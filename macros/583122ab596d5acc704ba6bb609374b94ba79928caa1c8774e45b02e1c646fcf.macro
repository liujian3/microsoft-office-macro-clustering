Attribute VB_Name = "CheckModule"
Option Explicit

' *** |fffd|s|fffd|f|fffd|[|fffd|^|fffd|p|fffd||3d0||fffd| ***
Private no          As String   ' No.
Private request     As String   ' |fffd|\|fffd||fffd||fffd||656a|
Private reg_status  As String   ' |fffd|o|fffd|^|fffd||fffd|
Private pia         As String   ' PIA|fffd||30e||fffd||fffd|{|fffd||fffd|
Private eval_num    As String   ' |fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd|
Private eval_name   As String   ' |fffd|]|fffd||fffd||fffd||fffd||fffd||fffd|
Private eval_place  As String   ' |fffd|]|fffd||fffd||fffd||fffd||fffd||30c|f|fffd||689||4cf||fffd|

Private biz_num2    As String   ' |fffd||295|\|fffd||fffd||4d014||fffd|
Private accept_biz  As String   ' |fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471|
Private basis_laws  As String   ' |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||fffd|
Private article_num As String   ' |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd||fffd||14d9||fffd||316||fffd||fffd||30b|y|fffd||44a|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd|
Private attach      As String   ' |fffd|Y|fffd|t
Private organ_cd    As String   ' |fffd||3d4|C|fffd||fffd|(|fffd||fffd|)|fffd|@|fffd||583|R|fffd|[|fffd|h
Private organ_name  As String   ' |fffd||3d4|C|fffd||fffd|(|fffd||fffd|)|fffd|@|fffd||596||fffd|
Private organ_check As String   ' |fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F
Private start_date  As String   ' |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
Private end_date    As String   ' |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|

Private start_dtime As String   ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd|
Private end_dtime   As String   ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|

Private chkDateTime As Date

Private delegate    As String   ' |fffd||3d4|C|fffd||317|L|fffd||fffd|
    
    
' |fffd|l|fffd||fffd|03-07|fffd||303|`|fffd|F|fffd|b|fffd|N
' (1)(2)|fffd||182||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||4cf||fffd||fffd||303|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||34b||fffd||fffd||282||302||fffd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function chk0307(ByVal sheetName As String, ByRef col As Collection) As Boolean

    Dim var         As Variant
    Dim sheet       As Worksheet
    Dim maxRow      As Long
    Dim curRow      As Long
    Dim result      As Boolean
    Dim protect     As Boolean
    
    
    ' |fffd||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = True
    
    ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Set col = New Collection
    
    ' |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|m|fffd||fffd|
    Set sheet = ThisWorkbook.Sheets(sheetName)
    
    ' |fffd||14f|I|fffd|s|fffd||30e||64fe|
    maxRow = getMaxRowNum(sheet)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||308||a39e||fffd||fffd||fffd||fffd|
    protect = unprotectWorkSheet(sheet)
    
    With sheet
    
        .Activate
    
        ' |fffd|f|fffd|[|fffd|^|fffd|s|fffd|S|fffd|s|fffd||fffd||fffd|[|fffd|v
        For curRow = DATA_START_ROW_NUM To maxRow
            
            ' |fffd|s|fffd|f|fffd|[|fffd|^|fffd||30e||64fe|
            no = .Cells(curRow, COL_0307_NO).Value
            request = .Cells(curRow, COL_0307_REQUEST).Value
            reg_status = .Cells(curRow, COL_0307_REG_STATUS).Value
            pia = .Cells(curRow, COL_0307_PIA).Value
            eval_num = .Cells(curRow, COL_0307_EVAL_NUM).Value
            eval_name = .Cells(curRow, COL_0307_EVAL_NAME).Value
            eval_place = .Cells(curRow, COL_0307_EVAL_PLACE).Value
            
            ' |fffd|Z|fffd||fffd||fffd|w|fffd|i|fffd|F|fffd||30f||fffd||fffd||fffd||fffd||fffd|
            If request <> NONE_VALUE Or .Cells(curRow, COL_0307_REQUEST).Locked = False Then
                'DEL |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171115 start ---------------------------------------------
'                'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
'                Call setCellBackColorCombo(.Cells(curRow, COL_0307_REQUEST))
'                'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------
                'DEL |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171115 end ---------------------------------------------
                Call setCellBackColorCombo(.Cells(curRow, COL_0307_PIA))
                Call setCellBackColorInput(.Cells(curRow, COL_0307_EVAL_NUM))
                Call setCellBackColorInput(.Cells(curRow, COL_0307_EVAL_NAME))
                Call setCellBackColorCombo(.Cells(curRow, COL_0307_EVAL_PLACE))
            End If
            'DEL |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171115 start ---------------------------------------------
'            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
'            ' |fffd|\|fffd||fffd||fffd||656a||fffd|s|fffd||fffd||fffd||202||fffd||fffd|`|fffd|F|fffd|b|fffd|N
'            If request <> REQUEST_ENTRY And request <> REQUEST_DELETE And request <> NONE_VALUE Then
'                Call setErrNoMsg(no, ERR_MSG_INVALID_DATA_REQUEST, col)
'                Call setCellBackColorError(.Cells(curRow, COL_0307_REQUEST))
'            End If
'            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------
            'DEL |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171115 end ---------------------------------------------
            
            ' |fffd|\|fffd||fffd||fffd||656a||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Select Case request
            
                ' |fffd|u|fffd|o|fffd|^|fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_ENTRY
                                
                    ' PIA|fffd||fffd||fffd|{|fffd||3c2||30f||a347||fffd||303|`|fffd|F|fffd|b|fffd|N
                    If pia = PIA_OK Then
                                            
                        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If Len(Trim(eval_num)) = 0 Then
                            Call setErrNoMsg(no, ERR_MSG_EVAL_NUM & ERR_MSG_NO_EVAL, col)
                            Call setCellBackColorError(.Cells(curRow, COL_0307_EVAL_NUM))
                        End If
                        
                        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If Len(Trim(eval_name)) = 0 Then
                            Call setErrNoMsg(no, ERR_MSG_EVAL_NAME & ERR_MSG_NO_EVAL, col)
                            Call setCellBackColorError(.Cells(curRow, COL_0307_EVAL_NAME))
                        End If
                        
                        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||30c|f|fffd||68f||a3ca||fffd||311|I|fffd||fffd|s|fffd||fffd||fffd|^|fffd||fffd||fffd|I|fffd||fffd|
                        If (eval_place <> EVAL_PLACE_1) And (eval_place <> EVAL_PLACE_2) And (eval_place <> EVAL_PLACE_3) Then
                            Call setErrNoMsg(no, ERR_MSG_EVAL_PLACE & ERR_MSG_NO_EVAL, col)
                            Call setCellBackColorError(.Cells(curRow, COL_0307_EVAL_PLACE))
                        End If
                        
                    ' PIA|fffd||fffd||fffd|{|fffd|s|fffd|v or |fffd||fffd||fffd|{|fffd|\|fffd||fffd||30f||a347||fffd||303|`|fffd|F|fffd|b|fffd|N
                    ElseIf (InStr(pia, PIA_NO_OBLIGATION) <> 0) Or (pia = PIA_PLANS) Then
                                 
                        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd|
                        If Len(Trim(eval_num)) <> 0 Then
                           Call setErrNoMsg(no, ERR_MSG_EVAL_NUM & ERR_MSG_EXIST_EVAL, col)
                           Call setCellBackColorError(.Cells(curRow, COL_0307_EVAL_NUM))
                        End If
                        
                        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd|
                        If Len(Trim(eval_name)) <> 0 Then
                            Call setErrNoMsg(no, ERR_MSG_EVAL_NAME & ERR_MSG_EXIST_EVAL, col)
                            Call setCellBackColorError(.Cells(curRow, COL_0307_EVAL_NAME))
                        End If
                        
                        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||30c|f|fffd||68f||a3ca||fffd||311|I|fffd||fffd||fffd||fffd||fffd||fffd|
                        If (eval_place = EVAL_PLACE_1) Or (eval_place = EVAL_PLACE_2) Or (eval_place = EVAL_PLACE_3) Then
                            Call setErrNoMsg(no, ERR_MSG_EVAL_PLACE & ERR_MSG_EXIST_EVAL, col)
                            Call setCellBackColorError(.Cells(curRow, COL_0307_EVAL_PLACE))
                        End If
                    
                    ' PIA|fffd||fffd||fffd|{|fffd||cbd42||30b||d4481|^|fffd||fffd||fffd||fffd||fffd||fffd|
                    Else
                        Call setErrNoMsg(no, ERR_MSG_PIA_NONE, col)
                        Call setCellBackColorError(.Cells(curRow, COL_0307_PIA))
                    End If
                
                ' |fffd||fffd||fffd||311||fffd||fffd|F|fffd|l03-07|fffd||142||341|u|fffd|o|fffd|^|fffd|v|fffd||20a|O|fffd|`|fffd|F|fffd|b|fffd|N|fffd||202||fffd|
                Case Else
                
            End Select
            
        Next
    
    End With
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    If protect = True Then
        Call protectWorkSheet(sheet)
    End If
    
    ' |fffd||7c2||fffd|l|fffd||752||fffd|
    chk0307 = IIf(col.Count = 0, True, False)

End Function
    
' |fffd|l|fffd||fffd|03-08(1)|fffd||303|`|fffd|F|fffd|b|fffd|N
Public Function chk03081(ByRef col As Collection) As Boolean

    Dim var         As Variant
    Dim sheet       As Worksheet
    Dim maxRow      As Long
    Dim curRow      As Long
    Dim result      As Boolean
    
    Dim bizRow      As Long         ' |fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|A|fffd||38f||6ce||fffd||fffd||fffd||fffd||30d|s
    Dim bizStartRow As Long         ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||50a|J|fffd|n|fffd|s
    Dim bizEndRow   As Long         ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||50f|I|fffd||fffd||fffd|s
    Dim bizValidNum As Long         ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||513||fffd||fffd||313|o|fffd|^|fffd|s|fffd||fffd|
    Dim bizStatus   As String       ' |fffd||38f||6d5||295|\|fffd||fffd||4d014||502||301|u|fffd||3cd|X|fffd||fffd||fffd|v
    
    Dim eLoop       As Long
    Dim protect     As Boolean
    
    
    ' |fffd||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = True
    
    ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Set col = New Collection
    
    ' |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|m|fffd||fffd|
    Set sheet = ThisWorkbook.Sheets("|fffd|l03-08_1")
    
    ' |fffd||14f|I|fffd|s|fffd||30e||64fe|
    maxRow = getMaxRowNum(sheet)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||308||a39e||fffd||fffd||fffd||fffd|
    protect = unprotectWorkSheet(sheet)
    
    With sheet
     
        .Activate
       
        ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||513||fffd||fffd|m|fffd|F|fffd|p
        bizStartRow = 0
        bizEndRow = 0
        bizValidNum = 0
        bizStatus = ""
        
        ' |fffd|f|fffd|[|fffd|^|fffd|s|fffd|S|fffd|s|fffd||fffd||fffd|[|fffd|v
        For curRow = DATA_START_ROW_NUM To maxRow
            
            ' |fffd|s|fffd|f|fffd|[|fffd|^|fffd||30e||64fe|
            no = .Cells(curRow, COL_03081_NO).Value
            biz_num2 = .Cells(curRow, COL_03081_BIZ_NUM2).Value
            request = .Cells(curRow, COL_03081_REQUEST).Value
            reg_status = .Cells(curRow, COL_03081_REG_STATUS).Value
            accept_biz = .Cells(curRow, COL_03081_ACCEPT_BIZ).Value
            basis_laws = .Cells(curRow, COL_03081_BASIS_LAWS).Value
            article_num = .Cells(curRow, COL_03081_ARTICLE_NUM).Value
            attach = .Cells(curRow, COL_03081_ATTACH).Value
            organ_cd = .Cells(curRow, COL_03081_ORGAN_CD).Value
            organ_name = .Cells(curRow, COL_03081_ORGAN_NAME).Value
            organ_check = .Cells(curRow, COL_03081_ORGAN_CHECK).Value
            start_date = .Cells(curRow, COL_03081_START_DATE).Value
            end_date = .Cells(curRow, COL_03081_END_DATE).Value
            start_dtime = .Cells(curRow, COL_CHK_START_DTIME).Value
            end_dtime = .Cells(curRow, COL_CHK_END_DTIME).Value
            
            ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||513||fffd||fffd|m|fffd|F|fffd|p
            If bizStatus = "" Then
                ' |fffd||38f||6ce||fffd||fffd||fffd||fffd||30d|s|fffd||64fe|(|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|V|fffd|[|fffd|g)
                bizRow = CLng(Application.WorksheetFunction.Match(biz_num2, ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).Columns(C_NUMBER_COL_NUM), 0))
                bizStatus = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).Cells(bizRow, C_NUMBER_USE_LAW_COL_NUM + 4).Value
                bizStartRow = curRow
            End If
            bizEndRow = curRow
            
            If ((request = REQUEST_ENTRY) And (reg_status = DATA_UNREGISTERED)) Or _
                ((request = REQUEST_UPDATE) And (reg_status = DATA_REGISTERED)) Or _
                ((request = NONE_VALUE) And (reg_status = DATA_REGISTERED)) Then
                bizValidNum = bizValidNum + 1
            End If
            
            ' |fffd|Z|fffd||fffd||fffd|w|fffd|i|fffd|F|fffd||30f||fffd||fffd||fffd||fffd||fffd|
            If request <> NONE_VALUE Or .Cells(curRow, COL_03081_REQUEST).Locked = False Then
                Call setCellBackColorCombo(.Cells(curRow, COL_03081_REQUEST))
                Call setCellBackColorCombo(.Cells(curRow, COL_03081_ACCEPT_BIZ))
                Call setCellBackColorCombo(.Cells(curRow, COL_03081_BASIS_LAWS))
                Call setCellBackColorInput(.Cells(curRow, COL_03081_ARTICLE_NUM))
                Call setCellBackColorCombo(.Cells(curRow, COL_03081_ATTACH))
                Call setCellBackColorAuto(.Cells(curRow, COL_03081_ORGAN_CD))
                Call setCellBackColorAuto(.Cells(curRow, COL_03081_ORGAN_NAME))
                Call setCellBackColorCombo(.Cells(curRow, COL_03081_ORGAN_CHECK))
                Call setCellBackColorInput(.Cells(curRow, COL_03081_START_DATE))
                Call setCellBackColorInput(.Cells(curRow, COL_03081_END_DATE))
            End If
                    
            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
            ' |fffd|\|fffd||fffd||fffd||656a||fffd|s|fffd||fffd||fffd||202||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            If request <> REQUEST_ENTRY And request <> REQUEST_UPDATE And request <> REQUEST_DELETE And request <> NONE_VALUE Then
                Call setErrNoMsg(no, ERR_MSG_INVALID_DATA_REQUEST, col)
                Call setCellBackColorError(.Cells(curRow, COL_03081_REQUEST))
            End If
            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------
                    
            ' |fffd|\|fffd||fffd||fffd||656a||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Select Case request

                ' |fffd|u|fffd|o|fffd|^|fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_ENTRY
                    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101 start --------------------------------------
                    If accept_biz <> CHECK_OK Then
                        'UPD |fffd||6d1||fffd|41|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171207 start --------------------------------------
                        If accept_biz = NONE_VALUE Then
                            Call setErrNoMsg(no, ERR_MSG_NO_ACCEPT_BIZ, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03081_ACCEPT_BIZ))
                        Else
                            Call setErrNoMsg(no, ERR_MSG_ACCEPT_BIZ, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03081_ACCEPT_BIZ))
                        End If
'                        Call setErrNoMsg(no, ERR_MSG_NO_ACCEPT_BIZ, col)
'                        Call setCellBackColorError(.Cells(curRow, COL_03081_ACCEPT_BIZ))
                        'UPD |fffd||6d1||fffd|41|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171207 end --------------------------------------
                    End If
                    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101 end --------------------------------------
                    
                    ' |fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34a|m|fffd|F
                    If ((Len(Trim(basis_laws)) = 0) Or (basis_laws = NONE_VALUE)) And (Len(Trim(article_num)) = 0) Then
                        Call setErrNoMsg(no, ERR_MSG_NO_BASIS, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_BASIS_LAWS))
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ARTICLE_NUM))
                    End If
                    
                    ' |fffd|u|fffd|Y|fffd|t|fffd|v|fffd|m|fffd|F
                    If attach <> CHECK_OK Then
                        Call setErrNoMsg(no, ERR_MSG_NO_ATTACH, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ATTACH))
                    End If
                    
                    ' |fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(organ_cd)) = 0 Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CD_BLANK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ORGAN_CD))
                    End If
                   
                    'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 start --------------------------------------------------
                    '|fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||d3||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    '|fffd||3d4|C|fffd||fffd||fffd|@|fffd||fffd| = |fffd||fffd||fffd|@|fffd||582||142||fffd||fffd||fffd||fffd|NG
                    If Trim(organ_cd) = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).KikanCode.Caption Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CD_F_NOVALID, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ORGAN_CD))
                    End If
                    'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 end --------------------------------------------------
                   
                    ' |fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||596||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(organ_name)) = 0 Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_NAME_BLANK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ORGAN_NAME))
                    End If
                   
                    ' |fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|v|fffd||fffd||fffd|I|fffd||fffd|
                    If organ_check <> CHECK_ALREADY Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CHECK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ORGAN_CHECK))
                    End If
                    
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(start_date)) = 0 Then
                        ' 20170803 del |fffd||fffd||fffd||fffd||fffd||342||343|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O
                        'Call setErrNoMsg(no, ERR_MSG_START_D_BLANK, col)
                        'Call setCellBackColorError(.Cells(curRow, COL_03081_START_DATE))
                    Else
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||348||34a|O
                        If (CDate(start_date) < CDate(start_dtime)) Or _
                            (CDate(end_dtime) < CDate(start_date)) Then
                            Call setErrNoMsg(no, ERR_MSG_START_D_OUTRANGE, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03081_START_DATE))
                            
                        'ADD |fffd||6d1||fffd|28 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||354||fffd||fffd||fffd||389||fffd| 20190524 start --------------------------------------------------
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd|O
                        ElseIf CDate(start_date) < CDate(getRirekiData()) Then
                            Call setErrNoMsg(no, ERR_MSG_START_D_OUTRANGE3, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03081_START_DATE))
                        'ADD |fffd||6d1||fffd|28 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||354||fffd||fffd||fffd||389||fffd| 20190524 end ----------------------------------------------------
                        End If
                    End If
                    
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(end_date)) = 0 Then
                        ' 20170803 del |fffd||fffd||fffd||fffd||fffd||342||343|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O
                        'Call setErrNoMsg(no, ERR_MSG_END_D_BLANK, col)
                        'Call setCellBackColorError(.Cells(curRow, COL_03081_END_DATE))
                    Else
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||348||34a|O
                        If CDate(end_dtime) < CDate(end_date) Then
                            Call setErrNoMsg(no, ERR_MSG_END_D_OUTRANGE, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03081_END_DATE))
                        End If
                    
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v
                        If Len(Trim(start_date)) = 0 Then
                            chkDateTime = CDate(start_dtime)
                        Else
                            chkDateTime = CDate(start_date)
                        End If
                        If CDate(end_date) < chkDateTime Then
                            Call setErrNoMsg(no, ERR_MSG_END_D_REVERSE, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03081_END_DATE))
                        End If
                    
                    End If

                ' |fffd|u|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X|fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_UPDATE
                    
                    ' |fffd|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N
                    If reg_status = DATA_UNREGISTERED Then
                        Call setErrNoMsg(no, ERR_MSG_REQUEST, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_REQUEST))
                    End If
                    'DEL |fffd||6d1||fffd|41|fffd||389||fffd| 20171115 start --------------------------------------
'                    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101 start --------------------------------------
'                    If accept_biz <> CHECK_OK Then
'                        Call setErrNoMsg(no, ERR_MSG_NO_ACCEPT_BIZ, col)
'                        Call setCellBackColorError(.Cells(curRow, COL_03081_ACCEPT_BIZ))
'                    End If
'                    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101 end --------------------------------------
                    'DEL |fffd||6d1||fffd|41|fffd||389||fffd| 20171115 end --------------------------------------
                    
                    ' |fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34a|m|fffd|F
                    If ((Len(Trim(basis_laws)) = 0) Or (basis_laws = NONE_VALUE)) And (Len(Trim(article_num)) = 0) Then
                        Call setErrNoMsg(no, ERR_MSG_NO_BASIS, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_BASIS_LAWS))
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ARTICLE_NUM))
                    End If
                    
                    ' |fffd|u|fffd|Y|fffd|t|fffd|v|fffd|m|fffd|F
                    If attach <> CHECK_OK Then
                        Call setErrNoMsg(no, ERR_MSG_NO_ATTACH, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ATTACH))
                    End If
                
                    ' ADD |fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X|fffd|v|fffd||308||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 2018.8 start -----
                    ' |fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd||fffd||fffd|u|fffd||3c1|v|fffd||20a|O|fffd||142||fffd||fffd||fffd||fffd|NG
                    If organ_check <> CHECK_ALREADY Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CHECK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ORGAN_CHECK))
                    End If
                    ' ADD |fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X|fffd|v|fffd||308||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 2018.8 end   -----
                
                ' |fffd|u|fffd||d3dc||fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_DELETE
                
                    ' |fffd|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N
                    If reg_status = DATA_UNREGISTERED Then
                        Call setErrNoMsg(no, ERR_MSG_REQUEST, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_REQUEST))
                    End If
                    
                    'DEL |fffd||6d1||fffd|41|fffd||389||fffd| 20171115 start --------------------------------------
'                    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101 start --------------------------------------
'                    If accept_biz <> CHECK_OK Then
'                        Call setErrNoMsg(no, ERR_MSG_NO_ACCEPT_BIZ, col)
'                        Call setCellBackColorError(.Cells(curRow, COL_03081_ACCEPT_BIZ))
'                    End If
'                    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101 end --------------------------------------
                    'DEL |fffd||6d1||fffd|41|fffd||389||fffd| 20171115 end --------------------------------------
                    
                    ' |fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|v|fffd||fffd||fffd|I|fffd||fffd|
                    If organ_check <> CHECK_ALREADY Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CHECK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_ORGAN_CHECK))
                    End If
                    
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(end_date)) = 0 Then
                        
                        ' |fffd|u|fffd||d3dc||fffd|v|fffd||fffd||fffd||317|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||341|A|fffd|G|fffd||fffd||fffd|[|fffd||182||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|||fffd|P|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|B
                        ' |fffd|i|fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|j
                        .Cells(curRow, COL_03081_END_DATE).Value = CStr(DateAdd("d", -1, CDate(getRirekiData())))
                        end_date = .Cells(curRow, COL_03081_END_DATE).Value
                    
                    End If
                    
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||348||34a|O
                    If CDate(end_dtime) < CDate(end_date) Then
                        Call setErrNoMsg(no, ERR_MSG_END_D_OUTRANGE, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_END_DATE))
                    End If
                    
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v
                    If Len(Trim(start_date)) = 0 Then
                        chkDateTime = CDate(start_dtime)
                    Else
                        chkDateTime = CDate(start_date)
                    End If
                    If CDate(end_date) < chkDateTime Then
                        Call setErrNoMsg(no, ERR_MSG_END_D_REVERSE, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03081_END_DATE))
                    End If
                
                ' |fffd||fffd||fffd||311||fffd||fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||202||fffd|
                Case Else

            End Select

            ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||502||30d||14f|I|fffd|s|fffd||30f||a347||fffd|A|fffd||1c9||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            If biz_num2 <> .Cells(curRow + 1, COL_03081_BIZ_NUM2).Value Then

                ' |fffd||fffd||fffd||fffd||295|\|fffd||fffd||4d014||502||157|L|fffd||fffd||fffd|s0
                If bizValidNum = 0 Then
                    Select Case bizStatus
                        ' |fffd||fffd|
                        Case STATUS_OK
                            Call setErrNoMsg(CStr(bizStartRow - DATA_TITLE_ROW_NUM) & "|fffd|`" & CStr(bizEndRow - DATA_TITLE_ROW_NUM), ERR_MSG_ENTRY_NOVALID, col)
                            For eLoop = bizStartRow To bizEndRow
                                Call setCellBackColorError(.Cells(eLoop, COL_03081_REQUEST))
                            Next
                        
                        ' |fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|
                        Case STATUS_CHANGE
                            Call setErrNoMsg(CStr(bizStartRow - DATA_TITLE_ROW_NUM) & "|fffd|`" & CStr(bizEndRow - DATA_TITLE_ROW_NUM), ERR_MSG_UPDATE_NOVALID, col)
                            For eLoop = bizStartRow To bizEndRow
                                Call setCellBackColorError(.Cells(eLoop, COL_03081_REQUEST))
                            Next
                    End Select
                End If

                bizStartRow = 0
                bizEndRow = 0
                bizValidNum = 0
                bizStatus = ""

            End If

        Next
    
    End With
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    If protect = True Then
        Call protectWorkSheet(sheet)
    End If
    
    ' |fffd||7c2||fffd|l|fffd||752||fffd|
    chk03081 = IIf(col.Count = 0, True, False)

End Function
    
' |fffd|l|fffd||fffd|03-08(2)|fffd||303|`|fffd|F|fffd|b|fffd|N
Public Function chk03082(ByRef col As Collection) As Boolean

    Dim var         As Variant
    Dim sheet       As Worksheet
    Dim maxRow      As Long
    Dim curRow      As Long
    Dim result      As Boolean
    Dim protect     As Boolean
    
    ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
    Dim eLoop       As Long
    
    Dim styleRow            As Integer  ' |fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|F|fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||30d|s
    Dim person_info_name_num As String   ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
    Dim targetStart         As Integer  ' |fffd||38f||6ca|J|fffd|n|fffd|s
    Dim targetEnd           As Integer  ' |fffd||38f||6cf|I|fffd||fffd||fffd|s
    Dim targetCount         As Integer  ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||d3dc||fffd||30c||fffd||fffd||fffd|
    Dim appCount    As Integer  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||50d||fffd||fffd||310|\|fffd||fffd||fffd||fffd||fffd||fffd|
    Dim err_num             As String
    Dim refuse_request      As String   ' |fffd|l03-07_2|fffd|F|fffd|\|fffd||fffd||fffd||656a|
    Dim refuse_reg_status   As String   ' |fffd|l03-07_2|fffd|F|fffd|o|fffd|^|fffd||fffd|
    Dim traceFlg            As Boolean  ' |fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g
    ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----
    
    ' |fffd||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = True
    
    ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Set col = New Collection
    
    ' |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|m|fffd||fffd|
    Set sheet = ThisWorkbook.Sheets("|fffd|l03-08_2")
    
    ' |fffd||14f|I|fffd||30e||64fe|
    maxRow = getMaxRowNum(sheet)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||308||a39e||fffd||fffd||fffd||fffd|
    protect = unprotectWorkSheet(sheet)
    
    With sheet
    
        .Activate
        
        ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
        ' |fffd||3d0||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
        styleRow = 0
        targetStart = 0
        targetEnd = 0
        targetCount = 0
        traceFlg = False
        ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----
        
        ' |fffd|f|fffd|[|fffd|^|fffd|s|fffd|S|fffd|s|fffd||fffd||fffd|[|fffd|v
        For curRow = DATA_START_ROW_NUM To maxRow
            
            ' |fffd|s|fffd|f|fffd|[|fffd|^|fffd||30e||64fe|
            no = .Cells(curRow, COL_03082_NO).Value
            request = .Cells(curRow, COL_03082_REQUEST).Value
            reg_status = .Cells(curRow, COL_03082_REG_STATUS).Value
            delegate = .Cells(curRow, COL_03082_DELEGATE).Value
            organ_cd = .Cells(curRow, COL_03082_ORGAN_CD).Value
            organ_name = .Cells(curRow, COL_03082_ORGAN_NAME).Value
            
            ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
            
            ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|(|fffd|l03-08_2)
            person_info_name_num = .Cells(curRow, COL_03082_NUMBER).Value
            
            ' |fffd||fffd||fffd||fffd||fffd||38f||6c2||313||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd||310|\|fffd||fffd||fffd||656a||fffd||193|o|fffd|^|fffd||cbd42||fffd|l03-07_2|fffd||fffd||fffd||64fe|
            If traceFlg = False Then
                
                ' |fffd|u|fffd|l03-07_2|fffd|v|fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd||30d|s
                styleRow = CLng(Application.WorksheetFunction.Match(person_info_name_num, ThisWorkbook.Worksheets(C_03072_SHEET_NAME).Columns(COL_0307_NUMBER), 0))
                ' |fffd|l03-07_2|fffd|F|fffd|\|fffd||fffd||fffd||656a|
                refuse_request = ThisWorkbook.Worksheets(C_03072_SHEET_NAME).Cells(styleRow, COL_0307_REQUEST).Value
                ' |fffd|l03-07_2|fffd|F|fffd|o|fffd|^|fffd||fffd|
                refuse_reg_status = ThisWorkbook.Worksheets(C_03072_SHEET_NAME).Cells(styleRow, COL_0307_REG_STATUS).Value
                
                ' |fffd||1d0||54a|J|fffd|n
                traceFlg = True
                ' |fffd|J|fffd|n|fffd|s
                targetStart = curRow
                ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
                targetCount = 0
            End If
            
            ' |fffd|I|fffd||fffd||fffd|s
            targetEnd = curRow
            
            ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----
            
            ' |fffd|Z|fffd||fffd||fffd|w|fffd|i|fffd|F|fffd||30f||fffd||fffd||fffd||fffd||fffd|
            If request <> NONE_VALUE Or .Cells(curRow, COL_03082_REQUEST).Locked = False Then
                'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
                Call setCellBackColorCombo(.Cells(curRow, COL_03082_REQUEST))
                'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------
                Call setCellBackColorAuto(.Cells(curRow, COL_03082_ORGAN_CD))
                Call setCellBackColorAuto(.Cells(curRow, COL_03082_ORGAN_NAME))
            End If
                    
            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
            ' |fffd|\|fffd||fffd||fffd||656a||fffd|s|fffd||fffd||fffd||202||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            If request <> REQUEST_ENTRY And request <> REQUEST_UPDATE And request <> REQUEST_DELETE And request <> NONE_VALUE Then
                Call setErrNoMsg(no, ERR_MSG_INVALID_DATA_REQUEST, col)
                Call setCellBackColorError(.Cells(curRow, COL_03082_REQUEST))
            End If
            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------
                    
            ' |fffd|\|fffd||fffd||fffd||656a||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Select Case request

                ' |fffd|u|fffd|o|fffd|^|fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_ENTRY
                    
                    ' |fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(organ_cd)) = 0 Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CD_BLANK2, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03082_ORGAN_CD))
                    End If
                   
                    'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 start --------------------------------------------------
                    '|fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||d3||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    '|fffd||3d4|C|fffd||fffd||fffd|@|fffd||fffd| = |fffd||fffd||fffd|@|fffd||582||142||fffd||fffd||fffd||fffd|NG
                    If Trim(organ_cd) = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).KikanCode.Caption Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CD_T_NOVALID, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03082_ORGAN_CD))
                    End If
                    'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 end --------------------------------------------------
                   
                    ' |fffd||3d4|C|fffd||fffd|@|fffd||596||fffd||fffd||fffd||fffd||fffd||fffd||341|i|fffd||fffd||fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|s|fffd||fffd||fffd||fffd||fffd||341|j
                    If Len(Trim(organ_name)) = 0 Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_NAME_BLANK2, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03082_ORGAN_NAME))
                    End If

                ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
                ' |fffd||d3dc||fffd|F|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g|fffd|A|fffd|b|fffd|v
                Case REQUEST_DELETE
                    targetCount = targetCount + 1

                ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----

                ' |fffd||fffd||fffd||311||fffd||fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||202||fffd|
                Case Else

            End Select

            ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
            ' |fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd||142||342||202||fffd||fffd||202||fffd||a347|
            If (person_info_name_num <> .Cells(curRow + 1, COL_03082_NUMBER).Value) Then
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||50d||fffd||fffd||310|\|fffd||fffd||fffd||fffd||fffd||fffd|
                appCount = targetEnd - targetStart + 1
                
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||50d||fffd||fffd||310|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c2||10d||d3dc||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347|
                If targetCount = appCount Then
                
'                   UPD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc|(|fffd|C|fffd||fffd|) |fffd||6d1||fffd|35|fffd||389||fffd| 20190613 start ------------------------------------
'                    ' ((|fffd|l03-07_2)|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|[|fffd||fffd||fffd||fffd|(|fffd|l03-07_2)|fffd|o|fffd|^|fffd||cbd41|F|fffd||fffd||fffd|o|fffd|^)|fffd||702||fffd||fffd||fffd|((|fffd|l03-07_2)|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||d3dc||fffd||fffd||fffd||fffd|(|fffd|l03-07_2)|fffd|o|fffd|^|fffd||cbd41|F|fffd|o|fffd|^|fffd||fffd|)
'                    If (refuse_request = NONE_VALUE And refuse_reg_status = DATA_UNREGISTERED) Or _
'                      (refuse_request = REQUEST_DELETE And refuse_reg_status = DATA_REGISTERED) Then
                    ' (((|fffd|l03-07_2)|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|[|fffd||fffd||fffd||fffd|(|fffd|l03-07_2)|fffd|o|fffd|^|fffd||cbd41|F|fffd||fffd||fffd|o|fffd|^)|fffd||702||fffd||fffd||fffd|((|fffd|l03-07_2)|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||d3dc||fffd||fffd||fffd||fffd|(|fffd|l03-07_2)|fffd|o|fffd|^|fffd||cbd41|F|fffd|o|fffd|^|fffd||fffd|))
                    ' |fffd||fffd||fffd||fffd|(|fffd|l03-08_2)|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||315||3cd|X|fffd||fffd||fffd|F|fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|
                    If ((refuse_request = NONE_VALUE And refuse_reg_status = DATA_UNREGISTERED) Or _
                        (refuse_request = REQUEST_DELETE And refuse_reg_status = DATA_REGISTERED)) And _
                        .Cells(curRow, COL_LAW_OBLIGATION_FLG + 6).Value = STATUS_CHANGE Then
'                   UPD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc|(|fffd|C|fffd||fffd|) |fffd||6d1||fffd|35|fffd||389||fffd| 20190613 end --------------------------------------
                        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||752||fffd|
                        If targetStart = targetEnd Then
                            err_num = CStr(targetStart - DATA_TITLE_ROW_NUM)
                        Else
                            err_num = CStr(targetStart - DATA_TITLE_ROW_NUM) & "|fffd|`" & CStr(targetEnd - DATA_TITLE_ROW_NUM)
                        End If
                        
                        Call setErrNoMsg(err_num, ERR_MSG_UPDATE_NOVALID2, col)
                        
                        ' |fffd|l03-08_2|fffd|V|fffd|[|fffd|g|fffd||303|G|fffd||fffd||fffd|[|fffd||4cf||fffd||fffd||250||510|F|fffd||752||fffd|
                        For eLoop = targetStart To targetEnd
                             Call setCellBackColorError(.Cells(eLoop, COL_03082_REQUEST))
                        Next
                    End If
                End If
                ' |fffd||1d0||54f|I|fffd||fffd|
                traceFlg = False
            
            End If
            ' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----

        Next
    
    End With
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    If protect = True Then
        Call protectWorkSheet(sheet)
    End If
    
    ' |fffd||7c2||fffd|l|fffd||752||fffd|
    chk03082 = IIf(col.Count = 0, True, False)

End Function
    
' |fffd|l|fffd||fffd|03-08(3)|fffd||303|`|fffd|F|fffd|b|fffd|N
Public Function chk03083(ByRef col As Collection) As Boolean

    Dim var         As Variant
    Dim sheet       As Worksheet
    Dim maxRow      As Long
    Dim curRow      As Long
    Dim result      As Boolean
    Dim protect     As Boolean
    
    
    ' |fffd||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = True
    
    ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Set col = New Collection
    
    ' |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|m|fffd||fffd|
    Set sheet = ThisWorkbook.Sheets("|fffd|l03-08_3")
    
    ' |fffd||14f|I|fffd|s|fffd||30e||64fe|
    maxRow = getMaxRowNum(sheet)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||308||a39e||fffd||fffd||fffd||fffd|
    protect = unprotectWorkSheet(sheet)
    
    With sheet
    
        .Activate
        
        ' |fffd|f|fffd|[|fffd|^|fffd|s|fffd|S|fffd|s|fffd||fffd||fffd|[|fffd|v
        For curRow = DATA_START_ROW_NUM To maxRow
            
            ' |fffd|s|fffd|f|fffd|[|fffd|^|fffd||30e||64fe|
            no = .Cells(curRow, COL_03083_NO).Value
            request = .Cells(curRow, COL_03083_REQUEST).Value
            reg_status = .Cells(curRow, COL_03083_REG_STATUS).Value
            basis_laws = .Cells(curRow, COL_03083_BASIS_LAWS).Value
            article_num = .Cells(curRow, COL_03083_ARTICLE_NUM).Value
            attach = .Cells(curRow, COL_03083_ATTACH).Value
            organ_cd = .Cells(curRow, COL_03083_ORGAN_CD).Value
            organ_name = .Cells(curRow, COL_03083_ORGAN_NAME).Value
            start_date = .Cells(curRow, COL_03083_START_DATE).Value
            end_date = .Cells(curRow, COL_03083_END_DATE).Value
            start_dtime = .Cells(curRow, COL_CHK_START_DTIME).Value
            end_dtime = .Cells(curRow, COL_CHK_END_DTIME).Value
            
            ' |fffd|Z|fffd||fffd||fffd|w|fffd|i|fffd|F|fffd||30f||fffd||fffd||fffd||fffd||fffd|
            If request <> NONE_VALUE Or .Cells(curRow, COL_03083_REQUEST).Locked = False Then
                Call setCellBackColorCombo(.Cells(curRow, COL_03083_REQUEST))
                Call setCellBackColorCombo(.Cells(curRow, COL_03083_BASIS_LAWS))
                Call setCellBackColorInput(.Cells(curRow, COL_03083_ARTICLE_NUM))
                Call setCellBackColorCombo(.Cells(curRow, COL_03083_ATTACH))
                Call setCellBackColorAuto(.Cells(curRow, COL_03083_ORGAN_CD))
                Call setCellBackColorAuto(.Cells(curRow, COL_03083_ORGAN_NAME))
                Call setCellBackColorInput(.Cells(curRow, COL_03083_START_DATE))
                Call setCellBackColorInput(.Cells(curRow, COL_03083_END_DATE))
            End If
                    
            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
            ' |fffd|\|fffd||fffd||fffd||656a||fffd|s|fffd||fffd||fffd||202||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            If request <> REQUEST_ENTRY And request <> REQUEST_UPDATE And request <> REQUEST_DELETE And request <> NONE_VALUE Then
                Call setErrNoMsg(no, ERR_MSG_INVALID_DATA_REQUEST, col)
                Call setCellBackColorError(.Cells(curRow, COL_03083_REQUEST))
            End If
            'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------
                    
            ' |fffd|\|fffd||fffd||fffd||656a||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Select Case request

                ' |fffd|u|fffd|o|fffd|^|fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_ENTRY

                    ' |fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34a|m|fffd|F
                    If ((Len(Trim(basis_laws)) = 0) Or (basis_laws = NONE_VALUE)) And (Len(Trim(article_num)) = 0) Then
                        Call setErrNoMsg(no, ERR_MSG_NO_BASIS, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_BASIS_LAWS))
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ARTICLE_NUM))
                    End If
                    
                    ' |fffd|u|fffd|Y|fffd|t|fffd|v|fffd|m|fffd|F
                    If attach <> CHECK_OK Then
                        Call setErrNoMsg(no, ERR_MSG_NO_ATTACH, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ATTACH))
                    End If
                    
                    ' |fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(organ_cd)) = 0 Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CD_BLANK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ORGAN_CD))
                    End If
                   
                    'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 start --------------------------------------------------
                    '|fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||d3||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    '|fffd||3d4|C|fffd||fffd||fffd|@|fffd||fffd| = |fffd||fffd||fffd|@|fffd||582||142||fffd||fffd||fffd||fffd|NG
                    If Trim(organ_cd) = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).KikanCode.Caption Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_CD_F_NOVALID, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ORGAN_CD))
                    End If
                    'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 end --------------------------------------------------
                   
                    ' |fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||596||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(organ_name)) = 0 Then
                        Call setErrNoMsg(no, ERR_MSG_ORGAN_NAME_BLANK, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ORGAN_NAME))
                    End If
                    
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(start_date)) = 0 Then
                        ' 20170803 del |fffd||fffd||fffd||fffd||fffd||342||343|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O
                        'Call setErrNoMsg(no, ERR_MSG_START_D_BLANK, col)
                        'Call setCellBackColorError(.Cells(curRow, COL_03083_START_DATE))
                    Else
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||348||34a|O
                        If (CDate(start_date) < CDate(start_dtime)) Or _
                            (CDate(end_dtime) < CDate(start_date)) Then
                            Call setErrNoMsg(no, ERR_MSG_START_D_OUTRANGE2, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03083_START_DATE))
                        'ADD |fffd||6d1||fffd|28 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||354||fffd||fffd||fffd||389||fffd| 20190524 start --------------------------------------------------
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd|O
                        ElseIf CDate(start_date) < CDate(getRirekiData()) Then
                            Call setErrNoMsg(no, ERR_MSG_START_D_OUTRANGE3, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03083_START_DATE))
                        'ADD |fffd||6d1||fffd|28 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||354||fffd||fffd||fffd||389||fffd| 20190524 end ----------------------------------------------------
                        End If
                    End If

                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(end_date)) = 0 Then
                        ' 20170803 del |fffd||fffd||fffd||fffd||fffd||342||343|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O
                        'Call setErrNoMsg(no, ERR_MSG_END_D_BLANK, col)
                        'Call setCellBackColorError(.Cells(curRow, COL_03083_END_DATE))
                    Else
                        
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||348||34a|O
                        If (CDate(end_dtime) < CDate(end_date)) Then
                            Call setErrNoMsg(no, ERR_MSG_END_D_OUTRANGE2, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03083_END_DATE))
                        End If
                    
                        ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v
                        If Len(Trim(start_date)) = 0 Then
                            chkDateTime = CDate(start_dtime)
                        Else
                            chkDateTime = CDate(start_date)
                        End If
                        If CDate(end_date) < chkDateTime Then
                            Call setErrNoMsg(no, ERR_MSG_END_D_REVERSE, col)
                            Call setCellBackColorError(.Cells(curRow, COL_03083_END_DATE))
                        End If
                    
                    End If
                
                ' |fffd|u|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X|fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_UPDATE
                    
                    ' |fffd|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N
                    If reg_status = DATA_UNREGISTERED Then
                        Call setErrNoMsg(no, ERR_MSG_REQUEST, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_REQUEST))
                    End If
                    
                    ' |fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34a|m|fffd|F
                    If ((Len(Trim(basis_laws)) = 0) Or (basis_laws = NONE_VALUE)) And (Len(Trim(article_num)) = 0) Then
                        Call setErrNoMsg(no, ERR_MSG_NO_BASIS, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_BASIS_LAWS))
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ARTICLE_NUM))
                    End If
                    
                    ' |fffd|u|fffd|Y|fffd|t|fffd|v|fffd|m|fffd|F
                    If attach <> CHECK_OK Then
                        Call setErrNoMsg(no, ERR_MSG_NO_ATTACH, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_ATTACH))
                    End If
                
                ' |fffd|u|fffd||d3dc||fffd|v|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                Case REQUEST_DELETE
                
                    ' |fffd|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N
                    If reg_status = DATA_UNREGISTERED Then
                        Call setErrNoMsg(no, ERR_MSG_REQUEST, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_REQUEST))
                    End If
                        
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
                    If Len(Trim(end_date)) = 0 Then
                        
                        ' |fffd|u|fffd||d3dc||fffd|v|fffd||fffd||fffd||317|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||341|A|fffd|G|fffd||fffd||fffd|[|fffd||182||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|||fffd|P|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|B
                        ' |fffd|i|fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|j
                        .Cells(curRow, COL_03083_END_DATE).Value = CStr(DateAdd("d", -1, CDate(getRirekiData())))
                        end_date = .Cells(curRow, COL_03083_END_DATE).Value
                    
                    End If
                        
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||348||34a|O
                    If (CDate(end_dtime) < CDate(end_date)) Then
                        Call setErrNoMsg(no, ERR_MSG_END_D_OUTRANGE2, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_END_DATE))
                    End If
                
                    ' |fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v
                    If Len(Trim(start_date)) = 0 Then
                        chkDateTime = CDate(start_dtime)
                    Else
                        chkDateTime = CDate(start_date)
                    End If
                    If CDate(end_date) < chkDateTime Then
                        Call setErrNoMsg(no, ERR_MSG_END_D_REVERSE, col)
                        Call setCellBackColorError(.Cells(curRow, COL_03083_END_DATE))
                    End If
                
                ' |fffd||fffd||fffd||311||fffd||fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||202||fffd|
                Case Else

            End Select

        Next
    
    End With
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    If protect = True Then
        Call protectWorkSheet(sheet)
    End If
    
    ' |fffd||7c2||fffd|l|fffd||752||fffd|
    chk03083 = IIf(col.Count = 0, True, False)

End Function

' |fffd|f|fffd|[|fffd|^|fffd||310||752||80b3||fffd||fffd||102||fffd||fffd||fffd||14f|I|fffd|s|fffd||30e||64fe||fffd|iNo.|fffd|J|fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd|_|fffd||182||fffd||fffd||fffd|j
Private Function getMaxRowNum(ByVal sheet As Worksheet) As Long
    getMaxRowNum = sheet.Cells(sheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row
End Function

' |fffd|f|fffd|[|fffd|^|fffd||310||752||80b3||fffd||fffd||102||fffd||fffd||fffd||14f|I|fffd||fffd||30e||64fe||fffd|i|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||682||315|\|fffd||fffd||fffd|s|fffd||fffd||fffd|N|fffd|_|fffd||182||fffd||fffd||fffd|j
Private Function getMaxColNum(ByVal sheet As Worksheet) As Long
    getMaxColNum = sheet.Cells(DATA_TITLE_ROW_NUM, sheet.Columns.Count).End(xlToLeft).Column
End Function

' |fffd|G|fffd||fffd||fffd|[|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|No.|fffd||183||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|l|fffd||7c2||fffd|
Private Sub setErrNoMsg(ByVal no As String, ByVal msg As String, ByRef col As Collection)
    col.Add Array(no, msg)
End Sub

' |fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|
Private Sub setCellBackColor(ByVal cell As Range, ByVal color As Long)
    cell.Interior.color = color
End Sub

' |fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd|F|fffd|j
Private Sub setCellBackColorCombo(ByVal cell As Range)
    Call setCellBackColor(cell, 14994616)
End Sub

' |fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||343|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd|F|fffd|j
Private Sub setCellBackColorInput(ByVal cell As Range)
    Call setCellBackColor(cell, 10092543)
End Sub

' |fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd|F|fffd|j
Private Sub setCellBackColorAuto(ByVal cell As Range)
    Call setCellBackColor(cell, 11851260)
End Sub

' |fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|i|fffd|G|fffd||fffd||fffd|[|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd|F|fffd|j
Private Sub setCellBackColorError(ByVal cell As Range)
    Call setCellBackColor(cell, 255)
End Sub
Attribute VB_Name = "ClickModule"
'------------------------
' |fffd|@|fffd||591|I|fffd||fffd|
'------------------------
Sub UserFormShow1()

    UserForm1.Show

End Sub

'-----------------------
' |fffd|w|fffd||fffd|s|fffd||fffd||fffd|R|fffd|s|fffd|[
'-----------------------
Sub UserFormShow2()

    UserForm2.Show

End Sub

'-----------------------
' |fffd|w|fffd||fffd|s|fffd||fffd||fffd||d3dc|
'-----------------------
Sub UserFormShow3()

    UserForm3.Show

End Sub
Attribute VB_Name = "CommonConst"
Option Explicit

' ================================================================================
' |fffd|e|fffd|l|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||301|A|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||30d|s|fffd|^|fffd||fffd||fffd||fffd||fffd||80b7||fffd||fffd||8414|
' ================================================================================
' |fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g
Public Const C_NUMBER_COL_NUM           As Long = 5     ' [|fffd||295|\|fffd||fffd||4d014||fffd|][|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|]|fffd||fffd|
Public Const C_BIZ_P_I_NAME_COL_NUM     As Long = 6     ' [|fffd||fffd||fffd||fffd||fffd||fffd|][|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|]|fffd||fffd|
Public Const C_NUMBER_USE_LAW_COL_NUM   As Long = 7     ' |fffd||50d||fffd||fffd||fffd||fffd|p|fffd|@|fffd||fffd||fffd||fffd||189||fffd||94|\|fffd|^|fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
Public Const C_REMARKS_COL_NUM          As Long = 14    ' |fffd||fffd||fffd|l|fffd||fffd||fffd||697||fffd|
'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| end -------------------------------------------------------------------
Public Const C_BIZ_P_I_CD_COL_NUM       As Long = 15    ' [|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h][|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h]|fffd|B|fffd||fffd||fffd||fffd||fffd||697||fffd|
Public Const C_START_DTIME_COL_NUM      As Long = 16    ' |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||697||fffd|
Public Const C_END_DTIME_COL_NUM        As Long = 17    ' |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||697||fffd|
Public Const C_BIZ_START_ROW_NUM        As Long = 20    ' [|fffd||fffd||fffd||189||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|]|fffd|\|fffd||fffd||fffd|J|fffd|n|fffd|s
Public Const C_APP_FORM_SHEET_NAME      As String = "|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c|"
Public Const C_APP_FORM_SHEET_COPY_NAME As String = "|fffd|o|fffd|^|fffd|E|fffd||3cd|X|fffd||fffd||fffd|e"

' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
Public Const C_03072_SHEET_NAME As String = "|fffd|l03-07_2"
' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
' ADD |fffd||6d1||fffd|32|fffd||389||fffd| 2019.7 start -----
Public Const C_03081_SHEET_NAME As String = "|fffd|l03-08_1"
Public Const C_03082_SHEET_NAME As String = "|fffd|l03-08_2"
Public Const C_03083_SHEET_NAME As String = "|fffd|l03-08_3"
' ADD |fffd||6d1||fffd|32|fffd||389||fffd| 2019.7 end -----

'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
' |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||38f||6ca|O|fffd||fffd||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g
Public Const SHT_NAME_NONE_P_I          As String = "|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||38f||6ca|O|fffd||fffd||fffd|X|fffd|g"
Public Const NONE_P_I                   As String = "|fffd||4b7c2||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||202||fffd|" '|fffd||fffd||fffd|l|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|e
Public Const NONE_P_I_LIST_START_ROW_NUM  As Long = 2   ' |fffd||fffd||fffd|X|fffd|g|fffd|J|fffd|n|fffd|s
Public Const NONE_P_I_ORGAN_CD_COL_NUM  As Long = 1     ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd|
Public Const NONE_P_I_P_I_NUM_COL_NUM   As Long = 2     ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd||fffd|
'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| end -------------------------------------------------------------------

' |fffd|e|fffd||fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd|V|fffd|[|fffd|g
Public Const WL_ORGAN_CD_COL_NUM        As Long = 4     ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd|
Public Const WL_1ST_KEY_ROW_NUM         As Long = 5     ' WL|fffd|E|fffd||fffd|P|fffd|L|fffd|[|fffd|s|fffd|i|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|A|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|j
Public Const WL_2ND_KEY_ROW_NUM         As Long = 8     ' WL|fffd|E|fffd||fffd|Q|fffd|L|fffd|[|fffd|s|fffd|i|fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd|j
Public Const WL4_DATA_START_ROW_NUM     As Long = 12    ' WL4(|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g)|fffd|E|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s
Public Const WL1_NAME                   As String = "|fffd||189||fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g"
Public Const WL2_NAME                   As String = "|fffd||4b7c3|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g"
Public Const WL3_NAME                   As String = "|fffd||189||fffd||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g"
Public Const WL4_NAME                   As String = "|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g"

' |fffd|e|fffd||fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g
Public Const DATA_TITLE_ROW_NUM         As Long = 6     ' |fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||30d||fffd||fffd||68d|s
Public Const DATA_START_ROW_NUM         As Long = 7     ' |fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s
Public Const DATA_START_COL_NUM         As Long = 4     ' |fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd||fffd|

Public Const COL_0307_NO                As Long = 4     ' |fffd|l|fffd||fffd|03-07 D|fffd||fffd|: No
Public Const COL_0307_NUMBER            As Long = 5     ' |fffd|l|fffd||fffd|03-07 E|fffd||fffd|: |fffd||295|\|fffd||fffd||4d014||501|^|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
Public Const COL_0307_NAME              As Long = 6     ' |fffd|l|fffd||fffd|03-07 F|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
Public Const COL_0307_REQUEST           As Long = 7     ' |fffd|l|fffd||fffd|03-07 G|fffd||fffd|: |fffd|\|fffd||fffd||fffd||656a|
Public Const COL_0307_REG_STATUS        As Long = 8     ' |fffd|l|fffd||fffd|03-07 H|fffd||fffd|: |fffd|o|fffd|^|fffd||fffd|
Public Const COL_0307_PIA               As Long = 9     ' |fffd|l|fffd||fffd|03-07 I|fffd||fffd|: PIA|fffd||30e||fffd||fffd|{|fffd||fffd|
Public Const COL_0307_EVAL_NUM          As Long = 10    ' |fffd|l|fffd||fffd|03-07 J|fffd||fffd|: |fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd|
Public Const COL_0307_EVAL_NAME         As Long = 11    ' |fffd|l|fffd||fffd|03-07 K|fffd||fffd|: |fffd|]|fffd||fffd||fffd||fffd||fffd||fffd|
Public Const COL_0307_EVAL_PLACE        As Long = 12    ' |fffd|l|fffd||fffd|03-07 L|fffd||fffd|: |fffd|]|fffd||fffd||fffd||fffd||fffd||30c|f|fffd||689||4cf||fffd|

Public Const COL_03081_NO               As Long = 4     ' |fffd|l|fffd||fffd|03-08(1) D|fffd||fffd|: No
Public Const COL_03081_BIZ_NUM2         As Long = 5     ' |fffd|l|fffd||fffd|03-08(1) E|fffd||fffd|: |fffd||295|\|fffd||fffd||4d014||fffd|
Public Const COL_03081_BIZ_NAME         As Long = 6     ' |fffd|l|fffd||fffd|03-08(1) F|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd|
Public Const COL_03081_PROC_NUM         As Long = 7     ' |fffd|l|fffd||fffd|03-08(1) G|fffd||fffd|: |fffd||1d7||fffd||fffd||50d||fffd|
Public Const COL_03081_PROC_NAME        As Long = 8     ' |fffd|l|fffd||fffd|03-08(1) H|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||8471||fffd||fffd|
Public Const COL_03081_REQUEST          As Long = 9     ' |fffd|l|fffd||fffd|03-08(1) I|fffd||fffd|: |fffd|\|fffd||fffd||fffd||656a|
Public Const COL_03081_REG_STATUS       As Long = 10    ' |fffd|l|fffd||fffd|03-08(1) J|fffd||fffd|: |fffd|o|fffd|^|fffd||fffd|
Public Const COL_03081_ACCEPT_BIZ       As Long = 11    ' |fffd|l|fffd||fffd|03-08(1) K|fffd||fffd|: |fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471|
Public Const COL_03081_BASIS_LAWS       As Long = 12    ' |fffd|l|fffd||fffd|03-08(1) L|fffd||fffd|: |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||fffd|
Public Const COL_03081_ARTICLE_NUM      As Long = 13    ' |fffd|l|fffd||fffd|03-08(1) M|fffd||fffd|: |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd||fffd||14d9||fffd||316||fffd||fffd||30b|y|fffd||44a|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd|
Public Const COL_03081_ATTACH           As Long = 14    ' |fffd|l|fffd||fffd|03-08(1) N|fffd||fffd|: |fffd|Y|fffd|t
Public Const COL_03081_ORGAN_CD         As Long = 15    ' |fffd|l|fffd||fffd|03-08(1) O|fffd||fffd|: |fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h
Public Const COL_03081_ORGAN_NAME       As Long = 16    ' |fffd|l|fffd||fffd|03-08(1) P|fffd||fffd|: |fffd||3d4|C|fffd||fffd||fffd|i|fffd|@|fffd||596||fffd||fffd|j
Public Const COL_03081_ORGAN_CHECK      As Long = 18    ' |fffd|l|fffd||fffd|03-08(1) R|fffd||fffd|: |fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F
Public Const COL_03081_START_DATE       As Long = 19    ' |fffd|l|fffd||fffd|03-08(1) S|fffd||fffd|: |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
Public Const COL_03081_END_DATE         As Long = 20    ' |fffd|l|fffd||fffd|03-08(1) T|fffd||fffd|: |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|

Public Const COL_03082_NO               As Long = 4     ' |fffd|l|fffd||fffd|03-08(2) D|fffd||fffd|: No
Public Const COL_03082_NUMBER           As Long = 5     ' |fffd|l|fffd||fffd|03-08(2) E|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
Public Const COL_03082_NAME             As Long = 6     ' |fffd|l|fffd||fffd|03-08(2) F|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
Public Const COL_03082_REQUEST          As Long = 7     ' |fffd|l|fffd||fffd|03-08(2) G|fffd||fffd|: |fffd|\|fffd||fffd||fffd||656a|
Public Const COL_03082_REG_STATUS       As Long = 8     ' |fffd|l|fffd||fffd|03-08(2) H|fffd||fffd|: |fffd|o|fffd|^|fffd||fffd|
Public Const COL_03082_DELEGATE         As Long = 9     ' |fffd|l|fffd||fffd|03-08(2) I|fffd||fffd|: |fffd||3d4|C|fffd||317|L|fffd||fffd|
Public Const COL_03082_ORGAN_CD         As Long = 10    ' |fffd|l|fffd||fffd|03-08(2) J|fffd||fffd|: |fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h
Public Const COL_03082_ORGAN_NAME       As Long = 11    ' |fffd|l|fffd||fffd|03-08(2) K|fffd||fffd|: |fffd||3d4|C|fffd||fffd|i|fffd|@|fffd||596||fffd||fffd|j

Public Const COL_03083_NO               As Long = 4     ' |fffd|l|fffd||fffd|03-08(3) D|fffd||fffd|: No
Public Const COL_03083_NUMBER           As Long = 5     ' |fffd|l|fffd||fffd|03-08(3) E|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
Public Const COL_03083_NAME             As Long = 6     ' |fffd|l|fffd||fffd|03-08(3) F|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
Public Const COL_03083_REQUEST          As Long = 7     ' |fffd|l|fffd||fffd|03-08(3) G|fffd||fffd|: |fffd|\|fffd||fffd||fffd||656a|
Public Const COL_03083_REG_STATUS       As Long = 8     ' |fffd|l|fffd||fffd|03-08(3) H|fffd||fffd|: |fffd|o|fffd|^|fffd||fffd|
Public Const COL_03083_BASIS_LAWS       As Long = 9     ' |fffd|l|fffd||fffd|03-08(3) I|fffd||fffd|: |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||fffd|
Public Const COL_03083_ARTICLE_NUM      As Long = 10    ' |fffd|l|fffd||fffd|03-08(3) J|fffd||fffd|: |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd||fffd||14d9||fffd||316||fffd||fffd||30b|y|fffd||44a|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd|
Public Const COL_03083_ATTACH           As Long = 11    ' |fffd|l|fffd||fffd|03-08(3) K|fffd||fffd|: |fffd|Y|fffd|t
Public Const COL_03083_ORGAN_CD         As Long = 12    ' |fffd|l|fffd||fffd|03-08(3) L|fffd||fffd|: |fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h
Public Const COL_03083_ORGAN_NAME       As Long = 13    ' |fffd|l|fffd||fffd|03-08(3) M|fffd||fffd|: |fffd||3d4|C|fffd||fffd||fffd|i|fffd|@|fffd||596||fffd||fffd|j
Public Const COL_03083_START_DATE       As Long = 14    ' |fffd|l|fffd||fffd|03-08(3) N|fffd||fffd|: |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
Public Const COL_03083_END_DATE         As Long = 15    ' |fffd|l|fffd||fffd|03-08(3) O|fffd||fffd|: |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|

' |fffd||fffd||fffd||fffd||fffd|}|fffd|X|fffd|^
''Public Const COL_A1_BIZ_CD              As Long = 1     ' A|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
''Public Const COL_A1_BIZ_NAME            As Long = 3     ' C|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd|
''Public Const COL_A1_NULLIFICATION_FLG   As Long = 7     ' G|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
''Public Const COL_A1_START_DTIME         As Long = 8     ' H|fffd||fffd|: |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
''Public Const COL_A1_END_DTIME           As Long = 9     ' I|fffd||fffd|: |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|
''Public Const COL_A1_LOGIC_DEL_FLG       As Long = 17    ' Q|fffd||fffd|: |fffd|_|fffd||fffd||fffd||d3dc||fffd|t|fffd||fffd||fffd|O
Public Const COL_A1_BIZ_CD              As Long = 1     ' A|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
Public Const COL_A1_BIZ_NAME            As Long = 2     ' B|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd|
Public Const COL_A1_START_DTIME         As Long = 3     ' C|fffd||fffd|: |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
Public Const COL_A1_END_DTIME           As Long = 4     ' D|fffd||fffd|: |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|
Public Const COL_A1_NULLIFICATION_FLG   As Long = 5     ' E|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
Public Const COL_A1_LOGIC_DEL_FLG       As Long = 6     ' F|fffd||fffd|: |fffd|_|fffd||fffd||fffd||d3dc||fffd|t|fffd||fffd||fffd|O

' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|}|fffd|X|fffd|^
''Public Const COL_A3_PERSON_INFO_NAME_CD As Long = 1     ' A|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h
''Public Const COL_A3_PERSON_INFO_NAME    As Long = 3     ' C|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
''Public Const COL_A3_NULLIFICATION_FLG   As Long = 5     ' E|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
''Public Const COL_A3_START_DTIME         As Long = 6     ' F|fffd||fffd|: |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
''Public Const COL_A3_END_DTIME           As Long = 7     ' G|fffd||fffd|: |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|
''Public Const COL_A3_LOGIC_DEL_FLG       As Long = 15    ' O|fffd||fffd|: |fffd|_|fffd||fffd||fffd||d3dc||fffd|t|fffd||fffd||fffd|O
Public Const COL_A3_PERSON_INFO_NAME_CD As Long = 1     ' A|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h
Public Const COL_A3_PERSON_INFO_NAME    As Long = 2     ' B|fffd||fffd|: |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
Public Const COL_A3_START_DTIME         As Long = 3     ' C|fffd||fffd|: |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
Public Const COL_A3_END_DTIME           As Long = 4     ' D|fffd||fffd|: |fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|
Public Const COL_A3_NULLIFICATION_FLG   As Long = 5     ' E|fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
Public Const COL_A3_LOGIC_DEL_FLG       As Long = 6     ' F|fffd||fffd|: |fffd|_|fffd||fffd||fffd||d3dc||fffd|t|fffd||fffd||fffd|O

' |fffd|s|fffd|R|fffd|s|fffd|[|fffd|E|fffd||d3dc||fffd|E|fffd||fffd||fffd|t|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||598|A
Public Const COPY_FLG_VALUE             As String = "1" ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd|l
Public Const COL_COPY_FLG               As Long = 29    ' AC|fffd||fffd|: |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
Public Const COL_CHK_START_DTIME        As Long = 30    ' AD|fffd||fffd|: |fffd|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|
Public Const COL_CHK_END_DTIME          As Long = 31    ' AE|fffd||fffd|: |fffd|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|
'ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc|(|fffd|C|fffd||fffd|) |fffd||6d1||fffd|35|fffd||389||fffd| 20190613 start ------------------------------------
Public Const COL_LAW_OBLIGATION_FLG     As Integer = 32 ' AF|fffd||fffd|: |fffd||4b7cb|`|fffd||fffd|
'ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc|(|fffd|C|fffd||fffd|) |fffd||6d1||fffd|35|fffd||389||fffd| 20190613 end --------------------------------------

' ================================================================================
' |fffd|s|fffd|f|fffd|[|fffd|^|fffd|E|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||752||8576||fffd||fffd||fffd||fffd||8414|
' ================================================================================
Public Const STATUS_OK              As String = "|fffd||fffd|"
Public Const STATUS_CHANGE          As String = "|fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|"
Public Const STATUS_NG              As String = "|fffd|~"
Public Const STATUS_BLANK           As String = "|fffd|@"

Public Const STS_OK_NUM             As Integer = 1  ' "|fffd||fffd|"
Public Const STS_CNG_NUM            As Integer = 2  ' "|fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|"
Public Const STS_NG_NUM             As Integer = 4  ' "|fffd|~"
Public Const STS_BLK_NUM            As Integer = 8  ' "|fffd|@"
Public Const STS_ERR_NUM            As Integer = 16 ' |fffd||fffd||fffd|z|fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|

Public Const REQUEST_ENTRY          As String = "|fffd|o|fffd|^"
Public Const REQUEST_UPDATE         As String = "|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X"
Public Const REQUEST_DELETE         As String = "|fffd||d3dc|"

Public Const DATA_REGISTERED        As String = "|fffd|o|fffd|^|fffd||fffd|"
Public Const DATA_UNREGISTERED      As String = "|fffd||fffd||fffd|o|fffd|^"

Public Const PIA_OK                 As String = "|fffd||fffd||fffd|{|fffd||3c2||fffd|"
Public Const PIA_NO_OBLIGATION      As String = "|fffd|@|fffd||7cf||fffd||fffd||fffd|{|fffd|`|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|"
Public Const PIA_PLANS              As String = "|fffd||fffd||fffd|{|fffd|\|fffd||fffd|"

Public Const EVAL_PLACE_1           As String = "|fffd|@|fffd|]|fffd||fffd||fffd||fffd|Web|fffd||24c|f|fffd||fffd|"
Public Const EVAL_PLACE_2           As String = "|fffd|A|fffd||fffd||fffd|c|fffd||302||fffd|HP|fffd||24c|f|fffd||fffd|"
Public Const EVAL_PLACE_3           As String = "|fffd|B|fffd||fffd||fffd||242||fffd||fffd|f|fffd||fffd||fffd||fffd|"

Public Const CHECK_OK               As String = "|fffd||fffd|"
Public Const CHECK_ALREADY          As String = "|fffd||fffd|"
Public Const NONE_VALUE             As String = "|fffd||"

' ================================================================================
' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||8414|
' ================================================================================
Public Const ERR_MSG_NOT_IMPLEMENT      As String = "|fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|{"
Public Const ERR_MSG_NONE               As String = "|fffd|G|fffd||fffd||fffd|[|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 start ---------------------------------------------
Public Const ERR_MSG_INVALID_DATA_REQUEST       As String = "|fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|v|fffd||313||fffd||fffd|e|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B"
'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|NNo.39|fffd||389||fffd| 20171108 end ---------------------------------------------

' |fffd|l|fffd||fffd|03-07
Public Const ERR_MSG_PIA_NONE           As String = "|fffd|uPIA|fffd||30e||fffd||fffd|{|fffd||cbd41|v|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B"
Public Const ERR_MSG_EVAL_NUM           As String = "|fffd|u|fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const ERR_MSG_EVAL_NAME          As String = "|fffd|u|fffd|]|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const ERR_MSG_EVAL_PLACE         As String = "|fffd|u|fffd|]|fffd||fffd||fffd||fffd||fffd||30c|f|fffd||68f||a3ca||fffd|v|fffd||fffd||fffd|I|fffd||fffd|"
Public Const ERR_MSG_NO_EVAL            As String = "|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B"
Public Const ERR_MSG_EXIST_EVAL         As String = "|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd|{|fffd|`|fffd||fffd||fffd||342||202||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||2361||fffd||fffd||fffd||fffd|{|fffd|\|fffd||fffd||142||fffd||fffd||fffd||a347||fffd||341|A|fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||353||fffd||fffd||342||fffd||fffd||202||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"

' |fffd|l|fffd||fffd|03-08
Public Const ERR_MSG_NO_BASIS           As String = "|fffd|u|fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||7c1|v|fffd|A|fffd|u|fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd||fffd||14d9||fffd||316||fffd||fffd||30b|y|fffd||44a|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd|v|fffd||317||fffd||fffd||fffd||fffd||fffd||fffd||d4482||142||fffd||fffd|B"
Public Const ERR_MSG_NO_ATTACH          As String = "|fffd|u|fffd|Y|fffd|t|fffd|v|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||142||fffd||fffd|B"
Public Const ERR_MSG_ORGAN_CD_BLANK     As String = "|fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||d4482||142||fffd||fffd|B"
'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 start --------------------------------------------------
Public Const ERR_MSG_ORGAN_CD_F_NOVALID   As String = "|fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||250|\|fffd||fffd||fffd||482||30b|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
Public Const ERR_MSG_ORGAN_CD_T_NOVALID   As String = "|fffd|u|fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||250|\|fffd||fffd||fffd||482||30b|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
'ADD |fffd||fffd||fffd||352|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 20171211 end --------------------------------------------------
Public Const ERR_MSG_ORGAN_NAME_BLANK   As String = "|fffd|u|fffd||3d4|C|fffd||fffd||fffd|v|fffd||fffd||fffd||d4482||142||fffd||fffd|B"
Public Const ERR_MSG_ORGAN_CHECK        As String = "|fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|v|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B"
Public Const ERR_MSG_START_D_BLANK      As String = "|fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||d4482||142||fffd||fffd|B"
Public Const ERR_MSG_START_D_OUTRANGE   As String = "|fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||38f||6ce||fffd||fffd||fffd||fffd||8471||fffd||fffd||fffd||302||314||348||34a|O|fffd||142||fffd||fffd|B"
Public Const ERR_MSG_START_D_OUTRANGE2  As String = "|fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||4ea51||302||314||348||34a|O|fffd||142||fffd||fffd|B"
'ADD |fffd||6d1||fffd|28 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||354||fffd||fffd||fffd||389||fffd| 20190524 start --------------------------------------------------
Public Const ERR_MSG_START_D_OUTRANGE3  As String = "|fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd||fffd|}|fffd|X|fffd|^|fffd|[|fffd||313|K|fffd|p|fffd||fffd||fffd||fffd||fffd|O|fffd||182||202||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
'ADD |fffd||6d1||fffd|28 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||354||fffd||fffd||fffd||389||fffd| 20190524 end ----------------------------------------------------
Public Const ERR_MSG_REQUEST            As String = "|fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|v|fffd||30e|w|fffd||80aa||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B"
Public Const ERR_MSG_END_D_BLANK        As String = "|fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||d4482||142||fffd||fffd|B"
Public Const ERR_MSG_END_D_OUTRANGE     As String = "|fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||38f||6ce||fffd||fffd||fffd||fffd||8471||fffd||fffd||fffd||302||314||348||34a|O|fffd||142||fffd||fffd|B"
Public Const ERR_MSG_END_D_OUTRANGE2    As String = "|fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||4ea51||302||314||348||34a|O|fffd||142||fffd||fffd|B"
Public Const ERR_MSG_END_D_REVERSE      As String = "|fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||211|O|fffd||182||202||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
'Public Const ERR_MSG_NO_ACCEPT_BIZ      As String = "|fffd||fffd||fffd||a396||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||101|A|fffd|u|fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||242|P|fffd||fffd||fffd||20f||fffd||301||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
Public Const ERR_MSG_NO_ACCEPT_BIZ      As String = "|fffd|u|fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||142||fffd||fffd|B"    'ADD |fffd||6d1||fffd|41|fffd||389||fffd| 20171101
Public Const ERR_MSG_ACCEPT_BIZ         As String = "|fffd|u|fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B"      'ADD |fffd||6d1||fffd|41|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171207
Public Const ERR_MSG_ENTRY_NOVALID      As String = "|fffd||3cd|X|fffd||fffd||fffd||241|u|fffd||fffd||fffd|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||311||38f||6ce||fffd||fffd||fffd||fffd||8471||fffd||253|o|fffd|^|fffd||38f||6c2||fffd||fffd|P|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
Public Const ERR_MSG_UPDATE_NOVALID     As String = "|fffd||3cd|X|fffd||fffd||fffd||241|u|fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||311||38f||6ce||fffd||fffd||fffd||fffd||8471||fffd||fffd||fffd||fffd||fffd||5c2||10d||d3dc||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"

' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
Public Const ERR_MSG_UPDATE_NOVALID2    As String = "|fffd||3cd|X|fffd||fffd||fffd||241|u|fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||5c2||10d||d3dc||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbLf & _
                                                       "|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|u|fffd|~|fffd|v|fffd||255||3cd|X|fffd||fffd||fffd|A|fffd||fffd||fffd||202||152||4b7c2||fffd||fffd|s|fffd||fffd||fffd||60a4||fffd||24f|C|fffd||fffd||fffd||fffd||fffd|A" & vbLf & _
                                                       "|fffd||113|x|fffd|u|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||150|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||10d||c42c||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B"
Public Const ERR_MSG_CHANGE_SHEET       As String = "|fffd|\|fffd||fffd||fffd||fffd||fffd||10d90||fffd||fffd||fffd||250|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|V|fffd|[|fffd|g|fffd||313||fffd||fffd|e|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbLf & _
                                                       "|fffd||113|x|fffd|u|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||150|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||10d||c42c||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B"
' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----

Public Const ERR_MSG_ORGAN_CD_BLANK2    As String = "|fffd|u|fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||d4482||142||fffd||fffd|B"
Public Const ERR_MSG_ORGAN_NAME_BLANK2  As String = "|fffd|u|fffd||3d4|C|fffd||fffd|v|fffd||fffd||fffd||d4482||142||fffd||fffd|B"

' ================================================================================
' |fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_
' ================================================================================
Public Const ATTACH_DIR_NAME            As String = "|fffd|Y|fffd|t|fffd||fffd||fffd||fffd|"
Public Const ATTACH_DIR_NAME_ININ       As String = "|fffd||3d4|C|fffd||fffd|C|fffd||30d||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const ATTACH_DIR_NAME_PIA        As String = "PIA|fffd|]|fffd||fffd||fffd||fffd|"


'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
Public Const STR_BASE_DATE_END          As String = "2099/1/1"
'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------


' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 start -----
Public gCheckErrFlg                     As String
Public Const FLG_CHECK_OK               As String = "0"
Public Const FLG_CHECK_NG               As String = "1"
Public Const ERR_NONE                   As String = "0"
Public Const ERR_EXIST                  As String = "1"

' ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc||fffd||389||fffd| 2018.9 end   -----

Attribute VB_Name = "FileOperation"
Option Explicit

Const ARC_WAIT_TIME As Integer = 600

Private fso         As Object

' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|k|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|p|fffd|X|fffd||303|t|fffd|@|fffd|C|fffd||fffd|/|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|w|fffd||fffd||303|p|fffd|X|fffd||fffd|zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||182||fffd||fffd||108||fffd||fffd|k|fffd||c42c||fffd||fffd||fffd||fffd|B

' |fffd||fffd|Microsoft|fffd||142||341|ACopyHere|fffd||fffd||fffd|\|fffd|b|fffd|h|fffd||30e|g|fffd|p|fffd||343|T|fffd|||fffd|[|fffd|g|fffd||38f||6ca|O|fffd||302||fffd||fffd||7c1|A|fffd|s|fffd||f347||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
'   |fffd|O|fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd||30e|g|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd||348||fffd||fffd|k|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||30c||fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|v
'   https://support.microsoft.com/ja-jp/help/2679832
Public Function createZipFile(ByRef fileArray() As String, ByVal zipPath As String, ByRef errMsg As String)

    Dim app         As Object
    Dim zipFile     As Object

    Dim dateStart   As Date
    Dim lngCnt      As Long
    Dim varFile     As Variant
    Dim strPath     As String
    Dim blnArc      As Boolean
    Dim blnFncRet   As Boolean

On Error GoTo ERR_HND

    blnFncRet = False
    errMsg = ""
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set app = CreateObject("Shell.Application")
    
    
    ' |fffd||c42c||fffd||38f||6c2||fffd|zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||251||fffd||fffd||742||fffd||fffd||fffd||a347||fffd|A|fffd||d3dc||fffd||fffd||fffd||fffd|
    If fso.FileExists(zipPath) = True Then
        fso.DeleteFile zipPath
    End If
    
    ' |fffd||fffd||fffd|zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c|
    With fso.CreateTextFile(zipPath, True)
        .Write "PK" & Chr(5) & Chr(6) & String(18, 0)
        .Close
    End With
    Set zipFile = app.Namespace(fso.GetAbsolutePathName(zipPath))

    ' |fffd||c42c||fffd||fffd||fffd||fffd|zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||251||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|[
    lngCnt = 0
    For Each varFile In fileArray
        
        ' |fffd||fffd||fffd||fffd||fffd||fffd|wait|fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||181|A|fffd||202||fffd||fffd||fffd||fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|A|fffd||1c2||74e||fffd||fffd||303|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|v|fffd||fffd||fffd||142||fffd|
        ' |fffd||fffd||fffd||fffd|wait|fffd||fffd||fffd||fffd||fffd||90a9||fffd|A|fffd|f|fffd|o|fffd|b|fffd|O|fffd||14d|s|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||348||a25e||fffd||fffd||fffd||202||fffd|
        Application.Wait (Now() + TimeValue("0:00:01"))
        strPath = fso.GetAbsolutePathName(varFile)
            
        ' |fffd||fffd||fffd|k|fffd||fffd||fffd||fffd|
        blnArc = False
        If isFolder(strPath) = True Then
            ' |fffd||38f||6c2||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||30f||a347|
            blnArc = chkFileExistInFolder(strPath)
        Else
            ' |fffd||38f||6c2||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f||a347|
            If Dir(strPath) <> "" Then
                blnArc = True
            End If
        End If
            
        If blnArc = True Then
            zipFile.CopyHere (strPath)
            lngCnt = lngCnt + 1
        End If
    Next
            
    ' |fffd|R|fffd|s|fffd|[|fffd|I|fffd||fffd||fffd||702||151||482||81|B(|fffd|w|fffd||fffd|b|fffd||fffd||fffd||7c2||143|G|fffd||fffd||fffd|[|fffd|j
    dateStart = Now
    Do Until zipFile.items().Count = lngCnt
        If DateDiff("s", dateStart, Now) > ARC_WAIT_TIME Then
            errMsg = "|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            GoTo FUNC_END
        End If
        Application.Wait (Now() + TimeValue("0:00:01"))
    Loop
    
    ' |fffd||fffd||fffd|k|fffd||fffd||fffd||fffd|I|fffd||fffd|
    blnFncRet = True

FUNC_END:
    
    ' |fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||309||fffd||fffd|
    Set fso = Nothing
    Set app = Nothing
    
    ' |fffd||7c2||fffd|l|fffd||310||752||fffd|
    createZipFile = blnFncRet
    
    Exit Function

ERR_HND:
    errMsg = "|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & Err.Description
    GoTo FUNC_END

End Function

' |fffd|w|fffd||fffd||303|p|fffd|X|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||142||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
Public Function isFolder(path As String) As Boolean
    isFolder = CreateObject("Scripting.FileSystemObject").FolderExists(path)
End Function

' |fffd|w|fffd||fffd||303|p|fffd|X|fffd||fffd|"\"|fffd||fffd|t|fffd|^|fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||20a|O|fffd|j
Public Function addFolSepStr(folderPath As String) As String
    addFolSepStr = folderPath & IIf(Right(folderPath, 1) <> "\", "\", "")
End Function

' |fffd|w|fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|P|fffd||20f||3476||fffd||742||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|B
Public Function chkFileExistInFolder(folderPath As String) As Boolean

    Dim result  As Boolean
    Dim folder  As Object
    
    ' |fffd||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = False
    
    If fso.GetFolder(folderPath).files.Count > 0 Then
        ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|true
        result = True
    Else
        ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||381|A|fffd|z|fffd||fffd||fffd||303|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||10b|A|fffd|I|fffd||243|`|fffd|F|fffd|b|fffd|N
        For Each folder In fso.GetFolder(folderPath).SubFolders
            result = chkFileExistInFolder(folder.path)
            If result = True Then
                Exit For
            End If
        Next
    End If
    
    chkFileExistInFolder = result

End Function
Attribute VB_Name = "Module1"
Option Explicit

Public Const TOOL_LOCK_PWD      As String = "MLz6gcL0"
Public Const OUT_XLS_SHEET_PWD  As String = "ZaR5WraNucr3"
Public Const OUT_XLS_NAME_BODY  As String = "(03-07|fffd||fffd|03-08)|fffd||3cd|X|fffd|\|fffd||fffd||fffd||fffd|"

' |fffd|{|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||42f83|t|fffd|@|fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub Auto_Open()
    
    Dim targetDir       As String
    Dim execFlg         As Boolean

    ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|F|fffd|u|fffd|\|fffd||fffd||fffd||fffd||fffd|v|fffd||182||fffd||fffd||10d||c42c||fffd||fffd||fffd||a0bd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||142||34e||fffd||fffd|{|fffd||fffd||fffd||202||fffd|
    If (InStr(ThisWorkbook.Name, OUT_XLS_NAME_BODY) = 0) Then
    
        execFlg = False
        
        ' |fffd|Y|fffd|t|fffd||fffd||fffd||fffd|
        targetDir = addFolSepStr(ThisWorkbook.path) & ATTACH_DIR_NAME
        If Dir(targetDir, vbDirectory) = "" Then
            MkDir targetDir
            execFlg = True
        End If
            
        ' |fffd||3d4|C|fffd||fffd|C|fffd||30d||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        targetDir = addFolSepStr(ThisWorkbook.path) & ATTACH_DIR_NAME & "\" & ATTACH_DIR_NAME_ININ
        If Dir(targetDir, vbDirectory) = "" Then
            MkDir targetDir
            execFlg = True
        End If
            
        ' |fffd||3d4|C|fffd||fffd|C|fffd||30d||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        targetDir = addFolSepStr(ThisWorkbook.path) & ATTACH_DIR_NAME & "\" & ATTACH_DIR_NAME_PIA
        If Dir(targetDir, vbDirectory) = "" Then
            MkDir targetDir
            execFlg = True
        End If
            
        If execFlg = True Then
            MsgBox "|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||c42c||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd||3d4|C|fffd||fffd|C|fffd||30d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||441|APIA|fffd|]|fffd||fffd||fffd||fffd||fffd||353|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||254|z|fffd|u|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly + vbInformation
        End If
    
    End If

End Sub

Public Sub execRowLock(ByVal sheet As Excel.Worksheet, ByVal Target As Range)

    Select Case Target.Value
        Case REQUEST_ENTRY
            Call execRowLockEntry(sheet, Target)
        
        Case REQUEST_UPDATE
            Call execRowLockUpdate(sheet, Target)
        
        Case REQUEST_DELETE
            Call execRowLockDelete(sheet, Target)
        
        Case NONE_VALUE
            Call execRowLockNone(sheet, Target)
    
    End Select

End Sub

' |fffd|\|fffd||fffd||fffd||656a|[|fffd|o|fffd|^]|fffd||fffd||fffd||30d|s|fffd||fffd||fffd|b|fffd|N
Private Sub execRowLockEntry(ByVal sheet As Excel.Worksheet, ByVal Target As Range)
    
    Dim maxCol      As Long
    
    ' |fffd||14f|I|fffd||fffd||30e||64fe|
    maxCol = sheet.Cells(DATA_TITLE_ROW_NUM, sheet.Columns.Count).End(xlToLeft).Column
    
    ' |fffd||151||fffd||348||342||303||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call cellRock(sheet, Target.Row, Target.Column + 2, Target.Row, maxCol, False)
    
    ' |fffd|l|fffd||fffd||fffd||fffd||fffd||30c||95||290||fffd||fffd||fffd|
    Select Case sheet.Name
        Case "|fffd|l03-08_1"
            Call cellRock(sheet, Target.Row, COL_03081_ORGAN_CD, Target.Row, COL_03081_ORGAN_NAME, True)
        Case "|fffd|l03-08_2"
            sheet.Cells(Target.Row, COL_03082_DELEGATE).Value = CHECK_OK
            Call cellRock(sheet, Target.Row, COL_03082_DELEGATE, Target.Row, COL_03082_DELEGATE, True)
            Call cellRock(sheet, Target.Row, COL_03082_ORGAN_CD, Target.Row, COL_03082_ORGAN_NAME, True)
        Case "|fffd|l03-08_3"
            Call cellRock(sheet, Target.Row, COL_03083_ORGAN_CD, Target.Row, COL_03083_ORGAN_NAME, True)
    End Select
    
End Sub

' |fffd|\|fffd||fffd||fffd||656a|[|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X]|fffd||fffd||fffd||30d|s|fffd||fffd||fffd|b|fffd|N
Private Sub execRowLockUpdate(ByVal sheet As Excel.Worksheet, ByVal Target As Range)
    
    Dim maxCol      As Long
    
    ' |fffd||14f|I|fffd||fffd||30e||64fe|
    maxCol = sheet.Cells(DATA_TITLE_ROW_NUM, sheet.Columns.Count).End(xlToLeft).Column
    
    ' |fffd||151||fffd||348||342||303||fffd||fffd|b|fffd|N
    Call cellRock(sheet, Target.Row, Target.Column + 2, Target.Row, maxCol, True)
    
    ' |fffd|l|fffd||fffd||fffd||fffd||fffd||30c||95||290||fffd||fffd||fffd|
    Select Case sheet.Name
        Case "|fffd|l03-08_1"
            ' L|fffd||fffd|u|fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||7c1|v|fffd|`N|fffd||fffd|u|fffd|Y|fffd|t|fffd|v|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
            Call cellRock(sheet, Target.Row, COL_03081_BASIS_LAWS, Target.Row, COL_03081_ATTACH, False)
            ' ADD |fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X|fffd|v|fffd||308||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 2018.8 start -----
            ' R|fffd||fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|v|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
            Call cellRock(sheet, Target.Row, COL_03081_ORGAN_CHECK, Target.Row, COL_03081_ORGAN_CHECK, False)
            ' ADD |fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|@|fffd||7d3||fffd||fffd||315||3cd|X|fffd|v|fffd||308||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||1c9||fffd||fffd||389||fffd| 2018.8 end   -----
        Case "|fffd|l03-08_3"
            ' I|fffd||fffd|u|fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||7c1|v|fffd|`K|fffd||fffd|u|fffd|Y|fffd|t|fffd|v|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
            Call cellRock(sheet, Target.Row, COL_03083_BASIS_LAWS, Target.Row, COL_03083_ATTACH, False)
    End Select
    
End Sub

' |fffd|\|fffd||fffd||fffd||656a|[|fffd||d3dc|]|fffd||fffd||fffd||30d|s|fffd||fffd||fffd|b|fffd|N
Private Sub execRowLockDelete(ByVal sheet As Excel.Worksheet, ByVal Target As Range)
    
    Dim maxCol      As Long
    
    ' |fffd||14f|I|fffd||fffd||30e||64fe|
    maxCol = sheet.Cells(DATA_TITLE_ROW_NUM, sheet.Columns.Count).End(xlToLeft).Column
    
    ' |fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    Call cellRock(sheet, Target.Row, Target.Column + 2, Target.Row, maxCol, True)
    
    ' |fffd|l|fffd||fffd||fffd||fffd||fffd||30c||95||290||fffd||fffd||fffd|
    Select Case sheet.Name
        Case "|fffd|l03-08_1"
            ' R|fffd||fffd|u|fffd||3d4|C|fffd||fffd||fffd|@|fffd||582||242||fffd||fffd|m|fffd|F|fffd|v|fffd|AT|fffd||fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
            Call cellRock(sheet, Target.Row, COL_03081_ORGAN_CHECK, Target.Row, COL_03081_ORGAN_CHECK, False)
            Call cellRock(sheet, Target.Row, COL_03081_END_DATE, Target.Row, COL_03081_END_DATE, False)
        Case "|fffd|l03-08_3"
            ' O|fffd||fffd|u|fffd|L|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
            Call cellRock(sheet, Target.Row, COL_03083_END_DATE, Target.Row, COL_03083_END_DATE, False)
    End Select
    
End Sub

' |fffd|\|fffd||fffd||fffd||656a|[|fffd||]|fffd||fffd||fffd||30d|s|fffd||fffd||fffd|b|fffd|N
Private Sub execRowLockNone(ByVal sheet As Excel.Worksheet, ByVal Target As Range)
    
    Dim maxCol      As Long
    
    ' |fffd||14f|I|fffd||fffd||30e||64fe|
    maxCol = sheet.Cells(DATA_TITLE_ROW_NUM, sheet.Columns.Count).End(xlToLeft).Column
    
    ' |fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    Call cellRock(sheet, Target.Row, Target.Column + 2, Target.Row, maxCol, True)
    
End Sub

' |fffd|w|fffd||fffd|V|fffd|[|fffd|g|fffd|A|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||303||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
Public Sub cellRock(ByVal sheet As Worksheet, _
                    ByVal row_s As Long, _
                    ByVal col_s As Long, _
                    ByVal row_e As Long, _
                    ByVal col_e As Long, _
                    ByVal lockFlg As Boolean)
    
    Dim loopR       As Long
    Dim loopC       As Long
    Dim mergeCnt    As Long
    
    ' |fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd|w|fffd||fffd|
    mergeCnt = 0
    For loopC = col_s To col_e
    
        ' 10|fffd|s|fffd||681|i|fffd||fffd||fffd||696||fffd||fffd|\|fffd||fffd||fffd|s|fffd|j|fffd||311||38f||6d7||fffd||fffd||fffd||fffd||fffd||243|}|fffd|[|fffd|W|fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|
        ' |fffd||fffd||fffd|c|fffd|i|fffd|s|fffd|j|fffd||303|}|fffd|[|fffd|W|fffd||342||202||fffd||fffd||182||fffd||fffd||fffd||fffd|O|fffd||fffd|
        If sheet.Cells(DATA_TITLE_ROW_NUM, loopC).MergeCells = True Then
            mergeCnt = mergeCnt + 1
        Else
            mergeCnt = 0
        End If

        ' |fffd|}|fffd|[|fffd|W|fffd|Z|fffd||fffd||fffd||142||342||202||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||341|A|fffd|}|fffd|[|fffd|W|fffd|Z|fffd||fffd||fffd||310||64ea||fffd||302||74f||fffd||fffd||fffd||fffd||fffd||fffd|s
        Select Case mergeCnt
            Case 0
                sheet.Range(sheet.Cells(row_s, loopC), sheet.Cells(row_e, loopC)).Locked = lockFlg
                
            Case 1
                For loopR = row_s To row_e
                    sheet.Range(sheet.Cells(loopR, loopC).Address).MergeArea.Locked = lockFlg
                Next loopR
        End Select
    
    Next loopC

End Sub

' |fffd|e|fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||308||fffd||fffd||fffd||348||342||fffd||fffd|w|fffd||80b7||fffd||fffd|B
Public Sub setSheetPreviewArea(ByVal sheet As Worksheet)

    Dim pRowEnd As Long
    Dim pColEnd As Long

    ' |fffd||fffd||fffd||fffd||348||342||30d||14f|I|fffd|s|fffd|E|fffd||fffd||30e||64fe|
    pRowEnd = sheet.Cells(sheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row + 2
    pColEnd = sheet.Cells(DATA_TITLE_ROW_NUM, sheet.Columns.Count).End(xlToLeft).Column + 1

    ' |fffd||fffd||fffd||fffd||348||350||752||fffd|
    sheet.PageSetup.PrintArea = sheet.Range(sheet.Cells(3, 3), sheet.Cells(pRowEnd, pColEnd)).Address

End Sub

' |fffd||fffd||fffd||85da||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|A|fffd||e3c0||fffd||fffd|or|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getRirekiData(Optional ByVal getVersion As Boolean = False) As String
    
    Dim getCol  As Long
    Dim getRow  As Long
    
    ' |fffd||64fe||fffd|J|fffd||fffd||fffd||fffd||fffd||30a|m|fffd||fffd|
    getCol = IIf(getVersion = True, 3, 4)
    
    With ThisWorkbook.Sheets("|fffd||fffd||fffd||85da||fffd||fffd|")
        getRow = .Cells(.Rows.Count, 1).End(xlUp).Row
        getRirekiData = .Cells(getRow, getCol).Value
    End With

End Function
'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
''ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
'' |fffd||fffd||fffd||85da||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|A|fffd|O|fffd||fffd||30a||e3c0||fffd||fffd|or|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
'Public Function getPreRirekiData(Optional ByVal getVersion As Boolean = False) As String
'
'    Dim getBDCol    As Long '|fffd||e3c0||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|
'    Dim getCol      As Long
'    Dim getEndRow   As Long
'    Dim getRow      As Long
'    Dim strNewRirekiData    As String
'
'    getPreRirekiData = ""
'    strNewRirekiData = ""
'
'    '|fffd||e3c0||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|
'    getBDCol = 4
'
'    ' |fffd||64fe||fffd|J|fffd||fffd||fffd||fffd||fffd||30a|m|fffd||fffd|
'    getCol = IIf(getVersion = True, 3, 4)
'
'    With ThisWorkbook.Sheets("|fffd||fffd||fffd||85da||fffd||fffd|")
'
'        '|fffd||fffd||fffd||fffd||fffd||14f|I|fffd|s
'        getEndRow = .Cells(.Rows.Count, 1).End(xlUp).Row
'        '|fffd||150|V|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd|
'        strNewRirekiData = .Cells(getEndRow, getBDCol).Value
'
'        '|fffd||14f|I|fffd|s|fffd||fffd||fffd||fffd|J|fffd|n|fffd|s|fffd||702||143||fffd||fffd|[|fffd|v
'        getRow = 0
'        For getRow = getEndRow To 4 Step -1
'
'            If strNewRirekiData <> .Cells(getRow, getCol).Value Then
'                '|fffd||150|V|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd||fffd||188||642||202||fffd||a347||fffd|A|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd|i|fffd||702||fffd||fffd||342||fffd||fffd||30e||fffd||fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|No|fffd|j|fffd||182||fffd||fffd||fffd|
'                getPreRirekiData = .Cells(getRow, getCol).Value
'
'                Exit Function
'            End If
'
'        Next
'
'    End With
'
'End Function
''ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||309||fffd||fffd|
Public Sub closeRecordset(ByRef rs As ADODB.Recordset)

    If (rs Is Nothing) = False Then
        If rs.State <> adStateClosed Then rs.Close
        Set rs = Nothing
    End If

End Sub

' |fffd|`|fffd||64d9||fffd|}|fffd|~|fffd||752||fffd|
Public Sub setDrawControl(Optional ByVal enableFlg As Boolean = False)

    If enableFlg = False Then
        ' |fffd|}|fffd|~
        Application.Cursor = xlWait
        Application.ScreenUpdating = False
        Application.Calculation = xlCalculationManual
        Application.EnableEvents = False
        Application.DisplayAlerts = False
    Else
        ' |fffd|}|fffd|~|fffd||fffd||fffd||fffd|
        Application.DisplayAlerts = True
        Application.EnableEvents = True
        Application.Calculation = xlCalculationAutomatic
        Application.ScreenUpdating = True
        Application.Cursor = xlDefault
    End If

End Sub

' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||c0aa||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|

' |fffd||7c2||fffd|l  |fffd|F|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Atrue|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||182||fffd||fffd||195||6cc||fffd||202||fffd||fffd|j|fffd||30f||a347||fffd|Afalse

Public Function unprotectWorkSheet(ByVal sheet As Worksheet, Optional ByVal pwStr As String = "") As Boolean

    Dim result      As Boolean
    Dim pw          As String

    result = sheet.ProtectContents

    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||c0a0||fffd||839e||fffd|A|fffd||fffd||fffd||fffd|
    If result = True Then
        If pwStr = "" Then
            pw = IIf(InStr(ThisWorkbook.Name, OUT_XLS_NAME_BODY), OUT_XLS_SHEET_PWD, TOOL_LOCK_PWD)
        Else
            pw = pwStr
        End If
        sheet.Unprotect Password:=pw
    End If

    unprotectWorkSheet = result

End Function

' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||752||fffd|
Public Sub protectWorkSheet(ByVal sheet As Worksheet, Optional ByVal pwStr As String = "")
    
    Dim pw          As String

    If pwStr = "" Then
        pw = IIf(InStr(ThisWorkbook.Name, OUT_XLS_NAME_BODY) > 0, OUT_XLS_SHEET_PWD, TOOL_LOCK_PWD)
    Else
        pw = pwStr
    End If
    
    sheet.protect AllowFormattingColumns:=True, _
                AllowFiltering:=True, _
                UserInterfaceOnly:=True, _
                Password:=pw

End Sub

' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Sub createConnection(ByRef conn As ADODB.Connection)

    Set conn = New ADODB.Connection
    conn.Provider = "MSDASQL"
    conn.ConnectionString = "Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};" & "DBQ=" & ThisWorkbook.FullName & "; ReadOnly = False;"
    conn.Open

End Sub

' ====================================================================================================
' |fffd||590||fffd||fffd||fffd||fffd|@|fffd|FgetOrganList
'         |fffd|F
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|F|fffd|@|fffd||583|}|fffd|X|fffd|^|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|@|fffd||596||fffd||fffd|E|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'         |fffd|F
' |fffd||fffd||fffd||fffd|    |fffd|F1.|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd|
'         |fffd|F2.|fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd|i|fffd|C|fffd||4ce|w|fffd||fffd|j
'         |fffd|F
' |fffd||fffd||fffd|l    |fffd|F1|fffd||309||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
' ====================================================================================================

Public Function getOrganList(ByRef organDic As Object, Optional ByVal searchWord As String = "") As Boolean
    
    Dim localConn           As ADODB.Connection
    Dim rsOrgan             As ADODB.Recordset
    Dim sql                 As String
    Dim sql_tbl             As String
    Dim organ_cd_before     As String
    Dim organ_cd            As String
    Dim organ_name          As String
    Dim noChkFlg            As Boolean
    Dim loopC               As Long
    Dim baseDate            As Date


On Error GoTo ERR_HND

    ' |fffd|l|fffd||50b|p|fffd|p|fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd||fffd||310||fffd||fffd||fffd|
    Set organDic = CreateObject("Scripting.Dictionary")
    
    ' |fffd|@|fffd||596||fffd||fffd||fffd||fffd|o|fffd|pSQL|fffd||fffd||fffd||fffd|
    sql_tbl = "SELECT organ_cd, organ_name, valid_start_dtime, valid_end_dtime, "
    sql_tbl = sql_tbl & "IIf(Left(existing_id_cd, 1) = '2', 1, IIf(Left(existing_id_cd,1) = '1', 2, IIf(organ_group_cd = '07', 2, 3))) AS SORT1, "
    sql_tbl = sql_tbl & "Mid(organ_cd, 6, 5) AS SORT2, organ_group_cd AS SORT3, Mid(organ_cd, 4, 2) AS SORT4, Mid(organ_cd, 11, 6) AS SORT5 "
    sql_tbl = sql_tbl & "FROM [organ_mst$] "
    sql_tbl = sql_tbl & "WHERE (Mid(organ_cd, 7, 3) <> '999') AND (nullification_flg = '0') AND (logic_del_flg = '0') AND (organ_name Not Like '%|fffd||fffd||fffd||fffd|%|fffd|i|fffd|Z|fffd||fffd||fffd|j%') "

    If Len(searchWord) > 0 Then
        sql_tbl = sql_tbl & " AND (organ_name Like '%" & searchWord & "%') "
    End If

    sql = "SELECT * FROM (" & sql_tbl & ") WHERE SORT1 <> 3 ORDER BY SORT1, SORT2, SORT3, SORT4, SORT5, valid_start_dtime"

    ' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call createConnection(localConn)

    ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Set rsOrgan = New ADODB.Recordset
    rsOrgan.Open sql, localConn, adOpenStatic

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||281|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If CLng(rsOrgan.RecordCount) = 0 Then
        
        ' |fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||309||fffd||fffd|
        Call closeRecordset(rsOrgan)
        Set localConn = Nothing
        
        ' |fffd||590||fffd||fffd||313||fffd||fffd||fffd||182||fffd||fffd||102||350||fffd||fffd||fffd|I|fffd||fffd|
        getOrganList = True
        Exit Function
    End If

    ' |fffd||e3c0||fffd||fffd||fffd||64fe|
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
    '|fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd||64fe|
    baseDate = CDate(getRirekiData())
'    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
'    '|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||64fe|
'    baseDate = CDate(getPreRirekiData())
''    baseDate = CDate(getRirekiData())
'    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
    ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|E|fffd|@|fffd||596||fffd||fffd||fffd||fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd||fffd||24a|i|fffd|[
    ' |fffd|L|fffd||fffd||fffd||fffd||fffd||513||fffd||fffd||303||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||382||fffd||fffd||316||fffd||fffd||302||fffd||fffd|A|fffd||202||fffd||fffd||fffd||38d||150|V|fffd||303||fffd||fffd|R|fffd|[|fffd|h|fffd||316||fffd||fffd||302||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    organ_cd_before = rsOrgan.Fields("organ_cd").Value
    organ_cd = ""
    noChkFlg = False

    Do Until rsOrgan.EOF
        
        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||30e||64fe|
        organ_cd = rsOrgan.Fields("organ_cd").Value

        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||3c2||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd|A|fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd||fffd||251|O|fffd||30b|@|fffd||583|R|fffd|[|fffd|h|fffd|E|fffd|@|fffd||596||fffd||fffd||fffd||fffd|i|fffd|[
        If organ_cd <> organ_cd_before Then
            organDic.Add organ_cd_before, organ_name
            noChkFlg = False
        End If

        ' |fffd|@|fffd||596||fffd||fffd||30e||64fe||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||513||fffd||fffd||fffd||fffd||fffd|
        If noChkFlg = False Then
            organ_name = rsOrgan.Fields("organ_name").Value
            'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
            If CDate(rsOrgan.Fields("valid_start_dtime").Value) <= CDate(STR_BASE_DATE_END) And _
                    CDate(baseDate) <= CDate(rsOrgan.Fields("valid_end_dtime").Value) Then
'            If CDate(rsOrgan.Fields("valid_start_dtime").Value) <= baseDate And _
'                    baseDate <= CDate(rsOrgan.Fields("valid_end_dtime").Value) Then
            'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------

                ' |fffd|L|fffd||fffd||fffd||fffd||fffd||513||fffd||fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||308||20d|~|fffd||30b|@|fffd||596||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||202||fffd|
                noChkFlg = True
                DoEvents
            End If
        End If

        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||311||794||fffd|
        organ_cd_before = organ_cd
        rsOrgan.MoveNext
    
    Loop

    ' |fffd||14f|I|fffd|@|fffd||582||30b|@|fffd||583|R|fffd|[|fffd|h|fffd|E|fffd|@|fffd||596||fffd||fffd||fffd||fffd|i|fffd|[
    organDic.Add organ_cd_before, organ_name

    Call closeRecordset(rsOrgan)
    Set localConn = Nothing
    
    getOrganList = True
    Exit Function

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd|b|fffd||fffd|I|fffd||243|G|fffd||fffd||fffd|[|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
    MsgBox Err.Number & ":" & Err.Description, vbOKOnly + vbCritical
    
    Call closeRecordset(rsOrgan)
    
    ' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||309||fffd||fffd|
    If Not localConn Is Nothing Then Set localConn = Nothing

    getOrganList = False

End Function

' |fffd||fffd||fffd||342||fffd||fffd||fffd||fffd|u|fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd|v|fffd||313||fffd||fffd||353||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
Public Function checkInputEvalNo(ByVal evalNo As String) As Boolean
    
    Dim objRE       As Object
    Dim strPattern  As String

    
    ' |fffd||fffd||fffd||fffd||fffd||342||fffd|OK|fffd|i|fffd||d4482||302||742||fffd||fffd||702||781|j
    If Len(Trim(evalNo)) = 0 Then
        checkInputEvalNo = True
        Exit Function
    End If
    
    Set objRE = CreateObject("VBScript.RegExp")
    strPattern = "^\d*[\,|\d]*\d$"
        
    With objRE
        .Pattern = strPattern
        .IgnoreCase = True
        .Global = True
        checkInputEvalNo = .Test(evalNo)
    End With

    Set objRE = Nothing
    
End Function
Attribute VB_Name = "SearchDisp"
Attribute VB_Base = "0{815DBFA3-047B-42A7-958C-ADDEB1CB4BFA}{E3DD1E6B-0982-410B-B1E8-4665D74FB7F8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub SearchLst_Click()
'
'   |fffd|I|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|@|fffd||596||fffd||fffd||fffd||fffd|m|fffd||80b3||fffd||a0bd||fffd||fffd|A|fffd|@|fffd||58f||fffd||fffd||24b|@|fffd||583|R|fffd|[|fffd|h|fffd|E|fffd|S|fffd||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|E|fffd|@|fffd||596||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
'   |fffd|u|fffd||fffd||fffd||fffd||fffd|v|fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|v|fffd||a5d7||fffd||fffd|\|fffd||fffd|
'
    If SearchDisp.SearchLst.ListIndex <> -1 Then
        SearchDisp.AfterSelectLabel.Caption = "|fffd||fffd||fffd||255|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|@|fffd||582||315||3cd|X|fffd|\|fffd||fffd||fffd||142||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H|fffd||fffd||b0b5||fffd||fffd||fffd||fffd||fffd|OK|fffd||fffd||fffd|A" & vbCrLf & _
                                "|fffd|I|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||a5d7||fffd||fffd||fffd|@|fffd||596||fffd||fffd||fffd|I|fffd||fffd||fffd|A" & vbCrLf & _
                                "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||84bc||fffd||fffd||fffd||a347||fffd||341|A|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        
        SearchDisp.SelectedKikan = SearchDisp.SearchLst.Text
    End If

End Sub

' |fffd|@|fffd||596||fffd||fffd||fffd||fffd||fffd||fffd||80b3||fffd||a0bd||fffd||fffd||30f||fffd||fffd||fffd|
Private Sub OKButton_Click()
    
    ' |fffd|@|fffd||596||fffd||fffd|I|fffd||fffd||fffd|m|fffd|F
    If SearchDisp.SelectedKikan = "" Then
        MsgBox "|fffd|@|fffd||596||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", vbOKOnly + vbExclamation
        Exit Sub
    End If

    ' |fffd|I|fffd||fffd||fffd|i|fffd||fffd|\|fffd||fffd||fffd|j
    ' |fffd||fffd|Unload|fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||242||10e||fffd||fffd|{|fffd||302||fffd||fffd||181|i|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||582||30f||fffd||fffd||64fe||fffd||702||142||fffd|Unload|fffd||fffd||fffd||202||fffd||fffd|j
    Me.Hide

End Sub

' |fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd|
Private Sub CloseButton_Click()
    
    ' |fffd||fffd||fffd|X|fffd|g|fffd||311|I|fffd||fffd||fffd||fffd||fffd||fffd|
    SearchDisp.SearchLst.ListIndex = -1
    
    ' |fffd|I|fffd||fffd||fffd|i|fffd||fffd|\|fffd||fffd||fffd|j
    ' |fffd||fffd|Unload|fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||242||10e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    Me.Hide

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g
Private Sub Worksheet_Change(ByVal Target As Range)
    
    Select Case Target.Column
        ' |fffd|\|fffd||fffd||fffd||656a||fffd||315||3cd|X|fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd|E|fffd||fffd||fffd||fffd||fffd||752||fffd|
        Case COL_0307_REQUEST
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||302||757|L|fffd||fffd|
            If ActiveSheet.ProtectContents = True Then Call execRowLock(ActiveSheet, Target)
        
        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||315||3cd|X|fffd|F|fffd||fffd||fffd||352|l|fffd|m|fffd|F
        Case COL_0307_EVAL_NUM
            If checkInputEvalNo(Target.Value) = False Then
                Application.Undo
                MsgBox "|fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||354||fffd||fffd|p|fffd||fffd||fffd|l|fffd||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||34e||fffd||fffd|A|fffd||fffd||fffd|p|fffd|J|fffd||fffd||fffd|}(,)|fffd||353||fffd||fffd||342||142||fffd||fffd||702||fffd|", vbOKOnly + vbExclamation
                Exit Sub
            End If

    End Select
    
End Sub
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g
Private Sub Worksheet_Change(ByVal Target As Range)
    
    Select Case Target.Column
        ' |fffd|\|fffd||fffd||fffd||656a||fffd||315||3cd|X|fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd|E|fffd||fffd||fffd||fffd||fffd||752||fffd|
        Case COL_0307_REQUEST
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||302||757|L|fffd||fffd|
            If ActiveSheet.ProtectContents = True Then Call execRowLock(ActiveSheet, Target)
        
        ' |fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||315||3cd|X|fffd|F|fffd||fffd||fffd||352|l|fffd|m|fffd|F
        Case COL_0307_EVAL_NUM
            If checkInputEvalNo(Target.Value) = False Then
                Application.Undo
                MsgBox "|fffd|]|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||354||fffd||fffd|p|fffd||fffd||fffd|l|fffd||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||34e||fffd||fffd|A|fffd||fffd||fffd|p|fffd|J|fffd||fffd||fffd|}(,)|fffd||353||fffd||fffd||342||142||fffd||fffd||702||fffd|", vbOKOnly + vbExclamation
                Exit Sub
            End If

    End Select
    
End Sub

Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdCreateFormSheet, 17, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdClear, 15, 2, MSForms, CommandButton"
Attribute VB_Control = "txtSearchInput, 14, 3, MSForms, TextBox"
Attribute VB_Control = "lblTitle, 13, 4, MSForms, Label"
Attribute VB_Control = "lblNote1, 12, 5, MSForms, Label"
Attribute VB_Control = "lblInfoAreaTitle, 11, 6, MSForms, Label"
Attribute VB_Control = "KoukyoCode, 10, 7, MSForms, Label"
Attribute VB_Control = "lblLocalGovernmentCode, 9, 8, MSForms, Label"
Attribute VB_Control = "KikanName, 8, 9, MSForms, Label"
Attribute VB_Control = "KikanCode, 7, 10, MSForms, Label"
Attribute VB_Control = "lblSearchTitle1, 6, 11, MSForms, Label"
Attribute VB_Control = "lblOrganName, 5, 12, MSForms, Label"
Attribute VB_Control = "lblOrganCd, 4, 13, MSForms, Label"
Attribute VB_Control = "lblSearchTitle2, 3, 14, MSForms, Label"
Attribute VB_Control = "cmdSearch, 1, 15, MSForms, CommandButton"
Option Explicit

Private conn            As ADODB.Connection
Private organDic        As Object

' |fffd|u|fffd||fffd||fffd||fffd||fffd|l|fffd||256||7c2||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
Private Sub cmdClear_Click()
 
    Dim s_raw   As Long
    Dim e_raw   As Long
    Dim loopC   As Long


    ' |fffd|m|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
    If MsgBox("|fffd||3cd|X|fffd||fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion) = vbNo Then
        Exit Sub
    End If
    
    Call setDrawControl
   
    With ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME)

        'ADD 20170825 |fffd|c|fffd|[|fffd||fffd||fffd||6d1||fffd||fffd||fffd|A|fffd||82||fffd||fffd||10d||10b|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||141|u|fffd||fffd||fffd||fffd||fffd|l|fffd||256||7c2||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||fffd||fffd|s|fffd||fffd||fffd|G|fffd||fffd||fffd|['1004'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cf|C|fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD

        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd|v|fffd||303|N|fffd||fffd||fffd|A
        ' **************************************************
        e_raw = .Cells(.Rows.Count, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
        s_raw = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        
        If s_raw < e_raw Then
        
            For loopC = s_raw + 1 To e_raw
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbBlack
                .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + 2).Value = STATUS_BLANK
                .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + 4).Value = STATUS_BLANK
                .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + 6).Value = STATUS_BLANK
            Next
        
        End If
        
        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|v|fffd||303|N|fffd||fffd||fffd|A
        ' **************************************************
        e_raw = .Cells(s_raw, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
        s_raw = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        
        If s_raw < e_raw Then
        
            For loopC = s_raw + 1 To e_raw
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbBlack
                .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + 2).Value = STATUS_BLANK
                .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + 2).Value = STATUS_BLANK
                .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + 4).Value = STATUS_BLANK
            Next
        
        End If
    
    End With
    
    'ADD 20170825 |fffd|c|fffd|[|fffd||fffd||fffd||6d1||fffd||fffd||fffd|A|fffd||82||fffd||fffd||10d||10b|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||141|u|fffd||fffd||fffd||fffd||fffd|l|fffd||256||7c2||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||fffd||fffd|s|fffd||fffd||fffd|G|fffd||fffd||fffd|['1004'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cf|C|fffd||fffd|
    Call protectWorkSheet(ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME), TOOL_LOCK_PWD)
    
    Call setDrawControl(True)

End Sub

' |fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d||c42c||fffd||fffd||fffd||fffd|
Private Sub cmdCreateFormSheet_Click()
    
    Dim inqStartRow     As Long
    Dim inqEndRow       As Long
    Dim proStartRow     As Long
    Dim proEndRow       As Long
    Dim noErrFlg        As Boolean
    
    Dim loopC           As Long
    
    ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f02||30f|I|fffd||fffd||fffd|E|fffd|J|fffd|n|fffd|s|fffd||64fe|
    proEndRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
    proStartRow = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|", ActiveSheet.Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
    
    ' |fffd||fffd||fffd||fffd||fffd||30f|I|fffd||fffd||fffd|E|fffd|J|fffd|n|fffd|s|fffd||64fe|
    inqEndRow = ActiveSheet.Cells(proStartRow, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
    inqStartRow = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", ActiveSheet.Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
    
    ' |fffd||fffd||fffd||fffd||fffd|O|fffd||30f||a347||fffd|A|fffd||402||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If inqStartRow = inqEndRow And proStartRow = proEndRow Then
        Debug.Print "|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|0|fffd||fffd||fffd|E|fffd|E|fffd|E"
        Exit Sub
    End If

    ' |fffd|m|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|o|fffd||fffd|
    If MsgBox("|fffd||3cd|X|fffd|\|fffd||fffd||fffd||fffd||fffd|e|fffd||14f49|f|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||10d90||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
        "|fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||3c2||742||317|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|e|fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||142||315||3cd|X|fffd||fffd||fffd|e|fffd||354|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf & _
        "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion) = vbNo Then
        Exit Sub
    End If
    
    ' |fffd|e|fffd|J|fffd|n|fffd|s|fffd||242|P|fffd||fffd||fffd|Z
    ' |fffd||fffd||fffd||fffd||fffd|Z|fffd|O|fffd||341|A|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|s|fffd||30d|s|fffd||292|u|fffd||fffd||fffd|w|fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd|f|fffd|[|fffd|^|fffd||64ea||fffd|s|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    inqStartRow = inqStartRow + 1
    proStartRow = proStartRow + 1
    
    ' |fffd||fffd||fffd|~|fffd|\|fffd|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
    ' |fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||34d|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||208||5c1|A|fffd|`|fffd|F|fffd|b|fffd|N|fffd||590||fffd||fffd||fffd||fffd||14f||fffd||fffd||fffd|
    If checkListStatus(inqStartRow, inqEndRow, proStartRow, proEndRow) = False Then
        Exit Sub
    End If
    
    ' |fffd|u|fffd|b|fffd|N|fffd||315||6cc||fffd||308||a39e||fffd||fffd||fffd||fffd|
    ThisWorkbook.Unprotect TOOL_LOCK_PWD
    
    ' |fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|\|fffd||fffd|
    UserForm4.Show vbModeless
    DoEvents
    
    ' |fffd|`|fffd||fffd||312||fffd|~
    Call setDrawControl
        
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f02||30d||fffd||fffd|F|fffd||fffd|
    For loopC = inqStartRow To proEndRow
        If loopC <= inqEndRow Or proStartRow <= loopC Then
            Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbBlack
        End If
    Next
    
    ' |fffd||fffd||fffd|~|fffd|\|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|
    Call protectWorkSheet(ActiveSheet, TOOL_LOCK_PWD)
        
    ' |fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd|
    Call viewAppricationFormSheet(True)
    
    ' |fffd|l03-07_1|fffd|F|fffd||fffd||fffd||189||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call createForm03071(inqStartRow, inqEndRow)
Debug.Print "|fffd|l|fffd||fffd|03-07(1)|fffd|@|fffd||c42c||fffd|F" & Now()

    ' |fffd|l03-07_2|fffd|F|fffd||fffd||fffd||4b7c2||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
    Call createForm03072(proStartRow, proEndRow)
Debug.Print "|fffd|l|fffd||fffd|03-07(2)|fffd|@|fffd||c42c||fffd|F" & Now()
    
    ' |fffd|@|fffd||596||fffd||fffd|E|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd||fffd||30d||c42c|
    Call getOrganList(organDic)
    
    ' |fffd|l03-08_1|fffd|F|fffd||fffd||fffd||189||f396||fffd||fffd||fffd||24a||582||fffd||fffd||fffd||3d4|C|fffd||fffd||fffd|@(|fffd||3d4|C|fffd||242||fffd||fffd|s|fffd||fffd||fffd||295|\|fffd||fffd||fffd||30e||fffd||fffd||fffd|)
    Call createForm03081(inqStartRow, inqEndRow, Me.KikanCode.Caption)
Debug.Print "|fffd|l|fffd||fffd|03-08(1)|fffd|@|fffd||c42c||fffd|F" & Now()
   
    ' |fffd|l03-08_2|fffd|F|fffd||fffd||fffd||4b7ce||fffd||fffd||fffd||fffd||24a||582||fffd||fffd||fffd||3d4|C|fffd||fffd||fffd|@(|fffd||295|\|fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||4b7c2||30b|`|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|)
    Call createForm03082(proStartRow, proEndRow, Me.KikanCode.Caption)
Debug.Print "|fffd|l|fffd||fffd|03-08(2)|fffd|@|fffd||c42c||fffd|F" & Now()

    ' |fffd|l03-08_3|fffd|F|fffd||fffd||fffd||4b7ce||fffd||fffd||fffd||fffd||24a||582||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|@(|fffd||295|\|fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||4b7c2||30b|`|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|)
    Call createForm03083(proStartRow, proEndRow, Me.KikanCode.Caption)
Debug.Print "|fffd|l|fffd||fffd|03-08(3)|fffd|@|fffd||c42c||fffd|F" & Now()

    Set organDic = Nothing
    
    ' ==================================================
    ' |fffd|u|fffd|`|fffd|F|fffd|b|fffd|N|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||191|J|fffd||fffd|
    ' ==================================================
    With ThisWorkbook.Sheets("|fffd|`|fffd|F|fffd|b|fffd|N")
        
        .Activate
        
        ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD
       
        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|A|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|A|fffd|@|fffd||596||fffd||fffd||313|]|fffd|L
        .Range("|fffd|@|fffd||583|R|fffd|[|fffd|h") = Me.KikanCode.Caption
        .Range("|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h") = Me.KoukyoCode.Caption
        .Range("|fffd|@|fffd||596||fffd|") = Me.KikanName.Caption

        ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        .Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W").Value = "|fffd|\|fffd||fffd||fffd||fffd||fffd||58b|L|fffd||fffd||fffd||fffd|A|fffd|K|fffd||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||90b1||fffd||fffd|"
        .Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W").Font.color = vbRed
        .Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W").Interior.color = vbWhite
        
        .cmdCreateDocument.Enabled = False

        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|o|fffd||343|G|fffd||fffd||fffd|A|fffd||303|N|fffd||fffd||fffd|A
        Call .clearErrList
        Call .outputNormalMsg("|fffd|l03-07_1", ERR_MSG_NOT_IMPLEMENT)
        Call .outputNormalMsg("|fffd|l03-07_2", ERR_MSG_NOT_IMPLEMENT)
        Call .outputNormalMsg("|fffd|l03-08_1", ERR_MSG_NOT_IMPLEMENT)
        Call .outputNormalMsg("|fffd|l03-08_2", ERR_MSG_NOT_IMPLEMENT)
        Call .outputNormalMsg("|fffd|l03-08_3", ERR_MSG_NOT_IMPLEMENT)

        ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
        Call protectWorkSheet(ThisWorkbook.Sheets("|fffd|`|fffd|F|fffd|b|fffd|N"), TOOL_LOCK_PWD)
    
    End With
    
    ' |fffd|u|fffd|b|fffd|N|fffd||30d||115||6cc||fffd|
    ThisWorkbook.protect TOOL_LOCK_PWD, True
    
    ' |fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||283|N|fffd||fffd||fffd|[|fffd|Y
    Unload UserForm4
    
    ' |fffd||115|`|fffd||fffd|
    Call setDrawControl(True)

    ' |fffd|u|fffd|l03-07_1|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||fffd|
    ThisWorkbook.Sheets("|fffd|l03-07_1").Activate
    DoEvents

End Sub

' |fffd|@|fffd||596||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||a5d7||fffd||fffd||fffd||fffd|
Private Sub cmdSearch_Click()
    
    Dim organDic        As Object
    Dim loopC           As Long
    Dim organList()     As String
    Dim organ_cd        As String
    Dim organ_name      As String
    
    
    ' |fffd||38f||6c2||30b|@|fffd||588||a5d7||fffd||30e||64fe|
    Call getOrganList(organDic, Trim(Me.txtSearchInput.Text))
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||281|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|
    If organDic.Count = 0 Then
        Set organDic = Nothing
        MsgBox "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||702||78b|@|fffd||596||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B", vbOKOnly + vbInformation
        Exit Sub
    End If
    
    Application.Cursor = xlWait
    
    ' |fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30c||fffd||fffd||182||202||fffd|f|fffd|[|fffd|^|fffd||310||fffd||fffd||fffd|
    ReDim organList(organDic.Count - 1, 1)
    For loopC = 0 To organDic.Count - 1
        organList(loopC, 0) = organDic.item(organDic.Keys()(loopC))
        organList(loopC, 1) = organDic.Keys()(loopC)
    Next
    
    Application.Cursor = xlDefault
    Set organDic = Nothing
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||295|\|fffd||fffd||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||752||fffd||195|\|fffd||fffd|
    With SearchDisp.SearchLst
        .Height = 128
        .Width = 307.5
        .IntegralHeight = True
        .Font = "Meiryo UI"
        .ColumnCount = 2
        .ColumnWidths = ";0"
        .List = organList
    End With
    With SearchDisp
        .AfterSelectLabel.Caption = ""
        .SelectedKikan = ""
        .StartUpPosition = 0
        .Top = 114
        .Left = 228
    End With
    
    ' SerchDisp|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||315|\|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|SerchDisp|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||248||693||fffd|
    SearchDisp.Show

    ' -----------------------------------------------------------------------
    ' |fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||341|ASerchDisp|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd||7427||fffd||40aa||fffd||7c2||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd|@|fffd||fffd|
    ' -----------------------------------------------------------------------
    
    ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|A|fffd|@|fffd||596||fffd||fffd||30e||64fe|
    organ_cd = ""
    organ_name = ""
    If (SearchDisp.SearchLst.ListIndex <> -1) Then
        organ_cd = SearchDisp.SearchLst.List(SearchDisp.SearchLst.ListIndex, 1)
        organ_name = SearchDisp.SearchLst.List(SearchDisp.SearchLst.ListIndex, 0)
    End If

    ' SerchDisp|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30f|I|fffd||fffd|
    Unload SearchDisp
    
    ' SearchDisp|fffd||242||10b|@|fffd||596||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd|A|fffd|\|fffd||fffd||fffd||fffd|
    If Len(Trim(organ_cd)) > 0 Then
    
        ' ******************************
        ' |fffd|u|fffd|@|fffd||58f||fffd||fffd|v|fffd||303|Z|fffd|b|fffd|g
        ' ******************************

        ' |fffd|@|fffd||583|R|fffd|[|fffd|h
        Me.KikanCode.Caption = organ_cd

        ' |fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h
        ' |fffd||fffd||fffd|F|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd|3|fffd||fffd||fffd||682||fffd|"2"|fffd||30f||a347|(|fffd||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||fffd|)|fffd||302||741|A|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd|6|fffd||fffd||fffd||682||fffd||fffd||fffd|5|fffd||fffd||fffd||fffd||fffd|u|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||182||fffd||fffd||115|\|fffd||fffd|
        If Mid(organ_cd, 3, 1) = "2" Then
            Me.KoukyoCode.Caption = Mid(organ_cd, 6, 5)
        Else
            Me.KoukyoCode.Caption = "---"
        End If

        ' |fffd|@|fffd||596||fffd|
        Me.KikanName.Caption = organ_name

        ' ******************************
        ' |fffd||a5d7||fffd|\|fffd||fffd||fffd||fffd|
        ' ******************************
        ThisWorkbook.Unprotect TOOL_LOCK_PWD

        ' |fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
        Call viewAppricationFormSheet(False)

        ' |fffd|u|fffd|b|fffd|N|fffd||30d||115||6cc||fffd|
        ThisWorkbook.protect TOOL_LOCK_PWD, True

        ' |fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|\|fffd||fffd|
        UserForm4.Show vbModeless
        DoEvents

        ' |fffd||a5d7||fffd|\|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||295|`|fffd||fffd||312||fffd|~|fffd|^|fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||312||fffd||fffd||141|j
        Call createMainSheet

        ' |fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||283|N|fffd||fffd||fffd|[|fffd|Y
        Unload UserForm4

    End If
    
End Sub

' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
Private Function checkListStatus(ByVal i_s_row As Long, ByVal i_e_row As Long, ByVal p_s_row As Long, ByVal p_e_row As Long) As Boolean

    Dim result          As Boolean  ' |fffd||590||fffd||fffd||316||7c2||fffd|l
    Dim loopC           As Long
    Dim loopS           As Long

    Dim statusChk(6)    As Integer  ' |fffd||fffd||fffd|~|fffd|\
    Dim iSelectErr      As Long     ' |fffd||fffd||fffd||fffd||fffd||30c||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    Dim iLogicalErr     As Long     ' |fffd||fffd||fffd||fffd||fffd||318|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    Dim iWarning        As Long     ' |fffd||fffd||fffd||fffd||fffd||30c|x|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j|fffd||fffd||fffd||fffd|
    Dim pSelectErr      As Long     ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f02||30c||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    Dim pLogicalErr     As Long     ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f02||318|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    
    Dim strMsg          As String


    ' |fffd||590||fffd||fffd||316||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = False

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    iSelectErr = 0
    iLogicalErr = 0
    iWarning = 0
    pSelectErr = 0
    pLogicalErr = 0
    
    ' |fffd|V|fffd|[|fffd|g|fffd||303||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    Call unprotectWorkSheet(ActiveSheet, TOOL_LOCK_PWD)

    With ActiveSheet
    
        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|v|fffd||30a|m|fffd|F
        ' **************************************************
        For loopC = i_s_row To i_e_row
                
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||311|O|fffd|i|fffd|F|fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
            .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbBlack
                
            ' |fffd||fffd||fffd|~|fffd|\|fffd||30f||fffd||502||fffd||fffd||64fe|
            For loopS = 0 To 4
                statusChk(loopS) = getStatusNumber(.Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + loopS).Value)
            
                ' |fffd|Z|fffd||fffd||fffd||fffd||fffd||352|l|fffd|s|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                If (statusChk(loopS) And STS_ERR_NUM) = STS_ERR_NUM Then
                    MsgBox "|fffd||fffd||fffd||352|l|fffd||fffd||fffd|s|fffd||fffd||fffd||203|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly + vbQuestion
                    .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + loopS).Activate
                    GoTo FUNC_END
                End If
            Next

            ' |fffd||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
            If (statusChk(1) = statusChk(2)) Or _
                (statusChk(3) = statusChk(4)) Or _
                ((statusChk(3) = STS_NG_NUM) And (statusChk(4) = STS_CNG_NUM)) Then
            
                ' |fffd||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                iSelectErr = iSelectErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
            
            ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|P
            ' |fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||189||fffd||94|\|fffd|F|fffd|C|fffd||4c1|A|fffd||189||f396||fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||fffd|C|fffd||317|L|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|i|fffd||3cd|X|fffd|j|fffd||182||202||fffd||a347|
            ElseIf (statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_OK_NUM) Or _
                (statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_BLK_NUM) Or _
                (statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_CNG_NUM) Or _
                (statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_OK_NUM) Or _
                (statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_BLK_NUM) Or _
                (statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_CNG_NUM) Then
 
                ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                iLogicalErr = iLogicalErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed

            ' |fffd|x|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j
            ' |fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||189||fffd||94|\|fffd|F|fffd||fffd||fffd|A|fffd||189||f396||fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||fffd|C|fffd||317|L|fffd||fffd||fffd|F|fffd|~|fffd||182||202||fffd||a347|
            ElseIf (statusChk(0) = STS_OK_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM) Or _
                (statusChk(0) = STS_OK_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM) Then

                ' |fffd|x|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j|fffd||fffd||fffd|Z
                iWarning = iWarning + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
            
            ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|Q
            ' |fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||189||fffd||94|\|fffd|F|fffd|~|fffd|A|fffd||189||f396||fffd||fffd||fffd|F|fffd||fffd||fffd|A|fffd||fffd|C|fffd||317|L|fffd||fffd||fffd|F|fffd|~|fffd||182||202||fffd||a347|
            ElseIf (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_OK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_OK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM) Then
 
                ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                iLogicalErr = iLogicalErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
            
            End If

        Next


        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd|v|fffd||30a|m|fffd|F
        ' **************************************************
        For loopC = p_s_row To p_e_row
                
            ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f02||311|O|fffd|i|fffd|F|fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
            .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbBlack
                
            ' |fffd||fffd||fffd|~|fffd|\|fffd||30f||fffd||502||fffd||fffd||64fe|
            For loopS = 0 To 6
                statusChk(loopS) = getStatusNumber(.Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + loopS).Value)
            
                ' |fffd|Z|fffd||fffd||fffd||fffd||fffd||352|l|fffd|s|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                If (statusChk(loopS) And STS_ERR_NUM) = STS_ERR_NUM Then
                    MsgBox "|fffd||fffd||fffd||352|l|fffd||fffd||fffd|s|fffd||fffd||fffd||203|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly + vbQuestion
                    .Cells(loopC, C_NUMBER_USE_LAW_COL_NUM + loopS).Activate
                    GoTo FUNC_END
                End If
            Next

            ' |fffd||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
            If (statusChk(1) = statusChk(2)) Or _
                (statusChk(3) = statusChk(4)) Or _
                ((statusChk(3) = STS_NG_NUM) And (statusChk(4) = STS_CNG_NUM)) Or _
                (statusChk(5) = statusChk(6)) Or _
                ((statusChk(5) = STS_NG_NUM) And (statusChk(6) = STS_CNG_NUM)) Then
            
                ' |fffd||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                pSelectErr = pSelectErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
            
            ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|P
            ' |fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||fffd|C|fffd|F|fffd|i|fffd|C|fffd||4c1|j|fffd|A|fffd||3d4|C|fffd|F|fffd|~|fffd|@|fffd||182||202||fffd||a347|
            ElseIf (statusChk(0) = STS_OK_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_NG_NUM) Or _
                (statusChk(0) = STS_OK_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(5) = STS_NG_NUM And statusChk(6) = STS_BLK_NUM) Or _
                (statusChk(0) = STS_OK_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_NG_NUM) Or _
                (statusChk(0) = STS_OK_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(5) = STS_NG_NUM And statusChk(6) = STS_BLK_NUM) Then
 
                'UPD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
                ' |fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd|~|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|A|fffd||fffd|C|fffd|F|fffd|~|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|A|fffd||3d4|C|fffd|F|fffd|~|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|A|fffd||fffd||fffd|l|fffd|F|fffd||4b7c2||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||202||fffd||fffd|@|fffd||142||202||fffd||fffd||a347|
                If Not (statusChk(0) = STS_OK_NUM _
                    And statusChk(1) = STS_NG_NUM _
                    And statusChk(2) = STS_BLK_NUM _
                    And statusChk(3) = STS_NG_NUM _
                    And statusChk(4) = STS_BLK_NUM _
                    And statusChk(5) = STS_NG_NUM _
                    And statusChk(6) = STS_BLK_NUM _
                    And .Cells(loopC, C_REMARKS_COL_NUM).Value = NONE_P_I) _
                    Then
                    ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                    pLogicalErr = pLogicalErr + 1
                    .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
                End If
                
'                ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
'                pLogicalErr = pLogicalErr + 1
'                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
                'UPD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| end -------------------------------------------------------------------
            
            ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|Q
            ' |fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|i|fffd|C|fffd||4c1|j|fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||fffd|C|fffd|F|fffd||fffd||fffd||fffd||fffd|i|fffd||3cd|X|fffd|j|fffd|A|fffd||3d4|C|fffd|F|fffd|i|fffd|C|fffd||4c1|j|fffd|@|fffd||182||202||fffd||a347|
            ElseIf (statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_BLK_NUM) Or _
                (statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_CNG_NUM) Or _
                (statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_OK_NUM) Or _
                (statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_BLK_NUM) Or _
                (statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_CNG_NUM) Or _
                (statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_OK_NUM) Then
 
                ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                pLogicalErr = pLogicalErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
           
            ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|R
            ' |fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd||fffd||fffd|A|fffd||fffd|C|fffd|F|fffd||fffd||fffd|A|fffd||3d4|C|fffd|F|fffd|i|fffd|C|fffd||4c1|j|fffd|@|fffd||182||202||fffd||a347||fffd|i|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd|j
            ' |fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd||fffd||fffd|A|fffd||fffd|C|fffd|F|fffd|~|fffd|A|fffd||3d4|C|fffd|F|fffd|i|fffd|C|fffd||4c1|j|fffd|@|fffd||182||202||fffd||a347||fffd|i|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|j
            
            '|fffd||209||fffd||fffd||1c9||fffd|
            '------
            'Or _
            '(statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM) Or _
            '(statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_OK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM)
            '------
                   
            ElseIf (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM) Or _
                   (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_OK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM) Or _
                   (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM) Or _
                   (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_OK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM) Then
 
                ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                pLogicalErr = pLogicalErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
            
            ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|S
            ' |fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd|~|fffd|A|fffd||fffd|C|fffd|F|fffd|~|fffd|A|fffd||3d4|C|fffd|F|fffd||fffd||fffd||fffd||fffd|i|fffd||3cd|X|fffd|j|fffd|@|fffd||182||202||fffd||a347|
            ElseIf (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM And statusChk(5) = STS_NG_NUM And statusChk(6) = STS_OK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_BLK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_CNG_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM And statusChk(5) = STS_NG_NUM And statusChk(6) = STS_OK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_BLK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_OK_NUM And statusChk(2) = STS_NG_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_CNG_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM And statusChk(5) = STS_NG_NUM And statusChk(6) = STS_OK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_BLK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_OK_NUM And statusChk(4) = STS_NG_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_CNG_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM And statusChk(5) = STS_NG_NUM And statusChk(6) = STS_OK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_BLK_NUM) Or _
                (statusChk(0) = STS_NG_NUM And statusChk(1) = STS_NG_NUM And statusChk(2) = STS_BLK_NUM And statusChk(3) = STS_NG_NUM And statusChk(4) = STS_BLK_NUM And statusChk(5) = STS_OK_NUM And statusChk(6) = STS_CNG_NUM) Then
 
                ' |fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|Z
                pLogicalErr = pLogicalErr + 1
                .Cells(loopC, C_BIZ_P_I_NAME_COL_NUM).Font.color = vbRed
            
            End If

        Next

        ' **************************************************
        '  |fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||282||30f|o|fffd||fffd|
        ' **************************************************
        If iSelectErr = 0 And iLogicalErr = 0 And pSelectErr = 0 And pLogicalErr = 0 Then
        
            ' |fffd|x|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|o|fffd||342||143||fffd||fffd|[|fffd|U|fffd|m|fffd|F
            If iWarning > 0 Then
                
                strMsg = "|fffd|x|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j|fffd||fffd||fffd|A " & iWarning & " |fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf
                strMsg = strMsg & "|fffd||50d||fffd||fffd||fffd||fffd|p|fffd|@|fffd||fffd||fffd||fffd||189||f0aa||fffd||94|\|fffd||20e||fffd||fffd||fffd||fffd||242||82||fffd||fffd||101|A|fffd|u|fffd||fffd||fffd||6c2||24f||189||f0b7||fffd||9396||fffd||fffd||fffd|v|fffd||fffd| |fffd|~ |fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd|I|fffd||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf
                strMsg = strMsg & "|fffd|I|fffd||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|i|fffd||fffd||fffd||189||fffd||fffd||fffd|s|fffd||fffd||202||fffd||fffd||a347||fffd|j|fffd||341|A|fffd|C|fffd||fffd||fffd|s|fffd|v|fffd||142||fffd||fffd|B" & vbCrLf & vbCrLf
                strMsg = strMsg & "|fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||7c2||102||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H" & vbCrLf & vbCrLf
                strMsg = strMsg & "|fffd|x|fffd||fffd||fffd||302||fffd||fffd||fffd||4cf||fffd||fffd||341|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50e||fffd||fffd||155|\|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf
                strMsg = strMsg & "|fffd||68d||5c2||341|u|fffd||246b||fffd||fffd||fffd||fffd|_|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"

                If MsgBox(strMsg, vbYesNo + vbQuestion) = vbYes Then
                    result = True
                End If
            
            ' |fffd|x|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j|fffd||fffd||fffd||202||fffd||fffd||fffd||396||fffd||fffd||fffd||fffd||fffd||fffd||fffd|OK
            Else
                result = True
            End If
            
        Else
            ' NG|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||30f||a347||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|\|fffd|z
            strMsg = "|fffd||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd|B|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & vbCrLf
            
            If iSelectErr > 0 Or iLogicalErr > 0 Or iWarning > 0 Then
                strMsg = strMsg & "|fffd||fffd||fffd||fffd||fffd||189||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf
                If iSelectErr > 0 Then strMsg = strMsg & "|fffd||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|E|fffd|E " & iSelectErr & " |fffd||fffd|" & vbCrLf
                If iLogicalErr > 0 Then strMsg = strMsg & "|fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|E|fffd|E " & iLogicalErr & " |fffd||fffd|" & vbCrLf
                If iWarning > 0 Then strMsg = strMsg & "|fffd|x|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|i|fffd||fffd||fffd||fffd|OK|fffd|j|fffd|E|fffd|E|fffd|E " & iWarning & " |fffd||fffd|" & vbCrLf
                strMsg = strMsg & vbCrLf
           End If
    
            If pSelectErr > 0 Or pLogicalErr > 0 Then
                strMsg = strMsg & "|fffd||fffd||fffd||fffd||fffd||4b7c2||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|" & vbCrLf
                If pSelectErr > 0 Then strMsg = strMsg & "|fffd||fffd|I|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|E|fffd|E " & pSelectErr & " |fffd||fffd|" & vbCrLf
                If pLogicalErr > 0 Then strMsg = strMsg & "|fffd|_|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|E|fffd|E " & pLogicalErr & " |fffd||fffd|" & vbCrLf
                strMsg = strMsg & vbCrLf
            End If
   
            strMsg = strMsg & "|fffd|G|fffd||fffd||fffd|[|fffd||302||fffd||fffd||fffd||4cf||fffd||fffd||341|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||353||fffd||fffd||fffd||90|l|fffd||fffd||56f02||fffd||50e||fffd||fffd||155|\|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf
            strMsg = strMsg & "|fffd||68d||5c2||341|u|fffd||246b||fffd||fffd||fffd||fffd|_|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"

            Call MsgBox(strMsg, vbOKOnly + vbExclamation)

        End If

    End With

FUNC_END:

    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ActiveSheet, TOOL_LOCK_PWD)

    ' |fffd||590||fffd||fffd||316||7c2||fffd|l|fffd||752||fffd|
    checkListStatus = result

End Function

' |fffd||fffd||fffd|~|fffd|\|fffd||310||752||fffd|l|fffd||fffd||fffd|A|fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||115||50b|p
Private Function getStatusNumber(ByVal status As String) As Integer

    Dim result As Integer

    ' |fffd|w|fffd||8576||fffd||fffd||fffd||fffd||242||fffd||fffd|l|fffd||752||fffd|
    Select Case status
        ' |fffd||fffd| |fffd||fffd| 1
        Case STATUS_OK
            result = STS_OK_NUM
        ' |fffd||fffd||fffd|e|fffd||255||3cd|X|fffd||fffd||fffd||fffd| |fffd||fffd| 2
        Case STATUS_CHANGE
            result = STS_CNG_NUM
        ' |fffd|~ |fffd||fffd| 4
        Case STATUS_NG
            result = STS_NG_NUM
        ' (|fffd||d4481||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd| 8
        Case STATUS_BLANK
            result = STS_BLK_NUM
        Case Else
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||202||fffd||fffd||fffd|8|fffd|A|fffd|z|fffd||fffd|O|fffd||fffd|16
            If Len(Trim(status)) = 0 Then
                result = STS_BLK_NUM
            Else
                result = STS_ERR_NUM
            End If
    End Select
    
    getStatusNumber = result

End Function

' |fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub viewAppricationFormSheet(view As Boolean)

    Dim sheetName   As Variant
    Dim sheet       As Excel.Worksheet

    For Each sheetName In Array("|fffd|`|fffd|F|fffd|b|fffd|N", "|fffd|l03-07_1", "|fffd|l03-07_2", "|fffd|l03-08_1", "|fffd|l03-08_2", "|fffd|l03-08_3", "|fffd||246b||fffd||fffd||fffd||fffd|_|fffd|l|fffd||fffd||fffd|L|fffd||fffd|")
    
        Set sheet = ThisWorkbook.Sheets(sheetName)
        sheet.Visible = view
    Next

End Sub

' |fffd|l|fffd||fffd|03-07(1)|fffd||313|W|fffd|J|fffd||fffd||fffd||fffd|
Private Sub createForm03071(ByVal startRow As Long, ByVal proEndRow As Long)

    Dim ws03071         As Worksheet
    Dim wsCreate        As Worksheet
    Dim oldMaxRow       As Long
    Dim targetRow       As Long
    Dim rowCnt          As Long         ' |fffd|uNo|fffd|v|fffd|J|fffd||fffd||fffd||fffd||fffd||50d||fffd|
    Dim loopJ           As Long         ' |fffd|u|fffd||fffd||fffd||fffd||fffd|v|fffd|p|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    
    ' |fffd|\|fffd||fffd||301||fffd||fffd|~
    Dim init_law        As String
    Dim before_03071    As String
    Dim after_03071     As String
    Dim before_03081    As String
    Dim after_03081     As String
    

On Error GoTo ERR_HND
 
    ' |fffd||38f||6c3||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30e||64fe|
    Set ws03071 = ThisWorkbook.Sheets("|fffd|l03-07_1")
    Set wsCreate = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME)
    
    With ws03071
        
        .Activate
        
        ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD
    
        ' |fffd||fffd||fffd||fffd||fffd|s|fffd||311|S|fffd|s|fffd||d3dc|
        oldMaxRow = .Cells(.Rows.Count, COL_0307_NO).End(xlUp).Row
        If oldMaxRow > DATA_TITLE_ROW_NUM Then
            .Range(DATA_START_ROW_NUM & ":" & oldMaxRow).Delete
        End If
        targetRow = DATA_START_ROW_NUM
        
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|\|fffd||fffd|
        .Rows(DATA_START_ROW_NUM).Hidden = False

        ' |fffd||189||f396||fffd||fffd||fffd||143||fffd||fffd|[|fffd|v
        rowCnt = 0
        For loopJ = startRow To proEndRow
            
            init_law = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM)
            before_03071 = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM + 1)
            after_03071 = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM + 2)
            before_03081 = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM + 3)
            after_03081 = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM + 4)
            
            ' |fffd||fffd||fffd|~|fffd|g|fffd||74d||fffd||fffd||d0b9||fffd|`|fffd|F|fffd|b|fffd|N
            If (init_law = STATUS_NG) And _
                (before_03071 = STATUS_NG) And _
                (Len(Trim(after_03071)) = 0) And _
                (before_03081 = STATUS_NG) And _
                (Len(Trim(after_03081)) = 0) Then
                
                ' |fffd|u|fffd||fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|v
                ' |fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||341|A03-08(1)|fffd||fffd||fffd||702||7c2||fffd||fffd||fffd||502||fffd||fffd|l|fffd||fffd||fffd||38f||6c2||182||fffd||fffd||fffd|
            
            Else
                
                ' |fffd|s|fffd|}|fffd||fffd|
                .Rows(targetRow).Copy
                .Rows(targetRow).Insert
                    
                rowCnt = rowCnt + 1
                        
                ' No|fffd|E|fffd||295|\|fffd||fffd||4d014||501|E|fffd||fffd||fffd||fffd||fffd||fffd|
                .Cells(targetRow, COL_0307_NO).Value = rowCnt
                .Cells(targetRow, COL_0307_NUMBER).Value = wsCreate.Cells(loopJ, C_NUMBER_COL_NUM).Value
                .Cells(targetRow, COL_0307_NAME).Value = wsCreate.Cells(loopJ, C_BIZ_P_I_NAME_COL_NUM).Value
                
                .Range(.Cells(targetRow, COL_0307_NO).Address, .Cells(targetRow, COL_0307_NAME)).Interior.color = wsCreate.Cells(loopJ, C_NUMBER_COL_NUM).Interior.color
                        
                ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||310||752||fffd|
                .Cells(targetRow, COL_0307_PIA).Value = NONE_VALUE
                .Cells(targetRow, COL_0307_EVAL_PLACE).Value = NONE_VALUE
                        
                If before_03071 = STATUS_OK Then
                    .Cells(targetRow, COL_0307_REG_STATUS).Value = DATA_REGISTERED
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Validation.Modify _
                        Formula1:=REQUEST_DELETE & "," & NONE_VALUE
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||752||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Value = IIf(after_03071 = STATUS_NG, REQUEST_DELETE, NONE_VALUE)
                    .Cells(targetRow, COL_0307_REQUEST).Locked = True
                Else
                    .Cells(targetRow, COL_0307_REG_STATUS).Value = DATA_UNREGISTERED
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Validation.Modify _
                        Formula1:=REQUEST_ENTRY & "," & NONE_VALUE
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||752||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Value = IIf(after_03071 = STATUS_OK, REQUEST_ENTRY, NONE_VALUE)
                    .Cells(targetRow, COL_0307_REQUEST).Locked = True
                End If
           
                ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||303|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|s
                Call execRowLock(ws03071, .Cells(targetRow, COL_0307_REQUEST))
                
                ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|[|fffd||]|fffd|A|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|\|fffd||fffd||fffd||656a||fffd||20d|~|fffd||311|S|fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||14482||242||fffd||fffd||fffd|
                If .Cells(targetRow, COL_0307_REQUEST).Value = NONE_VALUE And _
                    .Cells(targetRow, COL_0307_REQUEST).Locked = True Then

                    .Range(.Cells(targetRow, COL_0307_REQUEST).Address, .Cells(targetRow, COL_0307_EVAL_PLACE)).Interior.color = vbWhite
                End If
                
                targetRow = targetRow + 1
            
            End If
        
            ' 10|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
            If loopJ Mod 10 = 0 Then DoEvents
        Next
    
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|
        If targetRow <> DATA_START_ROW_NUM Then
            .Rows(targetRow).Hidden = True
        End If

        ' |fffd||64ea||fffd|J|fffd||fffd|
        .Select
        ActiveWindow.ScrollColumn = 1
        ActiveWindow.ScrollRow = 1
        .Range("A1").Select

    End With

    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ws03071, TOOL_LOCK_PWD)
    
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd|l|fffd||fffd|03-07(2)|fffd||313|W|fffd|J|fffd||fffd||fffd||fffd|
Private Sub createForm03072(ByVal startRow As Long, ByVal proEndRow As Long)

    Dim ws03072         As Worksheet
    Dim wsCreate        As Worksheet
    Dim oldMaxRow       As Long
    Dim targetRow       As Long
    Dim rowCnt          As Long         ' |fffd|uNo|fffd|v|fffd|J|fffd||fffd||fffd||fffd||fffd||50d||fffd|
    Dim loopP           As Long         ' |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|v|fffd|p|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    
    ' |fffd|\|fffd||fffd||301||fffd||fffd|~
    Dim init_law        As String
    Dim before_03072    As String
    Dim after_03072     As String
    Dim before_03083    As String
    Dim after_03083     As String
    Dim before_03082    As String
    Dim after_03082     As String
    'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
    Dim strRemarks      As String
    'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------

On Error GoTo ERR_HND
 
    ' |fffd||38f||6c3||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30e||64fe|
    Set ws03072 = ThisWorkbook.Sheets("|fffd|l03-07_2")
    Set wsCreate = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME)
    
    With ws03072
    
        .Activate
        
        ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD
    
        ' |fffd||fffd||fffd||fffd||fffd|s|fffd||311|S|fffd|s|fffd||d3dc|
        oldMaxRow = .Cells(.Rows.Count, COL_0307_NO).End(xlUp).Row
        If oldMaxRow > DATA_TITLE_ROW_NUM Then
            .Range(DATA_START_ROW_NUM & ":" & oldMaxRow).Delete
        End If
        targetRow = DATA_START_ROW_NUM
        
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|\|fffd||fffd|
        .Rows(DATA_START_ROW_NUM).Hidden = False

        ' |fffd||189||f396||fffd||fffd||fffd||143||fffd||fffd|[|fffd|v
        rowCnt = 0
        For loopP = startRow To proEndRow
            
            init_law = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM)
            before_03072 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 1)
            after_03072 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 2)
            before_03083 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 3)
            after_03083 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 4)
            before_03082 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 5)
            after_03082 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 6)
            'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
            strRemarks = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 7)
            'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------
            
            ' |fffd||fffd||fffd|~|fffd|g|fffd||74d||fffd||fffd||d0b9||fffd|`|fffd|F|fffd|b|fffd|N
            If (init_law = STATUS_NG) And _
                (before_03072 = STATUS_NG) And _
                (Len(Trim(after_03072)) = 0) And _
                (before_03083 = STATUS_NG) And _
                (Len(Trim(after_03083)) = 0) And _
                (before_03082 = STATUS_NG) And _
                (Len(Trim(after_03082)) = 0) Then
                
                ' |fffd|u|fffd||fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|v
                ' |fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||341|A03-08(2)(3)|fffd||fffd||fffd||702||7c2||fffd||fffd||fffd||502||fffd||fffd|l|fffd||fffd||fffd||38f||6c2||182||fffd||fffd||fffd|
                
            'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
            ElseIf (init_law = STATUS_OK) And _
                (before_03072 = STATUS_NG) And _
                (Len(Trim(after_03072)) = 0) And _
                (before_03083 = STATUS_NG) And _
                (Len(Trim(after_03083)) = 0) And _
                (before_03082 = STATUS_NG) And _
                (Len(Trim(after_03082)) = 0) And _
                strRemarks = NONE_P_I Then
                
                ' |fffd|u|fffd||fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|v
                ' |fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd|A|fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd|F|fffd|~|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|A|fffd||fffd|C|fffd|F|fffd|~|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|A|fffd||3d4|C|fffd|F|fffd|~|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|A|fffd||fffd||fffd|l|fffd|F|fffd||4b7c2||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||202||fffd|
                '|fffd|@ |fffd||30f||a347||fffd|A|fffd||fffd|\|fffd||fffd||fffd||182||fffd||fffd||fffd|
            'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------
            
            Else
                
                 ' |fffd|s|fffd|}|fffd||fffd|
                .Rows(targetRow).Copy
                .Rows(targetRow).Insert
                    
                rowCnt = rowCnt + 1
                        
                ' No|fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
                .Cells(targetRow, COL_0307_NO).Value = rowCnt
                .Cells(targetRow, COL_0307_NUMBER).Value = wsCreate.Cells(loopP, C_NUMBER_COL_NUM).Value
                .Cells(targetRow, COL_0307_NAME).Value = wsCreate.Cells(loopP, C_BIZ_P_I_NAME_COL_NUM).Value
                        
                .Range(.Cells(targetRow, COL_0307_NO).Address, .Cells(targetRow, COL_0307_NAME)).Interior.color = wsCreate.Cells(loopP, C_NUMBER_COL_NUM).Interior.color
                
                ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||310||752||fffd|
                .Cells(targetRow, COL_0307_PIA).Value = NONE_VALUE
                .Cells(targetRow, COL_0307_EVAL_PLACE).Value = NONE_VALUE
                        
                If before_03072 = STATUS_OK Then
                    .Cells(targetRow, COL_0307_REG_STATUS).Value = DATA_REGISTERED
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Validation.Modify _
                        Formula1:=REQUEST_DELETE & "," & NONE_VALUE
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||752||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Value = IIf(after_03072 = STATUS_NG, REQUEST_DELETE, NONE_VALUE)
                    .Cells(targetRow, COL_0307_REQUEST).Locked = True
                Else
                    .Cells(targetRow, COL_0307_REG_STATUS).Value = DATA_UNREGISTERED
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Validation.Modify _
                        Formula1:=REQUEST_ENTRY & "," & NONE_VALUE
                            
                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||752||fffd|
                    .Cells(targetRow, COL_0307_REQUEST).Value = IIf(after_03072 = STATUS_OK, REQUEST_ENTRY, NONE_VALUE)
                    .Cells(targetRow, COL_0307_REQUEST).Locked = True
                End If
           
                ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||303|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|s
                Call execRowLock(ws03072, .Cells(targetRow, COL_0307_REQUEST))
                
                ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|[|fffd||]|fffd|A|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|\|fffd||fffd||fffd||656a||fffd||20d|~|fffd||311|S|fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||14482||242||fffd||fffd||fffd|
                If .Cells(targetRow, COL_0307_REQUEST).Value = NONE_VALUE And _
                    .Cells(targetRow, COL_0307_REQUEST).Locked = True Then

                    .Range(.Cells(targetRow, COL_0307_REQUEST).Address, .Cells(targetRow, COL_0307_EVAL_PLACE)).Interior.color = vbWhite
                End If
                
                targetRow = targetRow + 1
            
            End If
            
            ' 10|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
            If loopP Mod 10 = 0 Then DoEvents
        Next
    
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|
        If targetRow <> DATA_START_ROW_NUM Then
            .Rows(targetRow).Hidden = True
        End If

        ' |fffd||64ea||fffd|J|fffd||fffd|
        .Select
        ActiveWindow.ScrollColumn = 1
        ActiveWindow.ScrollRow = 1
        .Range("A1").Select

    End With

    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ws03072, TOOL_LOCK_PWD)
    
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd|l|fffd||fffd|03-08(1)|fffd||313|W|fffd|J|fffd||fffd||fffd||fffd|
Private Sub createForm03081(ByVal startRow As Long, ByVal proEndRow As Long, ByVal organ_cd As String)

    Dim rs              As ADODB.Recordset
    Dim ws03081         As Worksheet
    Dim wsCreate        As Worksheet
    Dim wsWL            As Worksheet
    Dim oldMaxRow       As Long
    Dim targetRow       As Long
    Dim rowCnt          As Long         ' |fffd|uNo|fffd|v|fffd|J|fffd||fffd||fffd||fffd||fffd||50d||fffd|
    Dim loopJ           As Long         ' |fffd|u|fffd||fffd||fffd||fffd||fffd|v|fffd|p|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    Dim loopJM          As Long         ' |fffd|u|fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd|p|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    Dim organCdRow      As Long         ' |fffd|u|fffd||189||fffd||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30d|s|fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim bizCdCol        As Long         ' |fffd|u|fffd||189||fffd||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6ce||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||30a|J|fffd|n|fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim procCdCol       As Long         ' |fffd|u|fffd||189||fffd||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6ce||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||30a|J|fffd|n|fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim procCdEndCol    As Long         ' |fffd|u|fffd||189||fffd||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6ce||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||30f|I|fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim biz_cd          As String
    Dim proc_cd         As String
    Dim wl_status       As String
    Dim sql             As String
    Dim ret             As Variant
    Dim existWL         As Boolean
    
    ' |fffd|\|fffd||fffd||301||fffd||fffd|~
    Dim before_03081    As String
    Dim after_03081     As String
    
    Dim organCdCnt      As Long         ' 20170915 ADD |fffd|u|fffd||189||fffd||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30d|s|fffd||fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim organCdExecCnt  As Long         ' 20170915 ADD |fffd||fffd||fffd||302||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd|B0|fffd||30f||a347||fffd||142||fffd|1|fffd||fffd||34e||fffd||fffd|{|fffd||fffd||fffd||fffd||60a4||fffd||24f||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||30e||fffd|
    Dim procCdOutCnt    As Long         ' 20170915 ADD |fffd||fffd||fffd||fffd||fffd||8471||fffd|o|fffd||343|J|fffd|E|fffd||fffd||fffd|^|fffd|F|fffd|P|fffd||fffd||fffd||fffd||fffd||8471||fffd||fffd||fffd||243||fffd||fffd|Z|fffd|b|fffd|g


On Error GoTo ERR_HND
 
    ' |fffd||38f||6c3||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30e||64fe|
    Set ws03081 = ThisWorkbook.Sheets("|fffd|l03-08_1")
    Set wsCreate = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME)
    Set wsWL = ThisWorkbook.Worksheets(WL3_NAME)
    
On Error Resume Next

    ' WL|fffd||301|u|fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||38f||6d7||fffd||64fe|
    ret = Application.WorksheetFunction.Match(organ_cd, wsWL.Columns(WL_ORGAN_CD_COL_NUM), 0)
    If IsError(ret) Then
        organCdRow = 0
        ' 20170915 ADD
        organCdCnt = 0
        Err.Clear
    Else
        organCdRow = CLng(ret)
        ' 20170915 ADD
        organCdCnt = WorksheetFunction.CountIf(wsWL.Columns(WL_ORGAN_CD_COL_NUM), organ_cd)
    End If
    
On Error GoTo ERR_HND

    ' WL|fffd||301|u|fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd|v|fffd||14f|I|fffd||fffd||64fe|
    procCdEndCol = wsWL.Cells(WL_2ND_KEY_ROW_NUM, wsWL.Columns.Count).End(xlToLeft).Column


    With ws03081
    
        .Activate
        
        ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD
    
        ' |fffd||fffd||fffd||fffd||fffd|s|fffd||311|S|fffd|s|fffd||d3dc|
        oldMaxRow = .Cells(.Rows.Count, COL_03081_NO).End(xlUp).Row
        If oldMaxRow > DATA_TITLE_ROW_NUM Then
            .Range(DATA_START_ROW_NUM & ":" & oldMaxRow).Delete
        End If
        targetRow = DATA_START_ROW_NUM
        
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|\|fffd||fffd|
        .Rows(DATA_START_ROW_NUM).Hidden = False
       
        ' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Call createConnection(conn)
        
        ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Set rs = New ADODB.Recordset
        sql = "SELECT proc_cd, proc_name, biz_cd, valid_start_dtime, valid_end_dtime FROM [proc_mst$] "
        sql = sql & "WHERE nullification_flg = '0' "
        sql = sql & "AND logic_del_flg = '0' "

' |fffd|u|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd|A|fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||302||702||702||202||302||141|A|fffd|I|fffd||fffd||fffd||3c2||30e||fffd||fffd||fffd||fffd||8471||fffd||351||38f||6ca|O|fffd|j
''        sql = sql & "AND CDate(valid_start_dtime) <= #" & getRirekiData() & "# "
        'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
        sql = sql & "AND CDate(valid_end_dtime) >= #" & getRirekiData() & "# "
'        'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171124 start --------------------------------------------------------------
'        sql = sql & "AND CDate(valid_end_dtime) >= #" & getPreRirekiData() & "# "
''        sql = sql & "AND CDate(valid_end_dtime) >= #" & getRirekiData() & "# "
'        'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171124 end --------------------------------------------------------------
        'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
        rs.Open sql, conn, adOpenStatic

        ' |fffd||189||f396||fffd||fffd||fffd||143||fffd||fffd|[|fffd|v
        rowCnt = 0
        For loopJ = startRow To proEndRow
            
            before_03081 = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM + 3)
            after_03081 = wsCreate.Cells(loopJ, C_NUMBER_USE_LAW_COL_NUM + 4)
            
            ' |fffd||fffd||fffd|~|fffd|g|fffd||74d||fffd||fffd||d0b9||fffd|`|fffd|F|fffd|b|fffd|N
            If (before_03081 = STATUS_NG) And _
                (Len(Trim(after_03081)) = 0) Then
                
                ' |fffd|u|fffd||fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|v
            
            Else
                
                ' |fffd||fffd||fffd||7cd||fffd||fffd||752|l|fffd||fffd||fffd||fffd|biz_cd|fffd||fffd||fffd||64fe|
                biz_cd = wsCreate.Cells(loopJ, C_BIZ_P_I_CD_COL_NUM)
            
                ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||752||fffd|
                rs.Filter = adFilterNone
                rs.Filter = "biz_cd = '" & biz_cd & "'"
                
                ' |fffd||fffd||fffd||fffd||fffd||8471||fffd||243||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||fffd||a347||fffd||302||741|A|fffd|s|fffd||1c9||fffd|
                If CLng(rs.RecordCount) > 0 Then
                    
                    ' 20170915 DEL |fffd|s|fffd|}|fffd||fffd||fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||fffd|1|fffd|s|fffd|P|fffd||291|}|fffd||fffd||fffd||255||3cd|X
''                    ' |fffd|s|fffd|}|fffd||fffd|
''                    targetRow = .Cells(.Rows.Count, COL_03081_BIZ_NUM2).End(xlUp).Row + 1
''                    .Rows(targetRow).Copy
''                    .Rows(targetRow & ":" & targetRow + CLng(rs.RecordCount) - 1).Insert
            
                    For loopJM = 1 To CLng(rs.RecordCount)
                    
                        ' 20170915 DEL |fffd|s|fffd|J|fffd|E|fffd||fffd||fffd|g|fffd||343||fffd||fffd|R|fffd|[|fffd|h|fffd|}|fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd|{
                        '' rowCnt = rowCnt + 1
                        proc_cd = rs.Fields("proc_cd")
                        existWL = False
                        
' 20170915 ADD
' -------------------------------------------------------------------------------------
                        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||30f||a347||fffd||302||741|A|fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||303|J|fffd||fffd||fffd||fffd||fffd||292|u|fffd|m|fffd|F
                        If organCdCnt > 0 Then
 On Error Resume Next
                            ' ****************************************
                            '   WL|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                            ' ****************************************
                            ' |fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|J|fffd|n|fffd||fffd||64fe|
                            ret = Empty
                            ret = Application.WorksheetFunction.Match(biz_cd, wsWL.Rows(WL_1ST_KEY_ROW_NUM), 0)
                            If IsError(ret) Then
                                bizCdCol = 0
                                procCdCol = 0
                                Err.Clear
                            Else
                                bizCdCol = CLng(ret)
                            End If
                                
                            ' |fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd|J|fffd|n|fffd||fffd||64fe|
                            If bizCdCol <> 0 Then
                                ret = Empty
                                ret = Application.WorksheetFunction.Match(proc_cd, _
                                    wsWL.Range(wsWL.Cells(WL_2ND_KEY_ROW_NUM, bizCdCol), wsWL.Cells(WL_2ND_KEY_ROW_NUM, procCdEndCol)), 0)
                                If IsError(ret) Then
                                    procCdCol = 0
                                    Err.Clear
                                Else
                                    procCdCol = bizCdCol + CLng(ret) - 1
                                End If
                            End If
On Error GoTo ERR_HND
                            ' |fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||fffd||30e||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||38f||6c3|R|fffd|[|fffd|h|fffd||142||fffd||fffd||90a9||fffd||30a|m|fffd|F
                            ' --- 20171227 mod start ---
''                            If procCdCol <> 0 And wsWL.Cells(WL_1ST_KEY_ROW_NUM, procCdCol).Value = biz_cd Then
''                                existWL = True
''                            End If
                            ' --------------------------
                            If procCdCol <> 0 Then
                                If wsWL.Cells(WL_1ST_KEY_ROW_NUM, procCdCol).Value = biz_cd Then existWL = True
                            End If
                            ' --- 20171227 mod end   ---
                        
                        End If
                        
                        organCdExecCnt = 0
                        procCdOutCnt = 0
                        Do
                            ' |fffd||38f||6c2||30e||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||317||fffd|WL|fffd||242||fffd||fffd||fffd||a347||fffd|A|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd|`|fffd|F|fffd|b|fffd|N
                            If existWL = True Then
                                
                                Do While (organCdExecCnt < organCdCnt)
                                    
                                    ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||30e||64fe|
                                    wl_status = wsWL.Cells((organCdRow + organCdExecCnt), procCdCol).Value
                                    
                                    ' |fffd||fffd||fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd|u|fffd||3d4|C|fffd||fffd||fffd||fffd|v|fffd||30f||a347||fffd|A|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd||315||6ce||fffd|
                                    If wl_status = "1" Or wl_status = "2" Then
''                                        organCdExecCnt = loopO
                                        Exit Do
                                    End If
                                    
                                    organCdExecCnt = organCdExecCnt + 1
                                
                                Loop
                                                            
                                If organCdExecCnt = organCdCnt Then
                                    existWL = False
                                End If
                            
                            End If
                            
                            'UPD 20171127 |fffd||6d1||fffd|49 |fffd||389||fffd| start --------------------------------------------
                            '|fffd||fffd||fffd||fffd||fffd||8471||fffd||301|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd|2099/1/1|fffd||142||fffd||fffd||fffd||381|AWL|fffd||30a|m|fffd|FOK
                            '|fffd||fffd||fffd||fffd||fffd||8471||fffd||301|u|fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd|v|fffd||fffd|2099/1/1|fffd||142||fffd||fffd||fffd||381|AWL|fffd||30a|m|fffd|FOK|fffd||fffd||fffd|A|fffd|P|fffd||fffd||fffd||fffd||fffd|o|fffd||342||fffd||fffd||102||fffd||fffd||202||fffd||fffd|iWL|fffd||202||fffd||fffd|A|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd|S|fffd||101|u|fffd||3d4|C|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|v|fffd|j
                            '|fffd||30f||a347||fffd|A|fffd|s|fffd|}|fffd||fffd||fffd||38f||fffd|
                            ' WL|fffd||30a|m|fffd|FOK|fffd||fffd||fffd|A|fffd|P|fffd||fffd||fffd||fffd||fffd|o|fffd||342||fffd||fffd||102||fffd||fffd||202||fffd||fffd|iWL|fffd||202||fffd||fffd|A|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd|S|fffd||101|u|fffd||3d4|C|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|v|fffd|j|fffd||a347||fffd|A|fffd|s|fffd|}|fffd||fffd||fffd||38f||fffd|
                            If CDate(rs.Fields("valid_start_dtime")) >= CDate(STR_BASE_DATE_END) And existWL = True _
                            Or CDate(rs.Fields("valid_start_dtime")) < CDate(STR_BASE_DATE_END) And ((existWL = True) Or (procCdOutCnt = 0)) Then
'                            ' WL|fffd||30a|m|fffd|FOK|fffd||fffd||fffd|A|fffd|P|fffd||fffd||fffd||fffd||fffd|o|fffd||342||fffd||fffd||102||fffd||fffd||202||fffd||fffd|iWL|fffd||202||fffd||fffd|A|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd|S|fffd||101|u|fffd||3d4|C|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|v|fffd|j|fffd||a347||fffd|A|fffd|s|fffd|}|fffd||fffd||fffd||38f||fffd|
'                            If (existWL = True) Or (procCdOutCnt = 0) Then
                            'UPD 20171127 |fffd||6d1||fffd|49 |fffd||389||fffd| end --------------------------------------------
                        
''                                targetRow = .Cells(.Rows.Count, COL_03081_BIZ_NUM2).End(xlUp).Row + 1
                                .Rows(targetRow).Copy
                                .Rows(targetRow).Insert

                                rowCnt = rowCnt + 1
                                procCdOutCnt = procCdOutCnt + 1
' -------------------------------------------------------------------------------------
                        
                                ' No|fffd|E|fffd||295|\|fffd||fffd||4d014||501|E|fffd||fffd||fffd||fffd||fffd||fffd|
                                .Cells(targetRow, COL_03081_NO).Value = rowCnt
                                .Cells(targetRow, COL_03081_BIZ_NUM2).Value = wsCreate.Cells(loopJ, C_NUMBER_COL_NUM).Value
                                .Cells(targetRow, COL_03081_BIZ_NAME).Value = wsCreate.Cells(loopJ, C_BIZ_P_I_NAME_COL_NUM).Value
                                
                                .Range(.Cells(targetRow, COL_03081_NO).Address, .Cells(targetRow, COL_03081_BIZ_NAME)).Interior.color = wsCreate.Cells(loopJ, C_NUMBER_COL_NUM).Interior.color
                                
                                ' |fffd||1d7||fffd||fffd||50d||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||8471||fffd||fffd|
                                ' UPD 20171031 |fffd||6d1||fffd|No.55 |fffd||389||fffd| start --------------------------------------------
                                .Cells(targetRow, COL_03081_PROC_NUM).Value = getProcNum(proc_cd)
'                                .Cells(targetRow, COL_03081_PROC_NUM).Value = Val(Mid(proc_cd, 4, 3)) & "-" & Val(Right(proc_cd, 6))
                                ' UPD 20171031 |fffd||6d1||fffd|No.55 |fffd||389||fffd| end --------------------------------------------
                                .Cells(targetRow, COL_03081_PROC_NAME).Value = rs.Fields("proc_name")
        
                                ' |fffd|B|fffd||fffd||fffd||fffd||fffd||681|F|fffd|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd|E|fffd|I|fffd||fffd||fffd||fffd|
                                .Cells(targetRow, COL_CHK_START_DTIME).Value = rs.Fields("valid_start_dtime")
                                .Cells(targetRow, COL_CHK_END_DTIME).Value = rs.Fields("valid_end_dtime")

' 20170915 DEL WL|fffd||311||fffd||fffd||74a|m|fffd|F|fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||fffd||fffd||3cd|X
' -------------------------------------------------------------------------------------
''                        ' WL|fffd||311||fffd||fffd||74a|m|fffd|F
''                        If organCdRow <> 0 Then
''On Error Resume Next
''                            ' ****************************************
''                            '   WL|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
''                            ' ****************************************
''                            ' |fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|J|fffd|n|fffd||fffd||64fe|
''                            ret = Empty
''                            ret = Application.WorksheetFunction.match(biz_cd, wsWL.Rows(WL_1ST_KEY_ROW_NUM), 0)
''                            If IsError(ret) Then
''                                bizCdCol = 0
''                                procCdCol = 0
''                                Err.Clear
''                            Else
''                                bizCdCol = CLng(ret)
''                            End If
''
''                            ' |fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd|J|fffd|n|fffd||fffd||64fe|
''                            If bizCdCol <> 0 Then
''                                ret = Empty
''                                ret = Application.WorksheetFunction.match(proc_cd, _
''                                    wsWL.Range(wsWL.Cells(WL_2ND_KEY_ROW_NUM, bizCdCol), wsWL.Cells(WL_2ND_KEY_ROW_NUM, procCdEndCol)), 0)
''                                If IsError(ret) Then
''                                    procCdCol = 0
''                                    Err.Clear
''                                Else
''                                    procCdCol = bizCdCol + CLng(ret) - 1
''                                End If
''                            End If
''
''                            ' |fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||fffd||30e||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||38f||6c3|R|fffd|[|fffd|h|fffd||142||fffd||fffd||90a9||fffd||30a|m|fffd|F
''                            If procCdCol <> 0 And wsWL.Cells(WL_1ST_KEY_ROW_NUM, procCdCol).Value = biz_cd Then
''                                ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||30e||64fe|
''                                wl_status = wsWL.Cells(organCdRow, procCdCol).Value
''                                If wl_status = "1" Or wl_status = "2" Then
''                                    existWL = True
''                                End If
''                            End If
''On Error GoTo ERR_HND
''                        End If
' -------------------------------------------------------------------------------------
                                
                                ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||310||752||fffd|
                                .Cells(targetRow, COL_03081_BASIS_LAWS).Value = NONE_VALUE
                                .Cells(targetRow, COL_03081_ATTACH).Value = NONE_VALUE
                                .Cells(targetRow, COL_03081_ORGAN_CHECK).Value = NONE_VALUE
                                
                                If existWL = True Then
                                    .Cells(targetRow, COL_03081_REG_STATUS).Value = DATA_REGISTERED
                                    .Cells(targetRow, COL_03081_ACCEPT_BIZ).Value = CHECK_OK
                                    
                                    ' 20170915 MOD
                                    ''.Cells(targetRow, COL_03081_ORGAN_CD).Value = wsWL.Cells(organCdRow, procCdCol + 1).Value
                                    .Cells(targetRow, COL_03081_ORGAN_CD).Value = wsWL.Cells((organCdRow + organCdExecCnt), procCdCol + 1).Value
                                    
                                    ' |fffd|@|fffd||596||fffd|
                                    If organDic.Exists(.Cells(targetRow, COL_03081_ORGAN_CD).Value) = True Then
                                        .Cells(targetRow, COL_03081_ORGAN_NAME).Value = organDic.item(.Cells(targetRow, COL_03081_ORGAN_CD).Value)
                                    Else
                                        .Cells(targetRow, COL_03081_ORGAN_NAME).Value = "[ERROR]|fffd|@|fffd||596||fffd||fffd||fffd||fffd||fffd||fffd|o[ERROR]"
                                    End If
                                    
                                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                                    .Cells(targetRow, COL_03081_REQUEST).Validation.Modify _
                                        Formula1:=REQUEST_DELETE & "," & REQUEST_UPDATE & "," & NONE_VALUE
                                    
                                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
                                    .Cells(targetRow, COL_03081_REQUEST).Value = IIf(after_03081 = STATUS_NG, REQUEST_DELETE, NONE_VALUE)
                                    
                                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
                                    .Cells(targetRow, COL_03081_REQUEST).Locked = IIf(after_03081 = STATUS_CHANGE, False, True)
                                Else
                                    .Cells(targetRow, COL_03081_REG_STATUS).Value = DATA_UNREGISTERED
                                    .Cells(targetRow, COL_03081_ACCEPT_BIZ).Value = NONE_VALUE
                                    
                                    ' |fffd|\|fffd||fffd||fffd||656a|
                                    .Cells(targetRow, COL_03081_REQUEST).Validation.Modify _
                                        Formula1:=REQUEST_ENTRY & "," & NONE_VALUE
                                    .Cells(targetRow, COL_03081_REQUEST).Value = NONE_VALUE
                                    
                                    ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
                                    Select Case after_03081
                                        Case STATUS_OK, STATUS_CHANGE
                                            .Cells(targetRow, COL_03081_REQUEST).Locked = False
                                        Case Else
                                            .Cells(targetRow, COL_03081_REQUEST).Locked = True
                                    End Select
                                    
                                End If
                   
                                ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||303|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|s
                                Call execRowLock(ws03081, .Cells(targetRow, COL_03081_REQUEST))
                                
                                ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|[|fffd||]|fffd|A|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|\|fffd||fffd||fffd||656a||fffd||20d|~|fffd||311|S|fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||14482||242||fffd||fffd||fffd|
                                If .Cells(targetRow, COL_03081_REQUEST).Value = NONE_VALUE And _
                                    .Cells(targetRow, COL_03081_REQUEST).Locked = True Then
                
                                    .Range(.Cells(targetRow, COL_03081_REQUEST).Address, .Cells(targetRow, COL_03081_END_DATE)).Interior.color = vbWhite
                                End If
                            
                                targetRow = targetRow + 1
' 20170915 ADD
' -------------------------------------------------------------------------------------
                            End If
                            
                            organCdExecCnt = organCdExecCnt + 1
                        Loop While (organCdExecCnt < organCdCnt)

                        ' 1|fffd||fffd||fffd||fffd||fffd||8471||fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
                        DoEvents
' -------------------------------------------------------------------------------------

                        rs.MoveNext
                    Next
                
                End If
            
            End If
        
            ' 20170915 MOD |fffd||fffd||fffd||fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||3cd|X
            ''' 10|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
            ''If loopJ Mod 10 = 0 Then DoEvents
''            ' 1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
''            DoEvents
        Next
    
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|
        If targetRow <> DATA_START_ROW_NUM Then
            .Rows(targetRow).Hidden = True
        End If

        ' |fffd||64ea||fffd|J|fffd||fffd|
        .Select
        ActiveWindow.ScrollColumn = 1
        ActiveWindow.ScrollRow = 1
        .Range("A1").Select

    End With

    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ws03081, TOOL_LOCK_PWD)

    Call closeRecordset(rs)
    Set conn = Nothing
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description
    
    Call closeRecordset(rs)
    
    ' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||309||fffd||fffd|
    If Not conn Is Nothing Then Set conn = Nothing

End Sub

' |fffd|l|fffd||fffd|03-08(2)|fffd||313|W|fffd|J|fffd||fffd||fffd||fffd|
Private Sub createForm03082(ByVal startRow As Long, ByVal proEndRow As Long, ByVal organ_cd As String)

    Dim ws03082         As Worksheet
    Dim wsCreate        As Worksheet
    Dim wsWL            As Worksheet
    Dim oldMaxRow       As Long
    Dim targetRow       As Long
    Dim rowCnt          As Long         ' |fffd|uNo|fffd|v|fffd|J|fffd||fffd||fffd||fffd||fffd||50d||fffd|
    Dim loopP           As Long         ' |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|v|fffd|p|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    Dim organCdRow      As Long         ' |fffd|u|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||30d|s|fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim nameCdCol       As Long         ' |fffd|u|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||30a|J|fffd|n|fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim p_i_name_cd     As String
    Dim wl_status       As String
    Dim ret             As Variant
    Dim existWL         As Boolean
    Dim organCdCol      As Collection   ' |fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd|
    Dim searchStartRow  As Long
    Dim searchproEndRow    As Long
    Dim loopCnt         As Long
    Dim insRowCnt       As Long
    
    ' |fffd|\|fffd||fffd||301||fffd||fffd|~
    Dim before_03082    As String
    Dim after_03082     As String
    

On Error GoTo ERR_HND
 
    ' |fffd||38f||6c3||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30e||64fe|
    Set ws03082 = ThisWorkbook.Sheets("|fffd|l03-08_2")
    Set wsCreate = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME)
    Set wsWL = ThisWorkbook.Worksheets(WL4_NAME)

    With ws03082
    
        .Activate
        
        ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD
    
        ' |fffd||fffd||fffd||fffd||fffd|s|fffd||311|S|fffd|s|fffd||d3dc|
        oldMaxRow = .Cells(.Rows.Count, COL_03082_NO).End(xlUp).Row
        If oldMaxRow > DATA_TITLE_ROW_NUM Then
            .Range(DATA_START_ROW_NUM & ":" & oldMaxRow).Delete
        End If
        targetRow = DATA_START_ROW_NUM
        
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|\|fffd||fffd|
        .Rows(DATA_START_ROW_NUM).Hidden = False

        ' |fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd||143||fffd||fffd|[|fffd|v
        rowCnt = 0
        For loopP = startRow To proEndRow
            
            before_03082 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 5)
            after_03082 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 6)
            
            ' |fffd||fffd||fffd|~|fffd|g|fffd||74d||fffd||fffd||d0b9||fffd|`|fffd|F|fffd|b|fffd|N
            If (before_03082 = STATUS_NG) And _
                (Len(Trim(after_03082)) = 0) Then
                
                ' |fffd|u|fffd||fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|v
            
            Else
                
                ' |fffd||fffd||fffd||7cd||fffd||fffd||752|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||64fe|
                p_i_name_cd = wsCreate.Cells(loopP, C_BIZ_P_I_CD_COL_NUM)
                
                Set organCdCol = New Collection
                existWL = False
    
On Error Resume Next
                ' ****************************************
                '
                ' ****************************************
                ' |fffd||38f||6c2||182||202||fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||fffd||64fe|
                ret = Empty
                ret = Application.WorksheetFunction.Match(p_i_name_cd, wsWL.Rows(WL_1ST_KEY_ROW_NUM), 0)
                If IsError(ret) Then
                    nameCdCol = 0
                    Err.Clear
                Else
                    nameCdCol = CLng(ret)
                End If
                                
                If nameCdCol <> 0 Then
                    nameCdCol = nameCdCol + 1
                    searchStartRow = WL4_DATA_START_ROW_NUM
                    searchproEndRow = wsWL.Cells(wsWL.Rows.Count, nameCdCol).End(xlUp).Row
                           
                    Do While (searchStartRow <= searchproEndRow)
                        ret = Empty
                        ret = Application.WorksheetFunction.Match(organ_cd, wsWL.Range(wsWL.Cells(searchStartRow, nameCdCol), wsWL.Cells(searchproEndRow, nameCdCol)), 0)
                        If IsError(ret) Then
                            organCdRow = 0
                            Err.Clear
                        Else
                            organCdRow = CLng(ret)
                        End If
                
                        If organCdRow > 0 Then
                            organCdCol.Add wsWL.Cells(searchStartRow + organCdRow - 1, WL_ORGAN_CD_COL_NUM).Value
                        Else
                            Exit Do
                        End If
                            
                        searchStartRow = searchStartRow + organCdRow
                    Loop
                End If
On Error GoTo ERR_HND
                    
                ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||30e||64fe||fffd|L|fffd||fffd||fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                If organCdCol.Count > 0 Then
                    insRowCnt = organCdCol.Count
                    existWL = True
                Else
                    insRowCnt = 1
                End If
                
                For loopCnt = 1 To insRowCnt
                
                    ' |fffd|s|fffd|}|fffd||fffd|
                    .Rows(targetRow).Copy
                    .Rows(targetRow).Insert
                    
                    rowCnt = rowCnt + 1
                
                    ' No|fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
                    .Cells(targetRow, COL_03082_NO).Value = rowCnt
                    .Cells(targetRow, COL_03082_NUMBER).Value = wsCreate.Cells(loopP, C_NUMBER_COL_NUM).Value
                    .Cells(targetRow, COL_03082_NAME).Value = wsCreate.Cells(loopP, C_BIZ_P_I_NAME_COL_NUM).Value
    
                    .Range(.Cells(targetRow, COL_03082_NO).Address, .Cells(targetRow, COL_03082_NAME)).Interior.color = wsCreate.Cells(loopP, C_NUMBER_COL_NUM).Interior.color

                    ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||310||752||fffd|
                    If existWL = True Then
                        .Cells(targetRow, COL_03082_REG_STATUS).Value = DATA_REGISTERED
                        .Cells(targetRow, COL_03082_DELEGATE).Value = CHECK_OK
                        .Cells(targetRow, COL_03082_ORGAN_CD).Value = organCdCol.item(loopCnt)
                        
                        ' |fffd|@|fffd||596||fffd|
                        If organDic.Exists(.Cells(targetRow, COL_03082_ORGAN_CD).Value) = True Then
                            .Cells(targetRow, COL_03082_ORGAN_NAME).Value = organDic.item(.Cells(targetRow, COL_03082_ORGAN_CD).Value)
                        Else
                            .Cells(targetRow, COL_03082_ORGAN_NAME).Value = "[ERROR]|fffd|@|fffd||596||fffd||fffd||fffd||fffd||fffd||fffd|o[ERROR]"
                        End If
                        
                        ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                        .Cells(targetRow, COL_03082_REQUEST).Validation.Modify _
                            Formula1:=REQUEST_DELETE & "," & NONE_VALUE
                                
                        ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
                        .Cells(targetRow, COL_03082_REQUEST).Value = IIf(after_03082 = STATUS_NG, REQUEST_DELETE, NONE_VALUE)
                        
                        ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
                        .Cells(targetRow, COL_03082_REQUEST).Locked = IIf(after_03082 = STATUS_CHANGE, False, True)
                    Else
                        .Cells(targetRow, COL_03082_REG_STATUS).Value = DATA_UNREGISTERED
                        .Cells(targetRow, COL_03082_DELEGATE).Value = NONE_VALUE
                        
                        ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                        .Cells(targetRow, COL_03082_REQUEST).Validation.Modify _
                            Formula1:=REQUEST_ENTRY & "," & NONE_VALUE
                        
                        ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
                        .Cells(targetRow, COL_03082_REQUEST).Value = IIf(after_03082 = STATUS_OK, REQUEST_ENTRY, NONE_VALUE)
                        
                        ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
                        .Cells(targetRow, COL_03082_REQUEST).Locked = True
                        
                    End If
                    
                    'ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc|(|fffd|C|fffd||fffd|) |fffd||6d1||fffd|35|fffd||389||fffd| 20190613 start ------------------------------------
                    ' |fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||313|o|fffd|^|fffd||cbd42||312|l|fffd||fffd|l03-08_2|fffd|V|fffd|[|fffd|g|fffd||fffd|AL|fffd||fffd||583|R|fffd|s|fffd|[
                    .Cells(targetRow, COL_LAW_OBLIGATION_FLG + 6).Value = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 6).Value
                    'ADD |fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||311|S|fffd||d3dc|(|fffd|C|fffd||fffd|) |fffd||6d1||fffd|35|fffd||389||fffd| 20190613 end --------------------------------------
                    
                    ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||303|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|s
                    Call execRowLock(ws03082, .Cells(targetRow, COL_03082_REQUEST))
                    
                    ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|[|fffd||]|fffd|A|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|\|fffd||fffd||fffd||656a||fffd||20d|~|fffd||311|S|fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||14482||242||fffd||fffd||fffd|
                    If .Cells(targetRow, COL_03082_REQUEST).Value = NONE_VALUE And _
                        .Cells(targetRow, COL_03082_REQUEST).Locked = True Then
    
                        .Range(.Cells(targetRow, COL_03082_REQUEST).Address, .Cells(targetRow, COL_03082_ORGAN_NAME)).Interior.color = vbWhite
                    End If
                    
                    targetRow = targetRow + 1
                
                Next
            
            End If
        
            ' 10|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
            If loopP Mod 10 = 0 Then DoEvents
        Next
    
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|
        If targetRow <> DATA_START_ROW_NUM Then
            .Rows(targetRow).Hidden = True
        End If

        ' |fffd||64ea||fffd|J|fffd||fffd|
        .Select
        ActiveWindow.ScrollColumn = 1
        ActiveWindow.ScrollRow = 1
        .Range("A1").Select

    End With

    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ws03082, TOOL_LOCK_PWD)

    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd|l|fffd||fffd|03-08(3)|fffd||313|W|fffd|J|fffd||fffd||fffd||fffd|
Private Sub createForm03083(ByVal startRow As Long, ByVal proEndRow As Long, ByVal organ_cd As String)

    Dim ws03083         As Worksheet
    Dim wsCreate        As Worksheet
    Dim wsWL            As Worksheet
    Dim oldMaxRow       As Long
    Dim targetRow       As Long
    Dim rowCnt          As Long         ' |fffd|uNo|fffd|v|fffd|J|fffd||fffd||fffd||fffd||fffd||50d||fffd|
    Dim loopP           As Long         ' |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|v|fffd|p|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    Dim organCdRow      As Long         ' |fffd|u|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30d|s|fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim nameCdCol       As Long         ' |fffd|u|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||30a|J|fffd|n|fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim p_i_name_cd     As String
    Dim wl_status       As String
    Dim ret             As Variant
    Dim existWL         As Boolean
    
    ' |fffd|\|fffd||fffd||301||fffd||fffd|~
    Dim before_03083    As String
    Dim after_03083     As String
    
    Dim organCdCnt      As Long         ' 20170917 ADD |fffd|u|fffd||4b7c8||3d1||fffd||fffd||fffd||fffd||3d1||fffd||fffd||60ca||fffd|X|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30d|s|fffd||fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|0
    Dim organCdExecCnt  As Long         ' 20170917 ADD |fffd||fffd||fffd||302||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd|B0|fffd||30f||a347||fffd||142||fffd|1|fffd||fffd||34e||fffd||fffd|{|fffd||fffd||fffd||fffd||60a4||fffd||24f||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||30e||fffd|
    Dim nameCdOutCnt    As Long         ' 20170917 ADD |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f0f|o|fffd||343|J|fffd|E|fffd||fffd||fffd|^|fffd|F|fffd|P|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56202||243||fffd||fffd|Z|fffd|b|fffd|g


On Error GoTo ERR_HND
 
    ' |fffd||38f||6c3||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30e||64fe|
    Set ws03083 = ThisWorkbook.Sheets("|fffd|l03-08_3")
    Set wsCreate = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME)
    Set wsWL = ThisWorkbook.Worksheets(WL4_NAME)
    
On Error Resume Next

    ' WL|fffd||301|u|fffd||3d4|C|fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||38f||6cd|s|fffd||64fe|
    ret = Application.WorksheetFunction.Match(organ_cd, wsWL.Columns(WL_ORGAN_CD_COL_NUM), 0)
    If IsError(ret) Then
        organCdRow = 0
        ' 20170917 ADD
        organCdCnt = 0
        Err.Clear
    Else
        organCdRow = CLng(ret)
        ' 20170917 ADD
        organCdCnt = WorksheetFunction.CountIf(wsWL.Columns(WL_ORGAN_CD_COL_NUM), organ_cd)
    End If
    
    
On Error GoTo ERR_HND

    With ws03083
    
        .Activate
        
        ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
        .Unprotect Password:=TOOL_LOCK_PWD
    
        ' |fffd||fffd||fffd||fffd||fffd|s|fffd||311|S|fffd|s|fffd||d3dc|
        oldMaxRow = .Cells(.Rows.Count, COL_03083_NO).End(xlUp).Row
        If oldMaxRow > DATA_TITLE_ROW_NUM Then
            .Range(DATA_START_ROW_NUM & ":" & oldMaxRow).Delete
        End If
        targetRow = DATA_START_ROW_NUM
        
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|\|fffd||fffd|
        .Rows(DATA_START_ROW_NUM).Hidden = False

        ' |fffd||4b7d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd||143||fffd||fffd|[|fffd|v
        rowCnt = 0
        For loopP = startRow To proEndRow
            
            before_03083 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 3)
            after_03083 = wsCreate.Cells(loopP, C_NUMBER_USE_LAW_COL_NUM + 4)
            
            ' |fffd||fffd||fffd|~|fffd|g|fffd||74d||fffd||fffd||d0b9||fffd|`|fffd|F|fffd|b|fffd|N
            If (before_03083 = STATUS_NG) And _
                (Len(Trim(after_03083)) = 0) Then
                
                ' |fffd|u|fffd||fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|v
            
            Else
                
                ' |fffd||fffd||fffd||7cd||fffd||fffd||752|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||64fe|
                p_i_name_cd = wsCreate.Cells(loopP, C_BIZ_P_I_CD_COL_NUM)
                    
                ' 20170917 DEL |fffd|s|fffd|}|fffd||fffd||fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||3cd|X
''                ' |fffd|s|fffd|}|fffd||fffd|
''                .Rows(targetRow).Copy
''                .Rows(targetRow).Insert
''
''                rowCnt = rowCnt + 1
                existWL = False
                       
' 20170917 ADD
' -------------------------------------------------------------------------------------
                ' WL|fffd||311||fffd||fffd||74a|m|fffd|F
                If organCdRow <> 0 Then

On Error Resume Next
                    
                    ' ****************************************
                    '   WL|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                    ' ****************************************
                    ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|J|fffd|n|fffd||fffd||64fe|
                    ret = Empty
                    ret = Application.WorksheetFunction.Match(p_i_name_cd, wsWL.Rows(WL_1ST_KEY_ROW_NUM), 0)
                    If IsError(ret) Then
                        nameCdCol = 0
                        Err.Clear
                    Else
                        nameCdCol = CLng(ret)
                    End If

On Error GoTo ERR_HND
                    
                    If nameCdCol <> 0 Then
                        existWL = True
                    End If
                
                End If

                organCdExecCnt = 0
                nameCdOutCnt = 0
                
                Do
                    ' |fffd||38f||6c2||313||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||fffd|WL|fffd||242||fffd||fffd||fffd||a347||fffd|A|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd|`|fffd|F|fffd|b|fffd|N
                    If existWL = True Then
                    
                        Do While (organCdExecCnt < organCdCnt)
                        
                        ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||30e||64fe|
                        wl_status = wsWL.Cells((organCdRow + organCdExecCnt), nameCdCol).Value
                        
                            ' |fffd||fffd||fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd|u|fffd||3d4|C|fffd||fffd||fffd||fffd|v|fffd||30f||a347||fffd|A|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd||315||6ce||fffd|
                            If wl_status = "1" Or wl_status = "2" Then
                                Exit Do
                            End If
                            
                            organCdExecCnt = organCdExecCnt + 1
                            
                        Loop
                        
                        If organCdExecCnt = organCdCnt Then
                            existWL = False
                        End If
                        
                    End If
                            
                    ' WL|fffd||30a|m|fffd|FOK|fffd||fffd||fffd|A|fffd|P|fffd||fffd||fffd||fffd||fffd|o|fffd||342||fffd||fffd||102||fffd||fffd||202||fffd||fffd|iWL|fffd||202||fffd||fffd|A|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd|S|fffd||101|u|fffd||3d4|C|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|v|fffd|j|fffd||a347||fffd|A|fffd|s|fffd|}|fffd||fffd||fffd||38f||fffd|
                    If (existWL = True) Or (nameCdOutCnt = 0) Then
                    
                        .Rows(targetRow).Copy
                        .Rows(targetRow).Insert
    
                        rowCnt = rowCnt + 1
                        nameCdOutCnt = nameCdOutCnt + 1
' -------------------------------------------------------------------------------------
                        
                        ' No|fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd||fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
                        .Cells(targetRow, COL_03083_NO).Value = rowCnt
                        .Cells(targetRow, COL_03083_NUMBER).Value = wsCreate.Cells(loopP, C_NUMBER_COL_NUM).Value
                        .Cells(targetRow, COL_03083_NAME).Value = wsCreate.Cells(loopP, C_BIZ_P_I_NAME_COL_NUM).Value
                        
                        ' |fffd|B|fffd||fffd||fffd||fffd||fffd||681|F|fffd|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd|E|fffd|I|fffd||fffd||fffd||fffd|
                        .Cells(targetRow, COL_CHK_START_DTIME).Value = wsCreate.Cells(loopP, C_START_DTIME_COL_NUM).Value
                        .Cells(targetRow, COL_CHK_END_DTIME).Value = wsCreate.Cells(loopP, C_END_DTIME_COL_NUM).Value
                        
                        .Range(.Cells(targetRow, COL_03083_NO).Address, .Cells(targetRow, COL_03083_NAME)).Interior.color = wsCreate.Cells(loopP, C_NUMBER_COL_NUM).Interior.color

' 20170917 DEL WL|fffd||311||fffd||fffd||74a|m|fffd|F|fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||fffd||fffd||3cd|X
' -------------------------------------------------------------------------------------
''                ' WL|fffd||311||fffd||fffd||74a|m|fffd|F
''                If organCdRow <> 0 Then
''On Error Resume Next
''                    ' ****************************************
''                    '   WL|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
''                    ' ****************************************
''                    ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|J|fffd|n|fffd||fffd||64fe|
''                    ret = Empty
''                    ret = Application.WorksheetFunction.Match(p_i_name_cd, wsWL.Rows(WL_1ST_KEY_ROW_NUM), 0)
''                    If IsError(ret) Then
''                        nameCdCol = 0
''                        Err.Clear
''                    Else
''                        nameCdCol = CLng(ret)
''                    End If
''
''                    If nameCdCol <> 0 Then
''                        ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||30e||64fe|
''                        wl_status = wsWL.Cells(organCdRow, nameCdCol).Value
''                        If wl_status = "1" Or wl_status = "2" Then
''                            existWL = True
''                        End If
''                    End If
''On Error GoTo ERR_HND
''                End If
' -------------------------------------------------------------------------------------
                        
                        ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||310||752||fffd|
                        .Cells(targetRow, COL_03083_BASIS_LAWS).Value = NONE_VALUE
                        .Cells(targetRow, COL_03083_ATTACH).Value = NONE_VALUE
                        
                        If existWL = True Then
                            .Cells(targetRow, COL_03083_REG_STATUS).Value = DATA_REGISTERED
                            
                            ' 20170917 MOD
                            ''.Cells(targetRow, COL_03083_ORGAN_CD).Value = wsWL.Cells(organCdRow, nameCdCol + 1).Value
                            .Cells(targetRow, COL_03083_ORGAN_CD).Value = wsWL.Cells((organCdRow + organCdExecCnt), nameCdCol + 1).Value
                            
                            ' |fffd|@|fffd||596||fffd|
                            If organDic.Exists(.Cells(targetRow, COL_03083_ORGAN_CD).Value) = True Then
                                .Cells(targetRow, COL_03083_ORGAN_NAME).Value = organDic.item(.Cells(targetRow, COL_03083_ORGAN_CD).Value)
                            Else
                                .Cells(targetRow, COL_03083_ORGAN_NAME).Value = "[ERROR]|fffd|@|fffd||596||fffd||fffd||fffd||fffd||fffd||fffd|o[ERROR]"
                            End If
                            
                            ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                            .Cells(targetRow, COL_03083_REQUEST).Validation.Modify _
                                Formula1:=REQUEST_DELETE & "," & REQUEST_UPDATE & "," & NONE_VALUE
                                    
                            ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
                            .Cells(targetRow, COL_03083_REQUEST).Value = IIf(after_03083 = STATUS_NG, REQUEST_DELETE, NONE_VALUE)
                            
                            ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
                            .Cells(targetRow, COL_03083_REQUEST).Locked = IIf(after_03083 = STATUS_CHANGE, False, True)
                        Else
                            .Cells(targetRow, COL_03083_REG_STATUS).Value = DATA_UNREGISTERED
                            
                            ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||34b|K|fffd||fffd|
                            .Cells(targetRow, COL_03083_REQUEST).Validation.Modify _
                                Formula1:=REQUEST_ENTRY & "," & NONE_VALUE
                            
                            ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
                            .Cells(targetRow, COL_03083_REQUEST).Value = IIf(after_03083 = STATUS_OK, REQUEST_ENTRY, NONE_VALUE)
                            
                            ' |fffd|\|fffd||fffd||fffd||656a||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
                            .Cells(targetRow, COL_03083_REQUEST).Locked = True
                            
                        End If
                        
                        ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||303|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|s
                        Call execRowLock(ws03083, .Cells(targetRow, COL_03083_REQUEST))
                        
                        ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|[|fffd||]|fffd|A|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|\|fffd||fffd||fffd||656a||fffd||20d|~|fffd||311|S|fffd|Z|fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||14482||242||fffd||fffd||fffd|
                        If .Cells(targetRow, COL_03083_REQUEST).Value = NONE_VALUE And _
                            .Cells(targetRow, COL_03083_REQUEST).Locked = True Then
                            
                            .Range(.Cells(targetRow, COL_03083_REQUEST).Address, .Cells(targetRow, COL_03083_END_DATE)).Interior.color = vbWhite
                        End If
                        
                        targetRow = targetRow + 1
                        
' 20170917 ADD
' -------------------------------------------------------------------------------------
                    End If
                    
                    organCdExecCnt = organCdExecCnt + 1
                
                Loop While (organCdExecCnt < organCdCnt)

                ' 1|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56202||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
                DoEvents
' -------------------------------------------------------------------------------------
            
            End If
        
            ' 20170917 DEL |fffd||fffd||fffd||fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||3cd|X
''            ' 10|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd|OS|fffd||250||fffd||fffd||fffd||fffd||7c2||fffd|
''            If loopP Mod 10 = 0 Then DoEvents
        Next
    
        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|
        If targetRow <> DATA_START_ROW_NUM Then
            .Rows(targetRow).Hidden = True
        End If

        ' |fffd||64ea||fffd|J|fffd||fffd|
        .Select
        ActiveWindow.ScrollColumn = 1
        ActiveWindow.ScrollRow = 1
        .Range("A1").Select

    End With

    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ws03083, TOOL_LOCK_PWD)

    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd|u|fffd||18e||fffd||fffd||fffd||fffd|p|fffd|v|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||308||a5d7||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B
Private Sub getOrganTypeCdAll(ByVal baseDate As String, ByRef dataDic As Object)

    Dim rs      As ADODB.Recordset
    Dim retCol  As Collection
    Dim loopCnt As Long
    Dim sql     As String
    Dim code    As String

On Error GoTo ERR_HND:
        
    ' |fffd||fffd||fffd|j|fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|dic|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    ' |fffd||fffd||fffd|jADO|fffd||317||fffd||fffd|p|fffd|s|fffd||82||242||202||fffd||fffd||fffd||fffd||fffd||64a3||fffd||fffd||fffd||103||fffd||fffd|[|fffd|v|fffd||151||389||fffd||fffd||fffd||fffd||60a4||fffd|E|fffd|E|fffd|E
    
    ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Set rs = New ADODB.Recordset
    sql = "SELECT organ_type_cd FROM [organ_type_mst$] "
    sql = sql & "WHERE nullification_flg = '0' "
    sql = sql & "AND logic_del_flg = '0' "
    
    ' |fffd||fffd||fffd|t|fffd||64fe||fffd||fffd||fffd||fffd||fffd||752||fffd||30f|C|fffd||fffd||fffd|@20170915 MOD
    '' sql = sql & "AND (valid_start_dtime <= #" & baseDate & "#) "
    '' sql = sql & "AND (valid_end_dtime >= #" & baseDate & "#) "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
    sql = sql & "AND CDate(valid_start_dtime) < #" & STR_BASE_DATE_END & "# "
    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_start_dtime) <= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    
    sql = sql & "AND organ_type_name not like '|fffd||18e||fffd||fffd||fffd||fffd|p%' "
    rs.Open sql, conn, adOpenStatic
    
    Do Until rs.EOF
        ' |fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||fffd||fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd||fffd||253|o|fffd|^|fffd|B|fffd|l|fffd||355|s|fffd||fffd|
        dataDic.Add rs.Fields("organ_type_cd").Value, 1
        rs.MoveNext
    Loop
    
    rs.Close
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd|L|fffd|[|fffd||241|A|fffd|@|fffd||58e||fffd||28b|@|fffd||591||389||fffd||fffd|}|fffd|X|fffd|^|fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B
' |fffd||fffd||fffd|u|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|v|fffd||242||341|u|fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub getOrganTypeCd(ByVal baseDate As String, ByVal organ_cd As String, ByRef chkDic As Object, ByRef dataDic As Object)

    Dim rs      As ADODB.Recordset
    Dim retCol  As Collection
    Dim loopCnt As Long
    Dim sql     As String
    Dim code    As String

On Error GoTo ERR_HND:
        
    ' |fffd||fffd||fffd|j|fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|dic|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    
    ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Set rs = New ADODB.Recordset
    sql = "SELECT organ_type_cd FROM [organ_type_organ_corres_mst$] "
    sql = sql & "WHERE organ_cd = '" & organ_cd & "' "
    sql = sql & "AND nullification_flg = '0' "
    sql = sql & "AND logic_del_flg = '0' "
    
    ' |fffd||fffd||fffd|t|fffd||64fe||fffd||fffd||fffd||fffd||fffd||752||fffd||30f|C|fffd||fffd||fffd|@20170915 MOD
    '' sql = sql & "AND (valid_start_dtime <= #" & baseDate & "#) "
    '' sql = sql & "AND (valid_end_dtime >= #" & baseDate & "#) "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
    sql = sql & "AND CDate(valid_start_dtime) < #" & STR_BASE_DATE_END & "# "
    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_start_dtime) <= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    
    sql = sql & "GROUP BY organ_type_cd"
    rs.Open sql, conn, adOpenStatic
    
    ' |fffd||fffd||282||314||fffd||fffd||fffd||fffd||fffd|h|fffd|~|fffd||fffd||fffd||fffd||5c1|AWindows|fffd||250||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||7c2||fffd|
    DoEvents
    
    ' |fffd||64fe||fffd|S|fffd|f|fffd|[|fffd|^|fffd||143||fffd||fffd|[|fffd|v
    Do Until rs.EOF
        code = rs.Fields("organ_type_cd").Value
        
        ' |fffd|m|fffd|F|fffd||38f||6c2||30b|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||141|A|fffd|V|fffd||fffd||30f||a347||fffd||302||fffd|
        If chkDic.Exists(code) = True And dataDic.Exists(code) = False Then
            
            ' |fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||fffd||fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd||fffd||253|o|fffd|^|fffd|B|fffd|l|fffd||355|s|fffd||fffd|
            dataDic.Add code, 1
            
            ' |fffd||64fe||fffd||fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||242||101|A|fffd||10b|A|fffd|`|fffd|F|fffd|b|fffd|N
            Call getOrganTypeCd(baseDate, code, chkDic, dataDic)
        
        End If
        rs.MoveNext
    Loop
    
    rs.Close
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd||189||f2d6||fffd||97|p|fffd||18d||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||42a42||fffd|A|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|E|fffd||189||fffd||48b|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||fffd||fffd||243|O|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
Private Sub getInqBizGroupRS(ByVal baseDate As String, ByRef rs As ADODB.Recordset)

    Dim sql     As String

On Error GoTo ERR_HND:
        
    ' |fffd||fffd||fffd|j|fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    ' |fffd||fffd||fffd|j|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||356|{|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||242||101|A|fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    
    ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Set rs = New ADODB.Recordset
    sql = "SELECT biz_cd, inquirer_type_cd FROM [inq_perm_compa_list_info_mst$] "
    sql = sql & "WHERE nullification_flg = '0' "
    sql = sql & "AND logic_del_flg = '0' "
    
    ' |fffd||fffd||fffd|t|fffd||64fe||fffd||fffd||fffd||fffd||fffd||752||fffd||30f|C|fffd||fffd||fffd|@20170915 MOD
    '' sql = sql & "AND (valid_start_dtime <= #" & baseDate & "#) "
    '' sql = sql & "AND (valid_end_dtime >= #" & baseDate & "#) "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
    sql = sql & "AND CDate(valid_start_dtime) < #" & STR_BASE_DATE_END & "# "
    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_start_dtime) <= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    
    sql = sql & "GROUP BY biz_cd, inquirer_type_cd"
    rs.Open sql, conn, adOpenStatic
    
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd||189||f2d6||fffd||97|p|fffd||18d||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||42a42||fffd|A|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|E|fffd||4b7ce||48b|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||fffd||fffd||243|O|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
Private Sub getProvPInfoNameGroupRS(ByVal baseDate As String, ByRef rs As ADODB.Recordset)

    Dim sql     As String

On Error GoTo ERR_HND:
        
    ' |fffd||fffd||fffd|j|fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    ' |fffd||fffd||fffd|j|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||356|{|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||242||101|A|fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|{|fffd||302||fffd||fffd||fffd|
    
    ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Set rs = New ADODB.Recordset
    sql = "SELECT person_info_name_cd, provider_type_cd FROM [inq_perm_compa_list_info_mst$] "
    sql = sql & "WHERE nullification_flg = '0' "
    sql = sql & "AND logic_del_flg = '0' "
    
    ' |fffd||fffd||fffd|t|fffd||64fe||fffd||fffd||fffd||fffd||fffd||752||fffd||30f|C|fffd||fffd||fffd|@20170915 MOD
    '' sql = sql & "AND (valid_start_dtime <= #" & baseDate & "#) "
    '' sql = sql & "AND (valid_end_dtime >= #" & baseDate & "#) "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
    sql = sql & "AND CDate(valid_start_dtime) < #" & STR_BASE_DATE_END & "# "
    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_start_dtime) <= #" & baseDate & "# "
'    sql = sql & "AND CDate(valid_end_dtime) >= #" & baseDate & "# "
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    
    sql = sql & "GROUP BY person_info_name_cd, provider_type_cd"
    rs.Open sql, conn, adOpenStatic
    
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description

End Sub

' |fffd||fffd||fffd||fffd||fffd||a5d7||fffd|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd||30d||d3dc|
Private Sub clearList()
    
    Dim s_raw   As Long
    Dim e_raw   As Long

    
    With ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME)

        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||d3dc|
        ' **************************************************
        e_raw = .Cells(.Rows.Count, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
        s_raw = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        
        If s_raw < e_raw Then
            .Range(s_raw + 1 & ":" & e_raw).Delete
        End If
        
        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||d3dc|
        ' **************************************************
        e_raw = .Cells(s_raw, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
        s_raw = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        
        If s_raw < e_raw Then
            .Range(s_raw + 1 & ":" & e_raw).Delete
        End If

        ' |fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|\|fffd||fffd|
        .Rows(s_raw + 1).Hidden = False
    
    End With
    
End Sub

' |fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd||c42c||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|~|fffd|\|fffd||c42c||fffd|j
Private Sub createMainSheet()
    
    Dim organ_cd            As String
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
    '|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||3cd|X|fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j
    Dim baseDate            As String       ' |fffd||fffd||fffd||fffd||e3c0||fffd||fffd|
'    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
'    '|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||3cd|X|fffd|i|fffd||e3c0||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd|j
'    Dim baseDate            As String       ' |fffd|O|fffd||fffd||e3c0||fffd||fffd|
'    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
    Dim organTypeCdDic      As Object       ' |fffd|@|fffd||58e||fffd||28b|@|fffd||591||389||fffd||fffd|}|fffd|X|fffd|^|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd|A|fffd||38f||6cb|@|fffd||582||255|R|fffd||c2||fffd||fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h
    Dim organTypeCdALLDic   As Object       ' |fffd|@|fffd||58e||fffd||283|}|fffd|X|fffd|^|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd|A|fffd|L|fffd||fffd||fffd||20b|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd|S|fffd||281|i|fffd||fffd||fffd||18e||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    
    
On Error GoTo ERR_HND
    
    ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||30e||64fe|
    organ_cd = Me.KikanCode.Caption
    
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
    ' |fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd||30e||64fe|
    baseDate = getRirekiData()
'    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
'    ' |fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||30e||64fe|
'    baseDate = getPreRirekiData()
''    ' |fffd||e3c0||fffd||fffd||fffd||30e||64fe|
''    baseDate = getRirekiData()
'    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
    'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
    ' |fffd|e|fffd||fffd|Dic|fffd||fffd||fffd||fffd|
    Set organTypeCdDic = CreateObject("Scripting.Dictionary")
    Set organTypeCdALLDic = CreateObject("Scripting.Dictionary")
    
    ' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call createConnection(conn)
    
    ' |fffd|`|fffd||fffd||312||fffd|~
    Call setDrawControl
    
    ' |fffd||18e||fffd||fffd||fffd||fffd|p|fffd||14c82||fffd||fffd||fffd||fffd|S|fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||30e||64fe|
    Call getOrganTypeCdAll(baseDate, organTypeCdALLDic)

    ' |fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd||64fe|
    ' |fffd||fffd||fffd|j|fffd||10b|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c1|A|fffd|d|fffd||fffd||fffd|E|fffd|E|fffd|E
    Call getOrganTypeCd(baseDate, organ_cd, organTypeCdALLDic, organTypeCdDic)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
    ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME).Unprotect Password:=TOOL_LOCK_PWD
    
    ' |fffd|O|fffd||fffd||308||a5d7||fffd||fffd||fffd|c|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
    Call clearList
    
    ' |fffd||fffd||fffd||fffd||fffd||a5d7||fffd||30d||c42c|
    Call createMainSheetSection1(baseDate, organ_cd, organTypeCdDic)
    
    ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd||30d||c42c|
    Call createMainSheetSection2(baseDate, organ_cd, organTypeCdDic)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    Call protectWorkSheet(ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME), TOOL_LOCK_PWD)

    ' |fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||309||fffd||fffd|
    Set organTypeCdALLDic = Nothing
    Set organTypeCdDic = Nothing
    Set conn = Nothing
    
    ' |fffd|`|fffd||fffd||30a|J|fffd|n
    Call setDrawControl(True)
    
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd|b|fffd||fffd|I|fffd||243|G|fffd||fffd||fffd|[|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
    MsgBox Err.Number & ":" & Err.Description, vbOKOnly + vbCritical
    
    ' |fffd|R|fffd|l|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||309||fffd||fffd|
    If Not conn Is Nothing Then Set conn = Nothing
    
    ' |fffd|`|fffd||fffd||30a|J|fffd|n
    Call setDrawControl(True)

End Sub

' |fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||c42c|

' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F |fffd||e3c0||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd|@|fffd||583|R|fffd|[|fffd|h
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|hDic|fffd|i|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|}|fffd|X|fffd|^|fffd||fffd||fffd|Q|fffd||182||fffd||fffd|A|fffd||64fe||fffd||fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd|j

Private Sub createMainSheetSection1(ByVal baseDate As String, ByVal organ_cd As String, ByRef organTypeCdDic As Object)

    Dim startRow            As Long             ' |fffd||fffd||fffd||fffd||fffd||38f||6d0||64ea||fffd|s|fffd|i|fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd|j
    Dim targetRow           As Long             ' |fffd||fffd||fffd||fffd||fffd||38f||6cd|s|fffd|i|fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd|j
    Dim targetWLCol         As Long             ' |fffd||fffd||fffd||fffd||fffd||38f||6d7||fffd|i|fffd|e|fffd||fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||303|V|fffd|[|fffd|g|fffd|j
    Dim tmpRow              As Long             ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||14f|I|fffd|s
    Dim loopCnt             As Long             ' |fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|p|fffd||315||3d0||fffd|
    Dim linesCnt            As Integer          ' 1|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||fffd|
        
    Dim wlStatus            As String           ' |fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd|X|fffd|e|fffd|[|fffd|^|fffd|X
    Dim sheetD              As Worksheet        ' D|fffd|W|fffd||fffd||fffd|Q|fffd||183||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim sheetWL0307         As Worksheet        ' 0307|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim sheetWL0308         As Worksheet        ' 0308|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim tmpCell             As Range            ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||348||341|i|fffd|Z|fffd||fffd||fffd|j
    Dim rsInqBiz            As ADODB.Recordset  ' |fffd||189||fffd||48b|@|fffd||58e||fffd||281|E|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||243||fffd||fffd|j|fffd|[|fffd|N|fffd||203||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g
        
    Dim targetRow0307       As Long             ' 0307|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||fffd||301|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30f||fffd||42a91||fffd||fffd||742||fffd||fffd||fffd|s|fffd||50d||fffd|
    Dim targetRow0308       As Long             ' 0308|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||fffd||301|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30f||fffd||42a91||fffd||fffd||742||fffd||fffd||fffd|s|fffd||50d||fffd|
        
    Dim lowOK               As Boolean          ' |fffd|u|fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|D|fffd|W|fffd||fffd||fffd||fffd|
    Dim lowStatus           As String           ' |fffd|u|fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|WL|fffd||fffd||303|f|fffd|[|fffd|^|fffd|B|fffd|f|fffd|o|fffd|b|fffd|O|fffd|p
    Dim initStatus          As String           ' |fffd|u|fffd||fffd||fffd||742||313|o|fffd|^|fffd||cbd41|v
        
    ' |fffd||fffd||fffd||fffd||fffd|}|fffd|X|fffd|^|fffd||30f||fffd||fffd|
    Dim biz_cd_before       As String           ' |fffd|O|fffd||30d|s|fffd||30e||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
    Dim biz_cd              As String           ' |fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
    Dim biznum2             As String           ' |fffd||295|\|fffd||fffd||4d014||fffd|
    Dim biz_name            As String           ' |fffd||fffd||fffd||fffd||fffd||fffd|
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 start -------------------------------------------------------------------
'    Dim ThisBaseDate        As String           ' |fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd|
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 end -------------------------------------------------------------------
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
On Error GoTo ERR_HND
    
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 start -------------------------------------------------------------------
'    '|fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd||fffd||64fe|
'    ThisBaseDate = ""
'    ThisBaseDate = getRirekiData()
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 end -------------------------------------------------------------------
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
    ' |fffd||189||fffd||48b|@|fffd||58e||fffd||281|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||fffd||fffd||243||fffd||fffd|j|fffd|[|fffd|N|fffd||203||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||30e||64fe|
    Call getInqBizGroupRS(baseDate, rsInqBiz)
    
    ' **************************************************
    '  |fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||c42c|
    ' **************************************************
    With ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME)

        Set sheetD = ThisWorkbook.Sheets("biz_mst")
        Set sheetWL0307 = ThisWorkbook.Sheets(WL1_NAME)
        Set sheetWL0308 = ThisWorkbook.Sheets(WL3_NAME)
        
        ' |fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||30e||64fe||fffd||38f||6cd|s|fffd||752||fffd|
        targetRow0307 = getTargetRow(organ_cd, sheetWL0307, WL_ORGAN_CD_COL_NUM)
        targetRow0308 = getTargetRow(organ_cd, sheetWL0308, WL_ORGAN_CD_COL_NUM)
        
        startRow = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        targetRow = startRow
        tmpRow = sheetD.Cells(sheetD.Rows.Count, COL_A1_BIZ_CD).End(xlUp).Row
        biz_cd_before = ""
        
        ' |fffd||fffd||fffd||fffd||fffd|}|fffd|X|fffd|^|fffd||311|S|fffd|s|fffd||fffd||fffd|[|fffd|v
        For loopCnt = 2 To tmpRow
            
            biz_cd = sheetD.Cells(loopCnt, COL_A1_BIZ_CD).Value
            biznum2 = IIf(Val(Right(biz_cd, 3)) = 0, Val(Left(Right(biz_cd, 12), 9)), Val(Left(Right(biz_cd, 12), 9)) & "|fffd||fffd|" & Val(Right(biz_cd, 3)))
            biz_name = sheetD.Cells(loopCnt, COL_A1_BIZ_NAME).Value
            
            ' |fffd||38f||6cd|s|fffd||317|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|`|fffd|F|fffd|b|fffd|N
            ' mod 20170830 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|^
            'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
            If Left(biz_cd, 4) = "JM01" And _
                sheetD.Cells(loopCnt, COL_A1_NULLIFICATION_FLG).Value = "0" And _
                sheetD.Cells(loopCnt, COL_A1_LOGIC_DEL_FLG).Value = "0" And _
                CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) < CDate(STR_BASE_DATE_END) And _
                CDate(sheetD.Cells(loopCnt, COL_A1_END_DTIME).Value) >= CDate(baseDate) Then
'            If Left(biz_cd, 4) = "JM01" And _
'                sheetD.Cells(loopCnt, COL_A1_NULLIFICATION_FLG).Value = "0" And _
'                sheetD.Cells(loopCnt, COL_A1_LOGIC_DEL_FLG).Value = "0" And _
'                CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) <= CDate(baseDate) And _
'                CDate(sheetD.Cells(loopCnt, COL_A1_END_DTIME).Value) >= CDate(baseDate) Then
            'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
                
                ' |fffd||fffd||fffd||fffd||fffd||3c3|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|
                If biz_cd_before <> biz_cd Then
                    
                    ' *** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347| ***
                    
                    ' |fffd||fffd||fffd|s|fffd||142||314||fffd||fffd||fffd|p|fffd||24d||fffd||fffd||30e||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||6d1||fffd|
                    biz_cd_before = biz_cd
                
' *********************************************************************************************************
                
                    ' |fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd||301||fffd||fffd||fffd||fffd|@|fffd||582||30e||fffd||fffd||fffd||fffd||351||38f||6ca|O|fffd|A|fffd||303||fffd||fffd|W|fffd|b|fffd|N|fffd||353||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|B
                    ' |fffd||fffd||fffd||202||70b1||fffd||fffd|
                
                    ' |fffd||38f||6ce||fffd||fffd||fffd||fffd||301|u|fffd||189||fffd||94|\|fffd|v|fffd||fffd||fffd||fffd|
                    lowOK = False
                    rsInqBiz.Filter = adFilterNone
                    rsInqBiz.Filter = "biz_cd = '" & biz_cd & "'"
                    Do Until rsInqBiz.EOF
                        If organTypeCdDic.Exists(rsInqBiz.Fields("inquirer_type_cd").Value) = True Then
                            lowOK = True
                            Exit Do
                        End If
                        rsInqBiz.MoveNext
                    Loop
               
' *********************************************************************************************************
                
                    ' (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90a9||fffd||fffd||fffd||202||302||141|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|C|fffd||fffd||fffd|f|fffd||fffd||fffd|g|fffd||349||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|j
                        
                        targetRow = targetRow + 1
                
                        ' |fffd|s|fffd|}|fffd||fffd||fffd||fffd||fffd||fffd|
                        .Rows(targetRow).Insert
                        .Cells(targetRow, C_NUMBER_COL_NUM).Value = biznum2
                        .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Value = biz_name
                        .Cells(targetRow, C_BIZ_P_I_CD_COL_NUM).Value = biz_cd
                    
                        ' |fffd|s|fffd||fffd||fffd||fffd||fffd||30e|w|fffd||fffd|
                        linesCnt = Application.RoundUp(Len(biz_name) / 35, 0)
                        .Rows(targetRow).RowHeight = IIf(linesCnt = 1, 2, linesCnt) * 14.25
                   
                        ' ==================================================
                        '  WL1|fffd|Q|fffd||181|i|fffd||fffd||fffd||189||fffd||317|L|fffd||fffd||fffd|j
                        ' ==================================================
                        wlStatus = ""
                        lowStatus = STATUS_NG   ' debug|fffd|p|fffd|FWL|fffd||301|u|fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|
                        initStatus = STATUS_NG
                        targetWLCol = getTargetCol(biz_cd, sheetWL0307, WL_1ST_KEY_ROW_NUM)
                        
                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||3cd|X
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 start -------------------------------------------------------------------
                        '|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||256||fffd||fffd||fffd||fffd|A|fffd||702||fffd||fffd||341|ubiz_mst|fffd|v|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|>|fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd||fffd||142||fffd||fffd||fffd||383|Z|fffd||fffd||fffd||252||fffd||fffd|F|fffd|i|fffd||381|j
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
                        If targetWLCol = 0 Or CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) > CDate(baseDate) Then
'                        If targetWLCol = 0 Or CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) > CDate(ThisBaseDate) Then
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
                            .Cells(targetRow, C_NUMBER_COL_NUM).Interior.color = 13434828
                            .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Interior.color = 13434828
                        Else
                            .Cells(targetRow, C_NUMBER_COL_NUM).Interior.color = 16777215
                            .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Interior.color = 16777215
                        End If
'                        .Cells(targetRow, C_NUMBER_COL_NUM).Interior.color = IIf(targetWLCol = 0, 13434828, 16777215)
'                        .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Interior.color = IIf(targetWLCol = 0, 13434828, 16777215)
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 end -------------------------------------------------------------------
                        
                        ' |fffd||38f||6cb|@|fffd||581|A|fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||56f02||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                        If targetRow0307 > 0 And targetWLCol > 0 Then
                                
                            wlStatus = sheetWL0307.Cells(targetRow0307, targetWLCol).Value
                            Select Case wlStatus
                                    
                                ' 1:|fffd|@|fffd||fffd||fffd||14f||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||890f||189||fffd|o|fffd||fffd||fffd||fffd|
                                ' 5:|fffd|@|fffd||fffd||fffd||14f||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||8908||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
                                Case "1", "5"
                                    lowStatus = STATUS_OK
                                    initStatus = STATUS_OK
                                
                                ' 2:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||890f||189||fffd|o|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd|~|fffd||fffd|
                                Case "2"
                                    initStatus = STATUS_OK
                                
                                ' 3:|fffd|@|fffd||fffd||fffd||14f||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||189||fffd|o|fffd||fffd||fffd||202||fffd|
                                ' 6:|fffd|@|fffd||fffd||fffd||14f||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||8908||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||189||fffd|o|fffd||fffd||fffd||202||fffd| |fffd||fffd| |fffd||fffd||fffd|~
                                Case "3", "6"
                                    lowStatus = STATUS_OK
                                
                                ' 0:|fffd|@|fffd||fffd||fffd||14f||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
                                ' 4:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||189||fffd|o|fffd||fffd||fffd||202||fffd|
                                ' |fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||80a6||fffd||202||fffd||fffd|P|fffd|[|fffd|X|fffd|S|fffd||fffd||fffd||702||182||7c2||101|u|fffd||fffd||fffd||311||fffd||fffd|v |fffd||fffd| |fffd|~|fffd|~
                                Case Else
                            
                            End Select
                        
                        End If
                
                        ' [|fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM).Value = IIf(lowOK = True, STATUS_OK, STATUS_NG)
                        
                        ' [|fffd||fffd||fffd||742||313|o|fffd|^|fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 1).Value = initStatus
                        
' *********************************************************************************************************
''                        ' |fffd||fffd|debug|fffd|p|fffd|@WL|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X
''                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 5).Value = wlStatus
''
''                        ' |fffd||fffd|debug|fffd|p|fffd|@|fffd||189||fffd||94|\
''                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 4).Value = lowStatus
''                        If lowStatus <> .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM).Value Then
''                            .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 4).Interior.color = 65535
''                        Else
''                            .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 4).Interior.color = 16777215
''                        End If
''
' *********************************************************************************************************
                        ' [|fffd||3cd|X|fffd||fffd|]
                        Set tmpCell = .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 2)
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|f|fffd|[|fffd|^|fffd||313||fffd||fffd||34b|K|fffd||fffd|
                        tmpCell.Validation.Delete
                        tmpCell.Validation.Add Type:=xlValidateList, Operator:=xlEqual, _
                            Formula1:=IIf(initStatus = STATUS_NG, STATUS_OK, STATUS_NG) & "," & STATUS_BLANK
                        tmpCell.Value = STATUS_BLANK
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
                        Call tmpCell.FormatConditions.Delete
                        Call tmpCell.FormatConditions.Add(Type:=xlExpression, Formula1:="=AND(len(trim(R[0]C[0]))>0,R[0]C[0]<>R[0]C[-1])")
                        tmpCell.FormatConditions(1).Interior.color = 9420794
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                        tmpCell.Locked = False
              
                        ' ==================================================
                        '  WL3|fffd|Q|fffd||181|i|fffd||fffd|C|fffd||317|L|fffd||fffd||fffd|j
                        ' ==================================================
                        initStatus = STATUS_NG
                        targetWLCol = getTargetCol(biz_cd, sheetWL0308, WL_1ST_KEY_ROW_NUM)
                       
                        If targetRow0308 > 0 And targetWLCol > 0 Then
                            
                            ' 20170915 |fffd|u|fffd||fffd||fffd||a396||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd|@|fffd||582||fffd||fffd||fffd||30e||fffd|C|fffd|v|fffd||389||fffd|
''                            Do
''                                Select Case sheetWL0308.Cells(targetRow0308, targetWLCol).Value
''
''                                    ' 1:|fffd||3d1||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|A|fffd|Q|fffd||18f|o|fffd||fffd||fffd||fffd|
''                                    ' 2:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd|A|fffd||189||fffd|o|fffd||fffd||fffd||202||fffd|
''                                    Case "1", "2"
''                                        initStatus = STATUS_OK
''
''                                    ' 0:|fffd||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
''                                    ' 9:|fffd||fffd|O
''                                    ' |fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||80a6||fffd||202||fffd||fffd|P|fffd|[|fffd|X|fffd|S|fffd||fffd||fffd||702||182||7c2||101|u|fffd||fffd||fffd||311||fffd||fffd|v |fffd||fffd| |fffd|~
''                                    Case Else
''                                        ' |fffd||fffd||fffd||30d|s|fffd||303|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd|`|fffd|F|fffd|b|fffd|N|fffd||308||5c1|A|fffd||38f||6d7||fffd||fffd||fffd|R|fffd|i|fffd||7c2||fffd|
''                                        targetWLCol = targetWLCol + 3
''                                End Select
''
''                                ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|XOK|fffd||30f||a347||fffd||fffd||fffd|[|fffd|v|fffd|O|fffd||fffd|
''                                If initStatus = STATUS_OK Then Exit Do
''
''                            ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c2||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||30a||501|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
''                            Loop While (biz_cd = sheetWL0308.Cells(WL_1ST_KEY_ROW_NUM, targetWLCol).Value)
                            initStatus = getAcceptStatus(sheetWL0308, organ_cd, biz_cd, targetRow0308, targetWLCol)
                    
                        End If
                       
                        ' [|fffd||fffd||fffd||742||313|o|fffd|^|fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 3).Value = initStatus
                        
                        ' [|fffd||3cd|X|fffd||fffd|]
                        Set tmpCell = .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)
                                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|f|fffd|[|fffd|^|fffd||313||fffd||fffd||34b|K|fffd||fffd|
                        tmpCell.Validation.Delete
                        tmpCell.Validation.Add Type:=xlValidateList, Operator:=xlEqual, _
                            Formula1:=IIf(initStatus = STATUS_NG, STATUS_OK, STATUS_CHANGE & "," & STATUS_NG) & "," & STATUS_BLANK
                        tmpCell.Value = STATUS_BLANK
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
                        Call tmpCell.FormatConditions.Delete
                        Call tmpCell.FormatConditions.Add(Type:=xlExpression, Formula1:="=AND(len(trim(R[0]C[0]))>0,R[0]C[0]<>R[0]C[-1])")
                        tmpCell.FormatConditions(1).Interior.color = 14470546
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                        tmpCell.Locked = False
                       
                    ' (|fffd||fffd||fffd||fffd||fffd||143|C|fffd||fffd||fffd|f|fffd||fffd||fffd|g|fffd||7c2||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|j|fffd|j
                
                End If
            
            Else
                
                ' *** |fffd||fffd||fffd||fffd||fffd||3c1|i|fffd|O|fffd||30d|s|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|j|fffd||30f||a347|
                    
                ' |fffd|B|fffd||fffd||fffd||301|u|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||302||fffd||fffd||302||193||fffd||fffd||fffd||fffd||a347||fffd||302||74f||fffd||fffd||fffd|
                ' |fffd||fffd||fffd||642||202||fffd||a347||fffd||341|A|fffd||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||303|f|fffd|[|fffd|^|fffd||341|u|fffd|o|fffd||351||38f||6ca|O|fffd|v|fffd||182||fffd||fffd||10f||fffd||fffd||fffd||fffd||3c2||314||fffd||fffd||fffd|
                If .Cells(targetRow, C_BIZ_P_I_CD_COL_NUM).Value = biz_cd Then
                        
                    ' |fffd||e3c0||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||513||fffd||fffd||251||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||256||fffd||fffd||302||302||742||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd| ***
                    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
                    If CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) < CDate(STR_BASE_DATE_END) _
                        And CDate(sheetD.Cells(loopCnt, COL_A1_END_DTIME).Value) >= CDate(baseDate) Then
'                    If CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) <= CDate(baseDate) Then
                    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
                        .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Value = biz_name
                    End If
                
                End If
            
            End If
        
        Next
        
        ' 1|fffd|s|fffd||20f||fffd|o|fffd||34e||fffd||fffd||310||fffd||fffd||fffd|i|fffd|o|fffd||342||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||342||202||fffd||fffd||18e|v|fffd||fffd||fffd||fffd||fffd|A|fffd|O|fffd||302||fffd||fffd||7cf||fffd||fffd||fffd||fffd||752||fffd|j
        If startRow < targetRow Then
            
            startRow = startRow + 1
            
            ' |fffd|r|fffd||fffd|
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Borders(xlEdgeLeft).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Borders(xlEdgeRight).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Borders(xlEdgeBottom).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Borders(xlInsideVertical).LineStyle = xlContinuous
            
            ' |fffd||fffd||fffd||42e42||190||702||fffd||502||fffd||fffd|\|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd|j
            .Range(.Cells(startRow, C_BIZ_P_I_NAME_COL_NUM), .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM)).HorizontalAlignment = xlHAlignLeft
            .Range(.Cells(startRow, C_BIZ_P_I_NAME_COL_NUM), .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM)).WrapText = True
            
        End If
    
    End With
    
    Call closeRecordset(rsInqBiz)
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description
    
    Call closeRecordset(rsInqBiz)

End Sub

' |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||c42c|

' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F |fffd||e3c0||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd|@|fffd||583|R|fffd|[|fffd|h
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|hDic|fffd|i|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|}|fffd|X|fffd|^|fffd||fffd||fffd|Q|fffd||182||fffd||fffd|A|fffd||64fe||fffd||fffd||fffd||fffd||fffd|@|fffd||58e||fffd||283|R|fffd|[|fffd|h|fffd|j

Private Sub createMainSheetSection2(ByVal baseDate As String, ByVal organ_cd As String, ByRef organTypeCdDic As Object)

    Dim startRow            As Long             ' |fffd||fffd||fffd||fffd||fffd||38f||6d0||64ea||fffd|s|fffd|i|fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd|j
    Dim targetRow           As Long             ' |fffd||fffd||fffd||fffd||fffd||38f||6cd|s|fffd|i|fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd|j
    Dim targetWLCol         As Long             ' |fffd||fffd||fffd||fffd||fffd||38f||6d7||fffd|i|fffd|e|fffd||fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||303|V|fffd|[|fffd|g|fffd|j
    Dim tmpRow              As Long             ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||14f|I|fffd|s
    Dim loopCnt             As Long             ' |fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|p|fffd||315||3d0||fffd|
    Dim linesCnt            As Integer          ' 1|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||fffd|
        
    Dim wlStatus            As String           ' |fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd|X|fffd|e|fffd|[|fffd|^|fffd|X
    Dim sheetD              As Worksheet        ' D|fffd|W|fffd||fffd||fffd|Q|fffd||183||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim sheetWL0307         As Worksheet        ' 0307|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim sheetWL0308         As Worksheet        ' 0308|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim tmpCell             As Range            ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||348||341|i|fffd|Z|fffd||fffd||fffd|j
    Dim rsProvPInfoName     As ADODB.Recordset  ' |fffd||4b7ce||48b|@|fffd||58e||fffd||281|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||fffd||fffd||243||fffd||fffd|j|fffd|[|fffd|N|fffd||203||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g
        
    Dim targetRow0307       As Long             ' 0307|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||fffd||301|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30f||fffd||42a91||fffd||fffd||742||fffd||fffd||fffd|s|fffd||50d||fffd|
    Dim targetRow0308       As Long             ' 0308|fffd|p|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||fffd||301|A|fffd||38f||6cb|@|fffd||583|R|fffd|[|fffd|h|fffd||30f||fffd||42a91||fffd||fffd||742||fffd||fffd||fffd|s|fffd||50d||fffd|
        
    Dim lowOK               As Boolean          ' |fffd|u|fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|D|fffd|W|fffd||fffd||fffd||fffd|
    Dim lowStatus           As String           ' |fffd|u|fffd|@|fffd||fffd||fffd||fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|WL|fffd||fffd||303|f|fffd|[|fffd|^|fffd|B|fffd|f|fffd|o|fffd|b|fffd|O|fffd|p
    Dim initStatus          As String           ' |fffd|u|fffd||fffd||fffd||742||313|o|fffd|^|fffd||cbd41|v
        
    ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|}|fffd|X|fffd|^|fffd||30f||fffd||fffd|
    Dim person_info_name_cd_before  As String   ' |fffd|O|fffd||30d|s|fffd||313||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h
    Dim person_info_name_cd         As String   ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h
    Dim person_info_name_num        As String   ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
    Dim person_info_name            As String   ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 start -------------------------------------------------------------------
'    Dim ThisBaseDate        As String           ' |fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd|
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 end -------------------------------------------------------------------
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
On Error GoTo ERR_HND
    
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 start -------------------------------------------------------------------
'    '|fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd||fffd||64fe|
'    ThisBaseDate = ""
'    ThisBaseDate = getRirekiData()
'    'ADD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 end -------------------------------------------------------------------
    'DEL |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
    
    ' |fffd||4b7ce||48b|@|fffd||58e||fffd||281|E|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||fffd||fffd||243||fffd||fffd|j|fffd|[|fffd|N|fffd||203||fffd||fffd|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||30e||64fe|
    Call getProvPInfoNameGroupRS(baseDate, rsProvPInfoName)
    
    ' **************************************************
    '  |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||c42c|
    ' **************************************************
    With ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME)
        
        Set sheetD = ThisWorkbook.Sheets("person_info_name_mst")
        Set sheetWL0307 = ThisWorkbook.Sheets(WL2_NAME)
        Set sheetWL0308 = ThisWorkbook.Sheets(WL4_NAME)
        
        ' |fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||30e||64fe||fffd||38f||6cd|s|fffd||752||fffd|
        targetRow0307 = getTargetRow(organ_cd, sheetWL0307, WL_ORGAN_CD_COL_NUM)
        targetRow0308 = getTargetRow(organ_cd, sheetWL0308, WL_ORGAN_CD_COL_NUM)
        
        startRow = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        targetRow = startRow
        tmpRow = sheetD.Cells(sheetD.Rows.Count, COL_A3_PERSON_INFO_NAME_CD).End(xlUp).Row
        person_info_name_cd_before = ""
        
        ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|}|fffd|X|fffd|^|fffd||311|S|fffd|s|fffd||fffd||fffd|[|fffd|v
        For loopCnt = 2 To tmpRow
            
            person_info_name_cd = sheetD.Cells(loopCnt, COL_A3_PERSON_INFO_NAME_CD).Value   ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h
            person_info_name_num = Val(Right(person_info_name_cd, 14))                      ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
            person_info_name = sheetD.Cells(loopCnt, COL_A3_PERSON_INFO_NAME).Value         ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|
            
            ' |fffd||38f||6cd|s|fffd||317|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|`|fffd|F|fffd|b|fffd|N
            ' mod 20170830 |fffd|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|^
            ' [memo]|fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||193||fffd||fffd||fffd||90|l|fffd||fffd||56f02||308||fffd||4c9||fffd||fffd||34e||635e||fffd||fffd||fffd|_|fffd||14e||fffd||fffd|{|fffd||255||3cd|X|fffd||3c2||308||5c1|A|fffd||fffd|Ver.|fffd||142||353||fffd||fffd|t|fffd||fffd||fffd||fffd||302||742||149||81|B|fffd||fffd||fffd||fffd||fffd||3c3|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|v
            'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
            If sheetD.Cells(loopCnt, COL_A3_NULLIFICATION_FLG).Value = "0" And _
                sheetD.Cells(loopCnt, COL_A3_LOGIC_DEL_FLG).Value = "0" And _
                CDate(sheetD.Cells(loopCnt, COL_A3_START_DTIME).Value) < CDate(STR_BASE_DATE_END) And _
                CDate(sheetD.Cells(loopCnt, COL_A3_END_DTIME).Value) >= CDate(baseDate) Then
'            If sheetD.Cells(loopCnt, COL_A3_NULLIFICATION_FLG).Value = "0" And _
'                sheetD.Cells(loopCnt, COL_A3_LOGIC_DEL_FLG).Value = "0" And _
'                CDate(sheetD.Cells(loopCnt, COL_A3_START_DTIME).Value) <= CDate(baseDate) And _
'                CDate(sheetD.Cells(loopCnt, COL_A3_END_DTIME).Value) >= CDate(baseDate) Then
            'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
            
                ' |fffd||fffd||fffd||fffd||fffd||3c3|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|
                If person_info_name_cd_before <> person_info_name_cd Then
                    
                    ' *** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347| ***
                    
                    ' |fffd||fffd||fffd|s|fffd||142||314||fffd||fffd||fffd|p|fffd||24d||fffd||fffd||313||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||fffd||6d1||fffd|
                    person_info_name_cd_before = person_info_name_cd

' *********************************************************************************************************

                    ' |fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd||301||fffd||fffd||fffd||fffd|@|fffd||582||313||fffd||fffd||fffd||90|l|fffd||fffd||fffd||351||38f||6ca|O|fffd|A|fffd||303||fffd||fffd|W|fffd|b|fffd|N|fffd||353||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|B
                    ' |fffd||fffd||fffd||202||70b1||fffd||fffd|

                    ' |fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||fffd||301|u|fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd|
                    lowOK = False
                    rsProvPInfoName.Filter = adFilterNone
                    rsProvPInfoName.Filter = "person_info_name_cd = '" & person_info_name_cd & "'"
                    Do Until rsProvPInfoName.EOF
                        If organTypeCdDic.Exists(rsProvPInfoName.Fields("provider_type_cd").Value) = True Then
                            lowOK = True
                            Exit Do
                        End If
                        rsProvPInfoName.MoveNext
                    Loop

' *********************************************************************************************************
                
                    ' (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90a9||fffd||fffd||fffd||202||302||141|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|C|fffd||fffd||fffd|f|fffd||fffd||fffd|g|fffd||349||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|j
                        
                        targetRow = targetRow + 1
                        
                        ' |fffd|s|fffd|}|fffd||fffd||fffd||fffd||fffd||fffd|
                        .Rows(targetRow).Insert
                        .Cells(targetRow, C_NUMBER_COL_NUM).Value = person_info_name_num
                        .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Value = person_info_name
                        .Cells(targetRow, C_BIZ_P_I_CD_COL_NUM).Value = person_info_name_cd
                        
                        ' |fffd|}|fffd|X|fffd|^|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|/|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd|i|fffd||fffd||14e|Q|fffd||182||fffd||fffd||fffd|j
                        .Cells(targetRow, C_START_DTIME_COL_NUM).Value = sheetD.Cells(loopCnt, COL_A3_START_DTIME).Value
                        .Cells(targetRow, C_END_DTIME_COL_NUM).Value = sheetD.Cells(loopCnt, COL_A3_END_DTIME).Value
                    
                        ' |fffd|s|fffd||fffd||fffd||fffd||fffd||30e|w|fffd||fffd|
                        linesCnt = Application.RoundUp(Len(person_info_name) / 35, 0)
                        .Rows(targetRow).RowHeight = IIf(linesCnt = 1, 2, linesCnt) * 14.25
                   
                        ' ==================================================
                        '  WL2|fffd|Q|fffd||181|i|fffd||fffd||fffd||4b7c2||317|L|fffd||fffd||fffd|j
                        ' ==================================================
                        wlStatus = ""
                        lowStatus = STATUS_NG   ' debug|fffd|p|fffd|FWL|fffd||301|u|fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|
                        initStatus = STATUS_NG
                        targetWLCol = getTargetCol(person_info_name_cd, sheetWL0307, WL_1ST_KEY_ROW_NUM)
                        
                        ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f02||310|F|fffd||3cd|X
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 start -------------------------------------------------------------------
                        '|fffd|z|fffd||fffd||fffd|C|fffd|g|fffd||fffd||fffd|X|fffd|g|fffd||256||fffd||fffd||fffd||fffd|A|fffd||702||fffd||fffd||341|uperson_info_name_mst|fffd|v|fffd||317|L|fffd||fffd||fffd|J|fffd|n|fffd||fffd|>=|fffd||fffd||fffd||fffd||30a||e3c0||fffd||fffd||fffd||142||fffd||fffd||fffd||383|Z|fffd||fffd||fffd||252||fffd||fffd|F|fffd|i|fffd||381|j
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 start -------------------------------------------------------------------
                        If targetWLCol = 0 Or CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) >= CDate(baseDate) Then
'                        If targetWLCol = 0 Or CDate(sheetD.Cells(loopCnt, COL_A1_START_DTIME).Value) >= CDate(ThisBaseDate) Then
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd||fffd|i|fffd|O|fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e3c0||fffd||fffd||fffd|j 20171212 end -------------------------------------------------------------------
                            .Cells(targetRow, C_NUMBER_COL_NUM).Interior.color = 13434828
                            .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Interior.color = 13434828
                        Else
                            .Cells(targetRow, C_NUMBER_COL_NUM).Interior.color = 16777215
                            .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Interior.color = 16777215
                        End If
'                        .Cells(targetRow, C_NUMBER_COL_NUM).Interior.color = IIf(targetWLCol = 0, 13434828, 16777215)
'                        .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Interior.color = IIf(targetWLCol = 0, 13434828, 16777215)
                        'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171122 end -------------------------------------------------------------------
                        
                        ' |fffd||38f||6cb|@|fffd||581|A|fffd||38f||6d3||fffd||fffd||fffd||90|l|fffd||fffd||56f02||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                        If targetRow0307 > 0 And targetWLCol > 0 Then
                                
                            wlStatus = sheetWL0307.Cells(targetRow0307, targetWLCol).Value
                            Select Case wlStatus
                                    
                                ' 1:|fffd|@|fffd||fffd||fffd||152||4b7cb||fffd||fffd||82||fffd||fffd||fffd||102||fffd||fffd||8912||4b7cf|o|fffd||fffd||fffd||fffd|
                                ' 5:|fffd|@|fffd||fffd||fffd||152||4b7cb||fffd||fffd||82||fffd||fffd||fffd||102||fffd||fffd||8908||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
                                Case "1", "5"
                                    lowStatus = STATUS_OK
                                    initStatus = STATUS_OK
                                
                                ' 2:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||8912||4b7c2||fffd||fffd|o|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd|~|fffd||fffd|
                                Case "2"
                                    initStatus = STATUS_OK
                                
                                ' 3:|fffd|@|fffd||fffd||fffd||152||4b7cb||fffd||fffd||82||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||4b7cf|o|fffd||fffd||fffd||202||fffd|
                                ' 6:|fffd|@|fffd||fffd||fffd||152||4b7cb||fffd||fffd||82||fffd||fffd||fffd||102||fffd||fffd||8908||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||4b7cf|o|fffd||fffd||fffd||202||fffd| |fffd||fffd| |fffd||fffd||fffd|~
                                Case "3", "6"
                                    lowStatus = STATUS_OK
                                
                                ' 0:|fffd|@|fffd||fffd||fffd||152||4b7cb||fffd||fffd||82||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
                                ' 4:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||4b7cf|o|fffd||fffd||fffd||202||fffd|
                                ' |fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||80a6||fffd||202||fffd||fffd|P|fffd|[|fffd|X|fffd|S|fffd||fffd||fffd||702||182||7c2||101|u|fffd||fffd||fffd||311||fffd||fffd|v |fffd||fffd| |fffd|~|fffd|~
                                Case Else
                            
                            End Select
                        
                        End If
    
                        ' [|fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM).Value = IIf(lowOK = True, STATUS_OK, STATUS_NG)
                        
                        ' [|fffd||fffd||fffd||742||313|o|fffd|^|fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 1).Value = initStatus
                        
' *********************************************************************************************************
''                        ' |fffd||fffd|debug|fffd|p|fffd|@WL|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X
''                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 5).Value = wlStatus
''
''                        ' |fffd||fffd|debug|fffd|p|fffd|@|fffd||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd|
''                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 4).Value = lowStatus
''                        If lowStatus <> .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM).Value Then
''                            .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 4).Interior.color = 65535
''                        Else
''                            .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM - 4).Interior.color = 16777215
''                        End If
''
' *********************************************************************************************************
                        ' [|fffd||3cd|X|fffd||fffd|]
                        Set tmpCell = .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 2)
                       
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|f|fffd|[|fffd|^|fffd||313||fffd||fffd||34b|K|fffd||fffd|
                        tmpCell.Validation.Delete
                        tmpCell.Validation.Add Type:=xlValidateList, Operator:=xlEqual, _
                            Formula1:=IIf(initStatus = STATUS_NG, STATUS_OK, STATUS_NG) & "," & STATUS_BLANK
                       
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd|F|fffd|V|fffd|K|fffd|s|fffd||152||4b7cb|`|fffd||fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
                        tmpCell.Value = STATUS_BLANK
                        If targetWLCol = 0 And lowOK = True Then
                            tmpCell.Value = STATUS_OK
                        End If
                       
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
                        Call tmpCell.FormatConditions.Delete
                        Call tmpCell.FormatConditions.Add(Type:=xlExpression, Formula1:="=AND(len(trim(R[0]C[0]))>0,R[0]C[0]<>R[0]C[-1])")
                        tmpCell.FormatConditions(1).Interior.color = 9420794
                   
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                        tmpCell.Locked = False
                        
                        ' ==================================================
                        '  WL4|fffd|Q|fffd||fffd|-1|fffd|i|fffd||fffd|C|fffd||242||fffd||fffd||fffd||fffd||4b7c2||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|j
                        ' ==================================================
                        initStatus = STATUS_NG
                        targetWLCol = getTargetCol(person_info_name_cd, sheetWL0308, WL_1ST_KEY_ROW_NUM)
                       
                        If targetRow0308 > 0 And targetWLCol > 0 Then
    
                            ' 20170915 |fffd|u|fffd||fffd||fffd||a396||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||90|l|fffd||315||fffd||fffd||fffd||fffd|@|fffd||582||fffd||fffd||fffd||30e||fffd|C|fffd|v|fffd||389||fffd|
''                            Select Case sheetWL0308.Cells(targetRow0308, targetWLCol).Value
''
''                                ' 1:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||8912||4b7cf|o|fffd||fffd||fffd||fffd|
''                                ' 2:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd||fffd||4b7cf|o|fffd||fffd||fffd||202||fffd|
''                                Case "1", "2"
''                                    initStatus = STATUS_OK
''
''                                ' 0:|fffd||4b7cb||fffd||fffd||82||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
''                                ' 9:|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|
''                                ' |fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||80a6||fffd||202||fffd||fffd|P|fffd|[|fffd|X|fffd|S|fffd||fffd||fffd||702||182||7c2||101|u|fffd||fffd||fffd||311||fffd||fffd|v
''                                Case Else
''
''                            End Select
                            initStatus = getAcceptStatus(sheetWL0308, organ_cd, person_info_name_cd, targetRow0308, targetWLCol)
                   
                        End If
                       
                        ' [|fffd||fffd||fffd||742||313|o|fffd|^|fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 3).Value = initStatus
                        
                        ' [|fffd||3cd|X|fffd||fffd|]
                        Set tmpCell = .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 4)
                                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|f|fffd|[|fffd|^|fffd||313||fffd||fffd||34b|K|fffd||fffd|
                        tmpCell.Validation.Delete
                        tmpCell.Validation.Add Type:=xlValidateList, Operator:=xlEqual, _
                            Formula1:=IIf(initStatus = STATUS_NG, STATUS_OK, STATUS_CHANGE & "," & STATUS_NG) & "," & STATUS_BLANK
                        tmpCell.Value = STATUS_BLANK
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
                        Call tmpCell.FormatConditions.Delete
                        Call tmpCell.FormatConditions.Add(Type:=xlExpression, Formula1:="=AND(len(trim(R[0]C[0]))>0,R[0]C[0]<>R[0]C[-1])")
                        tmpCell.FormatConditions(1).Interior.color = 14470546
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                        tmpCell.Locked = False
                        
                        ' ==================================================
                        '  WL4|fffd|Q|fffd||fffd|-2|fffd|i|fffd||fffd||fffd||4b7c2||fffd||fffd||3d4|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|j
                        ' ==================================================
                        initStatus = STATUS_NG
                        
                        If targetWLCol > 0 Then
                            
                            ' |fffd||38f||6c2||301|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||64ea||fffd||fffd|{|fffd|P|fffd||fffd||fffd||64fe||fffd|i|fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|J|fffd||fffd||fffd||fffd||fffd||30e||64fe||fffd|j
                            targetWLCol = targetWLCol + 1
                            
                            ' |fffd||fffd||fffd||14e|Z|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||253||fffd||fffd|Y|fffd|@|fffd||582||30b|@|fffd||583|R|fffd|[|fffd|h|fffd||fffd||fffd||702||702||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
                            If getTargetRow(organ_cd, sheetWL0308, targetWLCol) > 0 Then
                                ' |fffd||702||702||fffd||102||fffd||fffd||fffd||381||fffd|
                                initStatus = STATUS_OK
                            End If
                            
                       End If
                       
                        ' [|fffd||fffd||fffd||742||313|o|fffd|^|fffd||fffd|]
                        .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 5).Value = initStatus
                        
                        ' [|fffd||3cd|X|fffd||fffd|]
                        Set tmpCell = .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 6)
                                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|f|fffd|[|fffd|^|fffd||313||fffd||fffd||34b|K|fffd||fffd|
                        tmpCell.Validation.Delete
                        tmpCell.Validation.Add Type:=xlValidateList, Operator:=xlEqual, _
                            Formula1:=IIf(initStatus = STATUS_NG, STATUS_OK, STATUS_CHANGE & "," & STATUS_NG) & "," & STATUS_BLANK
                        tmpCell.Value = STATUS_BLANK
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
                        Call tmpCell.FormatConditions.Delete
                        Call tmpCell.FormatConditions.Add(Type:=xlExpression, Formula1:="=AND(len(trim(R[0]C[0]))>0,R[0]C[0]<>R[0]C[-1])")
                        tmpCell.FormatConditions(1).Interior.color = 14470546
                        
                        ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                        tmpCell.Locked = False
                       
                        'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
                        ' [|fffd||fffd||fffd|l]
                        If chkNonePersonInfo(organ_cd, person_info_name_num) = True Then
                            .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 7).Value = NONE_P_I
                            'ADD 20171122 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
                            .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 2).Value = ""
                            'ADD 20171122 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
                        End If
                        'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
                        
                    ' (|fffd||fffd||fffd||fffd||fffd||143|C|fffd||fffd||fffd|f|fffd||fffd||fffd|g|fffd||7c2||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|j|fffd|j
                
                End If
            
            Else
                
                ' *** |fffd||fffd||fffd||fffd||fffd||3c1|i|fffd|O|fffd||30d|s|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|j|fffd||30f||a347|
                
                ' |fffd|B|fffd||fffd||fffd||301|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||302||fffd||fffd||302||193||fffd||fffd||fffd||fffd||a347||fffd||302||74f||fffd||fffd||fffd|
                ' |fffd||fffd||fffd||642||202||fffd||a347||fffd||341|A|fffd||fffd||fffd|Y|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h|fffd||303|f|fffd|[|fffd|^|fffd||341|u|fffd|o|fffd||351||38f||6ca|O|fffd|v|fffd||182||fffd||fffd||10f||fffd||fffd||fffd||fffd||3c2||314||fffd||fffd||fffd|
                If .Cells(targetRow, C_BIZ_P_I_CD_COL_NUM).Value = person_info_name_cd Then
                    
                    ' |fffd||e3c0||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||513||fffd||fffd||251||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||256||fffd||fffd||302||302||742||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd| ***
                    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 start ------------------------------------------------------
                    If CDate(sheetD.Cells(loopCnt, COL_A3_START_DTIME).Value) < CDate(STR_BASE_DATE_END) _
                        And CDate(sheetD.Cells(loopCnt, COL_A3_END_DTIME).Value) >= CDate(baseDate) Then
'                    If CDate(sheetD.Cells(loopCnt, COL_A3_START_DTIME).Value) <= CDate(baseDate) Then
                    'UPD |fffd||6d1||fffd|49|fffd||389||fffd| 20171117 end ------------------------------------------------------
                        .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM).Value = person_info_name
                    End If
                
                End If
             
            End If
        
        Next
        
        ' 1|fffd|s|fffd||20f||fffd|o|fffd||34e||fffd||fffd||310||fffd||fffd||fffd|i|fffd|o|fffd||342||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||342||202||fffd||fffd||18e|v|fffd||fffd||fffd||fffd||fffd|A|fffd|O|fffd||302||fffd||fffd||7cf||fffd||fffd||fffd||fffd||752||fffd|j
        If startRow < targetRow Then
            
            startRow = startRow + 1
            
            'UPD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
            ' |fffd|r|fffd||fffd|
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Borders(xlEdgeLeft).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Borders(xlEdgeRight).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Borders(xlEdgeBottom).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Borders(xlInsideVertical).LineStyle = xlContinuous
'            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Borders(xlEdgeLeft).LineStyle = xlContinuous
'            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Borders(xlEdgeRight).LineStyle = xlContinuous
'            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Borders(xlEdgeBottom).LineStyle = xlContinuous
'            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
'            .Range(.Cells(startRow, C_NUMBER_COL_NUM), .Cells(targetRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Borders(xlInsideVertical).LineStyle = xlContinuous
            'UPD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| end -------------------------------------------------------------------
            
            ' |fffd||fffd||fffd||42e42||190||702||fffd||502||fffd||fffd|\|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|J|fffd||fffd||fffd||fffd||fffd|j
            .Range(.Cells(startRow, C_BIZ_P_I_NAME_COL_NUM), .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM)).HorizontalAlignment = xlHAlignLeft
            .Range(.Cells(startRow, C_BIZ_P_I_NAME_COL_NUM), .Cells(targetRow, C_BIZ_P_I_NAME_COL_NUM)).WrapText = True
            'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
            .Range(.Cells(startRow, C_REMARKS_COL_NUM), .Cells(targetRow, C_REMARKS_COL_NUM)).HorizontalAlignment = xlHAlignLeft
            .Range(.Cells(startRow, C_REMARKS_COL_NUM), .Cells(targetRow, C_REMARKS_COL_NUM)).WrapText = True
            'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| end -------------------------------------------------------------------
        End If

    End With
    
    Call closeRecordset(rsProvPInfoName)
    Exit Sub

ERR_HND:
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Debug.Print Err.Description
    
    Call closeRecordset(rsProvPInfoName)

End Sub

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|A|fffd||38f||6cd|s|fffd|A|fffd||fffd||348||342||fffd||fffd|w|fffd||80b5||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd|Hit|fffd||fffd||fffd||fffd||64ea||fffd||317||fffd||50d||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B

' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||38f||6c3|V|fffd|[|fffd|g
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||38f||6cd|s
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|

' |fffd||7c2||fffd|l|fffd|@|fffd|F |fffd||fffd||50d||fffd||fffd|istartCol|fffd||fffd||fffd|w|fffd||80a0||fffd||fffd||30f||a347||fffd|AstartCol|fffd||fffd||fffd||fffd||311||fffd||fffd||397||fffd||50d||fffd||fffd|j|fffd|@0|fffd||30f||a347||fffd||34e||64fe||fffd||202||fffd|

Private Function getTargetCol(ByVal chkword As String, ByVal sh As Worksheet, ByVal targetRow As Long, _
                            Optional ByVal startCol As Long = 0, Optional ByVal endCol As Long = 0) As Long

    Dim retVal      As Variant
    Dim result      As Long

On Error Resume Next
                            
    If startCol = 0 Then
        retVal = Application.WorksheetFunction.Match(chkword, sh.Rows(targetRow), 0)
    Else
        retVal = Application.WorksheetFunction.Match(chkword, _
            sh.Range(sh.Cells(targetRow, startCol).Address, sh.Cells(targetRow, endCol).Address), 0)
    End If
                            
    If IsError(retVal) Then
        result = 0
        Err.Clear
    Else
        result = CLng(retVal)
    End If
                            
    getTargetCol = result

End Function

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|A|fffd||38f||6d7||fffd|A|fffd|s|fffd||348||342||fffd||fffd|w|fffd||80b5||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd|Hit|fffd||fffd||fffd||fffd||64ea||fffd||30d|s|fffd||50d||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B

' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||38f||6c3|V|fffd|[|fffd|g
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||38f||6d7||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd|s
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|s

' |fffd||7c2||fffd|l|fffd|@|fffd|F |fffd|s|fffd||50d||fffd||fffd|istartRow|fffd||fffd||fffd|w|fffd||80a0||fffd||fffd||30f||a347||fffd|AstartRow|fffd||fffd||fffd||fffd||311||fffd||fffd||397||fffd||50d||fffd||fffd|j|fffd|@0|fffd||30f||a347||fffd||34e||64fe||fffd||202||fffd|

Private Function getTargetRow(ByVal chkword As String, ByVal sh As Worksheet, ByVal targetCol As Long, _
                            Optional ByVal startRow As Long = 0, Optional ByVal proEndRow As Long = 0) As Long

    Dim retVal      As Variant
    Dim result      As Long

On Error Resume Next
                            
    If startRow = 0 Then
        retVal = Application.WorksheetFunction.Match(chkword, sh.Columns(targetCol), 0)
    Else
        retVal = Application.WorksheetFunction.Match(chkword, _
            sh.Range(sh.Cells(startRow, targetCol).Address, sh.Cells(proEndRow, targetCol).Address), 0)
    End If
                            
    If IsError(retVal) Then
        result = 0
        Err.Clear
    Else
        result = CLng(retVal)
    End If
                            
    getTargetRow = result

End Function

' |fffd||38f||6c2||30b|@|fffd||581|E|fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||101|A|fffd|o|fffd|^|fffd|L|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|B

' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F WL3/WL4|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
'|fffd|@|fffd|@|fffd|@|fffd|@ |fffd|F |fffd|@|fffd||583|R|fffd|[|fffd|h
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h/|fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f03|R|fffd|[|fffd|h
'         |fffd|F |fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd|s
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd|

' |fffd||7c2||fffd|l|fffd|@|fffd|F 1|fffd||fffd||fffd||142||fffd||fffd|u|fffd||3d4|C|fffd||fffd||fffd||fffd|v|fffd||194||fffd||fffd||80b3||fffd||a0bd||fffd||a347||fffd|A"|fffd||fffd|"

Private Function getAcceptStatus(ByVal sheet As Worksheet, ByVal organ_cd As String, _
                                ByVal code As String, ByVal targetRow As Long, ByVal targetCol As Long) As String
                            
    Dim chkRow      As Long
    Dim chkCol      As Long
    Dim result      As String
    
    ' |fffd||7c2||fffd|l|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    result = STATUS_NG
  
    With sheet
    
        ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        chkRow = targetRow
        
        ' |fffd|c|fffd||fffd||fffd|i|fffd||fffd||fffd|F|fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|j|fffd||303||fffd||fffd|[|fffd|v
        Do
            ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            chkCol = targetCol
                
            ' |fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||90|l|fffd|j|fffd||303||fffd||fffd|[|fffd|v
            ' |fffd||fffd||fffd||fffd||fffd||fffd||90|l|fffd||34e||fffd||fffd||6c2||342|P|fffd||fffd||fffd|[|fffd|v|fffd||154||fffd||fffd||fffd||fffd||90aa||fffd|A|fffd||fffd||fffd||fffd||fffd||30b||fffd||fffd||289||fffd||fffd||308||5d5||fffd||fffd||93642||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||243||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||302||702||702||182||fffd||fffd||fffd|B
            Do
                Select Case .Cells(chkRow, chkCol).Value
               
                    ' 1:|fffd||3d1||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|A|fffd|Q|fffd||18f|o|fffd||fffd||fffd||fffd|
                    ' 2:|fffd||3d4|C|fffd||fffd||fffd||fffd||102||fffd||fffd||90aa||fffd|A|fffd||189||fffd|o|fffd||fffd||fffd||202||fffd|
                    Case "1", "2"
                        result = STATUS_OK
                    
                    ' 0:|fffd||189||f2d6||fffd||82||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
                    ' 9:|fffd||fffd|O
                    ' |fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||80a6||fffd||202||fffd||fffd|P|fffd|[|fffd|X|fffd|S|fffd||fffd||fffd||702||182||7c2||101|u|fffd||fffd||fffd||311||fffd||fffd|v |fffd||fffd| |fffd|~
                    Case Else
                        ' |fffd||fffd||fffd||30d|s|fffd||303|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd|`|fffd|F|fffd|b|fffd|N|fffd||308||5c1|A|fffd||38f||6d7||fffd||fffd||fffd|R|fffd|i|fffd||7c2||fffd|
                        chkCol = chkCol + 3
                End Select
                
                ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|XOK|fffd||30f||a347||fffd||fffd||fffd|[|fffd|v|fffd|O|fffd||fffd|
                If result = STATUS_OK Then Exit Do
            
            ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c2||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||30a||501|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
            Loop While (code = .Cells(WL_1ST_KEY_ROW_NUM, chkCol).Value)
                    
            ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|XOK|fffd||30f||a347||fffd||fffd||fffd|[|fffd|v|fffd|O|fffd||fffd|
            If result = STATUS_OK Then Exit Do
        
            ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd|s|fffd||fffd||fffd||fffd||fffd||248||693||fffd||fffd||fffd||fffd||fffd|
            chkRow = chkRow + 1
        
        ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c2||193||fffd||fffd||fffd||fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||30a||501|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
        Loop While (organ_cd = .Cells(WL_1ST_KEY_ROW_NUM, WL_ORGAN_CD_COL_NUM).Value)
                    
    End With
    
    ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||282||315||50b|p
    getAcceptStatus = result

End Function

' ADD 20171031 |fffd||6d1||fffd|No.55 |fffd||389||fffd|
' |fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||1d7||fffd||fffd||50d||fffd||fffd||582||315||3ca||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||fffd||8471||fffd|R|fffd|[|fffd|h
' |fffd||7c2||fffd|l|fffd|@|fffd|F |fffd||1d7||fffd||fffd||50d||fffd|
Private Function getProcNum(ByVal strProcCd As String) As String

    getProcNum = ""
    
    Select Case True
    Case Mid(strProcCd, 3, 1) = "9"
        'JT99000000000001
        '|fffd||fffd||fffd|@|fffd||1d7||fffd||fffd||50d||fffd||fffd|F900-1
        getProcNum = "900-1"
    Case Mid(strProcCd, 7, 4) <> "0000"
        'JT0+|fffd||1d7||fffd||fffd||50d||fffd|X|fffd||312|l3|fffd||fffd|+|fffd|}|fffd||fffd|Y4|fffd||fffd|+|fffd||1d7||fffd||fffd||50d||fffd|Z|fffd||312|l6|fffd||fffd|
        '|fffd||fffd||fffd|@|fffd||1d7||fffd||fffd||50d||fffd|[X|fffd||fffd|Y-Z]
        getProcNum = Val(Mid(strProcCd, 4, 3)) _
                    & "|fffd||fffd|" _
                    & Val(Mid(strProcCd, 7, 4)) _
                    & "-" _
                    & Val(Right(strProcCd, 6))
    Case Else
        'JT0+|fffd||1d7||fffd||fffd||50d||fffd|A|fffd||312|l3|fffd||fffd|+0000+|fffd||1d7||fffd||fffd||50d||fffd|B|fffd||312|l6|fffd||fffd|
        '|fffd||fffd||fffd|@|fffd||1d7||fffd||fffd||50d||fffd|[A-B]
        getProcNum = Val(Mid(strProcCd, 4, 3)) _
                    & "-" _
                    & Val(Right(strProcCd, 6))
    End Select
    
End Function
'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| start -------------------------------------------------------------------
' |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||38f||6ca|O|fffd||fffd||fffd|X|fffd|g|fffd|v|fffd||251||fffd||fffd||742||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|F |fffd|@|fffd||583|R|fffd|[|fffd|h
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|F |fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||50d||fffd|
' |fffd||7c2||fffd|l|fffd|@|fffd|F TRUE|fffd|F|fffd||fffd||fffd||fffd|/FALSE|fffd|F|fffd||202||fffd|
Private Function chkNonePersonInfo(ByVal strOrganCd As String, _
                                   ByVal strP_I_Num As String _
                                   ) As Boolean

Dim lngRow  As Long

On Error Resume Next
                            
    chkNonePersonInfo = False
                            
    lngRow = NONE_P_I_LIST_START_ROW_NUM
                            
    With ThisWorkbook.Sheets(SHT_NAME_NONE_P_I)
        Do While Trim(.Cells(lngRow, NONE_P_I_ORGAN_CD_COL_NUM).Value) <> ""
            If Trim(.Cells(lngRow, NONE_P_I_ORGAN_CD_COL_NUM).Value) = strOrganCd _
                And Trim(.Cells(lngRow, NONE_P_I_P_I_NUM_COL_NUM).Value) = strP_I_Num Then
                chkNonePersonInfo = True
                Exit Function
            End If
            lngRow = lngRow + 1
        Loop
    End With
    
End Function
'ADD 20171116 |fffd||6d1||fffd|45 |fffd||389||fffd| end -------------------------------------------------------------------
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g
Private Sub Worksheet_Change(ByVal Target As Range)
    
    Select Case Target.Column
        ' |fffd|\|fffd||fffd||fffd||656a||fffd||315||3cd|X|fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd|E|fffd||fffd||fffd||fffd||fffd||752||fffd|
        Case COL_03081_REQUEST
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||302||757|L|fffd||fffd|
            If ActiveSheet.ProtectContents = True Then Call execRowLock(ActiveSheet, Target)
    End Select
    
End Sub

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g
Private Sub Worksheet_Change(ByVal Target As Range)
    
    Select Case Target.Column
        ' |fffd|\|fffd||fffd||fffd||656a||fffd||315||3cd|X|fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd|E|fffd||fffd||fffd||fffd||fffd||752||fffd|
        Case COL_03082_REQUEST
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||302||757|L|fffd||fffd|
            If ActiveSheet.ProtectContents = True Then Call execRowLock(ActiveSheet, Target)
    End Select
    
End Sub
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g
Private Sub Worksheet_Change(ByVal Target As Range)
    
    Select Case Target.Column
        ' |fffd|\|fffd||fffd||fffd||656a||fffd||315||3cd|X|fffd|F|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd|E|fffd||fffd||fffd||fffd||fffd||752||fffd|
        Case COL_03083_REQUEST
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||302||757|L|fffd||fffd|
            If ActiveSheet.ProtectContents = True Then Call execRowLock(ActiveSheet, Target)
    End Select
    
End Sub
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdCreateDocument, 5, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdInputCheck, 4, 3, MSForms, CommandButton"
Option Explicit

'UPD |fffd|N|fffd||5c2||fffd||fffd||389||fffd| 20171213 start -------------------------------------------------
Const REQUEST_NUM_STR As String = "1903"
'Const REQUEST_NUM_STR As String = "01"
'UPD |fffd|N|fffd||5c2||fffd||fffd||389||fffd| 20171213 end -------------------------------------------------

' |fffd||fffd|o|fffd||fffd||fffd||78d||c42c|
Private Sub cmdCreateDocument_Click()

    Dim Filename        As String

    Dim outPath1        As String   ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||350||fffd|P|fffd|i|fffd|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||a39e||fffd||c42c||fffd||fffd|j
    Dim outPath2        As String   ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||350||fffd|Q|fffd|i|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||6041|WorkBook|fffd||193||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|j
    Dim xlsPath         As String   ' |fffd|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X
    Dim xlsPath2        As String   ' |fffd|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X|fffd|Q |fffd|fADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171031
    Dim zipPath1        As String   ' |fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|o|fffd||350||fffd|P|fffd|j
    Dim zipPath2        As String   ' |fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|o|fffd||350||fffd|Q|fffd|j|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||4b7d4||fffd|
    Dim attachDir       As String   ' |fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|t|fffd||fffd||fffd|p|fffd|X
    Dim appNameBase     As String   ' |fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd|{|fffd|j

    ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24e|g|fffd|p
    Dim dupBook         As Workbook
    Dim dupSheet        As Variant
    Dim dupSheetName    As String
    Dim delFlg          As Boolean  ' |fffd|V|fffd|[|fffd|g|fffd||d3dc||fffd|t|fffd||fffd||fffd|O
    Dim addFooterFlg    As Boolean  ' |fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd||fffd|t|fffd||fffd||fffd|O
    Dim protectFlg      As Boolean  ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|t|fffd||fffd||fffd|O

    ' |fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||24e|g|fffd|p
    Dim files(1)        As String   ' |fffd||fffd||fffd|k|fffd||38f||6c3|p|fffd|X|fffd||752||fffd|z|fffd||fffd|i|fffd|\|fffd||fffd||fffd||fffd||fffd|y|fffd||453|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|j
    Dim zipFile         As String
    Dim finalMsg        As String
    Dim errMsg          As String
    Dim ret             As Boolean

    Dim maxRow          As Long
    Dim maxCol          As Long
    Dim loopR           As Long
    Dim loopC           As Long
    Dim mergeCnt        As Long
    Dim cngCellAtt      As Boolean
    
    Dim outDateTime     As Date


On Error GoTo ERR_HND

    ' |fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
    If Range("|fffd|\|fffd||fffd||fffd||495||fffd||fffd||fffd||fffd||fffd|").Value = "" Then
        MsgBox "|fffd|\|fffd||fffd||fffd||495||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly + vbExclamation
        Exit Sub
    End If
        
    If Range("|fffd|\|fffd||fffd||fffd||48e||fffd||fffd||fffd|").Value = "" Then
        MsgBox "|fffd|\|fffd||fffd||fffd||48e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly + vbExclamation
        Exit Sub
    End If
    
    ' |fffd||fffd|o|fffd||fffd||fffd||78d||c42c||fffd|`|fffd|F|fffd|b|fffd|N
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171116 start ----------------------------------------------------
    If MsgBox("|fffd||fffd|o|fffd||fffd||fffd||782||fffd||fffd||c42c||fffd||fffd||fffd||702||fffd||fffd|B" _
                & vbCrLf _
                & vbCrLf _
                & "|fffd||fffd|o|fffd||fffd||fffd||782||30d||c42c||fffd||fffd||fffd||241|A|fffd|o|fffd|b|fffd|N|fffd|O|fffd||fffd||fffd|E|fffd||fffd||fffd|h|fffd||142||30d||fffd||182||34d|s|fffd||fffd||202||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" _
                & vbCrLf _
                & "|fffd||702||fffd||fffd|A|fffd||3cd|X|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd|c|fffd|[|fffd||fffd||fffd||20a|O|fffd||14a|J|fffd||fffd||fffd||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||351|S|fffd||115||82||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" _
                & vbCrLf _
                & vbCrLf _
                & "|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion) = vbNo Then
        
'    If MsgBox("|fffd||fffd|o|fffd||fffd||fffd||782||fffd||fffd||c42c||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion) = vbNo Then
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171116 end ----------------------------------------------------
        Exit Sub
    End If

    ' |fffd|e|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|
    outPath1 = addFolSepStr(IIf(Environ("TEMP") = "", ThisWorkbook.path, Environ("TEMP")))
    outPath2 = addFolSepStr(ThisWorkbook.path)
    
    outDateTime = Now()
' mod 20170828 |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||243||fffd||fffd|@|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|^
'    appNameBase = Mid(Range("N3").Value, 6, 5) & "_" & Range("N7").Value & "_" & "(03-07|fffd||fffd|03-08)|fffd||3cd|X|fffd|\|fffd||fffd||fffd||fffd|_" & Format(outDateTime, "yyyymmddhhmm")
    appNameBase = Mid(Range("N3").Value, 6, 5) & "_" & Range("N7").Value & "_" & "(03-07|fffd||fffd|03-08)|fffd||3cd|X|fffd|\|fffd||fffd||fffd||fffd|_Ver" & Split(getRirekiData(True), ".")(0) & "_" & Format(outDateTime, "yyyymmddhhmm")
    
    xlsPath = outPath1 & appNameBase & ".xlsm"
    xlsPath2 = outPath2 & appNameBase & ".xlsm"  'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171031
    zipPath1 = outPath1 & appNameBase & ".zip"
    zipPath2 = outPath2 & appNameBase & ".zip"
    attachDir = outPath2 & ATTACH_DIR_NAME
    

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||6ce||fffd|
    Filename = ThisWorkbook.Name

    ' |fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|\|fffd||fffd|
    UserForm4.Show vbModeless
    
    DoEvents
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||143||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    Call subSheetBookLock(False)
    
    ' |fffd|\|fffd||fffd||fffd||30a|e|fffd||fffd||fffd||682||303|Z|fffd|b|fffd|g
    Call unprotectWorkSheet(Sheets("|fffd|\|fffd||fffd|"))
    Sheets("|fffd|\|fffd||fffd|").Range("N11").Value = Range("|fffd|@|fffd||583|R|fffd|[|fffd|h").Value
    Sheets("|fffd|\|fffd||fffd|").Range("N13").Value = Range("|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h").Value
    Sheets("|fffd|\|fffd||fffd|").Range("N15").Value = Range("|fffd|@|fffd||596||fffd|").Value
    Sheets("|fffd|\|fffd||fffd|").Range("AD11").Value = Range("|fffd|\|fffd||fffd||fffd||495||fffd||fffd||fffd||fffd||fffd|").Value
    Sheets("|fffd|\|fffd||fffd|").Range("AD13").Value = Range("|fffd|\|fffd||fffd||fffd||490|E|fffd||fffd|").Value
    Sheets("|fffd|\|fffd||fffd|").Range("AD15").Value = Range("|fffd|\|fffd||fffd||fffd||48e||fffd||fffd||fffd|").Value
    'UPD |fffd|N|fffd||5c2||fffd||fffd||389||fffd| 20171213 start -------------------------------------------------
    Sheets("|fffd|\|fffd||fffd|").Range("L19").Value = Left(Range("N3").Value & "000000000000", 12) & REQUEST_NUM_STR
'    Sheets("|fffd|\|fffd||fffd|").Range("L19").Value = Left(Range("N3").Value & "000000000000", 12) & Right(Year(Date), 2) & REQUEST_NUM_STR
    'UPD |fffd|N|fffd||5c2||fffd||fffd||389||fffd| 20171213 start -------------------------------------------------
    Sheets("|fffd|\|fffd||fffd|").Range("L21").Value = Format(outDateTime, "yyyy|fffd|N m|fffd||fffd| d|fffd||fffd|" & vbCrLf & "( h|fffd||fffd| m|fffd||fffd| )")
    Sheets("|fffd|\|fffd||fffd|").Range("C26").Value = "Ver." & getRirekiData(True)
    Call protectWorkSheet(Sheets("|fffd|\|fffd||fffd|"))
    
    ' |fffd||fffd||fffd|~|fffd|R|fffd|s|fffd|[
    Call copyMakeFormSheet
    DoEvents
    
    ' |fffd||fffd||fffd||fffd|
    ActiveWorkbook.SaveCopyAs xlsPath
    DoEvents
    
    Set dupBook = Workbooks.Open(xlsPath)

    ' |fffd||fffd||fffd||fffd|Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311||fffd||fffd||fffd|
    With dupBook
        
        ' |fffd|u|fffd|b|fffd|N|fffd||303||fffd||fffd|b|fffd|N|fffd||309||fffd||fffd||fffd|
        .Unprotect TOOL_LOCK_PWD
        
        ' |fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||311|S|fffd|V|fffd|[|fffd|g|fffd||143||fffd||fffd|[|fffd|v
        For Each dupSheet In .Worksheets
            
            ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
            Call unprotectWorkSheet(dupSheet, TOOL_LOCK_PWD)
            
            delFlg = False
            addFooterFlg = False
            protectFlg = False
            
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||242||fffd||93c8||fffd||fffd||fffd||fffd||fffd||fffd|
            dupSheetName = dupSheet.Name
            
            Select Case dupSheetName
                
                Case "|fffd|\|fffd||fffd|"
                    
                    ' |fffd|\|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
                    dupSheet.Visible = True
                    dupSheet.Select
                    dupSheet.Cells(1, 1).Select
                    
                    ' |fffd||fffd||fffd||fffd||fffd||6cc||fffd|A|fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd|
                    addFooterFlg = True
                    protectFlg = True
                
                ' |fffd|o|fffd|^|fffd|E|fffd||3cd|X|fffd||fffd||fffd|e
                Case C_APP_FORM_SHEET_COPY_NAME
                
                    ' |fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||310||752||fffd|
                    ActiveWindow.Zoom = 100
                    dupSheet.PageSetup.Zoom = False
                    dupSheet.PageSetup.FitToPagesWide = 1
                    
                    ' |fffd||fffd||fffd||fffd||fffd||6cc||fffd|A|fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd|
                    addFooterFlg = True
                    protectFlg = True
                
                Case "|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd|", "organ_mst", "|fffd||246b||fffd||fffd||fffd||fffd|_|fffd|l|fffd||fffd||fffd|L|fffd||fffd|"
                    
                    ' |fffd||6cc||fffd||202||fffd||fffd|A|fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd||fffd||202||fffd|
                    addFooterFlg = False
                    protectFlg = False
                
                Case "|fffd||fffd||fffd||85da||fffd||fffd|"
                    
                    ' |fffd||6cc||c0a0||fffd||fffd|A|fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd||fffd||202||fffd|
                    addFooterFlg = False
                    protectFlg = True
                
                Case Else
                    
                    ' |fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|`|fffd|F|fffd|b|fffd|N
                    If (Left(dupSheetName, 1) = "|fffd|l") Then
                
                        ' |fffd||14f|I|fffd|s|fffd|A|fffd||14f|I|fffd||fffd||30e||64fe|
                        maxRow = dupSheet.Cells(dupSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row
                        maxCol = dupSheet.Cells(DATA_TITLE_ROW_NUM, dupSheet.Columns.Count).End(xlToLeft).Column
        
                        ' |fffd||14f|I|fffd|s|fffd||fffd|10|fffd|i|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|s|fffd||202||fffd||fffd|j|fffd||30f||a347|
                        ' |fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|s|fffd||202||fffd||fffd||142||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd|O|fffd||fffd|
                        If maxRow < DATA_START_ROW_NUM Then
                            maxRow = DATA_START_ROW_NUM
                        Else
                            ' |fffd||fffd|s|fffd||d3dc|
                            dupSheet.Rows(maxRow + 1).Delete
                        End If
        
                        ' |fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|{
                        Call cellRock(dupSheet, DATA_START_ROW_NUM, DATA_START_COL_NUM, maxRow, maxCol, True)
                    
                        ' |fffd||fffd||fffd||fffd||fffd||6cc||fffd|A|fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd|
                        addFooterFlg = True
                        protectFlg = True
                    
                    Else
                        ' |fffd||fffd||fffd||311||fffd||fffd|F|fffd||d3dc||fffd||38f||fffd|
                        delFlg = True
                    End If
            End Select
                        
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||281|j
            If delFlg = True Then
                ' |fffd|V|fffd|[|fffd|g|fffd||d3dc|
                Debug.Print "|fffd||d3dc||fffd|V|fffd|[|fffd|g|fffd|F" & dupSheetName
                dupSheet.Delete
            Else
                ' |fffd|t|fffd|b|fffd|^|fffd|[|fffd||1c9||fffd|
                If addFooterFlg = True Then
                    With dupSheet.PageSetup
                        .LeftFooter = "&08&F"
                        '.CenterFooter = "&08&A"
                        '.RightFooter = "&08&P/&N"
                    End With
                End If
            
                ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|
                If protectFlg = True Then
                    If (Left(dupSheetName, 1) = "|fffd|l") Then
                        Call protectWorkSheet(dupSheet, OUT_XLS_SHEET_PWD)
                    Else
                        Call protectWorkSheet(dupSheet, TOOL_LOCK_PWD)
                    End If
                End If
            End If
            
        Next dupSheet
    
        ' |fffd|u|fffd|b|fffd|N|fffd||315||6cc||fffd||195||6d1||fffd|
        .protect TOOL_LOCK_PWD, True
        .SaveAs xlsPath, xlOpenXMLWorkbookMacroEnabled
        .Close
    End With
    
    'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171031 start ----------------------------------------------------
    '|fffd|uTEMP|fffd|v|fffd||310|\|fffd||fffd||fffd||fffd||fffd||fffd|zip|fffd||c42c||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||243|R|fffd|s|fffd|[
    '|fffd||fffd||fffd||fffd||fffd|k|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd|Azip|fffd||c42c||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||250|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd||fffd||fffd||fffd|
    FileCopy xlsPath, xlsPath2
    'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171031 end ----------------------------------------------------
    
    ' |fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c|
    files(0) = xlsPath
    files(1) = attachDir
    ret = createZipFile(files, zipPath1, errMsg)
    
    'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 start ----------------------------------------------------
    ' zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||308||693||fffd|
    If Dir(zipPath1) <> "" Then
        Name zipPath1 As zipPath2
    End If
    'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 end ----------------------------------------------------
    
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171031 start ----------------------------------------------------
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 start ----------------------------------------------------
    'UPD |fffd||6d1||fffd|39|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171208 start ----------------------------------------------------
    If Dir(zipPath2) <> "" _
        And Dir(xlsPath) <> "" _
        And Dir(xlsPath2) <> "" _
        And ret = True Then
        ' |fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd||82|Q|fffd||82||310|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|uTEMP|fffd|v|fffd||310|\|fffd||fffd||fffd||fffd||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd|A
        ' |fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||7c2||fffd|l|fffd|FTRUE|fffd|j|fffd||fffd||fffd||102||fffd||fffd||fffd||381|A
        ' |fffd|Q|fffd||82||310|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc|
'    If Dir(zipPath2) <> "" _
'        And Dir(xlsPath) <> "" _
'        And Dir(xlsPath2) <> "" Then
'        ' |fffd||fffd||fffd|k|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||82|Q|fffd||82||310|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|uTEMP|fffd|v|fffd||310|\|fffd||fffd||fffd||fffd||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||381|A
'        ' |fffd|Q|fffd||82||310|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc|
    'UPD |fffd||6d1||fffd|39|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171208 end ----------------------------------------------------
'    If Dir(zipPath1) <> "" _
'        And Dir(xlsPath) <> "" _
'        And Dir(xlsPath2) <> "" Then
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 end ----------------------------------------------------

        CreateObject("Scripting.FileSystemObject").DeleteFile xlsPath
        CreateObject("Scripting.FileSystemObject").DeleteFile xlsPath2
        
    'ADD |fffd||6d1||fffd|39|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171208 start ----------------------------------------------------
    Else
        '|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|s|fffd||30f||a347|
        If errMsg = "" Then
            '|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|
            '|fffd|ierrMsg|fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|j
            errMsg = "|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & Err.Description
        End If
    'ADD |fffd||6d1||fffd|39|fffd|i|fffd|s|fffd||fffd||fffd|j|fffd||389||fffd| 20171208 end ----------------------------------------------------
    End If
    
'    ' |fffd||fffd||fffd|k|fffd||310||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||fffd||70b8||fffd|A|fffd||c42c||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc|
'    CreateObject("Scripting.FileSystemObject").DeleteFile files(0)
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171031 end ----------------------------------------------------
    
    DoEvents
    
    ' |fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
    Windows(Filename).Activate
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|~|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
    Sheets(C_APP_FORM_SHEET_COPY_NAME).Delete
    
    ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
    Sheets("|fffd|`|fffd|F|fffd|b|fffd|N").Select

    ' |fffd||fffd||fffd|k|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    If errMsg <> "" Then
        Unload UserForm4
        
        Call subSheetBookLock(True)
        MsgBox errMsg, vbOKOnly + vbCritical
        Exit Sub
    End If

    'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171116 start ----------------------------------------------------
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 start ----------------------------------------------------
    If Dir(zipPath2) = "" Then
'    If Dir(zipPath1) = "" Then
    'UPD |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 end ----------------------------------------------------
        Unload UserForm4
        
        Call subSheetBookLock(True)
        GoTo ERR_HND
    End If
    'ADD |fffd||6d1||fffd|39|fffd||389||fffd| 20171116 end ----------------------------------------------------
    
    'DEL |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 start ----------------------------------------------------
'    ' zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||308||693||fffd|
'    Name zipPath1 As zipPath2
    'DEL |fffd||6d1||fffd|39|fffd||389||fffd| 20171124 end ----------------------------------------------------
    
    ' |fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
    Unload UserForm4
    
    Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W").Value = "|fffd||fffd|o|fffd||fffd||fffd||78d||c42c||fffd||fffd||fffd|{|fffd||fffd|"
    Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W").Font.color = vbBlue
    Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W").Interior.color = vbWhite
    cmdCreateDocument.Enabled = False
    
    Call subSheetBookLock(True)
    
    Application.Wait (Now() + TimeValue("0:00:03"))
    
    ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||34a||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
    finalMsg = "|fffd|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|izip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|j|fffd||30d||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf
    finalMsg = finalMsg & "|fffd||c42c||fffd||fffd||fffd||a0bd|zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|[|fffd|N|fffd|t|fffd||fffd||fffd|[|fffd||243|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf
    finalMsg = finalMsg & "zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||343|c|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||24a|i|fffd|[|fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf
    finalMsg = finalMsg & "|fffd|\|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & vbCrLf
    finalMsg = finalMsg & appNameBase & ".zip"
    
    MsgBox finalMsg, vbOKOnly + vbInformation
    
    Exit Sub
    
ERR_HND:
    Unload UserForm4
    Call subSheetBookLock(True)
    MsgBox "|fffd||fffd|o|fffd||fffd||fffd||782||30d||c42c||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & Err.Description, vbOKOnly + vbCritical

End Sub

' |fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s
Private Sub cmdInputCheck_Click()

    Dim col         As Collection   ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd|
    Dim chkSheet    As Boolean      ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    Dim msgRowMax   As Long
    Dim blnNoErr    As Boolean      ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||fffd||fffd||fffd|
    Dim curSheet    As Worksheet
    
    
    ' |fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|\|fffd||fffd|
    UserForm4.Show vbModeless
    DoEvents
    
    ' |fffd|`|fffd||fffd||312||fffd|~
    Call setDrawControl
    
    Set curSheet = ActiveSheet
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
    Call unprotectWorkSheet(curSheet)
    
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||683||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    msgRowMax = ActiveSheet.Cells(ActiveSheet.Rows.Count, 5).End(xlUp).Row
    If msgRowMax > 14 Then
        ActiveSheet.Range("15:" & msgRowMax).Delete
    End If
    
    ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||fffd||fffd||fffd|Ftrue(|fffd|G|fffd||fffd||fffd|[|fffd||202||fffd|)
    blnNoErr = True
    
    ' ==============================
    ' |fffd|l|fffd||fffd|03-07(1)|fffd||303|`|fffd|F|fffd|b|fffd|N
    ' ==============================
    If chk0307("|fffd|l03-07_1", col) = True Then
        ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||30f|o|fffd||fffd|
        Call outputNormalMsg("|fffd|l03-07_1", ERR_MSG_NONE)
    Else
        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
        blnNoErr = False
        Call outputErrMsg("|fffd|l03-07_1", col)
    End If

    ' ==============================
    ' |fffd|l|fffd||fffd|03-07(2)|fffd||303|`|fffd|F|fffd|b|fffd|N
    ' ==============================
    If chk0307("|fffd|l03-07_2", col) = True Then
        ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||30f|o|fffd||fffd|
        Call outputNormalMsg("|fffd|l03-07_2", ERR_MSG_NONE)
    Else
        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
        blnNoErr = False
        Call outputErrMsg("|fffd|l03-07_2", col)
    End If

    ' ==============================
    ' |fffd|l|fffd||fffd|03-08(1)|fffd||303|`|fffd|F|fffd|b|fffd|N
    ' ==============================
    If chk03081(col) = True Then
        ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||30f|o|fffd||fffd|
        Call outputNormalMsg("|fffd|l03-08_1", ERR_MSG_NONE)
    Else
        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
        blnNoErr = False
        Call outputErrMsg("|fffd|l03-08_1", col)
    End If
    
    ' ==============================
    ' |fffd|l|fffd||fffd|03-08(2)|fffd||303|`|fffd|F|fffd|b|fffd|N
    ' ==============================
    If chk03082(col) = True Then
        ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||30f|o|fffd||fffd|
        Call outputNormalMsg("|fffd|l03-08_2", ERR_MSG_NONE)
    Else
        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
        blnNoErr = False
        Call outputErrMsg("|fffd|l03-08_2", col)
    End If

    ' ==============================
    ' |fffd|l|fffd||fffd|03-08(3)|fffd||303|`|fffd|F|fffd|b|fffd|N
    ' ==============================
    If chk03083(col) = True Then
        ' |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd||fffd||30f|o|fffd||fffd|
        Call outputNormalMsg("|fffd|l03-08_3", ERR_MSG_NONE)
    Else
        ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
        blnNoErr = False
        Call outputErrMsg("|fffd|l03-08_3", col)
    End If

    curSheet.Select
    
    With Range("|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W")
         
        ' |fffd|S|fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
        If blnNoErr = True Then
            .Value = "|fffd|\|fffd||fffd||fffd||48f||fffd||fffd||fffd||fffd||fffd||34c||fffd|A|fffd||fffd|o|fffd||fffd||fffd||78d||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@"
            .Font.color = vbWhite
            .Interior.color = vbBlue
            
            ' |fffd|u|fffd||fffd|o|fffd||fffd||fffd||78d||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            cmdCreateDocument.Enabled = True
        Else
            .Value = " |fffd|G|fffd||fffd||fffd|[|fffd||4cf||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            .Font.color = vbWhite
            .Interior.color = vbRed
            
            ' |fffd|u|fffd||fffd|o|fffd||fffd||fffd||78d||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||4a210||fffd|
            cmdCreateDocument.Enabled = False
        End If
        
    End With
    
    Unload UserForm4
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|
    Call protectWorkSheet(curSheet)
    
    Set curSheet = Nothing
    
    ' |fffd|`|fffd||fffd||30a|J|fffd|n
    Call setDrawControl(True)

    ' |fffd|m|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O
    MsgBox "|fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbOKOnly + vbInformation

End Sub

' |fffd|V|fffd|[|fffd|g|fffd|y|fffd||443|u|fffd|b|fffd|N|fffd||303||fffd||fffd|b|fffd|N|fffd|^|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
Private Sub subSheetBookLock(protect As Boolean)

    If protect = True Then
        ' |fffd|V|fffd|[|fffd|g|fffd||303||fffd||fffd|b|fffd|N
        ActiveSheet.protect Password:=TOOL_LOCK_PWD
        
        ' |fffd|u|fffd|b|fffd|N|fffd||303||fffd||fffd|b|fffd|N
        ThisWorkbook.protect TOOL_LOCK_PWD, True
        
        ' |fffd|`|fffd||fffd||30a|J|fffd|n
        Call setDrawControl(True)
    Else
        ' |fffd|`|fffd||fffd||312||fffd|~
        Call setDrawControl
        
        ' |fffd|u|fffd|b|fffd|N|fffd||303||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
        ThisWorkbook.Unprotect TOOL_LOCK_PWD
        
        ' |fffd|V|fffd|[|fffd|g|fffd||303||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
        ActiveSheet.Unprotect Password:=TOOL_LOCK_PWD
    End If

End Sub

' |fffd||64f||d0c1||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||310||752||fffd|
Private Sub outputErrMsg(ByVal sheetName As String, ByRef col As Collection)

    Dim targetRow   As Long
    Dim rowCnt      As Long
    Dim item        As Variant
    
    ' |fffd||fffd||fffd||742||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||149||fffd||fffd|s|fffd||fffd||fffd||64fe|
    targetRow = Cells(Rows.Count, 5).End(xlUp).Row
    
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|s|fffd||310||752||fffd|
    For rowCnt = 1 To col.Count
    
        ' |fffd|O|fffd||30d|s|fffd||1584e||282||fffd||fffd|A|fffd|}|fffd||fffd|
        Rows(targetRow + rowCnt - 1).Copy
        Rows(targetRow + rowCnt).Insert
    
        ' |fffd||64ea||fffd|s|fffd||302||742||30f||fffd||fffd||fffd|
        If rowCnt = 1 Then
            ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||310||64ea||fffd|s|fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||752||fffd|
            If targetRow = 14 Then
                Rows(15).Interior.color = RGB(255, 255, 255)    '16777215
                Range("M15").MergeArea.HorizontalAlignment = xlGeneral
                Range("M15").MergeArea.WrapText = True
            End If

            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||310||752||fffd|
            Cells(targetRow + 1, 5).Value = sheetName
        End If

        ' No|fffd|E|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||310||752||fffd|
        item = col.item(rowCnt)
        Cells(targetRow + rowCnt, 10).Value = item(0)
        Cells(targetRow + rowCnt, 13).Value = item(1)
        
        ' |fffd|s|fffd||fffd||fffd||fffd||fffd||30e|w|fffd||fffd|
        Rows(targetRow + rowCnt).RowHeight = Application.RoundUp(Len(item(1)) / 53, 0) * 10.5
    Next
    Application.CutCopyMode = False

End Sub

' |fffd||fffd||fffd||d0c1||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||310||752||fffd|
Public Sub outputNormalMsg(ByVal sheetName As String, ByVal msg As String)
    
    Dim targetRow   As Long
    Dim sheet       As Worksheet

    Set sheet = ThisWorkbook.Sheets("|fffd|`|fffd|F|fffd|b|fffd|N")
    
    With sheet
    
        ' |fffd|s|fffd|}|fffd||fffd|
        targetRow = Cells(.Rows.Count, 5).End(xlUp).Row
        Rows(targetRow).Copy
        targetRow = targetRow + 1
        Rows(targetRow).Insert
    
        ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||310||64ea||fffd|s|fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||752||fffd|
        If targetRow = 15 Then
            Rows(15).Interior.color = RGB(255, 255, 255)    '16777215
            Range("M15").MergeArea.HorizontalAlignment = xlGeneral
            Range("M15").MergeArea.WrapText = True
        End If
    
        ' |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|Z|fffd|b|fffd|g
        Cells(targetRow, 5).Value = sheetName
        Cells(targetRow, 10).Value = "|fffd||"
        Cells(targetRow, 13).Value = msg

        ' |fffd|s|fffd||fffd||fffd||fffd||fffd||30e|w|fffd||fffd|
        Rows(targetRow).RowHeight = Application.RoundUp(Len(msg) / 53, 0) * 10.5

    End With
    Application.CutCopyMode = False
    
End Sub

' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||683||fffd||fffd|X|fffd|g|fffd||303|N|fffd||fffd||fffd|A
' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|E|fffd||6cc||fffd||fffd||fffd||fffd||fffd||34c||102||44f|o|fffd||fffd||fffd||fffd||fffd||14d|s|fffd||fffd|
Public Sub clearErrList()

    Dim sheet       As Worksheet
    Dim msgRowMax   As Long

    Set sheet = ThisWorkbook.Sheets("|fffd|`|fffd|F|fffd|b|fffd|N")
    
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||683||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    msgRowMax = sheet.Cells(sheet.Rows.Count, 5).End(xlUp).Row
    If msgRowMax > 14 Then
        sheet.Range("15:" & msgRowMax).Delete
    End If
    
End Sub

' |fffd||fffd||fffd|~|fffd|\|fffd||315||fffd||fffd||fffd|
Private Sub copyMakeFormSheet()
    
    Dim newSheet            As Worksheet
    Dim orgSheet            As Worksheet
    
    Dim inqStartRow         As Long     ' |fffd||fffd||fffd||fffd||fffd||a5d7||fffd||30f|I|fffd||fffd||fffd|s
    Dim inqEndRow           As Long     ' |fffd||fffd||fffd||fffd||fffd||a5d7||fffd||30f|I|fffd||fffd||fffd|s
    Dim proStartRow         As Long     ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f08||a5d7||fffd||30a|J|fffd|n|fffd|s
    Dim proEndRow           As Long     ' |fffd||fffd||fffd||fffd||90|l|fffd||fffd||56f08||a5d7||fffd||30f|I|fffd||fffd||fffd|s
    Dim variableStartRow    As Long     ' Window|fffd|g|fffd||30c||152||fffd|s
    Dim loopC               As Long     ' |fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|
    Dim orgShape            As Variant  ' |fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g


On Error GoTo ERR_HND

    ' |fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||312||1c9||fffd|
    Set orgSheet = ActiveWorkbook.Worksheets(Worksheets(C_APP_FORM_SHEET_NAME).Name)
    Set newSheet = ActiveWorkbook.Worksheets.Add(orgSheet)
    newSheet.Name = C_APP_FORM_SHEET_COPY_NAME

    ' Window|fffd|g|fffd||30c||152||fffd|s
    variableStartRow = 16

    ' |fffd||a5d7||fffd||30a|J|fffd|n|fffd|E|fffd|I|fffd||fffd||fffd|s|fffd||64fe|
    With orgSheet
        inqStartRow = C_BIZ_START_ROW_NUM
        inqEndRow = .Range(.Cells(inqStartRow, C_NUMBER_COL_NUM).Address).End(xlDown).Row
        proStartRow = .Range(.Cells(inqEndRow, C_NUMBER_COL_NUM).Address).End(xlDown).Row + 1
        proEndRow = .Range(.Cells(proStartRow, C_NUMBER_COL_NUM).Address).End(xlDown).Row
    End With
    
    With newSheet
                
        ' ********************
        ' |fffd|w|fffd|b|fffd|_|fffd|[|fffd||fffd||fffd||310|V|fffd||fffd|
        ' ********************
        For Each orgShape In orgSheet.Shapes
            
            Debug.Print orgShape.Name
            
            ' |fffd|R|fffd|}|fffd||fffd||fffd|h|fffd|{|fffd|^|fffd||fffd||fffd|A|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd|A|fffd||fffd||fffd||fffd||fffd|n|fffd||fffd||fffd|x|fffd||fffd||fffd||20a|O|fffd||fffd|S|fffd|R|fffd|s|fffd|[
            If (Left(orgShape.Name, 3) <> "cmd") And _
                (Left(orgShape.Name, 3) <> "txt") And _
                (Left(orgShape.Name, 9) <> "lblSearch") And _
                (Left(orgShape.Name, 9) <> "Drop Down") Then
                
                orgShape.Copy
                .Paste
                .Shapes(.Shapes.Count).Top = orgShape.Top
                .Shapes(.Shapes.Count).Left = orgShape.Left
            End If
        Next
                
        ' ********************
        ' |fffd||a5d7||fffd||315||fffd||fffd||fffd|
        ' ********************
        'UPD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
        orgSheet.Range(orgSheet.Cells(variableStartRow - 1, C_NUMBER_COL_NUM), orgSheet.Cells(proEndRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Copy
'        orgSheet.Range(orgSheet.Cells(variableStartRow - 1, C_NUMBER_COL_NUM), orgSheet.Cells(proEndRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Copy
        'UPD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------
        .Cells(variableStartRow - 1, C_NUMBER_COL_NUM).PasteSpecial
        Application.CutCopyMode = False
        
        ' |fffd||fffd||fffd||303|J|fffd||fffd||fffd||fffd||fffd||310|F|fffd||fffd||fffd|u|fffd||fffd||fffd|v
        .Range(.Cells(variableStartRow, C_BIZ_P_I_NAME_COL_NUM), .Cells(proEndRow, C_BIZ_P_I_NAME_COL_NUM)).Font.color = vbBlack
        
        ' |fffd||fffd||fffd||350||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
        .Range(.Cells(inqStartRow, C_NUMBER_USE_LAW_COL_NUM + 2), .Cells(inqEndRow, C_NUMBER_USE_LAW_COL_NUM + 2)).Validation.Delete
        .Range(.Cells(inqStartRow, C_NUMBER_USE_LAW_COL_NUM + 4), .Cells(inqEndRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Validation.Delete
        .Range(.Cells(proStartRow, C_NUMBER_USE_LAW_COL_NUM + 2), .Cells(proEndRow, C_NUMBER_USE_LAW_COL_NUM + 2)).Validation.Delete
        .Range(.Cells(proStartRow, C_NUMBER_USE_LAW_COL_NUM + 4), .Cells(proEndRow, C_NUMBER_USE_LAW_COL_NUM + 4)).Validation.Delete
        .Range(.Cells(proStartRow, C_NUMBER_USE_LAW_COL_NUM + 6), .Cells(proEndRow, C_NUMBER_USE_LAW_COL_NUM + 6)).Validation.Delete
        'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
        .Range(.Cells(proStartRow, C_NUMBER_USE_LAW_COL_NUM + 7), .Cells(proEndRow, C_NUMBER_USE_LAW_COL_NUM + 7)).Validation.Delete
        'ADD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------
        
        ' ********************
        ' |fffd|S|fffd||310||fffd||fffd||fffd|
        ' ********************
        
        ' |fffd||55742||315||fffd||fffd||fffd|
        'UPD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
        For loopC = 1 To C_NUMBER_USE_LAW_COL_NUM + 8
'        For loopC = 1 To C_NUMBER_USE_LAW_COL_NUM + 7
        'UPD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------
            .Columns(loopC).ColumnWidth = orgSheet.Columns(loopC).ColumnWidth
        Next
    
        ' |fffd|s|fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd|
        For loopC = 1 To proEndRow
            .Rows(loopC).RowHeight = orgSheet.Rows(loopC).RowHeight
        Next
        
        ' |fffd||fffd||fffd||fffd||348||350||752||fffd|
        'UPD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| start -------------------------------------------------------------------
        .PageSetup.PrintArea = .Range(.Cells(1, 1), .Cells(proEndRow + 1, C_NUMBER_USE_LAW_COL_NUM + 8)).Address
'        .PageSetup.PrintArea = .Range(.Cells(1, 1), .Cells(proEndRow + 1, C_NUMBER_USE_LAW_COL_NUM + 7)).Address
        'UPD 20171207 |fffd||6d1||fffd|45|fffd|i|fffd|s|fffd||fffd||fffd|j |fffd||389||fffd| end -------------------------------------------------------------------
        
        ' |fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd|
        ActiveWindow.DisplayGridlines = False
        ActiveWindow.FreezePanes = False
        .Rows(variableStartRow).Select
        ActiveWindow.FreezePanes = True
        ActiveWindow.view = xlPageBreakPreview
        
''        .Cells.Font.Name = "|fffd|l|fffd|r |fffd||fffd||fffd||fffd|"
''        .Cells.Font.Size = "10"
        .Cells.Locked = True
        
        .Cells(1, 1).Select
    End With
    
    Exit Sub

ERR_HND:
    Debug.Print Err.Number & Err.Description
    Err.Clear

End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Workbook_Open()
    'ADD |fffd||fffd||fffd| |fffd||6d1||fffd|32|fffd||389||fffd||fffd|C|fffd||fffd||fffd|@20190724|fffd|@Start---
    Dim i As Integer   'For|fffd||fffd|

    For i = 1 To ThisWorkbook.Sheets.Count '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||702||143||fffd||fffd|[|fffd|v

        If Sheets(i).Name = C_APP_FORM_SHEET_NAME Then    '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd||30f||a347|
            If Worksheets(C_03081_SHEET_NAME).Visible = True Then  '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||317|l|fffd||fffd|3-08_1|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Call protectWorkSheet(ThisWorkbook.Sheets(C_03081_SHEET_NAME)) '|fffd|l03-08_1|fffd|V|fffd|[|fffd|g|fffd||fffd||6cc||fffd|
            End If
                            
            If Worksheets(C_03082_SHEET_NAME).Visible = True Then  '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||317|l|fffd||fffd|3-08_2|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Call protectWorkSheet(ThisWorkbook.Sheets(C_03082_SHEET_NAME)) '|fffd|l03-08_2|fffd|V|fffd|[|fffd|g|fffd||fffd||6cc||fffd|
            End If
    
            If Worksheets(C_03083_SHEET_NAME).Visible = True Then  '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||317|l|fffd||fffd|3-08_3|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Call protectWorkSheet(ThisWorkbook.Sheets(C_03083_SHEET_NAME)) '|fffd|l03-08_3|fffd|V|fffd|[|fffd|g|fffd||fffd||6cc||fffd|
            End If
                ' ADD |fffd||6d1||fffd|32|fffd||389||fffd| 20190704 AND|fffd||fffd||fffd| start-----
                '        Call protectWorkSheet(ThisWorkbook.Sheets("|fffd|l03-08_1")) '|fffd|l03-08_1|fffd|V|fffd|[|fffd|g|fffd||fffd||6cc||fffd|
                '        Call protectWorkSheet(ThisWorkbook.Sheets("|fffd|l03-08_2")) '|fffd|l03-08_2|fffd|V|fffd|[|fffd|g|fffd||fffd||6cc||fffd|
                '        Call protectWorkSheet(ThisWorkbook.Sheets("|fffd|l03-08_3")) '|fffd|l03-08_3|fffd|V|fffd|[|fffd|g|fffd||fffd||6cc||fffd|
                ' ADD |fffd||6d1||fffd|32|fffd||389||fffd| 20190704 AND|fffd||fffd||fffd| end -----
            Exit For    '|fffd||fffd||fffd|[|fffd|v|fffd|I|fffd||fffd|
        End If
    Next i  '|fffd||fffd||fffd||303|V|fffd|[|fffd|g|fffd||50d||fffd|
    'ADD |fffd||fffd||fffd| |fffd||6d1||fffd|32|fffd||389||fffd||fffd|C|fffd||fffd||fffd|@20190724|fffd|@End---
End Sub

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{DF092CD6-2EAD-44C7-8CF2-86A09E0ACAF6}{6D7C7366-2EB3-4EA8-A2A9-36527D85372D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

' |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||155||6ce||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|C|fffd|x|fffd|[|fffd|g|fffd||3d0||fffd|
Private masterSheet     As Worksheet    ' |fffd||10f|o|fffd||fffd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g

'----------------------------------------
' |fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub cmdClose_Click()
    Unload Me
End Sub

'----------------------------------------
' |fffd||fffd||fffd|f|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub cmdRefrect_Click()

    Dim maxRowNum       As Long     ' |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30d||151||5340||fffd||fffd|
    Dim targetRowNum    As Long     ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|E|fffd|@|fffd||596||fffd||fffd||302||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||9340||fffd||fffd|
    Dim targetRow       As Long     ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||38f||6cd|s
    Dim targetCol       As Long     ' |fffd|\|fffd||fffd||fffd||656a||fffd|m|fffd|F|fffd||fffd|
    Dim organCdCol      As Long     ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|Z|fffd|b|fffd|g|fffd||38f||6d7||fffd|
    Dim organ_cd        As String   ' |fffd|@|fffd||583|R|fffd|[|fffd|h
    Dim organ_name      As String   ' |fffd|@|fffd||596||fffd|


    ' |fffd||fffd||fffd||34d||fffd||fffd||502||30e||64fe|
    If Len(Trim(Me.txtRowNum.Text)) = 0 Then
        MsgBox "No.|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    Else
        targetRowNum = CLng(Trim(Me.txtRowNum.Text))
    End If
    
    ' |fffd|I|fffd||fffd||fffd|s|fffd||30e||64fe|
    If Me.lstOrganName.ListIndex = -1 Then
        MsgBox "|fffd||752||80b7||fffd||fffd|@|fffd||596||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||151||5340||fffd||510||fffd||fffd||fffd||fffd||64fe|
    If masterSheet.Cells(masterSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row = DATA_TITLE_ROW_NUM Then
        maxRowNum = 0
    Else
        maxRowNum = CLng(masterSheet.Cells(masterSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Value)
    End If

    ' |fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd|
    If targetRowNum > 0 And targetRowNum <= maxRowNum Then

        organ_cd = Me.lstOrganName.List(Me.lstOrganName.ListIndex, 1)
        organ_name = Me.lstOrganName.List(Me.lstOrganName.ListIndex, 0)
       
        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd||303|Z|fffd|b|fffd|g|fffd||38f||6cd|s|fffd|E|fffd||fffd||50d||fffd||fffd||64fe|
        targetRow = DATA_TITLE_ROW_NUM + targetRowNum
        Select Case masterSheet.Name
            Case "|fffd|l03-08_1"
                targetCol = COL_03081_REQUEST
                organCdCol = COL_03081_ORGAN_CD
            Case "|fffd|l03-08_2"
                targetCol = COL_03082_REQUEST
                organCdCol = COL_03082_ORGAN_CD
            Case "|fffd|l03-08_3"
                targetCol = COL_03083_REQUEST
                organCdCol = COL_03083_ORGAN_CD
        End Select
        
        ' |fffd||fffd||fffd||351||38f||6c3|Z|fffd||fffd||fffd||303||fffd||fffd|b|fffd|N|fffd||fffd||502||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|B
        If masterSheet.ProtectContents = True And masterSheet.Cells(targetRow, targetCol).Value <> REQUEST_ENTRY Then
            
            ' |fffd||48f|WNG|fffd|s|fffd||582||30e|w|fffd||839e|
            MsgBox "|fffd|w|fffd||fffd||fffd|No.|fffd||582||30b|@|fffd||596||fffd||fffd||310||752||fffd||342||142||fffd||fffd||702||fffd||fffd||fffd|B", vbOKOnly + vbCritical
            Exit Sub
        
        End If

        ' |fffd|@|fffd||583|R|fffd|[|fffd|h|fffd|A|fffd|@|fffd||596||fffd||fffd||303|Z|fffd|b|fffd|g
        masterSheet.Cells(targetRow, organCdCol).Value = organ_cd
        masterSheet.Cells(targetRow, organCdCol + 1).Value = organ_name
    
    Else
        ' |fffd|w|fffd||8340||fffd||502||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||a347|
        MsgBox "|fffd|w|fffd||fffd||fffd|No.|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

End Sub

'----------------------------------------
' |fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub cmdSearch_Click()

    ' |fffd|@|fffd||596||fffd||fffd||a5d7||fffd||fffd||fffd|X|fffd|g|fffd||30d||110||fffd||fffd||fffd|
    Call createList

    ' |fffd||fffd||fffd|f|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    If Me.lstOrganName.ListCount > 0 Then
        Me.cmdRefrect.Enabled = True
    Else
        Me.cmdRefrect.Enabled = False
    End If

End Sub

'----------------------------------------
' |fffd||fffd||fffd||513||fffd||fffd||342||10512|l|fffd||302||742||fffd|
'----------------------------------------
Private Sub txtRowNum_Change()
    
    Dim strInput As String
    
    strInput = Me.txtRowNum.Text
    
    If Len(strInput) = 0 Then
        Exit Sub
    End If
    
    If IsNumeric(Right(strInput, 1)) = True Then
        Exit Sub
    End If
    
    txtRowNum.Text = Left(strInput, Len(strInput) - 1)

End Sub

'----------------------------------------
' |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'----------------------------------------
Private Sub UserForm_Initialize()

    Dim rouNum  As Long
    
    ' |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||310||752||fffd|
    Me.Caption = "|fffd|@|fffd||596||fffd||fffd|I|fffd||fffd|"
    
    ' |fffd|@|fffd||596||fffd||fffd||a5d7||fffd||fffd||fffd|X|fffd|g|fffd||303|N|fffd||fffd||fffd|A
    Me.lstOrganName.Clear

    ' |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|i|fffd|[
    Set masterSheet = ThisWorkbook.ActiveSheet
    
    ' |fffd|I|fffd||fffd||fffd|s|fffd||30e||64fe|
    rouNum = ActiveCell.Row
    
    ' |fffd|f|fffd|[|fffd|^|fffd||317|L|fffd||fffd||fffd||348||353||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If rouNum < DATA_START_ROW_NUM Or rouNum > masterSheet.Cells(masterSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row Then
        Me.txtRowNum.Text = ""
    Else
        Me.txtRowNum.Text = CStr(rouNum) - DATA_TITLE_ROW_NUM
        Me.txtSearch.SetFocus
    End If

    ' |fffd||fffd||fffd|f|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    Me.cmdRefrect.Enabled = False

End Sub

'----------------------------------------
' |fffd|@|fffd||596||fffd||fffd||a5d7||fffd||fffd||fffd|X|fffd|g|fffd||310||fffd||fffd||fffd|
'----------------------------------------
Private Sub createList()

    Dim loopC           As Long
    Dim organList()     As String
    Dim organDic        As Object       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||582||30f||fffd||fffd||fffd||6ce||fffd||fffd||fffd||fffd||fffd|f|fffd|B|fffd|N|fffd|V|fffd||fffd||fffd|i|fffd||fffd|

    ' |fffd|@|fffd||596||fffd||fffd||a5d7||fffd||fffd||fffd|X|fffd|g|fffd||303|N|fffd||fffd||fffd|A
    Me.lstOrganName.Clear
    
    ' |fffd|@|fffd||596||fffd||fffd||a5d7||fffd||fffd||fffd|X|fffd|g|fffd||303|\|fffd|[|fffd|X|fffd||64fe|
    ' |fffd||fffd||fffd|X|fffd|g|fffd||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||103|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    If getOrganList(organDic, Trim(txtSearch.Text)) = False Then
        Set organDic = Nothing
        MsgBox "|fffd|@|fffd||596||fffd||fffd||30e||64fe||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd||596||fffd||fffd|I|fffd||fffd||fffd||fffd||282||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B", vbOKOnly + vbCritical
        Unload Me
        Exit Sub
    End If

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||281|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|
    If organDic.Count = 0 Then
        MsgBox "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||702||78b|@|fffd||596||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B", vbOKOnly + vbInformation
        Exit Sub
    End If
    
    Application.Cursor = xlWait

    ' |fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30c||fffd||fffd||182||202||fffd|f|fffd|[|fffd|^|fffd||310||fffd||fffd||fffd|
    ReDim organList(organDic.Count - 1, 1)
    For loopC = 0 To organDic.Count - 1
        organList(loopC, 0) = organDic.item(organDic.Keys()(loopC))
        organList(loopC, 1) = organDic.Keys()(loopC)
    Next

    Set organDic = Nothing
    Application.Cursor = xlDefault
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||fffd|X|fffd|g|fffd||243|Z|fffd|b|fffd|g
    Me.lstOrganName.List = organList

End Sub

'----------------------------------------
' |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'----------------------------------------
Private Sub UserForm_Terminate()
    
    ' |fffd|S|fffd||102||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||309||fffd||fffd|
    Set masterSheet = Nothing

End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{581D92FE-53FE-495D-9EC6-C3BECA0D0010}{1DCE0E1E-9AFD-4313-A260-BF50BEC98512}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private sheetName   As String
Private maxRowNum   As Long
Private targetRow   As Long
Private rowNum      As Long
Private loopCnt     As Integer

'----------------------------------------
' |fffd|R|fffd|s|fffd|[|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub CommandButton1_Click()

    Dim spFlg           As Boolean  ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|t|fffd||fffd||fffd|O|fffd|@true|fffd||155||6cc||c0a0||fffd||fffd|Afalse|fffd||155||6cc||fffd||202||fffd|
    
    
    ' |fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||316||fffd||fffd|O|fffd||fffd||fffd||64fe|
    sheetName = ActiveSheet.Name

    ' |fffd|V|fffd|[|fffd|g|fffd||fffd||30d||151||5340||fffd||510||fffd||fffd||fffd||fffd||64fe|
    maxRowNum = IIf(ActiveSheet.Cells(DATA_START_ROW_NUM, DATA_START_COL_NUM).Value <> Empty, ActiveSheet.Cells(ActiveSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Value, 0)

    ' 0|fffd||fffd||fffd||30f||a347|
    If maxRowNum = 0 Then
        MsgBox "|fffd|f|fffd|[|fffd|^|fffd||fffd|0|fffd||fffd||fffd||142||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

    ' |fffd|R|fffd|s|fffd|[|fffd||38f||6cd||fffd||fffd||501|E|fffd|s|fffd||fffd||fffd||30e||64fe|
    If TextBox1.Text <> Empty Then
        targetRow = TextBox1.Text
    Else
        ' |fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|
        MsgBox "|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|s|fffd||fffd|No.|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If
    
    If TextBox2.Text <> Empty Then
        rowNum = TextBox2.Text
        
        ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|1|fffd|`100|fffd||314||348||353||fffd||fffd||142||202||fffd||fffd||a347|
        If rowNum < 1 Or rowNum > 100 Then
            MsgBox "|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||341|A1|fffd|`100|fffd||30a||502||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbOKOnly + vbExclamation
            Exit Sub
        End If
    
    Else
        ' |fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|
        MsgBox "|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

    ' |fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd|
    If targetRow < 1 Or targetRow > maxRowNum Then
        MsgBox "|fffd||38f||6c2||fffd|No.|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

    ' |fffd|l|fffd||fffd|03-08(1)|fffd||30f||a347||fffd|A|fffd|u|fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||fffd||fffd|u|fffd||fffd||fffd|v|fffd||142||202||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[
    If sheetName = "|fffd|l03-08_1" Then
        If ActiveSheet.Cells(DATA_TITLE_ROW_NUM + targetRow, COL_03081_ACCEPT_BIZ).Value <> CHECK_OK Then
            MsgBox "|fffd|u|fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||fffd||fffd|u|fffd||fffd||fffd|v|fffd||142||342||202||fffd||fffd|s|fffd||343|R|fffd|s|fffd|[|fffd||142||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbExclamation
            Exit Sub
        End If
    End If

    ' ******************************
    ' |fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|
    ' ******************************
    
    Call setDrawControl
    
    ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
    spFlg = unprotectWorkSheet(ActiveSheet)
    
    With ActiveSheet

        ' |fffd|s|fffd|}|fffd||fffd|
        For loopCnt = 1 To rowNum
            .Rows(targetRow + DATA_START_ROW_NUM).Insert
        Next

        ' |fffd||38f||6cd||fffd||fffd||502||30d|s|fffd||fffd||fffd|R|fffd|s|fffd|[
        .Rows(targetRow + DATA_TITLE_ROW_NUM).Copy

        ' |fffd|\|fffd||fffd|t|fffd||fffd|
        For loopCnt = 1 To rowNum
            .Rows(targetRow + loopCnt + DATA_TITLE_ROW_NUM).PasteSpecial (xlPasteAll)
        
            ' |fffd|R|fffd|s|fffd|[|fffd|s|fffd||fffd|\|fffd||fffd||fffd|t|fffd||fffd||fffd|O
            .Cells(targetRow + loopCnt + DATA_TITLE_ROW_NUM, COL_COPY_FLG).Value = COPY_FLG_VALUE
        Next

        ' |fffd||fffd||fffd||50d||110|U|fffd||fffd|
        For loopCnt = 1 To (maxRowNum + rowNum)
            .Cells(loopCnt + DATA_TITLE_ROW_NUM, DATA_START_COL_NUM).Value = loopCnt
        Next
    
        ' |fffd|R|fffd|s|fffd|[|fffd|s|fffd||30f|C|fffd||fffd|
        Call modCopiedLine
    
        ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A1|fffd||fffd|I|fffd||fffd|
        Application.CutCopyMode = False
        .Range("A1").Select
    
    End With

    ' |fffd||fffd||fffd||fffd||348||350||752||fffd|
    Call setSheetPreviewArea(ActiveSheet)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    If spFlg = True Then
        Call protectWorkSheet(ActiveSheet)
    End If
    
    Call setDrawControl(True)

    ' |fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    Unload Me

End Sub

'----------------------------------------
' |fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub CommandButton2_Click()
    Unload Me
    End
End Sub

'----------------------------------------
' |fffd||fffd||fffd||513||fffd||fffd||342||10512|l|fffd||302||742||fffd|
'----------------------------------------
Private Sub TextBox1_Change()
    If Len(TextBox1.Text) = 0 Then
        Exit Sub
    End If
    If IsNumeric(Right(TextBox1.Text, 1)) = True Then
        Exit Sub
    End If
    TextBox1.Text = Left(TextBox1.Text, Len(TextBox1.Text) - 1)
End Sub

'----------------------------------------
' |fffd|s|fffd||fffd||fffd||fffd||fffd||342||10512|l|fffd||302||742||fffd|
'----------------------------------------
Private Sub TextBox2_Change()
    If Len(TextBox2.Text) = 0 Then
        Exit Sub
    End If
    If IsNumeric(Right(TextBox2.Text, 1)) = True Then
        Exit Sub
    End If
    TextBox2.Text = Left(TextBox2.Text, Len(TextBox2.Text) - 1)
End Sub

Private Sub UserForm_Initialize()

    Dim rouNum  As Long
    
    ' |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||310||752||fffd|
    Me.Caption = "|fffd|w|fffd||fffd|s|fffd||303|R|fffd|s|fffd|["
    
    ' |fffd|I|fffd||fffd||fffd|s|fffd||30e||64fe|
    rouNum = ActiveCell.Row
    
    ' |fffd|f|fffd|[|fffd|^|fffd||317|L|fffd||fffd||fffd||348||353||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If rouNum < DATA_START_ROW_NUM Or rouNum > ActiveSheet.Cells(ActiveSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row Then
        Me.TextBox1.Text = ""
    Else
        Me.TextBox1.Text = CStr(rouNum) - DATA_TITLE_ROW_NUM
        Me.TextBox2.SetFocus
    End If

End Sub

' |fffd|R|fffd|s|fffd|[|fffd|s|fffd||30f|C|fffd||fffd|
Private Sub modCopiedLine()

' 03-08(1)
' |fffd|R|fffd|s|fffd|[|fffd||fffd||30d|s|fffd||301|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||341|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|A|fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|v|fffd||341|u|fffd|o|fffd|^|fffd|v|fffd|A|fffd|u|fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|v|fffd||341|u|fffd||fffd||fffd|v|fffd||152||fffd||182||fffd||fffd|A
' |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||7c1|`|fffd||fffd||fffd||357||fffd||fffd||702||142||16893||fffd||fffd||34f||fffd||502||182||fffd||fffd|A|fffd||fffd||fffd||93||fffd||fffd||349||94|\|fffd||182||fffd||fffd||fffd|

' 03-08(2)
'|fffd|u|fffd|w|fffd||fffd|s|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||30d|s|fffd||301|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||341|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|A|fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|v|fffd||341|u|fffd|o|fffd|^|fffd|v|fffd||152||fffd||182||fffd||fffd|A
' |fffd||3d4|C|fffd||317|L|fffd||fffd||fffd|`|fffd||3d4|C|fffd||fffd||702||142||16893||fffd||fffd||34f||fffd||502||182||fffd||fffd|A|fffd||fffd||fffd||93||fffd||fffd||349||94|\|fffd||182||fffd||fffd||fffd|

' 03-08(3)
'|fffd|u|fffd|w|fffd||fffd|s|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||30d|s|fffd||301|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||341|u|fffd||fffd||fffd|o|fffd|^|fffd|v|fffd|A|fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|v|fffd||341|u|fffd|o|fffd|^|fffd|v|fffd||152||fffd||182||fffd||fffd|A
' |fffd||3d4|C|fffd||30d||fffd||fffd||fffd||fffd||182||202||fffd|@|fffd||7c1|`|fffd||fffd||fffd||357||fffd||fffd||702||142||16893||fffd||fffd||34f||fffd||502||182||fffd||fffd|A|fffd||fffd||fffd||93||fffd||fffd||349||94|\|fffd||182||fffd||fffd||fffd|

    Dim colRequest      As Long     ' |fffd|\|fffd||fffd||fffd||656a||fffd||fffd|
    Dim colRegStatus    As Long     ' |fffd|o|fffd|^|fffd||cbd57||fffd|
    
    Dim curRow          As Long     ' |fffd||fffd||fffd||74f||fffd||fffd||fffd||fffd|s
    
    
    With ActiveSheet
        
        For loopCnt = 1 To rowNum
            
            ' |fffd||fffd||fffd||74d|s|fffd||50d||fffd||fffd||30e||64fe|
            curRow = DATA_TITLE_ROW_NUM + targetRow + loopCnt
            
            ' |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||24e||64fe||fffd||fffd||fffd||fffd|u|fffd|\|fffd||fffd||fffd||656a||fffd|v|fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||fffd||292|u|fffd||313||fffd||fffd||fffd||181|A|fffd||95||283|J|fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd|
            Select Case sheetName
                
                Case "|fffd|l03-08_1"
                    colRequest = COL_03081_REQUEST
                    colRegStatus = COL_03081_REG_STATUS
                
                    .Cells(curRow, COL_03081_ACCEPT_BIZ).Value = CHECK_OK
                    .Cells(curRow, COL_03081_BASIS_LAWS).Value = NONE_VALUE
                    .Cells(curRow, COL_03081_ARTICLE_NUM).Value = ""
                    .Cells(curRow, COL_03081_ATTACH).Value = NONE_VALUE
                    .Cells(curRow, COL_03081_ORGAN_CD).Value = ""
                    .Cells(curRow, COL_03081_ORGAN_NAME).Value = ""
                    .Cells(curRow, COL_03081_ORGAN_CHECK).Value = NONE_VALUE
                    .Cells(curRow, COL_03081_START_DATE).Value = ""
                    .Cells(curRow, COL_03081_END_DATE).Value = ""
                
                Case "|fffd|l03-08_2"
                    colRequest = COL_03082_REQUEST
                    colRegStatus = COL_03082_REG_STATUS
                
                    .Cells(curRow, COL_03082_DELEGATE).Value = NONE_VALUE
                    .Cells(curRow, COL_03082_ORGAN_CD).Value = ""
                    .Cells(curRow, COL_03082_ORGAN_NAME).Value = ""
                
                Case "|fffd|l03-08_3"
                    colRequest = COL_03083_REQUEST
                    colRegStatus = COL_03083_REG_STATUS

                    .Cells(curRow, COL_03083_BASIS_LAWS).Value = NONE_VALUE
                    .Cells(curRow, COL_03083_ARTICLE_NUM).Value = ""
                    .Cells(curRow, COL_03083_ATTACH).Value = NONE_VALUE
                    .Cells(curRow, COL_03083_ORGAN_CD).Value = ""
                    .Cells(curRow, COL_03083_ORGAN_NAME).Value = ""
                    .Cells(curRow, COL_03083_START_DATE).Value = ""
                    .Cells(curRow, COL_03083_END_DATE).Value = ""
            
            End Select
            
            ' |fffd|\|fffd||fffd||fffd||656a|
            .Cells(curRow, colRequest).Validation.Modify _
                Formula1:=REQUEST_ENTRY & "," & NONE_VALUE
            .Cells(curRow, colRequest).Value = REQUEST_ENTRY
            .Cells(curRow, colRequest).Locked = True
            
            ' |fffd|o|fffd|^|fffd||fffd|
            .Cells(curRow, colRegStatus).Value = DATA_UNREGISTERED
            
            ' |fffd|u|fffd|o|fffd|^|fffd||cbd41|v|fffd||20d|~|fffd||303|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|s
            Call execRowLock(ActiveSheet, .Cells(curRow, colRequest))
        
            If sheetName = "|fffd|l03-08_1" Then
                .Cells(curRow, COL_03081_ACCEPT_BIZ).Locked = True
            End If
        
        Next

    End With

End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{C6A07ACE-423E-43F7-BA8A-50B8E28813FC}{3B0FEA16-EE50-4DC7-8ECA-D92ED55165A0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

'----------------------------------------
' |fffd||d3dc||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub CommandButton1_Click()

    Dim sheetName   As String
    Dim maxRowNum   As Long
    Dim targetRow   As Long
    Dim loopCnt     As Integer
    Dim spFlg           As Boolean  ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|t|fffd||fffd||fffd|O|fffd|@true|fffd||155||6cc||c0a0||fffd||fffd|Afalse|fffd||155||6cc||fffd||202||fffd|
    
    
    ' |fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||316||fffd||fffd|O|fffd||fffd||fffd||64fe|
    sheetName = ActiveSheet.Name

    ' |fffd|V|fffd|[|fffd|g|fffd||fffd||30d||151||5340||fffd||510||fffd||fffd||fffd||fffd||64fe|
    maxRowNum = IIf(ActiveSheet.Cells(DATA_START_ROW_NUM, DATA_START_COL_NUM).Value <> Empty, ActiveSheet.Cells(ActiveSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Value, 0)

    ' 0|fffd||fffd||fffd||30f||a347|
    If maxRowNum = 0 Then
        MsgBox "|fffd|f|fffd|[|fffd|^|fffd||fffd|0|fffd||fffd||fffd||142||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If
    
    ' |fffd||38f||6cd||fffd||fffd||502||30e||64fe|
    If TextBox1.Text <> Empty Then
        targetRow = TextBox1.Text
    Else
        ' |fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|
        MsgBox "|fffd||d3dc||fffd||fffd||fffd||fffd|s|fffd||fffd|No.|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

    ' |fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd|
    If targetRow < 1 Or targetRow > maxRowNum Then
        MsgBox "|fffd||38f||6c2||fffd|No.|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

    ' |fffd||38f||6cd|s|fffd||30f||fffd||503|`|fffd|F|fffd|b|fffd|N|fffd|F|fffd|R|fffd|s|fffd|[|fffd|@|fffd|\|fffd||143|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|s|fffd||20a|O|fffd||d3dc||fffd|s|fffd||fffd|
    If ActiveSheet.Cells(DATA_TITLE_ROW_NUM + targetRow, COL_COPY_FLG).Value <> COPY_FLG_VALUE Then
        MsgBox "|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|s|fffd||20a|O|fffd||34d||d3dc||fffd||142||fffd||fffd||702||fffd||fffd||fffd|", vbOKOnly + vbCritical
        Exit Sub
    End If

    ' ******************************
    ' |fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|
    ' ******************************
    
    ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
    spFlg = unprotectWorkSheet(ActiveSheet)

    With ActiveSheet

        ' |fffd|s|fffd||d3dc|
        .Rows(DATA_TITLE_ROW_NUM + targetRow).Delete
            
        ' |fffd||fffd||fffd||50d||110|U|fffd||fffd|
        For loopCnt = 1 To maxRowNum - 1
            .Cells(DATA_TITLE_ROW_NUM + loopCnt, DATA_START_COL_NUM).Value = loopCnt
        Next
    
        ' A1|fffd||fffd|I|fffd||fffd|
        .Range("A1").Select
    
    End With
    
    ' |fffd||fffd||fffd||fffd||348||350||752||fffd|
    Call setSheetPreviewArea(ActiveSheet)
    
    ' |fffd|V|fffd|[|fffd|g|fffd||30d||115||6cc||fffd|
    If spFlg = True Then
        Call protectWorkSheet(ActiveSheet)
    End If
    
    ' |fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    Unload Me

End Sub

'----------------------------------------
' |fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'----------------------------------------
Private Sub CommandButton2_Click()
    Unload Me
    End
End Sub

'----------------------------------------
' |fffd||fffd||fffd||513||fffd||fffd||342||10512|l|fffd||302||742||fffd|
'----------------------------------------
Private Sub TextBox1_Change()
    If Len(TextBox1.Text) = 0 Then
        Exit Sub
    End If
    If IsNumeric(Right(TextBox1.Text, 1)) = True Then
        Exit Sub
    End If
    TextBox1.Text = Left(TextBox1.Text, Len(TextBox1.Text) - 1)
End Sub

Private Sub UserForm_Initialize()
    
    Dim rouNum  As Long
    
    ' |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||310||752||fffd|
    Me.Caption = "|fffd|w|fffd||fffd|s|fffd||30d||d3dc|"
    
    ' |fffd|I|fffd||fffd||fffd|s|fffd||30e||64fe|
    rouNum = ActiveCell.Row
    
    ' |fffd|f|fffd|[|fffd|^|fffd||317|L|fffd||fffd||fffd||348||353||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If rouNum < DATA_START_ROW_NUM Or rouNum > ActiveSheet.Cells(ActiveSheet.Rows.Count, DATA_START_COL_NUM).End(xlUp).Row Then
        Me.TextBox1.Text = ""
    Else
        Me.TextBox1.Text = CStr(rouNum) - DATA_TITLE_ROW_NUM
        Me.CommandButton1.SetFocus
    End If

End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{CA581C69-CD98-4834-87C5-A6DD71E4E81E}{E88DA9A8-B73E-4791-B427-EEC76EAA775A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "WlList"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "testModule"

' |fffd||fffd||fffd|J|fffd||fffd||fffd|p
Public Sub test_allSheetLock()
    Call execAllSheetsLock(True)
End Sub

' |fffd||fffd||fffd|J|fffd||fffd||fffd|p
Public Sub test_allSheetUnlock()
    Call execAllSheetsLock(False)
End Sub

' |fffd||fffd||fffd|J|fffd||fffd||fffd|p
Private Sub execAllSheetsLock(lockFlg As Boolean)
    
    Dim sh As Worksheet

    ThisWorkbook.Unprotect TOOL_LOCK_PWD
    
    ' |fffd|S|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||38f||fffd|
    For Each sh In ThisWorkbook.Worksheets
        
        If lockFlg = True Then
            sh.protect Password:=TOOL_LOCK_PWD
        Else
            sh.Unprotect Password:=TOOL_LOCK_PWD
        End If

    Next
    ThisWorkbook.protect TOOL_LOCK_PWD, True

End Sub

' |fffd|`|fffd|F|fffd|b|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd|A|fffd|u|fffd||fffd|o|fffd||fffd||fffd||78d||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||182||fffd||fffd||fffd|
Public Sub enableOutputFile()
    
    ThisWorkbook.Unprotect TOOL_LOCK_PWD
    Sheets("|fffd|`|fffd|F|fffd|b|fffd|N").Visible = True
    Sheets("|fffd|`|fffd|F|fffd|b|fffd|N").cmdCreateDocument.Enabled = True
    ThisWorkbook.protect TOOL_LOCK_PWD, True

End Sub

' |fffd||fffd|z|fffd||fffd||fffd||fffd||c42c||fffd|i|fffd||fffd||fffd|FW1|fffd|j
'Sub W1()
Sub test_initialize()
'
'|fffd||fffd||fffd||fffd||fffd||752||fffd|@|fffd|@Test|fffd|p
'
'
'|fffd||fffd||fffd||fffd||fffd||752||fffd|
'

    Dim lngr As Long, lngr2 As Long     '|fffd|s|fffd|J|fffd|E|fffd||fffd||fffd|^
    Dim ints As Integer                 '|fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|^

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||283||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30d||fffd||fffd||fffd||fffd||195||fffd||fffd||312|l|fffd||fffd||8414||fffd||fffd||fffd|B
    Const sglListHight = 128
    Const sglListWidth = 307.5
    'Font|fffd||fffd|
    Const strFontn As String = "Meiryo UI"
    '|fffd|u|fffd||3cd|X|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s
    Const lngStRow As Long = 30

    '|fffd||fffd||28d|X|fffd|V|fffd||fffd|~
    Application.ScreenUpdating = False
    

    '|fffd|u|fffd|\|fffd||fffd||fffd|l|fffd||fffd||fffd||c42c||fffd|v|fffd|V|fffd|[|fffd|g|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Set objMains = ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME)

    '20170718 add
    objMains.Unprotect Password:=TOOL_LOCK_PWD

    '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|E|fffd||fffd||fffd|x|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
    objMains.txtSearchInput.Value = ""
    objMains.KikanCode = "---"
    objMains.KikanName = "---"
    objMains.KoukyoCode = "---"
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||295|\|fffd||fffd||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||288||a5d7|_|fffd|N|fffd||fffd||fffd|A
    SearchDisp.SearchLst.Clear
    With SearchDisp.SearchLst
        .Height = sglListHight
        .Width = sglListWidth
        .IntegralHeight = True
        .Font = strFontn
    End With
    
    If objMains.Cells(lngStRow, 6) <> "" Then
        With objMains
            lngr = .UsedRange.Rows(.Rows.Count).Row
            ActiveSheet.Unprotect
            '.Rows(lngStRow & ":" & lngR).Delete (xlUp)
            .Rows(lngStRow & ":" & lngr).ClearContents
            .Range(Cells(lngStRow, 6 - 2), Cells(lngr, 6 + 7)).ClearFormats      '|fffd||fffd||fffd||fffd||fffd||303|N|fffd||fffd||fffd|A|fffd|F|fffd|F|fffd||fffd|r|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
            '.Range(Cells(lngStRow, 6 - 2), Cells(lngR, 6 + 7)).Borders.LineStyle = xlLineStyleNone
            ActiveSheet.protect AllowFormattingColumns:=True, AllowFormattingRows:=True, UserInterfaceOnly:=True
        End With
    End If

    '20170718 add
    objMains.protect AllowFormattingColumns:=True, AllowFormattingRows:=True, UserInterfaceOnly:=True, Password:=TOOL_LOCK_PWD
    
    '|fffd||189||fffd|E|fffd||4b7c9||94|\|fffd||a5d7||fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd|
    ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).Activate

    '|fffd||fffd||28d|X|fffd|V|fffd||fffd||fffd||10a|J|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True

End Sub

' |fffd||fffd|z|fffd||fffd||fffd||fffd||c42c||fffd|i|fffd||fffd||fffd|FW2|fffd|j
'Sub W2()
Sub test_enableEventsTrue()
'
'
'
        Application.EnableEvents = True             'WorkSheet_Change|fffd||fffd|L|fffd||fffd||fffd||242||fffd||fffd||fffd|


End Sub

' |fffd||fffd|z|fffd||fffd||fffd||fffd||c42c||fffd|i|fffd||fffd||fffd|Fw_rgb|fffd|j
'Sub w_rgb()
Sub test_w_rgb()

    Debug.Print "|fffd||381||fffd|" & ThisWorkbook.Worksheets("|fffd|l03-07_1").Range("F7").Interior.color                '13434828
''    GoTo endlabel

    Debug.Print "|fffd|I|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd|" & ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).Range("I15").Interior.color  '9420794
    Debug.Print "|fffd||fffd||fffd|F|fffd||fffd|" & ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).Range("K15").Interior.color      '14470546
    
    Debug.Print "|fffd|F|fffd||202||fffd||fffd||fffd|" & ThisWorkbook.Worksheets(C_APP_FORM_SHEET_NAME).Range("H15").Interior.color    '16777215

endlabel:

End Sub

Sub test_w_rgb2()

    Debug.Print "|fffd||81||fffd|" & ThisWorkbook.Worksheets("|fffd|l03-07_1").Range("G12").Interior.color
    Debug.Print "|fffd||fffd||fffd||fffd|" & ThisWorkbook.Worksheets("|fffd|l03-07_1").Range("J12").Interior.color
    Debug.Print "|fffd|@|fffd||581||fffd|" & ThisWorkbook.Worksheets("|fffd|l03-08_1").Range("P12").Interior.color
End Sub

Sub test_initialize2()
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||283||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30d||fffd||fffd||fffd||fffd||195||fffd||fffd||312|l|fffd||fffd||8414||fffd||fffd||fffd|B
    Const sglListHight = 128
    Const sglListWidth = 307.5
    
    ' Font|fffd||fffd|
    Const strFontn As String = "Meiryo UI"
    
    Dim s_raw   As Long
    Dim e_raw   As Long


    ' |fffd|`|fffd||fffd||312||fffd|~
    Application.DisplayAlerts = False
    Application.ScreenUpdating = False

    With ThisWorkbook.Sheets(C_APP_FORM_SHEET_NAME)

        ' |fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|E|fffd||fffd||fffd|x|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
        .txtSearchInput.Value = ""
        .KikanCode = "---"
        .KikanName = "---"
        .KoukyoCode = "---"
    
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||295|\|fffd||fffd||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||288||a5d7|_|fffd|N|fffd||fffd||fffd|A
        SearchDisp.SearchLst.Clear
        SearchDisp.SearchLst.Height = sglListHight
        SearchDisp.SearchLst.Width = sglListWidth
        SearchDisp.SearchLst.IntegralHeight = True
        SearchDisp.SearchLst.Font = strFontn

        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||d3dc|
        ' **************************************************
        e_raw = .Cells(.Rows.Count, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
        s_raw = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||90|l|fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        
        If s_raw < e_raw Then
            .Range(s_raw + 1 & ":" & e_raw).Delete
        End If

        ' **************************************************
        '  |fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|v|fffd||30d||d3dc|
        ' **************************************************
        e_raw = .Cells(s_raw, C_BIZ_P_I_NAME_COL_NUM).End(xlUp).Row
        s_raw = CLng(Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", .Columns(C_BIZ_P_I_NAME_COL_NUM), 0))
        
        If s_raw < e_raw Then
            .Range(s_raw + 1 & ":" & e_raw).Delete
        End If

    End With
    
    ' |fffd|`|fffd||fffd||30a|J|fffd|n
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True

End Sub


INQUEST-PP=macro
