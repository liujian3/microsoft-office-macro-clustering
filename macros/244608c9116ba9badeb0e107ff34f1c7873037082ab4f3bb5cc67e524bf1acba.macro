Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
   
   
End Sub

Attribute VB_Name = "|123||fffd||fffd|1"
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3|").Select
 
 '|fffd||fffd||fffd||fffd||fffd||fffd|
    With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("C4"))
        .CommandText = Array( _
        "SELECT BUILDINFO.bianhao" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.bianhao" _
        )
        .Name = "|fffd||fffd||46f||fffd||fffd||fffd|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With
    
 '|fffd||fffd||fffd||fffd||3af||fffd||fffd||fffd||fffd|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("C6"))
        .CommandText = Array( _
        "SELECT BUILDINFO.weituoren" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.weituoren" _
        )
        .Name = "|fffd||fffd||46f||3af||fffd||fffd||fffd||fffd|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With
   
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("C8"))
        .CommandText = Array( _
        "SELECT BUILDINFO.menpai" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.menpai" _
        )
        .Name = "|fffd||fffd||46f||fffd||fffd||fffd||fffd|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With


  Sheets("|fffd||fffd||13f||2f5||fffd||fffd||fffd||fffd|").Select

  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("B8"))
        .CommandText = Array( _
        "SELECT BUILDINFO.djxinzhi" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.djxinzhi" _
        )
        .Name = "|fffd||fffd||46f||fffd||fffd||fffd||fffd||fffd||fffd|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
End With


 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||37e|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("D8"))
        .CommandText = Array( _
        "SELECT BUILDINFO.yongtu" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.yongtu" _
        )
        .Name = "|fffd||fffd||46f||fffd||fffd||fffd||fffd||fffd||37e|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With

 '|fffd||fffd||fffd||fffd||1e79|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("D9"))
        .CommandText = Array( _
        "SELECT BUILDINFO.jiegou" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.jiegou" _
        )
        .Name = "|fffd||fffd||46f||fffd||1e79|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With


 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("B11"))
        .CommandText = Array( _
        "SELECT BUILDINFO.cengshu" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.cengshu" _
        )
        .Name = "|fffd||fffd||46f||fffd||fffd||fffd||fffd|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With

 '|fffd||fffd||fffd||fffd||fffd||fffd||1fd||5f0||fffd||fffd|
 With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access Database;DBQ=C:\RESULT1.MDB;DefaultDir=C:;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("D11"))
        .CommandText = Array( _
        "SELECT BUILDINFO.zhuangshi" & Chr(13) & "" & Chr(10) & "FROM `C:\RESULT1`.BUILDINFO BUILDINFO" & Chr(13) & "" & Chr(10) & "ORDER BY BUILDINFO.zhuangshi" _
        )
        .Name = "|fffd||fffd||46f||fffd||fffd||1fd||5f0||fffd||fffd|"
        .FieldNames = False
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With

Range("B8,D9,D11").Select
    Range("D11").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "|fffd||fffd||fffd||fffd|"
        .FontStyle = "|fffd||fffd||fffd||fffd|"
        .Size = 14
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With

Range("D8:F8,D11:F11,D12:F12").Select
    Range("F12").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge







    Sheets("|fffd||fffd||fffd||fffd||fffd|").Select             '|fffd||fffd||fffd||fffd|"|fffd||fffd||fffd||fffd||fffd|"
    Columns("A:F").Select           '---1
    Selection.ClearContents         '---2
                    ' 1|fffd||fffd|2 |fffd||fffd||fffd||fffd||53a||3f2||fffd||3aa|Columns("A:F").ClearContents
                    '|fffd||fffd||fffd||fffd||133||fffd||fffd||fffd|  |fffd||fffd||5b1||fffd||4f0||fffd||fffd||fffd||3f2||fffd||fffd||fffd|
                    
    Dim a As Integer
    
    With ActiveSheet.QueryTables.Add(Connection:=Array( _
        "OLEDB;Provider=Microsoft.Jet.OLEDB.4.0;Password="""";User ID=Admin;Data Source=C:\RESULT1.MDB;Mode=Share Deny Write;Extended Properties=" _
        , _
        """"";Jet OLEDB:System database="""";Jet OLEDB:Registry Path="""";Jet OLEDB:Database Password="""";Jet OLEDB:Engine Type=5;Jet OLEDB:Data" _
        , _
        "base Locking Mode=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password="""";" _
        , _
        "Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:C" _
        , "ompact Without Replica Repair=False;Jet OLEDB:SFP=False"), Destination:= _
        Range("A1"))
        .CommandType = xlCmdSql
        .CommandText = Array( _
        "Select roomid as |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,round(roomarea,2) as |fffd||fffd||fffd||6bd||fffd||fffd||fffd||fffd||fffd||fffd|,round(gyarea,2) as |fffd||fffd||fffd||437||fffd||32f||fffd||fffd||fffd|,(round(roomarea,2) + round(gyarea,2)) AS |fffd||fffd||fffd||fffd||fffd||fffd||fffd|,hxbh as |fffd||fffd||fffd||371||fffd||fffd| from result order by hxbh,onfloor" _
        )
        .Name = "RESULT1"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .SourceDataFile = "C:\RESULT1.MDB"
        .Refresh BackgroundQuery:=False
    End With
    
    Columns("b:D").NumberFormatLocal = "0.00_ "
    
   ' |fffd||fffd||fffd||fffd||fffd||371||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns("A:E").Select
    Selection.Sort Key1:=Range("E2"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, SortMethod _
        :=xlPinYin, DataOption1:=xlSortTextAsNumbers
    
   ' |fffd||fffd||fffd||63b||fffd||fffd||371||fffd||fffd||4bb||fffd||fffd|
    Columns("E:E").EntireColumn.Hidden = True
    
    
    ' |fffd||fffd||fffd||fffd||fffd||438||7e1||fffd||fffd||43f||fffd|
    a = Range("A65536").End(xlUp).Row + 1
    Rows("1:" & a).RowHeight = 18
    Columns("A").ColumnWidth = 35
    Columns("B:C").ColumnWidth = 14
    Columns("D").ColumnWidth = 13
    

   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||435||fffd||fffd||fffd||4bb||fffd||fffd|

    If Range("A" & a) = "|fffd||3fc||fffd|" Then
        Rows(a).Delete
    End If
    Range("A" & a) = "|fffd||3fc||fffd|"
    Range("B2", "B" & a).Select
    Range("A" & a).Offset(0, 1) = Application.Sum(Range("B2", "B" & a))
    Range("C2", "B" & a).Select
    Range("A" & a).Offset(0, 2) = Application.Sum(Range("C2", "C" & a))
    Range("D2", "B" & a).Select
    Range("A" & a).Offset(0, 3) = Application.Sum(Range("D2", "D" & a))
    Range("A" & a).Select
    
    
    '|fffd||fffd||fffd||fffd||4bb||fffd||fffd|
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    
    
    
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "|fffd||1fc||1f1||fffd||163||fffd|"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3|!|fffd||fffd||46f||fffd||fffd||fffd|"
    
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Range("A1").Select
    ActiveCell.FormulaR1C1 = _
        "=CONCATENATE(""|fffd||fffd||fffd||48fa|"",|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3|!|fffd||fffd||46f||fffd||fffd||fffd||fffd|)"
        
       
    '|fffd||fffd||fffd||fffd||fffd||438||fffd|
    Rows("1:1").Select
    Selection.RowHeight = 22
    
    
    
    Sheets("|fffd||fffd||13f||2f5||fffd||fffd||fffd||fffd|").Select
    Range("D12").Select
    ActiveCell.FormulaR1C1 = "=SUM(OFFSET(|fffd||fffd||fffd||fffd||fffd|!R2C4,,,COUNTA(|fffd||fffd||fffd||fffd||fffd|!C)-2))"
    
    
    Sheets("|fffd||fffd||32f||fffd||3f6||fffd||fffd||fffd|").Select
    Range("G5").Select
    ActiveCell.FormulaR1C1 = "=SUM(OFFSET(|fffd||fffd||fffd||fffd||fffd|!R2C3,,,COUNTA(|fffd||fffd||fffd||fffd||fffd|!C[-4])-2))"

 Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3|").Select
    

    
End Sub


INQUEST-PP=macro
