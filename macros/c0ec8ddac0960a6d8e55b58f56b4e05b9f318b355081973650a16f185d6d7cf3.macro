Attribute VB_Name = "Module1"

Sub FMC_Vybava()
'
' FMC_Vybava Macro
' Macro recorded 22.2.2005 by jbartos1
'
'--- smazat vsechno

On Error Resume Next
Worksheets("FMC-Vybava").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    ActiveSheet.Shapes("Image1").Select
    'ActiveSheet.Shapes.SelectAll
    Selection.Delete
    ActiveSheet.Shapes("Image2").Select
    Selection.Delete
    ActiveSheet.Shapes("RAZITKO").Select
    Selection.Delete

    Range("A1").Select

Dim INMERGE()
'------zkopirovani vybavy
    Sheets("Vybava").Select
    Cells.Select
    Selection.Copy
    Sheets("FMC-Vybava").Select
    Range("A1").Select
    ActiveSheet.Paste
    I = 3
    Do While Range("A" & I) <> ""
     I = I + 1
    Loop
    VYBAVARADKU = I
    VYBAVASLOUPKU = 8 + Worksheets("Cover").Range("B15").Value
'------srovnani podle typu a skupiny + vlozeni mezery pokud typ neni zadny
    For RTYP = 3 To VYBAVARADKU - 1
     If Cells(RTYP, 3).Value = "" Then Cells(RTYP, 3).Value = " "
    Next

    Range(Cells(2, 1), Cells(VYBAVARADKU, VYBAVASLOUPKU)).Select
    ROVNAT = MsgBox("YES = Abecedne? (NO = Nechat v poradi jako na sheetu Vybava)", vbYesNo, "Razeni vybavy:")
    If ROVNAT = vbYes Then
    Selection.Sort Key1:=Range("C3"), Order1:=xlDescending, Key2:=Range("D3") _
        , Order2:=xlAscending, Key3:=Range("A3"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Else
'     Selection.Sort Key1:=Range("C3"), Order1:=xlDescending, Key2:=Range("D3") _
'        , Order2:=xlAscending, Header:= _
'        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    End If

'------Oddeleni typu a vlozeni radku pro nadpis
    I = 2
    Do While Range("A" & I) <> ""
    'MsgBox I & " " & Range("C" & I).Value & " " & Range("C" & I + 1).Value
     If Range("C" & I).Value <> Range("C" & I + 1).Value Then
      
      Range(Cells(I, 1), Cells(I, VYBAVASLOUPKU)).Select
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
  
     
      Rows(I + 1).Select
      Selection.Insert Shift:=xlDown
      'Selection.Interior.Color = vbWhite
      Selection.Interior.ColorIndex = xlNone
      Selection.Font.Color = vbBlack
      Range("A" & I + 1).Value = Range("C" & I + 2).Value
      Range("A" & I + 1).HorizontalAlignment = xlLeft
      Range(Cells(I + 1, 1), Cells(I + 1, Worksheets("Cover").Range("B15").Value + 8)).Select
      Selection.ClearFormats
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Interior.Color = RGB(0, 200, 255)
      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

      'MsgBox I & " jiny "
      I = I + 1
     End If
     I = I + 1
    Loop
    RADKU = I - 1
    SLOUPKU = 3 + Worksheets("Cover").Range("B15").Value
    'Columns("A:A").Select
    'Selection.Insert Shift:=xlToRight
    'Range("A1").Select

'------merge A podle skupiny + nadpis
    
    I = 4
    Rows(I).Select
    Selection.Insert Shift:=xlDown
    RADKU = RADKU + 1
    Range("A" & I).Value = Range("D" & I + 1).Value
    With Selection.Interior
        .ColorIndex = xlNone
        .Pattern = xlSolid
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Range(Cells(I, 1), Cells(I, SLOUPKU + 5)).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("A" & I).Select
    With Selection.Interior
        .ColorIndex = 6
        .Pattern = xlSolid
    End With
      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With

    I = I + 1
    Do While Range("A" & I) <> ""
     If (Range("D" & I).Value <> Range("D" & I + 1).Value) And Range("D" & I + 1).Value <> "" Then
      Rows(I + 1).Select
      Selection.Insert Shift:=xlDown
      RADKU = RADKU + 1
      Range("A" & I + 1).Value = Range("D" & I + 2).Value
      With Selection.Interior
        .ColorIndex = xlNone
        .Pattern = xlSolid
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
      End With
      Range(Cells(I + 1, 1), Cells(I + 1, SLOUPKU + 5)).Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Range("A" & I + 1).Select
      With Selection.Interior
        .ColorIndex = 6
        .Pattern = xlSolid
      End With
            With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With

      I = I + 1
     End If
    I = I + 1
    Loop

'------smazani nepotrebnych sloupcu
DOE = MsgBox("YES = S DOE ? NO = Bez DOE", vbYesNo, "DOE Sloupek ???")
If DOE = vbYes Then
    Columns("C:F").Select               'DOE
    Selection.Delete Shift:=xlToLeft    'DOE
    Columns("D:D").Select               'DOE
    Selection.Delete Shift:=xlToLeft    'DOE
    DOEC = 1
Else
    Columns("C:H").Select
    Selection.Delete Shift:=xlToLeft
    DOEC = 0
End If
SLOUPKU = SLOUPKU + DOEC
'------mergovani entit
I = 3 + DOEC
POCETMODELU = 0
Do While Cells(1, I).Value <> ""
 POCETMODELU = POCETMODELU + 1
 I = I + Trim(Cells(1, I).Comment.Text)
Loop
I = 3 + DOEC
J = 0
ReDim INMERGE(POCETMODELU)
Do While Cells(1, I).Value <> ""
 x = Trim(Cells(1, I).Comment.Text)
 I = I + x
 INMERGE(J) = x
 J = J + 1
Loop


Application.DisplayAlerts = False
R = 4 + DOEC
Do While Range("A" & R).Value <> ""
ZAC = 3 + DOEC
For M = 0 To POCETMODELU
 I = 0
 HODNOTA = Cells(R, ZAC).Value
 ZAC1 = ZAC
 Do While I < CInt(INMERGE(M)) - 1
  If HODNOTA = Cells(R, ZAC1 + 1).Value Then
   Range(Cells(R, ZAC1), Cells(R, ZAC1 + 1)).Select
   Range(Cells(R, ZAC1), Cells(R, ZAC1 + 1)).Merge (False)
   ZAC1 = ZAC1 + 1
  Else
   HODNOTA = Cells(R, ZAC1 + 1)
   ZAC1 = ZAC1 + 1
  End If
  I = I + 1
 Loop
 ZAC = ZAC + CInt(INMERGE(M))
Next
R = R + 1
Loop


'-------Poznamky
POZNSTART = R
Range("A" & POZNSTART).Value = "Pozn|fffd|mky:"
Sheets("FMC-Poznamky").Select
R = 4
I = 1
Do While Range("B" & R).Value <> ""
 Worksheets("FMC-Vybava").Cells(POZNSTART + I, 1).Value = Range("B" & R).Value & " - " & Range("C" & R).Value
 'Worksheets("FMC-Vybava").Cells(POZNSTART + I, 2).Value = Range("C" & R).Value
 I = I + 1
 R = R + 1
Loop
POZNAMEK = I - 1
Sheets("FMC-Vybava").Select
Cells.Select
Selection.Rows.AutoFit
Range(Cells(POZNSTART + 1, 2), Cells(POZNSTART + I, SLOUPKU)).Select
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


'----------prohozeni ID a poznamky
For I = (3 + DOEC) To SLOUPKU - 1
 XXX = Cells(2, I).Comment.Text
 Cells(2, I).Comment.Delete
 Cells(2, I).AddComment Cells(2, I).Value
 Cells(2, I).Value = XXX

Next

'---------- Zformatovani-------------
'--- tluste hranice poznamky a DOE
Range(Cells(1, 2), Cells(RADKU - 1, 2)).Select

      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
If DOE = vbYes Then
 Range(Cells(1, 3), Cells(RADKU - 1, 3)).Select

      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With

End If
'--- tlusta hranice nahore
Range(Cells(1, 3 + DOEC), Cells(2, SLOUPKU - 1)).Select
      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With

'--- smazani neviditelnych nadpisu
Range(Cells(2, 1), Cells(2, 1)).ClearContents
'---------Nadpis
Range("A1").Value = ""
Range("A2").Value = "Ford " & Worksheets("Cover").Cells(2, 4).Value & " V|fffd|bava:"
CENIK = Range("A2").Value
Range("A2").Select
Selection.Font.ColorIndex = 1
    With Selection.Font
        .Name = "Arial"
        .Size = 22
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("B1:B2").Select
    'Range("B2").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 90
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    If DOE = vbYes Then
     Range("C1:C2").Select
     With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 90
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
     End With
     Selection.Interior.Color = RGB(0, 200, 255)
    End If
    Range("A1:A2").Select
    Selection.Interior.ColorIndex = 41
    Selection.Font.ColorIndex = 2
    Range("B1:B2").Select
    Selection.Interior.Color = RGB(0, 200, 255)

'--- tlusty hranice modelu
BOK = 2 + DOEC
For I = 0 To POCETMODELU - 1 + DOEC
 BOK = BOK + INMERGE(I)
 Range(Cells(1, BOK), Cells(RADKU - 1, BOK)).Select

       With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
 Range(Cells(1, BOK), Cells(1, BOK)).Select
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With

Next

For I = 0 To CInt(Worksheets("Cover").Range("B15").Value) - 1
 Cells(2, I + 3).Select
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With

Next

'--- zformatovani poznamek
For I = (RADKU + 1) To (RADKU + POZNAMEK)
 Cells(I, 1).Select
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
 'Selection.Interior.Color = RGB(0, 200, 255)
 Range(Cells(I, 1), Cells(I, 1)).Select
 'Selection.Merge (False)
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
Next

'--- pridani vseobecnych kecu
Range(Cells(RADKU + POZNAMEK + 1, 1), Cells(RADKU + POZNAMEK + 10, SLOUPKU - 1)).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeTop).Weight = xlMedium
    Selection.Borders(xlEdgeTop).ColorIndex = xlAutomatic
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Sheets("Cover").Select

    'Range("D47").Value = Range("D47").Value & Range("C4").Value
    'Range("F47").Value = Range("F47").Value & Range("C4").Value
    If Range("C5").Value <> "" Then
     DTMPLT = " od " & Range("C5").Value
    End If
    If Range("C6").Value <> "" Then
     DTMPLT = " pro vozidla vyroben|fffd| od " & Range("C6").Value
    End If

    Range("D46:D47").Select
    Selection.Copy
    Sheets("FMC-Vybava").Select
    Cells(RADKU + POZNAMEK + 2, 1).Select
    ActiveSheet.Paste

    If Trim(Worksheets("Cover").Range("C10").Value) = "ANO" Then
     Sheets("Cover").Select
     Range("D48").Select
     Selection.Copy
     Sheets("FMC-Vybava").Select
     Cells(RADKU + POZNAMEK + 4, 1).Select
     ActiveSheet.Paste
     Cells(RADKU + POZNAMEK + 4, 1).Value = Cells(RADKU + POZNAMEK + 4, 1).Value & " " & DTMPLT
    Else
     Sheets("Cover").Select
     Range("F48").Select
     Selection.Copy
     Sheets("FMC-Vybava").Select
     Cells(RADKU + POZNAMEK + 4, 1).Select
     ActiveSheet.Paste
     Cells(RADKU + POZNAMEK + 4, 1).Value = Cells(RADKU + POZNAMEK + 4, 1).Value & " " & DTMPLT
    End If
    Sheets("Cover").Select
    Range("D49:D53").Select
    Selection.Copy
    Sheets("FMC-Vybava").Select
    Cells(RADKU + POZNAMEK + 5, 1).Select
    ActiveSheet.Paste
    Sheets("Cover").Select
    ActiveSheet.Shapes("LOGO").Select
    Selection.Copy
    Sheets("FMC-Vybava").Select
    Cells(RADKU + POZNAMEK + 7, 4).Select
    LEVO = Cells(RADKU + POZNAMEK + 7, 4).Left + 35
    ODSHORA = Cells(RADKU + POZNAMEK + 7, 4).Top
    ActiveSheet.Paste
    ActiveSheet.Shapes("Image1").Select
    ActiveSheet.Shapes("Image1").Left = LEVO
    ActiveSheet.Shapes("Image1").Top = ODSHORA
    ActiveSheet.Shapes("Image1").Placement = xlFreeFloating
    ActiveSheet.Shapes("Image1").PrintObject = True
    ActiveSheet.Shapes("Image1").LockAspectRatio = msoTrue
    ActiveSheet.Shapes("Image1").Height = 33#
    ActiveSheet.Shapes("Image1").Width = 72#
    '--- protoze to nekde vysi
    ActiveSheet.Shapes("Image2").Select
    ActiveSheet.Shapes("Image2").Left = LEVO
    ActiveSheet.Shapes("Image2").Top = ODSHORA
    ActiveSheet.Shapes("Image2").Placement = xlFreeFloating
    ActiveSheet.Shapes("Image2").PrintObject = True
    ActiveSheet.Shapes("Image2").LockAspectRatio = msoTrue
    ActiveSheet.Shapes("Image2").Height = 33#
    ActiveSheet.Shapes("Image2").Width = 72#
    '--- plac na razitko
    
    LEVO = LEVO - 65
    ODSHORA = ODSHORA - 110
    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, LEVO, ODSHORA, 200, 100).Select
    Selection.Characters.Text = "Autorizovan|fffd| partner Ford:"
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "tu|fffd|n|fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.ShapeRange.Fill.Visible = msoTrue
    Selection.ShapeRange.Fill.Solid
    Selection.ShapeRange.Fill.ForeColor.SchemeColor = 65
    Selection.ShapeRange.Fill.Transparency = 0#
    Selection.ShapeRange.Line.Weight = 2.25
    Selection.ShapeRange.Line.DashStyle = msoLineSolid
    Selection.ShapeRange.Line.Style = msoLineSingle
    Selection.ShapeRange.Line.Transparency = 0#
    Selection.ShapeRange.Line.Visible = msoTrue
    Selection.ShapeRange.Line.ForeColor.SchemeColor = 64
    Selection.ShapeRange.Line.BackColor.RGB = RGB(255, 255, 255)
    Selection.ShapeRange.LockAspectRatio = msoTrue
    Selection.ShapeRange.Name = "RAZITKO"
    
    'Selection.ShapeRange.Height = 113.25
    'Selection.ShapeRange.Width = 170.25
    With Selection
        .Placement = xlFreeFloating
        .PrintObject = True
    End With
    
    'Range(Cells(RADKU + POZNAMEK + 2, 3), Cells(RADKU + POZNAMEK + 5, 7)).Select
    'Selection.Merge (False)
    'Cells(RADKU + POZNAMEK + 2, 3).Value = "Autorizovan|fffd| partner Ford:"
    'With Selection
    '    .HorizontalAlignment = xlCenter
    '    .VerticalAlignment = xlTop
    '    .WrapText = False
    '    .Orientation = 0
    '    .AddIndent = False
    '    .IndentLevel = 0
    '    .ShrinkToFit = False
    '    .ReadingOrder = xlContext
    '    .MergeCells = True
    'End With
    'With Selection.Borders(xlEdgeRight)
    '    .LineStyle = xlContinuous
    '    .Weight = xlMedium
    '    .ColorIndex = xlAutomatic
    '  End With
    '  With Selection.Borders(xlEdgeLeft)
    '    .LineStyle = xlContinuous
    '    .Weight = xlMedium
    '    .ColorIndex = xlAutomatic
    '  End With
    '  With Selection.Borders(xlEdgeTop)
    '    .LineStyle = xlContinuous
    '    .Weight = xlMedium
    '    .ColorIndex = xlAutomatic
    '  End With
    '  With Selection.Borders(xlEdgeBottom)
    '    .LineStyle = xlContinuous
    '    .Weight = xlMedium
    '    .ColorIndex = xlAutomatic
    'End With


'--- zformatovani stranky k tisku
A4PL = MsgBox("YES = A4 Portrait ? (NO = Landscape)", vbYesNo, "Format stranky:")
If A4PL = vbYes Then PORLAND = xlPortrait
If A4PL = vbNo Then PORLAND = xlLandscape
'ActiveSheet.PageSetup.CenterFooterPicture.Filename = "c:\newfordlogo.gif"
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$2"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = Range(Cells(1, 1), Cells(RADKU + POZNAMEK + 10, SLOUPKU - 1)).Address
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = CENIK
        .LeftFooter = Worksheets("cover").Range("D54").Value
        .CenterFooter = "&P/&N"
        .RightFooter = "FORD MOTOR COMPANY, s.r.o., " & Worksheets("cover").Range("C4").Value
        .LeftMargin = Application.CentimetersToPoints(0.5)
        .RightMargin = Application.CentimetersToPoints(0.5)
        .TopMargin = Application.CentimetersToPoints(0.8)
        .BottomMargin = Application.CentimetersToPoints(0.8)
        .HeaderMargin = Application.CentimetersToPoints(0.5)
        .FooterMargin = Application.CentimetersToPoints(0.5)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = PORLAND 'xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .PrintErrors = xlPrintErrorsDisplayed
    End With
'---- zformatovani cen
Range(Cells(1, 3), Cells(RADKU, SLOUPKU - 1)).Select
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .NumberFormat = "#,##0"
End With


Application.DisplayAlerts = True
Range("A1").Select
Worksheets("Cover").Range("C15").Value = RADKU
Worksheets("Cover").Range("D15").Value = POZNAMEK
Worksheets("Cover").Range("E15").Value = SLOUPKU
PUBRADKU = RADKU
PUBPOZNAMEK = POZNAMEK

Call Kontrola

End Sub

Sub MergeSelection()
'
' MergeSelection Macro
' Macro recorded 14.1.2005 by jbartos1
'

'
    'Range("Z19:AG19").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
End Sub



Sub AddID()
'
' AddID Macro
' Macro recorded 25.1.2005 by jbartos1
'
'
ThisWorkbook.Sheets("BarvyPotahy").Unprotect "dms"
Worksheets("Entity").Select
Model = ""
IDX = 0
I = 3
BP = 5
BPVALUE = ""
BPMODELLIST = ""
BPCOUNT = 0
BPKAR = 1
ReDim BPKARLIST(1)
BPKARLIST(0) = "ALL"
BPKcount = 1
VYBAVAIDX = 9
III = Worksheets("Cover").Range("B15").Value
Worksheets("Vybava").Select
If IsNull(III) Then III = 0
If IsEmpty(III) Then III = 0
If III > 0 Then
 Range(Cells(1, 9), Cells(2, 9 + III)).Select
 Selection.ClearComments
 Selection.Clear
 Selection.UnMerge

End If

Worksheets("Entity").Select
UBP = MsgBox("Pridat modely do Barev a Potahu ?", vbYesNo)
Do
 BUNKAA = "A" & I
 BUNKAB = "B" & I
 BUNKAK = "K" & I 'motor
 BUNKAI = "I" & I
 BUNKAJ = "J" & I
 BUNKAP = "P" & I
 DESCR = ""
 If Range("A" & I).Value <> "" Then DESCR = DESCR & Range("A" & I).Value & vbLf
 If Range("C" & I).Value <> "" Then DESCR = DESCR & Range("C" & I).Value & vbLf
 If Range("D" & I).Value <> "" Then DESCR = DESCR & Range("D" & I).Value & vbLf
 If Range("E" & I).Value <> "" Then DESCR = DESCR & Range("E" & I).Value & vbLf
 If Range("I" & I).Value <> "" Then DESCR = DESCR & Range("I" & I).Value & vbLf
 If Range("J" & I).Value <> "" Then DESCR = DESCR & Range("J" & I).Value & vbLf
 If Range("M" & I).Value <> "" Then DESCR = DESCR & Range("M" & I).Value & vbLf
 If Range("N" & I).Value <> "" Then DESCR = DESCR & Range("N" & I).Value & vbLf
 If Range("O" & I).Value <> "" Then DESCR = DESCR & Range("O" & I).Value & vbLf
 If Range("P" & I).Value <> "" Then DESCR = DESCR & Range("P" & I).Value & vbLf
 If Range("Q" & I).Value <> "" Then DESCR = DESCR & Range("Q" & I).Value & vbLf
 
 If Range(BUNKAA).Value <> "" Then
  IDX = IDX + 1
  Range(BUNKAB).Value = Worksheets("Cover").Cells(2, 3).Value & IDX
  Range(BUNKAK).Value = Range(BUNKAJ).Text & " " & Range(BUNKAI).Value
  Worksheets("Vybava").Cells(2, VYBAVAIDX).Value = Worksheets("Cover").Cells(2, 3).Value & IDX
  'Worksheets("Vybava").Cells(2, VYBAVAIDX).Value = DESCR '
  Worksheets("Vybava").Cells(1, VYBAVAIDX).Value = Range(BUNKAA).Value
 If (BPVALUE <> Range(BUNKAA).Value) Then
  BPVALUE = Range(BUNKAA).Value
  BPMODELLIST = BPMODELLIST & BPVALUE & ","
 End If
  BPKAR = 1
  For BPK = 0 To BPKcount - 1
   If Range(BUNKAP).Value <> BPKARLIST(BPK) Then
    BPKAR = BPKAR * 1
   Else
    BPKAR = BPKAR * 0
   End If
  Next
  
  If BPKAR = 1 Then
   BPKcount = BPKcount + 1
   ReDim Preserve BPKARLIST(BPKcount)
   BPKARLIST(BPKcount - 1) = Range(BUNKAP).Value
  End If
       
  Worksheets("Vybava").Cells(2, VYBAVAIDX).Orientation = 0
  xy = Worksheets("Vybava").Cells(2, VYBAVAIDX).AddressLocal
  Worksheets("Vybava").Range(xy).ClearComments
  Worksheets("Vybava").Range(xy).AddComment DESCR
  'Worksheets("Vybava").Range(xy).AddComment Worksheets("Cover").Cells(2, 3).Value & IDX
    
  VYBAVAIDX = VYBAVAIDX + 1
  Worksheets("Entity").Select
 End If
 I = I + 1
 Worksheets("Cover").Range("B15").Value = IDX
Loop While Range(BUNKAA).Value <> ""

BPKAR = ""
For BPK = 0 To BPKcount - 1
 BPKAR = BPKAR & BPKARLIST(BPK) & ","
Next

'---List modelu do BarvyPotahy
Worksheets("BarvyPotahy").Select
For BP = 5 To 100
 Cells(BP, 1).Select
 ThisWorkbook.Sheets("BarvyPotahy").Unprotect "dms"
     With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:=BPMODELLIST
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Neexistujici model !!!"
        .ShowInput = True
        .ShowError = True
    End With
Next
If UBP = vbYes Then
 BPMODEL = Split(BPMODELLIST, ",")
 For BP = 0 To UBound(BPMODEL) - 1
  Cells(BP + 5, 1).Value = BPMODEL(BP)
 Next
End If
'---Vzor pro validaci modelu
 Cells(1, 1).Select
     With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:=BPMODELLIST
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Neexistujici model !!!"
        .ShowInput = True
        .ShowError = True
    End With

'--- List karoserii do BarvyPotahy

Worksheets("BarvyPotahy").Select
For BP = 5 To 100
 ThisWorkbook.Sheets("BarvyPotahy").Unprotect "dms"
 Cells(BP, 2).Select
     With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:=BPKAR
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Neexistujici karoserie !!!"
        .ShowInput = True
        .ShowError = True
    End With
Next
'--- Vzor pro validaci karoserii
 Cells(1, 2).Select
     With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:=BPKAR
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Neexistujici karoserie !!!"
        .ShowInput = True
        .ShowError = True
    End With



Cells(5, 1).Select


'---mergovani
Application.DisplayAlerts = False
Worksheets("Vybava").Select
VYBAVAIDX = 9
I = 9
MI = 1
BUNKAX = Cells(1, I).Address
Model = Range(BUNKAX).Value
Do
I = I + 1
BUNKAX = Cells(1, I).Address
If Range(BUNKAX).Value = Model Then
 MI = MI + 1
Else
 Range(Cells(1, VYBAVAIDX), Cells(1, VYBAVAIDX + MI - 1)).Select
 Range(Cells(1, VYBAVAIDX), Cells(1, VYBAVAIDX + MI - 1)).Merge (False)
 Range(Cells(1, VYBAVAIDX), Cells(1, VYBAVAIDX + MI - 1)).ClearComments
 'Range(Cells(1, VYBAVAIDX), Cells(1, VYBAVAIDX + MI - 1)).AddComment COMM
 xy = Cells(1, VYBAVAIDX).AddressLocal
 Worksheets("Vybava").Range(xy).AddComment " " & MI
 
 'Call MergeSelection
 VYBAVAIDX = VYBAVAIDX + MI
 Model = Range(BUNKAX).Value
 MI = 1
End If
 'MsgBox "I=" & I & " MI=" & MI & " Vybavaidx=" & VYBAVAIDX
Loop While Range(BUNKAX).Value <> ""
Application.DisplayAlerts = True

'--- Zformatovani komentu
For I = 9 To III + 8
Cells(2, I).Select
ActiveCell.Comment.Visible = True
ActiveCell.Comment.Shape.Select True
With Selection.Font
        .Name = "tahoma"
        .FontStyle = "tu|fffd|n|fffd|"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
End With
Selection.ShapeRange.LockAspectRatio = msoFalse
Selection.ShapeRange.Height = 130
Selection.ShapeRange.Width = 84.75
ActiveCell.Comment.Visible = False
Next

ThisWorkbook.Sheets("BarvyPotahy").Protect "dms", True, True, True, False, True, True, True, False, True, False, False, True

End Sub

Sub FMC_Cenik_Transit_M1M2()
'
' FMC_Cenik_Transit_M1M2 Macro
' Macro recorded 22.2.2005 by jbartos1
'
'
'
On Error Resume Next
Dotaz = "Pou|fffd|iteln|fffd| pro vytvo|fffd|en|fffd| FMC cen|fffd|ku pro: " & vbCrLf
Dotaz = Dotaz & " Transit BUS M2 " & vbCrLf
Dotaz = Dotaz & "   nebo"
Dotaz = Dotaz & " Transit Tourneo M1 " & vbCrLf
Dotaz = Dotaz & "   nebo"
Dotaz = Dotaz & " Transit Kombi M1 " & vbCrLf
Dotaz = Dotaz & "   nebo"
Dotaz = Dotaz & " Connect Tourneo M1 " & vbCrLf

Response = MsgBox(Dotaz, vbYesNo, "????")
If Response = vbYes Then
'--- smazat vsechno
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    ActiveSheet.Shapes("Image1").Select
    Selection.Delete
    ActiveSheet.Shapes("Image2").Select
    Selection.Delete

    Range("E9").Select

Worksheets("Entity").Select

III = Worksheets("Cover").Range("B15").Value

'---uprava ID na cislo
I = 3
Do
 BUNKAB = "B" & I
 I = I + 1
 Range(BUNKAB).Value = Mid(Range(BUNKAB).Value, 4)
 'MsgBox I
Loop While I < III + 3

'---
I = 3
Do
 BUNKAA = "A" & I
 BUNKAN = "N" & I
 BUNKAO = "O" & I
 Range(BUNKAN).Value = Range(BUNKAN).Value & " p|fffd|evodovka"
 Range(BUNKAO).Value = Range(BUNKAO).Value & " pohon"
 I = I + 1
Loop While Range(BUNKAA).Value <> ""
SRCDATA = "Entity!R2C1:R" & I - 2 & "C17"
Worksheets("FMC-Cenik").Activate
Worksheets("FMC-Cenik").Select
Cells.Select
Selection.Delete Shift:=xlUp

    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:= _
        SRCDATA).CreatePivotTable TableDestination:=Range("B6"), _
        TableName:="PivotTable1"
        
    With ActiveSheet.PivotTables("PivotTable1")
        .ColumnGrand = False
        .NullString = "---"
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable1").AddFields RowFields:=Array("Rozvor v mm", _
        "Rozvor", "Model", "Ozna|fffd|en|fffd|", "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)"), ColumnFields:=Array("Pohon", "Motor", _
        "V|fffd|kon", "P|fffd|evodovka")
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Cena").Orientation = _
        xlDataField
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Model").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Rozvor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Rozvor v mm").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Ozna|fffd|en|fffd|").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)").Subtotals = Array _
        (False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Pohon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("V|fffd|kon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("P|fffd|evodovka").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)

    '---srovnani
    ActiveSheet.PivotTables("PivotTable1").PivotFields( _
        "Rozvor v mm").AutoSort xlAscending, _
        "Rozvor v mm"
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Pohon").AutoSort _
        xlAscending, "Pohon"
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").AutoSort _
        xlAscending, "Motor"

    ActiveSheet.PivotTables("PivotTable1").PivotFields( _
        "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)").AutoSort xlAscending, _
        "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)"

    Worksheets("Entity").Select
    I = 3
    Do
    BUNKAA = "A" & I
    BUNKAN = "N" & I
    BUNKAO = "O" & I
    N = Split(Range(BUNKAN).Value, " ")
    O = Split(Range(BUNKAO).Value, " ")
    Range(BUNKAN).Value = N(0)
    Range(BUNKAO).Value = O(0)
    I = I + 1
    Loop While Range(BUNKAA).Value <> ""
    Worksheets("FMC-Cenik").Select

    '----zformatovani ceniku
    '---prevedeni pivota na normalni tabulku
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Rows.AutoFit
    Selection.Columns.AutoFit
    Selection.Copy
    SLOUPKU = Selection.Columns.Count
    RADKU = Selection.Rows.Count
    
    KAM = "B" & RADKU + 6
    Range(KAM).Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Delete
    Rows("6").Select
    Selection.Delete
'----Mazani prazdnych sloupcu - DODELAT----
    XSLD = 0
    For SL = SLOUPKU + 1 To 2 Step -1
     XS = 0
     For I = 10 To RADKU + 4
      If Cells(I, SL).Value = "" Then
       XS = XS
      Else
       XS = XS + 1
      End If
     Next
     If XS = 0 Then
      XSLD = XSLD + 1
      Columns(SL).Select
      Selection.Delete
     End If
    
    Next
    SLOUPKU = SLOUPKU - XSLD
    
'--- srovnani

    Columns("D:D").Select
    Selection.Insert Shift:=xlToRight
    Columns("B:B").Select
    Selection.Copy
    Columns("D:D").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Copy
    Columns("B:B").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select


    '---nadpis tabulky
    Range(Cells(5, 2), Cells(5, SLOUPKU + 1)).Select
    Selection.Merge (False)
    Selection.Value = "Cen|fffd|k Ford " & Worksheets("Cover").Range("D2").Value
    CENIK = Selection.Value
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    With Selection.Interior
        .ColorIndex = 41
        .Pattern = xlSolid
    End With
    Selection.Font.ColorIndex = 2
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    '---nadpisy polozek
    For I = 2 To 6
    Range(Cells(6, I), Cells(9, I)).Select
        With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Next
    Range(Cells(5, 2), Cells(5 + RADKU - 1, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Range(Cells(6, 7), Cells(9, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
'--- logo
Range(Cells(2, 2), Cells(4, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Sheets("Cover").Select
    'ActiveSheet.Shapes("Picture 21").Select
    ActiveSheet.LOGO.Select
    Selection.Copy
    Sheets("FMC-Cenik").Select
    Cells(1, 2).Select
    ActiveSheet.Paste
    ActiveSheet.Shapes("Image1").Select
    ActiveSheet.Shapes("Image1").Left = 55
    ActiveSheet.Shapes("Image1").Top = 15
    ActiveSheet.Shapes("Image1").Placement = 1
    ActiveSheet.Shapes("Image2").Select
    ActiveSheet.Shapes("Image2").Left = 55
    ActiveSheet.Shapes("Image2").Top = 15
    ActiveSheet.Shapes("Image2").Placement = 1

'--- doplneni radkoveho ohraniceni

For R = 10 To (RADKU + 3)
 Range(Cells(R, 6), Cells(R, SLOUPKU + 1)).Select
     With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
Next
Range(Cells(10, 2), Cells(RADKU + 4, SLOUPKU + 1)).Select
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
End With
Range(Cells(10, 7), Cells(RADKU + 4, SLOUPKU + 1)).NumberFormat = "#,##0"


'--- misto na obrazek
    Range("A6").Select
    For II = 1 To 20
     Selection.EntireRow.Insert
    Next
    RADKUALL = RADKU + 20 + 4 '--- tabulka s nadpisem + 20 vlozenych + 4 hlavicka s logem
    
    Range(Cells(6, 2), Cells(RADKUALL - RADKU + 1, SLOUPKU + 1)).Select
    
    Selection.Interior.ColorIndex = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


'--- zformatovani stranky k tisku
A4PL = MsgBox("YES = A4 Portrait ? (NO = Landscape)", vbYesNo, "Format stranky:")
If A4PL = vbYes Then PORLAND = xlPortrait
If A4PL = vbNo Then PORLAND = xlLandscape
'ActiveSheet.PageSetup.CenterFooterPicture.Filename = "c:\newfordlogo.gif"
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$5"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = Range(Cells(2, 2), Cells(RADKUALL, SLOUPKU + 1)).Address
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = CENIK
        .LeftFooter = Worksheets("cover").Range("D52").Value
        .CenterFooter = "&P/&N"
        .RightFooter = "FORD MOTOR COMPANY,s.r.o., " & Worksheets("cover").Range("C4").Value
        .LeftMargin = Application.CentimetersToPoints(0.5)
        .RightMargin = Application.CentimetersToPoints(0.5)
        .TopMargin = Application.CentimetersToPoints(1)
        .BottomMargin = Application.CentimetersToPoints(1)
        .HeaderMargin = Application.CentimetersToPoints(0.5)
        .FooterMargin = Application.CentimetersToPoints(0.5)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = PORLAND 'xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .PrintErrors = xlPrintErrorsDisplayed
    End With
    
    Range("B4").Select
    '---uprava ID zpet
    Worksheets("Entity").Select
    I = 3
    Do
     BUNKAB = "B" & I
     I = I + 1
     Range(BUNKAB).Value = Worksheets("Cover").Range("C2").Value & Range(BUNKAB).Value
    
    Loop While I < III + 3


'---
Worksheets("FMC-Cenik").Select
    
    
    End If
End Sub

Sub FMC_Cenik_Transit_N1N2()
'
' FMC_Cenik_Transit_N1N2 Macro
' Macro recorded 22.2.2005 by jbartos1
'
'
'
On Error Resume Next
Dotaz = "Pou|fffd|iteln|fffd| pro vytvo|fffd|en|fffd| FMC cen|fffd|ku pro: " & vbCrLf
Dotaz = Dotaz & " Transit VAN " & vbCrLf
Dotaz = Dotaz & "   nebo"
Dotaz = Dotaz & " Transit Kombi VAN " & vbCrLf
Dotaz = Dotaz & "   nebo"
Dotaz = Dotaz & " Connect Transit " & vbCrLf

Response = MsgBox(Dotaz, vbYesNo, "????")
If Response = vbYes Then

'--- smazat vsechno
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    ActiveSheet.Shapes("Image1").Select
    Selection.Delete
    ActiveSheet.Shapes("Image2").Select
    Selection.Delete

    Range("E9").Select

Worksheets("Entity").Select

III = Worksheets("Cover").Range("B15").Value

'---uprava ID na cislo
I = 3
Do
 BUNKAB = "B" & I
 I = I + 1
 Range(BUNKAB).Value = Mid(Range(BUNKAB).Value, 4)
 'MsgBox I
Loop While I < III + 3


'---

I = 3
Do
 BUNKAA = "A" & I
 BUNKAN = "N" & I
 BUNKAO = "O" & I
 Range(BUNKAN).Value = Range(BUNKAN).Value & " p|fffd|evodovka"
 Range(BUNKAO).Value = Range(BUNKAO).Value & " pohon"
 I = I + 1
Loop While Range(BUNKAA).Value <> ""
SRCDATA = "Entity!R2C1:R" & I - 2 & "C17"
Worksheets("FMC-Cenik").Activate
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp

    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:= _
        SRCDATA).CreatePivotTable TableDestination:=Range("B6"), _
        TableName:="PivotTable1"
     
        
    With ActiveSheet.PivotTables("PivotTable1")
        .ColumnGrand = False
        .NullString = "---"
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable1").AddFields RowFields:=Array("Rozvor v mm", _
        "Rozvor", "Model", "Ozna|fffd|en|fffd|", "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)", _
         "Objem n|fffd|kl. prostoru SAE (m3)"), ColumnFields:=Array("Pohon", "Motor", _
        "V|fffd|kon", "P|fffd|evodovka")
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Cena").Orientation = _
        xlDataField
    Range("B8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Model").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("C8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Rozvor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Rozvor v mm").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("D8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Ozna|fffd|en|fffd|").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Range("E8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Objem n|fffd|kl. prostoru SAE (m3)").Subtotals = Array _
        (False, False, False, False, False, False, False, False, False, False, False, False)
    Range("F3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Pohon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("G3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("I3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("V|fffd|kon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("J3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("P|fffd|evodovka").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)

    '---srovnani
    ActiveSheet.PivotTables("PivotTable1").PivotFields( _
        "Rozvor v mm").AutoSort xlAscending, _
        "Rozvor v mm"
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Pohon").AutoSort _
        xlAscending, "Pohon"
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").AutoSort _
        xlAscending, "Motor"

    ActiveSheet.PivotTables("PivotTable1").PivotFields( _
        "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)").AutoSort xlAscending, _
        "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)"

    Worksheets("Entity").Select
    I = 3
    Do
    BUNKAA = "A" & I
    BUNKAN = "N" & I
    BUNKAO = "O" & I
    N = Split(Range(BUNKAN).Value, " ")
    O = Split(Range(BUNKAO).Value, " ")
    Range(BUNKAN).Value = N(0)
    Range(BUNKAO).Value = O(0)
    I = I + 1
    Loop While Range(BUNKAA).Value <> ""
    Worksheets("FMC-Cenik").Select

    '----zformatovani ceniku
    '---prevedeni pivota na normalni tabulku
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Rows.AutoFit
    Selection.Columns.AutoFit
    Selection.Copy
    SLOUPKU = Selection.Columns.Count
    RADKU = Selection.Rows.Count
      
    KAM = "B" & RADKU + 6
    Range(KAM).Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Delete
    Rows("6").Select
    Selection.Delete
'----Mazani prazdnych sloupcu -----
    XSLD = 0
    For SL = SLOUPKU + 1 To 2 Step -1
     XS = 0
     For I = 10 To RADKU + 4
      If Cells(I, SL).Value = "" Then
       XS = XS
      Else
       XS = XS + 1
      End If
     Next
     If XS = 0 Then
      XSLD = XSLD + 1
      Columns(SL).Select
      Selection.Delete
     End If
    
    Next
    SLOUPKU = SLOUPKU - XSLD
    
    '--- srovnani

    Columns("D:D").Select
    Selection.Insert Shift:=xlToRight
    Columns("B:B").Select
    Selection.Copy
    Columns("D:D").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Copy
    Columns("B:B").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select


    '---nadpis tabulky
    Range(Cells(5, 2), Cells(5, SLOUPKU + 1)).Select
    Selection.Merge (False)
    Selection.Value = "Cen|fffd|k Ford " & Worksheets("Cover").Range("D2").Value
    CENIK = Selection.Value
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    With Selection.Interior
        .ColorIndex = 41
        .Pattern = xlSolid
    End With
    Selection.Font.ColorIndex = 2
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With

    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    '---nadpisy polozek
    For I = 2 To 7
    Range(Cells(6, I), Cells(9, I)).Select
        With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Next
    Range(Cells(5, 2), Cells(5 + RADKU - 1, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Range(Cells(6, 7), Cells(9, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
'--- logo
Range(Cells(2, 2), Cells(4, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Sheets("Cover").Select
    'ActiveSheet.Shapes("Picture 21").Select
    ActiveSheet.LOGO.Select
    Selection.Copy
    Sheets("FMC-Cenik").Select
    Cells(1, 2).Select
    ActiveSheet.Paste
    ActiveSheet.Shapes("Image1").Select
    ActiveSheet.Shapes("Image1").Left = 55
    ActiveSheet.Shapes("Image1").Top = 15
    ActiveSheet.Shapes("Image1").Placement = 1
    ActiveSheet.Shapes("Image2").Select
    ActiveSheet.Shapes("Image2").Left = 55
    ActiveSheet.Shapes("Image2").Top = 15
    ActiveSheet.Shapes("Image2").Placement = 1

'--- doplneni radkoveho ohraniceni

For R = 10 To (RADKU + 3)
 Range(Cells(R, 6), Cells(R, SLOUPKU + 1)).Select
     With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
Next
Range(Cells(10, 2), Cells(RADKU + 4, SLOUPKU + 1)).Select
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
End With
Range(Cells(10, 8), Cells(RADKU + 4, SLOUPKU + 1)).NumberFormat = "#,##0"

'--- misto na obrazek
    Range("A6").Select
    For II = 1 To 20
     Selection.EntireRow.Insert
    Next
    RADKUALL = RADKU + 20 + 4 '--- tabulka s nadpisem + 20 vlozenych + 4 hlavicka s logem
    
    Range(Cells(6, 2), Cells(RADKUALL - RADKU + 1, SLOUPKU + 1)).Select
    
    Selection.Interior.ColorIndex = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


'--- zformatovani stranky k tisku
A4PL = MsgBox("YES = A4 Portrait ? (NO = Landscape)", vbYesNo, "Format stranky:")
If A4PL = vbYes Then PORLAND = xlPortrait
If A4PL = vbNo Then PORLAND = xlLandscape
'ActiveSheet.PageSetup.CenterFooterPicture.Filename = "c:\newfordlogo.gif"
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$5"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = Range(Cells(2, 2), Cells(RADKUALL, SLOUPKU + 1)).Address
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = CENIK
        .LeftFooter = Worksheets("cover").Range("D52").Value
        .CenterFooter = "&P/&N"
        .RightFooter = "FORD MOTOR COMPANY,s.r.o., " & Worksheets("cover").Range("C4").Value
        .LeftMargin = Application.CentimetersToPoints(0.5)
        .RightMargin = Application.CentimetersToPoints(0.5)
        .TopMargin = Application.CentimetersToPoints(1)
        .BottomMargin = Application.CentimetersToPoints(1)
        .HeaderMargin = Application.CentimetersToPoints(0.5)
        .FooterMargin = Application.CentimetersToPoints(0.5)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = PORLAND 'xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .PrintErrors = xlPrintErrorsDisplayed
    End With
    
    Range("B4").Select
    '---uprava ID zpet
    Worksheets("Entity").Select
    I = 3
    Do
     BUNKAB = "B" & I
     I = I + 1
     Range(BUNKAB).Value = Worksheets("Cover").Range("C2").Value & Range(BUNKAB).Value
    
    Loop While I < III + 3


'---
Worksheets("FMC-Cenik").Select
    
    
    
    End If
End Sub

Sub FMC_Cenik_Transit_Podvozky()
'
' FMC_Cenik_Transit_Podvozky Macro
' Macro recorded 22.2.2005 by jbartos1
'

'
On Error Resume Next
Dotaz = "Pou|fffd|iteln|fffd| pro vytvo|fffd|en|fffd| FMC cen|fffd|ku pro: " & vbCrLf
Dotaz = Dotaz & " Transit Podvozky " & vbCrLf


Response = MsgBox(Dotaz, vbYesNo, "????")
If Response = vbYes Then

'--- smazat vsechno
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    ActiveSheet.Shapes("Image1").Select
    Selection.Delete
    ActiveSheet.Shapes("Image2").Select
    Selection.Delete

    Range("E9").Select

Worksheets("Entity").Select

III = Worksheets("Cover").Range("B15").Value

'---uprava ID na cislo
I = 3
Do
 BUNKAB = "B" & I
 I = I + 1
 Range(BUNKAB).Value = Mid(Range(BUNKAB).Value, 4)
 'MsgBox I
Loop While I < III + 3


'---

I = 3
Do
 BUNKAA = "A" & I
 BUNKAN = "N" & I
 BUNKAO = "O" & I
 Range(BUNKAN).Value = Range(BUNKAN).Value & " p|fffd|evodovka"
 Range(BUNKAO).Value = Range(BUNKAO).Value & " pohon"
 I = I + 1
Loop While Range(BUNKAA).Value <> ""
SRCDATA = "Entity!R2C1:R" & I - 2 & "C17"
Worksheets("FMC-Cenik").Activate
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp

     ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:= _
        SRCDATA).CreatePivotTable TableDestination:=Range("B6"), _
        TableName:="PivotTable1"
        
        
    With ActiveSheet.PivotTables("PivotTable1")
        .ColumnGrand = False
        .NullString = "---"
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("PivotTable1").AddFields RowFields:=Array("Rozvor v mm", _
        "Rozvor", "Model", "Ozna|fffd|en|fffd|", "Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)", _
         "Lo|fffd|n|fffd| d|fffd|lka valn|fffd|ku/d|fffd|lka r|fffd|mu podvozku (mm)"), ColumnFields:=Array("Pohon", "Motor", _
        "V|fffd|kon", "P|fffd|evodovka")
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Cena").Orientation = _
        xlDataField
    Range("B8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Model").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("C8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Rozvor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Rozvor v mm").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Nosnost/P|fffd||fffd|pustn|fffd| hmotnost (kg)").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("D8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Ozna|fffd|en|fffd|").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    Range("E8").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Lo|fffd|n|fffd| d|fffd|lka valn|fffd|ku/d|fffd|lka r|fffd|mu podvozku (mm)").Subtotals = Array _
        (False, False, False, False, False, False, False, False, False, False, False, False)
    Range("F3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Pohon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("G3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("I3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("V|fffd|kon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("J3").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("P|fffd|evodovka").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
   
    
  
    Worksheets("Entity").Select
    I = 3
    Do
    BUNKAA = "A" & I
    BUNKAN = "N" & I
    BUNKAO = "O" & I
    N = Split(Range(BUNKAN).Value, " ")
    O = Split(Range(BUNKAO).Value, " ")
    Range(BUNKAN).Value = N(0)
    Range(BUNKAO).Value = O(0)
    I = I + 1
    Loop While Range(BUNKAA).Value <> ""
    Worksheets("FMC-Cenik").Select

    '---prevedeni pivota na normalni tabulku
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Rows.AutoFit
    Selection.Columns.AutoFit
    Selection.Copy
    SLOUPKU = Selection.Columns.Count
    RADKU = Selection.Rows.Count
 
    KAM = "B" & RADKU + 6
    Range(KAM).Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Delete
    Rows("6").Select
    Selection.Delete
'----Mazani prazdnych sloupcu -----
    XSLD = 0
    For SL = SLOUPKU + 1 To 2 Step -1
     XS = 0
     For I = 10 To RADKU + 4
      If Cells(I, SL).Value = "" Then
       XS = XS
      Else
       XS = XS + 1
      End If
     Next
     If XS = 0 Then
      XSLD = XSLD + 1
      Columns(SL).Select
      Selection.Delete
     End If
    
    Next
    SLOUPKU = SLOUPKU - XSLD
    
    '--- srovnani

    Columns("D:D").Select
    Selection.Insert Shift:=xlToRight
    Columns("B:B").Select
    Selection.Copy
    Columns("D:D").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Copy
    Columns("B:B").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select


    '---nadpis tabulky
    Range(Cells(5, 2), Cells(5, SLOUPKU + 1)).Select
    Selection.Merge (False)
    Selection.Value = "Cen|fffd|k Ford " & Worksheets("Cover").Range("D2").Value
    CENIK = Selection.Value
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    With Selection.Interior
        .ColorIndex = 41
        .Pattern = xlSolid
    End With
    Selection.Font.ColorIndex = 2
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    '---nadpisy polozek
    For I = 2 To 7
    Range(Cells(6, I), Cells(9, I)).Select
        With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Next
    Range(Cells(5, 2), Cells(5 + RADKU - 1, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Range(Cells(6, 7), Cells(9, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
'--- logo
Range(Cells(2, 2), Cells(4, SLOUPKU + 1)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Sheets("Cover").Select
    'ActiveSheet.Shapes("Picture 21").Select
    ActiveSheet.LOGO.Select
    Selection.Copy
    Sheets("FMC-Cenik").Select
    Cells(1, 2).Select
    ActiveSheet.Paste
    ActiveSheet.Shapes("Image1").Select
    ActiveSheet.Shapes("Image1").Left = 55
    ActiveSheet.Shapes("Image1").Top = 15
    ActiveSheet.Shapes("Image1").Placement = 1
    ActiveSheet.Shapes("Image2").Select
    ActiveSheet.Shapes("Image2").Left = 55
    ActiveSheet.Shapes("Image2").Top = 15
    ActiveSheet.Shapes("Image2").Placement = 1


'--- doplneni radkoveho ohraniceni

For R = 10 To (RADKU + 3)
 Range(Cells(R, 6), Cells(R, SLOUPKU + 1)).Select
     With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
Next
Range(Cells(10, 2), Cells(RADKU + 4, SLOUPKU + 1)).Select
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
End With
Range(Cells(10, 7), Cells(RADKU + 4, SLOUPKU + 1)).NumberFormat = "#,##0"

'--- misto na obrazek
    Range("A6").Select
    For II = 1 To 20
     Selection.EntireRow.Insert
    Next
    RADKUALL = RADKU + 20 + 4 '--- tabulka s nadpisem + 20 vlozenych + 4 hlavicka s logem
    
    Range(Cells(6, 2), Cells(RADKUALL - RADKU + 1, SLOUPKU + 1)).Select
    
    Selection.Interior.ColorIndex = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


'--- zformatovani stranky k tisku
A4PL = MsgBox("YES = A4 Portrait ? (NO = Landscape)", vbYesNo, "Format stranky:")
If A4PL = vbYes Then PORLAND = xlPortrait
If A4PL = vbNo Then PORLAND = xlLandscape
'ActiveSheet.PageSetup.CenterFooterPicture.Filename = "c:\newfordlogo.gif"
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$5"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = Range(Cells(2, 2), Cells(RADKUALL, SLOUPKU + 1)).Address
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = CENIK
        .LeftFooter = Worksheets("cover").Range("D52").Value
        .CenterFooter = "&P/&N"
        .RightFooter = "FORD MOTOR COMPANY,s.r.o., " & Worksheets("cover").Range("C4").Value
        .LeftMargin = Application.CentimetersToPoints(0.5)
        .RightMargin = Application.CentimetersToPoints(0.5)
        .TopMargin = Application.CentimetersToPoints(1)
        .BottomMargin = Application.CentimetersToPoints(1)
        .HeaderMargin = Application.CentimetersToPoints(0.5)
        .FooterMargin = Application.CentimetersToPoints(0.5)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = PORLAND 'xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .PrintErrors = xlPrintErrorsDisplayed
    End With
    
    Range("B4").Select
    '---uprava ID zpet
    Worksheets("Entity").Select
    I = 3
    Do
     BUNKAB = "B" & I
     I = I + 1
     Range(BUNKAB).Value = Worksheets("Cover").Range("C2").Value & Range(BUNKAB).Value
    
    Loop While I < III + 3


'---
Worksheets("FMC-Cenik").Select
    
    
    End If
End Sub

Sub FMC_CenikOS()
'
' FMC_CenikOS Macro
' Macro recorded 24.2.2005 by jbartos1
'
On Error Resume Next
Dotaz = "Pou|fffd|iteln|fffd| pro vytvo|fffd|en|fffd| FMC cen|fffd|ku pro: " & vbCrLf
Dotaz = Dotaz & " Osobni auta " & vbCrLf

Response = MsgBox(Dotaz, vbYesNo, "????")
If Response = vbYes Then
'--- pohon
Response = MsgBox("Zobrazit POHON na ceniku? Jen pro Ford Kuga.", vbYesNo, "????")
If Response = vbYes Then
 QPOHON = "ANO"
 Else
 QPOHON = "NE"
End If

'--- smazat vsechno
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    ActiveSheet.Shapes("Image1").Select
    Selection.Delete
    ActiveSheet.Shapes("Image2").Select
    Selection.Delete
    ActiveSheet.Shapes("Image3").Select
    Selection.Delete

    Range("E9").Select


Worksheets("Entity").Select
III = Worksheets("Cover").Range("B15").Value

'---uprava ID na cislo
'I = 3
'Do
' BUNKAB = "B" & I
' I = I + 1
' Range(BUNKAB).Value = Mid(Range(BUNKAB).Value, 4)
' 'MsgBox I
'Loop While I < III + 3
'---uprava ID na cislo podle modelu
COUNTER = 1
NMODEL = Range("A3").Value
I = 3
Do
 BUNKAB = "B" & I
 BUNKAA = "A" & I
 If NMODEL = Range(BUNKAA).Value Then
  Range(BUNKAB).Value = COUNTER
 Else
  COUNTER = COUNTER + 1
  Range(BUNKAB).Value = COUNTER
  NMODEL = Range(BUNKAA).Value
 End If
 I = I + 1
Loop While I < III + 3

'---
I = 3
Do
 BUNKAA = "A" & I
 I = I + 1
Loop While Range(BUNKAA).Value <> ""

SRCDATA = "Entity!R2C1:R" & I - 2 & "C17"
'MsgBox SRCDATA
Worksheets("FMC-Cenik").Activate
Worksheets("FMC-Cenik").Select
    Cells.Select
    Selection.Delete Shift:=xlUp

    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:= _
        SRCDATA).CreatePivotTable TableDestination:=Range("B3"), _
        TableName:="PivotTable1"
    With ActiveSheet.PivotTables("PivotTable1")
        .ColumnGrand = False
        .HasAutoFormat = False
        .NullString = "---"
        .RowGrand = False
    End With
   If QPOHON = "NE" Then
    ActiveSheet.PivotTables("PivotTable1").AddFields RowFields:=Array("ID", "Model", _
        "Motor", "V|fffd|kon", "P|fffd|evodovka"), ColumnFields:="Karoserie"
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Cena").Orientation = _
        xlDataField
    Range("B6").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Model").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("F9").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("I7").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("V|fffd|kon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("J6").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("P|fffd|evodovka").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("ID").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
   End If
   If QPOHON = "ANO" Then
    ActiveSheet.PivotTables("PivotTable1").AddFields RowFields:=Array("ID", "Model", _
        "Motor", "V|fffd|kon", "P|fffd|evodovka", "Pohon"), ColumnFields:="Karoserie"
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Cena").Orientation = _
        xlDataField
    Range("B6").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Model").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("F9").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Motor").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("I7").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("V|fffd|kon").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    Range("J6").Select
    ActiveSheet.PivotTables("PivotTable1").PivotFields("P|fffd|evodovka").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("ID").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("PivotTable1").PivotFields("Pohon").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
   End If

    '---prevedeni pivota na normalni tabulku
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Rows.AutoFit
    Selection.Columns.AutoFit
    Selection.Copy
    SLOUPKU = Selection.Columns.Count
    RADKU = Selection.Rows.Count
           
    KAM = "B" & RADKU + 6
    Range(KAM).Select
    
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveSheet.PivotTables("PivotTable1").PivotSelect "", xlDataAndLabel, True
    Selection.Delete
    Rows("6").Select
    Selection.Delete
    
'----Mazani prazdnych sloupcu -----
    XSLD = 0
    For SL = SLOUPKU + 1 To 2 Step -1
     XS = 0
     For I = 6 To RADKU + 4
      If Cells(I, SL).Value = "" Then
       XS = XS
      Else
       XS = XS + 1
      End If
     Next
     If XS = 0 Then
      XSLD = XSLD + 1
      Columns(SL).Select
      Selection.Delete
     End If
    
    Next
    SLOUPKU = SLOUPKU - XSLD
    
   '--- formatovani pohonu
   If QPOHON = "ANO" Then
    Range(Cells(7, 7), Cells(7 + RADKU - 3, 8)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
   End If
  '---
    '--- srovnani
    Application.DisplayAlerts = False
    Columns("B:B").Select
    Selection.Delete Shift:=xlToLeft
    Range("B7").Select
    x = Range("B7").Value
    XX = x
    I = 7
    Start = I
    Do While I <= RADKU + 5
    I = Start
    Do While x = XX And I <= RADKU + 5
     XX = Cells(I, 2).Value
     If XX = "" Then XX = x
     'MsgBox I & "-" & x & "-" & XX & "-"
     I = I + 1
    Loop
    x = Cells(I - 1, 2).Value

    Range(Cells(Start, 2), Cells(I - 2, SLOUPKU)).Select
        'Selection.Sort Key1:=Range(Cells(Start, 2).Address), Order1:=xlAscending, Key2:=Range(Cells(Start, 3).Address _
        ), Order2:=xlAscending, Key3:=Range(Cells(Start, 2).Address), Order3:=xlAscending, Header _
        :=xlNo, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal, DataOption2:=xlSortNormal, DataOption3:= _
        xlSortNormal
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    
    'MsgBox Start & " " & I - 2
    Range(Cells(Start, 2), Cells(I - 2, 2)).Select
    Selection.Merge (False)
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
 
    Start = I - 1
    
  Loop
Application.DisplayAlerts = True

'--- oddeleni karoserii
For I = 6 To SLOUPKU
    Range(Cells(6, I), Cells(RADKU + 4, I)).Select
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With

Next
        
    '---nadpis tabulky
    Range(Cells(4, 2), Cells(4, SLOUPKU)).Select
    Selection.Merge (False)
    Selection.Value = "Cen|fffd|k Ford " & Worksheets("Cover").Range("D2").Value
    CENIK = Selection.Value
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    With Selection.Interior
        .ColorIndex = 41
        .Pattern = xlSolid
    End With
    Selection.Font.ColorIndex = 2
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
        
    '---nadpisy polozek
    If QPOHON = "NE" Then XS = 5
    If QPOHON = "ANO" Then XS = 6
    For I = 2 To XS
    Range(Cells(5, I), Cells(6, I)).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Next
    
    Range(Cells(5, 2), Cells(5 + RADKU - 1, SLOUPKU)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    
    Range(Cells(5, XS + 1), Cells(5, SLOUPKU)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Merge (False)
    
    If QPOHON = "NE" Then Range("F5").Value = "Karoserie"
    If QPOHON = "ANO" Then Range("G5").Value = "Karoserie"

    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With

'--- logo
Range(Cells(1, 2), Cells(3, SLOUPKU)).Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Sheets("Cover").Select
    'ActiveSheet.Shapes("Picture 21").Select
    ActiveSheet.LOGO.Select
    Selection.Copy
    Sheets("FMC-Cenik").Select
    Cells(1, 2).Select
    ActiveSheet.Paste
    ActiveSheet.Shapes("Image1").Select
    ActiveSheet.Shapes("Image1").Left = 55
    ActiveSheet.Shapes("Image1").Top = 5
    ActiveSheet.Shapes("Image1").Placement = 1

    
'--- misto na obrazek

    Range("A5").Select
    For II = 1 To 15
     Selection.EntireRow.Insert
    Next
    RADKUALL = RADKU + 15 + 4 '--- tabulka s nadpisem + 15 vlozenych + 4 hlavicka s logem
    
    Range(Cells(5, 2), Cells(RADKUALL - RADKU, SLOUPKU)).Select
    
    Selection.Interior.ColorIndex = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    

'--- zformatovani stranky k tisku
A4PL = MsgBox("YES = A4 Portrait ? (NO = Landscape)", vbYesNo, "Format stranky:")
If A4PL = vbYes Then PORLAND = xlPortrait
If A4PL = vbNo Then PORLAND = xlLandscape
'ActiveSheet.PageSetup.CenterFooterPicture.Filename = "c:\newfordlogo.gif"
  '  With ActiveSheet.PageSetup
  '      .PrintTitleRows = "$1:$2"
  '      .PrintTitleColumns = ""
  '  End With
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$6"
        .PrintTitleColumns = ""
    End With

    ActiveSheet.PageSetup.PrintArea = Range(Cells(1, 2), Cells(RADKUALL, SLOUPKU)).Address
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = CENIK
        .LeftFooter = "" 'Worksheets("cover").Range("D52").Value
        .CenterFooter = "&P/&N"
        .RightFooter = "FORD MOTOR COMPANY, s.r.o., " & Worksheets("cover").Range("C4").Value
        .LeftMargin = Application.InchesToPoints(0.393700787401575)
        .RightMargin = Application.InchesToPoints(0.393700787401575)
        .TopMargin = Application.InchesToPoints(0.7)
        .BottomMargin = Application.InchesToPoints(0.590551181102362)
        .HeaderMargin = Application.InchesToPoints(0.511811023622047)
        .FooterMargin = Application.InchesToPoints(0.393700787401575)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = PORLAND 'xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
        .PrintErrors = xlPrintErrorsDisplayed
    End With
    
    Range("B4").Select
    
'---uprava ID zpet
'Worksheets("Entity").Select
'I = 3
'Do
' BUNKAB = "B" & I
' I = I + 1
' Range(BUNKAB).Value = Worksheets("Cover").Range("C2").Value & Range(BUNKAB).Value
 
'Loop While I < III + 3
Worksheets("Entity").Select
I = 3
IDX = 1
BUNKAA = "A" & I
BUNKAB = "B" & I
Do
 Range(BUNKAB).Value = Worksheets("Cover").Cells(2, 3).Value & IDX
 I = I + 1
 IDX = IDX + 1
 BUNKAA = "A" & I
 BUNKAB = "B" & I
Loop While Range(BUNKAA).Value <> ""

'--- zformatovani cen
Worksheets("FMC-Cenik").Select
Range(Cells(RADKUALL - RADKU, 6), Cells(RADKUALL, SLOUPKU)).Select
Selection.NumberFormat = "#,##0"

 Range("A1").Select
 End If
End Sub

Sub FMC_VybavaUsporna()
'
' FMC_VybavaUsporna Macro
' Macro recorded 9.11.2005 by jbartos1
'
On Error Resume Next
Sheets("FMC-Vybava").Select
If Cells(1, 3).Value = "DOE" Then
 ZACATEK = 4
Else
 ZACATEK = 3
End If
I = ZACATEK
POCETMODELU = 0
Do While Cells(1, I).Value <> ""
 POCETMODELU = POCETMODELU + 1
 I = I + Trim(Cells(1, I).Comment.Text)
Loop

I = ZACATEK
J = 0
ReDim INMERGE(POCETMODELU)
Do While Cells(1, I).Value <> ""
 x = Trim(Cells(1, I).Comment.Text)
 I = I + x
 INMERGE(J) = x
 J = J + 1
Loop

Application.DisplayAlerts = False
R = 4
Do While Range("A" & R).Value <> ""
ZAC = ZACATEK
For M = 0 To POCETMODELU - 1
 I = 0
 ZAC1 = ZAC
 HODNOTA = ""
 Do While I <= CInt(INMERGE(M)) - 1
   If Cells(R, ZAC1 + I).Value <> "" Then
    If HODNOTA <> "" Then
     HODNOTA = HODNOTA & " / " & Cells(R, ZAC1 + I).Value
    Else
     HODNOTA = Cells(R, ZAC1 + I).Value
    End If
   End If

  I = I + 1
 Loop
 XHODNOTA = Split(HODNOTA, " / ")
 LL = UBound(XHODNOTA)
 If LL > 1 Then
  For L = 0 To LL
   For N = L + 1 To LL
    If XHODNOTA(L) = XHODNOTA(N) Then
     XHODNOTA(N) = ""
    End If
   Next
  Next
 End If
 
 YHODNOTA = ""
 For L = 0 To LL
 If XHODNOTA(L) <> "" Then
  If YHODNOTA <> "" Then
   YHODNOTA = YHODNOTA & " / " & XHODNOTA(L)
  Else
   YHODNOTA = XHODNOTA(L)
  End If
 End If
 Next
 
 
 Cells(R, ZAC1).Value = YHODNOTA
 'Cells(R, ZAC1).AddComment YHODNOTA
 Range(Cells(R, ZAC1), Cells(R, ZAC1 + CInt(INMERGE(M)) - 1)).Select
 Selection.Merge (False)
 
 ZAC = ZAC + CInt(INMERGE(M))
Next
R = R + 1
Loop

ZAC = ZACATEK
For M = 0 To POCETMODELU - 1
 ZAC1 = ZAC
 Range(Cells(2, ZAC1), Cells(2, ZAC1 + CInt(INMERGE(M)) - 1)).Select
 'Selection.Clear
 Selection.Merge (False)
 Range(Cells(1, ZAC1), Cells(2, ZAC1 + CInt(INMERGE(M)) - 1)).Select
 Selection.Merge (False)
       With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
      With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
      End With
 ZAC = ZAC + CInt(INMERGE(M))
Next

'---posunuti loga a razitka
    PUBRADKU = Worksheets("Cover").Range("C15").Value
    PUBPOZNAMEK = Worksheets("Cover").Range("D15").Value
    PUBSLOUPKU = Worksheets("Cover").Range("E15").Value
    LEVO = Cells(PUBRADKU + PUBPOZNAMEK + 7, 4).Left + 35
    ODSHORA = Cells(PUBRADKU + PUBPOZNAMEK + 7, 4).Top
    ActiveSheet.Shapes("Image1").Top = ODSHORA
    ActiveSheet.Shapes("Image2").Top = ODSHORA
    ActiveSheet.Shapes("RAZITKO").Top = ODSHORA - 115

Range(Cells(3, 3), Cells(PUBRADKU, PUBSLOUPKU)).Select
Selection.ColumnWidth = 1


End Sub

Sub Kontrola()
'
' Kontrola Macro
' Macro recorded 24.1.2006 by jbartos1
'
On Error Resume Next
'--- tecka v modelovem roku
    Application.DisplayAlerts = False
    Worksheets("Cover").Select
    Range("C3").Select
    Selection.NumberFormat = "@"
    RPLWHAT = Range("C3").Value
    RPLTO = Replace(RPLWHAT, ",", ".")
    Range("C3").Value = RPLTO
    Application.DisplayAlerts = True
'--- udaje na Cover sheetu
EC = Range("B15").Value
MR = Range("C3").Value
DV = Range("C4").Value
DP = Range("C5").Value
DPV = Range("C6").Value
MZ = Range("C7").Value
MV = Range("C8").Value
MC = MV + MZ
DPH = Range("C10").Value
TC = Range("C11").Value

If DP <> "" And DPV <> "" Then MsgBox "Uved jenom bud 'Platnost od' nebo jenom 'Platnosti pro vozidla vyrobena od'. Ne oboje !!!"

M1 = "- Je Modelovy rok opravdu = " & MR & " ? " & vbCrLf
M2 = "- Je Datum vydani opravdu = " & DV & " ? " & vbCrLf
M2a = "- Je Datum platnosti opravdu = " & DP & " ? " & vbCrLf
M2b = "- Je Datum platnosti pro vozidla vyrobena od, opravdu = " & DPV & " ? " & vbCrLf
M3 = "- Je Zakladni marze opravdu = " & MZ & "% ? " & vbCrLf
M4 = "- Je variabilni marze opravdu = " & MV & "% ? " & vbCrLf
M5 = "- Je tedy celkova marze = " & MC & "% ? " & vbCrLf
M6 = "- Jsou ceny s DPH ? " & DPH & vbCrLf
MsgBox M1 & M2 & M2a & M2b & M3 & M4 & M5 & M6, vbCritical, "!!!!!!! ZKONTROLUJ !!!!!!!!"

'--- Vybava - MEMO ven
Worksheets("Vybava").Select
Application.DisplayAlerts = False

Columns("E:E").Select
With Selection
    Set C = .Find("MEMO", LookIn:=xlValues)
    If Not C Is Nothing Then
        firstAddress = C.Address
        Do
            C.Value = ""
            Set C = .FindNext(C)
            MsgBox "Nalezeno MEMO (Vybave / WERS) - smazano!"
        Loop While Not C Is Nothing And C.Address <> firstAddress
    End If
End With

'--- Kontrola modeloveho roku >> 2.znak v entite
Worksheets("Data").Select
Columns("S:S").Select
With Selection
    Set C = .Find(MR, LookIn:=xlValues)
    If Not C Is Nothing Then
        firstAddress = C.Address
        COL = Range(firstAddress).Column + 1
        RAD = Range(firstAddress).Row
        MYC = Right(Cells(RAD, COL).Value, 1)
'        MsgBox MYC
    End If
End With

Worksheets("Entity").Select
OKKO = "OK"
For R = 3 To EC + 2
 ENT = Mid(Cells(R, 20).Value, 2, 1)
 If ENT <> MYC Then
  OKKO = "KO"
  Cells(R, 20).Interior.Color = RGB(255, 0, 0)
 Else
  Cells(R, 20).Interior.Color = RGB(255, 255, 255)
 End If
Next
If OKKO = "KO" Then MsgBox "!!! Spatny modelovy rok v Entitach - cervene oznaceno !!!"
Application.DisplayAlerts = True

OKKO = "OK"
Worksheets("Vybava").Select
J = 9
I = 3
Do While Cells(2, J) <> ""
 I = 3
 Do While Cells(I, 1) <> ""
  If Cells(I, J).Value = "" Or Cells(I, J).Value <> "S" And Cells(I, J).Value <> "N" And Not IsNumeric(Cells(I, J).Value) Then
   Cells(I, J).Interior.Color = RGB(255, 0, 0)
   OKKO = "KO"
  Else
   Cells(I, J).Interior.Color = RGB(255, 255, 255)
  End If
  I = I + 1
 Loop
 J = J + 1
Loop
If OKKO = "KO" Then MsgBox "!!! Zkontroluj cenu ve vybave - cervene oznaceno !!!"

Worksheets("Cover").Select

End Sub



Attribute VB_Name = "Module2"

'Sub Verze()

'AUTOR = "J.Bartos" & vbCrLf
'VER = "verze 1.0 - 27.9.2007" & vbCrLf
'M1 = "--------------------------------" & vbCrLf
'M2 = "  FORD MOTOR COMPANY CZ  " & vbCrLf
'M3 = "  Cenik novych vozidel   " & vbCrLf
'M4 = "    - pro DMS            " & vbCrLf
'M5 = "    - zakaznicky         " & vbCrLf
'M6 = "--------------------------------" & vbCrLf

'MsgBox M1 & M2 & M3 & M4 & M5 & M6 & VER & AUTOR, vbInformation, "Info"
'End Sub

Function DMSmenu()

ThisWorkbook.Sheets("DATA").Unprotect "dms"

'---Menu
Set myMenuBar = CommandBars.ActiveMenuBar
Set newMenu = myMenuBar.Controls.Add(Type:=msoControlPopup, _
    Temporary:=True)
newMenu.Caption = "DMS Cenik"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Add ID"
ctrl1.TooltipText = "Spusti macro AddID"
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "AddID"

Set ctrl2 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl2.BeginGroup = True
ctrl2.Caption = "FMC_Cenik_Transit_M1M2"
ctrl2.TooltipText = "Spusti macro FMC_Cenik_Transit_M1M2"
ctrl2.Style = msoButtonCaption
ctrl2.OnAction = "FMC_Cenik_Transit_M1M2"

Set ctrl3 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl3.Caption = "FMC_Cenik_Transit_N1N2"
ctrl3.TooltipText = "Spusti macro FMC_Cenik_Transit_N1N2"
ctrl3.Style = msoButtonCaption
ctrl3.OnAction = "FMC_Cenik_Transit_N1N2"

Set ctrl4 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl4.Caption = "FMC_Cenik_Transit_Podvozky"
ctrl4.TooltipText = "Spusti macro FMC_Cenik_Transit_Podvozky"
ctrl4.Style = msoButtonCaption
ctrl4.OnAction = "FMC_Cenik_Transit_Podvozky"

Set ctrl5 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl5.Caption = "FMC_CenikOS"
ctrl5.TooltipText = "Spusti macro FMC_CenikOS"
ctrl5.Style = msoButtonCaption
ctrl5.OnAction = "FMC_CenikOS"

Set ctrl6 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl6.BeginGroup = True
ctrl6.Caption = "FMC_Vybava"
ctrl6.TooltipText = "Spusti macro FMC_Vybava"
ctrl6.Style = msoButtonCaption
ctrl6.OnAction = "FMC_Vybava"

Set ctrl7 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl7.Caption = "FMC_VybavaUsporna"
ctrl7.TooltipText = "Spusti macro FMC_VybavaUsporna"
ctrl7.Style = msoButtonCaption
ctrl7.OnAction = "FMC_VybavaUsporna"

Set ctrl8 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl8.BeginGroup = True
ctrl8.Caption = "Kontrola"
ctrl8.TooltipText = "Spusti macro Kontrola"
ctrl8.Style = msoButtonCaption
ctrl8.OnAction = "Kontrola"
 
'---VISTAINTERIORS---
Worksheets("Data").Select
I = 2
Do While Range("O" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C15:R" & I - 1 & "C15"
ActiveWorkbook.Names.Add Name:="VISTAINTERIORS", RefersToR1C1:=ROZSAH

'---VISTACOLOURS---
Worksheets("Data").Select
I = 2
Do While Range("Q" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C17:R" & I - 1 & "C17"
ActiveWorkbook.Names.Add Name:="VISTACOLOURS", RefersToR1C1:=ROZSAH

'---Potahy---
Worksheets("Data").Select
I = 2
Do While Range("A" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C1:R" & I - 1 & "C1"
ActiveWorkbook.Names.Add Name:="Potahy", RefersToR1C1:=ROZSAH

'---PotahyLookup---
Worksheets("Data").Select
I = 2
Do While Range("A" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C1:R" & I - 1 & "C2"
ActiveWorkbook.Names.Add Name:="PotahyLook", RefersToR1C1:=ROZSAH
Range("PotahyLook").Select
Selection.Sort Key1:=Range("A2"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal


'---BarvyPotahu---
Worksheets("Data").Select
I = 2
Do While Range("D" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C4:R" & I - 1 & "C4"
ActiveWorkbook.Names.Add Name:="BarvyPotahu", RefersToR1C1:=ROZSAH


'---BarvyPotahuLookup---
Worksheets("Data").Select
I = 2
Do While Range("D" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C4:R" & I - 1 & "C5"
ActiveWorkbook.Names.Add Name:="BarvyPotahuLook", RefersToR1C1:=ROZSAH
Range("BarvyPotahuLook").Select
Selection.Sort Key1:=Range("D2"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal

 
'---AUTA---
Worksheets("Data").Select
I = 2
Do While Range("L" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C12:R" & I - 1 & "C12"
ActiveWorkbook.Names.Add Name:="AUTA", RefersToR1C1:=ROZSAH
Range("AUTA").Select
'Selection.Sort Key1:=Range("L2"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal


'---MY---
Worksheets("Data").Select
I = 2
Do While Range("S" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C19:R" & I - 1 & "C19"
ActiveWorkbook.Names.Add Name:="MY", RefersToR1C1:=ROZSAH
  
'---Barvy---
Worksheets("Data").Select
I = 2
Do While Range("H" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C7:R" & I - 1 & "C8"
ActiveWorkbook.Names.Add Name:="Barvy", RefersToR1C1:=ROZSAH

'---BarvyLookUp---
Worksheets("Data").Select
I = 2
Do While Range("H" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Data!R2C7:R" & I - 1 & "C10"
ActiveWorkbook.Names.Add Name:="BarvyLook", RefersToR1C1:=ROZSAH
Range("BarvyLook").Select
Selection.Sort Key1:=Range("I2"), Order1:=xlAscending, Key2:=Range("G2") _
        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
        False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
        :=xlSortNormal

  
'---TMPEntity---
Worksheets("Entity").Select
I = 3
Do While Range("B" & I) <> ""
 I = I + 1
Loop
ROZSAH = "=Entity!R3C1:R" & I - 1 & "C17"
ActiveWorkbook.Names.Add Name:="TMPEntity", RefersToR1C1:=ROZSAH

ThisWorkbook.Sheets("DATA").Protect "dms"


End Function
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "LOGO, 31, 0, MSForms, Image"

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Application.WindowState = xlMaximized


 ThisWorkbook.Sheets("BarvyPotahy").Unprotect "dms"
 '---Zdroje pro validaci modelu
 MODELY = ThisWorkbook.Sheets("Entity").Cells(3, 1).Value
 I = 4
 Do While ThisWorkbook.Sheets("Entity").Cells(I, 1).Value <> ""
  JO = 0
  For J = 3 To I - 1
   If ThisWorkbook.Sheets("Entity").Cells(I, 1).Value = ThisWorkbook.Sheets("Entity").Cells(J, 1).Value Then
     JO = JO + 1
   End If
  Next
  If JO = 0 Then
   MODELY = MODELY & "," & ThisWorkbook.Sheets("Entity").Cells(I, 1).Value
  End If
  I = I + 1
 Loop
 Range("A1").Select
 With Selection.Validation
  .Delete
  .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
      xlBetween, Formula1:=MODELY
  .IgnoreBlank = True
  .InCellDropdown = True
  .InputTitle = ""
  .ErrorTitle = "Chyba"
  .InputMessage = ""
  .ErrorMessage = "Neexistujici model !!!"
  .ShowInput = True
  .ShowError = True
 End With
 '---Zdroje pro validaci Karoserii
 KASTLE = "ALL," & ThisWorkbook.Sheets("Entity").Cells(3, 16).Value
 I = 4
 Do While ThisWorkbook.Sheets("Entity").Cells(I, 16).Value <> ""
  JO = 0
  For J = 3 To I - 1
   If ThisWorkbook.Sheets("Entity").Cells(I, 16).Value = ThisWorkbook.Sheets("Entity").Cells(J, 16).Value Then
     JO = JO + 1
   End If
  Next
  If JO = 0 Then
   KASTLE = KASTLE & "," & ThisWorkbook.Sheets("Entity").Cells(I, 16).Value
  End If
  I = I + 1
 Loop
 
 Range("B1").Select
 With Selection.Validation
  .Delete
  .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
      xlBetween, Formula1:=KASTLE
  .IgnoreBlank = True
  .InCellDropdown = True
  .InputTitle = ""
  .ErrorTitle = "Chyba"
  .InputMessage = ""
  .ErrorMessage = "Neexistujici karoserie !!!"
  .ShowInput = True
  .ShowError = True
 End With
 
 '---Zdroj pro validaci potahu
 Range("C1").Select
  With Selection.Validation
  .Delete
  .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
      xlBetween, Formula1:="=Potahy"
  .IgnoreBlank = True
  .InCellDropdown = True
  .InputTitle = ""
  .ErrorTitle = "Chyba"
  .InputMessage = ""
  .ErrorMessage = "Neexistujici kod potahu !!!"
  .ShowInput = True
  .ShowError = True
 End With

 '---Zdroj pro validaci barvy potahu
 Range("E1").Select
  With Selection.Validation
  .Delete
  .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
      xlBetween, Formula1:="=BarvyPotahu"
  .IgnoreBlank = True
  .InCellDropdown = True
  .InputTitle = ""
  .ErrorTitle = "Chyba"
  .InputMessage = ""
  .ErrorMessage = "Neexistujici barva potahu !!!"
  .ShowInput = True
  .ShowError = True
 End With
 
 '---Zdroj pro lookup kodu potahu
 Range("D1").Select
 ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[-1],PotahyLook,2,FALSE)"

 '---Zdroj pro lookup barvy potahu
 Range("F1").Select
 ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[-1],BarvyPotahuLook,2,FALSE)"
 
 '---Zdroj pro VISTU
 
 Range("G5:G100").Select
   With Selection.Validation
  .Delete
  .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
      xlBetween, Formula1:="=VISTAINTERIORS"
  .IgnoreBlank = True
  .InCellDropdown = True
  .InputTitle = ""
  .ErrorTitle = "Chyba"
  .InputMessage = ""
  .ErrorMessage = "Neexistujici VISTA INTERIER !!!"
  .ShowInput = True
  .ShowError = True
 End With

 
 '---Model
 Range("A1").Select
 Selection.Copy
 Range("A5:A100").Select
 Selection.PasteSpecial Paste:=xlPasteValidation, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid
  '---karoserie
 Range("B1").Select
 Selection.Copy
 Range("B5:B100").Select
 Selection.PasteSpecial Paste:=xlPasteValidation, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid
  '---Kod Potahu
 Range("C1").Select
 Selection.Copy
 Range("C5:C100").Select
 Selection.PasteSpecial Paste:=xlPasteValidation, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid
 '---Potah
 Range("D1").Select
 Selection.Copy
 Range("D5:D100").Select
 Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid
'---Barva Potahu
 Range("E1").Select
 Selection.Copy
 Range("E5:E100").Select
 Selection.PasteSpecial Paste:=xlPasteValidation, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid
 '---Popis barvy Potahu
 Range("F1").Select
 Selection.Copy
 Range("F5:F100").Select
 Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid

 
 '---Barvy
 Range("G1").Select
 Selection.Copy
 Range("H5:BZ100").Select
 Selection.PasteSpecial Paste:=xlPasteValidation, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
 Application.Worksheets("BarvyPotahy").CircleInvalid

 
 Range("A2").Select
 ThisWorkbook.Sheets("BarvyPotahy").Protect "dms", True, True, True, False, True, True, True, False, True, False, False, True

End Sub


Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
On Error Resume Next
 Set fs = CreateObject("scripting.filesystemobject")
 Application.WindowState = xlMaximized
 CESTA = ThisWorkbook.Path
 If fs.fileexists(CESTA & "\" & "_DMS_data.xls") Then
  ThisWorkbook.Sheets("DATA").Unprotect "dms"
  Application.Workbooks.Open (CESTA & "\" & "_DMS_data.xls")
  Workbooks("_DMS_data.xls").Sheets("DATA").Activate
  Range("A1:T350").Select
  Selection.Copy
  ThisWorkbook.Sheets("DATA").Activate
  Range("A1").Activate
  'ActiveSheet.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
  Range("A1").PasteSpecial xlPasteValues
  Application.DisplayAlerts = False
  Application.Workbooks("_DMS_data.xls").Close
  Application.DisplayAlerts = True
  ThisWorkbook.Sheets("DATA").Protect "dms"
  Call DMSmenu
 End If
 
  
 ThisWorkbook.Sheets("Cover").Activate
 '----test prekopirovani kodu
  
 
 
End Sub




INQUEST-PP=macro
