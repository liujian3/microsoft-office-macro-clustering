Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub workbook_open()                                                             'Wenn die Datei ge|fffd|ffnet wird (Private Sub steht f|fffd|r ein Makro welches im Hintergrund l|fffd|uft)
Worksheets(1).Activate
Worksheets("Hinweis").Visible = False
MsgBox "Das Tool wurde erfolgreich gestartet." + vbCrLf + vbCrLf + vbCrLf + "Wenn Sie auf das Icon ""Info"" neben der Themen|fffd|berschrift klicken, bekommen Sie weitere Informationen.", vbInformation, "Herzlich Willkommen"         'Eine MessageBox geht auf "Inhalt", nur ne Info Box "Name der Box"
End Sub                                                                                 'Sub wird beendet

Private Sub Workbook_BeforeClose(Cancel As Boolean)

    Dim blnSave As Boolean
    
    Select Case MsgBox("Wollen Sie ihre |fffd|nderungen speichern?", vbQuestion Or vbYesNoCancel, "Speichern?")
        Case vbYes
            blnSave = True
        Case vbNo
            blnSave = False
        Case vbCancel
            Cancel = True
            Exit Sub
    End Select

Worksheets("Hinweis").Visible = True
Worksheets("Hinweis").Activate

    If blnSave Then
        Worksheets("Hinweis").Visible = True
        Worksheets("Hinweis").Activate
        Save
    Else
        Worksheets("Hinweis").Visible = True
        Worksheets("Hinweis").Activate
        Saved = True
    End If
    
End Sub
Private Sub Active_sheet()
ActiveSheet.DisplayAutomaticPageBreaks = True
End Sub

'Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

'MsgBox "Bitte Speichern Sie die Datei immer als folgenden Dateityp ab:""Excel 97-2003 Arbeitsblatt""" + vbCrLf + vbCrLf + vbCrLf + "Als Vorgabe zur Dateibezeichnung gilt: ""WE-Nummer_Jahr_Monat_Tag_....."""
'End Sub




Attribute VB_Name = "Drucken"
Sub Druckbutton_AInhalt()                   'Druckbutton-Makro (Name)

With ActiveSheet.PageSetup                  'Mit folgenden settings (aktives Tabellenblatt)
  .PrintArea = "$A$6:$D$19"                 'Druckbereich von A1 bis J33
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False                   'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
End With                                    'Settings Ende
Application.Dialogs(xlDialogPrint).Show     'Dass DruckFenster angezeigt wird
ActiveSheet.PageSetup.PrintArea = False     'L|fffd|scht voreingestellte StandardDrucksettings
  
End Sub

Sub Druckbutton_BEinfuehrung()              'Druckbutton-Makro (Name)

With ActiveSheet.PageSetup                  'Mit folgenden settings (aktives Tabellenblatt)
  .PrintArea = "$A$6:$D$20"                 'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = 1
End With                                    'Settings Ende
Application.Dialogs(xlDialogPrint).Show     'Dass DruckFenster angezeigt wird
ActiveSheet.PageSetup.PrintArea = False     'L|fffd|scht voreingestellte StandardDrucksettings
  
End Sub

Sub Druckbutton_CUnternehmensangaben()      'Druckbutton-Makro (Name)

With ActiveSheet.PageSetup                  'Mit folgenden settings (aktives Tabellenblatt)
  .PrintArea = "$A$6:$D$15"                 'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                 'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
End With                                    'Settings Ende
Application.Dialogs(xlDialogPrint).Show     'Dass DruckFenster angezeigt wird

  
End Sub

Sub Druckbutton_IAllgemeines()

With ActiveSheet.PageSetup
  .PrintArea = "$A$6:$H$33"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
  
End With
Application.Dialogs(xlDialogPrint).Show
ActiveSheet.PageSetup.PrintArea = False
  
End Sub


Sub Druckbutton_IIArbeitsplatz()            'Druckbutton-Makro (Name)

End With
With ActiveSheet.PageSetup
  .PrintArea = "$A$6:$H$47"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
  
End With
Application.Dialogs(xlDialogPrint).Show
ActiveSheet.PageSetup.PrintArea = False
  
End Sub

Sub Druckbutton_IIIGemeinwesen()            'Druckbutton-Makro (Name)

End With
With ActiveSheet.PageSetup
  .PrintArea = "$A$6:$H$17"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
  
End With
Application.Dialogs(xlDialogPrint).Show
ActiveSheet.PageSetup.PrintArea = False
  
  
End Sub

Sub Druckbutton_IVUmwelt()                 'Druckbutton-Makro (Name)

End With
With ActiveSheet.PageSetup
  .PrintArea = "$A$6:$H$33"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
  
End With
Application.Dialogs(xlDialogPrint).Show
ActiveSheet.PageSetup.PrintArea = False
  
End Sub

Sub Druckbutton_VMarkt()                    'Druckbutton-Makro (Name)

With ActiveSheet.PageSetup                  'Mit folgenden settings (aktives Tabellenblatt)
  .PrintArea = "$A$6:$H$39"                'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
  
  End With                                    'Settings Ende
Application.Dialogs(xlDialogPrint).Show     'Dass DruckFenster angezeigt wird
ActiveSheet.PageSetup.PrintArea = False     'L|fffd|scht voreingestellte StandardDrucksettings
  
End Sub

Sub Druckbutton_DAuswertungsbogen()         'Druckbutton-Makro (Name)

With ActiveSheet.PageSetup                  'Mit folgenden settings (aktives Tabellenblatt)
  .PrintArea = "$A$6:$F$134"                'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
  
  End With                                  'Settings Ende
Application.Dialogs(xlDialogPrint).Show     'Dass DruckFenster angezeigt wird
ActiveSheet.PageSetup.PrintArea = False     'L|fffd|scht voreingestellte StandardDrucksettings

End Sub


'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'#########################################################################################################
'Sub DruckenVieleTabellen()
'Sheets(Array("Tabelle1", "Tabelle9", "Tabelle56")).PrintOut Copies:=1
'Sheets("Tabelle25").PrintOut Copies:=16
'.CenterVertically = True
'----------------------------------------
'----------------------------------------
'----------------------------------------
Sub Gesamtes_tool_Drucken()
'----------------------------------------
With Sheets("A. Inhalt").PageSetup
               .PrintArea = "$A$6:$D$19"                 'Druckbereich von A1 bis J33
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("B. Einf|fffd|hrung").PageSetup
             .PrintArea = "$A$6:$D$20"                 'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = 1
        End With
With Sheets("C. Unternehmensangaben").PageSetup
              .PrintArea = "$A$6:$D$15"                 'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                 'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("I. Allgemeines").PageSetup
 .PrintArea = "$A$6:$H$33"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("II. Arbeitsplatz").PageSetup
      .PrintArea = "$A$6:$H$47"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("III. Gemeinwesen").PageSetup
                .PrintArea = "$A$6:$H$17"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("IV. Umwelt").PageSetup
            .PrintArea = "$A$6:$H$33"
  .Orientation = xlLandscape
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("V. Markt").PageSetup
                 .PrintArea = "$A$6:$H$39"                'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
With Sheets("D. Auswertungsbogen").PageSetup
               .PrintArea = "$A$6:$F$134"                'Druckbereich von A1 bis J33
  .Orientation = xlLandscape                'Orientation = Hoch oder Querformat ==> xlLandscape = Querformat ==> xlPortrait = Hochformat
  .Zoom = False
  .FitToPagesWide = 1
  .FitToPagesTall = False
        End With
Sheets(Array("A. Inhalt", "B. Einf|fffd|hrung", "C. Unternehmensangaben", "I. Allgemeines", "II. Arbeitsplatz", "III. Gemeinwesen", "IV. Umwelt", "V. Markt", "D. Auswertungsbogen")).PrintPreview

End Sub








  


Attribute VB_Name = "Ein_Aus_Blenden"
Sub Verantowrtung_Einblenden()
Sheets("I. Allgemeines").Unprotect "arqum1"
Sheets("I. Allgemeines").Rows("11:16").Hidden = False
Sheets("I. Allgemeines").Protect "arqum1"
End Sub

Sub Verantowrtung_Ausblenden()
Sheets("I. Allgemeines").Unprotect "arqum1"
Sheets("I. Allgemeines").Rows("11:16").Hidden = True
Sheets("I. Allgemeines").Protect "arqum1"
End Sub

Sub Orga_Einblenden()
Sheets("I. Allgemeines").Unprotect "arqum1"
Sheets("I. Allgemeines").Rows("20:26").Hidden = False
Sheets("I. Allgemeines").Protect "arqum1"
End Sub
Sub Orga_Ausblenden()
Sheets("I. Allgemeines").Unprotect "arqum1"
Sheets("I. Allgemeines").Rows("20:26").Hidden = True
Sheets("I. Allgemeines").Protect "arqum1"
End Sub
Sub Anwendung_Einblenden()
Sheets("I. Allgemeines").Unprotect "arqum1"
Sheets("I. Allgemeines").Rows("29:33").Hidden = False
Sheets("I. Allgemeines").Protect "arqum1"
End Sub
Sub Anwendung_Ausblenden()
Sheets("I. Allgemeines").Unprotect "arqum1"
Sheets("I. Allgemeines").Rows("29:33").Hidden = True
Sheets("I. Allgemeines").Protect "arqum1"
End Sub
'######ARBEITSPLATZ###########################################################
Sub Arbeitsbedingungen_Einblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("11:13").Hidden = False
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Arbeitsbedingungen_Ausblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("11:13").Hidden = True
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub
Sub Besch|fffd|ftigung_Einblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("18:25").Hidden = False
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Besch|fffd|ftigung_Ausblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("18:25").Hidden = True
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub


Sub Weiterentwicklung_Einblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("27:28").Hidden = False
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Weiterentwicklung_Ausblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("27:28").Hidden = True
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Inkl_Einblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("30:40").Hidden = False
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Inkl_Ausblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("30:40").Hidden = True
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Gesund_Einblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("42:48").Hidden = False
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub

Sub Gesund_Ausblenden()
Sheets("II. Arbeitsplatz").Unprotect "arqum1"
Sheets("II. Arbeitsplatz").Rows("42:48").Hidden = True
Sheets("II. Arbeitsplatz").Protect "arqum1"
End Sub
Sub Ausblenden_Einflussbereich()
Sheets("III. Gemeinwesen").Unprotect "arqum1"
Sheets("III. Gemeinwesen").Rows("11:12").Hidden = True
Sheets("III. Gemeinwesen").Protect "arqum1"
End Sub
Sub Einblenden_Einflussbereich()
Sheets("III. Gemeinwesen").Unprotect "arqum1"
Sheets("III. Gemeinwesen").Rows("11:12").Hidden = False
Sheets("III. Gemeinwesen").Protect "arqum1"
End Sub

Sub Ausblenden_Einflussbereich_Gesamt()
Sheets("III. Gemeinwesen").Unprotect "arqum1"
Sheets("III. Gemeinwesen").Rows("14:17").Hidden = True
Sheets("III. Gemeinwesen").Protect "arqum1"
End Sub
Sub Einblenden_Einflussbereich_Gesamt()
Sheets("III. Gemeinwesen").Unprotect "arqum1"
Sheets("III. Gemeinwesen").Rows("14:17").Hidden = False
Sheets("III. Gemeinwesen").Protect "arqum1"
End Sub

Sub Ressourcen_Einblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("11:18").Hidden = False
Sheets("IV. Umwelt").Protect "arqum1"
End Sub

Sub Ressourcen_Ausblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("11:18").Hidden = True
Sheets("IV. Umwelt").Protect "arqum1"
End Sub

Sub UBelastung_Einblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("20:23").Hidden = False
Sheets("IV. Umwelt").Protect "arqum1"
End Sub

Sub UBelastung_Ausblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("20:23").Hidden = True
Sheets("IV. Umwelt").Protect "arqum1"
End Sub

Sub Mobilit|fffd|t_Einblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("25:29").Hidden = False
Sheets("IV. Umwelt").Protect "arqum1"
End Sub
Sub Mobili|fffd|t_Ausblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("25:29").Hidden = True
Sheets("IV. Umwelt").Protect "arqum1"
End Sub
Sub Umgebung_Einblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("31:33").Hidden = False
Sheets("IV. Umwelt").Protect "arqum1"
End Sub
Sub Umgebung_Ausblenden()
Sheets("IV. Umwelt").Unprotect "arqum1"
Sheets("IV. Umwelt").Rows("31:33").Hidden = True
Sheets("IV. Umwelt").Protect "arqum1"
End Sub


'#####MARKT#########################################################

Sub Transparenz_Einblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("11:14").Hidden = False
Sheets("V. Markt").Protect "arqum1"
End Sub
Sub Transparenz_Ausblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("11:14").Hidden = True
Sheets("V. Markt").Protect "arqum1"
End Sub

Sub IntTatigkeiten_Einblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("16:20").Hidden = False
Sheets("V. Markt").Protect "arqum1"
End Sub
Sub IntTatigkeiten_Ausblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("16:20").Hidden = True
Sheets("V. Markt").Protect "arqum1"
End Sub

Sub Beschaffung_Einblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("22:24").Hidden = False
Sheets("V. Markt").Protect "arqum1"
End Sub
Sub Beschaffung_Ausblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("22:24").Hidden = True
Sheets("V. Markt").Protect "arqum1"
End Sub

Sub Produkt_Einblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("26:31").Hidden = False
Sheets("V. Markt").Protect "arqum1"
End Sub
Sub Produkt_Ausblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("26:31").Hidden = True
Sheets("V. Markt").Protect "arqum1"
End Sub

Sub Konsumenten_Einblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("34:39").Hidden = False
Sheets("V. Markt").Protect "arqum1"
End Sub
Sub Konsumenten_Ausblenden()
Sheets("V. Markt").Unprotect "arqum1"
Sheets("V. Markt").Rows("34:39").Hidden = True
Sheets("V. Markt").Protect "arqum1"
End Sub
'########################################################################################################################
Sub AUFLISTUNG_EIN()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Rows("23:23").Hidden = False
Sheets("D. Auswertungsbogen").Rows("44:44").Hidden = False
Sheets("D. Auswertungsbogen").Rows("77:77").Hidden = False
Sheets("D. Auswertungsbogen").Rows("86:86").Hidden = False
Sheets("D. Auswertungsbogen").Rows("109:109").Hidden = False
UserForm1.Show
Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub
Sub AUFLISTUNG_AUS()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Rows("23:133").Hidden = True
Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub
Sub Unternehmen_EIN()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Rows("8:15").Hidden = False
Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub
Sub Unternehmen_AUS()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Rows("8:15").Hidden = True
Sheets("D. Auswertungsbogen").Protect "arqum1"
Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub

Sub Statistik_EIN()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Rows("17:21").Hidden = False
Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub
Sub Statistik_AUS()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"
Sheets("D. Auswertungsbogen").Rows("17:21").Hidden = True
Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub
Attribute VB_Name = "MAKROS"
Sub Alle_X_wegI()
If MsgBox("Sind Sie sicher, dass alle Antworten im aktuellen Themenblock zur|fffd|ckgesetzt werden sollen?", vbInformation + vbOKCancel, "Sicherheitsabfrage") = vbOK Then
Worksheets("I. Allgemeines").Range("B11:E16").Value = ""
Worksheets("I. Allgemeines").Range("B20:E26").Value = ""
Worksheets("I. Allgemeines").Range("B29:E33").Value = ""
MsgBox "Es wurden alle Antwortm|fffd|glichkeiten auf ""noch nicht beantwortet"" gesetzt.", vbInformation + vbOKOnly, "Vorgang erfolgreich durchgef|fffd|hrt"
Else
Exit Sub
End If
End Sub

Sub Alle_X_wegII()
If MsgBox("Sind Sie sicher, dass alle Antworten im aktuellen Themenblock zur|fffd|ckgesetzt werden sollen?", vbInformation + vbOKCancel, "Sicherheitsabfrage") = vbOK Then
Worksheets(5).Range("B11:E13").Value = ""
Worksheets(5).Range("B18:E25").Value = ""
Worksheets(5).Range("B27:E28").Value = ""
Worksheets(5).Range("B30:E40").Value = ""
Worksheets(5).Range("B42:E48").Value = ""
MsgBox "Es wurden alle Antwortm|fffd|glichkeiten auf ""noch nicht beantwortet"" gesetzt.", vbInformation + vbOKOnly, "Vorgang erfolgreich durchgef|fffd|hrt"
Else
Exit Sub
End If
End Sub

Sub Alle_X_wegIII()
If MsgBox("Sind Sie sicher, dass alle Antworten im aktuellen Themenblock zur|fffd|ckgesetzt werden sollen?", vbInformation + vbOKCancel, "Sicherheitsabfrage") = vbOK Then
Worksheets(6).Range("B11:E12").Value = ""
Worksheets(6).Range("B14:E17").Value = ""
MsgBox "Es wurden alle Antwortm|fffd|glichkeiten auf ""noch nicht beantwortet"" gesetzt.", vbInformation + vbOKOnly, "Vorgang erfolgreich durchgef|fffd|hrt"
Else
Exit Sub
End If
End Sub

Sub Alle_X_wegIV()
If MsgBox("Sind Sie sicher, dass alle Antworten im aktuellen Themenblock zur|fffd|ckgesetzt werden sollen?", vbInformation + vbOKCancel, "Sicherheitsabfrage") = vbOK Then
Worksheets(7).Range("B11:E18").Value = ""
Worksheets(7).Range("B20:E23").Value = ""
Worksheets(7).Range("B25:E29").Value = ""
Worksheets(7).Range("B31:E33").Value = ""
MsgBox "Es wurden alle Antwortm|fffd|glichkeiten auf ""noch nicht beantwortet"" gesetzt.", vbInformation + vbOKOnly, "Vorgang erfolgreich durchgef|fffd|hrt"
Else
Exit Sub
End If
End Sub


Sub Alle_X_wegV()
If MsgBox("Sind Sie sicher, dass alle Antworten im aktuellen Themenblock zur|fffd|ckgesetzt werden sollen?", vbInformation + vbOKCancel, "Sicherheitsabfrage") = vbOK Then
Worksheets(8).Range("B11:E14").Value = ""
Worksheets(8).Range("B16:E20").Value = ""
Worksheets(8).Range("B22:E24").Value = ""
Worksheets(8).Range("B26:E31").Value = ""
Worksheets(8).Range("B34:E39").Value = ""
MsgBox "Es wurden alle Antwortm|fffd|glichkeiten auf ""noch nicht beantwortet"" gesetzt.", vbInformation + vbOKOnly, "Vorgang erfolgreich durchgef|fffd|hrt"
Else
Exit Sub
End If
End Sub


Sub InfoButton_AInhalt()
MsgBox "Die Inhalts|fffd|bersicht dient zur schnellen Navigation zwischen den einzelnen Seiten." + vbCrLf + vbCrLf + "Die Navigation ist auch |fffd|ber die Reiterauswahl von Excel, sowie |fffd|ber die Navigationselemente ""zur|fffd|ck"" und ""weiter"" m|fffd|glich.", vbInformation + vbOKOnly, "Hilfe"
End Sub

Sub InfoButton_CUnternehmensangaben()
MsgBox "Bitte geben Sie hier alle relevanten Informationen zu Ihrem Unternehmen an.", vbInformation + vbOKOnly, "Hilfe"
End Sub

Sub InfoButton_I_V()
MsgBox "Mit Klick auf den Button ""Interessiert mich"" werden Ihnen die jeweiligen Fragen der einzelnen Themenbereiche angezeigt." + vbCrLf + "Mit dem Button ""Ausblenden"" wird der einzelne Themenbereich wieder ausgeblendet." + vbCrLf + "Auch wenn ein Themenbereich ausgeblendet wurde, werden die darin beantworteten Fragen in der Auswertung ber|fffd|cksichtigt." + vbCrLf + vbCrLf + "Sie haben bei der Beantwortung jeder Frage die M|fffd|glichkeit, zwischen ""erf|fffd|llt"", ""nicht erf|fffd|llt"", ""teilweise erf|fffd|llt/in Bearbeitung"" oder ""nicht relevant"" zu w|fffd|hlen." + vbCrLf + "Sie halten Ihre Antwort fest, indem Sie ein ""x"" in das jeweilige Feld setzen. Beachten Sie dabei bitte, dass es sich um das ""kleine x"" handeln muss.", vbInformation + vbOKOnly, "Hilfe zur Beantwortung der Fragen"
End Sub

Sub InfoButton_Auswertung()
MsgBox "Bitte klicken Sie auf den Button ""Auswertung starten!"", damit Ihre Eingaben aktualisiert werden.", vbInformation + vbOKOnly, "Hilfe zur Beantwortung der Fragen"
End Sub

Sub Auswertung_Starten()
UserForm1.Show
End Sub

Attribute VB_Name = "Modul2"
Sub Umbrueche_weg()
Attribute Umbrueche_weg.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Umbrueche_weg Makro
'

'
    ActiveWindow.SmallScroll Down:=24
    ActiveSheet.ResetAllPageBreaks
    ActiveWindow.SmallScroll Down:=-12
End Sub
Attribute VB_Name = "Navigation"
Sub Navigation_Inhalts|fffd|bersicht()
Worksheets("A. Inhalt").Activate
End Sub

Sub Navigation_Einf|fffd|hrung()
Worksheets("B. Einf|fffd|hrung").Activate
End Sub

Sub Navigation_Unternehmensangaben()
Worksheets("C. Unternehmensangaben").Activate
End Sub

Sub Navigation_Allgemeines()
Worksheets("I. Allgemeines").Activate
End Sub

Sub Navigation_Arbeitsplatz()
Worksheets("II. Arbeitsplatz").Activate
End Sub

Sub Navigation_Gemeinwesen()
Worksheets("III. Gemeinwesen").Activate
End Sub

Sub Navigation_Umwelt()
Worksheets("IV. Umwelt").Activate
End Sub

Sub Navigation_Markt()
Worksheets("V. Markt").Activate
End Sub

Sub Navigation_Auswertungsbogen()
Worksheets("D. Auswertungsbogen").Activate
End Sub

Sub Navigation_vorw|fffd|rts()
ActiveSheet.Next.Activate
End Sub

Sub Navigation_r|fffd|ckw|fffd|rts()
Dim ws As Worksheet
Set ws = ActiveSheet
Do Until ws.Previous Is Nothing
Set ws = ws.Previous
If ws.Visible = xlSheetVisible Then
ws.Activate
Exit Do
End If
Loop
End Sub
Attribute VB_Name = "TEST_Auswertung_X"
Sub Auswertung_TEST()

Dim Tabb, ZeileE, ZeileAuswertung, XFehler, x As Integer
ZeileAuswertung = 24
XFehler = 0
For Tabb = 4 To 8 Step 1
    If Tabb = 4 Then
    ZeileAuswertung = 24
    ElseIf Tabb = 5 Then
    ZeileAuswertung = 45
    ElseIf Tabb = 6 Then
    ZeileAuswertung = 78
    ElseIf Tabb = 7 Then
    ZeileAuswertung = 87
    ElseIf Tabb = 8 Then
    ZeileAuswertung = 110
    End If
For ZeileE = 11 To 50 Step 1
    If Worksheets(Tabb).Cells(ZeileE, 10).Value > 1 Then
    XFehler = XFehler + 1
    End If
    If Worksheets(Tabb).Cells(ZeileE, 1).Value = "" Then
    ZeileAuswertung = ZeileAuswertung - 1
    ElseIf Worksheets(Tabb).Cells(ZeileE, 2).Value = "" And Worksheets(Tabb).Cells(ZeileE, 3).Value = "" And Worksheets(Tabb).Cells(ZeileE, 4).Value = "" And Worksheets(Tabb).Cells(ZeileE, 5).Value = "" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = "nicht beantwortet"
    ElseIf Worksheets(Tabb).Cells(ZeileE, 2).Value = "x" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = "erf|fffd|llt"
    ElseIf Worksheets(Tabb).Cells(ZeileE, 3).Value = "x" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = Worksheets(Tabb).Cells(ZeileE, 9).Value
    ElseIf Worksheets(Tabb).Cells(ZeileE, 4).Value = "x" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = Worksheets(Tabb).Cells(ZeileE, 9).Value
    ElseIf Worksheets(Tabb).Cells(ZeileE, 5).Value = "x" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = "nicht relevant"
    
    End If
ZeileAuswertung = ZeileAuswertung + 1
Next ZeileE

Next Tabb
If XFehler > 0 Then
MsgBox "Bei der Beantwortung von " & XFehler & " Fragen, wurde eine Doppelantwort gegeben." + vbCrLf + vbCrLf + "Bitte korrigieren Sie die Fehleingabe.", vbInformation + vbOKOnly, "Doppelbeantwortung"
End If
End Sub






If CheckBox1.Value = True Then 'erf|fffd|llt
'####ERF|fffd|LLT############################################################################################################################
Dim I, Tab1, WV, ZE, PLATZ As Integer

For Tab1 = 4 To 8 Step 1
WV = Worksheets(Tab1).OLEObjects.Count
    If Tab1 = 4 Then
    PLATZ = 24
    ElseIf Tab1 = 5 Then
    PLATZ = 45
    ElseIf Tab1 = 6 Then
    PLATZ = 79
    ElseIf Tab1 = 7 Then
    PLATZ = 88
    ElseIf Tab1 = 8 Then
    PLATZ = 111
    End If
For I = 1 To WV Step 4
    If Worksheets(Tab1).Shapes("OptionButton" & I).DrawingObject.Object.Value = True Then
    ZE = Worksheets(Tab1).Shapes("OptionButton" & I).TopLeftCell.Row

    Worksheets("D. Auswertungsbogen").Cells(PLATZ, 2).Value = "Erf|fffd|llt"
    Worksheets("D. Auswertungsbogen").Cells(PLATZ, 5).Value = Worksheets(Tab1).Cells(ZE, 7)
    Worksheets("D. Auswertungsbogen").Rows(PLATZ).Hidden = False

    End If
    PLATZ = PLATZ + 1
Next I
Next Tab1
End If



If CheckBox2.Value = True Then 'nicht erf|fffd|llt
'####NICHT erf|fffd|llt############################################################################################################################
Dim I2, Tab2, WV2, ZE2, PLATZ2 As Integer

For Tab2 = 4 To 8 Step 1
WV2 = Worksheets(Tab2).OLEObjects.Count
    If Tab2 = 4 Then
    PLATZ2 = 24
    ElseIf Tab2 = 5 Then
    PLATZ2 = 45
    ElseIf Tab2 = 6 Then
    PLATZ2 = 79
    ElseIf Tab2 = 7 Then
    PLATZ2 = 88
    ElseIf Tab2 = 8 Then
    PLATZ2 = 111
    End If
For I2 = 2 To WV2 Step 4
    If Worksheets(Tab2).Shapes("OptionButton" & I2).DrawingObject.Object.Value = True Then
    ZE2 = Worksheets(Tab2).Shapes("OptionButton" & I2).TopLeftCell.Row

    Worksheets("D. Auswertungsbogen").Cells(PLATZ2, 2).Value = Worksheets(Tab2).Cells(ZE2, 9).Value
    Worksheets("D. Auswertungsbogen").Cells(PLATZ2, 5).Value = Worksheets(Tab2).Cells(ZE2, 7)
    Worksheets("D. Auswertungsbogen").Rows(PLATZ2).Hidden = False

    End If
    PLATZ2 = PLATZ2 + 1
Next I2
Next Tab2
End If


If CheckBox3.Value = True Then 'teilweise erf|fffd|llt
'####TEILWEISE erf|fffd|llt############################################################################################################################
Dim I3, Tab3, WV3, ZE3, PLATZ3 As Integer

For Tab3 = 4 To 8 Step 1
WV3 = Worksheets(Tab3).OLEObjects.Count
    If Tab3 = 4 Then
    PLATZ3 = 24
    ElseIf Tab3 = 5 Then
    PLATZ3 = 45
    ElseIf Tab3 = 6 Then
    PLATZ3 = 79
    ElseIf Tab3 = 7 Then
    PLATZ3 = 88
    ElseIf Tab3 = 8 Then
    PLATZ3 = 111
    End If
For I3 = 3 To WV3 Step 4
    If Worksheets(Tab3).Shapes("OptionButton" & I3).DrawingObject.Object.Value = True Then
    ZE3 = Worksheets(Tab3).Shapes("OptionButton" & I3).TopLeftCell.Row
    Worksheets("D. Auswertungsbogen").Cells(PLATZ3, 2).Value = Worksheets(Tab3).Cells(ZE3, 9).Value
    Worksheets("D. Auswertungsbogen").Cells(PLATZ3, 5).Value = Worksheets(Tab3).Cells(ZE3, 7)
    Worksheets("D. Auswertungsbogen").Rows(PLATZ3).Hidden = False

    End If
    PLATZ3 = PLATZ3 + 1
Next I3
Next Tab3
End If


If CheckBox4.Value = True Then 'nicht relevant
'####Nicht relevant############################################################################################################################
Dim I4, Tab4, WV4, ZE4, PLATZ4 As Integer

For Tab4 = 4 To 8 Step 1
WV4 = Worksheets(Tab4).OLEObjects.Count
    If Tab4 = 4 Then
    PLATZ4 = 24
    ElseIf Tab4 = 5 Then
    PLATZ4 = 45
    ElseIf Tab4 = 6 Then
    PLATZ4 = 79
    ElseIf Tab4 = 7 Then
    PLATZ4 = 88
    ElseIf Tab4 = 8 Then
    PLATZ4 = 111
    End If
For I4 = 4 To WV4 Step 4
    If Worksheets(Tab4).Shapes("OptionButton" & I4).DrawingObject.Object.Value = True Then
    ZE4 = Worksheets(Tab4).Shapes("OptionButton" & I4).TopLeftCell.Row
    Worksheets("D. Auswertungsbogen").Cells(PLATZ4, 2).Value = "Nicht relevant"
    Worksheets("D. Auswertungsbogen").Cells(PLATZ4, 5).Value = Worksheets(Tab4).Cells(ZE4, 7)
    Worksheets("D. Auswertungsbogen").Rows(PLATZ4).Hidden = False

    End If
    PLATZ4 = PLATZ4 + 1
Next I4
Next Tab4
End If


Tabelle30.Protect "arqum1"
Unload Me
End Sub























































If CheckBox1.Value = False And CheckBox2.Value = False And CheckBox3.Value = False And CheckBox4.Value = False Then
MsgBox "Bitte w|fffd|hlen Sie mindestens einen Punkt aus", vbCritical + vbOKOnly, "Es wurde keine Auswahl getroffen!"
Exit Sub
End If
sec_ = 1.5
Set DeinMsg = CreateObject("WScript.Shell")
DeinMsg.Popup "Die Auswertung der Checkliste wird nun erfolgen." + vbCrLf + "Dieser Vorgang kann bis zu 30 Sekunden ben|fffd|tigen." + vbCrLf + vbCrLf + "Bitte haben Sie etwas Geduld.", sec_, _
                 "Auswertung wird nun gestartet", 64



Tabelle30.Unprotect "arqum1"
'#######################################
'#######################################
'#######################################
'#######################################
'#######################################
'#######################################
'STATISTIK               ################
'####Erf|fffd|llt#############################

Dim Nummer5, Anzahl5, Tab5, WV5, G5 As Integer
G5 = 0
Anzahl5 = 0

For Tab5 = 4 To 8 Step 1
WV5 = Worksheets(Tab5).OLEObjects.Count
For Nummer5 = 1 To WV5 Step 4
If Worksheets(Tab5).Shapes("OptionButton" & Nummer5).DrawingObject.Object.Value = True Then
Anzahl5 = Anzahl5 + 1
End If
Next Nummer5
G5 = G5 + WV5
Next Tab5


Worksheets("D. Auswertungsbogen").Cells(17, 2).Value = Anzahl5


'####NICHT Erf|fffd|llt#############################
Dim Nummer6, Anzahl6, Tab6, WV6, G6 As Integer
G6 = 0
Anzahl6 = 0

For Tab6 = 4 To 8 Step 1
WV6 = Worksheets(Tab6).OLEObjects.Count
For Nummer6 = 2 To WV6 Step 4
If Worksheets(Tab6).Shapes("OptionButton" & Nummer6).DrawingObject.Object.Value = True Then
Anzahl6 = Anzahl6 + 1
End If
Next Nummer6
G6 = G6 + WV6
Next Tab6


Worksheets("D. Auswertungsbogen").Cells(18, 2).Value = Anzahl6


'####Teilweise Erf|fffd|llt#############################
Dim Nummer7, Anzahl7, Tab7, WV7, G7 As Integer
G7 = 0
Anzahl7 = 0

For Tab7 = 4 To 8 Step 1
WV7 = Worksheets(Tab7).OLEObjects.Count
For Nummer7 = 3 To WV7 Step 4
If Worksheets(Tab7).Shapes("OptionButton" & Nummer7).DrawingObject.Object.Value = True Then
Anzahl7 = Anzahl7 + 1
End If
Next Nummer7
G7 = G7 + WV7
Next Tab7


Worksheets("D. Auswertungsbogen").Cells(19, 2).Value = Anzahl7


'####Nicht relevant#############################
Dim Nummer8, Anzahl8, Tab8, WV8, G8 As Integer
G8 = 0
Anzahl8 = 0

For Tab8 = 4 To 8 Step 1
WV8 = Worksheets(Tab8).OLEObjects.Count
For Nummer8 = 4 To WV8 Step 4
If Worksheets(Tab8).Shapes("OptionButton" & Nummer8).DrawingObject.Object.Value = True Then
Anzahl8 = Anzahl8 + 1
End If
Next Nummer8
G8 = G8 + WV8
Next Tab8


Worksheets("D. Auswertungsbogen").Cells(20, 2).Value = Anzahl8


'####Anzahl nicht beantworteter Fragen#############################

Worksheets("D. Auswertungsbogen").Cells(18, 3).Value = G5 / 4
Worksheets("D. Auswertungsbogen").Cells(19, 3).Value = (G5 / 4) - (Anzahl5 + Anzahl6 + Anzahl7 + Anzahl8)
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(4).ScrollArea = "A1:I33"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub


Attribute VB_Name = "Tabelle14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(1).ScrollArea = "A1:D17"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(2).ScrollArea = "A1:D18"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(8).ScrollArea = "A1:H39"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(5).ScrollArea = "A1:H48"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(9).ScrollArea = "A1:F134"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(6).ScrollArea = "A1:H17"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(7).ScrollArea = "A1:H33"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
End Sub

Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Worksheets(3).ScrollArea = "A1:D15"
ActiveSheet.PageSetup.PrintArea = ""
ActiveSheet.ResetAllPageBreaks
Cells(8, 4).Select
End Sub

Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
ActiveSheet.PageSetup.PrintArea = ""
End Sub

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{C3C5E1AD-D753-4008-97A1-00DAFDA4B17A}{8108962B-B553-4B03-8928-362522AC1306}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Sheets("D. Auswertungsbogen").Unprotect "arqum1"

sec_ = 1.1
Set DeinMsg = CreateObject("WScript.Shell")
DeinMsg.Popup "Die Auswertung der Checkliste wird nun erfolgen." + vbCrLf + "Dieser Vorgang kann bis zu 30 Sekunden ben|fffd|tigen." + vbCrLf + vbCrLf + "Bitte haben Sie etwas Geduld.", sec_, _
                 "Auswertung wird nun gestartet", 64

'####AUSWERTUNG############################################################################################################################
'####AUSWERTUNG############################################################################################################################
'####AUSWERTUNG############################################################################################################################
'####AUSWERTUNG############################################################################################################################
'####AUSWERTUNG############################################################################################################################
'####AUSWERTUNG############################################################################################################################
'####AUSWERTUNG############################################################################################################################
Worksheets("D. Auswertungsbogen").Rows("24:43").Hidden = True
Worksheets("D. Auswertungsbogen").Rows("45:76").Hidden = True
Worksheets("D. Auswertungsbogen").Rows("78:85").Hidden = True
Worksheets("D. Auswertungsbogen").Rows("87:108").Hidden = True
Worksheets("D. Auswertungsbogen").Rows("110:134").Hidden = True

Dim Tabb, ZeileE, ZeileAuswertung, XFehler, x As Integer
ZeileAuswertung = 24
XFehler = 0
For Tabb = 4 To 8 Step 1
    If Tabb = 4 Then
    ZeileAuswertung = 24
    ElseIf Tabb = 5 Then
    ZeileAuswertung = 45
    ElseIf Tabb = 6 Then
    ZeileAuswertung = 78
    ElseIf Tabb = 7 Then
    ZeileAuswertung = 87
    ElseIf Tabb = 8 Then
    ZeileAuswertung = 110
    End If
For ZeileE = 11 To 50 Step 1
    If Worksheets(Tabb).Cells(ZeileE, 10).Value > 1 Then
    XFehler = XFehler + 1
    End If
    If Worksheets(Tabb).Cells(ZeileE, 1).Value = "" Then
    ZeileAuswertung = ZeileAuswertung - 1
    ElseIf Worksheets(Tabb).Cells(ZeileE, 2).Value = "" And Worksheets(Tabb).Cells(ZeileE, 3).Value = "" And Worksheets(Tabb).Cells(ZeileE, 4).Value = "" _
    And Worksheets(Tabb).Cells(ZeileE, 5).Value = "" Then
    'Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = "nicht beantwortet"
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 7).Value = "nb"
    'Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 5).Value = Worksheets(Tabb).Cells(ZeileE, 7).Value
    'ERF|fffd|LLT
    ElseIf Worksheets(Tabb).Cells(ZeileE, 2).Value = "x" Then
    'Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = "erf|fffd|llt"
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 7).Value = "e"
    'Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 5).Value = Worksheets(Tabb).Cells(ZeileE, 7).Value
    'Teilweise
    ElseIf Worksheets(Tabb).Cells(ZeileE, 3).Value = "x" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = Worksheets(Tabb).Cells(ZeileE, 9).Value
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 7).Value = "te"
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 5).Value = Worksheets(Tabb).Cells(ZeileE, 7).Value
    'Nicht erf|fffd|llt
    ElseIf Worksheets(Tabb).Cells(ZeileE, 4).Value = "x" Then
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = Worksheets(Tabb).Cells(ZeileE, 9).Value
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 7).Value = "ne"
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 5).Value = Worksheets(Tabb).Cells(ZeileE, 7).Value
    'nicht relevant
    ElseIf Worksheets(Tabb).Cells(ZeileE, 5).Value = "x" Then
    'Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 2).Value = "nicht relevant"
    Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 7).Value = "nr"
    'Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung, 5).Value = Worksheets(Tabb).Cells(ZeileE, 7).Value
    
    End If
ZeileAuswertung = ZeileAuswertung + 1
Next ZeileE

Next Tabb


'++++nicht ERF|fffd|LLT++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
If CheckBox2.Value = True Then
For ZeileAuswertung2 = 24 To 134 Step 1
If Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung2, 7).Value = "ne" Then
Worksheets("D. Auswertungsbogen").Rows(ZeileAuswertung2).Hidden = False
End If
Next ZeileAuswertung2
End If

'++++teilweise ERF|fffd|LLT++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
If CheckBox3.Value = True Then
For ZeileAuswertung3 = 24 To 134 Step 1
If Worksheets("D. Auswertungsbogen").Cells(ZeileAuswertung3, 7).Value = "te" Then
Worksheets("D. Auswertungsbogen").Rows(ZeileAuswertung3).Hidden = False
End If
Next ZeileAuswertung3
End If


Unload Me

If XFehler > 0 Then
MsgBox "Bei der Beantwortung von " & XFehler & " Frage(n) wurde eine Doppelantwort gegeben." + vbCrLf + vbCrLf + "Bitte korrigieren Sie die Fehleingabe, um eine korrekte Auswertung zu gew|fffd|hrleisten.", _
vbInformation + vbOKOnly, "Doppelbeantwortung"
End If

'####STATISTIK############################################################################################################################
'####STATISTIK############################################################################################################################
'####STATISTIK############################################################################################################################
'####STATISTIK############################################################################################################################
'####STATISTIK############################################################################################################################
'####STATISTIK############################################################################################################################
'####STATISTIK############################################################################################################################

'Worksheets("D. Auswertungsbogen").Cells(17, 2).Value = Application.WorksheetFunction.CountIf(Range("G24:G133"), "e")
'Worksheets("D. Auswertungsbogen").Cells(18, 2).Value = Application.WorksheetFunction.CountIf(Range("G24:G133"), "te")
'Worksheets("D. Auswertungsbogen").Cells(19, 2).Value = Application.WorksheetFunction.CountIf(Range("G24:G133"), "ne")
'Worksheets("D. Auswertungsbogen").Cells(20, 2).Value = Application.WorksheetFunction.CountIf(Range("G24:G133"), "nr")
'Worksheets("D. Auswertungsbogen").Cells(19, 3).Value = Application.WorksheetFunction.CountIf(Range("G24:G133"), "nb")

Sheets("D. Auswertungsbogen").Protect "arqum1"
End Sub



INQUEST-PP=macro
