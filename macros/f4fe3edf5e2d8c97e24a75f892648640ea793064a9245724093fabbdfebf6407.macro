Attribute VB_Name = "Module1"
Option Explicit
'-- obtained from  http://www.CharteredValuer.com
'--   http://pun1ww1-a.sancharnet.in:83/akl_valuer/index.htm
Function SpellNumber(kapil As Double)

'Attribute Macro4.VB_Description = "Macro recorded 05/01/01 by Shailesh Agrawal"
'Attribute Macro4.VB_ProcData.VB_Invoke_Func = "Normal.NewMacros.Macro4"
' Your comments and Feed back will be most appreciated.
' Macro4 Macro
' Macro recorded 05/01/2001 by Shailesh Agrawal Associates
' This macro is available free of cost at www.CharteredValuer.com
' For Further inquiry feel free to contact on shashi@CharteredValuer.com
' This is distributed as freeware. We do not take any responsiblity for any problem
' due to this macro
'

Dim words(100) As String
 words(0) = "Zero"
 words(1) = "One"
 words(2) = "Two"
 words(3) = "Three"
 words(4) = "Four"
 words(5) = "Five"
 words(6) = "Six"
 words(7) = "Seven"
 words(8) = "Eight"
 words(9) = "Nine"
 words(10) = "Ten"
 words(11) = "Eleven"
 words(12) = "Twelve"
 words(13) = "Thirteen"
 words(14) = "Fourteen"
 words(15) = "Fifteen"
 words(16) = "Sixteen"
 words(17) = "Seventeen"
 words(18) = "Eighteen"
 words(19) = "Nineteen"
 words(20) = "Twenty"
 words(21) = "Twenty One"
 words(22) = "Twenty Two"
 words(23) = "Twenty Three"
 words(24) = "Twenty Four"
 words(25) = "Twenty Five"
 words(26) = "Twenty Six"
 words(27) = "Twenty Seven"
 words(28) = "Twenty Eight"
 words(29) = "Twenty Nine"
 words(30) = "Thirty"
 words(31) = "Thirty One"
 words(32) = "Thirty Two"
 words(33) = "Thirty Three"
 words(34) = "Thirty Four"
 words(35) = "Thirty Five"
 words(36) = "Thirty Six"
 words(37) = "Thirty Seven"
 words(38) = "Thirty Eight"
 words(39) = "Thirty Nine"
 words(40) = "Fourty"
 words(41) = "Fourty One"
 words(42) = "Fourty Two"
 words(43) = "Fourty Three"
 words(44) = "Fourty Four"
 words(45) = "Fourty Five"
 words(46) = "Fourty Six"
 words(47) = "Fourty Seven"
 words(48) = "Fourty Eight"
 words(49) = "Fourty Nine"
 words(50) = "Fifty"
 words(51) = "Fifty One"
 words(52) = "Fifty Two"
 words(53) = "Fifty Three"
 words(54) = "Fifty Four"
 words(55) = "Fifty Five"
 words(56) = "Fifty Six"
 words(57) = "Fifty Seven"
 words(58) = "Fifty Eight"
 words(59) = "Fifty Nine"
 words(60) = "Sixty"
 words(61) = "Sixty One"
 words(62) = "Sixty Two"
 words(63) = "Sixty Three"
 words(64) = "Sixty Four"
 words(65) = "Sixty Five"
 words(66) = "Sixty Six"
 words(67) = "Sixty Seven"
 words(68) = "Sixty Eight"
 words(69) = "Sixty Nine"
 words(70) = "Seventy"
 words(71) = "Seventy One"
 words(72) = "Seventy Two"
 words(73) = "Seventy Three"
 words(74) = "Seventy Four"
 words(75) = "Seventy Five"
 words(76) = "Seventy Six"
 words(77) = "Seventy Seven"
 words(78) = "Seventy Eight"
 words(79) = "Seventy Nine"
 words(80) = "Eighty"
 words(81) = "Eighty One"
 words(82) = "Eighty Two"
 words(83) = "Eighty Three"
 words(84) = "Eighty Four"
 words(85) = "Eighty Five"
 words(86) = "Eighty Six"
 words(87) = "Eighty Seven"
 words(88) = "Eighty Eight"
 words(89) = "Eighty Nine"
 words(90) = "Ninety"
 words(91) = "Ninety One"
 words(92) = "Ninety Two"
 words(93) = "Ninety Three"
 words(94) = "Ninety Four"
 words(95) = "Ninety Five"
 words(96) = "Ninety Six"
 words(97) = "Ninety Seven"
 words(98) = "Ninety Eight"
 words(99) = "Ninety Nine"
 words(100) = "One Hundred"

Dim GHAU As String
Dim CRORE As String
Dim LAKH As String
Dim thousand As String, ERUPT As Variant
Dim HUNDRED As String
'==========================================
Dim AJEB1   As Variant
Dim BINDRZ  As Variant
Dim BOROS   As Variant, BORIS As Variant
Dim BORUS   As Variant, CYRUS As Variant, CYROS1 As Variant
Dim DOZAL   As Variant
Dim GRIPP1  As String
Dim GRIPP2  As Long
Dim GRIPP3  As Variant, PAISE As String
Dim GXZP1   As String, GXZP2 As String, GXZP3 As String
Dim GXZP4   As String, GXZP5 As String, GXZP6 As String, GXZP7 As String
Dim HARP1   As Variant, HARP2 As Variant, HARP3 As Variant
Dim HARP4   As Variant, HARP5 As Variant, HARP6 As Variant
Dim HARP7   As Variant
Dim JANTI   As Variant, JANTI1 As Variant, JANTI2 As Variant, JANTI3 As Variant
Dim KARANT1 As Variant, KARANT2 As Variant, KARANT3 As Variant
Dim KARANT4 As Variant, KARANT5 As Variant, KARANT6 As Variant
Dim KARANT7 As Variant, KARANT8 As Variant
Dim LINZUR1 As Variant, LINZUR2 As Variant, LINZUR3 As Variant
Dim LINZUR4 As Variant, LINZUR5 As Variant, LINZUR  As Variant
Dim PAST1   As Variant, PAST2 As Variant, PAST3 As Variant
Dim PAST4   As Variant, PAST5 As Variant, PAST12 As Variant
Dim RABJI1  As String
Dim XORE6   As String
Dim XORE7   As Variant, XORE8 As Variant
Dim XYME    As Variant
Dim XYZ     As String, FLITIES As Variant
Dim ZZART   As Variant
GXZP6 = " "
GXZP7 = " "

'-- Limits in place 2004-09-23 ...
If kapil = 0 Then
  SpellNumber = "Rupees" _
            & " Only"
  Exit Function
End If
If kapil > 999999999.99 Then
  SpellNumber = "High Value" _
            & " "
  Exit Function
End If

BINDRZ = kapil
PAST1 = BINDRZ - Int(BINDRZ)
PAST12 = Round((PAST1 * 100), 0)

PAST2 = Int(PAST12)
PAST3 = Str(PAST2)
PAST4 = Val(PAST3)
JANTI = Str(Int(BINDRZ))
JANTI1 = Val(JANTI)
JANTI2 = Int(JANTI1)
AJEB1 = Str(JANTI2)
CRORE = " Crore "
LAKH = " Lakh "
thousand = " Thousand "
HUNDRED = " Hundred "
PAISE = "- Paise"
GXZP1 = " "
GXZP2 = " "
GXZP3 = " "
GXZP4 = " "
GXZP5 = " "
GXZP6 = " "
GXZP7 = " "
XYZ = "&"
RABJI1 = Trim(AJEB1)
If Len(RABJI1) > 7 Then
 KARANT1 = Right(RABJI1, 9)
 KARANT2 = Right(RABJI1, 7)
 KARANT3 = Val(KARANT1) - Val(KARANT2)
 KARANT4 = KARANT3 / 10000000
 KARANT5 = Str(KARANT4)
 KARANT6 = Right(KARANT5, 2)
 KARANT7 = Val(KARANT6)
 If KARANT7 > 0 Then
   KARANT8 = words(KARANT7)
 Else
   KARANT8 = ""
   CRORE = ""
   GXZP1 = ""
 End If
Else
 KARANT8 = ""
 CRORE = ""
 GXZP1 = ""
End If
If Len(RABJI1) > 5 Then
 LINZUR = Right(RABJI1, 5)
 LINZUR2 = Val(RABJI1) - Val(LINZUR)
 LINZUR3 = LINZUR2 / 100000
 XORE6 = Str(LINZUR3)
 XORE7 = Right(XORE6, 2)
 XORE8 = Val(XORE7)
 If XORE8 > 0 Then
   LINZUR4 = words(XORE8)
 Else
   LINZUR4 = ""
   LAKH = ""
   GXZP2 = ""
 End If
   Else
   LINZUR4 = ""
   LAKH = ""
   GXZP2 = ""
End If
If Len(RABJI1) > 3 Then
 HARP1 = Right(RABJI1, 3)
 HARP2 = Val(RABJI1) - Val(HARP1)
 HARP3 = HARP2 / 1000
 HARP4 = Str(HARP3)
 HARP5 = Right(HARP4, 2)
 HARP6 = Val(HARP5)
 If HARP6 > 0 Then
   HARP7 = words(HARP6)
 Else
   HARP7 = ""
   thousand = ""
   GXZP3 = ""
 End If
Else
 HARP7 = ""
 thousand = ""
 GXZP3 = ""
End If
If Len(RABJI1) > 2 Then
 BORIS = Right(RABJI1, 3)
 CYRUS = Left(BORIS, 1)
 CYROS1 = Val(CYRUS)
 If CYROS1 > 0 Then
   ERUPT = words(CYROS1)
 Else
   ERUPT = ""
   HUNDRED = ""
   GXZP4 = ""
 End If
Else
 ERUPT = ""
 HUNDRED = ""
 GXZP4 = ""
End If
If Len(RABJI1) > 1 Then
 ZZART = Right(RABJI1, 2)
 DOZAL = Val(ZZART)
 If DOZAL > 0 Then
   FLITIES = words(DOZAL)
 Else
   FLITIES = ""
   XYZ = ""
 End If
Else
 FLITIES = ""
 XYZ = ""
End If
If Len(RABJI1) < 2 And Len(RABJI1) > 0 Then
 GRIPP1 = Left(RABJI1, 1)
 GRIPP2 = Val(GRIPP1)
 XYZ = ""
 GXZP5 = ""
 GXZP6 = ""
 If GRIPP2 > 0 Then
   GRIPP3 = words(GRIPP2)
 Else
   GRIPP3 = ""
 End If
Else
 GRIPP3 = ""
End If
If Len(RABJI1) < 3 And Len(RABJI1) > 0 Then
 XYZ = ""
 GXZP5 = ""
 GXZP6 = ""
End If
If PAST4 > 0 Then
    PAST5 = words(PAST4)
 Else
 PAST5 = ""
 PAISE = ""
 GXZP7 = ""
End If
XYME = Val(AJEB1)
GHAU = "Rupees " + Trim(KARANT8) + GXZP1 + Trim(CRORE) _
  + GXZP1 + Trim(LINZUR4) + GXZP2 + Trim(LAKH) + GXZP2 _
  + Trim(HARP7) + GXZP3 + Trim(thousand) + GXZP3 _
  + Trim(ERUPT) + GXZP4 + Trim(HUNDRED) + GXZP5 + XYZ _
  + GXZP4 + Trim(FLITIES) + GXZP6 + Trim(GRIPP3) _
  + GXZP7 + Trim(PAISE) + GXZP7 + Trim(PAST5) + " Only"

SpellNumber = GHAU
End Function





'Main Function
Function SpellNumberU(ByVal MyNumber)
    Dim Dollars, Cents, Temp
    Dim DecimalPlace, Count
    ReDim Place(9) As String
    Place(2) = " Thousand "
    Place(3) = " Million "
    Place(4) = " Billion "
    Place(5) = " Trillion "
    ' String representation of amount.
    MyNumber = Trim(Str(MyNumber))
    ' Position of decimal place 0 if none.
    DecimalPlace = InStr(MyNumber, ".")
    ' Convert cents and set MyNumber to dollar amount.
    If DecimalPlace > 0 Then
        Cents = GetTens(Left(Mid(MyNumber, DecimalPlace + 1) & _
                  "00", 2))
        MyNumber = Trim(Left(MyNumber, DecimalPlace - 1))
    End If
    Count = 1
    Do While MyNumber <> ""
        Temp = GetHundreds(Right(MyNumber, 3))
        If Temp <> "" Then Dollars = Temp & Place(Count) & Dollars
        If Len(MyNumber) > 3 Then
            MyNumber = Left(MyNumber, Len(MyNumber) - 3)
        Else
            MyNumber = ""
        End If
        Count = Count + 1
    Loop
    Select Case Dollars
        Case ""
            Dollars = "No Dollars"
        Case "One"
            Dollars = "One Dollar"
         Case Else
            Dollars = Dollars & " Dollars"
    End Select
    Select Case Cents
        Case ""
            Cents = " and No Cents"
        Case "One"
            Cents = " and One Cent"
              Case Else
            Cents = " and " & Cents & " Cents"
    End Select
    SpellNumberU = Dollars & Cents
End Function
      
' Converts a number from 100-999 into text
Function GetHundreds(ByVal MyNumber)
    Dim Result As String
    If Val(MyNumber) = 0 Then Exit Function
    MyNumber = Right("000" & MyNumber, 3)
    ' Convert the hundreds place.
    If Mid(MyNumber, 1, 1) <> "0" Then
        Result = GetDigit(Mid(MyNumber, 1, 1)) & " Hundred "
    End If
    ' Convert the tens and ones place.
    If Mid(MyNumber, 2, 1) <> "0" Then
        Result = Result & GetTens(Mid(MyNumber, 2))
    Else
        Result = Result & GetDigit(Mid(MyNumber, 3))
    End If
    GetHundreds = Result
End Function
      
' Converts a number from 10 to 99 into text.
Function GetTens(TensText)
    Dim Result As String
    Result = ""           ' Null out the temporary function value.
    If Val(Left(TensText, 1)) = 1 Then   ' If value between 10-19...
        Select Case Val(TensText)
            Case 10: Result = "Ten"
            Case 11: Result = "Eleven"
            Case 12: Result = "Twelve"
            Case 13: Result = "Thirteen"
            Case 14: Result = "Fourteen"
            Case 15: Result = "Fifteen"
            Case 16: Result = "Sixteen"
            Case 17: Result = "Seventeen"
            Case 18: Result = "Eighteen"
            Case 19: Result = "Nineteen"
            Case Else
        End Select
    Else                                 ' If value between 20-99...
        Select Case Val(Left(TensText, 1))
            Case 2: Result = "Twenty "
            Case 3: Result = "Thirty "
            Case 4: Result = "Forty "
            Case 5: Result = "Fifty "
            Case 6: Result = "Sixty "
            Case 7: Result = "Seventy "
            Case 8: Result = "Eighty "
            Case 9: Result = "Ninety "
            Case Else
        End Select
        Result = Result & GetDigit _
            (Right(TensText, 1))  ' Retrieve ones place.
    End If
    GetTens = Result
End Function
     
' Converts a number from 1 to 9 into text.
Function GetDigit(Digit)
    Select Case Val(Digit)
        Case 1: GetDigit = "One"
        Case 2: GetDigit = "Two"
        Case 3: GetDigit = "Three"
        Case 4: GetDigit = "Four"
        Case 5: GetDigit = "Five"
        Case 6: GetDigit = "Six"
        Case 7: GetDigit = "Seven"
        Case 8: GetDigit = "Eight"
        Case 9: GetDigit = "Nine"
        Case Else: GetDigit = ""
    End Select
End Function



'Main Function
Function SpellNumberF(ByVal MyNumber)
    Dim Dollars, Cents, Temp
    Dim DecimalPlace, Count
    ReDim Place(9) As String
    Place(2) = " Thousand "
    Place(3) = " Million "
    Place(4) = " Billion "
    Place(5) = " Trillion "
    ' String representation of amount.
    MyNumber = Trim(Str(MyNumber))
    ' Position of decimal place 0 if none.
    DecimalPlace = InStr(MyNumber, ".")
    ' Convert cents and set MyNumber to dollar amount.
    If DecimalPlace > 0 Then
        Cents = GetTens(Left(Mid(MyNumber, DecimalPlace + 1) & _
                  "00", 2))
        MyNumber = Trim(Left(MyNumber, DecimalPlace - 1))
    End If
    Count = 1
    Do While MyNumber <> ""
        Temp = GetHundreds(Right(MyNumber, 3))
        If Temp <> "" Then Dollars = Temp & Place(Count) & Dollars
        If Len(MyNumber) > 3 Then
            MyNumber = Left(MyNumber, Len(MyNumber) - 3)
        Else
            MyNumber = ""
        End If
        Count = Count + 1
    Loop
    Select Case Dollars
        Case ""
            Dollars = " "
        Case "One"
            Dollars = "One "
         Case Else
            Dollars = Dollars
    End Select
    Select Case Cents
        Case ""
            Cents = " "
        Case "One"
            Cents = " and One "
              Case Else
            Cents = " point " & Cents
    End Select
    SpellNumberF = Dollars & Cents
End Function
      
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
