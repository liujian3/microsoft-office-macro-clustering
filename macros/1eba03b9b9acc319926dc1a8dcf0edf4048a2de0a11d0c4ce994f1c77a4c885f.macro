Attribute VB_Name = "Module1"
Sub openuserform()

'To identify the first cell
If ThisWorkbook.Sheets("Data").Cells(7, 2).Value <> "" Then

'For ttr = 7 To ThisWorkbook.Sheets("Data").UsedRange.Rows.Count
'For ttc = 2 To ThisWorkbook.Sheets("Data").UsedRange.Columns.Count
'
'If ThisWorkbook.Sheets("Data").Cells(ttr, ttc).Interior.ColorIndex = xlColorIndexNone Then
'Else
'MsgBox "Row number :" & ttr & "Column number :" & ttc
'End If
'
'Next
'Next

'Error handling
cf11 = ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row
Cf12 = "B7" & " : " & "AF" & cf11
If ThisWorkbook.Sheets("Data").Range(Cf12).Interior.ColorIndex = xlColorIndexNone Then
UserForm1.Show
Else
MsgBox "Please correct the invalid data", vbCritical
End If

Else
 MsgBox "Please enter the data in B7 Cell", vbCritical
End If

End Sub

Sub Vendor_Metrics()


'PO Number
c1 = 2
'Vendor Name
c2 = 3
'Print Location State
c3 = 4
'Print Location City
c4 = 5
'Company Code/GL-Code
c5 = 6
'Cost Center
c6 = 7
'JOB / Order Number
c7 = 8
'Market (by State)
c8 = 9
'Document Type
c9 = 10
'8.5 x 11
c10 = 11
'Project Description
c11 = 12
'Total Volume (0 when item is in New Member Packet)
c12 = 13
'Business Contact / Requestor Name
c13 = 14
'Date Received by Vendor
c14 = 15
'Date Due
c15 = 16
' Delivery Date / BP
c16 = 17
'SLA Met Y / N
c17 = 18
'Total packages
c18 = 19
'Total Impressions
c19 = 20
'Total Sheets of Paper
c20 = 21
'Insert(s) Added
c21 = 22
'Type of Insert
c22 = 23
'Total Cost
c23 = 24
'Actual Print Cost
c24 = 25
'Actual Postage Cost
c25 = 26
'Coding and/or Data processing, other costs
c26 = 27
'Delivery Method
c27 = 28
'Color
c28 = 29
'Finish Type
c29 = 30
'Finishing and Bindary
c30 = 31
'Wastage (if applicable)?
c31 = 32
'Cost savings /eff avoid
c32 = 33

'To identify the first cell
If ThisWorkbook.Sheets("Data").Cells(7, 3).Value <> "" Then

If ThisWorkbook.Sheets("Data").Range("B5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Or _
ThisWorkbook.Sheets("Data").Range("D5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Or _
ThisWorkbook.Sheets("Data").Range("E5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Or _
ThisWorkbook.Sheets("Data").Range("F5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Or _
ThisWorkbook.Sheets("Data").Range("G5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Or _
ThisWorkbook.Sheets("Data").Range("H5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Or _
ThisWorkbook.Sheets("Data").Range("I5").End(xlDown).Row > ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row Then

MsgBox "Update the empty rows in 'Vendor Name' Column"

Else


'Clear formating
Cf = ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row
Cf1 = "A7" & " : " & "AF" & Cf

ThisWorkbook.Sheets("Data").Range(Cf1).ClearFormats
ThisWorkbook.Sheets("Data").Range(Cf1).Interior.ColorIndex = xlColorIndexNone
ThisWorkbook.Sheets("Data").Range(Cf1).Font.Color = RGB(0, 0, 0)

ThisWorkbook.Sheets("Conditions").Visible = True


'******************Data validation - List option********************
'Finishing Type
Dim Dvrange1 As Range, Dvrng1 As Range
Set WSD = ThisWorkbook.Worksheets("Conditions")
Cf4 = ThisWorkbook.Sheets("Data").UsedRange.Rows.Count


Rng01 = "AD7" & " : " & "AD" & Cf4

Set Dvrange1 = ThisWorkbook.Worksheets("Conditions").Range("F7:F22")
Set Dvrng1 = ThisWorkbook.Worksheets("Data").Range(Rng01)

With Dvrng1.Validation
    .Delete 'delete previous validation
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange1.Address
End With

'Bindery
Dim Dvrange2 As Range, Dvrng2 As Range

Rng02 = "AE7" & " : " & "AE" & Cf4

Set Dvrange2 = ThisWorkbook.Worksheets("Conditions").Range("H7:H24")
Set Dvrng2 = ThisWorkbook.Worksheets("Data").Range(Rng02)

With Dvrng2.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange2.Address
End With

'Delivery method
Dim Dvrange3 As Range, Dvrng3 As Range

Rng03 = "AB7" & " : " & "AB" & Cf4

Set Dvrange3 = ThisWorkbook.Worksheets("Conditions").Range("J7:J34")
Set Dvrng3 = ThisWorkbook.Worksheets("Data").Range(Rng03)

With Dvrng3.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange3.Address
End With



'Document Type
Dim Dvrange4 As Range, Dvrng4 As Range

Rng04 = "J7" & " : " & "J" & Cf4

Set Dvrange4 = ThisWorkbook.Worksheets("Conditions").Range("L7:L24")
Set Dvrng4 = ThisWorkbook.Worksheets("Data").Range(Rng04)

With Dvrng4.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange4.Address
End With


'Type of insert
Dim Dvrange5 As Range, Dvrng5 As Range

Rng05 = "W7" & " : " & "W" & Cf4

Set Dvrange5 = ThisWorkbook.Worksheets("Conditions").Range("N7:N21")
Set Dvrng5 = ThisWorkbook.Worksheets("Data").Range(Rng05)

With Dvrng5.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange5.Address
End With

'***********************Length Validation***************************

'PO Number
For R1 = 7 To ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row
a = ThisWorkbook.Sheets("Data").Cells(R1, c1).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c1).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c1).Value)
    If Len(a) > 20 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c1).Interior.ColorIndex = 6
    ElseIf a = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c1).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c1).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(a, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c1).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c1).Font.Color = RGB(255, 255, 255)
    End If
    
'Vendor Name
b = ThisWorkbook.Sheets("Data").Cells(R1, c2).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c2).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c2).Value)
    If Len(b) > 50 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c2).Interior.ColorIndex = 6
    End If
    If ThisWorkbook.Sheets("Data").Cells(R1, c2).Value = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c2).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c2).Font.Color = RGB(255, c255, c255)
    End If
    If ThisWorkbook.Sheets("Data").Cells(R1, c2).Value = "NA" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c2).Interior.ColorIndex = 3
    End If
    If InStr(b, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c2).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c2).Font.Color = RGB(255, c255, c255)
    End If
    
'Print Location State
ThisWorkbook.Sheets("Data").Cells(R1, c3).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c3).Value)
C = ThisWorkbook.Sheets("Data").Cells(R1, c3).Value
    If Len(C) > 2 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c3).Interior.ColorIndex = 6
    End If
    If ThisWorkbook.Sheets("Data").Cells(R1, c3).Value = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c3).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c3).Font.Color = RGB(255, 255, 255)
    End If
    If ThisWorkbook.Sheets("Data").Cells(R1, c3).Value = "NA" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c3).Interior.ColorIndex = 3
    End If
    
    If InStr(C, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c3).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c3).Font.Color = RGB(255, 255, 255)
    End If
    
'Print Location City
d = ThisWorkbook.Sheets("Data").Cells(R1, c4).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c4).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c4).Value)
    If Len(d) > 60 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c4).Interior.ColorIndex = 6
    ElseIf d = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c4).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c4).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(d, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c4).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c4).Font.Color = RGB(255, 255, 255)
    End If
    
'Company Code/GL-Code
e = ThisWorkbook.Sheets("Data").Cells(R1, c5).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c5).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c5).Value)
    If Len(e) > 25 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c5).Interior.ColorIndex = 6
    ElseIf e = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c5).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c5).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(e, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c5).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c5).Font.Color = RGB(255, 255, 255)
    End If
    
'Cost Center
f = ThisWorkbook.Sheets("Data").Cells(R1, c6).Value
    If Len(f) > 18 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Interior.ColorIndex = 6
    ElseIf f = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(f, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Font.Color = RGB(255, 255, 255)
    End If
    
    If f <> "NA" And IsNumeric(f) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c6).Font.Color = RGB(255, 255, 255)
    End If
        
    
'JOB / Order Number
g = ThisWorkbook.Sheets("Data").Cells(R1, c7).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c7).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c7).Value)
    If Len(g) > 30 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c7).Interior.ColorIndex = 6
    End If
    If ThisWorkbook.Sheets("Data").Cells(R1, c7).Value = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c7).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c7).Font.Color = RGB(255, 255, 255)
    End If
    If ThisWorkbook.Sheets("Data").Cells(R1, c7).Value = "NA" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c7).Interior.ColorIndex = 3
    End If
    
    If InStr(g, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c7).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c7).Font.Color = RGB(255, 255, 255)
    End If
    
'Market (by State)
ThisWorkbook.Sheets("Data").Cells(R1, c8).Value = RTrim(ThisWorkbook.Sheets("Data").Cells(R1, c8).Value)
h = ThisWorkbook.Sheets("Data").Cells(R1, c8).Value
    If Len(h) > 2 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c8).Interior.ColorIndex = 6
    ElseIf h = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c8).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c8).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(h, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c8).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c8).Font.Color = RGB(255, 255, 255)
    End If
    
'Document Type
i = ThisWorkbook.Sheets("Data").Cells(R1, c9).Value
    If Len(i) > 150 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c9).Interior.ColorIndex = 6
    ElseIf i = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c9).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c9).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(i, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c9).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c9).Font.Color = RGB(255, 255, 255)
    End If
    
    'Split function
            myAr5 = Split(i, ";")
            For i5 = LBound(myAr5) To UBound(myAr5)
                'For ci5 = 7 To 23
                Set CWb = ThisWorkbook.Sheets("conditions")
                If Trim(UCase(myAr5(i5))) = CWb.Cells(7, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(8, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(9, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(10, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(11, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(12, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(13, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(14, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(15, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(16, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(17, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(18, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(19, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(20, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(21, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(22, "L").Value Or _
                Trim(UCase(myAr5(i5))) = CWb.Cells(23, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(24, "L").Value Then
'                Trim(UCase(myAr5(i5))) = CWb.Cells(23, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(24, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(25, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(26, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(27, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(28, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(51, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(29, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(30, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(52, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(31, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(32, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(53, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(33, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(34, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(54, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(35, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(36, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(55, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(37, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(38, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(56, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(39, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(40, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(57, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(41, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(42, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(58, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(43, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(44, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(59, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(45, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(46, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(60, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(47, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(48, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(62, "L").Value Or _
'                Trim(UCase(myAr5(i5))) = CWb.Cells(49, "L").Value Or Trim(UCase(myAr5(i5))) = CWb.Cells(50, "L").Value Then
                
                Else
                ThisWorkbook.Sheets("Data").Cells(R1, c9).Interior.ColorIndex = 3
                ThisWorkbook.Sheets("Data").Cells(R1, c9).Font.Color = RGB(255, 255, 255)
                End If
                 
            Next
                
'8.5 x 11
ThisWorkbook.Sheets("Data").Cells(R1, c10).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c10).Value)
j = ThisWorkbook.Sheets("Data").Cells(R1, c10).Value
    If Len(j) > 1 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Interior.ColorIndex = 6
    ElseIf j = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Font.Color = RGB(255, 255, 255)
    End If
    
    If j = "Y" Or j = "N" Or j = "U" Then
    'ThisWorkbook.Sheets("Data").Cells(R1, c10).Interior.ColorIndex = xlColorIndexNone
    Else
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(j, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c10).Font.Color = RGB(255, 255, 255)
    End If
    
'Project Description
k = ThisWorkbook.Sheets("Data").Cells(R1, c11).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c11).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c11).Value)
    If Len(k) > 200 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c11).Interior.ColorIndex = 6
    ElseIf k = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c11).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c11).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(k, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c11).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c11).Font.Color = RGB(255, 255, 255)
    End If

'Total Volume (0 when item is in New Member Packet)
l = ThisWorkbook.Sheets("Data").Cells(R1, c12).Value
    If Len(l) > 18 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Interior.ColorIndex = 6
    ElseIf l = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(l, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Font.Color = RGB(255, 255, 255)
    End If
    
    If l <> "NA" And IsNumeric(l) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c12).Font.Color = RGB(255, 255, 255)
    End If

'Business Contact / Requestor Name
m = ThisWorkbook.Sheets("Data").Cells(R1, c13).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c13).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c13).Value)
    If Len(m) > 100 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c13).Interior.ColorIndex = 6
    ElseIf m = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c13).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c13).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(m, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c13).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c13).Font.Color = RGB(255, 255, 255)
    End If
    
'Date Received by Vendor
n = ThisWorkbook.Sheets("Data").Cells(R1, c14).Value
    If Len(n) > 11 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c14).Interior.ColorIndex = 6
    ElseIf n = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c14).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c14).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(n, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c14).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c14).Font.Color = RGB(255, 255, 255)
    End If

    
'Date Due
o = ThisWorkbook.Sheets("Data").Cells(R1, c15).Value
    If Len(o) > 11 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c15).Interior.ColorIndex = 6
    ElseIf o = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c15).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c15).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(o, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c15).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c15).Font.Color = RGB(255, 255, 255)
    End If
    
'Delivery Date / BP
p = ThisWorkbook.Sheets("Data").Cells(R1, c16).Value
    If Len(p) > 11 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c16).Interior.ColorIndex = 6
    ElseIf p = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c16).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c16).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(p, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c16).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c16).Font.Color = RGB(255, 255, 255)
    End If
    
'SLA Met Y / N
ThisWorkbook.Sheets("Data").Cells(R1, c17).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c17).Value)
q = ThisWorkbook.Sheets("Data").Cells(R1, c17).Value
    If Len(q) > 1 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Interior.ColorIndex = 6
    ElseIf q = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Font.Color = RGB(255, 255, 255)
    End If
    
    If q = "Y" Or q = "N" Or q = "U" Then
    'ThisWorkbook.Sheets("Data").Cells(R1, c17).Interior.ColorIndex = xlColorIndexNone
    Else
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(q, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c17).Font.Color = RGB(255, 255, 255)
    End If
    
'Total packages
'ThisWorkbook.Sheets("Data").Cells(R1, c18).Value = ThisWorkbook.Sheets("Data").Cells(R1, c18).Value
r = ThisWorkbook.Sheets("Data").Cells(R1, c18).Value
    If Len(r) > 18 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Interior.ColorIndex = 6
    ElseIf r = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Font.Color = RGB(255, 255, 255)
    End If

    If InStr(r, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Font.Color = RGB(255, 255, 255)
    End If
    
    If r <> "NA" And IsNumeric(r) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c18).Font.Color = RGB(255, 255, 255)
    End If
    
'Total Impressions
'ThisWorkbook.Sheets("Data").Cells(R1, c19).Value = ThisWorkbook.Sheets("Data").Cells(R1, c19).Value
s = ThisWorkbook.Sheets("Data").Cells(R1, c19).Value
    If Len(s) > 18 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Interior.ColorIndex = 6
    ElseIf s = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(s, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Font.Color = RGB(255, 255, 255)
    End If
    
    If s <> "NA" And IsNumeric(s) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c19).Font.Color = RGB(255, 255, 255)
    End If
    
'Total Sheets of Paper
'ThisWorkbook.Sheets("Data").Cells(R1, c20).Value = ThisWorkbook.Sheets("Data").Cells(R1, c20).Value
t = ThisWorkbook.Sheets("Data").Cells(R1, c20).Value
    If Len(t) > 18 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Interior.ColorIndex = 6
    ElseIf t = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(t, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Font.Color = RGB(255, 255, 255)
    End If
    
    If t <> "NA" And IsNumeric(t) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c20).Font.Color = RGB(255, 255, 255)
    End If
    
'Insert(s) Added
ThisWorkbook.Sheets("Data").Cells(R1, c21).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c21).Value)
u = ThisWorkbook.Sheets("Data").Cells(R1, c21).Value
    If Len(u) > 18 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Interior.ColorIndex = 6
    ElseIf u = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Font.Color = RGB(255, 255, 255)
    End If
   
    If u = "Y" Or u = "N" Or u = "U" Then
    'ThisWorkbook.Sheets("Data").Cells(R1, c21).Interior.ColorIndex = xlColorIndexNone
    Else
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(u, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c21).Font.Color = RGB(255, 255, 255)
    End If
    
'Type of Insert
v = ThisWorkbook.Sheets("Data").Cells(R1, c22).Value
    'ThisWorkbook.Sheets("Data").Cells(R1, c22).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c22).Value)
    If Len(v) > 100 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c22).Interior.ColorIndex = 6
    ElseIf v = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c22).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c22).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(v, ",") Or InStr(v, "NA;") Or InStr(v, "; NA") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c22).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c22).Font.Color = RGB(255, 255, 255)
    End If
    
'Split function
            myAr4 = Split(v, ";")
            For i4 = LBound(myAr4) To UBound(myAr4)
                
                Set CWb1 = ThisWorkbook.Sheets("conditions")
                If Trim(UCase(myAr4(i4))) = CWb1.Cells(7, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(8, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(9, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(10, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(11, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(12, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(13, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(14, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(15, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(16, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(17, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(18, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(19, "N").Value Or Trim(UCase(myAr4(i4))) = CWb1.Cells(20, "N").Value Or _
                Trim(UCase(myAr4(i4))) = CWb1.Cells(21, "N").Value Then
                
                Else
                ThisWorkbook.Sheets("Data").Cells(R1, c22).Interior.ColorIndex = 3
                ThisWorkbook.Sheets("Data").Cells(R1, c22).Font.Color = RGB(255, 255, 255)
                End If
            Next
'Total Cost
w = ThisWorkbook.Sheets("Data").Cells(R1, c23).Value
    If Len(w) > 15 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Interior.ColorIndex = 6
    ElseIf w = "" Or w = "," Then
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(w, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Font.Color = RGB(255, 255, 255)
    End If
    
    If w <> "NA" And IsNumeric(w) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c23).Font.Color = RGB(255, 255, 255)
    End If
    
'Actual Print Cost
X = ThisWorkbook.Sheets("Data").Cells(R1, c24).Value
    If Len(X) > 15 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Interior.ColorIndex = 6
    ElseIf X = "" Or X = "," Then
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(X, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Font.Color = RGB(255, 255, 255)
    End If
    
    If X <> "NA" And IsNumeric(X) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c24).Font.Color = RGB(255, 255, 255)
    End If
    
'Actual Postage Cost
y = ThisWorkbook.Sheets("Data").Cells(R1, c25).Value
    If Len(y) > 15 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Interior.ColorIndex = 6
    ElseIf y = "" Or y = "," Then
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(y, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Font.Color = RGB(255, 255, 255)
    End If
   
    If y <> "NA" And IsNumeric(y) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c25).Font.Color = RGB(255, 255, 255)
    End If
    
'Coding and/or Data processing, other costs
Z = ThisWorkbook.Sheets("Data").Cells(R1, c26).Value
    If Len(Z) > 15 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Interior.ColorIndex = 6
    ElseIf Z = "" Or Z = "," Then
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(Z, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Font.Color = RGB(255, 255, 255)
    End If
   
    If Z <> "NA" And IsNumeric(Z) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c26).Font.Color = RGB(255, 255, 255)
    End If

'Delivery Method
aa = ThisWorkbook.Sheets("Data").Cells(R1, c27).Value
    If Len(aa) > 30 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c27).Interior.ColorIndex = 6
    ElseIf aa = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c27).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c27).Font.Color = RGB(255, 255, 255)
    End If
    
    If InStr(aa, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c27).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c27).Font.Color = RGB(255, 255, 255)
    End If
    
'Split function
            myAr3 = Split(aa, ";")
            For i3 = LBound(myAr3) To UBound(myAr3)
                Set CWb2 = ThisWorkbook.Sheets("conditions")
                If Trim(UCase(myAr3(i3))) = CWb2.Cells(7, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(8, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(9, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(10, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(11, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(12, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(13, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(14, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(15, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(16, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(17, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(18, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(19, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(20, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(21, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(22, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(23, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(24, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(25, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(26, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(27, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(28, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(29, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(30, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(31, "J").Value Or Trim(UCase(myAr3(i3))) = CWb2.Cells(32, "J").Value Or _
                Trim(UCase(myAr3(i3))) = CWb2.Cells(33, "J").Value Then
                
                Else
                ThisWorkbook.Sheets("Data").Cells(R1, c27).Interior.ColorIndex = 3
                ThisWorkbook.Sheets("Data").Cells(R1, c27).Font.Color = RGB(255, 255, 255)
                End If
            Next

'Color
ThisWorkbook.Sheets("Data").Cells(R1, c28).Value = Trim(ThisWorkbook.Sheets("Data").Cells(R1, c28).Value)
ab = ThisWorkbook.Sheets("Data").Cells(R1, c28).Value
    If Len(ab) > 1 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Interior.ColorIndex = 6
    ElseIf ab = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Font.Color = RGB(255, 255, 255)
    End If
    
    If ab = "Y" Or ab = "N" Or ab = "U" Then
    'ThisWorkbook.Sheets("Data").Cells(R1, c28).Interior.ColorIndex = xlColorIndexNone
    Else
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Font.Color = RGB(255, 255, 255)
    End If
        
    If InStr(ab, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c28).Font.Color = RGB(255, 255, 255)
    End If
    
    
'Finish Type
ac = ThisWorkbook.Sheets("Data").Cells(R1, c29).Value
    If Len(ac) > 100 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c29).Interior.ColorIndex = 6
    ElseIf ac = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c29).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c29).Font.Color = RGB(255, 255, 255)
    End If
    If InStr(ac, ",") Or InStr(ac, "NA;") Or InStr(ac, "; NA") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c29).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c29).Font.Color = RGB(255, 255, 255)
    End If
    
'Split function
    myAr2 = Split(ac, ";")
    For i2 = LBound(myAr2) To UBound(myAr2)
        
                Set CWb3 = ThisWorkbook.Sheets("conditions")
                If Trim(UCase(myAr2(i2))) = CWb3.Cells(7, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(8, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(9, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(10, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(11, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(12, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(13, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(14, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(15, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(16, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(17, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(18, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(19, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(20, "F").Value Or _
                Trim(UCase(myAr2(i2))) = CWb3.Cells(21, "F").Value Or Trim(UCase(myAr2(i2))) = CWb3.Cells(22, "F").Value Then
                
                Else
                ThisWorkbook.Sheets("Data").Cells(R1, c29).Interior.ColorIndex = 3
                ThisWorkbook.Sheets("Data").Cells(R1, c29).Font.Color = RGB(255, 255, 255)
                End If
    Next
    

        
'Finishing and Bindery
ad = ThisWorkbook.Sheets("Data").Cells(R1, c30).Value
    If Len(ad) > 100 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c30).Interior.ColorIndex = 6
    ElseIf ad = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c30).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c30).Font.Color = RGB(255, 255, 255)
    End If
    If InStr(ad, ",") Or InStr(ad, "NA;") Or InStr(ad, "; NA") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c30).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c30).Font.Color = RGB(255, 255, 255)
    End If
 
'Split function
    myAr6 = Split(ad, ";")
    For i1 = LBound(myAr6) To UBound(myAr6)
    
    Set CWb3 = ThisWorkbook.Sheets("conditions")
                If Trim(UCase(myAr6(i1))) = CWb3.Cells(7, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(8, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(9, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(10, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(11, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(12, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(13, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(14, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(15, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(16, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(17, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(18, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(19, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(20, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(21, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(22, "H").Value Or _
                Trim(UCase(myAr6(i1))) = CWb3.Cells(23, "H").Value Or Trim(UCase(myAr6(i1))) = CWb3.Cells(24, "H").Value Then
                
                Else
                ThisWorkbook.Sheets("Data").Cells(R1, c30).Interior.ColorIndex = 3
                ThisWorkbook.Sheets("Data").Cells(R1, c30).Font.Color = RGB(255, 255, 255)
                End If
    Next

        
'Wastage (if applicable)?
ae = ThisWorkbook.Sheets("Data").Cells(R1, c31).Value
    If Len(ae) > 15 Then
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Interior.ColorIndex = 6
    ElseIf ae = "" Then
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Font.Color = RGB(255, 255, 255)
    End If
    If InStr(ae, ",") Then
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Interior.ColorIndex = 3
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Font.Color = RGB(255, 255, 255)
    End If
    
    If ae <> "NA" And IsNumeric(ae) = False Then
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R1, c31).Font.Color = RGB(255, 255, 255)
    End If
    
''Cost savings /eff avoid
'af = ThisWorkbook.Sheets("Data").Cells(R1, c32).Value
'    If Len(af) > 18 Then
'    ThisWorkbook.Sheets("Data").Cells(R1, c32).Interior.ColorIndex = 6
'    ElseIf ae = "" Then
'    ThisWorkbook.Sheets("Data").Cells(R1, c32).Interior.ColorIndex = 3
'    ThisWorkbook.Sheets("Data").Cells(R1, c32).Font.Color = RGB(255, 255, 255)
'    End If

Next

'Converting Amount field
ThisWorkbook.Sheets("Data").Range("X:AA").NumberFormat = "0.00"

'Converting Date format
ThisWorkbook.Sheets("Data").Range("O:Q").NumberFormat = "mm/dd/yyyy"

'Converting into MMM-DD-YYYY
For R2 = 7 To ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row
For c33 = 15 To 17
N2 = ThisWorkbook.Sheets("Data").Cells(R2, c33).Value

'Date validation,if incorrect date then move to next iteration
If Not IsDate(N2) Then
  
        '    If c33 = 15 Then
        '    Daterow = "O"
        '    ElseIf c33 = 16 Then
        '    Daterow = "P"
        '    ElseIf c33 = 17 Then
        '    Daterow = "Q"
        '    End If
        
        'MsgBox ("Please enter valid date in Cell : " & Daterow & R2 & ". Example: mm/dd/yyyy")

    ThisWorkbook.Sheets("Data").Cells(R2, c33).Interior.ColorIndex = 46
    ThisWorkbook.Sheets("Data").Cells(R2, c33).Font.Color = RGB(255, 255, 255)
    
GoTo NextIteration
Else
End If
   
Idate2 = Month(N2) & "/" & Day(N2) & "/" & Year(N2)

IDay = Day(Idate2)
Imonth = Month(Idate2)
Iyear = Year(Idate2)

Select Case Imonth
   Case 1
      Smonth = "Jan"
    Case 2
      Smonth = "Feb"
    Case 3
      Smonth = "Mar"
    Case 4
      Smonth = "Apr"
    Case 5
      Smonth = "May"
    Case 6
      Smonth = "Jun"
    Case 7
      Smonth = "Jul"
    Case 8
      Smonth = "Aug"
    Case 9
      Smonth = "Sep"
    Case 10
      Smonth = "Oct"
    Case 11
      Smonth = "Nov"
    Case 12
      Smonth = "Dec"
   End Select
   
Select Case IDay
   Case 1
      SDay = "01"
    Case 2
      SDay = "02"
    Case 3
      SDay = "03"
    Case 4
      SDay = "04"
    Case 5
      SDay = "05"
    Case 6
      SDay = "06"
    Case 7
      SDay = "07"
    Case 8
      SDay = "08"
    Case 9
      SDay = "09"
    Case Else
      SDay = IDay
   End Select

ThisWorkbook.Sheets("Data").Cells(R2, c33).Value = Smonth & "-" & SDay & "-" & Iyear

NextIteration:
Next
Next

'To handle "fixed object will move" error

Dim wksht As Excel.Worksheet
Dim wb As Excel.Workbook
Set wb = ThisWorkbook

    For Each wksht In wb.Worksheets
        For Each cmt In wksht.Comments
           cmt.Shape.Placement = xlMoveAndSize
        Next cmt
    Next wksht
    
'Borders
Cf2 = ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row
Cf3 = "A7" & " : " & "AF" & Cf2
'ThisWorkbook.Sheets("Data").Range (Cf3)

Dim rRng As Range

    Set rRng = ThisWorkbook.Sheets("Data").Range(Cf3)

    'Clear existing
    rRng.Borders.LineStyle = xlNone

    'Apply new borders
    rRng.BorderAround xlContinuous
    rRng.Borders(xlInsideHorizontal).LineStyle = xlContinuous
    rRng.Borders(xlInsideVertical).LineStyle = xlContinuous



ThisWorkbook.Sheets("Conditions").Visible = xlSheetVeryHidden
ThisWorkbook.Sheets("Temp_CSV").Visible = xlSheetVeryHidden

'Remove duplicates
Dim rng As Range
Dim cel As Range
'Set Rng = ThisWorkbook.Sheets("Data").Range(Range("H1"), Range("H200000"))
Set rng = Range(Range("H1"), Range("H" & ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row))
    For Each cel In rng
        If WorksheetFunction.CountIf(rng, cel.Value) > 1 Then
            cel.Interior.ColorIndex = 3
        End If
    Next cel
    

MsgBox "Done"

End If

Else
MsgBox "Please enter the values in Vendor name (C7 cells)"
End If



End Sub

Sub clear_data()
If MsgBox("Do you want remove the data from this sheet?", vbYesNo) = vbNo Then Exit Sub

Cf5 = ThisWorkbook.Sheets("Data").UsedRange.Rows.Count
Cf7 = ThisWorkbook.Sheets("Data").Range("C5").End(xlDown).Row
Rng01 = "A7" & " : " & "AF" & Cf5

Dim rngToDelete As Range
Set rngToDelete = Range(Rng01)

rngToDelete.EntireRow.Clear
rngToDelete.EntireRow.Select
Selection.Delete Shift:=xlUp

'Converting to Date format
ThisWorkbook.Sheets("Data").Range("O7 : Q200000").NumberFormat = "YYYY-MM-DD"

'******************Data validation - List option********************
'Finishing Type
Dim Dvrange1 As Range, Dvrng1 As Range
Set WSD = ThisWorkbook.Worksheets("Conditions")
Cf4 = ThisWorkbook.Sheets("Data").UsedRange.Rows.Count


Rng01 = "AD7" & " : " & "AD200000"

Set Dvrange1 = ThisWorkbook.Worksheets("Conditions").Range("F7:F22")
Set Dvrng1 = ThisWorkbook.Worksheets("Data").Range(Rng01)

With Dvrng1.Validation
    .Delete 'delete previous validation
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange1.Address
End With

'Bindery
Dim Dvrange2 As Range, Dvrng2 As Range

Rng02 = "AE7" & " : " & "AE200000"

Set Dvrange2 = ThisWorkbook.Worksheets("Conditions").Range("H7:H24")
Set Dvrng2 = ThisWorkbook.Worksheets("Data").Range(Rng02)

With Dvrng2.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange2.Address
End With

'Delivery method
Dim Dvrange3 As Range, Dvrng3 As Range

Rng03 = "AB7" & " : " & "AB200000"

Set Dvrange3 = ThisWorkbook.Worksheets("Conditions").Range("J7:J33")
Set Dvrng3 = ThisWorkbook.Worksheets("Data").Range(Rng03)

With Dvrng3.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange3.Address
End With



'Document Type
Dim Dvrange4 As Range, Dvrng4 As Range

Rng04 = "J7" & " : " & "J200000"

Set Dvrange4 = ThisWorkbook.Worksheets("Conditions").Range("L7:L24")
Set Dvrng4 = ThisWorkbook.Worksheets("Data").Range(Rng04)

With Dvrng4.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange4.Address
End With


'Type of insert
Dim Dvrange5 As Range, Dvrng5 As Range

Rng05 = "W7" & " : " & "W200000"

Set Dvrange5 = ThisWorkbook.Worksheets("Conditions").Range("N7:N21")
Set Dvrng5 = ThisWorkbook.Worksheets("Data").Range(Rng05)

With Dvrng5.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
        Formula1:="='" & WSD.Name & "'!" & Dvrange5.Address
End With

ThisWorkbook.Save 'This step has been stated to be necessary for the range to reset.

MsgBox "Cleared"

End Sub


Sub Cell_Split()
Dim ws As Worksheet
Dim aCell As Range, rng As Range
Dim Lrow As Long, i As Long
Dim myAr() As String

Dim ws2 As Worksheet
Dim bCell As Range, rng2 As Range
Dim variable As String

'~~> Change this to the relevant worksheet
Set ws = ThisWorkbook.Sheets("Conditions")
With ws
    '~~> Find the last row in Col A
    Lrow = .Range("H" & .Rows.Count).End(xlUp).Row
    Set rng = .Range("H7:H" & Lrow)
End With


Set ws2 = ThisWorkbook.Sheets("Data")
With ws2
    '~~> Find the last row in Col A
    Lrow = .Range("AE" & .Rows.Count).End(xlUp).Row
    '~~> Set your range
    Set rng2 = .Range("AE7:AE" & Lrow)
    '~~> Loop trhough your range
    For Each bCell In rng2
        If Len(Trim(bCell.Value)) <> 0 Then
            variable = aCell.Value
            For Each aCell In rng
                '~~> Skip the row if value in cell A is blank
                If Len(Trim(aCell.Value)) <> 0 Then
                    '~~> Check if the cell has ";"
                    '~~> If it has ";" then loop through values
                    If InStr(1, bCell.Value, ";") Then
                        myAr = Split(bCell.Value, ";")
                        For i = LBound(myAr) To UBound(myAr)
                            If myAr(i) = variable Then
                            Else
                                'You were pasting nothing with that
                                '.bCell(, 2).PasteSpecial xlPasteValues
                                .Cells(bCell.Row, 2) = aCell.Offset(0, 1).Value

                            End If
                        Next i
                    Else
                        'Same here
                        '.bCell(, 2).PasteSpecial xlPasteValues
                        .Cells(bCell.Row, 2) = aCell.Offset(0, 1).Value

                    End If
                End If
            Next aCell

        End If
    Next bCell
End With
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

'Finishing and Bindary
Dim Oldvalue As String
Dim Newvalue As String
Application.EnableEvents = True
On Error GoTo Exitsub
If Target.Column = 31 Then
  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then
    GoTo Exitsub
  Else: If Target.Value = "" Then GoTo Exitsub Else
    Application.EnableEvents = False
    Newvalue = Target.Value
    Application.Undo
    Oldvalue = Target.Value
      If Oldvalue = "" Then
        Target.Value = Newvalue
      Else
        If InStr(1, Oldvalue, Newvalue) = 0 Then
            Target.Value = Oldvalue & "; " & Newvalue
      Else:
        Target.Value = Oldvalue
      End If
    End If
  End If
End If

'Type of Insert
Dim Oldvalue1 As String
Dim Newvalue1 As String
Application.EnableEvents = True
On Error GoTo Exitsub
If Target.Column = 23 Then
  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then
    GoTo Exitsub
  Else: If Target.Value = "" Then GoTo Exitsub Else
    Application.EnableEvents = False
    Newvalue1 = Target.Value
    Application.Undo
    Oldvalue1 = Target.Value
      If Oldvalue1 = "" Then
        Target.Value = Newvalue1
      Else
        If InStr(1, Oldvalue1, Newvalue1) = 0 Then
            Target.Value = Oldvalue1 & "; " & Newvalue1
      Else:
        Target.Value = Oldvalue1
      End If
    End If
  End If
End If

'Finish Type
Dim Oldvalue2 As String
Dim Newvalue2 As String
Application.EnableEvents = True
On Error GoTo Exitsub
If Target.Column = 30 Then
  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then
    GoTo Exitsub
  Else: If Target.Value = "" Then GoTo Exitsub Else
    Application.EnableEvents = False
    Newvalue2 = Target.Value
    Application.Undo
    Oldvalue2 = Target.Value
      If Oldvalue2 = "" Then
        Target.Value = Newvalue2
      Else
        If InStr(1, Oldvalue2, Newvalue2) = 0 Then
            Target.Value = Oldvalue2 & "; " & Newvalue2
      Else:
        Target.Value = Oldvalue2
      End If
    End If
  End If
End If

Application.EnableEvents = True
Exitsub:
Application.EnableEvents = True
End Sub

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{930B49DC-3D61-4596-B06C-A6C39B8BC196}{B224B807-1A2A-4E83-9817-7B1E599F1EAD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()


    
cf6 = ThisWorkbook.Sheets("Data").UsedRange.Rows.Count
Cf7 = "B7" & " : " & "AG" & cf6
Cf8 = "A2" & " : " & "AF" & (cf6 - 5)


ThisWorkbook.Sheets("Temp_CSV").Range(Cf8).Value = ThisWorkbook.Sheets("Data").Range(Cf7).Value

ThisWorkbook.Sheets("Temp_CSV").Visible = True
    
Dim ws As Excel.Worksheet
Dim SaveToDirectory As String

Dim CurrentWorkbook As String
Dim CurrentFormat As Long

CurrentWorkbook = ThisWorkbook.FullName
CurrentFormat = ThisWorkbook.FileFormat

'Find share path location
Fname = UserForm1.TextBox1.Value
SaveToDirectory = Fname & "\"
     
'Date & Time stamp validation
Dim currentTime As String
'currentTime = Format(Now(), "yyyyMMdd hhmmss")
currentTime = Format(Now(), "yyyyMMdd")

    ThisWorkbook.Sheets("Temp_CSV").Copy
    Fname1 = ThisWorkbook.Sheets("Data").Cells(7, 3).Value
    ActiveWorkbook.SaveAs Filename:=SaveToDirectory & Fname1 & "_" & "EPM_" & currentTime & ".csv", FileFormat:=xlCSV
    
    'ActiveWorkbook.ActiveSheet.Range("N:N").NumberFormat = "yyyy-mm-dd"
        
    ActiveWorkbook.Close savechanges:=True
    ThisWorkbook.Activate
'Next
ThisWorkbook.Sheets("Temp_CSV").Range(Cf8).Delete
ThisWorkbook.Sheets("Temp_CSV").Visible = xlSheetVeryHidden

UserForm1.Hide

End Sub

Private Sub CommandButton2_Click()
UserForm1.Hide
End Sub


INQUEST-PP=macro
