Attribute VB_Name = "Blad1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
If [C17] = "Maand" Then
Sheets("BTW (maand)").Visible = True
Else
Sheets("BTW (maand)").Visible = False
End If
If [C17] = "Kwartaal" Then
Sheets("BTW (kwartaal)").Visible = True
Else
Sheets("BTW (kwartaal)").Visible = False
End If
If [C17] = "Jaar" Then
Sheets("BTW (jaar)").Visible = True
Else
Sheets("BTW (jaar)").Visible = False
End If

Dim C As Range, inter As Range, r As Range
   Set C = Range("c17")
   Set inter = Intersect(C, Target)
   If inter Is Nothing Then Exit Sub
   Application.EnableEvents = False
      For Each r In inter
         If r.Value = "" Then r.Value = "Kwartaal"
      Next r
   Application.EnableEvents = True

End Sub


Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
    LinkTo = Target.SubAddress
    WhereBang = InStr(1, LinkTo, "'!")
    If WhereBang > 0 Then
        MySheet = Mid(LinkTo, 2, WhereBang - 2)
     Else
    WhereBang = InStr(1, LinkTo, "!")
    If WhereBang > 0 Then
MySheet = Left(LinkTo, WhereBang - 1)
Else: Exit Sub
End If
End If
Worksheets(MySheet).Visible = True
Worksheets(MySheet).Select
MyAddr = Mid(LinkTo, WhereBang + 1)

End Sub

Attribute VB_Name = "Blad10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Blad11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()
    MsgBox "WORDT NIET MEER GEBRUIKT"
'    Range("B4").Value = "Kies relatie"
'    Range("C12").Value = "d" 'Format(Date, "dd-MM-yyyy")
'    Range("C13").ClearContents
'
'    Range("B17:D25").ClearContents
End Sub

Private Sub CommandButton2_Click()
    MsgBox "WORDT NIET MEER GEBRUIKT"
    
' On Error GoTo ErrHandler:
'        Dim FolderPath As String
'
'        FolderPath = Application.ActiveWorkbook.path
'        If Right(FolderPath, 1) <> "\" Then
'            FolderPath = FolderPath & "\"
'        End If
'
'        FolderPath = FolderPath & "Facturen"
'
'        If Dir(FolderPath, vbDirectory) = vbNullString Then
'            MkDir FolderPath
'        End If
'
'
'        i = 1
'        If isEmpty(Range("C13")) Then
'            pdfname = "Factuur"
'        Else
'            pdfname = "Factuur " & Range("C13")
'        End If
'
'        If Dir(FolderPath & "\" & pdfname & ".pdf") <> "" Then
'            Do While Dir(FolderPath & "\" & pdfname & ".pdf") <> ""
'
'                If isEmpty(Range("C13")) Then
'                    pdfname = "Factuur " & " (" & i & ")"
'                Else
'                    pdfname = "Factuur " & Range("C13") & " (" & i & ")"
'                End If
'
'                i = i + 1
'                If i = 100 Then
'                    Exit Do
'                End If
'            Loop
'        End If
'       With ActiveSheet.PageSetup
'            .LeftMargin = Application.InchesToPoints(0.1)
'            .RightMargin = Application.InchesToPoints(0.1)
'            .TopMargin = Application.InchesToPoints(0.3)
'            .BottomMargin = Application.InchesToPoints(0.1)
'            .HeaderMargin = Application.InchesToPoints(0.1)
'            .FooterMargin = Application.InchesToPoints(0.1)
'            .CenterHorizontally = True
'            .CenterVertically = False
'        End With
'
'        ActiveSheet.Range("B1:E44").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FolderPath & "\" & pdfname & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
'            :=False, OpenAfterPublish:=True
'        Exit Sub
'
'ErrHandler:
'    MsgBox "Er is iets mis gegaan"
'    Resume Next
      
End Sub


Private Sub CommandButton3_Click()
     MsgBox "WORDT NIET MEER GEBRUIKT"
'   'On Error GoTo ErrHandler:
'
'        'Check if record already exists
'        dubFound = False
'        dubOverwrite = False
'        dubRow = 0
'
'        Dim Datum As String
'        Dim factnr As String
'
'        Datum = Range("C12").Value
'        factnr = Range("C13").Value
'
'        If Datum = "" Then
'            MsgBox "Er is geen datum ingevuld."
'            Exit Sub
'        End If
'        If factnr = "" Then
'            MsgBox "Er is geen factuurnumer ingevuld."
'            Exit Sub
'        End If
'
'
'        With Worksheets("Verkoop & Opbrengsten").Range("D6:D206")
'             Set C = .Find(Range("C13").Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)
'             If Not C Is Nothing Then
'                dubRow = C.Row
'                dubFound = True
'              End If
'        End With
'
'        If dubFound = True Then
'            Dim mbResult As Integer
'            mbResult = MsgBox("Er is al een factuur met dit nummer aanwezig, wilt u deze overschrijven?", vbYesNoCancel)
'            Select Case mbResult
'                Case vbYes
'                    dubOverwrite = True
'                Case vbNo
'                    Exit Sub
'                Case vbCancel
'                    Exit Sub
'            End Select
'
'           'Dim msg As CustomMsg
'           ' Set msg = New CustomMsg
'           ' msg.Caption = "Verwerken in boekhouding"
'           ' With msg
'            '  .StartUpPosition = 0
'            '  .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
'            '  .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
'            'End With
'
'             '   msg.Show
'             '   Select Case msg.Tag
'              '      Case 1
'              '          dubOverwrite = False
'              '          Unload msg
'              '          Set msg = Nothing
'              '        Case 2
'              '          dubOverwrite = True
'              '          Unload msg
'              '          Set msg = Nothing
'              '        Case 3
'              '          Unload msg
'              '          Set msg = Nothing
'              '          Exit Sub
'              '      End Select
'        End If
'
'        'Find first empty row
'        If dubFound = False And dubOverwrite = True Then
'            LastRow = dubRow
'        Else
'            LastRow = Sheets("Verkoop & Opbrengsten").Cells(Rows.Count, 3).End(xlUp).Offset(1).Row
'        End If
'
'        'Get first category
'        Dim rng As Range
'        Dim v As Integer
'        Dim cat As Integer
'        Dim catName As String
'        Set rng = Sheets("Categorie|fffd|n").Range("B6:B250")
'        v = 8000
'        For Each cll In rng
'        If CInt(cll.Value) >= v Then
'            cat = cll.Value
'            catName = Sheets("Categorie|fffd|n").Range("C" & cll.Row)
'            Exit For
'        End If
'        Next
'
'        'Insert record
'        With Sheets("Verkoop & Opbrengsten")
'            .Cells(LastRow, 2).Value = Datum   'Datum
'            .Cells(LastRow, 3).Value = "Factuur"            'Soort
'            .Cells(LastRow, 4).Value = factnr   'Omschrijving
'            .Cells(LastRow, 5).Value = Range("B4").Value    'Relatie
'            .Cells(LastRow, 6).Value = Range("E26").Value   'Bedrag ex
'            .Cells(LastRow, 7).Value = Range("E27").Value   'Btw tarief
'            .Cells(LastRow, 9).Value = "Openstaand"         'status
'            .Cells(LastRow, 10).Value = cat & " " & catName 'categorie
'        End With
'
'        MsgBox "Factuur is verwerkt"
'        Exit Sub
'ErrHandler:
'    MsgBox "Er is iets mis gegaan"
'    Exit Sub
End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
   Dim C As Range, inter As Range, r As Range
   Set C = Range("B4")
   Set inter = Intersect(C, Target)
   If inter Is Nothing Then Exit Sub

   Application.EnableEvents = False
      For Each r In inter
         If r.Value = "" Then r.Value = "Kies relatie"
      Next r
   Application.EnableEvents = True
End Sub





Attribute VB_Name = "Blad12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Deactivate()
ThisWorkbook.Sheets("Exporteer naar e-Boekhouden.nl").Visible = False 'verbergen
End Sub

Attribute VB_Name = "Blad2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim oldRange As Range
Dim ignoreChanges As Boolean

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   If Not oldRange Is Nothing Then
        If Not Intersect(oldRange, Range("G6:G600", "H6:H600")) Is Nothing Then
            For Each Row In oldRange
                Call BtwBerekening(Row.Row)
            Next
        End If
   End If
   Set oldRange = Target
End Sub


Public Sub BtwBerekening(Row As Integer)
    
    Worksheets("Verkoop & Opbrengsten").Unprotect
        
    Dim bedrag As Double
    Dim Btw As String
    
    bedrag = Range("G" & Row).Value
    Btw = Range("H" & Row).Value2
    
    If bedrag <> 0 And Btw <> "Geen btw" Then
        Range("I" & Row).Value = Round(bedrag * Range("H" & Row).Value2, 2)
    Else
        Range("I" & Row).Value = ""
    End If
        
    Worksheets("Verkoop & Opbrengsten").Protect

End Sub

Public Sub SetIgnoreChanges(Ignore As Boolean)
    ignoreChanges = Ignore

End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
   
   If ignoreChanges = True Then Exit Sub
   
   
   On Error GoTo ErrHandler
   Application.ScreenUpdating = False
   Application.EnableEvents = False
   
   'Btw berekening
   If Target.Column = 7 Or Target.Column = 8 Then
        Call BtwBerekening(Target.Row)
   End If
   
   'Check soort
   If Target.Column = 3 Then
        If Range("C" & Target.Row).Value = "Factuur" Then
            If Range("D" & Target.Row).Value = "" Then
                Range("D" & Target.Row).Value = "Verplicht"
            End If
            If Range("E" & Target.Row).Value = "Verplicht" Then
                Range("E" & Target.Row).Value = ""
            End If
        ElseIf Range("C" & Target.Row).Value <> "" Then
            If Range("E" & Target.Row).Value = "" Then
                Range("E" & Target.Row).Value = "Verplicht"
            End If
            If Range("D" & Target.Row).Value = "Verplicht" Then
                Range("D" & Target.Row).Value = ""
            End If
        End If
   End If
   
   'Check Factuurnummer
   If Target.Column = 4 Then
        If Range("C" & Target.Row).Value = "Factuur" And Range("D" & Target.Row).Value = "" Then
            Range("D" & Target.Row).Value = "Verplicht"
        End If
   End If
   
   'Check Omschrijving
   If Target.Column = 5 Then
        If Range("C" & Target.Row).Value <> "Factuur" And Range("C" & Target.Row).Value <> "" And Range("E" & Target.Row).Value = "" Then
            Range("E" & Target.Row).Value = "Verplicht"
        End If
   End If
   
   'Dubbele mutaties controle
    If Target.Row < 6 Then Exit Sub             ' IF ITS A HEADER, DO NOTHING.
    
    Worksheets("Verkoop & Opbrengsten").Unprotect
    
    Dim factnr As String
    Dim btwPerc As String
     
    factnr = Range("D" & Target.Row).Value
    btwPerc = Range("H" & Target.Row).Value
    
    If factnr <> "" And btwPerc <> "" Then

        Range("D" & Target.Row).Offset(0, 0).Font.Color = vbBlack
        Range("H" & Target.Row).Offset(0, 0).Font.Color = vbBlack
        
        For i = 6 To 500
            If Target.Row <> i And Cells(i, 4) = factnr And Cells(i, 8) = btwPerc Then
                Range("D" & Target.Row).Offset(0, 0).Font.Color = vbRed
                Range("H" & Target.Row).Offset(0, 0).Font.Color = vbRed
                Exit For
            End If
        Next

    End If
 
   Worksheets("Verkoop & Opbrengsten").Protect
   
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
ErrHandler:
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    
End Sub

Attribute VB_Name = "Blad3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Dim oldRange As Range

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   If Not oldRange Is Nothing Then
        If Not Intersect(oldRange, Range("G6:G600", "H6:H600")) Is Nothing Then
            For Each Row In oldRange
                
                Call BtwBerekening(Row.Row)
            Next
        End If
   End If
   Set oldRange = Target
End Sub


Private Sub BtwBerekening(Row As Integer)
    
    Worksheets("Inkoop & Uitgaven").Unprotect
        
    Dim bedrag As Double
    Dim Btw As String
    
    bedrag = Range("G" & Row).Value
    Btw = Range("H" & Row).Value2
    
    If bedrag <> 0 And Btw <> "Geen btw" Then
        Range("I" & Row).Value = Round(bedrag * Range("H" & Row).Value2, 2)
    Else
        Range("I" & Row).Value = ""
    End If
        
    Worksheets("Inkoop & Uitgaven").Protect

End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
   
    On Error GoTo ErrHandler
    Application.ScreenUpdating = False
    Application.EnableEvents = False
   
    'Btw berekening
    If Target.Column = 7 Or Target.Column = 8 Then
        Call BtwBerekening(Target.Row)
    End If
   
    'Check soort
    If Target.Column = 3 Then
        If Range("C" & Target.Row).Value = "Factuur" Then
            If Range("D" & Target.Row).Value = "" Then
                Range("D" & Target.Row).Value = "Verplicht"
            End If
            If Range("E" & Target.Row).Value = "Verplicht" Then
                Range("E" & Target.Row).Value = ""
            End If
        ElseIf Range("C" & Target.Row).Value <> "" Then
            If Range("E" & Target.Row).Value = "" Then
                Range("E" & Target.Row).Value = "Verplicht"
            End If
            If Range("D" & Target.Row).Value = "Verplicht" Then
                Range("D" & Target.Row).Value = ""
            End If
        End If
   End If
   
   'Check Factuurnummer
   If Target.Column = 4 Then
        If Range("C" & Target.Row).Value = "Factuur" And Range("D" & Target.Row).Value = "" Then
            Range("D" & Target.Row).Value = "Verplicht"
        End If
   End If
   
   'Check Omschrijving
   If Target.Column = 5 Then
        If Range("C" & Target.Row).Value <> "Factuur" And Range("C" & Target.Row).Value <> "" And Range("E" & Target.Row).Value = "" Then
            Range("E" & Target.Row).Value = "Verplicht"
        End If
   End If
   
    If Target.Row < 6 Then Exit Sub             ' IF ITS A HEADER, DO NOTHING.
    
    Worksheets("Inkoop & Uitgaven").Unprotect
    
    Dim factnr As String
    Dim btwPerc As String
    Dim Relatie As String
          
    factnr = Range("D" & Target.Row).Value
    btwPerc = Range("H" & Target.Row).Value
    Relatie = Range("F" & Target.Row).Value
   
    Range("D" & Target.Row).Offset(0, 0).Font.Color = vbBlack
    Range("H" & Target.Row).Offset(0, 0).Font.Color = vbBlack
    Range("F" & Target.Row).Offset(0, 0).Font.Color = vbBlack
    
    If factnr <> "" And btwPerc <> "" And Relatie <> "" Then
 
      '  MsgBox Cells(i, 4).Value & " == " & FactNr
        For i = 6 To 500
            If Target.Row <> i And Cells(i, 4) = factnr And Cells(i, 8) = btwPerc And Cells(i, 6) = Relatie Then
                Range("D" & Target.Row).Offset(0, 0).Font.Color = vbRed
                Range("H" & Target.Row).Offset(0, 0).Font.Color = vbRed
                Range("F" & Target.Row).Offset(0, 0).Font.Color = vbRed
                Exit For
            End If
        Next

    End If
    
    Worksheets("Inkoop & Uitgaven").Protect
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
   
ErrHandler:
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    
End Sub

Attribute VB_Name = "Blad4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Blad5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Blad6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Blad7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
ThisWorkbook.Sheets("Beginbalans").Visible = False 'verbergen
End Sub

Attribute VB_Name = "Blad8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Blad9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "CustomMsg"
Attribute VB_Base = "0{90CB6CAC-17C8-4044-B313-A09D26930C18}{52616E03-F933-4C78-A718-0711A825109B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit


Private Sub cmdCancel_Click()
    Me.Tag = 3
    Me.Hide
End Sub

Private Sub cmdOverwrite_Click()
    Me.Tag = 2
    Me.Hide
End Sub

Private Sub commandAdd_Click()
     Me.Tag = 1
    Me.Hide
End Sub


Private Sub Userform_QueryClose(Cancel As Integer, CloseMode As Integer)
  If CloseMode = vbFormControlMenu Then Cancel = True
  Me.Tag = 3
  Me.Hide
End Sub


Attribute VB_Name = "FactuurRegel"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Datum As Date
Public Prijs As Double
Public Omschrijving As String
Public BtwPercentage As String





Attribute VB_Name = "Module1"
Sub Knopwissen()
    
    Worksheets("Factuur maken").Unprotect
    Range("B4").Value = "Kies relatie"
    Range("C12").Value = Date
    Range("B17:E28").ClearContents
    
    Dim factnr As String
    factnr = Range("C13").Value
    
    If factnr <> "" Then
        If FindDuplicate(factnr) = True Then
            index = 1
            factnr = AddNr(factnr)
            Do Until FindDuplicate(factnr) = False
            
                If index = 100 Then
                    Exit Do
                End If
                factnr = AddNr(factnr)
            Loop
            
        End If
    End If
    
    Range("C13").Value = factnr

    Worksheets("Factuur maken").Protect
End Sub
Sub Knopverwerkeninboekhouding()

  'On Error GoTo ErrHandler:

        Dim Datum, factnr, Relatie As String
        Dim totaal As Double

        Datum = Range("C12").Value
        factnr = Range("C13").Value
        Relatie = Range("B4").Value

        For i = 17 To 28

            Btw = Range("E" & i).Value2
            bedrag = Range("F" & i)
            'MsgBox bedrag
            If Btw = "" And bedrag <> "" Then
               MsgBox "Er is geen btw-percentage opgegeven in de factuur"
               Exit Sub
            End If
        Next

        If WorksheetFunction.CountA(Range("D17:D28")) = 0 Then
            MsgBox "Er zijn geen factuurregels aanwezig"
            Exit Sub
        End If

        If Relatie = "Kies relatie" Then
            MsgBox "Er is geen relatie geselecteerd."
            Exit Sub
        End If
        If Datum = "" Then
            MsgBox "Er is geen datum ingevuld."
            Exit Sub
        End If
        If factnr = "" Then
            MsgBox "Er is geen factuurnumer ingevuld."
            Exit Sub
        End If

        With Worksheets("Verkoop & Opbrengsten").Range("D6:D255")
             Set C = .Find(Range("C13").Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)
             If Not C Is Nothing Then
                MsgBox "Er is al een factuur met dit nummer aanwezig!"
                Exit Sub
              End If
        End With

        'Find first empty row
        LastRow = Sheets("Verkoop & Opbrengsten").Cells(Rows.Count, 3).End(xlUp).Offset(1).Row

        'Get first category
        Dim rng As Range
        Dim v As Integer
        Dim cat As Integer
        Dim catName As String
        Set rng = Sheets("Categorie|fffd|n").Range("B6:B250")
        v = 8000 ' 8xxx voor omzetrekeningen
        For Each cll In rng
        If CInt(cll.Value) >= v Then
            cat = cll.Value
            catName = Sheets("Categorie|fffd|n").Range("C" & cll.Row)
            Exit For
        End If
        Next


        bedrag0 = 0
        bedrag6 = 0
        bedrag21 = 0

        Dim omschrijving0, omschrijving6, omschrijving21 As String

        For i = 17 To 28

            Btw = Range("E" & i).Value2
            bedrag = Range("F" & i)
            Omschrijving = Range("C" & i).Value
            'MsgBox bedrag
            If Btw <> "" And bedrag <> "" Then
                If Btw = "0,21" Then
                    bedrag21 = bedrag21 + bedrag
                    omschrijving21 = omschrijving21 & "" & Range("C" & i).Value
                ElseIf Btw = "0,06" Then
                    bedrag6 = bedrag6 + bedrag
                    omschrijving6 = omschrijving6 & "" & Range("C" & i).Value
                Else
                    bedrag0 = bedrag0 + bedrag
                    omschrijving0 = omschrijving0 & "" & Range("C" & i).Value
                End If
            End If
        Next

        ' Turn off WorkSheet_Change event. This somehow clears the B4 field in this sheet

        'Insert records
        If bedrag21 <> 0 Then
            With Sheets("Verkoop & Opbrengsten")
                .SetIgnoreChanges (True)
                .Cells(LastRow, 2).Value = Datum                'Datum
                .Cells(LastRow, 3).Value = "Factuur"            'Soort
                .Cells(LastRow, 4).Value = factnr               'Factuurnummer
                .Cells(LastRow, 5).Value = omschrijving21         'Omschrijving
                .Cells(LastRow, 6).Value = Range("B4").Value    'Relatie
                .Cells(LastRow, 7).Value = bedrag21              'Bedrag ex
                .Cells(LastRow, 8).Value = "21%"                'Btw tarief
                .Cells(LastRow, 10).Value = "Openstaand"        'status
                .Cells(LastRow, 11).Value = cat & " " & catName 'categorie
                .SetIgnoreChanges (False)
                .BtwBerekening (LastRow)
            End With
            LastRow = LastRow + 1
        End If

        If bedrag6 <> 0 Then
            With Sheets("Verkoop & Opbrengsten")
                .SetIgnoreChanges (True)
                .Cells(LastRow, 2).Value = Datum                'Datum
                .Cells(LastRow, 3).Value = "Factuur"            'Soort
                .Cells(LastRow, 4).Value = factnr               'Factuurnummer
                .Cells(LastRow, 5).Value = omschrijving6         'Omschrijving
                .Cells(LastRow, 6).Value = Range("B4").Value    'Relatie
                .Cells(LastRow, 7).Value = bedrag6 'Bedrag ex
                .Cells(LastRow, 8).Value = "6%"                 'Btw tarief
                .Cells(LastRow, 10).Value = "Openstaand"        'status
                .Cells(LastRow, 11).Value = cat & " " & catName 'categorie
                .SetIgnoreChanges (False)
                .BtwBerekening (LastRow)
            End With
            LastRow = LastRow + 1
        End If

        If bedrag0 <> 0 Then
            With Sheets("Verkoop & Opbrengsten")
                .SetIgnoreChanges (True)
                .Cells(LastRow, 2).Value = Datum                'Datum
                .Cells(LastRow, 3).Value = "Factuur"            'Soort
                .Cells(LastRow, 4).Value = factnr               'Factuurnummer
                .Cells(LastRow, 5).Value = omschrijving0         'Omschrijving
                .Cells(LastRow, 6).Value = Range("B4").Value    'Relatie
                .Cells(LastRow, 7).Value = bedrag0              'Bedrag ex
                .Cells(LastRow, 8).Value = "Geen btw"                'Btw tarief
                .Cells(LastRow, 10).Value = "Openstaand"        'status
                .Cells(LastRow, 11).Value = cat & " " & catName 'categorie
                .SetIgnoreChanges (False)
                .BtwBerekening (LastRow)
            End With
        End If

        MsgBox "Factuur is verwerkt"
        Exit Sub
ErrHandler:
    MsgBox "Er is iets mis gegaan"
    Exit Sub
End Sub
Sub KnopOpslaan()
    On Error GoTo ErrHandler:
        Dim FolderPath As String
    
        FolderPath = Application.ActiveWorkbook.path
        If Right(FolderPath, 1) <> "/" Then
            FolderPath = FolderPath & "/"
        End If
        
        Dim jaar As Integer
        jaar = Sheets("BasisInstellingen").Range("C5").Value

#If Mac Then
        FolderPath = CreateFolderinMacOffice2016(NameFolder:="Facturen" & jaar)
#Else

        FolderPath = FolderPath & "Facturen" & jaar
        
        If Dir(FolderPath, vbDirectory) = vbNullString Then
            MkDir FolderPath
        End If
#End If
        
        i = 1
        If isEmpty(Range("C13")) Then
            pdfname = "Factuur"
        Else
            pdfname = "Factuur " & Range("C13")
        End If
        
        If Dir(FolderPath & "/" & pdfname & ".pdf") <> "" Then
            Do While Dir(FolderPath & "/" & pdfname & ".pdf") <> ""
                
                If isEmpty(Range("C13")) Then
                    pdfname = "Factuur " & " (" & i & ")"
                Else
                    pdfname = "Factuur " & Range("C13") & " (" & i & ")"
                End If
                
                i = i + 1
                If i = 100 Then
                    Exit Do
                End If
            Loop
        End If
       With ActiveSheet.PageSetup
            .LeftMargin = Application.InchesToPoints(0.1)
            .RightMargin = Application.InchesToPoints(0.1)
            .TopMargin = Application.InchesToPoints(0.3)
            .BottomMargin = Application.InchesToPoints(0.1)
            .HeaderMargin = Application.InchesToPoints(0.1)
            .FooterMargin = Application.InchesToPoints(0.1)
            .CenterHorizontally = True
            .CenterVertically = False
        End With

        ActiveSheet.Range("B1:F47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FolderPath & "/" & pdfname & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
            :=False, OpenAfterPublish:=True

#If Mac Then

    If Range("M11").Cells(1, 1).Hyperlinks.Count = 0 Then
        Range("M11").Cells(1, 1).Hyperlinks.Add Range("M11").Cells(1, 1), "file:///" & FolderPath, "", "Open PDF folder", "Open PDF Folder"
        Range("M11").Font.Size = 14
        Range("M11").Font.Bold = True
        Range("M11").HorizontalAlignment = xlCenter
        Range("M11").VerticalAlignment = xlCenter


    End If
#End If

        Exit Sub
        
ErrHandler:
    MsgBox "Er is iets mis gegaan"
    Resume Next
 
End Sub

Function CreateFolderinMacOffice2016(NameFolder As String) As String
    'Function to create folder if it not exists in the Microsoft Office Folder
    'Ron de Bruin : 8-Jan-2016
    Dim OfficeFolder As String
    Dim PathToFolder As String
    Dim TestStr As String

    OfficeFolder = MacScript("return POSIX path of (path to desktop folder) as string")
    OfficeFolder = Replace(OfficeFolder, "/Desktop", "") & _
        "Library/Group Containers/UBF8T346G9.Office/"

    PathToFolder = OfficeFolder & NameFolder

    On Error Resume Next
    TestStr = Dir(PathToFolder, vbDirectory)
    On Error GoTo 0
    If TestStr = vbNullString Then
        MkDir PathToFolder
        'You can use this msgbox line for testing if you want
        'MsgBox "You find the new folder in this location :" & PathToFolder
    End If
    CreateFolderinMacOffice2016 = PathToFolder
End Function


Public Function AddNr(ByVal sValue)
        Dim sStart As Integer
        Dim qNo As String
        Dim sNewValue
        Dim sPart01, sPart02
        Dim sTmpLen
        sStart = 0
        qNo = ""
        
        If sValue = "" Then Exit Function

        For C = Len(sValue) To 1 Step -1
            If IsNumeric(Mid(sValue, C, 1)) = False Then
                sStart = C
                Exit For
            End If
        Next
        If sStart = 0 Then sStart = 1: qNo = 1
        If sStart = Len(sValue) Then
            If IsNumeric(sValue) Then
                sNewValue = sValue + 1
            Else
                sNewValue = sValue
            End If
        Else
            If qNo = "1" Then
                sPart01 = ""
                sPart02 = sValue
            Else
                sPart01 = Left(sValue, sStart)
                sPart02 = Mid(sValue, sStart + 1)
            End If
            sTmpLen = Len(sPart02)
            sPart02 = CDbl(sPart02) + 1

            If sTmpLen < Len(CStr(sPart02)) Then
                sNewValue = sPart01 & sPart02
            Else
                sNewValue = sPart01 & StringConcat(sTmpLen - Len(CStr(sPart02)), "0") & CStr(sPart02)
            End If
        End If

        AddNr = sNewValue
    End Function
    
    Public Function StringConcat(ByVal sCnt As Long, ByVal sChar As String) As String
        StringConcat = ""
        For i = 1 To sCnt
            StringConcat = StringConcat & sChar
        Next
    End Function

Function FindDuplicate(factnr) As Boolean
    
    With Worksheets("Verkoop & Opbrengsten").Range("D6:D206")
         Set C = .Find(factnr, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)
         If Not C Is Nothing Then
            FindDuplicate = True
            Exit Function
          End If
    End With
    
    FindDuplicate = False
End Function
Attribute VB_Name = "Module2"
Sub ExportOpenen()
Attribute ExportOpenen.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets("Exporteer naar e-Boekhouden.nl").Visible = True
    ActiveWorkbook.Sheets("Exporteer naar e-Boekhouden.nl").Activate
End Sub
Attribute VB_Name = "Module3"
Sub unlockvoorlogo()
Attribute unlockvoorlogo.VB_ProcData.VB_Invoke_Func = " \n14"
'
' unlockvoorlogo Macro
'

'
    Range("B1").Select
    ActiveSheet.Unprotect
    Range("C1").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub
Attribute VB_Name = "Module4"
Dim sSessionId As String
Dim sError As String
Dim sUrl As String
Dim sUsername As String
Dim sSecurityCode1 As String
Dim sSecurityCode2 As String
Dim Relaties As Collection
Dim OnlineRelaties As Collection
Dim Mutaties As Collection
Dim BalansMutaties As Collection
Dim jaar As Integer

Sub ExportToEb()
    
    sUrl = "https://soap.e-boekhouden.nl/soapExcel.asmx"
    'sUrl = "http://localhost:62211/soapExcel.asmx"
    sUsername = Range("C11").Value
    sSecurityCode1 = Range("C13").Value
    sSecurityCode2 = Range("C15").Value
    jaar = Sheets("BasisInstellingen").Cells(5, 3).Value
    sError = ""
    
    If sUsername = "" Then
        MsgBox "Gebruikersnaam is niet ingevuld."
        Exit Sub
    End If
    If sSecurityCode1 = "" Then
        MsgBox "Beveiligingscode1 is niet ingevuld."
        Exit Sub
    End If
    If sSecurityCode2 = "" Then
        MsgBox "Beveiligingscode2 is niet ingevuld."
        Exit Sub
    End If
    
    If sError <> "" Then
        MsgBox sError
        Exit Sub
    End If
    
    Application.DisplayStatusBar = True
    Application.StatusBar = "Bezig met gegevens te importeren"

    Call OpenSession
    Call GetOnlineRelaties
    Call FillRelaties
    Call FillMutaties
    
    If sError <> "" Then
        MsgBox sError
        Application.DisplayStatusBar = False
        Exit Sub
    End If
    
    'check if account is empty
    Dim isEmpty As Boolean
    isEmpty = IsEmptyAccount
    If isEmpty = False Then
      If MsgBox("Uw account bevat al gegevens, wilt u deze overschrijven?", vbYesNo) = vbNo Then
          Application.DisplayStatusBar = False
          Exit Sub
      End If
    End If
    ' By default the SOAP/API will delete existing mutations when we continue here
    
    
    If sError <> "" Then
        MsgBox sError
        Application.DisplayStatusBar = False
        Exit Sub
    End If
    
    ' add beginbalans
    Call AddBalance
    
    If sError <> "" Then
        MsgBox sError
        Application.DisplayStatusBar = False
        Exit Sub
    End If
    
    ' add relaties
    Call AddRelatie
    
    If sError <> "" Then
        MsgBox sError
        Application.DisplayStatusBar = False
        Exit Sub
    End If
    
    ' add mutaties
    Call AddMutaties
    
    If sError <> "" Then
        MsgBox sError
        Application.DisplayStatusBar = False
        Exit Sub
    End If

    Call EndSession
    
    MsgBox "De gegevens zijn geimporteerd in e-Boekhouden.nl."
    Application.DisplayStatusBar = False
End Sub


Function AddMutaties()

    Dim sEnv As String
    Dim xmlDoc
    
    For Each bmut In BalansMutaties
    
        Set xmlDoc = CreateObject("MSXML2.DOMDocument")
        Set objHttp = CreateObject("MSXML2.XMLHTTP")
        
        With bmut
            
            sEnv = ""
            sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
            sEnv = sEnv & "  <soapenv:Header/>"
            sEnv = sEnv & "  <soapenv:Body>"
            sEnv = sEnv & "   <soap:AddBeginBalansCredDeb>"
            sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
            sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
            sEnv = sEnv & "    <soap:oMut>"
            sEnv = sEnv & "         <soap:MutatieNr>0</soap:MutatieNr>"
            sEnv = sEnv & "         <soap:Soort>" & .Soort & "</soap:Soort>"
            sEnv = sEnv & "         <soap:Datum>" & Format(.Datum, "yyyy-MM-dd") & "</soap:Datum>"
            sEnv = sEnv & "         <soap:Rekening>0</soap:Rekening>"
            sEnv = sEnv & "         <soap:RelatieCode>" & .RelCode & "</soap:RelatieCode>"
            sEnv = sEnv & "         <soap:Factuurnummer>" & .FactuurNummer & "</soap:Factuurnummer>"
            sEnv = sEnv & "         <soap:Boekstuk></soap:Boekstuk>"
            sEnv = sEnv & "         <soap:Omschrijving></soap:Omschrijving>"
            sEnv = sEnv & "         <soap:Betalingstermijn>0</soap:Betalingstermijn>"
            sEnv = sEnv & "         <soap:InExBTW>EX</soap:InExBTW>"
            sEnv = sEnv & "         <soap:MutatieRegels>"
            
            For Each Regel In .MutatieRegels
                sEnv = sEnv & "             <soap:cMutatieRegel>"
                sEnv = sEnv & "                 <soap:BedragInvoer>" & Replace((Regel.BedragEx + Regel.BtwBedrag), ",", ".") & "</soap:BedragInvoer>"
                sEnv = sEnv & "                 <soap:BedragExclBTW>0</soap:BedragExclBTW>"
                sEnv = sEnv & "                 <soap:BedragBTW>0</soap:BedragBTW>"
                sEnv = sEnv & "                 <soap:BedragInclBTW>" & Replace((Regel.BedragEx + Regel.BtwBedrag), ",", ".") & "</soap:BedragInclBTW>"
                sEnv = sEnv & "                 <soap:BTWCode></soap:BTWCode>"
                sEnv = sEnv & "                 <soap:BTWPercentage>0</soap:BTWPercentage>"
                sEnv = sEnv & "                 <soap:TegenrekeningCode></soap:TegenrekeningCode>"
                sEnv = sEnv & "                 <soap:KostenplaatsID>0</soap:KostenplaatsID>"
                sEnv = sEnv & "             </soap:cMutatieRegel>"
            Next
            sEnv = sEnv & "         </soap:MutatieRegels>"
            sEnv = sEnv & "    </soap:oMut>"
            sEnv = sEnv & "   </soap:AddBeginBalansCredDeb>"
            sEnv = sEnv & "  </soapenv:Body>"
            sEnv = sEnv & "</soapenv:Envelope>"
        End With
                
        With objHttp
            .Open "POST", sUrl, False
            .setRequestHeader "Content-Type", "text/xml"
            .send sEnv
            
            xmlDoc.LoadXML .ResponseText
       
            If (InStr(.ResponseText, "LastErrorDescription") > 0) Then
                sError = sError & vbNewLine & IIf(bmut.Omzet, "Verkoop & Opbrengsten ", "Inkoop & Uitgaven ") & "Regel " & bmut.Regel & " Fout: " & xmlDoc.getElementsByTagName("LastErrorDescription").Item(0).Text
            End If
        End With
    Next
    
    Dim mut As Mutatie
    For Each mut In Mutaties
                
        Set xmlDoc = CreateObject("MSXML2.DOMDocument")
        Set objHttp = CreateObject("MSXML2.XMLHTTP")
        
        With mut
            sEnv = ""
            sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
            sEnv = sEnv & "  <soapenv:Header/>"
            sEnv = sEnv & "  <soapenv:Body>"
            sEnv = sEnv & "   <soap:AddMutatie>"
            sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
            sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
            sEnv = sEnv & "    <soap:oMut>"
            sEnv = sEnv & "         <soap:MutatieNr>0</soap:MutatieNr>"
            sEnv = sEnv & "         <soap:Soort>" & .Soort & "</soap:Soort>"
            sEnv = sEnv & "         <soap:Datum>" & Format(.Datum, "yyyy-MM-dd") & "</soap:Datum>"
            sEnv = sEnv & "         <soap:Rekening>" & .Rekening & "</soap:Rekening>" 'openstaand = 1300 m,  bank =1010,kas = 1000
            sEnv = sEnv & "         <soap:RelatieCode>" & .RelCode & "</soap:RelatieCode>"
            sEnv = sEnv & "         <soap:Factuurnummer>" & IIf(.Soort Like "Factuur*", .FactuurNummer, "") & "</soap:Factuurnummer>" 'alleen bij soort = factuur, anders leeg
            sEnv = sEnv & "         <soap:Boekstuk></soap:Boekstuk>" ' leeg
            sEnv = sEnv & "         <soap:Omschrijving>" & .Omschrijving & "</soap:Omschrijving>" 'leeg bij factuur
            sEnv = sEnv & "         <soap:Betalingstermijn>0</soap:Betalingstermijn>" 'leeg of 0
            sEnv = sEnv & "         <soap:InExBTW>EX</soap:InExBTW>"
            sEnv = sEnv & "         <soap:MutatieRegels>"
            
            For Each Regel In .MutatieRegels
               ' MsgBox Regel.BedragEx
                sEnv = sEnv & "             <soap:cMutatieRegel>"
                sEnv = sEnv & "                 <soap:BedragInvoer>" & Replace(Regel.BedragEx, ",", ".") & "</soap:BedragInvoer>"
                sEnv = sEnv & "                 <soap:BedragExclBTW>" & Replace(Regel.BedragEx, ",", ".") & "</soap:BedragExclBTW>"
                sEnv = sEnv & "                 <soap:BedragBTW>" & Replace(Regel.BtwBedrag, ",", ".") & "</soap:BedragBTW>"
                sEnv = sEnv & "                 <soap:BedragInclBTW>" & Replace((Regel.BedragEx + Regel.BtwBedrag), ",", ".") & "</soap:BedragInclBTW>"
                sEnv = sEnv & "                 <soap:BTWCode>" & Regel.BtwCode & "</soap:BTWCode>"
                sEnv = sEnv & "                 <soap:BTWPercentage>" & Regel.BtwPercentage & "</soap:BTWPercentage>"
                sEnv = sEnv & "                 <soap:TegenrekeningCode>" & Regel.TegenRekening & "</soap:TegenrekeningCode>" 'cat code
                sEnv = sEnv & "                 <soap:KostenplaatsID>0</soap:KostenplaatsID>"
                sEnv = sEnv & "             </soap:cMutatieRegel>"
            Next
            sEnv = sEnv & "         </soap:MutatieRegels>"
            sEnv = sEnv & "    </soap:oMut>"
            sEnv = sEnv & "   </soap:AddMutatie>"
            sEnv = sEnv & "  </soapenv:Body>"
            sEnv = sEnv & "</soapenv:Envelope>"
            
            'MsgBox .FactuurNummer
        End With
                
        With objHttp
            .Open "POST", sUrl, False
            .setRequestHeader "Content-Type", "text/xml"
            .send sEnv
            
            xmlDoc.LoadXML .ResponseText
            
            If (InStr(.ResponseText, "LastErrorDescription") > 0) Then
                sError = sError & vbNewLine & IIf(mut.Omzet, "Verkoop & Opbrengsten ", "Inkoop & Uitgaven ") & "Regel " & mut.Regel & " Fout: " & xmlDoc.getElementsByTagName("LastErrorDescription").Item(0).Text
            End If
        End With
    
    Next
    
    'MsgBox "Balans : " & BalansMutaties.Count & " Mutaties : " & Mutaties.Count
End Function


Sub FillMutaties()

    Set Mutaties = New Collection
    Set BalansMutaties = New Collection
    Dim empyCnt As Integer
    
    With Sheets("Verkoop & Opbrengsten")
        
        emptyCnt = 0
                
        For i = 6 To 500
            If Sheets("Verkoop & Opbrengsten").Cells(i, 12).Value = "Er ontbreken gegevens" Then
                sError = "1 of meer regels op het Verkoop & Opbrengsten blad zijn nog niet volledig"
                Exit Sub
            End If
            If Sheets("Verkoop & Opbrengsten").Cells(i, 12).Value = "Datum buiten boekjaar" Then
                sError = "1 of meer regels op het Inkoop & Uitgaven blad vallen buiten dit boekjaar"
                Exit Sub
            End If
            If .Cells(i, 2) = "" Then
                emptyCnt = emptyCnt + 1
                If emptyCnt > 5 Then
                    Exit For
                End If
            Else
                Set Mutatie = New Mutatie
                With Mutatie
                    .Omzet = True
                    .Regel = i
                    Set .MutatieRegels = New Collection
                    Dim factnr As String
                            
                    .Datum = Sheets("Verkoop & Opbrengsten").Cells(i, 2).Value
                    
                    If Sheets("Verkoop & Opbrengsten").Cells(i, 3).Value = "Factuur" And Sheets("Verkoop & Opbrengsten").Cells(i, 10).Value = "Openstaand" Then
                        .Soort = "FactuurVerstuurd"
                        .Omschrijving = Sheets("Verkoop & Opbrengsten").Cells(i, 5).Value
                        .FactuurNummer = Sheets("Verkoop & Opbrengsten").Cells(i, 4).Value
                    Else
                        .Soort = "GeldOntvangen"
                        .FactuurNummer = Sheets("Verkoop & Opbrengsten").Cells(i, 4).Value
                        .Omschrijving = Sheets("Verkoop & Opbrengsten").Cells(i, 5).Value
                    End If
                    
                    If Sheets("Verkoop & Opbrengsten").Cells(i, 3).Value = "Factuur" And .Omschrijving = "" Then
                        .Omschrijving = "Factuur: " & .FactuurNummer
                    End If
                    
                    ' Dit is nodig voor de controle op dubbelen
                    If Sheets("Verkoop & Opbrengsten").Cells(i, 3).Value <> "Factuur" And .FactuurNummer = "" Then
                        .FactuurNummer = .Omschrijving
                    End If
                    
                    If Sheets("Verkoop & Opbrengsten").Cells(i, 3).Value = "Factuur" And Sheets("Verkoop & Opbrengsten").Cells(i, 10).Value = "Openstaand" Then
                        .Rekening = "1300"
                    ElseIf Sheets("Verkoop & Opbrengsten").Cells(i, 10).Value = "Betaald via Bank" Then
                        .Rekening = "1010"
                    Else
                        .Rekening = "1000"
                    End If
                    
                    factnr = .FactuurNummer
                    
                    Dim TegenRekening As String
                    .Categorie = Sheets("Verkoop & Opbrengsten").Cells(i, 11)
                    If .Categorie <> "" Then
                        TegenRekening = Left(.Categorie, 4)
                    End If
                    
                    Naam = Sheets("Verkoop & Opbrengsten").Cells(i, 6)
                    If Naam <> "" Then
                        .RelCode = GetRelatie(Naam)
                    End If
                    
                    If Sheets("Verkoop & Opbrengsten").Cells(i, 3).Value = "Factuur" And Sheets("Verkoop & Opbrengsten").Cells(i, 10).Value = "Openstaand" And .RelCode = "" Then
                        sError = "Gegevens zijn incorrect, 1 of meer relaties zijn niet gevonden."
                        Exit Sub
                    End If
                    
                    .Status = Sheets("Verkoop & Opbrengsten").Cells(i, 10)
                    
                    'Mutatie Regels
                    Dim Regel As New MutatieRegel
                    With Regel
                        
                        .TegenRekening = TegenRekening
                        .BedragEx = Sheets("Verkoop & Opbrengsten").Cells(i, 7)
                    
                        If Sheets("Verkoop & Opbrengsten").Cells(i, 8) = "Geen btw" Then
                            .BtwPercentage = 0
                        Else
                            .BtwPercentage = Sheets("Verkoop & Opbrengsten").Cells(i, 8) * 100
                        End If
                        
                        .BtwBedrag = Sheets("Verkoop & Opbrengsten").Cells(i, 9)
                        
                        If .BtwPercentage = "21" Then
                            .BtwCode = "HOOG_VERK_21"
                        ElseIf .BtwPercentage = "6" Then
                            .BtwCode = "LAAG_VERK"
                        Else
                            .BtwCode = "GEEN"
                        End If
                    End With
                    
                  
                    If .Datum < DateSerial(jaar, 1, 1) And .Status = "Openstaand" Then
                        .Soort = "FactuurVerstuurd"
                        .MutatieRegels.Add Regel
                        BalansMutaties.Add Mutatie
                    ElseIf .Datum >= DateSerial(jaar, 1, 1) Then
                          Dim Duplicate As Mutatie
                          Set Duplicate = FindDuplicateInvoice(Mutatie.FactuurNummer, Mutatie.Datum, Mutatie.Omzet)
                          
                          'Als er al een mutatie aanwezig is met dit factuurnummer, dan als mutatieregel aan de bestaande
                          'mutatie toevoegen, Geen nieuwe mutatie aanmaken
                          
                          If Not Duplicate Is Nothing Then
                              Duplicate.MutatieRegels.Add Regel
                          Else
                          
                              .MutatieRegels.Add Regel
                              Mutaties.Add Mutatie
                          End If

                    End If
                    Set Mutatie = Nothing
                    Set Regel = Nothing
                    
                End With
            End If
        Next
    End With

    With Sheets("Inkoop & Uitgaven")
        
        emptyCnt = 0
                  
        For i = 6 To 500
            If Sheets("Inkoop & Uitgaven").Cells(i, 12).Value = "Er ontbreken gegevens" Then
                sError = "1 of meer regels op het Inkoop & Uitgaven blad zijn nog niet volledig"
                Exit Sub
            End If
            If Sheets("Inkoop & Uitgaven").Cells(i, 12).Value = "Datum buiten boekjaar" Then
                sError = "1 of meer regels op het Inkoop & Uitgaven blad vallen buiten dit boekjaar"
                Exit Sub
            End If
            If .Cells(i, 2) = "" Then
                emptyCnt = emptyCnt + 1
                If emptyCnt > 5 Then
                    Exit For
                End If
            Else
                Set Mutatie = New Mutatie
                With Mutatie
                    .Regel = i
                    Set .MutatieRegels = New Collection
                    .Datum = Sheets("Inkoop & Uitgaven").Cells(i, 2).Value
                    
                    If Sheets("Inkoop & Uitgaven").Cells(i, 3).Value = "Factuur" And Sheets("Inkoop & Uitgaven").Cells(i, 10).Value = "Openstaand" Then
                        .Soort = "FactuurOntvangen"
                        .Omschrijving = Sheets("Inkoop & Uitgaven").Cells(i, 5).Value
                        .FactuurNummer = Sheets("Inkoop & Uitgaven").Cells(i, 4).Value
                    Else
                        .Soort = "GeldUitgegeven"
                        .FactuurNummer = Sheets("Inkoop & Uitgaven").Cells(i, 4).Value
                        .Omschrijving = Sheets("Inkoop & Uitgaven").Cells(i, 5).Value
                    End If
                    
                    If Sheets("Inkoop & Uitgaven").Cells(i, 3).Value = "Factuur" And .Omschrijving = "" Then
                        .Omschrijving = "Factuur: " & .FactuurNummer
                    End If
                    
                    ' Dit is nodig voor de controle op dubbelen
                    If Sheets("Inkoop & Uitgaven").Cells(i, 3).Value <> "Factuur" And .FactuurNummer = "" Then
                        .FactuurNummer = .Omschrijving
                    End If
        
                    If Sheets("Inkoop & Uitgaven").Cells(i, 3).Value = "Factuur" And Sheets("Inkoop & Uitgaven").Cells(i, 10).Value = "Openstaand" Then
                        .Rekening = "1700"
                    ElseIf Sheets("Inkoop & Uitgaven").Cells(i, 10).Value = "Betaald via Bank" Then
                        .Rekening = "1010"
                    Else
                        .Rekening = "1000"
                    End If
                    
                    factnr = .FactuurNummer
                    
                    Dim TegenRekening2 As String
                    .Categorie = Sheets("Inkoop & Uitgaven").Cells(i, 11)
                    If .Categorie <> "" Then
                        TegenRekening2 = Left(.Categorie, 4)
                    End If
                    
                    Naam = Sheets("Inkoop & Uitgaven").Cells(i, 6)
                    If Naam <> "" Then
                        .RelCode = GetRelatie(Naam)
                    End If
                    
                    If Sheets("Inkoop & Uitgaven").Cells(i, 3).Value = "Factuur" And Sheets("Inkoop & Uitgaven").Cells(i, 10).Value = "Openstaand" And .RelCode = "" Then
                        sError = "Gegevens zijn incorrect, 1 of meer relaties zijn niet gevonden."
                        Exit Sub
                    End If
                    
                    .Status = Sheets("Inkoop & Uitgaven").Cells(i, 10)
                    
                    'Mutatie Regels
                    Dim Regel2 As New MutatieRegel
                    With Regel2
                        
                        .TegenRekening = TegenRekening2
                        .BedragEx = Sheets("Inkoop & Uitgaven").Cells(i, 7)
                    
                        If Sheets("Inkoop & Uitgaven").Cells(i, 8) = "Geen btw" Then
                            .BtwPercentage = 0
                        Else
                            .BtwPercentage = Sheets("Inkoop & Uitgaven").Cells(i, 8) * 100
                        End If
                        
                        .BtwBedrag = Sheets("Inkoop & Uitgaven").Cells(i, 9)
                        
                        If .BtwPercentage = "21" Then
                            .BtwCode = "HOOG_INK_21"
                        ElseIf .BtwPercentage = "6" Then
                            .BtwCode = "LAAG_INK"
                        Else
                            .BtwCode = "GEEN"
                        End If
                    End With
                    
                    If .Datum < DateSerial(jaar, 1, 1) And .Status = "Openstaand" Then
                        .Soort = "FactuurOntvangen"
                        .MutatieRegels.Add Regel2
                        BalansMutaties.Add Mutatie
                    ElseIf .Datum >= DateSerial(jaar, 1, 1) Then
                          Dim Duplicate2 As Mutatie
                          Set Duplicate2 = FindDuplicateInvoice(Mutatie.FactuurNummer, Mutatie.Datum, Mutatie.Omzet)
                          
                          'Als er al een mutatie aanwezig is met dit factuurnummer, dan als mutatieregel aan de bestaande
                          'mutatie toevoegen, Geen nieuwe mutatie aanmaken
                          
                          If Not Duplicate2 Is Nothing Then
                              Duplicate2.MutatieRegels.Add Regel2
                          Else
                          
                              .MutatieRegels.Add Regel2
                              Mutaties.Add Mutatie
                          End If
                    End If
                    Set Mutatie = Nothing
                    Set Regel2 = Nothing
                    
                End With
            End If
        Next
    End With
End Sub
    



Function FindDuplicateInvoice(number As String, mutdate As Date, Omzet As Boolean) As Mutatie
    For Each m In Mutaties
        If m.FactuurNummer = number And m.Datum = mutdate And m.Omzet = Omzet Then
            Set FindDuplicateInvoice = m
            Exit Function
        End If
    Next
End Function

Function FindDuplicateInvoiceBalans(number As String, mutdate As Date, Omzet As Boolean) As Mutatie
    For Each m In BalansMutaties
        If m.FactuurNummer = number And m.Datum = mutdate And m.Omzet = Omzet Then
            Set FindDuplicateInvoice = m
            Exit Function
        End If
    Next
End Function

Sub debugMut(tect)

     For Each mute In Mutaties
    'Regels komen niet overeen met hetgeen wat er in FillMutaties gebeurt, er staan nu 3 dezelfde mutatieregels in, snap niet waarom?
    For Each Regel3 In mute.MutatieRegels
        MsgBox Regel3.BedragEx & tect
    Next
    Next
End Sub

Function GetRelatie(name) As String

    For Each Rel In Relaties
        With Rel
        If .Naam = name Then
            GetRelatie = .code
            Exit Function
        End If
        End With
    Next
End Function

Function FindOnlineRelatie(code, email) As Boolean
    For Each Rel In OnlineRelaties
        With Rel
        If .code = code Or .email = email Then
            FindOnlineRelatie = True
            Exit Function
        End If
        End With
    Next
    FindOnlineRelatie = False
End Function


    
Function AddRelatie()
    
    For Each Rel In Relaties
        
        If Rel.DoExport = True Then
              
            Dim sEnv As String
            Dim xmlDoc
            Set xmlDoc = CreateObject("MSXML2.DOMDocument")
            Set objHttp = CreateObject("MSXML2.XMLHTTP")
            
            With Rel
                sEnv = ""
                sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
                sEnv = sEnv & "  <soapenv:Header/>"
                sEnv = sEnv & "  <soapenv:Body>"
                sEnv = sEnv & "   <soap:AddRelatie>"
                sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
                sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
                sEnv = sEnv & "    <soap:oRel>"
                sEnv = sEnv & "         <soap:ID>0</soap:ID>"
                sEnv = sEnv & "         <soap:AddDatum>" & Format(Date, "yyyy-MM-dd") & "</soap:AddDatum>"
                sEnv = sEnv & "         <soap:Code>" & .code & "</soap:Code>"
                sEnv = sEnv & "         <soap:Bedrijf>" & .Naam & "</soap:Bedrijf>"
                sEnv = sEnv & "         <soap:Adres>" & .Adres & "</soap:Adres>"
                sEnv = sEnv & "         <soap:Postcode>" & .Postcode & "</soap:Postcode>"
                sEnv = sEnv & "         <soap:Plaats>" & .Plaats & "</soap:Plaats>"
                
                If Left(.Telefoon, 2) = "06" Then
                    sEnv = sEnv & "         <soap:Gsm>" & .Telefoon & "</soap:Gsm>"
                Else
                    sEnv = sEnv & "         <soap:Telefoon>" & .Telefoon & "</soap:Telefoon>"
                End If
                
                sEnv = sEnv & "         <soap:Email>" & .email & "</soap:Email>"
                sEnv = sEnv & "         <soap:LA>0</soap:LA>"
                sEnv = sEnv & "         <soap:Gb_ID>0</soap:Gb_ID>"
                sEnv = sEnv & "         <soap:GeenEmail>1</soap:GeenEmail>"
                sEnv = sEnv & "         <soap:NieuwsbriefgroepenCount>0</soap:NieuwsbriefgroepenCount>"
            
                sEnv = sEnv & "    </soap:oRel>"
                sEnv = sEnv & "   </soap:AddRelatie>"
                sEnv = sEnv & "  </soapenv:Body>"
                sEnv = sEnv & "</soapenv:Envelope>"
            End With
                    
            With objHttp
                .Open "POST", sUrl, False
                .setRequestHeader "Content-Type", "text/xml"
                .send sEnv
                
                xmlDoc.LoadXML .ResponseText
               
                If (InStr(.ResponseText, "LastErrorDescription") > 0) Then
                    sError = xmlDoc.getElementsByTagName("LastErrorDescription").Item(0).Text
                End If
            End With
            
            index = index + 1
        End If
    Next Rel
    
    Set objHttp = Nothing
    Set xmlDoc = Nothing

End Function

Sub FillRelaties()

    Set Relaties = New Collection
    Dim emptyCnt As Integer
    Dim index As Integer
    emptyCnt = 0
    index = 1
    
     With Sheets("Relaties")
         For i = 6 To 500
              If .Cells(i, 3) = "" Then
                  emptyCnt = emptyCnt + 1
                  If emptyCnt > 5 Then
                      Exit For
                  End If
              Else
                  Set Rel = New Relatie
                  With Rel
                        .Naam = Sheets("Relaties").Cells(i, 3).Value
                        .Adres = Sheets("Relaties").Cells(i, 4).Value
                        .Postcode = Sheets("Relaties").Cells(i, 5).Value
                        .Plaats = Sheets("Relaties").Cells(i, 6).Value
                        .Telefoon = Sheets("Relaties").Cells(i, 7).Value
                        .email = Sheets("Relaties").Cells(i, 8).Value
                        .code = "Rel" & index
                        
                        'check of relatie al in EB bestaat
                        If FindOnlineRelatie(.code, .email) = True Then
                            Rel.DoExport = False
                        Else
                            Rel.DoExport = True
                        End If
                        
                        Relaties.Add Rel
                        index = index + 1
                  End With
              End If
         Next
     End With
End Sub

Function AddBalance()

    Dim sEnv As String
    Dim xmlDoc
    Set xmlDoc = CreateObject("MSXML2.DOMDocument")
    Set objHttp = CreateObject("MSXML2.XMLHTTP")
    
    sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
    sEnv = sEnv & "  <soapenv:Header/>"
    sEnv = sEnv & "  <soapenv:Body>"
    sEnv = sEnv & "   <soap:AddBeginBalans>"
    sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
    sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
    sEnv = sEnv & "    <soap:oMut>"
    sEnv = sEnv & "         <soap:Soort>OpeningsSaldo</soap:Soort>"
    sEnv = sEnv & "         <soap:Datum>" & Format(DateSerial(jaar, 1, 1), "yyyy-MM-dd") & "</soap:Datum>"
    sEnv = sEnv & "         <soap:MutatieNr>0</soap:MutatieNr>"
    sEnv = sEnv & "         <soap:MutatieRegels>"
    
                            Dim sRekening As String
                            Dim sBedrag As Double
                                
                            With Sheets("Beginbalans")
                            
                                For i = 7 To 22
                                    'Activa & Passiva
                                    sRekening = .Cells(i, 2).Value
                                    sBedrag = .Cells(i, 4).Value2 * -1 + .Cells(i, 5).Value
                                    
                                    If sRekening <> "" And sBedrag <> 0 Then
    sEnv = sEnv & "                     <soap:cMutatieRegel>"
    sEnv = sEnv & "                         <soap:BedragInvoer>" & Replace(sBedrag, ",", ".") & "</soap:BedragInvoer>"
    sEnv = sEnv & "                         <soap:TegenrekeningCode>" & sRekening & "</soap:TegenrekeningCode>"
    sEnv = sEnv & "                     </soap:cMutatieRegel>"
                                    End If
                                Next
                            End With
    
    sEnv = sEnv & "         </soap:MutatieRegels>"
    sEnv = sEnv & "    </soap:oMut>"
    sEnv = sEnv & "   </soap:AddBeginBalans>"
    sEnv = sEnv & "  </soapenv:Body>"
    sEnv = sEnv & "</soapenv:Envelope>"
        
    With objHttp
        .Open "POST", sUrl, False
        .setRequestHeader "Content-Type", "text/xml"
        .send sEnv
        
        xmlDoc.LoadXML .ResponseText
        
        If (InStr(.ResponseText, "LastErrorDescription") > 0) Then
            sError = xmlDoc.getElementsByTagName("LastErrorDescription").Item(0).Text
        End If
    End With
     
    Set objHttp = Nothing
    Set xmlDoc = Nothing

End Function


Function GetOnlineRelaties()
    
    Set OnlineRelaties = New Collection
    Dim sEnv As String
    Dim xmlDoc
    Set xmlDoc = CreateObject("MSXML2.DOMDocument")
    Set objHttp = CreateObject("MSXML2.XMLHTTP")
    
    sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
    sEnv = sEnv & "  <soapenv:Header/>"
    sEnv = sEnv & "  <soapenv:Body>"
    sEnv = sEnv & "   <soap:GetRelaties>"
    sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
    sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
    sEnv = sEnv & "         <soap:cFilter>"
    sEnv = sEnv & "             <soap:Trefwoord></soap:Trefwoord>"
    sEnv = sEnv & "             <soap:Code></soap:Code>"
    sEnv = sEnv & "             <soap:ID>0</soap:ID>"
    sEnv = sEnv & "         </soap:cFilter>"
    sEnv = sEnv & "   </soap:GetRelaties>"
    sEnv = sEnv & "  </soapenv:Body>"
    sEnv = sEnv & "</soapenv:Envelope>"
    
    With objHttp
        .Open "POST", sUrl, False
        .setRequestHeader "Content-Type", "text/xml"
        .send sEnv
        
        xmlDoc.LoadXML .ResponseText
        
        If (InStr(.ResponseText, "LastErrorDescription") > 0) Then
            sError = xmlDoc.getElementsByTagName("LastErrorDescription").Item(0).Text
        End If
        
        Set elements = xmlDoc.getElementsByTagName("cRelatie")
        For Each element In elements
            
            Set Rel = New Relatie
            With Rel
               .email = element.SelectSingleNode("Email").Text
               .code = element.SelectSingleNode("Code").Text
            End With
            OnlineRelaties.Add Rel
        Next
    End With
     
    Set objHttp = Nothing
    Set xmlDoc = Nothing
End Function

Function IsEmptyAccount()
    Dim sEnv As String
    Dim xmlDoc
    Set xmlDoc = CreateObject("MSXML2.DOMDocument")
    Set objHttp = CreateObject("MSXML2.XMLHTTP")
    
    sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
    sEnv = sEnv & "  <soapenv:Header/>"
    sEnv = sEnv & "  <soapenv:Body>"
    sEnv = sEnv & "   <soap:IsEmptyAccount>"
    sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
    sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
    sEnv = sEnv & "   </soap:IsEmptyAccount>"
    sEnv = sEnv & "  </soapenv:Body>"
    sEnv = sEnv & "</soapenv:Envelope>"
    
    With objHttp
        .Open "POST", sUrl, False
        .setRequestHeader "Content-Type", "text/xml"
        .send sEnv
        
        xmlDoc.LoadXML .ResponseText
         
        IsEmptyAccount = xmlDoc.getElementsByTagName("IsEmptyAccountResult").Item(0).Text
    End With
     
    Set objHttp = Nothing
    Set xmlDoc = Nothing
End Function


Sub OpenSession()

    Dim sEnv As String
    Dim xmlDoc
    Set xmlDoc = CreateObject("MSXML2.DOMDocument")
    Set objHttp = CreateObject("MSXML2.XMLHTTP")
    
    sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
    sEnv = sEnv & "  <soapenv:Header/>"
    sEnv = sEnv & "  <soapenv:Body>"
    sEnv = sEnv & "   <soap:OpenSession>"
    sEnv = sEnv & "    <soap:Username>" + sUsername + "</soap:Username>"
    sEnv = sEnv & "    <soap:SecurityCode1>" + sSecurityCode1 + "</soap:SecurityCode1>"
    sEnv = sEnv & "    <soap:SecurityCode2>" + sSecurityCode2 + "</soap:SecurityCode2>"
    sEnv = sEnv & "   </soap:OpenSession>"
    sEnv = sEnv & "  </soapenv:Body>"
    sEnv = sEnv & "</soapenv:Envelope>"
    
    With objHttp
        .Open "POST", sUrl, False
        .setRequestHeader "Content-Type", "text/xml"
        .send sEnv
        
        xmlDoc.LoadXML .ResponseText
         
        sError = xmlDoc.getElementsByTagName("LastErrorDescription").Item(0).Text
        sSessionId = xmlDoc.getElementsByTagName("SessionID").Item(0).Text
    End With
     
    Set objHttp = Nothing
    Set xmlDoc = Nothing
End Sub

Sub EndSession()
    Dim sEnv As String
    Dim xmlDoc
    Set xmlDoc = CreateObject("MSXML2.DOMDocument")
    Set objHttp = CreateObject("MSXML2.XMLHTTP")
            
    sEnv = sEnv & "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:soap=""http://www.e-boekhouden.nl/SoapExcel/"">"
    sEnv = sEnv & "  <soapenv:Header/>"
    sEnv = sEnv & "  <soapenv:Body>"
    sEnv = sEnv & "   <soap:CloseSession>"
    sEnv = sEnv & "    <soap:SessionID>" + sSessionId + "</soap:SessionID>"
    sEnv = sEnv & "   </soap:CloseSession>"
    sEnv = sEnv & "  </soapenv:Body>"
    sEnv = sEnv & "</soapenv:Envelope>"
    
    With objHttp
        .Open "POST", sUrl, False
        .setRequestHeader "Content-Type", "text/xml"
        .send sEnv
    End With
     
    Set objHttp = Nothing
    Set xmlDoc = Nothing
End Sub


Attribute VB_Name = "Module5"
Attribute VB_Name = "Module6"
Sub BalansOpenen()
    Sheets("Beginbalans").Visible = True
    ActiveWorkbook.Sheets("Beginbalans").Activate
End Sub




Attribute VB_Name = "Mutatie"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Datum As Date
Public Soort As String
Public Omschrijving As String
Public RelCode As String
Public Status As String
Public Categorie As String
Public Rekening As String
Public FactuurNummer As String
Public MutatieRegels As Collection
Public Omzet As Boolean ' om te voorkomen dat factuurnummers niet dubbel mgoen zijn voer inkoop en verkoop samen
Public Regel As Integer






Attribute VB_Name = "MutatieRegel"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public BedragEx As Double
Public BtwPercentage As String
Public BtwBedrag As Double
Public BtwCode As String
Public TegenRekening As String

Attribute VB_Name = "Relatie"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Naam As String
Public Adres As String
Public Postcode As String
Public Plaats As String
Public Telefoon As String
Public email As String
Public code As String
Public DoExport As Boolean

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

End Sub

Private Sub Workbook_Open()

End Sub


INQUEST-PP=macro
