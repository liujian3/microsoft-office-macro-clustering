Attribute VB_Name = "Auswertung"
Option Explicit
                
Sub StartAuswertung()

UserForm2.Show vbModeless

End Sub
                
Sub Tippauswertung()

Dim Punkte As Long, richtigeTipps As Long, richtigeTordifferenz As Long, richtigeTendenz As Long, letzteZeile As Long, Zeile As Long
Dim i As Long, j As Long, k As Long, z As Long, letzteZeileA As Long
Dim Daten_Array() As Single, Daten_ArrayP() As Single
Dim Name As String, Lieblingsverein As String, Ergebnistipps As String, Sondertipps As String, Ordnerpfad As String, Tabellenblatt As String
Dim TippLiga As String, Auswertungsliga As String, Tippdatei As String, Dateipfad As String, Land As String
Dim Teams As Integer, t As Integer, l As Integer, Spieltage As Integer, absSpieltage As Integer, CursorPos As String
Dim kErg As String, kDif As String, kTd As String, M As String, HM As String, CL1 As String, CL2 As String, CL3 As String, Q1 As String
Dim Q2 As String, Q3 As String, EL1 As String, EL2 As String, EL3 As String, R1 As String, R2 As String, R3 As String, A1 As String, A2 As String
Dim A3 As String, A As String, AR As String

Dim L|fffd|nderKZ As String
Dim ZeileX As Long, ZeileC As Long
Dim u As Integer, xx As Integer, x As Integer
Dim AktuellerSpieltag As Integer, VorherigerSpieltag As Integer
Dim rng As Range

Dim Zeile1 As Integer, Spiel As Integer, Zeile2 As Integer
Dim yy As Byte

Dim Zelle2
Dim Auswertungsdatei As Workbook, Tippschein As Workbook, Vorlage As Workbook
Dim VorlageSondertipps As Worksheet, VorlageSpielregeln As Worksheet, VorlageSpielplan As Worksheet
Dim Auswertungstool As Worksheet, Platzierung As Worksheet, Spielplan As Worksheet, Tippscheindatenblatt As Worksheet, Spielregeln As Worksheet, Hilfsdaten As Worksheet, Bundesligatabelle As Worksheet, wksSondertipps As Worksheet
Dim Bereich As Range, Zelle As Range

Dim Pfad As String          'Startpfad
Dim Daten As New Collection 'gesammelte Ergebinsse
Dim Eintrag

Set Auswertungsdatei = ThisWorkbook
Set Auswertungstool = Auswertungsdatei.Worksheets("Auswertungstool")
Set Platzierung = Auswertungsdatei.Worksheets("Platzierung")
Set Hilfsdaten = Auswertungsdatei.Worksheets("Hilfsdaten")

Saison = Left(Right(Sheets("Auswertungstool").Range("B2"), 7), 2) & "-" & Right(Sheets("Auswertungstool").Range("B2"), 2)

Dateipfad = Auswertungsdatei.Path & "\"
With Auswertungstool
    If .Range("E11").Value = "" Then
        blnAbbruch = True
        MsgBox "Es fehlt der Ordnerpfad f|fffd|r die Tippscheine."
        .Range("E11").Select
        Exit Sub
    ElseIf Right(.Range("E11").Value, 1) = "\" Then
        Ordnerpfad = .Range("E11").Value
    Else
        Ordnerpfad = .Range("E11").Value & "\"
    End If
    
    If Dateipfad = Ordnerpfad Then
        blnAbbruch = True
        MsgBox ("Die Auswertungsdatei, darf nicht im Ordner der Tippscheine gespeichert sein, da sonst keine Auswertung m|fffd|glich ist. Bitte schlie|fffd|en Sie die Auswertungsdatei und speichern die Datei in einem anderen Ordner.")
        .Range("E11").Select
        Exit Sub
    ElseIf Dir(Ordnerpfad) = "" Or Ordnerpfad = "\" Then
        blnAbbruch = True
        MsgBox "Der Ordner ist nicht vorhanden. Bitte tragen Sie den Ordnerpfad der Tippschein-Dateien ein."
        .Range("E11").Select
        Exit Sub
    End If
'    Sheets("Daten").Unprotect Password:=Passwort
'    Sheets("Daten").Range("B1:XFD1048576").ClearContents
    Sheets("Daten").Columns("B:XFD").Delete Shift:=xlToLeft
    Sheets("Daten").Range("A8:A24").ClearContents
    
    If .Range("E9").Value = "1. Bundesliga" Then
        TippLiga = "1BL" & Saison
        Auswertungsliga = "1. Bundesliga"
        Teams = 18
        Sheets("Daten").Range("A3").Value = "1BL"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value 'Meister
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value 'Herbstmeister
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value 'CL
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L21").Value 'CL
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L24").Value 'CL Quali
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L26").Value 'EL
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L26").Value 'EL
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L29").Value 'Relegation
        Sheets("Daten").Range("A16").Value = Sheets(Auswertungsliga).Range("L31").Value 'Abstieg
        Sheets("Daten").Range("A17").Value = Sheets(Auswertungsliga).Range("L31").Value 'Abstieg
        
    ElseIf .Range("E9").Value = "2. Bundesliga" Then
        TippLiga = "2BL" & Saison
        Auswertungsliga = "2. Bundesliga"
        Teams = 18
        Sheets("Daten").Range("A3").Value = "2BL"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L23").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L25").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L27").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L28").Value
        
    ElseIf .Range("E9").Value = "3. Bundesliga" Then
        TippLiga = "3BL" & Saison
        Auswertungsliga = "3. Bundesliga"
        Teams = 20
        Sheets("Daten").Range("A3").Value = "3BL"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L24").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L27").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L28").Value
        
    ElseIf .Range("E9").Value = "S|fffd|perLig" Then
        TippLiga = "1TK" & Saison
        Auswertungsliga = "S|fffd|perLig"
        Teams = 18
        Sheets("Daten").Range("A3").Value = "1TK"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L23").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L24").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L27").Value
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L28").Value
        
    ElseIf .Range("E9").Value = "Eredivisie" Then
        TippLiga = "1NL" & Saison
        Auswertungsliga = "Eredivisie"
        Teams = 18
        Sheets("Daten").Range("A3").Value = "1NL"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L23").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L24").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L27").Value
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L29").Value
        
    ElseIf .Range("E9").Value = "Premier League" Then
        TippLiga = "1ENG" & Saison
        Auswertungsliga = "Premier League"
        Teams = 20
        Sheets("Daten").Range("A3").Value = "1ENG"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L22").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L24").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L28").Value
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L29").Value
        Sheets("Daten").Range("A16").Value = Sheets(Auswertungsliga).Range("L30").Value
        
    ElseIf .Range("E9").Value = "Primera Division" Then
        TippLiga = "1ESP" & Saison
        Auswertungsliga = "Primera Division"
        Teams = 20
        Sheets("Daten").Range("A3").Value = "1ESP"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L22").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L24").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L27").Value
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L29").Value
        Sheets("Daten").Range("A16").Value = Sheets(Auswertungsliga).Range("L30").Value
        Sheets("Daten").Range("A17").Value = Sheets(Auswertungsliga).Range("L31").Value
        
    ElseIf .Range("E9").Value = "Ligue 1" Then
        TippLiga = "1FR" & Saison
        Auswertungsliga = "Ligue 1"
        Teams = 20
        Sheets("Daten").Range("A3").Value = "1FR"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L24").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L29").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L30").Value
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L31").Value
        
    ElseIf .Range("E9").Value = "Serie A" Then
        TippLiga = "1IT" & Saison
        Auswertungsliga = "Serie A"
        Teams = 20
        Sheets("Daten").Range("A3").Value = "1IT"
        Sheets("Daten").Range("A8").Value = Sheets(Auswertungsliga).Range("L17").Value
        Sheets("Daten").Range("A9").Value = Sheets(Auswertungsliga).Range("L19").Value
        Sheets("Daten").Range("A10").Value = Sheets(Auswertungsliga).Range("L21").Value
        Sheets("Daten").Range("A11").Value = Sheets(Auswertungsliga).Range("L23").Value
        Sheets("Daten").Range("A12").Value = Sheets(Auswertungsliga).Range("L25").Value
        Sheets("Daten").Range("A13").Value = Sheets(Auswertungsliga).Range("L26").Value
        Sheets("Daten").Range("A14").Value = Sheets(Auswertungsliga).Range("L28").Value
        Sheets("Daten").Range("A15").Value = Sheets(Auswertungsliga).Range("L29").Value
        Sheets("Daten").Range("A16").Value = Sheets(Auswertungsliga).Range("L30").Value
        
    Else
        blnAbbruch = True
        MsgBox "Bitte w|fffd|hlen Sie die Liga aus f|fffd|r die eine Tippauswertung erstellt werden soll."
        .Range("E9").Select
        Exit Sub
    End If
    
    Sheets("Daten").Range("A1").Value = Sheets(Auswertungsliga).Range("J2").Value
    Land = .Range("J9").Value
End With

Set Spielplan = Auswertungsdatei.Worksheets(Auswertungsliga)

If Teams = 18 Then
    Spieltage = 34
ElseIf Teams = 20 Then
    Spieltage = 38
End If

Auswertungsdatei.Unprotect Password:=Passwort

With Spielplan
    .Visible = True
    
    If WorksheetFunction.CountA(.Range("E13:G22")) <> 27 And Teams = 18 Then
        blnAbbruch = True
        MsgBox ("Bitte erg|fffd|nzen Sie die Spielergebnisse, bevor Sie die Auswertung starten.")
        .Select
        Auswertungsdatei.Protect Password:=Passwort
        Exit Sub
    ElseIf WorksheetFunction.CountA(.Range("E13:G22")) <> 30 And Teams = 20 Then
        blnAbbruch = True
        MsgBox ("Bitte erg|fffd|nzen Sie die Spielergebnisse, bevor Sie die Auswertung starten.")
        .Select
        Auswertungsdatei.Protect Password:=Passwort
        Exit Sub
    ElseIf MsgBox("Sind alle Ergebnisse bereits in den Spielplan eingetragen?", vbYesNo, "Ergebnisabfrage") = vbNo Then
        blnAbbruch = True
        MsgBox ("Bitte erg|fffd|nzen Sie die Spielergebnisse, bevor Sie die Auswertung starten.")
        .Select
        Auswertungsdatei.Protect Password:=Passwort
        Exit Sub
    End If
    
    absSpieltage = .Range("J2").Value 'auch mit angefangenen Spieltagen!
'    absSpieltage = .Range("J1").Value 'nur volle Spieltage!
    
End With
Debug.Print Now
With Platzierung
    .Select
    .Unprotect Password:=Passwort
    If .Range("A" & Rows.Count).End(xlUp).Row > 5 Then
        ZeileC = .Range("A" & Rows.Count).End(xlUp).Row
        .Rows("6:" & ZeileC).Interior.Pattern = xlNone
    Else
        ZeileC = 6
    End If
    If .Range("CI1").Value <> "" Then
        L|fffd|nderKZ = .Range("CI1").Value
        Sheets(L|fffd|nderKZ).Visible = True
        Sheets(L|fffd|nderKZ).Unprotect Password:=Passwort
        .Range("A6:CH" & ZeileC).Copy
        Sheets(L|fffd|nderKZ).Range("A6").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Sheets(L|fffd|nderKZ).Protect Password:=Passwort
        Sheets(L|fffd|nderKZ).Visible = False
    End If
'    .Range("A6:CH" & Rows.Count).ClearContents
    .Rows("6:" & Rows.Count).Delete Shift:=xlUp
'    .Range("A6:CH" & Rows.Count).Interior.Pattern = xlNone
    .Range("CI1").Value = Left(TippLiga, Len(TippLiga) - 5)
    L|fffd|nderKZ = Range("CI1").Value
    If Teams = 18 Then
        .Columns("BY:CF").EntireColumn.Hidden = True
    ElseIf Teams = 20 Then
        .Columns("BY:CF").EntireColumn.Hidden = False
    End If
End With

ChDir Ordnerpfad

With Hilfsdaten
    .Visible = True
    .Select
'    .Range("A:A").ClearContents
    .Columns("A:A").Delete Shift:=xlToLeft
    .Range("A1").Select
End With

Call FileList(Daten, Ordnerpfad)                 'Alles im aktuellen Ordner

If Daten.Count = 0 Then
    MsgBox ("In Ordner " & Ordnerpfad & " wurden keine Dateien gefunden.")
    Exit Sub
End If
z = 1
For Each Eintrag In Daten
    Hilfsdaten.Range("A" & z).Value = Eintrag
    z = z + 1
Next Eintrag

letzteZeile = Hilfsdaten.Range("A" & Rows.Count).End(xlUp).Row

i = 1
j = 6
k = 1
x = 1
For i = 1 To letzteZeile
    x = x + 1
    Application.EnableEvents = False
    Debug.Print Hilfsdaten.Range("A" & i).Value
    Application.Workbooks.Open Hilfsdaten.Range("A" & i).Value
    Application.EnableEvents = True
    CursorPos = ActiveCell.Address
    
    Set Tippschein = ActiveWorkbook
    Set Tippscheindatenblatt = Tippschein.Worksheets("Spielplan")
    Set Spielregeln = Tippschein.Worksheets("Spielregeln")
    Set wksSondertipps = Tippschein.Worksheets("Sondertipps")
    
    If Tippscheindatenblatt.Range("AS25").Value <> TippLiga Then
        Tippschein.Close savechanges:=False
        Auswertungsdatei.Activate
        x = x - 1
        GoTo sprung:
    End If
    
    'Office 2016x
    Application.Workbooks.Open Auswertungsdatei.Path & "\Office\" & TippLiga & ".xlsm"

    Set Vorlage = ActiveWorkbook
    Set VorlageSondertipps = Vorlage.Sheets("Sondertipps")
    Set VorlageSpielregeln = Vorlage.Sheets("Spielregeln")
    Set VorlageSpielplan = Vorlage.Sheets("Spielplan")
'    Auswertungsdatei.Activate
    With VorlageSpielplan
        .Unprotect Password:=Passwort
        .Range("G8").Value = Tippscheindatenblatt.Range("G8").Value
        .Range("G10").Value = Tippscheindatenblatt.Range("G10").Value
        'Spieltipps |fffd|bertragen
        Tippscheindatenblatt.Range("H13:J577").Copy
        Vorlage.Activate
        .Activate
        .Range("H13").Activate
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
        .Protect Password:=Passwort
    End With
    
    Vorlage.Sheets("Hinweise").Range("M34").Value = Tippschein.Sheets("Hinweise").Range("M34").Value
    If Tippschein.Sheets("Hinweise").Range("M35").Value < Tippschein.Sheets("Hinweise").Range("M34").Value Then
        Vorlage.Sheets("Hinweise").Range("M35").Value = Tippschein.Sheets("Hinweise").Range("M34").Value + 3
    Else
        Vorlage.Sheets("Hinweise").Range("M35").Value = Tippschein.Sheets("Hinweise").Range("M35").Value
    End If
    
    If TippLiga = "1BL" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G16").Value = wksSondertipps.Range("G16").Value
            .Range("G18").Value = wksSondertipps.Range("G18").Value
            .Range("G20").Value = wksSondertipps.Range("G20").Value
            .Range("G21").Value = wksSondertipps.Range("G21").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G25").Value = wksSondertipps.Range("G25").Value
            .Range("G26").Value = wksSondertipps.Range("G26").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H40").Value = Spielregeln.Range("H40").Value
            .Range("H42").Value = Spielregeln.Range("H42").Value
            .Range("H44").Value = Spielregeln.Range("H44").Value
            .Range("H45").Value = Spielregeln.Range("H45").Value
            .Range("H47").Value = Spielregeln.Range("H47").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "2BL" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G18").Value = wksSondertipps.Range("G18").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G25").Value = wksSondertipps.Range("G25").Value
            .Range("G26").Value = wksSondertipps.Range("G26").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H42").Value = Spielregeln.Range("H42").Value
            .Range("H47").Value = Spielregeln.Range("H47").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "3BL" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G18").Value = wksSondertipps.Range("G18").Value
            .Range("G22").Value = wksSondertipps.Range("G22").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G24").Value = wksSondertipps.Range("G24").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H42").Value = Spielregeln.Range("H42").Value
            .Range("H48").Value = Spielregeln.Range("H48").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "1ENG" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G16").Value = wksSondertipps.Range("G16").Value
            .Range("G18").Value = wksSondertipps.Range("G18").Value
            .Range("G19").Value = wksSondertipps.Range("G19").Value
            .Range("G20").Value = wksSondertipps.Range("G20").Value
            .Range("G22").Value = wksSondertipps.Range("G22").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G24").Value = wksSondertipps.Range("G24").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H40").Value = Spielregeln.Range("H40").Value
            .Range("H42").Value = Spielregeln.Range("H42").Value
            .Range("H44").Value = Spielregeln.Range("H44").Value
            .Range("H48").Value = Spielregeln.Range("H48").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "1ESP" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G16").Value = wksSondertipps.Range("G16").Value
            .Range("G18").Value = wksSondertipps.Range("G18").Value
            .Range("G20").Value = wksSondertipps.Range("G20").Value
            .Range("G21").Value = wksSondertipps.Range("G21").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G24").Value = wksSondertipps.Range("G24").Value
            .Range("G25").Value = wksSondertipps.Range("G25").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H40").Value = Spielregeln.Range("H40").Value
            .Range("H42").Value = Spielregeln.Range("H42").Value
            .Range("H44").Value = Spielregeln.Range("H44").Value
            .Range("H45").Value = Spielregeln.Range("H45").Value
            .Range("H48").Value = Spielregeln.Range("H48").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "1TK" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G17").Value = wksSondertipps.Range("G17").Value
            .Range("G18").Value = wksSondertipps.Range("G18").Value
            .Range("G22").Value = wksSondertipps.Range("G22").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G24").Value = wksSondertipps.Range("G24").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H44").Value = Spielregeln.Range("H44").Value
            .Range("H45").Value = Spielregeln.Range("H45").Value
            .Range("H47").Value = Spielregeln.Range("H47").Value
            .Range("H48").Value = Spielregeln.Range("H48").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "1NL" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G19").Value = wksSondertipps.Range("G19").Value
            .Range("G20").Value = wksSondertipps.Range("G20").Value
            .Range("G22").Value = wksSondertipps.Range("G22").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G25").Value = wksSondertipps.Range("G25").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H44").Value = Spielregeln.Range("H44").Value
            .Range("H45").Value = Spielregeln.Range("H45").Value
            .Range("H47").Value = Spielregeln.Range("H47").Value
            .Range("H48").Value = Spielregeln.Range("H48").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    ElseIf TippLiga = "1FR" & Saison Then
        'Sondertipps
        With VorlageSondertipps
            .Range("G11").Value = wksSondertipps.Range("G11").Value
            .Range("G13").Value = wksSondertipps.Range("G13").Value
            .Range("G15").Value = wksSondertipps.Range("G15").Value
            .Range("G17").Value = wksSondertipps.Range("G17").Value
            .Range("G19").Value = wksSondertipps.Range("G19").Value
            .Range("G21").Value = wksSondertipps.Range("G21").Value
            .Range("G22").Value = wksSondertipps.Range("G22").Value
            .Range("G23").Value = wksSondertipps.Range("G23").Value
            .Range("G28").Value = wksSondertipps.Range("G28").Value
            .Range("G30").Value = wksSondertipps.Range("G30").Value
        End With
        'Spielregeln
        With VorlageSpielregeln
            .Range("E26").Value = Spielregeln.Range("E26").Value
            .Range("E27").Value = Spielregeln.Range("E27").Value
            .Range("E28").Value = Spielregeln.Range("E28").Value
            .Range("E29").Value = Spielregeln.Range("E29").Value
            .Range("H35").Value = Spielregeln.Range("H35").Value
            .Range("H37").Value = Spielregeln.Range("H37").Value
            .Range("H39").Value = Spielregeln.Range("H39").Value
            .Range("H42").Value = Spielregeln.Range("H42").Value
            .Range("H44").Value = Spielregeln.Range("H44").Value
            .Range("H48").Value = Spielregeln.Range("H48").Value
            .Range("H49").Value = Spielregeln.Range("H49").Value
            .Range("H50").Value = Spielregeln.Range("H50").Value
            .Range("H52").Value = Spielregeln.Range("H52").Value
            .Range("H54").Value = Spielregeln.Range("H54").Value
        End With
    End If
    
    Tippschein.Close savechanges:=False
    Application.DisplayAlerts = False
    Vorlage.SaveAs Filename:=Hilfsdaten.Range("A" & i).Value, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False
    Application.DisplayAlerts = True
    Set Tippschein = Vorlage
    
    Set Tippscheindatenblatt = Tippschein.Worksheets("Spielplan")
    Set Spielregeln = Tippschein.Worksheets("Spielregeln")
    Set wksSondertipps = Tippschein.Worksheets("Sondertipps")
    
    If Auswertungsliga = "1. Bundesliga" Or Auswertungsliga = "2. Bundesliga" Then
        Set Bundesligatabelle = Tippschein.Worksheets("Bundesligatabelle")
    Else
        Set Bundesligatabelle = Tippschein.Worksheets("Tabellen")
    End If
    
    With Tippscheindatenblatt
        .Select
'        CursorPos = ActiveCell.Address
        .Range("L38").Select 'Beginn Spielergebnisse
        .Unprotect Password:=Passwort
    End With
    
    Auswertungsdatei.Activate
    
    With Spielplan
        .Select
     
        Spielregeln.Range("E26").Value = .Range("O12").Value
        Spielregeln.Range("E27").Value = .Range("O13").Value
        Spielregeln.Range("E28").Value = .Range("O14").Value
        Spielregeln.Range("E29").Value = .Range("O15").Value 'aktuell nur in 1.+2. BL aktiv
        
        wksSondertipps.Unprotect Password:=Passwort
            
        If TippLiga = "1BL" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H40").Value = .Range("O22").Value
            Spielregeln.Range("H42").Value = .Range("O24").Value
            Spielregeln.Range("H44").Value = .Range("O26").Value
            Spielregeln.Range("H45").Value = .Range("O27").Value
            Spielregeln.Range("H47").Value = .Range("O29").Value
            Spielregeln.Range("H49").Value = .Range("O31").Value
            Spielregeln.Range("H50").Value = .Range("O32").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O34").Value
            If .Range("O35").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O35").Value
            Spielregeln.Range("H54").Value = .Range("O36").Value
            If .Range("O37").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O37").Value
            
        ElseIf TippLiga = "2BL" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H42").Value = .Range("O23").Value
            Spielregeln.Range("H47").Value = .Range("O25").Value
            Spielregeln.Range("H49").Value = .Range("O27").Value
            Spielregeln.Range("H50").Value = .Range("O28").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O30").Value
            If .Range("O31").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O31").Value
            Spielregeln.Range("H54").Value = .Range("O32").Value
            If .Range("O33").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O33").Value
            
        ElseIf TippLiga = "3BL" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H42").Value = .Range("O24").Value
            Spielregeln.Range("H48").Value = .Range("O26").Value
            Spielregeln.Range("H49").Value = .Range("O27").Value
            Spielregeln.Range("H50").Value = .Range("O28").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O30").Value
            If .Range("O31").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O31").Value
            Spielregeln.Range("H54").Value = .Range("O32").Value
            If .Range("O33").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O33").Value
            
        ElseIf TippLiga = "1TK" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H44").Value = .Range("O23").Value
            Spielregeln.Range("H45").Value = .Range("O24").Value
            Spielregeln.Range("H47").Value = .Range("O26").Value
            Spielregeln.Range("H48").Value = .Range("O27").Value
            Spielregeln.Range("H49").Value = .Range("O28").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O30").Value
            If .Range("O31").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O31").Value
            Spielregeln.Range("H54").Value = .Range("O32").Value
            If .Range("O33").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O33").Value
            
        ElseIf TippLiga = "1NL" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H44").Value = .Range("O23").Value
            Spielregeln.Range("H45").Value = .Range("O24").Value
            Spielregeln.Range("H47").Value = .Range("O26").Value
            Spielregeln.Range("H48").Value = .Range("O27").Value
            Spielregeln.Range("H50").Value = .Range("O29").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O31").Value
            If .Range("O32").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O32").Value
            Spielregeln.Range("H54").Value = .Range("O33").Value
            If .Range("O34").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O34").Value
            
        ElseIf TippLiga = "1ENG" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H40").Value = .Range("O22").Value
            Spielregeln.Range("H42").Value = .Range("O24").Value
            Spielregeln.Range("H44").Value = .Range("O26").Value
            Spielregeln.Range("H48").Value = .Range("O28").Value
            Spielregeln.Range("H49").Value = .Range("O29").Value
            Spielregeln.Range("H50").Value = .Range("O30").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O32").Value
            If .Range("O33").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O33").Value
            Spielregeln.Range("H54").Value = .Range("O34").Value
            If .Range("O35").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O35").Value
            
        ElseIf TippLiga = "1ESP" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H40").Value = .Range("O22").Value
            Spielregeln.Range("H42").Value = .Range("O24").Value
            Spielregeln.Range("H44").Value = .Range("O26").Value
            Spielregeln.Range("H45").Value = .Range("O27").Value
            Spielregeln.Range("H48").Value = .Range("O29").Value
            Spielregeln.Range("H49").Value = .Range("O30").Value
            Spielregeln.Range("H50").Value = .Range("O31").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O33").Value
            If .Range("O34").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O34").Value
            Spielregeln.Range("H54").Value = .Range("O35").Value
            If .Range("O36").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O36").Value
            
        ElseIf TippLiga = "1FR" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            'Spielregeln.Range("H40").Value = .Range("O22").Value
            Spielregeln.Range("H42").Value = .Range("O24").Value
            Spielregeln.Range("H44").Value = .Range("O26").Value
            'Spielregeln.Range("H45").Value = .Range("O27").Value
            Spielregeln.Range("H48").Value = .Range("O29").Value
            Spielregeln.Range("H49").Value = .Range("O30").Value
            Spielregeln.Range("H50").Value = .Range("O31").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O33").Value
            If .Range("O34").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O34").Value
            Spielregeln.Range("H54").Value = .Range("O35").Value
            If .Range("O36").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O36").Value
            
        ElseIf TippLiga = "1IT" & Saison Then
            Spielregeln.Range("H35").Value = .Range("O17").Value
            Spielregeln.Range("H37").Value = .Range("O19").Value
            Spielregeln.Range("H39").Value = .Range("O21").Value
            Spielregeln.Range("H40").Value = .Range("O22").Value
            Spielregeln.Range("H42").Value = .Range("O24").Value
            Spielregeln.Range("H44").Value = .Range("O26").Value
            Spielregeln.Range("H45").Value = .Range("O27").Value
            Spielregeln.Range("H48").Value = .Range("O29").Value
            Spielregeln.Range("H49").Value = .Range("O30").Value
            Spielregeln.Range("H50").Value = .Range("O31").Value
            'neue Sondertipps hinzuf|fffd|gen
            Spielregeln.Range("H52").Value = .Range("O33").Value
            If .Range("O34").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I28").Value = .Range("O34").Value
            Spielregeln.Range("H54").Value = .Range("O35").Value
            If .Range("O36").Value <> "Mannschaft w|fffd|hlen" Then wksSondertipps.Range("I30").Value = .Range("O36").Value
            
        End If
        
        wksSondertipps.Protect Password:=Passwort
            
        .Range("E13:G577").Copy
    
    End With
    
    Tippschein.Activate
    Tippscheindatenblatt.Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    'Aktuelle Ligatabelle berechnen
    
    With Bundesligatabelle
        .Activate
    
        'If Sheets("Hinweise").Range("A1").Value = 1 Then Exit Sub

        .Unprotect Password:=Passwort

        Zelle2 = ActiveCell.Address
    
        Application.ScreenUpdating = False
        Application.Calculation = xlCalculationManual
        
        If Teams = 18 Then
    
        'Gesamttabelle
            Sheets("Spielplan").Range("AE99:AN117").Copy
            .Range("C5").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("L6:L23"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("K6:K23"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("H6:H23"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("C5:L23")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
    
        'Heimtabelle
            Sheets("Spielplan").Range("AE120:AN138").Copy
            .Range("C29").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("L30:L47"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("K30:K47"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("H30:H47"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("C29:L47")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
    
        'Vorrundentabelle
            Sheets("Spielplan").Range("AE162:AN180").Copy
            .Range("O29").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("X30:X47"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("W30:W47"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("T30:T47"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("O29:X47")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
    
        'Ausw|fffd|rtstabelle
            Sheets("Spielplan").Range("AE141:AN159").Copy
            .Range("C53").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("L54:L71"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("K54:K71"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("H54:H71"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("C53:L71")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
    
        'R|fffd|ckrundentabelle
            Sheets("Spielplan").Range("AE183:AN201").Copy
            .Range("O53").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("X54:X71"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("W54:W71"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("T54:T71"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("O53:X71")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
                
        'Tipptabelle
            Sheets("Spielplan").Range("BF36:BO54").Copy
            .Range("O5").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("X6:X23"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("W6:W23"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("T6:T23"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("O5:X23")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
                
        Else 'Liga mit 20 Vereinen
        
        'Gesamttabelle
            Sheets("Spielplan").Range("AE99:AN119").Copy
            .Range("C5").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("L6:L25"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("K6:K25"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("H6:H25"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("C5:L25")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
                
        'Heimtabelle
            Sheets("Spielplan").Range("AE120:AN140").Copy
            .Range("C29").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("L30:L49"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("K30:K49"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("H30:H49"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("C29:L49")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
        
        'Vorrundentabelle
            Sheets("Spielplan").Range("AE162:AN182").Copy
            .Range("O29").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("X30:X49"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("W30:W49"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("T30:T49"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("O29:X49")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
                
        'Ausw|fffd|rtstabelle
            Sheets("Spielplan").Range("AE141:AN161").Copy
            .Range("C53").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("L54:L73"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("K54:K73"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("H54:H73"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("C53:L73")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
        
        'R|fffd|ckrundentabelle
            Sheets("Spielplan").Range("AE183:AN203").Copy
            .Range("O53").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("X54:X73"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("W54:W73"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("T54:T73"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("O53:X73")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
                
        'Tipptabelle
            Sheets("Spielplan").Range("BF36:BO56").Copy
            .Range("O5").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            Application.CutCopyMode = False
            .Sort.SortFields.Clear
            .Sort.SortFields.Add Key:=Range("X6:X25"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("W6:W25"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            .Sort.SortFields.Add Key:=Range("T6:T25"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
            With .Sort
                .SetRange Range("O5:X25")
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
                
        End If

        .Range(Zelle2).Activate
        
'        Application.CutCopyMode = False
    
        Application.ScreenUpdating = True
        Application.Calculation = xlCalculationAutomatic
        Call Calculate
    
        .Protect Password:=Passwort, DrawingObjects:=True, Contents:=True, Scenarios:=False
        
    End With
    'Ende Tabellenberechnung
    
    Auswertungsdatei.Activate
    
    With Platzierung
        Application.ScreenUpdating = False
        Application.Calculation = xlCalculationManual
        
        .Range("C" & j).Value = Tippscheindatenblatt.Range("G8").Value  'Name
        Sheets("Daten").Cells(1, x).Value = Tippscheindatenblatt.Range("G8").Value
        
        'Sondertipps schreiben
        If Sheets("Daten").Range("A3").Value = "1BL" Then
        
            Sheets("Daten").Cells(8, x).Value = wksSondertipps.Range("G11").Value 'Meister
            Sheets("Daten").Cells(9, x).Value = wksSondertipps.Range("G13").Value 'Herbstmeister
            Sheets("Daten").Cells(10, x).Value = wksSondertipps.Range("G15").Value 'Direkte CL-Qualifikation
            Sheets("Daten").Cells(11, x).Value = wksSondertipps.Range("G16").Value 'Direkte CL-Qualifikation
            Sheets("Daten").Cells(12, x).Value = wksSondertipps.Range("G18").Value 'Erreichen der CL-Qualifikation
            Sheets("Daten").Cells(13, x).Value = wksSondertipps.Range("G20").Value 'Erreichen der Europa League
            Sheets("Daten").Cells(14, x).Value = wksSondertipps.Range("G21").Value 'Erreichen der Europa League
            Sheets("Daten").Cells(15, x).Value = wksSondertipps.Range("G23").Value 'Relegationsplatz
            Sheets("Daten").Cells(16, x).Value = wksSondertipps.Range("G25").Value 'Direkte Absteiger
            Sheets("Daten").Cells(17, x).Value = wksSondertipps.Range("G26").Value 'Direkte Absteiger
            'neue Sondertipps hinzuf|fffd|gen
            Sheets("Daten").Cells(18, x).Value = wksSondertipps.Range("G28").Value 'Trainerentlassung
            Sheets("Daten").Cells(19, x).Value = wksSondertipps.Range("G30").Value 'Torsch|fffd|tzenk|fffd|nig
        ElseIf Sheets("Daten").Range("A3").Value = "2BL" Then
            'neue Sondertipps hinzuf|fffd|gen
            Sheets("Daten").Cells(8, x).Value = wksSondertipps.Range("G11").Value 'Meister
            Sheets("Daten").Cells(9, x).Value = wksSondertipps.Range("G13").Value 'Herbstmeister
            Sheets("Daten").Cells(10, x).Value = wksSondertipps.Range("G15").Value 'Direkter Aufsteiger
            Sheets("Daten").Cells(11, x).Value = wksSondertipps.Range("G18").Value 'Aufstiegsrelegation
            Sheets("Daten").Cells(12, x).Value = wksSondertipps.Range("G23").Value 'Abstiegsrelegation
            Sheets("Daten").Cells(13, x).Value = wksSondertipps.Range("G25").Value 'Direkte Absteiger
            Sheets("Daten").Cells(14, x).Value = wksSondertipps.Range("G26").Value 'Direkte Absteiger
            Sheets("Daten").Cells(15, x).Value = wksSondertipps.Range("G28").Value 'Trainerentlassung
            Sheets("Daten").Cells(16, x).Value = wksSondertipps.Range("G30").Value 'Torsch|fffd|tzenk|fffd|nig
        ElseIf Sheets("Daten").Range("A3").Value = "3BL" Then
            'neue Sondertipps hinzuf|fffd|gen
        ElseIf Sheets("Daten").Range("A3").Value = "1TK" Then
            'neue Sondertipps hinzuf|fffd|gen
        ElseIf Sheets("Daten").Range("A3").Value = "1NL" Then
            'neue Sondertipps hinzuf|fffd|gen
        ElseIf Sheets("Daten").Range("A3").Value = "1ENG" Then
            'neue Sondertipps hinzuf|fffd|gen
        ElseIf Sheets("Daten").Range("A3").Value = "1ESP" Then
            'neue Sondertipps hinzuf|fffd|gen
        ElseIf Sheets("Daten").Range("A3").Value = "1FR" Then
            'neue Sondertipps hinzuf|fffd|gen
        ElseIf Sheets("Daten").Range("A3").Value = "1IT" Then
            'neue Sondertipps hinzuf|fffd|gen
        End If

        Set rng = Sheets(L|fffd|nderKZ).Range("C:C").Find(.Range("C" & j).Value)

        If rng Is Nothing Then
            ZeileX = 0
'            MsgBox "Name: " & .Range("C" & j).Value & " nicht gefunden."
        Else
            ZeileX = rng.Row
        End If
        
        .Range("D" & j).Value = Tippscheindatenblatt.Range("G14").Value 'Punkte
        .Range("E" & j).Value = Tippscheindatenblatt.Range("G19").Value 'Ergebnisse
        .Range("F" & j).Value = Tippscheindatenblatt.Range("G20").Value 'Tordifferenz
        .Range("G" & j).Value = Tippscheindatenblatt.Range("G21").Value 'Tendenz
        Sheets("Daten").Cells(3, x).Value = Tippscheindatenblatt.Range("G14").Value
        Sheets("Daten").Cells(4, x).Value = Tippscheindatenblatt.Range("G19").Value
        Sheets("Daten").Cells(5, x).Value = Tippscheindatenblatt.Range("G20").Value
        Sheets("Daten").Cells(6, x).Value = Tippscheindatenblatt.Range("G21").Value
        
        If Tippscheindatenblatt.Range("G10").Value <> "bitte ausw|fffd|hlen" Then .Range("H" & j).Value = Tippscheindatenblatt.Range("G10").Value 'Lieblingsverein
        .Range("CG" & j).Value = Tippscheindatenblatt.Range("G16").Value 'Punkte aus Spielergebnissen
        .Range("CH" & j).Value = Tippscheindatenblatt.Range("G17").Value 'Punkte aus Sondertipps
        
        Application.ScreenUpdating = True
        Application.Calculation = xlCalculationAutomatic
        Call Calculate
    End With

    Erase Daten_Array
    ReDim Daten_Array(1 To Spieltage)
    Erase Daten_ArrayP
    ReDim Daten_ArrayP(1 To Spieltage)
    
    If Teams = 18 Then
        Zeile = 48
        Zeile1 = 37
        yy = 0
        For Spiel = 1 To 306
            yy = yy + 1
            If yy = 10 Then
                yy = 1
                Zeile1 = Zeile1 + 6
            Else
                Zeile1 = Zeile1 + 1
            End If
            Sheets("Daten").Cells(Spiel + 25, x).Value = Tippscheindatenblatt.Range("H" & Zeile1).Value & ":" & Tippscheindatenblatt.Range("J" & Zeile1).Value
            
        Next Spiel
    ElseIf Teams = 20 Then
        Zeile = 49
    End If
    u = 10
    
    Zeile2 = 411
    For t = 1 To absSpieltage
        If Teams = 18 Then
            Daten_Array(t) = Tippscheindatenblatt.Range("Q" & Zeile).Value 'Gesamtpunkte
            Sheets("Daten").Cells(Zeile2, x).Value = Tippscheindatenblatt.Range("Q" & Zeile).Value
            Sheets("Daten").Cells(Zeile2 + 1, x).Value = Tippscheindatenblatt.Range("R" & Zeile).Value 'Korrekte Tipps
            Sheets("Daten").Cells(Zeile2 + 2, x).Value = Tippscheindatenblatt.Range("S" & Zeile).Value 'Tordifferenz
            Sheets("Daten").Cells(Zeile2 + 3, x).Value = Tippscheindatenblatt.Range("T" & Zeile).Value 'Tendenz
            Zeile2 = Zeile2 + 4
            Zeile = Zeile + 14
        ElseIf Teams = 20 Then
            Daten_Array(t) = Tippscheindatenblatt.Range("Q" & Zeile).Value
            Sheets("Daten").Cells(Zeile2, x).Value = Tippscheindatenblatt.Range("Q" & Zeile).Value
            Sheets("Daten").Cells(Zeile2 + 1, x).Value = Tippscheindatenblatt.Range("R" & Zeile).Value 'Korrekte Tipps
            Sheets("Daten").Cells(Zeile2 + 2, x).Value = Tippscheindatenblatt.Range("S" & Zeile).Value 'Tordifferenz
            Sheets("Daten").Cells(Zeile2 + 3, x).Value = Tippscheindatenblatt.Range("T" & Zeile).Value 'Tendenz
            Zeile2 = Zeile2 + 4
            Zeile = Zeile + 15
        End If
        If ZeileX > 0 Then
'            Sheets(L|fffd|nderKZ).Cells(ZeileX, u).Select
            Daten_ArrayP(t) = Sheets(L|fffd|nderKZ).Cells(ZeileX, u).Value
            u = u + 2
        End If
    Next t

    With Tippscheindatenblatt
        .Activate
        .Protect Password:=Passwort
        .Range(CursorPos).Select
    End With

    Tippschein.Close savechanges:=True
'    Vorlage.Close savechanges:=False
    Auswertungsdatei.Activate
    With Platzierung
        .Select
    
        Application.ScreenUpdating = False
        Application.Calculation = xlCalculationManual

    '    Platzierung.Range("A" & j).FormulaR1C1 = "=IF(R[-1]C=""Platz"",""1."",IF((RC[2]&RC[3]&RC[4]&RC[5]&RC[47])=(R[-1]C[2]&R[-1]C[3]&R[-1]C[4]&R[-1]C[5]&R[-1]C[47]),R[-1]C," & k & "&"".""))"
        .Range("A" & j).FormulaR1C1 = "=IF((R[-1]C[3]&""_""&R[-1]C[4]&""_""&R[-1]C[5]&""_""&R[-1]C[6])=(RC[3]&""_""&RC[4]&""_""&RC[5]&""_""&RC[6]),R[-1]C,ROW(RC)-5&""."")"
        'Bei L|fffd|sung NEU nicht mehr ben|fffd|tigt
    '    Platzierung.Range("I" & j).Select
        'Column 9
        xx = 9
        For l = 1 To absSpieltage
        
            'NEU
            'Punkte
            .Cells(j, xx).Value = Daten_Array(l)
            'Platzierung Replace(.Range("A" & j).Value, ".", "")
'            If ZeileX > 0 And Replace(.Range("A" & j).Value, ".", "") <> 0 Then
            If ZeileX > 0 And Daten_ArrayP(l) <> 0 Then
                .Cells(j, xx + 1).Value = Daten_ArrayP(l)
                If Daten_ArrayP(l) = 1 Then 'Platz 1
'                If Replace(.Range("A" & j).Value, ".", "") = 1 Then
                    .Cells(j, xx + 1).Interior.Color = 65280 'gr|fffd|n 3407718 '5296274
                Else
                    .Cells(j, xx + 1).Interior.ThemeColor = xlThemeColorDark2 'grau
                End If
                .Cells(j, xx + 1).Font.Bold = True
            Else
                .Cells(j, xx + 1).Value = ""
                .Cells(j, xx + 1).Interior.ThemeColor = xlThemeColorDark2
                .Cells(j, xx + 1).Font.Bold = True
    '            ActiveCell.Interior.Color = 8421504
            End If
            xx = xx + 2
        
        
'        'ALT
'        'Punkte
'        ActiveCell.Value = Daten_Array(l)
'        ActiveCell.Offset(0, 1).Select
'        'Platzierung
'        If ZeileX > 0 And Daten_ArrayP(l) <> 0 Then
'            ActiveCell.Value = Daten_ArrayP(l)
'            If Daten_ArrayP(l) = 1 Then 'Platz 1
'                ActiveCell.Interior.Color = 65280 'gr|fffd|n 3407718 '5296274
'            Else
'                ActiveCell.Interior.ThemeColor = xlThemeColorDark2 'grau
'            End If
'            ActiveCell.Font.Bold = True
'        ElseIf l <> absSpieltage Then '
'            ActiveCell.Value = ""
'            ActiveCell.Interior.ThemeColor = xlThemeColorDark2
''            ActiveCell.Interior.Color = 8421504
'        End If
'        ActiveCell.Offset(0, 1).Select
        Next l
    
        Application.ScreenUpdating = True
        Application.Calculation = xlCalculationAutomatic
        Call Calculate

        j = j + 1
        k = k + 1
    
    End With
    
sprung:
Application.Wait (Now + TimeValue("0:00:02"))
Next i

AktuellerSpieltag = xx - 1
VorherigerSpieltag = xx - 3

With Hilfsdaten
'    .Range("A:A").ClearContents
    .Columns("A:A").Delete Shift:=xlToLeft
    .Visible = False
End With

With Spielplan
    .Select
    .Range("K3").Select
    '.Visible = False
End With

With Platzierung
    .Select
    
    .Range("C2").Value = "Tippauswertung der Liga: " & Auswertungsliga & " (" & Land & ") Saison " & Saison
    
    letzteZeileA = .Range("A" & Rows.Count).End(xlUp).Row
        
    .Sort.SortFields.Clear
    .Sort.SortFields.Add Key:=Range("D6:D" & letzteZeileA), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    .Sort.SortFields.Add Key:=Range("E6:E" & letzteZeileA), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    .Sort.SortFields.Add Key:=Range("F6:F" & letzteZeileA), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With .Sort
        .SetRange Range("B5:CH" & letzteZeileA)
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    If .Range("A6").Value <> "" Then
'        .Range("A6:A" & letzteZeileA).Select
'        Selection.Copy
'        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        .Range("A6:A" & letzteZeileA).Copy
        .Range("A6:A" & letzteZeileA).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
        .PageSetup.PrintArea = "$A$1:$CH$" & letzteZeileA
        
        .Range("A6:CH" & letzteZeileA).Select
        
        Application.ScreenUpdating = False
        Application.Calculation = xlCalculationManual
            
        With Selection.Borders(xlEdgeLeft)
            .LineStyle = xlContinuous
            .ColorIndex = 0
            .TintAndShade = 0
            .Weight = xlThin
        End With
        With Selection.Borders(xlEdgeTop)
            .LineStyle = xlContinuous
            .ColorIndex = 0
            .TintAndShade = 0
            .Weight = xlThin
        End With
        With Selection.Borders(xlEdgeBottom)
            .LineStyle = xlContinuous
            .ColorIndex = 0
            .TintAndShade = 0
            .Weight = xlThin
        End With
        With Selection.Borders(xlEdgeRight)
            .LineStyle = xlContinuous
            .ColorIndex = 0
            .TintAndShade = 0
            .Weight = xlThin
        End With
        With Selection.Borders(xlInsideVertical)
            .LineStyle = xlContinuous
            .ColorIndex = 0
            .TintAndShade = 0
            .Weight = xlThin
        End With
        With Selection.Borders(xlInsideHorizontal)
            .LineStyle = xlContinuous
            .ColorIndex = 0
            .TintAndShade = 0
            .Weight = xlThin
        End With
        
        'Kopiert die bedingte Formatierung f|fffd|r die Kennzeichnung der Gewinner (gr|fffd|n) / Verlierer (rot) der Woche in Zeile B
        .Range("B1").Copy
        .Range("B6:B" & letzteZeileA).PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
    End If
    
    For i = 6 To letzteZeileA
        .Cells(i, AktuellerSpieltag).Value = Replace(.Range("A" & i).Value, ".", "") '.Range("A" & i).Value
        If .Cells(i, AktuellerSpieltag).Value = "1" Then
            .Cells(i, AktuellerSpieltag).Interior.Color = 3407718 'gr|fffd|n
        Else
            .Cells(i, AktuellerSpieltag).Interior.ThemeColor = xlThemeColorDark2 'grau
        End If
        If .Cells(i, AktuellerSpieltag).Value <> "" And .Cells(i, VorherigerSpieltag).Value <> "" And AktuellerSpieltag > 10 Then 'And AktuellerSpieltag <> "J" Then
            .Range("B" & i).Value = Replace(.Cells(i, VorherigerSpieltag).Value, ".", "") - Replace(.Cells(i, AktuellerSpieltag).Value, ".", "")
        End If
    Next i
    .Range("A6").Select
    
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    Call Calculate
            
    .Protect userinterfaceonly:=True, Password:=Passwort, AllowFiltering:=True
    .EnableAutoFilter = True
End With

'Sheets("Daten").Protect Password:=Passwort
Auswertungsdatei.Protect Password:=Passwort

ActiveWorkbook.FollowHyperlink Address:="https://www.makro-excel.de/downloads/aktueller-datenbestand-excel-tippspiel/"

Debug.Print Now
End Sub

Sub SpieltagAusw|fffd|hlen()

Dim Zeile As String

On Error Resume Next

Zeile = Range("M3").Value
Range("E" & Zeile + 2).Select

End Sub

Sub SpielergebnisseEintragen()

Dim Tabellenblatt As String
Dim Auswertungstool As Worksheet

With ThisWorkbook
    Set Auswertungstool = .Worksheets("Auswertungstool")
    .Unprotect Password:=Passwort
    With Auswertungstool
        Tabellenblatt = .Range("E9").Value
        If Tabellenblatt = "bitte ausw|fffd|hlen" Or Tabellenblatt = "" Then
            MsgBox ("Bitte w|fffd|hlen Sie zuvor die Liga aus.")
            .Range("E9").Select
            ThisWorkbook.Protect Password:=Passwort
            Exit Sub
        End If
    End With
    .Sheets(Tabellenblatt).Visible = True
    .Sheets(Tabellenblatt).Select
    .Protect Password:=Passwort
End With

End Sub

Sub PlatzierungSortieren()

Dim letzteZeile As String
Dim Platzierung As Worksheet

Set Platzierung = ThisWorkbook.Worksheets("Platzierung")

letzteZeile = Platzierung.Range("A" & Rows.Count).End(xlUp).Row

With Platzierung
    .Unprotect Password:=Passwort
    .Range("A5:CH" & letzteZeile).Select
    If .Range("A1").Value = "" Then
        .Sort.SortFields.Clear
        .Sort.SortFields.Add Key:=Range("A6:A" & letzteZeile), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        With .Sort
            .SetRange Range("A5:CH" & letzteZeile)
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        .Range("A1").Value = "Sort.Name"
        .Range("A6").Select
    ElseIf .Range("A1").Value = "Sort.Name" Then
        .Sort.SortFields.Clear
        .Sort.SortFields.Add Key:=Range("C6:C" & letzteZeile), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        With .Sort
            .SetRange Range("A5:CH" & letzteZeile)
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        .Range("A1").Value = ""
        .Range("A6").Select
    End If
    .Protect userinterfaceonly:=True, Password:=Passwort, AllowFiltering:=True
End With

End Sub





Attribute VB_Name = "AuswertungErg"
Option Explicit

Sub AlleTipps()

Dim Punkte As Long, richtigeTipps As Long, richtigeTordifferenz As Long, richtigeTendenz As Long, letzteZeile As Long, Zeile As Long
Dim i As Long, j As Long, k As Long, z As Long, letzteZeileA As Long
Dim h As Integer, x As Integer
Dim Daten_Array() As Single, Daten_ArrayP() As Single
Dim Name As String, Lieblingsverein As String, Ergebnistipps As String, Sondertipps As String, Ordnerpfad As String, Tabellenblatt As String
Dim TippLiga As String, Auswertungsliga As String, Tippdatei As String, Dateipfad As String, Land As String
Dim Teams As Integer, t As Integer, l As Integer, Spieltage As Integer, absSpieltage As Integer, CursorPos As String
Dim kErg As String, kDif As String, kTd As String, M As String, HM As String, CL1 As String, CL2 As String, CL3 As String, Q1 As String
Dim Q2 As String, Q3 As String, EL1 As String, EL2 As String, EL3 As String, R1 As String, R2 As String, R3 As String, A1 As String, A2 As String
Dim A3 As String, A As String, AR As String

Dim L|fffd|nderKZ As String
Dim ZeileX As Long, ZeileC As Long
Dim u As Integer, Spieltag As Integer
Dim Farbe As Boolean
Dim AktuellerSpieltag As Integer, VorherigerSpieltag As Integer
Dim rng As Range

Dim Zelle2
Dim Auswertungsdatei As Workbook, Tippschein As Workbook
Dim Auswertungstool As Worksheet, Tippstatus As Worksheet, Spielplan As Worksheet, Tippscheindatenblatt As Worksheet, Spielregeln As Worksheet, Hilfsdaten As Worksheet, Bundesligatabelle As Worksheet
Dim Bereich As Range, Zelle As Range

Dim Pfad As String          'Startpfad
Dim Daten As New Collection 'gesammelte Ergebinsse
Dim Eintrag

Set Auswertungsdatei = ThisWorkbook
Set Auswertungstool = Auswertungsdatei.Worksheets("Auswertungstool")
Set Tippstatus = Auswertungsdatei.Worksheets("Tipp-Status")
Set Hilfsdaten = Auswertungsdatei.Worksheets("Hilfsdaten") 'muss ggf. noch ge|fffd|ndert werden

Saison = Left(Right(Sheets("Auswertungstool").Range("B2"), 7), 2) & "-" & Right(Sheets("Auswertungstool").Range("B2"), 2)

Dateipfad = Auswertungsdatei.Path & "\"

With Auswertungstool
    If .Range("E11").Value = "" Then
        blnAbbruch = True
        MsgBox "Es fehlt der Ordnerpfad f|fffd|r die Tippscheine."
        .Range("E11").Select
        Exit Sub
    ElseIf Right(.Range("E11").Value, 1) = "\" Then
        Ordnerpfad = .Range("E11").Value
    Else
        Ordnerpfad = .Range("E11").Value & "\"
    End If
    
    If Dateipfad = Ordnerpfad Then
        blnAbbruch = True
        MsgBox ("Die Auswertungsdatei, darf nicht im Ordner der Tippscheine gespeichert sein, da sonst keine Auswertung m|fffd|glich ist. Bitte schlie|fffd|en Sie die Auswertungsdatei und speichern die Datei in einem anderen Ordner.")
        .Range("E11").Select
        Exit Sub
    ElseIf Dir(Ordnerpfad) = "" Or Ordnerpfad = "\" Then
        blnAbbruch = True
        MsgBox "Der Ordner ist nicht vorhanden. Bitte tragen Sie den Ordnerpfad der Tippschein-Dateien ein."
        .Range("E11").Select
        Exit Sub
    End If
    
    If .Range("E9").Value = "1. Bundesliga" Then
        TippLiga = "1BL" & Saison
        Auswertungsliga = "1. Bundesliga"
        Teams = 18
    ElseIf .Range("E9").Value = "2. Bundesliga" Then
        TippLiga = "2BL" & Saison
        Auswertungsliga = "2. Bundesliga"
        Teams = 18
    ElseIf .Range("E9").Value = "3. Bundesliga" Then
        TippLiga = "3BL" & Saison
        Auswertungsliga = "3. Bundesliga"
        Teams = 20
    ElseIf .Range("E9").Value = "S|fffd|perLig" Then
        TippLiga = "1TK" & Saison
        Auswertungsliga = "S|fffd|perLig"
        Teams = 18
    ElseIf .Range("E9").Value = "Eredivisie" Then
        TippLiga = "1NL" & Saison
        Auswertungsliga = "Eredivisie"
        Teams = 18
    ElseIf .Range("E9").Value = "Premier League" Then
        TippLiga = "1ENG" & Saison
        Auswertungsliga = "Premier League"
        Teams = 20
    ElseIf .Range("E9").Value = "Primera Division" Then
        TippLiga = "1ESP" & Saison
        Auswertungsliga = "Primera Division"
        Teams = 20
    ElseIf .Range("E9").Value = "Ligue 1" Then
        TippLiga = "1FR" & Saison
        Auswertungsliga = "Ligue 1"
        Teams = 20
    ElseIf .Range("E9").Value = "Serie A" Then
        TippLiga = "1IT" & Saison
        Auswertungsliga = "Serie A"
        Teams = 20
    Else
        blnAbbruch = True
        MsgBox "Bitte w|fffd|hlen Sie die Liga aus f|fffd|r die die Tipps der Mitspieler zusammengefasst werden sollen."
        .Range("E9").Select
        Exit Sub
    End If
    
    Land = .Range("J9").Value
End With

Set Spielplan = Auswertungsdatei.Worksheets(Auswertungsliga)

If Teams = 18 Then
    Spieltage = 34
ElseIf Teams = 20 Then
    Spieltage = 38
End If

Auswertungsdatei.Unprotect Password:=Passwort

With Spielplan
    .Visible = True
    
    absSpieltage = .Range("J1").Value 'gespielte Spieltage
End With

With Tippstatus
    .Select
    .Unprotect Password:=Passwort
    
    'Hintergrundfarbe entfernen + Inhalte leeren
    If .Range("A" & Rows.Count).End(xlUp).Row > 3 Then
        ZeileC = .Range("G" & Rows.Count).End(xlUp).Row
'        .Rows("4:" & ZeileC).Interior.Pattern = xlNone
'        .Rows("4:" & ZeileC).ClearContents
'        .Range("4:" & ZeileC).Font.Bold = False
'        .Columns("H:XFD").ClearContents
        .Columns("H:XFD").Delete Shift:=xlToLeft
    Else
        ZeileC = 4
    End If
    j = 4
    Farbe = True
    For i = 13 To Sheets(Auswertungsliga).Range("C1048576").End(xlUp).Row
        If Sheets(Auswertungsliga).Range("J" & i).Value <> "" And Sheets(Auswertungsliga).Range("J" & i).Value <> "x" Then Spieltag = Spieltag + 1
        If Sheets(Auswertungsliga).Range("C" & i).Value = "-" Then
            If Spieltag Mod 2 <> 0 Then
                If Farbe = True Then
                    .Rows(j & ":" & j + 1).Interior.ThemeColor = xlThemeColorAccent1 'blau hell
                    .Rows(j & ":" & j + 1).Interior.TintAndShade = 0.799981688894314
                ElseIf Farbe = False Then
                    .Rows(j & ":" & j + 1).Interior.ThemeColor = xlThemeColorAccent1 'blau dunkel
                    .Rows(j & ":" & j + 1).Interior.TintAndShade = 0.599993896298105
                End If
            Else
                If Farbe = True Then
                    .Rows(j & ":" & j + 1).Interior.ThemeColor = xlThemeColorAccent6 'gr|fffd|n hell
                    .Rows(j & ":" & j + 1).Interior.TintAndShade = 0.799981688894314
                ElseIf Farbe = False Then
                    .Rows(j & ":" & j + 1).Interior.ThemeColor = xlThemeColorAccent6 'gr|fffd|n dunkel
                    .Rows(j & ":" & j + 1).Interior.TintAndShade = 0.599993896298105
                End If
            End If
            .Range("A" & j).Value = Spieltag
            .Range("B" & j).Value = Sheets(Auswertungsliga).Range("B" & i).Value
            .Range("C" & j).Value = Sheets(Auswertungsliga).Range("D" & i).Value
            .Range("D" & j).Value = Sheets(Auswertungsliga).Range("E" & i).Value
            .Range("E" & j).Value = ":"
            .Range("F" & j).Value = Sheets(Auswertungsliga).Range("G" & i).Value
            .Range("G" & j).Value = "Pkt."
            .Range("G" & j + 1).Value = "Tipp"
            j = j + 2
            If Farbe = True Then
                Farbe = False
            Else
                Farbe = True
            End If
        End If
    Next i
End With

ChDir Ordnerpfad

With Hilfsdaten
    .Visible = True
    .Select
'    .Range("A:A").ClearContents
    .Columns("A:A").Delete Shift:=xlToLeft
    .Range("A1").Select
End With

Call FileList(Daten, Ordnerpfad)                 'Alles im aktuellen Ordner

If Daten.Count = 0 Then
    MsgBox ("In Ordner " & Ordnerpfad & " wurden keine Dateien gefunden.")
    Exit Sub
End If
z = 1
For Each Eintrag In Daten
    Hilfsdaten.Range("A" & z).Value = Eintrag
    z = z + 1
Next Eintrag

letzteZeile = Hilfsdaten.Range("A" & Rows.Count).End(xlUp).Row

i = 1
j = 6
k = 1
h = 8

'Alle Tippscheine |fffd|ffnen und auslesen
For i = 1 To letzteZeile
    Application.EnableEvents = False
    Workbooks.Open Hilfsdaten.Range("A" & i).Value
    Application.EnableEvents = True
    Set Tippschein = ActiveWorkbook
    Set Tippscheindatenblatt = Tippschein.Worksheets("Spielplan")
    Set Spielregeln = Tippschein.Worksheets("Spielregeln")

    If Tippscheindatenblatt.Range("AS25").Value <> TippLiga Then
        Tippschein.Close savechanges:=False
        Auswertungsdatei.Activate
        GoTo sprung:
    End If
    
    If Auswertungsliga = "1. Bundesliga" Or Auswertungsliga = "2. Bundesliga" Then
        Set Bundesligatabelle = Tippschein.Worksheets("Bundesligatabelle")
    Else
        Set Bundesligatabelle = Tippschein.Worksheets("Tabellen")
    End If
    
    With Tippscheindatenblatt
        .Select
        CursorPos = ActiveCell.Address
        .Range("L38").Select 'Beginn Spielergebnisse
        .Unprotect Password:=Passwort
    End With
    
'    Auswertungsdatei.Activate
'
'    With Spielplan
'        .Select
'
'        Spielregeln.Range("E26").Value = .Range("O12").Value
'        Spielregeln.Range("E27").Value = .Range("O13").Value
'        Spielregeln.Range("E28").Value = .Range("O14").Value
'        Spielregeln.Range("E29").Value = .Range("O15").Value 'aktuell nur in 1.+2. BL aktiv
'
'        .Range("E13:G577").Copy
'    End With
'
'    Tippschein.Activate
'    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    Auswertungsdatei.Activate
    
    With Tippstatus
        Application.ScreenUpdating = False
        Application.Calculation = xlCalculationManual
        
        .Cells(3, h) = Tippscheindatenblatt.Range("G8").Value 'Name
        .Columns(h).HorizontalAlignment = xlCenter
        
        j = 4
        For x = 38 To Tippscheindatenblatt.Range("F1048576").End(xlUp).Row
            If Tippscheindatenblatt.Range("F" & x).Value = "-" Then
                .Cells(j, h).Value = Tippscheindatenblatt.Range("H" & x).Value & ":" & Tippscheindatenblatt.Range("J" & x).Value
                If .Cells(j, h).Value = ":" Then 'kein Tipp abgegeben
                    .Cells(j, h).Interior.Color = 255 'rot
                    .Cells(j + 1, h).Interior.Color = 255 'rot
                    .Cells(j + 1, h).Value = "(-)"
                Else
                    If .Cells(j, 4).Value <> "" And .Cells(j, 6).Value <> "" Then 'Spiel beendet
                        If Tippscheindatenblatt.Range("Q" & x).Value = Spielplan.Range("O12").Value Then 'richtiges Ergebnis getippt
                            .Cells(j, h).Interior.Color = 65280 'gr|fffd|n
                            .Cells(j + 1, h).Interior.Color = 65280 'gr|fffd|n
                            .Cells(j, h).Font.Bold = True
                            .Cells(j + 1, h).Font.Bold = True
                        End If
                        .Cells(j + 1, h).Value = "(" & Tippscheindatenblatt.Range("Q" & x).Value & ")"
                        If Tippscheindatenblatt.Range("Q" & x).Value > 0 Then
                            .Cells(j, h).Font.Bold = True
                            .Cells(j + 1, h).Font.Bold = True
                        End If
                    Else
                        .Cells(j + 1, h).Value = "(-)"
                    End If
                End If
                j = j + 2
            End If
        Next x
        
        Application.ScreenUpdating = True
        Application.Calculation = xlCalculationAutomatic
        Call Calculate
    End With
    
    With Tippscheindatenblatt
        .Activate
        .Protect Password:=Passwort
        .Range(CursorPos).Select
    End With

    Tippschein.Close savechanges:=False
    Auswertungsdatei.Activate
    Tippstatus.Select

h = h + 1

sprung:
Application.Wait (Now + TimeValue("0:00:02"))
Next i

With Hilfsdaten
'    .Range("A:A").ClearContents
    .Columns("A:A").Delete Shift:=xlToLeft
    .Visible = False
End With

With Tippstatus
    .Select
    .Range("A1").Select
    .Range("B2").Value = "Tipps aller Mitspieler f|fffd|r die " & Auswertungsliga & " (" & Land & ") Saison " & Saison
    
    letzteZeileA = .Range("G" & Rows.Count).End(xlUp).Row
    
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    Call Calculate
            
    .Protect userinterfaceonly:=True, Password:=Passwort, AllowFiltering:=True
    .EnableAutoFilter = True
End With

Auswertungsdatei.Protect Password:=Passwort

End Sub

Attribute VB_Name = "ConstVar"
Public Const Passwort As String = "zsg62sgx3"

Public Saison As String
Public strVersion As String
Public blnImport As Boolean
Public blnAbbruch As Boolean
Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
'Exit Sub

Dim i As Integer
Dim IE As Object

ActiveWorkbook.Unprotect Password:=Passwort

Sheets("Hinweise").Visible = True
Sheets("Tipp-Status").Visible = True
Sheets("Platzierung").Visible = True
Sheets("Auswertungstool").Visible = True
Sheets("Fehler").Visible = False
Sheets("Auswertungstool").Activate

If Sheets("Auswertungstool").Range("E11").Value = "" Then Sheets("Auswertungstool").Range("E11").Value = ThisWorkbook.Path & "\Tippscheine\"

For i = 5 To 23 Step 2
    Sheets(i).Visible = True
Next i

ActiveWorkbook.Protect Password:=Passwort, Structure:=True, Windows:=False

'Pr|fffd|fung auf Updates|fffd|
Set IE = CreateObject("InternetExplorer.Application")
On Error Resume Next

IE.Visible = False
IE.navigate "https://www.makro-excel.de/db/version.txt?" & Replace(Replace(Replace(Now, " ", ""), ":", ""), ".", "")

Do: Loop Until IE.Busy = False
erneut:
While IE.Busy
    DoEvents
Wend

Do While IE.Busy
    DoEvents
Loop

strVersion = IE.document.DocumentElement.innertext

If strVersion <> "" And strVersion <> Sheets("Hinweise").Range("I3").Value And strVersion <> Sheets("Auswertungstool").Range("L4").Value Then UserForm1.Show

'Feedback
With Sheets("Hinweise")
    .Range("O42").Value = .Range("O42").Value + 1
    If .Range("O42").Value = .Range("O43").Value Then
        .Range("O43").Value = .Range("O43").Value + 10 'n|fffd|chste Erinnerung
        Feedback.Show
    End If
End With

End Sub
Attribute VB_Name = "Download"
'Option Explicit

Public Sub Pause(ByVal MilliSekunden As Double)
 
Dim i As Double
Dim Ende As Double

Ende = Timer + (MilliSekunden / 1000)

Do While i < Ende
   DoEvents
   i = Timer
Loop
 
End Sub

Sub ErgebnisseAbfragen()

Dim myURL As String, myURL2 As String
Dim WinHttpReq As Object
Dim WinHttpReq2 As Object
Dim i As Integer, j As Integer, x As Integer
Dim lngZeile As Long, lngZeile2 As Long
Dim Saison As String, Liga As String, Tabelle As String
Dim wshshell As Object, oStream As Object

On Error Resume Next:

blnImport = True

Set WinHttpReq = CreateObject("Microsoft.XMLHTTP")

'Variable Saison + Liga
Saison = Replace(Right(Sheets("Auswertungstool").Range("B2").Value, 9), "/", "_")
Tabelle = Sheets("Auswertungstool").Range("E9").Value

If Tabelle = "1. Bundesliga" Then
    Liga = "1BL"
ElseIf Tabelle = "2. Bundesliga" Then
    Liga = "2BL"
ElseIf Tabelle = "3. Bundesliga" Then
    Liga = "3BL"
ElseIf Tabelle = "Premier League" Then
    Liga = "1ENG"
ElseIf Tabelle = "S|fffd|perLig" Then
    Liga = "1TK"
ElseIf Tabelle = "Eredivisie" Then
    Liga = "1NL"
ElseIf Tabelle = "Ligue 1" Then
    Liga = "1FR"
ElseIf Tabelle = "Primera Division" Then
    Liga = "1ESP"
ElseIf Tabelle = "Serie A" Then
    Liga = "1IT"
End If

ActiveWorkbook.Unprotect Password:=Passwort
Sheets("Tabelle1").Visible = True
    
Sheets("Tabelle1").Activate
Sheets("Tabelle1").Unprotect Password:=Passwort

myURL = "https://www.makro-excel.de/db/" & Liga & "_" & Saison & ".xml?" & Replace(Replace(Replace(Now, " ", ""), ":", ""), ".", "")
Debug.Print myURL
'FileDateTime (myURL)
WinHttpReq.Open "GET", myURL ', False ', "username", "password"
WinHttpReq.send

Pause (500)

'   Debug.Print WinHttpReq.responseBody

'Debug.Print ThisWorkbook.Path & "\" & Liga & "_" & Saison & ".xml"
myURL = WinHttpReq.responseBody
Debug.Print WinHttpReq.Status

If WinHttpReq.Status = 200 Then
    Set oStream = CreateObject("ADODB.Stream")
    oStream.Open
    oStream.Type = 1
    oStream.Write WinHttpReq.responseBody
    oStream.SaveToFile ThisWorkbook.Path & "\" & Liga & "_" & Saison & ".xml", 2 ' 1 = no overwrite, 2 = overwrite
    oStream.Close
Else 'Alternative
    On Error GoTo Fehler:
    Set WinHttpReq2 = CreateObject("WinHttp.WinHttpRequest.5.1")
    myURL2 = "https://www.makro-excel.de/db/" & Liga & "_" & Saison & ".xml?" & Replace(Replace(Replace(Now, " ", ""), ":", ""), ".", "")
    Debug.Print myURL
    'FileDateTime (myURL)
    WinHttpReq2.Open "GET", myURL2 ', False ', "username", "password"
    WinHttpReq2.send
    
    Pause (150)
    
    'Debug.Print ThisWorkbook.Path & "\" & Liga & "_" & Saison & ".xml"
    myURL2 = WinHttpReq2.responseBody
'    Debug.Print WinHttpReq2.Status
    If WinHttpReq2.Status = 200 Then
        Set oStream = CreateObject("ADODB.Stream")
        oStream.Open
        oStream.Type = 1
        oStream.Write WinHttpReq2.responseBody
        oStream.SaveToFile ThisWorkbook.Path & "\" & Liga & "_" & Saison & ".xml", 2 ' 1 = no overwrite, 2 = overwrite
        oStream.Close
    Else
        GoTo Fehler:
    End If
End If

'Datei |fffd|ffnen
ActiveWorkbook.XmlImport URL:=ThisWorkbook.Path & "\" & Liga & "_" & Saison & ".xml", ImportMap:=Nothing, Overwrite:=True, Destination:=Sheets("Tabelle1").Range("$A$1")

Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual

'Ergebnisse importieren
x = 13
lngZeile = Sheets("Tabelle1").Range("A1048576").End(xlUp).Row
lngZeile2 = Sheets(Tabelle).Range("C1048576").End(xlUp).Row

For i = 2 To lngZeile
    For j = x To lngZeile2
        If Sheets("Tabelle1").Range("A" & i).Value = Sheets(Tabelle).Range("Q" & j).Value Then
            Sheets(Tabelle).Range("E" & j).Value = Sheets("Tabelle1").Range("B" & i).Value
            Sheets(Tabelle).Range("G" & j).Value = Sheets("Tabelle1").Range("C" & i).Value
            x = j + 1
            Exit For
        End If
    Next j
Next i
'Sheets("Tabelle1").Range("A:C").ClearContents
Sheets("Tabelle1").Columns("A:C").Delete Shift:=xlToLeft
Sheets("Tabelle1").Protect Password:=Passwort
Sheets(Tabelle).Activate

Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic
Call Calculate

Sheets("Tabelle1").Visible = False
ActiveWorkbook.Protect Password:=Passwort

'Webseite laden und Datei l|fffd|schen
ActiveWorkbook.FollowHyperlink Address:="https://www.makro-excel.de/downloads/aktueller-datenbestand-excel-tippspiel/"

Kill ThisWorkbook.Path & "\" & Liga & "_" & Saison & ".xml"

blnImport = False

Exit Sub
Fehler:
On Error Resume Next
blnImport = False
Sheets("Tabelle1").Activate
'Sheets("Tabelle1").Range("A:C").ClearContents
Sheets("Tabelle1").Columns("A:C").Delete Shift:=xlToLeft
Sheets("Tabelle1").Protect Password:=Passwort
Sheets("Tabelle1").Visible = False
Sheets(Tabelle).Activate
ActiveWorkbook.Protect Password:=Passwort
MsgBox "Excel konnte keine Verbindung zum Internet-Server herstellen. Die Ergebnisse konnten nicht aktualisiert werden."

End Sub

Attribute VB_Name = "Feedback"
Attribute VB_Base = "0{A49C6694-BB5A-4933-8FAB-D41770B152B1}{AA539657-88A3-46C9-88D1-A0C168308167}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Initialize()

ActiveWorkbook.FollowHyperlink Address:="https://www.makro-excel.de/unterstuetzen-sie-uns-mit-einem-like-oder-tweet/"

End Sub

Private Sub Image1_Click()
On Error Resume Next
ActiveWorkbook.FollowHyperlink Address:="https://www.makro-excel.de/"

End Sub

Private Sub Image2_Click()
On Error Resume Next
ActiveWorkbook.FollowHyperlink Address:="https://www.facebook.com/MakroExcel/"

End Sub

Private Sub Image4_Click()
On Error Resume Next
ActiveWorkbook.FollowHyperlink Address:="https://twitter.com/excelmakro"

End Sub

Private Sub CommandButton1_Click()

Unload Feedback

End Sub
Attribute VB_Name = "Funktionen"
Option Explicit

Sub FileList(Daten As Collection, Pfad As String, _
              Optional Filter As String = "", _
              Optional SubDIR As Boolean = False)
  
Dim Datei As String

Filter = Trim(Filter)
If Right$(Pfad, 1) <> "\" Then Pfad = Pfad & "\"

'ersten Eintrag im Ordner lesen
If SubDIR Or (SubDIR = False And Filter = "") Then
    Datei = Dir(Pfad & Filter, vbDirectory) 'Ausgabe mit Ordnernamen
Else
    Datei = Dir(Pfad & Filter)              'Ausgabe ohne Ordnernamen
End If

While Datei <> ""
    If Datei <> "." And Datei <> ".." Then Daten.Add (Pfad & Datei)
    Datei = Dir
Wend

End Sub
Attribute VB_Name = "HTML"
Option Explicit

Global strHTML As String

Sub Erstellen()

strHTML = ThisWorkbook.Path & "\HTML-Rangliste\" '"D:\1\bootstrap studio\Tippspiel\"
'Debug.Print "D:\Dateien vom Samsung Notebook\Bundesligatippspiel 2018\HTML-Rangliste"
'Debug.Print strHTML
'Debug.Print Dir(strHTML)
On Error Resume Next
If Dir(strHTML) = "" Then
    MsgBox "Der Ordner HTML-Rangliste einschlie|fffd|lich Unterordnern und ben|fffd|tigten Dateien ist nicht vorhanden. Die HTML Seiten k|fffd|nnen nicht erstellt werden."
    'MkDir strHTML
    Exit Sub
End If

'HTMLErstellen
INDEXerstellen
IMPRESSUMerstellen
PLATZIERUNGENerstellen
PLATZIERUNGENXXerstellen
RANGLISTEerstellen
REGELNerstellen
SONDERTIPPSerstellen
SPIELTAGEerstellen
SPIELTAGXXerstellen

End Sub

Sub INDEXerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "tippspiel.html"
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer
Dim Daten As Worksheet, Liga As Worksheet

Set Daten = ThisWorkbook.Worksheets("Daten")
strLiga = Sheets("Auswertungstool").Range("E9").Value
Set Liga = ThisWorkbook.Worksheets(strLiga)
Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)
Spieltag = Liga.Range("J2").Value
If Spieltag = 0 Then Spieltag = 1
If strLiga = "1. Bundesliga" Or strLiga = "2. Bundesliga" Or strLiga = "S|fffd|perLig" Or strLiga = "Eredivisie" Then
    AnzSpieltage = 34 'Spieltage pro Saison
    Spiele = 9 'pro Spieltag
    lngZeile = ((Spieltag - 1) * 14) + 13 'letzter gespielter Spieltag
Else
    AnzSpieltage = 38 'Spieltage pro Saison
    Spiele = 10 'pro Spieltag
    lngZeile = ((Spieltag - 1) * 15) + 13 'letzter gespielter Spieltag
End If

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
'Print #1, "    <meta charset=""utf-8"">"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
Print #1, "</head>"
Print #1, ""
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""jumbotron hero"" style=""background-image:url(&quot;assets/img/fan.jpg&quot;);"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-7 get-it"">"
Print #1, "                    <h1>Ergebnisse " & Spieltag & ". Spieltag</h1>"
Print #1, "                    <div class=""table-responsive"">"
Print #1, "                        <table class=""table"">"
Print #1, "                            <tbody>"
j = 0
For i = 1 To Spiele
    Print #1, "                                <tr>"
    Print #1, "                                    <td class=""partien"">" & Liga.Range("B" & lngZeile + j).Value & "</td>"
    Print #1, "                                    <td class=""partien"">-</td>"
    Print #1, "                                    <td class=""partien"">" & Liga.Range("D" & lngZeile + j).Value & "</td>"
    Print #1, "                                    <td class=""partien"">" & Liga.Range("E" & lngZeile + j).Value & ":" & Liga.Range("G" & lngZeile + j).Value & "</td>"
    Print #1, "                                </tr>"
    j = j + 1
Next i
Print #1, "                            </tbody>"
Print #1, "                        </table>"
Print #1, "                    </div>"
Print #1, "                    <p>Die letzte Tipp-Auswertung erfolgte am " & Daten.Range("A2").Value & ".</p>"
Print #1, "                    <p><a class=""btn btn-primary btn-lg"" role=""button"" href=""rangliste.html"">Rangliste </a><a class=""btn btn-success btn-lg"" role=""button"" href=""spieltage.html"">Spieltage </a></p>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </div>"
Print #1, "    <section class=""testimonials"">"
Print #1, "        <div class=""container"">"
Print #1, "            <h2 class=""text-center"">Excel Bundesliga Tippspiel " & Saison & " (V" & Sheets("Hinweise").Range("I3").Value & ")</h2>"
Print #1, "            <blockquote>"
Print #1, "                <p>Das kostenlose Excel Tippspiel gibt es f|fffd|r die 1. bis 3. Bundesliga, sowie ausgew|fffd|hlte europ|fffd|ische Ligen (unterst|fffd|tzt werden England, Spanien, Italien, Frankreich, T|fffd|rkei, Niederlande). Alle zwei Jahre gibt es dann noch das EM bzw. WM"
Print #1, "                    Tippspiel. Viel Spa|fffd| beim Tippen!</p>"
Print #1, "                <footer>Marco Schade - www.makro-excel.de</footer>"
Print #1, "            </blockquote>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "</body>"
Print #1, ""
Print #1, "</html>"

Close #1

End Sub

Sub RANGLISTEerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "rangliste.html"
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, x As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer
Dim Daten As Worksheet, Platzierung As Worksheet

Set Daten = ThisWorkbook.Worksheets("Daten")
strLiga = Sheets("Auswertungstool").Range("E9").Value
Set Platzierung = ThisWorkbook.Worksheets("Platzierung")
Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)
lngZeile = Platzierung.Range("A1048576").End(xlUp).Row

If strLiga = "1. Bundesliga" Or strLiga = "2. Bundesliga" Or strLiga = "S|fffd|perLig" Or strLiga = "Eredivisie" Then
    AnzSpieltage = 34 'Spieltage pro Saison
Else
    AnzSpieltage = 38 'Spieltage pro Saison
End If

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
Print #1, "    <link href=""css/jquery.dataTables.min.css"" rel=""stylesheet""/>"
Print #1, "</head>"
Print #1, ""
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li class=""active"" role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
Print #1, "    <div class=""container"">"
Print #1, "        <ol class=""breadcrumb"">"
Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
Print #1, "            <li class=""active""><span>Rangliste</span></li>"
Print #1, "        </ol>"
Print #1, "    </div>"
Print #1, "    <section class=""testimonials"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-12"">"
Print #1, "                    <h2 class=""text-center"">Rangliste*</h2>"
Print #1, "                    <div class=""table-responsive"">"
Print #1, "                        <table id=""dyn_tabelle"" class=""table table-hover table-bordered"">"
Print #1, "                            <thead>"
Print #1, "                                <tr>"
Print #1, "                                    <th>Platz</th>"
Print #1, "                                    <th>|fffd|nderung Vorwoche</th>"
Print #1, "                                    <th>Spielername</th>"
Print #1, "                                    <th class=""text-center"">Punkte</th>"
Print #1, "                                    <th class=""text-center"">Korrekte Ergebnisse</th>"
Print #1, "                                    <th class=""text-center"">Tordifferenz</th>"
Print #1, "                                    <th class=""text-center"">Tendenz</th>"
Print #1, "                                </tr>"
Print #1, "                            </thead>"
Print #1, "                            <tbody>"
If lngZeile > 5 Then
    For i = 6 To lngZeile
        Print #1, "                                <tr>"
        Print #1, "                                    <td>" & Replace(Platzierung.Range("A" & i).Value, ".", "") & "</td>"
        Print #1, "                                    <td>" & Platzierung.Range("B" & i).Value & "</td>"
        Print #1, "                                    <td>" & Platzierung.Range("C" & i).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Platzierung.Range("D" & i).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Platzierung.Range("E" & i).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Platzierung.Range("F" & i).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Platzierung.Range("G" & i).Value & "</td>"
        Print #1, "                                </tr>"
    Next i
End If
Print #1, "                            </tbody>"
Print #1, "                        </table>"
Print #1, "                    </div>"
If Sheets(strLiga).Range("J2").Value = AnzSpieltage Then
    Print #1, "            <p>* Endstand nach dem " & AnzSpieltage & ". Spieltag.</p>"
Else
    Print #1, "            <p>* Zwischenstand nach dem " & Sheets(strLiga).Range("J2").Value & ". Spieltag.</p>"
End If
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"

Print #1, "    <div>"
Print #1, "        <div class=""container"">"
Print #1, "            <h2 class=""text-center"">Rangliste am Spieltag</h2>"
Print #1, "            <div class=""col-md-12"">"
Print #1, "                <div class=""table-responsive"">"
Print #1, "                    <table class=""table"">"
Print #1, "                        <tbody>"
x = 1
If AnzSpieltage = 34 Then
    For i = 1 To 5
        Print #1, "                            <tr>"
        Print #1, "                                <td><a href=""platzierungen" & x & ".html"">" & x & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 1 & ".html"">" & x + 1 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 2 & ".html"">" & x + 2 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 3 & ".html"">" & x + 3 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 4 & ".html"">" & x + 4 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 5 & ".html"">" & x + 5 & ". Spieltag</a></td>"
        If i < 5 Then
            Print #1, "                                <td><a href=""platzierungen" & x + 6 & ".html"">" & x + 6 & ". Spieltag</a></td>"
        End If
        Print #1, "                            </tr>"
        x = x + 7
    Next i
Else
    For i = 1 To 6
        Print #1, "                            <tr>"
        Print #1, "                                <td><a href=""platzierungen" & x & ".html"">" & x & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 1 & ".html"">" & x + 1 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 2 & ".html"">" & x + 2 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 3 & ".html"">" & x + 3 & ". Spieltag</a></td>"
        If i < 6 Then
            Print #1, "                                <td><a href=""platzierungen" & x + 4 & ".html"">" & x + 4 & ". Spieltag</a></td>"
            Print #1, "                                <td><a href=""platzierungen" & x + 5 & ".html"">" & x + 5 & ". Spieltag</a></td>"
            Print #1, "                                <td><a href=""platzierungen" & x + 6 & ".html"">" & x + 6 & ". Spieltag</a></td>"
        End If
        Print #1, "                            </tr>"
        x = x + 7
    Next i
End If
Print #1, "                        </tbody>"
Print #1, "                    </table>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </div>"
Print #1, "    </section>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "    <script src=""js/jquery.dataTables.min.de.js""></script>"
Print #1, "    <script src=""js/dataTables.responsive.min.js""></script>"
Print #1, "    <script src=""js/responsive.bootstrap.min.js""></script>"
Print #1, "    <script type=""text/javascript"">"
Print #1, "            $(document).ready(function() {"
Print #1, "      $('#dyn_tabelle').DataTable( {"
Print #1, "        ""order"": [0, 'asc' ],"
Print #1, "        responsive: true"
Print #1, "    } );"
Print #1, "    });"
Print #1, "    </script>"
Print #1, "</body>"
Print #1, ""
Print #1, "</html>"
Close #1

End Sub

Sub SONDERTIPPSerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "sondertipps.html"
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer, lngSpalte As Integer
Dim Daten As Worksheet, Platzierung As Worksheet

Set Daten = ThisWorkbook.Worksheets("Daten")
strLiga = Sheets("Auswertungstool").Range("E9").Value
'Set Daten = ThisWorkbook.Worksheets("Platzierung")
Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)
lngZeile = Daten.Range("A24").End(xlUp).Row
lngSpalte = Daten.Range("XFD1").End(xlToLeft).Column

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel" & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"

Print #1, "</head>"
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
Print #1, "    <div class=""container"">"
Print #1, "        <ol class=""breadcrumb"">"
Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
Print #1, "            <li><a href=""rangliste.html""><span>Rangliste </span></a></li>"
Print #1, "            <li><a><span>Sondertipps </span></a></li>"
Print #1, "        </ol>"
Print #1, "    </div>"
Print #1, "    <section class=""testimonials"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-12"">"
Print #1, "                    <h2 class=""text-center"">Sondertipps </h2>"
Print #1, "                    <div class=""table-responsive"">"
Print #1, "                        <table class=""table table-hover table-bordered"">"
Print #1, "                            <thead>"
Print #1, "                                <tr>"
Print #1, "                                    <th>Spielername </th>"
For i = 8 To lngZeile
    Print #1, "                                    <th>" & Daten.Range("A" & i).Value & "</td>"
Next i
Print #1, "                                </tr>"
Print #1, "                            </thead>"
Print #1, "                            <tbody>"
If lngSpalte > 1 Then
    For j = 2 To lngSpalte
        Print #1, "                                <tr>"
        Print #1, "                                    <td>" & Daten.Cells(1, j).Value & "</td>"
        For i = 8 To lngZeile
            Print #1, "                                    <td>" & Daten.Cells(i, j).Value & "</td>"
        Next i
        Print #1, "                                </tr>"
    Next j
End If
Print #1, "                            </tbody>"
Print #1, "                        </table>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "</body>"
Print #1, "</html>"

Close #1

End Sub

Sub SPIELTAGEerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "spieltage.html"
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, x As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer, lngSpalte As Integer
Dim Daten As Worksheet, Platzierung As Worksheet

Set Daten = ThisWorkbook.Worksheets("Daten")
strLiga = Sheets("Auswertungstool").Range("E9").Value
'Set Daten = ThisWorkbook.Worksheets("Platzierung")
Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)

lngZeile = Daten.Range("A24").End(xlUp).Row
lngSpalte = Daten.Range("XFD1").End(xlToLeft).Column

If strLiga = "1. Bundesliga" Or strLiga = "2. Bundesliga" Or strLiga = "S|fffd|perLig" Or strLiga = "Eredivisie" Then
    AnzSpieltage = 34 'Spieltage pro Saison
Else
    AnzSpieltage = 38 'Spieltage pro Saison
End If

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
Print #1, "</head>"
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
Print #1, "                    <li class=""active"" role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
Print #1, "    <div class=""container"">"
Print #1, "        <ol class=""breadcrumb"">"
Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
Print #1, "            <li class=""active""><span>Spieltage </span></li>"
Print #1, "        </ol>"
Print #1, "    </div>"
Print #1, "    <div>"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row icon-features"">"
Print #1, "                <div class=""col-xs-4 icon-feature"">"
Print #1, "                    <a href=""regeln.html""></a>"
Print #1, "                </div>"
Print #1, "                <div class=""col-xs-4 icon-feature"">"
Print #1, "                    <a href=""platzierungen.html""></a>"
Print #1, "                    <h2 class=""text-center"">Spieltage </h2></div>"
Print #1, "                <div class=""col-xs-4 icon-feature""><a href=""spieltag1.html""><i class=""glyphicon glyphicon-chevron-right""></i></a></div>"
Print #1, "            </div>"
Print #1, "            <h1 class=""text-center"">Spielpaarungen der Spieltage anzeigen</h1>"
Print #1, "            <div class=""col-md-12"">"
Print #1, "                <div class=""table-responsive"">"
Print #1, "                    <table class=""table"">"
Print #1, "                        <tbody>"
x = 1
If AnzSpieltage = 34 Then
    For i = 1 To 5
        Print #1, "                            <tr>"
        Print #1, "                                <td><a href=""spieltag" & x & ".html"">" & x & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 1 & ".html"">" & x + 1 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 2 & ".html"">" & x + 2 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 3 & ".html"">" & x + 3 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 4 & ".html"">" & x + 4 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 5 & ".html"">" & x + 5 & ". Spieltag</a></td>"
        If i < 5 Then
            Print #1, "                                <td><a href=""spieltag" & x + 6 & ".html"">" & x + 6 & ". Spieltag</a></td>"
        End If
        Print #1, "                            </tr>"
        x = x + 7
    Next i
Else
    For i = 1 To 6
        Print #1, "                            <tr>"
        Print #1, "                                <td><a href=""spieltag" & x & ".html"">" & x & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 1 & ".html"">" & x + 1 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 2 & ".html"">" & x + 2 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""spieltag" & x + 3 & ".html"">" & x + 3 & ". Spieltag</a></td>"
        If i < 6 Then
            Print #1, "                                <td><a href=""spieltag" & x + 4 & ".html"">" & x + 4 & ". Spieltag</a></td>"
            Print #1, "                                <td><a href=""spieltag" & x + 5 & ".html"">" & x + 5 & ". Spieltag</a></td>"
            Print #1, "                                <td><a href=""spieltag" & x + 6 & ".html"">" & x + 6 & ". Spieltag</a></td>"
        End If
        Print #1, "                            </tr>"
        x = x + 7
    Next i
End If
Print #1, "                        </tbody>"
Print #1, "                    </table>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </div>"
Print #1, "    <section class=""testimonials""></section>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "</body>"
Print #1, "</html>"

Close #1

End Sub

Sub PLATZIERUNGENerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "platzierungen.html"
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, x As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer, lngSpalte As Integer
Dim Daten As Worksheet, Platzierung As Worksheet

Set Daten = ThisWorkbook.Worksheets("Daten")
strLiga = Sheets("Auswertungstool").Range("E9").Value
'Set Daten = ThisWorkbook.Worksheets("Platzierung")
Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)
lngZeile = Daten.Range("A24").End(xlUp).Row
lngSpalte = Daten.Range("XFD1").End(xlToLeft).Column

If strLiga = "1. Bundesliga" Or strLiga = "2. Bundesliga" Or strLiga = "S|fffd|perLig" Or strLiga = "Eredivisie" Then
    AnzSpieltage = 34 'Spieltage pro Saison
Else
    AnzSpieltage = 38 'Spieltage pro Saison
End If

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
Print #1, "</head>"
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste</a></li>"
Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage</a></li>"
Print #1, "                    <li class=""active"" role=""presentation""><a href=""platzierungen.html"">Platzierungen</a></li>"
Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
Print #1, "    <div class=""container"">"
Print #1, "        <ol class=""breadcrumb"">"
Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
Print #1, "            <li><a href=""rangliste.html""><span>Rangliste</span></a></li>"
Print #1, "            <li class=""active""><span>Platzierungen</span></li>"
Print #1, "        </ol>"
Print #1, "    </div>"
Print #1, "    <div>"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row icon-features"">"
Print #1, "                <div class=""col-xs-4 icon-feature"">"
Print #1, "                    <a href=""regeln.html""></a>"
Print #1, "                </div>"
Print #1, "                <div class=""col-xs-4 icon-feature"">"
Print #1, "                    <a href=""platzierungen.html""></a>"
Print #1, "                    <h2 class=""text-center"">Spieltage </h2></div>"
Print #1, "                <div class=""col-xs-4 icon-feature""><a href=""platzierungen1.html""><i class=""glyphicon glyphicon-chevron-right""></i></a></div>"
Print #1, "            </div>"
Print #1, "            <h1 class=""text-center"">Zwischenstand an den Spieltagen anzeigen</h1>"
Print #1, "            <div class=""col-md-12"">"
Print #1, "                <div class=""table-responsive"">"
Print #1, "                    <table class=""table"">"
Print #1, "                        <tbody>"

x = 1
If AnzSpieltage = 34 Then
    For i = 1 To 5
        Print #1, "                            <tr>"
        Print #1, "                                <td><a href=""platzierungen" & x & ".html"">" & x & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 1 & ".html"">" & x + 1 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 2 & ".html"">" & x + 2 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 3 & ".html"">" & x + 3 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 4 & ".html"">" & x + 4 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 5 & ".html"">" & x + 5 & ". Spieltag</a></td>"
        If i < 5 Then
            Print #1, "                                <td><a href=""platzierungen" & x + 6 & ".html"">" & x + 6 & ". Spieltag</a></td>"
        End If
        Print #1, "                            </tr>"
        x = x + 7
    Next i
Else
    For i = 1 To 6
        Print #1, "                            <tr>"
        Print #1, "                                <td><a href=""platzierungen" & x & ".html"">" & x & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 1 & ".html"">" & x + 1 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 2 & ".html"">" & x + 2 & ". Spieltag</a></td>"
        Print #1, "                                <td><a href=""platzierungen" & x + 3 & ".html"">" & x + 3 & ". Spieltag</a></td>"
        If i < 6 Then
            Print #1, "                                <td><a href=""platzierungen" & x + 4 & ".html"">" & x + 4 & ". Spieltag</a></td>"
            Print #1, "                                <td><a href=""platzierungen" & x + 5 & ".html"">" & x + 5 & ". Spieltag</a></td>"
            Print #1, "                                <td><a href=""platzierungen" & x + 6 & ".html"">" & x + 6 & ". Spieltag</a></td>"
        End If
        Print #1, "                            </tr>"
        x = x + 7
    Next i
End If

Print #1, "                        </tbody>"
Print #1, "                    </table>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </div>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "</body>"
Print #1, "</html>"

Close #1

End Sub

Sub PLATZIERUNGENXXerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object
Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, x As Integer, y As Integer, ii As Integer, Punkte As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer, lngSpalte As Integer
Dim Daten As Worksheet, Platzierung As Worksheet

strLiga = Sheets("Auswertungstool").Range("E9").Value

If strLiga = "1. Bundesliga" Or strLiga = "2. Bundesliga" Or strLiga = "S|fffd|perLig" Or strLiga = "Eredivisie" Then
    AnzSpieltage = 34 'Spieltage pro Saison
Else
    AnzSpieltage = 38 'Spieltage pro Saison
End If

Set Platzierung = ThisWorkbook.Worksheets("Platzierung")

Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)
lngZeile = Platzierung.Range("A1048576").End(xlUp).Row
'lngSpalte = Platzierung.Range("XFD1").End(xlToLeft).Column
x = 9

For i = 1 To AnzSpieltage

    Set FSO = CreateObject("Scripting.FileSystemObject")
    
    'Datei erstellen
    strDatei = strHTML & "platzierungen" & i & ".html"
    Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
    Datei.Close
    
    'Datei beschreiben
    Open strDatei For Output As #1
    
    Print #1, "<!DOCTYPE html>"
    Print #1, "<html>"
    Print #1, "<head>"
    Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
    Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
    Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
    Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
    Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
    Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
    Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
    Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
    Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
    Print #1, "    <link href=""css/jquery.dataTables.min.css"" rel=""stylesheet""/>"
    Print #1, "</head>"
    Print #1, "<body>"
    Print #1, "    <nav class=""navbar navbar-default"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
    Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
    Print #1, "            </div>"
    Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
    Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
    Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste</a></li>"
    Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage</a></li>"
    Print #1, "                    <li class=""active"" role=""presentation""><a href=""platzierungen.html"">Platzierungen</a></li>"
    Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln</a></li>"
    Print #1, "                </ul>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </nav>"
    Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
    Print #1, "    <div class=""container"">"
    Print #1, "        <ol class=""breadcrumb"">"
    Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
    Print #1, "            <li><a href=""rangliste.html""><span>Rangliste</span></a></li>"
    Print #1, "            <li><a href=""platzierungen.html""><span>Platzierungen</span></a></li>"
    Print #1, "            <li class=""active""><span>" & i & ". Spieltag</span></li>"
    Print #1, "        </ol>"
    Print #1, "    </div>"
    Print #1, "    <div>"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row icon-features"">"
    If i > 1 Then
        Print #1, "                <div class=""col-xs-4 icon-feature""><a href=""platzierungen" & i - 1 & ".html""><i class=""glyphicon glyphicon-chevron-left""></i></a></div>"
    Else
        Print #1, "                <div class=""col-xs-4 icon-feature""></div>"
    End If
    Print #1, "                <div class=""col-xs-4 icon-feature"">"
    Print #1, "                    <a href=""platzierungen.html""></a>"
    Print #1, "                    <h2 class=""text-center"">" & i & ". Spieltag </h2></div>"
    If i < 34 Then Print #1, "                <div class=""col-xs-4 icon-feature""><a href=""platzierungen" & i + 1 & ".html""><i class=""glyphicon glyphicon-chevron-right""></i></a></div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </div>"
    Print #1, "    <section class=""testimonials"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-md-12"">"
    Print #1, "                    <div class=""table-responsive"">"
    Print #1, "                        <table id=""dyn_tabelle"" class=""table table-hover table-bordered"">"
    Print #1, "                            <thead>"
    Print #1, "                                <tr>"
    Print #1, "                                    <th>Platz</th>"
    Print #1, "                                    <th>Platz Vorwoche</th>"
    Print #1, "                                    <th>Spielername</th>"
    If i = 34 Then
        Print #1, "                                    <th>Punkte Gesamt (mit Sondertipps)</th>"
    Else
        Print #1, "                                    <th>Punkte Gesamt</th>"
    End If
    Print #1, "                                    <th>Punkte Spieltag</th>"
    '+ Punkte Sondertipps
    Print #1, "                                </tr>"
    Print #1, "                            </thead>"
    Print #1, "                            <tbody>"
    
    For j = 6 To lngZeile
        Print #1, "                                <tr>"
        Print #1, "                                    <td>" & Platzierung.Cells(j, x + 1).Value & "</td>" 'Platz
        If x > 9 Then
            Print #1, "                                    <td>" & Platzierung.Cells(j, x - 1).Value & "</td>" 'Platz Vorwoche
        Else
            Print #1, "                                    <td>-</td>" 'Platz Vorwoche
        End If
        Print #1, "                                    <td>" & Platzierung.Cells(j, 3).Value & "</td>" 'Spielername
        y = 9
        Punkte = 0
        For ii = 1 To i
            Punkte = Punkte + Platzierung.Cells(j, y).Value
            y = y + 2
        Next ii
        If i = 34 Then
            Print #1, "                                    <td>" & Punkte + Platzierung.Cells(j, 86).Value & "</td>" 'berechnen
        Else
            Print #1, "                                    <td>" & Punkte & "</td>" 'berechnen
        End If
        Print #1, "                                    <td>" & Platzierung.Cells(j, x).Value & "</td>"
        Print #1, "                                </tr>"
    Next j
    x = x + 2
    Print #1, "                            </tbody>"
    Print #1, "                        </table>"
    Print #1, "                    </div>"
    Print #1, "                </div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </section>"
    Print #1, "    <section class=""features"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-md-6"">"
    Print #1, "                    <h2>Die Spielregeln</h2>"
    Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
    Print #1, "                </div>"
    Print #1, "                <div class=""col-md-6"">"
    Print #1, "                    <div class=""row icon-features"">"
    Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
    Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
    Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
    Print #1, "                    </div>"
    Print #1, "                </div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </section>"
    Print #1, "    <footer class=""site-footer"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-sm-6"">"
    Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
    Print #1, "                <div class=""col-sm-3"">"
    Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
    Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </footer>"
    Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
    Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
    Print #1, "    <script src=""js/jquery.dataTables.min.de.js""></script>"
    Print #1, "    <script src=""js/dataTables.responsive.min.js""></script>"
    Print #1, "    <script src=""js/responsive.bootstrap.min.js""></script>"
    Print #1, "    <script type=""text/javascript"">"
    Print #1, "            $(document).ready(function() {"
    Print #1, "      $('#dyn_tabelle').DataTable( {"
    Print #1, "        ""order"": [0, 'asc' ],"
    Print #1, "        responsive: true"
    Print #1, "    } );"
    Print #1, "    });"
    Print #1, "    </script>"
    Print #1, "</body>"
    Print #1, "</html>"
    
    Close #1
    
Next i

End Sub

Sub SPIELTAGXXerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object
Dim Saison As String, strLiga As String
Dim i As Integer, j As Integer, x As Integer, y As Integer, ii As Integer, Punkte As Integer, Zeile As Integer, lngZeile As Long, AnzSpieltage As Integer, Spiele As Integer, Spieltag As Integer, lngSpalte As Integer
Dim Daten As Worksheet, Liga As Worksheet

strLiga = Sheets("Auswertungstool").Range("E9").Value

If strLiga = "1. Bundesliga" Or strLiga = "2. Bundesliga" Or strLiga = "S|fffd|perLig" Or strLiga = "Eredivisie" Then
    AnzSpieltage = 34 'Spieltage pro Saison
    Spiele = 9
Else
    AnzSpieltage = 38 'Spieltage pro Saison
    Spiele = 10
End If

Set Liga = ThisWorkbook.Worksheets(strLiga)
Set Daten = ThisWorkbook.Worksheets("Daten")

Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)
'lngZeile = Platzierung.Range("A1048576").End(xlUp).Row
lngSpalte = Daten.Range("XFD1").End(xlToLeft).Column
x = 9

For i = 1 To AnzSpieltage
    
    If AnzSpieltage = 34 Then
        y = (i - 1) * 14 + 13
        Zeile = ((i - 1) * 9) + 26
    Else
        y = (i - 1) * 15 + 13
        Zeile = ((i - 1) * 10) + 26
    End If
    
    Set FSO = CreateObject("Scripting.FileSystemObject")
    
    'Datei erstellen
    strDatei = strHTML & "spieltag" & i & ".html"
    Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
    Datei.Close
    
    'Datei beschreiben
    Open strDatei For Output As #1

    Print #1, "<!DOCTYPE html>"
    Print #1, "<html>"
    Print #1, "<head>"
    Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
    Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
    Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
    Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
    Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
    Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
    Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
    Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
    Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
    Print #1, "</head>"
    Print #1, "<body>"
    Print #1, "    <nav class=""navbar navbar-default"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
    Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
    Print #1, "            </div>"
    Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
    Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
    Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
    Print #1, "                    <li class=""active"" role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
    Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
    Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
    Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
    Print #1, "                </ul>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </nav>"
    Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
    Print #1, "    <div class=""container"">"
    Print #1, "        <ol class=""breadcrumb"">"
    Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
    Print #1, "            <li><a href=""spieltage.html""><span>Spieltage </span></a></li>"
    Print #1, "            <li class=""active""><span>" & i & ". Spieltag</span></li>"
    Print #1, "        </ol>"
    Print #1, "    </div>"
    Print #1, "    <div>"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row icon-features"">"
    If i > 1 Then
        Print #1, "                <div class=""col-xs-4 icon-feature""><a href=""spieltag" & i - 1 & ".html""><i class=""glyphicon glyphicon-chevron-left""></i></a></div>"
    Else
        Print #1, "                <div class=""col-xs-4 icon-feature""></div>"
    End If
    Print #1, "                <div class=""col-xs-4 icon-feature"">"
    Print #1, "                    <a href=""platzierungen.html""></a>"
    Print #1, "                    <h2 class=""text-center"">" & i & ". Spieltag </h2></div>"
    If i < 34 Then Print #1, "                <div class=""col-xs-4 icon-feature""><a href=""spieltag" & i + 1 & ".html""><i class=""glyphicon glyphicon-chevron-right""></i></a></div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </div>"
    Print #1, "    <section class=""testimonials"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-md-12"">"
    Print #1, "                    <div class=""table-responsive"">"
    Print #1, "                        <table class=""table table-hover table-bordered"">"
    Print #1, "                            <thead>"
    Print #1, "                                <tr>"
    Print #1, "                                    <th>Spiel</th>"
    Print #1, "                                    <th>Heim</th>"
    Print #1, "                                    <th></th>"
    Print #1, "                                    <th>Ausw|fffd|rts</th>"
    Print #1, "                                    <th class=""text-center"">Ergebnis</th>"
    Print #1, "                                </tr>"
    Print #1, "                            </thead>"
    Print #1, "                            <tbody>"
    For j = 1 To Spiele
        Print #1, "                                <tr>"
        Print #1, "                                    <td>" & j & "</td>"
        Print #1, "                                    <td>" & Liga.Range("B" & y + j - 1).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">-</td>"
        Print #1, "                                    <td>" & Liga.Range("D" & y + j - 1).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Liga.Range("E" & y + j - 1).Value & ":" & Liga.Range("G" & y + j - 1).Value & "</td>"
        Print #1, "                                </tr>"
    Next j
    Print #1, "                            </tbody>"
    Print #1, "                        </table>"
    Print #1, "                    </div>"
    Print #1, "                </div>"
    Print #1, "            </div>"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-md-12"">"
    Print #1, "                    <h1 class=""text-center"">Tipps</h1></div>"
    Print #1, "                <div class=""col-md-12"">"
    Print #1, "                    <div class=""table-responsive"">"
    Print #1, "                        <table class=""table table-hover table-bordered"">"
    Print #1, "                            <thead>"
    Print #1, "                                <tr>"
    Print #1, "                                    <th>Spielername</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 1</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 2</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 3</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 4</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 5 </th>"
    Print #1, "                                    <th class=""text-center"">Spiel 6</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 7</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 8</th>"
    Print #1, "                                    <th class=""text-center"">Spiel 9</th>"
    If AnzSpieltage = 38 Then Print #1, "                                    <th class=""text-center"">Spiel 10</th>"
    Print #1, "                                </tr>"
    Print #1, "                            </thead>"
    Print #1, "                            <tbody>"
    For j = 2 To lngSpalte
        Print #1, "                                <tr>"
        Print #1, "                                    <td>" & Daten.Cells(1, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 1, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 2, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 3, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 4, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 5, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 6, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 7, j).Value & "</td>"
        Print #1, "                                    <td class=""text-center"">" & Daten.Cells(Zeile + 8, j).Value & "</td>"
        If AnzSpieltage = 38 Then Print #1, "                                    <th class=""text-center"">" & Daten.Cells(Zeile + 9, j).Value & "</th>"
        Print #1, "                                </tr>"
    Next j
    Print #1, "                            </tbody>"
    Print #1, "                        </table>"
    Print #1, "                    </div>"
    Print #1, "                </div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </section>"
    Print #1, "    <section class=""features"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-md-6"">"
    Print #1, "                    <h2>Die Spielregeln</h2>"
    Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
    Print #1, "                </div>"
    Print #1, "                <div class=""col-md-6"">"
    Print #1, "                    <div class=""row icon-features"">"
    Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
    Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
    Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
    Print #1, "                    </div>"
    Print #1, "                </div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </section>"
    Print #1, "    <footer class=""site-footer"">"
    Print #1, "        <div class=""container"">"
    Print #1, "            <div class=""row"">"
    Print #1, "                <div class=""col-sm-6"">"
    Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
    Print #1, "                <div class=""col-sm-3"">"
    Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
    Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
    Print #1, "            </div>"
    Print #1, "        </div>"
    Print #1, "    </footer>"
    Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
    Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
    Print #1, "</body>"
    Print #1, "</html>"
    
    Close #1
    
Next i

End Sub

Sub REGELNerstellen()

Dim strDatei As String, Auswertungsliga As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "regeln.html"

If Dir(strDatei) <> "" Then Exit Sub
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String
Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)

Auswertungsliga = Sheets("Auswertungstool").Range("E9").Value

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
Print #1, "</head>"
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
Print #1, "                    <li class=""active"" role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
Print #1, "    <div class=""container"">"
Print #1, "        <ol class=""breadcrumb"">"
Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
Print #1, "            <li class=""active""><span>Regeln </span></li>"
Print #1, "        </ol>"
Print #1, "    </div>"
Print #1, "    <section class=""testimonials"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-12"">"
Print #1, "                    <h2>Die Spielregeln </h2>"
Print #1, "                    <hr>"
Print #1, "                    <p>F|fffd|r ein richtig getipptes Ergebnis gibt es " & Sheets(Auswertungsliga).Range("O12").Value & " Punkte, f|fffd|r die richtige Tordifferenz " & Sheets(Auswertungsliga).Range("O13").Value & " Punkte und f|fffd|r die Tendenz (Heimsieg, Unentschieden, Ausw|fffd|rtssieg) gibt es noch " & Sheets(Auswertungsliga).Range("O14").Value & " Punkt(e).</p>"
Print #1, "                    <p>Bei Unentschieden gibt es keine Tordifferenz, daher k|fffd|nnen Sie hier entweder " & Sheets(Auswertungsliga).Range("O12").Value & " Punkte f|fffd|r das richtige Ergebnis, oder je nach gew|fffd|hlter Option " & Sheets(Auswertungsliga).Range("O13").Value & " Punkt(e) f|fffd|r die Tordifferenz oder " & Sheets(Auswertungsliga).Range("O14").Value & " Punkt(e) f|fffd|r die Tendenz bekommen.</p>"
Print #1, "                    <p>Beispiele f|fffd|r die Punkteberechnung: </p>"
Print #1, "                    <table class=""table table-hover"">"
Print #1, "                    <thead>"
Print #1, "                    <tr><th>Tipp:</th><th>Ergebnis:</th><th>Punkte</th><th></th></tr>"
Print #1, "                    </thead>"
Print #1, "                    <tbody>"
Print #1, "                    <tr><td>3:1</td><td>3:1</td><td>" & Sheets(Auswertungsliga).Range("O12").Value & "</td><td>Ergebnis richtig getippt</td></tr>"
Print #1, "                    <tr><td>0:0</td><td>0:0</td><td>" & Sheets(Auswertungsliga).Range("O12").Value & "</td><td>Ergebnis richtig getippt</td></tr>"
Print #1, "                    <tr><td colspan=""4""><hr></td></tr>"
Print #1, "                    <tr><td>1:2</td><td>0:1</td><td>" & Sheets(Auswertungsliga).Range("O13").Value & "</td><td>Tordifferenz richtig getippt</td></tr>"
Print #1, "                    <tr><td>2:0</td><td>3:1</td><td>" & Sheets(Auswertungsliga).Range("O13").Value & "</td><td>Tordifferenz richtig getippt</td></tr>"
If Sheets(Auswertungsliga).Range("O15").Value = "Tordifferenz" Then
    Print #1, "                    <tr><td>1:1</td><td>2:2</td><td>" & Sheets(Auswertungsliga).Range("O13").Value & "</td><td>Tordifferenz richtig getippt</td></tr>"
    Print #1, "                    <tr><td colspan=""4""><hr></td></tr>"
Else
    Print #1, "                    <tr><td colspan=""4""><hr></td></tr>"
    Print #1, "                    <tr><td>1:1</td><td>2:2</td><td>" & Sheets(Auswertungsliga).Range("O14").Value & "</td><td>Tendenz richtig getippt</td></tr>"
End If
Print #1, "                    <tr><td>3:0</td><td>1:0</td><td>" & Sheets(Auswertungsliga).Range("O14").Value & "</td><td>Tendenz richtig getippt</td></tr>"
Print #1, "                    <tr><td colspan=""4""><hr></td></tr>"
Print #1, "                    <tr><td>0:2</td><td>1:1</td><td>0</td><td>falsches Ergebnis</td></tr>"
Print #1, "                    </tbody>"
Print #1, "                    </table>"
Print #1, "                    <p>Die Punkteverteilung kann auf Wunsch ge|fffd|ndert werden. Tragen Sie hierf|fffd|r die gew|fffd|nschte Punktzahl in der Auswertungsdatei im Tabellenblatt: <strong>" & Auswertungsliga & "</strong> ein. Es ist nicht n|fffd|tig die Punktzahl in den einzelnen Tippscheinen anzupassen. Bei der Tippauswertung werden die Punktzahlen immer ggf. entsprechend angepasst.</p>"
Print #1, "                    <p>Das Tippspiel bietet au|fffd|erdem die M|fffd|glichkeit Zusatzpunkte f|fffd|r Sondertipps vergeben zu k|fffd|nnen. Diese Funktion ist optional. M|fffd|chten Sie keine Punkte f|fffd|r Sondertipps vergeben, setzen Sie die Punktzahl auf <strong>""Null""</strong> Punkte.</p>"
Print #1, "                    <p>F|fffd|r die Tippauswertung einer Tippergemeinschaft k|fffd|nnen Sie die Datei Tippauswertung.xlsm verwenden. Diese Datei ist ebenfalls im Downloadpaket enthalten.</p>"
Print #1, "                    <p>Bei Punktgleichheit am Ende der Saison entscheiden die Meisten richtig getippten Ergebnisse. Wurde auch die gleiche Anzahl an richtigen Ergebnissen getippt, entscheidet die Anzahl der richtig getippten Tordifferenzen.</p>"
Print #1, "                    <h2>Die Punktevergabe</h2>"
Print #1, "                    <hr>"
Print #1, "                    <p>Ergebnis richtig getippt: <strong>" & Sheets(Auswertungsliga).Range("O12").Value & " Punkte</strong></p>"
Print #1, "                    <p>Tordifferenz richtig getippt: <strong>" & Sheets(Auswertungsliga).Range("O13").Value & " Punkte</strong></p>"
Print #1, "                    <p>Tendenz richtig getippt: <strong>" & Sheets(Auswertungsliga).Range("O14").Value & " Punkt</strong></p>"
Print #1, "                    <p>Unentschieden werden gewertet als <strong>" & Sheets(Auswertungsliga).Range("O15").Value & ".</strong></p>"
'Print #1, "                    <p>Punkte f|fffd|r Sondertipps:</p>"
''" & Sheets(Auswertungsliga).Range("O12").Value & "

Print #1, "                    <h2>Rechtliche Hinweise</h2>"
Print #1, "                    <hr>"
Print #1, "                    <p>Die Nutzung des Tippspiels ist nur zu nicht kommerziellen Zwecken erlaubt. Die kostenlose Version darf nur in unver|fffd|nderter Version genutzt werden. Die HTML-Dateien d|fffd|rfen grunds|fffd|tzlich nur in unver|fffd|nderter Form genutzt werden. Eine"
Print #1, "                    Ver|fffd|ffentlichung der Dateien im Internet erfolgt ausschlie|fffd|lich auf eigenes Risiko. Bei einer Ver|fffd|ffentlichung im Internet m|fffd|ssen Sie die notwendigen Pflichtangaben nach dem <a href=""https://www.gesetze-im-internet.de/tmg/tippspiel.html"" target=""_blank"">Telemediengesetz</a> beachten. Bei einer Ver|fffd|ffentlichung ist der "
Print #1, "                    inhaltliche Verantwortliche nicht der Ersteller der Tippspiels Marco Schade. Diese Angaben m|fffd|ssen von Ihnen dementsprechend ge|fffd|ndert werden! Eine Haftung f|fffd|r Rechtsverst|fffd||fffd|e wird nicht |fffd|bernommen."
Print #1, "                    Der Urheber des Tippspiels kann f|fffd|r Sch|fffd|den oder Kosten die durch die Nutzung oder Ver|fffd|ffentlichung des Tippspiels entstehen nicht in Anspruch"
Print #1, "                    genommen werden. Mit Nutzung des Tippspiels akzeptieren Sie die vorhergehenden Regeln vollst|fffd|ndig. Eine weitergehende Nutzung ist nur nach vorheriger Genehmigung durch den Urheber gestattet.</p>"
Print #1, "                    <p>Das Excel Tippspiel ist urheberrechtlich gesch|fffd|tzt. Urheber ist:</p>"
Print #1, "                    <p><a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de</a></p>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "</body>"
Print #1, "</html>"

Close #1

End Sub

Sub IMPRESSUMerstellen()

Dim strDatei As String
Dim FSO As Object, Datei As Object

Set FSO = CreateObject("Scripting.FileSystemObject")

'Datei erstellen
strDatei = strHTML & "impressum.html"

If Dir(strDatei) <> "" Then Exit Sub
Set Datei = FSO.CreateTextFile(strDatei, True) ' & ".html", True)
Datei.Close

'Datei beschreiben
Open strDatei For Output As #1

Dim Saison As String

Saison = Right(Sheets("Auswertungstool").Range("B2").Value, 9)

Print #1, "<!DOCTYPE html>"
Print #1, "<html>"
Print #1, "<head>"
Print #1, "    <meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1252"" />"
Print #1, "    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">"
Print #1, "    <meta name=""description"" content=""Excel Bundesliga Tippspiel by www.makro-excel.de"">"
Print #1, "    <meta name=""robots"" content=""noindex,follow"">"
Print #1, "    <title>Excel Tippspiel " & Saison & "</title>"
Print #1, "    <link rel=""stylesheet"" href=""assets/bootstrap/css/bootstrap.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/fonts/font-awesome.min.css"">"
Print #1, "    <link rel=""stylesheet"" href=""assets/css/style.css"">"
Print #1, "</head>"
Print #1, "<body>"
Print #1, "    <nav class=""navbar navbar-default"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""navbar-header""><a class=""navbar-brand navbar-link"" href=""tippspiel.html""><i class=""fa fa-soccer-ball-o""></i> Excel Tippspiel " & Saison & "</a>"
Print #1, "                <button class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navcol-1""><span class=""sr-only"">Toggle navigation</span><span class=""icon-bar""></span><span class=""icon-bar""></span><span class=""icon-bar""></span></button>"
Print #1, "            </div>"
Print #1, "            <div class=""collapse navbar-collapse"" id=""navcol-1"">"
Print #1, "                <ul class=""nav navbar-nav navbar-right"">"
Print #1, "                    <li role=""presentation""><a href=""rangliste.html"">Rangliste </a></li>"
Print #1, "                    <li role=""presentation""><a href=""spieltage.html"">Spieltage </a></li>"
Print #1, "                    <li role=""presentation""><a href=""platzierungen.html"">Platzierungen </a></li>"
Print #1, "                    <li role=""presentation""><a href=""regeln.html"">Regeln </a></li>"
Print #1, "                    <li role=""presentation""><a href=""https://www.amexio.de/"">Gutscheine</a></li>"
Print #1, "                </ul>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </nav>"
Print #1, "    <div class=""container""><img class=""img-responsive"" src=""assets/img/fan_header.jpg""></div>"
Print #1, "    <div class=""container"">"
Print #1, "        <ol class=""breadcrumb"">"
Print #1, "            <li><a href=""tippspiel.html""><span>Home</span></a></li>"
Print #1, "            <li class=""active""><span>Impressum </span></li>"
Print #1, "        </ol>"
Print #1, "    </div>"
Print #1, "    <section class=""testimonials"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-12"">"
Print #1, "                    <h2>Impressum </h2>"
Print #1, "                    <hr>"
Print #1, "                    <p><strong>Sofern die Dateien ins Internet hochgeladen werden, ist nachfolgend ein inhaltlich verantwortlicher Ansprechpartner anzugeben.</strong></p>"
Print #1, "                    <p>Name:<br />Anschrift:<br />PLZ Ort: </p>"
Print #1, "                    <p>Tel: </p>"
Print #1, "                    <p>Inhaltlich Verantwortlicher gem|fffd||fffd| |fffd| 10 MDStV: </p>"
Print #1, "                    <h2>Rechtliche Hinweise</h2>"
Print #1, "                    <hr>"
Print #1, "                    <p>Die Nutzung des Tippspiels ist nur zu nicht kommerziellen Zwecken erlaubt. Die kostenlose Version darf nur in unver|fffd|nderter Version genutzt werden. Die HTML-Dateien d|fffd|rfen grunds|fffd|tzlich nur in unver|fffd|nderter Form genutzt werden. Eine"
Print #1, "                    Ver|fffd|ffentlichung der Dateien im Internet erfolgt ausschlie|fffd|lich auf eigenes Risiko. Bei einer Ver|fffd|ffentlichung im Internet m|fffd|ssen Sie die notwendigen Pflichtangaben nach dem <a href=""https://www.gesetze-im-internet.de/tmg/tippspiel.html"" target=""_blank"">Telemediengesetz</a> beachten. Bei einer Ver|fffd|ffentlichung im Internet ist der "
Print #1, "                    inhaltlich Verantwortliche nicht der Ersteller des Tippspiels! Diese Angaben m|fffd|ssen von Ihnen dementsprechend ge|fffd|ndert werden! Eine Haftung f|fffd|r Rechtsverst|fffd||fffd|e wird nicht |fffd|bernommen."
Print #1, "                    Der Urheber des Tippspiels kann f|fffd|r Sch|fffd|den oder Kosten die durch die Nutzung oder Ver|fffd|ffentlichung des Tippspiels entstehen nicht in Anspruch"
Print #1, "                    genommen werden. Mit Nutzung des Tippspiels akzeptieren Sie die vorhergehenden Regeln vollst|fffd|ndig. Eine weitergehende Nutzung ist nur nach vorheriger Genehmigung durch den Urheber gestattet.</p>"
Print #1, "                    <p>Das Excel Tippspiel ist urheberrechtlich gesch|fffd|tzt. Urheber ist:</p>"
Print #1, "                    <p><a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de</a></p>"
Print #1, "                    <h2>Haftungsausschluss (Disclaimer)</h2>"
Print #1, "                    <hr>"
Print #1, "                    <h3>Haftung f|fffd|r Inhalte</h3>"
Print #1, "                    <p>Als Diensteanbieter ist der Ersteller gem|fffd||fffd| |fffd| 7 Abs.1 TMG f|fffd|r eigene Inhalte auf diesen Seiten nach den allgemeinen Gesetzen verantwortlich. Nach |fffd||fffd| 8 bis 10 TMG ist der Ersteller als Diensteanbieter jedoch nicht verpflichtet, |fffd|bermittelte oder gespeicherte "
Print #1, "                    fremde Informationen zu |fffd|berwachen oder nach Umst|fffd|nden zu forschen, die auf eine rechtswidrige T|fffd|tigkeit hinweisen. Verpflichtungen zur Entfernung oder Sperrung der Nutzung von Informationen nach den allgemeinen Gesetzen bleiben hiervon unber|fffd|hrt. "
Print #1, "                    Eine diesbez|fffd|gliche Haftung ist jedoch erst ab dem Zeitpunkt der Kenntnis einer konkreten Rechtsverletzung m|fffd|glich. Bei Bekanntwerden von entsprechenden Rechtsverletzungen werden diese Inhalte umgehend entfernt.</p>"
Print #1, "                    <h3>Haftung f|fffd|r Links</h3>"
Print #1, "                    <p>Das Angebot enth|fffd|lt Links zu externen Webseiten Dritter, auf deren Inhalte der Ersteller keinen Einfluss hat. Deshalb kann der Ersteller f|fffd|r diese fremden Inhalte auch keine Gew|fffd|hr |fffd|bernehmen. F|fffd|r die Inhalte der verlinkten Seiten ist stets der jeweilige "
Print #1, "                    <p>Anbieter oder Betreiber der Seiten verantwortlich. Die verlinkten Seiten wurden zum Zeitpunkt der Verlinkung auf m|fffd|gliche Rechtsverst|fffd||fffd|e |fffd|berpr|fffd|ft. Rechtswidrige Inhalte waren zum Zeitpunkt der Verlinkung nicht erkennbar. Eine permanente inhaltliche "
Print #1, "                    <p>Kontrolle der verlinkten Seiten ist jedoch ohne konkrete Anhaltspunkte einer Rechtsverletzung nicht zumutbar. Bei Bekanntwerden von Rechtsverletzungen werden derartige Links umgehend entfernt.</p>"
Print #1, "                    <h3>Urheberrecht</h3>"
Print #1, "                    <p>Die durch die Seitenbetreiber erstellten Inhalte und Werke auf diesen Seiten unterliegen dem deutschen Urheberrecht. Die Vervielf|fffd|ltigung, Bearbeitung, Verbreitung und jede Art der Verwertung au|fffd|erhalb der Grenzen des Urheberrechtes bed|fffd|rfen der "
Print #1, "                    schriftlichen Zustimmung des jeweiligen Autors bzw. Erstellers. Downloads und Kopien dieser Seite sind nur f|fffd|r den privaten, nicht kommerziellen Gebrauch gestattet. Soweit die Inhalte auf dieser Seite nicht vom Betreiber erstellt wurden, werden die "
Print #1, "                    Urheberrechte Dritter beachtet. Insbesondere werden Inhalte Dritter als solche gekennzeichnet. Sollten Sie trotzdem auf eine Urheberrechtsverletzung aufmerksam werden, bitten wir um einen entsprechenden Hinweis. Bei Bekanntwerden von Rechtsverletzungen "
Print #1, "                    werden derartige Inhalte umgehend entfernt.</p>"
Print #1, "                    <p>Quellverweis: <a href=""https://www.e-recht24.de/muster-disclaimer.html"" target=""_blank"">eRecht24</a></p>"
Print #1, "                    <h2>Bildernachweis</h2>"
Print #1, "                    <hr>"
Print #1, "                    <p>|fffd| Sergej Khackimullin - Fotolia.com</p>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <section class=""features"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <h2>Die Spielregeln</h2>"
Print #1, "                    <p class=""white"">Die Punktevergabe kann die Tippgemeinschaft auf Wunsch selbstst|fffd|ndig anpassen. Optional k|fffd|nnen zudem Punkte f|fffd|r bestimmte Sondertipps vergeben werden. Zu den vollst|fffd|ndigen <a href=""regeln.html"">Spielregeln </a>.</p>"
Print #1, "                </div>"
Print #1, "                <div class=""col-md-6"">"
Print #1, "                    <div class=""row icon-features"">"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""regeln.html""><i class=""glyphicon glyphicon-info-sign""></i><p>Regeln &amp; Rechte</p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""platzierungen.html""><i class=""glyphicon glyphicon-list""></i><p>Platzierungen </p></a></div>"
Print #1, "                        <div class=""col-xs-4 icon-feature white""><a href=""sondertipps.html""><i class=""glyphicon glyphicon-hourglass""></i><p>Sondertipps </p></a></div>"
Print #1, "                    </div>"
Print #1, "                </div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </section>"
Print #1, "    <footer class=""site-footer"">"
Print #1, "        <div class=""container"">"
Print #1, "            <div class=""row"">"
Print #1, "                <div class=""col-sm-6"">"
Print #1, "                    <h5>powered by <a href=""https://www.makro-excel.de"" target=""_blank"">www.makro-excel.de </a> |fffd|" & Year(Now) & "</h5></div>"
Print #1, "                <div class=""col-sm-3"">"
Print #1, "                    <h5><a href=""impressum.html"">Impressum </a> </h5></div>"
Print #1, "                <div class=""col-sm-3 social-icons""><a href=""https://www.facebook.com/MakroExcel/"" target=""_blank""><i class=""fa fa-facebook""></i></a><a href=""https://twitter.com/excelmakro"" target=""_blank""><i class=""fa fa-twitter""></i></a></div>"
Print #1, "            </div>"
Print #1, "        </div>"
Print #1, "    </footer>"
Print #1, "    <script src=""assets/js/jquery.min.js""></script>"
Print #1, "    <script src=""assets/bootstrap/js/bootstrap.min.js""></script>"
Print #1, "</body>"
Print #1, "</html>"

Close #1

End Sub

Attribute VB_Name = "Modul1"
Option Explicit

Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro1 Makro
'

'
    Columns("R:T").EntireColumn.Hidden = True
End Sub
Attribute VB_Name = "Modul2"
Sub Ansicht()
Attribute Ansicht.VB_ProcData.VB_Invoke_Func = " \n14"

Dim Teams As Integer

ActiveSheet.Protect userinterfaceonly:=True, Password:=Passwort
ActiveWorkbook.Protect Password:=Passwort, Structure:=True, Windows:=False
    
If Range("CI1").Value = "1BL" Then
    Teams = 18
ElseIf Range("CI1").Value = "2BL" Then
    Teams = 18
ElseIf Range("CI1").Value = "3BL" Then
    Teams = 20
ElseIf Range("CI1").Value = "1TK" Then
    Teams = 18
ElseIf Range("CI1").Value = "1NL" Then
    Teams = 18
ElseIf Range("CI1").Value = "1ENG" Then
    Teams = 20
ElseIf Range("CI1").Value = "1ESP" Then
    Teams = 20
ElseIf Range("CI1").Value = "1FR" Then
    Teams = 20
ElseIf Range("CI1").Value = "1IT" Then
    Teams = 20
End If


If Range("CH1").Value > 3 Or Range("CH1").Value < 1 Then Range("CH1").Value = 3

If Teams = 18 Then
    If Range("CH1").Value = 3 Then
        'Gesamt anzeigen
        Columns("I:BX").EntireColumn.Hidden = False 'Gesamt
        Columns("BY:CF").EntireColumn.Hidden = True
    ElseIf Range("CH1").Value = 1 Then
        'Vorrunde anzeigen
        Columns("I:AP").EntireColumn.Hidden = False 'Vorrunde
        Columns("AQ:CF").EntireColumn.Hidden = True 'R|fffd|ckrunde
    ElseIf Range("CH1").Value = 2 Then
        'R|fffd|ckrunde anzeigen
        Columns("I:AP").EntireColumn.Hidden = True 'Vorrunde
        Columns("AQ:BX").EntireColumn.Hidden = False 'R|fffd|ckrunde
    End If
    If Range("CH1").Value = 3 Then
        Range("CH1").Value = 1
    Else
        Range("CH1").Value = Range("CH1").Value + 1
    End If
Else
    If Range("CH1").Value = 3 Then
        'Gesamt anzeigen
        Columns("I:CF").EntireColumn.Hidden = False 'Gesamt
    ElseIf Range("CH1").Value = 1 Then
        'Vorrunde anzeigen
        Columns("I:AT").EntireColumn.Hidden = False 'Vorrunde
        Columns("AU:CF").EntireColumn.Hidden = True 'R|fffd|ckrunde
    ElseIf Range("CH1").Value = 2 Then
        'R|fffd|ckrunde anzeigen
        Columns("I:AT").EntireColumn.Hidden = True 'Vorrunde
        Columns("AU:CF").EntireColumn.Hidden = False 'R|fffd|ckrunde
    End If
    If Range("CH1").Value = 3 Then
        Range("CH1").Value = 1
    Else
        Range("CH1").Value = Range("CH1").Value + 1
    End If
End If
    
ActiveSheet.Protect userinterfaceonly:=True, Password:=Passwort, AllowFiltering:=True

End Sub
Attribute VB_Name = "Saisonwechsel"
Option Explicit

Sub Saisonwechsel_Durchfuehren()

Dim Liga As String
Dim Von As Integer, Bis As Integer
Dim Zelle As Range

Call aendern

'----------------------------------------------------------------------------------
'Saison
'Tabelle: Auswertungstool
'Zelle: B2

Set Zelle = Sheets("Auswertungstool").Range("B2")

Liga = Left(Zelle, Len(Zelle) - 9)
Von = Left(Right(Zelle, 9), 4) + 1
Bis = Right(Zelle, 4) + 1

Sheets("Auswertungstool").Range("B2").Value = Liga & Von & "/" & Bis
Sheets("Auswertungstool").Range("E11:H11").Value = "C:\Bundesliga Tippspiel\Tippscheine\"
Sheets("Hinweise").Range("I4").Value = Format(Now, "DD.MM.YYYY")
Sheets("Hinweise").Range("O42").Value = 1
Sheets("Hinweise").Range("O43").Value = 10

'----------------------------------------------------------------------------------

'Tipp-Status und Platzierung leeren

Exit Sub

'die Ausblendung muss ggf. f|fffd|r alle Spielpl|fffd|ne erfolgen
Columns("Q:Q").EntireColumn.Hidden = True
Columns("J:J").EntireColumn.Hidden = True



End Sub

Attribute VB_Name = "Startseite"
Option Explicit

Sub Zurueck()

Sheets("Auswertungstool").Activate

End Sub

Sub TrainerTorschuetzen()

Debug.Print ActiveSheet.Name

'Spanien, Italien, Frankreich 34, T|fffd|rkei, 2 Liga, 3Liga 31, 1 Liga 35, Niederlande 32, England 33
If ActiveSheet.Name = "1. Bundesliga" Then
    Range("O35").Select
ElseIf ActiveSheet.Name = "Premier League" Then
    Range("O33").Select
ElseIf ActiveSheet.Name = "Eredivisie" Then
    Range("O32").Select
ElseIf ActiveSheet.Name = "Ligue 1" Or ActiveSheet.Name = "Primera Division" Or ActiveSheet.Name = "Serie A" Then
    Range("O34").Select
Else
    Range("O31").Select
End If

End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)

If blnImport = True Then Exit Sub
If Target.Cells.Count = 1 And Range("J3").Value <> Replace(Range("K3").Value, ".", "") Then
    ActiveSheet.Unprotect Password:=Passwort
    
    Call SpieltagAusw|fffd|hlen
    Range("J3").Value = Range("K3").Value

    ActiveSheet.Protect Password:=Passwort, AllowFiltering:=True
End If

End Sub
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Test"
Option Explicit

Sub aendern()
'Debug.Print Sheets.Count

Dim i As Integer

ActiveWorkbook.Unprotect Password:=Passwort

For i = 1 To 26
    Sheets(i).Visible = True
    Sheets(i).Unprotect Password:=Passwort
    Sheets(i).Activate
    ActiveWindow.DisplayHeadings = True
Next i

Sheets("Auswertungstool").Select
Columns("Q:T").EntireColumn.Hidden = False

End Sub

Sub fertig()

Dim i As Integer

ActiveWorkbook.Unprotect Password:=Passwort

Sheets("Auswertungstool").Select
Columns("Q:T").EntireColumn.Hidden = True

For i = 1 To 26
    Sheets(i).Activate
    ActiveWindow.DisplayHeadings = False
    If i <> 2 And i <> 24 And i <> 26 Then
        Sheets(i).Protect Password:=Passwort
    End If
    If i > 1 Then Sheets(i).Visible = False
Next i

Sheets("Hinweise").Range("O42").Value = 1
Sheets("Hinweise").Range("O43").Value = 10

ActiveWorkbook.Protect Password:=Passwort

End Sub

Sub Arbeitsmappe_Freigeben()

ActiveWorkbook.Unprotect Password:=Passwort

End Sub

Sub Blatt_Freigeben()

ActiveSheet.Unprotect Password:=Passwort

End Sub

Sub anpassen()
Dim i As Integer, j As Integer


For j = 4 To Range("B1048576").End(xlUp).Row
Debug.Print InStr(Range("B" & j).Value, "Spieltag")
    If InStr(Range("B" & j).Value, "Spieltag") > 0 Then
        i = i + 1
    End If
    Range("A" & j).Value = i
    If Range("B" & j).Value = "" Or InStr(Range("B" & j).Value, "Spieltag") > 0 Then
        Rows(j & ":" & j).Delete Shift:=xlUp
        j = j - 1
    End If
    If Range("B1048576").End(xlUp).Row <= j Then
        Exit For
    End If
Next j

End Sub

Sub anpassen2()

Dim i As Integer, j As Integer

For i = Range("B1048576").End(xlUp).Row To 4 Step -1
    Range("G" & i).Value = "Tipp"
    Rows(i & ":" & i).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("G" & i).Value = "Pkt."
Next i
Range("G3").Delete Shift:=xlUp

End Sub

Attribute VB_Name = "Updates"
Option Explicit

Sub UpdatesPruefen()
'Pr|fffd|fung auf Updates

Dim IE As Object

Set IE = CreateObject("InternetExplorer.Application")
On Error Resume Next

IE.Visible = False
IE.navigate "https://www.makro-excel.de/db/version.txt?" & Replace(Replace(Replace(Now, " ", ""), ":", ""), ".", "")

Do: Loop Until IE.Busy = False
erneut:
While IE.Busy
    DoEvents
Wend

Do While IE.Busy
    DoEvents
Loop

strVersion = IE.document.DocumentElement.innertext

UserForm1.Show

End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{25CCDFEF-A9CB-49E1-8D36-AD24E63A6709}{3A0DC072-2E1E-4E01-8447-1772874E4204}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CommandButton1_Click()

ActiveSheet.Unprotect Password:=Passwort

If CheckBox1 = True And Len(strVersion) < 5 Then
    Sheets("Auswertungstool").Range("L4").Value = strVersion
Else
    Sheets("Auswertungstool").Range("L4").Value = ""
End If

ActiveSheet.Protect Password:=Passwort

Unload UserForm1

End Sub

Private Sub Label3_Click()

ActiveWorkbook.FollowHyperlink Address:="https://www.makro-excel.de/2019/07/09/excel-bundesliga-tippspiel-2019-2020/"

End Sub

Private Sub Label5_Click()

ActiveWorkbook.FollowHyperlink Address:="https://www.makro-excel.de/downloads/excel-fussball-tippspiele-versionshistorie/"

End Sub

Private Sub UserForm_Initialize()

ActiveSheet.Unprotect Password:=Passwort
CheckBox1.Visible = False
CheckBox1.Value = False

If strVersion = Sheets("Hinweise").Range("I3").Value Then

    Label1.Caption = "Es sind keine Updates verf|fffd|gbar."
    Sheets("Auswertungstool").Range("E7:H7").Value = ""
ElseIf strVersion = "" Or Len(strVersion) > 5 Then
    Label1.Caption = "Die Pr|fffd|fung auf Updates konnte nicht durchgef|fffd|hrt werden. |fffd|berpr|fffd|fen Sie die Internetverbindung und versuchen es erneut."
    Label2.Caption = "Sie nutzen Version: " & Sheets("Hinweise").Range("I3").Value & ". Pr|fffd|fen Sie die aktuell verf|fffd|gbare Version auf der Webseite."
    Label4.Caption = "Online pr|fffd|fen auf:"
    Label3.Caption = "https://www.makro-excel.de/2019/07/09/excel-bundesliga-tippspiel-2019-2020/"
Else
    CheckBox1.Visible = True
    Label1.Caption = "Es ist eine neue Version verf|fffd|gbar. Sie nutzen Version: " & Sheets("Hinweise").Range("I3").Value
    Label2.Caption = "Aktuell steht Version: " & strVersion & " zum Download bereit."
    Label4.Caption = "Hier herunterladen:"
    Label3.Caption = "https://www.makro-excel.de/2019/07/09/excel-bundesliga-tippspiel-2019-2020/"
    ActiveSheet.Hyperlinks.Add Anchor:=Sheets("Auswertungstool").Range("E7:H7"), Address:= _
        "https://www.makro-excel.de/2019/07/09/excel-bundesliga-tippspiel-2019-2020/", TextToDisplay:= _
        "Es ist ein Update verf|fffd|gbar! Hier herunterladen"
    Sheets("Auswertungstool").Range("E7:H7").Font.Color = -16776961
End If

ActiveSheet.Protect Password:=Passwort

End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{CE454445-A4C5-4AE2-8AC7-0593BC4F1F64}{203DA30C-B600-42D8-B5A9-4C2ED1ABD38C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()

blnAbbruch = False

If OptionButton1 = True Then
    Unload UserForm2
    Call Tippauswertung
    If blnAbbruch = True Then Exit Sub
    Call Erstellen
ElseIf OptionButton2 = True Then
    Unload UserForm2
    Call Tippauswertung
Else
    MsgBox "Bitte eine Auswertungsoption w|fffd|hlen."
    Exit Sub
End If

If blnAbbruch = True Then Exit Sub

Call AlleTipps

Sheets("Platzierung").Activate

End Sub
Attribute VB_Name = "XML"
Option Explicit

Sub XML_erzeugen()

Dim dateiname As String
Dim i As Long, j As Long, max_r As Long
Dim x As Integer
Dim strDateiName$
Dim strPath$
Dim Saison As String, Tabelle As String, Liga As String

'Variable Saison + Liga
Saison = Replace(Right(Sheets("Auswertungstool").Range("B2").Value, 9), "/", "_")

For x = 2 To 10
    Tabelle = Sheets("Auswertungstool").Range("R" & x).Value
    
    If Tabelle = "1. Bundesliga" Then
        Liga = "1BL"
    ElseIf Tabelle = "2. Bundesliga" Then
        Liga = "2BL"
    ElseIf Tabelle = "3. Bundesliga" Then
        Liga = "3BL"
    ElseIf Tabelle = "Premier League" Then
        Liga = "1ENG"
    ElseIf Tabelle = "S|fffd|perLig" Then
        Liga = "1TK"
    ElseIf Tabelle = "Eredivisie" Then
        Liga = "1NL"
    ElseIf Tabelle = "Ligue 1" Then
        Liga = "1FR"
    ElseIf Tabelle = "Primera Division" Then
        Liga = "1ESP"
    ElseIf Tabelle = "Serie A" Then
        Liga = "1IT"
    End If
    
    Sheets(Tabelle).Activate
    dateiname = Liga & "_" & Saison
    max_r = Range("C1048576").End(xlUp).Row
    strDateiName = "\" & dateiname & ".xml"
    strPath = ThisWorkbook.Path
    
    Open strPath & strDateiName For Output Access Write As #1
    
    Print #1, "<?xml version=""1.0""?>"
    Print #1, "<saison>"
    i = 0
    For j = 13 To max_r
        If Cells(j, 3).Value = "-" Then
            i = i + 1
'            Cells(j, 17).Value = i 'einmalig um ID f|fffd|r die Partie zu erstellen
            Print #1, "<spiel>"
            Print #1, " <id>" & i & "</id>"
            Print #1, " <h>" & Cells(j, 5).Value & "</h>"
            Print #1, " <a>" & Cells(j, 7).Value & "</a>"
            Print #1, "</spiel>"
        End If
        
    Next j
    
    Print #1, "</saison>"
    
    Close #1
Next x

'Debug.Print "fertig"
End Sub



INQUEST-PP=macro
