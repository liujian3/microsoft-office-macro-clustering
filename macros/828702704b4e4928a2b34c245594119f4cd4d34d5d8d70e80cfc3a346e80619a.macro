Attribute VB_Name = "FormABC"
Attribute VB_Base = "0{7D49404F-E1C4-4037-B284-EA3EFF358E6C}{39A1F614-C644-423D-9F6F-F82DD87AB055}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub ComboBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub
Private Sub ComboBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub
Private Sub CommandButton1_Click()
    If ComboBox3.Text = "" Then MsgBox "Por Favor Coloque el Tipo de Movimiento", vbCritical, "Error": Exit Sub
    If ComboBox1.Text = "" Then MsgBox "Por Favor Coloque la Fecha Inicial", vbCritical, "Error": Exit Sub
    If ComboBox2.Text = "" Then MsgBox "Por Favor Coloque la Fecha Final", vbCritical, "Error": Exit Sub
    If ComboBox2 < ComboBox1 Then MsgBox "La Fecha Inicial no debe ser Mayor que la Fecha Final", vbCritical, "Error": Exit Sub
     ABC
End Sub
Sub ABC()
Cuenta = 0
Suma1 = 0
Suma2 = 0
Acumulado = 0
Acumula = 0

With Hoja3
    .Activate
    .Visible = xlSheetVisible
    .Select
    .Cells.Clear
    .Cells.Font.Name = "Arial Narrow"
    .Cells.Font.Size = 8
    .Cells(1, 1) = "Clasificaci|fffd|n Metodo ABC": .Cells(1, 1).Font.Size = 12
    .Cells(2, 1) = "Tipo de Operaci|fffd|n : " & ComboBox3.Text
    .Cells(3, 1) = "Fecha entre el a|fffd|o " & ComboBox1 & " hasta el a|fffd|o " & ComboBox2
    .Cells(4, 1) = "Consulta Realizada el dia " & Date & " a las " & Time
    .Cells(5, 1) = "C|fffd|digos"
    .Cells(5, 2) = "Detalle"
    .Cells(5, 3) = "Unidades"
    .Cells(5, 4) = "Valorizaci|fffd|n"
    .Cells(5, 5) = "% Participaci|fffd|n Items"
    .Cells(5, 6) = "% Participaci|fffd|n Valor"
    .Cells(5, 7) = "% Acumulado Items"
    .Cells(5, 8) = "% Acumulado Valor"
    .Cells(5, 9) = "Clasificaci|fffd|n ABC"
    .Columns(9).HorizontalAlignment = xlCenter
    .Range(.Cells(5, 1), .Cells(5, 9)).Borders(xlEdgeBottom).LineStyle = xlDot
End With
Inicio = Format(ComboBox1, "mm/dd/yyyy") 'Access solo conoce el Formato Americano por tanto la fecha se coloca mes,dia,a|fffd|o
Final = Format(ComboBox2, "mm/dd/yyyy") 'Access solo conoce el Formato Americano

Set Rs = New ADODB.Recordset

Sql = "Select Productos.Codigo, Productos.Detalle, Sum(Registros.Cantidad), Sum(Registros.Precio * Registros.Cantidad)" & _
" From Productos INNER JOIN Registros ON Registros.Codigo=Productos.Codigo" & _
" WHERE Registros.Movimiento= '" & ComboBox3 & "'" & _
" And Year(Registros.Fecha) BETWEEN #" & Inicio & "# And #" & Final & "#" & _
" Group By Productos.Codigo, Productos.Detalle" & _
" Order By Sum(Registros.Precio * Registros.Cantidad) Desc"

With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With

If Rs.RecordCount > 0 Then
    Hoja3.Cells(6, 1).CopyFromRecordset Rs
Else
    Rs.Close
    Set Rs = Nothing
    Exit Sub
End If

Uf = Hoja3.Range("A" & Rows.Count).End(xlUp).Row + 5
With Hoja3
    Cuenta = Application.WorksheetFunction.CountA(Hoja3.Range("A6:A" & Uf))
    Suma1 = .Application.WorksheetFunction.Sum(Range("C6:C" & Uf))
    Suma2 = .Application.WorksheetFunction.Sum(Range("D6:D" & Uf))
End With

Lin = 6
Do While Hoja3.Cells(Lin, 1) <> ""
If Hoja3.Cells(Lin, 3) > 0 Then
    Hoja3.Cells(Lin, 5) = (Cuenta / Cuenta) / Cuenta 'Unidades entre el total
    Hoja3.Cells(Lin, 6) = Hoja3.Cells(Lin, 4) / Suma2 'Montos individuales entre el Monto General
    Hoja3.Cells(Lin, 3).NumberFormat = "#,##0.00"
    Hoja3.Cells(Lin, 4).NumberFormat = "$ #,##0.00"
    Hoja3.Range(Cells(Lin, 5), Cells(Lin, 8)).NumberFormat = "0.00%" '% Rubros,Monto,Acumulado Rubros, Acumulado Montos
End If
    Lin = Lin + 1
Loop

''% de Acumulado de la participaci|fffd|n en Items y Montos por Grupo
Lin = 6
Do While Hoja3.Cells(Lin, 2) <> ""
    Acumulado = Acumulado + Hoja3.Cells(Lin, 5)
    Acumula = Acumula + Hoja3.Cells(Lin, 6)
    Hoja3.Cells(Lin, 7) = Acumulado
    Hoja3.Cells(Lin, 8) = Acumula
Lin = Lin + 1
Loop
'Clasificar por el Metoso ABC
Lin = 6
Do While Hoja3.Cells(Lin, 1) <> ""
    If Hoja3.Cells(Lin, 7) <= 1 Then
        Hoja3.Cells(Lin, 9) = "C"
    End If
    If Hoja3.Cells(Lin, 7) <= 0.5 Then
        Hoja3.Cells(Lin, 9) = "B"
    End If
    If Hoja3.Cells(Lin, 7) <= 0.3 Then
        Hoja3.Cells(Lin, 9) = "A"
    End If
    Lin = Lin + 1
Loop

With Hoja3
    A = .Application.WorksheetFunction.CountIf(Range("I6:I" & Uf), "A") 'Cuenta si es A
    B = .Application.WorksheetFunction.CountIf(Range("I6:I" & Uf), "B") 'Cuenta si es B
    C = .Application.WorksheetFunction.CountIf(Range("I6:I" & Uf), "C") 'Cuenta si es C
    SumaA = .Application.WorksheetFunction.SumIf(Range("I6:I" & Uf), "A", Range("C6:C" & Uf)) 'Suma todas Las Unidades que sea A
    SumaB = .Application.WorksheetFunction.SumIf(Range("I6:I" & Uf), "B", Range("C6:C" & Uf)) 'Suma todas Las Unidades que sea B
    SumaC = .Application.WorksheetFunction.SumIf(Range("I6:I" & Uf), "C", Range("C6:C" & Uf)) 'Suma todas Las Unidades que sea C
    SumaAA = .Application.WorksheetFunction.SumIf(Range("I6:I" & Uf), "A", Range("D6:D" & Uf)) 'Suma todas Los Montos que sea A
    SumaBB = .Application.WorksheetFunction.SumIf(Range("I6:I" & Uf), "B", Range("D6:D" & Uf)) 'Suma todas Los Montos que sea B
    SumaCC = .Application.WorksheetFunction.SumIf(Range("I6:I" & Uf), "C", Range("D6:D" & Uf)) 'Suma todas Los Montos que sea C
    .Range("A" & Lin + 1) = "Clasificaci|fffd|n"
    .Range("B" & Lin + 1) = "Items por Grupo"
    .Range("C" & Lin + 1) = "Cantidades"
    .Range("D" & Lin + 1) = "Valores"
    .Range("E" & Lin + 1) = "% Participaci|fffd|n Items"
    .Range("F" & Lin + 1) = "% Total Valor"
    .Range("A" & Lin + 1, "F" & Lin + 1).Borders(xlEdgeBottom).LineStyle = xlDot
    .Range("A" & Lin + 2) = "A"
    .Range("A" & Lin + 3) = "B"
    .Range("A" & Lin + 4) = "C"
    .Range("B" & Lin + 2) = A
    .Range("B" & Lin + 3) = B
    .Range("B" & Lin + 4) = C
    .Range("C" & Lin + 2) = SumaA: .Range("C" & Lin + 2).NumberFormat = "#,##0.00"
    .Range("C" & Lin + 3) = SumaB: .Range("C" & Lin + 3).NumberFormat = "#,##0.00"
    .Range("C" & Lin + 4) = SumaC: .Range("C" & Lin + 4).NumberFormat = "#,##0.00"
    .Range("D" & Lin + 2) = SumaAA: .Range("D" & Lin + 2).NumberFormat = "$ #,##0.00"
    .Range("D" & Lin + 3) = SumaBB: .Range("D" & Lin + 3).NumberFormat = "$ #,##0.00"
    .Range("D" & Lin + 4) = SumaCC: .Range("D" & Lin + 4).NumberFormat = "$ #,##0.00"
    .Range("E" & Lin + 2) = A / Cuenta: .Range("E" & Lin + 2).NumberFormat = "0.00%"
    .Range("E" & Lin + 3) = B / Cuenta: .Range("E" & Lin + 3).NumberFormat = "0.00%"
    .Range("E" & Lin + 4) = C / Cuenta: .Range("E" & Lin + 4).NumberFormat = "0.00%"
    .Range("F" & Lin + 2) = SumaAA / Suma2: .Range("F" & Lin + 2).NumberFormat = "0.00%"
    .Range("F" & Lin + 3) = SumaBB / Suma2: .Range("F" & Lin + 3).NumberFormat = "0.00%"
    .Range("F" & Lin + 4) = SumaCC / Suma2: .Range("F" & Lin + 4).NumberFormat = "0.00%"
    .Range("A" & Lin + 4, "F" & Lin + 4).Borders(xlEdgeBottom).LineStyle = xlDot
    .Range("A" & Lin + 5) = "Total Items"
    .Range("A" & Lin + 6) = "Total Cantidad"
    .Range("A" & Lin + 7) = "Total Valor"
    .Range("B" & Lin + 5) = Cuenta
    .Range("B" & Lin + 6) = Suma1
    .Range("B" & Lin + 7) = Suma2
    .Range("B" & Lin + 5).NumberFormat = "#,##0"
    .Range("B" & Lin + 6).NumberFormat = "#,##0.00"
    .Range("B" & Lin + 7).NumberFormat = "$ #,##0.00"
    .Range("A" & Lin + 5, "B" & Lin + 5).Borders(xlEdgeBottom).LineStyle = xlDot
    .Range("A" & Lin + 6, "B" & Lin + 6).Borders(xlEdgeBottom).LineStyle = xlDot
    .Range("A" & Lin + 7, "B" & Lin + 7).Borders(xlEdgeBottom).LineStyle = xlDot
    .Columns("B:Z").AutoFit
End With

    Rs.Close
    Set Rs = Nothing
    CommandButton2_Click
    FormMenu.CmbSalir = True
End Sub
Private Sub CommandButton2_Click()
    Unload Me
End Sub
Private Sub UserForm_Initialize()
    For I = 2014 To 2060
        ComboBox1.AddItem I
        ComboBox2.AddItem I
    Next I
    With ComboBox3
        .AddItem "ENTRADA"
        .AddItem "SALIDA"
    End With
End Sub
Attribute VB_Name = "FormCalendario"
Attribute VB_Base = "0{EAAACE51-C7FC-407C-8111-1AFF12A11BA4}{C25A9E48-12FD-4959-B4D2-BBD7E00C2D31}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub Calendar1_Click()
    dFecha = Calendar1.Value
    Unload Me
End Sub
Private Sub UserForm_Initialize()
    Calendar1.Value = Now()
    dFecha = 0
End Sub

Attribute VB_Name = "FormCategoria"
Attribute VB_Base = "0{E0FDB7AC-7954-40B2-8DA0-58C34D2FB9DF}{2168D77E-278E-4FE8-9E26-5FCC17A56556}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If TxtCategoria.Text = "" Then: MsgBox "Debe Digitar la Categoria del Producto", vbCritical, "Error": Beep: Exit Sub
If LblStatus.Caption = "Categoria Registrada" Then: MsgBox "No se Registra Datos Repetidos", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Segur@ de Registrar la Categoria " & TxtCategoria & " ?", vbQuestion + vbYesNo, "Registrar Categoria") = vbYes Then
    Guarda_Categoria
    Call Categoria
    TxtCategoria.Text = "": LblStatus.Caption = "": LblStatus.BackColor = &H8000000F: TxtCategoria.SetFocus
Else
Exit Sub
End If
End Sub
Private Sub CommandButton2_Click()
    Unload Me
End Sub
Private Sub TextBox1_Change()
    Verificar
End Sub
Sub Verificar()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(TxtCategoria))
    Sql = "Select * From TablaCategoria Where Categoria= '" & Dato & "'"
    Rs.Open Sql, Cnn, 3, 3, adCmdText
    If Rs.RecordCount > 0 Then: LblStatus.Caption = "Categoria Registrada": LblStatus.BackColor = vbRed
    If Rs.RecordCount = 0 Then: LblStatus.Caption = "Categoria Nueva": LblStatus.BackColor = vbGreen
    Rs.Close
    Set Rs = Nothing
End Sub
Private Sub TxtTipo_Change()
    If TxtCategoria.Text = "" Then: LblStatus.Caption = "": LblStatus.BackColor = &H8000000F: Exit Sub
    TxtCategoria = UCase(TxtCategoria)
    Verificar
End Sub
Private Sub TxtCategoria_Change()
    If TxtCategoria.Text = "" Then
    LblStatus.Caption = ""
    LblStatus.BackColor = &H8000000F
    Else
    Verificar
    End If
End Sub
Sub Guarda_Categoria()
    Sql = "INSERT INTO TablaCategoria(Categoria) Values('" & UCase(TxtCategoria) & "')"
    Cnn.Execute (Sql)
    MsgBox Mensaje, vbInformation, "Informaci|fffd|n de Registro"
End Sub
Attribute VB_Name = "FormClientes"
Attribute VB_Base = "0{E5608CA5-BCCD-46B1-85FC-087173C37149}{E086C3FC-959D-49BD-A171-BD7C2D7D55E7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If TxtNombre.Text = "" Then: MsgBox "Flta Colocar el Nombre del Cliente", vbCritical, "Error": TxtNombre.SetFocus: Exit Sub
If TxtDireccion.Text = "" Then: MsgBox "Falta Colocar la Direccion del Cliente", vbCritical, "Error": TxtDireccion.SetFocus: Exit Sub
If TxtTelefono.Text = "" Then: MsgBox "Falta Colocar el Telefono del Cliente", vbCritical, "Error": TxtTelefono.SetFocus: Exit Sub
If TxtContacto.Text = "" Then: MsgBox "Falta Colocar el Contacto del Cliente", vbCritical, "Error": TxtContacto.SetFocus: Exit Sub
If LblConfirma.Caption = "Cliente Registrado" Then MsgBox "Cliente Registrado", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Segur@ de Registrar el Cliente " & UCase(TxtNombre) & " ?", vbQuestion + vbYesNo, "Registrar Cliente") = vbYes Then
    Registra
Else
    Exit Sub
End If
End Sub
Private Sub CommandButton2_Click()
    TxtNombre.Text = "": TxtDireccion.Text = "": TxtTelefono.Text = "": TxtContacto.Text = "": TxtNombre.SetFocus
End Sub
Private Sub CommandButton3_Click()
    Unload Me
End Sub
Private Sub TxtNombre_Change()
    If TxtNombre = "" Then
    LblConfirma.Caption = "": LblConfirma.BackColor = &H8000000F
    Else
    Verificar
    End If
End Sub
Sub Verificar()
Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(TxtNombre))
    Sql = "Select * From TablaClientes Where Compa|fffd|ia= '" & Replace(Dato, "'", "''") & "'"
    Rs.Open Sql, Cnn, 3, 3, adCmdText
    If Rs.RecordCount > 0 Then: LblConfirma.Caption = "Cliente Registrado": LblConfirma.BackColor = vbRed
    If Rs.RecordCount = 0 Then: LblConfirma.Caption = "Cliente Nuevo": LblConfirma.BackColor = vbGreen
    Rs.Close
    Set Rs = Nothing
End Sub
Sub Registra()
  Sql = "INSERT INTO TablaClientes(Compa|fffd|ia, Direccion, Telefono, Contacto) Values('" & Replace(UCase(TxtNombre), "'", "''") & "', '" & UCase(TxtDireccion) & "', '" & UCase(TxtTelefono) & "', '" & UCase(TxtContacto) & "')"
    Cnn.Execute (Sql)
    CommandButton2 = True
    MsgBox Mensaje, vbInformation, "Informaci|fffd|n de Registro"
End Sub

Attribute VB_Name = "FormCodigos"
Attribute VB_Base = "0{33786BB6-5484-410D-B2F2-7B04E0FF31D1}{63FB5C73-D019-4971-B9A2-BEF877E255EA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
If ListBox1.ListIndex = -1 Then
    Exit Sub
Else
    Nombre = ListBox1.List(ListBox1.ListIndex, 0)
    Unload Me
End If
End Sub
Private Sub TextBox1_Change()
If TextBox1.Text = "" Then
        ListBox1.Clear
        Exit Sub
    Else
        Codigos
    End If
End Sub
Private Sub UserForm_Initialize()
With ListBox1
    .ColumnCount = 3
    .ColumnWidths = "80;192"
        .Font.Size = 8
    .Font.Name = "Arial Narrow"
    .TextAlign = fmTextAlignCenter
End With
End Sub
Sub Codigos()
Set Rs = New ADODB.Recordset
Sql = "Select * From Productos Where Detalle Like '%" & UCase(Trim(TextBox1)) & "%'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
ListBox1.Clear
Do While Rs.EOF = False
ListBox1.AddItem Rs.Fields("Codigo")
ListBox1.List(ListBox1.ListCount - 1, 1) = Rs.Fields("Detalle")
ListBox1.List(ListBox1.ListCount - 1, 2) = Rs.Fields("UM")
Rs.MoveNext
Loop
Rs.Close
Set Rs = Nothing
End Sub
Attribute VB_Name = "FormEntrada"
Attribute VB_Base = "0{71302BD5-8EC8-45BA-B997-D6F0BFEEB8F5}{F28C9734-AAE7-4552-BB6A-C8101E444A52}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbCodigo_Change()
    TxtCantidad.Text = "": LblTotal.Caption = ""
    DetalleCodigo
End Sub
Sub Borra_Items()
    CmbCodigo.Text = "": TxtCantidad.Text = "": LblTotal.Caption = "": CmbCodigo.SetFocus
End Sub
Private Sub CmbCodigo_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
FormCodigos.Show
    If Nombre <> "" Then FormEntrada.CmbCodigo.Text = Nombre
End Sub
Private Sub CmbProveedor_Change()
    DetalleProveedor
End Sub
Private Sub CommandButton1_Click()
If CmbCodigo.Text = "" And LblDetalle.Caption = "" And LblUnidad.Caption = "" Then
    MsgBox "Debe Seleccionar un Item a Insertar", vbCritical, "Error"
    CmbCodigo.SetFocus
Exit Sub
ElseIf TxtCantidad = 0 Or TxtCantidad = "" Then
    MsgBox "Debe Colocar la Cantidad a Procesar", vbCritical, "Error"
    TxtCantidad.SetFocus
Exit Sub
End If
For I = 0 To ListBox1.ListCount - 1
    If CmbCodigo.Text = ListBox1.Column(0, I) Then
        MsgBox "El Producto " & UCase(CmbCodigo.Text) & " se encuentra en la lista", vbCritical, "Error": CmbCodigo.SetFocus: Exit Sub
    End If
Next I

If ListBox1.ListCount = 40 Then
    MsgBox "Ya Cuenta con 40 Items en la Lista" & vbNewLine & "Se Recomienda Registrar la Operaci|fffd|n", vbCritical, "Registrar"
    Exit Sub
End If

A = ListBox1.ListCount
    ListBox1.AddItem CmbCodigo.Text
    ListBox1.List(A, 1) = LblDetalle.Caption
    ListBox1.List(A, 2) = LblUnidad.Caption
    ListBox1.List(A, 3) = TxtValor
    ListBox1.List(A, 4) = TxtCantidad
    ListBox1.List(A, 5) = Format(LblTotal.Caption, "#,##0.000")
Calcula
Borra_Items
End Sub
Private Sub CommandButton2_Click()
If CmbProveedor.Text = "" Or LblDireccion.Caption = "" Or Lbltelefono.Caption = "" Then
    MsgBox "Favor Coloque el Proveedor", vbCritical, "Error": CmbProveedor.SetFocus: Exit Sub
ElseIf TxtPedido.Text = "" Then
    MsgBox "Favor Coloque la Orden o Pedido", vbCritical, "Error": TxtPedido.SetFocus: Exit Sub
ElseIf ListBox1.ListCount < 1 Then
    MsgBox " No Cuenta con Datos Para Procesar la Salida", vbCritical, "Error": Exit Sub
End If
If MsgBox("Est|fffd| Segur@ de Procesar la Entrada?", vbQuestion + vbYesNo, "Procesar Entrada") = vbYes Then
    ProcesarEntrada
    Registra
    Call Imprime_Entrada
    BorraTodo
    Maximo
    MsgBox Mensaje, vbInformation, "Entrada Procesada con Exito!"
Else
    Exit Sub
End If
End Sub
Private Sub CommandButton3_Click()
If CmbCodigo.Text = "" Then: MsgBox "Debe Seleccionar un Item a Modificar", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Seguro de Modificar el Item " & UCase(CmbCodigo.Text) & " ?", vbQuestion + vbYesNo, "Seguro?") = vbYes Then
    Modificar_item
    Calcula
    Borra_Items
    ListBox1.ListIndex = -1
Else
    Calcula
    Borra_Items
    ListBox1.ListIndex = -1
    Exit Sub
End If
End Sub
Private Sub CommandButton4_Click()
If ListBox1.ListCount = 0 Then: MsgBox "No Cuenta con Datos en la Lista", vbCritical, "Error": Exit Sub
If ListBox1.ListIndex = -1 Then: MsgBox "Seleccione un Item a Eliminar", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Segur@ de Eliminar el Item  " & ListBox1.List(ListBox1.ListIndex, 0) & " ?", vbQuestion + vbYesNo, "Eliminar") = vbYes Then
    Elimina_item
    Calcula
    Borra_Items
    ListBox1.ListIndex = -1
Else
    Borra_Items
    Calcula
    ListBox1.ListIndex = -1
    Exit Sub
End If
End Sub
Private Sub CommandButton5_Click()
    Borra_Items
End Sub
Private Sub CommandButton6_Click()
    BorraTodo
End Sub
Private Sub CommandButton7_Click()
    Unload Me
End Sub
Private Sub ListBox1_Click()
    CmbCodigo.Text = ListBox1.List(ListBox1.ListIndex, 0)
    TxtValor = ListBox1.List(ListBox1.ListIndex, 3)
    TxtCantidad.Text = ListBox1.List(ListBox1.ListIndex, 4)
End Sub
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Borra_Items
    ListBox1.ListIndex = -1
End Sub
Private Sub TxtCantidad_AfterUpdate()
    TxtCantidad = Format(TxtCantidad, "#,##0")
End Sub
Private Sub TxtCantidad_Change()
    If TxtCantidad = "," Then: TxtCantidad = "": Exit Sub
    If CmbCodigo.Text = "" Then: Exit Sub
    If CmbCodigo.Text = "" And TxtCantidad <> "" Then: LblTotal.Caption = "": Exit Sub
    If CmbCodigo.Text <> "" And TxtCantidad = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtCantidad <> "" And TxtValor = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtCantidad = "" And TxtValor <> "" Then: LblTotal.Caption = "": Exit Sub
    LblTotal.Caption = Format(TxtValor * TxtCantidad, "#,##0.000")
End Sub
Private Sub TxtCantidad_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)

If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtCantidad, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub TxtValor_AfterUpdate()
    TxtValor = Format(TxtValor, "#,##0.000")
End Sub
Private Sub TxtValor_Change()
    If TxtValor = "," Then: TxtValor = "": Exit Sub
    If CmbCodigo.Text = "" Then: Exit Sub
    If CmbCodigo.Text = "" And TxtValor <> "" Then: LblTotal.Caption = "": Exit Sub
    If CmbCodigo.Text <> "" And TxtValor = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtValor <> "" And TxtCantidad = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtValor = "" And TxtCantidad <> "" Then: LblTotal.Caption = "": Exit Sub
    LblTotal.Caption = Format(TxtValor * TxtCantidad, "#,##0.000")
End Sub
Private Sub TxtValor_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtValor, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub UserForm_Initialize()
   Codigos
   Proveedores
   Maximo
   lblfecha.Caption = Date
With ListBox1
    .ColumnCount = 6
    .Font.Name = "Arial Narrow"
    .Font.Size = 8
    .TextAlign = fmTextAlignCenter
    .ColumnWidths = "80 pt;190 pt;60 pt;60 pt;72 pt"
End With
End Sub
Sub Maximo()
Set Rs = New ADODB.Recordset
lblStock.Caption = ""
Rs.Open "Select Max(Control) As Maximo From Registros", Cnn
If Rs.Fields(0) > 0 Then
    lblControl.Caption = Format(Rs.Fields("Maximo") + 1, "00000000000")
Else
    lblControl.Caption = Format("1", "00000000000")
End If

Rs.Close
Set Rs = Nothing
End Sub
Sub Codigos()
  Set Rs = New ADODB.Recordset
    Rs.Open "Select * From Productos Order By Codigo", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbCodigo.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbCodigo.AddItem UCase(Rs.Fields("Codigo"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleCodigo()
Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbCodigo.Text))
    Sql = "Select * From Productos Where Codigo= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    LblDetalle.Caption = UCase(Rs.Fields("Detalle"))
    LblUnidad.Caption = UCase(Rs.Fields("UM"))
    TxtValor = Format(Rs.Fields("Costo"), "#,##0.000")
    lblStock.Caption = Format(Rs.Fields("Stock"), "#,##0")
Else
    LblDetalle.Caption = ""
    LblUnidad.Caption = ""
    TxtValor = ""
    lblStock.Caption = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Proveedores()
    Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaProveedores Order By Compa|fffd|ia", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbProveedor.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbProveedor.AddItem UCase(Rs.Fields("Compa|fffd|ia"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleProveedor()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbProveedor.Text))
    Sql = "Select * From TablaProveedores Where Compa|fffd|ia= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    LblDireccion.Caption = Rs.Fields("Direccion")
    Lbltelefono.Caption = Rs.Fields("Telefono")
Else
    LblDireccion.Caption = ""
    Lbltelefono.Caption = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Elimina_item()
ListBox1.RemoveItem ListBox1.ListIndex
End Sub
Sub Modificar_item()
    For I = 0 To ListBox1.ListCount - 1
        If UCase(Trim(CmbCodigo.Text)) = ListBox1.Column(0, I) Then
            ListBox1.Column(3, I) = TxtValor
            ListBox1.Column(4, I) = TxtCantidad
            ListBox1.Column(5, I) = LblTotal.Caption
        End If
    Next I
End Sub
Sub Calcula()
Can = 0
Suma = 0
    For I = 0 To ListBox1.ListCount - 1
         Can = Can + ListBox1.List(I, 4)
    Next I
    For I = 0 To ListBox1.ListCount - 1
        Suma = Suma + ListBox1.List(I, 5)
    Next I
lblCantidad.Caption = Format(Can, "#,##0")
lblImporte.Caption = Format(Suma, "#,##0.000")
End Sub
Sub ProcesarEntrada()
Rs.Open "Productos", Cnn, adOpenKeyset, adLockOptimistic, adCmdTable ' Nombre de la tabla entre comillas

Do While Rs.EOF = False
    For I = 0 To ListBox1.ListCount - 1
        If ListBox1.Column(0, I) = Rs.Fields("Codigo") Then
            Rs.Fields("Stock") = Format(Rs.Fields("Stock") + ListBox1.Column(4, I), "##,#0")
        Rs.Update
        End If
    Next I
Rs.MoveNext
Loop
Rs.Close
Set Rs = Nothing
End Sub
Sub Registra()

Set Rs = New ADODB.Recordset
Rs.Open "Registros", Cnn, adOpenKeyset, adLockOptimistic, adCmdTable ' Nombre de la tabla entre comillas
For I = 0 To ListBox1.ListCount - 1
    Costo = ListBox1.List(I, 3)
    Can = ListBox1.List(I, 4)
With Rs
    .AddNew
    .Fields("Control") = lblControl.Caption 'Numero de Control
    .Fields("Fecha") = CDate(Date) 'Fecha
    .Fields("Movimiento") = "ENTRADA" 'Movimiento
    .Fields("Proveedor") = UCase(CmbProveedor) 'Proveedor
    .Fields("Pedido") = UCase(TxtPedido.Text)
    .Fields("Codigo") = ListBox1.List(I, 0)
    .Fields("Precio") = Format(Costo, "#,##0.000")
    .Fields("Cantidad") = Format(Can, "#,##0")
    .Fields("Observaciones") = TxtObservacion.Text
    .Update
End With
Next I
Rs.Close
Set Rs = Nothing
End Sub
Sub BorraTodo()
    CmbProveedor.Text = "": TxtPedido.Text = "": CmbCodigo.Text = ""
    TxtCantidad.Text = "": LblTotal.Caption = "": ListBox1.Clear
    TxtObservacion.Text = "": lblCantidad.Caption = "": lblImporte.Caption = ""
    CmbProveedor.SetFocus
End Sub
Attribute VB_Name = "FormMenu"
Attribute VB_Base = "0{EF92B37A-FB40-46E3-8A1A-9907AC65F241}{4CDCF3A4-AA17-4FFB-993A-50D4D484873E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbSalir_Click()
    Cnn.Close
    Set Cnn = Nothing
    Unload Me
End Sub
Private Sub CommandButton14_Click()
    FormModProv.Show
End Sub
Private Sub CommandButton15_Click()
    FormClientes.Show
End Sub
Private Sub CommandButton16_Click()
    FormProveedores.Show
End Sub
Private Sub CommandButton17_Click()
    FormModClie.Show
End Sub
Private Sub CommandButton18_Click()
    FormSalida.Show
End Sub
Private Sub CommandButton19_Click()
    FormEntrada.Show
End Sub
Private Sub CommandButton20_Click()
      FormRegistros.Show
End Sub
Private Sub CommandButton21_Click()
    FormReporteMensual.Show
End Sub
Private Sub CommandButton22_Click()
      FormABC.Show
End Sub
Private Sub CommandButton23_Click()
    FormStock.Show
End Sub
Private Sub CommandButton3_Click()
    FormProductos.Show
End Sub
Private Sub CommandButton4_Click()
    FormModProd.Show
End Sub
Private Sub UserForm_Initialize()
        If Cnn.State = 1 Then Cnn.Close
        Call Conexion
    With Me
        .Height = Application.Height
        .Width = Application.Width
        .CmbSalir.Top = Me.Height - 90
        .LblVersion.Top = Me.Height - 70
        .LblVersion.Left = Me.Width - 130
    End With
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If CloseMode = vbFormControlMenu Then
        Cancel = True
        MsgBox "Click al Bot|fffd|n de Escape!", vbExclamation, "Atenci|fffd|n!!"
    End If
End Sub

Attribute VB_Name = "FormModClie"
Attribute VB_Base = "0{9C40FD17-88E7-4405-A85C-5244E3F7CD88}{A2500F3F-495E-425B-8670-2E26C0DFFD69}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbClientes_Change()
    DetalleClientes
End Sub
Private Sub CommandButton1_Click()
    If CmbClientes.Text = "" Then MsgBox "Debe Seleccionar un Cliente", vbCritical, "Error": CmbClientes.SetFocus: Exit Sub
    If TxtDireccion.Text = "" Then MsgBox "Debe Colocar la Direcci|fffd|n del Cliente", vbCritical: TxtDireccion.SetFocus: Exit Sub
    If TxtTelefono.Text = "" Then MsgBox "Debe colocar el Telefono del Cliente", vbCritical: TxtTelefono.SetFocus: Exit Sub
    If TxtContacto.Text = "" Then MsgBox "Favor Coloque el contacto del Cliente", vbCritical: TxtContacto.SetFocus: Exit Sub
    If MsgBox("Est|fffd| Segur@ de Modificar el Cliente " & CmbClientes.Text & " ?", vbQuestion + vbYesNo, "Modificar Cliente") = vbYes Then
        ModificaCliente
    Else
        Exit Sub
    End If
End Sub
Private Sub CommandButton2_Click()
    CmbClientes.Text = "": TxtDireccion.Text = "": TxtTelefono.Text = "": TxtContacto.Text = "": CmbClientes.SetFocus
End Sub
Private Sub CommandButton3_Click()
    Unload Me
End Sub
Private Sub UserForm_Initialize()
    Clientes
End Sub
Sub Clientes()
    Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaClientes Order By Compa|fffd|ia", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbClientes.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbClientes.AddItem UCase(Rs.Fields("Compa|fffd|ia"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleClientes()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbClientes.Text))
    Sql = "Select * From TablaClientes Where Compa|fffd|ia= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    TxtDireccion.Text = Rs.Fields("Direccion")
    TxtTelefono.Text = Rs.Fields("Telefono")
    TxtContacto.Text = Rs.Fields("Contacto")
Else
    TxtDireccion.Text = ""
    TxtTelefono.Text = ""
    TxtContacto.Text = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub ModificaCliente()
Set Rs = New ADODB.Recordset
Sql = "UPDATE TablaClientes SET Direccion= '" & UCase(TxtDireccion) & "',Telefono= '" & TxtTelefono _
& "'" & ",Contacto= '" & UCase(TxtContacto) & "'" & " WHERE Compa|fffd|ia= '" & Replace(CmbClientes, "'", "''") & "'"
Cnn.Execute (Sql)
CmbClientes.Text = "": CmbClientes.SetFocus
MsgBox Mensaje, vbInformation, "Modificar Clientes"
End Sub


Attribute VB_Name = "FormModProd"
Attribute VB_Base = "0{E9870CCF-9D66-490B-966E-C32E83268E2B}{862A2301-976F-4313-8E1E-53EB65DF097C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbCodigo_Change()
If CmbCodigo.Text = "" Then
    TxtDetalle.Text = "": CmbCategoria.Text = "": CmbUM.Text = "": TxtEmpaque.Text = "": TxtCosto.Text = "": TxtSeguridad.Text = ""
Else
    DetalleCodigo
End If
End Sub
Private Sub CommandButton1_Click()
If CmbCodigo.Text = "" Then MsgBox "Favor Seleccione un Producto", vbCritical, "Error": CmbCodigo.SetFocus: Exit Sub
If TxtDetalle.Text = "" Then MsgBox "Favor Coloque el Detalle del Producto", vbCritical, "Error": TxtDetalle.SetFocus: Exit Sub
If CmbCategoria.Text = "" Then MsgBox "Favor Colque la Categoria", vbCritical, "Error": CmbCategoria.SetFocus: Exit Sub
If CmbUM.Text = "" Then MsgBox "Favor Colque la Unidad de Medida", vbCritical, "Error": CmbUM.SetFocus: Exit Sub
If TxtEmpaque.Text = "" Then MsgBox "Favor coloque el Empaque del Producto", vbCritical, "Error": TxtEmpaque.SetFocus: Exit Sub
If TxtCosto.Text = "" Then MsgBox "Favor coloque el Costo del Producto", vbCritical, "Error": TxtCosto.SetFocus: Exit Sub
If TxtSeguridad.Text = "" Then MsgBox "Favor Coloque el Stock de Seguridad", vbCritical, "Error": TxtSeguridad.SetFocus: Exit Sub

If MsgBox("Est|fffd| Segur@ de Modificar el Producto " & UCase(CmbCodigo) & " ?", vbQuestion + vbYesNo, "Modificar") = vbYes Then
    Modificar_Producto
Else
    Exit Sub
End If
End Sub
Private Sub CommandButton2_Click()
    CmbCodigo.Text = "": TxtDetalle.Text = "": CmbCategoria.Text = "": CmbUM.Text = "": TxtEmpaque.Text = "": TxtSeguridad.Text = "": CmbCodigo.SetFocus
End Sub
Private Sub CommandButton3_Click()
    Unload Me
End Sub
Private Sub TxtCosto_AfterUpdate()
    TxtCosto = Format(TxtCosto, "#,##0.000")
End Sub
Private Sub TxtCosto_Change()
    If TxtCosto = "," Then: TxtCosto = "": Exit Sub
End Sub
Private Sub TxtCosto_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)

If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtCosto, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If

ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub UserForm_Initialize()
    Codigo
    Unidad
    Categoria
End Sub
Sub Codigo()
  Set Rs = New ADODB.Recordset
    Rs.Open "Select * From Productos Order By Codigo", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbCodigo.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbCodigo.AddItem UCase(Rs.Fields("Codigo"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleCodigo()
Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbCodigo.Text))
    Sql = "Select * From Productos Where Codigo= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    TxtDetalle = UCase(Rs.Fields("Detalle"))
    CmbCategoria = UCase(Rs.Fields("Categoria"))
    CmbUM = UCase(Rs.Fields("UM"))
    TxtEmpaque.Text = Format(Rs.Fields("Empaque"), "#,##0")
    TxtCosto = Format(Rs.Fields("Costo"), "#,##0.000")
    TxtSeguridad.Text = Format(Rs.Fields("StSeguridad"), "#,##0")
Else
    TxtDetalle.Text = ""
    CmbCategoria.Text = ""
    CmbUM.Text = ""
    TxtEmpaque.Text = ""
    TxtCosto.Text = ""
    TxtSeguridad.Text = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Categoria()
 Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaCategoria Order By Categoria", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    Do While Rs.BOF = False And Rs.EOF = False
    CmbCategoria.AddItem UCase(Rs.Fields("Categoria"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub Unidad()
 Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaUnidad Order By Unidad", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    Do While Rs.BOF = False And Rs.EOF = False
    CmbUM.AddItem UCase(Rs.Fields("Unidad"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Private Sub TxtEmpaque_AfterUpdate()
     TxtEmpaque = Format(TxtEmpaque, "#,##0")
End Sub
Private Sub TxtEmpaque_Change()
    If TxtEmpaque = "," Then: TxtEmpaque = "": Exit Sub
End Sub
Private Sub TxtEmpaque_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtEmpaque, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub TxtSeguridad_AfterUpdate()
    TxtSeguridad = Format(TxtSeguridad, "#,##0")
End Sub
Private Sub TxtSeguridad_Change()
    If TxtSeguridad = "," Then: TxtSeguridad = "": Exit Sub
End Sub
Private Sub TxtSeguridad_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtSeguridad, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Sub Modificar_Producto()
Set Rs = New ADODB.Recordset
Sql = "UPDATE Productos SET Detalle= '" & UCase(TxtDetalle) & "',Categoria= '" & UCase(CmbCategoria) & "'" & ",UM= '" & UCase(CmbUM) & "'" & ",Empaque= '" & UCase(TxtEmpaque) & "'" & ",Costo= '" & CCur(TxtCosto) & "'" & ",StSeguridad= '" & CDbl(TxtSeguridad) & "'" & " WHERE Codigo= '" & UCase(Trim(CmbCodigo)) & "'"
Cnn.Execute (Sql)
CommandButton2_Click
MsgBox Mensaje, vbInformation, "Modificar Producto"
End Sub



Attribute VB_Name = "FormModProv"
Attribute VB_Base = "0{D83FDC48-7FD9-4BC9-A7EA-AEB3EFE57756}{B7BD63A7-54B8-48AB-B965-34DFB851E767}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbProveedores_Change()
    DetalleProveedor
End Sub
Private Sub CommandButton1_Click()
    If CmbProveedores.Text = "" Then MsgBox "Debe Seleccionar un Proveedor", vbCritical, "Error": CmbProveedores.SetFocus: Exit Sub
    If TxtDireccion.Text = "" Then MsgBox "Debe Colocar la Direcci|fffd|n del Proveedor", vbCritical: TxtDireccion.SetFocus: Exit Sub
    If TxtTelefono.Text = "" Then MsgBox "Debe colocar el Telefono del Proveedor", vbCritical: TxtTelefono.SetFocus: Exit Sub
    If TxtContacto.Text = "" Then MsgBox "Favor Coloque el contacto del Proveedor", vbCritical: TxtContacto.SetFocus: Exit Sub
    If MsgBox("Est|fffd| Segur@ de Modificar el Proveedor " & CmbProveedores.Text & " ?", vbQuestion + vbYesNo, "Modificar Proveedor") = vbYes Then
        ModificaProveedor
    Else
        Exit Sub
    End If
End Sub
Private Sub CommandButton2_Click()
   CmbProveedores.Text = "": TxtDireccion.Text = "": TxtTelefono.Text = "": TxtContacto.Text = "": CmbProveedores.SetFocus
End Sub
Private Sub CommandButton3_Click()
    Unload Me
End Sub
Private Sub UserForm_Initialize()
    Proveedores
End Sub
Sub Proveedores()
    Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaProveedores Order By Compa|fffd|ia", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbProveedores.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbProveedores.AddItem UCase(Rs.Fields("Compa|fffd|ia"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleProveedor()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbProveedores.Text))
    Sql = "Select * From TablaProveedores Where Compa|fffd|ia= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    TxtDireccion.Text = Rs.Fields("Direccion")
    TxtTelefono.Text = Rs.Fields("Telefono")
    TxtContacto.Text = Rs.Fields("Contacto")
Else
    TxtDireccion.Text = ""
    TxtTelefono.Text = ""
    TxtContacto.Text = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub ModificaProveedor()
Set Rs = New ADODB.Recordset
Sql = "UPDATE TablaProveedores SET Direccion= '" & UCase(TxtDireccion) & "',Telefono= '" & TxtTelefono _
& "'" & ",Contacto= '" & UCase(TxtContacto) & "'" & " WHERE Compa|fffd|ia= '" & Replace(CmbProveedores, "'", "''") & "'"
Cnn.Execute (Sql)
CmbProveedores.Text = "": CmbProveedores.SetFocus
MsgBox Mensaje, vbInformation, "Modificar Proveedores"
End Sub




Attribute VB_Name = "FormProductos"
Attribute VB_Base = "0{8103FA8E-B733-40E0-946F-6B2650DD66E1}{CF80E7F1-246B-4002-8A35-538015A89ACB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If TxtCodigo.Text = "" Then: MsgBox "Favor Coloque el C|fffd|digo del Productos", vbCritical, "Error": TxtCodigo.SetFocus: Exit Sub
If TxtDetalle.Text = "" Then: MsgBox "Digite el Texto del Producto", vbCritical, "Error": TxtDetalle.SetFocus: Exit Sub
If CmbUM.Text = "" Then: MsgBox "Coloque la Unidad de Medida del Producto", vbCritical, "Error": CmbUM.SetFocus: Exit Sub
If TxtEmpaque.Text = "" Then: MsgBox "Favor Digite la Cantidad por Empaque", vbCritical, "Error": TxtEmpaque.SetFocus: Exit Sub
If TxtCosto.Text = "" Then: MsgBox "Colque el Precio del Producto", vbCritical, "Error": TxtCosto.SetFocus: Exit Sub
If TxtSeguridad.Text = "" Then MsgBox "Por Favor Coloque el Stock de Seguridad", vbCritical, "Error": TxtSeguridad.SetFocus: Exit Sub
If LblStatus.Caption = "C|fffd|digo Registrado" Then
    MsgBox "No Puede Procesar un Dato Repetido", vbCritical, "Error"
    Exit Sub
End If
If MsgBox("Est|fffd| Segur@ de Registrar el Producto " & TxtCodigo & " ? ", vbQuestion + vbYesNo, " Registrar Operaci|fffd|n ") = vbYes Then
    Guarda_Productos
    CommandButton2 = True
Else
    Exit Sub
End If
End Sub
Private Sub CommandButton2_Click()
    TxtCodigo = "": TxtDetalle.Text = "": CmbCategoria.Text = ""
    CmbUM.Text = "": TxtEmpaque.Text = "": TxtCosto.Text = "": TxtSeguridad.Text = ""
    TxtCodigo.SetFocus
End Sub
Private Sub CommandButton3_Click()
Unload Me
End Sub
Private Sub CommandButton4_Click()
    FormUnidad.Show
End Sub
Private Sub CommandButton5_Click()
    FormCategoria.Show
End Sub
Private Sub TxtCodigo_Change()
    If TxtCodigo.Text = "" Then
    LblStatus.Caption = "": LblStatus.BackColor = &H8000000F:  LblLenCaracter.Caption = ""
Else
    LblLenCaracter = Len(TxtCodigo)
    Verifica
End If
End Sub
Private Sub UserForm_Initialize()
    Call Unidad_Medida
    Call Categoria
End Sub
Sub Verifica()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(TxtCodigo))
    Sql = "Select * From Productos Where Codigo= '" & Dato & "'"
    Rs.Open Sql, Cnn, 3, 3, adCmdText
    If Rs.RecordCount > 0 Then: LblStatus.Caption = "C|fffd|digo Registrado": LblStatus.BackColor = vbRed
    If Rs.RecordCount = 0 Then: LblStatus.Caption = "C|fffd|digo Nuevo": LblStatus.BackColor = vbGreen
    Rs.Close
    Set Rs = Nothing
End Sub
Private Sub CmbCategoria_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub
Private Sub CmbUM_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub
Private Sub TxtEmpaque_AfterUpdate()
     TxtEmpaque = Format(TxtEmpaque, "#,##0")
End Sub
Private Sub TxtEmpaque_Change()
    If TxtEmpaque = "," Then: TxtEmpaque = "": Exit Sub
End Sub
Private Sub TxtEmpaque_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtEmpaque, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub TxtCosto_AfterUpdate()
    TxtCosto = Format(TxtCosto, "#,##0.000")
End Sub
Private Sub TxtCosto_Change()
    If TxtCosto = "," Then: TxtCosto = "": Exit Sub
End Sub
Private Sub TxtCosto_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)

If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtCosto, sCar) > 0) Then
KeyAscii = 0
    Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
    Exit Sub
End If
End Sub
Private Sub TxtSeguridad_AfterUpdate()
    TxtSeguridad = Format(TxtSeguridad, "#,##0")
End Sub
Private Sub TxtSeguridad_Change()
    If TxtSeguridad = "," Then: TxtSeguridad = "": Exit Sub
End Sub
Private Sub TxtSeguridad_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtSeguridad, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Sub Guarda_Productos()
    Sql = "INSERT INTO Productos(Codigo, Detalle, Categoria, UM, Empaque, Costo, Stock, StSeguridad) Values('" & UCase(TxtCodigo) & "', '" & UCase(TxtDetalle) & "', '" & UCase(CmbCategoria) & "', '" & UCase(CmbUM) & "', '" & TxtEmpaque & "', '" & TxtCosto & "', '" & 0 & "', '" & TxtSeguridad & "')"
    Cnn.Execute (Sql)
    CommandButton2 = True
    MsgBox Mensaje, vbInformation, "Informaci|fffd|n de Registro"
End Sub

Attribute VB_Name = "FormProveedores"
Attribute VB_Base = "0{1B7722BA-CC87-4110-AC50-9B5844FDE067}{FD281973-EBA9-4593-96EC-82FE32B9D10D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If TxtNombre.Text = "" Then: MsgBox "Flta Colocar el Nombre del Proveedor", vbCritical, "Error": TxtNombre.SetFocus: Exit Sub
If TxtDireccion.Text = "" Then: MsgBox "Falta Colocar la Direccion del Proveedor", vbCritical, "Error": TxtDireccion.SetFocus: Exit Sub
If TxtTelefono.Text = "" Then: MsgBox "Falta Colocar el Telefono del Proveedor", vbCritical, "Error": TxtTelefono.SetFocus: Exit Sub
If TxtContacto.Text = "" Then: MsgBox "Falta Colocar el Contacto del Proveedor", vbCritical, "Error": TxtContacto.SetFocus: Exit Sub
If LblConfirma.Caption = "Proveedor Registrado" Then MsgBox "Proveedor Registrado", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Segur@ de Registrar el Proveedor?", vbQuestion + vbYesNo, "Registrar Proveedor") = vbYes Then
    Registra
Else
    Exit Sub
End If
End Sub
Private Sub CommandButton2_Click()
    TxtNombre.Text = "": TxtDireccion.Text = "": TxtTelefono.Text = "": TxtContacto.Text = "": TxtNombre.SetFocus
End Sub
Private Sub CommandButton3_Click()
    Unload Me
End Sub
Private Sub TxtNombre_Change()
    If TxtNombre = "" Then
    LblConfirma.Caption = "": LblConfirma.BackColor = &H8000000F
    Else
    Verificar
    End If
End Sub
Sub Verificar()
Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(TxtNombre))
    Sql = "Select * From TablaProveedores Where Compa|fffd|ia= '" & Replace(Dato, "'", "''") & "'"
    Rs.Open Sql, Cnn, 3, 3, adCmdText
    If Rs.RecordCount > 0 Then: LblConfirma.Caption = "Proveedor Registrado": LblConfirma.BackColor = vbRed
    If Rs.RecordCount = 0 Then: LblConfirma.Caption = "Proveedor Nuevo": LblConfirma.BackColor = vbGreen
    Rs.Close
    Set Rs = Nothing
End Sub
Sub Registra()
  Sql = "INSERT INTO TablaProveedores(Compa|fffd|ia, Direccion, Telefono, Contacto) Values('" & Replace(UCase(TxtNombre), "'", "''") & "', '" & UCase(TxtDireccion) & "', '" & UCase(TxtTelefono) & "', '" & UCase(TxtContacto) & "')"
    Cnn.Execute (Sql)
    CommandButton2 = True
    MsgBox Mensaje, vbInformation, "Informaci|fffd|n de Registro"
End Sub

Attribute VB_Name = "FormRegistros"
Attribute VB_Base = "0{9FB9B874-BD84-4BCF-990F-8662AF44CCB3}{0E8940EC-C165-4242-8660-609655F35D40}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbControl_Change()
CmbControl = Format(CmbControl, "00000000000")
If CmbControl.Text = "" Then
LblCompa|fffd|ia.Caption = "": LblDireccion.Caption = "": Lbltelefono.Caption = "": LblPedido.Caption = ""
lblfecha.Caption = "": LblMovimiento.Caption = "": ListBox1.Clear: LblObservacion.Caption = ""
lblCantidad.Caption = "": lblImporte.Caption = ""
Exit Sub
End If
    Muestra
    Calcula
End Sub
Private Sub CmbControl_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If Not IsNumeric(Chr(KeyAscii)) Then
    KeyAscii = 0
End If
End Sub
Private Sub CommandButton1_Click()
    Unload Me
End Sub
Private Sub CommandButton2_Click()
    Call Imprime
End Sub
Private Sub UserForm_Initialize()
    Control
With ListBox1
    .ColumnCount = 6
    .Font.Name = "Arial Narrow"
    .Font.Size = 8
    .TextAlign = fmTextAlignCenter
    .ColumnWidths = "80 pt;190 pt;60 pt;60 pt;72 pt"
End With
End Sub
Sub Control()
Set Rs = New ADODB.Recordset
Rs.Open "Select Max(Control) As Maximo From Registros", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
If Rs.Fields(0) > 0 Then
For I = 1 To Rs.Fields("Maximo")
CmbControl.AddItem Format(I, "00000000000")
Next
    Else
CmbControl.Text = "1"
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Muestra()
Set Rs = New ADODB.Recordset
Dato = CmbControl

Sql = "Select Registros.*, (Registros.Precio * Registros.Cantidad) As Valor" & _
", Productos.Codigo As Cod, Productos.Detalle As Detal , Productos.UM As Un" & _
", TablaClientes.Compa|fffd|ia As Cliente_Compa|fffd|ia, TablaClientes.Direccion As Cliente_Dir, TablaClientes.Telefono As Cliente_Telf" & _
", TablaProveedores.Compa|fffd|ia As Proveedor_Compa|fffd|ia, TablaProveedores.Direccion As Provee_Dir, TablaProveedores.Telefono As Provee_Telf" & _
" From ((Registros" & _
" Left Join Productos" & _
" ON Registros.Codigo=Productos.Codigo)" & _
" Left Join TablaClientes" & _
" On Registros.Cliente=TablaClientes.Compa|fffd|ia)" & _
" Left Join TablaProveedores" & _
" On Registros.Proveedor=TablaProveedores.Compa|fffd|ia WHERE Control=" & Dato & ""

With Rs
.CursorLocation = adUseClient
.CursorType = adOpenKeyset
.LockType = adLockOptimistic
.Open Sql, Cnn, , , adCmdText
End With

LblCompa|fffd|ia.Caption = "": LblDireccion.Caption = "": Lbltelefono.Caption = "": LblPedido.Caption = ""
lblfecha.Caption = "": LblMovimiento.Caption = "": ListBox1.Clear: LblObservacion.Caption = ""
lblCantidad.Caption = "": lblImporte.Caption = ""

If Not IsNull(Rs.Fields("Proveedor_Compa|fffd|ia")) Then
Do While Rs.EOF = False
lblfecha.Caption = Rs.Fields("Fecha")
LblCompa|fffd|ia.Caption = UCase(Rs.Fields("Proveedor_Compa|fffd|ia"))
LblDireccion.Caption = UCase(Rs.Fields("Provee_Dir"))
Lbltelefono.Caption = Rs.Fields("Provee_Telf")
LblObservacion.Caption = UCase(Rs.Fields("Observaciones"))
LblPedido.Caption = UCase(Rs.Fields("Pedido"))
LblMovimiento.Caption = UCase(Rs.Fields("Movimiento"))
ListBox1.AddItem UCase(Rs.Fields("Cod"))
ListBox1.List(ListBox1.ListCount - 1, 1) = UCase(Rs.Fields("Detal"))
ListBox1.List(ListBox1.ListCount - 1, 2) = UCase(Rs.Fields("Un"))
ListBox1.List(ListBox1.ListCount - 1, 3) = Format(Rs.Fields("Precio"), "#,##0.000")
ListBox1.List(ListBox1.ListCount - 1, 4) = Format(Rs.Fields("Cantidad"), "#,##0")
ListBox1.List(ListBox1.ListCount - 1, 5) = Format(Rs.Fields("Valor"), "#,##0")
Rs.MoveNext
Loop

ElseIf Not IsNull(Rs.Fields("Cliente_Compa|fffd|ia")) Then
Do While Rs.EOF = False
lblfecha.Caption = Rs.Fields("Fecha")
LblCompa|fffd|ia.Caption = UCase(Rs.Fields("Cliente_Compa|fffd|ia"))
LblDireccion.Caption = UCase(Rs.Fields("Cliente_Dir"))
Lbltelefono.Caption = Rs.Fields("Cliente_Telf")
LblObservacion.Caption = UCase(Rs.Fields("Observaciones"))
LblPedido.Caption = UCase(Rs.Fields("Pedido"))
LblMovimiento.Caption = UCase(Rs.Fields("Movimiento"))
ListBox1.AddItem UCase(Rs.Fields("Cod"))
ListBox1.List(ListBox1.ListCount - 1, 1) = UCase(Rs.Fields("Detal"))
ListBox1.List(ListBox1.ListCount - 1, 2) = UCase(Rs.Fields("Un"))
ListBox1.List(ListBox1.ListCount - 1, 3) = Format(Rs.Fields("Precio"), "#,##0.000")
ListBox1.List(ListBox1.ListCount - 1, 4) = Format(Rs.Fields("Cantidad"), "#,##0")
ListBox1.List(ListBox1.ListCount - 1, 5) = Format(Rs.Fields("Valor"), "#,##0")
Rs.MoveNext
Loop
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Calcula()
Can = 0
Suma = 0
    For I = 0 To ListBox1.ListCount - 1
         Can = Can + ListBox1.List(I, 4)
    Next I
    For I = 0 To ListBox1.ListCount - 1
        Suma = Suma + ListBox1.List(I, 5)
    Next I
lblCantidad.Caption = Format(Can, "#,##0")
lblImporte.Caption = Format(Suma, "$ #,##0.000")
End Sub

Attribute VB_Name = "FormReporteMensual"
Attribute VB_Base = "0{C7B58801-15C7-4A12-AF87-6C1A4E61A73C}{DA302279-FEF2-446A-9296-5E44ACCE5910}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If Len(TextBox1) < 8 Then
   MsgBox "Fecha incompleta", vbCritical, "Error"
   TextBox1.SetFocus
   Exit Sub
ElseIf Mid(TextBox1, 1, 2) > 31 Then
   MsgBox "Los dias de la fecha inicio deben ser menor a 31 dias", vbCritical, "Error"
   TextBox1.SetFocus
   Exit Sub
ElseIf Mid(TextBox1, 4, 2) > 12 Then
   MsgBox "El mes de la fecha inicio debe ser menor o igual a 12 meses", vbCritical, "Error"
   TextBox1.SetFocus
   Exit Sub
ElseIf TextBox2.Text = "" Then
   MsgBox "Por favor coloque la fecha limite", vbExclamation, "Atencion"
   TextBox2.SetFocus
   Exit Sub
ElseIf Len(TextBox2) < 8 Then
   MsgBox "Fecha incompleta", vbCritical, "Error"
   TextBox2.SetFocus
Exit Sub
ElseIf Mid(TextBox2, 1, 2) > 31 Then
   MsgBox "Los dias de la fecha inicio deben ser menor a 31 dias", vbCritical, "Error"
   TextBox2.SetFocus
   Exit Sub
ElseIf Mid(TextBox2, 4, 2) > 12 Then
    MsgBox "El mes de la fecha final debe ser menor o igual a 12 meses", vbCritical, "Error"
    TextBox2.SetFocus
    Exit Sub
ElseIf CDate(TextBox2) < CDate(TextBox1) Then
    MsgBox "La Fecha Final debe Ser Mayor a la Fecha Inicial", vbCritical, "Error"
    Exit Sub
Else
    Consulta
End If
End Sub
Private Sub CommandButton3_Click()
    Unload Me
End Sub
Sub Consulta()
With Hoja3
.Visible = xlSheetVisible
.Select
.Cells.Clear
.Cells.Font.Name = "Arial Narrow"
.Cells.Font.Size = 8
.Columns(1).ColumnWidth = 8.71
.Cells(1, 1) = "Informe General de Movimientos"
.Cells(2, 1) = "Realizado el dia  " & Date & " a las " & Time
.Cells(4, 1) = "C|fffd|digos"
.Cells(4, 2) = "Descripci|fffd|n"
.Cells(4, 3) = "Entradas"
.Cells(4, 16) = "Salidas"
.Cells(4, 17) = "Stock Restante"
.Cells(4, 18) = "Mes(es) Inve."
.Columns("C:Q").NumberFormat = "#,##0"
.Columns("R:T").NumberFormat = "#,##0.000"
For I = 1 To 12
   Hoja3.Cells(4, 3 + I) = UCase(Left(MonthName(I), 1)) & _
   Mid(MonthName(I), 2, 2) 'UCase(Left(MonthName(I), 1)) & Mid(MonthName(I), 2, 2)
Next
End With

Inicio = Format(TextBox1, "mm/dd/yyyy") 'Access solo conoce el Formato Americano por tanto la fecha se coloca mes,dia,a|fffd|o
Final = Format(TextBox2, "mm/dd/yyyy") 'Access solo conoce el Formato Americano
Set Rs = New ADODB.Recordset
Sql = "Select Productos.Codigo,Productos.Detalle,"
Sql = Sql & "Sum(IIf(Movimiento='ENTRADA',Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=1,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=2,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=3,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=4,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=5,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=6,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=7,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=8,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=9,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=10,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=11,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA' and Month(Fecha)=12,Cantidad,0)),"
Sql = Sql & "Sum(IIf(Movimiento='SALIDA',Cantidad,0))"
Sql = Sql & "    From Productos INNER JOIN Registros ON Registros.Codigo=Productos.Codigo WHERE Fecha BETWEEN #" & Inicio & "# And #" & Final & "#" & ""
Sql = Sql & "    Group By Productos.Codigo,Productos.Detalle"
Rs.Open Sql, Cnn, adOpenKeyset, adLockOptimistic, adCmdText
Hoja3.Range("A5").CopyFromRecordset Rs
With Hoja3

Lin = 5
Do While .Cells(Lin, 1) <> ""
For I = 1 To 12
    If .Cells(Lin, 3 + I) > 0 Then
        .Cells(Lin, 17) = .Cells(Lin, 3) - .Cells(Lin, 16) 'Reste de Entradas-Salidas
    End If
Next I
Lin = Lin + 1
Loop

Lin = 5
Do While .Cells(Lin, 1) <> ""
For I = 1 To 12
    If .Cells(Lin, 3 + I) > 0 Then
        .Cells(Lin, 19) = .Cells(Lin, 19) + .Cells(Lin, 3 + I) / .Cells(Lin, 3 + I) 'Cuenta los meses con datos como un mes
        .Cells(Lin, 20) = .Cells(Lin, 16) / .Cells(Lin, 19) 'Promedia los meses de Salidas
    End If
Next I
    Lin = Lin + 1
Loop

Lin = 5
Do While .Cells(Lin, 1) <> ""
If .Cells(Lin, 20) > 0 Then
        .Cells(Lin, 18) = .Cells(Lin, 17) / .Cells(Lin, 20) 'Meses de Inventario
        .Range(.Cells(Lin, 19), .Cells(Lin, 20)) = "" 'Borra los Datos innecesarios
    End If
        Lin = Lin + 1
Loop
    .Range("A3") = "Del: " & CDate(TextBox1) & " al " & CDate(TextBox2)
    .Columns(1).ColumnWidth = 10.43
    .Columns("B:Z").AutoFit
End With
Rs.Close
Set Rs = Nothing
    CommandButton3_Click
    FormMenu.CmbSalir = True
End Sub
Private Sub TextBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    FormCalendario.Show
    If dFecha <> 0 Then
        TextBox1.Value = dFecha
        TextBox2.SetFocus
    End If
End Sub
Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub
Private Sub TextBox2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    FormCalendario.Show
    If dFecha <> 0 Then
        TextBox2.Value = dFecha
        CommandButton1.SetFocus
    End If
End Sub
Private Sub TextBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub
Attribute VB_Name = "FormSalida"
Attribute VB_Base = "0{E51A8D66-CEF3-42B7-83CF-A950EF243F96}{99E4BDF9-4EE2-4D2B-999F-784CD87C95DD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CmbCliente_Change()
    DetalleCliente
End Sub
Private Sub CmbCodigo_Change()
    TxtCantidad.Text = "": LblTotal.Caption = ""
    DetalleCodigo
End Sub
Sub Borra_Items()
    CmbCodigo.Text = "": TxtCantidad.Text = "": LblTotal.Caption = "": CmbCodigo.SetFocus
End Sub
Private Sub CmbCodigo_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
FormCodigos.Show
    If Nombre <> "" Then FormSalida.CmbCodigo.Text = Nombre
End Sub
Private Sub CommandButton1_Click()
If CmbCodigo.Text = "" And LblDetalle.Caption = "" And LblUnidad.Caption = "" Then
    MsgBox "Debe Seleccionar un Item a Insertar", vbCritical, "Error"
    CmbCodigo.SetFocus
    Exit Sub
ElseIf TxtCantidad = 0 Or TxtCantidad = "" Then
    MsgBox "Debe Colocar la Cantidad a Procesar", vbCritical, "Error"
    TxtCantidad.SetFocus
    Exit Sub
ElseIf lblStock.Caption = 0 Or lblStock.Caption = "" Then
    MsgBox "Sin Disponibilidad para la Salida del Material " & UCase(CmbCodigo.Text), vbCritical, "Error"
    CmbCodigo.SetFocus
Exit Sub
ElseIf CDbl(TxtCantidad) > CDbl(lblStock.Caption) Then
    MsgBox "La Cantidad es Mayor al Inventario del Material " & UCase(CmbCodigo.Text), vbCritical, "Error"
    TxtCantidad.SetFocus
Exit Sub
End If
For I = 0 To ListBox1.ListCount - 1
    If CmbCodigo.Text = ListBox1.Column(0, I) Then
        MsgBox "El Producto " & UCase(CmbCodigo.Text) & " se encuentra en la lista", vbCritical, "Error": CmbCodigo.SetFocus: Exit Sub
        CmbCodigo.SetFocus
    End If
Next I

If ListBox1.ListCount = 40 Then
    MsgBox "Ya Cuenta con 40 Items en la Lista" & vbNewLine & "Se Recomienda Registrar la Operaci|fffd|n", vbCritical, "Registrar"
    Exit Sub
End If

A = ListBox1.ListCount
    ListBox1.AddItem CmbCodigo.Text
    ListBox1.List(A, 1) = LblDetalle.Caption
    ListBox1.List(A, 2) = LblUnidad.Caption
    ListBox1.List(A, 3) = TxtValor
    ListBox1.List(A, 4) = TxtCantidad
    ListBox1.List(A, 5) = Format(LblTotal.Caption, "#,##0.000")
Calcula
Borra_Items
End Sub
Private Sub CommandButton2_Click()
If CmbCliente.Text = "" Or LblDireccion.Caption = "" Or Lbltelefono.Caption = "" Then
    MsgBox "Favor Coloque el Cliente", vbCritical, "Error": CmbCliente.SetFocus: Exit Sub
ElseIf TxtPedido.Text = "" Then
    MsgBox "Favor Coloque la Orden o Pedido", vbCritical, "Error": TxtPedido.SetFocus: Exit Sub
ElseIf ListBox1.ListCount < 1 Then
    MsgBox " No Cuenta con Datos Para Procesar la Salida", vbCritical, "Error": Exit Sub
End If
If MsgBox("Est|fffd| Segur@ de Procesar la Salida?", vbQuestion + vbYesNo, "Procesar Salida") = vbYes Then
    ProcesarSalida
    Registra
    Call Imprime_Salida
    BorraTodo
    Maximo
    MsgBox Mensaje, vbInformation, "Entrada Procesada con Exito!"
Else
    Exit Sub
End If
End Sub
Private Sub CommandButton3_Click()
If CmbCodigo.Text = "" Then: MsgBox "Debe Seleccionar un Item a Modificar", vbCritical, "Error": Exit Sub
If CDbl(TxtCantidad) > CDbl(lblStock.Caption) Then: MsgBox "La Cantidad es Mayor el Inventario", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Seguro de Modificar el Item " & UCase(CmbCodigo.Text) & " ?", vbQuestion + vbYesNo, "Seguro?") = vbYes Then
    Modificar_item
    Calcula
    Borra_Items
    ListBox1.ListIndex = -1
Else
    Calcula
    Borra_Items
    ListBox1.ListIndex = -1
    Exit Sub
End If
End Sub
Private Sub CommandButton4_Click()
If ListBox1.ListCount = 0 Then: MsgBox "No Cuenta con Datos en la Lista", vbCritical, "Error": Exit Sub
If ListBox1.ListIndex = -1 Then: MsgBox "Seleccione un Item a Eliminar", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Segur@ de Eliminar el Item  " & ListBox1.List(ListBox1.ListIndex, 0) & " ?", vbQuestion + vbYesNo, "Eliminar") = vbYes Then
    Elimina_item
    Calcula
    Borra_Items
    ListBox1.ListIndex = -1
Else
    Borra_Items
    Calcula
    ListBox1.ListIndex = -1
    Exit Sub
End If
End Sub
Private Sub CommandButton5_Click()
    Borra_Items
End Sub
Private Sub CommandButton6_Click()
    BorraTodo
End Sub
Private Sub CommandButton7_Click()
    Unload Me
End Sub
Private Sub ListBox1_Click()
    CmbCodigo.Text = ListBox1.List(ListBox1.ListIndex, 0)
    TxtValor = ListBox1.List(ListBox1.ListIndex, 3)
    TxtCantidad.Text = ListBox1.List(ListBox1.ListIndex, 4)
End Sub
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Borra_Items
    ListBox1.ListIndex = -1
End Sub
Private Sub TxtCantidad_AfterUpdate()
    TxtCantidad = Format(TxtCantidad, "#,##0")
End Sub
Private Sub TxtCantidad_Change()
    If TxtCantidad = "," Then: TxtCantidad = "": Exit Sub
    If CmbCodigo.Text = "" Then: Exit Sub
    If CmbCodigo.Text = "" And TxtCantidad <> "" Then: LblTotal.Caption = "": Exit Sub
    If CmbCodigo.Text <> "" And TxtCantidad = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtCantidad <> "" And TxtValor = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtCantidad = "" And TxtValor <> "" Then: LblTotal.Caption = "": Exit Sub
    LblTotal.Caption = Format(TxtValor * TxtCantidad, "#,##0.000")
End Sub
Private Sub TxtCantidad_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtCantidad, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub TxtValor_AfterUpdate()
    TxtValor = Format(TxtValor, "#,##0.000")
End Sub
Private Sub TxtValor_Change()
    If TxtValor = "," Then: TxtValor = "": Exit Sub
    If CmbCodigo.Text = "" Then: Exit Sub
    If CmbCodigo.Text = "" And TxtValor <> "" Then: LblTotal.Caption = "": Exit Sub
    If CmbCodigo.Text <> "" And TxtValor = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtValor <> "" And TxtCantidad = "" Then: LblTotal.Caption = "": Exit Sub
    If TxtValor = "" And TxtCantidad <> "" Then: LblTotal.Caption = "": Exit Sub
    LblTotal.Caption = Format(TxtValor * TxtCantidad, "#,##0.000")
End Sub
Private Sub TxtValor_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
sCar = Chr(KeyAscii)
If sCar = "," Then
KeyAscii = IIf(sDecimal = ",", 46, 44)
sCar = Chr(KeyAscii)
If (InStr(TxtValor, sCar) > 0) Then
KeyAscii = 0
Exit Sub
End If
ElseIf InStr("0123456789," & Chr(8), sCar) = 0 Then
KeyAscii = 0
Exit Sub
End If
End Sub
Private Sub UserForm_Initialize()
   Codigos
   Clientes
   Maximo
   lblfecha.Caption = Date
With ListBox1
    .ColumnCount = 6
    .Font.Name = "Arial Narrow"
    .Font.Size = 8
    .TextAlign = fmTextAlignCenter
    .ColumnWidths = "80 pt;190 pt;60 pt;60 pt;72 pt"
End With
End Sub
Sub Maximo()
Set Rs = New ADODB.Recordset
lblStock.Caption = ""
Rs.Open "Select Max(Control) As Maximo From Registros", Cnn
If Rs.Fields(0) > 0 Then
    lblControl.Caption = Format(Rs.Fields("Maximo") + 1, "00000000000")
Else
    lblControl.Caption = Format("1", "00000000000")
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Codigos()
  Set Rs = New ADODB.Recordset
    Rs.Open "Select * From Productos Order By Codigo", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbCodigo.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbCodigo.AddItem UCase(Rs.Fields("Codigo"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleCodigo()
Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbCodigo.Text))
    Sql = "Select * From Productos Where Codigo= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    LblDetalle.Caption = UCase(Rs.Fields("Detalle"))
    LblUnidad.Caption = UCase(Rs.Fields("UM"))
    TxtValor = Format(Rs.Fields("Costo"), "#,##0.000")
    lblStock.Caption = Format(Rs.Fields("Stock"), "#,##0")
Else
    LblDetalle.Caption = ""
    LblUnidad.Caption = ""
    TxtValor = ""
    lblStock.Caption = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Clientes()
    Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaClientes Order By Compa|fffd|ia", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    CmbCliente.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    CmbCliente.AddItem UCase(Rs.Fields("Compa|fffd|ia"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub DetalleCliente()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(CmbCliente.Text))
    Sql = "Select * From TablaClientes Where Compa|fffd|ia= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    LblDireccion.Caption = Rs.Fields("Direccion")
    Lbltelefono.Caption = Rs.Fields("Telefono")
Else
    LblDireccion.Caption = ""
    Lbltelefono.Caption = ""
End If
Rs.Close
Set Rs = Nothing

End Sub
Sub Elimina_item()
ListBox1.RemoveItem ListBox1.ListIndex
End Sub
Sub Modificar_item()
    For I = 0 To ListBox1.ListCount - 1
        If UCase(Trim(CmbCodigo.Text)) = ListBox1.Column(0, I) Then
            ListBox1.Column(3, I) = TxtValor
            ListBox1.Column(4, I) = TxtCantidad
            ListBox1.Column(5, I) = LblTotal.Caption
        End If
    Next I
End Sub
Sub Calcula()
Can = 0
Suma = 0
    For I = 0 To ListBox1.ListCount - 1
         Can = Can + ListBox1.List(I, 4)
    Next I
    For I = 0 To ListBox1.ListCount - 1
        Suma = Suma + ListBox1.List(I, 5)
    Next I
lblCantidad.Caption = Format(Can, "#,##0")
lblImporte.Caption = Format(Suma, "$ #,##0.000")
End Sub
Sub BorraTodo()
    CmbCliente.Text = "": TxtPedido.Text = "": CmbCodigo.Text = ""
    TxtCantidad.Text = "": LblTotal.Caption = "": ListBox1.Clear
    TxtObservacion.Text = "": lblCantidad.Caption = "": lblImporte.Caption = ""
    CmbCliente.SetFocus
End Sub
Sub ProcesarSalida()
Rs.Open "Productos", Cnn, adOpenKeyset, adLockOptimistic, adCmdTable ' Nombre de la tabla entre comillas

Do While Rs.EOF = False
    For I = 0 To ListBox1.ListCount - 1
        If ListBox1.Column(0, I) = Rs.Fields("Codigo") Then
            Rs.Fields("Stock") = Format(Rs.Fields("Stock") - ListBox1.Column(4, I), "##,#0")
        Rs.Update
        End If
    Next I
Rs.MoveNext
Loop
Rs.Close
Set Rs = Nothing
End Sub
Sub Registra()
Set Rs = New ADODB.Recordset
Rs.Open "Registros", Cnn, adOpenKeyset, adLockOptimistic, adCmdTable ' Nombre de la tabla entre comillas
For I = 0 To ListBox1.ListCount - 1
    Costo = ListBox1.List(I, 3)
    Can = ListBox1.List(I, 4)
With Rs
    .AddNew
    .Fields("Control") = lblControl.Caption 'Numero de Control
    .Fields("Fecha") = CDate(Date) 'Fecha
    .Fields("Movimiento") = "SALIDA" 'Movimiento
    .Fields("Cliente") = UCase(CmbCliente) 'Proveedor
    .Fields("Pedido") = UCase(TxtPedido.Text)
    .Fields("Codigo") = ListBox1.List(I, 0)
    .Fields("Precio") = Format(Costo, "#,##0.000")
    .Fields("Cantidad") = Format(Can, "#,##0")
    .Fields("Observaciones") = TxtObservacion.Text
    .Update
End With
Next I
Rs.Close
Set Rs = Nothing
End Sub


Attribute VB_Name = "FormStock"
Attribute VB_Base = "0{62ED0FD5-EEDC-44CD-9490-79D8A763F092}{7179035B-63B9-4C1D-A984-8A52582BD4C1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If ListBox1.ListIndex = -1 Then: Exit Sub
If ListBox1.List(ListBox1.ListIndex, 0) = "< TODOS >" Then
        StockGeneral
Else
        Codigo_Unico
End If
End Sub
Private Sub CommandButton2_Click()
    Unload Me
End Sub
Private Sub ListBox1_Click()
If ListBox1.ListIndex = -1 Then
   Borrar
ElseIf ListBox1.List(ListBox1.ListIndex, 0) = "< TODOS >" Then
   Borrar
Else
    MuestraDetalle
End If
End Sub
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
   Borrar
End Sub
Private Sub UserForm_Initialize()
    Codigos
End Sub
Sub Codigos()
Set Rs = New ADODB.Recordset
Sql = "SELECT * FROM Productos ORDER BY Codigo"

Rs.Open Sql, Cnn, adOpenKeyset, adLockOptimistic, adCmdText

ListBox1.AddItem "< TODOS >"
Do While Rs.EOF = False
    ListBox1.AddItem Rs.Fields("Codigo")
    Rs.MoveNext
Loop
Rs.Close
Set Rs = Nothing
End Sub
Sub MuestraDetalle()
Set Rs = New ADODB.Recordset
Dato = ListBox1.List(ListBox1.ListIndex, 0)
    Sql = "Select * From Productos Where Codigo= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
    LblDetalle.Caption = UCase(Rs.Fields("Detalle"))
    lblCategoria.Caption = UCase(Rs.Fields("Categoria"))
    LblUnidad.Caption = UCase(Rs.Fields("UM"))
    lblEmpaque.Caption = Format(Rs.Fields("Empaque"), "#,##0")
    lblValor.Caption = Format(Rs.Fields("Costo"), "#,##0.000")
Else
    LblDetalle.Caption = ""
    lblCategoria.Caption = ""
    LblUnidad.Caption = ""
    lblEmpaque.Caption = ""
    lblValor.Caption = ""
End If
Rs.Close
Set Rs = Nothing
End Sub
Sub Borrar()
    LblDetalle.Caption = ""
    lblCategoria.Caption = ""
    LblUnidad.Caption = ""
    lblEmpaque.Caption = ""
    lblValor.Caption = ""
End Sub
Sub StockGeneral()
With Hoja3
    .Activate
    .Visible = xlSheetVisible
    .Select
    .Cells.Clear
    .Cells.Font.Name = "Arial Narrow"
    .Cells.Font.Size = 8
    .Cells(1, 1) = "Reporte de Inventario Actual"
    .Cells(2, 1) = "Realizado el dia  " & Date & " a las  " & Time
    .Cells(3, 1) = "Codigo"
    .Cells(3, 2) = "Detalle"
    .Cells(3, 3) = "Categoria"
    .Cells(3, 4) = "U.M.V."
    .Cells(3, 5) = "Cant. Emp."
    .Cells(3, 6) = "Precio"
    .Cells(3, 7) = "Stock Actual"
    .Cells(3, 8) = "Stock Min."
    .Cells(3, 9) = "Importe Por Items"
    .Cells(3, 10) = "Status"
    .Range(.Cells(3, 1), .Cells(3, 10)).Borders(xlEdgeBottom).LineStyle = xlDot
    .Columns(6).NumberFormat = "[$Bs-200A] #,##0.000"
    .Columns(9).NumberFormat = "[$Bs-200A] #,##0.000"
    .Columns(7).NumberFormat = "#,##0"
    .Columns(8).NumberFormat = "#,##0"
End With
Set Rs = New ADODB.Recordset
Sql = "SELECT * FROM Productos Order By Codigo"
With Rs
.CursorLocation = adUseClient
.CursorType = adOpenKeyset
.LockType = adLockOptimistic
.Open Sql, Cnn, , , adCmdText
End With
If Rs.RecordCount > 0 Then
Hoja3.Cells(4, 1).CopyFromRecordset Rs
End If
Lin = 4
Do While Hoja3.Cells(Lin, 1) <> ""
    Hoja3.Cells(Lin, 9) = Hoja3.Cells(Lin, 7) * Hoja3.Cells(Lin, 8)
    If Hoja3.Cells(Lin, 7) < Hoja3.Cells(Lin, 8) Then
        Hoja3.Cells(Lin, 10) = "Stock Critico"
        Hoja3.Cells(Lin, 10).Font.Color = vbRed
    Else
        Hoja3.Cells(Lin, 10) = "Stock Optimo"
    End If
Lin = Lin + 1
Loop
Hoja3.Columns("B:Z").AutoFit
Rs.Close
Set Rs = Nothing
CommandButton2_Click
FormMenu.CmbSalir = True
End Sub
Sub Codigo_Unico()
With Hoja3
.Activate
.Visible = xlSheetVisible
.Select
.Cells.Clear
.Cells.Font.Name = "Arial Narrow"
.Cells.Font.Size = 8
.Cells(1, 1) = "Reporte de Inventario Actual"
.Cells(2, 1) = "Realizado el dia  " & Date & " a las  " & Time
.Cells(3, 1) = "Codigo"
.Cells(3, 2) = "Detalle"
.Cells(3, 3) = "Categoria"
.Cells(3, 4) = "U.M.V."
.Cells(3, 5) = "Cant. Emp."
.Cells(3, 6) = "Precio"
.Cells(3, 7) = "Stock Actual"
.Cells(3, 8) = "Stock Min."
.Cells(3, 9) = "Importe Por Items"
.Cells(3, 10) = "Status"
.Range(.Cells(3, 1), .Cells(3, 10)).Borders(xlEdgeBottom).LineStyle = xlDot
.Columns(6).NumberFormat = "[$Bs-200A] #,##0.000"
.Columns(9).NumberFormat = "[$Bs-200A] #,##0.000"
.Columns(7).NumberFormat = "#,##0"
.Columns(8).NumberFormat = "#,##0"
End With
Set Rs = New ADODB.Recordset
Dato = ListBox1.List(ListBox1.ListIndex, 0)
Sql = "Select * From Productos Where Codigo= '" & Replace(Dato, "'", "''") & "'"
With Rs
    .CursorLocation = adUseClient
    .CursorType = adOpenKeyset
    .LockType = adLockOptimistic
    .Open Sql, Cnn, , , adCmdText
End With
With Hoja3
If Rs.RecordCount > 0 Then
.Cells(4, 1).CopyFromRecordset Rs
Lin = 4
Do While .Cells(Lin, 1) <> ""
    .Cells(Lin, 9) = .Cells(Lin, 7) * .Cells(Lin, 8)
    If .Cells(Lin, 7) < .Cells(Lin, 8) Then
        .Cells(Lin, 10) = "Stock Critico"
        .Cells(Lin, 10).Font.Color = vbRed
    Else
        .Cells(Lin, 10) = "Stock Optimo"
    End If
Lin = Lin + 1
Loop
End If
    .Columns("B:Z").AutoFit
End With
Rs.Close
Set Rs = Nothing
CommandButton2_Click
FormMenu.CmbSalir = True
End Sub
Attribute VB_Name = "FormUnidad"
Attribute VB_Base = "0{6AC8C9DB-B14A-4BAB-AD9A-CC8A4C432E0E}{8DAFAB68-DD37-41C0-800E-BFE572BDE8A3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
If TxtUnidad.Text = "" Then: MsgBox "Debe Digitar la Unidad del Producto", vbCritical, "Error": Beep: Exit Sub
If LblStatus.Caption = "Unidad Registrada" Then: MsgBox "No se Registra Datos Repetidos", vbCritical, "Error": Exit Sub
If MsgBox("Est|fffd| Segur@ de Registrar la Unidad de Medida?", vbQuestion + vbYesNo, "Registrar Unidad de Medida") = vbYes Then
    Guarda_Tipo
    Call Unidad_Medida
    TxtUnidad.Text = "": LblStatus.Caption = "": LblStatus.BackColor = &H8000000F: TxtUnidad.SetFocus
Else
Exit Sub
End If
End Sub
Private Sub CommandButton2_Click()
    Unload Me
End Sub
Private Sub TextBox1_Change()
    Verificar
End Sub
Sub Verificar()
    Set Rs = New ADODB.Recordset
    Dato = UCase(Trim(TxtUnidad))
    Sql = "Select * From TablaUnidad Where Unidad= '" & Dato & "'"
    Rs.Open Sql, Cnn, 3, 3, adCmdText
    If Rs.RecordCount > 0 Then: LblStatus.Caption = "Unidad Registrada": LblStatus.BackColor = vbRed
    If Rs.RecordCount = 0 Then: LblStatus.Caption = "Unidad Nueva": LblStatus.BackColor = vbGreen
    Rs.Close
    Set Rs = Nothing
End Sub
Private Sub TxtTipo_Change()
    If TxtUnidad.Text = "" Then: LblStatus.Caption = "": LblStatus.BackColor = &H8000000F: Exit Sub
    TxtUnidad = UCase(TxtUnidad)
    Verificar
End Sub
Private Sub TxtUnidad_Change()
    If TxtUnidad.Text = "" Then
    LblStatus.Caption = ""
    LblStatus.BackColor = &H8000000F
    Else
    Verificar
    End If
End Sub
Sub Guarda_Tipo()
    Sql = "INSERT INTO TablaUnidad(Unidad) Values('" & UCase(TxtUnidad) & "')"
    Cnn.Execute (Sql)
    MsgBox Mensaje, vbInformation, "Informaci|fffd|n de Registro"
End Sub
Attribute VB_Name = "Hoja1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Option Explicit
Private Sub CommandButton1_Click()
    FormMenu.Show
End Sub
Attribute VB_Name = "Hoja2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Option Explicit
Private Sub CommandButton1_Click()
Application.ScreenUpdating = False
    With Hoja3
        .Cells.Clear
        .Cells.ColumnWidth = 10.71
        .Visible = xlSheetHidden
    End With
        Hoja1.Select
        FormMenu.Show
Application.ScreenUpdating = False
End Sub
Attribute VB_Name = "M|fffd|dulo1"
Option Explicit
'*********Por David Garcia**********
Public Cnn As New ADODB.Connection
Public Rs As New ADODB.Recordset
Public dFecha As Date
Public Inicio As Date
Public Final As Date
Public Lin As Long
Public Sql As String
Public Dato As String
Public Nombre As String
Public Uf As String
Public Acumulado As Double
Public Acumula As Double
Public Cuenta As Double
Public Suma1 As Double
Public Suma2 As Double
Public A As Long
Public B As Long
Public C As Long
Public SumaA As Double
Public SumaB As Double
Public SumaC As Double
Public SumaAA As Double
Public SumaBB As Double
Public SumaCC As Double
Public X As Integer
Public I As Integer
Public Suma As Double
Public Costo As Double
Public Can As Double
Public Texto As String
Public Palabra() As String
Public sCar As String * 1
Public sDecimal As String
Public Const Mensaje As String = "Operaci|fffd|n Ejecutada con Exito!"
Sub Conexion()
Set Cnn = New ADODB.Connection
With Cnn
.Provider = "Microsoft.ACE.OLEDB.12.0"
.ConnectionString = "Data Source=" & ThisWorkbook.Path & "\Base Productos.accdb"
.Open
End With
End Sub
Sub Unidad_Medida()
    Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaUnidad Order By Unidad", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    FormProductos.CmbUM.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    FormProductos.CmbUM.AddItem UCase(Rs.Fields("Unidad"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub Categoria()
    Set Rs = New ADODB.Recordset
    Rs.Open "Select * From TablaCategoria Order By Categoria", Cnn, adOpenKeyset, adLockOptimistic, adCmdText
    FormProductos.CmbCategoria.Clear
    Do While Rs.BOF = False And Rs.EOF = False
    FormProductos.CmbCategoria.AddItem UCase(Rs.Fields("Categoria"))
    Rs.MoveNext
    Loop
    Rs.Close
    Set Rs = Nothing
End Sub
Sub Imprime()
If MsgBox("Desea Imprimir el Documento N|fffd| " & FormRegistros.CmbControl, vbQuestion + vbYesNo, "Reimprimir Documento") = vbYes Then

With Hoja2
    .Activate
    .Visible = xlSheetVisible
    .Select
    .Cells.Clear
    .Cells.Font.Name = "Arial Narrow"
    .Cells.Font.Size = 8
    .Cells(3, 1) = "Proveedor"
    .Cells(4, 1) = "Tel|fffd|fono"
    .Cells(5, 1) = "Direcci|fffd|n"
    .Cells(6, 1) = "Orden/Pedido"
    .Cells(3, 5) = "Fecha"
    .Cells(4, 5) = "N|fffd| Control"
    .Cells(5, 5) = "Movimiento"
    .Cells(3, 2) = FormRegistros.LblCompa|fffd|ia
    .Cells(4, 2) = FormRegistros.LblDireccion
    .Cells(5, 2) = FormRegistros.Lbltelefono
    .Cells(6, 2) = FormRegistros.LblPedido.Caption
    .Cells(3, 6) = Format(FormRegistros.lblfecha.Caption, "DD/MM/YY")
    .Cells(3, 6).NumberFormat = "DD/MM/YY"
    .Cells(4, 6) = Format(FormRegistros.CmbControl, "00000000000")
    .Cells(4, 6).NumberFormat = "00000000000"
    .Cells(5, 6) = FormRegistros.LblMovimiento
    .Cells(9, 1) = "C|fffd|digo"
    .Cells(9, 2) = "Detalle"
    .Cells(9, 3) = "U.M.V"
    .Cells(9, 4) = "Valor Unitario"
    .Cells(9, 5) = "Cantidad Procesada"
    .Cells(9, 6) = "Valor Total"
    .Columns("A:F").HorizontalAlignment = xlCenter
    .Range("A9", "F9").Borders.LineStyle = xlDot
    .Range("B6", "D6").Merge
    .Range("B3", "D3").Merge
    .Range("B4", "D4").Merge
    .Range("B5", "D5").Merge
    .Range("A56:F57").Merge
    .Columns("A").ColumnWidth = 10.71
    .Columns("B").ColumnWidth = 33.43
    .Columns("C").ColumnWidth = 4.14
    .Columns("D").ColumnWidth = 8.14
    .Columns("E").ColumnWidth = 12.14
    .Columns("F").ColumnWidth = 14
End With
Uf = Hoja2.Range("A" & Rows.Count).End(xlUp).Row + 1
For I = 0 To FormRegistros.ListBox1.ListCount - 1
    Suma = Format(FormRegistros.ListBox1.List(I, 5), "#,##0.000")
    Can = Format(FormRegistros.ListBox1.List(I, 4), "#,##0")
    Costo = Format(FormRegistros.ListBox1.List(I, 3), "#,##0.000")
    Hoja2.Cells(Uf + I, 1) = FormRegistros.ListBox1.List(I, 0)
    Hoja2.Cells(Uf + I, 2) = FormRegistros.ListBox1.List(I, 1)
    Hoja2.Cells(Uf + I, 3) = FormRegistros.ListBox1.List(I, 2)
    Hoja2.Cells(Uf + I, 4) = Costo
    Hoja2.Cells(Uf + I, 5) = Can
    Hoja2.Cells(Uf + I, 6) = Suma
Next
Suma1 = 0
Suma2 = 0

Lin = 10
Do While Hoja2.Cells(Lin, 1) <> ""
    Hoja2.Cells(Lin, 4).NumberFormat = "#,##0.000"
    Hoja2.Cells(Lin, 5).NumberFormat = "#,##0"
    Hoja2.Cells(Lin, 6).NumberFormat = "#,##0.000"
    Suma1 = Suma1 + Hoja2.Cells(Lin, 5)
    Suma2 = Suma2 + Hoja2.Cells(Lin, 6)
Lin = Lin + 1
Loop
With Hoja2
    .Cells(53, 5) = "Total Cantidades"
    .Cells(54, 5) = "Valor General"
    .Cells(55, 1) = "Observaciones"
    .Cells(56, 1) = UCase(FormRegistros.LblObservacion)
    .Cells(53, 6) = Suma1
    .Cells(54, 6) = Suma2
    .Cells(53, 6).NumberFormat = "#,##0"
    .Cells(54, 6).NumberFormat = "#,##0.000"
    .PrintOut
    .Cells.Clear
    .Cells.ColumnWidth = 10.71
    .Visible = xlSheetHidden
End With
Else
    Exit Sub
End If
End Sub
Sub Imprime_Salida()
If MsgBox("Desea Imprimir el Documento de Salida N|fffd| " & FormSalida.lblControl, vbQuestion + vbYesNo, "Imprimir Documento") = vbYes Then

With Hoja2
    .Activate
    .Visible = xlSheetVisible
    .Select
    .Cells.Clear
    .Cells.Font.Name = "Arial Narrow"
    .Cells.Font.Size = 8
    .Cells(3, 1) = "Cliente"
    .Cells(4, 1) = "Tel|fffd|fono"
    .Cells(5, 1) = "Direcci|fffd|n"
    .Cells(6, 1) = "Orden/Pedido"
    .Cells(3, 5) = "Fecha"
    .Cells(4, 5) = "N|fffd| Control"
    .Cells(5, 5) = "Movimiento"
    .Cells(3, 2) = FormSalida.CmbCliente
    .Cells(4, 2) = FormSalida.LblDireccion
    .Cells(5, 2) = FormSalida.Lbltelefono
    .Cells(6, 2) = UCase(FormSalida.TxtPedido.Text)
    .Cells(3, 6) = Format(FormSalida.lblfecha.Caption, "DD/MM/YY")
    .Cells(3, 6).NumberFormat = "DD/MM/YY"
    .Cells(4, 6) = Format(FormSalida.lblControl, "00000000000")
    .Cells(4, 6).NumberFormat = "00000000000"
    .Cells(5, 6) = "SALIDA"
    .Cells(9, 1) = "C|fffd|digo"
    .Cells(9, 2) = "Detalle"
    .Cells(9, 3) = "U.M.V"
    .Cells(9, 4) = "Valor Unitario"
    .Cells(9, 5) = "Cantidad Procesada"
    .Cells(9, 6) = "Valor Total"
    .Columns("A:F").HorizontalAlignment = xlCenter
    .Range("A9", "F9").Borders.LineStyle = xlDot
    .Range("B6", "D6").Merge
    .Range("B3", "D3").Merge
    .Range("B4", "D4").Merge
    .Range("B5", "D5").Merge
    .Range("A56:F57").Merge
    .Columns("A").ColumnWidth = 10.71
    .Columns("B").ColumnWidth = 33.43
    .Columns("C").ColumnWidth = 4.14
    .Columns("D").ColumnWidth = 8.14
    .Columns("E").ColumnWidth = 12.14
    .Columns("F").ColumnWidth = 14
End With
Uf = Hoja2.Range("A" & Rows.Count).End(xlUp).Row + 1
For I = 0 To FormSalida.ListBox1.ListCount - 1
    Suma = Format(FormSalida.ListBox1.List(I, 5), "#,##0.000")
    Can = Format(FormSalida.ListBox1.List(I, 4), "#,##0")
    Costo = Format(FormSalida.ListBox1.List(I, 3), "#,##0.000")
    Hoja2.Cells(Uf + I, 1) = FormSalida.ListBox1.List(I, 0)
    Hoja2.Cells(Uf + I, 2) = FormSalida.ListBox1.List(I, 1)
    Hoja2.Cells(Uf + I, 3) = FormSalida.ListBox1.List(I, 2)
    Hoja2.Cells(Uf + I, 4) = Costo
    Hoja2.Cells(Uf + I, 5) = Can
    Hoja2.Cells(Uf + I, 6) = Suma
Next
Suma1 = 0
Suma2 = 0

Lin = 10
Do While Hoja2.Cells(Lin, 1) <> ""
    Hoja2.Cells(Lin, 4).NumberFormat = "#,##0.000"
    Hoja2.Cells(Lin, 5).NumberFormat = "#,##0"
    Hoja2.Cells(Lin, 6).NumberFormat = "#,##0.000"
    Suma1 = Suma1 + Hoja2.Cells(Lin, 5)
    Suma2 = Suma2 + Hoja2.Cells(Lin, 6)
Lin = Lin + 1
Loop
With Hoja2
    .Cells(53, 5) = "Total Cantidades"
    .Cells(54, 5) = "Valor General"
    .Cells(55, 1) = "Observaciones"
    .Cells(56, 1) = UCase(FormSalida.TxtObservacion)
    .Cells(53, 6) = Suma1
    .Cells(54, 6) = Suma2
    .Cells(53, 6).NumberFormat = "#,##0"
    .Cells(54, 6).NumberFormat = "#,##0.000"
    .PrintOut
    .Cells.Clear
    .Cells.ColumnWidth = 10.71
    .Visible = xlSheetHidden
End With
Else
    Exit Sub
End If
End Sub
Sub Imprime_Entrada()
If MsgBox("Desea Imprimir el Documento de Entrada N|fffd| " & FormEntrada.lblControl.Caption, vbQuestion + vbYesNo, "Imprimir") = vbYes Then

With Hoja2
    .Activate
    .Visible = xlSheetVisible
    .Select
    .Cells.Clear
    .Cells.Font.Name = "Arial Narrow"
    .Cells.Font.Size = 8
    .Cells(3, 1) = "Proveedor"
    .Cells(4, 1) = "Tel|fffd|fono"
    .Cells(5, 1) = "Direcci|fffd|n"
    .Cells(6, 1) = "Orden/Pedido"
    .Cells(3, 5) = "Fecha"
    .Cells(4, 5) = "N|fffd| Control"
    .Cells(5, 5) = "Movimiento"
    .Cells(3, 2) = FormEntrada.CmbProveedor
    .Cells(4, 2) = FormEntrada.LblDireccion
    .Cells(5, 2) = FormEntrada.Lbltelefono
    .Cells(6, 2) = UCase(FormEntrada.TxtPedido.Text)
    .Cells(3, 6) = Format(FormEntrada.lblfecha.Caption, "DD/MM/YY")
    .Cells(3, 6).NumberFormat = "DD/MM/YY"
    .Cells(4, 6) = Format(FormEntrada.lblControl, "00000000000")
    .Cells(4, 6).NumberFormat = "00000000000"
    .Cells(5, 6) = "ENTRADA"
    .Cells(9, 1) = "C|fffd|digo"
    .Cells(9, 2) = "Detalle"
    .Cells(9, 3) = "U.M.V"
    .Cells(9, 4) = "Valor Unitario"
    .Cells(9, 5) = "Cantidad Procesada"
    .Cells(9, 6) = "Valor Total"
    .Columns("A:F").HorizontalAlignment = xlCenter
    .Range("A9", "F9").Borders.LineStyle = xlDot
    .Range("B6", "D6").Merge
    .Range("B3", "D3").Merge
    .Range("B4", "D4").Merge
    .Range("B5", "D5").Merge
    .Range("A56:F57").Merge
    .Columns("A").ColumnWidth = 10.71
    .Columns("B").ColumnWidth = 33.43
    .Columns("C").ColumnWidth = 4.14
    .Columns("D").ColumnWidth = 8.14
    .Columns("E").ColumnWidth = 12.14
    .Columns("F").ColumnWidth = 14
End With
Uf = Hoja2.Range("A" & Rows.Count).End(xlUp).Row + 1
For I = 0 To FormEntrada.ListBox1.ListCount - 1
    Suma = Format(FormEntrada.ListBox1.List(I, 5), "#,##0.000")
    Can = Format(FormEntrada.ListBox1.List(I, 4), "#,##0")
    Costo = Format(FormEntrada.ListBox1.List(I, 3), "#,##0.000")
    Hoja2.Cells(Uf + I, 1) = FormEntrada.ListBox1.List(I, 0)
    Hoja2.Cells(Uf + I, 2) = FormEntrada.ListBox1.List(I, 1)
    Hoja2.Cells(Uf + I, 3) = FormEntrada.ListBox1.List(I, 2)
    Hoja2.Cells(Uf + I, 4) = Costo
    Hoja2.Cells(Uf + I, 5) = Can
    Hoja2.Cells(Uf + I, 6) = Suma
Next
Suma1 = 0
Suma2 = 0

Lin = 10
Do While Hoja2.Cells(Lin, 1) <> ""
    Hoja2.Cells(Lin, 4).NumberFormat = "#,##0.000"
    Hoja2.Cells(Lin, 5).NumberFormat = "#,##0"
    Hoja2.Cells(Lin, 6).NumberFormat = "#,##0.000"
    Suma1 = Suma1 + Hoja2.Cells(Lin, 5)
    Suma2 = Suma2 + Hoja2.Cells(Lin, 6)
Lin = Lin + 1
Loop
With Hoja2
    .Cells(53, 5) = "Total Cantidades"
    .Cells(54, 5) = "Valor General"
    .Cells(55, 1) = "Observaciones"
    .Cells(56, 1) = UCase(FormEntrada.TxtObservacion)
    .Cells(53, 6) = Suma1
    .Cells(54, 6) = Suma2
    .Cells(53, 6).NumberFormat = "#,##0"
    .Cells(54, 6).NumberFormat = "#,##0.000"
    .PrintOut
    .Cells.Clear
    .Cells.ColumnWidth = 10.71
    .Visible = xlSheetHidden
End With
Else
    Exit Sub
End If
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
