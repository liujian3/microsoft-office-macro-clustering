Attribute VB_Name = "Module1"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Sheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Select
    ActiveWindow.SelectedSheets.Delete
    Windows("|fffd|y|fffd|S|fffd||30d|X|fffd|V|fffd|z|fffd|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd|q|fffd||fffd||291||389||fffd||fffd||a5d7|20160822.xlsx").Activate
    Application.Left = 68.5
    Application.Top = 8.5
    Sheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Select
    Sheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Copy Before:=Workbooks("SpecCheck.xlsm").Sheets(6)
End Sub
Attribute VB_Name = "Module2"
Sub |fffd|q|fffd||fffd||282||30d|\|fffd||fffd|()
Dim MyPath As String, CFname As String, OpenFileName As String
Dim i As Integer, j As Integer, k As Integer, L As Integer
Dim NewLastRow As Integer, CurrentLastRow As Integer

'Dim Offset As Integer
    
    
   ' |fffd||fffd||fffd||741|i|fffd||fffd||181|j|fffd|f|fffd|B|fffd||fffd||fffd|N|fffd|g|fffd||fffd||fffd||313||1c2||74d||fffd||fffd||fffd| |fffd|i|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||fffd||256||7c2||90bd||fffd||7c1|j
   MyPath = ActiveWorkbook.Path      '|fffd||fffd||fffd||742||303|f|fffd|B|fffd||fffd||fffd|N|fffd|g|fffd||fffd|
   CFname = ActiveWorkbook.Name      '|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
   ChDir MyPath                      '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||788||5c2||243|p|fffd|X|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||193||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||250||752||fffd|
    
   ' |fffd||fffd||fffd||742||30d||14c||fffd||30d|s CurrentLastRow |fffd||fffd||fffd||fffd||fffd||fffd|
   Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Activate
   For i = 400 To 5 Step -1
      If Cells(i, 3).Value <> empy Then Exit For
   Next i
   CurrentLastRow = i
   For i = 4 To CurrentLastRow
      Cells(i, 7).Value = i
   Next i
   
   MsgBox "|fffd||fffd|r|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B"
   
   OpenFileName = Application.GetOpenFilename("Microsoft Excel|fffd|u|fffd|b|fffd|N,*.xls?")
   Workbooks.Open OpenFileName

   OpenFileName = ActiveWorkbook.Name
    
    ' |fffd|V|fffd||fffd||fffd||fffd||fffd||30d||14c||fffd||30d|s CurrentLastRow |fffd||fffd||fffd||fffd||fffd||fffd|
   For i = 400 To 5 Step -1
      If Cells(i, 3).Value <> empy Then Exit For
   Next i
   NewLastRow = i

   Cells(4, 7).Formula = "=IF(ISERROR(VLOOKUP(C4,[" & CFname & "]|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!$C$4:$C$300,1,FALSE)),1,0)"
   Cells(4, 8).Formula = "=MATCH(C4,[" & CFname & "]|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!$C$1:$C$300,FALSE)"
   Range(Cells(4, 7), Cells(NewLastRow, 8)).FillDown
   
   L = NewLastRow + 10
   
   For i = 4 To NewLastRow
      If Cells(i, 3).Value <> Empty And Cells(i, 7).Value = 1 Then
         Cells(L, 1).Value = "New?"
         Cells(L, 2).Value = i
         For j = 3 To 6
            Cells(L, j).Value = Cells(i, j).Value
         Next j
         L = L + 1
      End If
   Next i
   
   L = L + 1
   For i = 4 To NewLastRow
      If Cells(i, 3).Value <> Empty And Cells(i, 7).Value = 0 Then
         k = Cells(i, 8).Value
         For j = 4 To 6
            If Cells(i, j).Value <> Workbooks(CFname).Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Cells(k, j).Value Then
               Cells(L, 3).Value = Cells(i, 3).Value
               Cells(L, 4).Value = Cells(3, j).Value
               Cells(L, 5).Value = Cells(i, j).Value
               Cells(L, 6).Value = Workbooks(CFname).Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Cells(k, j).Value
               L = L + 1
            End If
         Next j
      End If
   Next i

   Range(Cells(4, 7), Cells(CurrentLastRow, 8)).ClearContents


   

   Workbooks(CFname).Activate
   Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Activate
   
   Cells(4, 7).Formula = "=IF(ISERROR(VLOOKUP(C4,[" & OpenFileName & "]|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!$C$4:$C$300,1,FALSE)),1,0)"
   Cells(4, 8).Formula = "=MATCH(C4,[" & OpenFileName & "]|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!$C$1:$C$300,FALSE)"
   Range(Cells(4, 7), Cells(NewLastRow, 8)).FillDown
   
   For i = 4 To CurrentLastRow
      If Cells(i, 3).Value <> Empty And Cells(i, 7).Value = 1 Then
         Cells(L, 1).Value = "New?"
         Cells(L, 2).Value = i
         For j = 3 To 6
            Cells(L, j).Value = Cells(i, j).Value
         Next j
         L = L + 1
      End If
   Next i
   
   L = L + 1
   For i = 4 To CurrentLastRow
      If Cells(i, 3).Value <> Empty And Cells(i, 7).Value = 0 Then
         k = Cells(i, 8).Value
         For j = 4 To 6
            If Cells(i, j).Value <> Workbooks(CFname).Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Cells(k, j).Value Then
               Cells(L, 3).Value = Cells(i, 3).Value
               Cells(L, 4).Value = Cells(3, j).Value
               Cells(L, 5).Value = Cells(i, j).Value
               Cells(L, 6).Value = Workbooks(CFname).Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Cells(k, j).Value
               L = L + 1
            End If
         Next j
      End If
   Next i

   Range(Cells(4, 7), Cells(CurrentLastRow, 8)).ClearContents
   


End Sub
Attribute VB_Name = "Module3"
Sub XSpecCHK()
    
    Worksheets("PDF_Spec").Activate
    Range("A1:J10000").ClearContents
    
    Range(Cells(1, 1), Cells(10000, 2)).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
    Range("A1").Select
    On Error GoTo m
    ActiveSheet.Paste
    On Error GoTo 0
        
    Call SpecCheck
    Exit Sub
m:
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    MsgBox "PDF|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"

End Sub
Sub EndSpecCheck()
Attribute EndSpecCheck.VB_ProcData.VB_Invoke_Func = "e\n14"
Dim i As Integer
    
    Worksheets("Stamp").Activate
    i = Range("B2").End(xlDown).Row
    Cells(i, 6) = Now
    Cells(i, 6).NumberFormatLocal = "yy/m/d h:mm"
    Cells(i, 6).Font.Size = 9

End Sub
Sub SpecCheck()
Dim |fffd|\|fffd||fffd||fffd|a|fffd|p As Integer, |fffd|{|fffd||fffd||fffd|a|fffd|p As Integer        '|fffd|a|fffd|F0|fffd|A|fffd|p|fffd|F1|fffd|A|fffd|a|fffd|p|fffd|F2
Dim i As Integer, j As Integer
Dim EndPDF As Integer

    Application.ScreenUpdating = False  '|fffd||fffd||fffd|Z|fffd||fffd||fffd||255|\|fffd||fffd||fffd||fffd||fffd|~|fffd||7c2||fffd|B|fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||302||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Rows.Hidden = False
    Range("B11: I400").ClearContents
    
    
    For Line = 10 To 100
        If Cells(Line, 1) = "|fffd|m|fffd|f|fffd||fffd||fffd||fffd|" Then Exit For
    Next Line
    i = Line + 1
    For Line = i To 100
        If Cells(Line, 1) = "|fffd|\|fffd||fffd||fffd||fffd|" Then Exit For
    Next Line
    j = Line - 1
    Range(Cells(i, 1), Cells(j, 1)).ClearContents
    
    For Line = j To 400
        If Cells(Line, 1) = "|fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    i = Line
    Range(Cells(i + 1, 1), Cells(1000, 1)).ClearContents
       
    Call EndLine(EndPDF)
    
    If EndPDF < 50 Then
        MsgBox "pdf|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||1c2||7c2||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|BAcrobat|fffd||301|u|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||24d||fffd||fffd||d0b9||fffd||103|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd|v|fffd||242||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B"
        Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
        Application.ScreenUpdating = True
        Exit Sub
    End If
    
    
    |fffd|\|fffd||fffd||fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 7)
    |fffd|{|fffd||fffd||fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11)
    
' |fffd|\|fffd||fffd||fffd||313||fffd||fffd||4d6||fffd|
    If |fffd|\|fffd||fffd||fffd|a|fffd|p = 1 Or |fffd|\|fffd||fffd||fffd|a|fffd|p = 3 Then Call |fffd|\|fffd||fffd||fffd|a(EndPDF)
    If |fffd|\|fffd||fffd||fffd|a|fffd|p = 2 Or |fffd|\|fffd||fffd||fffd|a|fffd|p = 3 Then Call |fffd|\|fffd||fffd||fffd|p(EndPDF)
    
'|fffd|s|fffd|c |fffd||1c9||fffd||fffd|V|fffd|[|fffd|g
    |fffd|{|fffd||fffd||fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11)
    If |fffd|{|fffd||fffd||fffd|a|fffd|p = 1 Or |fffd|{|fffd||fffd||fffd|a|fffd|p = 3 Then
        Call |fffd||fffd||fffd||4d5||fffd||fffd||fffd|(EndPDF, 1)
        Call TD(EndPDF, 1)
        Call |fffd||1c9||fffd||fffd|a(EndPDF)
    End If
    If |fffd|{|fffd||fffd||fffd|a|fffd|p = 2 Or |fffd|{|fffd||fffd||fffd|a|fffd|p = 3 Then
        Call |fffd||fffd||fffd||4d5||fffd||fffd||fffd|(EndPDF, 2)
        Call TD(EndPDF, 2)
        Call |fffd||1c9||fffd||fffd|p(EndPDF, |fffd|{|fffd||fffd||fffd|a|fffd|p)
    End If
    
' |fffd|\|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    Call |fffd|\|fffd||fffd|(EndPDF)
    
    Call PageCheck(EndPDF)
    
    Call |fffd|p|fffd||a31f||fffd||fffd|(EndPDF)
    
    If |fffd|{|fffd||fffd||fffd|a|fffd|p > 1 Then Call |fffd|a|fffd|p|fffd||fffd||fffd||fffd|(EndPDF, |fffd|{|fffd||fffd||fffd|a|fffd|p)
    
    Call |fffd||fffd||fffd||295|\|fffd||fffd|(|fffd|\|fffd||fffd||fffd|a|fffd|p, |fffd|{|fffd||fffd||fffd|a|fffd|p)
    
    Call NG|fffd||fffd||fffd||fffd|(|fffd|\|fffd||fffd||fffd|a|fffd|p, |fffd|{|fffd||fffd||fffd|a|fffd|p)
    
    Application.ScreenUpdating = True
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    
        MaxRow = Range(Cells(500, 1), Cells(501, 1)).End(xlUp).Row  '20191101_|fffd||fffd||fffd||fffd||348||34e|w|fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||1cb|L
        Hani = Range(Cells(1, 1), Cells(MaxRow, 8)).Address         '
        ActiveSheet.PageSetup.PrintArea = Hani                      '
    
    
    Range("A1").Select
    

End Sub
Private Sub |fffd||fffd||fffd||295|\|fffd||fffd|(|fffd|\|fffd|a|fffd|p As Integer, |fffd|{|fffd|a|fffd|p As Integer)
Dim |fffd||fffd||fffd||fffd| As String

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    
    If |fffd|\|fffd|a|fffd|p = 2 Then Call |fffd||fffd|\|fffd||fffd||fffd||fffd|("|fffd|a|fffd|\|fffd||fffd|")
    If |fffd|\|fffd|a|fffd|p = 1 Then Call |fffd||fffd|\|fffd||fffd||fffd||fffd|("|fffd|p|fffd|\|fffd||fffd|")
    
    If |fffd|{|fffd|a|fffd|p = 2 Then Call |fffd||fffd|\|fffd||fffd||fffd||fffd|("|fffd|a|fffd|s|fffd|c")
    If |fffd|{|fffd|a|fffd|p = 2 Then Call |fffd||fffd|\|fffd||fffd||fffd||fffd|("|fffd|a|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g")
    If |fffd|{|fffd|a|fffd|p = 1 Then Call |fffd||fffd|\|fffd||fffd||fffd||fffd|("|fffd|p|fffd|s|fffd|c")
    If |fffd|{|fffd|a|fffd|p = 1 Then Call |fffd||fffd|\|fffd||fffd||fffd||fffd|("|fffd|p|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g")

End Sub
Private Sub |fffd|\|fffd||fffd|(EndPDF As Integer)
Dim Line As Long, Top As Integer, Offset As Integer
Dim i As Integer, j As Integer, k As Integer
Dim TempLine As Integer, TempString As String
Dim |fffd|\|fffd|a|fffd|p As Integer, |fffd|{|fffd|a|fffd|p As Integer
Dim Col3 As Variant, Col4 As Variant, Col5 As String, Col6 As Variant, Col7 As Variant, Col8 As String, Col9 As String

Dim D As Variant


    ' |fffd|d|fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||7340||fffd||682||303|R|fffd|s|fffd|[
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For i = 1 To 200
        If Cells(i, 1) = "|fffd|\|fffd||fffd||fffd||fffd|" Then Exit For
    Next i
    Top = i
    
    ' |fffd|{|fffd||fffd||fffd|a|fffd|p
    |fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11)
    
    Cells(Top - 1, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 5)
    Cells(Top - 1, 6) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 5)
    Cells(Top - 1, 7) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(19, 5)
    For i = 2 To 100
        If Worksheets("|fffd|\01").Cells(i, 1) = Empty Then Exit For
        If Worksheets("|fffd|\01").Cells(i, 1) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(19, 5) Then
            Cells(Top - 1, 7) = Cells(Top - 1, 7) & vbCrLf & Worksheets("|fffd|\01").Cells(i, 2)
        End If
    Next i
    
    Cells(11, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(9, 5)    '|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|
    Cells(12, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(10, 5)   '|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||311||fffd|
    Cells(13, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(11, 5)   '|fffd||fffd||fffd|i|fffd||24a||582||fffd||fffd||90bb||fffd||311||fffd|
    Cells(14, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(12, 5)   '
    Cells(15, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(13, 5)
    Cells(16, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(14, 5)
    Cells(17, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(15, 5)
    Cells(18, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(16, 5)
    
    Cells(11, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(9, 11)
    Cells(12, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(10, 11)
    Cells(13, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(11, 11)
    Cells(14, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(12, 11)
    Cells(15, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(13, 11)
    Cells(16, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(14, 11)
    Cells(17, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(15, 11)
    Cells(18, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(16, 11)
    
    Cells(19, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(43, 5)    '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||311||fffd||fffd|i|fffd|c|fffd||fffd|)
    Cells(19, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(43, 11)   '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||311||fffd||fffd|i|fffd||fffd||fffd|Z)
    
    Cells(20, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(17, 5)    '|fffd||fffd||fffd|Z|fffd||290|M|fffd||fffd|
    Cells(21, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(18, 5)    '|fffd||fffd||fffd|Z|fffd|o|fffd|R|fffd||6c2|P|fffd|R|fffd||fffd||fffd||fffd||fffd|g
    Cells(22, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(18, 11)   '|fffd||fffd||fffd|Z|fffd|o|fffd|R|fffd||6c2|Q|fffd|R|fffd||fffd||fffd||fffd||fffd|g
    
    
    Cells(23, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(49, 5)    '|fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd|
    Cells(23, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(49, 11)   '|fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd|e
    
    
    For Line = 11 To 22
        If Cells(Line, 3) = Empty And Cells(Line, 4) = Empty Then Rows(Line).Hidden = True
    Next Line
    
    If |fffd|a|fffd|p = 1 Or |fffd|a|fffd|p = 3 Then
        Cells(Top + 10, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(33, 5) ' |fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h
        Cells(Top + 11, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(35, 5) ' |fffd|l|fffd|r|fffd|k
        Cells(Top + 12, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(36, 5) ' |fffd||fffd|R|fffd||fffd|
        Cells(Top + 13, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(37, 5) ' |fffd||fffd||fffd||fffd|
        Cells(Top + 14, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(38, 5) ' |fffd||fffd||fffd|
        Cells(Top + 15, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(39, 5) ' |fffd||6ca||fffd|
        ' |fffd||fffd||8235||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd| '16
        Cells(Top + 17, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(41, 5) ' |fffd||f455|
        Cells(Top + 36, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(45, 5) ' |fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^
        Cells(Top + 37, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(46, 5) ' |fffd||fffd||fffd||fffd||30f||15e6|
        Cells(Top + 38, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(47, 5) ' |fffd||d3|d|fffd||fffd||fffd||fffd|
        Cells(Top + 39, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(48, 5) ' |fffd||fffd||fffd|b|fffd|`|fffd|A|fffd|b|fffd|v
    End If
    
    Cells(Top + 35, 2) = "|fffd||fffd|"
    For Offset = 36 To 39
        If Left(Cells(Top + Offset, 2), 1) = "|fffd||fffd|" Then Cells(Top + 35, 2) = "|fffd||fffd|"
    Next Offset
    
    If |fffd|a|fffd|p = 2 Or |fffd|a|fffd|p = 3 Then
        Cells(Top + 21, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(33, 5)  ' |fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h
        Cells(Top + 22, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(35, 5)  ' |fffd|l|fffd|r|fffd|k
        Cells(Top + 23, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(36, 5)  ' |fffd||fffd|R|fffd||fffd|
        Cells(Top + 24, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(37, 5)  ' |fffd||fffd||fffd||fffd|
        Cells(Top + 25, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(38, 5)  ' |fffd||fffd||fffd|
        Cells(Top + 26, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(39, 5)  ' |fffd||6ca||fffd|
        ' |fffd||fffd||8235||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd|
        Cells(Top + 28, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(41, 5)  ' |fffd||f455|
        Cells(Top + 48, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(45, 5)  ' |fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^
        Cells(Top + 49, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(46, 5)  ' |fffd||fffd||fffd||fffd||30f||15e6|
        Cells(Top + 50, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(47, 5)  ' |fffd||d3|d|fffd||fffd||fffd||fffd|
        Cells(Top + 51, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(48, 5)  ' |fffd||fffd||fffd|b|fffd|`|fffd|A|fffd|b|fffd|v
    End If
    
    Cells(Top + 47, 2) = "|fffd||fffd|"
    For Offset = 48 To 51
        If Left(Cells(Top + Offset, 2), 1) = "|fffd||fffd|" Then Cells(Top + 47, 2) = "|fffd||fffd|"
    Next Offset
    
    Worksheets("PDF_Spec").Activate
    For Line = 1 To EndPDF
        ' |fffd|p|fffd|\|fffd||fffd|
        If Cells(Line, 1) = "This specification is approved and confirmed by both" Then _
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 1, 3) = Line
        
        ' |fffd|a|fffd|\|fffd||fffd|
        If Cells(Line, 1) = "|fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" _
            And Cells(Line + 1, 1) = "|fffd|X|fffd|g|fffd||fffd||fffd|[|fffd|W|fffd||fffd||fffd|f|fffd|o|fffd|C|fffd|X|fffd|\|fffd||fffd||fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|" Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 4, 3) = Line
            TempLine = Line
        End If
        
        If InStr(Cells(Line, 1), "|fffd|Y|fffd||fffd||fffd||fffd||fffd|i") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 5, 3) = Line   '|fffd|a |fffd|Y|fffd||fffd||fffd|i|fffd||fffd||fffd|X|fffd|g
        
        ' |fffd||3cd|X|fffd||fffd||fffd||fffd|
        If InStr(Cells(Line, 1), "|fffd||fffd|") > 0 Then
            Cells(Line, 2) = DelSpace(Cells(Line, 1))
            If Cells(Line, 2) = "|fffd||3cd|X|fffd||fffd||fffd||fffd|" Then
                Offset = 6
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                i = InStr(Cells(Line + 2, 1), " ")
                If i > 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Left(Cells(Line + 2, 1), i - 1)
            End If
        End If
        
        If Cells(Line, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 7, 3) = Line  ' |fffd|a|fffd|s|fffd|c
        ' |fffd|a|fffd||1c9||fffd|
        If InStr(Cells(Line, 1), "|fffd|Q|fffd|l|fffd|p|fffd|b|fffd|h") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 9, 3) = Line ' |fffd|Q|fffd|l|fffd|p|fffd|b|fffd|h
        
        ' |fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        If Cells(Line, 1) = "|fffd||fffd| |fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|" Then          ' X345|fffd||315|i|fffd||fffd||fffd|\|fffd||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
            For j = -8 To -4
                i = InStr(Cells(Line + j, 1), "|fffd||fffd||fffd|i|fffd|\|fffd||fffd|")
                If i > 0 Then
                    Cells(Line + j, 2) = Mid(Cells(Line + j, 1), 3, Len(Cells(Line + j, 1)) - 2)
                    i = InStr(Cells(Line + j, 2), "|fffd|@")
                    If i > 0 Then
                        Cells(Line + j, 2) = Left(Cells(Line + j, 2), i - 1)
                        Cells(Line + j, 3) = StrConv(Cells(Line + j, 2), vbNarrow)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 6) = Cells(Line + j, 3)
                    End If
                    i = InStr(Cells(Line + j - 1, 1), " ")
                    If i > 0 Then
                        Cells(Line + j - 1, 2) = Mid(Cells(Line + j - 1, 1), i + 1, Len(Cells(Line + j - 1, 1)) - i)
                        Cells(Line + j - 1, 3) = StrConv(Cells(Line + j - 1, 2), vbNarrow)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 6) = Cells(Line + j - 1, 3) & vbCrLf & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 6)
                    End If
                End If
            Next j
        End If
        i = InStr(Cells(Line, 1), "|fffd||fffd||fffd|b|fffd|g|fffd|i|fffd||fffd||fffd|o|fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|@")    'X344 (|fffd|^|fffd|C|fffd||fffd||fffd|i|fffd|j
        If i > 2 Then
            If ISNUMBER(Cells(Line - 2, 1)) = 1 Or Len(Cells(Line - 2, 1)) > 20 Then
                Col7 = Cells(Line - 3, 1)
            Else
                Col7 = Cells(Line - 2, 1)
            End If
            Call WriteLine(Top + 10, Line, "", "", Col7)
        End If
        



'Cells(1, 4) = Replace(StrConv(UCase(Cells(1, 3).Value), 8), " ", "")

        If Replace(StrConv(UCase(Cells(Line, 1).Value), 8), " ", "") = "1.|6ef||fffd|NO.|fffd|\|fffd||fffd||fffd||fffd||fffd|@" Then      ' X34|fffd||30f||a347| 20191023_|fffd||fffd||fffd||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
        End If

'        If Cells(Line, 1) = "|fffd|P|fffd|D|fffd||fffd||fffd|b|fffd|g No.|fffd|\|fffd||fffd||fffd||fffd||fffd|@" Then      ' X34|fffd||30f||a347| 20190712_|fffd||fffd||fffd||fffd|
'            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
'        End If
        
        
        If Cells(Line, 1) = "PW-Mini |fffd||fffd||fffd|b|fffd|gNo.|fffd||310||fffd||fffd||fffd|" Then      ' X35_PW-mini|fffd||30f||a347| 20190717_|fffd||fffd||fffd||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
        End If



'        If Cells(Line, 1) = "|fffd||fffd||fffd||fffd||fffd|b|fffd|g No|fffd|D|fffd|\|fffd|L|fffd||310||fffd||fffd||fffd|" Then      ' X33|fffd||30f||a347| 20190712_|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|"
'            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
'        End If
'
'        If Cells(Line, 1) = "|fffd||fffd||fffd||fffd||fffd|b|fffd|gNo|fffd|D|fffd|\|fffd|L|fffd||310||fffd||fffd||fffd|" Then      ' X33|fffd||30f||a347| 20190725_|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|"
'            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
'        End If

        If Replace(StrConv(UCase(Cells(Line, 1).Value), 8), " ", "") = "|fffd||fffd||6ef||fffd|NO.|fffd|\|fffd|L|fffd||310||fffd||fffd||fffd|" Then      ' X33|fffd||30f||a347| 20191023_|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|"
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
        End If
        
        
        If Cells(Line, 1) = "|fffd||fffd||fffd||fffd||fffd|N|fffd|\|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||309||fffd||fffd||a305||fffd||fffd||fffd|h|fffd|b|fffd|g|fffd||155|\|fffd||fffd||fffd|j" Then      ' X35|fffd||fffd|M-FLAT|fffd||a347|_20170609_|fffd||fffd||fffd||fffd||fffd||1cb|L
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
        End If
        
        
        If InStr(Cells(Line, 1), "Lot No.|fffd||310||fffd||fffd||fffd|") > 0 Then              ' X36|fffd||30f||a347|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
        End If
        
        If InStr(Cells(Line, 1), "|fffd|E|fffd||fffd||fffd|b|fffd|gNo. |fffd|\|fffd|L|fffd||310||fffd||fffd||fffd|") > 0 Then  ' X36|fffd||30f||a347|_20190724_|fffd||fffd||fffd||fffd||fffd||1c9||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 10, 3) = Line
        End If
        
        
        
    
    
        ' |fffd|a|fffd|M|fffd||fffd||fffd||fffd|
        ' |fffd|l|fffd|r|fffd|k
        If Cells(Line, 1) = "|fffd|z|fffd||fffd||fffd||1d7||fffd||fffd||fffd||fffd|x|fffd||fffd|(Moisture Sensitivity Level)" Then
            Call WriteLine(Top + 11, Line, "", Mid(Cells(Line + 1, 1), 7, Len(Cells(Line + 1, 1)) - 6), Mid(Cells(Line + 2, 1), 9, Len(Cells(Line + 2, 1)) - 8))
        End If
        
        ' UL|fffd||fffd|R|fffd||fffd||fffd|O|fffd||fffd||fffd|[|fffd|h|fffd||616||fffd|
        If Right(Cells(Line, 1), 9) = "|fffd||fffd|R|fffd||fffd||fffd|O|fffd||fffd||fffd|[|fffd|h|fffd||616||fffd|" Then
            i = InStr(Cells(Line + 2, 1), " ")
            If i > 1 Then
                Cells(Line + 2, 2) = Left(Cells(Line + 2, 1), i - 1)
                Cells(Line + 2, 3) = Mid(Cells(Line + 2, 1), i + 1, Len(Cells(Line + 2, 1)) - i)
                i = InStr(Cells(Line + 2, 3), "EPOXY")
                If i > 3 Then
                    Cells(Line + 2, 3) = Left(Cells(Line + 2, 3), i - 2)
                Else
                    Cells(Line + 2, 3) = ""
                End If
            Else
                Col6 = ""
                Col7 = ""
            End If
            Call WriteLine(Top + 12, Line, "", Cells(Line + 2, 2), Cells(Line + 2, 3))
        End If
        
        ' |fffd|a|fffd||fffd||fffd||fffd| THD
        If Cells(Line, 1) = "|fffd||fffd||fffd|[|fffd|h|fffd|^|fffd|C|fffd|v|fffd||302||342||42f95|t|fffd||fffd||fffd||24a||582||fffd||fffd||948d||fffd||4ce||fffd||fffd||fffd|" Then _
            Call WriteLine(Top + 13, Line, "", Right(Cells(Line + 1, 1), Len(Cells(Line + 1, 1)) - 5), Right(Cells(Line + 2, 1), Len(Cells(Line + 2, 1)) - 8))
        
        ' |fffd|a|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|t|fffd||fffd||fffd|[
        If Cells(Line, 1) = "|fffd||fffd||fffd||fffd||fffd||3d4|M|fffd||fffd||fffd||fffd|" Then
            Offset = 13
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            If Len(Cells(Line + 1, 1)) > 6 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Right(Cells(Line + 1, 1), Len(Cells(Line + 1, 1)) - 5)
            If Len(Cells(Line + 2, 1)) > 9 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = Right(Cells(Line + 2, 1), Len(Cells(Line + 2, 1)) - 8)
        End If
        
        ' |fffd|a|fffd||fffd||fffd||fffd| THD
        If Cells(Line, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then    ' X36|fffd|@|fffd||302|s|fffd|c|fffd||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 13, 3) = Line
                        
        End If
        
        
        ' |fffd||fffd||90||fffd||fffd|
        If Cells(Line, 1) = "|fffd||fffd||90||fffd||fffd||312||fffd||fffd||4ce||fffd||fffd||fffd|" Then
            Offset = 14
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
    
        ' |fffd|a|fffd||6ca||1cf||fffd||fffd||fffd|
        If Cells(Line, 1) = "|fffd||6ca||1cf||fffd||fffd||fffd||fffd||242||82||fffd||fffd||fffd|" Then
            Offset = 15
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        ' |fffd||fffd||8235||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd|
        If Left(Cells(Line, 1), 23) = "|fffd||fffd||fffd||fffd||fffd||142||348||fffd||293|I|fffd||212||fffd||fffd||4ce||fffd||fffd||fffd||fffd||242||82||fffd||fffd||10b|L|fffd||682||fffd||fffd||702||fffd||fffd||fffd||fffd|A" Then
            Offset = 16
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        ' |fffd||f455||fffd|d|fffd|l
        
         If InStr(Cells(Line, 1), "|fffd||f455||fffd|d|fffd|l|fffd|i") > 0 Then
            i = InStr(Cells(Line, 1), "|fffd||f455|")
            Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            i = InStr(Cells(Line, 2), " ")
            If i > 5 Then
                Cells(Line, 3) = Left(Cells(Line, 2), i - 1)
                Cells(Line, 2) = Mid(Cells(Line, 2), i + 1, Len(Cells(Line, 2)) - i)
            End If
            Call WriteLine(Top + 17, Line, "", Cells(Line, 3), Cells(Line, 2))
        End If
        
        If InStr(Cells(Line, 1), "|fffd||f455||fffd|d|fffd|l(") > 0 Then '20191007|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|
            i = InStr(Cells(Line, 1), "|fffd||f455|")
            Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            i = InStr(Cells(Line, 2), " ")
            If i > 5 Then
                Cells(Line, 3) = Left(Cells(Line, 2), i - 1)
                Cells(Line, 2) = Mid(Cells(Line, 2), i + 1, Len(Cells(Line, 2)) - i)
            End If
            Call WriteLine(Top + 17, Line, "", Cells(Line, 3), Cells(Line, 2))
        End If
        
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd||fffd|d|fffd|l") > 0 Then
            i = InStr(Cells(Line, 1), "|fffd||fffd||fffd||fffd|d|fffd|l")
            Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            i = InStr(Cells(Line, 2), " ")
            If i > 5 Then
                Cells(Line, 3) = Left(Cells(Line, 2), i - 1)
                Cells(Line, 2) = Mid(Cells(Line, 2), i + 1, Len(Cells(Line, 2)) - i)
            End If
            Call WriteLine(Top + 17, Line, "", Cells(Line, 3), Cells(Line, 2))
        End If
        
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd||fffd|`|fffd||fffd|") > 0 Then
            i = InStr(Cells(Line, 1), "|fffd|X|fffd|e|fffd|B|fffd|b|fffd|N")
            If i > 0 Then
                Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            End If
            i = InStr(Cells(Line, 1), "|fffd||e8||fffd||fffd|")
            If i > 0 Then
                Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            End If
            If Cells(Line, 2) <> Empty Then
                i = InStr(Cells(Line, 2), " ")
                If i > 5 Then
                    Cells(Line, 3) = Left(Cells(Line, 2), i - 1)
                    Cells(Line, 2) = Mid(Cells(Line, 2), i + 1, Len(Cells(Line, 2)) - i)
                End If
                Cells(Line, 2) = StrConv(Cells(Line, 2), vbNarrow)
                Call WriteLine(Top + 17, Line, "", Cells(Line, 3), Cells(Line, 2))
            End If
        End If
        
        If InStr(Cells(Line, 1), "|fffd|G|fffd||fffd||fffd|{|fffd|X|fffd|e|fffd|[|fffd|s|fffd||fffd||fffd|O|fffd||f455||fffd|d|fffd|l") > 0 Then
            i = InStr(Cells(Line - 1, 1), "|fffd|^|fffd|C|fffd|v")
            If i > 0 Then
                Cells(Line - 1, 2) = DelEndSpace(Left(Cells(Line - 1, 1), i - 1))
            End If
            Call WriteLine(Top + 17, Line, "", "", Cells(Line - 1, 2))
        End If
        
        
        
        ' |fffd||f455||fffd||78e||fffd|
        If InStr(Cells(Line, 1), "|fffd||f455||fffd||78e||fffd|") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 17, 4) = Line & " |fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd| |fffd||78e||fffd|"
        
        ' |fffd|p|fffd|s|fffd|c
        If Cells(Line, 1) = "RESTRICTIONS ON PRODUCT USE" Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 18, 3) = Line
        
        ' |fffd|p|fffd||1c9||fffd|
        ' |fffd|p|fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h
        ' Lot No
                'x36|fffd||303||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|_20190717_|fffd||fffd||fffd||fffd|
        If InStr(Cells(Line, 1), "Explanation for Lot No. indication system") > 0 Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 7) = Cells(Line - 2, 1)
        End If
        
        
        If InStr(Cells(Line, 1), "|fffd|P|fffd|DLot No. Designation") > 0 Or InStr(Cells(Line, 1), "1. Lot No. Designation") > 0 Then  ' X34
            If ISNUMBER(Cells(Line - 2, 1)) = 0 Then
                Call WriteLine(Top + 21, Line, "", "", Cells(Line - 2, 1))
            Else
                Call WriteLine(Top + 21, Line, "", "", Cells(Line - 3, 1))
            End If
        End If
        If InStr(Cells(Line, 1), "FLAT Marking") > 0 Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 7) = Cells(Line - 2, 1)
        End If
        If InStr(Cells(Line, 1), "|fffd|d|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|k|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then     ' X345|fffd||315|i|fffd||fffd||fffd|\|fffd||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 3) = Line
            For j = -9 To -7              ' X345|fffd||315|i|fffd||fffd||fffd|\|fffd||fffd|
                i = InStr(Cells(Line + j, 1), "|fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
                If i > 0 Then
                    Cells(Line + j, 2) = Mid(Cells(Line + j, 1), 3, Len(Cells(Line + j, 1)) - 2)
                    i = InStr(Cells(Line + j, 2), "|fffd|@")
                    If i > 0 Then
                        Cells(Line + j, 2) = Left(Cells(Line + j, 2), i - 1)
                        Cells(Line + j, 3) = StrConv(Cells(Line + j, 2), vbNarrow)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 6) = Cells(Line + j, 3)
                    End If
                    i = InStr(Cells(Line + j - 1, 1), " ")
                    If i > 0 Then
                        Cells(Line + j - 1, 2) = Mid(Cells(Line + j - 1, 1), i + 1, Len(Cells(Line + j - 1, 1)) - i)
                        Cells(Line + j - 1, 3) = StrConv(Cells(Line + j - 1, 2), vbNarrow)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 6) = Cells(Line + j - 1, 3) & vbCrLf & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 6)
                    End If
                End If
            Next j
        End If
        
        If InStr(Cells(Line, 1), "Explanation for lot No.") > 0 Then     ' X345|fffd||315|i|fffd||fffd||fffd|\|fffd||fffd|_20170608_|fffd||fffd||fffd||fffd||fffd||1cb|L
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 3) = Line
            For j = -9 To -7              ' X345|fffd||315|i|fffd||fffd||fffd|\|fffd||fffd|
                i = InStr(Cells(Line + j, 1), "|fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
                If i > 0 Then
                    Cells(Line + j, 2) = Mid(Cells(Line + j, 1), 3, Len(Cells(Line + j, 1)) - 2)
                    i = InStr(Cells(Line + j, 2), "|fffd|@")
                    If i > 0 Then
                        Cells(Line + j, 2) = Left(Cells(Line + j, 2), i - 1)
                        Cells(Line + j, 3) = StrConv(Cells(Line + j, 2), vbNarrow)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 6) = Cells(Line + j, 3)
                    End If
                    i = InStr(Cells(Line + j - 1, 1), " ")
                    If i > 0 Then
                        Cells(Line + j - 1, 2) = Mid(Cells(Line + j - 1, 1), i + 1, Len(Cells(Line + j - 1, 1)) - i)
                        Cells(Line + j - 1, 3) = StrConv(Cells(Line + j - 1, 2), vbNarrow)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 6) = Cells(Line + j - 1, 3) & vbCrLf & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 21, 6)
                    End If
                End If
            Next j
        End If
                
        If Cells(Line, 1) = "|fffd||fffd|Explanation for Lot No indication system" Then               ' X35
            Call WriteLine(Top + 21, Line, "", "", "")
        End If
        
        
        ' |fffd|p |fffd|l|fffd|r|fffd|k
        If Cells(Line, 1) = "Moisture Absorption Control Level (Moisture Sensitivity Level)" Then
            Offset = 22
            Call WriteLine(Top + Offset, Line, "", Mid(Cells(Line + 1, 1), 16, Len(Cells(Line + 1, 1)) - 15), Mid(Cells(Line + 2, 1), 16, Len(Cells(Line + 2, 1)) - 15))
        End If
        
        ' |fffd|p UL|fffd||fffd|R|fffd||fffd||fffd|O|fffd||fffd||fffd|[|fffd|h|fffd||616||fffd|
        If Cells(Line, 1) = "Certification of UL Flammability Classification" Then
            Offset = 23
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            i = InStr(Cells(Line + 5, 1), " ")
            If i > 1 Then
                Cells(Line + 5, 2) = Left(Cells(Line + 5, 1), i - 1)
                Cells(Line + 5, 3) = Mid(Cells(Line + 5, 1), i + 1, Len(Cells(Line + 5, 1)) - i)
                i = InStr(Cells(Line + 5, 3), "EPOXY")
                If i > 0 Then
                    Cells(Line + 5, 3) = Left(Cells(Line + 5, 3), i - 2)
                End If
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Cells(Line + 5, 2)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = Cells(Line + 5, 3)
            End If
        End If
        
        ' |fffd|p |fffd||fffd||fffd||fffd|
        If Cells(Line, 1) = "Heat-resistant Mounting Conditions" Then
            Offset = 24
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            If Len(Cells(Line + 1, 1)) > 15 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Mid(Cells(Line + 1, 1), 15, Len(Cells(Line + 1, 1)) - 14)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = Mid(Cells(Line + 2, 1), 15, Len(Cells(Line + 2, 1)) - 14)
            End If
        End If
        
        ' |fffd||fffd||90||fffd||fffd|
        If Cells(Line, 1) = "CAUTIONS IN BOARD CLEANING PROCEDURE" Then
            Offset = 25
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        ' |fffd||6ca||1cf||fffd||fffd||fffd|
        If Cells(Line, 1) = "General Storage" Then
            Offset = 26
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        ' |fffd||fffd||8235||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd|
        If Left(Cells(Line, 1), 59) = "This section describes the general precautions for handling" Then
            Offset = 27
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        ' |fffd|p |fffd||f455|
        ' |fffd|N|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|O
        If InStr(Cells(Line, 1), "Packaging -") > 0 Then
            i = InStr(Cells(Line, 1), " Packaging")
            Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            Call WriteLine(Top + 28, Line, "", "", Cells(Line, 2))
        End If
        
'---------20191118_|fffd|p|fffd||f455||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|O|fffd||151||389||fffd|_|fffd||fffd||fffd||fffd|

        If InStr(Cells(Line, 1), "Embossed Carrier Tape Packaging specifications for") > 0 Then
            i = InStr(Cells(Line, 1), " Packaging")
            Cells(Line, 2) = DelEndSpace(Left(Cells(Line, 1), i - 1))
            Call WriteLine(Top + 28, Line, "", "", Cells(Line, 2))
        End If
'-------------------------------------------------------------------
        
        i = InStr(Cells(Line, 1), "Tape Specifications for")     '|fffd||fffd||fffd|e|fffd|[|fffd|s|fffd||fffd||fffd|O|fffd||f455||fffd|d|fffd|l
        If i > 0 Then
            i = InStr(Cells(Line, 1), "Package")
            If i > 26 Then
                Cells(Line, 2) = Mid(Cells(Line, 1), 25, i - 26)
                Call WriteLine(Top + 28, Line, "", "", Cells(Line, 2))
            End If
        End If
        
        i = InStr(Cells(Line, 1), "Stick Packing Specification") + InStr(Cells(Line, 1), "Stick(STA4) Packing Specification")  '|fffd|X|fffd|e|fffd|B|fffd|b|fffd|N
        If i > 5 Then
            Cells(Line, 2) = Left(Cells(Line, 1), i - 1)
            Cells(Line, 2) = DelEndSpace(StrConv(Cells(Line, 2), vbNarrow))
            Call WriteLine(Top + 28, Line, "", "", Cells(Line, 2))
        End If
        
        
        ' |fffd|a |fffd|i|fffd||fffd|
        If Cells(Line, 1) = "|fffd|H|fffd||fffd||fffd||598|A|fffd||fffd||fffd||fffd|" Then
            Offset = 29
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        
        '|fffd|H|fffd||fffd||fffd||1d7||fffd||fffd|}
        If Left(Cells(Line, 1), 13) = "|fffd||fffd||fffd||fffd||fffd||310||fffd||fffd|i|fffd||fffd||fffd||fffd| |fffd|H|fffd||fffd||fffd||1d7||fffd||fffd|}" Or Left(Cells(Line, 1), 12) = "|fffd||fffd||fffd||fffd||fffd||310||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|H|fffd||fffd||fffd||1d7||fffd||fffd|}" Then
            If InStr(Cells(Line, 1), "|fffd|O|fffd|H|fffd||fffd|") > 0 Then
                If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 30, 3) = Empty Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 30, 3) = Line
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 30, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 30, 3) & " , " & Line
                End If
            Else
                Col4 = ""
                Col6 = ""
                Col7 = ""
                For j = -18 To 18
                    If Left(Cells(Line + j, 1), 1) = "|fffd||fffd|" Then Exit For
                    Offset = 31              '|fffd||fffd||fffd||4d6||fffd||fffd|FLine-1|fffd|A|fffd||fffd||fffd|i|fffd||fffd|=Line+1|fffd|APKG|fffd||fffd|=Line-3
                    If InStr(Cells(Line + j, 1), "|fffd||4486|") > 0 Then
                        Col4 = DelEndSpace(Left(Cells(Line + j, 1), Len(Cells(Line + j, 1)) - 2))
                    End If
                    TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 6)
                    TempString = Left(TempString, 4)
                    i = InStr(Cells(Line + j, 1), TempString)
                    If i > 0 Then
                        Col6 = Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1)
                        i = InStr(Col6, " ")
                        If i > 0 Then Col6 = Left(Col6, i - 1)
                    End If
                    TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 7)
                    TempString = Left(TempString, 3)
                    i = InStr(Cells(Line + j, 1), TempString)
                    If i > 0 Then
                        Col7 = Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1)
                        i = InStr(Col7, " ")
                        If i > 0 Then Col7 = Left(Col7, i - 1)
                    End If
                    If Col7 = Empty Then
                        TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 7)
                        i = InStr(TempString, vbCr)
                        If i > 0 Then TempString = Mid(TempString, i + 2, 2)
                        i = InStr(Cells(Line + j, 1), TempString)
                        If i > 0 Then
                            Col7 = Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1)
                            i = InStr(Col7, " ")
                            If i > 0 Then Col7 = Left(Col7, i - 1)
                        End If
                    End If
                    If InStr(Cells(Line + j, 1), "|fffd||556a|") > 0 Then Col5 = "|fffd||556a|"
                    If InStr(Cells(Line + j, 1), "|fffd|P|fffd|H|fffd||fffd||fffd||fffd||fffd||30d|H|fffd||fffd|") > 0 Then Col5 = "|fffd|P|fffd||fffd|"
                    If InStr(Cells(Line + j, 1), "|fffd||fffd||fffd||fffd|") > 0 Then Col5 = "|fffd||fffd||fffd||fffd|"
                    If InStr(Cells(Line + j, 1), "|fffd|L|fffd|O") Then Col5 = "|fffd|L|fffd|O"
                    If Left(Cells(Line + j, 1), 1) = "Q" Then
                        TempString = Mid(Cells(Line + j, 1), 2, Len(Cells(Line + j, 1)) - 1)
                        If ISNUMBER(TempString) = 1 Then Call WriteCol(Top + 31, 8, Cells(Line + j, 1))
                    End If
                    If IsDate(Cells(Line + j, 1)) Then
                        If InStr(Cells(Line + j, 1), "|fffd|N") > 0 Then Call WriteCol(Top + 31, 9, Cells(Line + j, 1))
                    End If
                Next j
                i = InStr(Cells(Line, 1), "Q")
                If i > 0 Then Call WriteCol(Top + 31, 8, Mid(Cells(Line, 1), i, Len(Cells(Line, 1)) - i + 1))
                If InStr(Cells(Line + 1, 1), "|fffd||c42c||fffd||fffd||fffd|t") > 0 Then Call WriteCol(Top + 31, 9, Mid(Cells(Line + 1, 1), 5, Len(Cells(Line + 1, 1)) - 4))
                Call WriteLine(Top + 31, Line, Col4, Col6, Col7)
                Call WriteCol(Top + 31, 5, Col5)
            End If
        End If
                
        ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|}|fffd|i|fffd|P|fffd||fffd||fffd|j
        If Left(Cells(Line, 1), 9) = "|fffd||fffd||fffd|@|fffd||fffd||fffd|@|fffd|\|fffd|@|fffd||fffd||fffd|@|fffd|}" Then
            Offset = 32
            i = InStr(Cells(Line + 3, 1), " ")
            If i > 1 And Cells(Line + 2, 1) = "|fffd||fffd||fffd|@|fffd|i|fffd|@|fffd||fffd||fffd|@|fffd||30a|O|fffd|@|fffd||341|@|fffd||fffd|@|fffd||fffd||fffd|@|fffd||fffd|" Then
                TempString = Left(Cells(Line - 2, 1), Len(Cells(Line - 2, 1)) - 2)
                TempString = DelEndSpace(TempString)
                Call WriteLine(Top + Offset, Line, TempString, Left(Cells(Line + 3, 1), i - 1), Mid(Cells(Line + 3, 1), i + 1, Len(Cells(Line + 3, 1)) - i))
            i = InStr(Cells(Line, 1), "Q")
            If i > 1 Then Call WriteCol(Top + Offset, 8, Mid(Cells(Line, 1), i, Len(Cells(Line, 1)) - i + 1))
            If InStr(Cells(Line + 6, 1), "|fffd|P|fffd|H") > 0 Then Call WriteCol(Top + Offset, 5, "|fffd|P|fffd||fffd|")
            If InStr(Cells(Line + 6, 1), "|fffd||fffd||fffd||fffd|") Then Call WriteCol(Top + Offset, 5, "|fffd||fffd||fffd||fffd|")
            If InStr(Cells(Line + 4, 1), "|fffd|L|fffd|O") Then Call WriteCol(Top + Offset, 5, "|fffd|L|fffd|O")
            If InStr(Cells(Line + 1, 1), "|fffd||c42c||fffd||fffd||fffd|t") > 0 Then Call WriteCol(Top + 32, 9, Mid(Cells(Line + 1, 1), 5, Len(Cells(Line + 1, 1)) - 4))
            End If
        End If
        
        ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|}|fffd|i|fffd||556a||fffd|j
        If Left(Cells(Line, 1), 9) = "|fffd||fffd| |fffd||fffd| |fffd|\ |fffd||fffd| |fffd|}" Then
            Offset = 32
            For i = -15 To 15
                If InStr(Cells(Line + i, 1), "|fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Or InStr(Cells(Line + i, 1), "|fffd|N|fffd||fffd||fffd|[|fffd||fffd|") > 0 Then Exit For
                If InStr(Cells(Line + i, 1), "|fffd||4486|") > 0 Then Col4 = DelEndSpace(Left(Cells(Line + i, 1), Len(Cells(Line + i, 1)) - 2))
                j = InStr(Cells(Line + i, 1), "|fffd||fffd||fffd|i|fffd||fffd|")
                If j > 0 Then Col6 = Mid(Cells(Line + i, 1), j + 4, Len(Cells(Line + i, 1)) - 3 - j)
                j = InStr(Cells(Line + i, 1), "|fffd|O|fffd||34a||fffd|")
                If j > 0 Then Col7 = Mid(Cells(Line + i, 1), j + 4, Len(Cells(Line + i, 1)) - 3 - j)
                If Left(Cells(Line + i, 1), 1) = "Q" Then Call WriteCol(Top + Offset, 8, Cells(Line + i, 1))
                If IsDate(Cells(Line + i, 1)) And InStr(Cells(Line + i, 1), "|fffd|N") > 0 Then Call WriteCol(Top + Offset, 9, Cells(Line + i, 1))
                If InStr(Cells(Line + i, 1), "|fffd||556a|") Then Call WriteCol(Top + Offset, 5, "|fffd||556a|")
            Next i
            Call WriteLine(Top + Offset, Line, Col4, Col6, Col7)
        End If
        
        If Left(Cells(Line, 1), 7) = "|fffd|i|fffd||fffd||fffd||6cf||611||30c|n|fffd|}" Then
            Col4 = ""
            Col5 = ""
            Col6 = ""
            Col7 = ""
            Col8 = ""
            Col9 = ""
            Offset = 33
            For i = -7 To 11
                If InStr(Cells(Line + i, 1), "|fffd||4486|") Then
                    TempString = Mid(Cells(Line + i, 1), 1, Len(Cells(Line + i, 1)) - 2)
                    Col4 = DelEndSpace(TempString)
                End If
                j = InStr(Cells(Line + i, 1), "Q")
                If j > 0 Then
                    Col8 = Mid(Cells(Line + i, 1), j, Len(Cells(Line + i, 1)) - j + 1)
                    j = InStr(Col8, " ")
                    If j > 0 Then Col8 = Left(Col8, j - 1)
                End If
                j = InStr(Cells(Line + i, 1), "|fffd||c42c||fffd||fffd||fffd|t")
                If j > 0 Then
                    Col9 = Mid(Cells(Line + i, 1), 5, Len(Cells(Line + i, 1)) - 4)
                End If
                If Col9 = Empty Then
                    If IsDate(Cells(Line + i, 1)) And InStr(Cells(Line + i, 1), "|fffd|N") > 0 Then Col9 = Cells(Line + i, 1)
                End If
                If InStr(Cells(Line + i, 1), "|fffd||556a|") Then Col5 = "|fffd||556a|"
                If InStr(Cells(Line + i, 1), "|fffd|P|fffd|H") Then Col5 = "|fffd|P|fffd||fffd|"
                If InStr(Cells(Line + i, 1), "|fffd||fffd||fffd||fffd|") Then Col5 = "|fffd||fffd||fffd||fffd|"
                If InStr(Cells(Line + i, 1), "|fffd|L|fffd|O") Then Col5 = "|fffd|L|fffd|O"
            Next i
            Call WriteLine(Top + Offset, Line, Col4, Col6, Col7)
            Call WriteCol(Top + Offset, 5, Col5)
            Call WriteCol(Top + Offset, 8, Col8)
            Call WriteCol(Top + Offset, 9, Col9)
        End If
        
        ' |fffd|P|fffd||fffd|
        If Left(Cells(Line, 1), 9) = "|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c|n|fffd|}" Then
            Offset = 34
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            TempString = Left(Cells(Line - 2, 1), Len(Cells(Line - 2, 1)) - 2)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = DelEndSpace(TempString)
            i = InStr(Cells(Line, 1), "Q")
            If i > 0 Then Call WriteCol(Top + Offset, 8, Mid(Cells(Line, 1), i, Len(Cells(Line, 1)) - i + 1))
            i = InStr(Cells(Line + 1, 1), "|fffd||c42c||fffd||fffd||fffd|t")
            If i > 0 Then Call WriteCol(Top + Offset, 9, Mid(Cells(Line + 1, 1), 5, Len(Cells(Line + 1, 1)) - 4))
            For i = -5 To 5
                If InStr(Cells(Line + i, 1), "|fffd|P|fffd|H") Then Call WriteCol(Top + Offset, 5, "|fffd|P|fffd||fffd|")
                If InStr(Cells(Line + i, 1), "|fffd||fffd||fffd||fffd|") Then Call WriteCol(Top + Offset, 5, "|fffd||fffd||fffd||fffd|")
                If InStr(Cells(Line + i, 1), "|fffd|L|fffd|O") Then Call WriteCol(Top + Offset, 5, "|fffd|L|fffd|O")
            Next i
        End If
        
        ' |fffd||556a|
        If Left(Cells(Line, 1), 16) = "|fffd|i|fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd|E|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c|n|fffd|}" Then
            Offset = 34
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            i = InStr(Cells(Line + 9, 1), "|fffd||4486|")
            If i > 2 Then TempString = Left(Cells(Line + 9, 1), i - 2)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = TempString
            For i = -5 To 5
                If InStr(Cells(Line + i, 1), "|fffd||556a|") Then Call WriteCol(Top + Offset, 5, "|fffd||556a|")
            Next i
        End If
        
        ' |fffd|a |fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
        If Cells(Line, 1) = "|fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^" Then
            Offset = 35
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
        
        If Cells(Line, 1) = "|fffd||fffd||fffd||154||fffd||fffd||fffd||fffd||301|@|fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g" Then
            Offset = 36
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            i = InStr(Cells(Line + 1, 1), Left(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 6), 4))
            If i > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Cells(Line + 1, 1)
            i = InStr(Cells(Line + 3, 1), "|fffd|O|fffd|`")
            If i > 0 Then
                i = InStr(Cells(Line + 3, 1), "(")
                If i > 0 Then Cells(Line + 3, 2) = Mid(Cells(Line + 3, 1), i + 1, Len(Cells(Line + 3, 1)) - i - 1)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = Cells(Line + 3, 2)
            End If
        End If
        
        If Cells(Line, 1) = "|fffd||fffd||fffd||fffd||30f||15e6|" Then
            Offset = 37
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            i = InStr(Cells(Line + 2, 1), " ")
            If i > 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Left(Cells(Line + 2, 1), i - 1)
        End If
                
        If Cells(Line, 1) = "|fffd||d3|d|fffd|j|fffd||ce38c||fffd|" Then
            Offset = 38
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Mid(Cells(Line + 1, 1), 6, Len(Cells(Line + 1, 1)) - 5)
            For i = 1 To 20
                If Cells(Line + i, 1) = "|fffd||d3|d|fffd|j|fffd||fffd||251||382||fffd||fffd||fffd||fffd||8235||fffd||fffd||fffd||fffd||312||fffd||fffd||4ce||fffd||fffd||fffd|" Then Exit For
            Next i
            If i < 20 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd||fffd||fffd||4ce||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            If i > 19 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd||fffd||fffd||4ce||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
        If Cells(Line, 1) = "|fffd||fffd||fffd|b|fffd|`|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd|" Then
            Offset = 39
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            If Left(Cells(Line + 4, 1), 12) = "|fffd|{|fffd||fffd||fffd|i|fffd||343||fffd||fffd|b|fffd|`|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd|" Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Cells(Line + 2, 1)
            Else
                If Len(Cells(Line + 1, 1)) > 5 Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Mid(Cells(Line + 1, 1), 6, Len(Cells(Line + 1, 1)) - 5)
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = "|fffd|s|fffd||fffd|"
                End If
                
            End If
        End If
    
        If Cells(Line, 1) = "|fffd||8b||fffd||fffd||fffd||fffd||fffd|" Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 40, 3) = Line               '|fffd||8b||fffd||fffd||fffd||fffd||fffd|
        
        If Cells(Line, 1) = "Production Information" Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 41, 3) = Line ' |fffd|p|fffd|i|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
        
        ' QC Process Flow|fffd|i|fffd|H|fffd||fffd||fffd|j
        If Left(Cells(Line, 1), 15) = "QC Process Flow" Then
            If InStr(Cells(Line, 1), "A") > 0 Then
            Else
                Col4 = ""
                Col6 = ""
                Col7 = ""
                For j = -10 To 10
                    If Left(Cells(Line + j, 1), 1) = "Construction" Then Exit For
                    TempString = Left(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 4), 5)
                    i = InStr(Cells(Line + j, 1), TempString)
                    If i > 0 Then Col4 = DelEndSpace(Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1))
                    If InStr(Cells(Line + j, 1), "Product Name Package") > 0 Then
                        i = InStr(Cells(Line + j + 1, 1), " ")
                        If i > 0 Then
                            Col6 = Left(Cells(Line + j + 1, 1), i - 1)
                            Col7 = Mid(Cells(Line + j + 1, 1), i + 1, Len(Cells(Line + j + 1, 1)) - i)
                            If InStr(Col7, " ") > 0 Then
                                TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 7)
                                k = Len(TempString)
                                i = InStr(TempString, vbCr)
                                If i > 0 And i * 2 < k Then
                                    k = InStr(Col7, " ")
                                    If i < k Then Col7 = Left(Cells(Line + j + 1, 1), k - 1)
                                End If
                            End If
                        End If
                    End If
                    If InStr(Cells(Line + j, 1), "Ooita") > 0 Then Col5 = "|fffd||556a|"
                    If InStr(Cells(Line + j, 1), "Himeji Operations") > 0 Then Col5 = "|fffd|P|fffd||fffd|"
                    If InStr(Cells(Line + j, 1), "Kaga") > 0 Then Col5 = "|fffd||fffd||fffd||fffd|"
                    If InStr(Cells(Line + j, 1), "Buzen") Then Col5 = "|fffd|L|fffd|O"
                    If InStr(Cells(Line + j, 1), "Thailand") Then Col5 = "|fffd|^|fffd|C"
                    
                    i = InStr(Cells(Line + j, 1), "Issue No. Q")
                    If i > 0 Then
                        Col8 = Mid(Cells(Line + j, 1), i + 10, Len(Cells(Line + j, 1)) - i - 9)
                    End If
                    i = InStr(Cells(Line + j, 1), "Date")
                    If i > 0 Then
                        TempString = Mid(Cells(Line + j, 1), i + 5, Len(Cells(Line + j, 1)) - i - 4)
                        If IsDate(TempString) Then Col9 = TempString
                    End If
                Next j
                
                If Col6 = Empty Then
                    For j = -18 To 18
                        TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 6)            ' |fffd|i|fffd||fffd|
                        TempString = Left(TempString, 4)
                        i = InStr(Cells(Line + j, 1), TempString)
                        If i > 0 Then
                            Col6 = Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1)
                            i = InStr(Col6, " ")
                            If i > 0 Then
                                Col7 = Mid(Col6, i + 1, Len(Col6) - i)
                                Col6 = Left(Col6, i - 1)
                            End If
                        End If
                        If Col7 = Empty Then
                            TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 7)           ' PKG|fffd||fffd|
                            TempString = Left(TempString, 3)
                            i = InStr(Cells(Line + j, 1), TempString)
                            If i > 0 Then
                                Col7 = Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1)
                                i = InStr(Col7, " ")
                                If i > 0 Then Col7 = Left(Col7, i - 1)
                            End If
                            If Col7 = Empty Then
                                TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 7)
                                i = InStr(TempString, vbCr)
                                If i > 0 Then TempString = Mid(TempString, i + 2, 2)
                                i = InStr(Cells(Line + j, 1), TempString)
                                If i > 0 Then
                                    Col7 = Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1)
                                    i = InStr(Col7, " ")
                                    If i > 0 Then Col7 = Left(Col7, i - 1)
                                End If
                            End If
                        End If
                    Next j
                End If
                Call WriteLine(Top + 43, Line, Col4, Col6, Col7)
                Call WriteCol(Top + 43, 5, Col5)
                Call WriteCol(Top + 43, 8, Col8)
                Call WriteCol(Top + 43, 9, Col9)
            End If
        End If
        
        ' Construction Drawingw
        If Left(Cells(Line, 1), 20) = "Construction Drawing" Then
            For j = -10 To 10
                TempString = Left(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 4), 5)
                i = InStr(Cells(Line + j, 1), TempString)
                If i > 0 Then Col4 = DelEndSpace(Mid(Cells(Line + j, 1), i, Len(Cells(Line + j, 1)) - i + 1))
                If InStr(Cells(Line + j, 1), "Product Name Package") > 0 Then
                    i = InStr(Cells(Line + j + 1, 1), " ")
                    If i > 0 Then
                        Col6 = Left(Cells(Line + j + 1, 1), i - 1)
                        Col7 = Mid(Cells(Line + j + 1, 1), i + 1, Len(Cells(Line + j + 1, 1)) - i)
                        If InStr(Col7, " ") > 0 Then
                            TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 7)
                            k = Len(TempString)
                            i = InStr(TempString, vbCr)
                            If i > 0 And i * 2 < k Then
                                k = InStr(Col7, " ")
                                If i < k Then Col7 = Left(Cells(Line + j + 1, 1), k - 1)
                            End If
                        End If
                    End If
                End If
                If InStr(Cells(Line + j, 1), "Ooita") > 0 Then Col5 = "|fffd||556a|"
                If InStr(Cells(Line + j, 1), "Himeji Operations") > 0 Then Col5 = "|fffd|P|fffd||fffd|"
                If InStr(Cells(Line + j, 1), "Kaga") > 0 Then Col5 = "|fffd||fffd||fffd||fffd|"
                If InStr(Cells(Line + j, 1), "Buzen") Then Col5 = "|fffd|L|fffd|O"
                If InStr(Cells(Line + j, 1), "Thailand") Then Col5 = "|fffd|^|fffd|C"
                    
                i = InStr(Cells(Line + j, 1), "Issue No. Q")
                If i > 0 Then
                    Col8 = Mid(Cells(Line + j, 1), i + 10, Len(Cells(Line + j, 1)) - i - 9)
                End If
                i = InStr(Cells(Line + j, 1), "Date")
                If i > 0 Then
                    TempString = Mid(Cells(Line + j, 1), i + 5, Len(Cells(Line + j, 1)) - i - 4)
                    If IsDate(TempString) Then Col9 = TempString
                End If
            Next j
            
            Call WriteLine(Top + 44, Line, Col4, Col6, Col7)
            Call WriteCol(Top + 44, 5, Col5)
            Call WriteCol(Top + 44, 8, Col8)
            Call WriteCol(Top + 44, 9, Col9)
        End If
        
        ' Quality Assurance Procedural Flow
        If Left(Cells(Line, 1), 33) = "Quality Assurance Procedural Flow" Then
            Call WriteLine(Top + 45, Line, Cells(Line - 2, 1), "", "")
            For j = -5 To 5
                If InStr(Cells(Line + j, 1), "Ooita") > 0 Then Col5 = "|fffd||556a|"
                If InStr(Cells(Line + j, 1), "Himeji Operations") > 0 Then Col5 = "|fffd|P|fffd||fffd|"
                If InStr(Cells(Line + j, 1), "Kaga") > 0 Then Col5 = "|fffd||fffd||fffd||fffd|"
                If InStr(Cells(Line + j, 1), "Buzen") Then Col5 = "|fffd|L|fffd|O"
                If InStr(Cells(Line + j, 1), "Thailand") Then Col5 = "|fffd|^|fffd|C"
            
                i = InStr(Cells(Line + j, 1), "Issue No. Q")
                If i > 0 Then
                    Col8 = Mid(Cells(Line + j, 1), i + 10, Len(Cells(Line + j, 1)) - i - 9)
                End If
                i = InStr(Cells(Line + j, 1), "Date")
                If i > 0 Then
                    TempString = Mid(Cells(Line + j, 1), i + 5, Len(Cells(Line + j, 1)) - i - 4)
                    If IsDate(TempString) Then Col9 = TempString
                End If
            
            
            Next j
            Call WriteCol(Top + 45, 5, Col5)
            Call WriteCol(Top + 46, 8, Col8)
            Call WriteCol(Top + 46, 9, Col9)

        End If
        
        ' Quality Service and
        If Left(Cells(Line, 1), 19) = "Quality Service and" Then
            Call WriteLine(Top + 46, Line, Cells(Line - 2, 1), "", "")
            For j = -5 To 5
                If InStr(Cells(Line + j, 1), "Ooita") > 0 Then Col5 = "|fffd||556a|"
                If InStr(Cells(Line + j, 1), "Himeji Operations") > 0 Then Col5 = "|fffd|P|fffd||fffd|"
                If InStr(Cells(Line + j, 1), "Kaga") > 0 Then Col5 = "|fffd||fffd||fffd||fffd|"
                If InStr(Cells(Line + j, 1), "Buzen") Then Col5 = "|fffd|L|fffd|O"
                If InStr(Cells(Line + j, 1), "Thailand") Then Col5 = "|fffd|^|fffd|C"
            
                i = InStr(Cells(Line + j, 1), "Issue No")
                If i > 0 Then
                    Col8 = Mid(Cells(Line + j, 1), i + 10, Len(Cells(Line + j, 1)) - i - 9)
                End If
                i = InStr(Cells(Line + j, 1), "Date")
                If i > 0 Then
                    TempString = Mid(Cells(Line + j, 1), i + 5, Len(Cells(Line + j, 1)) - i - 4)
                    If IsDate(TempString) Then Col9 = TempString
                End If
            
            Next j
            Call WriteCol(Top + 46, 5, Col5)
            Call WriteCol(Top + 46, 8, Col8)
            Call WriteCol(Top + 46, 9, Col9)

        End If
        
        ' |fffd|p |fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
        If Cells(Line, 1) = "Reliability Test Report" Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 47, 3) = Line
        
        ' |fffd|p |fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Cells(Line, 1) = "RELIABILITY TEST REPORT" Then
            Offset = 48
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Cells(Line + 1, 1)
            i = InStr(Cells(Line + 3, 1), "TOSHIBA")
            If i > 0 Then
                Cells(Line + 3, 2) = Mid(Cells(Line + 3, 1), i, Len(Cells(Line + 3, 1)) - i + 1)
                i = InStr(Cells(Line + 3, 2), "(")
                If i > 0 Then
                    Cells(Line + 3, 3) = Mid(Cells(Line + 3, 2), i + 1, Len(Cells(Line + 3, 2)) - i)
                    If Right(Cells(Line + 3, 3), 1) = ")" Then Cells(Line + 3, 3) = Left(Cells(Line + 3, 3), Len(Cells(Line + 3, 3)) - 1)
                    If Right(Cells(Line + 3, 3), 1) = ")" Then Cells(Line + 3, 3) = Left(Cells(Line + 3, 3), Len(Cells(Line + 3, 3)) - 1)
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = Cells(Line + 3, 3)
                End If
            End If
            
            For i = 8 To 9
                If Cells(Line + i, 1) = "Test items Referred standard" Then
                    If Cells(Line + i + 1, 1) <> "(JEITA) Test conditions Note." Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "(JEITA)|fffd|O|fffd||241||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd|"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                        Exit For
                    End If
                End If
            Next i
        End If
        
        If Cells(Line, 1) = "Estimated Failure Rate" Then
            Offset = 49
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            i = InStr(Cells(Line + 2, 1), " ")
            If i > 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Left(Cells(Line + 2, 1), i - 1)
        End If
                
        If Cells(Line, 1) = "Electrostatic Discharge Test" Then
            Offset = 50
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Mid(Cells(Line + 1, 1), 19, Len(Cells(Line + 1, 1)) - 18)
            For i = 1 To 30
                If Cells(Line + i, 1) = "Protective Measures for Static Electricity" Then Exit For
            Next i
            If i < 29 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd||fffd||fffd||4ce||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            If i > 28 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd||fffd||fffd||4ce||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
        If Cells(Line, 1) = "Latch-up test" Then
            Offset = 51
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Cells(Line + 2, 1)
            If Cells(Line + 4, 1) <> "This product cannot occur latch-up phenomenon, therefore" And _
                Len(Cells(Line + 1, 1)) > 5 Then
                i = InStr(Cells(Line + 1, 1), "product")
                If i > 0 Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Mid(Cells(Line + 1, 1), i + 8, Len(Cells(Line + 1, 1)) - i - 7)
                End If
            End If
        End If
    Next Line
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Offset = Range(Cells(Top, 1), Cells(Top, 1)).End(xlDown).Row
    
    Cells(Top, 3) = "|fffd|n|fffd|j"
    Cells(Top, 5) = "|fffd|n|fffd|j"
    i = 1
    For Line = Top + 1 To Offset
        If Cells(Line, 3) <> Empty Then
            TempString = Cells(Line, 3)
            For k = 1 To 10
                j = InStr(TempString, vbCr)
                If j > 0 Then
                    If Left(TempString, j - 1) < i Then Cells(Top, 3) = "|fffd|m|fffd|f"
                    TempString = Mid(TempString, j + 1, Len(TempString) - j)
                Else
                    If Val(TempString) < i Then Cells(Top, 3) = "|fffd|m|fffd|f"
                    Exit For
                End If
            Next k
        End If
        
        If InStr(Cells(Line, 2), "|fffd||fffd|") > 0 And Cells(Line, 3) = Empty Then
            Cells(Line, 5) = "|fffd|m|fffd|f"
            Cells(Top, 5) = "|fffd|m|fffd|f"
        End If
    Next Line
    
    ' |fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    TempLine = 0
    Call MultiItems(Cells(Top - 1, 6), Top, Offset, 6, TempLine)
    Cells(Top, 6) = "|fffd|n|fffd|j"
    If TempLine = 1 Then Cells(Top, 6) = "|fffd|m|fffd|f"
    
    ' |fffd|p|fffd|b|fffd|P|fffd|[|fffd|W|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    TempLine = 0
    Call MultiItems(Cells(Top - 1, 7), Top, Offset, 7, TempLine)
    Cells(Top, 7) = "|fffd|n|fffd|j"
    If TempLine = 1 Then Cells(Top, 7) = "|fffd|m|fffd|f"
    
    
    ' |fffd|s|fffd|v|fffd||20d|s|fffd||314||fffd|\|fffd||fffd|
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
        
    |fffd|\|fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 7)
    |fffd|{|fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11)
    
    ' |fffd|\|fffd|a|fffd|p
    If |fffd|\|fffd|a|fffd|p = 1 Then
        Rows(Top + 1).Hidden = True
        Rows(Top + 2).Hidden = True
        Rows(Top + 3).Hidden = True
    End If
    If |fffd|\|fffd|a|fffd|p = 2 Then
        Rows(Top + 4).Hidden = True
        Rows(Top + 5).Hidden = True
        Rows(Top + 6).Hidden = True
    End If
    
    ' |fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||394||fffd|\|fffd||fffd||fffd||fffd|
    If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(44, 5) = Empty Then
        For Offset = 29 To 34
            Rows(Top + Offset).Hidden = True
        Next Offset
        For Offset = 41 To 46
            Rows(Top + Offset).Hidden = True
        Next Offset
    End If
    
    For Line = Top + 7 To 300
        If |fffd|{|fffd|a|fffd|p = 1 And Left(Cells(Line, 1), 1) = "|fffd|p" Then Rows(Line).Hidden = True
        If |fffd|{|fffd|a|fffd|p = 2 And Left(Cells(Line, 1), 1) = "|fffd|a" Then Rows(Line).Hidden = True
        If Left(Cells(Line, 2), 1) = "|fffd||fffd|" Then Rows(Line).Hidden = True
        If Cells(Line, 1) = Empty Then Exit For
    Next Line

End Sub
Private Sub PageCheck(EndPDF As Integer)
Dim Top As Integer, Offset As Integer, Line As Integer, TLine As Integer, Page As Integer, |fffd|aPage As Integer
Dim |fffd|a|fffd|p As Integer, EndTD As Integer, EndM As Integer
Dim i As Integer
Dim Temp As String

    Page = 9999

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For Line = 1 To 300
        If Cells(Line, 1) = "|fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    Top = Line + 1

    |fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11)
    Worksheets("PDF_Spec").Activate
    For Line = 1 To EndPDF
        If |fffd|a|fffd|p > 1 Then
            If Cells(Line, 1) = "RESTRICTIONS ON PRODUCT USE" Then Exit For
        Else
            If Cells(Line, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Exit For
        End If
    Next Line
    EndTD = Line
    
    ' |fffd|a|fffd|p|fffd||1c2||fffd||fffd||70a9||fffd||30d||14c||331f||fffd||fffd||fffd||fffd||fffd||fffd|TD|fffd||fffd||fffd|iEndTD)|fffd||702||fffd|
    ' |fffd||fffd||fffd||30d|s|fffd||fffd||fffd||fffd||fffd||fffd|
    Offset = 0
    For Line = EndPDF To EndTD Step -1
        Temp = Cells(Line, 1)
        i = InStr(Cells(Line, 1), " ")
        If i > 1 Then Temp = Left(Cells(Line, 1), i - 1)
        If Right(Temp, 1) = "*" Then
            i = InStr(Cells(Line, 1), "*")
            If i > 1 Then Cells(Line, 2) = Left(Cells(Line, 1), i - 1)
            If ISNUMBER(Cells(Line, 2)) = 1 Then
                If Cells(Line, 2) < 999 Then
                    Page = Cells(Line, 2)
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Page
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                    If |fffd|a|fffd|p > 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 4) = Line
                    If |fffd|a|fffd|p = 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 3) = Line
                    Exit For
                End If
            End If
        End If
    Next Line
    
    If Line < EndTD Then
        For Line = EndPDF To EndTD Step -1
            i = InStr(Cells(Line, 1), "* ")
            If i > 0 Then
                Cells(Line, 2) = Left(Cells(Line, 1), i - 1)
                If IsNumeric(Cells(Line, 2)) Then
                    If Cells(Line, 2) < 999 Then
                        Page = Cells(Line, 2)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Page
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                        If |fffd|a|fffd|p > 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 4) = Line
                        If |fffd|a|fffd|p = 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 3) = Line
                        Exit For
                    End If
                End If
            End If
        Next Line
    End If
    If Page <> 9999 Then Offset = Offset + 1
    
    '
    TLine = Line
    If TLine < EndTD Then
        i = InStr(Cells(Line, 4), "*")
        If i > 0 Then Cells(Line, 4) = Left(Cells(Line, 4), i - 1)
        Page = Cells(Line, 4)
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Page
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        If |fffd|a|fffd|p > 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 4) = Line
        If |fffd|a|fffd|p = 1 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 3) = Line
    End If
    
    EndM = 1
    If |fffd|a|fffd|p = 3 Then
        ' |fffd|a|fffd||30d||14c||331f||fffd||fffd|
        For Line = EndTD To 1 Step -1
            If Right(Cells(Line, 1), 1) = "*" Then
                If i > 1 Then Cells(Line, 2) = Left(Cells(Line, 1), Len(Cells(Line, 1)) - 1)
                If ISNUMBER(Cells(Line, 2)) = 1 Then
                    If Cells(Line, 2) < 500 Then
                        EndM = Line
                        |fffd|aPage = Cells(Line, 2)  ' |fffd|a|fffd||30d||14f|I|fffd|y|fffd|[|fffd|W
                        Exit For
                    End If
                End If
            End If
        Next Line

       If Line < 2 Then  ' |fffd|a|fffd||30d||14c||30aa||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||315||282||20c||fffd||fffd||fffd|
            For Line = EndTD To 1 Step -1
                i = InStr(Cells(Line, 1), "* ")
                If i > 0 Then
                    Cells(Line, 2) = Left(Cells(Line, 1), i - 1)
                    If ISNUMBER(Cells(Line, 2)) = 1 Then
                        EndM = Line
                        |fffd|aPage = Cells(Line, 2)
                        Exit For
                    End If
                End If
            Next Line
        End If
    End If

    ' |fffd||14c||fffd||303|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd|TD|fffd||30d||14c||fffd||702||fffd|
    For Line = TLine To EndTD Step -1
        Cells(Line, 8) = Cells(Line, 1).NumberFormatLocal
        If IsDate(Cells(Line, 1)) Then
            Cells(Line, 4) = DateValue(Cells(Line, 1))
            Cells(Line, 4).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
            If Cells(Line, 4) + 2 > Page And Cells(Line, 4) < Page Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Cells(Line, 4)
                Page = Cells(Line, 4)
                Offset = Offset + 1
            End If
        End If
        If ISNUMBER(Cells(Line, 1)) = 1 Then
            Cells(Line, 4) = Cells(Line, 1)
            If Cells(Line, 4) < Page And Cells(Line, 4) + 2 > Page And Cells(Line, 4) > 0 And Cells(Line, 4) = Int(Cells(Line, 4)) Then
                Cells(Line, 4).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Cells(Line, 1)
                Page = Cells(Line, 4)
                Offset = Offset + 1
            End If
        End If
    Next Line
    
    ' TD|fffd||fffd|
    For Line = EndTD + 4 To EndM Step -1
        If Cells(Line, 3) = "Page" Or Cells(Line, 3) = "TY2" Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Cells(Line, 4)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "TD"
            Offset = Offset + 1
        End If
    Next Line
    
    If |fffd|a|fffd|p = 3 Then
        For Line = EndM To 2 Step -1
            If Cells(Line, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Exit For
        Next Line
        EndTD = Line
        
        Page = |fffd|aPage
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = |fffd|aPage
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = EndM
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top - 1, 3) = EndM
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd|a"
                
        Offset = Offset + 1
    
        For Line = EndM To EndTD Step -1
            Cells(Line, 8) = Cells(Line, 1).NumberFormatLocal
            If IsDate(Cells(Line, 1)) Then
                Cells(Line, 4) = DateValue(Cells(Line, 1))
                Cells(Line, 4).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
                If Cells(Line, 4) + 2 > Page And Cells(Line, 4) < Page Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Cells(Line, 4)
                    Page = Cells(Line, 4)
                    Offset = Offset + 1
                End If
            End If
            If IsNumeric(Cells(Line, 1)) Then
                Cells(Line, 4) = Cells(Line, 1)
                If Cells(Line, 4) < Page And Cells(Line, 4) + 2 > Page And Cells(Line, 4) > 0 And Cells(Line, 4) = Int(Cells(Line, 4)) Then
                    Cells(Line, 4).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Cells(Line, 1)
                    Page = Cells(Line, 4)
                    Offset = Offset + 1
                End If
            End If
        Next Line
        
        ' TD|fffd||fffd|
        For Line = EndTD To 1 Step -1
            If Cells(Line, 3) = "Page" Or Cells(Line, 3) = "TY2" Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Cells(Line, 4)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "TD"
                Offset = Offset + 1
            End If
        Next Line
    End If
    
    ' |fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Page = Cells(Top, 2)
    Cells(Top, 5) = "|fffd|n|fffd|j"
    For Line = Top + 1 To 300
        If Cells(Line, 2) <> Empty Then
            If Cells(Line, 2) = Page - 1 Then
                Page = Page - 1
            Else
                If |fffd|a|fffd|p = 3 And Cells(Line, 4) = "|fffd|a" Then
                    Page = Cells(Line, 2)
                Else
                    Cells(Top, 5) = "|fffd|m|fffd|f"
                    Cells(Line, 5) = Cells(Line - 1, 2) - Cells(Line, 2)
                    Page = Cells(Line, 2)
                End If
            End If
        Else
            Exit For
        End If
    Next Line
    If Page <> 1 Then
        Cells(Top, 5) = "|fffd|m|fffd|f"
        Cells(Line, 5) = "|fffd||14f|I|fffd|y|fffd|[|fffd|W" & Page
    End If

End Sub
Private Sub |fffd|\|fffd||fffd||fffd|p(EndPDF As Integer)
Dim i As Integer, j As Integer, k As Integer, Line As Integer
Dim Top As Integer, Offset As Integer
Dim CoverTop As Integer
Dim ODS As Integer

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For i = 2 To 300
        If Cells(i, 1) = "|fffd|p|fffd|\|fffd||fffd|" Then Exit For
    Next i
    Top = i
    Cells(i, 3) = "|fffd||2d7||fffd||fffd||fffd|"
    Cells(i, 4) = "|fffd|o|fffd|c|fffd|e"


'|fffd|[|fffd||fffd| |fffd|d |fffd|l |fffd||fffd|
    Worksheets("PDF_Spec").Activate
    
    ' |fffd||14f||fffd||fffd||30d|s
    For Line = 1 To 100
        If Cells(Line, 1) = "SPECIFICATION" Then Exit For
    Next Line
    CoverTop = Line
    If Line > 100 Then Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(100, 11) = "|fffd|p|fffd|d|fffd|l|fffd||fffd||fffd|\|fffd||fffd||fffd|s|fffd||fffd|"
    
    
    '|fffd|d|fffd|l|fffd||fffd||fffd||50d||fffd||fffd||193||fffd||fffd||4d6||fffd|
    
   ' |fffd|d|fffd|l|fffd||fffd||fffd||50d||fffd|
    Offset = 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    For Line = CoverTop To CoverTop + 50
        i = InStr(Cells(Line, 1), "Specification number :")
        If i > 0 Then
            i = InStr(Cells(Line, 1), ":")
            j = Len(Cells(Line, 1))
            Cells(Line, 2) = Mid(Cells(Line, 1), i + 2, j - i)
            Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(2, 5)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
            If Cells(Line, 2) = Cells(Line, 3) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            End If
        End If
    Next Line
        
   ' |fffd||fffd||fffd||4d6||fffd|
    Offset = 2
    ODS = 0
    For Line = CoverTop To CoverTop + 50
        If InStr(Cells(Line, 1), "ODS") Then
            ODS = 1
            Exit For
        End If
    Next Line
    
    If ODS = 0 Then
        For Line = CoverTop To CoverTop + 50
            If InStr(Cells(Line, 1), "This specification") > 0 Then
                Cells(Line + 1, 2) = Cells(Line + 1, 1)
                If Left(Cells(Line + 2, 1), 11) = "and TOSHIBA" Then
                    Cells(Line + 2, 2) = Cells(Line + 3, 1)
                Else
                    Cells(Line + 2, 2) = Cells(Line + 2, 1)
                End If
                Cells(Line + 1, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 11)
                Cells(Line + 2, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 11)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line + 1, 2)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line + 1, 3)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 4) = Cells(Line + 2, 2)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 3) = Cells(Line + 2, 3)
                If Cells(Line + 1, 2) <> Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 11) Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                End If
                If Cells(Line + 2, 2) <> Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 11) Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 5) = "|fffd|m|fffd|f"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 5) = "|fffd|n|fffd|j"
                End If
                Exit For
            End If
        Next Line
    Else
        For Line = 1 To 50
            If InStr(Cells(Line, 1), "TOSHIBA CORPORATION") > 0 Then
                Cells(Line - 1, 2) = Cells(Line - 1, 1)
                Cells(Line - 2, 2) = Cells(Line - 2, 1)
                Cells(Line - 1, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 11)
                Cells(Line - 2, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 11)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line - 1, 2)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line - 1, 3)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 4) = Cells(Line - 2, 2)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 3) = Cells(Line - 2, 3)
                If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                End If
                If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 4) Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 5) = "|fffd|n|fffd|j"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 5) = "|fffd|m|fffd|f"
                End If
                Exit For
            End If
                    
        Next Line
    End If
    
    '|fffd|i|fffd||fffd|
    Offset = 4
    For Line = CoverTop To CoverTop + 50
        If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(6, 5) <> Empty Then _
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(6, 5)
        If Left(Cells(Line, 1), 16) = "Product number :" Then
            i = InStr(Cells(Line, 1), ":")
            j = Len(Cells(Line, 1))
            Cells(Line, 2) = Mid(Cells(Line, 1), i + 2, j - i + 2)
            Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 5)
            If Left(Cells(Line + 1, 1), 4) <> "Your" And Len(Cells(Line, 3)) - j + 11 > 2 Then Cells(Line, 2) = Cells(Line, 2) & Cells(Line + 1, 1)
            If InStr(Cells(Line, 3), vbCr) Then
                Cells(Line, 3) = DelChr(Cells(Line, 3), vbCr)
                Cells(Line, 3) = DelChr(Cells(Line, 3), vbLf)
                Cells(Line, 3) = DelSpace(Cells(Line, 3))
                Cells(Line, 2) = DelSpace(Cells(Line, 2))
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
            If Cells(Line, 2) <> Cells(Line, 3) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            End If
            Exit For
        End If
    Next Line
    
    ' |fffd|M|fffd||415|i|fffd||fffd|
    '|fffd|M|fffd||415|i|fffd||517|v|fffd||fffd||fffd||202||fffd||fffd||30f||a347|_20171127_|fffd||fffd||fffd||fffd|
    Offset = 5
    If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11) = Empty Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = "|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
        
    For Line = CoverTop To CoverTop + 50
        If Left(Cells(Line, 1), 21) <> "Your product number :" Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
        Else
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                j = Len(Cells(Line, 1))
                Cells(Line, 2) = "'" + Mid(Cells(Line, 1), 23, j - 21)
                Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2).Value
        
        Exit For
            End If
        Next Line
        

'|fffd|M|fffd||415|i|fffd||517|L|fffd||fffd||30f||a347|_20171127_|fffd||fffd||fffd||fffd|
    If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11) <> Empty Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11)
            For Line = CoverTop To CoverTop + 50
            If Left(Cells(Line, 1), 21) = "Your product number :" Then
                j = Len(Cells(Line, 1))
                    Cells(Line, 2) = "'" + Mid(Cells(Line, 1), 23, j - 21)
                        Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11)

                For j = 1 To 10
                    i = InStr(Cells(Line, 3), vbCr)
                    If i > 0 Then
                        Cells(Line, 3 + j) = DelSpace(Left(Cells(Line, 3), i - 1))
                        Cells(Line, 3) = Mid(Cells(Line, 3), i + 2, Len(Cells(Line, 3)) - i - 1)
                        If Cells(Line, 3) = Cells(Line, 3 + j) Then Exit For
                    Else
                        Exit For
                    End If
                Next j

                k = j
                Cells(Line, 3 + j) = Cells(Line, 3)
                Cells(Line, 3 + j) = DelSpace(Cells(Line, 3 + j))
                
                If k > 2 Then
                    Cells(Line, 3) = Cells(Line, 4)
                    For j = 2 To k
                        If Cells(Line, j + 2) <> Cells(Line, j + 3) Then
                            Cells(Line, 3) = Cells(Line, 3) & Cells(Line, j + 3)
                        End If
                    Next j
                End If
                
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
                If Cells(Line, 2) <> Cells(Line, 3) Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                End If
                Exit For



End If
Next Line
End If
If Line = 52 And Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11) <> Empty Then
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
End If

    
    'ODS
    
    
    
    ' |fffd||fffd||fffd|t
    Offset = 7
    For Line = CoverTop To CoverTop + 50
        If Left(Cells(Line, 1), 6) = "Date :" Then
            Cells(Line, 2) = Mid(Cells(Line, 1), 7, Len(Cells(Line, 1)) - 6)
            If Left(Cells(Line, 2), 1) = " " Then
                Cells(Line, 2) = Mid(Cells(Line, 2), 2, Len(Cells(Line, 2)) - 1)
            End If
            Cells(Line, 2).NumberFormatLocal = "yyyy/mm/dd"
            Cells(Line, 3).Formula = "=TODAY()"
            If Weekday(Cells(Line, 3)) < 4 Then Cells(Line, 3) = Cells(Line, 3) - 2
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
            If Cells(Line, 2) < Cells(Line, 3) - 3 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            End If
            Exit For
        End If
    Next Line
    
    ' |fffd||fffd||fffd||416||fffd|  20170707_|fffd|V|fffd||416||fffd||fffd||389||fffd|_|fffd||fffd||fffd||fffd||fffd|L
    Offset = 8
    For Line = CoverTop To CoverTop + 50
        If Cells(Line, 1) = "TOSHIBA ELECTRONIC DEVICES &" Then
            If Cells(Line + 1, 1) = "STORAGE CORPORATION" Then
                Cells(Line, 2) = Cells(Line, 1) & " " & Cells(Line + 1, 1)
                Cells(Line, 3) = "TOSHIBA ELECTRONIC DEVICES & STORAGE CORPORATION"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            
            End If
'            Else
'                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            
            Exit For
        End If
    Next Line
                If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "" Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = "TOSHIBA ELECTRONIC DEVICES & STORAGE CORPORATION"
                End If
            
End Sub
Private Sub |fffd|\|fffd||fffd||fffd|a(EndPDF As Integer)
Dim i As Integer, j As Integer, k As Integer, Line As Integer
Dim Top As Integer, Offset As Integer
Dim CoverTop As Integer
Dim Er As Integer, Ex As String, Ey As String, TempString As String

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For i = 2 To 300
        If Cells(i, 1) = "|fffd|a|fffd|\|fffd||fffd|" Then Exit For
    Next i
    Top = i
    Cells(i, 3) = "|fffd||2d7||fffd||fffd||fffd|"
    Cells(i, 4) = "|fffd|o|fffd|c|fffd|e"
    

'|fffd|[|fffd||fffd| |fffd|d |fffd|l |fffd||fffd|
    Worksheets("PDF_Spec").Activate
    
    ' |fffd||14f||fffd||fffd||30d|s
    For Line = 1 To 100
        If Cells(Line, 1) = "|fffd|[|fffd||fffd| |fffd|d |fffd|l |fffd||fffd|" Or Cells(Line, 1) = "|fffd|[ |fffd||fffd| |fffd|d |fffd|l |fffd||fffd|" Then
'            If Line > 99 Then Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(100, 1) = "|fffd|a|fffd|d|fffd|l|fffd||fffd||fffd|\|fffd||fffd||fffd|s|fffd||fffd|"
            Exit For
        End If
    Next Line
    
    CoverTop = Int(Line / 15) + 1   ' |fffd|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|s|fffd||fffd||fffd||fffd||fffd||4d6||fffd||fffd||30c||fffd||242||202||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|p|fffd||fffd||fffd||156||fffd||fffd||fffd||fffd||a347||fffd||342|P|fffd|s|fffd||682||fffd||fffd||fffd||242||fffd||fffd||fffd|B
    
   ' |fffd|d|fffd|l|fffd||fffd||fffd||50d||fffd|
    Offset = 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    For Line = CoverTop To CoverTop + 50
        i = InStr(Cells(Line, 1), "|fffd|d|fffd|l|fffd||fffd||fffd||50d||fffd|")
        If i > 0 Then
            j = Len(Cells(Line, 1))
            Cells(Line, 2) = Mid(Cells(Line, 1), i + 6, j - i - 5)
            Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(2, 5)
            Cells(Line, 3) = DelSpace(Cells(Line, 3))
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            If Cells(Line, 2) = Cells(Line, 3) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            End If
            Exit For
        End If
    Next Line
        
        
   ' |fffd||fffd||fffd||4d6||fffd|
    Offset = 2
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    For Line = CoverTop To CoverTop + 50
        i = InStr(Cells(Line, 1), "|fffd||4486|")
        If i > 0 Then
            ' |fffd||4486||fffd||30d||d3dc|
            Cells(Line, 2) = Left(Cells(Line, 1), i - 1)
            ' |fffd|X|fffd|y|fffd|[|fffd|X|fffd||30d||d3dc|
            Cells(Line, 2) = DelSpace(Cells(Line, 2))
            Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 5)
            If InStr(Cells(Line, 3), "(|fffd||fffd|)") > 0 Then Cells(Line, 3) = Replace(Cells(Line, 3), "(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            If InStr(Cells(Line, 3), "|fffd|i|fffd||fffd||fffd|j") > 0 Then Cells(Line, 3) = Replace(Cells(Line, 3), "|fffd|i|fffd||fffd||fffd|j", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            Cells(Line, 3) = DelSpace(Cells(Line, 3))
            i = Len(Cells(Line, 2))
            j = Len(Cells(Line, 3))
            If i + 2 < j Then
                Cells(Line, 2) = Cells(Line - 1, 1) & Cells(Line, 2)
                Cells(Line, 2) = DelSpace(Cells(Line, 2))
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            If Cells(Line, 2) = Cells(Line, 3) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            End If
            Exit For
        End If
    Next Line
    
    '|fffd|i|fffd||fffd|
    Offset = 3
    For Line = CoverTop To CoverTop + 50
        If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(6, 5) <> Empty Then _
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(6, 5)
        If Left(Cells(Line, 1), 4) = "|fffd|i |fffd||fffd||fffd|F" Then
            j = Len(Cells(Line, 1))
            Cells(Line, 2) = Mid(Cells(Line, 1), 6, j - 4)
            Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 5)
            If InStr(Cells(Line, 3), vbCr) Then
                Cells(Line, 3) = DelChr(Cells(Line, 3), vbCr)
                Cells(Line, 3) = DelChr(Cells(Line, 3), vbLf)
                Cells(Line, 3) = DelSpace(Cells(Line, 3))
                Cells(Line, 2) = DelSpace(Cells(Line, 2))
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            If Cells(Line, 2) <> Cells(Line, 3) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            End If
            Exit For
        End If
    Next Line
    
    
    
'|fffd|M|fffd||415|i|fffd||fffd|
'|fffd|M|fffd||415|i|fffd||517|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347|_20171121_|fffd||fffd||fffd||fffd|

    Offset = 4
        If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11) = Empty Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = "|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
    
        For Line = CoverTop To CoverTop + 50
            If Left(Cells(Line, 1), 5) <> "|fffd|M|fffd||415|i|fffd||501|F" Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                    j = Len(Cells(Line, 1))
                    Cells(Line, 2) = "'" + Mid(Cells(Line, 1), 7, j - 5)
                    Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11)
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2).Value
                    
        Exit For
            End If
        Next Line
            
'|fffd|M|fffd||415|i|fffd||517|v|fffd||fffd||fffd|L|fffd||fffd||30f||a347|_20171121_|fffd||fffd||fffd||fffd|
        If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11) <> Empty Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11)
            For Line = CoverTop To CoverTop + 50
            If Left(Cells(Line, 1), 5) = "|fffd|M|fffd||415|i|fffd||501|F" Then
                j = Len(Cells(Line, 1))
                    Cells(Line, 2) = "'" + Mid(Cells(Line, 1), 7, j - 5)
                        Cells(Line, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11)
            
                For j = 1 To 10
                    i = InStr(Cells(Line, 3), vbCr)
                    If i > 0 Then
                        Cells(Line, 3 + j) = DelSpace(Left(Cells(Line, 3), i - 1))
                        Cells(Line, 3) = Mid(Cells(Line, 3), i + 2, Len(Cells(Line, 3)) - i - 1)
                        If Cells(Line, 3) = Cells(Line, 3 + j) Then Exit For
                    Else
                        Exit For
                    End If
                Next j

                k = j
                Cells(Line, 3 + j) = Cells(Line, 3)
                Cells(Line, 3 + j) = DelSpace(Cells(Line, 3 + j))
                
                If k > 2 Then
                    Cells(Line, 3) = Cells(Line, 4)
                    For j = 2 To k
                        If Cells(Line, j + 2) <> Cells(Line, j + 3) Then
                            Cells(Line, 3) = Cells(Line, 3) & Cells(Line, j + 3)
                        End If
                    Next j
                End If
                
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 3)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
                If Cells(Line, 2) <> Cells(Line, 3) Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                End If
                Exit For



End If
Next Line
End If
If Line = 52 And Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 11) <> Empty Then
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
End If



    
    ' |fffd|n|fffd|c|fffd|r
    Offset = 5
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(8, 5)
    If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(8, 5) <> "|fffd||fffd||fffd|K|fffd|v" Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
        For Line = CoverTop To CoverTop + 50
            If Left(Cells(Line, 1), 16) = "|fffd||10d||fffd||fffd||fffd|C|fffd||89ed6|@|fffd||24a||fffd||c2||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|K|fffd||fffd|" Then
                TempString = Worksheets("TEMPSPEC").Cells(35, 1).Value
                i = Line
                Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
                If Er = 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                Exit For
            End If
        Next Line
    Else
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = "|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
    
    ' |fffd||fffd||fffd|t
    Offset = 6
    For Line = CoverTop To CoverTop + 50
        If Left(Cells(Line, 1), 3) = "|fffd||fffd||fffd|s|fffd||fffd|" Then
            i = Len(Cells(Line, 1))
            
''            j = InStr(Cells(Line, 1), "|fffd||fffd||fffd||fffd|")
            j = InStr(Cells(Line, 1), "|fffd||fffd||fffd|s|fffd||fffd|")
            
            If i = 0 Or j = 0 Then GoTo Errdate

''            Cells(Line, 2) = Mid(Cells(Line, 1), j, i - j + 1)
            Cells(Line, 2) = Mid(Cells(Line, 1), j + 4, i - j + 1)

            i = Len(Cells(Line, 2))
            j = InStr(Cells(Line, 2), "|fffd|N")
            If i = 0 Or j = 0 Then GoTo Errdate

''            Cells(Line, 3) = Mid(Cells(Line, 2), 3, j - 3) + 1988
            Cells(Line, 3) = Mid(Cells(Line, 2), 1, j - 2)

            i = j
            j = InStr(Cells(Line, 2), "|fffd||fffd|")
            Cells(Line, 4) = Mid(Cells(Line, 2), i + 1, j - i - 1)
            i = j
            j = InStr(Cells(Line, 2), "|fffd||fffd|")
            If i = 0 Or j = 0 Then GoTo Errdate
            Cells(Line, 5) = Mid(Cells(Line, 2), i + 1, j - i - 1)
            Cells(Line, 6).Formula = "=DATE(C" & Line & ",D" & Line & ",E" & Line & ")"
            Cells(Line, 7).Formula = "=TODAY()"
            If Weekday(Cells(Line, 7)) < 4 Then Cells(Line, 7) = Cells(Line, 7) - 2
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 6)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Cells(Line, 7)
            If Cells(Line, 7) - 3 < Cells(Line, 6) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
Errdate:
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            End If
            Exit For
        End If
    Next Line
    
    ' |fffd||416||fffd| 20170707_|fffd|V|fffd||416||fffd||fffd||389||fffd|_|fffd||fffd||fffd||fffd||fffd|L
    Offset = 7
    For Line = CoverTop To CoverTop + 50

            If Cells(Line, 1) <> "|fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd||143|f|fffd|o|fffd|C|fffd|X|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then

                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Else
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Right(Cells(Line, 1), 16)
            Exit For
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Line
        End If
    Next Line
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = "|fffd||fffd||fffd||143|f|fffd|o|fffd|C|fffd|X|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    
    
    For i = 1 To 300
        If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1) = "|fffd|a |fffd|\|fffd||fffd|" Then Exit For
    Next i
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 3) = Line

    ' |fffd||fffd||308||fffd|@|fffd||208||fffd|
    Offset = 8
    For Line = CoverTop To CoverTop + 50
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
        If Left(Cells(Line, 1), 21) = "|fffd||fffd| |fffd||fffd|o|fffd||fffd||fffd||112||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||242||82||fffd||fffd||702||fffd||fffd||102||fffd|" Then
            i = Line
            TempString = Worksheets("TEMPSPEC").Cells(35, 2)
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Exit For
        End If
    Next Line
 
End Sub
Private Sub TD(EndPDF As Integer, |fffd|a|fffd|p As Integer)
Dim Line As Integer, SLine As Integer, TLine As Integer, EndTD As Integer
Dim Top As Integer, Offset As Integer
Dim TempDate As Date, FType As Integer, Cnt As Integer
Dim PName As String, TDname As String, PKG As String, HOff As Integer, POff As Integer
Dim i As Integer, j As Integer, k As Integer, Page As Integer, PType As Integer, n As Integer
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    SLine = 1
    For Line = 1 To 300
        If Cells(Line, 1) = "|fffd|a |fffd|\|fffd||fffd|" And Cells(Line, 3) <> Empty Then SLine = Cells(Line, 3)
        If |fffd|a|fffd|p = 1 And Cells(Line, 1) = "|fffd|a|fffd|s|fffd|c" Then Exit For
        If |fffd|a|fffd|p = 2 And Cells(Line, 1) = "|fffd|p|fffd|s|fffd|c" Then Exit For
    Next Line
    Top = Line
    Cells(Top, 3) = "|fffd||2d7||fffd||fffd||fffd|"
    Cells(Top, 4) = "|fffd|o|fffd|c|fffd|e"

    Worksheets("PDF_Spec").Activate
    If |fffd|a|fffd|p = 2 Then
        For Line = 1 To EndPDF
            If Cells(Line, 1) = "RESTRICTIONS ON PRODUCT USE" Then Exit For
        Next Line
        EndTD = Cells(Line + 1, 2).End(xlDown).Row
        
        ' |fffd|{|fffd||fffd||fffd|a|fffd|p|fffd||30f||a347||fffd|a|fffd||fffd||fffd||30d||14c||fffd|
        For Line = EndTD To 1 Step -1
            If Right(Cells(Line, 1), 1) = "*" Then
                Cells(Line, 2) = Left(Cells(Line, 1), Len(Cells(Line, 1)) - 1)
                If ISNUMBER(Cells(Line, 2)) = 1 Then
                    SLine = Line
                    Exit For
                End If
            End If
        Next Line
    End If
    
    If |fffd|a|fffd|p = 1 Then
        For Line = 1 To EndPDF
            If Cells(Line, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Exit For
        Next Line
        If Line > EndPDF Then
            For Line = 1 To EndPDF
                i = InStr(Cells(Line, 1), "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|")
                If i = 2 Then
                    Cells(Line, 1) = Mid(Cells(Line, 1), 2, Len(Cells(Line, 1)) - 1)
                    For j = 10 To 100
                        If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 1) = "|fffd|m|fffd|f|fffd||fffd||fffd||fffd|" Then
                            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 3) = "|fffd||fffd||fffd||4d5||fffd||fffd||fffd||fffd||301|u|fffd||6235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2||fffd|v|fffd||311|O|fffd||255|s|fffd|v|fffd||215||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                            Exit For
                        End If
                    Next j
                    Exit For
                End If
            Next Line
        End If
        
        EndTD = Cells(Line + 1, 2).End(xlDown).Row
    End If
    
    FType = 0
    ' |fffd|t|fffd|b|fffd|^|fffd||fffd||fffd|t
    ' FType=1 ->|fffd||fffd||fffd|t|fffd||302||741|@|fffd|@FType=2 -> |fffd|y|fffd|[|fffd|W|fffd||193||fffd||fffd|t|fffd||311|g|fffd||fffd||fffd||fffd|
    For Line = EndTD + 1 To SLine Step -1
        If IsDate(Cells(Line, 1)) Then
            Cells(Line, 2) = Cells(Line, 1)
            Cells(Line, 2).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
            If Cells(Line, 2) > 25500 And (InStr(Cells(Line, 1), "/") > 0 Or InStr(Cells(Line, 1), "-") > 0) Then
                FType = 1
                TempDate = Cells(Line, 1)
                Cells(Line, 3) = "TY1"
                TLine = Line + 1
                Exit For
            End If
        End If
    Next Line
    
    'FType=1 |fffd||202||74ef||fffd||fffd||fffd||fffd||fffd|t|fffd||30d|s|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If FType = 1 Then
        For Line = TLine To SLine Step -1
            If IsDate(Cells(Line, 1)) Then
                If Cells(Line, 1) = TempDate Then
                    Cells(Line, 2) = Cells(Line, 2)
                    Cells(Line, 3) = "TY1"
                    Cnt = Cnt + 1
                End If
            End If
        Next Line
        If Cnt < 2 Then FType = 0
    End If
    
    If FType <> 1 Or Cnt < 2 Then
        For Line = EndTD To SLine Step -1
            i = InStr(Cells(Line, 1), " ")
            If i > 0 And IsDate(Mid(Cells(Line, 1), i + 1, Len(Cells(Line, 1)) - i)) Then
                Cells(Line, 2) = Right(Cells(Line, 1), 10)
                Cells(Line, 4) = Left(Cells(Line, 1), i - 1)
                If IsDate(Cells(Line, 2)) And ISNUMBER(Cells(Line, 4)) = 1 Then
                    FType = 2
                    TempDate = Cells(Line, 2)
                    Cells(Line, 3) = "TY2"
                    TLine = Line - 1
                    Cells(Line, 4) = Left(Cells(Line, 1), i - 1)
                    Cnt = Cnt + 1
                    If Right(Cells(Line, 4), 1) = "*" Then
                        Cells(Line, 5) = Cells(Line, 4)
                        Cells(Line, 4) = Left(Cells(Line, 4), Len(Cells(Line, 4)) - 1)
                    End If
'                    If ISNUMBER(Cells(Line, 4)) = 0 Then Cells(Line, 3) = ""
                    Exit For
                End If
            End If
        Next Line
    End If
    
    If FType = 2 Then
        For Line = TLine To SLine Step -1
            i = InStr(Cells(Line, 1), " ")
            If i > 0 And Mid(Cells(Line, 1), i + 1, Len(Cells(Line, 1)) - i) = TempDate Then
                If Right(Cells(Line, 1), 10) = TempDate Then
                    Cells(Line, 2) = Right(Cells(Line, 1), 10)
                    If IsDate(Cells(Line, 2)) Then
                        Cells(Line, 3) = "TY2"
                        Cells(Line, 4) = Left(Cells(Line, 1), i - 1)
                        Cnt = Cnt + 1
                    End If
                End If
            End If
        Next Line
    End If
EXF:
    If Cnt > 2 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 2, 4) = TempDate
    End If
    
    
    ' |fffd|w|fffd|b|fffd|_|fffd|i|fffd||fffd|
    PName = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 5)
    i = InStr(PName, vbCr)
    If i > 0 Then PName = Mid(PName, 1, i - 1)
    i = InStr(PName, ",")
    If i > 0 Then PName = Mid(PName, 1, i - 1)
    i = InStr(PName, "(")
    If i > 0 Then PName = Mid(PName, 1, i - 1)
    i = InStr(PName, "-")
    If i > 0 Then PName = Mid(PName, 1, i - 1)
    
    
    Cnt = 0
    TDname = PName
    For Line = EndTD To SLine + 2 Step -1
        If Left(Cells(Line, 3), 2) = "TY" Then
            For Offset = -1 To 4
                If Left(Cells(Line + Offset, 1), 4) = Left(PName, 4) Then
                    TDname = Cells(Line + Offset, 1)
                    Cells(Line + Offset, 3) = "HD"
                    HOff = Offset
                    GoTo CTN
                End If
            Next Offset
        End If
    Next Line
CTN:
    TLine = Line - 1
    Cnt = 0
    For Line = TLine - 1 To SLine + 2 Step -1
        If Cells(Line, 1) = TDname Then
            Cells(Line, 3) = "HD"
            Cnt = Cnt + 1
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 1, 4) = TDname
        End If
    Next Line
    
    ' TY1|fffd||303|y|fffd|[|fffd|W
    POff = 0
    CTN = 0
    PType = 0
    n = 0
    If FType = 1 Then
        For Line = EndTD - 10 To SLine + 2 Step -1
            For n = 0 To 1
                If Cells(Line, 3) = "TY1" And POff = 0 Then
                    For i = -2 To 4
                        If ISNUMBER(Cells(Line + i, 1)) = 1 Then
                            If Cells(Line + i, 1) < 1000 And Cells(Line + i, 1) = Int(Cells(Line + i, 1)) Then
                                Cells(Line + i, 3) = "Page"
                                Cells(Line + i, 2) = Cells(Line + i, 1)
                                Cells(Line + i, 4) = Cells(Line + i, 1)
                                Page = Cells(Line + i, 1)
                                POff = i
                                For k = -3 To 3
                                    If Cells(Line + i + k, 3) = "HD" Then
                                        HOff = k
                                        Exit For
                                    End If
                                Next k
                                TLine = Line - 1
                                Cnt = Cnt + 1
                                Exit For
                            End If
                        End If
                    Next i
                    If POff = 0 Then
                        For i = -2 To 4
                            j = InStr(Cells(Line + i, 1), "Corporation")
                            If j > 0 And j < Len(Cells(Line + i, 1)) - 11 Then
                                Cells(Line + i, 2) = Mid(Cells(Line + i, 1), j + 12, Len(Cells(Line + i, 1)) - j - 11)
                                If ISNUMBER(Cells(Line + i, 2)) = 1 Then
                                    Cells(Line + i, 3) = "Page"
                                    Cells(Line + i, 4) = Cells(Line + i, 2)
                                    Page = Cells(Line + i, 2)
                                    POff = i
                                    PType = 1
                                    TLine = Line - 1
                                    Cnt = Cnt + 1
                                    Exit For
                                End If
                            End If
                        Next i
                    End If
                End If
                If CTN > 0 Then Exit For
            Next n
        Next Line
        
        
        For Line = TLine To SLine + 2 Step -1
            If Cells(Line, 3) = "TY1" And POff <> 0 Then
                If PType = 0 Then
                    If ISNUMBER(Cells(Line + POff, 1)) = 1 Then
                        If Cells(Line + POff, 1) = Page - 1 Then
                            Cells(Line + POff, 2) = Cells(Line + POff, 1)
                            Cells(Line + POff, 3) = "Page"
                            Cells(Line + POff, 4) = Cells(Line + POff, 2)
                            Page = Cells(Line + POff, 2)
                        End If
                    End If
                Else
                    j = InStr(Cells(Line + POff, 1), "Corporation")
                    If j > 0 Then
                        Cells(Line + POff, 2) = Mid(Cells(Line + POff, 1), j + 12, Len(Cells(Line + POff, 1)) - j - 11)
                        If ISNUMBER(Cells(Line + POff, 2)) = 1 Then
                            If Cells(Line + POff, 2) = Page - 1 Then
                                Cells(Line + POff, 3) = "Page"
                                Cells(Line + POff, 4) = Cells(Line + POff, 2)
                                Page = Cells(Line + POff, 2)
                            End If
                        End If
                    End If
                End If
            End If
        Next Line
        
        If Page <> 1 Then
            For Line = SLine + 2 To EndTD
                If Cells(Line, 3) = "HD" Then
                    If Cells(Line - HOff, 3) <> "Page" And IsNumeric(Cells(Line - HOff, 1)) Then
                        Cells(Line - HOff, 3) = "Page"
                        Cells(Line - HOff, 2) = Cells(Line - HOff, 1)
                        Cells(Line - HOff, 4) = Cells(Line - HOff, 2)
                        Page = Cells(Line - HOff, 2)
                    End If
                End If
                If Cells(Line - HOff + 1, 3) = "Page" Then Exit For
            Next Line
        End If
        
    End If
    
    ' |fffd|p|fffd|b|fffd|P|fffd|[|fffd|W|fffd||fffd|
    PKG = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(19, 5)
    If PKG <> Empty Then
        For Line = SLine To EndTD
            i = InStr(Cells(Line, 1), PKG)
            If i > 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 3, 4) = Cells(Line, 1)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 3, 6) = Line
            End If
        Next Line
    End If
    For Line = SLine To EndTD
        If InStr(Cells(Line, 1), "|fffd||28f||316||fffd|") > 0 Or InStr(Cells(Line, 1), "Nickname") > 0 Then
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 3, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - i - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 3, 6) = Line
        End If
    Next Line
    
    ' |fffd||fffd||fffd||4d5||fffd||fffd||fffd||fffd||183|t|fffd|b|fffd|^|fffd||fffd||fffd|t|fffd|m|fffd|F
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    If Cells(Top + 2, 4) <> Empty Then
        Cells(Top + 2, 5) = "|fffd|n|fffd|j"
        If Cells(Top + 4, 4) = "Rev5" Then
            If Cells(Top + 2, 4) > "2012 / 4 / 25" Then Cells(Top + 2, 5) = "|fffd|m|fffd|f"
        End If
    End If

End Sub
Private Sub |fffd||fffd||fffd||4d5||fffd||fffd||fffd|(EndPDF As Integer, |fffd|a|fffd|p As Integer)
Dim TLine As Integer, Top As Long, Er As Integer
Dim i As Integer, j As Integer, Ly As Integer
Dim X As Integer, Y As Integer, Sx As String, Sy As String
Dim Lx As Integer, Tx As String, TD As Integer, Offset As Integer
Dim Px As Integer, Ex As String, Ey As String
Dim |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| As String

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    
    Offset = 4
    If |fffd|a|fffd|p = 1 Then Tx = "|fffd|a|fffd|s|fffd|c"
    If |fffd|a|fffd|p = 2 Then Tx = "|fffd|p|fffd|s|fffd|c"
    For i = 1 To 200
        If Cells(i, 1) = Tx Then Exit For
    Next i
    TD = i
    
    Worksheets("PDF_SPEC").Activate
    Ex = 0
    
    For TLine = 1 To EndPDF
        If |fffd|a|fffd|p = 1 And Cells(TLine, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Exit For
        If |fffd|a|fffd|p = 2 And Cells(TLine, 1) = "RESTRICTIONS ON PRODUCT USE" Then Exit For
    Next TLine
    Top = TLine
    If Top > EndPDF - 1 Then Ex = 9999
    
    
    'Rev11|fffd|`|fffd|F|fffd|b|fffd|N_20180131_|fffd||fffd||fffd||fffd||fffd||1cb|L|fffd|@|fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd|[|fffd|`|fffd||fffd||fffd||350|m|fffd||2d5||fffd|_|fffd||fffd||fffd||4d5||fffd||fffd||fffd||fffd||fffd|Private Sub|fffd||248||693||fffd|
    Dim Term As String
   
    SpecNo = 1
    
    For i = 1 To 10
        xNo = i * 200
            If Worksheets("TEMPSPEC").Cells(xNo + 2, 1).Value = "" Then
                    Exit For
            End If
    Next i
    i = i - 1
    If i >= 2 Then
        Term = "|fffd||fffd||fffd||fffd||fffd||30e|d|fffd|l|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||fffd|No|fffd||fffd||fffd||fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf
            For j = 1 To i
                tqq = Worksheets("TEMPSPEC").Cells(200 * j + 23, 2)
                tqq = Left(tqq, 15) & vbCrLf
                Term = Term & j & "." & Worksheets("TEMPSPEC").Cells(200 * j + 5, 2) & "|fffd||fffd||fffd||fffd|:" & tqq
            Next j
    
        SpecNo = InputBox(Term)
        End If
    
    xNo = SpecNo * 200

    Dim BU As String
        BU = Worksheets("TEMPSPEC").Cells(xNo + 11, 3).Value
            BU = Left$(BU, 3)
                
    
' Rev11 BU&GaAs |fffd|`|fffd|F|fffd|b|fffd|N_20180131_|fffd||fffd||fffd||fffd||fffd||1cb|L, 20180801_|fffd||797||1d4||fffd||fffd||fffd||3cd|X
    If BU = "X36" Then

        If |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 8)
        If |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 8)

            |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
                TLine = Top + 1
                Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
        If Er = 0 Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev12 GaAs"
            GoTo Judge
        End If
    
    Else
    
 ' Rev11&BU |fffd|`|fffd|F|fffd|b|fffd|N_20180131_|fffd||fffd||fffd||fffd||fffd||1cb|L, 20180801_|fffd||797||1d4||fffd||fffd||fffd||3cd|X
        If |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 7)
        If |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 7)

            |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
                TLine = Top + 1
                Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
        If Er = 0 Then
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev12"
            GoTo Judge
        End If
    
    End If
        
Judge:

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cells(TD + Offset, 7) = TLine

    If Er = 0 Then
        Cells(TD + Offset, 5) = "|fffd|n|fffd|j"
    Else
        Cells(TD + Offset, 3) = Ex
        Cells(TD + Offset, 4) = Ey
        Cells(TD + Offset, 5) = "|fffd|m|fffd|f"
    End If
    
End Sub
Private Sub |fffd||1c9||fffd||fffd|a(EndPDF As Integer)
Dim Line As Integer, Top As Integer, Offset As Integer
Dim i As Integer, LineSpamp As Integer
Dim TempString As String, TLine As Integer
Dim Er As Integer, Ex As String, Ey As String

Dim F|fffd||fffd||fffd||fffd| As Integer

    F|fffd||fffd||fffd||fffd| = 0

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For Line = 1 To 300
        If Cells(Line, 1) = "|fffd|a|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g" Then Exit For
    Next Line
    Top = Line
    Cells(Top, 3) = "|fffd||2d7||fffd||fffd||fffd|"
    Cells(Top, 4) = "|fffd|o|fffd|c|fffd|e"


    Offset = 1 '|fffd|p|fffd|r
    TempString = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(20, 11)
    i = InStr(TempString, vbCrLf)
    If i > 0 Then TempString = Left(TempString, i - 1)
    Cells(Top + Offset, 3) = TempString
    
    If Left(Cells(Top + Offset, 3), 2) = "|fffd|p|fffd|r" Then
        Cells(Top + Offset, 3) = Mid(Cells(Top + Offset, 3), 3, Len(Cells(Top + Offset, 3)) - 2)
        i = InStr(Cells(Top + Offset, 3), ":")
        If i > 0 Then
            Cells(Top + Offset, 3) = Mid(Cells(Top + Offset, 3), i + 1, Len(Cells(Top + Offset, 3)) - i)
        End If
        i = InStr(Cells(Top + Offset, 3), "|fffd|F")
        If i > 0 Then
            Cells(Top + Offset, 3) = Mid(Cells(Top + Offset, 3), i + 1, Len(Cells(Top + Offset, 3)) - i)
        End If
        If Left(Cells(Top + Offset, 3), 1) = " " Or Left(Cells(Top + Offset, 3), 1) = "|fffd|@" Then
            Cells(Top + Offset, 3) = Mid(Cells(Top + Offset, 3), 2, Len(Cells(Top + Offset, 3)) - 1)
        End If
    End If
    Offset = Offset + 1    ' |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(21, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(21, 11)
    Offset = Offset + 1    ' |fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(22, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(22, 11)
    Offset = Offset + 1    ' |fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(23, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(23, 11)
    Offset = Offset + 1    ' |fffd||fffd||fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(25, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(25, 11)
    
    Offset = Offset + 4    ' |fffd||fffd||fffd|Y|fffd||fffd|/|fffd|n|fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(26, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(26, 11)
    Offset = Offset + 1    ' |fffd||fffd||fffd|Y|fffd|H|fffd||a5bc|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(27, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 And InStr(Cells(Top + Offset + 1, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(27, 11)
    Offset = Offset + 1    ' |fffd|H|fffd||fffd|Z|fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(28, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(28, 11)
    
    Offset = Offset + 3    ' RoHS
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(29, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(29, 11)
    If Cells(Top + Offset, 3) <> Empty Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Offset = Offset + 1    ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd|
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(30, 11)
    If Cells(Top + Offset, 3) <> Empty Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Offset = Offset + 1    ' |fffd|w|fffd||8576||fffd||fffd|
    
    ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||389||fffd||fffd||fffd|NG|fffd||fffd||fffd||fffd||fffd||fffd|
    If Cells(Top + 11, 3) <> Empty Then Cells(Top + 11, 5) = "|fffd|m|fffd|f"
    
    Worksheets("PDF_Spec").Activate
    
    For Line = 1 To EndPDF
        If Cells(Line, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Exit For
    Next Line
    If Line > EndPDF Then Exit Sub
    TLine = Cells(Line, 2).End(xlDown).Row

    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 5, 3) = "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
        For Line = TLine To 1 Step -1    ' |fffd||fffd||fffd||282||fffd||fffd|s|fffd|c|fffd||fffd||fffd||242||fffd||fffd||fffd||a347|
            If InStr(Cells(Line, 1), "|fffd||fffd||fffd||fffd|") > 0 And F|fffd||fffd||fffd||fffd| = 0 Then
                Offset = 5
                i = InStr(Cells(Line, 1), ":") + InStr(Cells(Line, 1), "|fffd|F")
                F|fffd||fffd||fffd||fffd| = 1
                If i > 0 Then
                    TempString = Mid(Cells(Line, 1), i + 1, Len(Cells(Line, 1)) - 1 - 1)
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = TempString
                    If InStr(TempString, "g") > 0 And (InStr(TempString, "|fffd|W|fffd||fffd|") > 0 Or InStr(TempString, "Typ.") > 0 Or InStr(TempString, "typ.") > 0) Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
                        Exit For
                    End If
                Else
                    If InStr(Cells(Line + 1, 1), "|fffd|W|fffd||fffd|") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line + 1, 1)
                    If InStr(Cells(Line + 2, 1), "|fffd|W|fffd||fffd|") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line + 2, 1)
                    If InStr(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4), "g") > 0 Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
                        Exit For
                    End If
                End If
            End If
        Next Line
    End If
    
    
    
    For Line = TLine To TLine + 80
        If ISNUMBER(Cells(Line, 1)) = 1 And Line > TLine + 60 Then Exit For
        ' |fffd|p|fffd|r
        If InStr(Cells(Line, 1), "|fffd|p|fffd|r") > 0 And (InStr(Cells(Line, 1), ":") Or InStr(Cells(Line, 1), "|fffd|F") > 0) Then
            Offset = 1
            i = InStr(Cells(Line, 1), ":")
            Cells(Line, 2) = Mid(Cells(Line, 1), i + 1, Len(Cells(Line, 1)) - i)
            Cells(Line, 2) = DelSpace(Cells(Line, 2))
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
        
        ' |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|") > 0 Then
            Offset = 2
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 1, Len(Cells(Line, 1)) - i)
            If Left(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4), 1) = " " Then _
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4), 2, Len(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4)) - 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
        ' |fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|") > 0 Then
            Offset = 3
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
    ' |fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|") > 0 Then
            Offset = 4
            i = InStr(Cells(Line, 1), ":")
            
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Replace(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3), " ", "")   '20191107_Sn|fffd||fffd||fffd|b|fffd|L|fffd||389||fffd||fffd|@|fffd||fffd||fffd||fffd|
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Replace(Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1), " ", "")
            
            
'            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
        
        Offset = 5
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|") > 0 And Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) <> "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
            i = InStr(Cells(Line, 1), ":")
            If i > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
        End If
        
        If InStr(Cells(Line, 1), "|fffd|R|fffd|v|fffd||fffd||fffd|i|fffd||fffd||fffd|e|fffd|B") > 0 Then
            Offset = 6
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If

        If InStr(Cells(Line, 1), "|fffd|}|fffd|[|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|@") > 0 Then
            Offset = 7
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If

        If InStr(Cells(Line, 1), "|fffd|{|fffd||fffd||fffd|i|fffd||242||350||fffd||fffd|i|fffd||fffd||303||fffd||fffd|b|fffd|g|fffd|i|fffd||fffd||fffd|o|fffd|[|fffd|\|fffd||fffd||fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B") > 0 Then
            Offset = 8
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd||fffd||fffd|b|fffd|gNo.|fffd||fffd||fffd||fffd| |fffd|L|fffd||682||fffd||fffd||fffd|"
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If

    ' |fffd||fffd||fffd|Y|fffd||fffd|
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|Y|fffd||fffd||fffd|^|fffd|n|fffd||fffd|") > 0 And InStr(Cells(Line, 1), "|fffd|H|fffd||fffd|") > 0 Then
            Offset = 9
            i = InStr(Cells(Line, 1), ":")
            Cells(Line, 2) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line, 2)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
            Cells(Line, 2) = ""
        End If
    
    ' |fffd|H|fffd||a5bc||fffd|^|fffd|Z|fffd||fffd|
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|Y|fffd|H|fffd||fffd|") > 0 Then
            Offset = 10
            
            For i = 1 To 30
                If Left(Cells(Line + i, 1), 1) = "/" Or Left(Cells(Line + i, 1), 1) = "|fffd|^" Then
                    Cells(Line + i, 1) = Mid(Cells(Line + i, 1), 2, Len(Cells(Line + i, 1)) - 1)
                End If
            Next i
            i = Line + 1
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 2) = "|fffd||fffd|" Then
                Offset = 11
            End If
            TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3)
            TempString = DelTab(TempString)
            TempString = Replace(TempString, ":" & vbCrLf, vbCrLf)
            TLine = Line
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 8) = Er & Ex & Ey
            End If
            For Er = Line + 1 To i - 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) & Cells(Er, 1) & vbCrLf
            Next Er
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = i
        End If
    
        If InStr(Cells(Line, 1), "|fffd||fffd||fffd|[|fffd||fffd||fffd|d|fffd||fffd|") > 0 Then         '1|fffd||fffd||fffd|[|fffd||fffd||fffd|d|fffd||fffd|(|fffd|W|fffd||fffd|)
            Offset = 12
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
        If InStr(Cells(Line, 1), "|fffd||f455||fffd|d|fffd||fffd|(|fffd|W|fffd||fffd|) ") > 0 Then    '|fffd||f455||fffd|d|fffd||fffd|(|fffd|W|fffd||fffd|)
            Offset = 13
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
    ' RoHS
        If InStr(Cells(Line, 1), "|fffd||f455||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|") > 0 Then
            Offset = 14
            For i = 0 To 2
                Cells(Line + i, 1) = DelChr(Cells(Line + i, 1), Chr(34))
            Next i
            TempString = Worksheets("TEMPSPEC").Cells(32, 1)
            i = Line
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 8) = Er & " " & Ex & " " & Ey
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = i
        End If
    
    ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd|
        If InStr(Cells(Line, 1), "|fffd|{|fffd||fffd||fffd|i|fffd||343|n|fffd||fffd||fffd|Q|fffd||fffd||fffd|t|fffd||fffd||fffd|[") > 0 Then
            Offset = 15
            TempString = Worksheets("TEMPSPEC").Cells(33, 1)
            i = Line
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = i
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 8) = Er & " " & Ex & " " & Ey
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    Next Line
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    i = 1
    Cells(Top, 6) = "|fffd|n|fffd|j"
    For Offset = 1 To 16
        If Cells(Offset, 6) <> Empty And Cells(Offset, 3) <> "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
            If i > Cells(Offset, 6) Then Cells(Top, 6) = "|fffd|m|fffd|f"
            i = Cells(Offset, 6)
        End If
        If (Cells(Top + Offset, 2) = "|fffd||fffd|" Or Cells(Top + Offset, 2) = Empty) And Cells(Top + Offset, 4) = Empty And Cells(Top + Offset, 5) = Empty Then
            Rows(Top + Offset).Hidden = True
        End If
    Next Offset

End Sub
Private Sub |fffd||1c9||fffd||fffd|p(EndPDF As Integer, |fffd|a|fffd|p As Integer)
Dim Line As Integer, TLine As Integer, Top As Integer, Offset As Integer
Dim i As Integer
Dim TempString As String
Dim Er As Integer, Ex As String, Ey As String

Dim EWeight As Integer

    EWeight = 0

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For Line = 1 To 200
        If Cells(Line, 1) = "|fffd|p|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g" Then Exit For
    Next Line
    Top = Line
    Cells(Top, 3) = "|fffd||2d7||fffd||fffd||fffd|"
    Cells(Top, 4) = "|fffd|o|fffd|c|fffd|e"

    Offset = 1 '              |fffd|p|fffd|r
    TempString = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(20, 11)
    If |fffd|a|fffd|p = 3 Then
        i = InStr(TempString, vbCrLf)
        If i > 0 Then Cells(Top + Offset, 3) = Mid(TempString, i + 2, Len(TempString) - i)
    Else
        Cells(Top + Offset, 3) = TempString
    End If
    Offset = Offset + 1    ' |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(21, 5)
    Cells(Top + Offset, 3) = Worksheets("TEMPSPEC").Cells(76, 13)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Offset = Offset + 1    ' |fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(22, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("TEMPSPEC").Cells(77, 13)
    Offset = Offset + 1    ' |fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(23, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("TEMPSPEC").Cells(78, 13)
    Offset = Offset + 1    ' |fffd||fffd||fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(25, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(25, 11)
    Offset = Offset + 4    ' |fffd||fffd||fffd|Y|fffd||fffd|/|fffd|n|fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(26, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("TEMPSPEC").Cells(79, 13)
    Offset = Offset + 1    ' |fffd||fffd||fffd|Y|fffd|H|fffd||a5bc|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(27, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 And InStr(Cells(Top + Offset + 1, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("TEMPSPEC").Cells(80, 13)
    Offset = Offset + 1    ' |fffd|H|fffd||fffd|Z|fffd||fffd|
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(28, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("TEMPSPEC").Cells(81, 13)
    Offset = Offset + 3    ' RoHS
    Cells(Top + Offset, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(29, 5)
    If InStr(Cells(Top + Offset, 2), "|fffd||fffd|") > 0 Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(29, 11)
    If Cells(Top + Offset, 3) <> Empty Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Offset = Offset + 1    ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd|
    Cells(Top + Offset, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(30, 11)
    If Cells(Top + Offset, 3) <> Empty Then Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
    Offset = Offset + 1    ' |fffd|w|fffd||8576||fffd||fffd|
    
    
    
    Worksheets("PDF_Spec").Activate
    For Line = 1 To EndPDF
        If Cells(Line, 1) = "RESTRICTIONS ON PRODUCT USE" Then Exit For
    Next Line
    TLine = Cells(Line, 2).End(xlDown).Row

    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 5, 3) = "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
        For Line = TLine To 10 Step -1                                   ' |fffd||fffd||fffd||fffd|
            If InStr(Cells(Line, 1), "Weight") > 0 And FWeight = 0 Then
                Offset = 5
                FWeight = 1
                i = InStr(Cells(Line, 1), ":")
                If i > 0 Then
                    TempString = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = TempString
                    If InStr(TempString, "g") > 0 And (InStr(TempString, "Typ.") > 0 Or InStr(TempString, "typ.") > 0) Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
                        Exit For
                    End If
                Else
                    If InStr(Cells(Line + 1, 1), "typ.") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line + 1, 1)
                    If InStr(Cells(Line + 2, 1), "typ.") > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Cells(Line + 2, 1)
                    If InStr(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4), "g") > 0 Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
                        Exit For
                    End If
                End If
            End If
        Next Line
    End If
    
    For Line = TLine To TLine + 70
        If ISNUMBER(Cells(Line, 1)) = 1 And Line > TLine + 30 Then Exit For
        ' |fffd|p|fffd|r
        Offset = 1
        If InStr(Cells(Line, 1), "|fffd|Applied equipment") > 0 Then
            i = InStr(Cells(Line, 1), ":")
            TempString = Mid(Cells(Line, 1), i + 1, Len(Cells(Line, 1)) - i)
            If Left(TempString, 1) = " " Then TempString = Mid(TempString, 2, Len(TempString) - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = TempString
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
        
        ' |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|
        If InStr(Cells(Line, 1), "Mold material") > 0 Then
            Offset = 2
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
        ' |fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|
        If InStr(Cells(Line, 1), "Lead material") > 0 Then
            Offset = 3
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
        '
        If InStr(Cells(Line, 1), "Lead finish") > 0 Then
            Offset = 4
            i = InStr(Cells(Line, 1), ":")
            If i > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
        
        If InStr(Cells(Line, 1), "Weight") > 0 And Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + 5, 3) <> "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
            Offset = 5
            i = InStr(Cells(Line, 1), ":")
            If i > 0 Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
        
        If InStr(Cells(Line, 1), "Leads coplanarity") > 0 Then
            Offset = 6
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If

        If InStr(Cells(Line, 1), "Marking") > 0 Then
            Offset = 7
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If

        If InStr(Cells(Line, 1), "This product has no Lot number on package.") > 0 Then
            Offset = 8
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = "|fffd||fffd||fffd|b|fffd|gNo.|fffd||fffd||fffd||fffd| |fffd|L|fffd||682||fffd||fffd||fffd|"
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
    
        ' |fffd||fffd||fffd|Y|fffd||fffd||fffd|^|fffd|n|fffd||fffd|
        If InStr(Cells(Line, 1), "/ Region of origin") > 0 Then
            Offset = 9
            Er = InStr(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2), "|fffd||fffd||fffd|O|fffd|H|fffd||fffd|") * InStr(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 2), "|fffd||fffd||fffd||fffd|H|fffd||fffd|")
            
            i = InStr(Cells(Line, 1), ":")
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Mid(Cells(Line, 1), i + 2, Len(Cells(Line, 1)) - 1 - 1)
            If Er > 0 Then _
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) & vbCrLf & Cells(Line + 1, 1)
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
           End If
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
        End If
        
       ' |fffd|H|fffd||a5bc||fffd|^|fffd|Z|fffd||fffd|
        If InStr(Cells(Line, 1), "Producing works") > 0 Then
            Offset = 10
            For i = 1 To 30
                If Left(Cells(Line + i, 1), 1) = "/" Or Left(Cells(Line + i, 1), 1) = "|fffd|^" Then
                    Cells(Line + i, 1) = Mid(Cells(Line + i, 1), 2, Len(Cells(Line + i, 1)) - 1)
                End If
            Next i
            i = Line + 1
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset + 1, 2) = "|fffd||fffd|" Then
                Offset = 11
            End If
            TempString = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3)
            TempString = DelTab(TempString)
            TempString = Replace(TempString, ":" & vbCrLf, vbCrLf)
'            TLine = Line
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 8) = Er & " " & Ex & " " & Ey
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = i - 1
            For Er = Line + 1 To i - 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 4) & Cells(Er, 1) & vbCrLf
            Next Er
        End If
    
       ' RoHS
        If InStr(Cells(Line, 1), "The product(s) is/are") > 0 Then
            Offset = 14
            For i = 0 To 2
                Cells(Line + i, 1) = DelChr(Cells(Line + i, 1), Chr(34))
            Next i
            
            TempString = Worksheets("TEMPSPEC").Cells(32, 2)
            i = Line
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 8) = Er & " " & Ex & " " & Ey
            End If
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = i
        End If
    
    
    ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd|
        Offset = 15
'        If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 3) <> Empty Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
        If InStr(Cells(Line, 1), "Halogen-Free product") Then
            TempString = Worksheets("TEMPSPEC").Cells(33, 2)
            i = Line
            Call |fffd||fffd||fffd||fffd||fffd||fffd|r(i, TempString, Er, Ex, Ey)
            If Er = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|n|fffd|j"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 6) = Line
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 7) = i
            Else
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top + Offset, 8) = Er & " " & Ex & " " & Ey
            End If
        End If
    Next Line

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    i = 1
    Cells(Top, 6) = "|fffd|n|fffd|j"
    For Offset = 1 To 16
        If Cells(Offset, 6) <> Empty And Cells(Offset, 3) <> "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
            If i > Cells(Offset, 6) Then Cells(Top, 6) = "|fffd|m|fffd|f"
            i = Cells(Offset, 6)
        End If
        If (Cells(Top + Offset, 2) = "|fffd||fffd|" Or Cells(Top + Offset, 2) = Empty) And Cells(Top + Offset, 5) = Empty Then
            Rows(Top + Offset).Hidden = True
        End If
    Next Offset

End Sub





Private Sub |fffd|m|fffd||2d5||fffd|_|fffd||fffd||fffd||4d5||fffd||fffd||fffd|(EndPDF As Integer, |fffd|a|fffd|p As Integer)
Dim TLine As Integer, Top As Long, Er As Integer
Dim i As Integer, j As Integer, Ly As Integer
Dim X As Integer, Y As Integer, Sx As String, Sy As String
Dim Lx As Integer, Tx As String, TD As Integer, Offset As Integer
Dim Px As Integer, Ex As String, Ey As String
Dim |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| As String

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    
    Offset = 4
    If |fffd|a|fffd|p = 1 Then Tx = "|fffd|a|fffd|s|fffd|c"
    If |fffd|a|fffd|p = 2 Then Tx = "|fffd|p|fffd|s|fffd|c"
    For i = 1 To 200
        If Cells(i, 1) = Tx Then Exit For
    Next i
    TD = i
    
    Worksheets("PDF_SPEC").Activate
    Ex = 0
    
    For TLine = 1 To EndPDF
        If |fffd|a|fffd|p = 1 And Cells(TLine, 1) = "|fffd||fffd||fffd|i|fffd||fffd||8235||fffd||fffd||fffd||fffd||302||fffd||fffd||80a2|" Then Exit For
        If |fffd|a|fffd|p = 2 And Cells(TLine, 1) = "RESTRICTIONS ON PRODUCT USE" Then Exit For
    Next TLine
    Top = TLine
    If Top > EndPDF - 1 Then Ex = 9999
    
    
    ' Rev9 |fffd|`|fffd|F|fffd|b|fffd|N_20170622_|fffd||fffd||fffd||fffd||fffd||1cb|L
    If |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 5)
    If |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 5)
    
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
    TLine = Top + 1
    Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
    If Er = 0 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev9"
        GoTo Judge
    End If
    
    ' Rev9 GaAs |fffd|`|fffd|F|fffd|b|fffd|N_20170622_|fffd||fffd||fffd||fffd||fffd||1cb|L
    If |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 6)
    If |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 6)
    
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
    TLine = Top + 1
    Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
    If Er = 0 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev9 GaAs"
        GoTo Judge
    End If

    
    ' Rev6 |fffd|W|fffd||fffd| |fffd|`|fffd|F|fffd|b|fffd|N
    If |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 1)
    If |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 1)
    
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
    TLine = TLine + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 6) = TLine
    Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
    If Er = 0 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev6"
        GoTo Judge
    End If
    
    ' Rev6 GaAs |fffd|`|fffd|F|fffd|b|fffd|N
    If Er > 0 And |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 2)
    If Er > 0 And |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 2)
    
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
    TLine = Top + 1
    Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
    If Er = 0 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev6 GaAs"
        GoTo Judge
    End If
    
    ' Rev5
    If Er > 0 And |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 3)
    If Er > 0 And |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 3)
    
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
    TLine = Top + 1
    Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
    If Er = 0 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev5"
        GoTo Judge
    End If
    
    ' Rev5 GaAs
    If Er > 0 And |fffd|a|fffd|p = 1 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(30, 4)
    If Er > 0 And |fffd|a|fffd|p = 2 Then Cells(Top, 2) = Worksheets("TEMPSPEC").Cells(31, 4)
    
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Cells(Top, 2)
    TLine = Top + 1
    Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, Er, Ex, Ey)
    If Er = 0 Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(TD + Offset, 4) = "Rev5 GaAS"
        GoTo Judge
    End If
    
    
    
    
Judge:

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cells(TD + Offset, 7) = TLine

    If Er = 0 Then
        Cells(TD + Offset, 5) = "|fffd|n|fffd|j"
    Else
        Cells(TD + Offset, 3) = Ex
        Cells(TD + Offset, 4) = Ey
        Cells(TD + Offset, 5) = "|fffd|m|fffd|f" & X
    End If
    
End Sub
Attribute VB_Name = "Module4"
Sub PDFPropaty()
Dim objShell As Object, objWindow As Object, objIE As Object, objTAG As Object

Dim objAcroPDDoc    As New Acrobat.AcroPDDoc
    '|fffd||20d|~|fffd||fffd|Acrobat|fffd|S|fffd||10b||fffd||fffd||fffd|
Dim lRet                As Long   '|fffd||7c2||fffd|l
Dim strGetFileName      As String
Dim strGetFlags         As String
Dim strGetInfo          As String
Dim strGetNumPages      As String
Dim strGetPageMode      As String
Dim strGetPermanentID   As String


Dim i                   As Long '|fffd|s
Dim OpenFile            As String
      

'    OpenFile = Application.GetOpenFilename("PDF,*.pdf")
    
    
    
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For i = 1 To 300
        If Cells(i, 1).Value = "PDF" Then Exit For
    Next i
    i = i + 1
      
      
'    Const CON_NAME = "D:\iac_developer_guide.pdf"
    'PDF|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
    '|fffd||fffd||fffd||4c1|jAcrobat|fffd||349||fffd||282||255|\|fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|B
    
    
    lRet = objAcroPDDoc.Open(OpenFile)
    Debug.Print "lRet = " & lRet
      
    'PDF|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    strGetFileName = objAcroPDDoc.GetFileName
    Cells(i, 1).Value = "GetFileName = " & strGetFileName
    i = i + 1
      
    '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|E|fffd|t|fffd||fffd||fffd|O
    strGetFlags = objAcroPDDoc.GetFlags
    Cells(i, 1).Value = "GetFlags = " & strGetFlags
    i = i + 1
      
    'PDF|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|S|fffd|y|fffd|[|fffd|W|fffd||fffd|
    strGetNumPages = objAcroPDDoc.GetNumPages
    Cells(i, 1).Value = "GetNumPages = " & strGetNumPages
    i = i + 1
      
    'PDF|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90c2||fffd|[|fffd|h
    strGetPageMode = objAcroPDDoc.GetPageMode
    Cells(i, 1).Value = "GetPageMode = " & strGetPageMode
    i = i + 1
      
    '|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^ID
    strGetPermanentID = objAcroPDDoc.GetPermanentID
    Cells(i, 1).Value = "GetPermanentID = " & strGetPermanentID
    i = i + 1
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||303|^|fffd|C|fffd|g|fffd||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("Title")
    Cells(i, 1).Value = "GetInfo(""Title"") = " & strGetInfo
    i = i + 1
      
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||303|T|fffd|u|fffd|^|fffd|C|fffd|g|fffd||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("Subject")
    Cells(i, 1).Value = "GetInfo(""Subject"") = " & strGetInfo
    i = i + 1
      
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||30d||c42c||fffd||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("Author")
    Cells(i, 1).Value = "GetInfo(""Author"") = " & strGetInfo
    i = i + 1
      
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||303|L|fffd|[|fffd||fffd||fffd|[|fffd|h
    strGetInfo = objAcroPDDoc.GetInfo("Keywords")
    Cells(i, 1).Value = "GetInfo(""Keywords"") = " & strGetInfo
    i = i + 1
      
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||30d||c42c||fffd||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("Creator")
    Cells(i, 1).Value = "GetInfo(""Creator"") = " & strGetInfo
    i = i + 1
      
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||30d||c42c||fffd||fffd||fffd||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("CreationDate")
    Cells(i, 1).Value = "GetInfo(""CreationDate"") = " & strGetInfo
    i = i + 1
      
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||30d|X|fffd|V|fffd||fffd||fffd||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("ModDate")
    Cells(i, 1).Value = "GetInfo(""ModDate"") = " & strGetInfo
    i = i + 1
      
    '|fffd||68d||5cf||fffd||fffd|FPDF|fffd||3ca||fffd|
    strGetInfo = objAcroPDDoc.GetInfo("Producer")
    Cells(i, 1).Value = "GetInfo(""Producer"") = " & strGetInfo
    i = i + 1
      
'    strGetInfo = objAcroPDDoc.GetInfo("CustomName")
'    Cells(i, 1).Value = "GetInfo(""AddInfo"") = " & strGetInfo
'    i = i + 1
    
'    Cells(i, 1).Value = objAcroPDDoc.GetInfo("customname")
    
    
 

End Sub
Attribute VB_Name = "Module5"
Sub |fffd||fffd|\|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd| As String)
Dim Line As Integer, Top As Integer, EndL As Integer

    For Line = 50 To 400
        If Cells(Line, 1) = |fffd||fffd||fffd||fffd| Then Exit For
    Next Line
    Top = Line
    EndL = Cells(Top, 1).End(xlDown).Row
    For Line = Top To EndL
        Rows(Line).Hidden = True
    Next Line

End Sub
Sub EndLine(EndPDF As Integer)
Dim i As Long, j As Integer

    Worksheets("PDF_Spec").Activate
    For i = 1 To 9999
        If IsError(Cells(i, 1)) Then Cells(i, 1) = "Err" 'Cells(i, 1) = "'" & Cells(i, 1).Value
        If Cells(i, 1) = Empty Then
            For j = 1 To 20
                If Cells(i + j, 1) <> Empty Then Exit For
            Next j
            If j = 21 Then
                EndPDF = i - 1
                Exit For
            End If
        End If
    Next i
    Cells(1, 2) = EndPDF

End Sub
Sub RoHS(EndPDF As Integer, n As Integer, Er As Integer, Ex As String, Ey As String)
Dim Line As Integer, TLine As Integer, SLine As Integer
Dim Top As Integer, Offset As Integer
Dim S|fffd|aTD As Integer, E|fffd|aTD As Integer, S|fffd|pTD As Integer, E|fffd|pTD As Integer
Dim S|fffd|aR As Integer, E|fffd|aR As Integer, S|fffd|pR As Integer, E|fffd|pR As Integer
Dim RoHSText As String
Dim i As Integer, j As Integer, KeyTop As Integer

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    
    S|fffd|aTD = 0
    E|fffd|aTD = 9999
    S|fffd|pTD = 9999
    E|fffd|pTD = 9999
    S|fffd|aR = 0
    E|fffd|aR = 9999
    S|fffd|pR = 9999
    E|fffd|pR = 9999
    
    
    For i = 1 To 400
        If Cells(i, 1) = "|fffd|a|fffd||fffd||fffd||4d5||fffd||fffd||fffd|" And Cells(i, 6) <> Empty Then
            S|fffd|aTD = Cells(i, 6)
            E|fffd|aTD = Cells(i, 7)
        End If
        If Cells(i, 1) = "|fffd|aRoHS" And Cells(i, 6) <> Empty Then
            S|fffd|aR = Cells(i, 6)
            E|fffd|aR = Cells(i, 7)
        End If
        If Cells(i, 1) = "|fffd|p|fffd||fffd||fffd||4d5||fffd||fffd||fffd|" And Cells(i, 6) <> Empty Then
            S|fffd|pTD = Cells(i, 6)
            E|fffd|pTD = Cells(i, 7)
        End If
        If Cells(i, 1) = "|fffd|pRoHS" And Cells(i, 6) <> Empty Then
            S|fffd|pR = Cells(i, 6)
            E|fffd|pR = Cells(i, 7)
        End If
        
        If Cells(i, 1) = "|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h" Then     ' |fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||308||292|u|fffd|m|fffd|F
            KeyTop = i
            TLine = i
            For Top = 1 To 50
                If Cells(TLine + Top, 1) = "RoHS" Then Exit For
            Next Top
            Top = TLine + Top
        End If

        If Cells(i, 1) = "|fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next i
    Line = i
    
    i = Cells(i + 1, 2).End(xlDown).Row
    If Cells(i + 4, 1) <> Empty And Cells(i + 5, 1) <> Empty Then
        Offset = Cells(i + 4, 1).End(xlDown).Row + 1
    Else
        If Cells(i + 4, 1) = Empty Then
            Offset = i + 4
        Else
            If Cells(i + 5, 1) = Empty Then Offset = i + 5
        End If
    End If
    
    ' |fffd||fffd||fffd||fffd||fffd|J|fffd|n
    
    Worksheets("PDF_Spec").Activate
    TLine = 0
    For Line = 1 To EndPDF
        If Line = S|fffd|aTD Then TLine = E|fffd|aTD
        If Line = S|fffd|aR Then TLine = E|fffd|aR
        If Line = S|fffd|pTD Then TLine = E|fffd|pTD
        If Line = S|fffd|pR Then TLine = E|fffd|pR
        
            
        If Line > TLine Then
            If InStr(Cells(Line, 1), "RoHS") > 0 Or InStr(Cells(Line, 1), "|fffd|q|fffd||fffd||fffd|g|fffd|r") Then
                Er = 1
                ' |fffd|{|fffd||fffd||fffd|i|fffd||fffd|RoHS|fffd|K|fffd||fffd||fffd||fffd|
                i = InStr(Cells(Line, 1), "|fffd|{|fffd||fffd||fffd|i|fffd||fffd|")
                If i > 0 Then
                    For n = 1 To 9
                        TLine = Line
                        RoHSText = Worksheets("TEMPSPEC").Cells(34, n)
                        Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, RoHSText, Er, Ex, Ey)
                        If Er = 0 Then Exit For
                    Next n
                    If n > 5 Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1) = "|fffd|{|fffd||fffd||fffd|i|fffd||fffd|RoHS"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) = Line
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd| 2013|fffd|N1|fffd||fffd|2|fffd||fffd||fffd||702||fffd|"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(KeyTop, 5) = "|fffd|v"
                        Offset = Offset + 1
                    End If
                    If Er > 1 Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) & "," & Line
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1) = "|fffd|{|fffd||fffd||fffd|i|fffd||fffd|RoHS"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) = Line
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3) = Cells(Line, 1)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 4) = Er
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 5) = Ex
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 6) = Ey
                        Offset = Offset + 1
                    End If
                End If
        
                ' Please contact your TOSHIBA sales representative for details as to environmental matters such as the RoHS compatibility of Product.
                j = 0
                i = InStr(Cells(Line - 1, 1), "sales representative for")
                If i > 0 Then
                    TLine = Line - 1
                    j = 1
                End If
                i = InStr(Cells(Line, 1), "sales representative for")
                If i > 0 Then
                    TLine = Line
                    j = 1
                End If
                SLine = TLine
                If j = 1 Then
                    For n = 1 To 2
                        TLine = SLine
                        RoHSText = Worksheets("TEMPSPEC").Cells(34, n + 9)
                        Call |fffd||fffd||fffd||fffd||fffd||fffd|r(TLine, RoHSText, Er, Ex, Ey)
                        If Er = 0 Then Exit For
                    Next n
                    If n > 1 Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1) = "Please contact your"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) = Line
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd| 2013|fffd|N1|fffd||fffd|2|fffd||fffd||fffd||702||fffd|"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(KeyTop, 5) = "|fffd|v"
                    End If
                    If Er > 1 Then
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) & "," & Line
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1) = "Please contact your"
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) = Line
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3) = Cells(Line, 1)
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 4) = Er
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 5) = Ex
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 6) = Ey
                        Offset = Offset + 1
                    End If
                End If
            
                If InStr(Cells(Line, 1), "[[G]]/RoHS") > 0 Or InStr(Cells(Line, 1), "|fffd|m|fffd|m|fffd|f|fffd|n|fffd|n/|fffd|q|fffd||fffd||fffd|g|fffd|r") > 0 Or InStr(Cells(Line, 1), "|fffd||fffd||fffd|B") > 0 Then
'                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) & "," & Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1) = "|fffd|s|fffd|v|fffd|t[[G]]/RoHS"
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) = Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3) = Cells(Line, 1)
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(KeyTop, 5) = "|fffd|v"
                    Offset = Offset + 1
                    Er = 0
                End If
                
                If Er > 0 Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 4) & "," & Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1) = "RoHS"
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) = Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3) = Cells(Line, 1)
                    Offset = Offset + 1
                    Er = 0
                End If
                
            End If
        End If
    Next Line
    
    n = Offset

End Sub
Function DelTab(InText As String)
Dim i As Integer, L As Integer, TL As Integer
    
    L = Len(InText)
    TL = L
    For i = 2 To L - 1
        If Mid(InText, i, 1) = Chr(9) Then
            InText = Mid(InText, 1, i - 1) & Mid(InText, i + 1, L - i)
            TL = TL - 1
            If i = TL Then Exit For
        End If
    Next i
    DelTab = InText
    
End Function
Function DelChr(InText As String, Chr As String)
Dim i As Integer, L As Integer, TL As Integer

    L = Len(InText)
    TL = L
    For i = 2 To L - 1
        If Mid(InText, i, 1) = Chr Then
            InText = Mid(InText, 1, i - 1) & Mid(InText, i + 1, L - i)
            TL = TL - 1
            If i = TL Then Exit For
        End If
    Next i
    DelChr = InText

End Function
Sub |fffd||fffd||fffd||fffd||fffd||fffd|r(Line As Integer, |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| As String, Er As Integer, Ex As String, Ey As String)
Dim X As Integer, Y As Integer
Dim Sx As String, Sy As String
Dim Lx As Integer, Ly As Integer
Dim TLine As Integer

    TLine = Line
    
    For X = 1 To 10
        Sx = Mid(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, X, 1)
        If Sx <> "*" And Sx <> " " Then Exit For
    Next X
    |fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd| = Mid(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, X, Len(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|) - X + 1)
    
    Cells(TLine, 2) = DelSpace(Cells(TLine, 1))
    ' |fffd||fffd||fffd||fffd|
    Sx = Left(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, 3)
    Lx = InStr(Cells(Line, 2), Sx)
    If Lx > 0 Then Cells(Line, 2) = Mid(Cells(Line, 2), Lx, Len(Cells(Line, 2)) - Lx + 1)
    Ly = Len(Cells(TLine, 2))
    Lx = Len(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|)
    
    Er = 0
    Y = 1
    For X = 1 To Lx
        Sx = Mid(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, X, 1)
        ' |fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|l|fffd||242||fffd||fffd||fffd||a347||fffd||354||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd|*|fffd||182||fffd||fffd||fffd||194||fffd|r|fffd||fffd||fffd||202||fffd||fffd|B
        If Sx = "*" Then
            Y = Y + 1
            If Y > Ly Then
                TLine = TLine + 1
                Y = 1
                Cells(TLine, 2) = DelSpace(Cells(TLine, 1))
                Ly = Len(Cells(TLine, 2))
            End If
        Else
            If Sx <> " " And Sx <> "|fffd|@" And Sx <> vbCr And Sx <> vbLf Then
                Sy = Mid(Cells(TLine, 2), Y, 1)
                If Sx <> Sy Then
                    Er = X
                    Ex = Mid(|fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd|, X, 20)
                    Ey = Mid(Cells(TLine, 2), Y, 20)
                    Exit For
                End If
                Y = Y + 1
                If Y > Ly Then
                    TLine = TLine + 1
                    Y = 1
                    Cells(TLine, 2) = DelSpace(Cells(TLine, 1))
                    Ly = Len(Cells(TLine, 2))
                End If
            End If
        End If
    Next X
    Line = TLine

End Sub
Function DelSpace(InText As String)
Dim i As Integer, L As Integer, n As Integer

    L = Len(InText)
    n = 1
    For i = 1 To L - 1
        If Right(InText, 1) = " " Or Right(InText, 1) = "|fffd|@" Then
            InText = Left(InText, L - n)
            n = n + 1
        Else
            Exit For
        End If
    Next i
    
    L = Len(InText)
    n = 0
    For i = 1 To L - 1
        If Mid(InText, L - i, 1) = " " Or Mid(InText, L - i, 1) = "|fffd|@" Then
            InText = Left(InText, L - i - 1) & Right(InText, i - n)
            n = n + 1
        End If
    Next i
    DelSpace = InText
    
End Function
Function DelEndSpace(InText As String)
Dim i As Integer, L As Integer
    L = Len(InText)
    For i = 1 To L
        If Right(InText, 1) = " " Or Right(InText, 1) = "|fffd|@" Then
            InText = Left(InText, Len(InText) - 1)
        Else
            Exit For
        End If
    Next i
    DelEndSpace = InText
    
End Function
Sub |fffd||fffd|\|fffd||fffd||fffd|s()
Dim Line As Integer, TLine As Integer, |fffd|\|fffd|a|fffd|p As Integer, |fffd|{|fffd|a|fffd|p As Integer

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
        
    |fffd|\|fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 5)
    |fffd|{|fffd|a|fffd|p = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11)
    
    For Line = 1 To 100
        If Cells(Line, 1) = "|fffd|\|fffd||fffd||fffd||fffd|" Then Exit For
    Next Line
    TLine = Line
    
    ' |fffd|\|fffd|a|fffd|p
    If |fffd|\|fffd|a|fffd|p = 1 Then Rows(TLine + 1, TLine + 3).Hidden = True
    If |fffd|\|fffd|a|fffd|p = 2 Then Rows(TLine + 4, TLine + 6).Hidden = True
    
    For Line = TLine + 7 To 200
        If Cells(Line, 1) = Empty Then Exit For
        If |fffd|{|fffd|a|fffd|p = 1 And Left(Cells(Line, 1), 1) = "|fffd|p" Then Rows(Line).Hidden = True
        If |fffd|{|fffd|a|fffd|p = 2 And Left(Cells(Line, 1), 1) = "|fffd|a" Then Rows(Line).Hidden = True
    Next Line

End Sub
Sub |fffd|p|fffd||a31f||fffd||fffd|(EndPDF As Integer)
Dim Top As Integer, EndWord As Integer, Offset As Integer, Line As Integer
Dim KWord As String, EXWord(30) As String, TEXWord As String
Dim XLine As Integer
Dim SSkip As Integer, ESkip As Integer
Dim i As Integer, j As Integer, k As Integer
Dim Er As Integer, n As Integer, Ex As String, Ey As String

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    For Line = 1 To 300
        If Cells(Line, 1) = "|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h" Then Exit For
    Next Line
    Top = Line + 1
    EndWord = Cells(Top, 1).End(xlDown).Row
    
    For i = Top To EndWord
        For j = 2 To 100
            If Worksheets("|fffd|\01").Cells(j, 3) = Empty Then Exit For
            If Cells(i, 1) = Worksheets("|fffd|\01").Cells(j, 3) Then Cells(i, 3) = Worksheets("|fffd|\01").Cells(j, 4)
        Next j
    Next i
    
    For Line = 1 To 300
        If Cells(Line, 1) = "|fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    XLine = Line
    
    ' Confidential  (|fffd|d|fffd|l|fffd||fffd||fffd||30d||14c||30a9||fffd||fffd|`|fffd|F|fffd|b|fffd|N )
    For Line = Top To EndWord
        If Cells(Line, 1) = "Confidential" Or Cells(Line, 1) = "confidential" Then Cells(Line, 2) = "'" & Cells(XLine + 1, 3) & "-" & 9999
    Next Line
    
    For Line = XLine + 1 To 300
        If Cells(Line, 2) = Empty Then Exit For
    Next Line
    XLine = Line + 3
    
    
    ' |fffd||fffd||fffd||64f||fffd||fffd|
    ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd|
    SSkip = 1
    ESkip = 9999
    For Line = 1 To Top
        If Cells(Line, 1) = "|fffd|a|fffd|n|fffd||fffd||fffd|t|fffd||fffd|" Then
            SSkip = Cells(Line, 6)
            ESkip = Cells(Line, 7)
        End If
        If SSkip > 1 Then
            For n = Top To EndWord
                If Cells(n, 1) = "|fffd|n|fffd||fffd||fffd|Q|fffd||fffd|" Or Cells(n, 1) = "|fffd|t|fffd||fffd||fffd|[" Then Cells(n, 2) = "'" & SSkip & "-" & ESkip
            Next n
        End If
    Next Line
    For Line = 1 To Top
        If Cells(Line, 1) = "|fffd|p|fffd|n|fffd||fffd||fffd|t|fffd||fffd|" Then
            SSkip = Cells(Line, 6)
            ESkip = Cells(Line, 7)
        End If
        If SSkip > 1 Then
            For n = Top To EndWord
                If Cells(n, 1) = "halogen" Or Cells(n, 1) = "Halogen" Or Cells(n, 1) = "Free" Or _
                    Cells(n, 1) = "free" Or Cells(n, 1) = "semiconductor" Then _
                    Cells(n, 2) = "'" & SSkip & "-" & ESkip
            Next n
        End If
    Next Line
        
    
    Worksheets("PDF_Spec").Activate
    For Offset = Top To EndWord
        KWord = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 1)
        If KWord = "RoHS" Then
            Call RoHS(EndPDF, n, Er, Ex, Ey)
            XLine = n
            GoTo ERoHS
        End If
        
        For j = 0 To 30
            EXWord(j) = ""
        Next j
        TEXWord = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 3)
        
        j = 0
        i = 1
        Do While i <> 0
            i = InStr(TEXWord, ",")
            If i > 0 Then
                EXWord(j) = Left(TEXWord, i - 1)
                TEXWord = Mid(TEXWord, i + 1, Len(TEXWord) - i)
            Else
                EXWord(j) = TEXWord
            End If
            j = j + 1
            k = j
        Loop
        
        SSkip = 9999
        ESkip = 9999
        If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2) <> Empty Then
            i = InStr(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2), "-")
            SSkip = Left(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2), i - 1)
            ESkip = Mid(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2), i + 1, Len(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 2)) - i)
        End If
        
        For Line = 1 To EndPDF
            If Line < SSkip Or Line > ESkip Then
                i = 0
                For j = 0 To k
                    If EXWord(j) <> Empty Then i = i + InStr(Cells(Line, 1), EXWord(j))
                Next j
                If InStr(Cells(Line, 1), KWord) > 0 And i = 0 Then
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 4) & "," & Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 1) = KWord
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 2) = Line
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 3) = Cells(Line, 1)
                    XLine = XLine + 1
                End If
            End If
        Next Line

ERoHS:
    Next Offset
    
    For Offset = Top To EndWord
        If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Offset, 4) = Empty Then Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Rows(Offset).Hidden = True
    Next Offset
    

End Sub
Sub NG|fffd||fffd||fffd||fffd|(|fffd|\|fffd||fffd||fffd|a|fffd|p As Integer, |fffd|{|fffd||fffd||fffd|a|fffd|p As Integer)
Dim Line As Integer, TLine As Integer, ELine As Integer
Dim Top As Integer, Limit As Integer

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate     ' NG|fffd||fffd||fffd||682||30d|s|fffd|@Top
    For Line = 1 To 100
        If Cells(Line, 1) = "|fffd|m|fffd|f|fffd||fffd||fffd||fffd|" Then Exit For
    Next Line
    Top = Line + 1
    
    For Line = Top To 100                ' |fffd||14f|I|fffd|s Limit =|fffd|\|fffd||fffd||fffd||fffd||fffd||302|Q|fffd|s|fffd|O
        If Cells(Line, 1) = "|fffd|\|fffd||fffd||fffd||fffd|" Then Exit For
    Next Line
    Limit = Line - 2
    TLine = Line
    
        
    If Cells(Line, 3) = "|fffd|m|fffd|f" Then      '|fffd|\|fffd||fffd||fffd||fffd|NG|fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||fffd||fffd||fffd||fffd||502||fffd|
        Cells(Top, 1) = "|fffd|\|fffd||fffd||fffd||fffd||fffd|m|fffd|f"
        Top = Top + 1
    End If
    If Cells(Line, 6) = "|fffd|m|fffd|f" Then      '|fffd||fffd||fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||a0bd||fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|iTD|fffd||34f||fffd||fffd||fffd||fffd|j
        Cells(Top, 1) = "|fffd|\|fffd||fffd||fffd|i|fffd||fffd|"
        Top = Top + 1
    End If
    If Cells(Line, 7) = "|fffd|m|fffd|f" Then      '|fffd||fffd||fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||fffd||102||fffd||fffd||fffd|p|fffd|b|fffd|P|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|iTD|fffd||34f||fffd||fffd||fffd|)
        Cells(Top, 1) = "|fffd|\|fffd||fffd|PKG"
        Top = Top + 1
    End If
    
    ELine = Cells(TLine, 1).End(xlDown).Row
    
    For Line = TLine + 1 To ELine            ' |fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||14c||fffd||fffd|o|fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h|fffd||195||f455||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
        If Cells(Line, 5) = "|fffd|m|fffd|f" Then
            Cells(Top, 1) = Cells(Line, 1) & "|fffd|s|fffd||fffd||fffd|i|fffd||fffd||fffd|o|fffd||142||fffd||fffd||fffd||fffd|j|fffd||702||fffd||fffd||356||fffd||80a0||fffd||fffd|"
            Top = Top + 1
        End If
    Next Line
    TLine = ELine
    
    
    If |fffd|\|fffd||fffd||fffd|a|fffd|p = 1 Or |fffd|\|fffd||fffd||fffd|a|fffd|p = 3 Then    ' |fffd|a|fffd||fffd||fffd|\|fffd||fffd||fffd||30d||fffd||fffd||682||156||fffd||fffd||356||fffd||fffd||fffd||fffd||fffd|
        For Line = TLine To 300
            If Cells(Line, 1) = "|fffd|a|fffd|\|fffd||fffd|" Then Exit For
        Next Line
        TLine = Line + 1
        ELine = Cells(TLine, 1).End(xlDown).Row
        For Line = TLine To ELine
            If Cells(Line, 5) = "|fffd|m|fffd|f" Then
                Cells(Top, 1) = Cells(Line, 1)
                Top = Top + 1
            End If
        Next Line
    End If
    TLine = ELine + 1

    If |fffd|\|fffd||fffd||fffd|a|fffd|p = 2 Or |fffd|\|fffd||fffd||fffd|a|fffd|p = 3 Then      ' |fffd|p|fffd||fffd||fffd|\|fffd||fffd||fffd||30d||fffd||fffd||682||156||fffd||fffd||356||fffd||fffd||fffd||fffd||fffd|
        For Line = TLine To 300
            If Cells(Line, 1) = "|fffd|p|fffd|\|fffd||fffd|" Then Exit For
        Next Line
        TLine = Line + 1
        ELine = Cells(TLine, 1).End(xlDown).Row
        For Line = TLine To ELine
            If Cells(Line, 5) = "|fffd|m|fffd|f" Then
                Cells(Top, 1) = Cells(Line, 1)
                Top = Top + 1
            End If
        Next Line
    End If
    TLine = ELine + 1
    
    If |fffd|{|fffd||fffd||fffd|a|fffd|p = 1 Or |fffd|{|fffd||fffd||fffd|a|fffd|p = 3 Then      ' |fffd|a|fffd||fffd|TD|fffd||312||fffd||fffd||4d5||fffd||fffd||fffd||fffd||356||fffd||fffd||202||fffd||fffd||fffd|
        For Line = TLine To 300
            If Cells(Line, 1) = "|fffd|a|fffd||fffd||fffd||4d5||fffd||fffd||fffd|" Then
                If Cells(Line, 5) <> "|fffd|n|fffd|j" Then
                    Cells(Top, 1) = Cells(Line, 1)
                    Top = Top + 1
                End If
                Exit For
            End If
        Next Line
        TLine = Line + 1
    End If
        
    If |fffd|{|fffd||fffd||fffd|a|fffd|p = 2 Or |fffd|{|fffd||fffd||fffd|a|fffd|p = 3 Then      ' |fffd|p|fffd||fffd|TD|fffd||312||fffd||fffd||4d5||fffd||fffd||fffd||fffd||356||fffd||fffd||202||fffd||fffd||fffd|
        For Line = TLine To 300
            If Cells(Line, 1) = "|fffd|p|fffd||fffd||fffd||4d5||fffd||fffd||fffd|" Then
                If Cells(Line, 5) <> "|fffd|n|fffd|j" Then
                    Cells(Top, 1) = Cells(Line, 1)
                    Top = Top + 1
                End If
                Exit For
            End If
        Next Line
        TLine = Line + 1
    End If
    
    If |fffd|{|fffd||fffd||fffd|a|fffd|p = 1 Or |fffd|{|fffd||fffd||fffd|a|fffd|p = 3 Then      ' |fffd|a|fffd||fffd||fffd||312||1c9||fffd||fffd||c42c||fffd|V|fffd|[|fffd|g|fffd||356||fffd||fffd||202||fffd||fffd||fffd|
        For Line = TLine To 300
            If Cells(Line, 1) = "|fffd|a|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g" Then Exit For
        Next Line
        TLine = Line + 1
        If Cells(TLine - 1, 6) = "|fffd|m|fffd|f" Then
            Cells(Top, 1) = "|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g|fffd|L|fffd||68f||fffd|"
            Top = Top + 1
        End If
        ELine = Cells(TLine, 1).End(xlDown).Row
        For Line = TLine To ELine
            If Cells(Line, 5) = "|fffd|m|fffd|f" Then
                Cells(Top, 1) = Cells(Line, 1)
                Top = Top + 1
                If Top > Limit Then Exit Sub
            End If
        Next Line
        TLine = ELine
    End If
    
    
    If |fffd|{|fffd||fffd||fffd|a|fffd|p = 2 Or |fffd|{|fffd||fffd||fffd|a|fffd|p = 3 Then      ' |fffd|p|fffd||fffd||fffd||312||1c9||fffd||fffd||c42c||fffd|V|fffd|[|fffd|g|fffd||356||fffd||fffd||202||fffd||fffd||fffd|
        For Line = TLine To 300
            If Cells(Line, 1) = "|fffd|p|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g" Then Exit For
        Next Line
        TLine = Line + 1
        If Cells(TLine - 1, 6) = "|fffd|m|fffd|f" Then
            Cells(Top, 1) = "|fffd||1c9||fffd||fffd|V|fffd|[|fffd|g|fffd|L|fffd||68f||fffd|"
            Top = Top + 1
        End If
        ELine = Cells(TLine, 1).End(xlDown).Row
        For Line = TLine To ELine
            If Cells(Line, 5) = "|fffd|m|fffd|f" Then
                Cells(Top, 1) = Cells(Line, 1)
                Top = Top + 1
                If Top > Limit Then Exit Sub
            End If
        Next Line
        TLine = ELine + 1
    End If
    
    For Line = TLine To 300                      ' |fffd|p|fffd||fffd||fffd||fffd||fffd||318|a|fffd||fffd||fffd|i|fffd|Q|fffd|o|fffd|C|fffd|g|fffd|j|fffd||fffd||fffd||fffd||fffd||342||202||fffd||fffd||fffd|
        If Cells(Line, 1) = "|fffd|Q|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    If Cells(Line + 1, 5) = "|fffd|m|fffd|f" Then
        Cells(Top, 1) = "|fffd|Q|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Top = Top + 1
        If Top > Limit Then Exit Sub
    End If
    TLine = Line + 2
    
    For Line = TLine To 300                      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||202||fffd||fffd||fffd|
        If Cells(Line, 1) = "|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h" Then Exit For
    Next Line
    If Cells(Line, 5) = "|fffd|v" Then
        Cells(Top, 1) = "|fffd|sW|fffd|tRoHS"
        Top = Top + 1
    End If
    TLine = Line + 1
    For Line = TLine To 300
        If Cells(Line, 1) = Empty Then Exit For
        If Cells(Line, 4) <> Empty Then
            Cells(Top, 1) = "|fffd|p|fffd||a31f||fffd||fffd|"
            Cells(Top, 3) = Cells(Line, 1)
            Top = Top + 1
            If Top > Limit Then Exit Sub
        End If
    Next Line
    TLine = Line + 1
    
    For Line = TLine To 300                       ' |fffd|y|fffd|[|fffd|W|fffd||50d||fffd||fffd||34f||fffd||fffd||510||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Cells(Line, 1) = "|fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    If Cells(Line + 1, 5) = "|fffd|m|fffd|f" Then
        Cells(Top, 1) = "|fffd|y|fffd|[|fffd|W"
        Top = Top + 1
        If Top > Limit Then Exit Sub
    End If

End Sub
Sub |fffd|a|fffd|p|fffd||fffd||fffd||fffd|(EndPDF As Integer, |fffd|{|fffd||fffd||fffd|a|fffd|p As Integer)
Dim Line As Integer, Top As Integer, PTop As Integer, XLine As Integer
Dim End|fffd|a|fffd|d|fffd|l As Integer, End|fffd|d|fffd|l|fffd||fffd| As Integer
Dim |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd| As Integer, |fffd|p|fffd|M|fffd||fffd||fffd||fffd| As Integer
Dim NGLine As Integer

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    
    For Line = 10 To 500
        If Cells(Line, 1) = "|fffd|p |fffd|i|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|" Then Exit For
    Next Line
    |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd| = Line
    
    For Line = |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd| To 500
        If Cells(Line, 1) = "|fffd|p |fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|" Then Exit For
    Next Line
    |fffd|p|fffd|M|fffd||fffd||fffd||fffd| = Line
    
    For Line = |fffd|p|fffd|M|fffd||fffd||fffd||fffd| To 500
        If Cells(Line, 1) = "|fffd|Q|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    Top = Line + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 5) = "|fffd|n|fffd|j"

    
    For Line = Top To 500
        If Cells(Line, 1) = "|fffd|y|fffd|[|fffd|W|fffd|`|fffd|F|fffd|b|fffd|N" Then Exit For
    Next Line
    PTop = Line
    
    End|fffd|a|fffd|d|fffd|l = 1
    If Cells(PTop, 3) <> Empty Then End|fffd|a|fffd|d|fffd|l = Cells(PTop, 3)
    End|fffd|d|fffd|l|fffd||fffd| = Cells(PTop, 4)
    If Cells(PTop + 1, 2) <> Empty Then
        For Line = PTop + 2 To 300
            If Cells(Line, 2) = Empty Then Exit For
        Next Line
        XLine = Line
    Else
        XLine = PTop + 1
    End If
    XLine = XLine + 3
    
    For Line = XLine To 500
        If Cells(Line, 1) = Empty Then Exit For
    Next Line
    XLine = Line + 3
    
    |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd| = Cells(|fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd|, 3)
    |fffd|p|fffd|M|fffd||fffd||fffd||fffd| = Cells(|fffd|p|fffd|M|fffd||fffd||fffd||fffd|, 3)
        
    NGLine = End|fffd|a|fffd|d|fffd|l
    Call DByte(Top, XLine, End|fffd|a|fffd|d|fffd|l + 1, End|fffd|d|fffd|l|fffd||fffd|, NGLine)
    
    If |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd| <> Empty Then Call DByte(Top, XLine, |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd|, EndPDF, NGLine)
    If |fffd|p|fffd|i|fffd||fffd||fffd|\|fffd||fffd| = Empty And |fffd|p|fffd|M|fffd||fffd||fffd||fffd| <> Empty Then Call DByte(Top, XLine, |fffd|p|fffd|M|fffd||fffd||fffd||fffd|, EndPDF, NGLine)

End Sub
Sub DByte(Top As Integer, XLine As Integer, SLine As Integer, ELine As Integer, NGLine As Integer)
Dim Cnt As Integer, Continue As Integer, X As String
    
'   Top ,Xline
'   Cnt, Continue, X

    Worksheets("PDF_SPEC").Activate
    ' |fffd|d|fffd|l|fffd||fffd||fffd||fffd||fffd||fffd|
    Continue = 1
    
    Worksheets("|fffd|\01").Cells(2, 5).Formula = "=IFNA(MATCH(E3,F2:F200,0),0)"
    For Line = SLine To ELine
        Cnt = 0
        For i = 1 To Len(Cells(Line, 1))
            X = Mid(Cells(Line, 1), i, 1)
            Worksheets("|fffd|\01").Cells(3, 5) = X
            If Worksheets("|fffd|\01").Cells(2, 5) = 0 Then
                If Len(X) <> LenB(StrConv(X, vbFromUnicode)) Then
                    Cells(Line, 5) = Cells(Line, 5) & X
                    Cnt = Cnt + 1
                End If
            End If
        Next i
        If Cnt > 0 Then NGLine = Line
        If NGLine + 2 < Line Then Continue = 0
        If Cnt > 0 Then
            If Continue = 0 Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Top, 5) = "|fffd|m|fffd|f"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 1) = "|fffd|p|fffd||fffd||fffd||fffd||fffd|Q|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|H"
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 2) = Line
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 3) = Cells(Line, 1)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 4) = Cells(Line, 5)
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(XLine, 5) = Cnt
                XLine = XLine + 1
            End If
        End If
    Next Line
    Worksheets("|fffd|\01").Cells(2, 5).ClearContents

End Sub
Sub MultiItems(item As String, Top As Integer, EndLine As Integer, Col As Integer, NG As Integer)
Dim BItem(9) As String, TItem(9) As String, TTemp As String
Dim i As Integer, L As Integer, m As Integer, n As Integer, CHK(9) As Integer
Dim Line As Integer, nB As Integer, nT As Integer
    
    For i = 1 To 9
        BItem(i) = ""
        TItem(i) = ""
        CHK(i) = 0
    Next i
    
    NG = 0
    
    i = 1
    BItem(0) = item
    For i = 0 To 9
        n = InStr(item, vbCr)
        If n > 0 Then
            BItem(i) = Left(item, n - 1)
            item = Mid(item, n + 2, Len(item) - n - 1)
        Else
            BItem(i) = item
            Exit For
        End If
    Next i
    nB = i
    
    i = 0
    For Line = Top + 1 To EndLine
        If Cells(Line, Col) <> Empty Then          ' |fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            TTemp = Cells(Line, Col)
            
            For i = 0 To 9
                n = InStr(TTemp, vbCr)
                If n > 0 Then                      ' |fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||249||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||8561||fffd||fffd||fffd||fffd||fffd|i|fffd||30f||a347|
                    TItem(i) = Left(TTemp, n - 1)
                    TTemp = Mid(TTemp, n + 2, Len(TTemp) - n - 1)
                Else
                    TItem(i) = TTemp
                    Exit For
                End If
            Next i
            nT = i
            
            For n = 0 To nT
                CHK(n) = 0
            Next n
            
            For n = 0 To nT
                For m = 0 To nB
                    L = Len(TItem(n))
                    If Left(BItem(m), L) = TItem(n) Then
                        CHK(n) = 1    ' |fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||682||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||141|@OK
                        Exit For
                    End If
                Next m
            Next n
    
            For i = 0 To nT
                If CHK(i) = 0 Then NG = 1
            Next i
        
        End If
    Next Line

End Sub
Function ISNUMBER(Ix As Variant)
Dim i As Integer, L As Integer, X As String, Y As Integer

    L = Len(Ix)
    Y = 0
    If L <> 0 Then
        Y = 1
        For i = 1 To L
            X = Mid(Ix, i, 1)
            If Asc(X) < 48 Or Asc(X) > 57 Then Y = 0
        Next i
    End If
    ISNUMBER = Y
    
End Function
Function ISNUMBER1(Ix As Variant)
Dim i As Integer, L As Integer, X As String, Y As Long

    L = Len(Ix)
    Y = 0
    For i = 1 To L
        X = Mid(Ix, i, 1)
        If Asc(X) > 47 And Asc(X) < 58 Then
            Y = Y * 10 + Val(X)
        Else
            Y = -1
            Exit For
        End If
    Next i
    ISNUMBER1 = Y
    
End Function
Sub WriteLine(Line As Integer, Col3 As Variant, Col4 As Variant, Col6 As Variant, Col7 As Variant)

    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 3) = Empty Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 3) = Col3
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 4) = Col4
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 6) = Col6
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 7) = Col7
    Else
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 3) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 3) & vbCrLf & Col3
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 4) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 4) & vbCrLf & Col4
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 6) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 6) & vbCrLf & Col6
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 7) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, 7) & vbCrLf & Col7
    End If

End Sub
Sub WriteCol(Line As Integer, Col As Integer, Text As String)

    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, Col) = Empty Then
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, Col) = Text
    Else
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, Col) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Line, Col) & vbCrLf & Text
    End If

End Sub
Sub TESTXY()
Dim Y As Long

    Y = ISNUMBER1("123")
    MsgBox Y
    
End Sub
Sub IS|fffd||68b|q|fffd|t|fffd|@|fffd|C|fffd||fffd|()
Dim DirectoryPath As String, DISC(5) As String, i As Integer, Temp As String, buf As String
Dim mySheet As Worksheet, myBook As String, NewBook As String
Dim RC As Integer

    myBook = ActiveWorkbook.Name
    
    DISC(0) = "Z"
    DISC(1) = "Y"
    DISC(2) = "X"
    DISC(3) = "W"
    DISC(4) = "V"
    DISC(5) = "U"
    
    Cnt = 0
    For i = 0 To 5
        DirectoryPath = DISC(i) & ":\Guide Line_|fffd|w|fffd||fffd|\"
        If Dir(DirectoryPath, vbDirectory) <> Empty Then
            ChDir DirectoryPath
            buf = Dir(DirectoryPath & "*.xls*")
            Do While buf <> ""
                Cnt = Cnt + 1
                Worksheets("|fffd|\01").Cells(Cnt, 12) = buf
                buf = Dir()
            Loop
            Exit For
        End If
    Next i

    Worksheets("|fffd|\01").Activate
    For i = 1 To 50
        If Cells(i, 12) = Empty Then Exit For
        Ex = 0
        For j = 1 To 50
            If Cells(j, 11) = Empty Then Exit For
            If Cells(j, 11) = Cells(i, 12) Then
                Ex = 1
                Exit For
            End If
        Next j
        If Ex = 0 Then
            If InStr(Cells(i, 12), "|fffd|y|fffd|S|fffd||30d|X|fffd|V|fffd|z|fffd|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd|q|fffd||fffd||291||389||fffd||fffd||a5d7|") > 0 Then
            
                Workbooks.Open (DirectoryPath & Cells(i, 12))
                NewBook = ActiveWorkbook.Name
                For Each mySheet In Worksheets
                    If mySheet.Name = "|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|" Then
                    
                        RC = MsgBox("|fffd|V|fffd||fffd||fffd||fffd||fffd|u|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd|v|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||582||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion, "|fffd|m|fffd|F")

                        If RC = vbYes Then
                            Workbooks(myBook).Activate
                            Application.DisplayAlerts = False
                            Worksheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Delete
                            Application.DisplayAlerts = True
                        
                            Workbooks(NewBook).Activate
                            Sheets("|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|").Copy Before:=Workbooks("SpecCheck.xlsm").Sheets("|fffd|\01")
                            
                            Worksheets("|fffd|\01").Activate
                            j = Cells(1, 12).End(xlDown).Row
                            Range(Cells(1, 12), Cells(j, 12)).Copy Cells(1, 11)
                            
                            Exit For
                        End If
                    End If
                Next
                Workbooks(NewBook).Close
                Workbooks(myBook).Activate
                Worksheets("Stamp").Activate
            End If
        End If
    Next i

End Sub

Attribute VB_Name = "Module9"
Sub SpecListDisp(xNo)
Dim objShell As Object, objWindow As Object, objIE As Object, objTAG As Object
Dim i As Integer, j As Integer, k As Integer, L As Integer, m As Integer, m2 As Integer, n As Integer, l2 As Integer
Dim X As Integer, Y As Integer
Dim strTNAME As String

Dim WinListR As Integer, WinListC As Integer
Dim WebDataX As Integer, WebDataY As Integer
Dim WebDataIniX As Integer, WebDataIniY As Integer

Dim Workareaini As Integer, Workareaend As Integer

Dim SpecNo As Integer

Dim Term As String, Term1 As String
Dim OffsetR As Integer, OffsetC As Integer
Dim LineNo As Integer, StartCol As Integer, EndCol As Integer, Number_Term As Integer
Dim Ougi As Integer, |fffd|a|fffd|p As Integer, Factory As Integer, Jyusyo As Integer
Dim JyusyoS As String
Dim Jmae As String, Jato As String, Jato1 As String
Dim Emae As String, Emae1 As String, Eato As String, Eato1 As String
Dim SerchWordEnd As Integer
Dim |fffd|H|fffd||fffd|O|fffd||fffd| As Integer, |fffd|H|fffd||fffd|Z|fffd||fffd| As Integer

Dim FRoHS As Integer

   Application.ScreenUpdating = False  '|fffd||fffd||fffd|Z|fffd||fffd||fffd||255|\|fffd||fffd||fffd||fffd||fffd|~|fffd||7c2||fffd|B|fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||302||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|


'|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd|

   ' |fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd|
   Worksheets("TEMPSPEC").Activate
   Workareaini = 50
   Workareaend = Range(Cells(Workareaini, 1), Cells(Workareaini, 1)).End(xlDown).Row
   Range("A4") = Workareaini
   Range("B4") = Workareaend
   
   
'|fffd|@=============================
'|fffd|@Window|fffd||30f||fffd||fffd||64fe||fffd||183|f|fffd|[|fffd|^|fffd|_|fffd||fffd||fffd|v

   Call ReadSpec(k, Workareaend, WinListR)
      
   j = 1
   Term = "|fffd||fffd||fffd||fffd||fffd||30e|d|fffd|l|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||fffd|No|fffd||fffd||fffd||fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf
   
   ' |fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
   If k = 0 Then
      MsgBox "|fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
      Worksheets("Stamp").Activate
      GoTo Owari
   Else
      For i = Workareaend + 10 To WinListR
         If Cells(i, 2) = "|fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            Cells(i, 4) = Cells(200 * j + 5, 2)
            Cells(i, 5) = Left(Cells(200 * j + 23, 2), 15)
            Term = Term & j & "." & Cells(i, 4) & "|fffd||fffd||fffd||fffd|:" & Cells(i, 5) & vbCrLf
            j = j + 1
         End If
      Next i
   End If
   
  ' |fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||355|\|fffd||fffd||fffd||fffd||fffd||fffd|
   SpecNo = 1
   If j > 2 Then
3          SpecNo = InputBox(Term)
      Do While SpecNo > j - 1
         SpecNo = InputBox(Term)
      Loop
   End If
   
' ============ |fffd|O|fffd||fffd||fffd||fffd| =================
'|fffd|@|fffd|P|fffd|j|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd||fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||215||fffd||fffd||fffd||fffd||30d||d3dc|
'|fffd|@|fffd|Q|fffd|j|fffd||702||fffd||fffd|A|fffd|c|fffd||182||317|v|fffd||fffd||fffd||251||382||fffd||fffd||109||fffd||fffd|Z|fffd||5368d||fffd||fffd||682||249|c|fffd||183|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||302||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|d|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||d3dc|

'|fffd|@|fffd|P|fffd|j|fffd||301|@|fffd||389||fffd||fffd||fffd||fffd||681|@|fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd||fffd|A|fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd||fffd|A|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|

   Worksheets("TEMPSPEC").Activate
   Range(Cells(Workareaini, 11), Cells(Workareaend, 13)).ClearContents
  
  ' |fffd||c42c||fffd|y|fffd|[|fffd|W|fffd|f|fffd|[|fffd|^|fffd||308||fffd||303|N|fffd||fffd||fffd|A
  ' |fffd||c42c||fffd|y|fffd|[|fffd|W|fffd|f|fffd|[|fffd|^
    '|fffd|@|fffd|@Column 2(B):|fffd|p|fffd|r
    '|fffd|@|fffd|@Column 3(C)|fffd|F|fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd||fffd||fffd|
    '|fffd|@|fffd|@Column 4(D)|fffd|F|fffd||fffd||fffd||311||fffd|
    '|fffd|@|fffd|@Column 5(E)|fffd|F|fffd||fffd||fffd|Y|fffd||fffd||fffd|A|fffd|H|fffd||fffd|
    '|fffd|@|fffd|@Column 6(F)|fffd|F|fffd|o|fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd|
    '|fffd|@|fffd|@Column 7(G)|fffd|FRoHS
    '|fffd|@  Column 8(H)|fffd|F|fffd|n|fffd||fffd||fffd|Q|fffd||fffd|
    '|fffd|@  Column 9(I)|fffd|F4M|fffd||fffd||fffd||fffd||fffd|A|fffd||8b||fffd||fffd||fffd||fffd||fffd|
    
   WebDataIniY = 200 * SpecNo
   xNo = SpecNo
    
   Range(Cells(Workareaini, 8), Cells(Workareaend, 9)).ClearContents
   
   '|fffd||fffd||fffd|Z|fffd||292|u|fffd|m|fffd|F  |fffd||fffd||fffd|Z|fffd||53682||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||292|u|fffd||30a|m|fffd|F|fffd|@"|fffd||fffd||fffd|Z|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|E|fffd||fffd||fffd||fffd|"|fffd||308||292|u
   m = Workareaini + 1
   Term = Cells(m, 1)
   For i = WebDataIniY To WebDataIniY + 200
      If Cells(i, 1) = Term Then Exit For
   Next i
   Ougi = i

   '|fffd||fffd||fffd||fffd||fffd||315|K|fffd|v|fffd||208||10c||fffd|
   For i = Workareaini + 2 To Workareaend
   Term = Cells(i, 1)
      For j = WebDataIniY To Ougi
         For k = 1 To 10
            If Cells(j, k) = Term Then
               Cells(i, 6) = j + Cells(i, 2)
               Cells(i, 7) = k + Cells(i, 3)
               Cells(i, 8) = Cells(Cells(i, 6), Cells(i, 7))
               GoTo ppp1
            End If
         Next k
      Next j
ppp1:
   Next i
   
  ' |fffd||fffd||fffd|Z|fffd||53682||303|f|fffd|[|fffd|^|fffd||fffd||fffd|W
   m = Workareaini + 26
   For i = m To Workareaend
   Term = Cells(i, 1)
      For j = Ougi To WebDataIniY + 200
         For k = 1 To 10
            If Cells(j, k) = Term Then
               Cells(i, 9) = Cells(j + Cells(i, 4), k + Cells(i, 5))
               Cells(i, 6) = j + Cells(i, 4)
               Cells(i, 7) = k + Cells(i, 5)
               GoTo ppp2
            End If
         Next k
      Next j
ppp2:
   Next i
   
   ' |fffd||2d7||fffd||fffd||fffd||fffd||50d||fffd||fffd||30f||fffd||fffd||fffd| (|fffd||fffd||fffd||303|X|fffd|y|fffd|[|fffd|X|fffd||d3dc|)
    m = Workareaini + 2
    k = Len(Cells(m, 8))
    For i = 1 To k
        If Right(Cells(m, 8), 1) = " " Then
            Cells(m, 8) = Mid(Cells(m, 8), 1, k - i)
        Else
            Exit For
        End If
    Next i
    Cells(m, 8).Copy
    Cells(Cells(m, 6), Cells(m, 7)).PasteSpecial Paste:=xlPasteValues
   
  ' |fffd||fffd||fffd||4d6||fffd||fffd||30f||fffd||fffd||fffd|(|fffd||fffd||fffd||315|s|fffd|v|fffd||203|X|fffd|y|fffd|[|fffd|X|fffd||d3dc||fffd|j
    m = Workareaini + 3
    Call |fffd||fffd||fffd||4d6||fffd|(m)
   
    Call |fffd|q|fffd||fffd||fffd|(m)

  ' |fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
   For i = 5 To 14
      m = Workareaini + i
      L = Len(Cells(m, 8))
      If L > 6 Then
         Term = Cells(m, 8)
         For k = 1 To L
            If Mid(Term, k, 1) = vbCr Then
               Term = Mid(Term, k + 4, L - k - 4)
               Cells(m, 8) = Term
               Exit For
            End If
         Next k
      End If
   Next i
   Cells(Workareaini + 5, 8) = DelEndSpace(Cells(Workareaini + 5, 8))
   For i = 6 To 14
      If Cells(Workareaini + i, 8) <> Empty Then _
         Cells(Workareaini + 5, 8) = Cells(Workareaini + 5, 8) & vbCrLf & DelEndSpace(Cells(Workareaini + i, 8))
   Next i
   Cells(Cells(Workareaini + 5, 6), Cells(Workareaini + 5, 7)) = Cells(Workareaini + 5, 8)
   
   ' |fffd|M|fffd||415|i|fffd||501|im=15-24) |fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   For i = 16 To 24
      If Cells(Workareaini + i, 8) <> Empty Then _
         Cells(Workareaini + 15, 8) = Cells(Workareaini + 15, 8) & vbCrLf & Cells(Workareaini + i, 8)
   Next i
   Cells(Cells(Workareaini + 15, 6), Cells(Workareaini + 15, 7)) = Cells(Workareaini + 15, 8)
   
   '|fffd|@|fffd|\|fffd||fffd||fffd|a|fffd|p|fffd|`|fffd|F|fffd|b|fffd|N|fffd|@|fffd|a|fffd|F|fffd|P|fffd|A|fffd|p|fffd|G|fffd|Q|fffd|A|fffd|a|fffd|p|fffd|F|fffd|R
   
   m = Workareaini + 52
   m2 = Workareaini + 25
   Call |fffd|a|fffd|pC(m, m2, |fffd|a|fffd|p)
      
   m = Workareaini + 34    ' |fffd|p|fffd|r
   Call |fffd|p|fffd|r(m, |fffd|a|fffd|p)
   
   m = Workareaini + 26     ' |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|
   Call |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|(m)
   
   m = Workareaini + 27     '|fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|
   Call |fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|(m)
   
   
   m = Workareaini + 28     '|fffd||fffd||fffd|b|fffd|L|fffd|g|fffd||fffd||fffd|y|fffd||455|\|fffd||28f||fffd||fffd||fffd|
   Call |fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|(m)
   
   m = Workareaini + 29     '|fffd||fffd||fffd|Y|fffd||fffd|
   Call |fffd||fffd||fffd|Y|fffd||fffd|(m)
   
   m = Workareaini + 30     ' |fffd|H|fffd||fffd|/|fffd|H|fffd||fffd|Z|fffd||fffd|
   Call |fffd|O|fffd||fffd|(m, |fffd|H|fffd||fffd|O|fffd||fffd|)
   Call |fffd|H|fffd||a5bc|(m, |fffd|H|fffd||fffd|O|fffd||fffd|, |fffd|a|fffd|p, |fffd|H|fffd||fffd|Z|fffd||fffd|)
   Range("D4") = |fffd|H|fffd||fffd|Z|fffd||fffd|
   
   For i = 26 To 31
      m = Workareaini + i
      If |fffd|a|fffd|p = 1 Or |fffd|a|fffd|p = 3 Then Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 12)
      If |fffd|a|fffd|p = 2 Then Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 13)
   Next i
   
   ' RoHS|fffd|`|fffd|F|fffd|b|fffd|N

   ' |fffd||fffd||fffd|Z|fffd||53692||fffd||fffd|o|fffd|i|fffd|c|fffd||183|R|fffd||fffd||fffd||fffd||fffd|g|fffd||d3dc||fffd|j
   For i = 36 To 43
      m = Workareaini + i
      L = Len(Cells(m, 9))
      If L > 5 Then
         For j = 1 To Len(Cells(m, 8)) - 1
            If Mid(Cells(m, 8), j, 1) <> Mid(Cells(m, 9), j + 7, 1) Then
               Cells(m, 12) = Mid(Cells(m, 9), j + 7, L - j - 7)
               
               L = Len(Cells(m, 12))
               k = L
               For n = 1 To L
                  If Left(Cells(m, 12), 1) = vbLf Or Left(Cells(m, 12), 1) = vbCr Then
                     Cells(m, 12) = Right(Cells(m, 12), k - 1)
                     k = k - 1
                  Else
                     Exit For
                  End If
               Next n
               Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 12)
               Cells(m, 9) = Cells(m, 12)
               Exit For
            
               L = Len(Cells(m, 12))
               k = L
               For n = 1 To L
                  If Right(Cells(m, 12), 1) = vbLf Or Right(Cells(m, 12), 1) = vbCr Or _
                     Right(Cells(m, 12), 1) = " " Then
                     Cells(m, 12) = Mid(Cells(m, 12), 2, k - 1)
                     k = k - 1
                  Else
                     Exit For
                  End If
               Next n
               
               Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 12)
               Cells(m, 9) = Cells(m, 12)
               Exit For
            End If
         Next j
      End If
   Next i

   ' |fffd||fffd||fffd|i|fffd|\|fffd||fffd|
   m = Workareaini + 50
   Call |fffd||fffd||fffd|i|fffd|\|fffd||fffd|(m)

   m = Workareaini + 51
   Call |fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g(m)

   Call |fffd||fffd||fffd||fffd|(Workareaini, Workareaend)

'   Call SpecList(WebDataIniY, Ougi)
   
   Call |fffd|d|fffd|l|fffd||fffd|(WebDataIniY, Ougi)

Owari:
   
   Application.ScreenUpdating = True
   
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
   For i = 50 To 1 Step -1
      Cells(i, 1).Activate
   Next i
   Range("A1").Activate
   


End Sub
Sub XSpecListDisp()
Dim i As Integer, xNo As Integer


    Call SpecListDisp(xNo)

    Worksheets("Stamp").Activate
    If Range("B3") = Empty Then
        i = 3
    Else
        i = Range("B2").End(xlDown).Row
    End If
    
    If Cells(i, 2) <> Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(2, 5) Then
        i = i + 1
        Cells(i, 1) = Cells(i - 1, 1) + 1
        Cells(i, 2) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(2, 5)
        Cells(i, 3) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(4, 5)
        Cells(i, 4) = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(5, 5)
        Cells(i, 5) = Now
        Cells(i, 5).NumberFormatLocal = "yy/m/d h:mm"
        Range(Cells(i, 1), Cells(i, 5)).Font.Size = 9
    End If
    If i <> 3 And Day(Cells(i - 1, 5)) <> Day(Cells(i, 5)) Then
        Cells(i, 1) = 1
        Range(Cells(i - 1, 1), Cells(i - 1, 6)).Borders(xlEdgeBottom).LineStyle = xlContinuous1
        Range(Cells(i - 1, 1), Cells(i - 1, 6)).Borders(xlEdgeBottom).Weight = xlMedium
        
        Call IS|fffd||68b|q|fffd|t|fffd|@|fffd|C|fffd||fffd|
        
    End If

'---------------------------------------------------------------------
'pdf|fffd||1c2||74d||fffd||fffd||fffd| 20171020|fffd||fffd||fffd||fffd||fffd||1cb|L
xNo = xNo * 200
Dim URL As String, IE As Object
Dim specpdf As String, yyyy As String, mm As String
Dim yyyyno As Integer, xx1 As Integer

specpdf = Worksheets("TEMPSPEC").Cells(xNo + 5, 4).Value
torokuday = Left(Worksheets("TEMPSPEC").Cells(xNo + 32, 8).Value, 4)

If specpdf = " " Then
        MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|")
        GoTo ski
End If


yyyy = torokuday

    Set IE = CreateObject("InternetExplorer.Application")
    URL = "http://qait.semicon.toshiba.co.jp/hanpin/qadb/etc/shiyou/" + yyyy + "/" + specpdf
    With IE
        .navigate (URL)
        .Visible = True
    End With
    Set IE = Nothing

'-----------------------------------------------------------------------

ski:

    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate

End Sub
Sub |fffd|d|fffd|l|fffd||fffd|1()
Dim LineNo As Integer

   LineNo = ActiveCell.Row
   
   Call SpecListDisp
   
   Worksheets("Stamp").Cells(LineNo, 33) = Range("E4")

End Sub
Private Sub ReadSpec(k As Integer, Workareaend As Integer, WinListR As Integer)
Dim objShell As Object, objWindow As Object, objIE As Object, objTAG As Object
Dim i As Integer, j As Integer
Dim X As Integer, Y As Integer
Dim strTNAME As String

Dim WinListC As Integer
Dim WebDataX As Integer, WebDataY As Integer
Dim WebDataIniX As Integer, WebDataIniY As Integer

'|fffd|@=============================
'|fffd|@Window|fffd||30f||fffd||fffd||64fe||fffd||183|f|fffd|[|fffd|^|fffd|_|fffd||fffd||fffd|v

   WinListR = Workareaend + 10 'TEMPSPEC|fffd||30f||fffd||fffd||fffd||fffd||308||fffd||302||fffd||fffd||182|P0|fffd|s|fffd||682||fffd||fffd||fffd|L|fffd||fffd|
   WinListC = 1
   WebDataIniX = 1
   WebDataIniY = 200           ' TEMPSPEC|fffd||fffd|200|fffd|s|fffd||682||fffd||fffd||fffd|
   WebDataX = WebDataIniX  '
   WebDataY = WebDataIniY + 1 '|fffd||1c2||74d||fffd||fffd||fffd|Web|fffd||fffd||fffd|s|fffd||310||64ea||fffd|s(TEMPSPECno200|fffd|s|fffd||682||fffd||fffd||fffd|L|fffd||fffd||fffd|j
   
   Cells(WebDataIniY, WebDataIniX + 2).Formula = "=RC[-2]-RC[-1]+201"
   Cells(WebDataIniY, WebDataX + 1).Formula = "=MOD(RC[-1]," & WebDataIniY & ")"

   ' TEMPSPEC|fffd|V|fffd|[|fffd|g|fffd||313||fffd||fffd|e|fffd|N|fffd||fffd||fffd|A
   ' |fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd|Window|fffd||310||fffd||fffd||34d||151||fffd|40|fffd||182||fffd||fffd||102||fffd||fffd||fffd|B
   
   ' |fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd|Window|fffd||310||fffd||fffd||34d||151||fffd|40|fffd||182||fffd||fffd||102||fffd||fffd||fffd|B
   Range(Cells(WinListR, WinListC), Cells(WinListR + 40, WinListC + 3)).ClearContents
   Range(Cells(WebDataY, WebDataX), Cells(WebDataY + 10000, WebDataX + 12)).ClearContents
  
   Set objShell = CreateObject("Shell.Application")             '|fffd|V|fffd|F|fffd||fffd||fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|

   '|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||311|S|fffd||103|`|fffd|F|fffd|b|fffd|N
   k = 0
   For Each objWindow In objShell.Windows
      Cells(WinListR, 1) = TypeName(objWindow.Document)   ' TypeName|fffd||143|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||3d0||fffd||fffd||303|^|fffd|C|fffd|v|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
      If TypeName(objWindow.Document) = "HTMLDocument" Then     ' HTML|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         Cells(WinListR, 2) = objWindow.Document.Title    ' URL|fffd||183|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
         Cells(WinListR, 3) = objWindow.Document.URL

         If Cells(WinListR, 2) = "|fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd|" Then        ' |fffd||2d7||fffd||fffd||fffd||fffd||309||fffd||282||142||fffd||fffd||fffd||383|_|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd|B200|fffd|s|fffd||fffd|
            k = k + 1                                           ' |fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|k=1 |fffd||250||752||80b7||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|"0"
            Worksheets("TEMPSPEC").Activate
            Set objIE = objWindow

            For Each objTAG In objIE.Document.all
               strTNAME = objTAG.TagName                         '|fffd|^|fffd|O|fffd||316||fffd||fffd|O|fffd||fffd||3d0||fffd||fffd||595||6d1||fffd|
               If strTNAME = "TR" Then                           'TR|fffd|s|fffd||30a|J|fffd|n|fffd||202||fffd|
                  WebDataY = WebDataY + 1                        '|fffd|s|fffd|J|fffd|n|fffd||202||302||fffd| |fffd|s|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|{1
                  WebDataX = 0                                   '|fffd||fffd||fffd||fffd|O(|fffd||fffd|)|fffd||fffd||fffd||fffd||fffd||fffd|
               End If

               If strTNAME = "TH" Or strTNAME = "TD" Then        'TH|fffd||fffd||fffd|o|fffd||fffd| TD|fffd|f|fffd|[|fffd|^
                  WebDataX = WebDataX + 1                        '|fffd||fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|{1
                  Cells(WebDataY, WebDataX) = "'" & objTAG.innerText '.InnerText|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
               End If
            Next
            
            ' |fffd|_|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||30d||14c||fffd||30d|s WebDataY |fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||30d||14f||fffd||fffd||30d|s|fffd||fffd||fffd||c2bce||fffd||fffd|
            Cells(WebDataIniY, WebDataIniX) = WebDataY
            WebDataY = Cells(WebDataIniY, WebDataIniX + 2)
         End If
      End If
   WinListR = WinListR + 1
   Next
   
   Set objShell = Nothing
   Set objIE = Nothing
   Set objLink = Nothing
   
End Sub
Private Sub |fffd||fffd||fffd||4d6||fffd|(m As Integer)
Dim i As Integer, k As Integer, L As Integer
  
  ' |fffd||fffd||fffd||4d6||fffd||fffd||30f||fffd||fffd||fffd|(|fffd||fffd||fffd||315|s|fffd|v|fffd||203|X|fffd|y|fffd|[|fffd|X|fffd||d3dc||fffd|j
   Worksheets("TEMPSPEC").Activate
   
   L = Len(Cells(m, 8))
   k = L
   For i = 1 To L - 1
      If Right(Cells(m, 8), 1) = " " Or Right(Cells(m, 8), 1) = "|fffd|@" Or _
         Right(Cells(m, 8), 1) = vbCr Or Right(Cells(m, 8), 1) = vbLf Then
         Cells(m, 8) = Left(Cells(m, 8), k - 1)
         k = k - 1
      Else
         Exit For
      End If
   Next i
   Range("A5") = Cells(m, 8)

End Sub
Private Sub |fffd|q|fffd||fffd||fffd|(m As Integer)
   
   ' |fffd||fffd||fffd||4d1||389||fffd||fffd|\|fffd||303|`|fffd|F|fffd|b|fffd|N
   '  A5|fffd|F|fffd||fffd||fffd||4d6||fffd||fffd|i|fffd||2d7||fffd||fffd||fffd||fffd|j
   '|fffd|@B5|fffd|F|fffd||394||fffd|\|fffd||30d|s|fffd||50d||fffd|
   '|fffd|@C5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||30e||416||fffd|
   '|fffd|@D5|fffd|F|fffd||394||fffd|\|fffd||303|R|fffd||fffd||fffd||fffd||fffd|g
   '|fffd|@E5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||315|\|fffd||fffd||fffd||50d||fffd|
   '|fffd|@F5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||312||fffd||fffd||4d5||fffd||fffd||fffd||fffd||d3dc|
   '|fffd|@G5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||30c||95||291||389||fffd|
   '|fffd|@H5|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
   '|fffd|@I5|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|@|fffd|a
   '|fffd|@J5|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|@|fffd|p
   '  K5|fffd|F|fffd||8b||fffd||fffd||fffd||fffd||fffd|
   '  L5|fffd|F|fffd||8b||fffd||fffd||fffd||fffd||fffd|
     
   Worksheets("TEMPSPEC").Activate
   Range("B5:J6").ClearContents
   
   ' B5 |fffd||394||fffd|\|fffd||50d||fffd|
   Range("B5").Formula = "=MATCH(A5,|fffd||394||fffd|\!A1:A4000,FALSE)"
   If IsError(Range("B5")) Then     '|fffd||fffd|r|fffd|\|fffd||253||fffd||fffd||4d6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||351||394||fffd|\|fffd||252||1c9||fffd||fffd||fffd||fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|B
      Worksheets("|fffd||394||fffd|\").Activate
      L = Range("A3").End(xlDown).Row
      Cells(L + 1, 1) = Worksheets("TEMPSPEC").Cells(m, 8)
      Range(Cells(2, 1), Cells(L + 1, 7)).Sort key1:=Range("A2"), order1:=xlAscending, Header:=xlYes
      Worksheets("TEMPSPEC").Activate
      MsgBox "|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||402||fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & Cells(m, 8)
   End If
   
   Range("C5") = Worksheets("|fffd||394||fffd|\").Cells(Range("B5"), 3)   ' C5 |fffd||394||fffd|\|fffd||313||fffd||fffd||4d1||389||fffd||fffd|\|fffd||30c||68b|q|fffd||fffd|
   Range("D5") = Worksheets("|fffd||394||fffd|\").Cells(Range("B5"), 5)   ' D5 D6 |fffd||394||fffd|\|fffd||303|R|fffd||fffd||fffd||fffd||fffd|g
   
   If Range("C5") <> Empty Then
      Range("E5").Formula = "=VLOOKUP(C5,|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!C3:D207,2,FALSE)"  ' E5|fffd|AE6 |fffd||68b|q|fffd||389||fffd||fffd|\|fffd||315|\|fffd||fffd|
      Range("E6").Formula = "=If(Iserror(E5),"""",IF(E5=0,"""",E5))"
      Range("F5").Formula = "=VLOOKUP(C5,|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!C3:E207,3,FALSE)"  ' F5|fffd|AF6 |fffd||68b|q|fffd||389||fffd||fffd|\|fffd||315||fffd||fffd||fffd||fffd||d3dc|
      Range("F6").Formula = "=If(Iserror(F5),"""",IF(F5=0,"""",F5))"
      Range("G5").Formula = "=VLOOKUP(C5,|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!C3:F207,4,FALSE)"  ' G5|fffd|AG6 |fffd||68b|q|fffd||389||fffd||fffd|\|fffd||315||fffd||fffd||fffd||fffd||d3dc|
      Range("G6").Formula = "=If(Iserror(G5),"""",IF(G5=0,"""",G5))"
   
      '|fffd|@|fffd||3cd|X|fffd||fffd||fffd||fffd|
      ' |fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'      Range("H5").Formula = "=VLOOKUP(C5,|fffd||3cd|X|fffd||fffd||fffd||fffd|!C3:G174,5,FALSE)"
'      Range("H6").Formula = "=If(Iserror(H5),"""",IF(H5=0,"""",H5))"
      ' |fffd|a |fffd||3cd|X|fffd||fffd||fffd||fffd|
'      Range("I5").Formula = "=VLOOKUP(C5,|fffd||3cd|X|fffd||fffd||fffd||fffd|!C3:H174,6,FALSE)"
'      Range("I6").Formula = "=If(Iserror(I5),"""",IF(I5=0,"""",I5))"
      
'      If Range("I6") <> Empty Then
'         Cells(Workareaend + 1, 9) = 1
'         Cells(Workareaend + 2, 9) = Range("I6")
'      End If
      
      ' |fffd|p |fffd||3cd|X|fffd||fffd||fffd||fffd|
'      Range("J5").Formula = "=VLOOKUP(C5,|fffd||3cd|X|fffd||fffd||fffd||fffd|!C3:I174,7,FALSE)"
'      Range("J6").Formula = "=If(Iserror(J5),"""",IF(J5=0,"""",J5))"
      
'      If Range("J6") <> Empty Then
'         Cells(Workareaend + 1, 9) = 1
'         Cells(Workareaend + 3, 9) = Range("J6")
'      End If
      
   End If
   Range("B5:J6").Value = Range("B5:J6").Value

End Sub
Private Sub |fffd|a|fffd|pC(m As Integer, m2 As Integer, |fffd|a|fffd|p As Integer)
   
   Worksheets("TEMPSPEC").Activate
   
   |fffd|a|fffd|p = 0
   If Left(Cells(m, 8), 3) = "|fffd||fffd||fffd|a|fffd||fffd|" Then |fffd|a|fffd|p = 1
   If Mid(Cells(m, 8), 7, 3) = "|fffd||fffd||fffd|p|fffd||fffd|" Then |fffd|a|fffd|p = |fffd|a|fffd|p + 2
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 7) = |fffd|a|fffd|p
   
   '|fffd|@|fffd|{|fffd||fffd||fffd|a|fffd|p|fffd|`|fffd|F|fffd|b|fffd|N|fffd|@|fffd|a|fffd|F|fffd|P|fffd|A|fffd|p|fffd|G|fffd|Q|fffd|A|fffd|a|fffd|p|fffd|F|fffd|R
   m = m2
   |fffd|a|fffd|p = 0
   If Left(Cells(m, 8), 3) = "|fffd||fffd||fffd|a|fffd||fffd|" Then |fffd|a|fffd|p = 1
   If Mid(Cells(m, 8), 7, 3) = "|fffd||fffd||fffd|p|fffd||fffd|" Then |fffd|a|fffd|p = |fffd|a|fffd|p + 2
   Range("C4") = |fffd|a|fffd|p
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(1, 11) = |fffd|a|fffd|p

End Sub
Private Sub |fffd|p|fffd|r(m As Integer, |fffd|a|fffd|p As Integer)
Dim i As Integer
   
   Worksheets("TEMPSPEC").Activate
   If Len(Cells(m, 9)) > 9 Then
      If |fffd|a|fffd|p = 3 Then
         Cells(m, 11) = InStr(Cells(m, 9), "|fffd|p")
         L = Len(Cells(m, 9))
         If Mid(Cells(m, 9), 9, 1) <> "|fffd|p" Then
            Cells(m, 12) = Mid(Cells(m, 9), 4, Cells(m, 11) - 10)
            Cells(m, 13) = Mid(Cells(m, 9), Cells(m, 11) + 3, L - Cells(m, 11) - 5)
         End If
         Cells(m, 11).ClearContents
      Else
         If |fffd|a|fffd|p = 1 Then
            Cells(m, 12) = Mid(Cells(m, 9), 4, Len(Cells(m, 9)) - 3)
            Cells(m, 13) = ""
         Else
            Cells(m, 12) = ""
            Cells(m, 13) = Mid(Cells(m, 9), 4, Len(Cells(m, 9)) - 3)
         End If
      End If
      
      i = InStr(Cells(m, 12), "|fffd|p|fffd|r")
      '20171012_|fffd|p|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||a554||fffd|C|fffd||fffd|_|fffd||fffd||fffd||fffd|
      If i > 0 And i < 3 Then
         Cells(m, 12) = Mid(Cells(m, 12), 3, Len(Cells(m, 12)) - 2)
         If Left(Cells(m, 12), 1) = ":" Or Left(Cells(m, 12), 1) = "|fffd|F" Then Cells(m, 12) = Mid(Cells(m, 12), 2, Len(Cells(m, 12)) - 1)
      End If
      i = InStr(Cells(m, 13), "pplication")
      If i = 2 Then
         Cells(m, 13) = Mid(Cells(m, 13), 12, Len(Cells(m, 13)) - 11)
         If Left(Cells(m, 13), 1) = ":" Or Left(Cells(m, 13), 1) = "|fffd|F" Then Cells(m, 13) = Mid(Cells(m, 13), 2, Len(Cells(m, 13)) - 1)
      End If
      Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 12) & vbCrLf & Cells(m, 13)
   End If
   
   
   

End Sub
Private Sub |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd|(m As Integer)
   
   Worksheets("TEMPSPEC").Activate
   If Left(Cells(m, 8), 1) = "|fffd||fffd|" Then
      If Left(Cells(m, 9), 7) = "|fffd|G|fffd|||fffd|L|fffd|V|fffd|n|fffd||fffd||fffd||fffd|" Then
         Cells(m, 12) = Cells(m, 14)
         Cells(m, 13) = Cells(m, 39)
      End If
   End If

End Sub
Private Sub |fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd|(m As Integer)
Dim i As Integer

   Worksheets("TEMPSPEC").Activate
   If Left(Cells(m, 8), 1) = "|fffd||fffd|" Then
      Cells(m, 10) = 1
      Cells(Cells(m, 6), Cells(m, 7)) = ""
      Cells(m, 11).Formula = "=FIND(""|fffd||fffd|"",RC[-2],RC[-1])"
      If IsError(Cells(m, 11)) Then GoTo End1
      For i = 14 To 18
         If Cells(m, i) = Cells(m, 11) Then Exit For
      Next i
      Cells(m, 12) = Cells(m, i + 12)
      Cells(m, 13) = Cells(m, i + 25)
      If Cells(m, 19) = Cells(m, 11) Then
         Cells(m, 10) = 79
         Cells(m, 11).Formula = "=FIND("" "",RC[-2],RC[-1])"
         Cells(m, 12) = Mid(Cells(m, 9), 79, Cells(m, 11) - 79)
         Cells(m, 13) = Cells(m, 12)
      End If
   Else
      Cells(m, 12) = ""
      Cells(m, 13) = ""
   End If
End1:

End Sub
Private Sub |fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|(m As Integer)
Dim i As Integer, j As Integer
   
    Worksheets("TEMPSPEC").Activate
   If Left(Cells(m, 8), 1) = "|fffd||fffd|" Then
      Cells(m, 10) = 1
      Cells(m, 11).Formula = "=FIND(""|fffd||fffd|"",RC[-2],RC[-1])"
      If IsError(Cells(m, 11)) Then
         Cells(m, 12) = ""
         Cells(m, 13) = ""
      Else
         '|fffd||fffd||fffd|b|fffd|L|fffd|g|fffd||fffd|
         For i = 14 To 22
            If Cells(m, i) = Cells(m, 11) Then
               If i = 14 Then
                  Cells(m, 12) = Cells(m, 28)
                  Cells(m, 13) = Cells(m, 43)
                  Cells(m, 10) = Cells(m, 11) + 1
                  For j = 15 To 18
                     If Cells(m, j) = Cells(m, 11) Then
                        Cells(m, 12) = Cells(m, j + 14)
                        Cells(m, 13) = Cells(m, j + 29)
                     End If
                  Next j
               End If
               If i = 19 Then
                  Cells(m, 12) = Cells(m, 33)
                  Cells(m, 13) = Cells(m, 48)
                  Cells(m, 10) = Cells(m, 11) + 1
                  If Cells(m, 11) = Cells(m, 20) Then
                     Cells(m, 12) = Cells(m, 34)
                     Cells(m, 13) = Cells(m, 49)
                  End If
               End If

' |fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||28f||fffd||fffd||fffd|QAIT|fffd||3cd|X|fffd||389||fffd|_20180410_|fffd||fffd||fffd||fffd|
                    If i = 21 Then
                        Cells(m, 12) = Cells(m, 35)
                        Cells(m, 13) = Cells(m, 50)
                        Cells(m, 10) = Cells(m, 11) + 1
                    End If
               
               
               
               
               If i = 22 Then
                  For j = 113 To 200
                     If Mid(Cells(m, 9), j, 6) = "|fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@" Then
                        Cells(m, 12) = Mid(Cells(m, 9), 113, j - 114)
                        Cells(m, 13) = Mid(Cells(m, 9), 113, j - 114)
                        Exit For
                     End If
                  Next j
               End If
            End If
         Next i
      
          '|fffd|\|fffd||28f||fffd||fffd||fffd|
         Cells(m, 10) = 142
         If IsError(Cells(m, 11)) Then
            Cells(m, 12) = Cells(m, 12)
         Else
            If Left(Cells(m, 8), 1) = "|fffd||fffd|" Then
               For i = 24 To 27
                  If Cells(m, i) = Cells(m, 11) Then
                     Cells(m, 12) = Cells(m, 12) & Cells(m, i + 14)
                     Cells(m, 13) = Cells(m, 13) & Cells(m, i + 29)
                  End If
               Next i
            End If
         End If
      End If
   End If
   Cells(m, 11).ClearContents

End Sub

Private Sub |fffd|O|fffd||fffd|(m As Integer, |fffd|H|fffd||fffd|O|fffd||fffd| As Integer)
   
   |fffd|H|fffd||fffd|O|fffd||fffd| = 0
   Cells(m, 11).Formula = "=IF(ISERROR(FIND(""|fffd||fffd||fffd|O|fffd|H|fffd||fffd|"",RC[-3],1)),0,1)"
   If Cells(m, 11) = 1 Then |fffd|H|fffd||fffd|O|fffd||fffd| = 1
   Cells(m, 11).Formula = "=IF(ISERROR(FIND(""|fffd||fffd||fffd||fffd|H|fffd||fffd|"",RC[-3],1)),0,1)"
   If Cells(m, 11) = 1 Then |fffd|H|fffd||fffd|O|fffd||fffd| = |fffd|H|fffd||fffd|O|fffd||fffd| + 2
   Cells(m, 11).ClearContents

End Sub
Private Sub |fffd||fffd||fffd|Y|fffd||fffd|(m As Integer)
Dim i As Integer, |fffd||fffd||fffd|O|fffd||fffd| As Integer
   
   Call |fffd|O|fffd||fffd|(m, |fffd||fffd||fffd|O|fffd||fffd|)
   Cells(m, 11).Formula = "=FIND(""|fffd||fffd|"",RC[-2],RC[-1])"
   Cells(m, 10) = 1
   If IsError(Cells(m, 11)) Then GoTo Endsub1
   Cells(m, 12) = ""
   Cells(m, 13) = ""
   
   ' |fffd|O|fffd|H|fffd||fffd|
   If |fffd||fffd||fffd|O|fffd||fffd| = 1 Or |fffd||fffd||fffd|O|fffd||fffd| = 3 Then
      Cells(m, 12) = "|fffd|O|fffd|H|fffd||fffd||fffd|F"
      Cells(m, 13) = "Diffused in "
      For i = 2 To 5
         If Cells(12, i) = Cells(m, 11) Then
            Cells(m, 12) = Cells(m, 12) & Cells(12, i + 22) & "|fffd|A"
            Cells(m, 13) = Cells(m, 13) & Cells(12, i + 35) & " or "
            Cells(m, 10) = Cells(12, i) + 1
            If IsError(Cells(m, 11)) Then Exit For
         End If
      Next i
      Cells(m, 12) = Left(Cells(m, 12), Len(Cells(m, 12)) - 1)
      Cells(m, 13) = Left(Cells(m, 13), Len(Cells(m, 13)) - 4)
             
      
   ' |fffd||fffd|H|fffd||fffd|
      If |fffd||fffd||fffd|O|fffd||fffd| = 3 Then
         Cells(m, 10) = 29
         Cells(m, 12) = Cells(m, 12) & "|fffd|A|fffd||fffd|H|fffd||fffd||fffd|F"
         Cells(m, 13) = Cells(m, 13) & vbCrLf & "Assembled in "
         For i = 6 To 13
            If Cells(12, i) = Cells(m, 11) Then
               Cells(m, 12) = Cells(m, 12) & Cells(12, i + 22) & "|fffd|A"
               Cells(m, 13) = Cells(m, 13) & Cells(12, i + 35) & " or "
               Cells(m, 10) = Cells(12, i) + 1
               If IsError(Cells(m, 11)) Then Exit For
            End If
         Next i
         Cells(m, 12) = Left(Cells(m, 12), Len(Cells(m, 12)) - 1)
         Cells(m, 13) = Left(Cells(m, 13), Len(Cells(m, 13)) - 4)
      End If
    End If
    
  ' |fffd||fffd|H|fffd||fffd||fffd||302||fffd|
   If |fffd||fffd||fffd|O|fffd||fffd| = 2 Then
      Cells(m, 10) = 1
      If IsError(Cells(m, 11)) Then GoTo Endsub1
      Cells(m, 12) = " |fffd||fffd|H|fffd||fffd||fffd|F"
      Cells(m, 13) = "Assembled in "
      For i = 15 To 22
         If Cells(12, i) = Cells(m, 11) Then
            Cells(m, 12) = Cells(m, 12) & Cells(12, i + 13) & "|fffd|A"
            Cells(m, 13) = Cells(m, 13) & Cells(12, i + 26) & " or "
            Cells(m, 10) = Cells(12, i) + 1
            If IsError(Cells(m, 11)) Then Exit For
         End If
      Next i
      Cells(m, 12) = Left(Cells(m, 12), Len(Cells(m, 12)) - 1)
      Cells(m, 13) = Left(Cells(m, 13), Len(Cells(m, 13)) - 4)
   End If

Endsub1:
   Cells(m, 11).ClearContents

End Sub
Private Sub |fffd|H|fffd||a5bc|(m As Integer, |fffd|H|fffd||fffd|O|fffd||fffd| As Integer, |fffd|a|fffd|p As Integer, |fffd|Z|fffd||fffd| As Integer)
Dim i As Integer, k As Integer

' |fffd|H|fffd||fffd|O|fffd||fffd|@|fffd|a|fffd|p
'|fffd|@   |fffd|@1     1    |fffd|a
'       2     1|fffd|@|fffd|@|fffd|a
'       3     1|fffd|@|fffd|@|fffd|a|fffd|@|fffd|a
'       1     2    |fffd|p
'       2     2|fffd|@|fffd|@|fffd|p
'       3     2|fffd|@|fffd|@|fffd|p|fffd|@|fffd|p
'       1     3|fffd|@|fffd|@|fffd|a|fffd|@|fffd|p
'       2     3|fffd|@|fffd|@|fffd|a|fffd|@|fffd|p
'       3     3|fffd|@|fffd|@|fffd|a|fffd|@|fffd|p|fffd|@|fffd|a|fffd|@|fffd|p
   
   Range(Cells(m, 12), Cells(m + 1, 13)).ClearContents
   
   Cells(m, 11).Formula = "=FIND(""|fffd||fffd|"",RC[-3],1)"
   If IsError(Cells(m, 11)) Then
      Cells(m, 11).ClearContents
      GoTo End1
   End If
   |fffd|Z|fffd||fffd| = 0
   If Left(Cells(m + 1, 8), 1) = "|fffd||fffd|" Then
      |fffd|Z|fffd||fffd| = 1
      m = m + 1
   End If
   Cells(m, 11).Formula = "=FIND(RC[3],RC[-2],RC[-1])"
   
   ' |fffd||14c||fffd||315|s|fffd|v|fffd||203|X|fffd|y|fffd|[|fffd|X|fffd||fffd|-|fffd||d3dc|
   k = Len(Cells(m, 9))
   For i = 1 To k - 1
      If Right(Cells(m, 9), 1) = " " Or Right(Cells(m, 9), 1) = "|fffd|@" Then
         Cells(m, 9) = Mid(Cells(m, 9), 1, k - 1)
      End If
   Next i
   
   Cells(m, 10) = 1
   If |fffd|a|fffd|p = 1 Or |fffd|a|fffd|p = 3 Then Cells(m, 14) = "|fffd|a"
   If |fffd|a|fffd|p = 2 Then Cells(m, 14) = "|fffd|p"
   k = Cells(m, 11)
   
   Cells(m, 10) = k + 1
   If |fffd|H|fffd||fffd|O|fffd||fffd| = 3 And |fffd|a|fffd|p = 1 Then Cells(m, 14) = "|fffd|a"
   If |fffd|H|fffd||fffd|O|fffd||fffd| = 1 And |fffd|a|fffd|p = 2 Then Cells(m, 14) = "|fffd|p"
   If |fffd|a|fffd|p = 3 Then Cells(m, 14) = "|fffd|p"
   
   If IsError(Cells(m, 11)) Then Cells(m, 11) = Len(Cells(m, 9)) + 11
   
   If |fffd|H|fffd||fffd|O|fffd||fffd| = 1 Or |fffd|H|fffd||fffd|O|fffd||fffd| = 3 Then
      If |fffd|a|fffd|p = 1 Or |fffd|a|fffd|p = 3 Then Cells(m, 12) = "  |fffd|O|fffd|H|fffd||fffd|" & Chr(9) & ": "
      If |fffd|a|fffd|p = 2 Then Cells(m, 13) = "  Pellet process" & Chr(9) & ": "
   End If
   If |fffd|H|fffd||fffd|O|fffd||fffd| = 2 Then
      If |fffd|a|fffd|p = 1 Or |fffd|a|fffd|p = 3 Then Cells(m, 12) = " |fffd||fffd|H|fffd||fffd|(|fffd||702||78c||fffd||fffd||fffd||fffd|H|fffd||fffd|)" & Chr(9) & ":  "
      If |fffd|a|fffd|p = 2 Then Cells(m, 13) = " Assembly process" & Chr(9) & ":  "
   End If
   
   ' |fffd|P|fffd||fffd||fffd||682||313||fffd||fffd||fffd|
   ' |fffd||14f||fffd||fffd||318|a|fffd|@|fffd|p|fffd||30c||fffd||fffd| SP SP CR LF|fffd|@4|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||142|T|fffd||fffd||fffd||fffd||fffd||682||fffd||fffd||fffd|
   ' |fffd||fffd|H|fffd||fffd||fffd|L|fffd||682||311|O|fffd||fffd||fffd| SP CR LF   SP SP CR LF |fffd||fffd|H|fffd||fffd| SP CR LF |fffd|a|fffd|@|fffd||fffd| 9|fffd||fffd||fffd||fffd||fffd||d3dc|
   If |fffd|a|fffd|p = 1 Then Cells(m, 12) = Cells(m, 12) & Mid(Cells(m, 9), k + 5, Cells(m, 11) - k - 17)
   If |fffd|a|fffd|p = 2 Then Cells(m, 13) = Cells(m, 13) & Mid(Cells(m, 9), k + 5, Cells(m, 11) - k - 16)
   If |fffd|a|fffd|p = 3 Then Cells(m, 12) = Cells(m, 12) & Mid(Cells(m, 9), k + 5, Cells(m, 11) - k - 5)

   If IsError(Cells(m, 11)) Then GoTo End1

   '|fffd|Q|fffd||fffd||fffd||696||688||20d|~
   k = Cells(m, 11)
   Cells(m, 10) = k + 1
   
   If IsError(Cells(m, 11)) Then Cells(m, 11) = Len(Cells(m, 9))
   
   If |fffd|H|fffd||fffd|O|fffd||fffd| = 3 Then
      If |fffd|a|fffd|p = 1 Then Cells(m, 12) = Cells(m, 12) & _
         vbCrLf & " |fffd||fffd|H|fffd||fffd|(|fffd||702||78c||fffd||fffd||fffd||fffd|H|fffd||fffd|)" & Chr(9) & ": " & Mid(Cells(m, 9), k + 5, Cells(m, 11) - k - 6)
      If |fffd|a|fffd|p = 2 Then Cells(m, 13) = Cells(m, 13) & _
         vbCrLf & " Assembly process" & Chr(9) & ": " & Mid(Cells(m, 9), k + 5, Cells(m, 11) - k - 6)
      If |fffd|a|fffd|p = 3 Then
         '|fffd|Q|fffd||fffd||fffd||696||fffd|
         Cells(m, 14) = "|fffd|a"
         Cells(m, 13) = " Pellet process: " & Mid(Cells(m, 9), k + 1, Cells(m, 11) - k - 11)
         '|fffd|R|fffd||fffd||fffd||696||fffd|
         k = Cells(m, 11)
         Cells(m, 10) = k + 1
         Cells(m, 14) = "|fffd|p"
         Cells(m, 12) = Cells(m, 12) & "  |fffd||fffd|H|fffd||fffd|(|fffd||702||78c||fffd||fffd||fffd||fffd|H|fffd||fffd|)" & Chr(9) & _
            ": " & Mid(Cells(m, 9), k + 5, Cells(m, 11) - k - 5)
         '|fffd|S|fffd||fffd||fffd||fffd|
         Cells(m, 13) = Cells(m, 13) & "  Assembly process" & Chr(9) & ": " & _
            Mid(Cells(m, 9), Cells(m, 11) + 1, Len(Cells(m, 9)) - Cells(m, 11))
      End If
   End If
   
   k = Len(Cells(m, 12))
   If k > 31 Then
      For i = k - 30 To k
         If Mid(Cells(m, 12), i, 10) = "|fffd|A|fffd|E|fffd|g|fffd|\|fffd|[|fffd|X|fffd||fffd||fffd|[|fffd|J|fffd|[" Then
            Cells(m, 12) = Mid(Cells(m, 12), 1, i - 4)
            Exit For
         End If
      Next i
   End If
   
    If Cells(m, 13) <> Empty Then
        For i = 1 To Len(Cells(m, 13))
            If Right(Cells(m, 13), 1) = " " Or Right(Cells(m, 13), 1) = "-" Then
                Cells(m, 13) = Left(Cells(m, 13), Len(Cells(m, 13)) - 1)
            Else
                Exit For
            End If
        Next i
    End If

End1:
   If |fffd|Z|fffd||fffd| = 0 Then Range(Cells(m, 11), Cells(m + 1, 11)).ClearContents
   If |fffd|Z|fffd||fffd| = 1 Then Range(Cells(m - 1, 11), Cells(m, 11)).ClearContents

End Sub
Private Sub |fffd||fffd||fffd|i|fffd|\|fffd||fffd|(m As Integer)
      
   If Left(Cells(m, 9), 6) = "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
      Cells(m, 12) = Right(Cells(m, 9), Len(Cells(m, 9)) - 9)
   Else
      Cells(m, 12) = Cells(m, 9)
   End If
   Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 12)

End Sub
Private Sub |fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g(m As Integer)
   Cells(m, 11).Formula = "=FIND(""|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd|X|fffd|R|fffd|[|fffd|h"",RC[-2],1)"
   If IsError(Cells(m, 11)) Then
      Cells(m, 11).Formula = "=FIND(""|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd|X|fffd|R|fffd|[|fffd|h|fffd||202||fffd|"",RC[-2],1)"
      If IsError(Cells(m, 11)) Then
         GoTo end|fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g
      Else
         Cells(m, 12) = Cells(2, 13)
         Cells(m, 13) = Cells(3, 13)
      End If
   Else
      Cells(m, 12) = Left(Cells(m, 9), Len(Cells(m, 9)) - 14)
   End If
   Cells(m, 11).ClearContents
   Cells(Cells(m, 6), Cells(m, 7)) = Cells(m, 12)
end|fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g:
   
End Sub
Private Sub |fffd||fffd||fffd||fffd|(Workareaini As Integer, Workareaend As Integer)
Dim i As Integer, j As Integer, k As Integer
Dim Term As String

' |fffd|@ RoHS|fffd|@|fffd|@|fffd|@WorkAreaEnd + 4
'|fffd|@|fffd|@|fffd|n|fffd||fffd||fffd|t|fffd||fffd||fffd|@WorkAreaEnd + 5
'|fffd|@|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||e8||fffd|@WorkAreaEnd + 6
'|fffd|@|fffd|@|fffd|}|fffd|[|fffd|L|fffd||fffd||fffd|OWorkAreaEnd + 7
   
   Range(Cells(Workareaend + 4, 2), Cells(Workareaend + 7, 2)).ClearContents
   
   For i = 4 To 7
      For j = 3 To 10
         If Cells(Workareaend + i, j) <> Empty Then
            Term = Cells(Workareaend + i, j)
            Cells(Workareaini + 35, 11).Formula = "=ISERROR(FIND(""" & Term & """,RC[-3],1))"
            Cells(Workareaini + 35, 12).Formula = "=ISERROR(FIND(""" & Term & """,RC[-3],1))"
            Cells(Workareaini + 35, 13).Formula = "=IF(AND(RC[-2],RC[-1]),0,1)"
            Range(Cells(Workareaini + 35, 11), Cells(Workareaini + 46, 13)).FillDown
            If WorksheetFunction.Sum(Range(Cells(Workareaini + 35, 13), Cells(Workareaini + 46, 13))) = 1 Then _
               Cells(Workareaend + i, 2) = 1
         End If
      Next j
   Next i
   
   Range(Cells(Workareaini + 35, 11), Cells(Workareaini + 46, 13)).ClearContents

End Sub
Private Sub |fffd|Z|fffd||fffd||fffd||48f|W(m As Integer, |fffd|a|fffd|p As Integer)
Dim i As Integer, j As Integer
Dim t As String, T1 As String, T2 As String, T3 As String

   T1 = ":" & vbCrLf & Chr(9)
   T2 = vbCrLf & Chr(9) & " |fffd|^"
   T3 = vbCrLf & Chr(9) & " /"
   j = 0
   
   Worksheets("TEMPSPEC").Activate
     
   If |fffd|a|fffd|p = 1 Or |fffd|a|fffd|p = 3 Then
      Cells(m, 10) = 1
      Cells(m, 11).Formula = "=FIND(CHAR(10),RC[1],RC[-1])"
      k = 1
      Do While k = 1
         If IsError(Cells(m, 11)) Then
           k = 0
         Else
            If j = Cells(m, 11) Then Exit Do
            j = Cells(m, 11)
            t = Mid(Cells(m, 12), j + 1, 1)
            If t <> " " And t <> "|fffd|" Then
               Cells(m, 12) = Mid(Cells(m, 12), 1, j) & Chr(9) & _
               Mid(Cells(m, 12), j + 1, Len(Cells(m, 12)) - j)
            End If
            Cells(m, 10) = j + 2
         End If
      Loop
      Cells(m, 12) = Replace(Cells(m, 12), T1, T2)
      j = Len(Cells(m, 12))
      For i = 1 To 10
         If Mid(Cells(m, 12), j - i, 1) = ": " Then _
            Cells(m, 12) = Mid(Cells(m, 12), 1, j - i - 1)
      Next i
   End If
   
   If |fffd|a|fffd|p = 2 Or |fffd|a|fffd|p = 3 Then
      Cells(m, 10) = 1
      Cells(m, 11).Formula = "=FIND(CHAR(10),RC[2],RC[-1])"
      k = 1
      Do While k = 1
         If IsError(Cells(m, 11)) Then
           k = 0
         Else
            If j = Cells(m, 11) Then Exit Do
            j = Cells(m, 11)
            t = Mid(Cells(m, 13), j + 1, 1)
            If t <> " " And t <> "|fffd|" Then
               Cells(m, 13) = Mid(Cells(m, 13), 1, j) & Chr(9) & _
               Mid(Cells(m, 13), j + 1, Len(Cells(m, 13)) - j)
            End If
            Cells(m, 10) = j + 2
         End If
      Loop
      Cells(m, 13) = Replace(Cells(m, 13), T1, T3)
      j = Len(Cells(m, 13))
      For i = 1 To 10
         If Mid(Cells(m, 13), j - i, 1) = ": " Then _
            Cells(m, 13) = Mid(Cells(m, 13), 1, j - i - 1)
      Next i
   End If
      
End Sub
Sub |fffd||c42c||fffd|V|fffd|[|fffd|g()
Dim i As Integer, j As Integer, m As Integer, SheetName As String, Col As Integer
Dim |fffd|J|fffd|n|fffd|s As Integer, Flag As Integer, |fffd|a As Integer, |fffd|p As Integer, |fffd|Z|fffd||fffd| As Integer, |fffd|a|fffd|p As Integer

   Worksheets("TEMPSPEC").Activate

   |fffd|J|fffd|n|fffd|s = Range("A4")
   |fffd||fffd||18d||14c||fffd| = Range("B4")
   Flag = Range("B4") + 1
   |fffd|a = Range("B4") + 2
   |fffd|p = Range("B4") + 3
   |fffd|a|fffd|p = Range("C4")
   |fffd|Z|fffd||fffd| = Range("D4")
   
'|fffd|@|fffd|p|fffd|r|fffd|@|fffd|@|fffd|@|fffd|@      2 B
'  |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd||fffd||fffd|  |fffd|@3 C
'  |fffd||fffd||fffd|i|fffd||fffd||fffd||281|@|fffd|@|fffd|@  |fffd|@4 D
'  |fffd|R|fffd|v|fffd||fffd||fffd|i|fffd||fffd||fffd|e|fffd|B  |fffd|@5 E
'|fffd|@|fffd|}|fffd|[|fffd|L|fffd||fffd||fffd|O|fffd|@|fffd|@  |fffd|@6 F
'  |fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|  7 G

'|fffd|@|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@|fffd|@  8 H
'  |fffd|x|fffd|[|fffd|L|fffd||fffd||fffd|O|fffd|@|fffd|@|fffd|@|fffd|@9 I

'|fffd|@|fffd||fffd||fffd|Y|fffd||fffd||fffd|H|fffd||fffd|@ |fffd|@|fffd|@20 T
'|fffd|@|fffd||fffd||fffd||f3bf||fffd||281|@|fffd|@ |fffd|@|fffd|@21 U
'  |fffd|o|fffd|[|fffd|R|fffd|[|fffd|h|fffd|@|fffd|@|fffd|@ 22 V

'  RoHS             30 AD
'  |fffd|n|fffd||fffd||fffd|t|fffd||fffd||fffd|@|fffd|@|fffd|@ |fffd|@31 AE
'  |fffd||3cd|X|fffd||8b||fffd||fffd||fffd||fffd||fffd|     32 AF

   
   
' ================== |fffd|f|fffd|[|fffd|^|fffd||c42c| (|fffd|O|fffd||fffd||fffd||fffd|)================


   Range(Cells(Flag, 2), Cells(Flag, 50)) = 0
   Range(Cells(|fffd|a, 2), Cells(|fffd|p, 50)) = ""
   
   m = |fffd|J|fffd|n|fffd|s + 34
   Col = 2
   If Cells(m, 12) <> Empty Then
      Cells(Flag, Col) = 1
      Cells(|fffd|a, Col) = Range("A2") & Chr(9) & ": " & Cells(m, 12)
   End If
   If Cells(m, 13) <> Empty Then
      Cells(Flag, Col) = 1
      Cells(|fffd|p, Col) = Range("A3") & Chr(9) & ": " & Cells(m, 13)
   End If
   
   
   ' |fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd||78e||fffd||fffd|A|fffd||fffd||fffd|[|fffd|h|fffd||78e||fffd||fffd|A|fffd|\|fffd||28f||fffd||fffd||fffd|
   For i = 1 To 3
      m = |fffd|J|fffd|n|fffd|s + 25 + i
      Col = 3
      If Left(Cells(m, 8), 1) = "|fffd||fffd|" Then
         Cells(Flag, Col) = 1
         Cells(|fffd|a, Col) = Cells(|fffd|a, 3) & Cells(2, i + 1) & Chr(9) & ": " & Cells(m, 12) & vbCrLf
         Cells(|fffd|p, Col) = Cells(|fffd|p, 3) & Cells(3, i + 1) & Chr(9) & ": " & Cells(m, 13) & vbCrLf
      End If
   Next i
   
   ' |fffd||fffd||fffd||fffd|
   m = |fffd|J|fffd|n|fffd|s + 33
   Col = 4
   If Left(Cells(m, 8), 1) = "|fffd||fffd|" And Left(Cells(m, 9), 6) <> "|fffd||fffd|TD|fffd|L|fffd||68d||fffd|" Then
      Cells(Flag, Col) = 1
      If |fffd|a|fffd|p = 1 Then Cells(|fffd|a, Col) = Cells(2, 10) & Chr(9) & ": " & Mid(Cells(m, 9), 4, Len(Cells(m, 9)) - 4)
      If |fffd|a|fffd|p = 2 Then Cells(|fffd|p, Col) = Cells(3, 10) & Chr(9) & ": " & Mid(Cells(m, 9), 4, Len(Cells(m, 9)) - 4)
      If |fffd|a|fffd|p = 3 Then
         Cells(m, 11).Formula = "=FIND(""|fffd|p"",RC[-2],1)"
         Cells(|fffd|a, Col) = Cells(2, 10) & Chr(9) & ": " & Mid(Cells(m, 9), 4, Cells(m, 11) - 4)
         Cells(|fffd|p, Col) = Cells(3, 10) & Chr(9) & ": " & _
             Mid(Cells(m, 9), Cells(m, 11) + 3, Len(Cells(m, 9)) - Cells(m, 11) - 3)
      End If
   End If
   
   ' |fffd|R|fffd|v|fffd||fffd||fffd|i|fffd||fffd||fffd|e|fffd|B
   m = |fffd||fffd||18d||14c||fffd| + 6
   If Cells(m, 2) = 1 Then
      Col = 5
      Cells(Flag, Col) = 1
      Cells(|fffd|a, Col) = Cells(2, 11) & Chr(9) & ": 0.1mm MAX"
      Cells(|fffd|p, Col) = Cells(3, 11) & Chr(9) & ": 0.1mm MAX"
   End If
   
   
   
   m = |fffd|J|fffd|n|fffd|s + 51
   Col = 7
   Cells(m, 11).Formula = "=FIND(""|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd|X|fffd|R|fffd|[|fffd|h|fffd||202||fffd|"",RC[-2],1)"
   If IsError(Cells(m, 11)) Then
      GoTo Skip|fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g
   Else
      Cells(Flag, Col) = 1
      Cells(|fffd|a, Col) = Cells(2, 13)
      Cells(|fffd|p, Col) = Cells(3, 13)
   End If
Skip|fffd||fffd||fffd|i|fffd||fffd||fffd|b|fffd|g:

   
   ' |fffd||fffd||fffd|Y|fffd||fffd|
   m = |fffd|J|fffd|n|fffd|s + 29
   Col = 20
   Cells(m, 11).Formula = "=FIND(""|fffd||fffd|"",RC[-2],1)"
   If IsError(Cells(m, 11)) Then GoTo Skip|fffd||fffd||fffd|Y|fffd||fffd|
   Cells(Flag, Col) = 1
   Cells(|fffd|a, Col) = Cells(2, 5) & Chr(9) & ":  " & Cells(m, 12) & vbCrLf
   Cells(|fffd|p, Col) = Cells(3, 5) & Chr(9) & ":  " & Cells(m, 13) & vbCrLf
Skip|fffd||fffd||fffd|Y|fffd||fffd|:
   Cells(m, 11).ClearContents
   
   ' |fffd|H|fffd||fffd||18f|Z|fffd||fffd|
   m = |fffd|J|fffd|n|fffd|s + 30
   Cells(m, 11).Formula = "=FIND(""|fffd||fffd|"",RC[-3],1)"
   If IsError(Cells(m, 11)) Then
      GoTo Skip|fffd|H|fffd||fffd|
   Else
      If |fffd|Z|fffd||fffd| = 0 Then
         Cells(Flag, Col) = 1
         Cells(|fffd|a, Col) = Cells(|fffd|a, Col) & vbCrLf & Cells(2, 6) & vbCrLf & Cells(m, 12)
         Cells(|fffd|p, Col) = Cells(|fffd|p, Col) & vbCrLf & Cells(3, 6) & vbCrLf & Cells(m, 13)
         Cells(|fffd|a, Col) = Replace(Cells(|fffd|a, Col), vbCrLf, vbCrLf & Chr(9))
         Cells(|fffd|p, Col) = Replace(Cells(|fffd|p, Col), vbCrLf, vbCrLf & Chr(9))
         Cells(|fffd|a, Col) = Replace(Cells(|fffd|a, Col), Chr(9) & "  |fffd|O|fffd|H|fffd||fffd|", " |fffd|O|fffd|H|fffd||fffd|")
         Cells(|fffd|p, Col) = Replace(Cells(|fffd|p, Col), Chr(9) & "  Pellet process", "  Pellet process")
         Cells(|fffd|a, Col) = Replace(Cells(|fffd|a, Col), Chr(9) & " |fffd||fffd|H|fffd||fffd|", "|fffd||fffd|H|fffd||fffd|")
         Cells(|fffd|p, Col) = Replace(Cells(|fffd|p, Col), Chr(9) & " Assembly process", " Assembly process")
         Cells(|fffd|a, Col) = Replace(Cells(|fffd|a, Col), Chr(9) & "|fffd|E|fffd||fffd||fffd|Y|fffd|H|fffd||fffd|", "|fffd|E|fffd||fffd||fffd|Y|fffd|H|fffd||fffd|")
         Cells(|fffd|p, Col) = Replace(Cells(|fffd|p, Col), Chr(9) & "|fffd|Producing", "|fffd|Producing")
      Else
         j = m + 1
         Cells(Flag, Col) = 1
         Call |fffd|Z|fffd||fffd||fffd||48f|W(j, |fffd|a|fffd|p)
         Cells(|fffd|a, Col) = Cells(|fffd|a, Col) & Cells(2, 6) & vbCrLf & Cells(j, 12)
         Cells(|fffd|p, Col) = Cells(|fffd|p, Col) & Cells(3, 6) & vbCrLf & Cells(j, 13)
      End If
   End If
Skip|fffd|H|fffd||fffd|:
   
   ' RoHS
   m = |fffd|J|fffd|n|fffd|s + 32
   Col = 30
   If Left(Cells(m, 8), 1) = "|fffd||fffd|" Then
      Cells(Flag, Col) = 1
      Cells(|fffd|a, Col) = Cells(2, 8)
      Cells(|fffd|p, Col) = Cells(3, 8)
   End If
   
   ' |fffd|n|fffd||fffd||fffd|t|fffd||fffd|
   m = |fffd||fffd||18d||14c||fffd| + 5
   
   If Cells(m, 2) = 1 Then
      Col = 31
      Cells(Flag, Col) = 1
      Cells(|fffd|a, Col) = Cells(2, 9)
      Cells(|fffd|p, Col) = Cells(3, 9)
   End If
   
   
   ' |fffd||3cd|X|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
   Col = 32
   If Cells(5, 9) <> Empty And Cells(6, 9) <> Empty Then
      Cells(Flag, Col) = 1
      Cells(|fffd|a, Col) = Cells(5, 9)
      Cells(|fffd|p, Col) = Cells(6, 9)
   End If

   
'========== |fffd||c42c||fffd|V|fffd|[|fffd|g|fffd|L|fffd||fffd| ==============================================
   
   SheetName = "|fffd||c42c||fffd|V|fffd|[|fffd|g"
   
   Col = 5
   
   Worksheets(SheetName).Activate
   Range(Cells(2, Col), Cells(50, Col + 1)).ClearContents
   
   Worksheets("TEMPSPEC").Activate
   
   If |fffd|a|fffd|p = 2 Then GoTo |fffd||c42c|1

   For i = 2 To 40
      If Cells(Flag, i) = 1 Then _
         Worksheets(SheetName).Cells(i, Col) = Cells(|fffd|a, i)
   Next i

|fffd||c42c|1:
   
   If |fffd|a|fffd|p = 1 Then GoTo |fffd||c42c|2
   Col = 6
   For i = 2 To 40
      If Cells(Flag, i) = 1 Then _
         Worksheets(SheetName).Cells(i, Col) = Cells(|fffd|p, i)
   Next i

|fffd||c42c|2:

   Worksheets("|fffd||c42c||fffd|V|fffd|[|fffd|g").Activate

End Sub
Private Sub |fffd|H|fffd||fffd|Z|fffd||fffd|(|fffd|Z|fffd||fffd| As Integer, Workareaend As Integer)
Term As String

   Jyusyo = |fffd|Z|fffd||fffd|
   If Jyusyo = 0 Then
      Cells(Workareaend + 2, 5) = Cells(Workareaend + 2, 5) & vbCrLf & "|fffd|E|fffd||fffd||fffd|Y|fffd|H|fffd||fffd|" & vbLf & "|fffd|@" & Cells(m, 12)
      Cells(Workareaend + 3, 5) = Cells(Workareaend + 3, 5) & vbCrLf & "|fffd|Producing works" & vbCrLf & " " & Cells(m, 13)
   Else
      Term = vbCr & vbLf
      Term1 = vbCr & vbLf & Chr(9) & Chr(9)
      Cells(m + 1, 12) = Replace(Cells(m + 1, 12), Term, Term1)
      Term = ": " & vbCr & vbLf
      Term1 = vbCr & vbLf & Chr(9) & Chr(9) & "|fffd|^"
      Cells(m + 1, 12) = Replace(Cells(m + 1, 12), Term, Term1)
      Term1 = vbCr & vbLf & Chr(9) & Chr(9) & "/"
      Cells(m + 1, 13) = Replace(Cells(m + 1, 13), Term, Term1)
      Cells(Workareaend + 2, 5) = Cells(Workareaend + 2, 5) & vbCrLf & _
         "|fffd|E|fffd||fffd||fffd|Y|fffd|H|fffd||fffd|" & vbCrLf & "|fffd|@" & Cells(m + 1, 12)
      Cells(Workareaend + 3, 5) = Cells(Workareaend + 3, 5) & vbCrLf & _
         "|fffd|Producing works" & vbCrLf & "  " & Cells(m + 1, 13)
   End If

End Sub
Private Sub |fffd|d|fffd|l|fffd||fffd|(WebDataIniY As Integer, Ougi As Integer)
Dim i As Integer, j As Integer, k As Integer, L As Integer, l2 As Integer
Dim Number_Term As Integer, OffsetR As Integer, OffsetC As Integer

   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
   ' |fffd||fffd|\|fffd||fffd||fffd|s|fffd||30d||115|\|fffd||fffd|
   Rows("2:100").EntireRow.Hidden = False
   ' |fffd|\|fffd||30d||14c||fffd||30d|s
   Number_Term = Range("A2").End(xlDown).Row
   
   ' |fffd|L|fffd||693||fffd||fffd|e|fffd||303|N|fffd||fffd||fffd|A
   Range(Cells(2, 5), Cells(Number_Term, 5)).ClearContents
   Range(Cells(2, 11), Cells(Number_Term, 11)).ClearContents
   
   Worksheets("TEMPSPEC").Activate
   
   For i = 2 To Number_Term
   
      
      If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 3) <> Empty Or Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 3) > -100 Then
         Term = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 2)
         OffsetR = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 3)
         OffsetC = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 4)
         L = Len(Term)

         For j = WebDataIniY To WebDataIniY + 200
            For k = 1 To 10
               If Cells(j, k) = Term Then
                  Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 5) = Cells(j + OffsetR, k + OffsetC)
                  GoTo |fffd|d|fffd|l|fffd||fffd|1
               End If
            Next k
         Next j
      End If
|fffd|d|fffd|l|fffd||fffd|1:
      
      If (Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 8) <> Empty Or Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 8) > -100) _
         And Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 10) = 0 Then
         Term = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 7)
         OffsetR = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 8)
         OffsetC = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 9)
         L = Len(Term)

         For j = WebDataIniY To WebDataIniY + 200
            For k = 1 To 10
               If Cells(j, k) = Term Then
                  Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 11) = Cells(j + OffsetR, k + OffsetC)
                  GoTo |fffd|d|fffd|l|fffd||fffd|2
               End If
            Next k
         Next j
      End If
|fffd|d|fffd|l|fffd||fffd|2:
   Next i

   ''|fffd||fffd||fffd|Z|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|E|fffd||fffd||fffd||fffd||fffd|@|fffd||20d|~
   For i = 10 To Number_Term
      If Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 8) <> Empty Or Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 8) > -100 Then
         Term = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 7)
         OffsetR = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 8)
         OffsetC = Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 9)
      
         For j = Ougi To WebDataIniY + 200
            For k = 1 To 10
               If Cells(j, k) = Term And Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 10) = 1 Then
                  Worksheets("|fffd|d|fffd|l|fffd||fffd|").Cells(i, 11) = Cells(j + OffsetR, k + OffsetC)
                  GoTo |fffd|d|fffd|l|fffd||fffd|3
               End If
            Next k
         Next j
      End If
|fffd|d|fffd|l|fffd||fffd|3:
   Next i
   
   '         A5|fffd|F|fffd||fffd||fffd||4d6||fffd||fffd|i|fffd||2d7||fffd||fffd||fffd||fffd|j
   '|fffd|@G2  |fffd||fffd| B5|fffd|F|fffd||394||fffd|\|fffd||30d|s|fffd||50d||fffd|
   '|fffd|@       C5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||30e||416||fffd|
   '|fffd|@K17 |fffd||fffd| D5|fffd|F|fffd||394||fffd|\|fffd||303|R|fffd||fffd||fffd||fffd||fffd|g
   '|fffd|@K6  |fffd||fffd| E5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||315|\|fffd||fffd||fffd||50d||fffd|
   '|fffd|@K19 |fffd||fffd| F5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||312||fffd||fffd||4d5||fffd||fffd||fffd||fffd||d3dc|
   '|fffd|@K9  |fffd||fffd| G5|fffd|F|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd||fffd||30c||95||291||389||fffd|
   '|fffd|@E30 |fffd||fffd| H5|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
   '|fffd|@E31 |fffd||fffd| I5|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|@|fffd|a
   '|fffd|@K31 |fffd||fffd| J5|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|@|fffd|p

   ' |fffd||394||fffd|\|fffd||30d|s|fffd||50d||fffd||fffd|@B2
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("G2") = Range("B5")
   ' |fffd||68b|q|fffd||283|R|fffd||fffd||fffd||fffd||fffd|g
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("K17") = Range("D5")
   ' |fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd| |fffd||315|\|fffd||fffd||fffd||30d|\|fffd||fffd|
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("K6") = Range("E6")
   
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("K19") = Range("F6")
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("K9") = Range("G6")
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("E30") = Range("H6")
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("E31") = Range("I6")
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Range("K31") = Range("J6")
   
   Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
   
   Range("E2:E100").WrapText = True
   Range("E2:E100").Rows.AutoFit
   Range("K2:K100").WrapText = True
   Range("K2:K100").Rows.AutoFit

   For j = 2 To Number_Term
      ' |fffd|E|fffd||303|X|fffd|y|fffd|[|fffd|X|fffd|A|fffd||fffd||fffd|s|fffd||fffd||fffd||d3dc|
      k = Len(Cells(j, 5))
      m = k
      For L = 1 To k - 1
         If Right(Cells(j, 5), 1) = " " Or Right(Cells(j, 5), 1) = "|fffd|@" Or _
            Right(Cells(j, 5), 1) = vbCr Or Right(Cells(j, 5), 1) = vbLf Then
            Cells(j, 5) = Left(Cells(j, 5), m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L
      k = Len(Cells(j, 11))
      m = k
      For L = 1 To k - 1
         If Right(Cells(j, 11), 1) = " " Or Right(Cells(j, 11), 1) = "|fffd|@" Or _
            Right(Cells(j, 11), 1) = vbCr Or Right(Cells(j, 11), 1) = vbLf Then
            Cells(j, 11) = Left(Cells(j, 11), m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L
      
      ' |fffd||fffd||fffd||303|X|fffd|y|fffd|[|fffd|X|fffd|A|fffd||fffd||fffd|s|fffd||fffd||fffd||d3dc|
      k = Len(Cells(j, 5))
      m = k
      For L = 1 To k
         If Left(Cells(j, 5), 1) = " " Or Left(Cells(j, 5), 1) = "|fffd|@" Or _
            Left(Cells(j, 5), 1) = vbLf Or Left(Cells(j, 5), 1) = vbCr Then
            Cells(j, 5) = Mid(Cells(j, 5), 2, m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L
      k = Len(Cells(j, 11))
      m = k
      For L = 1 To k
         If Left(Cells(j, 11), 1) = " " Or Left(Cells(j, 11), 1) = "|fffd|@" Or _
            Left(Cells(j, 11), 1) = vbLf Or Left(Cells(j, 11), 1) = vbCr Then
            Cells(j, 11) = Mid(Cells(j, 11), 2, m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L
   Next j

   ' |fffd|L|fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
   LineNo = 51
   l2 = Range(Cells(LineNo, 1), Cells(LineNo, 1)).End(xlDown).Row
   Range(Cells(10, 12), Cells(19, 13)).ClearContents
   Range(Cells(LineNo, 11), Cells(l2, 11)).ClearContents
   
   Range("L9").Formula = "=IF(ISERROR(FIND($L$8,E9,1)),0,1)"
   Range("L9:L18").FillDown
   Range("L10:M18").FillRight
   Range("L9").Copy Range("L48")
   Range("L9").Copy Range("M48")
   
   For i = 10 To 19
      Cells(i, 12).Formula = "=IF(ISERROR(FIND(R8C12,RC[-7],1)),0,1)"
      Cells(i, 13).Formula = "=IF(ISERROR(FIND(R8C12,RC[-2],1)),0,1)"
   Next i
   
   For i = LineNo To l2
      If Cells(i, 5) = Empty Then Exit For
      L = Len(Cells(i, 5))
      k = 1
      For j = 1 To L
         If Mid(Cells(i, 5), j, 1) = "|fffd|A" Then
            Term = Mid(Cells(i, 5), k, j - k)
            k = j + 1
            Range("L8") = Term
            For m = 9 To 18
               If Cells(m, 12) = 1 Then _
                  Cells(i, 11) = Cells(i, 11) & "/" & Term & ": " & Cells(m, 1) & vbCrLf
               If Cells(m, 13) = 1 Then _
                  Cells(i, 11) = Cells(i, 11) & "/" & Term & ": " & "|fffd||fffd|)" & Cells(m, 7) & vbCrLf
            Next m
         End If
      Next j
      Term = Mid(Cells(i, 5), k, L - k + 1)
      Range("L8") = Term
      For m = 9 To 18
         If Cells(m, 12) = 1 Then _
            Cells(i, 11) = Cells(i, 11) & "/" & Term & ": " & Cells(m, 1)
         If Cells(m, 13) = 1 Then _
            Cells(i, 11) = Cells(i, 11) & "/" & Term & ": " & "|fffd||fffd|)" & Cells(m, 7)
      Next m
   Next i

 
   For i = LineNo To l2
      L = Len(Cells(i, 11))
      If Right(Cells(i, 11), 1) = vbLf Then Cells(i, 11) = Mid(Cells(i, 11), 1, L - 2)
   Next i

   Range("E6") = Range("K51")
   Range("E24") = Range("K52")
   Range("K29") = Range("K53")
   Range("K30") = Range("K54")
   Range("K34") = Range("K55")
   
   Range(Cells(8, 12), Cells(50, 13)).ClearContents
      
      ' |fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||314||fffd|\|fffd||fffd|
   For j = 2 To Number_Term
      If j > 8 Then
         If (Cells(j, 5) = "  " Or Cells(j, 5) = " " _
         Or Cells(j, 5) = Empty Or Right(Cells(j, 5), 1) = "|fffd||fffd|" Or _
         (Left(Cells(j, 5), 1) = "|fffd||fffd|" And Len(Cells(j, 5)) < 6) Or _
         Right(Cells(j, 5), 1) = "|fffd|a" Or Right(Cells(j, 5), 1) = "|fffd|p") And _
         Cells(j, 11) = Empty Then Rows(j).EntireRow.Hidden = True
      End If
   Next j
   
   Rows(8).RowHeight = 13.5
   ' ODS
   If Left(Cells(8, 5), 1) = "|fffd||fffd|" And Left(Cells(8, 11), 1) = "|fffd||fffd|" Then Rows(8).EntireRow.Hidden = True
   ' |fffd||fffd||fffd||fffd|p|fffd|r
   If Right(Cells(20, 11), 1) = "|fffd|a" Or Right(Cells(20, 11), 1) = "|fffd|p" Then Rows(20).EntireRow.Hidden = True
   ' |fffd||fffd||fffd|b|fffd|g|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|
   If Left(Cells(33, 5), 1) = "|fffd||fffd|" And Left(Cells(33, 11), 1) = "|fffd||fffd|" Then Rows(33).EntireRow.Hidden = True
   
   ' |fffd||fffd||fffd|s|fffd||311|}|fffd||fffd|
'   GoTo Skip2
   m = 5
   For i = 9 To Number_Term
      If i <> 26 And i <> 27 Then
         L = Len(Cells(i, m))
         k = L
         Term = Cells(i, m)
         For j = 2 To L - 1
            If Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Or _
               Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Then
               If Mid(Term, j - 1, 1) <> vbLf Then
                  Term = Mid(Term, 1, j - 1) & vbCrLf & Mid(Term, j, k - j + 1)
                  k = k + 2
               End If
            End If
         Next j
         Cells(i, m) = Term
      End If
   Next i
   
   m = 11
   For i = 10 To Number_Term
      L = Len(Cells(i, m))
      k = L
      Term = Cells(i, m)
      For j = 2 To L - 1
         If Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Or _
            Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Or Mid(Term, j, 1) = "|fffd||fffd|" Then
            If Mid(Term, j - 1, 1) <> vbLf Then
               Term = Mid(Term, 1, j - 1) & vbCrLf & Mid(Term, j, k - j + 1)
               k = k + 2
            End If
         End If
      Next j
      Cells(i, m) = Term
   Next i

Skip2:
End Sub
Private Sub SpecList(WebDataIniY As Integer, Ougi As Integer)
Dim i As Integer, j As Integer, k As Integer, L As Integer, m As Integer
Dim StartCol As Integer, EndCol As Integer, LineNo As Integer
Dim Term As String
Dim OffsetR As Integer, OffsetC As Integer


   Worksheets("SpecList").Activate
   StartCol = 2
   EndCol = Range("B2").End(xlToRight).Column
   LineNo = Range("A4").End(xlDown).Row
      
   Worksheets("TEMPSPEC").Activate
   
   j = LineNo + 1
   For i = 6 To LineNo
      If Worksheets("SpecList").Cells(i, 1) = Range("B205") Then    '|fffd|d|fffd|l|fffd||fffd||fffd||50d||fffd|
         j = i
         Exit For
      End If
   Next i
   LineNo = j
   
   Worksheets("SpecList").Cells(LineNo, 1) = Range("B205")
   
   For i = StartCol To EndCol
      Term = Worksheets("SpecList").Cells(2, i)
      OffsetR = Worksheets("SpecList").Cells(3, i)
      OffsetC = Worksheets("SpecList").Cells(4, i)

      For j = WebDataIniY To WebDataIniY + 200
         For k = 1 To 10
            If Cells(j, k) = Term Then
               Worksheets("SpecList").Cells(LineNo, i) = Cells(j + OffsetR, k + OffsetC)
               GoTo SpecList1
            End If
         Next k
      Next j
SpecList1:
   Next i
   
   Worksheets("SpecList").Activate
   StartCol = Range(Cells(2, EndCol), Cells(2, EndCol)).End(xlToRight).Column
   EndCol = Range(Cells(2, StartCol), Cells(2, StartCol)).End(xlToRight).Column
   Worksheets("TEMPSPEC").Activate
   
   For i = StartCol To EndCol
      Term = Worksheets("SpecList").Cells(2, i)
      OffsetR = Worksheets("SpecList").Cells(3, i)
      OffsetC = Worksheets("SpecList").Cells(4, i)

      For j = Ougi To 400
         For k = 1 To 10
            If Cells(j, k) = Term Then
               Worksheets("SpecList").Cells(LineNo, i) = Cells(j + OffsetR, k + OffsetC)
               GoTo SpecList2
            End If
         Next k
      Next j
SpecList2:
   Next i

End Sub
Private Sub Disp(WebDataIniY As Integer, Ougi As Integer)
Dim i As Integer, j As Integer, k As Integer, L As Integer, m As Integer
Dim SerchWordEnd As Integer
Dim Number_Term As integr, OffsetR As intgeger, OffsetC As Integer

   ' |fffd|p|fffd||a31f||fffd||fffd|
   If Worksheets("Disp").Cells(51, 1) <> Empty Then
      SerchWordEnd = 51
      If Worksheets("Disp").Cells(52, 1) <> Empty Then SerchWordEnd = Worksheets("Disp").Range("A51").End(xlDown).Row
      k = 51
      Range(Cells(Workareaini + 35, 13), Cells(Workareaini + 45, (SerchWordEnd - k) * 2 + 13)) = 0
      For i = k To SerchWordEnd
         Term = Worksheets("Disp").Cells(i, 1)
         For j = 35 To 46
            Cells(Workareaini + j, 11).Formula = "=FIND(""" & Term & """,RC[-3],1)"
            Cells(Workareaini + j, 12).Formula = "=if(ISERROR(RC[-1]),0,1)"
            If Cells(Workareaini + j, 12) = 1 Then Cells(Workareaini + j, i - k + 13) = 1
            Cells(Workareaini + j, 11).Formula = "=FIND(""" & Term & """,RC[-2],1)"
            Cells(Workareaini + j, 12).Formula = "=if(ISERROR(RC[-1]),0,1)"
            If Cells(Workareaini + j, 12) = 1 Then _
               Cells(Workareaini + j, i + SerchWordEnd + 13 - 2 * k) = 1
         Next j
      Next i
   End If
   
   Worksheets("Disp").Activate
   
   Number_Term = Range("B2").End(xlDown).Row
   '|fffd||a39e||fffd|I|fffd||203|G|fffd||fffd||fffd|A|fffd||243|N|fffd||fffd||fffd|A
   Range("E61:E63").ClearContents
      
   Worksheets("Disp").Activate
   Rows("2:100").EntireRow.Hidden = False
   Worksheets("TEMPSPEC").Activate
   
   '
   For i = 2 To Number_Term
      Term = Worksheets("Disp").Cells(i, 2)
      OffsetR = Worksheets("Disp").Cells(i, 3)
      OffsetC = Worksheets("Disp").Cells(i, 4)
      L = Len(Term)

      For j = WebDataIniY To WebDataIniY + 200
         For k = 1 To 10
            If Cells(j, k) = Term Then
               Worksheets("Disp").Cells(i, 5) = Cells(j + OffsetR, k + OffsetC)
               GoTo bbb
            End If
         Next k
      Next j
bbb:
   Next i
   
   
   ''|fffd||fffd||fffd|Z|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|E|fffd||fffd||fffd||fffd||fffd|@|fffd||20d|~
   For i = 11 To Number_Term
      Term = Worksheets("Disp").Cells(i, 7)
      OffsetR = Worksheets("Disp").Cells(i, 8)
      OffsetC = Worksheets("Disp").Cells(i, 9)
      
      For j = Ougi To WebDataIniY + 200
         For k = 1 To 10
            If Cells(j, k) = Term Then
               Worksheets("Disp").Cells(i, 10) = Cells(j + OffsetR, k + OffsetC)
               GoTo ccc
            End If
         Next k
      Next j
ccc:
   Next i
   
   
   
   Worksheets("Disp").Activate

   Range("E2:E100").WrapText = True
   Range("E2:E100").Rows.AutoFit

   For j = 2 To Number_Term
      
      ' |fffd|E|fffd||303|X|fffd|y|fffd|[|fffd|X|fffd|A|fffd||fffd||fffd|s|fffd||fffd||fffd||d3dc|
      k = Len(Cells(j, 5))
      m = k
      For L = 1 To k - 1
         If Right(Cells(j, 5), 1) = " " Or Right(Cells(j, 5), 1) = "|fffd|@" Or _
            Right(Cells(j, 5), 1) = vbCr Or Right(Cells(j, 5), 1) = vbLf Then
            Cells(j, 5) = Left(Cells(j, 5), m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L
      k = Len(Cells(j, 11))
      m = k
      For L = 1 To k - 1
         If Right(Cells(j, 11), 1) = " " Or Right(Cells(j, 11), 1) = "|fffd|@" Or _
            Right(Cells(j, 11), 1) = vbCr Or Right(Cells(j, 11), 1) = vbLf Then
            Cells(j, 11) = Left(Cells(j, 11), m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L
      
      k = Len(Cells(j, 5))
      m = k
      For L = 1 To k
         If Left(Cells(j, 5), 1) = vbLf Or Left(Cells(j, 5), 1) = vbCr Then
            Cells(j, 5) = Right(Cells(j, 5), m - 1)
            m = m - 1
         Else
            Exit For
         End If
      Next L

      ' |fffd||2d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||314||fffd|\|fffd||fffd|
      If j > 8 Then
         If Cells(j, 5) = "  " Or Cells(j, 5) = " " _
         Or Cells(j, 5) = Empty Or Right(Cells(j, 5), 1) = "|fffd||fffd|" Or _
         (Left(Cells(j, 5), 1) = "|fffd||fffd|" And Len(Cells(j, 5)) < 6) Or _
         Right(Cells(j, 5), 1) = "|fffd|a" Or Right(Cells(j, 5), 1) = "|fffd|p" _
            Then Rows(j).EntireRow.Hidden = True
      End If
   Next j
   
   '|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||315|\|fffd||fffd|
   For i = 51 To SerchWordEnd
      Cells(i, 5).ClearContents
      For j = 35 To 45
         If Worksheets("TEMPSPEC").Cells(Workareaini + j, i - 38) = 1 Or _
            Worksheets("TEMPSPEC").Cells(Workareaini + j, i - 38 + (SerchWordEnd - 51)) = 1 Then _
            Cells(i, 5) = Cells(i, 5) & "/" & Worksheets("TEMPSPEC").Cells(Workareaini + j, 1)
      Next j
   Next i

   Range("J1").Formula = "=MATCH(E3,|fffd||394||fffd|\!A1:A3320,FALSE)"
   Range("J2") = Range("J1")

   Range("J1").Formula = "=VLOOKUP(E3,|fffd||394||fffd|\!A3:C4000,3,FALSE)"
   Range("J3").Formula = "=If(J1=0,"""",J1)"
   Range("J3") = Range("J3")
   
   Range("J1").Formula = "=VLOOKUP(E3,|fffd||394||fffd|\!A3:E4000,5,FALSE)"
   Range("J8").Formula = "=If(J1=0,"""",J1)"
   Range("J8") = Range("J8")
   
   Range("J1").Formula = "=VLOOKUP(J3,|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!C3:D207,2,FALSE)"
   Range("J4").Formula = "=If(Iserror(J1),"""",IF(J1=0,"""",J1))"
   Range("J4") = Range("J4")
   
   Range("J1").Formula = "=VLOOKUP(J3,|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!C3:E207,3,FALSE)"
   Range("J5").Formula = "=If(Iserror(J1),"""",IF(J1=0,"""",J1))"
   Range("J5") = Range("J5")
   
   Range("J1").Formula = "=VLOOKUP(J3,|fffd|q|fffd||fffd||294|[|fffd||fffd||fffd|d|fffd|l|fffd||fffd||fffd||30d|\|fffd||fffd|!C3:F207,4,FALSE)"
   Range("J6").Formula = "=If(Iserror(J1),"""",IF(J1=0,"""",J1))"
   Range("J6") = Range("J6")
   
   Range("J1").Formula = "=VLOOKUP(E3,|fffd||394||fffd|\!A3:G4000,7,FALSE)"
   Range("J60").Formula = "=If(J1=0,"""",J1)"
   Range("J60") = Range("J60")
   
   Range("J1").Formula = "=VLOOKUP(E3,|fffd||394||fffd|\!A3:H4000,8,FALSE)"
   Range("J61").Formula = "=If(J1=0,"""",J1)"
   Range("J61") = Range("J61")
   
   Range("J1").ClearContents
   
   
   Range("E48").Formula = "=VLOOKUP(J3,|fffd||3cd|X|fffd||fffd||fffd||fffd|!C3:G174,5,FALSE)"
   Range("E49").Formula = "=VLOOKUP(J3,|fffd||3cd|X|fffd||fffd||fffd||fffd|!C3:I174,6,FALSE)"
   Range("J49").Formula = "=VLOOKUP(J3,|fffd||3cd|X|fffd||fffd||fffd||fffd|!C3:I174,7,FALSE)"
   
   If IsError(Range("E48")) Then Range("E48") = ""
   If IsError(Range("E49")) Then Range("E49") = ""
   If IsError(Range("J49")) Then Range("J49") = ""
   
   Range(Cells(48, 5), Cells(49, 10)) = Range(Cells(48, 5), Cells(49, 10))

End Sub
Sub Hexdisp()
Dim buf As String, dmp As String, i As Long
   Worksheets("TEMPSPEC").Activate
   buf = Range("A40").Text
   For i = 1 To LenB(buf)
      dmp = dmp & Hex(AscB(MidB(buf, i, 1))) & " "
   Next i
   Range("A41") = dmp
End Sub
Sub TextMatch()
Dim i As Integer, j As Integer
Dim Target As String, Reference As String
Dim Tj As String, Ri As String
Dim LenT As Integer, LenR As Integer
Dim Line As Integer
Dim TOff As Integer, ECNT As Integer


    ECNT = 0
    
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Range("A62:K100").ClearContents
    
    Target = Cells(60, 5)
    Reference = Cells(60, 11)
   
    For i = 1 To 5
        If Left(Reference, 1) = "*" Or Left(Reference, 1) = " " Then
            Reference = Mid(Reference, 2, Len(Reference) - 1)
        Else
            Exit For
        End If
    Next i

    LenT = Len(Target)
    LenR = Len(Reference)
   
    i = InStr(Target, Left(Reference, 3))
    If i > 0 Then
        Target = Mid(Target, i, LenT - i + 1)
        LenT = Len(Target)
    Else
        Cells(62, 5) = "|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        GoTo Endchk
    End If
   
    j = 1
    TOff = 0
    Line = 62
    For i = 1 To LenR
        Ri = Mid(Reference, i, 1)
        If Ri <> " " And Ri <> "|fffd|@" And Ri <> vbCr And Ri <> vbLf Then
Modori0:
            Tj = Mid(Target, j, 1)
            If Tj <> " " And Tj <> "|fffd|@" And Tj <> vbCr And Tj <> vbLf Then
                If Ri = "*" Then
                    j = j + 1
                    Tj = Mid(Target, j, 1)
                Else
                    If Ri <> Tj Then
                        Cells(Line, 1) = j
                        Cells(Line, 5) = Mid(Target, j, 1)
                        Cells(Line, 11) = Mid(Reference, i, 1)
                        Cells(Line + 1, 5) = Mid(Target, j, 20)
                        Cells(Line + 1, 11) = Mid(Reference, i, 20)
                        Line = Line + 2
                        ECNT = ECNT + 1
                        
                        ' |fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||42a42||fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||a3ca||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|B
                        If j + 3 < LenT Then
                            TOff = InStr(Mid(Target, j + 1, LenT - j - 2), Mid(Reference, i + 1, 3))
                        End If
                        If TOff > 3 Then
                            Cells(Line, 5) = "|fffd||20d|~|fffd||313||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||702||fffd||fffd||fffd|"
                            Exit For
                        Else
                            j = j + TOff
                        End If
                    Else
                        j = j + 1
                        Tj = Mid(Target, j, 1)
                    End If
                End If
            Else
                j = j + 1
                Tj = Mid(Target, j, 1)
                GoTo Modori0
            End If
        End If
    Next i
 
    If ECNT = 0 Then
        Cells(Line, 5) = "OK   " & Time
    Else
        Cells(Line, 5) = "NG " & ECNT & "|fffd||4cf||fffd|  " & Time
    End If
Endchk:
 
 
End Sub
Sub TextMatch_Old()
Dim i As Integer, j As Integer, p As Integer
Dim ii As Integer, jj As Integer
Dim Target As String, Reference As String
Dim LenT As Integer, LenR As Integer
Dim ErrF As Integer, Line As Integer


    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Range("A62:K100").ClearContents
    ErrF = 1
    Line = 62
    Bp = 0
    
    Target = Cells(60, 5)
    Reference = Cells(60, 11)
   
    For i = 1 To 5
        If Left(Reference, 1) = "*" Or Left(Reference, 1) = " " Then
            Reference = Mid(Reference, 2, Len(Reference) - 1)
        Else
            Exit For
        End If
    Next i

    LenT = Len(Target)
    LenR = Len(Reference)
   
       
       
   
   
   For i = 1 To 5
      For j = 1 To 5
         If Mid(Target, i, 1) = Mid(Reference, j, 1) Then
            If Mid(Target, i, 2) = Mid(Reference, j, 2) Then GoTo douki1
         End If
      Next j
   Next i
   Cells(62, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
   GoTo Endchk
   
douki1:
   o = 0
   For p = 1 To LenT - i
check:
      If Mid(Target, i + p, 1) <> Mid(Reference, j + p, 1) Then
         If Mid(Target, i + p, 1) = " " Or Mid(Target, i + p, 1) = "|fffd|@" Or _
            Mid(Target, i + p, 1) = vbLf Then
            i = i + 1
            GoTo check
         End If
         If Mid(Reference, j + p, 1) = " " Or Mid(Reference, j + p, 1) = "|fffd|@" Or _
            Mid(Reference, j + p, 1) = vbLf Then
            j = j + 1
            GoTo check
         End If
         ErrF = ErrF + 1
         Cells(Line, 1) = p
         Cells(Line, 5) = Mid(Target, i + p, 1)
         Cells(Line, 11) = Mid(Reference, j + p, 1)
         Cells(Line + 1, 5) = Mid(Target, i + p, 20)
         Cells(Line + 1, 11) = Mid(Reference, i + p, 20)
         Line = Line + 2
         For ii = 1 To 10
            For jj = 1 To 10
               If Mid(Target, p + i + ii, 1) = Mid(Reference, p + j + jj, 1) Then
                  If Mid(Target, p + i + ii, 3) = Mid(Reference, p + j + jj, 3) Then
                     i = i + ii
                     j = j + jj
                     GoTo douki2
                  End If
               End If
            Next jj
         Next ii
         Cells(Line, 5) = p
         Cells(Line, 11) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
         
         If ErrF > 10 Then GoTo Endchk
      End If
douki2:
   Next p
   Cells(Line, 5) = "OK   " & Time

Endchk:
End Sub
Sub |fffd||fffd||fffd||fffd||fffd|a()
   
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("A30").Copy Range("K60")
    Call TextMatch
    If InStr(Cells(62, 5), "OK") = 0 Then
        Worksheets("TEMPSPEC").Range("B30").Copy Range("K60")
        Call TextMatch
        If InStr(Cells(62, 5), "OK") = 0 Then
            Worksheets("TEMPSPEC").Range("C30").Copy Range("K60")
            Call TextMatch
            If InStr(Cells(62, 5), "OK") = 0 Then
                Worksheets("TEMPSPEC").Range("D30").Copy Range("K60")
                Call TextMatch
                If InStr(Cells(62, 5), "OK") > 0 Then Cells(62, 5) = Cells(62, 5) & " Rev5 GaAs"
            Else
                Cells(62, 5) = Cells(62, 5) & " Rev5"
            End If
        Else
            Cells(62, 5) = Cells(62, 5) & " Rev6 GaAs"
        End If
    Else
        Cells(62, 5) = Cells(62, 5) & " Rev6"
    End If

End Sub
Sub |fffd||fffd||fffd||fffd||fffd|p()

    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("A31").Copy Range("K60")
    Call TextMatch
    If InStr(Cells(62, 5), "OK") = 0 Then
        MsgBox "Rev6 NG"
        Worksheets("TEMPSPEC").Range("B31").Copy Range("K60")
        Call TextMatch
        If InStr(Cells(62, 5), "OK") = 0 Then
            MsgBox "Rev6 GaAS NG"
            Worksheets("TEMPSPEC").Range("C31").Copy Range("K60")
            Call TextMatch
            If InStr(Cells(62, 5), "OK") = 0 Then
                MsgBox "Rev5 NG"
                Worksheets("TEMPSPEC").Range("D31").Copy Range("K60")
                Call TextMatch
                If InStr(Cells(62, 5), "OK") > 0 Then
                    Cells(62, 5) = Cells(62, 5) & " Rev5 GaAs"
                Else
                    MsgBox "Rev5 GaAs NG"
                End If
            Else
                Cells(62, 5) = Cells(62, 5) & " Rev5"
            End If
        Else
            Cells(62, 5) = Cells(62, 5) & " Rev6 GaAs"
        End If
    Else
        Cells(62, 5) = Cells(62, 5) & " Rev6"
    End If
End Sub
Sub |fffd|n|fffd||fffd||fffd|t|fffd||fffd||fffd|a()
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("A33").Copy Range("K60")
    Call TextMatch
End Sub
Sub |fffd|n|fffd||fffd||fffd|t|fffd||fffd||fffd|p()
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("B33").Copy Range("K60")
    Call TextMatch
End Sub
Sub RoHS|fffd|Q|fffd|a()
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("A34").Copy Range("K60")
    Call TextMatch
End Sub
Sub RoHS|fffd|Q|fffd|p()
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("J34").Copy Range("K60")
    Call TextMatch
End Sub
Sub OldRoHS|fffd|Q|fffd|p()
    Worksheets("|fffd|d|fffd|l|fffd||fffd|").Activate
    Worksheets("TEMPSPEC").Range("K34").Copy Range("K60")
    Call TextMatch
End Sub
Sub Moji()
Dim i As Integer, L As Integer, Target As String

   Worksheets("TEMPSPEC").Activate
   Range(Cells(46, 1), Cells(47, 3000)).ClearContents
   Target = Cells(45, 1)
   L = Len(Target)
   For i = 1 To L
      Cells(46, i) = Mid(Target, i, 1)
      Cells(47, i) = i
      If Cells(46, i) = " " Then Cells(46, i) = "space"
      If Cells(46, i) = "|fffd|@" Then Cells(46, i) = "Space"
      If Cells(46, i) = Chr(9) Then Cells(46, i) = "Tab"
      If Cells(46, i) = vbCr Then Cells(46, i) = "CR"
      If Cells(46, i) = vbLf Then Cells(46, i) = "LF"
   Next i
   
End Sub
Sub Word|fffd|N|fffd||fffd||fffd||193||fffd||fffd||fffd|()
' |fffd|N|fffd||fffd|
Dim wdapp As Object
Dim filePath As String
Dim |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| As String
'Dim |fffd|p|fffd||fffd||fffd|A|fffd|O|fffd||fffd||fffd|t As Paragraph
Dim i As Integer


   filePath = ActiveWorkbook.Path & "\" & "|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g.doc"
 
   On Error Resume Next
 
   Set wdapp = GetObject(, "word.application")
 
   If Err.Number = 429 Then
      Set wdapp = CreateObject("word.application")
   End If
 
   Err.Clear
 
   Name filePath As filePath
 
   If Err.Number = 0 Then
      wdapp.Documents.Open Filename:=filePath
      wdapp.Visible = True
   ElseIf Err.Number = 75 Then
      MsgBox "|fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
   End If
 
   On Error GoTo 0
     
  ' |fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd|
   Worksheets("|fffd||c42c||fffd|V|fffd|[|fffd|g").Activate
   
   For i = 2 To 40
      If Cells(i, 5) <> Empty Then
         wdapp.Selection.TypeText Text:=Cells(i, 5) & vbCrLf
      End If
'   Selection.Paragraphs(1).Style = wdStyleHeading1
   Next i
   
   |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = Cells(52, 8) & "|fffd||c42c||fffd|V|fffd|[|fffd|g"
'   ActiveDocument.SaveAs |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
   
   'Word|fffd||fffd|\|fffd||fffd|
   wdapp.Visible = True
    
    
   
   Set wdapp = Nothing
         
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
