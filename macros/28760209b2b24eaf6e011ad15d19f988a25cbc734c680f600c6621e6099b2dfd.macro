Attribute VB_Name = "EsteLivro"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforeClose(Cancel As Boolean)
Application.ScreenUpdating = False
Sheets("Jogos Hoje").Activate
Sheets("Jogos Hoje").Unprotect
    Range("a:l").Clear
 Sheets("Jogos Hoje").Protect
Sheets("Lista").Activate

    Range("b:C").Clear
    Range("A3:A1000").Clear
    Range("D3:D1000").Clear
    Range("F3:D1000").Clear
 Sheets("Jogo atual").Activate
    Range("A:AZ").Clear
     Sheets("dados").Activate
     
    
            Range("A:CG").Clear
    
   
Range("CV:CW").Clear


Range("DI:DX").Clear

Range("EA:FE").Clear

Sheets("H2H").Activate
Sheets("H2H").Unprotect
Range("B3:C3").ClearContents
Range("C7:D7").ClearContents

Sheets("H2H Hoje").Activate
Sheets("H2H Hoje").Unprotect
    [E3] = ""
    [d1] = "2|fffd| Seleccione aqui na lista o jogo de hoje que deseja analisar"
Rows("4:92").EntireRow.Hidden = True

Sheets("INICIO").Activate
Call RepoeXdaBarra
ActiveWorkbook.Save
End Sub

Private Sub Workbook_Open()
Application.ScreenUpdating = False

Worksheets("INICIO").Activate

Call RetiraXdaBarra
[A1].Select


Call abertura

If [Configura|fffd||fffd|es!S9] = "ON" Then
Call random
Else
End If
Worksheets("INICIO").Protect
Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Folha1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
Call RetiraXdaBarra
End Sub


Attribute VB_Name = "Folha10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

End Sub
Attribute VB_Name = "Folha25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Folha9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"

Sub Simul_Click()
Application.ScreenUpdating = False
    [D4] = "Fundo Inicial"
    [C6] = "1.9"
    [C8] = "0.02"
    [C9] = "0.05"
    [C10] = "0.10"
    [E6] = "35"
    [E8] = "100"
End Sub
Sub Banca_Click()
Dim answer As Integer
answer = MsgBox("Tem a certeza que pretende eliminar todas as c|fffd|lulas preenchidas?", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
[C8:D19,B3:G3].ClearContents
Else
End If
End Sub
Sub Resetbet_Click()
Application.ScreenUpdating = False
[D4:E4,C6,E6,C8:C10,E8].ClearContents
End Sub
Sub DivideStake_Click()
Application.ScreenUpdating = False
[B6:K6,D8:E8].ClearContents
End Sub

Sub poisson()
Application.ScreenUpdating = False
Sheets("Score").Unprotect ""
Worksheets("Score").Visible = True
Worksheets("Score").Activate
[A1].Select
Sheets("Score").Protect ""
End Sub

Sub help_meses()
Application.ScreenUpdating = False
    Worksheets("Help").Visible = True
    Worksheets("Help").Select
    [A1].Select
End Sub

Sub score()
Application.ScreenUpdating = False
Sheets("Score").Unprotect ""
If [C15] < 0.0001 And [G15] < 0.0001 Then
Rows("15").EntireRow.Hidden = True
Else
Rows("15").EntireRow.Hidden = False
End If
If [C16] < 0.0001 And [G16] < 0.0001 Then
Rows("16").EntireRow.Hidden = True
Else
Rows("16").EntireRow.Hidden = False
End If
If [C17] < 0.0001 And [G17] < 0.0001 Then
Rows("17").EntireRow.Hidden = True
Else
Rows("17").EntireRow.Hidden = False
End If
If [C18] < 0.0001 And [G18] < 0.0001 Then
Rows("18").EntireRow.Hidden = True
Else
Rows("18").EntireRow.Hidden = False
End If
If [C19] < 0.0001 And [G19] < 0.0001 Then
Rows("19").EntireRow.Hidden = True
Else
Rows("19").EntireRow.Hidden = False
End If
If [C20] < 0.0001 And [G20] < 0.0001 Then
Rows("20").EntireRow.Hidden = True
Else
Rows("20").EntireRow.Hidden = False
End If
If [C21] < 0.0001 And [G21] < 0.0001 Then
Rows("21").EntireRow.Hidden = True
Else
Rows("21").EntireRow.Hidden = False
End If
If [C22] < 0.0001 And [G22] < 0.0001 Then
Rows("22").EntireRow.Hidden = True
Else
Rows("22").EntireRow.Hidden = False
End If
If [C23] < 0.0001 And [G23] < 0.0001 Then
Rows("23").EntireRow.Hidden = True
Else
Rows("23").EntireRow.Hidden = False
End If
If [C24] < 0.0001 And [G24] < 0.0001 Then
Rows("24").EntireRow.Hidden = True
Else
Rows("24").EntireRow.Hidden = False
End If
If [C25] < 0.0001 And [G25] < 0.0001 Then
Rows("25").EntireRow.Hidden = True
Else
Rows("25").EntireRow.Hidden = False
End If
If [C26] < 0.0001 And [G26] < 0.0001 Then
Rows("26").EntireRow.Hidden = True
Else
Rows("26").EntireRow.Hidden = False
End If
Sheets("Score").Protect ""
End Sub

Sub Ajuda()
If Application.DisplayCommentIndicator = xlCommentAndIndicator Then
       Application.DisplayCommentIndicator = xlCommentIndicatorOnly
    Else
       Application.DisplayCommentIndicator = xlCommentAndIndicator
    End If
End Sub

Sub Caixadeverifica|fffd||fffd|o20_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("Z:AB").EntireColumn.Hidden = False Then
Columns("Z:AB").EntireColumn.Hidden = True
Else
Columns("Z:AB").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub
Sub Caixadeverifica|fffd||fffd|o22_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("V").EntireColumn.Hidden = False Then

Columns("V").EntireColumn.Hidden = True
Columns("X:Y").EntireColumn.Hidden = True
Else
Columns("V").EntireColumn.Hidden = False
Columns("X:Y").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub
Sub Caixadeverifica|fffd||fffd|o23_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("C:F").EntireColumn.Hidden = False Then

Columns("C:F").EntireColumn.Hidden = True
Columns("AS:AZ").EntireColumn.Hidden = True
Else
Columns("C:F").EntireColumn.Hidden = False
Columns("AS:AZ").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub
Sub Caixadeverifica|fffd||fffd|o24_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("O:R").EntireColumn.Hidden = False Then
Columns("O:R").EntireColumn.Hidden = True
Columns("BQ:BX").EntireColumn.Hidden = True
Else
Columns("O:R").EntireColumn.Hidden = False
Columns("BQ:BX").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub

Sub Caixadeverifica|fffd||fffd|o29_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("G:J").EntireColumn.Hidden = False Then
Columns("G:J").EntireColumn.Hidden = True
Columns("BA:BH").EntireColumn.Hidden = True
Else
Columns("G:J").EntireColumn.Hidden = False
Columns("BA:BH").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub

Sub Caixadeverifica|fffd||fffd|o30_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("K:N").EntireColumn.Hidden = False Then
Columns("K:N").EntireColumn.Hidden = True
Columns("BI:BP").EntireColumn.Hidden = True
Else
Columns("K:N").EntireColumn.Hidden = False
Columns("BI:BP").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub

Sub Caixadeverifica|fffd||fffd|o31_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("S:T").EntireColumn.Hidden = False Then
Columns("S:T").EntireColumn.Hidden = True
Columns("BY:CF").EntireColumn.Hidden = True
Else
Columns("S:T").EntireColumn.Hidden = False
Columns("BY:CF").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub
Sub Caixadeverifica|fffd||fffd|o32_Click()
Dim Ultimaplanilha As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""
If Columns("A").EntireColumn.Hidden = False Then
Columns("A").EntireColumn.Hidden = True
Columns("CG:CO").EntireColumn.Hidden = True
Else
Columns("A").EntireColumn.Hidden = False
Columns("CG:CO").EntireColumn.Hidden = False
End If
Sheets(Retornaplanilha).Protect ""
End Sub

Sub exemplo_score()


[D14] = 1.14285714285714
[H14] = 0.8

End Sub




Attribute VB_Name = "Module10"
Option Explicit


Public messagem As String
Public MyProgressbar As ProgressBar


'OCULTA OS BOT|fffd|ES MINIMIZAR / MAXIMIZAR E FECHAR DA BARRA DO EXCEL

'Sem as declara|fffd||fffd|es abaixo as macros para retirar e repor os bot|fffd|es n|fffd|o funcionar|fffd|
Declare PtrSafe Function FindWindow32 Lib "user32" Alias "FindWindowA" _
        (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer
        
Declare PtrSafe Function GetWindowLong32 Lib "user32" Alias "GetWindowLongA" _
        (ByVal hWnd As Integer, ByVal nIndex As Integer) As Long
        
Declare PtrSafe Function SetWindowLong32 Lib "user32" Alias "SetWindowLongA" _
        (ByVal hWnd As Integer, ByVal nIndex As Integer, ByVal dwNewLong As Long) As Long
        
Global Const GWL_STYLE = (-16)
Global Const WS_SYSMENU = &H80000
 
Sub Ocultar_tudo()

    'Menu superior
    Application.ExecuteExcel4Macro "show.toolbar(""ribbon"",false)"
    
    'barra de F|fffd|rmulas
    Application.DisplayFormulaBar = False
    
    'barra de status
    Application.DisplayStatusBar = False
    
    'Cabe|fffd|alhos
    ActiveWindow.DisplayHeadings = False
    
    'Guias da planilha
    ActiveWindow.DisplayWorkbookTabs = False
    
    'Linhas de grade
    ActiveWindow.DisplayGridlines = False
    
    'Barras horozontais
    ActiveWindow.DisplayHorizontalScrollBar = False
    
    'barras verticais
    ActiveWindow.DisplayVerticalScrollBar = False

    With Application
        .WindowState = xlMaximized
    End With
        
End Sub

Sub Mostrar_tudo()

    'Menu superior
    Application.ExecuteExcel4Macro "show.toolbar(""ribbon"",true)"
    
    'Barra de F|fffd|rmulas
    Application.DisplayFormulaBar = True
    
    'Barra de status
    Application.DisplayStatusBar = True
    
    'Cabe|fffd|alhos
     ActiveWindow.DisplayHeadings = True
    
    'Guias da planilha
    ActiveWindow.DisplayWorkbookTabs = True
    
    'Linhas de grade
    'ActiveWindow.DisplayGridlines = True
    
    'Barras horozontais
    ActiveWindow.DisplayHorizontalScrollBar = True
    
    'Barras verticais
    ActiveWindow.DisplayVerticalScrollBar = True

    With Application
       .WindowState = xlMaximized
    End With

End Sub

Sub RepoeXdaBarra()

    Application.ScreenUpdating = True
    Dim WindowStyle As Long
    Dim hWnd As Integer
    Dim WindowName As String
    Dim Result As Variant

    WindowName = Application.Caption
    hWnd = FindWindow32(0&, ByVal WindowName)
    WindowStyle = GetWindowLong32(hWnd, GWL_STYLE)
    WindowStyle = WindowStyle Or WS_SYSMENU
    Result = SetWindowLong32(hWnd, GWL_STYLE, WindowStyle)
    
    'For|fffd|a a barra de t|fffd|tulos a se atualizar, Retornando os Bot|fffd|es
    Application.Caption = " An|fffd|lise "
    'ActiveWindow.Caption = " Gest|fffd|o MCS "

End Sub

Sub RetiraXdaBarra()

    Application.ScreenUpdating = False

    Dim WindowStyle As Long
    Dim hWnd As Integer
    Dim WindowName As String
    Dim Result As Variant

    WindowName = Application.Caption
    hWnd = FindWindow32(0&, ByVal WindowName)
    WindowStyle = GetWindowLong32(hWnd, GWL_STYLE)
    WindowStyle = WindowStyle And (Not WS_SYSMENU)
    Result = SetWindowLong32(hWnd, GWL_STYLE, WindowStyle)

    'For|fffd|a a barra de t|fffd|tulos a se atualizar, Ocultando os Bot|fffd|es
    'Application.Caption = " Dashboard "
    'ActiveWindow.Caption = " Produtividade "

End Sub



Public Sub fcExibeAcaoProgressbar(intNumAcao As Integer, strMsg As String)

    With MyProgressbar
        .ActionNumber = intNumAcao
        .StatusMessage = strMsg
    End With
    
End Sub


Attribute VB_Name = "Module11"
Sub statsleague()
Dim x As String
 Dim rCell As Range
    Dim sPesquisa As String
    Dim sFirst As String

    Set MyProgressbar = New ProgressBar
    
    With MyProgressbar
        .Title = "Consulta em andamento"
        .ExcelStatusBar = True
        .StartColour = rgbRed
        .EndColour = rgbGreen
    End With
    
    MyProgressbar.TotalActions = 8
    
    MyProgressbar.ShowBar
    
fcExibeAcaoProgressbar 1, "Acessando a Internet..."
Application.ScreenUpdating = False
If Sheets("Settings").Range("K3") = 0 Then
Else
x = Sheets("Settings").Range("K3")
Worksheets("dados").Visible = True
Sheets("dados").Select
[A:AA].Clear
[A:AA].QueryTable.Delete
With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("A1"))
        .Name = "stats1"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = """btable"""
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
 

End If


fcExibeAcaoProgressbar 2, "Analisando dados..."

If Sheets("Settings").Range("L3") = 0 Then
Else
[AD:AR].Clear
[AD:AR].QueryTable.Delete
x = Sheets("Settings").Range("L3")

With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("$AD$1"))
        .Name = "stats2"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "6"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
End If


fcExibeAcaoProgressbar 3, "Analisando dados..."
Application.ScreenUpdating = False
If Sheets("Settings").Range("M3") = 0 Then
Else
[AT:BC].Clear
[AT:BC].QueryTable.Delete
x = Sheets("Settings").Range("M3")

With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("$AT$1"))
        
        .Name = "stats3"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    End If
    
    


fcExibeAcaoProgressbar 4, "Copiando dados..."

If Sheets("Settings").Range("N3") = 0 Then
Else
[BG:BO].Clear
[BG:BO].QueryTable.Delete
x = Sheets("Settings").Range("N3")
    
 With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("$BG$1"))
        
        .Name = "stats4"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "16"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
 End If
fcExibeAcaoProgressbar 5, "Copiando dados..."
If Sheets("Settings").Range("O3") = 0 Then
Else
[BP:BY].Clear
[BP:BY].QueryTable.Delete
x = Sheets("Settings").Range("O3")
    
  With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("$BP$1"))
        .Name = "stats5"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "9"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    End If
    
 
    
  
        

 fcExibeAcaoProgressbar 6, "Calculando..."
 
If Sheets("Settings").Range("P3") = 0 Then
Else
[BZ:CG].Clear
[BZ:CG].QueryTable.Delete
x = Sheets("Settings").Range("P3")
    
With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("$BZ$1"))
        .Name = "stats6"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "5,""btable"""
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
 End If
   
  fcExibeAcaoProgressbar 7, "Calculando..."

If Sheets("Settings").Range("Q3") = 0 Then
Else
[DI:DX].ClearContents
[DI:DX].QueryTable.Delete
x = Sheets("Settings").Range("Q3")
    
With ActiveSheet.QueryTables.Add(Connection:="URL;" & x, Destination:=Range("$DI$1"))
        
        .Name = "stats7"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "2"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
End If

fcExibeAcaoProgressbar 8, "Terminando a An|fffd|lise..."

'[AT:AT].Select
'     sPesquisa = "Home"
       
'    Set rCell = Selection.Cells.Find(sPesquisa)
 '   If rCell Is Nothing Then Exit Sub
 '       sFirst = rCell.Address
 '       Range("" & sFirst & ":BC200").ClearContents
        
        
 '     sPesquisa = "Streaks & Sequences (at home)"
        
 '  Set rCell = Cells.Find(sPesquisa)
 '   If rCell Is Nothing Then Exit Sub
 '       sFirst = rCell.Address
  '      Range("" & sFirst & ":BY200").ClearContents
        

    
    Columns("L:L").Select
    Selection.Replace What:=".", Replacement:=",", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False

       Columns("BK:BN").Select
    Selection.Replace What:=".", Replacement:=",", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False


[CV:CW].Clear
      Columns("CB:CB").Select
    Selection.TextToColumns Destination:=Range("CV1"), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar:="-", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
  
  Columns("A:A").Select
    Selection.Copy
    Columns("AB:AB").Select
    ActiveSheet.Paste
    
 Range("AE4:AE27").Select
    Selection.Copy
    
    Sheets("H2H").Select
    
    Range("BQ1").Select
    ActiveSheet.Paste
    
    Range("C7:D7").ClearContents
    
    
     
   
    
    Worksheets("dados").Visible = False
    
    [C7:D7].ClearContents
    [A1].Select
       Application.ScreenUpdating = True
    Sheets("H2H").Select
        MyProgressbar.Complete 1
    
Exit_Sub:
    MsgBox "A pesquisa n|fffd|o foi completa em 100%, existe a possibilidade de haver dados errados."

 End Sub


Attribute VB_Name = "Module12"
Sub rangemeses()
    Range("Z:Z,AC:AC,Y:Y,V:V,AG4:AH34,AK4:AK34,AM4:AN34,AO2:AR2,AO4:AR5,AO7:AR9,AO19:AR19,AO21:AR21,AO27:AR27,AO29:AR29,AO35:AR37,AP45,AR45,AH37:AH47,AJ37:AJ47,AG52:AK82,AT:AT,AV:AV,BB:BB,BD:BD,BJ:BJ,BL:BL,BR:BR,BT:BT,BZ:BZ,CB:CB,CH:CH,CJ:CJ").Select

End Sub
Sub moeda()
Application.ScreenUpdating = False
Sheets("Banca").Visible = True
Sheets("Janeiro").Visible = True
Sheets("Fevereiro").Visible = True
Sheets("Mar|fffd|o").Visible = True
Sheets("Abril").Visible = True
Sheets("Maio").Visible = True
Sheets("Junho").Visible = True
Sheets("Julho").Visible = True
Sheets("Agosto").Visible = True
Sheets("Setembro").Visible = True
Sheets("Outubro").Visible = True
Sheets("Novembro").Visible = True
Sheets("Dezembro").Visible = True
Sheets("Stats Ano").Visible = True
Sheets("Stats Competi|fffd||fffd|o").Visible = True
Sheets("Stats Mercados").Visible = True
Sheets("Resumo").Visible = True
Sheets("Tipsters").Visible = True
Sheets("Bet Simulator").Visible = True
Sheets("Divide Stake").Visible = True

Sheets("Banca").Unprotect ""
Sheets("Janeiro").Unprotect ""
Sheets("Fevereiro").Unprotect ""
Sheets("Mar|fffd|o").Unprotect ""
Sheets("Abril").Unprotect ""
Sheets("Maio").Unprotect ""
Sheets("Junho").Unprotect ""
Sheets("Julho").Unprotect ""
Sheets("Agosto").Unprotect ""
Sheets("Setembro").Unprotect ""
Sheets("Outubro").Unprotect ""
Sheets("Novembro").Unprotect ""
Sheets("Dezembro").Unprotect ""
Sheets("Stats Ano").Unprotect ""
Sheets("Stats Competi|fffd||fffd|o").Unprotect ""
Sheets("Stats Mercados").Unprotect ""
Sheets("Resumo").Unprotect ""
Sheets("Tipsters").Unprotect ""
Sheets("Bet Simulator").Unprotect ""
Sheets("Divide Stake").Unprotect ""



Select Case [Configura|fffd||fffd|es!S14]
   Case "(|fffd|) Euro"
    Sheets("Banca").Select
    Range("C8:G21,B3:C3").Select
        Selection.NumberFormat = "#,##0.00 $"

    Sheets("Janeiro").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Fevereiro").Select
       Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Mar|fffd|o").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Abril").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Maio").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Junho").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Julho").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Agosto").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Setembro").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Outubro").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Novembro").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Dezembro").Select
        Call rangemeses
    Selection.NumberFormat = "#,##0.00 $"
    
    Sheets("Stats Ano").Select
    Range("C29:C41,E29:F41,H29:H41,J29:K41,N29:O41,Q29:R41,T29:U41").Select
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Stats Competi|fffd||fffd|o").Select
    Range("B:B,G:G").Select
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Stats Mercados").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Resumo").Select
    Range("B3:C26,E3:F26,M3:N12").Select
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Tipsters").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Bet Simulator").Select
    Range("C13:E58").Select
    Selection.NumberFormat = "#,##0.00 $"
    Sheets("Divide Stake").Select
    Range("B11:K11,D8:E8,J8:K8").Select
    Selection.NumberFormat = "#,##0.00 $"






   Case "($) D|fffd|lar"
    Sheets("Banca").Select
    Range("C8:G21,B3:C3").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Janeiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Fevereiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Mar|fffd|o").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Abril").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Maio").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Junho").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Julho").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Agosto").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Setembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Outubro").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Novembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Dezembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$$-C09]#,##0.00"
     Sheets("Stats Ano").Select
    Range("C29:C41,E29:F41,H29:H41,J29:K41,N29:O41,Q29:R41,T29:U41").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Stats Competi|fffd||fffd|o").Select
    Range("B:B,G:G").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Stats Mercados").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Resumo").Select
    Range("B3:C26,E3:F26,M3:N12").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Tipsters").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Bet Simulator").Select
    Range("C13:E58").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
    Sheets("Divide Stake").Select
    Range("B11:K11,D8:E8,J8:K8").Select
    Selection.NumberFormat = "[$$-C09]#,##0.00"
  
   
   
   Case "(|fffd|) Libra"
       Sheets("Banca").Select
    Range("C8:G21,B3:C3").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Janeiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Fevereiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Mar|fffd|o").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Abril").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Maio").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Junho").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Julho").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Agosto").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Setembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Outubro").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Novembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Dezembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
     Sheets("Stats Ano").Select
    Range("C29:C41,E29:F41,H29:H41,J29:K41,N29:O41,Q29:R41,T29:U41").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Stats Competi|fffd||fffd|o").Select
    Range("B:B,G:G").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Stats Mercados").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Resumo").Select
    Range("B3:C26,E3:F26,M3:N12").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Tipsters").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Bet Simulator").Select
    Range("C13:E58").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
    Sheets("Divide Stake").Select
    Range("B11:K11,D8:E8,J8:K8").Select
    Selection.NumberFormat = "[$|fffd|-809]#,##0.00"

   Case "(CHF) Franco Sui|fffd|o"
    Sheets("Banca").Select
    Range("C8:G21,B3:C3").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
        Sheets("Janeiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Fevereiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Mar|fffd|o").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Abril").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Maio").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Junho").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Julho").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Agosto").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Setembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Outubro").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Novembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Dezembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
     Sheets("Stats Ano").Select
    Range("C29:C41,E29:F41,H29:H41,J29:K41,N29:O41,Q29:R41,T29:U41").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Stats Competi|fffd||fffd|o").Select
    Range("B:B,G:G").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Stats Mercados").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Resumo").Select
    Range("B3:C26,E3:F26,M3:N12").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Tipsters").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Bet Simulator").Select
    Range("C13:E58").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"
    Sheets("Divide Stake").Select
    Range("B11:K11,D8:E8,J8:K8").Select
    Selection.NumberFormat = "[$CHF-807] #,##0.00"

   Case "(R$) Real Brasil"
    Sheets("Banca").Select
    Range("C8:G21,B3:C3").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
        Sheets("Janeiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Fevereiro").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Mar|fffd|o").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Abril").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Maio").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Junho").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Julho").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Agosto").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Setembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Outubro").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Novembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Dezembro").Select
        Call rangemeses
    Selection.NumberFormat = "[$R$-416] #,##0.00"
     Sheets("Stats Ano").Select
    Range("C29:C41,E29:F41,H29:H41,J29:K41,N29:O41,Q29:R41,T29:U41").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Stats Competi|fffd||fffd|o").Select
    Range("B:B,G:G").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Stats Mercados").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Resumo").Select
    Range("B3:C26,E3:F26,M3:N12").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Tipsters").Select
    Range("B:B,D:D").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Bet Simulator").Select
    Range("C13:E58").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"
    Sheets("Divide Stake").Select
    Range("B11:K11,D8:E8,J8:K8").Select
    Selection.NumberFormat = "[$R$-416] #,##0.00"

   End Select
Sheets("Banca").Protect ""
Sheets("Janeiro").Protect ""
Sheets("Fevereiro").Protect ""
Sheets("Mar|fffd|o").Protect ""
Sheets("Abril").Protect ""
Sheets("Maio").Protect ""
Sheets("Junho").Protect ""
Sheets("Julho").Protect ""
Sheets("Agosto").Protect ""
Sheets("Setembro").Protect ""
Sheets("Outubro").Protect ""
Sheets("Novembro").Protect ""
Sheets("Dezembro").Protect ""
Sheets("Stats Ano").Protect ""
Sheets("Stats Competi|fffd||fffd|o").Protect ""
Sheets("Stats Mercados").Protect ""
Sheets("Resumo").Protect ""
Sheets("Tipsters").Protect ""
Sheets("Bet Simulator").Protect ""
Sheets("Divide Stake").Protect ""


Sheets("Banca").Visible = False
Sheets("Janeiro").Visible = False
Sheets("Fevereiro").Visible = False
Sheets("Mar|fffd|o").Visible = False
Sheets("Abril").Visible = False
Sheets("Maio").Visible = False
Sheets("Junho").Visible = False
Sheets("Julho").Visible = False
Sheets("Agosto").Visible = False
Sheets("Setembro").Visible = False
Sheets("Outubro").Visible = False
Sheets("Novembro").Visible = False
Sheets("Dezembro").Visible = False
Sheets("Stats Ano").Visible = False
Sheets("Stats Competi|fffd||fffd|o").Visible = False
Sheets("Stats Mercados").Visible = False
Sheets("Resumo").Visible = False
Sheets("Tipsters").Visible = False
Sheets("Bet Simulator").Visible = False
Sheets("Divide Stake").Visible = False


       Sheets("Configura|fffd||fffd|es").Select

Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Module2"
Sub sair()
    Dim answer As String
    Dim question As String
    Sheets("H2H Hoje").Unprotect ""
    
    question = "Deseja realmente sair?"
    answer = MsgBox(question, vbYesNo)

    If answer = vbNo Then
        Cancel = True
        Exit Sub
    Else
        'Se existirem outros arquivos abertos, fecha apenas o arquivo ativo.
        'Caso contrario, fecha o Excel
        If Application.Workbooks.Count = 1 Then
            Application.Quit
        Else
            ActiveWorkbook.Close
        End If
    End If
    
End Sub

Sub configura|fffd||fffd|es()
Application.ScreenUpdating = False
Sheets("Configura|fffd||fffd|es").Unprotect ""
Worksheets("Configura|fffd||fffd|es").Visible = True
    Worksheets("Configura|fffd||fffd|es").Activate
    Call abertura
    [A1].Select
End Sub


Sub fullscreen()
If Application.DisplayFullScreen = True Then
Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
Application.DisplayFullScreen = False
[i5] = "Window"
[i15] = "ON"
If Application.DisplayFormulaBar = True Then
[i7] = "ON"
End If
If Application.DisplayStatusBar = False Then

[i15] = "OFF"
End If
Else
Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",True)"
Application.DisplayFullScreen = True
[i5] = "Fullscreen"
[i7] = "OFF"
[i15] = "OFF"

End If
End Sub

Sub formulas()
If Application.DisplayFullScreen = True Then
[i7] = "OFF"
Else
If Application.DisplayFormulaBar = True Then

Application.DisplayFormulaBar = False
[i7] = "OFF"
Else

Application.DisplayFormulaBar = True

[i7] = "ON"
End If
End If
End Sub
Sub cabe|fffd|alhos()
If ActiveWindow.DisplayHeadings = True Then

ActiveWindow.DisplayHeadings = False
[i9] = "OFF"
Else

ActiveWindow.DisplayHeadings = True

[i9] = "ON"
End If
End Sub
Sub linhasgrelha()
If ActiveWindow.DisplayGridlines = True Then

ActiveWindow.DisplayGridlines = False
[i11] = "OFF"
Else

ActiveWindow.DisplayGridlines = True

[i11] = "ON"
End If
End Sub
Sub separadores()
If ActiveWindow.DisplayWorkbookTabs = True Then

ActiveWindow.DisplayWorkbookTabs = False
[i13] = "OFF"
Else

ActiveWindow.DisplayWorkbookTabs = True

[i13] = "ON"
End If
End Sub

Sub status()
If Application.DisplayStatusBar = True Then

 Application.DisplayStatusBar = False
[i15] = "OFF"
Else

 Application.DisplayStatusBar = True

[i15] = "ON"
End If
End Sub

Sub rolamento()
If ActiveWindow.DisplayHorizontalScrollBar = False And ActiveWindow.DisplayVerticalScrollBar = False Then

 With ActiveWindow
        .DisplayHorizontalScrollBar = True
        .DisplayVerticalScrollBar = False
 End With
 [I17] = "S|fffd| Horizontal"
 
Else

    If ActiveWindow.DisplayHorizontalScrollBar = True And ActiveWindow.DisplayVerticalScrollBar = False Then

         With ActiveWindow
        .DisplayHorizontalScrollBar = False
        .DisplayVerticalScrollBar = True
        End With
        [I17] = "S|fffd| Vertical"
    Else
        If ActiveWindow.DisplayHorizontalScrollBar = True And ActiveWindow.DisplayVerticalScrollBar = True Then
            With ActiveWindow
                .DisplayHorizontalScrollBar = False
                .DisplayVerticalScrollBar = False
            End With
            [I17] = "Ambas desativadas"
        Else
             With ActiveWindow
                .DisplayHorizontalScrollBar = True
            .DisplayVerticalScrollBar = True
            End With
            [I17] = "Ambas ativadas"

End If
End If
End If


End Sub

Sub notificacoes()
If [S9] = "ON" Then
[S9] = "OFF"
Else
[S9] = "ON"
End If
End Sub


Sub reporconfig()
Application.ScreenUpdating = False
'Oculta todas as guias de menu
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",True)"
    Application.DisplayFullScreen = False
    'Ocultar barra de f|fffd|rmulas
    Application.DisplayFormulaBar = True
    
    'Ocultar barra de status, disposta ao final da planilha
    Application.DisplayStatusBar = True
    
       
    With ActiveWindow
        'Ocultar barra horizontal
        .DisplayHorizontalScrollBar = True
        
        'Ocultar barra vertical
        .DisplayVerticalScrollBar = True
        
        'Ocultar guias das planilhas
        .DisplayWorkbookTabs = True
        
        'Oculta os t|fffd|tulos de linha e coluna
        .DisplayHeadings = True
        
        'Oculta valores zero na planilha
        .DisplayZeros = True
        
        'Oculta as linhas de grade da planilha
        .DisplayGridlines = True
    End With
  Call Mostrar_tudo
[i5] = "Window"
[i7] = "ON"
[i9] = "ON"
[i11] = "ON"
[i13] = "ON"
[i15] = "ON"
[I17] = "Ambas ativadas"
End Sub
Attribute VB_Name = "Module3"



Sub DS_simul_Click()
Application.ScreenUpdating = False
[B6] = "5"
[C6] = "23"
[D6] = "13"
[E6] = "5"
[F6] = "15"
[G6] = "34"
[H6] = "7.5"
[I6] = "6"
[D8] = "1000"

End Sub
Sub Jan()

If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Select
        [A1].Select
        End If
Else

Sheets("Janeiro").Unprotect ""
Sheets("Janeiro").Visible = True
Sheets("Janeiro").Activate
Call abertura
[A1].Select
Sheets("Janeiro").Protect ""
End If

End Sub
Sub Fev()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").activatee
        [A1].Select
        End If
Else
Sheets("Fevereiro").Unprotect ""
Worksheets("Fevereiro").Visible = True
Worksheets("Fevereiro").Activate
Call abertura
[A1].Select
Sheets("Fevereiro").Protect ""
End If
End Sub
Sub Mar()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Activate
        End If
Else
Sheets("Mar|fffd|o").Unprotect ""
Worksheets("Mar|fffd|o").Visible = True
Worksheets("Mar|fffd|o").Activate
Call abertura
[A1].Select
Sheets("Mar|fffd|o").Protect ""
End If
End Sub
Sub Abr()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Select
        [A1].Select
        End If
Else
Sheets("Abril").Unprotect ""
Worksheets("Abril").Visible = True
Worksheets("Abril").Activate
Call abertura
[A1].Select
Sheets("Abril").Protect ""
End If
End Sub
Sub Mai()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Select
        [A1].Select
        End If
Else
Sheets("Maio").Unprotect ""
Worksheets("Maio").Visible = True
Worksheets("Maio").Activate
Call abertura
[A1].Select
Sheets("Maio").Protect ""
End If
End Sub
Sub Jun()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Sheets("Junho").Unprotect ""
Worksheets("Junho").Visible = True
Worksheets("Junho").Activate
Call abertura
[A1].Select
Sheets("Junho").Protect ""
End If
End Sub
Sub Jul()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Select
        [A1].Select
        End If
Else
Sheets("Julho").Unprotect ""
Worksheets("Julho").Visible = True
Worksheets("Julho").Activate
Call abertura
[A1].Select
Sheets("Julho").Protect ""
End If
End Sub
Sub Ago()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Sheets("Agosto").Unprotect ""
Worksheets("Agosto").Visible = True
Worksheets("Agosto").Activate
Call abertura
[A1].Select
Sheets("Agosto").Protect ""
End If
End Sub
Sub Sete()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Activate
        End If
Else
Sheets("Setembro").Unprotect ""
Worksheets("Setembro").Visible = True
Worksheets("Setembro").Activate
Call abertura
[A1].Select
Sheets("Setembro").Protect ""
End If
End Sub
Sub Out()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Sheets("Outubro").Unprotect ""
Worksheets("Outubro").Visible = True
Worksheets("Outubro").Activate
Call abertura
[A1].Select
Sheets("Outubro").Protect ""
End If
End Sub
Sub Nov()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Sheets("Novembro").Unprotect ""
Worksheets("Novembro").Visible = True
Worksheets("Novembro").Activate
Call abertura
[A1].Select
Sheets("Novembro").Protect ""
End If
End Sub
Sub Dez()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Sheets("Dezembro").Unprotect ""
Worksheets("Dezembro").Visible = True
Worksheets("Dezembro").Activate
Call abertura
[A1].Select
Sheets("Dezembro").Protect ""
End If
End Sub
Sub Inicio_Click()

Application.ScreenUpdating = False

Sheets("Score").Unprotect ""
Sheets("Help").Unprotect ""
Sheets("Janeiro").Unprotect ""
Sheets("Fevereiro").Unprotect ""
Sheets("Mar|fffd|o").Unprotect ""
Sheets("Abril").Unprotect ""
Sheets("Maio").Unprotect ""
Sheets("Junho").Unprotect ""
Sheets("Julho").Unprotect ""
Sheets("Agosto").Unprotect ""
Sheets("Setembro").Unprotect ""
Sheets("Outubro").Unprotect ""
Sheets("Novembro").Unprotect ""
Sheets("Dezembro").Unprotect ""
Sheets("Divide Stake").Unprotect ""
Sheets("Bet Simulator").Unprotect ""
Sheets("Stats Ano").Unprotect ""
Sheets("Bet Simulator").Unprotect ""
Sheets("Stats Competi|fffd||fffd|o").Unprotect ""
Sheets("Stats Mercados").Unprotect ""
Sheets("Resumo").Unprotect ""
Sheets("INICIO").Unprotect ""
Sheets("Configura|fffd||fffd|es").Unprotect ""
Sheets("Stake Plans").Unprotect ""
Sheets("H2H").Unprotect ""
Sheets("H2H Hoje").Unprotect ""
Sheets("Tipsters").Unprotect ""
Sheets("prognosticos").Unprotect ""
Worksheets("Score").Visible = False
Worksheets("Help").Visible = False
Worksheets("Janeiro").Visible = False
Worksheets("Fevereiro").Visible = False
Worksheets("Mar|fffd|o").Visible = False
Worksheets("Abril").Visible = False
Worksheets("Maio").Visible = False
Worksheets("Junho").Visible = False
Worksheets("Julho").Visible = False
Worksheets("Agosto").Visible = False
Worksheets("Setembro").Visible = False
Worksheets("Outubro").Visible = False
Worksheets("Novembro").Visible = False
Worksheets("Dezembro").Visible = False
Worksheets("Divide Stake").Visible = False
Worksheets("Bet Simulator").Visible = False
Worksheets("Stats Ano").Visible = False
Worksheets("Stats Competi|fffd||fffd|o").Visible = False
Worksheets("Stats Mercados").Visible = False
Worksheets("Resumo").Visible = False
Worksheets("Erros").Visible = False
Worksheets("Configura|fffd||fffd|es").Visible = False
Worksheets("Stake Plans").Visible = False
Worksheets("H2H").Visible = False
Worksheets("H2H Hoje").Visible = False
Worksheets("Tipsters").Visible = False
Worksheets("Prognosticos").Visible = False
Worksheets("INICIO").Activate
Call abertura
[A1].Select
Sheets("Score").Protect ""
Sheets("Help").Protect ""
Sheets("Janeiro").Protect ""
Sheets("Fevereiro").Protect ""
Sheets("Mar|fffd|o").Protect ""
Sheets("Abril").Protect ""
Sheets("Maio").Protect ""
Sheets("Junho").Protect ""
Sheets("Julho").Protect ""
Sheets("Agosto").Protect ""
Sheets("Setembro").Protect ""
Sheets("Outubro").Protect ""
Sheets("Novembro").Protect ""
Sheets("Dezembro").Protect ""
Sheets("Divide Stake").Protect ""
Sheets("Bet Simulator").Protect ""
Sheets("Stats Ano").Protect ""
Sheets("Bet Simulator").Protect ""
Sheets("Stats Competi|fffd||fffd|o").Protect ""
Sheets("Stats Mercados").Protect ""
Sheets("Resumo").Protect ""
Sheets("INICIO").Protect ""
Sheets("Configura|fffd||fffd|es").Protect ""
Sheets("Stake Plans").Protect ""
Sheets("H2H").Protect ""
Sheets("H2H Hoje").Protect ""
Sheets("Tipsters").Protect ""
Sheets("Prognosticos").Protect ""
End Sub
Sub Statsano()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Application.ScreenUpdating = False
Sheets("Stats Ano").Unprotect ""
Worksheets("Stats Ano").Visible = True
Worksheets("Stats Ano").Activate
Call abertura
[A1].Select
Sheets("Stats Ano").Protect ""
End If
End Sub
Sub Statscomp()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Application.ScreenUpdating = False
Sheets("Stats Competi|fffd||fffd|o").Unprotect ""
Worksheets("Stats Competi|fffd||fffd|o").Visible = True
Worksheets("Stats Competi|fffd||fffd|o").Activate
Call abertura
[A1].Select
Sheets("Stats Competi|fffd||fffd|o").Protect ""
End If
End Sub
Sub Mercdesp()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Application.ScreenUpdating = False
Sheets("Stats Mercados").Unprotect ""
Worksheets("Stats Mercados").Visible = True
Worksheets("Stats Mercados").Activate
Call abertura
[A1].Select
Sheets("Stats Mercados").Protect ""
End If
End Sub
Sub Banca()
Application.ScreenUpdating = False
Sheets("Banca").Unprotect ""
Worksheets("Banca").Visible = True
Worksheets("Banca").Activate
Call abertura
[A1].Select
Sheets("Banca").Protect ""
End Sub



Sub resumo()
If [Banca!B3] = "" And [Banca!C8] = "" And [Banca!C9] = "" And [Banca!C10] = "" And [Banca!C11] = "" And [Banca!C12] = "" And [Banca!C13] = "" And [Banca!C14] = "" And [Banca!C15] = "" And [Banca!C16] = "" And [Banca!C17] = "" And [Banca!C18] = "" And [Banca!C19] = "" Then
answer = MsgBox("Antes de efectuar qualquer modifica|fffd||fffd|o deve inserir um dep|fffd|sito. Deseja inserir dep|fffd|sito agora?", vbYesNo + vbQuestion, "Dep|fffd|sito")
        If answer = vbYes Then
        Worksheets("Banca").Activate
        [A1].Select
        End If
Else
Application.ScreenUpdating = False
Sheets("Resumo").Unprotect ""
Worksheets("Resumo").Visible = True
Worksheets("Resumo").Activate
Call abertura
[A1].Select
Sheets("Resumo").Protect ""
End If
End Sub
Sub betsimulator()
Application.ScreenUpdating = False
Sheets("Bet Simulator").Unprotect ""
Worksheets("Bet Simulator").Visible = True
Worksheets("Bet Simulator").Activate
Call abertura
[A1].Select
Sheets("Bet Simulator").Protect ""

End Sub
Sub Dividestake()
Application.ScreenUpdating = False
Sheets("Divide Stake").Unprotect ""
Worksheets("Divide Stake").Visible = True
Worksheets("Divide Stake").Activate
Call abertura
[A1].Select
Sheets("Divide Stake").Protect ""

End Sub
Sub Jan_Elim()
Dim Ultimaplanilha As String
Dim A As String
Retornaplanilha = ActiveSheet.Name
Sheets(Retornaplanilha).Unprotect ""

A = [A1]
Dim answer As Integer
answer = MsgBox("Tem a certeza que pretende eliminar todas as c|fffd|lulas preenchidas?", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
 Sheets("Listas").Select
    Range("AA4").Select
    Selection.Copy
Sheets(Retornaplanilha).Select

   
    Range("AC4").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Selection.AutoFill Destination:=Range("" & A)
    Range("" & A).Select
[AM4:AM34].ClearContents
        [A4:AB500].ClearContents
        [A1].Select
Else
    'do nothing
End If
Sheets(Retornaplanilha).Protect ""
End Sub

Sub elimitudo_Click()
[C6] = [Listas!T1]
answer = MsgBox("Tem a certeza que pretende eliminar tudo e come|fffd|ar novo ano? Esta ac|fffd||fffd|o pode demorar algum tempo.", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
    Sheets("Janeiro").Unprotect ""
    Sheets("Fevereiro").Unprotect ""
    Sheets("Mar|fffd|o").Unprotect ""
    Sheets("Abril").Unprotect ""
    Sheets("Maio").Unprotect ""
    Sheets("Junho").Unprotect ""
    Sheets("Julho").Unprotect ""
    Sheets("Agosto").Unprotect ""
    Sheets("Setembro").Unprotect ""
    Sheets("Outubro").Unprotect ""
    Sheets("Novembro").Unprotect ""
    Sheets("Dezembro").Unprotect ""
    Sheets("INICIO").Unprotect ""
    Sheets("Tipsters").Unprotect ""
    Sheets("ERROS").Unprotect ""
    
    [Banca!B3:Banca!G3].ClearContents
    [Banca!C8:Banca!D19].ClearContents
    [Janeiro!A4:Janeiro!AB1000].ClearContents
    [Fevereiro!A4:Fevereiro!AB1000].ClearContents
    [Mar|fffd|o!A4:Mar|fffd|o!AB1000].ClearContents
    [Abril!A4:Abril!AB1000].ClearContents
    [Maio!A4:Maio!AB1000].ClearContents
    [Junho!A4:Junho!AB1000].ClearContents
    [Julho!A4:Julho!AB1000].ClearContents
    [Agosto!A4:Agosto!AB1000].ClearContents
    [Setembro!A4:Setembro!AB1000].ClearContents
    [Outubro!A4:Outubro!AB1000].ClearContents
    [Novembro!A4:Novembro!AB1000].ClearContents
    [Dezembro!A4:Dezembro!AB1000].ClearContents
    [Janeiro!AM4:Janeiro!AM34].ClearContents
    [Fevereiro!AM4:Fevereiro!AM34].ClearContents
    [Mar|fffd|o!AM4:Mar|fffd|o!AM34].ClearContents
    [Abril!AM4:Abril!AM34].ClearContents
    [Maio!AM4:Maio!AM34].ClearContents
    [Junho!AM4:Junho!AM34].ClearContents
    [Julho!AM4:Julho!AM34].ClearContents
    [Agosto!AM4:Agosto!AM34].ClearContents
    [Setembro!AM4:Setembro!AM34].ClearContents
    [Outubro!AM4:Outubro!AM34].ClearContents
    [Novembro!AM4:Novembro!AM34].ClearContents
    [Dezembro!AM4:Dezembro!AM34].ClearContents
    [Tipsters!A6:Tipsters!A54].ClearContents
    [ERROS!B18:ERROS!F100].ClearContents
    
    Range([Janeiro!AC4], [Janeiro!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Fevereiro!AC4], [Fevereiro!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Mar|fffd|o!AC4], [Mar|fffd|o!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Abril!AC4], [Abril!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Maio!AC4], [Maio!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Junho!AC4], [Junho!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Julho!AC4], [Julho!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Agosto!AC4], [Agosto!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Setembro!AC4], [Setembro!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Outubro!AC4], [Outubro!AC1000]).FormulaR1C1 = Range([Listas!AA4]).FormulaR1C1
    Range([Novembro!AC4], [Novembro!AC1000]).FormulaR1C1 = Range([Listas!T4], [Listas!T1000]).FormulaR1C1
    Range([Dezembro!AC4], [Dezembro!AC1000]).FormulaR1C1 = Range([Listas!T4], [Listas!T1000]).FormulaR1C1
    
    
    
    Sheets("Janeiro").Protect ""
Sheets("Fevereiro").Protect ""
Sheets("Mar|fffd|o").Protect ""
Sheets("Abril").Protect ""
Sheets("Maio").Protect ""
Sheets("Junho").Protect ""
Sheets("Julho").Protect ""
Sheets("Agosto").Protect ""
Sheets("Setembro").Protect ""
Sheets("Outubro").Protect ""
Sheets("Novembro").Protect ""
Sheets("Dezembro").Protect ""
Sheets("INICIO").Protect ""
Sheets("Tipsters").Protect ""
Else
    'fazer nada
End If

End Sub



Sub Erros()
Application.ScreenUpdating = False
Worksheets("Erros").Visible = True
Worksheets("Erros").Activate
Call abertura
[A1].Select
End Sub

Sub stakes()
Application.ScreenUpdating = False
Worksheets("Stake Plans").Visible = True
Worksheets("Stake Plans").Activate
Call abertura
[A1].Select
End Sub
Attribute VB_Name = "Module4"
Sub h2hhoje()
Attribute h2hhoje.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False
Sheets("H2H Hoje").Unprotect ""
Worksheets("H2H Hoje").Visible = True
    Worksheets("H2H Hoje").Select
    Call abertura
    [A1].Select


    End Sub
Sub h2h()
Application.ScreenUpdating = False

Dim answer As Integer
answer = MsgBox("Est|fffd| em fase de manuten|fffd||fffd|o estar|fffd| dispon|fffd|vel numa pr|fffd|xima vers|fffd|o. Obrigado pela compreens|fffd|o, bons Greens.", vbOKOnly, "Aviso")
'Sheets("H2H").Unprotect ""
'Worksheets("H2H").Visible = True
'    Worksheets("H2H").Select
'    Call abertura
'    [A1].Select
End Sub
Sub prognosticos()



Application.ScreenUpdating = False
Set MyProgressbar = New ProgressBar
    
    With MyProgressbar
        .Title = "Consulta de progn|fffd|sticos em andamento"
        .ExcelStatusBar = True
        .StartColour = rgbWhite
        .EndColour = rgbBlack
    End With
    
    MyProgressbar.TotalActions = 3
    
    MyProgressbar.ShowBar

fcExibeAcaoProgressbar 1, "Analisando... pode demorar v|fffd|rios minutos..."
    Worksheets("dados").Visible = True
    Sheets("dados").Select
[EA:EP].Clear

    With ActiveSheet.QueryTables.Add(Connection:="URL;https://www.over25tips.com/free-football-betting-tips", Destination:=Range("EA1"))
        .Name = "free-football-betting-tips"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingRTF
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    
    
 fcExibeAcaoProgressbar 2, "Terminando a An|fffd|lise..."
  Dim rCell As Range
    Dim sPesquisa As String
    Dim sFirst As String
   
   
   sPesquisa = " = The home team must have had 7 goals or more in their last 3 home matches."
   Columns("EA:EA").Select
    Set rCell = Selection.Cells.Find(sPesquisa)
    If rCell Is Nothing Then
    
    Else
        sFirst = rCell.Address
        Range("" & sFirst & ":EP2000").ClearContents
    End If
        Cells.Replace What:="Football betting tips for tomorrow", Replacement:="Progn|fffd|sticos de Futebol para Amanh|fffd|", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
    Columns("EP:EP").Select
    Cells.Replace What:="Prediction", Replacement:="Previs|fffd|o", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False

     
 fcExibeAcaoProgressbar 3, "Terminando a An|fffd|lise..."
  [EA:EP].QueryTable.Delete
       Worksheets("dados").Visible = False
       Sheets("Prognosticos").Unprotect ""
    Worksheets("Prognosticos").Visible = True
    Worksheets("Prognosticos").Select
    Call abertura
    [A1].Select
    ActiveWindow.DisplayZeros = False
Sheets("Prognosticos").Protect ""
    'MyProgressbar.Complete 1
    MyProgressbar.Terminate
    
    
[A1].Select
End Sub
Attribute VB_Name = "Module5"
Sub lucromensal()
Dim answer As Integer
answer = MsgBox("Deseja definir a mesma percentagem (%) de objectivo final para todos os meses?", vbYesNo + vbQuestion, "Definir Objectivo")
If answer = vbYes Then
Application.ScreenUpdating = False
Worksheets("Janeiro").Visible = True
Worksheets("Fevereiro").Visible = True
Worksheets("Mar|fffd|o").Visible = True
Worksheets("Abril").Visible = True
Worksheets("Maio").Visible = True
Worksheets("Junho").Visible = True
Worksheets("Julho").Visible = True
Worksheets("Agosto").Visible = True
Worksheets("Setembro").Visible = True
Worksheets("Outubro").Visible = True
Worksheets("Novembro").Visible = True
Worksheets("Dezembro").Visible = True

Sheets("Banca").Select
[Banca!D3].Copy
Sheets("Janeiro").Select
[Janeiro!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Fevereiro").Select
[Fevereiro!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Mar|fffd|o").Select
[Mar|fffd|o!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Abril").Select
[Abril!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Maio").Select
[Maio!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Junho").Select
[Junho!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Julho").Select
[Julho!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Agosto").Select
[Agosto!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Setembro").Select
[Setembro!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Outubro").Select
[Outubro!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Novembro").Select
[Novembro!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Dezembro").Select
[Dezembro!AK49].Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

Worksheets("Janeiro").Visible = False
Worksheets("Fevereiro").Visible = False
Worksheets("Mar|fffd|o").Visible = False
Worksheets("Abril").Visible = False
Worksheets("Maio").Visible = False
Worksheets("Junho").Visible = False
Worksheets("Julho").Visible = False
Worksheets("Agosto").Visible = False
Worksheets("Setembro").Visible = False
Worksheets("Outubro").Visible = False
Worksheets("Novembro").Visible = False
Worksheets("Dezembro").Visible = False

Sheets("Banca").Activate

answer = MsgBox("Definido com sucesso. Poder|fffd| futuramente definir manualmente no respectivo m|fffd|s uma % diferente.", vbOKOnly, "Definir objectivo mensal")
[D3].Select

Else

End If
End Sub
Attribute VB_Name = "Module6"

Function HLink(rng As Range) As String
  If rng(1).Hyperlinks.Count Then
      HLink = rng.Hyperlinks(1).Address
  End If
End Function

Sub Jogoshoje()

Application.ScreenUpdating = False
Sheets("Jogos Hoje").Activate
Sheets("Jogos Hoje").Unprotect
    Range("a:l").Clear
    
    Set MyProgressbar = New ProgressBar
    
    With MyProgressbar
        .Title = "Consulta em andamento"
        .ExcelStatusBar = True
        .StartColour = rgbBlue
        .EndColour = rgbGreen
    End With
    
    MyProgressbar.TotalActions = 5
    
    MyProgressbar.ShowBar
fcExibeAcaoProgressbar 1, "Acessando a Internet..."
    
'
' Jogoshoje Macro
'

'
    With ActiveSheet.QueryTables.Add(Connection:="URL;http://data.nowgoal.cc/1x2", Destination:=Range("$A$1"))
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingAll
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    
 fcExibeAcaoProgressbar 2, "Analisando jogos..."
    
        Columns("M:N").Select
    Selection.SpecialCells(xlCellTypeFormulas, 2).Select
    Selection.Copy
    Sheets("Lista").Activate
    Range("B2").Select
    ActiveSheet.Paste
    
  fcExibeAcaoProgressbar 3, "Fazendo download dos jogos..."
    
       
    Dim contar As Integer
   
    contar = Sheets("Lista").Range("B2").End(xlDown).Row
    ActiveWorkbook.Names("listajogosh").RefersToR1C1 = "=Lista!R1C1:R" & contar & "C1"
    Sheets("Lista").Activate
    
    Columns("B:C").Select
    Range("A2").Select
    With ActiveWorkbook.Worksheets("Lista").Sort
        .SortFields.Clear
        .SortFields.Add Key:=Range("B2:B1000"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    
        .SetRange Range("B2:C1000")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    [A2].Select
        Selection.AutoFill Destination:=Range("A2:A1000")
  [D2].Select
    Selection.AutoFill Destination:=Range("D2:D1000")
   [F2].Select
    Selection.AutoFill Destination:=Range("F2:F1000")
    
 fcExibeAcaoProgressbar 4, "Processando os dados..."
    
 Sheets("Jogos Hoje").Activate
    Columns("D:J").Select
    Selection.Replace What:=".", Replacement:=",", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
 
 fcExibeAcaoProgressbar 5, "Terminando..."
 Sheets("H2H Hoje").Visible = True
 Sheets("H2H Hoje").Activate
 Range("D1").Select
 MyProgressbar.Terminate
 MsgBox "Jogos atualizados, selecione de seguida o jogo que deseja analisar e efetue o passo 3"
 Sheets("Jogos Hoje").Protect
 
End Sub

Sub jogoatual()
Application.ScreenUpdating = False
ActiveWindow.DisplayZeros = False
If Sheets("Jogos Hoje").Range("A1") = "" Then
Dim answer As Integer
answer = MsgBox("Primeiro |fffd| necess|fffd|rio atualizar os jogos do dia, quer fazer isso agora?", vbYesNo + vbQuestion, "Atualizar jogos do dia")
If answer = vbYes Then
Call Jogoshoje
Dim ans As Integer
ans = MsgBox("Jogos atualizados, selecione de seguida o jogo que deseja analisar e efetue o passo 3", vbOKOnly, "Atualizar jogos do dia")
End If
Else

Dim straddress As String
straddress = Sheets("H2H Hoje").Range("Z2").value
Sheets("Jogo atual").Activate
Sheets("Jogo atual").Range("A:AQ").Clear
    With ActiveSheet.QueryTables.Add(Connection:="URL;" & straddress, Destination:=Range("A1"))
   
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
    .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingRTF
        .WebTables = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
        
    End With
Dim i As Integer
    With ActiveSheet
        For i = .QueryTables.Count To 1 Step -1
            .QueryTables(i).Delete
        Next
    End With
    'substitui pontos por virgulas
         Range("A1:Z300").Select
  
    With Selection
        .Replace What:=".", Replacement:=",", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
        .Replace What:="(", Replacement:=" ", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
        .Replace What:=")", Replacement:=" ", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
        .Replace What:="[", Replacement:=" ", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
        .Replace What:="]", Replacement:=" ", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
    End With
  

  

Sheets("H2H Hoje").Unprotect
Sheets("H2H Hoje").Select
[A1].Select

Rows("4:92").EntireRow.Hidden = False
Sheets("H2H Hoje").Protect
End If
End Sub



Attribute VB_Name = "Module7"
Sub tips()
Application.ScreenUpdating = False
Sheets("Tipsters").Unprotect ""
Worksheets("Tipsters").Visible = True
Worksheets("Tipsters").Activate
Call abertura
[A1].Select
Sheets("Tipsters").Protect ""

End Sub


Sub retirement_Click()
Attribute retirement_Click.VB_ProcData.VB_Invoke_Func = " \n14"
Sheets("Stake Plans").Unprotect ""
If Rows("3:25").EntireRow.Hidden = True Then
    Rows("3:25").EntireRow.Hidden = False
Else
Rows("3:25").EntireRow.Hidden = True
Sheets("Stake Plans").Protect ""
End If
[A3].Select
End Sub

Sub retirementex_Click()
Application.ScreenUpdating = False
[L5,L8] = 1
[M5] = 6
[D5,M8] = 3
[G5,G6,G8,G15,G18,G19,G21,G23] = "Win"
[G7,G9:G14,G16,G17,G20,G22,G24] = "Lose"
[D6,D14,D18] = 2.2
[D6] = 2.2
[D7] = 4.5
[D8] = 1.8
[D9] = 2.55
[D10] = 6.5
[D11] = 11.5
[D12] = 7.6
[D13] = 4.4
[D15] = 2.9
[D16] = 5.5
[D17] = 3.3
[D19] = 1.44
[D20] = 11
[D21] = 5
[D22] = 4
[D23] = 4.8
[D24] = 7.5


End Sub

Sub retirementlimpar_Click()
Dim answer As Integer
answer = MsgBox("Tem a certeza que pretende eliminar as c|fffd|lulas preenchidas?", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
[D5:D24,G5:G24,L5:M5,L8:M8].ClearContents
Else
End If
End Sub

Sub kelly_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("26:49").EntireRow.Hidden = True Then
    Rows("26:49").EntireRow.Hidden = False
Else
Rows("26:49").EntireRow.Hidden = True
End If
[A26].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub kellyex_Click()
Application.ScreenUpdating = False
[K28] = 100
[L28] = 0.3
[M28] = 2
[D28] = 3
[G28,G29,G31,G35,G38,G41,G42,G44,G46] = "Win"
[G30,G32:G34,G36,G37,G39,G40,G43,G45,G47] = "Lose"
[D29,D37,D41] = 2.2
[D30] = 4.5
[D31] = 1.8
[D32] = 2.55
[D33] = 6.5
[D34] = 11.5
[D35] = 7.6
[D36] = 4.4
[D38] = 2.9
[D39] = 5.5
[D40] = 3.3
[D42] = 1.44
[D43] = 11
[D44] = 5
[D45] = 4
[D46] = 4.8
[D47] = 7.5

End Sub

Sub kellylimpar_Click()
Dim answer As Integer
answer = MsgBox("Tem a certeza que pretende eliminar as c|fffd|lulas preenchidas?", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
[D28:D47,G28:G47,K28:M28].ClearContents
Else
End If
End Sub

Sub Lay14_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("50:73").EntireRow.Hidden = True Then
    Rows("50:73").EntireRow.Hidden = False
Else
Rows("50:73").EntireRow.Hidden = True
End If
[A50].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub laylimpar_Click()
Dim answer As Integer
answer = MsgBox("Tem a certeza que pretende eliminar as c|fffd|lulas preenchidas?", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
[D52:E71,I52,J52].ClearContents
Else
End If
End Sub

Sub layex_Click()
Application.ScreenUpdating = False
[I52] = 5
[J52] = 20
[D52] = 3
[D53,D61] = 2.2
[D54] = 4.5
[D55] = 1.8
[D56] = 2.55
[D57] = 6.5
[D58] = 11.5
[D59] = 7.6
[D60] = 4.4
[D62,D70] = 3.2
[D63] = 4
[D64] = 5.2
[D65] = 6.8
[D66] = 4.4
[D67] = 8.1
[D68] = 3.2
[D69] = 2
[D71] = 12.2
[E52,E54,E57:E61,E64:E67,E70,E71] = "Win"
[E53,E55:E56,E62,E63,E68,E69] = "Lose"
End Sub


Sub Squareroot_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("74:97").EntireRow.Hidden = True Then
    Rows("74:97").EntireRow.Hidden = False
Else
Rows("74:97").EntireRow.Hidden = True
End If
[A74].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub squarelimpar_Click()
Dim answer As Integer
answer = MsgBox("Tem a certeza que pretende eliminar as c|fffd|lulas preenchidas?", vbYesNo + vbQuestion, "Apagar Dados")
If answer = vbYes Then
Application.ScreenUpdating = False
[D76:E95,I76].ClearContents
Else
End If
End Sub

Sub squareex_Click()
Application.ScreenUpdating = False
[I76] = 10
[D76] = 3
[D77,D85,D89] = 2.2
[D78] = 4.5
[D79] = 1.8
[D80] = 2.55
[D81] = 6.5
[D82] = 11.5
[D83,D95] = 7.6
[D84] = 4.4
[D86] = 2.9
[D87] = 5.5
[D88] = 3.3
[D90] = 1.44
[D91] = 11
[D92] = 5
[D93] = 4
[D94] = 4.8

[E76,E77,E79,E83,E89,E90,E92,E94] = "Win"
[E78,E80:E82,E84:E88,E91,E93,E95] = "Lose"
End Sub


Sub Reverselabouchere_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("98:113").EntireRow.Hidden = True Then
    Rows("98:113").EntireRow.Hidden = False
Else
Rows("98:113").EntireRow.Hidden = True
End If
[A98].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub Labouchere_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("114:129").EntireRow.Hidden = True Then
    Rows("114:129").EntireRow.Hidden = False
Else
Rows("114:129").EntireRow.Hidden = True
End If
[A114].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub updown_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("130:151").EntireRow.Hidden = True Then
    Rows("130:151").EntireRow.Hidden = False
Else
Rows("130:151").EntireRow.Hidden = True
End If
[A130].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub Oddsladder_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("152:170").EntireRow.Hidden = True Then
    Rows("152:170").EntireRow.Hidden = False
Else
Rows("152:170").EntireRow.Hidden = True
End If
[A152].Select
Sheets("Stake Plans").Protect ""
End Sub

Sub Fibonacci_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("171:186").EntireRow.Hidden = True Then
    Rows("171:186").EntireRow.Hidden = False
Else
Rows("171:186").EntireRow.Hidden = True
End If
[A171].Select
Sheets("Stake Plans").Protect ""
End Sub


Sub Parlay_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("187:210").EntireRow.Hidden = True Then
    Rows("187:210").EntireRow.Hidden = False
Else
Rows("187:210").EntireRow.Hidden = True
End If
[A187].Select
Sheets("Stake Plans").Protect ""
End Sub
Sub percentbet_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("211:234").EntireRow.Hidden = True Then
    Rows("211:234").EntireRow.Hidden = False
Else
Rows("211:234").EntireRow.Hidden = True
End If
[A211].Select
Sheets("Stake Plans").Protect ""
End Sub
Sub Martingale_Click()
Sheets("Stake Plans").Unprotect ""
If Rows("235:250").EntireRow.Hidden = True Then
    Rows("235:250").EntireRow.Hidden = False
Else
Rows("235:250").EntireRow.Hidden = True
End If
[A235].Select
Sheets("Stake Plans").Protect ""
End Sub


Attribute VB_Name = "Module8"
Sub abertura()
Application.ScreenUpdating = False
    Call Ocultar_tudo
    'Oculta todas as guias de menu
    If Sheets("Configura|fffd||fffd|es").[i5] = "Window" Then
    Application.DisplayFullScreen = False
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",true)"
    Else
    Application.DisplayFullScreen = True
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",false)"
    With Application
        .WindowState = xlMaximized
    End With
    End If
    'Ocultar barra de f|fffd|rmulas
    If Sheets("Configura|fffd||fffd|es").[i7] = "OFF" Then
    Application.DisplayFormulaBar = False
    Else
    Application.DisplayFormulaBar = True
    End If
    'Ocultar barra de status, disposta ao final da planilha
    If Sheets("Configura|fffd||fffd|es").[i15] = "OFF" Then
    Application.DisplayStatusBar = False
    Else
    Application.DisplayStatusBar = True
    End If
    'Alterar o nome do Excel
    Application.Caption = "Registo de apostas Anual v 6.6"
    
    
        'Ocultar barra horizontal
        ActiveWindow.DisplayHorizontalScrollBar = True
        
        'Ocultar barra vertical
        ActiveWindow.DisplayVerticalScrollBar = True
        
        'Ocultar guias das planilhas
        If Sheets("Configura|fffd||fffd|es").[i13] = "OFF" Then
        ActiveWindow.DisplayWorkbookTabs = False
        Else
        ActiveWindow.DisplayWorkbookTabs = True
        End If
        'Oculta os t|fffd|tulos de linha e coluna
        If Sheets("Configura|fffd||fffd|es").[i9] = "OFF" Then
        ActiveWindow.DisplayHeadings = False
        Else
        ActiveWindow.DisplayHeadings = True
        End If
                
        'Oculta as linhas de grade da planilha
        If Sheets("Configura|fffd||fffd|es").[i11] = "OFF" Then
        ActiveWindow.DisplayGridlines = False
        Else
        ActiveWindow.DisplayGridlines = True
    End If
End Sub

Sub random()

Sheets("ERROS").Range("G1").Calculate
Dim random As String
random = Sheets("ERROS").Range("G1")
Dim answer As Integer
answer = MsgBox("" & random, vbYesok + vbInformation, "Li|fffd||fffd|es a tirar")
End Sub


Sub configtabela()
Range("A150:AD1000").Select
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
End Sub
Sub inserirlinhaJan()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TJaneiro").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub
Sub inserirlinhaFev()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TFevereiro").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub
Sub inserirlinhaMar()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TMarco").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub
Sub inserirlinhaAbr()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TAbril").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub
Sub inserirlinhaMai()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TMaio").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub

Sub inserirlinhaJun()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TJunho").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub
Sub inserirlinhaJul()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TJulho").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub

Sub inserirlinhaAgo()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TAgosto").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub

Sub inserirlinhaSet()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TSetembro").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub

Sub inserirlinhaOut()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TOutubro").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub

Sub inserirlinhaNov()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TNovembro").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub

Sub inserirlinhaDez()
Dim valor As Integer

valor = Range("A2")
Rows("3:" & valor).EntireRow.Hidden = False
    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("TDezembro").Resize Range("$A$3:$AD" & valor)
    
  Call configtabela
  
 [A1].Activate
End Sub
Attribute VB_Name = "Module9"
Sub zoom100()
ActiveSheet.Unprotect
ActiveWindow.Zoom = 100
[v1] = ActiveWindow.Zoom / 100
ActiveSheet.Protect
End Sub
Sub zoommais()
ActiveSheet.Unprotect
x = ActiveWindow.Zoom
ActiveWindow.Zoom = (x + 10)
[v1] = ActiveWindow.Zoom / 100
ActiveSheet.Protect
End Sub
Sub zoommenos()
ActiveSheet.Unprotect
x = ActiveWindow.Zoom
ActiveWindow.Zoom = (x - 10)
[v1] = ActiveWindow.Zoom / 100
ActiveSheet.Protect
End Sub
Sub inserirtipster()
Attribute inserirtipster.VB_ProcData.VB_Invoke_Func = " \n14"

ActiveSheet.Unprotect
valor = [A2]

    Application.ScreenUpdating = False
    ActiveSheet.ListObjects("Tabelatipsters").Resize Range("$A$5:$G" & valor)
    
  
    [A3].Select
    ActiveSheet.Protect
End Sub

Attribute VB_Name = "ProgressBar"
Attribute VB_Base = "0{5515A2CE-44CE-4319-9228-9EC2136A6A0E}{A4A21AB6-60F1-44FB-9C06-5751E44F6F15}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





'##########################################################################
'##########################################################################
'Module Name: ProgressBar
'Module Type: Class
'Purpose    : Define a Progressbar Object
'##########################################################################
'Author     : Ejaz Ahmed
'Email      : StrugglingToExcel@outlook.com
'Website    : http://strugglingtoexcel.wordpress.com/
'Date       : 26 August 2014
'##########################################################################
'Module Options
'##########################################################################
Option Explicit
'##########################################################################

'##########################################################################
'Private Variables and Objects
'##########################################################################
'Private variables for storing the Main Properties of the Object
'Assigned to Caption Property of the Form.
Private cFormTitle As String
'Set to Ture if you'd like the Excel Status bar to also Show status.
Private cExcelStatusBar As Boolean
'Used to set to total number of actions the user wishes to perform.
Private cTotalActions As Long
'Remembers the number of completed actions. This variable can be overriddin
'by setting a number to the ActionNumber Property.
Private cActionNumber As Long
'Remembers the message that the user wishes to display in the Progressbar's
'Status bar.
Private cStatusMessage As String
'Remembers the Initial Width of the Progressbar Label.
Private cBarWidth As Double
'Remembers the Percentage of Actions Completed. Assigned to the Percent
'indicator in the ProgressBar form.
Private cPercentComplete As String

'Private Variables to Remember if certain properties were set
Private cFormShowStatus As Boolean
Private cTotalActionsSet As Boolean

'Private Variables to Handle the Colour Changes
Private cStartColourSet As Boolean
Private cEndColourSet As Boolean
Private cChangeColours As Boolean
Private cStartColour As XlRgbColor
Private cEndColour As XlRgbColor
Private cStartRed As Long, cEndRed As Long
Private cStartGreen As Long, cEndGreen As Long
Private cStartBlue As Long, cEndBlue As Long
'##########################################################################

'##########################################################################
'Error Numbers and Description:
'##########################################################################
' 1 - Set this Property before Running the Show Method.
' 2 - Set TotalActions Property First.
' 3 - Current Action number is greater than Total Actions.
' 4 - TotalActions cannot be changed after it has been set.
' 5 - Run the Show Method First
' 6 - Run the Complete Method only after all the actions have been completed.
' 7 - Progress Bar has already been Loaded.
' 8 - Set StartColour First.
'##########################################################################

'##########################################################################
'Class Events
'##########################################################################

'This Procedure is Run when the Form in Initiated
Private Sub UserForm_Initialize()
'Set Default Values for all the Variables
cActionNumber = 0
cTotalActions = 0
cStatusMessage = "Ready"
cFormTitle = "Progress Bar"
cExcelStatusBar = False
cFormShowStatus = False
cTotalActionsSet = False
cPercentComplete = "0%"
cStartColourSet = False
cEndColourSet = False
cStartColour = rgbDodgerBlue
cChangeColours = False

Me.Title = cFormTitle
Me.StatusMessageBox.Caption = " " & cStatusMessage
Me.PercentIndicator.Caption = cPercentComplete
End Sub

'This Sub is run when the class is terminated
Private Sub UserForm_Terminate()
Application.StatusBar = False
If Not Me.PercentIndicator = "100%" Then
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    End
End If
End Sub

'##########################################################################
'Properties
'##########################################################################

'This Procedure is Executed when the Title Propoerty is Set
Public Property Let Title(value As String)

'Proceed only if the Form has not been loaded already
If cFormShowStatus Then
    Err.Raise 1, cFormTitle, "Set this Property before Running the Show Method."
Else
    'Proceed if the user did not send a blank string
    If Not value = vbNullString Then
        'Initialize the private class variable
        cFormTitle = value
        'Update the Form's title if it has already been loaded
        If Not Me Is Nothing Then
            'Do Events makes sure the rest of your macro keeps running
            DoEvents
            Me.Caption = cFormTitle
        End If
    End If
End If

End Property

'This Procedure lets the User tries to access the Title Property.
Public Property Get Title() As String
Title = cFormTitle
End Property

'This Procedure is Executed when the ExcelStatusBar Propoerty is Set.
Public Property Let ExcelStatusBar(value As Boolean)

'Proceed only if the Form has not been loaded already
If cFormShowStatus Then
    Err.Raise 1, cFormTitle, "Set this Property before Running the Show Method."
Else
    'Initialize the private class variable
    cExcelStatusBar = value
    'If the user wants to see the Status messages in Excel's
    'Status bar also, make sure it is displayed.
    If value Then
        Application.DisplayStatusBar = True
    End If
End If
End Property

'This Procedure lets the User tries to access the ExcelStatusBar Property.
Public Property Get ExcelStatusBar() As Boolean
ExcelStatusBar = cExcelStatusBar
End Property

'This Procedure is Executed when the TotalActions Propoerty is Set.
Public Property Let TotalActions(value As Long)

'Proceed only if the Form has not been loaded already
If cFormShowStatus Then
    Err.Raise 1, cFormTitle, "Set this Property before Running the Show Method."
Else
    'Proceed if the User has not set the TotalActions property
    'Else Display an error message
    If cTotalActionsSet Then
        Err.Raise 4, cFormTitle, "TotalActions cannot be changed after it has been set."
    Else
        'Initialize the private class variables
        cTotalActions = value
        'This is used to make sure the user does not change this later
        cTotalActionsSet = True
    End If
End If
   
End Property

'This Procedure lets the User tries to access the ActionNumber Property.
Public Property Get TotalActions() As Long
TotalActions = cTotalActions
End Property

'This Procedure is Executed when the StartColour Propoerty is Set.
Public Property Let StartColour(value As XlRgbColor)

'Proceed only if the Form has not been loaded already
If cFormShowStatus Then
    Err.Raise 1, cFormTitle, "Set this Property before Running the Show Method."
Else
    cStartColourSet = True
    cStartColour = value
    cStartRed = GetPrimaryColour(cStartColour, "R")
    cStartGreen = GetPrimaryColour(cStartColour, "G")
    cStartBlue = GetPrimaryColour(cStartColour, "B")
End If

End Property

'This Procedure is Executed when the EndColour Propoerty is Set.
Public Property Let EndColour(value As XlRgbColor)

'Proceed only if the Form has not been loaded already
If cFormShowStatus Then
    Err.Raise 1, cFormTitle, "Set this Property before Running the Show Method."
Else
    If Not cStartColourSet Then
        Err.Raise 8, cFormTitle, "Set StartColour First."
    Else
        cEndColourSet = True
        cEndColour = value
        cEndRed = GetPrimaryColour(cEndColour, "R")
        cEndGreen = GetPrimaryColour(cEndColour, "G")
        cEndBlue = GetPrimaryColour(cEndColour, "B")
        cChangeColours = Not CBool(cStartColour = cEndColour)
    End If
End If

End Property

'This Procedure is Executed when the ActionNumber Propoerty is Set.
Public Property Let ActionNumber(value As Long)

'Update the private class variable
cActionNumber = value

'Call the Sub that Checks if the inputs are valid
'and refreshes the Progressbar
Call UpdateTheBar

End Property

'This Procedure lets the User tries to access the ActionNumber Property.
Public Property Get ActionNumber() As Long
ActionNumber = cActionNumber
End Property


'This Procedure is Executed when the ProgressStatusMessage Propoerty is Set.
Public Property Let StatusMessage(value As String)

'Update the private class variable
cStatusMessage = value

'Call the Sub that Checks if the inputs are valid
'and refreshes the Progressbar
Call UpdateTheBar

End Property

'This Procedure lets the User tries to access the ProgressStatusMessage Property.
Public Property Get StatusMessage() As String
StatusMessage = cStatusMessage
End Property


'##########################################################################
'Public Methods
'##########################################################################

Public Sub ShowBar()
If cFormShowStatus Then
    Err.Raise 7, cFormTitle, "Progress Bar has already been Loaded."
Else
    'Do Events makes sure the rest of your macro keeps running
    DoEvents
    'Remember the Initial Width of the ProgressBar
    cBarWidth = Me.ProgressBar.Width
    'Set the Width of the Progressbar to Zero
    Me.ProgressBar.Width = 0
    'Update the Title of the Form
    Me.Caption = cFormTitle
    'Initialize the Private Class Variable
    cFormShowStatus = True
    'Change the Colour of the Progressbar to StartColour
    Me.ProgressBar.BackColor = cStartColour
    Me.ProgressBox.BorderColor = cStartColour
    'Show the Form
    Me.Show
    'Repaint the Form
    Me.Repaint
End If
End Sub


'NextAction:Let the Progressbar know an action has been completed. I recommend using this
'method over manually overriding the ProgressStatusMessage and CurrentAction Properties
Public Sub NextAction(Optional ByVal ProgressStatusMessage As String, _
    Optional ByVal ShowActionCount As Boolean = True)

cActionNumber = cActionNumber + 1
If ShowActionCount Then
    cStatusMessage = "Action " & cActionNumber & " of " _
        & cTotalActions & " | " & ProgressStatusMessage
Else
    cStatusMessage = ProgressStatusMessage
End If

Call UpdateTheBar
    
End Sub

'Complete: This Method Can be used to Let the User Know that the Run Has
'been Completed. It Changes the statues message to the message specified
'and releases the control this object has over the excel status bar.
Public Sub Complete(Optional ByVal WaitForSeconds As Long = 0, _
    Optional ByVal Prompt As String = "Processamento Finalizado!")
    
Dim Counter As Long

'Proceed if the ProgressBar has already been loaded
'Display an error message otherwise
If cFormShowStatus Then
    'Display an error message if the CurrentAction numeber is lesser than the Number of
    'TotalActions. Otherwise, Change the Status Message to the desired message.
    If cActionNumber < cTotalActions Then
        Err.Raise 6, cFormTitle, _
            "Run the Complete Method only after all the actions have been completed."
    Else
        'Release control over Excel's status bar
        If cExcelStatusBar Then
            Application.StatusBar = False
        End If

        If WaitForSeconds > 0 Then
            For Counter = WaitForSeconds To 1 Step -1
                DoEvents
                Me.StatusMessageBox.Caption = " " & Prompt '& _
                    " | This Window will close in " & Counter & " " & _
                    IIf(Counter = 1, "second.", "seconds.")
                Application.Wait (Now() + TimeValue("00:00:01"))
            Next Counter
            Call Terminate
        Else
            'Do Events makes sure the rest of your macro keeps running
            DoEvents
            'Update the Status Message
            Me.StatusMessageBox.Caption = " " & Prompt
        End If
            
    End If
Else
    Err.Raise 5, cFormTitle, "Run the Show Method First"
End If
End Sub

'Terminate: Let the user Terminate Manually if they prefer
Public Sub Terminate()
'Terminate the Form if it is already loaded. Display an Error Message
'Otherwise
If cFormShowStatus Then
    'If the Form is Loaded, Unload it
    If cFormShowStatus Then
        Me.Hide
        cFormShowStatus = False
        cTotalActionsSet = False
        cActionNumber = 0
        cTotalActions = 0
    End If
    'Return the Appliation StatusBar control to Excel
    If cExcelStatusBar Then
        Application.StatusBar = False
    End If
Else
    Err.Raise 5, cFormTitle, "Run the Show Method First"
End If
End Sub

'##########################################################################

'##########################################################################
'Private Subs needed by this Class
'##########################################################################
Private Sub UpdateTheBar()

'Proceed only if the user has already set the TotalActions property
'Else Display an error message
If cTotalActionsSet Then
    'Proceed only if the CurrentAction number is lesser than or equal to
    'the Total Actions
    If cActionNumber > cTotalActions Then
        Err.Raise 3, cFormTitle, _
            "Current Action number is greater than Total Actions."
    Else
        'Proceed only if the Form has already been Showed. Display an
        'error message otherwise
        If cFormShowStatus Then
            'Call the Procedure that Updates the Bar
            Call UpdateProgress
        Else
            Err.Raise 5, cFormTitle, "Run the Show Method First"
        End If
    End If
Else
    Err.Raise 2, cFormTitle, "Set TotalActions Property First."
End If

End Sub

Private Sub UpdateProgress()

'Declare Sub Level Variables
Dim FractionComplete As Double
Dim ProgressPercent As String
Dim BarWidth As Double
Dim BarColour As XlRgbColor

'Initialize Variables
FractionComplete = cActionNumber / cTotalActions
BarWidth = cBarWidth * FractionComplete
cPercentComplete = Format(FractionComplete * 100, "0") & "%"

'Do Events makes sure the rest of your macro keeps running
DoEvents
'Change the Width of the Label
Me.ProgressBar.Width = BarWidth
'Update the Percent Indicator
Me.PercentIndicator.Caption = cPercentComplete

'Change the Colour of the Progressbar if needed
If cChangeColours Then
    BarColour = RGB( _
        cStartRed + (cEndRed - cStartRed) * FractionComplete, _
        cStartGreen + (cEndGreen - cStartGreen) * FractionComplete, _
        cStartBlue + (cEndBlue - cStartBlue) * FractionComplete)
    Me.ProgressBar.BackColor = BarColour
End If

'Set the Status Bar Message
Me.StatusMessageBox.Caption = " " & cStatusMessage
'Update Excel's Status Bar if needed
If cExcelStatusBar Then
    Application.StatusBar = ProgressText(cActionNumber, cTotalActions) & _
        " | " & cPercentComplete & " | " & cStatusMessage
End If

'Repaint the Form
Me.Repaint
End Sub
'##########################################################################

'##########################################################################
'Private Functions Needed by this Class Module
'##########################################################################

'##########################################################################
'GetPrimaryColour: Function used to extract the numerical value of each
'of the promary colours in a colour. Every colour is a mixture of three
'primary colours: Red, Blue and Green. In Excel, colours are represented
'as Hexadecimal Numbers of the Format "00BBGGRR", but they are stored as
'Decimal numbers. This function converts the Long Variable into Hexadicamal
'first, and then extracts the two characters that represent the primary
'colour and then converts it back to long.
'##########################################################################
'Author     : Ejaz Ahmed
'Email      : StrugglingToExcel@outlook.com
'Website    : http://strugglingtoexcel.wordpress.com/
'Date       : 26 August 2014
'##########################################################################
Private Function GetPrimaryColour(ByVal WhichColour As XlRgbColor, _
    ByVal RedBlueGreen As String) As Long
   
'Declate Function Level Variables
Dim HexString As String

'Convert Decimal to HexaDecimal
HexString = CStr(Hex(WhichColour))
'Prefix 0's so the string is always 8 Characters in length
HexString = String(8 - Len(HexString), "0") & HexString

'Extract the Red Blue or Green part of the Hexadecimal Number
'stored in HexString. Remember, that we need to prefix "&H"
'to tell excel that the number is Hexadecimal, so we can use
'the cLng function to convert it into the Decimal System Later.
Select Case StrConv(RedBlueGreen, vbUpperCase)
    Case "R"
        HexString = "&H" & Mid(HexString, 7, 2)
    Case "G"
        HexString = "&H" & Mid(HexString, 5, 2)
    Case "B"
        HexString = "&H" & Mid(HexString, 3, 2)
    Case Else
        HexString = "-100"
End Select

'Return the colour value in the 0 to 225 format.
GetPrimaryColour = CLng(HexString)
    
End Function


'##########################################################################
'ProgressText: Function to generate the Text, using unicode characters, to
'show a progress bar on Excel's Status Bar
'##########################################################################
'Author     : Ejaz Ahmed
'Email      : StrugglingToExcel@outlook.com
'Website    : http://strugglingtoexcel.wordpress.com/
'Date       : 22 September 2014
'##########################################################################
Function ProgressText(ByVal ActionNumber As Long, _
     ByVal TotalActions As Long, _
     Optional ByVal BarLength As Long = 15)
     
Dim BarComplete As Long
Dim BarInComplete As Long
Dim BarChar As String
Dim SpaceChar As String
Dim TempString As String

BarChar = ChrW(&H2589)
SpaceChar = ChrW(&H2000)

BarLength = Round(BarLength / 2, 0) * 2
BarComplete = Fix((ActionNumber * BarLength) / TotalActions)
BarInComplete = BarLength - BarComplete
ProgressText = String(BarComplete, BarChar) & String(BarInComplete, SpaceChar)
  
End Function
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
