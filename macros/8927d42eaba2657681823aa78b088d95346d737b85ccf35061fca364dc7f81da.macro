Attribute VB_Name = "AddItem"
Attribute VB_Base = "0{696C56E0-25B0-48BD-9025-2F58A46CE48C}{249C5B55-BF71-4FEE-B5EE-B01ECE415CB8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

 
 Private Sub UserForm_Activate()
    On Error Resume Next
    '----------------------------------------------------------------------------------------
    'POSITION FORM
    '----------------------------------------------------------------------------------------
    Me.Top = Application.Top + (Application.Height - Me.Height) / 2
    Me.Left = Application.Left + 300
    
    iStart = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0) + 1
    iEnd = Range("D" & Rows.Count).End(xlUp).Row
    Me.ComboBox1.Clear

    For i = iStart To iEnd
    
        If Range("A" & i).Value <> vbNullString Then Me.ComboBox1.AddItem Range("A" & i).Value
        If Range("A" & i).Value <> vbNullString Then Me.ComboBox2.AddItem Range("A" & i).Value
    
    Next i

End Sub
Private Sub ComboBox1_Change()
    On Error Resume Next
    
    If ComboBox1.Value <> "" Then
        Me.OptionButton1.Value = True
        ComboBox2.Value = ""
    End If
    
End Sub
Private Sub ComboBox2_Change()
    On Error Resume Next
    
    If ComboBox2.Value <> "" Then
        Me.OptionButton3.Value = True
        ComboBox1.Value = ""
    End If
    
End Sub
Private Sub CommandButton1_Click()
    On Error Resume Next
    
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
'----------------------------------------------------------------------------------------
'UNPROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1
'----------------------------------------------------------------------------------------
'UNPROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Unprotect PASSWORD:=PASSWORD1
'----------------------------------------------------------------------------------------
'GETS LAST ROW NUMBER
'----------------------------------------------------------------------------------------
    iStart = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0) + 1
    LastRow = Range("D" & Rows.Count).End(xlUp).Row
'----------------------------------------------------------------------------------------
'ADDS NEW ITEM
'----------------------------------------------------------------------------------------
    If Me.OptionButton2.Value = True Then         ' ADD NEW ITEM AT BOTTOM
        Sheet0.Range("A26:L29").Copy Destination:=Range("A" & LastRow + 1)
        Range("A" & LastRow + 1).Value = Me.ComboBox1.ListCount + 1
    ElseIf Me.OptionButton1.Value = True Then     ' ADD NEW ITEM AFTER SELECTED ITEM
        If Me.ComboBox1.Value = "" Then
            MsgBox "Please select an Item.", vbCritical, "Error"
            Me.ComboBox1.SetFocus
            
            ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
            AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
    
            Application.Calculation = xlCalculationAutomatic
            Application.ScreenUpdating = True
            Application.EnableEvents = True
            
            Exit Sub
        End If
        
        Cnt = Me.ComboBox1.ListCount
        SelItem = Me.ComboBox1.ListIndex + 1
           
        If SelItem = Cnt Then
            Sheet0.Range("A26:L29").Copy Destination:=Range("A" & LastRow + 1)
            Range("A" & LastRow + 1).Value = Me.ComboBox1.ListCount + 1
        Else
            ' IDENTIFY ROW OF FIRST ITEM
            Range("A" & iStart & ":A" & LastRow).Select
        
            Set rng = Selection.Find(What:=Me.ComboBox1.Value + 1, After:=ActiveCell, LookIn:=xlFormulas, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
    
            If Not rng Is Nothing Then aEnd = rng.Row
            
            ' INSERT NEW ITEM
            Rows(aEnd & ":" & aEnd + 3).Select
            Selection.Insert Shift:=xlDown
            Sheet0.Range("A26:L29").Copy Destination:=Range("A" & aEnd)
            
            Range("F" & aEnd).Select
            
            Range("A" & aEnd).Value = Me.ComboBox1.Value + 1
        End If
    ElseIf Me.OptionButton3.Value = True Then     ' DELETES ITEM SELECTED
        If Me.ComboBox2.Value = "" Then
            MsgBox "Please select an Item.", vbCritical, "Error"
            Me.ComboBox2.SetFocus
            
            ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
            AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
    
            Application.Calculation = xlCalculationAutomatic
            Application.ScreenUpdating = True
            Application.EnableEvents = True
            
            Exit Sub
        End If
        
        Cnt = Me.ComboBox2.ListCount
        SelItem = Me.ComboBox2.ListIndex + 1
        
        If Cnt = 1 Then
            MsgBox "Cannot delete Item 1.", vbCritical, "Error"
        Else
            ' IDENTIFY ROW OF FIRST ITEM
            Range("A" & iStart & ":A" & LastRow).Select
        
            Set rng = Selection.Find(What:=Me.ComboBox2.Value, After:=ActiveCell, LookIn:=xlFormulas, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)
    
            If Not rng Is Nothing Then aEnd = rng.Row Else aEnd = iStart
            
            ' INSERT NEW ITEM
            Rows(aEnd & ":" & aEnd + 3).Select
            Selection.Delete Shift:=xlUp
            
            Range("F" & aEnd).Select
                
            If SelItem <> Cnt Then Range("A" & aEnd).Value = Me.ComboBox2.Value
        End If
    End If
'----------------------------------------------------------------------------------------
'ADDS NEW ITEM NUMBER TO COMBOBOX
'----------------------------------------------------------------------------------------
    iEnd = Range("D" & Rows.Count).End(xlUp).Row
    Me.ComboBox1.Clear
    Me.ComboBox2.Clear
    NewItemNo = 1
    
    For i = iStart To iEnd
        If Range("A" & i).Value <> vbNullString Then
            Range("A" & i).Value = NewItemNo
            Me.ComboBox1.AddItem Range("A" & i).Value
            Me.ComboBox2.AddItem Range("A" & i).Value
            NewItemNo = NewItemNo + 1
        End If
    Next i
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True

    If Me.OptionButton2.Value = True Then Range("B" & iEnd).Select Else Range("B" & aEnd).Select
    
    Me.OptionButton2.Value = True
    
'----------------------------------------------------------------------------------------
'PROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
    AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
'----------------------------------------------------------------------------------------
'PROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Protect PASSWORD:=PASSWORD1, Structure:=True, Windows:=False
    
End Sub
Attribute VB_Name = "ExportSelection"
Attribute VB_Base = "0{15B94B57-A347-4194-A731-572E1F87E43C}{9C3496E2-823E-46BC-82E7-783CBDF1CDED}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

 Private Sub UserForm_Activate()
    On Error Resume Next
    '----------------------------------------------------------------------------------------
    'POSITION FORM
    '----------------------------------------------------------------------------------------
    Me.Top = Application.Top + (Application.Height - Me.Height) / 2
    Me.Left = Application.Left + 200
    
    If Mid(Sheet1.PageSetup.CenterFooter, 67, 3) = "EAR" Then
        Me.TextBox2.SetFocus
    ElseIf Mid(Sheet1.PageSetup.CenterFooter, 67, 3) = "ITA" Then
        Me.TextBox3.SetFocus
    End If
    
    If OptionButton2.Value = True Then
        Me.TextBox2.Text = Sheet0.Range("G4").Value
    ElseIf OptionButton3.Value = True Then
        Me.TextBox3.Text = Sheet0.Range("G4").Value
    End If
    
End Sub
 
Private Sub TextBox2_Enter()
    OptionButton2.Value = True
End Sub

Private Sub TextBox3_Enter()
    OptionButton3.Value = True
End Sub

Private Sub TextBox2_Change()
    TextBox2.Text = UCase(TextBox2.Text)
End Sub

Private Sub TextBox3_Change()
    'TextBox3.Text = UCase(TextBox3.Text)
End Sub

Private Sub CommandButton1_Click()
    On Error Resume Next
    
'----------------------------------------------------------------------------------------
'UNPROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1
'----------------------------------------------------------------------------------------
'UNPROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Unprotect PASSWORD:=PASSWORD1
    
'----------------------------------------------------------------------------------------
'UPDATES THE FOOTER EXPORT STATEMENT
'----------------------------------------------------------------------------------------
    If OptionButton1.Value = True Then
        NoTechData
    ElseIf OptionButton2.Value = True Then
        If TextBox2.Text = vbNullString Then
            MsgBox "Please enter an ECCN."
            TextBox2.SetFocus
            Exit Sub
        Else
            EARData
        End If
    ElseIf OptionButton3.Value = True Then
        If TextBox3.Text = vbNullString Then
            MsgBox "Please enter an ITAR category."
            TextBox3.SetFocus
            Exit Sub
        Else
            ITARData
        End If
    End If
    
    Unload Me
'----------------------------------------------------------------------------------------
'PROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
    AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
'----------------------------------------------------------------------------------------
'PROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Protect PASSWORD:=PASSWORD1, Structure:=True, Windows:=False
    

End Sub

Private Sub NoTechData()
    On Error Resume Next
    
    Sheet0.Range("G4:L4").ClearContents
    
    With Sheet1.PageSetup
        .LeftFooter = "FORM " & FileName
        .CenterFooter = "No Technical Data"
        .RightFooter = "&P of  &N"
    End With
    
    Application.PrintCommunication = True
    
End Sub

Private Sub EARData()
    On Error Resume Next
    
    Sheet0.Range("G4").Value = TextBox2.Text
    
    With Sheet1.PageSetup
        .LeftFooter = "FORM " & FileName
        .CenterFooter = "WARNING - This information contains technical data subject to the EAR. ECCN: &U" & TextBox2.Text
        .RightFooter = "&P of  &N"
    End With
    
    Application.PrintCommunication = True
    
End Sub


Private Sub ITARData()
    On Error Resume Next
    
    Sheet0.Range("G4").Value = TextBox3.Text
    
    With Sheet1.PageSetup
        .LeftFooter = "FORM " & FileName
        .CenterFooter = "WARNING - This information contains technical data subject to the ITAR. Category: &U" & TextBox3.Text
        .RightFooter = "&P of  &N"
    End With
    
    Application.PrintCommunication = True
    
End Sub

Attribute VB_Name = "PartsAffected"

Private Sub AddRow()
    On Error Resume Next
    
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
'----------------------------------------------------------------------------------------
'UNPROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Unprotect PASSWORD:=PASSWORD1
'----------------------------------------------------------------------------------------
'GETS LAST ROW NUMBER
'----------------------------------------------------------------------------------------
    LastRow = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0) ' - 1
'----------------------------------------------------------------------------------------
'ADDS NEW ITEM
'----------------------------------------------------------------------------------------
    Rows(LastRow & ":" & LastRow).Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
'----------------------------------------------------------------------------------------
'FORMATS ROW
'----------------------------------------------------------------------------------------

    LR2 = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0) - 1
    For i = 21 To LR2
        Range("A" & i & ":C" & i).Merge
        Range("E" & i & ":G" & i).Merge
    Next i
    
    Range("A" & LastRow & ":L" & LastRow).Select
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
'----------------------------------------------------------------------------------------
'PROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
    AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
End Sub

Private Sub DeleteRow()
    On Error Resume Next
    
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
'----------------------------------------------------------------------------------------
'GETS ROWS OF SELECTED RANGE TO DELETE
'----------------------------------------------------------------------------------------
    SelectedRow = ActiveCell.Row
    SelectedRowStart = Selection.Rows(1).Row
    SelectedRowEnd = Selection.Rows.Count + SelectedRowStart - 1
    LR = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0)
'----------------------------------------------------------------------------------------
'CHECKS IF ROWS OF SELECTED RANGE CAN BE DELETED
'----------------------------------------------------------------------------------------
    If SelectedRowEnd >= LR Then SelectedRowEnd = LR - 1
    If SelectedRowStart = 21 And SelectedRowEnd = LR - 1 And SelectedRowStart <> SelectedRowEnd Then SelectedRowStart = 22
    
    If SelectedRowStart < 21 Then
        MsgBox "Selected range includes row(s) that cannot be deleted.", vbCritical, "Error"
    ElseIf SelectedRowStart > 20 And SelectedRowStart < LR Then 'WITHIN RANGE FOR DELETION
        If SelectedRowStart = LR - 1 And SelectedRowStart = 21 Then
            MsgBox "Row cannot be deleted.", vbCritical, "Error"
        Else
            Ans = MsgBox("Delete selected row(s)?", vbYesNoCancel, "Confirm Delete")
            
            If Ans = 6 Then ' Yes
'----------------------------------------------------------------------------------------
'UNPROTECTS SHEET
'----------------------------------------------------------------------------------------
                ActiveSheet.Unprotect PASSWORD:=PASSWORD1
'----------------------------------------------------------------------------------------
'DELETES SELECTED ITEM
'----------------------------------------------------------------------------------------
                Rows(SelectedRowStart & ":" & SelectedRowEnd).Select
                Selection.Delete Shift:=xlUp
                Range("A" & SelectedRowStart - 1).Select
'----------------------------------------------------------------------------------------
'PROTECTS SHEET
'----------------------------------------------------------------------------------------
                ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
                AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
            End If
        End If
    ElseIf SelectedRowStart = LR Then
        MsgBox "Selected row cannot be deleted.", vbCritical, "Error"
    ElseIf SelectedRowStart > LR Then
        MsgBox "Item must be deleted by Add/Delete button ONLY.", vbCritical, "Error"
    End If
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
End Sub


Attribute VB_Name = "PrintView"
Private Sub EditView()

    Application.PrintCommunication = False
    
    ActiveSheet.PageSetup.Zoom = 70
    
    Application.PrintCommunication = True

End Sub

Private Sub PrintingView()

    Application.PrintCommunication = False
    
    With ActiveSheet.PageSetup
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
    End With
    
    Application.PrintCommunication = True

End Sub

Private Sub GeneralPrintView()

    Application.PrintCommunication = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$6"
        .PrintTitleColumns = ""
    End With
    Application.PrintCommunication = True
    ActiveSheet.PageSetup.PrintArea = ""
    Application.PrintCommunication = False
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "FORM 1589e-14"
        .CenterFooter = "No Technical Data"
        .RightFooter = "&P of  &N"
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.5)
        .HeaderMargin = Application.InchesToPoints(0.99)
        .FooterMargin = Application.InchesToPoints(0.3)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperLetter
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.Text = ""
        .EvenPage.CenterHeader.Text = ""
        .EvenPage.RightHeader.Text = ""
        .EvenPage.LeftFooter.Text = "FORM 1589e-14"
        .EvenPage.CenterFooter.Text = "No Technical Data"
        .EvenPage.RightFooter.Text = "&P of  &N"
        .FirstPage.LeftHeader.Text = ""
        .FirstPage.CenterHeader.Text = ""
        .FirstPage.RightHeader.Text = ""
        .FirstPage.LeftFooter.Text = "FORM 1589e-14"
        .FirstPage.CenterFooter.Text = "No Technical Data"
        .FirstPage.RightFooter.Text = "&P of  &N"
    End With
    Application.PrintCommunication = True
End Sub
Attribute VB_Name = "SOC_Items"
'CREATED BY: KYLE AGUILERA
'MOTIFIED BY: KYLE AGUILERA
'LAST UPDATED: 5/18/2016

Public Const PASSWORD1 As String = "forms dept16"
Public Const FileName As String = "1589e-14"

 
 
Private Sub AddNewItem()
    On Error Resume Next

    AddItem.Show 0
    
End Sub

Private Sub ShowExport()
    On Error Resume Next
    
    ExportSelection.Show
    
End Sub

Private Sub NewInstance()

    '- NEW INSTANCE OF EXCEL!
    Dim oXL As Excel.Application
    Dim FileName As String
    
    If Workbooks.Count > 1 Then
        ActiveWorkbook.Save

        Set oXL = CreateObject("Excel.Application")
        oXL.Visible = True
        FileName = ActiveWorkbook.FullName
        ActiveWorkbook.Close False
        oXL.Workbooks.Open FileName
        AppActivate oXL.Caption
        
'        Set oXL = CreateObject("Excel.Application")
'        oXL.Visible = True
'        FileName = ThisWorkbook.FullName
'        ThisWorkbook.Close False
'        oXL.Workbooks.Open FileName
'        AppActivate oXL.Caption
    Else
        MsgBox "Form is already in separate window.", vbInformation, "Complete"
    End If

End Sub

'Private Sub FileChangeAccess()
'    On Error Resume Next
'
'    If ActiveWorkbook.ReadOnly = True Then
'        ActiveWorkbook.ChangeFileAccess Mode:=xlReadWrite, Notify:=True
'        ActiveWorkbook.Save
'    End If
'
'End Sub
Attribute VB_Name = "SampleView"
Private Sub ShowSample()
Attribute ShowSample.VB_ProcData.VB_Invoke_Func = " \n14"
    On Error Resume Next

'----------------------------------------------------------------------------------------
'UNPROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1
'----------------------------------------------------------------------------------------
'UNPROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Unprotect PASSWORD:=PASSWORD1

    If ActiveWindow.View = xlNormalView Then ViewType = "Normal" Else ViewType = "Page"
    
    Sheet2.Visible = xlSheetVisible
    Sheet2.Activate
    
    If ViewType = "Normal" Then
        ActiveWindow.View = xlNormalView

        If ActiveWindow.FreezePanes = False Then
            ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1
            ActiveSheet.Unprotect PASSWORD:=PASSWORD1

            ActiveWindow.ScrollRow = 1
            ActiveWindow.FreezePanes = False
            Range("A9").Select
            ActiveWindow.FreezePanes = True
        End If
    Else
        ActiveWindow.View = xlPageLayoutView
    End If
'----------------------------------------------------------------------------------------
'PROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
    AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
'----------------------------------------------------------------------------------------
'PROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Protect PASSWORD:=PASSWORD1, Structure:=True, Windows:=False
    
End Sub
Private Sub HideSample()
    On Error Resume Next

'----------------------------------------------------------------------------------------
'UNPROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1

    Sheet2.Visible = xlSheetVeryHidden
    
'----------------------------------------------------------------------------------------
'PROTECTS SHEET
'----------------------------------------------------------------------------------------
    ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
    AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
'----------------------------------------------------------------------------------------
'PROTECTS WORKBOOK
'----------------------------------------------------------------------------------------
    ActiveWorkbook.Protect PASSWORD:=PASSWORD1, Structure:=True, Windows:=False
    
End Sub
Attribute VB_Name = "Sheet0"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public CurrentValue As String
Public CurrentValue2 As String

Private Sub Worksheet_Activate()
    On Error Resume Next

    Application.CellDragAndDrop = False
    Application.Run "HideSample"
    
End Sub

Private Sub Worksheet_Deactivate()
    
    Application.CellDragAndDrop = True
    
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    On Error Resume Next

    If Application.CellDragAndDrop <> False Then Application.CellDragAndDrop = False

    If ActiveWindow.View = xlNormalView Then
        If ActiveWindow.FreezePanes = False Then
            Application.Calculation = xlCalculationManual
            Application.ScreenUpdating = False
            Application.EnableEvents = False

            ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1
            ActiveSheet.Unprotect PASSWORD:=PASSWORD1

            ActiveWindow.ScrollRow = 1
            ActiveWindow.FreezePanes = False
            Range("A9").Select
            ActiveWindow.FreezePanes = True

            ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
            AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False

            ActiveWorkbook.Protect PASSWORD:=PASSWORD1, Structure:=True, Windows:=False

            Application.Calculation = xlCalculationAutomatic
            Application.ScreenUpdating = True
            Application.EnableEvents = True
        End If
    End If

    '------------------------------------------------------------------------------
    'FOR SOC MAIN BODY FORMATING FOR FONT SIZE
    '------------------------------------------------------------------------------
    iStart = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0) + 1
    iEnd = Range("D" & Rows.Count).End(xlUp).Row
    If Not Application.Intersect(Target, Range("$F$" & iStart & ":$L$" & iEnd)) Is Nothing Then
        Application.Calculation = xlCalculationManual
        Application.ScreenUpdating = False
        Application.EnableEvents = False

        'SendKeys "{F2}" 'TOGGLES NUMLOCK

        For i = iStart To iEnd
            '----------------------------------------------------------------------------------------
            'DETERMINE HEIGHT OF CELL
            '----------------------------------------------------------------------------------------
            NewSize = Range("F" & i).Font.Size

            If Range("AA" & i).Font.Size <> NewSize Then
                '----------------------------------------------------------------------------------------
                'UNPROTECTS Sheet
                '----------------------------------------------------------------------------------------
                ActiveSheet.Unprotect PASSWORD:=PASSWORD1

                Range("AA" & i).Font.Size = NewSize
                Range("AA" & i).Cells(1).EntireRow.AutoFit

                '----------------------------------------------------------------------------------------
                'PROTECTS Sheet
                '----------------------------------------------------------------------------------------
                ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
                AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
            End If
        Next i

        CurrentValue = Sheet1.Range("F" & Target.Row)
        CurrentValue2 = Sheet1.Range("E" & Target.Row)
        
        If Sheet1.PageSetup.Zoom <> 70 Then Application.Run "EditView"
    
        Application.Calculation = xlCalculationAutomatic
        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If


End Sub
Private Sub Worksheet_Change(ByVal Target As Range)

    On Error Resume Next
    
    iStart = 21
    iMid = Application.WorksheetFunction.Match("14. ITEM", Range("A:A"), 0) + 1
    iEnd = Range("D" & Rows.Count).End(xlUp).Row
    
    '------------------------------------------------------------------------------
    'FOR SOC HEADER FORMATING
    '------------------------------------------------------------------------------
    If Not Application.Intersect(Target, Range("$A$" & 10 & ":$L$" & 12)) Is Nothing Then
        If IsNumeric(Mid(Target.Address, 2, 1)) = False Then
            Application.Calculation = xlCalculationManual
            Application.ScreenUpdating = False
            Application.EnableEvents = False

            '----------------------------------------------------------------------------------------
            'UNPROTECTS SHEET
            '----------------------------------------------------------------------------------------
            ActiveSheet.Unprotect PASSWORD:=PASSWORD1

            '----------------------------------------------------------------------------------------
            'DETERMINE HEIGHT OF CELL
            '----------------------------------------------------------------------------------------
            Columns("AB:AB").WrapText = True 'BOX 6 WORD WRAP - CONTACT NAME
            Columns("AC:AC").WrapText = True 'BOX 6 WORD WRAP - PHONE NUMBER
            Columns("AD:AD").WrapText = True 'BOX 7 WORD WRAP - EMAIL
            Columns("AE:AE").WrapText = True 'BOX 8 WORD WRAP - SUPPLIER REJECTION
            Columns("AF:AF").WrapText = True 'BOX 9 WORD WRAP - BUYER NAME
            Columns("AG:AG").WrapText = True 'BOX 10 WORD WRAP - PO NUMBER
            Columns("AH:AH").WrapText = True 'BOX 11 WORD WRAP - PO ITEM
            '----------------------------------------------------------------------------------------
            'PROTECTS SHEET
            '----------------------------------------------------------------------------------------
            ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
            AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False

            Application.Calculation = xlCalculationAutomatic
            Application.ScreenUpdating = True
            Application.EnableEvents = True

        End If
    End If
    '------------------------------------------------------------------------------
    'FOR DESCRIPTION ON PARTS AFFECTED FORMATING
    '------------------------------------------------------------------------------
    If Not Application.Intersect(Target, Range("$E$" & iStart & ":$G$" & iMid - 1)) Is Nothing Then
        If IsNumeric(Mid(Target.Address, 2, 1)) = False Then
            '----------------------------------------------------------------------------------------
            'DETERMINE HEIGHT OF CELL
            '----------------------------------------------------------------------------------------
            If CurrentValue2 <> Range("E" & Target.Row).Value Then

                Application.Calculation = xlCalculationManual
                Application.ScreenUpdating = False
                Application.EnableEvents = False

                '----------------------------------------------------------------------------------------
                'UNPROTECTS SHEET
                '----------------------------------------------------------------------------------------
                ActiveSheet.Unprotect PASSWORD:=PASSWORD1
                
                Range("AC" & Target.Row).Value = "=E" & Target.Row
                Range("AC" & Target.Row).Cells(1).EntireRow.AutoFit
                '----------------------------------------------------------------------------------------
                'PROTECTS SHEET
                '----------------------------------------------------------------------------------------
                ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
                AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False

                Application.Calculation = xlCalculationAutomatic
                Application.ScreenUpdating = True
                Application.EnableEvents = True
            ElseIf Range("E" & Target.Row).Value = vbNullString Then
                Application.Calculation = xlCalculationManual
                Application.ScreenUpdating = False
                Application.EnableEvents = False
                
                Range("AC" & Target.Row).Cells(1).EntireRow.AutoFit
                
                Application.Calculation = xlCalculationAutomatic
                Application.ScreenUpdating = True
                Application.EnableEvents = True
            End If
        End If
    End If
    
    '------------------------------------------------------------------------------
    'FOR SOC MAIN BODY FORMATING
    '------------------------------------------------------------------------------
    If Not Application.Intersect(Target, Range("$F$" & iMid & ":$L$" & iEnd)) Is Nothing Then
        If IsNumeric(Mid(Target.Address, 2, 1)) = False Then
            '----------------------------------------------------------------------------------------
            'DETERMINE HEIGHT OF CELL
            '----------------------------------------------------------------------------------------
            If CurrentValue <> Range("F" & Target.Row).Value Then

                Application.Calculation = xlCalculationManual
                Application.ScreenUpdating = False
                Application.EnableEvents = False

                '----------------------------------------------------------------------------------------
                'UNPROTECTS SHEET
                '----------------------------------------------------------------------------------------
                ActiveSheet.Unprotect PASSWORD:=PASSWORD1

                If Len(Target.Value) = 0 Then
                    Range("F" & Target.Row).Value = Range("F" & Target.Row).Value
                ElseIf Right(Target.Value, 1) = Chr(10) Then
                    Range("F" & Target.Row).Value = Range("F" & Target.Row).Value
                Else
                    Range("F" & Target.Row).Value = Range("F" & Target.Row).Value & Chr(10)
                End If
                Range("AA" & Target.Row).Value = "=F" & Target.Row
                Range("AA" & Target.Row).Cells(1).EntireRow.AutoFit
                '----------------------------------------------------------------------------------------
                'PROTECTS SHEET
                '----------------------------------------------------------------------------------------
                ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
                AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False

                Application.Calculation = xlCalculationAutomatic
                Application.ScreenUpdating = True
                Application.EnableEvents = True

            End If
        End If
    End If
End Sub



Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit
Dim DragAndDrop As Boolean 'Flag for returning the setting to the way it was


Private Sub Workbook_NewSheet(ByVal Sh As Object)

    Application.CellDragAndDrop = True
    'Sh.Move
    
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    On Error Resume Next
    
    If Sheet1.Name <> FileName Then Sheet1.Name = FileName
    Dim Ans As String
    
''    'ITC EXPORT CLASSIFIFCATION CHECK
''    If Sheet1.Range("D3").Value <> vbNullString And Sheet1.PageSetup.CenterFooter = "No Technical Data" Then
''        Ans = MsgBox("No Technical Data was indicated. Are you sure this is the proper classification?", vbYesNo, "Export Classification")
''        If Ans = 6 Then ' YES
''            'DO NOTHING
''        Else
''            Cancel = True
''            Application.Run "ShowExport"
''        End If
''
''''        MsgBox "Please provide the proper ITC Export Classification.", vbCritical, "Export Classification Required"
''''        Cancel = True
''''        Application.Run "ShowExport"
''    End If
    
    ActiveWorkbook.Save
        
End Sub


 Private Sub Workbook_Open()
    On Error Resume Next
    
'    If Workbooks.Count = 1 Then
'        Application.OnTime Now() + TimeValue("00:00:05"), "FileChangeAccess"
'    End If

    DragAndDrop = Application.CellDragAndDrop
    If ActiveSheet.Name = FileName Then Application.CellDragAndDrop = False Else Application.CellDragAndDrop = True

    If ActiveSheet.Name = "Sample" Then Application.Run "HideSample"

    If ActiveWindow.View = xlNormalView Then
        If ActiveWindow.FreezePanes = False Then
            ActiveWorkbook.Unprotect PASSWORD:=PASSWORD1
            ActiveSheet.Unprotect PASSWORD:=PASSWORD1
    
            ActiveWindow.ScrollRow = 1
            ActiveWindow.FreezePanes = False
            Range("A9").Select
            ActiveWindow.FreezePanes = True
    
            ActiveSheet.Protect PASSWORD:=PASSWORD1, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
            AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=False
            
            ActiveWorkbook.Protect PASSWORD:=PASSWORD1, Structure:=True, Windows:=False
        End If
    End If

    ActiveWindow.View = xlPageLayoutView
    Sheet1.Range("C6").Select

    If Sheet1.PageSetup.Zoom <> 70 Then Application.Run "EditView"
    
 End Sub
 
Private Sub Workbook_BeforePrint(Cancel As Boolean)
 
    Application.Run "PrintingView"
 
End Sub


 Private Sub Workbook_BeforeClose(Cancel As Boolean)
    On Error Resume Next

    Dim Ans As String
    
    'ITC EXPORT CLASSIFIFCATION CHECK
    If Sheet1.Range("D3").Value <> vbNullString And Sheet1.PageSetup.CenterFooter = "No Technical Data" Then
        Ans = MsgBox("No Technical Data was indicated. Are you sure this is the proper classification?", vbYesNo, "Export Classification")
        If Ans = 6 Then ' YES
            'DO NOTHING
        Else
            Cancel = True
            Application.Run "ShowExport"
        End If
        
''        MsgBox "Please provide the proper ITC Export Classification.", vbCritical, "Export Classification Required"
''        Cancel = True
''        Application.Run "ShowExport"

    End If
    
    If Application.CellDragAndDrop <> True Then Application.CellDragAndDrop = True

 End Sub


INQUEST-PP=macro
