Attribute VB_Name = "Module1"

Public varia As Boolean
Public nline As Integer

Sub mainsub()
On Error GoTo errescp
If Worksheets("pn").Range("B53") = True Then
UserForm1.CommandButton6.Visible = False
UserForm1a.CommandButton6.Visible = False
varia = True
Else
UserForm1.CommandButton6.Visible = True
UserForm1a.CommandButton6.Visible = True
varia = False
End If
Worksheets("pn").Range("I46") = ThisWorkbook.name
Dim wkbk As Workbook
For Each wkbk In Workbooks
If ((Mid(wkbk.name, 1, 3) = "RT_") Or (Mid(wkbk.name, 1, 3) = "rtm")) Then
wkbk.Close
Else
End If
Next
Dim ext As String
Dim ext1 As String
Dim nameth As String
varia = Worksheets("pn").Range("B53")
Dim I As Integer
Dim text As String
Dim val As String
Dim destfin As String
Dim K As Integer
Worksheets("importdale").Range("A2") = Empty
Worksheets("importbcc").Range("A2") = Empty
 Worksheets("pn").Range("I45") = ThisWorkbook.name
 Worksheets("pn").Range("I48") = ThisWorkbook.FullName
 Worksheets("pn").Range("I51") = ThisWorkbook.Path
 ext = Worksheets("pn").Range("I50")
 ext1 = Worksheets("pn").Range("I46")
If Worksheets("pn").Range("I47") = False Then
Call MsgBox("for good functionality ,Excel is going to restore  " & vbCrLf & _
"this file under the original name and will then close. " & vbCrLf & _
"After this operation, please re-open Excel and my_VISHAY_NTC_curve ")
Application.DisplayAlerts = False
ext = ext & ext1
ThisWorkbook.SaveAs (ext)
nameth = Worksheets("pn").Range("I48")
On Error Resume Next
Kill (nameth)
On Error GoTo 0
Application.Quit
Else
If (ThisWorkbook.name = "my_vishay_NTC_curvev6_2.xls") Or (ThisWorkbook.name = "my_vishay_NTC_curvev6_2.xlsm") Then
UserForm1a.Label6.ForeColor = &H8000000B
Else
End If
On Error Resume Next
Worksheets("sheet2").Visible = True
Worksheets("sheet2").Select
Worksheets("sheet1").Visible = xlVeryHidden
Application.WindowState = xlMaximized
ActiveWindow.WindowState = xlMaximized
Worksheets("pn").Range("D8") = False
UserForm1a.TextBox1.Locked = False
UserForm1a.TextBox1.text = Worksheets("pn").Range("C42")
UserForm1a.TextBox1.Locked = True
Worksheets("pn").Range("c2") = ""
Worksheets("pn").Range("d2") = ""
Worksheets("pn").Range("e2") = ""
Worksheets("pn").Range("f2") = ""
Worksheets("pn").Range("g2") = ""
Worksheets("pn").Range("h2") = ""
Worksheets("pn").Range("i2") = ""
Worksheets("pn").Range("j2") = ""
Worksheets("pn").Range("k2") = ""
Worksheets("pn").Range("l2") = ""
Worksheets("pn").Range("m2") = ""
Worksheets("pn").Range("n2") = ""
Worksheets("pn").Range("o2") = ""
Worksheets("pn").Range("p2") = ""
Worksheets("pn").Range("q2") = ""
Worksheets("pn").Range("a32") = ""
Worksheets("pn").Range("b32") = ""
Worksheets("pn").Range("c32") = ""
Worksheets("pn").Range("d32") = ""
Worksheets("pn").Range("e32") = ""
Worksheets("pn").Range("f32") = ""
Worksheets("pn").Range("g32") = ""
Worksheets("pn").Range("h32") = ""
Worksheets("pn").Range("i32") = ""
Worksheets("pn").Range("j32") = ""
Worksheets("pn").Range("k32") = ""
Worksheets("pn").Range("l32") = ""
Worksheets("pn").Range("m32") = ""
Worksheets("pn").Range("n32") = ""
Worksheets("pn").Range("o32") = ""
Worksheets("pn").Range("p32") = ""
Worksheets("pn").Range("q32") = ""
Worksheets("pn").Range("r32") = ""
Worksheets("pn").Range("L46") = ""
Worksheets("pn").Range("B56") = True
Application.ScreenUpdating = False
'Application.ScreenUpdating = True
If Worksheets("pn").Range("A53") = False Then
UserForm7.Show
Else
End If
If Worksheets("pn").Range("C42") = False Then
UserForm1.Show
Else
If (Worksheets("pn").Range("V2") = True) Or (Worksheets("pn").Range("V2") = "init") Then
Call updat
Else
End If
UserForm1a.Show
End If
Do While Worksheets("pn").Range("B56") = True
Unload UserForm2
Unload UserForm3
Unload UserForm4
Unload UserForm5
Unload UserForm6
If Worksheets("pn").Range("B4") = "NTC999999999999999" Then
Exit Sub
Else
End If
UserForm10.Hide
UserForm2.Show
If Worksheets("pn").Range("B56") = False Then
Exit Do
Else
End If
If Worksheets("pn").Range("B1") = True Then
UserForm5.Show
Else
If Worksheets("pn").Range("B30") = True Then
UserForm6.Show
Else
Call MsgBox("no P/N has been defined")
End If
End If
Application.DisplayAlerts = False
'If Worksheets("pn").Range("B4") = "NTC999999999999999" Then
'Else
'End If
If Worksheets("pn").Range("B1") = True Then
For Each cellule In Worksheets("data sheet").Range("B31:I2000")
If (IsNumeric(cellule.Value) = False) And cellule.Value <> "" Then
val = cellule.Value
text = "A value of the R/T could not be computed " & val & ""
Call MsgBox(text)
Exit For
Else
End If
Next
Else
If Worksheets("pn").Range("B30") = True Then
For Each cellule In Worksheets("RT_curve2").Range("B36:I812")
If (IsNumeric(cellule.Value) = False) And cellule.Value <> "" Then
val = cellule.Value
text = "A value of the R/T could not be computed " & val & ""
Call MsgBox(text)
Exit For
Else
End If
Next
Else
End If
End If
Call AddNew
If varia = True Then
destfin = Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("I42")
Else
destfin = Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("I42")
End If
Call MsgBox("The R/T curve of your P/N has been saved at the extension:" & vbCrLf & _
"" & destfin & "")
If varia = True Then
For K = 1 To 1000
If Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("A61:C1060").Cells(K, 1) = "" Then
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("A61:C1060").Cells(K, 1) = Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("F42")
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("A61:C1060").Cells(K, 3) = Date
Exit For
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("A61:C1060").Select
Selection.Select
   Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Else
End If
Next K
Else
For K = 1 To 1000
If Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("A61:C1060").Cells(K, 1) = "" Then
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("A61:C1060").Cells(K, 1) = Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("F42")
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("A61:C1060").Cells(K, 3) = Date
Exit For
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("A61:C1060").Select
Selection.Select
   Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Else
End If
Next K
End If
Loop
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
Application.DisplayAlerts = True
End If
UserForm8.Show
Call terminate
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = False
Worksheets("sheet1").Select
Call savv
Call closs
Exit Sub
errescp:
Message = "Error No= " & Err.Number & vbCr
Message = Message & Err.Description & vbCr & vbCr
MsgBox (Message & "A Fatal error has occured" & vbCrLf & _
"The program must close.")
Call closs
End Sub



Public Function FileFolderExists(strFullPath As String) As Boolean
'Author       : Ken Puls (www.excelguru.ca)
'Macro Purpose: Check if a file or folder exists


    If Not Dir(strFullPath, vbDirectory) = vbNullString Then FileFolderExists = True
    


End Function


Function FileExists(FullFileName As String) As Boolean
' returns TRUE if the file exists
FileExists = Len(Dir(FullFileName)) > 0
End Function

Private Sub updat()
Application.DisplayAlerts = False
Dim antwoord As Byte
Dim sauvnam As String
Dim nom As String
Dim nom1 As String
Dim I As Integer
Dim Wk As Workbook
Dim wkb As Workbook
Dim ORng As Range
On Error Resume Next
'application.DisplayAlerts = False
Set wkb = ThisWorkbook
wkb.Worksheets("pn").Visible = True
wkb.Worksheets("pn").Activate
sauvnam = wkb.Worksheets("pn").Range("I51")
'MsgBox (sauvnam)
Set fich = Workbooks.Open("http://www.vishay.com/docs/29130/_my_vishay_ntc_curve.zip")
If fich Is Nothing Then
Set fich = Workbooks.Open("http://www.vishay.com/docs/29130/my_vishay_ntc_curve.zip")
wkb Activate
Worksheets("pn").Select
wkb.Worksheets("pn").Range("I52").Select
Selection.Copy
wkb.Worksheets("pn").Range("I55").Select
ActiveSheet.Paste
Else
'MsgBox ("yupi")
wkb.Activate
Worksheets("pn").Select
wkb.Worksheets("pn").Range("I54").Select
Selection.Copy
wkb.Worksheets("pn").Range("I55").Select
ActiveSheet.Paste
End If
On Error GoTo treatErr
fich.Activate
Set ORng = fich.Worksheets(1).Cells.Find("my_VISHAY_NTC_curvev")
ORng.Select
Selection.Copy
Range("AB1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Range("AA1").Value = "my_VISHAY_NTC_curvev"
Range("AD1") = "=+find( AA1, AB1)"
Range("AE1") = "=+NAJ|fffd|T( AA1, AB1)"
Range("AF1") = "=+Finden( AA1, AB1)"
Range("AG1") = "=+Encontrar( AA1, AB1)"
Range("AH1") = "=+ETSI( AA1, AB1)"
Range("AI1") = "=+Trouve( AA1, AB1)"
Range("AJ1") = "=+sz|fffd|veg.talal( AA1, AB1)"
Range("AK1") = "=+trova( AA1, AB1)"
Range("AL1") = "=+finn( AA1, AB1)"
Range("AM1") = "=+vind( AA1, AB1)"
Range("AN1") = "=+znajdz( AA1, AB1)"
Range("AO1") = "=+localizar( AA1, AB1)"
Range("AN1") = "=+hitta( AA1, AB1)"
Range("AO1") = "=+bul( AA1, AB1)"
If IsNumeric(Range("AD1")) = True Then funct = "=+find( AA1, AB1)"
If IsNumeric(Range("AE1")) = True Then funct = "=+NAJ|fffd|T( AA1, AB1)"
If IsNumeric(Range("AF1")) = True Then funct = "=+Finden( AA1, AB1)"
If IsNumeric(Range("AG1")) = True Then funct = "=+Encontrar( AA1, AB1)"
If IsNumeric(Range("AH1")) = True Then funct = "=+ETSI( AA1, AB1)"
If IsNumeric(Range("AI1")) = True Then funct = "=+Trouve( AA1, AB1)"
If IsNumeric(Range("AJ1")) = True Then funct = "=+sz|fffd|veg.talal( AA1, AB1)"
If IsNumeric(Range("AK1")) = True Then funct = "=+trova( AA1, AB1)"
If IsNumeric(Range("AL1")) = True Then funct = "=+finn( AA1, AB1)"
If IsNumeric(Range("AM1")) = True Then funct = "=+vind( AA1, AB1)"
If IsNumeric(Range("AN1")) = True Then funct = "=+znajdz( AA1, AB1)"
If IsNumeric(Range("AO1")) = True Then funct = "=+localizar( AA1, AB1)"
If IsNumeric(Range("AN1")) = True Then funct = "=+hitta( AA1, AB1)"
If IsNumeric(Range("AO1")) = True Then funct = "=+bul( AA1, AB1)"
Range("AC1") = funct
mult = Range("AC1").Value
If IsNumeric(mult) = False Then
Exit Sub
'MsgBox ("This function is not operational with this excel version")
fich.Close
Exit Sub
Else
End If
nom = Mid(Range("AB1"), Range("AC1"), 23)
fich.Close
wkb.Worksheets("pn").Range("L46") = nom
If wkb.Worksheets("pn").Range("T46") = "no info" Then
Exit Sub
'Call MsgBox("No Information could be obtained on update")
Else
If wkb.Worksheets("pn").Range("T46") = True Then

antwoord = MsgBox("A newer version ' " & nom & " ' is   " & vbCrLf & _
"available at 'http://www.vishay.com/docs/29130/'" & vbCrLf & _
"--------------------------------------------------" & vbCrLf & _
"Would you like to download it?", vbYesNo)
If antwoord = vbYes Then
Call MsgBox("After Download, please unzip and save it to your machine")
'fich.Close
'fich.Activate
'fich.Saved = True
'fich.Close
wkb.Activate
Worksheets("pn").Visible = True
Worksheets("pn").Activate
Range("I55").Select
On Error Resume Next

Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
'Range("I54").Select
'Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True


antwoord = MsgBox("Would you like to go ahead with the OLD version?" & vbCrLf & _
"----------------------------------------------------" & vbCrLf & _
"if  YES, this EXCEL session will continue with the present version" & vbCrLf & _
"" & vbCrLf & _
"if NO , this file will close. After that , please  restart the new " & vbCrLf & _
"" & nom & " that you just downloaded", vbYesNo)
If antwoord = vbNo Then
ThisWorkbook.Close
Else
Call MsgBox(" Don't forget next time to launch the new version of " & vbCrLf & _
"" & nom & "  in order to benefit of all updates")
End If
Else
Call MsgBox(" Please update soon to  " & nom & " : " & vbCrLf & _
"Updates usually add new part numbers " & vbCrLf & _
"The P/N's of your interest could be concerned")
End If
Else
nom1 = wkb.Worksheets("pn").Range("I46")
Exit Sub
'Call MsgBox("Your version of " & nom1 & " is up-to-date")
End If

End If
Exit Sub
treatErr:
Message = "Error No= " & Err.Number & vbCr
Message = Message & Err.Description & vbCr & vbCr

'On Error Resume Next
'Set fich = Workbooks(fich)
'If fich Is Nothing Then
'Exit Sub
'fich.Close
'End If
'If fich Is Nothing Then
'fich.Close
'Else
'End If
MsgBox (Message & "The website cannot be contacted by this program for eventual update" & vbCrLf & _
"If this message persists,  inactivate automatic  update at start " & vbCrLf & _
"For manual update, go to http://www.vishay.com/doc?29130")

'Call MsgBox("An error has occured : no information on possible " & vbCrLf & _
'"updating can be obtained at this moment. " & vbCrLf & _
'"Verify your internet connection or try another time")

End Sub



Attribute VB_Name = "Module2"
Sub unhider()
Attribute unhider.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'
Dim sh As Worksheet
For Each sh In Worksheets
sh.Visible = True
Next

'
 
End Sub



Function Rstandhinv(T As Double, A As Double, B As Double, C As Double)

Dim Y As Double
Dim X As Double

Y = (A - 1 / (273.15 + T)) / C

X = ((B / 3 / C) ^ 3 + Y ^ 2 / 4) ^ 0.5

Rstandhinv = Exp((X - Y / 2) ^ (1 / 3) - (X + Y / 2) ^ (1 / 3))


End Function


Sub savv()
Dim named As String
Dim vers As Integer
If Worksheets("pn").Range("B53") = True Then
vers = 52
Else
If Worksheets("pn").Range("B53") = False Then
vers = 56
Else
Call MsgBox("problem in save")
Exit Sub
End If
End If
named = Worksheets("pn").Range("C53")
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = False
Worksheets("sheet1").Select

ThisWorkbook.SaveAs named, FileFormat:=vers
End Sub

Sub closs()
Dim nam As String
Dim wkl As Workbook
For Each wkl In Workbooks()
wkl.Activate
nam = wkl.name
If (nam = "my_VISHAY_NTC_curvev6_2.xls") Then
wkl.Close
Else
End If
If (nam = "my_VISHAY_NTC_curvev6_2.xlsm") Then
wkl.Close
Else

End If
Next

End Sub
Attribute VB_Name = "Module3"
Sub display2()
Attribute display2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' display2 Macro
'

'
    Range("B6:I6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("B9:I9").Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = True
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
  
End Sub
Attribute VB_Name = "Module4"
Attribute VB_Name = "Module5"
Sub AddNew()

ufworking.Show vbModeless
DoEvents
Dim N As Double
N = 0
N = N + 1.8
Call ufwork(N)
DoEvents
On Error Resume Next
Application.ScreenUpdating = False
Dim nomfich As String
Dim nomfich2 As String
Dim s As Shape
Dim bOK As Boolean
N = N + 1.8
Call ufwork(N)
DoEvents
Dim Wk As Workbook
Dim D(10) As Double
Dim B(10) As Double
'Call MsgBox(varia)
N = N + 1.8
Call ufwork(N)
DoEvents
If varia = False Then
N = N + 1.8
Call ufwork(N)
DoEvents

If Worksheets("pn").Range("B1") = True Then
Worksheets("data sheet2").Activate
Range("A1:I2100").Select
Selection.Copy
Else
End If
N = N + 5
Call ufwork(N)
DoEvents
If Worksheets("pn").Range("B30") = True Then
Worksheets("RT_curve2").Activate
N = N + 1#
Call ufwork(N)

DoEvents
Range("A1:I2100").Select
N = N + 1#
Call ufwork(N)
DoEvents
Selection.Copy
N = N + 1#
Call ufwork(N)
DoEvents
Else
End If
nomfich = Worksheets("pn").Range("I42")
Set NewBook = Workbooks.Add
N = N + 1#
Call ufwork(N)
DoEvents

Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False

If Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("B1") = True Then
nline = Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("data sheet").Range("C6").Value
'MsgBox (nline)
Else
End If
If Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("B30") = True Then
nline = Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("RTdale").Range("A5").Value
'MsgBox (nline)
Else
End If


'MsgBox (nline)
Range("A" & nline & ":I2100").Select
Selection.Delete Shift:=xlUp
Application.DisplayAlerts = False
N = N + 1#
Call ufwork(N)
DoEvents
  
   Range("A17:I25").Select
    With Selection
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    
N = N + 1#
Call ufwork(N)
DoEvents
ActiveWorkbook.SaveAs FileName:="" & nomfich & "", FileFormat:=56
N = N + 10
    Columns("A:J").Select
    If Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("B1") = True Then
    Selection.ColumnWidth = 15
    Else
    Selection.ColumnWidth = 20
    End If
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Columns("J:J").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.EntireColumn.Hidden = True
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Activate
I = 0
If Worksheets("pn").Range("B1") = True Then
Application.DisplayAlerts = False
Do While I < 3
N = N + 1#
Call ufwork(N)
DoEvents
For Each s In Sheets("data sheet2").Shapes
  Workbooks("my_VISHAY_NTC_curvev6_2.xls").Activate
  If s.Type = msoPicture Then
N = N + 5
Call ufwork(N)

DoEvents
  I = I + 1
    s.Copy
    D(I) = s.Left
    B(I) = s.Top
    nomfich2 = Worksheets("pn").Range("I43")
    Set Wk = Workbooks(nomfich2 & ".xls")
    Wk.Activate
  N = N + 10
Call ufwork(N)
DoEvents
    Sheets("sheet1").Select
    Range("B2").Select
    ActiveSheet.Paste
  Else
N = N + 5
Call ufwork(N)
DoEvents
 
  End If
Next
Loop
Else
End If
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Activate
If Worksheets("pn").Range("B30") = True Then
Application.DisplayAlerts = False
For Each s In Sheets("RT_curve2").Shapes
  Workbooks("my_VISHAY_NTC_curvev6_2.xls").Activate
  If s.Type = msoPicture Then
'N = N + 3
Call ufwork(N)
DoEvents
  I = I + 1
    s.Copy
    D(I) = s.Left
  N = N + 1.8
Call ufwork(N)
DoEvents

    B(I) = s.Top + 64
'  N = N + 1.8
Call ufwork(N)
DoEvents

    nomfich2 = Worksheets("pn").Range("I43")
    Set Wk = Workbooks(nomfich2 & ".xls")
    Wk.Activate
N = N + 3
Call ufwork(N)
DoEvents

    Sheets("sheet1").Select
    Range("B2").Select
    ActiveSheet.Paste

   Columns("A:A").Select
    Selection.ColumnWidth = 5
  N = N + 3
Call ufwork(N)
DoEvents

    Columns("B:IV").Select
    Selection.ColumnWidth = 15
 ' N = N + 3
Call ufwork(N)
DoEvents

    Columns("J:J").Select
    Selection.ColumnWidth = 5
    Columns("K:K").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.EntireColumn.Hidden = True
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    Range("A7:J7").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("C5").Select
  Else
  End If
    Next
Else
End If

I = 0
Wk.Activate
For Each s In Sheets("sheet1").Shapes
N = N + 1.8
Call ufwork(N)
DoEvents
 Application.DisplayAlerts = False
 If s.Type = msoPicture Then
  I = I + 1
  s.Left = D(I) + 25
N = N + 2
Call ufwork(N)
DoEvents

  s.Top = B(I) + 30
  Else
 End If
 Next
 Wk.Activate
N = N + 2
Call ufwork(N)
DoEvents
 If Workbooks("my_VISHAY_NTC_curvev6_2.xls").Worksheets("pn").Range("B44") = True Then
N = N + 1.8
Call ufwork(N)
DoEvents

  Application.DisplayAlerts = False
    Range("1:3").Select
    Selection.Delete Shift:=xlUp
    Columns("A:A").Select
    Selection.ColumnWidth = 2
    Columns("B:B").Select
    Selection.ColumnWidth = 15
    Columns("I:XFD").Select
    Selection.EntireColumn.Hidden = False
    Columns("J:J").Select
    Selection.ColumnWidth = 2
    Columns("K:K").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.EntireColumn.Hidden = True
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 1
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0)
        .RightMargin = Application.InchesToPoints(0)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$26:$29"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0)
        .RightMargin = Application.InchesToPoints(0)
        .TopMargin = Application.InchesToPoints(0)
        .BottomMargin = Application.InchesToPoints(0)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
Else
    Range("13:13").Select
    Selection.Delete Shift:=xlUp
    Range("12:12").Select
    Selection.Delete Shift:=xlUp
    Range("11:11").Select
    Selection.Delete Shift:=xlUp
    Range("1:5").Select
    Selection.Delete Shift:=xlUp
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$29:$32"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 100
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$29:$32"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = 50
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    Range("A1").Select
End If
'Application.EnableEvents = False
Wk.Save
'Application.EnableEvents = True
Wk.Close

Else
N = N + 1.8
Call ufwork(N)
DoEvents
If Worksheets("pn").Range("B1") = True Then
Worksheets("data sheet2").Activate
nline = Worksheets("data sheet").Range("C6").Value
'MsgBox (nline)
Range("A1:I2100").Select
Selection.Copy
N = N + 1.8
Call ufwork(N)
DoEvents
Else
End If
If Worksheets("pn").Range("B30") = True Then
Worksheets("RT_curve2").Activate
nline = Worksheets("RTdale").Range("A5").Value
'MsgBox (nline)
Range("A1:I2100").Select
Selection.Copy
Else
End If
N = N + 1.8
Call ufwork(N)
DoEvents
nomfich = Worksheets("pn").Range("I42")
Set NewBook = Workbooks.Add
N = N + 5
Call ufwork(N)
DoEvents

Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
'MsgBox (nline)
Range("A" & nline & ":I2100").Select
Selection.Delete Shift:=xlUp
N = N + 2
Call ufwork(N)
DoEvents
Application.DisplayAlerts = False
   Range("A17:I25").Select
    With Selection
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
 N = N + 3
Call ufwork(N)
DoEvents
  
ActiveWorkbook.SaveAs FileName:="" & nomfich & "", FileFormat:=56
N = N + 10
Call ufwork(N)
DoEvents

    Columns("A:J").Select
    If Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("B1") = True Then
    Selection.ColumnWidth = 15
    Else
    Selection.ColumnWidth = 20
    End If
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Columns("J:J").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.EntireColumn.Hidden = True
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Activate
I = 0
N = N + 3
Call ufwork(N)
DoEvents
If Worksheets("pn").Range("B1") = True Then
Application.DisplayAlerts = False
Do While I < 3
N = N + 3
Call ufwork(N)
DoEvents
For Each s In Sheets("data sheet2").Shapes
  Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Activate
  If s.Type = msoPicture Then
 N = N + 3
  DoEvents
Call ufwork(N)
DoEvents
  I = I + 1
    s.Copy
    D(I) = s.Left
    B(I) = s.Top
    nomfich2 = Worksheets("pn").Range("I43")
    Set Wk = Workbooks(nomfich2 & ".xls")
    Wk.Activate
    Sheets("sheet1").Select
    Range("B2").Select
    ActiveSheet.Paste
  Else
  End If
Next
Loop
N = N + 3
Call ufwork(N)
DoEvents
Else
N = N + 3
Call ufwork(N)
DoEvents
End If
N = N + 3
Call ufwork(N)
DoEvents
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Activate
If Worksheets("pn").Range("B30") = True Then
Application.DisplayAlerts = False
For Each s In Sheets("RT_curve2").Shapes
N = N + 10

Call ufwork(N)
DoEvents
  Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Activate
  If s.Type = msoPicture Then
  I = I + 1
N = N + 3
Call ufwork(N)
DoEvents
    s.Copy
    D(I) = s.Left
    B(I) = s.Top + 64
    nomfich2 = Worksheets("pn").Range("I43")
    Set Wk = Workbooks(nomfich2 & ".xls")
    Wk.Activate

    Sheets("sheet1").Select
    Range("B2").Select
    ActiveSheet.Paste
N = N + 3
Call ufwork(N)
DoEvents

   Columns("A:A").Select
    Selection.ColumnWidth = 5
    Columns("B:IV").Select
    Selection.ColumnWidth = 15
    Columns("J:J").Select
    Selection.ColumnWidth = 5
    Columns("K:K").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.EntireColumn.Hidden = True
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    Range("A7:J7").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("C5").Select
  Else
  End If
    Next
Else
End If
N = N + 3
Call ufwork(N)
DoEvents
I = 0
Wk.Activate
For Each s In Sheets("sheet1").Shapes
 Application.DisplayAlerts = False
 If s.Type = msoPicture Then
N = N + 3
Call ufwork(N)
DoEvents
  I = I + 1
  s.Left = D(I) + 25
  s.Top = B(I) + 30
  Else
 N = N + 3
Call ufwork(N)
DoEvents

 End If
 Next
 Wk.Activate
 
 If Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Worksheets("pn").Range("B44") = True Then
N = N + 3
Call ufwork(N)
DoEvents
  Application.DisplayAlerts = False
    Range("1:3").Select
    Selection.Delete Shift:=xlUp
    Columns("A:A").Select
    Selection.ColumnWidth = 2
    Columns("B:B").Select
    Selection.ColumnWidth = 15
    Columns("I:XFD").Select
    Selection.EntireColumn.Hidden = False
    Columns("J:J").Select
    Selection.ColumnWidth = 2
    Columns("K:K").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.EntireColumn.Hidden = True
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 1
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0)
        .RightMargin = Application.InchesToPoints(0)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$26:$29"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0)
        .RightMargin = Application.InchesToPoints(0)
        .TopMargin = Application.InchesToPoints(0)
        .BottomMargin = Application.InchesToPoints(0)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
N = N + 1.8
Call ufwork(N)
DoEvents
    
Else

    Range("13:13").Select
    Selection.Delete Shift:=xlUp
    Range("12:12").Select
    Selection.Delete Shift:=xlUp
    Range("11:11").Select
    Selection.Delete Shift:=xlUp
    Range("1:5").Select
    Selection.Delete Shift:=xlUp
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$29:$32"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 100
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$29:$32"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = 50
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.text = ""
        .EvenPage.CenterHeader.text = ""
        .EvenPage.RightHeader.text = ""
        .EvenPage.LeftFooter.text = ""
        .EvenPage.CenterFooter.text = ""
        .EvenPage.RightFooter.text = ""
        .FirstPage.LeftHeader.text = ""
        .FirstPage.CenterHeader.text = ""
        .FirstPage.RightHeader.text = ""
        .FirstPage.LeftFooter.text = ""
        .FirstPage.CenterFooter.text = ""
        .FirstPage.RightFooter.text = ""
    End With
    Range("A1").Select
End If


'Application.EnableEvents = False
Wk.Save

'Application.EnableEvents = True
Wk.Close

End If

ufworking.Hide
End Sub


Sub ufwork(valeur As Double)

ufworking.adva.Width = 6 + valeur / 100 * 240

End Sub


Attribute VB_Name = "Module6"
Sub terminate()
Dim wkb As Workbook
Dim savegeard As String
Dim nam As String
Application.DisplayAlerts = False
Application.ScreenUpdating = False
'UserForm8.Hide
'Call MsgBox(varia)
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
'savegard = Worksheets("pn").Range("D42")
'savegard = savegard & "rtmvntcclist.xls"
savegeard = Worksheets("pn").Range("D42")
'Application.EnableEvents = False
If varia = False Then
UserForm10.Show vbModeless
DoEvents
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Save
UserForm10.Hide
Else
UserForm10.Show vbModeless
DoEvents
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Save
UserForm10.Hide
End If
'.EnableEvents = True
'Call MsgBox(varia)
If varia = False Then
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Activate
Else
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Activate
End If
Worksheets("pn").Visible = True
Worksheets("pn").Select
Range("A61:C1061").Select
Selection.Copy

savegeard = savegeard & "rtmvntcclist.xls"
If FileExists(savegeard) = True Then
Workbooks.Open FileName:=savegeard
'Windows(savegeard).Activate
Workbooks("rtmvntcclist.xls").Activate
'Worksheets(1).Select
Range("A61").Select
ActiveSheet.Paste
'ThisWorkbook.Close
Else
Set Wk = Workbooks.Add
Worksheets(1).Range("A61").Select
ActiveSheet.Paste
Wk.SaveAs FileName:=savegeard, FileFormat:=56
End If

'Wk.Close
Workbooks("rtmvntcclist.xls").Close

If varia = False Then
Workbooks("my_VISHAY_NTC_curvev6_2.xls").Close
Else
Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Close
End If



'
'    Windows("my_VISHAY_NTC_curvev6_2.xls").Activate
 '   Sheets("pn").Select
 '   Range("A61:C407").Select
 '   Selection.Copy
 '   Windows("rtmvntcclist.xls").Activate
 '   Range("A61").Select
 '   ActiveSheet.Paste
 '   Windows("my_VISHAY_NTC_curvev6_2.xls").Activate









End Sub
Attribute VB_Name = "Module7"
Private Sub hid()
Attribute hid.VB_ProcData.VB_Invoke_Func = " \n14"
'
' hid Macro
'

'
    Worksheets("sheet1").Visible = True
    Worksheets("sheet2").Visible = xlVeryHidden
    Worksheets("sheet2").Visible = xlVeryHidden
    Sheets("discl").Visible = xlVeryHidden
    Sheets("pn").Visible = xlVeryHidden
    Sheets("dbase ceramic types").Visible = xlVeryHidden
    Sheets("data sheet").Visible = xlVeryHidden
    Sheets("data sheet2").Visible = xlVeryHidden
    Sheets("dbase coomponents").Visible = xlVeryHidden
    Sheets("listPN").Visible = xlVeryHidden
    Sheets("RT_curve2").Visible = xlVeryHidden
    Sheets("RTdale").Visible = xlVeryHidden
    Sheets("ratiodale").Visible = xlVeryHidden
    Sheets("ratiosdale").Visible = xlVeryHidden
    Sheets("tpdale").Visible = xlVeryHidden
    Sheets("importbcc").Visible = xlVeryHidden
    Sheets("importdale").Visible = xlVeryHidden
    Sheets("info").Visible = xlVeryHidden
     
     
     
     
    
End Sub





Private Sub unhid()
'
' hid Macro
'

'
     Sheets("discl").Visible = True
    Sheets("pn").Visible = True
    Sheets("dbase ceramic types").Visible = True
    Sheets("data sheet").Visible = True
    Sheets("data sheet2").Visible = True
    Sheets("dbase coomponents").Visible = True
    Sheets("listPN").Visible = True
    Sheets("RT_curve2").Visible = True
    Sheets("RTdale").Visible = True
    Sheets("ratiodale").Visible = True
    Sheets("tpdale").Visible = True
    Sheets("sheet1").Visible = True
    Sheets("ratiosdale").Visible = True
    Sheets("importbcc").Visible = True
    Sheets("importdale").Visible = True
    Sheets("info").Visible = True
End Sub

Private Sub rejuvenate()
Worksheets("pn").Range("V2") = "init"
Worksheets("pn").Range("L46") = Empty
Worksheets("pn").Range("A61:C1061") = Empty
Worksheets("pn").Range("C42") = False
Worksheets("pn").Range("A53") = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
  Worksheets("sheet1").Visible = True
    Sheets("discl").Visible = xlVeryHidden
    Sheets("pn").Visible = xlVeryHidden
    Sheets("dbase ceramic types").Visible = xlVeryHidden
    Sheets("data sheet").Visible = xlVeryHidden
    Sheets("data sheet2").Visible = xlVeryHidden
    Sheets("dbase coomponents").Visible = xlVeryHidden
    Sheets("listPN").Visible = xlVeryHidden
    Sheets("RT_curve2").Visible = xlVeryHidden
    Sheets("RTdale").Visible = xlVeryHidden
    Sheets("ratiodale").Visible = xlVeryHidden
     Sheets("ratiosdale").Visible = xlVeryHidden
    Sheets("tpdale").Visible = xlVeryHidden
    Sheets("sheet5").Visible = xlVeryHidden
    Sheets("importdale").Visible = xlVeryHidden
    Sheets("importBcc").Visible = xlVeryHidden
    Sheets("info").Visible = xlVeryHidden
Worksheets("sheet1").Select
Worksheets("pn").Range("I46") = ThisWorkbook.name
If ThisWorkbook.name = "my_VISHAY_NTC_curvev6_2.xls" Then
Worksheets("pn").Range("B53") = False
Else
If ThisWorkbook.name = "my_VISHAY_NTC_curvev6_2.xlsm" Then
Worksheets("pn").Range("B53") = True
Else
Call MsgBox("probl|fffd|me de nom")
Exit Sub
End If
End If

End Sub


Private Sub hidall()
For Each Sheet In Worksheets
If Sheet.name = "Sheet1" Then
Sheet.Visible = True
Else
Sheet.Visible = xlVeryHidden
End If
Next

End Sub



Attribute VB_Name = "Module8"
Sub importerase()
Attribute importerase.VB_ProcData.VB_Invoke_Func = " \n14"
'
' importerase Macro
'

'
    Application.ScreenUpdating = False
    Worksheets("importdale").Visible = True
    Worksheets("importdale").Select
    Range("A2:AZ1000").Select
    Selection.ClearContents
    Worksheets("importdale").Visible = xlVeryHidden
     Worksheets("importbcc").Visible = True
    Worksheets("importbcc").Select
    Range("A2:AZ1000").Select
    Selection.ClearContents
    Worksheets("importbcc").Visible = xlVeryHidden






End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Sub workbook_open()
If Application.UserName = "astas" Or Application.UserName = "qlab" Or Application.UserName = "chavi" Then
answ = MsgBox("stop program?", vbYesNo)
If answ = vbYes Then Exit Sub
End If



'Worksheets("international").Visible = xlVeryHidden
'Worksheets("international").Range("A1") = "vrai"
'Worksheets("international").Range("B1") = "vrai"
'orksheets("international").Range("C1") = "=+find( A1, B1)"
'If IsNumeric(Worksheets("international").Range("C1")) = True Then
'UserForm1a.CommandButton4.Enabled = True
'UserForm1a.CommandButton4.Visible = True
'Else
'UserForm1a.CommandButton4.Enabled = False
'UserForm1a.CommandButton4.Visible = False
'End If
If (Worksheets("pn").Range("V2") = "init") Or (Worksheets("pn").Range("V2") = False) Then
UserForm1a.CheckBox1 = False
Else
UserForm1a.CheckBox1 = True
End If

Call mainsub

End Sub




Attribute VB_Name = "UserForm09a"
Attribute VB_Base = "0{824B5F65-CA5A-49E5-A04A-2F13677AC426}{6FA77A36-85FC-452D-A008-DC88EE47CEF4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub Label3_Click()

End Sub

Private Sub CommandButton1_Click()
UserForm09a.Hide
UserForm1a.Show
End Sub

Private Sub CommandButton2_Click()
Application.ScreenUpdating = False
Worksheets("info").Visible = True
Worksheets("info").Select
Worksheets("info").Range("c2").Select
 Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
Worksheets("info").Visible = xlVeryHidden

End Sub

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{26301153-8F2B-4142-93E1-B250769E0A41}{BCCDD7E1-6FE2-466B-85EB-6F572F30F046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
On Error Resume Next
UserForm1.Hide
If (Worksheets("pn").Range("I53") = False) Or (Worksheets("pn").Range("C42") = False) Or (Worksheets("pn").Range("C39") = False) Then
Call MsgBox(" click on browse and indicate a proper directory  for file saving" & vbCrLf & _
" the path length you indicated may be wrong or too long 100 char max ")
UserForm1.Show
Else
End If
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
'Workbooks("my_VISHAY_NTC_curvev6_2.xlsm").Save
UserForm10.Show vbModeless
DoEvents

ThisWorkbook.Save

End Sub



Private Sub CommandButton2_Click()
Application.ScreenUpdating = False
On Error GoTo errhandling
Dim fich As String
Dim savegard As String
Dim memo As String
memo = Worksheets("pn").Range("C42")
fich = Application.GetSaveAsFilename("RT_curve", , 1, "SELECT A DIRECTORY for R/T TABLE SAVING")
Worksheets("pn").Range("C42") = fich

If Worksheets("pn").Range("I53") = False Then
Call MsgBox("Sorry .. you have selected a file!!" & vbCrLf & _
"You need to select a directory!! " & vbCrLf & _
"When it's done,just click OPEN and then SAVE")
Worksheets("pn").Range("C42") = memo
Exit Sub
Else
End If
savegard = Worksheets("pn").Range("D42")
savegaard = savegard
savegard = savegard & "rtmvntcclist.xls"
Application.DisplayAlerts = False
If FileExists(savegard) = True Then
Workbooks.Open FileName:=savegard
Range("A61:C1061").Copy
ActiveWorkbook.Close
Worksheets("pn").Visible = True
Worksheets("pn").Select
Range("A61:C1061").Select
MsgBox ("The R/T curves computed with older versions have been recovered")
ActiveSheet.Paste
Worksheets("pn").Visible = xlVeryHidden
Else
Set Wk = Workbooks.Add
'Worksheets(1).Range("A61").Select
'ActiveSheet.Paste
'Application.EnableEvents = False
Wk.SaveAs FileName:=savegard, FileFormat:=56
'Application.EnableEvents = True
Dim Directory As String
Dim FileName As String
Dim IndexSheet As Worksheet
Dim rw As Long
'Change the directory below as needed
Directory = savegaard
If Left(Directory, 1) <> "\" Then
    Directory = Directory & "\"
End If
rw = 1
'Set IndexSheet = ThisWorkbook.ActiveSheet
FileName = Dir(Directory & "*.xls")
Do While FileName <> ""
'If FileName = "rtmvntcclist.xls" Or FileName = "RTcurve_NTC999999999999999.xls" Then
If ((Mid(FileName, 10, 3) = "NTC") Or (Mid(FileName, 10, 4) = "NTHS") Or (Mid(FileName, 10, 1) = "0") Or (Mid(FileName, 10, 1) = "1")) Then
Workbooks("rtmvntcclist.xls").Worksheets(1).Cells(rw + 60, 1).Value = Mid(FileName, 10, Len(FileName) - 13)
Workbooks("rtmvntcclist.xls").Worksheets(1).Cells(rw + 60, 3).Value = Date
rw = rw + 1
Else
End If
FileName = Dir
Loop
rw = rw - 1
Call MsgBox(rw & " R/T files have been recovered")
'Set IndexSheet = Nothing
'MsgBox ("No information relative to past versions was recovered")
Workbooks("rtmvntcclist.xls").Save
Workbooks("rtmvntcclist.xls").Activate
Worksheets(1).Select
Range("A61:C1061").Select
Selection.Copy
Workbooks("rtmvntcclist.xls").Close
Worksheets("pn").Visible = True
Worksheets("pn").Select
Range("A61:C1061").Select
ActiveSheet.Paste
Worksheets("pn").Visible = xlVeryHidden
End If
Exit Sub
errhandling:
Call MsgBox(" An unexpected error has just happened: " & vbCrLf & _
" the program will close now " & vbCrLf & _
" please restart the application ")
Call savv
ThisWorkbook.Close


 End Sub
Public Sub ListWorkbooks()
    Dim Directory As String
    Dim FileName As String
    Dim IndexSheet As Worksheet
    Dim rw As Long
    'Change the directory below as needed
    Directory = "C:\June\"
    If Left(Directory, 1) <> "\" Then
        Directory = Directory & "\"
    End If
    rw = 1
    Set IndexSheet = ThisWorkbook.ActiveSheet
    FileName = Dir(Directory & "*.xls")
    Do While FileName <> ""
        IndexSheet.Cells(rw, 1).Value = FileName
        rw = rw + 1
        FileName = Dir
    Loop
    
    Set IndexSheet = Nothing
 End Sub
  
Private Sub CommandButton3_Click()
On Error Resume Next
UserForm1.Hide
UserForm10.Show

Worksheets("pn").Range("B56") = True
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
Application.DisplayAlerts = False
'Application.EnableEvents = False
Worksheets("sheet1").Visible = True
Worksheets("sheet1").Select
Worksheets("sheet2").Visible = False
ThisWorkbook.Save
UserForm10.Hide
'Application.EnableEvents = True
ThisWorkbook.Close
End Sub

Private Sub CommandButton5_Click()
UserForm1.Hide
UserForm9.Show
End Sub

Sub CommandButton6_Click()

If val(Application.Version) > 11 Then
Dim fp As String
Dim pt As String
Dim fpo As String
Dim reponsh As Byte
reponsh = MsgBox("The file can be migrated to Excel 2007" & vbCrLf & _
"Would you like to perform this operation ? " & vbCrLf & _
"The file and its Excel session  will then close " & vbCrLf & _
"and will need to be restarted.", vbQuestion + vbYesNo)
'Call MsgBox(reponsh)
If reponsh = vbNo Then
Exit Sub
Else
fp = ThisWorkbook.FullName
pt = ThisWorkbook.Path
fn = ThisWorkbook.name
fpo = fp
fp = fp & "m"
UserForm1.CommandButton6.Visible = False
Worksheets("pn").Range("B53") = True
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
varia = True
Worksheets("pn").Range("I46") = fn
ThisWorkbook.SaveAs FileName:="" & fp & "", FileFormat:=52
Application.DisplayAlerts = False
On Error Resume Next
Workbooks(fpo).Close
Kill (fpo)
On Error GoTo 0
Application.DisplayAlerts = True
Call MsgBox("this file is now saved as an Excel 2007 .xlsm file" & vbCrLf & _
"Excel is going to close now.")
Application.DisplayAlerts = False
ThisWorkbook.Close
End If
Else
Call MsgBox("Your Excel version is older than  2007!" & vbCrLf & _
"This file may not be saved as an Excel .xlsm file")
Worksheets("pn").Range("B53") = False
End If
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub

Function FileExists(FullFileName As String) As Boolean
' returns TRUE if the file exists
FileExists = Len(Dir(FullFileName)) > 0
End Function



Private Sub Label7_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label6.Visible = False


End Sub

Private Sub Commandbutton2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label6.Visible = True

End Sub

Private Sub Label8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label6.Visible = False

End Sub


Private Sub Label9_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label6.Visible = False

End Sub

Private Sub Label6_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label6.Visible = False


End Sub
Attribute VB_Name = "UserForm10"
Attribute VB_Base = "0{5ED9E57E-CC93-4297-8F2D-CD8E96FC6870}{A2788613-E393-46C9-ADB1-D33304B26E32}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm1a"
Attribute VB_Base = "0{D4299842-21E1-4E8D-8B06-48BE911E0C58}{5479AAC9-246B-4DC5-B24F-E141CEECC549}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox1_Click()
If CheckBox1.Value = True Then
Worksheets("pn").Range("V2") = True
Else
Worksheets("pn").Range("V2") = False
End If
End Sub

Private Sub CommandButton1_Click()
UserForm1a.Hide
On Error Resume Next
Application.DisplayAlerts = False
If Worksheets("pn").Range("C42") = False Then
Call MsgBox("indicate a proper directory")
UserForm1a.Show
Else
End If
UserForm10.Show vbModeless
DoEvents
'Application.EnableEvents = False
ThisWorkbook.Save
'Application.EnableEvents = True
On Error GoTo 0
End Sub

Private Sub CommandButton2_Click()
Application.ScreenUpdating = False
On Error GoTo errhandling
Dim fich As String
Dim rtm As String
Dim fichcalc As String
Dim dirold As String
Dim dirnew As String
Dim fichnew As String
Dim finnew As String
Dim ncalc As Integer
Dim memo2 As String
memo2 = Worksheets("pn").Range("C42")

ncalc = Worksheets("pn").Range("A60")
Dim ntransf As Integer
ntransf = ncalc
If ncalc = 0 Then
Exit Sub
Else
dirold = Worksheets("pn").Range("E43")
fich = Application.GetSaveAsFilename("RT_curve", , 1, "save directory for R/T tables")
Worksheets("pn").Range("C42") = fich
If Worksheets("pn").Range("I53") = False Then
Call MsgBox("Sorry .. you have selected a file!!" & vbCrLf & _
"You need to select a directory !! " & vbCrLf & _
"When it's done,just click OPEN and then SAVE")
Worksheets("pn").Range("C42") = memo2
Exit Sub
Else
End If
dirnew = Worksheets("pn").Range("E43")
If fich = "False" Or (Worksheets("pn").Range("C39") = False) Then
UserForm1a.Hide
Call MsgBox("indicate another directory: the dir. path length  " & vbCrLf & _
" you indicated may be wrong or should be 100 char. max ")
UserForm1a.Show
Else
End If
Worksheets("pn").Range("C42") = fich
dirnew = Worksheets("pn").Range("E43")
'Call MsgBox("old dir" & dirold)
'Call MsgBox("new dir" & dirnew)
fichcalc = "start"
I = 0
For I = 1 To ncalc
 
 fichcalc = Worksheets("pn").Range("A61:A1000").Cells(I, 1)
 'Call MsgBox("fichcalc =" & fichcalc)

 'Call MsgBox(fichcalc)
 Fichold = dirold & fichcalc & ".xls"
 fichnew = dirnew & fichcalc & ".xls"
 'Call MsgBox("old " & fichold & "new " & fichnew)
 If Fichold = fichnew Then
 Exit Sub
 
 End If
 'Call MsgBox("old file =" & Fichold)
 'Call MsgBox("new file = " & fichnew)
 Dim leng As String
 leng = Len(Dir(Fichold))
 'Call MsgBox(leng)
 If Len(Dir(Fichold)) > 0 Then
 FileCopy Fichold, fichnew
' Call MsgBox("yes")
 'Call MsgBox(Fichold & "has been moved to " & fichnew)
 On Error Resume Next
 Kill Fichold
 On Error GoTo 0
 
 Else
' Call MsgBox(" the file named " & Fichold & " could not be found")
ntransf = ntransf - 1
 End If
Next
rtm = Worksheets("pn").Range("D42")
 rtm = rtm & "rtmvntcclist.xls"
 'Call MsgBox(rtm)
If FileExists(rtm) = True Then
On Error Resume Next
Kill rtm
On Error GoTo 0
Else
End If
I = I
UserForm1a.TextBox1.Locked = False
UserForm1a.TextBox1.text = Worksheets("pn").Range("C42")
UserForm1a.TextBox1.Locked = True
UserForm1a.TextBox1.text = Worksheets("pn").Range("C42")
Call MsgBox(ntransf & " files have been moved to new save directory." & vbCrLf & _
"From now on, the R/T files will be saved in the new directory. ")

Exit Sub
End If
errhandling:
Call MsgBox("An unexpected error occured during the transfer" & vbCrLf & _
"Exit the program and retry the operation. " & vbCrLf & _
"If error is repeated,this program might not be  " & vbCrLf & _
"able to open the old computed files. Open them manually " & vbCrLf & _
"Our apologies for this inconvenience")
End Sub

Private Sub CommandButton3_Click()
Worksheets("pn").Range("B56") = True
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
Application.DisplayAlerts = False
'Application.EnableEvents = False
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
End Sub

Private Sub CommandButton4_Click()
Application.DisplayAlerts = False
Dim antwoord As Byte
Dim sauvnam As String
Dim nom As String
Dim nom1 As String
Dim I As Integer
Dim Wk As Workbook
Dim ORng As Range

On Error GoTo treatErr
sauvnam = Worksheets("pn").Range("I51")
Set fich = Workbooks.Open("http://www.vishay.com/docs/29130/my_vishay_ntc_curve.zip")
Set ORng = fich.Worksheets(1).Cells.Find("my_VISHAY_NTC_curvev")
ORng.Select
Selection.Copy
Range("AB1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Range("AA1").Value = "my_VISHAY_NTC_curvev"
Range("AD1") = "=+find( AA1, AB1)"
Range("AE1") = "=+NAJ|fffd|T( AA1, AB1)"
Range("AF1") = "=+Finden( AA1, AB1)"
Range("AG1") = "=+Encontrar( AA1, AB1)"
Range("AH1") = "=+ETSI( AA1, AB1)"
Range("AI1") = "=+Trouve( AA1, AB1)"
Range("AJ1") = "=+sz|fffd|veg.talal( AA1, AB1)"
Range("AK1") = "=+trova( AA1, AB1)"
Range("AL1") = "=+finn( AA1, AB1)"
Range("AM1") = "=+vind( AA1, AB1)"
Range("AN1") = "=+znajdz( AA1, AB1)"
Range("AO1") = "=+localizar( AA1, AB1)"
Range("AN1") = "=+hitta( AA1, AB1)"
Range("AO1") = "=+bul( AA1, AB1)"
If IsNumeric(Range("AD1")) = True Then funct = "=+find( AA1, AB1)"
If IsNumeric(Range("AE1")) = True Then funct = "=+NAJ|fffd|T( AA1, AB1)"
If IsNumeric(Range("AF1")) = True Then funct = "=+Finden( AA1, AB1)"
If IsNumeric(Range("AG1")) = True Then funct = "=+Encontrar( AA1, AB1)"
If IsNumeric(Range("AH1")) = True Then funct = "=+ETSI( AA1, AB1)"
If IsNumeric(Range("AI1")) = True Then funct = "=+Trouve( AA1, AB1)"
If IsNumeric(Range("AJ1")) = True Then funct = "=+sz|fffd|veg.talal( AA1, AB1)"
If IsNumeric(Range("AK1")) = True Then funct = "=+trova( AA1, AB1)"
If IsNumeric(Range("AL1")) = True Then funct = "=+finn( AA1, AB1)"
If IsNumeric(Range("AM1")) = True Then funct = "=+vind( AA1, AB1)"
If IsNumeric(Range("AN1")) = True Then funct = "=+znajdz( AA1, AB1)"
If IsNumeric(Range("AO1")) = True Then funct = "=+localizar( AA1, AB1)"
If IsNumeric(Range("AN1")) = True Then funct = "=+hitta( AA1, AB1)"
If IsNumeric(Range("AO1")) = True Then funct = "=+bul( AA1, AB1)"
Range("AC1") = funct
mult = Range("AC1").Value
If IsNumeric(mult) = False Then
MsgBox ("This function is not operational with this excel version")
fich.Close
Exit Sub
Else
End If
nom = Mid(Range("AB1"), Range("AC1"), 23)
fich.Close
Worksheets("pn").Range("L46") = nom
If Worksheets("pn").Range("T46") = "no info" Then
Call MsgBox("No Information could be obtained on update")
Else
If Worksheets("pn").Range("T46") = True Then

antwoord = MsgBox("A newer version ' " & nom & " ' is   " & vbCrLf & _
"available at 'http://www.vishay.com/docs/29130/'" & vbCrLf & _
"--------------------------------------------------" & vbCrLf & _
"Would you like to download it?", vbYesNo)
If antwoord = vbYes Then
Call MsgBox("After Download, please unzip and save it to your machine")
Worksheets("pn").Visible = True
Worksheets("pn").Activate
Range("I52").Select
Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True


antwoord = MsgBox("Would you like to go ahead with the outdated version?" & vbCrLf & _
"----------------------------------------------------" & vbCrLf & _
"if you choose YES ,this EXCEL session will continue normally" & vbCrLf & _
"" & vbCrLf & _
"if you choose NO, this EXCEL session will close" & vbCrLf & _
"After closing, please re-open the updated version " & vbCrLf & _
"" & nom & " from the location where you saved it", vbYesNo)
If antwoord = vbNo Then
ThisWorkbook.Close
Application.Quit
Else
Call MsgBox(" Don't forget next time to launch the new version of " & vbCrLf & _
"" & nom & "  in order to benefit of all updates")
End If
Else
Call MsgBox(" Please update soon to  " & nom & " : " & vbCrLf & _
"Updates usually add new part numbers " & vbCrLf & _
"The P/N's of your interest could be concerned")
End If
Else
nom1 = Worksheets("pn").Range("I46")
Call MsgBox("Your version of " & nom1 & " is up-to-date")
End If

End If
Exit Sub
treatErr:
If fich Is Nothing Then
Else
fich.Close
End If
Call MsgBox("An error has occured : no information on possible " & vbCrLf & _
"updating can be obtained at this moment. " & vbCrLf & _
"Verify your internet connection or try another time")

End Sub






Private Sub CommandButton5_Click()
UserForm1a.Hide
UserForm09a.Show
End Sub

Private Sub CommandButton6_Click()
If val(Application.Version) > 11 Then
Dim fp As String
Dim pt As String
Dim fpo As String
Dim reponsh As Byte
reponsh = MsgBox("The file can be migrated to Excel 2007" & vbCrLf & _
" Would you like to perform this operation ? " & vbCrLf & _
" This file and its Excel session will then close " & vbCrLf & _
" and will need to be re-started.", vbYesNo)
If reponsh = vbNo Then
Exit Sub
Else
fp = ThisWorkbook.FullName
pt = ThisWorkbook.Path
fn = ThisWorkbook.name
'Call MsgBox(fp)
fpo = fp
fp = fp & "m"
'Call MsgBox(fp)
UserForm1.CommandButton6.Visible = False
Worksheets("pn").Range("B53") = True
'Call MsgBox(varia)
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
varia = True
Worksheets("pn").Range("I46") = fn
ThisWorkbook.SaveAs FileName:="" & fp & "", FileFormat:=52
On Error Resume Next
Application.DisplayAlerts = False
Workbooks(fpo).Close
Kill (fpo)
On Error GoTo 0
Application.DisplayAlerts = True
Call MsgBox("this file is now saved as an Excel 2007 .xlsm file" & vbCrLf & _
"Excel will close now.")
Application.DisplayAlerts = False

ThisWorkbook.Close


End If

Else
Call MsgBox("Your Excel version is older than Excel 2007")
Worksheets("pn").Range("B53") = False
End If
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select

End Sub

Private Sub Label10_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label7.Visible = False


End Sub



Private Sub Label11_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label7.Visible = False


End Sub

Private Sub Label7_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label7.Visible = False


End Sub

Private Sub Commandbutton2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label7.Visible = True

End Sub

Private Sub label8_MouseOut(ByVal Button As Long, ByVal Shift As Long, ByVal Target As Range)


Label7.Visible = False

End Sub


Private Sub Label9_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label7.Visible = False

End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub

Function FileExists(FullFileName As String) As Boolean
' returns TRUE if the file exists
FileExists = Len(Dir(FullFileName)) > 0
End Function

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{81FB3CA0-BB5D-4AE2-9A4A-078437823445}{94B856DB-7F25-4F68-93B4-A8E72A516FC9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Dim newtry As Byte
Dim senmail As Byte
Dim PARTNUM As String
Dim MINTEMP As String
Dim maxtemp As String
Dim steptemp As String
Dim OutApp As Object
Dim OutMail As Object
Dim strbody As String
Dim appnom As String
Worksheets("pn").Range("c2") = UserForm2.TextBox4.Value
Worksheets("pn").Range("d2") = UserForm2.TextBox5.Value
Worksheets("pn").Range("e2") = UserForm2.TextBox6.Value
Worksheets("pn").Range("f2") = UserForm2.TextBox7.Value
Worksheets("pn").Range("g2") = UserForm2.TextBox8.Value
Worksheets("pn").Range("h2") = UserForm2.TextBox9.Value
Worksheets("pn").Range("i2") = UserForm2.TextBox10.Value
Worksheets("pn").Range("j2") = UserForm2.TextBox11.Value
Worksheets("pn").Range("k2") = UserForm2.TextBox12.Value
Worksheets("pn").Range("l2") = UserForm2.TextBox13.Value
Worksheets("pn").Range("m2") = UserForm2.TextBox14.Value
Worksheets("pn").Range("n2") = UserForm2.TextBox15.Value
Worksheets("pn").Range("o2") = UserForm2.TextBox16.Value
Worksheets("pn").Range("p2") = UserForm2.TextBox17.Value
Worksheets("pn").Range("q2") = UserForm2.TextBox18.Value
Worksheets("pn").Range("A4") = "SAP"
UserForm2.Hide
UserForm2.TextBox4.Value = ""
UserForm2.TextBox5.Value = ""
UserForm2.TextBox6.Value = ""
UserForm2.TextBox7.Value = ""
UserForm2.TextBox8.Value = ""
UserForm2.TextBox9.Value = ""
UserForm2.TextBox10.Value = ""
UserForm2.TextBox11.Value = ""
UserForm2.TextBox12.Value = ""
UserForm2.TextBox13.Value = ""
UserForm2.TextBox14.Value = ""
UserForm2.TextBox15.Value = ""
UserForm2.TextBox16.Value = ""
UserForm2.TextBox17.Value = ""
UserForm2.TextBox18.Value = ""
Application.Calculate
Controls(UserForm2.TextBox4.TabIndex).SetFocus
If Worksheets("pn").Range("B4") = "NTC999999999999999" Then
Exit Sub
Else
End If
If (Worksheets("data sheet").Range("O3")) = True Then

newtry = MsgBox("this P/N is not in the program data base" & vbCrLf & _
" would you like to try again? ", vbQuestion + vbYesNo)
If newtry = vbYes Then
UserForm2.TextBox4.Value = ""
UserForm2.TextBox5.Value = ""
UserForm2.TextBox6.Value = ""
UserForm2.TextBox7.Value = ""
UserForm2.TextBox8.Value = ""
UserForm2.TextBox9.Value = ""
UserForm2.TextBox10.Value = ""
UserForm2.TextBox11.Value = ""
UserForm2.TextBox12.Value = ""
UserForm2.TextBox13.Value = ""
UserForm2.TextBox14.Value = ""
UserForm2.TextBox15.Value = ""
UserForm2.TextBox16.Value = ""
UserForm2.TextBox17.Value = ""
UserForm2.TextBox18.Value = ""
Controls(UserForm2.TextBox4.TabIndex).SetFocus
UserForm2.Show
Else

senmail = MsgBox("Would you like to adress an E'mail" & vbCrLf & _
" to VISHAY in order to obtain the wished R/T curve? ", vbQuestion + vbYesNo)
If senmail = vbYes Then
PARTNUM = InputBox("enter your P/N")
Do While PARTNUM = ""
PARTNUM = InputBox("the input info. is empty: type some P/N, or R25 or mech. execution")
Loop
MINTEMP = InputBox("enter Tmin (|fffd|C)", "My VISHAY NTC Curve", "-40")
If MINTEMP = "" Then MINTEMP = -40
maxtemp = InputBox("enter Tmax (|fffd|C)", "My VISHAY NTC Curve", "125")
If maxtemp = "" Then maxtemp = 125
steptemp = InputBox("enter T step (|fffd|C)", "My VISHAY NTC Curve", "5")
If steptemp = "" Then steptemp = 5
    appnom = Application.UserName
   
    Set OutApp = CreateObject("Outlook.Application")
    Set OutMail = OutApp.CreateItem(0)

    strbody = "Hi there" & vbNewLine & vbNewLine & _
              "please send me the R/T table" & vbNewLine & _
              "corresponding to " & PARTNUM & "" & vbNewLine & _
              "from " & MINTEMP & " |fffd|C to " & maxtemp & " |fffd|C" & vbNewLine & _
              "in steps of " & steptemp & " |fffd|C" & vbNewLine & _
              "Thanks. " & vbNewLine & _
              " " & appnom & " "
    On Error GoTo gestion_error
    With OutMail
        .To = "nlr@vishay.com"
        .CC = ""
        .BCC = ""
        .Subject = "R_T curve asked"
        .Body = strbody
        'You can add a file like this
        '.Attachments.Add ("C:\test.txt")
        .Send   'or use .Display
    End With
    On Error GoTo 0

    Set OutMail = Nothing
    Set OutApp = Nothing


Else
Application.DisplayAlerts = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
'.EnableEvents = False

Call importerase
Call savv
'Application.EnableEvents = True

ThisWorkbook.Close
Application.Quit
End If
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
'Application.EnableEvents = False
Call importerase
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.DisplayAlerts = False
Application.Quit
End If
Else
Worksheets("pn").Range("B1") = True
Worksheets("pn").Range("B30") = False
End If
Exit Sub
gestion_error:
MsgBox ("no email has been sent: please contact nlr@vishay.com")
Application.DisplayAlerts = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
'Application.EnableEvents = False
Call importerase
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.Quit

End Sub

Private Sub CommandButton2_Click()
Unload UserForm2
UserForm2.Hide
UserForm3.Show

End Sub

Private Sub CommandButton3_Click()
UserForm2.Hide
UserForm4.Show
End Sub

Private Sub CommandButton4_Click()
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Worksheets("sheet1").Select
UserForm2.Hide
ufworking.Show vbModeless
DoEvents
ThisWorkbook.Save
'Dim namedt As String
'namedt = Worksheets("pn").Range("I45")
'Workbooks(namedt).Activate
Worksheets("pn").Range("B56") = False

On Error Resume Next
UserForm8.ComboBox1.text = "scroll down"




End Sub

Private Sub CommandButton5_Click()
UserForm2.TextBox4.Value = ""
UserForm2.TextBox5.Value = ""
UserForm2.TextBox6.Value = ""
UserForm2.TextBox7.Value = ""
UserForm2.TextBox8.Value = ""
UserForm2.TextBox9.Value = ""
UserForm2.TextBox10.Value = ""
UserForm2.TextBox11.Value = ""
UserForm2.TextBox12.Value = ""
UserForm2.TextBox13.Value = ""
UserForm2.TextBox14.Value = ""
UserForm2.TextBox15.Value = ""
UserForm2.TextBox16.Value = ""
UserForm2.TextBox17.Value = ""
UserForm2.TextBox18.Value = ""
Controls(TextBox4.TabIndex).SetFocus
End Sub

Private Sub CommandButton6_Click()
On Error Resume Next
Application.ScreenUpdating = False
Worksheets("importbcc").Visible = True
Worksheets("importbcc").Activate
Range("A2").Select
ActiveSheet.PasteSpecial Format:="Text", Link:=False, DisplayAsIcon:= _
False
Worksheets("importbcc").Visible = xlVeryHidden
Application.ScreenUpdating = True
If Worksheets("importbcc").Range("L1") = True Then
Call MsgBox(" the P/N you've pasted is empty of incomplete")
Else
If Worksheets("importbcc").Range("K1") = True Then
Call MsgBox(" the P/N that you're trying to paste is longer than 18 digits")
Else

If Worksheets("pn").Range("AA5") = True Then
UserForm2.TextBox4.text = Worksheets("pn").Range("AB4")
UserForm2.TextBox5.text = Worksheets("pn").Range("AC4")
UserForm2.TextBox6.text = Worksheets("pn").Range("AD4")
UserForm2.TextBox7.text = Worksheets("pn").Range("AE4")
UserForm2.TextBox8.text = Worksheets("pn").Range("AF4")
UserForm2.TextBox9.text = Worksheets("pn").Range("AG4")
UserForm2.TextBox10.text = Worksheets("pn").Range("AH4")
UserForm2.TextBox11.text = Worksheets("pn").Range("AI4")
UserForm2.TextBox12.text = Worksheets("pn").Range("AJ4")
UserForm2.TextBox13.text = Worksheets("pn").Range("AK4")
UserForm2.TextBox14.text = Worksheets("pn").Range("AL4")
UserForm2.TextBox15.text = Worksheets("pn").Range("AM4")
UserForm2.TextBox16.text = Worksheets("pn").Range("AN4")
UserForm2.TextBox17.text = Worksheets("pn").Range("AO4")
UserForm2.TextBox18.text = Worksheets("pn").Range("AP4")
 Else
 Call MsgBox("error : the pasted P/N does not begin with NTC")
End If
End If
End If
Range("A2").Select
Selection.Delete
Worksheets("importbcc").Visible = xlVeryHidden
Worksheets("sheet2").Visible = True
Worksheets("sheet1").Visible = xlVeryHidden
Worksheets("sheet2").Select
End Sub



Private Sub Label10_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub
Private Sub Label4_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = True


End Sub




Private Sub Label5_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = True


End Sub
Private Sub Label6_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub
Private Sub Label7_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = True


End Sub

Private Sub Label8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub
Private Sub Label9_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub




Private Sub TextBox1_Change()
If Len(TextBox1.Value) = 1 Then
Controls(TextBox1.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox10_Change()
If Len(TextBox10.Value) = 1 Then
Controls(TextBox10.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox11_Change()
If Len(TextBox11.Value) = 1 Then
Controls(TextBox11.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox12_Change()
If Len(TextBox12.Value) = 1 Then
Controls(TextBox12.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox13_Change()
If Len(TextBox13.Value) = 1 Then
Controls(TextBox13.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox14_Change()
If Len(TextBox14.Value) = 1 Then
Controls(TextBox14.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox15_Change()
If Len(TextBox15.Value) = 1 Then
Controls(TextBox15.TabIndex + 1).SetFocus
Else
End If

End Sub

Private Sub TextBox16_Change()
If Len(TextBox16.Value) = 1 Then
Controls(TextBox16.TabIndex + 1).SetFocus
Else
End If

End Sub

Private Sub TextBox17_Change()
If Len(TextBox17.Value) = 1 Then
Controls(TextBox17.TabIndex + 1).SetFocus
Else
End If

End Sub

Private Sub TextBox18_Change()
If Len(TextBox18.Value) = 1 Then
Controls(TextBox18.TabIndex + 1).SetFocus
Else
End If

End Sub

Private Sub TextBox2_Change()
If Len(TextBox2.Value) = 1 Then
Controls(TextBox2.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox3_Change()
If Len(TextBox3.Value) = 1 Then
Controls(TextBox3.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox4_Change()
If Len(TextBox4.Value) = 1 Then
Controls(TextBox4.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox5_Change()
If Len(TextBox5.Value) = 1 Then
Controls(TextBox5.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox6_Change()
If Len(TextBox6.Value) = 1 Then
Controls(TextBox6.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox7_Change()
If Len(TextBox7.Value) = 1 Then
Controls(TextBox7.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox8_Change()
If Len(TextBox8.Value) = 1 Then
Controls(TextBox8.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox9_Change()
If Len(TextBox9.Value) = 1 Then
Controls(TextBox9.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{BFE0FD65-4364-4656-AFCB-0CBF5D8ED1AD}{4CA72FB7-467C-4B02-B990-8070EFE54EA5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Worksheets("pn").Range("c3") = TextBox3.Value
Worksheets("pn").Range("d3") = TextBox4.Value
Worksheets("pn").Range("f3") = TextBox5.Value
Worksheets("pn").Range("g3") = TextBox6.Value
Worksheets("pn").Range("h3") = TextBox7.Value
Worksheets("pn").Range("j3") = TextBox8.Value
Worksheets("pn").Range("k3") = TextBox9.Value
Worksheets("pn").Range("l3") = TextBox10.Value
Worksheets("pn").Range("m3") = TextBox11.Value
Worksheets("pn").Range("n3") = TextBox12.Value
Worksheets("pn").Range("A4") = "12NC"
UserForm3.Hide
If (Worksheets("data sheet").Range("O3")) = True Then
Call MsgBox(" no proper P/N has been defined")
UserForm3.Show
Else
End If



End Sub

Private Sub CommandButton2_Click()

Worksheets("pn").Range("c3") = TextBox3.Value
Worksheets("pn").Range("d3") = TextBox4.Value
Worksheets("pn").Range("f3") = TextBox5.Value
Worksheets("pn").Range("g3") = TextBox6.Value
Worksheets("pn").Range("h3") = TextBox7.Value
Worksheets("pn").Range("j3") = TextBox8.Value
Worksheets("pn").Range("k3") = TextBox9.Value
Worksheets("pn").Range("l3") = TextBox10.Value
Worksheets("pn").Range("m3") = TextBox11.Value
Worksheets("pn").Range("n3") = TextBox12.Value
Worksheets("pn").Range("A4") = "12NC"
UserForm3.Hide
If Worksheets("pn").Range("B13") = True Then
Call MsgBox("this 12NC is not in the data base ")
Unload UserForm3
UserForm3.Show
Else
End If

If (Worksheets("pn").Range("c3") = 2) And (Worksheets("pn").Range("d3") = 2) Then
Call MsgBox("this 12NC corresponds to an old NON ROHS complient P/N which" & vbCrLf & _
"was phased out since 2007. The program will convert it in its SAP   " & vbCrLf & _
"ROHS complient counterpart (both have same electrical characteristics )")
Else
End If

If Worksheets("pn").Range("A4") = "12NC" Then
UserForm2.TextBox4.text = Worksheets("pn").Range("c21")
UserForm2.TextBox5.text = Worksheets("pn").Range("d21")
UserForm2.TextBox6.text = Worksheets("pn").Range("e21")
UserForm2.TextBox7.text = Worksheets("pn").Range("f21")
UserForm2.TextBox8.text = Worksheets("pn").Range("g21")
UserForm2.TextBox9.text = Worksheets("pn").Range("h21")
UserForm2.TextBox10.text = Worksheets("pn").Range("i21")
UserForm2.TextBox11.text = Worksheets("pn").Range("j21")
UserForm2.TextBox12.text = Worksheets("pn").Range("k21")
UserForm2.TextBox13.text = Worksheets("pn").Range("l21")
UserForm2.TextBox14.text = Worksheets("pn").Range("m21")
UserForm2.TextBox15.text = Worksheets("pn").Range("n21")
UserForm2.TextBox16.text = Worksheets("pn").Range("o21")
UserForm2.TextBox17.text = Worksheets("pn").Range("p21")
UserForm2.TextBox18.text = Worksheets("pn").Range("q21")
Else
End If
Worksheets("pn").Range("D8") = True
UserForm2.Show

End Sub

Private Sub CommandButton4_Click()
Application.DisplayAlerts = False

Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Call importerase
Worksheets("sheet1").Select
'Application.EnableEvents = False

Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.DisplayAlerts = True
Application.Quit
End Sub

Private Sub CommandButton5_Click()
TextBox3.Value = ""
TextBox4.Value = ""
TextBox5.Value = ""
TextBox6.Value = ""
TextBox7.Value = ""
TextBox8.Value = ""
TextBox9.Value = ""
TextBox10.Value = ""
TextBox11.Value = ""
TextBox12.Value = ""
Controls(TextBox3.TabIndex).SetFocus


End Sub

Private Sub TextBox10_Change()
If Len(TextBox10.Value) = 1 Then
Controls(TextBox10.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox11_Change()
If Len(TextBox11.Value) = 1 Then
Controls(TextBox11.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox12_Change()
If Len(TextBox12.Value) = 1 Then
Controls(TextBox12.TabIndex + 1).SetFocus
Else
End If


End Sub

Private Sub TextBox3_Change()
If Len(TextBox3.Value) = 1 Then
Controls(TextBox3.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox4_Change()
If Len(TextBox4.Value) = 1 Then
Controls(TextBox4.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox5_Change()
If Len(TextBox5.Value) = 1 Then
Controls(TextBox5.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox6_Change()
If Len(TextBox6.Value) = 1 Then
Controls(TextBox6.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox7_Change()
If Len(TextBox7.Value) = 1 Then
Controls(TextBox7.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox8_Change()
If Len(TextBox8.Value) = 1 Then
Controls(TextBox8.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub TextBox9_Change()
If Len(TextBox9.Value) = 1 Then
Controls(TextBox9.TabIndex + 1).SetFocus
Else
End If
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{A314D789-1A32-45F2-9842-64D852E79A18}{32C8A211-3375-4E98-A378-DE697492F961}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
UserForm4.Hide
UserForm2.Show
End Sub

Private Sub CommandButton5_Click()
UserForm4.TextBox1.Value = ""
UserForm4.TextBox2.Value = ""
UserForm4.TextBox3.Value = ""
UserForm4.TextBox4.Value = ""
UserForm4.TextBox5.Value = ""
UserForm4.TextBox6.Value = ""
UserForm4.TextBox7.Value = ""
UserForm4.TextBox8.Value = ""
UserForm4.TextBox9.Value = ""
UserForm4.TextBox10.Value = ""
UserForm4.TextBox11.Value = ""
UserForm4.TextBox12.Value = ""
UserForm4.TextBox13.Value = ""
UserForm4.TextBox14.Value = ""
UserForm4.TextBox15.Value = ""
UserForm4.TextBox16.Value = ""
UserForm4.TextBox17.Value = ""
UserForm4.TextBox18.Value = ""
Controls(4).SetFocus
End Sub

Private Sub CommandButton6_Click()
Dim newtry As Byte
Dim senmail As Byte
Dim PARTNUM As String
Dim MINTEMP As String
Dim maxtemp As String
Dim steptemp As String
Dim appnom As String
Dim OutApp As Object
Dim OutMail As Object
Dim strbody As String

Worksheets("pn").Range("a32") = TextBox1.Value
Worksheets("pn").Range("b32") = TextBox2.Value
Worksheets("pn").Range("c32") = TextBox3.Value
Worksheets("pn").Range("d32") = TextBox4.Value
Worksheets("pn").Range("e32") = TextBox5.Value
Worksheets("pn").Range("f32") = TextBox6.Value
Worksheets("pn").Range("g32") = TextBox7.Value
Worksheets("pn").Range("h32") = TextBox8.Value
Worksheets("pn").Range("i32") = TextBox9.Value
Worksheets("pn").Range("j32") = TextBox10.Value
Worksheets("pn").Range("k32") = TextBox11.Value
Worksheets("pn").Range("l32") = TextBox12.Value
Worksheets("pn").Range("m32") = TextBox13.Value
Worksheets("pn").Range("n32") = TextBox14.Value
Worksheets("pn").Range("o32") = TextBox15.Value
Worksheets("pn").Range("p32") = TextBox16.Value
Worksheets("pn").Range("q32") = TextBox17.Value
Worksheets("pn").Range("r32") = TextBox18.Value
UserForm4.Hide


If (Worksheets("pn").Range("A35") = True) Then
Call MsgBox("none of the digits can be '&' ,'$' ,'*' or '-'")
UserForm4.Show
Else
End If
If (Worksheets("pn").Range("U34") = True) Then
Call MsgBox("This P/N has only 16 digits: perhaps the tolerance " & vbCrLf & _
"is missing ....Please verify the P/N.......")
UserForm4.Show
Else
End If
If (Worksheets("pn").Range("U34") = True) Then
Call MsgBox("the NTHS part number is not complete " & vbCrLf & _
"Please complete the part number with 17 digits at least")
UserForm4.Show
Else
End If
If (Worksheets("pn").Range("U35") = True) Then
Call MsgBox("this part number is not complete with less than 8 digits")
UserForm4.Show
Else
End If
If (Worksheets("pn").Range("T32")) = True Then
newtry = MsgBox("this P/N is not in the program data base" & vbCrLf & _
" would you like to try again? ", vbQuestion + vbYesNo)
If newtry = vbYes Then
UserForm4.TextBox1.Value = ""
UserForm4.TextBox2.Value = ""
UserForm4.TextBox3.Value = ""
UserForm4.TextBox4.Value = ""
UserForm4.TextBox5.Value = ""
UserForm4.TextBox6.Value = ""
UserForm4.TextBox7.Value = ""
UserForm4.TextBox8.Value = ""
UserForm4.TextBox9.Value = ""
UserForm4.TextBox10.Value = ""
UserForm4.TextBox11.Value = ""
UserForm4.TextBox12.Value = ""
UserForm4.TextBox13.Value = ""
UserForm4.TextBox14.Value = ""
UserForm4.TextBox15.Value = ""
UserForm4.TextBox16.Value = ""
UserForm4.TextBox17.Value = ""
UserForm4.TextBox18.Value = ""
Controls(4).SetFocus
UserForm4.Show
Else
senmail = MsgBox("Would you like to adress an E'mail" & vbCrLf & _
" to VISHAY in order to obtain the wished R/T curve? ", vbQuestion + vbYesNo)
If senmail = vbYes Then
appnom = Application.UserName
PARTNUM = InputBox("enter your P/N or any other information")
Do While PARTNUM = ""
PARTNUM = InputBox("the input info. is empty: enter some info(R25 and curve)")
Loop
MINTEMP = InputBox("enter Tmin (|fffd|C)", "My VISHAY NTC curve", "-40")
If MINTEMP = "" Then MINTEMP = -40
maxtemp = InputBox("enter Tmax (|fffd|C)", "My VISHAY NTC curve", "125")
If maxtemp = "" Then maxtemp = 125
steptemp = InputBox("enter T step (|fffd|C)", "My VISHAY NTC Curve", "5")
If steptemp = "" Then steptemp = 5

    Set OutApp = CreateObject("Outlook.Application")
    Set OutMail = OutApp.CreateItem(0)

    strbody = "Hi there" & vbNewLine & vbNewLine & _
              "give me the R/T table" & vbNewLine & _
              "corresponding to " & PARTNUM & "" & vbNewLine & _
              "from " & MINTEMP & " |fffd|C to " & maxtemp & " |fffd|C" & vbNewLine & _
              "in steps of " & steptemp & " |fffd|C" & vbNewLine & _
              "" & appnom & ""
    On Error GoTo gestion_error
    With OutMail
        .To = "thermistor1@vishay.com"
        .CC = ""
        .BCC = ""
        .Subject = "R_T curve asked"
        .Body = strbody
        'You can add a file like this
        '.Attachments.Add ("C:\test.txt")
        .Send   'or use .Display
    End With
    On Error GoTo 0

    Set OutMail = Nothing
    Set OutApp = Nothing


Else
Application.DisplayAlerts = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Call importerase
Worksheets("sheet1").Select
'Application.EnableEvents = False
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.Quit
End If
Application.DisplayAlerts = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Call importerase
Worksheets("sheet1").Select
'Application.EnableEvents = False
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.Quit
End If
Else
Worksheets("pn").Range("B1") = False
Worksheets("pn").Range("B30") = True
End If
Exit Sub
gestion_error:
MsgBox ("no email has been sent: please contact thermistor1@vishay.com")
Application.DisplayAlerts = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Call importerase
Worksheets("sheet1").Select
'Application.EnableEvents = False
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.Quit


End Sub

Private Sub CommandButton7_Click()
On Error Resume Next
Application.ScreenUpdating = False
Worksheets("importdale").Visible = True
Worksheets("importdale").Activate
Range("A2").Select

ActiveSheet.PasteSpecial Format:="Text", Link:=False, DisplayAsIcon:= _
False

Worksheets("importdale").Visible = xlVeryHidden
Application.ScreenUpdating = False
If Worksheets("importdale").Range("L1") = True Then
Call MsgBox(" the P/N you're trying to paste is empty of incomplete")
Else

If Worksheets("importdale").Range("K1") = True Then
Call MsgBox(" the P/N  you're trying to paste is longer than 18 digits")
Else

If (Worksheets("importdale").Range("M1") = False) Then
Call MsgBox("the structure of this P/N seems inconsistent" & vbCrLf & _
"normal P/N's begin with NTHS or with a 2-digits nr and a letter such as 01C, 02M ")
UserForm4.Show
Else
End If

If Worksheets("pn").Range("AA10") = True Then
UserForm4.TextBox1.text = Worksheets("pn").Range("AA9")
UserForm4.TextBox2.text = Worksheets("pn").Range("AB9")
UserForm4.TextBox3.text = Worksheets("pn").Range("AC9")
UserForm4.TextBox4.text = Worksheets("pn").Range("AD9")
UserForm4.TextBox5.text = Worksheets("pn").Range("AE9")
UserForm4.TextBox6.text = Worksheets("pn").Range("AF9")
UserForm4.TextBox7.text = Worksheets("pn").Range("AG9")
UserForm4.TextBox8.text = Worksheets("pn").Range("AH9")
UserForm4.TextBox9.text = Worksheets("pn").Range("AI9")
UserForm4.TextBox10.text = Worksheets("pn").Range("AJ9")
UserForm4.TextBox11.text = Worksheets("pn").Range("AK9")
UserForm4.TextBox12.text = Worksheets("pn").Range("AL9")
UserForm4.TextBox13.text = Worksheets("pn").Range("AM9")
UserForm4.TextBox14.text = Worksheets("pn").Range("AN9")
UserForm4.TextBox15.text = Worksheets("pn").Range("AO9")
UserForm4.TextBox16.text = Worksheets("pn").Range("AP9")
UserForm4.TextBox17.text = Worksheets("pn").Range("AQ9")
UserForm4.TextBox18.text = Worksheets("pn").Range("AR9")
 Else
 Call MsgBox("You must paste a P/N beginning with either :  " & vbCrLf & _
 "a) NTHS followed by a SMD case(like NTHS1206) " & vbCrLf & _
 "b) a two digits # followed by a letter (like 01M)")
End If
End If
End If
Range("A2").Select
Selection.Delete
Worksheets("importdale").Visible = xlVeryHidden
End Sub

Private Sub Label5_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = True


End Sub




Private Sub Label5_Click()

End Sub
Private Sub Label6_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub




Private Sub Label7_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub




Private Sub Label8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = False


End Sub

Private Sub Label9_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

Label4.Visible = True


End Sub


Private Sub TextBox1_Change()
If Len(TextBox1.Value) = 1 Then
Controls(5).SetFocus
Else
End If
End Sub

Private Sub TextBox10_Change()
If Len(TextBox10.Value) = 1 Then
Controls(14).SetFocus
Else
End If
End Sub

Private Sub TextBox11_Change()
If Len(TextBox11.Value) = 1 Then
Controls(15).SetFocus
Else
End If
End Sub

Private Sub TextBox12_Change()
If Len(TextBox12.Value) = 1 Then
Controls(16).SetFocus
Else
End If
End Sub

Private Sub TextBox13_Change()
If Len(TextBox13.Value) = 1 Then
Controls(17).SetFocus
Else
End If
End Sub

Private Sub TextBox14_Change()
If Len(TextBox14.Value) = 1 Then
Controls(18).SetFocus
Else
End If
End Sub

Private Sub TextBox15_Change()
If Len(TextBox15.Value) = 1 Then
Controls(19).SetFocus
Else
End If

End Sub

Private Sub TextBox16_Change()
If Len(TextBox16.Value) = 1 Then
Controls(20).SetFocus
Else
End If

End Sub

Private Sub TextBox17_Change()
If Len(TextBox17.Value) = 1 Then
Controls(21).SetFocus
Else
End If

End Sub

Private Sub TextBox18_Change()
If Len(TextBox18.Value) = 1 Then
Controls(22).SetFocus
Else
End If

End Sub

Private Sub TextBox2_Change()
If Len(TextBox2.Value) = 1 Then
Controls(6).SetFocus
Else
End If
End Sub

Private Sub TextBox3_Change()
If Len(TextBox3.Value) = 1 Then
Controls(7).SetFocus
Else
End If
End Sub

Private Sub TextBox4_Change()
If Len(TextBox4.Value) = 1 Then
Controls(8).SetFocus
Else
End If
End Sub

Private Sub TextBox5_Change()
If Len(TextBox5.Value) = 1 Then
Controls(9).SetFocus
Else
End If
End Sub

Private Sub TextBox6_Change()
If Len(TextBox6.Value) = 1 Then
Controls(10).SetFocus
Else
End If
End Sub

Private Sub TextBox7_Change()
If Len(TextBox7.Value) = 1 Then
Controls(11).SetFocus
Else
End If
End Sub

Private Sub TextBox8_Change()
If Len(TextBox8.Value) = 1 Then
Controls(12).SetFocus
Else
End If
End Sub

Private Sub TextBox9_Change()
If Len(TextBox9.Value) = 1 Then
Controls(13).SetFocus
Else
End If
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub
Attribute VB_Name = "UserForm5"
Attribute VB_Base = "0{4E2C107E-E51D-4F08-B413-AB5D2496AC32}{9C9B1D79-BFE1-466E-982C-B60B69D10381}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
ComboBox2.Value = ComboBox1.Value
ComboBox3.Value = ComboBox1.Value
ComboBox4.Value = ComboBox1.Value
ComboBox2.Locked = True
ComboBox3.Locked = True
ComboBox4.Locked = True
Worksheets("data sheet").Range("d17") = ComboBox1.Value
Application.Calculate
UserForm5.TextBox1.text = Worksheets("pn").Range("A9")
UserForm5.TextBox2.text = Worksheets("pn").Range("B9")



End Sub



Private Sub CommandButton1_Click()
Worksheets("data sheet").Range("d17") = ComboBox1.Value
Worksheets("data sheet").Range("d18") = ComboBox5.Value
Worksheets("data sheet").Range("d19") = TextBox1.Value
Worksheets("data sheet").Range("d20") = TextBox2.Value
UserForm5.Hide
If Worksheets("data sheet").Range("R18") = False Then
Call MsgBox("the temperature step must be > or = 0.1|fffd|C or O.2|fffd|C")
UserForm5.Show
Else
End If
If Worksheets("data sheet").Range("R19") = False Then
Call MsgBox("the temperature step must be lower than 20|fffd|C or 30|fffd|F")
UserForm5.Show
Else
End If
If Worksheets("data sheet").Range("R20") = False Then
Call MsgBox("The start temp. must be higher or = -55|fffd|C(-67|fffd|F)")
UserForm5.Show
Else
End If
If Worksheets("data sheet").Range("R21") = False Then
Call MsgBox("The end temp. must be lower or = 300|fffd|C(572|fffd|F)")
UserForm5.Show
Else
End If

If Worksheets("data sheet").Range("e21") = True Then
If Worksheets("data sheet").Range("e17") = False Then
UserForm5.Label9.Visible = True
UserForm5.Show
Else
UserForm5.Label9.Visible = False
End If

If Worksheets("data sheet").Range("e19") = False Then

UserForm5.Label6.Visible = True
UserForm5.Show
Else

UserForm5.Label6.Visible = False
End If
If Worksheets("data sheet").Range("e20") = False Then
UserForm5.Label7.Visible = True
UserForm5.Show
Else
UserForm5.Label7.Visible = False
End If
If Worksheets("data sheet").Range("e18") = False Then
UserForm5.Label8.Visible = True
UserForm5.Show
Else
UserForm5.Label8.Visible = False
End If
Else
End If

If Worksheets("data sheet").Range("C21") = False Then
MsgBox ("the end temperature is < or equal to the start temperature!")
UserForm5.TextBox1.BackColor = &H8000000D
UserForm5.TextBox2.BackColor = &H8000000D
UserForm5.Show
Else
UserForm5.TextBox1.BackColor = -2147483639
UserForm5.TextBox2.BackColor = -2147483639
End If
If Worksheets("data sheet").Range("C22") = False Then
UserForm5.ComboBox5.BackColor = &H8000000D
UserForm5.TextBox1.BackColor = &H8000000D
UserForm5.TextBox2.BackColor = &H8000000D
MsgBox ("the temperature span is not a multiple of the temperature step!")
UserForm5.Show
Else
UserForm5.ComboBox5.BackColor = -2147483639
End If
If Worksheets("data sheet").Range("C23") < 2 Then
MsgBox ("there is only one temperature in the table!")
UserForm5.TextBox1.BackColor = &H8000000D
UserForm5.TextBox2.BackColor = &H8000000D
UserForm5.ComboBox5.BackColor = &H8000000D
UserForm5.Show
Else
UserForm5.TextBox1.BackColor = -2147483639
UserForm5.TextBox2.BackColor = -2147483639
UserForm5.ComboBox5.BackColor = -2147483639
End If
Application.ScreenUpdating = False




End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub
Attribute VB_Name = "UserForm6"
Attribute VB_Base = "0{6ED262B7-DF46-4ACA-8442-57AF5118D396}{ECC43EDA-4E82-432D-B824-20D908891ABE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
ComboBox2.Value = ComboBox1.Value
ComboBox3.Value = ComboBox1.Value
ComboBox4.Value = ComboBox1.Value
ComboBox2.Locked = True
ComboBox3.Locked = True
ComboBox4.Locked = True
Worksheets("RTdale").Range("c7") = ComboBox1.Value
Application.Calculate
UserForm6.TextBox1.Value = Worksheets("pn").Range("V31").Value
UserForm6.TextBox2.Value = Worksheets("pn").Range("W31").Value
End Sub

Private Sub CommandButton1_Click()
Worksheets("RTdale").Range("c7") = ComboBox1.Value
Worksheets("RTdale").Range("c4") = ComboBox5.Value
Worksheets("RTdale").Range("c5") = TextBox1.Value
Worksheets("RTdale").Range("c6") = TextBox2.Value
UserForm6.Hide

If Worksheets("RTdale").Range("Q4") = False Then
Call MsgBox("the temperature step must be > or = 0.1|fffd|C or 0.2|fffd|F")
UserForm6.Show
Else
End If

If Worksheets("RTdale").Range("Q5") = False Then
Call MsgBox("the temperature step must be lower than 20|fffd|C or 30|fffd|F")
UserForm6.Show
Else
End If
If Worksheets("RTdale").Range("Q6") = False Then
Call MsgBox("The start temp. must be higher or = -55|fffd|C(-67|fffd|F)")
UserForm6.Show
Else
End If

If Worksheets("RTdale").Range("Q7") = False Then
Call MsgBox("The end temp. must be lower or = 300|fffd|C(572|fffd|F)")
UserForm6.Show
Else
End If






If Worksheets("RTdale").Range("G4") = False Then
UserForm6.Label9.Visible = True
UserForm6.Show
Else
UserForm6.Label9.Visible = False
End If

If Worksheets("RTdale").Range("G6") = False Then
UserForm6.Label6.Visible = True
UserForm6.Show
Else
UserForm6.Label6.Visible = False
End If

If Worksheets("RTdale").Range("G7") = False Then
UserForm6.Label7.Visible = True
UserForm6.Show
Else
UserForm6.Label7.Visible = False
End If

If Worksheets("RTdale").Range("G5") = False Then
UserForm6.Label8.Visible = True
UserForm6.Show
Else
UserForm6.Label8.Visible = False
End If



If Worksheets("RTdale").Range("G2") = False Then
MsgBox ("the end temperature is < or equal to the start temperature!")
UserForm6.TextBox1.BackColor = &H8000000D
UserForm6.TextBox2.BackColor = &H8000000D
UserForm6.Show
Else
UserForm6.TextBox1.BackColor = -2147483639
UserForm6.TextBox2.BackColor = -2147483639
End If
If Worksheets("RTdale").Range("G3") = False Then
UserForm6.TextBox1.BackColor = &H8000000D
UserForm6.TextBox2.BackColor = &H8000000D
UserForm6.ComboBox5.BackColor = &H8000000D
MsgBox ("the temperature span is not a multiple of the temperature step!")


UserForm6.Show
Else
UserForm6.ComboBox5.BackColor = -2147483639
End If
If Worksheets("RTdale").Range("H3") < 2 Then
MsgBox ("there is only one temperature in the table!")
UserForm6.TextBox1.BackColor = &H8000000D
UserForm6.TextBox2.BackColor = &H8000000D
UserForm6.ComboBox5.BackColor = &H8000000D
UserForm6.Show
Else
UserForm6.TextBox1.BackColor = -2147483639
UserForm6.TextBox2.BackColor = -2147483639
UserForm6.ComboBox5.BackColor = -2147483639
End If


End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub
Attribute VB_Name = "UserForm7"
Attribute VB_Base = "0{008EC7DF-3783-4465-B4CD-03FADA2EB8D2}{22231159-04D3-45BD-9B0A-38D643E1D24A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Worksheets("pn").Range("A53") = True
UserForm7.Hide
End Sub

Private Sub CommandButton2_Click()
Application.DisplayAlerts = False
Worksheets("sheet1").Visible = True
Worksheets("sheet2").Visible = xlVeryHidden
Call importerase
'Application.EnableEvents = False
Call savv
'Application.EnableEvents = True
ThisWorkbook.Close
Application.Quit
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub

Attribute VB_Name = "UserForm8"
Attribute VB_Base = "0{3391954E-DBB1-4DDC-839F-6016ECFE439F}{F95828AE-4CED-4EEE-8F3A-A0AAE2C14246}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()

UserForm8.Hide
End Sub

Private Sub CommandButton2_Click()
Dim filop As String
Dim filop1 As String
filop = UserForm8.ComboBox1.text
filop1 = filop & ".xls"
Application.DisplayAlerts = True
Application.ScreenUpdating = True
If existe_classeur(filop1) = True Then
Workbooks.Open ("" & filop & "")
Else
Call MsgBox(" this file cannot be found" & vbCrLf & _
"Please open it manually....")
End If
End Sub


Function existe_classeur(Nom_classeur As String)
existe = Dir(Nom_classeur)
existe_classeur = (existe <> "")

End Function

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        Cancel = True
        MsgBox "The X is disabled, please use a button on the form.", vbCritical
    End If
     
End Sub

Function FileExists(FullFileName As String) As Boolean
' returns TRUE if the file exists
FileExists = Len(Dir(FullFileName)) > 0
End Function
Attribute VB_Name = "UserForm9"
Attribute VB_Base = "0{3AD72979-E71A-4A3A-9E40-30451AAEE020}{3CB59466-77C2-4EBE-9EA4-D4D32F6A3BE2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label3_Click()

End Sub

Private Sub CommandButton1_Click()
UserForm9.Hide
UserForm1.Show
End Sub

Private Sub CommandButton2_Click()
Application.ScreenUpdating = False
Worksheets("info").Visible = True
Worksheets("info").Select
Worksheets("info").Range("c2").Select
 Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
Worksheets("info").Visible = xlVeryHidden

End Sub

Attribute VB_Name = "ufworking"
Attribute VB_Base = "0{658CA1E5-A85A-4F6C-927F-B4A1E5D0A432}{179CBF55-97B1-47EA-8060-E329FCE0CBB4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


INQUEST-PP=macro
