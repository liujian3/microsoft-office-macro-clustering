Attribute VB_Name = "Hoja1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ComboBox1, 17, 2, MSForms, ComboBox"
Attribute VB_Control = "ComboBox2, 18, 3, MSForms, ComboBox"

Private Sub ComboBox1_Change()
        
    Call Cambia_TipoEntidad
    
End Sub

Private Sub ComboBox2_Change()
    
    Call Cambia_TipoEnteJuridico
    
End Sub

Private Sub Worksheet_Deactivate()
    
    If (ActiveSheet.Name) <> "PAR|fffd|METROS" Then
        ValidarDatosGenerales
    End If
        
End Sub


Attribute VB_Name = "Hoja2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    'ConfiguraIngresoRegistro
  
End Sub


Attribute VB_Name = "Hoja3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
    
    If (ActiveSheet.Name) = "BENEFICIARIOS" Then
        ValidarDatosGenerales
    End If
    
End Sub


Attribute VB_Name = "Hoja4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Mod_Validaciones"

Sub ValidarDatosGenerales()
    Dim strRpta As String
    Dim strRUC As String
    Dim strPeriodo As String
    Dim intPeriodo As Integer
    Dim strDesTipEntJur As String
    Dim strTIN As String
    Dim strRasZoc As String
    Dim strPais As String
    Dim strCelular As String
    Dim strMail As String
        
    Depura_DatosGenerales
    
    strRUC = ThisWorkbook.Sheets("DATOS GENERALES").Cells(12, 6).Value
    strDesTipEntJur = ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Value
    strTIN = ThisWorkbook.Sheets("DATOS GENERALES").Cells(17, 6).Value
    strRasZoc = ThisWorkbook.Sheets("DATOS GENERALES").Cells(18, 6).Value
    strPais = ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Value
    strPais = UCase(strPais) 'cambia a Mayusculas y devuelve a la celda
    ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Value = strPais
    strCelular = ThisWorkbook.Sheets("DATOS GENERALES").Cells(20, 6).Value
    strMail = ThisWorkbook.Sheets("DATOS GENERALES").Cells(21, 6).Value
    GstrRecSus = ThisWorkbook.Sheets("DATOS GENERALES").Cells(23, 4).Value
    strNumOrd = ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 6).Value
    
    strRpta = fValidaRUC(strRUC)
    If strRpta <> "" Then
        MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
        ThisWorkbook.Sheets("DATOS GENERALES").Activate
    Else
        strRpta = ValidaPeriodo
        If strRpta <> "" Then
            ThisWorkbook.Sheets("DATOS GENERALES").Activate
        Else
            strRpta = fValidaDesTipEntJur(strDesTipEntJur)
            If strRpta <> "" Then
                MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                ThisWorkbook.Sheets("DATOS GENERALES").Activate
            Else
                strRpta = fValidaTIN(strTIN)
                If strRpta <> "" Then
                    MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                    ThisWorkbook.Sheets("DATOS GENERALES").Activate
                Else
                    strRpta = fValidaRazSoc(strRasZoc)
                    If strRpta <> "" Then
                        MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                        ThisWorkbook.Sheets("DATOS GENERALES").Activate
                    Else
                        strRpta = fValidaPais(strPais)
                        If strRpta <> "" Then
                            MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                            ThisWorkbook.Sheets("DATOS GENERALES").Activate
                        Else
                            strRpta = fValidaCelular(strCelular)
                            If strRpta <> "" Then
                                MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                                ThisWorkbook.Sheets("DATOS GENERALES").Activate
                            Else
                                strRpta = fValidaMail(strMail)
                                If strRpta <> "" Then
                                    MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                                    ThisWorkbook.Sheets("DATOS GENERALES").Activate
                                Else
                                    strRpta = fValidaNumOrd(strNumOrd)
                                    If strRpta <> "" Then
                                        MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                                        ThisWorkbook.Sheets("DATOS GENERALES").Activate
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End If
    
    GstrRUC = strRUC
    strPeriodo = ThisWorkbook.Sheets("DATOS GENERALES").Cells(13, 4).Value
    intPeriodo = 2018 + CInt(strPeriodo)
    GstrPeriodo = CStr(intPeriodo)
    GstrMes = ThisWorkbook.Sheets("DATOS GENERALES").Cells(13, 7).Value
    If Len(GstrMes) = 1 Then GstrMes = "0" & GstrMes
    GstrTipEnt = "0" & strValTipEnt
    intValTipEntJur = CInt(strValTipEntJur) - 1
    GstrTipEntJur = "0" & CStr(intValTipEntJur)
    GstrDesTipEntJur = Trim(ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Value)
    GstrTIN = Trim(strTIN)
    GstrRasZoc = Trim(strRasZoc)
    GstrPais = Trim(strPais)
    GstrCelular = Trim(strCelular)
    GstrMail = Trim(strMail)
    GstrArcCom = Trim(ThisWorkbook.Sheets("DATOS GENERALES").Cells(22, 4).Value)
    If GstrArcCom = "2" Then GstrArcCom = "0"
    GstrRecSus = Trim(ThisWorkbook.Sheets("DATOS GENERALES").Cells(23, 4).Value)
    If GstrRecSus = "2" Then GstrRecSus = "0"
    GstrNumOrd = Trim(strNumOrd)
    
End Sub

'***************************************************************************
'* Validar RUC - Modulo 11
'***************************************************************************
Function fValidaRUC(ByVal strRUC As String) As String
    
    Dim Num1  As Integer
    Dim Num2  As Integer
    Dim Num3  As Integer
    Dim Num4  As Integer
    Dim Num5  As Integer
    Dim Num6  As Integer
    Dim Num7  As Integer
    Dim Num8  As Integer
    Dim Num9  As Integer
    Dim Num10 As Integer
    Dim Num11 As String
    
    Dim nSuma       As Integer
    Dim nResiduo    As Integer
    Dim strTipAcu   As String
    
    fValidaRUC = ""
    
    If Len(Trim(strRUC)) <> 11 Then
        fValidaRUC = "El RUC deber|fffd| tener 11 d|fffd|gitos."
        Exit Function
    End If
    
    Num1 = Val(Mid(strRUC, 1, 1)) * 5
    Num2 = Val(Mid(strRUC, 2, 1)) * 4
    Num3 = Val(Mid(strRUC, 3, 1)) * 3
    Num4 = Val(Mid(strRUC, 4, 1)) * 2
    Num5 = Val(Mid(strRUC, 5, 1)) * 7
    Num6 = Val(Mid(strRUC, 6, 1)) * 6
    Num7 = Val(Mid(strRUC, 7, 1)) * 5
    Num8 = Val(Mid(strRUC, 8, 1)) * 4
    Num9 = Val(Mid(strRUC, 9, 1)) * 3
    Num10 = Val(Mid(strRUC, 10, 1)) * 2
    Num11 = Mid(strRUC, 11, 1)
    
    nSuma = Num1 + Num2 + Num3 + Num4 + Num5 + Num6 + Num7 + Num8 + Num9 + Num10
    nResiduo = 11 - (nSuma Mod 11)
    
    If nResiduo <= 9 And Num11 <> Trim(CStr(nResiduo)) Then
        fValidaRUC = "N|fffd|mero de RUC inv|fffd|lido."
    End If
    
    If nResiduo > 9 And Num11 <> Right(Trim(CStr(nResiduo)), 1) Then
        fValidaRUC = "N|fffd|mero de RUC inv|fffd|lido."
    End If
    
    'If strValTipEnt = "1" And Mid(strRUC, 1, 2) <> "10" Then
    '    fValidaRUC = "N|fffd|mero de RUC deber|fffd| empezar con '10'"
    'End If
    
End Function


'***************************************************************************
'* Validar Periodo
'***************************************************************************
Function ValidaPeriodo() As String
    Dim strPeriodo As String
    Dim strMes As String
    Dim strMesh As String
    Dim intPeriodo As Integer
    Dim intMes As Integer
    Dim intPerMes As Long
    Dim intPerMesActual As Long
    
   
    strPeriodo = ThisWorkbook.Sheets("DATOS GENERALES").Cells(13, 4).Value
    strMes = ThisWorkbook.Sheets("DATOS GENERALES").Cells(13, 7).Value

    intPeriodo = 2018 + CInt(strPeriodo)
    intMes = CInt(strMes)
    If Len(strMes) = 1 Then strMes = "0" + strMes
    intPerMes = CLng(CStr(intPeriodo) + strMes)
    strMesh = CStr(Month(Date))
    If Len(strMesh) = 1 Then strMesh = "0" + strMesh
    intPerMesActual = CLng(CStr(Year(Date)) + strMesh)

    'If (intPeriodo = 2019 And intMes < 7) Or (intPerMes > intPerMesActual) Then
    'validar que sea desde Enero 2019 hasta un mes antes del actual
    If (intPeriodo = 2019 And intMes >= 1) And (intPerMesActual > intPerMes) Then
        GSperiodo = CStr(intPeriodo)
        GSmes = strMes
        ValidaPeriodo = ""
    Else
        MsgBox "El Periodo Tributario debe ser mayor igual a Enero de 2019 y menor al Periodo actual", vbOKOnly, "Mensaje de Validaci|fffd|n"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(15, 3).Value = GSperiodo
        ValidaPeriodo = "Error"
    End If
    
End Function



'***************************************************************************
'* Validar Descripci|fffd|n Tipo Entidad Jur|fffd|dica
'***************************************************************************
Function fValidaDesTipEntJur(ByVal strDesTipEntJur As String) As String
    'Dim strValTipEntJur As String
   
    fValidaDesTipEntJur = ""
    'strValTipEntJur = ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.ListIndex
    strDesTipEntJur = Trim(strDesTipEntJur)
    
    If strValTipEnt = "2" And strValTipEntJur = "1" Then
        fValidaDesTipEntJur = "Debe de Elegir un Tipo de Ente Jur|fffd|dico."
        Exit Function
    End If
    
    If strValTipEntJur = "5" And Len(strDesTipEntJur) = 0 Then
        fValidaDesTipEntJur = "Debe de Ingresar una Descripci|fffd|n del Tipo de Ente Jur|fffd|dico de m|fffd|ximo 150 caracteres."
        Exit Function
    End If
    
    If strValTipEntJur = "5" And Len(strDesTipEntJur) > 150 Then
        fValidaDesTipEntJur = "La Descripci|fffd|n del Tipo de Ente Jur|fffd|dico deber|fffd| tener m|fffd|ximo 150 caracteres."
        Exit Function
    End If
    
    
End Function

'***************************************************************************
'* Validar TIN
'***************************************************************************
Function fValidaTIN(ByVal strTIN As String) As String
    'Dim strValTipEnt As String
   
    fValidaTIN = ""
    strTIN = Trim(strTIN)
    'strValTipEnt = ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 4).Value
    
    If strValTipEnt = "2" And Len(strTIN) = 0 Then
        fValidaTIN = "Debe de Ingresar el n|fffd|mero de TIN de m|fffd|ximo 21 caracteres."
        Exit Function
    End If
    
    If strValTipEnt = "2" And Len(strTIN) > 21 Then
        fValidaTIN = "El n|fffd|mero de TIN deber|fffd| tener m|fffd|ximo 21 caracteres."
        Exit Function
    End If
    
    
End Function
'***************************************************************************
'* Validar N|fffd|mero de Orden
'***************************************************************************
Function fValidaNumOrd(ByVal strNumOrd As String) As String
    'Dim strValTipEnt As String
   
    fValidaNumOrd = ""
    strNumOrd = Trim(strNumOrd)
    'strValTipEnt = ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 4).Value
    
    If GstrRecSus = 1 Then
        If IsNumeric(strNumOrd) Then
            If validaNumeroPuro(strNumOrd) Then
                If Len(strNumOrd) = 0 Or Len(strNumOrd) > 10 Then
                    fValidaNumOrd = "Debe de Ingresar el Nro. de Orden de la declaraci|fffd|n anterior de m|fffd|ximo 10 d|fffd|gitos."
                    Exit Function
                End If
            Else
                fValidaNumOrd = "Debe de Ingresar el Nro. de Orden de la declaraci|fffd|n anterior de m|fffd|ximo 10 d|fffd|gitos."
                Exit Function
            End If
        Else
            fValidaNumOrd = "Debe de Ingresar el Nro. de Orden de la declaraci|fffd|n anterior de m|fffd|ximo 10 d|fffd|gitos."
            Exit Function
        End If
    End If
    
End Function


'***************************************************************************
'* Validar Raz|fffd|n Social
'***************************************************************************
Function fValidaRazSoc(ByVal strRazSoc As String) As String
       
    fValidaRazSoc = ""
    strRazSoc = Trim(strRazSoc)
    
    If Len(strRazSoc) = 0 Then
        fValidaRazSoc = "Debe de Ingresar Raz|fffd|n Social."
    Else
        If Len(strRazSoc) > 100 Then
            fValidaRazSoc = "Raz|fffd|n Social no debe exceder los 100 caracteres."
        End If
    End If
    
End Function

'***************************************************************************
'* Validar Pais
'***************************************************************************
Function fValidaPais(ByVal strPais As String) As String
    Dim strResBusPais As String
    Dim C As Range
    
    fValidaPais = ""
    strPais = Trim(strPais)
    
    If strValTipEnt = "2" And Len(strPais) = 0 Then
        fValidaPais = "Debe de Ingresar un C|fffd|digo de Pa|fffd|s Constituci|fffd|n."
        Exit Function
    Else
        If strValTipEnt = "2" And Len(strPais) > 0 Then
            'Set C = Sheets("PAISES").Range("B2:B" & Sheets("PAISES").Range("B" & Rows.Count).End(xlUp).Row).Find(What:=strPais, LookIn:=xlValues, LookAt:=xlPart)
            Set C = Sheets("PAISES").Range("B2:B241").Find(What:=strPais, LookAt:=xlWhole)
            If C Is Nothing Then
                fValidaPais = "Debe de Ingresar un C|fffd|digo de Pa|fffd|s Constituci|fffd|n V|fffd|lido."
                Exit Function
            End If
        End If
    End If
    
End Function

'***************************************************************************
'* Validar Mail
'***************************************************************************
Function fValidaMail(ByVal strMail As String) As String
   
    fValidaMail = ""
    strMail = Trim(strMail)

    If validaEmail(strMail) = False Then
        fValidaMail = "Debe Ingresar un Correo Electr|fffd|nico v|fffd|lido."
    Else
        If Len(strMail) > 50 Then
            fValidaMail = "Correo Electr|fffd|nico no debe exceder los 50 caracteres."
        End If
    End If
    
End Function

'***************************************************************************
'* Validar Celular
'***************************************************************************
Function fValidaCelular(ByVal strCelular As String) As String
   
    fValidaCelular = ""
    strCelular = Trim(strCelular)
    

    If Not IsNumeric(strCelular) Then
        fValidaCelular = "Debe de Ingresar un N|fffd|mero de Celular v|fffd|lido."
    Else
        If validaNumeroPuro(strCelular) = True Then
            If Len(strCelular) = 9 Then
                If Mid(strCelular, 1, 1) <> "9" Then
                    fValidaCelular = "El N|fffd|mero de Celular debe empezar con el d|fffd|gito 9."
                End If
            Else
                fValidaCelular = "Debe de Ingresar un N|fffd|mero de Celular de 9 d|fffd|gitos."
            End If
        Else
            fValidaCelular = "Debe de Ingresar un N|fffd|mero de Celular de 9 d|fffd|gitos."
        End If
    End If

    
End Function


Sub Cambia_TipoEntidad()
   
    Call Depura_DatosGenerales
    
End Sub


Sub Cambia_TipoEnteJuridico()
    'Dim strValTipEntJur As Integer
    'strValTipEntJur = ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.ListIndex
    Call Depura_DatosGenerales
    If strValTipEntJur = 5 Then
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 4).Value = "H"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Interior.Color = RGB(255, 255, 255)
    Else
        'If strValTipEntJur = 0 And strValTipEnt = 1 Then ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.ListIndex = 1
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 4).Value = "D"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Interior.Color = RGB(192, 192, 192)
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Value = ""
    End If
        
End Sub


Sub Depura_DatosGenerales()
    'Dim strValTipEntJur As String
    Dim intValTipEntJur As Integer
    Dim intValTipEnt As Integer
    
    strValTipEnt = ThisWorkbook.Sheets("DATOS GENERALES").ComboBox1.ListIndex
    intValTipEnt = CInt(strValTipEnt) + 1
    strValTipEnt = CStr(intValTipEnt)
    
    strValTipEntJur = ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.ListIndex
    If Trim(strValTipEntJur) = "-1" Then strValTipEntJur = "0"
    intValTipEntJur = CInt(strValTipEntJur) + 1
    strValTipEntJur = CStr(intValTipEntJur)
    
    If strValTipEnt = "1" Then
        ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.Enabled = False
        ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.ListIndex = 0
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(15, 4).Value = "D"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Value = ""
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 4).Value = "D"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Interior.Color = RGB(192, 192, 192)
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(17, 6).Value = ""
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(17, 4).Value = "D"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(17, 6).Interior.Color = RGB(192, 192, 192)
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Value = ""
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 4).Value = "D"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Value = "PE"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Interior.Color = RGB(192, 192, 192)
    Else
        If strValTipEntJur <> "5" Then
            ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Value = ""
            ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 4).Value = "D"
            ThisWorkbook.Sheets("DATOS GENERALES").Cells(16, 6).Interior.Color = RGB(192, 192, 192)
            ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.Enabled = True
        End If
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(15, 4).Value = "H"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(17, 4).Value = "H"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(17, 6).Interior.Color = RGB(255, 255, 255)
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 4).Value = "H"
        'If ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Value = "PE" Then
        '    ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Value = ""
        'End If
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 6).Interior.Color = RGB(255, 255, 255)
    End If
    
    If ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 6).Interior.Color = RGB(192, 192, 192) Then
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 6).Value = ""
    End If

End Sub

Function validaEmail(email) As Boolean
    Dim RegEx As Object
    
    If Mid(email, 1, 1) = "@" Then
        validaEmail = False
    Else
        Set RegEx = CreateObject("vbscript.regexp")
        With RegEx
            .Global = True
            .Pattern = "^[_a-zA-Z0-9-]+(\.[_a-zA-Z0-9-]+)*@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*(\.[a-zA-Z]{2,4})$"
        End With
        validaEmail = RegEx.Test(email)
        Set RegEx = Nothing
     End If
     
End Function

Function validaNumeroPuro(numero As String) As Boolean
    validaNumeroPuro = True
    If InStr(numero, ".") > 0 Or InStr(numero, ",") > 0 Or InStr(numero, "-") Or InStr(numero, "+") > 0 Then
        validaNumeroPuro = False
    End If
End Function

Function validaLetraNumeroGuion(textoval As String) As Boolean
    Dim RegEx As Object
    
    Set RegEx = CreateObject("vbscript.regexp")
    With RegEx
        .Global = True
        .Pattern = "^[A-Za-z0-9-]+$"
    End With
    validaLetraNumeroGuion = RegEx.Test(textoval)
    Set RegEx = Nothing
     
End Function
Function validaNumeroPunto(textoval As String) As Boolean
    Dim RegEx As Object
    
    Set RegEx = CreateObject("vbscript.regexp")
    With RegEx
        .Global = True
        .Pattern = "^[0-9.]+$"
    End With
    validaNumeroPunto = RegEx.Test(textoval)
    Set RegEx = Nothing
     
End Function
Function validaSolo3Decimales(textoval As String) As Boolean
    Dim StrTmp As String
    
    If InStr(textoval, ".") > 0 Then
        StrTmp = Mid(textoval, InStr(textoval, ".") + 1)
        If Len(StrTmp) > 3 Then
            validaSolo3Decimales = False
        Else
            validaSolo3Decimales = True
        End If
    Else
        validaSolo3Decimales = True
    End If
     
End Function

'***************************************************************************
'* Validar Fecha
'***************************************************************************
Function fValidarFecha(ByVal strFecha As String) As String
    Dim strDia  As Integer
    Dim strMes  As Integer
    Dim strAnio As Integer
    
    fValidarFecha = ""
    
    '' formato dd/mm/yyyy
    If Not (Mid(strFecha, 3, 1) = "/" And Mid(strFecha, 6, 1) = "/" And Len(strFecha) = 10) Then
        fValidarFecha = "Error"
        GoTo Salir
    End If
    
    '' El numero del centro debe ser mayor a 0 y menor a 12 para poder especificar que sea dd/mm/aaaa
    strMes = Val(Mid(strFecha, 4, 2))
    If Not (strMes > 0 And strMes <= 12) Then
        fValidarFecha = "Error"
        GoTo Salir
    End If
    
    '' Dia mayor a 0
    strDia = Val(Mid(strFecha, 1, 2))
    If Not (strDia > 0) Then
        fValidarFecha = "Error"
        GoTo Salir
    End If
    
    '' Validar fecha
    If Not IsDate(strFecha) Then
        fValidarFecha = "Error"
        GoTo Salir
    End If
    
Salir:
End Function


'***************************************************************************
'* Mostrar listado parametro
'***************************************************************************
Sub MostrarParametro()
    Dim intActiveSheet  As Integer
    Dim strHoja         As String
    Dim strCadBusca     As String
    Dim strSalir        As String
    
    intActiveSheet = ThisWorkbook.ActiveSheet.Index
    strHoja = ThisWorkbook.Sheets(intActiveSheet).Name
    
    If strHoja = "DATOS GENERALES" And ColPaisHoja1 = ActiveCell.Column And RowPaisHoja1 = ActiveCell.Row And ThisWorkbook.Sheets("DATOS GENERALES").Cells(19, 4).Value = "H" Then
        ListadoAyuda = "AyudaPais1"
        frmListado.Show
    End If
    
    If strHoja = "BENEFICIARIOS" And ColRolHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        ListadoAyuda = "AyudaRol2"
        frmListado.Show
    End If
    
    If strHoja = "BENEFICIARIOS" And ColResiHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        ListadoAyuda = "AyudaResidente2"
        frmListado.Show
    End If
    
    If strHoja = "BENEFICIARIOS" And ColTiDoHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        ListadoAyuda = "AyudaTipoDocumento2"
        frmListado.Show
    End If
        
    If strHoja = "BENEFICIARIOS" And ColPaisHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColPaisHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaPais2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColNacionalidadHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColNacionalidadHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaPais4"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColRelaHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColRelaHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaRelacion2"
            frmListado.Show
        End If
    End If
    
    'NUEVOS
    
    If strHoja = "BENEFICIARIOS" And ColEstCivHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColEstCivHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaEstado2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColRegPatConHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColRegPatConHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaRegimen2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColTipProHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipProHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaPropiedad2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColRelParConManHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColRelParConManHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaRelacionPCM2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColTipDocTitHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipDocTitHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaTipoDocumento3"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColTipConHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipConHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaTipoControl2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColComEntJurHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColComEntJurHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaComponente2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColTipValHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipValHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaValor2"
            frmListado.Show
        End If
    End If
    
    If strHoja = "BENEFICIARIOS" And ColLugDepCusHoja2 = ActiveCell.Column And ActiveCell.Row >= RowHoja2 And ActiveCell.Row <= RowHoja2f Then
        If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColLugDepCusHoja2).Interior.Color = RGB(255, 255, 255) Then
            ListadoAyuda = "AyudaPais6"
            frmListado.Show
        End If
    End If
    
        
End Sub

'***************************************************************************
'* Mostrar Formulario para el ingreso de datos
'***************************************************************************
Sub MostrarFormulario()
    Dim intActiveSheet  As Integer
    Dim strHoja         As String
    Dim strCadBusca     As String
    Dim strSalir        As String
    
    intActiveSheet = ThisWorkbook.ActiveSheet.Index
    strHoja = ThisWorkbook.Sheets(intActiveSheet).Name
    
    If strHoja = "BENEFICIARIOS" And ActiveCell.Column >= 3 And ActiveCell.Column <= 31 And ActiveCell.Row >= 8 And ActiveCell.Row <= 607 Then
        'Atrapo valores de la fila
        ValoresDeLaFila
        ShayDataEnFila = Trim(Gcmbrol) + Trim(Gcmbres) + Trim(Gcmbtipdoc) + Trim(Gtxtnumdoc) + Trim(Gtxtnomape) + Trim(Gtxtpaires) + Trim(Gtxtfecnac) + Trim(Gtxtnac) + Trim(Gtxtdom) + Trim(Gtxtrelcon) + Trim(Gtxttel) + Trim(Gtxtcorele) + Trim(Gtxtestciv) + Trim(Gtxtnrodoccon) + Trim(Gtxtregpatcon) + Trim(Gtxttippro) + Trim(Gtxtrelparconman) + Trim(Gtxttipdoctit) + Trim(Gtxtnumdoctit) + Trim(Gtxttipcon) + Trim(Gtxtdestipcon) + Trim(Gtxtcomentjur) + Trim(Gtxttipval) + Trim(Gtxtnumval) + Trim(Gtxtporpar) + Trim(Gtxtvaluninom) + Trim(Gtxttipacc) + Trim(Gtxtfeccie) + Trim(Gtxtlugdepcus)
                       'Trim (Gcmbrol) + Trim(Gcmbres) + Trim(Gcmbtipdoc) + Trim(Gtxtnumdoc) + Trim(Gtxtnomape) + Trim(Gtxtpaires) + Trim(Gtxtfecnac) + Trim(Gtxtnac) + Trim(Gtxtdom) + Trim(Gtxtrelcon)                                                                                                                                                                                                                                                                                                + Trim(Gtxtporpar)
        If ShayDataEnFila = "" Then BhayDataEnFila = False Else BhayDataEnFila = True
        frmBeneficiarios.Show
        If cmdDioCancelar = False Then
            ConfiguraIngresoRegistro
        End If
    End If

    
    
End Sub

Sub ValoresDeLaFila()
    Dim strPais, strNacionalidad, strLudecu As String
    
    filCallForm = ActiveCell.Row
    Gcmbrol = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRolHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRolHoja2).Value = Gcmbrol
    Gcmbres = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColResiHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColResiHoja2).Value = Gcmbres
    Gcmbtipdoc = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTiDoHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTiDoHoja2).Value = Gcmbtipdoc
    Gtxtnumdoc = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumDocHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumDocHoja2).Value = Gtxtnumdoc
    Gtxtnomape = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNomApeHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNomApeHoja2).Value = Gtxtnomape
    
    strPais = UCase(Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColPaisHoja2).Value))
    Gtxtpaires = strPais
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColPaisHoja2).Value = strPais
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColPaisHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtpaires = False
    Else
        BGtxtpaires = True
    End If

    Gtxtfecnac = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColFecNacHoja2).Value)
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColFecNacHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtfecnac = False
    Else
        BGtxtfecnac = True
    End If

    strNacionalidad = UCase(Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNacionalidadHoja2).Value))
    Gtxtnac = strNacionalidad
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNacionalidadHoja2).Value = strNacionalidad
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColNacionalidadHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtnac = False
    Else
        BGtxtnac = True
    End If

    Gtxtdom = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColDomHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColDomHoja2).Value = Gtxtdom
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColDomHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtdom = False
    Else
        BGtxtdom = True
    End If

    Gtxtrelcon = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRelaHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRelaHoja2).Value = Gtxtrelcon
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColRelaHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtrelcon = False
    Else
        BGtxtrelcon = True
    End If
         
    Gtxttel = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTelHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTelHoja2).Value = Gtxttel
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTelHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxttel = False
    Else
        BGtxttel = True
    End If
         
    Gtxtcorele = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColCorEleHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColCorEleHoja2).Value = Gtxtcorele
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColCorEleHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtcorele = False
    Else
        BGtxtcorele = True
    End If
         
    Gtxtestciv = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColEstCivHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColEstCivHoja2).Value = Gtxtestciv
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColEstCivHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtestciv = False
    Else
        BGtxtestciv = True
    End If
         
    Gtxtnrodoccon = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumDocConHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumDocConHoja2).Value = Gtxtnrodoccon
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColNumDocConHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtnrodoccon = False
    Else
        BGtxtnrodoccon = True
    End If
         
    Gtxtregpatcon = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRegPatConHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRegPatConHoja2).Value = Gtxtregpatcon
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColRegPatConHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtregpatcon = False
    Else
        BGtxtregpatcon = True
    End If
         
    Gtxttippro = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipProHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipProHoja2).Value = Gtxttippro
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipProHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxttippro = False
    Else
        BGtxttippro = True
    End If
    
    Gtxtrelparconman = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRelParConManHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColRelParConManHoja2).Value = Gtxtrelparconman
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColRelParConManHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtrelparconman = False
    Else
        BGtxtrelparconman = True
    End If
         
    Gtxttipdoctit = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipDocTitHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipDocTitHoja2).Value = Gtxttipdoctit
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipDocTitHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxttipdoctit = False
    Else
        BGtxttipdoctit = True
    End If
         
    Gtxtnumdoctit = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumDocTitHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumDocTitHoja2).Value = Gtxtnumdoctit
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColNumDocTitHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtnumdoctit = False
    Else
        BGtxtnumdoctit = True
    End If
         
    Gtxttipcon = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipConHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipConHoja2).Value = Gtxttipcon
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipConHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxttipcon = False
    Else
        BGtxttipcon = True
    End If
         
    Gtxtdestipcon = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColDesTipConHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColDesTipConHoja2).Value = Gtxtdestipcon
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColDesTipConHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtdestipcon = False
    Else
        BGtxtdestipcon = True
    End If
         
    Gtxtcomentjur = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColComEntJurHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColComEntJurHoja2).Value = Gtxtcomentjur
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColComEntJurHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtcomentjur = False
    Else
        BGtxtcomentjur = True
    End If
         
    Gtxttipval = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipValHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipValHoja2).Value = Gtxttipval
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipValHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxttipval = False
    Else
        BGtxttipval = True
    End If
    
    Gtxtnumval = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumValHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColNumValHoja2).Value = Gtxtnumval
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColNumValHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtnumval = False
    Else
        BGtxtnumval = True
    End If
         
    Gtxtporpar = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColPorParEntJurHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColPorParEntJurHoja2).Value = Gtxtporpar
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColPorParEntJurHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtporpar = False
    Else
        BGtxtporpar = True
    End If
         
    Gtxtvaluninom = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColValUniNomHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColValUniNomHoja2).Value = Gtxtvaluninom
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColValUniNomHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtvaluninom = False
    Else
        BGtxtvaluninom = True
    End If
    
    Gtxttipacc = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipAccHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColTipAccHoja2).Value = Gtxttipacc
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColTipAccHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxttipacc = False
    Else
        BGtxttipacc = True
    End If
    
    Gtxtfeccie = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColFecCieHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColFecCieHoja2).Value = Gtxtfeccie
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColFecCieHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtfeccie = False
    Else
        BGtxtfeccie = True
    End If
    
    strLudecu = UCase(Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColLugDepCusHoja2).Value))
    Gtxtlugdepcus = strLudecu
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColLugDepCusHoja2).Value = strLudecu
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColLugDepCusHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtlugdepcus = False
    Else
        BGtxtlugdepcus = True
    End If
    
    Gtxtfecpre = Trim(ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColFecPreHoja2).Value)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, ColFecPreHoja2).Value = Gtxtfecpre
    If ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, ColFecPreHoja2).Interior.Color = RGB(192, 192, 192) Then
        BGtxtfecpre = False
    Else
        BGtxtfecpre = True
    End If
         
End Sub


Sub GrabaPlanoDatosGenerales()
    Dim strCarpeta  As String
    Dim Texto       As String
    Dim nombreArchivoControl, nomCarpetaMasArch, nomArchAES As String
    Dim strFecha        As String
    Dim strHora         As String
    
    Dim UTFStream   As Object
    Set UTFStream = CreateObject("adodb.stream")
    UTFStream.Type = 2 'adTypeText
    UTFStream.Mode = 3 'adModeReadWrite
    UTFStream.Charset = "UTF-8"
    
    ValidarDatosGenerales
    
    'Armando la informaci|fffd|n del archivo de Control (Datos Generales)
    Texto = ""
    Texto = Texto & Trim(GstrRUC) & Chr(124) & Trim(GstrPeriodo) & Trim(GstrMes) & Chr(124) & Trim(GstrTipEnt) & Chr(124)
    Texto = Texto & Trim(GstrTipEntJur) & Chr(124) & Trim(GstrDesTipEntJur) & Chr(124) & Trim(GstrTIN) & Chr(124) & Trim(GstrRasZoc) & Chr(124)
    Texto = Texto & Trim(GstrPais) & Chr(124) & Trim(GstrCelular) & Chr(124) & Trim(GstrMail) & Chr(124) & Trim(GstrArcCom) & Chr(124) & Trim(GstrRecSus) & Chr(124) & Trim(GstrNumOrd)
    
    'Armando el nombre del Archivo de Control
    strFecha = Format(Date, "YYYYMMDD")
    strHora = Format(Time, "HHMMSS")
    nombreArchivoControl = "FV3800_" & Trim(GstrPeriodo) & Trim(GstrMes) & "_" & Trim(GstrRUC) & "_CT_" & Trim(strFecha) & "_" & Trim(strHora) & ".txt"
    
    strCarpeta = ThisWorkbook.Path
    UTFStream.Open
    UTFStream.WriteText Texto, 1    'adWriteLine
    UTFStream.Position = 3          'skip BOM
            
    Dim BinaryStream As Object
    Set BinaryStream = CreateObject("adodb.stream")
    BinaryStream.Type = 1           'adTypeBinary
    BinaryStream.Mode = 3           'adModeReadWrite
    BinaryStream.Open               'Strips BOM (first 3 bytes)
    
    UTFStream.CopyTo BinaryStream
    UTFStream.Flush
    UTFStream.Close
            
    BinaryStream.SaveToFile strCarpeta & "\" & nombreArchivoControl, 2
    
    BinaryStream.Flush
    BinaryStream.Close
    
    'ZIPEA
    ZipFile strCarpeta, nombreArchivoControl
    If Right(strCarpeta, 1) <> "\" Then
        strCarpeta = strCarpeta & "\"
    End If
    nomCarpetaMasArch = strCarpeta & nombreArchivoControl
    'Elimina archivo .txt
    Kill nomCarpetaMasArch
    
    'ENCRIPTA
    fAesshell nameArchZIPtmp
    Application.Wait (Now + TimeValue("0:00:01"))
    'Elimina archivo .tmp
    Kill nameArchZIPtmp
    'Renombra archivo encriptado sin extension a uno con extensi|fffd|n .zip (encriptado tambien)
    nomArchAES = Left(nameArchZIPtmp, Len(nameArchZIPtmp) - 4)
    If GENCRIPTAindicador = True Then
        Name nomArchAES As nameArchZIPtmp
        GNomArchDatGen = nomArchAES
    End If
End Sub

Sub GrabaPlanoBeneficiarios()
    Dim strCarpeta  As String
    Dim Texto       As String
    Dim nombreArchivoGeneral, nomCarpetaMasArch, nomArchAES As String
    Dim strFecha        As String
    Dim strHora         As String
    Dim UTFStream   As Object
    Dim i, filIni As Integer
           
    Set UTFStream = CreateObject("adodb.stream")
    UTFStream.Type = 2 'adTypeText
    UTFStream.Mode = 3 'adModeReadWrite
    UTFStream.Charset = "UTF-8"
    
    strCarpeta = ThisWorkbook.Path
    UTFStream.Open
        
    For i = 1 To GCantidadFilasValidar
        filIni = 7 + i
        Sheets("BENEFICIARIOS").Select Cells(filIni, 3).Select
        ValoresDeLaFila
        Texto = ""
        If Gtxtfecnac <> "" Then Gtxtfecnac = Format(Gtxtfecnac, "YYYY/MM/DD")
        Texto = Texto & Gcmbrol & Chr(124) & Gcmbres & Chr(124) & Gcmbtipdoc & Chr(124) & Gtxtnumdoc & Chr(124)
        Texto = Texto & Gtxtnomape & Chr(124) & Gtxtpaires & Chr(124) & Gtxtfecnac & Chr(124) & Gtxtnac & Chr(124)
        Texto = Texto & Gtxtdom & Chr(124)
        Texto = Texto & Gtxtrelcon & Chr(124) & Gtxttel & Chr(124) & Gtxtcorele & Chr(124) & Gtxtestciv & Chr(124)
        Texto = Texto & Gtxtnrodoccon & Chr(124) & Gtxtregpatcon & Chr(124) & Gtxttippro & Chr(124) & Gtxtrelparconman & Chr(124)
        Texto = Texto & Gtxttipdoctit & Chr(124) & Gtxtnumdoctit & Chr(124) & Gtxttipcon & Chr(124) & Gtxtdestipcon & Chr(124)
        Texto = Texto & Gtxtcomentjur & Chr(124) & Gtxttipval & Chr(124) & Gtxtnumval & Chr(124) & Gtxtporpar & Chr(124) & Gtxtvaluninom & Chr(124)
        Texto = Texto & Gtxttipacc & Chr(124) & Gtxtfeccie & Chr(124) & Gtxtlugdepcus & Chr(124) & Gtxtfecpre
   
        UTFStream.WriteText Texto, 1    'adWriteLine
    Next i

    UTFStream.Position = 3
    
    Dim BinaryStream As Object
    Set BinaryStream = CreateObject("adodb.stream")
    BinaryStream.Type = 1           'adTypeBinary
    BinaryStream.Mode = 3           'adModeReadWrite
    BinaryStream.Open               'Strips BOM (first 3 bytes)
    
    UTFStream.CopyTo BinaryStream
    UTFStream.Flush
    UTFStream.Close
    
    ValidarDatosGenerales
    strFecha = Format(Date, "YYYYMMDD")
    strHora = Format(Time, "HHMMSS")
    nombreArchivoGeneral = "FV3800_" & Trim(GstrPeriodo) & GstrMes & "_" & Trim(GstrRUC) & "_GE_" & Trim(strFecha) & "_" & Trim(strHora) & ".txt"
            
    BinaryStream.SaveToFile strCarpeta & "\" & nombreArchivoGeneral, 2
    BinaryStream.Flush
    BinaryStream.Close
        
    'ZIPEA
    ZipFile strCarpeta, nombreArchivoGeneral
    If Right(strCarpeta, 1) <> "\" Then
        strCarpeta = strCarpeta & "\"
    End If
    nomCarpetaMasArch = strCarpeta & nombreArchivoGeneral
    'Elimina archivo .txt
    Kill nomCarpetaMasArch
    
    'ENCRIPTA
    fAesshell nameArchZIPtmp
    Application.Wait (Now + TimeValue("0:00:01"))
    'Elimina archivo .tmp
    Kill nameArchZIPtmp
    'Renombra archivo encriptado sin extension a uno con extensi|fffd|n .zip (encriptado tambien)
    nomArchAES = Left(nameArchZIPtmp, Len(nameArchZIPtmp) - 4)
    If GENCRIPTAindicador = True Then
        Name nomArchAES As nameArchZIPtmp
        GNomArchBen = nomArchAES
    End If

    
End Sub

Sub GrabaArchivoErrores(cantidad As Integer)
    Dim strCarpeta  As String
    Dim Texto       As String
    Dim nombreArchivoGeneral As String
    Dim strFecha        As String
    Dim strHora         As String
    Dim UTFStream   As Object
    Dim i, filIni As Integer
           
    Set UTFStream = CreateObject("adodb.stream")
    UTFStream.Type = 2 'adTypeText
    UTFStream.Mode = 3 'adModeReadWrite
    UTFStream.Charset = "UTF-8"
    
    strCarpeta = ThisWorkbook.Path
    UTFStream.Open
        
    For i = 1 To cantidad
        Texto = ThisWorkbook.Sheets("ERRORES").Cells(i, 1).Value & Chr(124) & ThisWorkbook.Sheets("ERRORES").Cells(i, 2).Value & Chr(124) & ThisWorkbook.Sheets("ERRORES").Cells(i, 3).Value
        UTFStream.WriteText Texto, 1    'adWriteLine
    Next i

    UTFStream.Position = 3
    
    Dim BinaryStream As Object
    Set BinaryStream = CreateObject("adodb.stream")
    BinaryStream.Type = 1           'adTypeBinary
    BinaryStream.Mode = 3           'adModeReadWrite
    BinaryStream.Open               'Strips BOM (first 3 bytes)
    
    UTFStream.CopyTo BinaryStream
    UTFStream.Flush
    UTFStream.Close
    
    ValidarDatosGenerales
    strFecha = Format(Date, "YYYYMMDD")
    strHora = Format(Time, "HHMMSS")
    nombreArchivoGeneral = "FV3800_" & GstrPeriodo & GstrMes & "_" & GstrRUC & "_ERRORES_" & strFecha & "_" & strHora & ".txt"
            
    BinaryStream.SaveToFile strCarpeta & "\" & nombreArchivoGeneral, 2
    BinaryStream.Flush
    BinaryStream.Close
    
End Sub

Sub GeneraArchivosPlanos()
    Dim mensajeError, mensajeFINAL As String
    Dim mensajeRpta As Integer
    
    If ValidaHayInformacionBeneficiarios = True Then
        If ValidaHayFilaVaciaEntreFilas = False Then
            If ValidaBeneficiarios = True Then
                mensajeRpta = MsgBox("|fffd|Desea generar los archivos planos?", vbOKCancel, "Mensaje del Sistema")
                If mensajeRpta = vbCancel Then
                    Exit Sub
                Else
                    GrabaPlanoDatosGenerales
                    If GENCRIPTAindicador = True Then
                        GrabaPlanoBeneficiarios
                        If GENCRIPTAindicador = True Then
                            mensajeFINAL = "Se generaron los Archivos correspondientes: " + Chr(13) + Chr(13)
                            mensajeFINAL = mensajeFINAL + GNomArchDatGen + ".zip" + Chr(13) + Chr(13)
                            mensajeFINAL = mensajeFINAL + GNomArchBen + ".zip" + Chr(13) + Chr(13)
                            MsgBox mensajeFINAL, vbOKOnly, "Mensaje de Validaci|fffd|n"
                        End If
                    End If
                End If
            End If
        Else
           mensajeError = "Los N|fffd| registros " + GFilasVacias + " deben contener informaci|fffd|n"
           MsgBox mensajeError, vbOKOnly, "Mensaje de Validaci|fffd|n"
        End If
    Else
        mensajeError = "Debe de ingresar informaci|fffd|n de Beneficiarios"
        MsgBox mensajeError, vbOKOnly, "Mensaje de Validaci|fffd|n"
    End If
    
End Sub


Function ValidaBeneficiarios() As Boolean
    Dim rowIni, intporpar As Integer
    Dim i, E, conRepLeg, conBenFinPro, conBenFinCon, conBenFinAdmSup, conEntJur As Integer
    Dim strCabReg, strMsjError As String
    Dim indErr As Boolean
    Dim TMPstrValTipEnt, strRpta As String
    Dim fechaNac As Date
    Dim RolTipNumDoc As String
    Dim strRegistrosAvalidar As String
    Dim Vnumero As Variant
            
    ThisWorkbook.Sheets("ERRORES").Range("A1:Z250").ClearContents
        
    RolTipNumDoc = ""
    
    strValTipEnt = ThisWorkbook.Sheets("DATOS GENERALES").ComboBox1.ListIndex
    intValTipEnt = CInt(strValTipEnt) + 1
    strValTipEnt = CStr(intValTipEnt)
    
    strMjsFinalError = ""
    ValidaBeneficiarios = False
    conRepLeg = 0
    conBenFinPro = 0
    conBenFinCon = 0
    conBenFinAdmSup = 0
    conEntJur = 0
    E = 1
    
    For i = 1 To GCantidadFilasValidar
        rowIni = 7 + i
        Sheets("BENEFICIARIOS").Select Cells(rowIni, 3).Select
        ConfiguraIngresoRegistro
        ValoresDeLaFila
        indErr = False
        strMsjError = ""
        
        If Gcmbrol <> "01" And Gcmbrol <> "02" And Gcmbrol <> "03" And Gcmbrol <> "04" And Gcmbrol <> "05" Then
            indErr = True
            strMsjError = strMsjError + "Debe ingresar un Rol v|fffd|lido." + Chr(13)
            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Rol"
            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un valor v|fffd|lido."
            E = E + 1
        Else
            If Gcmbrol = "01" Then conRepLeg = conRepLeg + 1
            If Gcmbrol = "02" Then conBenFinPro = conBenFinPro + 1
            If Gcmbrol = "03" Then conBenFinCon = conBenFinCon + 1
            If Gcmbrol = "04" Then conBenFinAdmSup = conBenFinAdmSup + 1
            If Gcmbrol = "05" Then conEntJur = conEntJur + 1
        End If
        
        If Gcmbres <> "0" And Gcmbres <> "1" Then
            indErr = True
            strMsjError = strMsjError + "Debe ingresar un Tipo de Residente v|fffd|lido." + Chr(13)
            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Es Residente"
            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo de Residente v|fffd|lido."
            E = E + 1
        End If
        
        If Gcmbtipdoc <> "01" And Gcmbtipdoc <> "04" And Gcmbtipdoc <> "06" And Gcmbtipdoc <> "07" And Gcmbtipdoc <> "08" And Gcmbtipdoc <> "09" Then
            indErr = True
            strMsjError = strMsjError + "Debe ingresar un Tipo de Documento v|fffd|lido y su N|fffd|mero respectivo." + Chr(13)
            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Documento"
            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo de Documento v|fffd|lido y su N|fffd|mero respectivo."
            E = E + 1
        Else
            If (Gcmbres = "1") And ((Gcmbtipdoc = "08" Or Gcmbtipdoc = "09")) Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un Tipo de Documento 01, 04, 06, 07 si el Tipo de Residente es 1 (Es Residente)." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Documento"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo de Documento 01, 04, 06, 07 si el Tipo de Residente es 1 (Es Residente)."
                E = E + 1
            Else
                If (Gcmbres = "0") And ((Gcmbtipdoc = "01" Or Gcmbtipdoc = "04" Or Gcmbtipdoc = "06" Or Gcmbtipdoc = "07")) Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un Tipo de Documento 08, 09 si el Tipo de Residente es 0 (No es Residente)." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Documento"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo de Documento 08, 09 si el Tipo de Residente es 0 (No es Residente)."
                    E = E + 1
                End If
            End If
            
            If Gtxtnumdoc = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un N|fffd|mero de Documento v|fffd|lido." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un N|fffd|mero de Documento v|fffd|lido."
                E = E + 1
            Else
                If Gcmbtipdoc = "01" Then
                    If IsNumeric(Gtxtnumdoc) Then
                        If Len(Gtxtnumdoc) <> 8 Then
                            indErr = True
                            strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (DNI debe tener 8 d|fffd|gitos)." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (DNI debe tener 8 d|fffd|gitos)."
                            E = E + 1
                        Else
                            If validaNumeroPuro(Gtxtnumdoc) = False Then
                                indErr = True
                                strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (DNI debe tener 8 d|fffd|gitos)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (DNI debe tener 8 d|fffd|gitos)."
                                E = E + 1
                            End If
                        End If
                    Else
                        indErr = True
                        strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (DNI debe tener 8 d|fffd|gitos)." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (DNI debe tener 8 d|fffd|gitos)."
                        E = E + 1
                    End If
                End If
                If Gcmbtipdoc = "04" Then
                    If Len(Gtxtnumdoc) > 12 Then
                        indErr = True
                        strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)"
                        E = E + 1
                    Else
                        If validaLetraNumeroGuion(Gtxtnumdoc) = False Then
                            indErr = True
                            strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)."
                            E = E + 1
                         End If
                    End If
                End If
                If Gcmbtipdoc = "06" Then
                    strRpta = fValidaRUC(Gtxtnumdoc)
                    If strRpta <> "" Then
                        indErr = True
                        strMsjError = strMsjError + "N|fffd|mero de Documento. " + strRpta + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = strRpta
                        E = E + 1
                    End If
                End If
                If Gcmbtipdoc = "07" Then
                    If Len(Gtxtnumdoc) > 12 Then
                        indErr = True
                        strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)."
                        E = E + 1
                    Else
                        If validaLetraNumeroGuion(Gtxtnumdoc) = False Then
                            indErr = True
                            strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)."
                            E = E + 1
                         End If
                    End If
                End If
                If Gcmbtipdoc = "08" Then
                    If Len(Gtxtnumdoc) > 30 Then
                        indErr = True
                        strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (TIN no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (TIN no debe tener m|fffd|s de 30 caracteres)."
                        E = E + 1
                    Else
                        If validaLetraNumeroGuion(Gtxtnumdoc) = False Then
                            indErr = True
                            strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (TIN no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (TIN no debe tener m|fffd|s de 30 caracteres)."
                            E = E + 1
                         End If
                    End If
                End If
                If Gcmbtipdoc = "09" Then
                    If Len(Gtxtnumdoc) > 30 Then
                        indErr = True
                        strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (ID no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (ID no debe tener m|fffd|s de 30 caracteres)."
                        E = E + 1
                    Else
                        If validaLetraNumeroGuion(Gtxtnumdoc) = False Then
                            indErr = True
                            strMsjError = strMsjError + "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (ID no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento no corresponde al Tipo de documento registrado (ID no debe tener m|fffd|s de 30 caracteres)."
                            E = E + 1
                         End If
                    End If
                End If
                
            End If
        End If
              
        If Gtxtnomape = "" Then
            indErr = True
            strMsjError = strMsjError + "Debe de ingresar Nombres y Apellidos." + Chr(13)
            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Nombres y Apellidos"
            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe de ingresar Nombres y Apellidos."
            E = E + 1
        Else
            If Len(Gtxtnomape) > 150 Then
                indErr = True
                strMsjError = strMsjError + "Nombres y Apellidos no debe tener m|fffd|s de 150 caracteres." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Nombres y Apellidos"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Nombres y Apellidos no debe tener m|fffd|s de 150 caracteres."
                E = E + 1
            End If
        End If
        
        If BGtxtpaires = True Then
            If Gtxtpaires <> "" Then
                TMPstrValTipEnt = strValTipEnt
                strValTipEnt = "2"
                strRpta = fValidaPais(Gtxtpaires)
                If strRpta <> "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe de ingresar un Pa|fffd|s de Residencia v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Pa|fffd|s de Residencia"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe de ingresar un Pa|fffd|s de Residencia v|fffd|lido."
                    E = E + 1
                End If
                strValTipEnt = TMPstrValTipEnt
            Else
                indErr = True
                strMsjError = strMsjError + "Debe de ingresar un Pa|fffd|s de Residencia v|fffd|lido." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Pa|fffd|s de Residencia"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe de ingresar un Pa|fffd|s de Residencia v|fffd|lido."
                E = E + 1
            End If
        Else
            If Gtxtpaires <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar un Pa|fffd|s de Residencia." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Pa|fffd|s de Residencia"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar un Pa|fffd|s de Residencia."
                E = E + 1
            End If
        End If
            
        If BGtxtfecnac = True Then
            If Gtxtfecnac = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar una Fecha de Nacimiento v|fffd|lida." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de Nacimiento"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha de Nacimiento v|fffd|lida."
                E = E + 1
            Else
                If fValidarFecha(Gtxtfecnac) <> "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar una Fecha de Nacimiento v|fffd|lida." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de Nacimiento"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha de Nacimiento v|fffd|lida."
                    E = E + 1
                Else
                    fechaNac = CDate(Gtxtfecnac)
                    If fechaNac >= Date Then
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar una Fecha de Nacimiento v|fffd|lida." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de Nacimiento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha de Nacimiento v|fffd|lida."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtfecnac <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar una Fecha de Nacimiento." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de Nacimiento"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar una Fecha de Nacimiento."
                E = E + 1
            End If
        End If
         
        
        If BGtxtnac = True Then
            If Gtxtnac <> "" Then
                TMPstrValTipEnt = strValTipEnt
                strValTipEnt = "2"
                strRpta = fValidaPais(Gtxtnac)
                If strRpta <> "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar una Nacionalidad v|fffd|lida." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Nacionalidad"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Nacionalidad v|fffd|lida."
                    E = E + 1
                End If
                strValTipEnt = TMPstrValTipEnt
            Else
                indErr = True
                strMsjError = strMsjError + "Debe ingresar una Nacionalidad v|fffd|lida." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Nacionalidad"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Nacionalidad v|fffd|lida."
                E = E + 1
            End If
        Else
            If Gtxtnac <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar una Nacionalidad." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Nacionalidad"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar una Nacionalidad."
                E = E + 1
            End If
        End If
        
                
        If BGtxtdom = True Then
            If Gtxtdom = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un Domicilio." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Domicilio"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Domicilio."
                E = E + 1
                If Len(Gtxtdom) > 150 Then
                    indErr = True
                    strMsjError = strMsjError + "Domicilio no debe tener m|fffd|s de 150 caracteres." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Domicilio"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Domicilio no debe tener m|fffd|s de 150 caracteres."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtdom <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar un Domicilio." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Domicilio"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar un Domicilio."
                E = E + 1
            End If
        End If
        
                
        If BGtxtrelcon = True Then
            If Gtxtrelcon = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un Tipo de Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo de Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico."
                E = E + 1
            Else
                If Gtxtrelcon = "01" Or Gtxtrelcon = "02" Or Gtxtrelcon = "03" Or Gtxtrelcon = "04" Or Gtxtrelcon = "05" Or _
                   Gtxtrelcon = "06" Or Gtxtrelcon = "07" Or Gtxtrelcon = "08" Or Gtxtrelcon = "09" Or Gtxtrelcon = "10" Or _
                   Gtxtrelcon = "11" Or Gtxtrelcon = "12" Or Gtxtrelcon = "13" Or Gtxtrelcon = "14" Or Gtxtrelcon = "15" Or _
                   Gtxtrelcon = "16" Or Gtxtrelcon = "17" Or Gtxtrelcon = "18" Or Gtxtrelcon = "19" Or Gtxtrelcon = "20" Or _
                   Gtxtrelcon = "21" Or Gtxtrelcon = "22" Or Gtxtrelcon = "23" Or Gtxtrelcon = "24" Or Gtxtrelcon = "25" Or _
                   Gtxtrelcon = "26" Or Gtxtrelcon = "27" Or Gtxtrelcon = "28" Or Gtxtrelcon = "29" Or Gtxtrelcon = "30" Or _
                   Gtxtrelcon = "31" Or Gtxtrelcon = "32" Or Gtxtrelcon = "33" Or Gtxtrelcon = "34" Or Gtxtrelcon = "35" Or _
                   Gtxtrelcon = "36" Or Gtxtrelcon = "37" Or Gtxtrelcon = "38" Or Gtxtrelcon = "39" Or Gtxtrelcon = "40" Or _
                   Gtxtrelcon = "41" Or Gtxtrelcon = "42" Or Gtxtrelcon = "43" Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un Tipo de Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo de Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtrelcon <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar un Tipo de Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar un Tipo de Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico."
                E = E + 1
            End If
        End If
        
                
        If BGtxttel = True Then
            If Gtxttel = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un n|fffd|mero de Tel|fffd|fono." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tel|fffd|fono"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un n|fffd|mero de Tel|fffd|fono."
                E = E + 1
            Else
                If IsNumeric(Gtxttel) Then
                    If validaNumeroPuro(Gtxttel) = False Then
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar un n|fffd|mero de Tel|fffd|fono v|fffd|lido." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tel|fffd|fono"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un n|fffd|mero de Tel|fffd|fono v|fffd|lido."
                        E = E + 1
                    Else
                        If Len(Gtxttel) > 30 Then
                            indErr = True
                            strMsjError = strMsjError + "N|fffd|mero de Tel|fffd|fono no debe exceder los 30 d|fffd|gitos." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tel|fffd|fono"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "N|fffd|mero de Tel|fffd|fono no debe exceder los 30 d|fffd|gitos."
                            E = E + 1
                        End If
                    End If
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un n|fffd|mero de Tel|fffd|fono v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tel|fffd|fono"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un n|fffd|mero de Tel|fffd|fono v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxttel <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar un Tel|fffd|fono." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tel|fffd|fono"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar un Tel|fffd|fono."
                E = E + 1
            End If
        End If
        
                            
        If BGtxtcorele = True Then
            If Gtxtcorele = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un Correo Electr|fffd|nico." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Correo Electr|fffd|nico"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Correo Electr|fffd|nico."
                E = E + 1
            Else
                strRpta = fValidaMail(Gtxtcorele)
                If strRpta <> "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un Correo Electr|fffd|nico v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Correo Electr|fffd|nico"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Correo Electr|fffd|nico v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtcorele <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar un Correo Electr|fffd|nico." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Correo Electr|fffd|nico"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar un Correo Electr|fffd|nico."
                E = E + 1
            End If
        End If
                
                
        If BGtxtestciv = True Then
            If Gtxtestciv = "" Then
                indErr = True
                strMsjError = strMsjError + "Debe ingresar un Estado Civil." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Estado Civil"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Estado Civil."
                E = E + 1
            Else
                If Gtxtestciv = "01" Or Gtxtestciv = "02" Or Gtxtestciv = "03" Or Gtxtestciv = "04" Or Gtxtestciv = "05" Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un Estado Civil v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Estado Civil"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Estado Civil v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtestciv <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar un Estado Civil." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Estado Civil"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar un Estado Civil."
                E = E + 1
            End If
        End If
                
                
        If BGtxtnrodoccon = True Then
            If Gtxtestciv = "02" Or Gtxtestciv = "05" Then
                If Gtxtnrodoccon = "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar DNI C|fffd|nyuge." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "DNI C|fffd|nyuge"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar DNI C|fffd|nyuge."
                    E = E + 1
                Else
                    If IsNumeric(Gtxtnrodoccon) Then
                        If Len(Gtxtnrodoccon) <> 8 Then
                            indErr = True
                            strMsjError = strMsjError + "Debe ingresr DNI C|fffd|nyuge v|fffd|lido (8 d|fffd|gitos)." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "DNI C|fffd|nyuge"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresr DNI C|fffd|nyuge v|fffd|lido (8 d|fffd|gitos)."
                            E = E + 1
                        Else
                            If validaNumeroPuro(Gtxtnrodoccon) = False Then
                                indErr = True
                                strMsjError = strMsjError + "Debe ingresr DNI C|fffd|nyuge v|fffd|lido (8 d|fffd|gitos)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "DNI C|fffd|nyuge"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresr DNI C|fffd|nyuge v|fffd|lido (8 d|fffd|gitos)."
                                E = E + 1
                            End If
                        End If
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar DNI C|fffd|nyuge v|fffd|lido (8 d|fffd|gitos)." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "DNI C|fffd|nyuge"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar DNI C|fffd|nyuge v|fffd|lido (8 d|fffd|gitos)."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtnrodoccon <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar DNI C|fffd|nyuge." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "DNI C|fffd|nyuge"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar DNI C|fffd|nyuge."
                E = E + 1
            End If
        End If
                
                
        If BGtxtregpatcon = True Then
            If Gtxtestciv = "02" Or Gtxtestciv = "05" Then
                If Gtxtregpatcon = "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar R|fffd|gimen Patrimonial C|fffd|nyuge." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "R|fffd|gimen Patrimonial C|fffd|nyuge"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar R|fffd|gimen Patrimonial C|fffd|nyuge."
                    E = E + 1
                Else
                    If Gtxtregpatcon = "01" Or Gtxtregpatcon = "02" Or Gtxtregpatcon = "03" Then
                        'OK
                        If Gtxtestciv = "02" And (Gtxtregpatcon = "01" Or Gtxtregpatcon = "02") Then
                            'OK
                        Else
                            If Gtxtestciv = "05" And Gtxtregpatcon = "03" Then
                                'OK
                            Else
                                indErr = True
                                strMsjError = strMsjError + "Debe ingresar R|fffd|gimen Patrimonial C|fffd|nyuge v|fffd|lido." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "R|fffd|gimen Patrimonial C|fffd|nyuge"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar R|fffd|gimen Patrimonial C|fffd|nyuge v|fffd|lido."
                                E = E + 1
                            End If
                        End If
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar R|fffd|gimen Patrimonial C|fffd|nyuge v|fffd|lido." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "R|fffd|gimen Patrimonial C|fffd|nyuge"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar R|fffd|gimen Patrimonial C|fffd|nyuge v|fffd|lido."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtregpatcon <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar R|fffd|gimen Patrimonial C|fffd|nyuge." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "R|fffd|gimen Patrimonial C|fffd|nyuge"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar R|fffd|gimen Patrimonial C|fffd|nyuge."
                E = E + 1
            End If
        End If
                
                
        If BGtxttippro = True Then
            If Gcmbrol = "02" Then
                If Gtxttippro = "01" Or Gtxttippro = "02" Or Gtxttippro = "03" Or Gtxttippro = "04" Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Tipo de Propiedad v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Propiedad"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Tipo de Propiedad v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxttippro <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Tipo de Propiedad." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Propiedad"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Tipo de Propiedad."
                E = E + 1
            End If
        End If
                
        If BGtxtrelparconman = True Then
            If Gcmbrol = "02" Then
                If Gtxtrelparconman = "01" Or Gtxtrelparconman = "02" Or Gtxtrelparconman = "03" Or Gtxtrelparconman = "04" Or _
                   Gtxtrelparconman = "05" Or Gtxtrelparconman = "06" Or Gtxtrelparconman = "07" Or Gtxtrelparconman = "08" Or _
                   Gtxtrelparconman = "09" Or Gtxtrelparconman = "10" Then
                    If ((Gtxttippro = "01" Or Gtxttippro = "03") And (Gtxtrelparconman = "")) Then
                        'OK
                    Else
                        If (Gtxttippro = "02" And (Gtxtrelparconman = "01" Or Gtxtrelparconman = "02" Or Gtxtrelparconman = "03" Or _
                                                   Gtxtrelparconman = "04" Or Gtxtrelparconman = "05" Or Gtxtrelparconman = "06" Or _
                                                   Gtxtrelparconman = "07" Or Gtxtrelparconman = "08" Or Gtxtrelparconman = "09")) Or _
                           (Gtxttippro = "04" And (Gtxtrelparconman = "09" Or Gtxtrelparconman = "10")) Then
                            'OK
                        Else
                            indErr = True
                            strMsjError = strMsjError + "Debe ingresar Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario v|fffd|lido." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario v|fffd|lido."
                            E = E + 1
                        End If
                    End If
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtrelparconman <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario."
                E = E + 1
            End If
        End If
                
                
        If BGtxttipdoctit = True Then
            If Gcmbrol = "02" And Gtxttippro = "02" And Gtxtrelparconman = "09" Then
                'OK
                If Gtxttipdoctit <> "01" And Gtxttipdoctit <> "04" And Gtxttipdoctit <> "06" And Gtxttipdoctit <> "07" And Gtxttipdoctit <> "08" And Gtxttipdoctit <> "09" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un Tipo Documento Titular v|fffd|lido y su N|fffd|mero Documento Titular respectivo." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo Documento Titular"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo Documento Titular v|fffd|lido y su N|fffd|mero Documento Titular respectivo."
                    E = E + 1
                Else
                    If Gtxtnumdoctit = "" Then
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar un N|fffd|mero de Documento Titular v|fffd|lido." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Documento Titular"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un N|fffd|mero de Documento Titular v|fffd|lido."
                        E = E + 1
                    Else
                        If Gtxttipdoctit = "01" Then
                            If IsNumeric(Gtxtnumdoctit) Then
                                If Len(Gtxtnumdoctit) <> 8 Then
                                    indErr = True
                                    strMsjError = strMsjError + "El N|fffd|mero de Documento Titular no corresponde al Tipo Documento Titular registrado (DNI debe tener 8 d|fffd|gitos)." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero de Documento Titular no corresponde al Tipo Documento Titular registrado (DNI debe tener 8 d|fffd|gitos)."
                                    E = E + 1
                                Else
                                    If validaNumeroPuro(Gtxtnumdoctit) = False Then
                                        indErr = True
                                        strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (DNI debe tener 8 d|fffd|gitos)." + Chr(13)
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (DNI debe tener 8 d|fffd|gitos)."
                                        E = E + 1
                                    End If
                                End If
                            Else
                                indErr = True
                                strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (DNI debe tener 8 d|fffd|gitos)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (DNI debe tener 8 d|fffd|gitos)."
                                E = E + 1
                            End If
                        End If
                        If Gtxttipdoctit = "04" Then
                            If Len(Gtxtnumdoctit) > 12 Then
                                indErr = True
                                strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)."
                                E = E + 1
                            Else
                                If validaLetraNumeroGuion(Gtxtnumdoctit) = False Then
                                    indErr = True
                                    strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Carnet Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres)."
                                    E = E + 1
                                End If
                            End If
                        End If
                        If Gtxttipdoctit = "06" Then
                            strRpta = fValidaRUC(Gtxtnumdoctit)
                            If strRpta <> "" Then
                                indErr = True
                                strMsjError = strMsjError + "N|fffd|mero Documento Titular. " + strRpta + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = strRpta
                                E = E + 1
                            End If
                        End If
                        If Gtxttipdoctit = "07" Then
                            If Len(Gtxtnumdoctit) > 12 Then
                                indErr = True
                                strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)."
                                E = E + 1
                            Else
                                If validaLetraNumeroGuion(Gtxtnumdoctit) = False Then
                                    indErr = True
                                    strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (Pasaporte no debe tener m|fffd|s de 12 caracteres)."
                                    E = E + 1
                                End If
                            End If
                        End If
                        If Gtxttipdoctit = "08" Then
                            If Len(Gtxtnumdoctit) > 30 Then
                                indErr = True
                                strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (TIN no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (TIN no debe tener m|fffd|s de 30 caracteres)."
                                E = E + 1
                            Else
                                If validaLetraNumeroGuion(Gtxtnumdoctit) = False Then
                                    indErr = True
                                    strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (TIN no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (TIN no debe tener m|fffd|s de 30 caracteres)."
                                    E = E + 1
                                End If
                            End If
                        End If
                        If Gtxttipdoctit = "09" Then
                            If Len(Gtxtnumdoctit) > 30 Then
                                indErr = True
                                strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (ID no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (ID no debe tener m|fffd|s de 30 caracteres)."
                                E = E + 1
                            Else
                                If validaLetraNumeroGuion(Gtxtnumdoctit) = False Then
                                    indErr = True
                                    strMsjError = strMsjError + "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (ID no debe tener m|fffd|s de 30 caracteres)." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "El N|fffd|mero Documento Titular no corresponde al Tipo Documento Titular registrado (ID no debe tener m|fffd|s de 30 caracteres)."
                                    E = E + 1
                                End If
                            End If
                        End If
                    End If
                End If
            Else
                If Gtxttipdoctit = "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un Tipo Documento Titular." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo Documento Titular"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un Tipo Documento Titular."
                    E = E + 1
                End If
                If Gtxtnumdoctit = "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar un N|fffd|mero Documento Titular." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero Documento Titular"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar un N|fffd|mero Documento Titular."
                    E = E + 1
                End If
            End If
        Else
            If Gtxttipdoctit <> "" Or Gtxtnumdoctit <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Tipo Documento Titular y N|fffd|mero Documento Titular." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo Documento Titular"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Tipo Documento Titular y N|fffd|mero Documento Titular."
                E = E + 1
            End If
        End If
              
                
        If BGtxttipcon = True Then
            If Gcmbrol = "03" Then
                If Gtxttipcon = "01" Or Gtxttipcon = "02" Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Tipo Control v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Control"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Tipo Control v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxttipcon <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Tipo de Control." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Control"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Tipo de Control."
                E = E + 1
            End If
        End If
                
                
        If BGtxtdestipcon = True Then
            If Gcmbrol = "03" Then
                If Gtxtdestipcon <> "" And Len(Gtxtdestipcon) <= 150 Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Descripci|fffd|n del Tipo Control v|fffd|lido (M|fffd|x. 150 caracteres)." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Descripci|fffd|n del Tipo de Control"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Descripci|fffd|n del Tipo Control v|fffd|lido (M|fffd|x. 150 caracteres)."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtdestipcon <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Descripci|fffd|n del Tipo de Control." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Descipci|fffd|n del Tipo de Control"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Descripci|fffd|n del Tipo de Control."
                E = E + 1
            End If
        End If
                
                
        If BGtxtcomentjur = True Then
            If Gcmbrol = "05" Then
                If Gtxtcomentjur = "01" Or Gtxtcomentjur = "02" Or Gtxtcomentjur = "03" Or Gtxtcomentjur = "04" Or _
                   Gtxtcomentjur = "05" Or Gtxtcomentjur = "06" Or Gtxtcomentjur = "07" Or Gtxtcomentjur = "08" Or _
                   Gtxtcomentjur = "09" Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Componente Ente Jur|fffd|dico v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Componente Ente Jur|fffd|dico"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Componente Ente Jur|fffd|dico v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxtcomentjur <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Componente Ente Jur|fffd|dico." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Componente Ente Jur|fffd|dico"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Componente Ente Jur|fffd|dico."
                E = E + 1
            End If
        End If
        
       
        If BGtxttipval = True Then
            If Gcmbrol <> "01" Then
                If Gtxttipval = "01" Or Gtxttipval = "02" Or Gtxttipval = "03" Or Gtxttipval = "" Then
                    'OK
                    If ((Gcmbrol = "02" Or Gcmbrol = "03") And Gtxttipval <> "") Or _
                       (Gcmbrol = "04" Or Gcmbrol = "05") Then
                        'OK
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar Tipo Valor v|fffd|lido." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo Valor"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Tipo Valor v|fffd|lido."
                        E = E + 1
                    End If
                Else
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Tipo Valor v|fffd|lido." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo Valor"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Tipo Valor v|fffd|lido."
                    E = E + 1
                End If
            End If
        Else
            If Gtxttipval <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Tipo Valor." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo Valor"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Tipo Valor."
                E = E + 1
            End If
        End If
        
        
        If BGtxtnumval = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                If (Gcmbrol = "04" Or Gcmbrol = "05") And Gtxtnumval = "" Then
                    'OK
                Else
                    If IsNumeric(Gtxtnumval) Then
                        'OK
                        If validaNumeroPunto(Gtxtnumval) = False Then
                            indErr = True
                            strMsjError = strMsjError + "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Valores"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                            E = E + 1
                        Else
                            If validaSolo3Decimales(Gtxtnumval) = False Then
                                indErr = True
                                strMsjError = strMsjError + "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Valores"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                                E = E + 1
                            Else
                                If Val(Gtxtnumval) > 0 And Val(Gtxtnumval) < 10000000000# Then
                                    'OK
                                Else
                                    indErr = True
                                    strMsjError = strMsjError + "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Valores"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                                    E = E + 1
                                End If
                            End If
                        End If
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Valores"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtnumval <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar N|fffd|mero de Valores." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "N|fffd|mero de Valores"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar N|fffd|mero de Valores."
                E = E + 1
            End If
        End If


        If BGtxtporpar = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                If Gcmbrol = "04" And Gtxtporpar = "" Then
                    'OK
                Else
                    If IsNumeric(Gtxtporpar) Then
                        If Gcmbrol = "04" Or Gcmbrol = "05" Then
                            If validaNumeroPunto(Gtxtporpar) = False Then
                                indErr = True
                                strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales."
                                E = E + 1
                            Else
                                If validaSolo3Decimales(Gtxtporpar) = False Then
                                    indErr = True
                                    strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales."
                                    E = E + 1
                                Else
                                    If Val(Gtxtporpar) >= 0 And Val(Gtxtporpar) <= 100 Then
                                    'OK
                                    Else
                                        indErr = True
                                        strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales."
                                        E = E + 1
                                    End If
                                End If
                            End If
                        Else
                            If Gcmbrol = "02" And Gtxttippro = "01" Then
                                If validaNumeroPunto(Gtxtporpar) = False Then
                                    indErr = True
                                    strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales."
                                    E = E + 1
                                Else
                                    If validaSolo3Decimales(Gtxtporpar) = False Then
                                        indErr = True
                                        strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales."
                                        E = E + 1
                                    Else
                                        If Val(Gtxtporpar) >= 1 And Val(Gtxtporpar) <= 100 Then
                                            'OK
                                        Else
                                            indErr = True
                                            strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales."
                                            E = E + 1
                                        End If
                                    End If
                                End If
                            Else
                                If ((Gcmbrol = "02") And (Gtxttippro = "02" Or Gtxttippro = "03" Or Gtxttippro = "04")) Or _
                                ((Gcmbrol = "03") And (Gtxttipcon = "01" Or Gtxttipcon = "02" Or Gtxttipcon = "03" Or Gtxttipcon = "04")) Then
                                    If validaNumeroPunto(Gtxtporpar) = False Then
                                        indErr = True
                                        strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales."
                                        E = E + 1
                                    Else
                                        If validaSolo3Decimales(Gtxtporpar) = False Then
                                            indErr = True
                                            strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales."
                                            E = E + 1
                                        Else
                                            If Val(Gtxtporpar) >= 0 And Val(Gtxtporpar) <= 100 Then
                                                'OK
                                            Else
                                                indErr = True
                                                strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales." + Chr(13)
                                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales."
                                                E = E + 1
                                            End If
                                        End If
                                    End If
                                End If
                            End If
                        End If
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtporpar <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "% Participaci|fffd|n PJ - Ente Jur|fffd|dico"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico."
                E = E + 1
            End If
        End If


        If BGtxtvaluninom = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                If (Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05") And (Gtxtvaluninom = "") Then
                    'OK
                Else
                    If IsNumeric(Gtxtvaluninom) Then
                        If validaNumeroPunto(Gtxtvaluninom) = False Then
                            indErr = True
                            strMsjError = strMsjError + "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Valor Unitario Nominal"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                            E = E + 1
                        Else
                            If validaSolo3Decimales(Gtxtvaluninom) = False Then
                                indErr = True
                                strMsjError = strMsjError + "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Valor Unitario Nominal"
                                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                                E = E + 1
                            Else
                                If Val(Gtxtvaluninom) > 0 And Val(Gtxtvaluninom) < 10000000000# Then
                                    'OK
                                Else
                                    indErr = True
                                    strMsjError = strMsjError + "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Valor Unitario Nominal"
                                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                                    E = E + 1
                                End If
                            End If
                        End If
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Valor Unitario Nominal"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Valor Unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtvaluninom <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Valor Unitario Nominal." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Valor Unitario Nominal"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Valor Unitario Nominal."
                E = E + 1
            End If
        End If



        If BGtxttipacc = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                If (Gcmbrol = "04" Or Gcmbrol = "05") And (Gtxttipacc = "") Then
                    'OK
                Else
                    If (Gcmbrol = "02" Or Gcmbrol = "03") And Gtxttipacc = "" Then
                        indErr = True
                        strMsjError = strMsjError + "Debe de ingresar Tipo de Acciones." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Acciones"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe de ingresar Tipo de Acciones."
                        E = E + 1
                    Else
                        If Len(Gtxttipacc) <= 30 Then
                            'OK
                        Else
                            indErr = True
                            strMsjError = strMsjError + "Tipo de Acciones no debe tener m|fffd|s de 30 caracteres." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Acciones"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Tipo de Acciones no debe tener m|fffd|s de 30 caracteres."
                            E = E + 1
                        End If
                    End If
                End If
            End If
        Else
            If Gtxttipacc <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Tipo de Acciones." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Tipo de Acciones"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Tipo de Acciones."
                E = E + 1
            End If
        End If



        If BGtxtfeccie = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                If fValidarFecha(Gtxtfeccie) <> "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar Fecha Cierta v|fffd|lida." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha Cierta"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Fecha Cierta v|fffd|lida."
                    E = E + 1
                Else
                    fechaNac = CDate(Gtxtfeccie)
                    If fechaNac >= Date Then
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar una Fecha Cierta v|fffd|lida." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de Nacimiento"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha Cierta v|fffd|lida."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtfeccie <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Fecha Cierta." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha Cierta"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Fecha Cierta."
                E = E + 1
            End If
        End If




        If BGtxtlugdepcus = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                If (Gcmbrol = "04" Or Gcmbrol = "05") And Gtxtlugdepcus = "" Then
                    'OK
                Else
                    If Gtxtlugdepcus <> "" Then
                        TMPstrValTipEnt = strValTipEnt
                        strValTipEnt = "2"
                        strRpta = fValidaPais(Gtxtlugdepcus)
                        If strRpta <> "" Then
                            indErr = True
                            strMsjError = strMsjError + "Debe ingresar Lugar de dep|fffd|sito o Custodia v|fffd|lido." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Lugar de dep|fffd|sito o Custodia"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Lugar de dep|fffd|sito o Custodia v|fffd|lido."
                            E = E + 1
                        End If
                        strValTipEnt = TMPstrValTipEnt
                    Else
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar Lugar de dep|fffd|sito o Custodia v|fffd|lido." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Nacionalidad"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar Lugar de dep|fffd|sito o Custodia v|fffd|lido."
                        E = E + 1
                    End If
                End If
            End If
        Else
            If Gtxtlugdepcus <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar Lugar de dep|fffd|sito o Custodia." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Lugar de dep|fffd|sito o Custodia"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar Lugar de dep|fffd|sito o Custodia."
                E = E + 1
            End If
        End If
        
        
        If BGtxtfecpre = True Then
            If Gcmbrol = "02" Or Gcmbrol = "03" Or Gcmbrol = "04" Or Gcmbrol = "05" Then
                'OK
                If Gtxtfecpre = "" Then
                    indErr = True
                    strMsjError = strMsjError + "Debe ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida." + Chr(13)
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n"
                    ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida."
                    E = E + 1
                Else
                    If fValidarFecha(Gtxtfecpre) <> "" Then
                        indErr = True
                        strMsjError = strMsjError + "Debe ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida." + Chr(13)
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n"
                        ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida."
                        E = E + 1
                    Else
                        fechaPre = CDate(Gtxtfecpre)
                        If fechaPre > Date Then
                            indErr = True
                            strMsjError = strMsjError + "Debe ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida." + Chr(13)
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n"
                            ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "Debe ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida."
                            E = E + 1
                        End If
                    End If
                End If
            End If
        Else
            If Gtxtfecpre <> "" Then
                indErr = True
                strMsjError = strMsjError + "No es necesario ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n." + Chr(13)
                ThisWorkbook.Sheets("ERRORES").Cells(E, 1).Value = i
                ThisWorkbook.Sheets("ERRORES").Cells(E, 2).Value = "Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n"
                ThisWorkbook.Sheets("ERRORES").Cells(E, 3).Value = "No es necesario ingresar una Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n."
                E = E + 1
            End If
        End If
        
        
        
        
        If indErr = True Then
            strCabReg = "Registro N|fffd| " + CStr(i) + Chr(13)
            strMsjError = strCabReg + strMsjError
            strMjsFinalError = strMjsFinalError + strMsjError + Chr(13)
        Else
            'Para validar mas adelante registros duplicados
            'RolTipNumDoc = RolTipNumDoc + Gcmbrol + Gcmbtipdoc + Gtxtnumdoc + "|"
        End If
    Next i
    
   
    
    If strMjsFinalError = "" Then
        strMsjError = ""
        
        If strValTipEnt = "2" Then
            If conRepLeg = 0 Then
                indErr = True
                strMsjError = strMsjError + "Estimado contribuyente, debe registrar un Rol Representante Legal y como m|fffd|nimo dos Roles Ente Jur|fffd|dico" + Chr(13)
            Else
                If conRepLeg > 1 Then
                    indErr = True
                    strMsjError = strMsjError + "Estimado contribuyente, debe registrar un Rol Representante Legal y como m|fffd|nimo dos Roles Ente Jur|fffd|dico" + Chr(13)
                Else
                    If conBenFinPro > 0 Or conBenFinCon > 0 Or conBenFinAdmSup > 0 Then
                        indErr = True
                        strMsjError = strMsjError + "Estimado contribuyente, debe registrar un Rol Representante Legal y como m|fffd|nimo dos Roles Ente Jur|fffd|dico" + Chr(13)
                    Else
                        If conEntJur >= 2 Then
                            'OK
                        Else
                            indErr = True
                            strMsjError = strMsjError + "Estimado contribuyente, debe registrar un Rol Representante Legal y como m|fffd|nimo dos Roles Ente Jur|fffd|dico" + Chr(13)
                        End If
                    End If
                End If
            End If
        Else
            If conBenFinAdmSup >= 1 Then 'de =1 se cambi|fffd| a >=1
                If conRepLeg = 0 And conBenFinPro = 0 And conBenFinCon = 0 And conEntJur = 0 Then
                    'OK
                Else
                    indErr = True
                    strMsjError = strMsjError + "Estimado contribuyente, |fffd|nicamente debe ingresar Roles tipo Rol Beneficiario Final Administrativo Superior" + Chr(13)
                End If
            Else
                If conBenFinAdmSup = 0 Then
                    If conBenFinPro > 0 And conBenFinCon > 0 And conRepLeg = 0 And conEntJur = 0 Then
                        'Ok
                    Else
                        If conBenFinPro > 0 And conBenFinCon = 0 And conRepLeg = 0 And conEntJur = 0 Then
                            'OK
                        Else
                            If conBenFinPro = 0 And conBenFinCon > 0 And conRepLeg = 0 And conEntJur = 0 Then
                                'OK
                            Else
                                indErr = True
                                strMsjError = strMsjError + "Estimado contribuyente, solo debe ingresar Roles del Tipo Beneficiario Final de Propiedad y/o Beneficiario Final de Control" + Chr(13)
                            End If
                        End If
                    End If
                Else
                    'se coment|fffd| esta validaci|fffd|n
                    'indErr = True
                    'strMsjError = strMsjError + "Estimado contribuyente, solo debe ingresar un solo Rol Beneficiario Final Administrativo Superior (y ning|fffd|n otro Rol)" + Chr(13)
                End If
            End If
        End If

        
        If indErr = True Then
            strMjsFinalError = "VALIDACI|fffd|N DE ERRORES" + Chr(13) + Chr(13) + strMjsFinalError + strMsjError + Chr(13)
        End If
        
        If strMjsFinalError <> "" Then
            MsgBox strMjsFinalError, vbOKOnly, "Mensaje de Validaci|fffd|n"
            ValidaBeneficiarios = False
        Else
            'se comenta la validaci|fffd|n de duplicados
            'strRegistrosAvalidar = ValidaExisteDuplicados(RolTipNumDoc)
            'If strRegistrosAvalidar = "" Then
               ValidaBeneficiarios = True
            'Else
            '   strMjsFinalError = "VALIDACI|fffd|N DE ERRORES" + Chr(13) + Chr(13) + strRegistrosAvalidar + Chr(13)
            '   MsgBox strMjsFinalError, vbOKOnly, "Mensaje de Validaci|fffd|n"
            '   ValidaBeneficiarios = False
            'End If
        End If
        
    Else
        '-MsgBox strMjsFinalError, vbOKOnly, "Mensaje de Validaci|fffd|n"
        strMjsFinalError = "VALIDACI|fffd|N DE ERRORES" + Chr(13) + Chr(13) + strMjsFinalError + Chr(13)
        GrabaArchivoErrores (E - 1)
        frmError.Show
        ValidaBeneficiarios = False
    End If
        
    '-MsgBox E - 1, vbOKOnly, "Mensaje de Validaci|fffd|n"
        
End Function

Function ValidaExisteDuplicados(strCadDatosAvalidar As String) As String
    Dim i, posPalote As Integer
    Dim strValorAcomparar As String
    
    ValidaExisteDuplicados = ""
    
    For i = 1 To GCantidadFilasValidar
        posPalote = InStr(1, strCadDatosAvalidar, "|")
        strValorAcomparar = Mid(strCadDatosAvalidar, 1, posPalote - 1)
        strCadDatosAvalidar = Mid(strCadDatosAvalidar, posPalote + 1)
        If InStr(1, strCadDatosAvalidar, strValorAcomparar) > 0 Then
            ValidaExisteDuplicados = "Registro Duplicado. El Rol, Tipo de Documento y N|fffd|mero de Documento del N|fffd| registro " + CStr(i) + " No pueden repetirse."
            i = GCantidadFilasValidar
        End If
    Next i
    
    'MsgBox strCadDatosAvalidar, vbOKOnly, "Mensaje de Validaci|fffd|n"
    'ValidaExisteDuplicados = ""
    
    
End Function

Sub ConfiguraIngresoRegistro()
    Dim res As String
    Dim rol As String
    Dim estciv As String
    Dim tippro As String
    Dim relparcon As String
       
    
    If ActiveCell.Column >= 3 And ActiveCell.Column <= 32 And ActiveCell.Row >= 8 And ActiveCell.Row <= 607 Then
    
        rol = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 3).Value
        res = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 4).Value
        estciv = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 15).Value
        tippro = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 18).Value
        relparcon = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Value
        
        If Mid(res, 1, 1) = "1" Then
            'pais
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 8).Interior.Color = RGB(192, 192, 192)
            'ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 8).Value = ""
            'fecha de nacimiento
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 9).Interior.Color = RGB(255, 255, 255)
            'ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 9).Value = ""
            'nacionalidad
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 10).Interior.Color = RGB(255, 255, 255)
            'ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 10).Value = ""
            'domicilio
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 11).Interior.Color = RGB(255, 255, 255)
            'Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 12).Interior.Color = RGB(255, 255, 255)
            'telefono
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 13).Interior.Color = RGB(255, 255, 255)
            'correo electronico
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 14).Interior.Color = RGB(255, 255, 255)
            'estado civil
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 15).Interior.Color = RGB(255, 255, 255)
            'dni c|fffd|nyuge
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 16).Interior.Color = RGB(255, 255, 255)
            'regimen patrimonial c|fffd|nyuge
            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(255, 255, 255)
            
            If estciv <> "01" And estciv <> "03" And estciv <> "04" Then
                'dni c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 16).Interior.Color = RGB(255, 255, 255)
                'regimen patrimonial c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(255, 255, 255)
            Else
                'dni c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 16).Interior.Color = RGB(192, 192, 192)
                'regimen patrimonial c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(192, 192, 192)
            End If
            
            If Mid(rol, 1, 2) = "02" Then
                'tipo de propiedad
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 18).Interior.Color = RGB(255, 255, 255)
                'relacion pariente c|fffd|nyuge mandatario
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Interior.Color = RGB(255, 255, 255)
                'tipo documento titular
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(255, 255, 255)
                'numero documento titular
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(255, 255, 255)
                If tippro = "01" Or tippro = "03" Then
                    'relacion pariente c|fffd|nyuge mandatario
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Interior.Color = RGB(192, 192, 192)
                    'tipo documento titular
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(192, 192, 192)
                    'numero documento titular
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(192, 192, 192)
                Else
                    If tippro = "02" Or tippro = "04" Then
                        If relparcon <> "09" Then
                            'tipo documento titular
                            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(255, 255, 255)
                            'numero documento titular
                            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(255, 255, 255)
                        Else
                            'tipo documento titular
                            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(192, 192, 192)
                            'numero documento titular
                            ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(192, 192, 192)
                        End If
                    End If
                End If
            Else
                'tipo de propiedad
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 18).Interior.Color = RGB(192, 192, 192)
                'relacion pariente c|fffd|nyuge mandatario
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Interior.Color = RGB(192, 192, 192)
                'tipo documento titular
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(192, 192, 192)
                'numero documento titular
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(192, 192, 192)
            End If
            
            If Mid(rol, 1, 2) = "03" Then
                'tipo de control
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 22).Interior.Color = RGB(255, 255, 255)
                'descripci|fffd|n tipo de control
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 23).Interior.Color = RGB(255, 255, 255)
            Else
                'tipo de control
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 22).Interior.Color = RGB(192, 192, 192)
                'descripci|fffd|n tipo de control
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 23).Interior.Color = RGB(192, 192, 192)
            End If
            
            If Mid(rol, 1, 2) = "05" Then
                'componente ente jur|fffd|dico
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 24).Interior.Color = RGB(255, 255, 255)
            Else
                'componente ente jur|fffd|dico
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 24).Interior.Color = RGB(192, 192, 192)
            End If
            
            If Mid(rol, 1, 2) = "02" Or Mid(rol, 1, 2) = "03" Or Mid(rol, 1, 2) = "04" Or Mid(rol, 1, 2) = "05" Then
                'tipo valor
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 25).Interior.Color = RGB(255, 255, 255)
                'n|fffd|mero de valores
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 26).Interior.Color = RGB(255, 255, 255)
                'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 27).Interior.Color = RGB(255, 255, 255)
                'valor unitario nominal
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 28).Interior.Color = RGB(255, 255, 255)
                'tipo de acciones
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 29).Interior.Color = RGB(255, 255, 255)
                'fecha cierta
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 30).Interior.Color = RGB(255, 255, 255)
                'lugar de dep|fffd|sito o custodia
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 31).Interior.Color = RGB(255, 255, 255)
                'Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 32).Interior.Color = RGB(255, 255, 255)
            Else
                'regimen patrimonial c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(192, 192, 192)
                'tipo valor
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 25).Interior.Color = RGB(192, 192, 192)
                'n|fffd|mero de valores
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 26).Interior.Color = RGB(192, 192, 192)
                'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 27).Interior.Color = RGB(192, 192, 192)
                'valor unitario nominal
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 28).Interior.Color = RGB(192, 192, 192)
                'tipo de acciones
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 29).Interior.Color = RGB(192, 192, 192)
                'fecha cierta
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 30).Interior.Color = RGB(192, 192, 192)
                'lugar de dep|fffd|sito o custodia
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 31).Interior.Color = RGB(192, 192, 192)
                'Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 32).Interior.Color = RGB(192, 192, 192)
            End If
        Else
            If Mid(res, 1, 1) = "0" Then
                'pais
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 8).Interior.Color = RGB(255, 255, 255)
                'fecha de nacimiento
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 9).Interior.Color = RGB(255, 255, 255)
                'nacionalidad
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 10).Interior.Color = RGB(255, 255, 255)
               'domicilio
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 11).Interior.Color = RGB(255, 255, 255)
                'Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 12).Interior.Color = RGB(255, 255, 255)
                'telefono
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 13).Interior.Color = RGB(255, 255, 255)
                'correo electronico
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 14).Interior.Color = RGB(255, 255, 255)
                'estado civil
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 15).Interior.Color = RGB(255, 255, 255)
                'dni c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 16).Interior.Color = RGB(255, 255, 255)
                'regimen patrimonial c|fffd|nyuge
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(255, 255, 255)
                
                If estciv <> "01" And estciv <> "03" And estciv <> "04" Then
                    'dni c|fffd|nyuge
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 16).Interior.Color = RGB(255, 255, 255)
                    'regimen patrimonial c|fffd|nyuge
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(255, 255, 255)
                Else
                    'dni c|fffd|nyuge
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 16).Interior.Color = RGB(192, 192, 192)
                    'regimen patrimonial c|fffd|nyuge
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(192, 192, 192)
                End If
            
                If Mid(rol, 1, 2) = "02" Then
                    'tipo de propiedad
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 18).Interior.Color = RGB(255, 255, 255)
                    'relacion pariente c|fffd|nyuge mandatario
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Interior.Color = RGB(255, 255, 255)
                    'tipo documento titular
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(255, 255, 255)
                    'numero documento titular
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(255, 255, 255)
                    If tippro = "01" Or tippro = "03" Then
                        'relacion pariente c|fffd|nyuge mandatario
                        ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Interior.Color = RGB(192, 192, 192)
                        'tipo documento titular
                        ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(192, 192, 192)
                        'numero documento titular
                        ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(192, 192, 192)
                    Else
                        If tippro = "02" Or tippro = "04" Then
                            If relparcon <> "09" Then
                                'tipo documento titular
                                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(255, 255, 255)
                                'numero documento titular
                                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(255, 255, 255)
                            Else
                                'tipo documento titular
                                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(192, 192, 192)
                                'numero documento titular
                                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(192, 192, 192)
                            End If
                        End If
                    End If
                Else
                    'tipo de propiedad
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 18).Interior.Color = RGB(192, 192, 192)
                    'relacion pariente c|fffd|nyuge mandatario
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 19).Interior.Color = RGB(192, 192, 192)
                    'tipo documento titular
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 20).Interior.Color = RGB(192, 192, 192)
                    'numero documento titular
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 21).Interior.Color = RGB(192, 192, 192)
                End If
            
                If Mid(rol, 1, 2) = "03" Then
                    'tipo de control
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 22).Interior.Color = RGB(255, 255, 255)
                    'descripci|fffd|n tipo de control
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 23).Interior.Color = RGB(255, 255, 255)
                Else
                    'tipo de control
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 22).Interior.Color = RGB(192, 192, 192)
                    'descripci|fffd|n tipo de control
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 23).Interior.Color = RGB(192, 192, 192)
                End If
            
                If Mid(rol, 1, 2) = "05" Then
                    'componente ente jur|fffd|dico
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 24).Interior.Color = RGB(255, 255, 255)
                Else
                    'componente ente jur|fffd|dico
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 24).Interior.Color = RGB(192, 192, 192)
                End If
            
                If Mid(rol, 1, 2) = "02" Or Mid(rol, 1, 2) = "03" Or Mid(rol, 1, 2) = "04" Or Mid(rol, 1, 2) = "05" Then
                    'tipo valor
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 25).Interior.Color = RGB(255, 255, 255)
                    'n|fffd|mero de valores
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 26).Interior.Color = RGB(255, 255, 255)
                    'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 27).Interior.Color = RGB(255, 255, 255)
                    'valor unitario nominal
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 28).Interior.Color = RGB(255, 255, 255)
                    'tipo de acciones
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 29).Interior.Color = RGB(255, 255, 255)
                    'fecha cierta
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 30).Interior.Color = RGB(255, 255, 255)
                    'lugar de dep|fffd|sito o custodia
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 31).Interior.Color = RGB(255, 255, 255)
                   'Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 32).Interior.Color = RGB(255, 255, 255)
                Else
                   'regimen patrimonial c|fffd|nyuge
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 17).Interior.Color = RGB(192, 192, 192)
                    'tipo valor
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 25).Interior.Color = RGB(192, 192, 192)
                    'n|fffd|mero de valores
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 26).Interior.Color = RGB(192, 192, 192)
                    'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 27).Interior.Color = RGB(192, 192, 192)
                    'valor unitario nominal
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 28).Interior.Color = RGB(192, 192, 192)
                    'tipo de acciones
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 29).Interior.Color = RGB(192, 192, 192)
                    'fecha cierta
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 30).Interior.Color = RGB(192, 192, 192)
                    'lugar de dep|fffd|sito o custodia
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 31).Interior.Color = RGB(192, 192, 192)
                   'Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
                    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(ActiveCell.Row, 32).Interior.Color = RGB(192, 192, 192)
                End If
            End If
        End If
    End If
End Sub

Sub LimpiarData()
    Dim rowIni As Integer
    Dim colIni As Integer
    Dim i, j As Integer
    Dim mensajeRpta As String
    
    
    rowIni = 8
    colIni = 3
    
    mensajeRpta = MsgBox("|fffd|Desea borrar todos los registros de Beneficiarios del Excel?", vbOKCancel, "Mensaje del Sistema")
    If mensajeRpta = vbCancel Then
        Exit Sub
    Else
        For i = rowIni To 607
            For j = colIni To 32
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(i, j).Interior.Color = RGB(255, 255, 255)
                ThisWorkbook.Sheets("BENEFICIARIOS").Cells(i, j).Value = ""
            Next j
        Next i
    End If
End Sub

Function ValidaHayInformacionBeneficiarios() As Boolean
    Dim rowIni As Integer
    Dim rowFin As Integer
    Dim colIni As Integer
    Dim colFin As Integer
    Dim i, j As Integer
    Dim valorColFil As String
    Dim trama As String
       
    rowIni = 8
    rowFin = 607
    colIni = 3
    colFin = 32
    ValidaHayInformacionBeneficiarios = False
    For i = rowIni To rowFin
        trama = ""
        For j = colIni To colFin
            valorColFil = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(i, j).Value
            valorColFil = Trim(valorColFil)
            trama = trama + valorColFil
        Next j
        If trama <> "" Then
            ValidaHayInformacionBeneficiarios = True
            i = 607
        End If
    Next i

End Function

Function ValidaHayFilaVaciaEntreFilas() As Boolean
    Dim rowIni As Integer
    Dim rowFin As Integer
    Dim colIni As Integer
    Dim colFin As Integer
    Dim i, j As Integer
    Dim valorColFil As String
    Dim trama As String
    
    Dim trama1 As String
    Dim cantreg As Integer
                
    rowIni = 8
    rowFin = 607
    colIni = 3
    colFin = 32
    cantreg = 600
    
    GFilasVacias = ""
    GCantidadFilasValidar = 0
    ValidaHayFilaVaciaEntreFilas = False
        
    For i = rowIni To rowFin
        trama = ""
        For j = colIni To colFin
            valorColFil = ThisWorkbook.Sheets("BENEFICIARIOS").Cells(i, j).Value
            valorColFil = Trim(valorColFil)
            trama = trama + valorColFil
        Next j
        j = colIni
        
        If i = rowIni Then
            trama1 = trama
            If trama = "" Then
                GFilasVacias = GFilasVacias + CStr(i - rowIni + 1) + ", "
            Else
                GCantidadFilasValidar = GCantidadFilasValidar + 1
            End If
        Else
            If trama1 = "" And trama <> "" Then
                ValidaHayFilaVaciaEntreFilas = True
                Exit For
            Else
                trama1 = trama
                If trama = "" Then
                    GFilasVacias = GFilasVacias + CStr(i - rowIni + 1) + ", "
                Else
                    GCantidadFilasValidar = GCantidadFilasValidar + 1
                End If
            End If
        End If
    Next i
    
End Function


'***************************************************************************
'* Generar Zip File
'***************************************************************************
Sub ZipFile(ByVal strCarpeta As String, ByVal strFile As String)
    Dim strDate         As String
    Dim DefPath         As String
    Dim sFName          As String
    Dim oApp            As Object
    Dim iCtr            As Long
    Dim i               As Integer
    Dim FName           As String
    Dim FileNameZip     As Variant
    
    DefPath = strCarpeta
    If Right(DefPath, 1) <> "\" Then
        DefPath = DefPath & "\"
    End If
    
    FileNameZip = DefPath & Mid(strFile, 1, InStr(1, strFile, ".") - 1) & ".zip"
    nameArchZIPtmp = FileNameZip
    
    'Browse to the file(s), use the Ctrl key to select more files
    FName = strFile
    If FName = "" Then
        'do nothing
    Else
        'Create empty Zip File
        NewZip (FileNameZip)
        Set oApp = CreateObject("Shell.Application")
        'I = 0
        If bIsBookOpen(sFName) Then
            MsgBox "Ha ocurrido un problema al descargar la solicitud, favor revise la unidad de almacenamiento.", vbExclamation, pstrMensaje
        Else
            'Copy the file to the compressed folder
            i = i + 1
            oApp.Namespace(FileNameZip).CopyHere DefPath & FName
            
            'Keep script waiting until Compressing is done
            On Error Resume Next
            Do Until oApp.Namespace(FileNameZip).items.Count = i
                Application.Wait (Now + TimeValue("0:00:01"))
            Loop
            On Error GoTo 0
        End If
        'MsgBox "Se gener|fffd| el archivo en la carpeta seleccionada: " & FileNameZip
    End If
End Sub


'***************************************************************************
'* Crear ruta ZIP
'***************************************************************************
Sub NewZip(sPath)
'Create empty Zip File
'Changed by keepITcool Dec-12-2005
    If Len(Dir(sPath)) > 0 Then Kill sPath
    Open sPath For Output As #1
    Print #1, Chr$(80) & Chr$(75) & Chr$(5) & Chr$(6) & String(18, 0)
    Close #1
End Sub


'***************************************************************************
'* Verificar si esta abierto el archivo
'***************************************************************************
Function bIsBookOpen(ByRef szBookName As String) As Boolean
' Rob Bovey
    On Error Resume Next
    bIsBookOpen = Not (Application.Workbooks(szBookName) Is Nothing)
End Function


'***************************************************************************
'* aesshell
'***************************************************************************
Function fAesshell(ByVal strSourceFileName As String)
    Dim strRuta         As String
    Dim strAesPath      As String
    Dim strDestFileName As String
    
    strRuta = ThisWorkbook.Path
    strAesPath = strRuta & "\aesshell.exe"
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    If fso.FileExists(strAesPath) Then
        strDestFileName = Replace(strSourceFileName, ".zip", "") '& ".aes"
        gstrArchivo = strDestFileName
        strCommand = strAesPath & " " & Chr(34) & strSourceFileName & Chr(34) & " " & Chr(34) & strDestFileName & Chr(34) & " E 47341783786655337477766912043545"
        'Debug.Print strCommand
        'aesshell.exe "E:\Resultado\PT_GE_10407958191_20170529_083934.zip.aes" "E:\Resultado\PT_GE_10407958191_20170529_083934.zip" D 47341783786655337477766912043545
        Shell strCommand
        Application.Wait (Now + TimeValue("0:00:01"))
        GENCRIPTAindicador = True
    Else
        MsgBox "No se ha encontrado el archivo aesshell.exe en la ruta del aplicativo, favor verifique.", vbExclamation, "Mensaje del Sistema"
        GENCRIPTAindicador = False
    End If
    
End Function

Sub Listadesplegable11_Cambiar()
    'no hay eventos aqui
End Sub

Sub Listadesplegable22_Cambiar()
    If ThisWorkbook.Sheets("DATOS GENERALES").Cells(23, 4).Value = 1 Then
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 4).Value = "H"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 6).Interior.Color = RGB(255, 255, 255)
    Else
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 4).Value = "D"
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 6).Interior.Color = RGB(192, 192, 192)
        ThisWorkbook.Sheets("DATOS GENERALES").Cells(24, 6).Value = ""
    End If
End Sub



Sub CancelF5()
    Cancel = True
    
End Sub



Attribute VB_Name = "Mod_VarGlob"
Public Const ColPaisHoja1 As Integer = 6    'columna ayuda pais hoja 1
Public Const RowPaisHoja1 As Integer = 19   'fila ayuda pais hoya 1

Public Const ColRolHoja2 As Integer = 3             'columna ayuda Rol hoja 2
Public Const ColResiHoja2 As Integer = 4            'columna ayuda Residente hoja 2
Public Const ColTiDoHoja2 As Integer = 5            'columna ayuda Documento hoja 2
Public Const ColNumDocHoja2 As Integer = 6          'columna en hoja 2
Public Const ColNomApeHoja2 As Integer = 7          'columna en hoja 2
Public Const ColPaisHoja2 As Integer = 8            'columna ayuda Pais hoja 2
Public Const ColFecNacHoja2 As Integer = 9          'columna en hoja 2
Public Const ColNacionalidadHoja2 As Integer = 10   'columna ayuda Nacionalidad hoja 2
Public Const ColDomHoja2 As Integer = 11            'columna en hoja 2
Public Const ColRelaHoja2 As Integer = 12           'columna ayuda Relaci|fffd|n hoja 2
Public Const ColTelHoja2 As Integer = 13            'columna en hoja 2
Public Const ColCorEleHoja2 As Integer = 14         'columna en hoja 2
Public Const ColEstCivHoja2 As Integer = 15         'columna ayuda Estado Civil hoja 2
Public Const ColNumDocConHoja2 As Integer = 16      'columna en hoja 2
Public Const ColRegPatConHoja2 = 17                 'columna ayuda R|fffd|gimen Patrimonial C|fffd|nyugue hoja 2
Public Const ColTipProHoja2 = 18                    'columna ayuda Tipo de Propiedad hoja 2
Public Const ColRelParConManHoja2 = 19              'columna ayuda Relaci|fffd|n Pariente / C|fffd|nyugue / Mandatario hoja 2
Public Const ColTipDocTitHoja2 = 20                 'columna ayuda Tipo Documento Titular hoja 2
Public Const ColNumDocTitHoja2 As Integer = 21      'columna en hoja 2
Public Const ColTipConHoja2 = 22                    'columna ayuda Tipo de Control hoja 2
Public Const ColDesTipConHoja2 = 23                 'columna en hoja 2
Public Const ColComEntJurHoja2 = 24                 'columna ayuda Componente Ente Jur|fffd|dico hoja 2
Public Const ColTipValHoja2 = 25                    'columna ayuda Tipo Valor hoja 2
Public Const ColNumValHoja2 = 26                    'columna en hoja 2
Public Const ColPorParEntJurHoja2 = 27              'columna en hoja 2
Public Const ColValUniNomHoja2 = 28                 'columna en hoja 2
Public Const ColTipAccHoja2 = 29                    'columna en hoja 2
Public Const ColFecCieHoja2 = 30                    'columna en hoja 2
Public Const ColLugDepCusHoja2 = 31                 'columna ayuda Lugar de Dep|fffd|sito o Custodia hoja 2
Public Const ColFecPreHoja2 = 32                   'columna en hoja 2


Public Const RowHoja2  As Integer = 8       'fila general inicio para columnas ayuda hoja 2
Public Const RowHoja2f As Integer = 607      'fila general fin para columnas ayuda hoja 2

Public ListadoAyuda As String 'para ver que ayuda F4 muestro
Public HojaActiva As String   'para saber el nombre de la hoja activa
Public strValTipEnt As String 'para saber el valor del tipo de entidad (iniciado en 1)
Public strValTipEntJur As String

'para armar la informacion a grabar en el plano Datos Generales
Public GstrRUC              As String
Public GstrPeriodo          As String
Public GstrMes              As String   'nuevo
Public GstrTipEnt           As String
Public GstrTipEntJur        As String   'nuevo
Public GstrDesTipEntJur     As String   'nuevo
Public GstrTIN              As String
Public GstrRasZoc           As String
Public GstrPais             As String
Public GstrCelular          As String
Public GstrMail             As String
Public GstrArcCom           As String   'nuevo
Public GstrRecSus           As String   'nuevo
Public GstrNumOrd           As String   'nuevo
'

'para armar la informacion a grabar en el plano Beneficiarios
'Public GstrRol      As String
'Public GstrRes      As String
'Public GstrTipDoc   As String
'Public GstrNumDoc   As String
'Public GstrNomApe   As String
'Public GstrPaiRes   As String
'Public GstrFecNac   As String
'Public GstrNac      As String
'Public GstrDom      As String
'Public GstrPorPar   As String
'Public GstrRelCon   As String
'

'Fila de donde se llama formulario ingreso datos Beneficiarios
Public filCallForm As Integer
Public cmdDioCancelar As Boolean

'para armar la informacion a grabar en el plano Beneficiarios
'Valores de la Fila de la hoja Beneficiarios
Public Gcmbrol              As String
Public Gcmbres              As String
Public Gcmbtipdoc           As String
Public Gtxtnumdoc           As String
Public Gtxtnomape           As String
Public Gtxtpaires           As String
Public Gtxtfecnac           As String
Public Gtxtnac              As String
Public Gtxtdom              As String
Public Gtxtrelcon           As String
Public Gtxttel              As String
Public Gtxtcorele           As String
Public Gtxtestciv           As String
Public Gtxtnrodoccon        As String
Public Gtxtregpatcon        As String
Public Gtxttippro           As String
Public Gtxtrelparconman     As String
Public Gtxttipdoctit        As String
Public Gtxtnumdoctit        As String
Public Gtxttipcon           As String
Public Gtxtdestipcon        As String
Public Gtxtcomentjur        As String
Public Gtxttipval           As String
Public Gtxtnumval           As String
Public Gtxtporpar           As String
Public Gtxtvaluninom        As String
Public Gtxttipacc           As String
Public Gtxtfeccie           As String
Public Gtxtlugdepcus        As String
Public Gtxtfecpre           As String


'indicadores campo filas en plomo
Public BGtxtpaires As Boolean
Public BGtxtfecnac As Boolean
Public BGtxtnac As Boolean
Public BGtxtdom As Boolean
Public BGtxtrelcon As Boolean
Public BGtxttel              As Boolean
Public BGtxtcorele           As Boolean
Public BGtxtestciv           As Boolean
Public BGtxtnrodoccon        As Boolean
Public BGtxtregpatcon        As Boolean
Public BGtxttippro           As Boolean
Public BGtxtrelparconman     As Boolean
Public BGtxttipdoctit        As Boolean
Public BGtxtnumdoctit        As Boolean
Public BGtxttipcon           As Boolean
Public BGtxtdestipcon        As Boolean
Public BGtxtcomentjur        As Boolean
Public BGtxttipval           As Boolean
Public BGtxtnumval           As Boolean
Public BGtxtporpar           As Boolean
Public BGtxtvaluninom        As Boolean
Public BGtxttipacc           As Boolean
Public BGtxtfeccie           As Boolean
Public BGtxtlugdepcus        As Boolean
Public BGtxtfecpre           As Boolean

'indicadores si hay algun valor en la fila Beneficiarios
Public BhayDataEnFila As Boolean
Public ShayDataEnFila As String

'valor de ayuda paises si es llamado de Formulario
Public valPaisForm As String

'para validar si hay filas vacias entre filas
Public BhayFilasVacias As Boolean
Public GFilasVacias As String
Public GCantidadFilasValidar As Integer

'para mensaje de errores
Public strMjsFinalError As String

'para zipeo
Public nameArchZIPtmp As String

'para encriptaci|fffd|n
Public GENCRIPTAindicador As Boolean

'para mostrar mensaje final
Public GNomArchDatGen, GNomArchBen As String

Public GSperiodo As String
Public GSmes As String
Attribute VB_Name = "M|fffd|dulo1"

Attribute VB_Name = "M|fffd|dulo2"

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
  
    'If bIsBookOpen("FV3800UtilitarioExcel.xlsm") = True Then
    '    MsgBox "EXCEL TRUE", vbExclamation, "EXCEL TRUE"
    'Else
    '    MsgBox "EXCEL FALSE", vbExclamation, "EXCEL FALSE"
    'End If
    
    
    Application.OnKey "{F4}", "MostrarParametro"
    Application.OnKey "{F10}", "MostrarFormulario"
    Application.OnKey "{F5}", "CancelF5"
    GSperiodo = "1"
    
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox1.Clear
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox1.AddItem "Persona Jur|fffd|dica"
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox1.AddItem "Ente Jur|fffd|dico"
        
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.Clear
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.AddItem ""
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.AddItem "Fondo de Inversi|fffd|n"
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.AddItem "Fideicomiso"
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.AddItem "Trust"
    ThisWorkbook.Sheets("DATOS GENERALES").ComboBox2.AddItem "Otros Entes Jur|fffd|dicos"
               
    strValTipEnt = ThisWorkbook.Sheets("DATOS GENERALES").ComboBox1.ListIndex
        
    
End Sub


Attribute VB_Name = "frmBeneficiarios"
Attribute VB_Base = "0{DDF19F79-176F-4919-BB05-290D3F4819E9}{1CDA129F-9190-42F6-A798-DDC8736D05E2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'para armar la informacion a grabar en el plano Beneficiarios
Private indRol          As Boolean
Private indRes          As Boolean
Private indTipDoc       As Boolean
Private indNumDoc       As Boolean
Private indNomApe       As Boolean
Private indPaiRes       As Boolean
Private indFecNac       As Boolean
Private indNac          As Boolean
Private indDom          As Boolean
Private indRelCon       As Boolean
Private indTel          As Boolean
Private indCorEle       As Boolean
Private indEstCiv       As Boolean
Private indDniCon       As Boolean
Private indRegPatCon    As Boolean
Private indTipPro       As Boolean
Private indRelParConMan As Boolean
Private indTipDocTit    As Boolean
Private indNumDocTit    As Boolean
Private indTipCon       As Boolean
Private indDesTipCon    As Boolean
Private indComEntJur    As Boolean
Private indTipVal       As Boolean
Private indNumVal       As Boolean
Private indPorPar       As Boolean
Private indValUniNom    As Boolean
Private indTipAcc       As Boolean
Private indFecCie       As Boolean
Private indLugDepCus    As Boolean
Private indFecPre       As Boolean




Private Sub cmbrol_Change()
    Valida_Combos_Change
End Sub

Private Sub cmbres_Change()
    Valida_Combos_Change
End Sub

Private Sub cmbestciv_Change()
    Valida_Combos_Change
End Sub

Private Sub cmbtippro_Change()
    Change_RelParConMan
End Sub
Private Sub cmbrelparconman_Change()
    Change_DocTit
End Sub



Private Sub Change_RelParConMan()
    Dim tippro As String
   
    tippro = cmbtippro.Text
   
    If Mid(tippro, 1, 2) = "02" Then
        cmbrelparconman.Enabled = True
        cmbrelparconman.Clear
        cmbrelparconman.AddItem "01" & " | " & "Padre"
        cmbrelparconman.AddItem "02" & " | " & "Madre"
        cmbrelparconman.AddItem "03" & " | " & "Hermano(a)"
        cmbrelparconman.AddItem "04" & " | " & "Abuelo(a)"
        cmbrelparconman.AddItem "05" & " | " & "Nieto(a)"
        cmbrelparconman.AddItem "06" & " | " & "Padres Del C|fffd|nyuge"
        cmbrelparconman.AddItem "07" & " | " & "Hijos Del C|fffd|nyuge"
        cmbrelparconman.AddItem "08" & " | " & "Pareja De Uni|fffd|n De Hecho"
        cmbrelparconman.AddItem "09" & " | " & "Titular"
        indRelParConMan = True
        cmbtipdoctit.ListIndex = -1
        txtnumdoctit.Text = ""
    Else
        If Mid(tippro, 1, 2) = "04" Then
            cmbrelparconman.Enabled = True
            cmbrelparconman.Clear
            cmbrelparconman.AddItem "09" & " | " & "Titular"
            cmbrelparconman.AddItem "10" & " | " & "Mandatario"
            indRelParConMan = True
            cmbtipdoctit.ListIndex = -1
            txtnumdoctit.Text = ""
        Else
            If Mid(tippro, 1, 2) = "01" Or Mid(tippro, 1, 2) = "03" Then
                cmbrelparconman.Clear
                cmbrelparconman.Enabled = False
                cmbtipdoctit.Clear
                cmbtipdoctit.Enabled = False
                txtnumdoctit.Text = ""
                txtnumdoctit.BackColor = RGB(192, 192, 192)
                indRelParConMan = False
                indTipDocTit = False
                indNumDocTit = False
            End If
        End If
    End If
    
End Sub



Private Sub Change_DocTit()
    Dim relparconman As String
   
    relparconman = cmbrelparconman.Text
   
    If Mid(relparconman, 1, 2) = "01" Or Mid(relparconman, 1, 2) = "02" Or Mid(relparconman, 1, 2) = "03" Or _
       Mid(relparconman, 1, 2) = "04" Or Mid(relparconman, 1, 2) = "05" Or Mid(relparconman, 1, 2) = "06" Or _
       Mid(relparconman, 1, 2) = "07" Or Mid(relparconman, 1, 2) = "08" Or Mid(relparconman, 1, 2) = "10" Then
        cmbtipdoctit.Enabled = True
        cmbtipdoctit.Clear
        cmbtipdoctit.AddItem "01" & " | " & "DNI"
        cmbtipdoctit.AddItem "04" & " | " & "Carnet de Extranjer|fffd|a"
        cmbtipdoctit.AddItem "06" & " | " & "RUC"
        cmbtipdoctit.AddItem "07" & " | " & "Pasaporte"
        cmbtipdoctit.AddItem "08" & " | " & "TIN"
        cmbtipdoctit.AddItem "09" & " | " & "ID"
        txtnumdoctit.Text = ""
        txtnumdoctit.BackColor = RGB(255, 255, 255)
        indTipDocTit = True
        indNumDocTit = True
    Else
        If Mid(relparconman, 1, 2) = "09" Then
            cmbtipdoctit.Clear
            cmbtipdoctit.Enabled = False
            txtnumdoctit.Text = ""
            txtnumdoctit.BackColor = RGB(192, 192, 192)
            indTipDocTit = False
            indNumDocTit = False
        End If
    End If
End Sub



Private Sub Valida_Combos_Change()
    
    Dim res As String
    Dim rol As String
    Dim estciv As String
    Dim tippro As String
    Dim relparcon As String
    
        
    res = cmbres.Text
    rol = cmbrol.Text
    estciv = cmbestciv.Text
    tippro = cmbtippro.Text
    relparcon = cmbrelparconman.Text

        
    If Mid(res, 1, 1) = "1" And Mid(rol, 1, 2) <> "" Then
        'pa|fffd|s
        txtpaires.BackColor = RGB(192, 192, 192)
        txtpaires.Text = ""
        indPaiRes = False
        'fecha de nacimiento
        txtfecnac.BackColor = RGB(255, 255, 255)
        indFecNac = True
        'nacionalidad
        txtnac.BackColor = RGB(255, 255, 255)
        indNac = True
        'domicilio
        txtdom.BackColor = RGB(255, 255, 255)
        indDom = True
        'relaci|fffd|n con PPJJ / Ente Jur|fffd|dico
        cmbrelconppjentjur.Enabled = True
        indRelCon = True
        'tel|fffd|fono
        txttel.BackColor = RGB(255, 255, 255)
        indTel = True
        'correo electr|fffd|nico
        txtcorele.BackColor = RGB(255, 255, 255)
        indCorEle = True
        'estado civil
        cmbestciv.Enabled = True
        indEstCiv = True
        'dni c|fffd|nyuge
        txtdnicon.BackColor = RGB(255, 255, 255)
        indDniCon = True
        'r|fffd|gimen patrimonial c|fffd|nyuge
        cmbregpatcon.Enabled = True
        indRegPatCon = True
        
        If Mid(estciv, 1, 2) <> "01" And Mid(estciv, 1, 2) <> "03" And Mid(estciv, 1, 2) <> "04" Then
            'dni c|fffd|nyuge
            txtdnicon.BackColor = RGB(255, 255, 255)
            indDniCon = True
            'r|fffd|gimen patrimonial c|fffd|nyuge
            cmbregpatcon.Enabled = True
            indRegPatCon = True
        Else
            'dni c|fffd|nyuge
            txtdnicon.BackColor = RGB(192, 192, 192)
            txtdnicon.Text = ""
            indDniCon = False
            'r|fffd|gimen patrimonial c|fffd|nyuge
            cmbregpatcon.Enabled = False
            cmbregpatcon.ListIndex = -1
            indRegPatCon = False
        End If
        
        If Mid(rol, 1, 2) = "02" Then
            'tipo de propiedad
            cmbtippro.Enabled = True
            indTipPro = True
            'relaci|fffd|n pariente c|fffd|nyuge mandatario
            cmbrelparconman.Enabled = True
            indRelParConMan = True
            'tipo documento titular
            cmbtipdoctit.Enabled = True
            indTipDocTit = True
            'n|fffd|mero documento titular
            txtnumdoctit.BackColor = RGB(255, 255, 255)
            indNumDocTit = True
            
            If Mid(tippro, 1, 2) = "01" Or Mid(tippro, 1, 2) = "03" Then
                'relaci|fffd|n pariente c|fffd|nyuge mandatario
                cmbrelparconman.Enabled = False
                cmbrelparconman.ListIndex = -1
                indRelParConMan = False
                'tipo documento titular
                cmbtipdoctit.Enabled = False
                cmbtipdoctit.ListIndex = -1
                indTipDocTit = False
                'n|fffd|mero documento titular
                txtnumdoctit.BackColor = RGB(192, 192, 192)
                indNumDocTit = False
            Else
                If Mid(tippro, 1, 2) = "02" Or Mid(tippro, 1, 2) = "04" Then
                    If Mid(relparcon, 1, 2) <> "09" Then
                        'tipo documento titular
                        cmbtipdoctit.Enabled = True
                        indTipDocTit = True
                        'n|fffd|mero documento titular
                        txtnumdoctit.BackColor = RGB(255, 255, 255)
                        indNumDocTit = True
                    Else
                        'tipo documento titular
                        cmbtipdoctit.Enabled = False
                        cmbtipdoctit.ListIndex = -1
                        indTipDocTit = False
                        'n|fffd|mero documento titular
                        txtnumdoctit.BackColor = RGB(192, 192, 192)
                        txtnumdoctit.Text = ""
                        indNumDocTit = False
                    End If
                End If
            End If
                
        Else
            'tipo de propiedad
            cmbtippro.Enabled = False
            cmbtippro.ListIndex = -1
            indTipPro = False
            'relaci|fffd|n pariente c|fffd|nyuge mandatario
            cmbrelparconman.Enabled = False
            cmbrelparconman.ListIndex = -1
            indRelParConMan = False
            'tipo documento titular
            cmbtipdoctit.Enabled = False
            cmbtipdoctit.ListIndex = -1
            indTipDocTit = False
            'n|fffd|mero documento titular
            txtnumdoctit.BackColor = RGB(192, 192, 192)
            txtnumdoctit.Text = ""
            indNumDocTit = False
        End If
        
        If Mid(rol, 1, 2) = "03" Then
            'tipo de control
            cmbtipcon.Enabled = True
            indTipCon = True
            'descripci|fffd|n tipo de control
            txtdestipcon.BackColor = RGB(255, 255, 255)
            indDesTipCon = True
        Else
            'tipo de control
            cmbtipcon.Enabled = False
            cmbtipcon.ListIndex = -1
            indTipCon = False
            'descripci|fffd|n tipo de control
            txtdestipcon.BackColor = RGB(192, 192, 192)
            txtdestipcon.Text = ""
            indDesTipCon = False
        End If
            
        If Mid(rol, 1, 2) = "05" Then
            'componente ente jur|fffd|dico
            cmbcomentjur.Enabled = True
            indComEntJur = True
        Else
            'componente ente jur|fffd|dico
            cmbcomentjur.Enabled = False
            cmbcomentjur.ListIndex = -1
            indComEntJur = False
        End If
        
        If Mid(rol, 1, 2) = "02" Or Mid(rol, 1, 2) = "03" Or Mid(rol, 1, 2) = "04" Or Mid(rol, 1, 2) = "05" Then
            'tipo valor
            cmbtipval.Enabled = True
            indTipVal = True
            'n|fffd|mero de valores
            txtnumval.BackColor = RGB(255, 255, 255)
            indNumVal = True
            'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
            txtporpar.BackColor = RGB(255, 255, 255)
            indPorPar = True
            'valor unitario nominal
            txtvaluninom.BackColor = RGB(255, 255, 255)
            indValUniNom = True
            'tipo de acciones
            txttipacc.BackColor = RGB(255, 255, 255)
            indTipAcc = True
            'fecha cierta
            txtfeccie.BackColor = RGB(255, 255, 255)
            indFecCie = True
            'lugar de dep|fffd|sito o custodia
            txtlugdepcus.BackColor = RGB(255, 255, 255)
            indLugDepCus = True
            'Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
            txtfecpre.BackColor = RGB(255, 255, 255)
            indFecPre = True
        Else
            'r|fffd|gimen patrimonial c|fffd|nyuge
            cmbregpatcon.Enabled = False
            cmbregpatcon.ListIndex = -1
            indRegPatCon = False
            'tipo valor
            cmbtipval.Enabled = False
            cmbtipval.ListIndex = -1
            indTipVal = False
            'n|fffd|mero de valores
            txtnumval.BackColor = RGB(192, 192, 192)
            txtnumval.Text = ""
            indNumVal = False
            'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
            txtporpar.BackColor = RGB(192, 192, 192)
            txtporpar.Text = ""
            indPorPar = False
            'valor unitario nominal
            txtvaluninom.BackColor = RGB(192, 192, 192)
            txtvaluninom.Text = ""
            indValUniNom = False
            'tipo de acciones
            txttipacc.BackColor = RGB(192, 192, 192)
            txttipacc.Text = ""
            indTipAcc = False
            'fecha cierta
            txtfeccie.BackColor = RGB(192, 192, 192)
            txtfeccie.Text = ""
            indFecCie = False
            'lugar de dep|fffd|sito o custodia
            txtlugdepcus.BackColor = RGB(192, 192, 192)
            txtlugdepcus.Text = ""
            indLugDepCus = False
            'Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
            txtfecpre.BackColor = RGB(192, 192, 192)
            txtfecpre.Text = ""
            indFecPre = False
        End If
    Else
        If Mid(res, 1, 1) = "0" And Mid(rol, 1, 2) <> "" Then
            'pais
            txtpaires.BackColor = RGB(255, 255, 255)
            indPaiRes = True
            'fecha de nacimiento
            txtfecnac.BackColor = RGB(255, 255, 255)
            indFecNac = True
            'nacionalidad
            txtnac.BackColor = RGB(255, 255, 255)
            indNac = True
            'domicilio
            txtdom.BackColor = RGB(255, 255, 255)
            indDom = True
            'relaci|fffd|n con PPJJ / Ente Jur|fffd|dico
            cmbrelconppjentjur.Enabled = True
            indRelCon = True
            'tel|fffd|fono
            txttel.BackColor = RGB(255, 255, 255)
            indTel = True
            'correo electr|fffd|nico
            txtcorele.BackColor = RGB(255, 255, 255)
            indCorEle = True
            'estado civil
            cmbestciv.Enabled = True
            indEstCiv = True
            'dni c|fffd|nyuge
            txtdnicon.BackColor = RGB(255, 255, 255)
            indDniCon = True
            'r|fffd|gimen patrimonial c|fffd|nyuge
            cmbregpatcon.Enabled = True
            indRegPatCon = True
            
            If Mid(estciv, 1, 2) <> "01" And Mid(estciv, 1, 2) <> "03" And Mid(estciv, 1, 2) <> "04" Then
                'dni c|fffd|nyuge
                txtdnicon.BackColor = RGB(255, 255, 255)
                indDniCon = True
                'r|fffd|gimen patrimonial c|fffd|nyuge
                cmbregpatcon.Enabled = True
                indRegPatCon = True
            Else
                'dni c|fffd|nyuge
                txtdnicon.BackColor = RGB(192, 192, 192)
                txtdnicon.Text = ""
                indDniCon = False
                'r|fffd|gimen patrimonial c|fffd|nyuge
                cmbregpatcon.Enabled = False
                cmbregpatcon.ListIndex = -1
                indRegPatCon = False
            End If
            
            If Mid(rol, 1, 2) = "02" Then
                'tipo de propiedad
                cmbtippro.Enabled = True
                indTipPro = True
                'relaci|fffd|n pariente c|fffd|nyuge mandatario
                cmbrelparconman.Enabled = True
                indRelParConMan = True
                'tipo documento titular
                cmbtipdoctit.Enabled = True
                indTipDocTit = True
                'n|fffd|mero documento titular
                txtnumdoctit.BackColor = RGB(255, 255, 255)
                indNumDocTit = True
            
                If Mid(tippro, 1, 2) = "01" Or Mid(tippro, 1, 2) = "03" Then
                    'relaci|fffd|n pariente c|fffd|nyuge mandatario
                    cmbrelparconman.Enabled = False
                    cmbrelparconman.ListIndex = -1
                    indRelParConMan = False
                    'tipo documento titular
                    cmbtipdoctit.Enabled = False
                    cmbtipdoctit.ListIndex = -1
                    indTipDocTit = False
                    'n|fffd|mero documento titular
                    txtnumdoctit.BackColor = RGB(192, 192, 192)
                    indNumDocTit = False
                Else
                    If Mid(tippro, 1, 2) = "02" Or Mid(tippro, 1, 2) = "04" Then
                        If Mid(relparcon, 1, 2) <> "09" Then
                            'tipo documento titular
                            cmbtipdoctit.Enabled = True
                            indTipDocTit = True
                            'n|fffd|mero documento titular
                            txtnumdoctit.BackColor = RGB(255, 255, 255)
                            indNumDocTit = True
                        Else
                            'tipo documento titular
                            cmbtipdoctit.Enabled = False
                            cmbtipdoctit.ListIndex = -1
                            indTipDocTit = False
                            'n|fffd|mero documento titular
                            txtnumdoctit.BackColor = RGB(192, 192, 192)
                            txtnumdoctit.Text = ""
                            indNumDocTit = False
                        End If
                    End If
                End If
            Else
                'tipo de propiedad
                cmbtippro.Enabled = False
                cmbtippro.ListIndex = -1
                indTipPro = False
                'relaci|fffd|n pariente c|fffd|nyuge mandatario
                cmbrelparconman.Enabled = False
                cmbrelparconman.ListIndex = -1
                indRelParConMan = False
                'tipo documento titular
                cmbtipdoctit.Enabled = False
                cmbtipdoctit.ListIndex = -1
                indTipDocTit = False
                'n|fffd|mero documento titular
                txtnumdoctit.BackColor = RGB(192, 192, 192)
                txtnumdoctit.Text = ""
                indNumDocTit = False
            End If
            
            If Mid(rol, 1, 2) = "03" Then
                'tipo de control
                cmbtipcon.Enabled = True
                indTipCon = True
                'descripci|fffd|n tipo de control
                txtdestipcon.BackColor = RGB(255, 255, 255)
                indDesTipCon = True
            Else
                'tipo de control
                cmbtipcon.Enabled = False
                cmbtipcon.ListIndex = -1
                indTipCon = False
                'descripci|fffd|n tipo de control
                txtdestipcon.BackColor = RGB(192, 192, 192)
                txtdestipcon.Text = ""
                indDesTipCon = False
            End If
            
            If Mid(rol, 1, 2) = "05" Then
                'componente ente jur|fffd|dico
                cmbcomentjur.Enabled = True
                indComEntJur = True
            Else
                'componente ente jur|fffd|dico
                cmbcomentjur.Enabled = False
                cmbcomentjur.ListIndex = -1
                indComEntJur = False
            End If
            
            If Mid(rol, 1, 2) = "02" Or Mid(rol, 1, 2) = "03" Or Mid(rol, 1, 2) = "04" Or Mid(rol, 1, 2) = "05" Then
                'tipo valor
                cmbtipval.Enabled = True
                indTipVal = True
                'n|fffd|mero de valores
                txtnumval.BackColor = RGB(255, 255, 255)
                indNumVal = True
                'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
                txtporpar.BackColor = RGB(255, 255, 255)
                indPorPar = True
                'valor unitario nominal
                txtvaluninom.BackColor = RGB(255, 255, 255)
                indValUniNom = True
                'tipo de acciones
                txttipacc.BackColor = RGB(255, 255, 255)
                indTipAcc = True
                'fecha cierta
                txtfeccie.BackColor = RGB(255, 255, 255)
                indFecCie = True
                'lugar de dep|fffd|sito o custodia
                txtlugdepcus.BackColor = RGB(255, 255, 255)
                indLugDepCus = True
                'fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
                txtfecpre.BackColor = RGB(255, 255, 255)
                indFecPre = True
            Else
                'r|fffd|gimen patrimonial c|fffd|nyuge
                cmbregpatcon.Enabled = False
                cmbregpatcon.ListIndex = -1
                indRegPatCon = False
                'tipo valor
                cmbtipval.Enabled = False
                cmbtipval.ListIndex = -1
                indTipVal = False
                'n|fffd|mero de valores
                txtnumval.BackColor = RGB(192, 192, 192)
                txtnumval.Text = ""
                indNumVal = False
                'porcentaje de participaci|fffd|n pj ente jur|fffd|dico
                txtporpar.BackColor = RGB(192, 192, 192)
                txtporpar.Text = ""
                indPorPar = False
                'valor unitario nominal
                txtvaluninom.BackColor = RGB(192, 192, 192)
                txtvaluninom.Text = ""
                indValUniNom = False
                'tipo de acciones
                txttipacc.BackColor = RGB(192, 192, 192)
                txttipacc.Text = ""
                indTipAcc = False
                'fecha cierta
                txtfeccie.BackColor = RGB(192, 192, 192)
                txtfeccie.Text = ""
                indFecCie = False
                'lugar de dep|fffd|sito o custodia
                txtlugdepcus.BackColor = RGB(192, 192, 192)
                txtlugdepcus.Text = ""
                indLugDepCus = False
                'fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n
                txtfecpre.BackColor = RGB(192, 192, 192)
                txtfecpre.Text = ""
                indFecPre = False
            End If
        End If
    End If
    
End Sub


Private Sub cmdAceptar_Click()
    Dim strRpta As String
    Dim TMPstrValTipEnt As String
    Dim intporpar As Integer
    Dim fechaNac As Date
                
    'VALIDANDO VALORES DEL FORMULARIO
    
    If Trim(cmbrol.Text) = "" Then
        MsgBox "Debe de escoger un Rol", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    If Trim(cmbres.Text) = "" Then
        MsgBox "Debe de escoger si Es Residente o no", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
        
    If Trim(cmbtipdoc.Text) = "" Then
        MsgBox "Debe de escoger un Tipo de Documento", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    If (Mid(cmbres.Text, 1, 1) = "0" And (Mid(cmbtipdoc, 1, 2) = "08" Or Mid(cmbtipdoc, 1, 2) = "09")) Or _
        (Mid(cmbres.Text, 1, 1) = "1" And (Mid(cmbtipdoc, 1, 2) = "01" Or Mid(cmbtipdoc, 1, 2) = "04" Or Mid(cmbtipdoc, 1, 2) = "06" Or Mid(cmbtipdoc, 1, 2) = "07")) Then
        'OK
    Else
        MsgBox "Debe escoger Tipo de Documento 01, 04, 06, 07 si Tipo de Residente es 1 (Es Residente) o escoger Tipo de Documento 08, 09 si Tipo de Residente es 0 (No es Residente)", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    txtnumdoc.Text = Trim(txtnumdoc.Text)
    If txtnumdoc.Text = "" Then
        MsgBox "Debe de ingresar un N|fffd|mero de Documento", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    Else
        If Mid(cmbtipdoc.Text, 1, 2) = "01" Then
            If Len(txtnumdoc.Text) <> 8 Then
                MsgBox "DNI debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If IsNumeric(txtnumdoc.Text) Then
                    'OK
                    If validaNumeroPuro(txtnumdoc.Text) = False Then
                        MsgBox "DNI debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    End If
                Else
                    MsgBox "DNI debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
        If Mid(cmbtipdoc.Text, 1, 2) = "04" Then
            If Len(txtnumdoc.Text) > 12 Then
                MsgBox "Carnet de Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If validaLetraNumeroGuion(txtnumdoc.Text) = False Then
                    MsgBox "Ingrese un Carnet de Extranjer|fffd|a v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
        If Mid(cmbtipdoc.Text, 1, 2) = "06" Then
            TMPstrValTipEnt = strValTipEnt
            strValTipEnt = ""
            strRpta = fValidaRUC(txtnumdoc.Text)
            If strRpta <> "" Then
                strValTipEnt = TMPstrValTipEn
                MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
            strValTipEnt = TMPstrValTipEn
        End If
        If Mid(cmbtipdoc.Text, 1, 2) = "07" Then
            If Len(txtnumdoc.Text) > 12 Then
                MsgBox "Pasaporte no debe tener m|fffd|s de 12 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If validaLetraNumeroGuion(txtnumdoc.Text) = False Then
                    MsgBox "Ingrese un Pasaporte v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
        If Mid(cmbtipdoc.Text, 1, 2) = "08" Then
            If Len(txtnumdoc.Text) > 30 Then
                MsgBox "TIN no debe tener m|fffd|s de 30 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If validaLetraNumeroGuion(txtnumdoc.Text) = False Then
                    MsgBox "Ingrese un TIN v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
        If Mid(cmbtipdoc.Text, 1, 2) = "09" Then
            If Len(txtnumdoc.Text) > 30 Then
                MsgBox "ID no debe tener m|fffd|s de 30 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If validaLetraNumeroGuion(txtnumdoc.Text) = False Then
                    MsgBox "Ingrese un ID v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
    End If
    
    txtnomape.Text = Trim(txtnomape.Text)
    If txtnomape.Text = "" Then
        MsgBox "Debe de ingresar Nombre y Apellido", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    Else
        If Len(txtnomape.Text) > 150 Then
            MsgBox "Nombres y Apellidos no debe tener m|fffd|s de 150 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    End If
    
    txtpaires.Text = Trim(txtpaires.Text)
    If indPaiRes = True Then
        TMPstrValTipEnt = strValTipEnt
        strValTipEnt = "2"
        txtpaires.Text = UCase(txtpaires.Text)
        strRpta = fValidaPais(txtpaires.Text)
        If strRpta <> "" Then
            MsgBox "Debe de ingresar un Pa|fffd|s de Residencia v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
            strValTipEnt = TMPstrValTipEnt
            Exit Sub
        Else
            strValTipEnt = TMPstrValTipEnt
        End If
    Else
        txtpaires.Text = ""
    End If
    
    txtfecnac.Text = Trim(txtfecnac.Text)
    If indFecNac = True Then
        If txtfecnac.Text = "" And indFecNac = True Then
            MsgBox "Debe de ingresar Fecha de Nacimiento", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        Else
            If fValidarFecha(txtfecnac.Text) <> "" Then
                MsgBox "Debe de ingresar Fecha de Nacimiento v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                fechaNac = CDate(txtfecnac.Text)
                If fechaNac >= Date Then
                    MsgBox "Debe de ingresar Fecha de Nacimiento v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
    Else
        txtfecnac.Text = ""
    End If
    
    txtnac.Text = Trim(txtnac.Text)
    If indNac = True Then
        TMPstrValTipEnt = strValTipEnt
        strValTipEnt = "2"
        txtnac.Text = UCase(txtnac.Text)
        strRpta = fValidaPais(txtnac.Text)
        If strRpta <> "" Then
            MsgBox "Debe de ingresar una Nacionalidad v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
            strValTipEnt = TMPstrValTipEnt
            Exit Sub
        Else
            strValTipEnt = TMPstrValTipEnt
        End If
    Else
        txtnac.Text = ""
    End If
    
    txtdom.Text = Trim(txtdom.Text)
    If txtdom.Text = "" And indDom = True Then
        MsgBox "Debe de ingresar Domicilio", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
        If Len(txtdom.Text) > 150 Then
            MsgBox "Domicilio no debe tener m|fffd|s de 150 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    End If
    
    If indRelCon = True And cmbrelconppjentjur.Text = "" Then
        MsgBox "Debe de escoger una Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    txttel.Text = Trim(txttel.Text)
    If indTel = True Then
        If txttel.Text <> "" Then
            If validaNumeroPuro(txttel.Text) = False Then
                MsgBox "Debe de ingresar Tel|fffd|fono v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If Len(txttel.Text) > 30 Then
                    MsgBox "Tel|fffd|fono no puede tener m|fffd|s de 30 n|fffd|meros", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        Else
            MsgBox "Debe de ingresar Tel|fffd|fono", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    Else
        txttel.Text = ""
    End If
    
    txtcorele.Text = Trim(txtcorele.Text)
    If indCorEle = True Then
        If txtcorele.Text <> "" Then
            If fValidaMail(txtcorele.Text) <> "" Then
                MsgBox "Debe de ingresar Correo Electr|fffd|nico v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        Else
            MsgBox "Debe de ingresar Correo Electr|fffd|nico", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    Else
        txtcorele.Text = ""
    End If
    
    If indEstCiv = True And cmbestciv.Text = "" Then
        MsgBox "Debe de escoger Estado Civil", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    txtdnicon.Text = Trim(txtdnicon.Text)
    If indDniCon = True Then
        If Len(txtdnicon.Text) <> 8 Then
            MsgBox "DNI C|fffd|nyuge debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        Else
            If IsNumeric(txtdnicon.Text) Then
                'OK
                If validaNumeroPuro(txtdnicon.Text) = False Then
                    MsgBox "DNI C|fffd|nyuge debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            Else
                MsgBox "DNI C|fffd|nyuge debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        End If
    Else
        txtdnicon.Text = ""
    End If
       
    
    If indRegPatCon = True Then
        If cmbregpatcon.Text = "" Then
            MsgBox "Debe de escoger R|fffd|gimen Patrimonial C|fffd|nyuge", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        Else
            If Mid(cmbestciv, 1, 2) = "02" And (Mid(cmbregpatcon.Text, 1, 2) = "01" Or Mid(cmbregpatcon.Text, 1, 2) = "02") Then
                'OK
            Else
                If Mid(cmbestciv, 1, 2) = "05" And Mid(cmbregpatcon.Text, 1, 2) = "03" Then
                    'OK
                Else
                    MsgBox "Debe de escoger R|fffd|gimen Patrimonial C|fffd|nyuge v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
    End If
    
    If indTipPro = True And cmbtippro.Text = "" Then
        MsgBox "Debe de escoger Tipo de Propiedad", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    If indRelParConMan = True And cmbrelparconman = "" Then
        MsgBox "Debe de escoger Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
   
    If indTipDocTit = True Then
        If Trim(cmbtipdoctit.Text) = "" Then
            MsgBox "Debe de escoger un Tipo Documento Titular", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    
        txtnumdoctit.Text = Trim(txtnumdoctit.Text)
        If txtnumdoctit.Text = "" Then
            MsgBox "Debe de ingresar un N|fffd|mero Documento Titular", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        Else
            If Mid(cmbtipdoctit.Text, 1, 2) = "01" Then
                If Len(txtnumdoctit.Text) <> 8 Then
                    MsgBox "N|fffd|mero Documento Titular - DNI debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If IsNumeric(txtnumdoctit.Text) Then
                        'OK
                        If validaNumeroPuro(txtnumdoctit.Text) = False Then
                            MsgBox "N|fffd|mero Documento Titular - DNI debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                            Exit Sub
                        End If
                    Else
                        MsgBox "N|fffd|mero Documento Titular - DNI debe tener 8 d|fffd|gitos", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    End If
                End If
            End If
            If Mid(cmbtipdoctit.Text, 1, 2) = "04" Then
                If Len(txtnumdoctit.Text) > 12 Then
                    MsgBox "N|fffd|mero Documento Titular - Carnet de Extranjer|fffd|a no debe tener m|fffd|s de 12 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If validaLetraNumeroGuion(txtnumdoctit.Text) = False Then
                        MsgBox "N|fffd|mero Documento Titular - Ingrese un Carnet de Extranjer|fffd|a v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    End If
                End If
            End If
            If Mid(cmbtipdoctit.Text, 1, 2) = "06" Then
                TMPstrValTipEnt = strValTipEnt
                strValTipEnt = ""
                strRpta = fValidaRUC(txtnumdoctit.Text)
                If strRpta <> "" Then
                    strValTipEnt = TMPstrValTipEn
                    strRpta = "N|fffd|mero Documento Titular - " + strRpta
                    MsgBox strRpta, vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
                strValTipEnt = TMPstrValTipEn
            End If
            If Mid(cmbtipdoctit.Text, 1, 2) = "07" Then
                If Len(txtnumdoctit.Text) > 12 Then
                    MsgBox "N|fffd|mero Documento Titular - Pasaporte no debe tener m|fffd|s de 12 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If validaLetraNumeroGuion(txtnumdoctit.Text) = False Then
                        MsgBox "N|fffd|mero Documento Titular - Ingrese un Pasaporte v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    End If
                End If
            End If
            If Mid(cmbtipdoctit.Text, 1, 2) = "08" Then
                If Len(txtnumdoctit.Text) > 30 Then
                    MsgBox "N|fffd|mero Documento Titular - TIN no debe tener m|fffd|s de 30 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If validaLetraNumeroGuion(txtnumdoctit.Text) = False Then
                        MsgBox "N|fffd|mero Documento Titular - Ingrese un TIN v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    End If
                End If
            End If
            If Mid(cmbtipdoctit.Text, 1, 2) = "09" Then
                If Len(txtnumdoctit.Text) > 30 Then
                    MsgBox "N|fffd|mero Documento Titular - ID no debe tener m|fffd|s de 30 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If validaLetraNumeroGuion(txtnumdoctit.Text) = False Then
                        MsgBox "N|fffd|mero Documento Titular - Ingrese un ID v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    End If
                End If
            End If
        End If
    Else
        If indNumDocTit = False Then
            txtnumdoctit.Text = ""
        End If
    End If
    
    
    If indTipCon = True And cmbtipcon.Text = "" Then
        MsgBox "Debe de escoger Tipo de Control", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If

    
    txtdestipcon.Text = Trim(txtdestipcon.Text)
    If indDesTipCon = True Then
        If txtdestipcon.Text <> "" Then
            If Len(txtdestipcon.Text) > 150 Then
                MsgBox "Descripci|fffd|n del Tipo Control no puede tener m|fffd|s de 30 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        Else
            MsgBox "Debe de ingresar Descripci|fffd|n del Tipo Control", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    Else
        txtdestipcon.Text = ""
    End If
        
    If indComEntJur = True And cmbcomentjur.Text = "" Then
        MsgBox "Debe de escoger Componente Ente Jur|fffd|dico", vbOKOnly, "Mensaje de Validaci|fffd|n"
        Exit Sub
    End If
    
    If indTipVal = True Then
        If ((Mid(cmbrol, 1, 2) = "02" Or Mid(cmbrol, 1, 2) = "03") And cmbtipval.Text <> "") Or (Mid(cmbrol, 1, 2) = "04" Or Mid(cmbrol, 1, 2) = "05") Then
            'OK
        Else
            MsgBox "Debe de escoger Tipo Valor", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        End If
    End If
    
    txtnumval.Text = Trim(txtnumval.Text)
    If indNumVal = True Then
        If (Mid(cmbrol, 1, 2) = "04" Or Mid(cmbrol, 1, 2) = "05") And Gtxtnumval = "" Then
            'OK
        Else
            If IsNumeric(txtnumval.Text) Then
                If validaNumeroPunto(txtnumval.Text) = False Then
                    MsgBox "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If validaSolo3Decimales(txtnumval.Text) = False Then
                        MsgBox "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    Else
                        If Val(txtnumval.Text) > 0 And Val(txtnumval.Text) < 10000000000# Then
                            'OK
                        Else
                            MsgBox "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                            Exit Sub
                        End If
                    End If
                End If
            Else
                MsgBox "Debe ingresar N|fffd|mero de Valores v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        End If
    Else
        txtnumval.Text = ""
    End If
    
        
    txtporpar.Text = Trim(txtporpar.Text)
    If indPorPar = True Then
        If Mid(cmbrol, 1, 2) = "04" And txtporpar.Text = "" Then
            'OK
        Else
            If IsNumeric(txtporpar.Text) Then
                If Mid(cmbrol, 1, 2) = "04" Or Mid(cmbrol, 1, 2) = "05" Then
                    If validaNumeroPunto(txtporpar.Text) = False Then
                        MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    Else
                        If validaSolo3Decimales(txtporpar.Text) = False Then
                            MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=0 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Else
                            If Val(txtporpar.Text) >= 0 And Val(txtporpar.Text) <= 100 Then
                                'OK
                            Else
                                MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico (>=0 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                                Exit Sub
                            End If
                        End If
                    End If
                Else
                    If Mid(cmbrol, 1, 2) = "02" And Mid(cmbtippro.Text, 1, 2) = "01" Then
                        If validaNumeroPunto(txtporpar.Text) = False Then
                            MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                            Exit Sub
                        Else
                            If validaSolo3Decimales(txtporpar.Text) = False Then
                                MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                                Exit Sub
                            Else
                                If Val(txtporpar.Text) >= 1 And Val(txtporpar.Text) <= 100 Then
                                    'OK
                                Else
                                    MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido (>=1 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                                    Exit Sub
                                End If
                            End If
                        End If
                    Else
                        If ((Mid(cmbrol, 1, 2) = "02") And (Mid(cmbtippro, 1, 2) = "02" Or Mid(cmbtippro, 1, 2) = "03" Or Mid(cmbtippro, 1, 2) = "04")) Or _
                        ((Mid(cmbrol, 1, 2) = "03") And (Mid(cmbtipcon, 1, 2) = "01" Or Mid(cmbtipcon, 1, 2) = "02" Or Mid(cmbtipcon, 1, 2) = "03" Or Mid(cmbtipcon, 1, 2) = "04")) Then
                            If validaNumeroPunto(txtporpar.Text) = False Then
                                MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico (>=0 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                                Exit Sub
                            Else
                                If validaSolo3Decimales(txtporpar.Text) = False Then
                                    MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico (>=0 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                                    Exit Sub
                                Else
                                    If Val(txtporpar.Text) >= 0 And Val(txtporpar.Text) <= 100 Then
                                        'OK
                                    Else
                                        MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico (>=0 y <=100) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                                        Exit Sub
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            Else
                MsgBox "Debe ingresar % Participaci|fffd|n PJ - Ente Jur|fffd|dico v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        End If
    Else
        txtporpar.Text = ""
    End If
    
    
    txtvaluninom.Text = Trim(txtvaluninom.Text)
    If indValUniNom = True Then
        If (Mid(cmbrol, 1, 2) = "03" Or Mid(cmbrol, 1, 2) = "04" Or Mid(cmbrol, 1, 2) = "05") And (txtvaluninom.Text = "") Then
            'OK
        Else
            If IsNumeric(txtvaluninom.Text) Then
                If validaNumeroPunto(txtvaluninom.Text) = False Then
                    MsgBox "Debe ingresar Valor unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                Else
                    If validaSolo3Decimales(txtvaluninom.Text) = False Then
                        MsgBox "Debe ingresar Valor unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                        Exit Sub
                    Else
                        If Val(txtvaluninom.Text) > 0 And Val(txtvaluninom.Text) < 10000000000# Then
                            'OK
                        Else
                            MsgBox "Debe ingresar Valor unitario Nominal v|fffd|lido (mayor a 0 y menor a 10000000000) y como m|fffd|ximo 3 decimales", vbOKOnly, "Mensaje de Validaci|fffd|n"
                            Exit Sub
                        End If
                    End If
                End If
            Else
                MsgBox "Debe ingresar Valor unitario Nominal v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        End If
    Else
        txtvaluninom.Text = ""
    End If
   
    
    txttipacc.Text = Trim(txttipacc.Text)
    If indTipAcc = True Then
        If (Mid(cmbrol, 1, 2) = "04" Or Mid(cmbrol, 1, 2) = "05") And (txttipacc.Text = "") Then
            'OK
        Else
            If (Mid(cmbrol, 1, 2) = "02" Or Mid(cmbrol, 1, 2) = "03") And txttipacc.Text = "" Then
                MsgBox "Debe ingresar Tipo de Acciones", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                If Len(txttipacc.Text) <= 30 Then
                    'OK
                Else
                    MsgBox "Tipo de Acciones no debe tener m|fffd|s de 30 caracteres", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
    Else
        txttipacc.Text = ""
    End If
    
            
    txtfeccie.Text = Trim(txtfeccie.Text)
    If indFecCie = True Then
        If fValidarFecha(txtfeccie.Text) <> "" Then
            MsgBox "Debe ingresar Fecha Cierta v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        Else
            fechaNac = CDate(txtfeccie.Text)
            If fechaNac >= Date Then
                MsgBox "Debe de ingresar Fecha Cierta v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        End If
    Else
        txtfeccie.Text = ""
    End If
    
    
    txtlugdepcus.Text = Trim(UCase(txtlugdepcus.Text))
    If indLugDepCus = True Then
        If (Mid(cmbrol, 1, 2) = "04" Or Mid(cmbrol, 1, 2) = "05") And txtlugdepcus.Text = "" Then
            'OK
        Else
            If txtlugdepcus.Text <> "" Then
                TMPstrValTipEnt = strValTipEnt
                strValTipEnt = "2"
                strRpta = fValidaPais(txtlugdepcus.Text)
                If strRpta <> "" Then
                    MsgBox "Debe ingresar Lugar de dep|fffd|sito o Custodia v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
                strValTipEnt = TMPstrValTipEnt
            Else
                MsgBox "Debe ingresar un Lugar de dep|fffd|sito o Custodia v|fffd|lido", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            End If
        End If
    Else
        txtlugdepcus.Text = ""
    End If
    
    
    txtfecpre.Text = Trim(txtfecpre.Text)
    If indFecPre = True Then
        If txtfecpre.Text = "" And indFecPre = True Then
            MsgBox "Debe de ingresar Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n", vbOKOnly, "Mensaje de Validaci|fffd|n"
            Exit Sub
        Else
            If fValidarFecha(txtfecpre.Text) <> "" Then
                MsgBox "Debe de ingresar Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
                Exit Sub
            Else
                fechaPre = CDate(txtfecpre.Text)
                If fechaPre > Date Then
                    MsgBox "Debe de ingresar Fecha de presentaci|fffd|n del formato o env|fffd|o de la comunicaci|fffd|n v|fffd|lida", vbOKOnly, "Mensaje de Validaci|fffd|n"
                    Exit Sub
                End If
            End If
        End If
    Else
        txtfecpre.Text = ""
    End If
    
    
    'FIN DE LAS VALIDACIONES

    
    'Si todo esta OK se devuelve valores del formulario a la hoja Beneficiarios

    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 3).Value = Mid(cmbrol.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 4).Value = Mid(cmbres.Text, 1, 1)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 5).Value = Mid(cmbtipdoc.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 6).Value = txtnumdoc.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 7).Value = txtnomape.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 8).Value = txtpaires.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 9).Value = txtfecnac.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 10).Value = txtnac.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 11).Value = txtdom.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 12).Value = Mid(cmbrelconppjentjur.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 13).Value = txttel.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 14).Value = txtcorele.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 15).Value = Mid(cmbestciv.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 16).Value = txtdnicon.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 17).Value = Mid(cmbregpatcon.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 18).Value = Mid(cmbtippro.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 19).Value = Mid(cmbrelparconman.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 20).Value = Mid(cmbtipdoctit.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 21).Value = txtnumdoctit.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 22).Value = Mid(cmbtipcon.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 23).Value = txtdestipcon.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 24).Value = Mid(cmbcomentjur.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 25).Value = Mid(cmbtipval.Text, 1, 2)
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 26).Value = txtnumval.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 27).Value = txtporpar.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 28).Value = txtvaluninom.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 29).Value = txttipacc.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 30).Value = txtfeccie.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 31).Value = txtlugdepcus.Text
    ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 32).Value = txtfecpre.Text
        
    
    'ThisWorkbook.Sheets("BENEFICIARIOS").Cells(filCallForm, 13).Value = Mid(txtrelcon.Text, 1, 2)
        
    cmdDioCancelar = False
    
    Unload Me
End Sub


Private Sub cmdcancelar_Click()

    cmdDioCancelar = True
    Unload Me
       
End Sub

Private Sub cmdlugdepcus_Click()
    If indLugDepCus = True Then
        ListadoAyuda = "AyudaPais7"
        frmListado.Show
        txtlugdepcus.Text = valPaisForm
    End If
End Sub

Private Sub cmdnacionalidad_Click()
    If indNac = True Then
        ListadoAyuda = "AyudaPais5"
        frmListado.Show
        txtnac.Text = valPaisForm
    End If
End Sub

Private Sub cmdpaires_Click()
    If indPaiRes = True Then
        ListadoAyuda = "AyudaPais3"
        frmListado.Show
        txtpaires.Text = valPaisForm
    End If
End Sub





Private Sub UserForm_Activate()
    
   
    'Llenando Valores de los Combo
    cmbrol.AddItem "01" & " | " & "Representante Legal"
    cmbrol.AddItem "02" & " | " & "Beneficiario Final de Propiedad"
    cmbrol.AddItem "03" & " | " & "Beneficiario Final de Control"
    cmbrol.AddItem "04" & " | " & "Beneficiario Final Administrativo Superior"
    cmbrol.AddItem "05" & " | " & "Ente Jur|fffd|dico"
        
    cmbres.AddItem "0" & " | " & "No es Residente"
    cmbres.AddItem "1" & " | " & "Es Residente"
    
    cmbtipdoc.AddItem "01" & " | " & "DNI"
    cmbtipdoc.AddItem "04" & " | " & "Carnet de Extranjer|fffd|a"
    cmbtipdoc.AddItem "06" & " | " & "RUC"
    cmbtipdoc.AddItem "07" & " | " & "Pasaporte"
    cmbtipdoc.AddItem "08" & " | " & "TIN"
    cmbtipdoc.AddItem "09" & " | " & "ID"
            
    cmbrelconppjentjur.AddItem "01" & " | " & "Director"
    cmbrelconppjentjur.AddItem "02" & " | " & "Director Ejecutivo"
    cmbrelconppjentjur.AddItem "03" & " | " & "Director General"
    cmbrelconppjentjur.AddItem "04" & " | " & "Director Gerente"
    cmbrelconppjentjur.AddItem "05" & " | " & "Gerente General"
    cmbrelconppjentjur.AddItem "06" & " | " & "Gerente"
    cmbrelconppjentjur.AddItem "07" & " | " & "Sub Gerente"
    cmbrelconppjentjur.AddItem "08" & " | " & "Gerente Financiero"
    cmbrelconppjentjur.AddItem "09" & " | " & "Gerente De Operaciones"
    cmbrelconppjentjur.AddItem "10" & " | " & "Gerente Titular"
    cmbrelconppjentjur.AddItem "11" & " | " & "Gerente Ejecutivo"
    cmbrelconppjentjur.AddItem "12" & " | " & "Gerente De Ventas"
    cmbrelconppjentjur.AddItem "13" & " | " & "Gerente Comercial"
    cmbrelconppjentjur.AddItem "14" & " | " & "Gerente Adjunto"
    cmbrelconppjentjur.AddItem "15" & " | " & "Gerente De Comercializaci|fffd|n"
    cmbrelconppjentjur.AddItem "16" & " | " & "Gerente T|fffd|cnico"
    cmbrelconppjentjur.AddItem "17" & " | " & "Gerente De Finanzas"
    cmbrelconppjentjur.AddItem "18" & " | " & "Gerente Administrativo"
    cmbrelconppjentjur.AddItem "19" & " | " & "Asesor"
    cmbrelconppjentjur.AddItem "20" & " | " & "Gestor"
    cmbrelconppjentjur.AddItem "21" & " | " & "Presidente"
    cmbrelconppjentjur.AddItem "22" & " | " & "Presidente Directorio"
    cmbrelconppjentjur.AddItem "23" & " | " & "Presidente Ejecutivo"
    cmbrelconppjentjur.AddItem "24" & " | " & "Apoderado"
    cmbrelconppjentjur.AddItem "25" & " | " & "Socio"
    cmbrelconppjentjur.AddItem "26" & " | " & "Liquidador"
    cmbrelconppjentjur.AddItem "27" & " | " & "Secretario"
    cmbrelconppjentjur.AddItem "28" & " | " & "Vicepresidente"
    cmbrelconppjentjur.AddItem "29" & " | " & "Tesorero"
    cmbrelconppjentjur.AddItem "30" & " | " & "Accionista"
    cmbrelconppjentjur.AddItem "31" & " | " & "Contador"
    cmbrelconppjentjur.AddItem "32" & " | " & "Abogado"
    cmbrelconppjentjur.AddItem "33" & " | " & "Propietario"
    cmbrelconppjentjur.AddItem "34" & " | " & "Vocal"
    cmbrelconppjentjur.AddItem "35" & " | " & "Heredero"
    cmbrelconppjentjur.AddItem "36" & " | " & "Socio Administrador"
    cmbrelconppjentjur.AddItem "37" & " | " & "Albacea"
    cmbrelconppjentjur.AddItem "38" & " | " & "Decano"
    cmbrelconppjentjur.AddItem "39" & " | " & "Tutor"
    cmbrelconppjentjur.AddItem "40" & " | " & "Administrador"
    cmbrelconppjentjur.AddItem "41" & " | " & "Titular"
    cmbrelconppjentjur.AddItem "42" & " | " & "Alcalde"
    cmbrelconppjentjur.AddItem "43" & " | " & "Promotor"
    
    cmbestciv.AddItem "01" & " | " & "Soltero(a)"
    cmbestciv.AddItem "02" & " | " & "Casado(a)"
    cmbestciv.AddItem "03" & " | " & "Viudo(a)"
    cmbestciv.AddItem "04" & " | " & "Divorciado(a)"
    cmbestciv.AddItem "05" & " | " & "Uni|fffd|n de Hecho"

    cmbregpatcon.AddItem "01" & " | " & "Sociedad de Gananciales"
    cmbregpatcon.AddItem "02" & " | " & "Separaci|fffd|n de Patrimonios"
    cmbregpatcon.AddItem "03" & " | " & "Uni|fffd|n de Hecho"

    cmbtippro.AddItem "01" & " | " & "Directa"
    cmbtippro.AddItem "02" & " | " & "Indirecta Parentesco"
    cmbtippro.AddItem "03" & " | " & "Indirecta Cadena de Titularidad"
    cmbtippro.AddItem "04" & " | " & "Indirecta Mandato o Acto Jur|fffd|dico"
        
    cmbrelparconman.AddItem "01" & " | " & "Padre"
    cmbrelparconman.AddItem "02" & " | " & "Madre"
    cmbrelparconman.AddItem "03" & " | " & "Hermano(a)"
    cmbrelparconman.AddItem "04" & " | " & "Abuelo(a)"
    cmbrelparconman.AddItem "05" & " | " & "Nieto(a)"
    cmbrelparconman.AddItem "06" & " | " & "Padres Del C|fffd|nyuge"
    cmbrelparconman.AddItem "07" & " | " & "Hijos Del C|fffd|nyuge"
    cmbrelparconman.AddItem "08" & " | " & "Pareja De Uni|fffd|n De Hecho"
    cmbrelparconman.AddItem "09" & " | " & "Titular"
    cmbrelparconman.AddItem "10" & " | " & "Mandatario"
               
    cmbtipdoctit.AddItem "01" & " | " & "DNI"
    cmbtipdoctit.AddItem "04" & " | " & "Carnet de Extranjer|fffd|a"
    cmbtipdoctit.AddItem "06" & " | " & "RUC"
    cmbtipdoctit.AddItem "07" & " | " & "Pasaporte"
    cmbtipdoctit.AddItem "08" & " | " & "TIN"
    cmbtipdoctit.AddItem "09" & " | " & "ID"
    
    
    cmbtipcon.AddItem "01" & " | " & "Directo"
    cmbtipcon.AddItem "02" & " | " & "Indirecto"
        
    cmbcomentjur.AddItem "01" & " | " & "Fideicomitente"
    cmbcomentjur.AddItem "02" & " | " & "Fiduciario"
    cmbcomentjur.AddItem "03" & " | " & "Fideicomisario"
    cmbcomentjur.AddItem "04" & " | " & "Part|fffd|cipe"
    cmbcomentjur.AddItem "05" & " | " & "Inversionista"
    cmbcomentjur.AddItem "06" & " | " & "Beneficiario"
    cmbcomentjur.AddItem "07" & " | " & "Trustee o Administrador"
    cmbcomentjur.AddItem "08" & " | " & "Constituyente o Settlor"
    cmbcomentjur.AddItem "09" & " | " & "Protector o Administrador"
                
    cmbtipval.AddItem ""
    cmbtipval.AddItem "01" & " | " & "Acciones"
    cmbtipval.AddItem "02" & " | " & "Participaciones"
    cmbtipval.AddItem "03" & " | " & "Derechos"
        
    
        
    If BhayDataEnFila = True Then 'Hay informacion a visualizar en el formulario
    
        txtnumdoc.Text = Gtxtnumdoc
        txtnomape.Text = Gtxtnomape
        txtpaires.Text = UCase(Gtxtpaires)
        txtfecnac.Text = Gtxtfecnac
        txtnac.Text = UCase(Gtxtnac)
        txtdom.Text = Gtxtdom
        
        txttel.Text = Gtxttel
        txtcorele.Text = Gtxtcorele
        txtdnicon.Text = Gtxtnrodoccon
        txtdestipcon.Text = Gtxtdestipcon
        txtnumval.Text = Gtxtnumval
        txtporpar.Text = Gtxtporpar
        txtvaluninom.Text = Gtxtvaluninom
        txttipacc.Text = Gtxttipacc
        txtfeccie.Text = Gtxtfeccie
        txtlugdepcus.Text = UCase(Gtxtlugdepcus)
        txtfecpre.Text = Gtxtfecpre

        
        If Gcmbrol = "01" Then cmbrol.ListIndex = 0
        If Gcmbrol = "02" Then cmbrol.ListIndex = 1
        If Gcmbrol = "03" Then cmbrol.ListIndex = 2
        If Gcmbrol = "04" Then cmbrol.ListIndex = 3
        If Gcmbrol = "05" Then cmbrol.ListIndex = 4
        
        If Gcmbtipdoc = "01" Then cmbtipdoc.ListIndex = 0
        If Gcmbtipdoc = "04" Then cmbtipdoc.ListIndex = 1
        If Gcmbtipdoc = "06" Then cmbtipdoc.ListIndex = 2
        If Gcmbtipdoc = "07" Then cmbtipdoc.ListIndex = 3
        If Gcmbtipdoc = "08" Then cmbtipdoc.ListIndex = 4
        If Gcmbtipdoc = "09" Then cmbtipdoc.ListIndex = 5
        
        If Gtxtrelcon = "01" Then cmbrelconppjentjur.ListIndex = 0
        If Gtxtrelcon = "02" Then cmbrelconppjentjur.ListIndex = 1
        If Gtxtrelcon = "03" Then cmbrelconppjentjur.ListIndex = 2
        If Gtxtrelcon = "04" Then cmbrelconppjentjur.ListIndex = 3
        If Gtxtrelcon = "05" Then cmbrelconppjentjur.ListIndex = 4
        If Gtxtrelcon = "06" Then cmbrelconppjentjur.ListIndex = 5
        If Gtxtrelcon = "07" Then cmbrelconppjentjur.ListIndex = 6
        If Gtxtrelcon = "08" Then cmbrelconppjentjur.ListIndex = 7
        If Gtxtrelcon = "09" Then cmbrelconppjentjur.ListIndex = 8
        If Gtxtrelcon = "10" Then cmbrelconppjentjur.ListIndex = 9
        If Gtxtrelcon = "11" Then cmbrelconppjentjur.ListIndex = 10
        If Gtxtrelcon = "12" Then cmbrelconppjentjur.ListIndex = 11
        If Gtxtrelcon = "13" Then cmbrelconppjentjur.ListIndex = 12
        If Gtxtrelcon = "14" Then cmbrelconppjentjur.ListIndex = 13
        If Gtxtrelcon = "15" Then cmbrelconppjentjur.ListIndex = 14
        If Gtxtrelcon = "16" Then cmbrelconppjentjur.ListIndex = 15
        If Gtxtrelcon = "17" Then cmbrelconppjentjur.ListIndex = 16
        If Gtxtrelcon = "18" Then cmbrelconppjentjur.ListIndex = 17
        If Gtxtrelcon = "19" Then cmbrelconppjentjur.ListIndex = 18
        If Gtxtrelcon = "20" Then cmbrelconppjentjur.ListIndex = 19
        If Gtxtrelcon = "21" Then cmbrelconppjentjur.ListIndex = 20
        If Gtxtrelcon = "22" Then cmbrelconppjentjur.ListIndex = 21
        If Gtxtrelcon = "23" Then cmbrelconppjentjur.ListIndex = 22
        If Gtxtrelcon = "24" Then cmbrelconppjentjur.ListIndex = 23
        If Gtxtrelcon = "25" Then cmbrelconppjentjur.ListIndex = 24
        If Gtxtrelcon = "26" Then cmbrelconppjentjur.ListIndex = 25
        If Gtxtrelcon = "27" Then cmbrelconppjentjur.ListIndex = 26
        If Gtxtrelcon = "28" Then cmbrelconppjentjur.ListIndex = 27
        If Gtxtrelcon = "29" Then cmbrelconppjentjur.ListIndex = 28
        If Gtxtrelcon = "30" Then cmbrelconppjentjur.ListIndex = 29
        If Gtxtrelcon = "31" Then cmbrelconppjentjur.ListIndex = 30
        If Gtxtrelcon = "32" Then cmbrelconppjentjur.ListIndex = 31
        If Gtxtrelcon = "33" Then cmbrelconppjentjur.ListIndex = 32
        If Gtxtrelcon = "34" Then cmbrelconppjentjur.ListIndex = 33
        If Gtxtrelcon = "35" Then cmbrelconppjentjur.ListIndex = 34
        If Gtxtrelcon = "36" Then cmbrelconppjentjur.ListIndex = 35
        If Gtxtrelcon = "37" Then cmbrelconppjentjur.ListIndex = 36
        If Gtxtrelcon = "38" Then cmbrelconppjentjur.ListIndex = 37
        If Gtxtrelcon = "39" Then cmbrelconppjentjur.ListIndex = 38
        If Gtxtrelcon = "40" Then cmbrelconppjentjur.ListIndex = 39
        If Gtxtrelcon = "41" Then cmbrelconppjentjur.ListIndex = 40
        If Gtxtrelcon = "42" Then cmbrelconppjentjur.ListIndex = 41
        If Gtxtrelcon = "43" Then cmbrelconppjentjur.ListIndex = 42
        
        If Gtxtestciv = "01" Then cmbestciv.ListIndex = 0
        If Gtxtestciv = "02" Then cmbestciv.ListIndex = 1
        If Gtxtestciv = "03" Then cmbestciv.ListIndex = 2
        If Gtxtestciv = "04" Then cmbestciv.ListIndex = 3
        If Gtxtestciv = "05" Then cmbestciv.ListIndex = 4
        
        If Gtxtregpatcon = "01" Then cmbregpatcon.ListIndex = 0
        If Gtxtregpatcon = "02" Then cmbregpatcon.ListIndex = 1
        If Gtxtregpatcon = "03" Then cmbregpatcon.ListIndex = 2

        If Gtxttippro = "01" Then cmbtippro.ListIndex = 0
        If Gtxttippro = "02" Then cmbtippro.ListIndex = 1
        If Gtxttippro = "03" Then cmbtippro.ListIndex = 2
        If Gtxttippro = "04" Then cmbtippro.ListIndex = 3
    
        If Gtxttippro = "02" Then
            If Gtxtrelparconman = "01" Then cmbrelparconman.ListIndex = 0
            If Gtxtrelparconman = "02" Then cmbrelparconman.ListIndex = 1
            If Gtxtrelparconman = "03" Then cmbrelparconman.ListIndex = 2
            If Gtxtrelparconman = "04" Then cmbrelparconman.ListIndex = 3
            If Gtxtrelparconman = "05" Then cmbrelparconman.ListIndex = 4
            If Gtxtrelparconman = "06" Then cmbrelparconman.ListIndex = 5
            If Gtxtrelparconman = "07" Then cmbrelparconman.ListIndex = 6
            If Gtxtrelparconman = "08" Then cmbrelparconman.ListIndex = 7
            If Gtxtrelparconman = "09" Then cmbrelparconman.ListIndex = 8
        Else
            If Gtxttippro = "04" Then
                If Gtxtrelparconman = "09" Then cmbrelparconman.ListIndex = 0
                If Gtxtrelparconman = "10" Then cmbrelparconman.ListIndex = 1
            End If
        End If
        
        'If Gtxtrelparconman = "01" Then cmbrelparconman.ListIndex = 0
        'If Gtxtrelparconman = "02" Then cmbrelparconman.ListIndex = 1
        'If Gtxtrelparconman = "03" Then cmbrelparconman.ListIndex = 2
        'If Gtxtrelparconman = "04" Then cmbrelparconman.ListIndex = 3
        'If Gtxtrelparconman = "05" Then cmbrelparconman.ListIndex = 4
        'If Gtxtrelparconman = "06" Then cmbrelparconman.ListIndex = 5
        'If Gtxtrelparconman = "07" Then cmbrelparconman.ListIndex = 6
        'If Gtxtrelparconman = "08" Then cmbrelparconman.ListIndex = 7
        'If Gtxtrelparconman = "09" Then cmbrelparconman.ListIndex = 8
        'If Gtxtrelparconman = "10" Then cmbrelparconman.ListIndex = 9
        
        If (Gtxttippro = "02" Or Gtxttippro = "04") And Gtxtrelparconman <> "09" Then
            If Gtxttipdoctit = "01" Then cmbtipdoctit.ListIndex = 0
            If Gtxttipdoctit = "04" Then cmbtipdoctit.ListIndex = 1
            If Gtxttipdoctit = "06" Then cmbtipdoctit.ListIndex = 2
            If Gtxttipdoctit = "07" Then cmbtipdoctit.ListIndex = 3
            If Gtxttipdoctit = "08" Then cmbtipdoctit.ListIndex = 4
            If Gtxttipdoctit = "09" Then cmbtipdoctit.ListIndex = 5
            txtnumdoctit.Text = Gtxtnumdoctit
        Else
            If Gtxttippro = "01" Or Gtxttippro = "03" Then
                cmbrelparconman.Enabled = False
                cmbrelparconman.Clear
                cmbtipdoctit.Enabled = False
                cmbtipdoctit.Clear
                txtnumdoctit.Text = ""
                txtnumdoctit.BackColor = RGB(192, 192, 192)
             End If
        End If
        
        'If Gtxttipdoctit = "01" Then cmbtipdoctit.ListIndex = 0
        'If Gtxttipdoctit = "04" Then cmbtipdoctit.ListIndex = 1
        'If Gtxttipdoctit = "06" Then cmbtipdoctit.ListIndex = 2
        'If Gtxttipdoctit = "07" Then cmbtipdoctit.ListIndex = 3
        'If Gtxttipdoctit = "08" Then cmbtipdoctit.ListIndex = 4
        'If Gtxttipdoctit = "09" Then cmbtipdoctit.ListIndex = 5
        
        If Gtxttipcon = "01" Then cmbtipcon.ListIndex = 0
        If Gtxttipcon = "02" Then cmbtipcon.ListIndex = 1
        
        If Gtxtcomentjur = "01" Then cmbcomentjur.ListIndex = 0
        If Gtxtcomentjur = "02" Then cmbcomentjur.ListIndex = 1
        If Gtxtcomentjur = "03" Then cmbcomentjur.ListIndex = 2
        If Gtxtcomentjur = "04" Then cmbcomentjur.ListIndex = 3
        If Gtxtcomentjur = "05" Then cmbcomentjur.ListIndex = 4
        If Gtxtcomentjur = "06" Then cmbcomentjur.ListIndex = 5
        If Gtxtcomentjur = "07" Then cmbcomentjur.ListIndex = 6
        If Gtxtcomentjur = "08" Then cmbcomentjur.ListIndex = 7
        If Gtxtcomentjur = "09" Then cmbcomentjur.ListIndex = 8
                
        If Gtxttipval = "01" Then cmbtipval.ListIndex = 1
        If Gtxttipval = "02" Then cmbtipval.ListIndex = 2
        If Gtxttipval = "03" Then cmbtipval.ListIndex = 3
        
        If Gcmbres = "0" Then cmbres.ListIndex = 0
        If Gcmbres = "1" Then cmbres.ListIndex = 1
        
    End If
    
    
End Sub


Attribute VB_Name = "frmError"
Attribute VB_Base = "0{62C248E5-835A-401A-B01E-F583C0C04248}{5194DACF-4FAF-4CC1-B23B-313B7C9890C7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub cmdAceptar_Click()
    Unload Me
End Sub

Private Sub txtError_Change()
    txtError.SelStart = 0
    
    
End Sub

Private Sub UserForm_Activate()
    txtError.Text = strMjsFinalError
    txtError.SetFocus
End Sub


Attribute VB_Name = "frmListado"
Attribute VB_Base = "0{23252AFE-9A7F-49B4-A675-D656D22DC054}{C6A1848C-098E-452B-8622-C59CF4603578}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim lstrHoja        As String
Dim lstrHojaActiva  As String

Private Sub cmdSalir_Click()
    Unload Me
End Sub



Private Sub lblEtiqueta_Click()

End Sub

Private Sub txtTextoBuscar_Change()

    Dim hj              As Worksheet
    Dim C               As Range
    Dim strFirstCell    As String
    Dim strBuscar       As String
    
    Application.ScreenUpdating = False
    strBuscar = txtTextoBuscar.Value
    
    If txtTextoBuscar.Value = Empty Then
        lstListadoX.Clear
        lstListado.Visible = True
        lstListadoX.Visible = False
        
        Exit Sub
    Else
        lstListadoX.Clear
        lstListado.Visible = False
        lstListadoX.Visible = True
        
        Set C = Sheets("PAISES").Range("A2:A" & Sheets("PAISES").Range("A" & Rows.Count).End(xlUp).Row).Find(What:=strBuscar, LookIn:=xlValues, LookAt:=xlPart)
        
        If C Is Nothing Then GoTo ProximaHoja
        
        strFirstCell = C.Address
        Do
            With lstListadoX
                '.ColumnCount = 4
                .ColumnCount = 3
                '.ColumnWidths = "0;300;50;50"
                .ColumnWidths = "0;150;50"
                .AddItem lstListadoX.ListCount + 1
                .Column(1, lstListadoX.ListCount - 1) = C.Value
                .Column(2, lstListadoX.ListCount - 1) = C.Offset(0, 1).Value
                '.Column(3, lstListadoX.ListCount - 1) = c.Offset(0, 2).Value
                .ColumnHeads = True
            End With
            Set C = Sheets("PAISES").Range("A2:A" & Sheets("PAISES").Range("A" & Rows.Count).End(xlUp).Row).FindNext(C)
        Loop Until strFirstCell = C.Address
ProximaHoja:
        Set hj = Nothing
        Set C = Nothing
    End If
    Application.ScreenUpdating = True


    
End Sub


Private Sub UserForm_Activate()

    If ListadoAyuda = "AyudaPais1" Then 'Usado para Pa|fffd|s Constituci|fffd|n del Excel DATOS GENERALES
        lblEtiqueta = "Pa|fffd|s Constituci|fffd|n"
        txtTextoBuscar.Visible = True
        HojaActiva = "DATOS GENERALES"
        lstListado.RowSource = "TablaPaises"
    End If
    
    If ListadoAyuda = "AyudaRol2" Then
        lblEtiqueta = "Rol"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaRol"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaResidente2" Then
        lblEtiqueta = "Residente"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaResidente"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaTipoDocumento2" Then
        lblEtiqueta = "Tipo de Documento"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaTipDoc"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaPais2" Then 'Usado para Pa|fffd|s de Residencia del Excel BENEFICIARIOS
        lblEtiqueta = "Pa|fffd|s de Residencia"
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaPaises"
    End If
    
    If ListadoAyuda = "AyudaPais3" Then
        lblEtiqueta = "Pa|fffd|s de Residencia"
        HojaActiva = "frmBeneficiarios" 'en este caso es el Pa|fffd|s de Residencia del Formulario de Beneficiarios
        lstListado.RowSource = "TablaPaises"
    End If
    
    If ListadoAyuda = "AyudaPais4" Then 'Usado para Nacionalidad del Excel BENEFICIARIOS
        lblEtiqueta = "Nacionalidad"
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaPaises"
    End If
    
    If ListadoAyuda = "AyudaPais5" Then
        lblEtiqueta = "Nacionalidad"
        HojaActiva = "frmBeneficiarios" 'en este caso es la Nacionalidad del Formulario de Beneficiarios
        lstListado.RowSource = "TablaPaises"
    End If
        
    If ListadoAyuda = "AyudaRelacion2" Then
        lblEtiqueta = "Relaci|fffd|n con PPJJ / Ente Jur|fffd|dico"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaRelacion"
        lstListado.ColumnWidths = "50,150"
    End If
    
'NUEVOS
    
    If ListadoAyuda = "AyudaEstado2" Then
        lblEtiqueta = "Estado Civil"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaEstado"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaRegimen2" Then
        lblEtiqueta = "R|fffd|gimen Patrimonial C|fffd|nyuge"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaRegimen"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaPropiedad2" Then
        lblEtiqueta = "Tipo de Propiedad"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaPropiedad"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaRelacionPCM2" Then
        lblEtiqueta = "Relaci|fffd|n Pariente / C|fffd|nyuge / Mandatario"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaRelacionPariente"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaTipoDocumento3" Then
        lblEtiqueta = "Tipo Documento Titular"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaTipDoc"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaTipoControl2" Then
        lblEtiqueta = "Tipo de Control"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaControl"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaComponente2" Then
        lblEtiqueta = "Componente Ente Jur|fffd|dico"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaComponente"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaValor2" Then
        lblEtiqueta = "Tipo Valor"
        txtTextoBuscar.Visible = False
        HojaActiva = "BENEFICIARIOS"
        lstListado.RowSource = "TablaValor"
        lstListado.ColumnWidths = "50,150"
    End If
    
    If ListadoAyuda = "AyudaPais6" Then
        lblEtiqueta = "Lugar de Dep|fffd|sito o Custodia"
        HojaActiva = "BENEFICIARIOS" 'en este caso es el Lugar de Dep|fffd|sito o Custodia
        lstListado.RowSource = "TablaPaises"
    End If
        
    If ListadoAyuda = "AyudaPais7" Then
        lblEtiqueta = "Lugar de Dep|fffd|sito o Custodia"
        HojaActiva = "BENEFICIARIOS" 'en este caso es el Lugar de Dep|fffd|sito o Custodia del Formulario de Beneficiarios
        lstListado.RowSource = "TablaPaises"
    End If
        
End Sub

Private Sub lstListado_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If lstListado.ListIndex = -1 Then Exit Sub
    SeleccionarParametro HojaActiva, ActiveCell.Column, ActiveCell.Row, lstListado, 1
End Sub

Private Sub lstListado_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If lstListado.ListIndex = -1 Then Exit Sub
    If KeyAscii = 13 Then
        SeleccionarParametro HojaActiva, ActiveCell.Column, ActiveCell.Row, lstListado, 1
    End If
End Sub

Private Sub lstListadoX_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If lstListadoX.ListIndex = -1 Then Exit Sub
    SeleccionarParametro HojaActiva, ActiveCell.Column, ActiveCell.Row, lstListadoX, 2
End Sub

Private Sub lstListadoX_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If lstListadoX.ListIndex = -1 Then Exit Sub
    If KeyAscii = 13 Then
        SeleccionarParametro HojaActiva, ActiveCell.Column, ActiveCell.Row, lstListadoX, 2
    End If
End Sub

Private Sub SeleccionarParametro(ByVal strHoja As String, ByVal intCol, ByVal intRow, ByVal lstList As Object, ByVal colfind As Integer)
    Dim strValor As String
    
    If HojaActiva = "BENEFICIARIOS" And ListadoAyuda <> "AyudaPais2" And ListadoAyuda <> "AyudaPais4" And ListadoAyuda <> "AyudaPais6" And ListadoAyuda <> "AyudaPais7" Then
        colfind = 0
    End If
    
    strValor = lstList.Column(colfind)
       
    valPaisForm = ""
    If ListadoAyuda = "AyudaPais3" Or ListadoAyuda = "AyudaPais5" Or ListadoAyuda = "AyudaPais7" Then
        valPaisForm = strValor
    Else
        ThisWorkbook.Sheets(strHoja).Cells(intRow, intCol).Value = strValor
    End If
    
    cmdSalir_Click
End Sub



INQUEST-PP=macro
