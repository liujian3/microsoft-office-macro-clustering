Attribute VB_Name = "Arkusz10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 7, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 9, 1, MSForms, CommandButton"
Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub

Private Sub CommandButton3_Click()
Dim nr As Integer, a, b
Application.ScreenUpdating = False
Application.EnableEvents = False
ActiveSheet.Unprotect
nr = Range("AP1") + 1
Select Case nr
Case 2
    Range("A122:A242").Select
    Selection.EntireRow.Hidden = False
    Range("B2:AN121").Copy
    Range("B123").Select
    
    ActiveSheet.Paste
    ActiveSheet.PageSetup.PrintArea = "C3:AM60,C64:AM120,C124:AM181,C185:AM241"
    [AJ133] = 2
    
    Range("D147:AM147,D149:AM149,D151:AM151,AF153:AM153,D156:AM156,D158:AM158,D160:AM160").ClearContents
    Range("D164:AM164,D166:AM166,D168:AM168,AF170:AM170,D173:AM173,D175:AM175,D177:AM177").ClearContents
    Range("D191:AM191,D193:AM193,D195:AM195,AF197:AM197,D200:AM200,D202:AM202,D204:AM204").ClearContents
    Range("D208:AM208,D210:AM210,D212:AM212,AF214:AM214,D217:AM217,D219:AM219,D221:AM221").ClearContents
    Range("D225:AM225,D227:AM227,D229:AM229,AF231:AM231,D234:AM234,D236:AM236,D238:AM238").ClearContents
    Application.GoTo Range("A130")
    Range("D147").Select
Case 3
    Range("A243:A363").Select
    Selection.EntireRow.Hidden = False
    Range("B2:AN121").Copy
    Range("B244").Select
    
    ActiveSheet.Paste
    ActiveSheet.PageSetup.PrintArea = "C3:AM60,C64:AM120,C124:AM181,C185:AM241,C245:AM302,C306:AM362"
    [AJ254] = 3
    
    Range("D268:AM268,D270:AM270,D272:AM272,AF274:AM274,D277:AM277,D279:AM279,D281:AM281").ClearContents
    Range("D285:AM285,D287:AM287,D289:AM289,AF291:AM291,D294:AM294,D296:AM296,D298:AM298").ClearContents
    Range("D312:AM312,D314:AM314,D316:AM316,AF318:AM318,D321:AM321,D323:AM323,D325:AM325").ClearContents
    Range("D329:AM329,D331:AM331,D333:AM333,AF335:AM335,D338:AM338,D340:AM340,D342:AM342").ClearContents
    Range("D346:AM346,D348:AM348,D350:AM350,AF352:AM352,D355:AM355,D357:AM357,D359:AM359").ClearContents
    Application.GoTo Range("A251")
    Range("D268").Select
Case 4
    Range("A364:A484").Select
    Selection.EntireRow.Hidden = False
    Range("B2:AN121").Copy
    Range("B365").Select
    
    ActiveSheet.Paste
    ActiveSheet.PageSetup.PrintArea = "C3:AM60,C64:AM120,C124:AM181,C185:AM241,C245:AM302,C306:AM362,C366:AN423,C427:AM483"
    [AJ375] = 4
    
    Range("D389:AM389,D391:AM391,D393:AM393,AF395:AM395,D398:AM398,D400:AM400,D402:AM402").ClearContents
    Range("D406:AM406,D408:AM408,D410:AM410,AF412:AM412,D415:AM415,D417:AM417,D419:AM419").ClearContents
    Range("D433:AM433,D435:AM435,D437:AM437,AF439:AM439,D442:AM442,D444:AM444,D446:AM446").ClearContents
    Range("D450:AM450,D452:AM452,D454:AM454,AF456:AM456,D459:AM459,D461:AM461,D463:AM463").ClearContents
    Range("D467:AM467,D469:AM469,D471:AM471,AF473:AM473,D476:AM476,D478:AM478,D480:AM480").ClearContents
    Application.GoTo Range("A372")
    Range("D389").Select
    ActiveSheet.Shapes("CommandButton3").Select
    Selection.Cut
End Select
ActiveSheet.Protect
Application.EnableEvents = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
End Sub

Private Sub CommandButton2_Click()
Wydruk.Show
End Sub

Attribute VB_Name = "Arkusz11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "i_x1, 7, 0, MSForms, Image"
Attribute VB_Control = "i_x2, 8, 1, MSForms, Image"
Attribute VB_Control = "i_x3, 9, 2, MSForms, Image"
Attribute VB_Control = "i_k1, 10, 3, MSForms, Image"
Attribute VB_Control = "i_k2, 11, 4, MSForms, Image"
Attribute VB_Control = "i_k3, 12, 5, MSForms, Image"
Attribute VB_Control = "CommandButton1, 13, 6, MSForms, CommandButton"
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub i_x1_Click()
i_x1.Visible = False
i_k1.Visible = True
[AE1] = 0
End Sub
Private Sub i_k1_Click()
i_k1.Visible = False
i_x1.Visible = True
i_x2.Visible = False
i_k2.Visible = True
i_x3.Visible = False
i_k3.Visible = True
[AE1] = 1
End Sub
Private Sub i_x2_Click()
i_x2.Visible = False
i_k2.Visible = True
[AE1] = 0
End Sub
Private Sub i_k2_Click()
i_k2.Visible = False
i_x2.Visible = True
i_x1.Visible = False
i_k1.Visible = True
i_x3.Visible = False
i_k3.Visible = True
[AE1] = 2
End Sub

Private Sub i_x3_Click()
i_x3.Visible = False
i_k3.Visible = True
[AE1] = 0
End Sub
Private Sub i_k3_Click()
i_k3.Visible = False
i_x3.Visible = True
i_x1.Visible = False
i_k1.Visible = True
i_x2.Visible = False
i_k2.Visible = True
[AE1] = 3
End Sub



Attribute VB_Name = "Arkusz12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 3, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
ActiveWindow.SelectedSheets.PrintOut
End Sub

Private Sub CommandButton2_Click()
Dim Nplik As String
If Range("D6") <> "Ministerstwo Finans|fffd|w" Then
MsgBox "Testowe UPO jest bezu|fffd|yteczne i nie jest zapisywane do pliku pdf.", vbInformation, "e-Deklaracje"
End
End If
If Val(Application.Version) < 12 Then
MsgBox "Zapisywanie UPO do pliku pdf mo|fffd|liwe jest tylko od wersji 2007 Excela.", vbCritical, "Uwaga - potrzebny Excel 2007 lub nowszy"
End
End If
Nplik = "UPO_" & [E20] & "_" & [F26] & ".pdf"
Nplik = Replace(Nplik, ":", ".")
Nplik = ThisWorkbook.Path & "\" & Nplik
ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=Nplik _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
MsgBox "UPO zapisano do pliku " & Chr(13) & Chr(13) & Nplik, vbInformation, "UPO w pdf"
End Sub


Attribute VB_Name = "Arkusz13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub Worksheet_Activate()
Application.OnKey "^{k}", "Calc"
Imfreshvat xlOn
End Sub

Private Sub Worksheet_Deactivate()
Application.OnKey "^{k}"
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
If [D30] = "" And Target.Row = 30 Then Fraza.Show
Imfreshvat xlOn
End Sub

Private Sub CommandButton2_Click()
If ActiveWorkbook.Colors(15) = RGB(234, 234, 234) Then
    ActiveWorkbook.Colors(15) = RGB(255, 255, 255)
    ActiveWorkbook.Colors(16) = RGB(255, 255, 255)
    CommandButton2.Caption = "W|fffd||fffd|cz t|fffd|o"
Else
    ActiveWorkbook.Colors(15) = RGB(234, 234, 234)
    ActiveWorkbook.Colors(16) = RGB(191, 191, 191)
    CommandButton2.Caption = "Wy|fffd||fffd|cz t|fffd|o"
End If
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
If Target.Row = 9 Then
[J9] = Replace([J9], " ", "")
For a = 1 To Len([J9])
b = b & Mid([J9], a, 1) & "   "
Next
[J9] = Trim(b)
End If
Application.EnableEvents = True
End Sub

Private Sub ixx1_Click()
ixx1.Visible = False
ikk1.Visible = True
End Sub
Private Sub ikk1_Click()
ikk1.Visible = False
ixx1.Visible = True
ixx2.Visible = False
ikk2.Visible = True
End Sub
Private Sub ixx2_Click()
ixx2.Visible = False
ikk2.Visible = True
End Sub
Private Sub ikk2_Click()
ikk2.Visible = False
ixx2.Visible = True
ixx1.Visible = False
ikk1.Visible = True
End Sub


Private Sub ixx3_Click()
ixx3.Visible = False
ikk3.Visible = True
End Sub
Private Sub ikk3_Click()
ikk3.Visible = False
ixx3.Visible = True
End Sub

Sub Firma(st)
If [AS2] = 1 Then
[A27] = InputBox("Wpisz nazw|fffd| pe|fffd|n|fffd| firmy", "Nazwa firmy")
[A30] = InputBox("Wpisz REGON firmy (nieobowi|fffd|zkowy)", "REGON firmy")
If [AS30] = False Then MsgBox "Wpisany REGON jest b|fffd||fffd|dny!", 16, "B|fffd||fffd|D": [A30].ClearContents
Else
[A27] = InputBox("Wpisz nazwisko osoby fizycznej", "Nazwa firmy")
[A28] = InputBox("Wpisz imi|fffd| osoby fizycznej", "Nazwa firmy")
[A29] = InputBox("Wpisz dat|fffd| urodzenia osoby fizycznej jako 8 cyfr np. 01021989", "Data urodzenia")
If [AS29] = False Then MsgBox "Wpisano b|fffd||fffd|dnie dat|fffd|!" & Chr(13) & Chr(13) & "Winno by|fffd| 8 cyfr np. 01021989", 16, "B|fffd||fffd|D": [A27:A29].ClearContents
End If
End Sub

Sub Imfreshvat(st)
'If ikk1.Visible = True And ixx1.Visible = True Then
'Application.ScreenUpdating = False

'
'End If
End Sub




Attribute VB_Name = "Arkusz14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 29, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Attribute VB_Name = "Arkusz15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ixx1, 9, 0, MSForms, Image"
Attribute VB_Control = "ikk1, 10, 1, MSForms, Image"
Attribute VB_Control = "CommandButton1, 13, 2, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub ixx1_Click()
ixx1.Visible = False
ikk1.Visible = True
[S1] = 0
End Sub
Private Sub ikk1_Click()
ikk1.Visible = False
ixx1.Visible = True
[S1] = 1
End Sub
Attribute VB_Name = "Arkusz16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
ActiveWindow.SelectedSheets.PrintOut
End Sub

Attribute VB_Name = "Arkusz17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 4, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
If ActiveWorkbook.Colors(15) = RGB(234, 234, 234) Then
    ActiveWorkbook.Colors(15) = RGB(255, 255, 255)
    ActiveWorkbook.Colors(16) = RGB(255, 255, 255)
    CommandButton1.Caption = "W|fffd||fffd|cz t|fffd|o"
Else
    ActiveWorkbook.Colors(15) = RGB(234, 234, 234)
    ActiveWorkbook.Colors(16) = RGB(191, 191, 191)
    CommandButton1.Caption = "Wy|fffd||fffd|cz t|fffd|o"
End If
End Sub

Private Sub CommandButton2_Click()
ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1
End Sub


Attribute VB_Name = "Arkusz2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 11, 0, MSForms, CommandButton"
Attribute VB_Control = "ikk2, 12, 1, MSForms, Image"
Attribute VB_Control = "ikk3, 13, 2, MSForms, Image"
Attribute VB_Control = "ixx4, 15, 3, MSForms, Image"
Attribute VB_Control = "ixx1, 16, 4, MSForms, Image"
Attribute VB_Control = "ixx5, 17, 5, MSForms, Image"
Attribute VB_Control = "ikk5, 18, 6, MSForms, Image"
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub

Private Sub CommandButton2_Click()
Wydruk.Show
End Sub

Private Sub ixx5_Click()
ixx5.Visible = False
ikk5.Visible = True
[CR3] = 0
End Sub
Private Sub ikk5_Click()
ikk5.Visible = False
ixx5.Visible = True
[CR3] = 1
End Sub

Attribute VB_Name = "Arkusz3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 67, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 68, 1, MSForms, CommandButton"
Attribute VB_Control = "ixx1, 69, 2, MSForms, Image"
Attribute VB_Control = "ixx2, 70, 3, MSForms, Image"
Attribute VB_Control = "ixx5, 71, 4, MSForms, Image"
Attribute VB_Control = "ixx6, 72, 5, MSForms, Image"
Attribute VB_Control = "ixx7, 73, 6, MSForms, Image"
Attribute VB_Control = "ixx8, 75, 8, MSForms, Image"
Attribute VB_Control = "ixx9, 76, 9, MSForms, Image"
Attribute VB_Control = "ixx10, 77, 10, MSForms, Image"
Attribute VB_Control = "ixx11, 79, 12, MSForms, Image"
Attribute VB_Control = "ixx12, 81, 14, MSForms, Image"
Attribute VB_Control = "ixx13, 82, 15, MSForms, Image"
Attribute VB_Control = "ixx14, 83, 16, MSForms, Image"
Attribute VB_Control = "ixx15, 84, 17, MSForms, Image"
Attribute VB_Control = "ikk21, 457, 19, MSForms, Image"
Attribute VB_Control = "ixx16, 87, 20, MSForms, Image"
Attribute VB_Control = "ikk1, 203, 21, MSForms, Image"
Attribute VB_Control = "CommandButton3, 230, 22, MSForms, CommandButton"
Attribute VB_Control = "ikk2, 205, 23, MSForms, Image"
Attribute VB_Control = "ikk5, 206, 24, MSForms, Image"
Attribute VB_Control = "ikk6, 207, 25, MSForms, Image"
Attribute VB_Control = "ikk7, 208, 26, MSForms, Image"
Attribute VB_Control = "ikk20, 456, 27, MSForms, Image"
Attribute VB_Control = "ikk8, 210, 28, MSForms, Image"
Attribute VB_Control = "ikk9, 211, 29, MSForms, Image"
Attribute VB_Control = "ikk10, 212, 30, MSForms, Image"
Attribute VB_Control = "ikk11, 213, 31, MSForms, Image"
Attribute VB_Control = "ixx21, 455, 32, MSForms, Image"
Attribute VB_Control = "ixx20, 454, 33, MSForms, Image"
Attribute VB_Control = "ikk12, 216, 34, MSForms, Image"
Attribute VB_Control = "ikk13, 217, 35, MSForms, Image"
Attribute VB_Control = "ikk14, 218, 36, MSForms, Image"
Attribute VB_Control = "ikk15, 219, 37, MSForms, Image"
Attribute VB_Control = "ikk17, 453, 38, MSForms, Image"
Attribute VB_Control = "ixx17, 452, 39, MSForms, Image"
Attribute VB_Control = "ikk16, 222, 40, MSForms, Image"
Attribute VB_Control = "ixx18, 374, 41, MSForms, Image"
Attribute VB_Control = "ixx19, 375, 42, MSForms, Image"
Attribute VB_Control = "ixx24, 376, 43, MSForms, Image"
Attribute VB_Control = "ixx25, 377, 44, MSForms, Image"
Attribute VB_Control = "ikk18, 378, 45, MSForms, Image"
Attribute VB_Control = "ikk19, 379, 46, MSForms, Image"
Attribute VB_Control = "ikk24, 380, 47, MSForms, Image"
Attribute VB_Control = "ikk25, 381, 48, MSForms, Image"
Attribute VB_Control = "ikk23, 439, 49, MSForms, Image"
Attribute VB_Control = "ikk22, 438, 50, MSForms, Image"
Attribute VB_Control = "ixx23, 437, 51, MSForms, Image"
Attribute VB_Control = "ixx22, 436, 52, MSForms, Image"
Attribute VB_Control = "ixx3, 397, 53, MSForms, Image"
Attribute VB_Control = "ixx4, 398, 54, MSForms, Image"
Attribute VB_Control = "ikk3, 399, 55, MSForms, Image"
Attribute VB_Control = "ikk4, 400, 56, MSForms, Image"
Private Sub CommandButton3_Click()
Walid xlOn
eDeklaracja.Show
End Sub

Private Sub Worksheet_Activate()
Imfreshvat xlOn
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
If Target.Address = "$D$29:$AN$29" And ActiveCell = "" Then Fraza.Show
End Sub

Private Sub CommandButton2_Click()
If ActiveWorkbook.Colors(15) = RGB(234, 234, 234) Then
    ActiveWorkbook.Colors(15) = RGB(255, 255, 255)
    ActiveWorkbook.Colors(16) = RGB(255, 255, 255)
    CommandButton2.Caption = "W|fffd||fffd|cz t|fffd|o"
Else
    ActiveWorkbook.Colors(15) = RGB(234, 234, 234)
    ActiveWorkbook.Colors(16) = RGB(191, 191, 191)
    CommandButton2.Caption = "Wy|fffd||fffd|cz t|fffd|o"
End If
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub

Private Sub ikk1_Click()
ikk1.Visible = False
ixx1.Visible = True
ixx2.Visible = False
ikk2.Visible = True
[AR1] = 1
End Sub
Private Sub ikk2_Click()
ikk2.Visible = False
ixx2.Visible = True
ixx1.Visible = False
ikk1.Visible = True
[AR1] = 2
End Sub

Private Sub ixx3_Click()
ixx3.Visible = False
ikk3.Visible = True
[AR2] = 0
Sheets("ORD-ZU").Visible = False
End Sub
Private Sub ikk3_Click()
If [AR1] = 2 Then
ikk3.Visible = False
ixx3.Visible = True
ixx4.Visible = False
ikk4.Visible = True
[AR2] = 1
Sheets("ORD-ZU").Visible = False
End If
End Sub
Private Sub ixx4_Click()
ixx4.Visible = False
ikk4.Visible = True
[AR2] = 0
Sheets("ORD-ZU").Visible = False
End Sub
Private Sub ikk4_Click()
If [AR1] = 2 Then
ikk4.Visible = False
ixx4.Visible = True
ixx3.Visible = False
ikk3.Visible = True
[AR2] = 2
Sheets("ORD-ZU").Visible = True
End If
End Sub

Private Sub ixx5_Click()
ixx5.Visible = False
ikk5.Visible = True
[AR3] = 0
End Sub
Private Sub ikk5_Click()
ikk5.Visible = False
ixx5.Visible = True
[AR3] = 1
End Sub

Private Sub ixx6_Click()
ixx6.Visible = False
ikk6.Visible = True
[AR4] = 0
End Sub
Private Sub ikk6_Click()
ikk6.Visible = False
ixx6.Visible = True
[AR4] = 1
End Sub

Private Sub ixx7_Click()
ixx7.Visible = False
ikk7.Visible = True
[AR5] = 0
End Sub
Private Sub ikk7_Click()
ikk7.Visible = False
ixx7.Visible = True
[AR5] = 1
End Sub

Private Sub ixx8_Click()
ixx8.Visible = False
ikk8.Visible = True
[AR6] = 0
End Sub
Private Sub ikk8_Click()
ikk8.Visible = False
ixx8.Visible = True
ixx9.Visible = False
ikk9.Visible = True
ixx10.Visible = False
ikk10.Visible = True
[AR6] = 1
End Sub
Private Sub ixx9_Click()
ixx9.Visible = False
ikk9.Visible = True
[AR6] = 0
End Sub
Private Sub ikk9_Click()
ikk9.Visible = False
ixx9.Visible = True
ixx8.Visible = False
ikk8.Visible = True
ixx10.Visible = False
ikk10.Visible = True
[AR6] = 2
End Sub
Private Sub ixx10_Click()
ixx9.Visible = False
ikk9.Visible = True
[AR6] = 0
End Sub
Private Sub ikk10_Click()
ikk10.Visible = False
ixx10.Visible = True
ixx8.Visible = False
ikk8.Visible = True
ixx9.Visible = False
ikk9.Visible = True
[AR6] = 3
End Sub

Private Sub ixx11_Click()
ixx11.Visible = False
ikk11.Visible = True
[AR7] = 0
End Sub
Private Sub ikk11_Click()
ikk11.Visible = False
ixx11.Visible = True
[AR7] = 1
End Sub

Private Sub ixx12_Click()
ixx12.Visible = False
ikk12.Visible = True
[AR8] = 0
End Sub
Private Sub ikk12_Click()
ikk12.Visible = False
ixx12.Visible = True
[AR8] = 1
End Sub

Private Sub ixx13_Click()
ixx13.Visible = False
ikk13.Visible = True
[AR9] = 0
[AR10] = 0
End Sub
Private Sub ikk13_Click()
ikk13.Visible = False
ixx13.Visible = True
ikk14.Visible = True
ixx14.Visible = False
[AR9] = 1
[AR10] = 0
End Sub

Private Sub ixx14_Click()
ixx14.Visible = False
ikk14.Visible = True
[AR9] = 0
[AR10] = 0
End Sub
Private Sub ikk14_Click()
ikk14.Visible = False
ixx14.Visible = True
ikk13.Visible = True
ixx13.Visible = False
[AR10] = 1
[AR9] = 0
End Sub

Private Sub ixx15_Click()
ixx15.Visible = False
ikk15.Visible = True
[AR11] = 0
[AR12] = 0
End Sub
Private Sub ikk15_Click()
ikk15.Visible = False
ixx15.Visible = True
ikk16.Visible = True
ixx16.Visible = False
[AR11] = 1
[AR12] = 0
End Sub

Private Sub ixx16_Click()
ixx16.Visible = False
ikk16.Visible = True
[AR11] = 0
[AR12] = 0
End Sub
Private Sub ikk16_Click()
ikk16.Visible = False
ixx16.Visible = True
ikk15.Visible = True
ixx15.Visible = False
[AR12] = 1
[AR11] = 0
End Sub


Private Sub ixx17_Click()
ixx17.Visible = False
ikk17.Visible = True
[AR13] = 0
End Sub
Private Sub ikk17_Click()
ikk17.Visible = False
ixx17.Visible = True
[AR13] = 1
End Sub

Private Sub ixx18_Click()
ixx18.Visible = False
ikk18.Visible = True
[AR14] = 0
End Sub
Private Sub ikk18_Click()
ikk18.Visible = False
ixx18.Visible = True
ixx19.Visible = False
ikk19.Visible = True
[AR14] = 1
End Sub
Private Sub ixx19_Click()
ixx19.Visible = False
ikk19.Visible = True
[AR14] = 0
End Sub
Private Sub ikk19_Click()
ikk19.Visible = False
ixx19.Visible = True
ixx18.Visible = False
ikk18.Visible = True
[AR14] = 2
End Sub

Private Sub ixx20_Click()
ixx20.Visible = False
ikk20.Visible = True
[AR15] = 0
End Sub
Private Sub ikk20_Click()
ikk20.Visible = False
ixx20.Visible = True
ixx21.Visible = False
ikk21.Visible = True
[AR15] = 1
End Sub
Private Sub ixx21_Click()
ixx21.Visible = False
ikk21.Visible = True
[AR15] = 0
End Sub
Private Sub ikk21_Click()
ikk21.Visible = False
ixx21.Visible = True
ixx20.Visible = False
ikk20.Visible = True
[AR15] = 2
End Sub

Private Sub ixx22_Click()
ixx22.Visible = False
ikk22.Visible = True
[AR16] = 0
End Sub
Private Sub ikk22_Click()
ikk22.Visible = False
ixx22.Visible = True
ixx23.Visible = False
ikk23.Visible = True
[AR16] = 1
End Sub
Private Sub ixx23_Click()
ixx23.Visible = False
ikk23.Visible = True
[AR16] = 0
End Sub
Private Sub ikk23_Click()
ikk23.Visible = False
ixx23.Visible = True
ixx22.Visible = False
ikk22.Visible = True
[AR16] = 2
End Sub

Private Sub ixx24_Click()
ixx24.Visible = False
ikk24.Visible = True
[AR17] = 0
End Sub
Private Sub ikk24_Click()
ikk24.Visible = False
ixx24.Visible = True
ixx25.Visible = False
ikk25.Visible = True
[AR17] = 1
End Sub
Private Sub ixx25_Click()
ixx25.Visible = False
ikk25.Visible = True
[AR17] = 0
End Sub
Private Sub ikk25_Click()
ikk25.Visible = False
ixx25.Visible = True
ixx24.Visible = False
ikk24.Visible = True
[AR17] = 2
End Sub


Sub Imfreshvat(st)
Application.ScreenUpdating = False
If [AR1] = 1 Then
ikk1.Visible = False
ixx1.Visible = True
ixx2.Visible = False
ikk2.Visible = True
End If

If [AR1] = 2 Then
ikk2.Visible = False
ixx2.Visible = True
ixx1.Visible = False
ikk1.Visible = True
End If

If [AR1] = 2 Then
ikk3.Visible = False
ixx3.Visible = True
ixx4.Visible = False
ikk4.Visible = True
[AR2] = 1
End If

If [AR1] = 2 Then
ikk4.Visible = False
ixx4.Visible = True
ixx3.Visible = False
ikk3.Visible = True
[AR2] = 2
End If

If [AR3] = 1 Then
ikk5.Visible = False
ixx5.Visible = True
End If

If [AR4] = 1 Then
ikk6.Visible = False
ixx6.Visible = True
End If

If [AR5] = 1 Then
ikk7.Visible = False
ixx7.Visible = True
End If

If [AR6] = 1 Then
ikk8.Visible = False
ixx8.Visible = True
ixx9.Visible = False
ikk9.Visible = True
ixx10.Visible = False
ikk10.Visible = True
End If

If [AR6] = 2 Then
ikk9.Visible = False
ixx9.Visible = True
ixx8.Visible = False
ikk8.Visible = True
ixx10.Visible = False
ikk10.Visible = True
End If

If [AR6] = 3 Then
ikk10.Visible = False
ixx10.Visible = True
ixx8.Visible = False
ikk8.Visible = True
ixx9.Visible = False
ikk9.Visible = True
End If

If [AR7] = 1 Then
ikk11.Visible = False
ixx11.Visible = True
End If

If [AR8] = 1 Then
ikk12.Visible = False
ixx12.Visible = True
End If

If [AR9] = 1 Then
ikk13.Visible = False
ixx13.Visible = True
End If

If [AR10] = 1 Then
ikk14.Visible = False
ixx14.Visible = True
End If

If [AR11] = 1 Then
ikk15.Visible = False
ixx15.Visible = True
End If

If [AR12] = 1 Then
ikk16.Visible = False
ixx16.Visible = True
End If

If [AR13] = 1 Then
ikk17.Visible = False
ixx17.Visible = True
End If

If [AR14] = 1 Then
ikk18.Visible = False
ixx18.Visible = True
ixx19.Visible = False
ikk19.Visible = True
End If

If [AR14] = 2 Then
ikk19.Visible = False
ixx19.Visible = True
ixx18.Visible = False
ikk18.Visible = True
End If

If [AR15] = 1 Then
ikk20.Visible = False
ixx20.Visible = True
ixx21.Visible = False
ikk21.Visible = True
End If

If [AR15] = 2 Then
ikk21.Visible = False
ixx21.Visible = True
ixx20.Visible = False
ikk20.Visible = True
End If

If [AR16] = 1 Then
ikk22.Visible = False
ixx22.Visible = True
ixx23.Visible = False
ikk23.Visible = True
End If

If [AR16] = 2 Then
ikk23.Visible = False
ixx23.Visible = True
ixx22.Visible = False
ikk22.Visible = True
End If

If [AR17] = 1 Then
ikk24.Visible = False
ixx24.Visible = True
ixx25.Visible = False
ikk25.Visible = True
End If

If [AR17] = 2 Then
ikk25.Visible = False
ixx25.Visible = True
ixx24.Visible = False
ikk24.Visible = True
End If

End Sub




Attribute VB_Name = "Arkusz4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 9, 0, MSForms, CommandButton"
Attribute VB_Control = "ixx1, 10, 1, MSForms, Image"
Attribute VB_Control = "ixx2, 11, 2, MSForms, Image"
Attribute VB_Control = "ixx3, 12, 3, MSForms, Image"
Attribute VB_Control = "ixx4, 13, 4, MSForms, Image"
Attribute VB_Control = "ixx5, 14, 5, MSForms, Image"
Attribute VB_Control = "ixx6, 15, 6, MSForms, Image"
Attribute VB_Control = "ixx7, 16, 7, MSForms, Image"
Attribute VB_Control = "ixx8, 17, 8, MSForms, Image"
Attribute VB_Control = "ixx9, 18, 9, MSForms, Image"
Attribute VB_Control = "ixx10, 19, 10, MSForms, Image"
Attribute VB_Control = "ixx11, 20, 11, MSForms, Image"
Attribute VB_Control = "ixx12, 21, 12, MSForms, Image"
Attribute VB_Control = "ikk1, 23, 14, MSForms, Image"
Attribute VB_Control = "ikk2, 24, 15, MSForms, Image"
Attribute VB_Control = "ikk3, 25, 16, MSForms, Image"
Attribute VB_Control = "ikk4, 26, 17, MSForms, Image"
Attribute VB_Control = "ikk5, 27, 18, MSForms, Image"
Attribute VB_Control = "ikk6, 28, 19, MSForms, Image"
Attribute VB_Control = "ikk7, 29, 20, MSForms, Image"
Attribute VB_Control = "ikk8, 30, 21, MSForms, Image"
Attribute VB_Control = "ikk9, 31, 22, MSForms, Image"
Attribute VB_Control = "ikk10, 32, 23, MSForms, Image"
Attribute VB_Control = "ikk11, 33, 24, MSForms, Image"
Attribute VB_Control = "ikk12, 34, 25, MSForms, Image"
Private Sub Worksheet_Activate()
Imfreshvat xlOn
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
Imfreshvat xlOn
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub

Private Sub ikk1_Click()
ikk1.Visible = False
ixx1.Visible = True
ixx2.Visible = False
ikk2.Visible = True
[AO1] = 1
End Sub
Private Sub ikk2_Click()
ikk2.Visible = False
ixx2.Visible = True
ixx1.Visible = False
ikk1.Visible = True
[AO1] = 2
End Sub

Private Sub ixx3_Click()
ixx3.Visible = False
ikk3.Visible = True
[AO2] = 0
End Sub
Private Sub ikk3_Click()
ikk3.Visible = False
ixx3.Visible = True
ixx4.Visible = False
ikk4.Visible = True
[AO2] = 1
End Sub
Private Sub ixx4_Click()
ixx4.Visible = False
ikk4.Visible = True
[AO2] = 0
End Sub
Private Sub ikk4_Click()
ikk4.Visible = False
ixx4.Visible = True
ixx3.Visible = False
ikk3.Visible = True
[AO2] = 2
End Sub


Private Sub ixx5_Click()
ixx5.Visible = False
ikk5.Visible = True
[AO3] = 0
End Sub
Private Sub ikk5_Click()
ikk5.Visible = False
ixx5.Visible = True
ixx6.Visible = False
ikk6.Visible = True
[AO3] = 1
End Sub
Private Sub ixx6_Click()
ixx6.Visible = False
ikk6.Visible = True
[AO3] = 0
End Sub
Private Sub ikk6_Click()
ikk6.Visible = False
ixx6.Visible = True
ixx5.Visible = False
ikk5.Visible = True
[AO3] = 2
End Sub

Private Sub ikk7_Click()
ikk7.Visible = False
ixx7.Visible = True
ixx8.Visible = False
ikk8.Visible = True
[AO4] = 1
End Sub
Private Sub ikk8_Click()
ikk8.Visible = False
ixx8.Visible = True
ixx7.Visible = False
ikk7.Visible = True
[AO4] = 2
End Sub

Private Sub ikk9_Click()
ikk9.Visible = False
ixx9.Visible = True
ixx10.Visible = False
ikk10.Visible = True
[AO5] = 1
End Sub
Private Sub ikk10_Click()
ikk10.Visible = False
ixx10.Visible = True
ixx9.Visible = False
ikk9.Visible = True
[AO5] = 2
End Sub

Private Sub ixx11_Click()
ixx11.Visible = False
ikk11.Visible = True
[AO6] = 0
End Sub
Private Sub ikk11_Click()
ikk11.Visible = False
ixx11.Visible = True
[AO6] = 1
End Sub

Private Sub ixx12_Click()
ixx12.Visible = False
ikk12.Visible = True
[AO7] = 0
End Sub
Private Sub ikk12_Click()
ikk12.Visible = False
ixx12.Visible = True
[AO7] = 1
End Sub

Private Sub ixx13_Click()
ixx13.Visible = False
ikk13.Visible = True
[AO8] = 0
End Sub
Private Sub ikk13_Click()
ikk13.Visible = False
ixx13.Visible = True
[AO8] = 1
End Sub

Sub Imfreshvat(st)

If ikk1.Visible = True And ixx1.Visible = True Then
Application.ScreenUpdating = False

If [AO1] = 1 Then
ikk1.Visible = False
ixx1.Visible = True
ixx2.Visible = False
ikk2.Visible = True
End If

If [AO1] = 2 Then
ikk2.Visible = False
ixx2.Visible = True
ixx1.Visible = False
ikk1.Visible = True
End If

If [AO2] = 1 Then
ikk3.Visible = False
ixx3.Visible = True
ixx4.Visible = False
ikk4.Visible = True
End If

If [AO2] = 2 Then
ikk4.Visible = False
ixx4.Visible = True
ixx3.Visible = False
ikk3.Visible = True
End If

If [AO3] = 1 Then
ikk5.Visible = False
ixx5.Visible = True
ixx6.Visible = False
ikk6.Visible = True
End If

If [AO3] = 2 Then
ikk6.Visible = False
ixx6.Visible = True
ixx5.Visible = False
ikk5.Visible = True
End If

If [AO4] = 1 Then
ikk7.Visible = False
ixx7.Visible = True
ixx8.Visible = False
ikk8.Visible = True
End If

If [AO4] = 2 Then
ikk8.Visible = False
ixx8.Visible = True
ixx7.Visible = False
ikk7.Visible = True
End If

If [AO5] = 1 Then
ikk9.Visible = False
ixx9.Visible = True
ixx10.Visible = False
ikk10.Visible = True
End If

If [AO5] = 2 Then
ikk10.Visible = False
ixx10.Visible = True
ixx9.Visible = False
ikk9.Visible = True
End If

If [AO6] = 1 Then
ikk11.Visible = False
ixx11.Visible = True
End If

If [AO7] = 1 Then
ikk12.Visible = False
ixx12.Visible = True
End If

If [AO8] = 1 Then
ikk13.Visible = False
ixx13.Visible = True
End If

End If
End Sub




Attribute VB_Name = "Arkusz5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ixx1, 5, 0, MSForms, Image"
Attribute VB_Control = "ixx2, 6, 1, MSForms, Image"
Attribute VB_Control = "ixx3, 7, 2, MSForms, Image"
Attribute VB_Control = "ixx4, 8, 3, MSForms, Image"
Attribute VB_Control = "CommandButton1, 10, 4, MSForms, CommandButton"
Attribute VB_Control = "ikk1, 12, 6, MSForms, Image"
Attribute VB_Control = "ikk2, 13, 7, MSForms, Image"
Attribute VB_Control = "ikk3, 14, 8, MSForms, Image"
Attribute VB_Control = "ikk4, 15, 9, MSForms, Image"
Attribute VB_Control = "ixx5, 16, 10, MSForms, Image"
Attribute VB_Control = "ixx6, 17, 11, MSForms, Image"
Attribute VB_Control = "ixx7, 18, 12, MSForms, Image"
Attribute VB_Control = "ixx8, 19, 13, MSForms, Image"
Attribute VB_Control = "ikk5, 20, 14, MSForms, Image"
Attribute VB_Control = "ikk6, 21, 15, MSForms, Image"
Attribute VB_Control = "ikk7, 22, 16, MSForms, Image"
Attribute VB_Control = "ikk8, 23, 17, MSForms, Image"
Attribute VB_Control = "ixx9, 24, 18, MSForms, Image"
Attribute VB_Control = "ixx10, 25, 19, MSForms, Image"
Attribute VB_Control = "ikk9, 26, 20, MSForms, Image"
Attribute VB_Control = "ikk10, 27, 21, MSForms, Image"
Attribute VB_Control = "ixx11, 28, 22, MSForms, Image"
Attribute VB_Control = "ixx12, 29, 23, MSForms, Image"
Attribute VB_Control = "ikk11, 30, 24, MSForms, Image"
Attribute VB_Control = "ikk12, 31, 25, MSForms, Image"
Attribute VB_Control = "ixx13, 32, 26, MSForms, Image"
Attribute VB_Control = "ixx14, 33, 27, MSForms, Image"
Attribute VB_Control = "ixx15, 34, 28, MSForms, Image"
Attribute VB_Control = "ixx16, 35, 29, MSForms, Image"
Attribute VB_Control = "ikk13, 36, 30, MSForms, Image"
Attribute VB_Control = "ikk14, 37, 31, MSForms, Image"
Attribute VB_Control = "ikk15, 38, 32, MSForms, Image"
Attribute VB_Control = "ikk16, 39, 33, MSForms, Image"
Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub ixx1_Click()
ixx1.Visible = False
ikk1.Visible = True
[W1] = 0
End Sub
Private Sub ikk1_Click()
ikk1.Visible = False
ixx1.Visible = True
ixx2.Visible = False
ikk2.Visible = True
[W1] = 1
End Sub
Private Sub ixx2_Click()
ixx2.Visible = False
ikk2.Visible = True
[W1] = 0
End Sub
Private Sub ikk2_Click()
ikk2.Visible = False
ixx2.Visible = True
ixx1.Visible = False
ikk1.Visible = True
[W1] = 2
End Sub

Private Sub ixx3_Click()
ixx3.Visible = False
ikk3.Visible = True
[W2] = 0
End Sub
Private Sub ikk3_Click()
ikk3.Visible = False
ixx3.Visible = True
ixx4.Visible = False
ikk4.Visible = True
[W2] = 1
End Sub
Private Sub ixx4_Click()
ixx4.Visible = False
ikk4.Visible = True
[W23] = 0
End Sub
Private Sub ikk4_Click()
ikk4.Visible = False
ixx4.Visible = True
ixx3.Visible = False
ikk3.Visible = True
[W2] = 2
End Sub

Private Sub ixx5_Click()
ixx5.Visible = False
ikk5.Visible = True
[W3] = 0
End Sub
Private Sub ikk5_Click()
ikk5.Visible = False
ixx5.Visible = True
ixx6.Visible = False
ikk6.Visible = True
[W3] = 1
End Sub
Private Sub ixx6_Click()
ixx6.Visible = False
ikk6.Visible = True
[W3] = 0
End Sub
Private Sub ikk6_Click()
ikk6.Visible = False
ixx6.Visible = True
ixx5.Visible = False
ikk5.Visible = True
[W3] = 2
End Sub

Private Sub ixx7_Click()
ixx7.Visible = False
ikk7.Visible = True
[W4] = 0
End Sub
Private Sub ikk7_Click()
ikk7.Visible = False
ixx7.Visible = True
ixx8.Visible = False
ikk8.Visible = True
[W4] = 1
End Sub
Private Sub ixx8_Click()
ixx8.Visible = False
ikk8.Visible = True
[W4] = 0
End Sub
Private Sub ikk8_Click()
ikk8.Visible = False
ixx8.Visible = True
ixx7.Visible = False
ikk7.Visible = True
[W4] = 2
End Sub

Private Sub ixx9_Click()
ixx9.Visible = False
ikk9.Visible = True
[W5] = 0
End Sub
Private Sub ikk9_Click()
ikk9.Visible = False
ixx9.Visible = True
ixx10.Visible = False
ikk10.Visible = True
[W5] = 1
End Sub
Private Sub ixx10_Click()
ixx10.Visible = False
ikk10.Visible = True
[W5] = 0
End Sub
Private Sub ikk10_Click()
ikk10.Visible = False
ixx10.Visible = True
ixx9.Visible = False
ikk9.Visible = True
[W5] = 2
End Sub

Private Sub ixx11_Click()
ixx11.Visible = False
ikk11.Visible = True
[W6] = 0
End Sub
Private Sub ikk11_Click()
ikk11.Visible = False
ixx11.Visible = True
ixx12.Visible = False
ikk12.Visible = True
[W6] = 1
End Sub
Private Sub ixx12_Click()
ixx12.Visible = False
ikk12.Visible = True
[W6] = 0
End Sub
Private Sub ikk12_Click()
ikk12.Visible = False
ixx12.Visible = True
ixx11.Visible = False
ikk11.Visible = True
[W6] = 2
End Sub

Private Sub ixx13_Click()
ixx13.Visible = False
ikk13.Visible = True
[W7] = 0
End Sub
Private Sub ikk13_Click()
ikk13.Visible = False
ixx13.Visible = True
ixx14.Visible = False
ikk14.Visible = True
[W7] = 1
End Sub
Private Sub ixx14_Click()
ixx14.Visible = False
ikk14.Visible = True
[W7] = 0
End Sub
Private Sub ikk14_Click()
ikk14.Visible = False
ixx14.Visible = True
ixx13.Visible = False
ikk13.Visible = True
[W7] = 2
End Sub

Private Sub ixx15_Click()
ixx15.Visible = False
ikk15.Visible = True
[W8] = 0
End Sub
Private Sub ikk15_Click()
ikk15.Visible = False
ixx15.Visible = True
ixx16.Visible = False
ikk16.Visible = True
[W8] = 1
End Sub
Private Sub ixx16_Click()
ixx16.Visible = False
ikk16.Visible = True
[w] = 0
End Sub
Private Sub ikk16_Click()
ikk16.Visible = False
ixx16.Visible = True
ixx15.Visible = False
ikk15.Visible = True
[W8] = 2
End Sub

Attribute VB_Name = "Arkusz6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Attribute VB_Name = "Arkusz7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 14, 0, MSForms, CommandButton"
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub
Attribute VB_Name = "Arkusz8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
End Sub

Private Sub CommandButton1_Click()
Wydruk.Show
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub
Attribute VB_Name = "Arkusz9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ikk31, 1, 0, MSForms, Image"
Attribute VB_Control = "ixx33, 2, 1, MSForms, Image"
Attribute VB_Control = "ixx32, 3, 2, MSForms, Image"
Attribute VB_Control = "ixx4, 4, 3, MSForms, Image"
Attribute VB_Control = "ikk3, 5, 4, MSForms, Image"
Attribute VB_Control = "ixx2, 6, 5, MSForms, Image"
Attribute VB_Control = "ixx8, 15, 6, MSForms, Image"
Attribute VB_Control = "ixx9, 16, 7, MSForms, Image"
Attribute VB_Control = "ixx10, 17, 8, MSForms, Image"
Attribute VB_Control = "ixx11, 18, 9, MSForms, Image"
Attribute VB_Control = "ixx12, 19, 10, MSForms, Image"
Attribute VB_Control = "ixx13, 20, 11, MSForms, Image"
Attribute VB_Control = "ixx14, 21, 12, MSForms, Image"
Attribute VB_Control = "ixx15, 22, 13, MSForms, Image"
Attribute VB_Control = "ixx16, 23, 14, MSForms, Image"
Attribute VB_Control = "ixx17, 24, 15, MSForms, Image"
Attribute VB_Control = "ixx18, 25, 16, MSForms, Image"
Attribute VB_Control = "ixx19, 26, 17, MSForms, Image"
Attribute VB_Control = "ixx20, 27, 18, MSForms, Image"
Attribute VB_Control = "ixx21, 28, 19, MSForms, Image"
Attribute VB_Control = "ixx22, 29, 20, MSForms, Image"
Attribute VB_Control = "ikk8, 38, 21, MSForms, Image"
Attribute VB_Control = "ikk9, 39, 22, MSForms, Image"
Attribute VB_Control = "ikk10, 40, 23, MSForms, Image"
Attribute VB_Control = "ikk11, 41, 24, MSForms, Image"
Attribute VB_Control = "ikk12, 42, 25, MSForms, Image"
Attribute VB_Control = "ikk13, 43, 26, MSForms, Image"
Attribute VB_Control = "ikk14, 44, 27, MSForms, Image"
Attribute VB_Control = "ikk15, 45, 28, MSForms, Image"
Attribute VB_Control = "ikk16, 46, 29, MSForms, Image"
Attribute VB_Control = "ikk17, 47, 30, MSForms, Image"
Attribute VB_Control = "ikk18, 48, 31, MSForms, Image"
Attribute VB_Control = "ikk19, 49, 32, MSForms, Image"
Attribute VB_Control = "ikk20, 50, 33, MSForms, Image"
Attribute VB_Control = "ikk21, 51, 34, MSForms, Image"
Attribute VB_Control = "ikk22, 52, 35, MSForms, Image"
Attribute VB_Control = "CommandButton2, 53, 36, MSForms, CommandButton"
Attribute VB_Control = "ixx3, 58, 37, MSForms, Image"
Attribute VB_Control = "ikk4, 59, 38, MSForms, Image"
Attribute VB_Control = "ikk32, 60, 39, MSForms, Image"
Attribute VB_Control = "ikk33, 61, 40, MSForms, Image"
Attribute VB_Control = "ixx31, 62, 41, MSForms, Image"
Attribute VB_Control = "ikk1, 63, 42, MSForms, Image"
Attribute VB_Control = "ixx34, 244, 43, MSForms, Image"
Attribute VB_Control = "ikk34, 245, 44, MSForms, Image"


Private Sub Worksheet_Activate()
Imfreshvat xlOn
End Sub


Private Sub CommandButton4_Click()
'Walid xlOn
'eDeklaracja.Show
End Sub


Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If ActiveWorkbook.Colors(19) = RGB(255, 255, 255) Then
ActiveWorkbook.Colors(19) = RGB(255, 255, 150)
End If
If [D24] = "" And Target.Row = 24 Then Fraza.Show
Imfreshvat xlOn
End Sub

Private Sub CommandButton2_Click()
Wydruk.Show
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.EnableEvents = False
On Error Resume Next
If Not Target.HasFormula And Not IsNumeric(Target.Value) Then Target.Value = UCase(Target.Value)
Application.EnableEvents = True
End Sub

Private Sub CommandButton1_Click()
If ActiveWorkbook.Colors(15) = RGB(234, 234, 234) Then
    ActiveWorkbook.Colors(15) = RGB(255, 255, 255)
    ActiveWorkbook.Colors(16) = RGB(255, 255, 255)
    CommandButton1.Caption = "W|fffd||fffd|cz t|fffd|o"
Else
    ActiveWorkbook.Colors(15) = RGB(234, 234, 234)
    ActiveWorkbook.Colors(16) = RGB(191, 191, 191)
    CommandButton1.Caption = "Wy|fffd||fffd|cz t|fffd|o"
End If

End Sub

Private Sub ixx8_Click()
ixx8.Visible = False
ikk8.Visible = True
[AL4] = 0
End Sub
Private Sub ikk8_Click()
ikk8.Visible = False
ixx8.Visible = True
[AL4] = 1
End Sub

Private Sub ixx9_Click()
ixx9.Visible = False
ikk9.Visible = True
[AL5] = 0
End Sub
Private Sub ikk9_Click()
ikk9.Visible = False
ixx9.Visible = True
[AL5] = 1
End Sub

Private Sub ixx10_Click()
ixx10.Visible = False
ikk10.Visible = True
[AL6] = 0
End Sub
Private Sub ikk10_Click()
ikk10.Visible = False
ixx10.Visible = True
[AL6] = 1
End Sub

Private Sub ixx11_Click()
ixx11.Visible = False
ikk11.Visible = True
[AL7] = 0
End Sub
Private Sub ikk11_Click()
ikk11.Visible = False
ixx11.Visible = True
[AL7] = 1
End Sub

Private Sub ixx12_Click()
ixx12.Visible = False
ikk12.Visible = True
[AL8] = 0
End Sub
Private Sub ikk12_Click()
ikk12.Visible = False
ixx12.Visible = True
[AL8] = 1
End Sub

Private Sub ixx13_Click()
ixx13.Visible = False
ikk13.Visible = True
[AL9] = 0
End Sub
Private Sub ikk13_Click()
ikk13.Visible = False
ixx13.Visible = True
[AL9] = 1
End Sub

Private Sub ixx14_Click()
ixx14.Visible = False
ikk14.Visible = True
[AL10] = 0
End Sub
Private Sub ikk14_Click()
ikk14.Visible = False
ixx14.Visible = True
[AL10] = 1
End Sub

Private Sub ixx15_Click()
ixx15.Visible = False
ikk15.Visible = True
[AL11] = 0
End Sub
Private Sub ikk15_Click()
ikk15.Visible = False
ixx15.Visible = True
[AL11] = 1
End Sub

Private Sub ixx16_Click()
ixx16.Visible = False
ikk16.Visible = True
[AL12] = 0
End Sub
Private Sub ikk16_Click()
ikk16.Visible = False
ixx16.Visible = True
[AL12] = 1
End Sub

Private Sub ixx17_Click()
ixx17.Visible = False
ikk17.Visible = True
[AL13] = 0
End Sub
Private Sub ikk17_Click()
ikk17.Visible = False
ixx17.Visible = True
[AL13] = 1
End Sub

Private Sub ixx18_Click()
ixx18.Visible = False
ikk18.Visible = True
[AL14] = 0
End Sub
Private Sub ikk18_Click()
ikk18.Visible = False
ixx18.Visible = True
[AL14] = 1
End Sub

Private Sub ixx19_Click()
ixx19.Visible = False
ikk19.Visible = True
[AL15] = 0
End Sub
Private Sub ikk19_Click()
ikk19.Visible = False
ixx19.Visible = True
[AL15] = 1
End Sub

Private Sub ixx20_Click()
ixx20.Visible = False
ikk20.Visible = True
[AL16] = 0
End Sub
Private Sub ikk20_Click()
ikk20.Visible = False
ixx20.Visible = True
[AL16] = 1
End Sub

Private Sub ixx21_Click()
ixx21.Visible = False
ikk21.Visible = True
[AL17] = 0
End Sub
Private Sub ikk21_Click()
ikk21.Visible = False
ixx21.Visible = True
[AL17] = 1
End Sub

Private Sub ixx22_Click()
ixx22.Visible = False
ikk22.Visible = True
[AL18] = 0
End Sub
Private Sub ikk22_Click()
ikk22.Visible = False
ixx22.Visible = True
[AL18] = 1
End Sub

Private Sub ikk31_Click()
ikk31.Visible = False
ixx31.Visible = True
ixx32.Visible = False
ikk32.Visible = True
ixx33.Visible = False
ikk33.Visible = True
[AL3] = 1
End Sub
Private Sub ikk32_Click()
ikk32.Visible = False
ixx32.Visible = True
ixx31.Visible = False
ikk31.Visible = True
ixx33.Visible = False
ikk33.Visible = True
[AL3] = 2
End Sub
Private Sub ikk33_Click()
ikk33.Visible = False
ixx33.Visible = True
ixx31.Visible = False
ikk31.Visible = True
ixx32.Visible = False
ikk32.Visible = True
[AL3] = 3
End Sub

Private Sub ixx34_Click()
ixx34.Visible = False
ikk34.Visible = True
[AL20] = 0
End Sub
Private Sub ikk34_Click()
ikk34.Visible = False
ixx34.Visible = True
[AL20] = 1
End Sub


Sub Imfreshvat(st)
If ikk31.Visible = True And ixx31.Visible = True Then
Application.ScreenUpdating = False

If [AL4] = 1 Then
ikk8.Visible = False
ixx8.Visible = True
End If

If [AL5] = 1 Then
ikk9.Visible = False
ixx9.Visible = True
End If

If [AL6] = 1 Then
ikk10.Visible = False
ixx10.Visible = True
End If

If [AL7] = 1 Then
ikk11.Visible = False
ixx11.Visible = True
End If

If [AL8] = 1 Then
ikk12.Visible = False
ixx12.Visible = True
End If

If [AL9] = 1 Then
ikk13.Visible = False
ixx13.Visible = True
End If

If [AL10] = 1 Then
ikk14.Visible = False
ixx14.Visible = True
End If

If [AL11] = 1 Then
ikk15.Visible = False
ixx15.Visible = True
End If

If [AL12] = 1 Then
ikk16.Visible = False
ixx16.Visible = True
End If

If [AL13] = 1 Then
ikk17.Visible = False
ixx17.Visible = True
End If

If [AL14] = 1 Then
ikk18.Visible = False
ixx18.Visible = True
End If

If [AL15] = 1 Then
ikk19.Visible = False
ixx19.Visible = True
End If

If [AL16] = 1 Then
ikk20.Visible = False
ixx20.Visible = True
End If

If [AL17] = 1 Then
ikk21.Visible = False
ixx21.Visible = True
End If

If [AL18] = 1 Then
ikk22.Visible = False
ixx22.Visible = True
End If

If [AL3] = 1 Then
ikk31.Visible = False
ixx31.Visible = True
ixx32.Visible = False
ikk32.Visible = True
ixx33.Visible = False
ikk33.Visible = True
End If

If [AL3] = 2 Then
ikk32.Visible = False
ixx32.Visible = True
ixx31.Visible = False
ikk31.Visible = True
ixx33.Visible = False
ikk33.Visible = True
End If

If [AL3] = 3 Then
ikk33.Visible = False
ixx33.Visible = True
ixx31.Visible = False
ikk31.Visible = True
ixx32.Visible = False
ikk32.Visible = True
End If

If [AL20] = 1 Then
ikk34.Visible = False
ixx34.Visible = True
End If

End If
End Sub

Attribute VB_Name = "Fraza"
Attribute VB_Base = "0{C032B51D-FD5C-45E3-A863-22D37FE8EBC9}{37EB81B6-3615-480E-B6A9-63F2A209F0A6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit
Dim Fraz() As Variant

Private Sub Anuluj_Click()
Unload Me
End Sub

Private Sub ComboBox1_Change()
With Me
.ComboBox1.DropDown
.ComboBox1.List = Filter(Fraz, .ComboBox1.Value, True, vbTextCompare)
End With
End Sub

Private Sub ComboBox1_Click()
ActiveCell = Me.ComboBox1.List
Unload Me
End Sub

Private Sub UserForm_Initialize()
With ActiveSheet
Fraz = Application.Transpose(.Range("AR1:AR" & .Cells(.Rows.Count, "AR").End(xlUp).Row).Value)
Me.ComboBox1.List = Fraz
End With
End Sub




Attribute VB_Name = "Funkcje"
Option Private Module
Public LStr As Integer

#If Win64 Then
Declare PtrSafe Function apiShowWindow Lib "user32" Alias "ShowWindow" _
            (ByVal hwnd As Long, ByVal nCmdSHow As Long) As Long
#Else
Declare Function apiShowWindow Lib "user32" Alias "ShowWindow" ( _
            ByVal hwnd As Long, ByVal nCmdSHow As Long) As Long
#End If
Const SW_SHOWMAXIMIZED = 3

Sub ShowWindow()
Dim IE As Object
    Set IE = CreateObject("InternetExplorer.Application")
    IE.Navigate Nplik
    apiShowWindow IE.hwnd, 3
End Sub

'If CzyID(ActiveCell) = False Then MsgBox "NIP/PESEL " & ActiveCell & " jest b|fffd||fffd|dny!", vbCritical: End
Function CzyID(sID As String) As Boolean
Dim iWag As Variant, iWagi As Variant, i As Integer, iSumaKon As Integer
Application.Volatile
iWag = Array(6, 5, 7, 2, 3, 4, 5, 6, 7)
iWagi = Array(1, 3, 7, 9, 1, 3, 7, 9, 1, 3)
sID = Replace(sID, "-", "")
sID = Replace(sID, " ", "")
If IsNumeric(sID) Then
If Len(sID) = 10 Then
For i = LBound(iWag) To UBound(iWag)
    iSumaKon = iSumaKon + (iWag(i) * CInt(Mid(sID, i + 1, 1)))
Next i
iSumaKon = iSumaKon Mod 11
End If
If Len(sID) = 11 Then
For i = LBound(iWagi) To UBound(iWagi)
    iSumaKon = iSumaKon + (iWagi(i) * CInt(Mid(sID, i + 1, 1)))
Next i
iSumaKon = 10 - iSumaKon Mod 10
End If
End If
If iSumaKon = Right(sID, 1) Then
CzyID = True
Else
CzyID = False
End If
End Function

Function CzyData(sDat As String) As Boolean
Dim Rok As Integer, Mc As Integer, Dz As Integer
Application.Volatile
sDat = Replace(sDat, " ", "")
sDat = Replace(sDat, "-", "/")
sDat = Replace(sDat, ".", "/")
If IsDate(sDat) Then
CzyData = True
Else
CzyData = False
End If
End Function

Function NIP(Adr) 'NIP ""
If CzyID(Range(Adr)) = False Then
Application.EnableEvents = False
Range(Adr).Select
w = Selection.Row
c = Selection.Column
Application.GoTo Cells(w - 5, 1)
Cells(w, c).Select
Application.EnableEvents = True
If Len(Replace(ActiveCell, " ", "")) < 11 Then
MsgBox "B|fffd||fffd|dny NIP", 16, "Uwaga"
Else
MsgBox "B|fffd||fffd|dny PESEL", 16, "Uwaga"
End If
End
End If
End Function

Function UT(ByVal sStr As String)
If IsNumeric(sStr) Then sStr = Replace(Format(sStr, "0.00"), ",", ".")
If sStr = "" Then sStr = "0.00"
UT = sStr
End Function

Function UL(ByVal Nmr As Double)
If Nmr = 0 Then
UL = "0"
Else
UL = Round(Nmr, 0)
End If
End Function

Function ZN(str)
Dim Za As String, Zb As String
Za = Replace(str, "&", "&amp;")
Zb = Replace(Za, "<", "&lt;")
ZN = Replace(Zb, ">", "&gt;")
End Function

Function DATAA(ByVal Dat As String)
Dim Rok, Mc, Dz
  Rok = Right(Dat, 4)
  If Len(Dat) < 8 Then
  Mc = Mid(Dat, 2, 2)
  Dz = "0" & Left(Dat, 1)
  Else
  Mc = Mid(Dat, 3, 2)
  Dz = Left(Dat, 2)
  End If
DATAA = Rok & "-" & Mc & "-" & Dz
End Function


Public Function Base64_Encode(text As String) As String
    Dim arrData() As Byte
    arrData = StrConv(text, vbFromUnicode)
     
    Dim objXML As MSXML2.DOMDocument
    Dim objNode As MSXML2.IXMLDOMElement
     
    Set objXML = New MSXML2.DOMDocument
    Set objNode = objXML.createElement("b64")
     
    objNode.DataType = "bin.base64"
    objNode.nodeTypedValue = arrData
    Base64_Encode = objNode.text
     
    Set objNode = Nothing
    Set objXML = Nothing
End Function

Function XSDValid(strXML As String) As Boolean
    Dim xmlDoc As Object
    Dim objSchema As Object
    Dim objErr As Object
    Dim Que As Integer
    Dim Wzor
    On Error GoTo handleCancel
    Application.EnableCancelKey = xlErrorHandler
   
    Set objSchema = CreateObject("MSXML2.XMLSchemaCache.6.0")
    objSchema.Add "http://crd.gov.pl/wzor/2019/12/11/8928/", _
    "http://pit.waw.pl/xsd/8928schemat.xsd"
    
handleCancel:
    If Abs(Err) > 18 Then
    MsgBox "Wyst|fffd|pi|fffd| problem z pobraniem schematu XSD." & vbCrLf & _
            "" & vbCrLf & vbCrLf & _
            "Mo|fffd|liwy brak dost|fffd|pu do strony Ministerstwa Finans|fffd|w", 64, ""
    Application.StatusBar = False
    Exit Function
    End If
    If Err = 18 Then
    MsgBox "Sprawdzanie zgodno|fffd|ci ze schematem XSD zosta|fffd|o przerwane.", 64, ""
    Application.StatusBar = False
    Exit Function
    End If
    
    Set xmlDoc = CreateObject("Msxml2.DOMDocument.6.0")
    With xmlDoc
        .setProperty "ProhibitDTD", False
        .async = False
        .validateOnParse = True
        .resolveExternals = False
        .Load strXML
        Set .Schemas = objSchema
    End With
               
    Set objErr = xmlDoc.validate()
    If objErr.errorCode <> 0 Then
    Wzor = objErr.reason
    Que = MsgBox("B|fffd||fffd|d: " & Wzor & Chr(13) & Chr(13) & "Czy usun|fffd||fffd| b|fffd||fffd|dny plik:" & vbCrLf & Nplik, 36, "B|fffd||fffd|d")
    If Que = 6 Then Kill Nplik
    Application.StatusBar = False
    End
    Else
    'MsgBox "Plik XML jest zgodny ze schematem XSD", 64, ""
    Application.StatusBar = False
    End If

End Function



Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Workbook_BeforePrint(Cancel As Boolean)
ActiveWorkbook.Colors(19) = RGB(255, 255, 255)
End Sub
Attribute VB_Name = "Wydruk"
Attribute VB_Base = "0{26045BE3-5934-4006-BACF-72C290B7D299}{69792073-D628-407A-B4C0-56884A45671E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
Opt2.Value = True
Application.SendKeys "{tab}{tab}{tab}~"
Application.Dialogs(xlDialogPrinterSetup).Show
End Sub

Private Sub OK_Click()
Dim a As Integer
Unload Me
If Opt1.Value = True Then
    For a = 1 To LStr Step 2
    ActiveWindow.SelectedSheets.PrintOut From:=a, To:=a
    Next
If LStr = 2 Then
MsgBox "W|fffd||fffd| odpowiednio kartk|fffd| do podajnika i drukuj drug|fffd| stron|fffd|", 64, "Drukuj formularz dwustronnie"
ActiveWindow.SelectedSheets.PrintOut From:=2, To:=2
Else
Wydruk2.Show
End If
End If
If Opt2.Value = True Then ActiveWindow.SelectedSheets.PrintOut
End Sub

Private Sub Anuluj_Click()
Unload Me
End Sub

Private Sub UserForm_Initialize()
ActiveWorkbook.Colors(19) = RGB(255, 255, 255)
If Val(Application.Version) > 11 Then
LStr = ActiveSheet.PageSetup.Pages.Count
Else
LStr = ExecuteExcel4Macro("get.document(50)")
End If
If LStr = 1 Then
Unload Me
ActiveWindow.SelectedSheets.PrintOut
End
End If
End Sub

Attribute VB_Name = "Wydruk2"
Attribute VB_Base = "0{B7455722-68AB-4F89-B602-36B4DFF00877}{77D8024A-878D-4406-A80E-A7190EE2C331}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

    
Private Sub OK_Click()
Dim a As Integer, b As Integer
Unload Me
b = 0
If LStr Mod 2 Then
    b = 1
    Range("B4").PrintOut
End If

If Opt1.Value = True Then
    For a = LStr - b To 2 Step -2
    ActiveWindow.SelectedSheets.PrintOut From:=a, To:=a
    Next
End If
If Opt2.Value = True Then
    For a = 2 To LStr - b Step 2
    ActiveWindow.SelectedSheets.PrintOut From:=a, To:=a
    Next
End If
End Sub

Private Sub Anuluj_Click()
Unload Me
End Sub

Private Sub UserForm_Click()

End Sub

Attribute VB_Name = "XML"
Option Private Module
Public eDek As Integer, ePod As Integer
Public Nplik As String
Dim S(53)
Dim SP(64)
Dim M(40)
Dim NZ(29)
Dim PM(44)
Dim WW(15)
Dim IP(33)

Sub Doxml()
Dim ZG As Integer
Dim a, b, c, d, Wer, Wer2, zezn
Dim Dz, Mc, Rok
Dim P(289) As Variant
Dim CO(184) As Variant
Dim CD(119) As Variant
Dim BR(273) As Variant
Dim PR As Object

Application.ScreenUpdating = False
Sheets("CIT-8").Select
If [K87] > 0 Then
MsgBox "Wysy|fffd|ka do e-Deklaracje nie obs|fffd|uguje za|fffd||fffd|cznika SSE-R.", vbInformation, "UWAGA!"
End
End If

'/walidacja
Wer2 = Empty
NRPL:
Nplik = ThisWorkbook.Path & "\CIT-8 " & Left(Range("D37"), 15) & Wer2 & ".xml"
Nplik = Replace(Nplik, """", "")
If Dir(Nplik) <> "" Then
    Wer = Wer + 1
    Wer2 = "(" & Wer & ")"
    GoTo NRPL
End If

P(1) = [C8]
P(2) = [AR2] 'P7
P(3) = [Q94] 'P35
P(4) = [L14]
P(5) = [U14]
P(6) = [AR29]
P(7) = [AR1]
P(8) = [D37]
P(9) = [AR40]
P(10) = [L40]
P(11) = [AC40]
P(12) = [D42]
P(13) = [N42]
P(14) = [AF42]
P(15) = [AL42]
P(16) = [D44]
P(17) = [AC44]
P(18) = [AR3]
P(19) = [AR4]
P(20) = [D52]
P(21) = [AR5]
P(22) = [H56]
P(23) = [D58]
P(24) = [AR6]
P(25) = [AR7]
P(26) = [AR8]
P(27) = [AR9]
P(28) = [AR10]
P(29) = [AR11]
P(30) = [AR12]
P(31) = [AR13]
P(32) = [AR14]
P(33) = [D89]
P(34) = [V88]
P(35) = [AR15]
P(36) = [W94]
P(37) = [AC94]
P(38) = [AJ94]
P(39) = [D96]
P(40) = [H96]
P(41) = [Y96]
P(42) = [AI96]
P(43) = [D98]
P(44) = [L98]
P(45) = [Q98]
P(46) = [Y98]
P(47) = [AI98]
P(48) = [AD105]
P(49) = [AK105]
P(50) = [AD107]
P(51) = [AK107]
P(52) = [AD110]
P(53) = [AK110]
P(54) = [AD112]
P(55) = [AK112]
P(56) = [AD116]
P(57) = [AK116]
P(58) = [AD124]
P(59) = [AK124]
P(60) = [AD126]
P(61) = [AK126]
P(62) = [AD128]
P(63) = [AK128]
P(64) = [AD130]
P(65) = [AK130]
P(66) = [AD132]
P(67) = [AK132]
P(68) = [AD135]
P(69) = [AK135]
P(70) = [AD138]
P(71) = [AK138]
P(72) = [AD141]
P(73) = [AK141]
P(74) = [AD149]
P(75) = [AK149]
P(76) = [AD152]
P(77) = [AK152]
P(78) = [AD155]
P(79) = [AK155]
P(80) = [AD165]
P(81) = [AK165]
P(82) = [AD170]
P(83) = [AK170]
P(84) = [AD179]
P(85) = [AK179]
P(86) = [AD181]
P(87) = [AK181]
P(88) = [AD184]
P(89) = [AK184]
P(90) = [AD187]
P(91) = [AK187]
P(92) = [AD197]
P(93) = [AK197]
P(94) = [AD199]
P(95) = [AK199]
P(96) = [AD201]
P(97) = [AK201]
P(98) = [AD203]
P(99) = [AK203]
P(100) = [AD205]
P(101) = [AK205]
P(102) = [AD208]
P(103) = [AK208]
P(104) = [AD211]
P(105) = [AK211]
P(106) = [AD214]
P(107) = [AK214]
P(108) = [AD219]
P(109) = [AD224]
P(110) = [AD230]
P(111) = [AD232]
P(112) = [AD235]
P(113) = [AD238]
P(114) = [AD240]
P(115) = [AD243]
P(116) = [M253]
P(117) = [AD253]
P(118) = [AD255]
P(119) = [AD258]
P(120) = [AD263]
P(121) = [AD265]
P(122) = [AD267]
P(123) = [AR16]
P(124) = [AD275]
P(125) = [AD277]
P(126) = [AD279]
P(127) = [AD281]
P(128) = [AD283]
P(129) = [W285]
P(130) = [AD285]
P(131) = [I292]
P(132) = [O292]
P(133) = [S292]
P(134) = [X292]
P(135) = [AD292]
P(136) = [AK292]
P(137) = [I294]
P(138) = [O294]
P(139) = [S294]
P(140) = [X294]
P(141) = [AD294]
P(142) = [AK294]
P(143) = [I296]
P(144) = [O296]
P(145) = [S296]
P(146) = [X296]
P(147) = [AD296]
P(148) = [AK296]
P(149) = [I298]
P(150) = [O298]
P(151) = [S298]
P(152) = [X298]
P(153) = [AD298]
P(154) = [AK298]
P(155) = [I301]
P(156) = [O301]
P(157) = [S301]
P(158) = [X301]
P(159) = [AD301]
P(160) = [AK301]
P(161) = [I303]
P(162) = [O303]
P(163) = [S303]
P(164) = [X303]
P(165) = [AD303]
P(166) = [AK303]
P(167) = [I305]
P(168) = [O305]
P(169) = [S305]
P(170) = [X305]
P(171) = [AD305]
P(172) = [AK305]
P(173) = [I307]
P(174) = [O307]
P(175) = [S307]
P(176) = [X307]
P(177) = [AD307]
P(178) = [AK307]
P(179) = [I310]
P(180) = [O310]
P(181) = [S310]
P(182) = [X310]
P(183) = [AD310]
P(184) = [AK310]
P(185) = [I312]
P(186) = [O312]
P(187) = [S312]
P(188) = [X312]
P(189) = [AD312]
P(190) = [AK312]
P(191) = [I314]
P(192) = [O314]
P(193) = [S314]
P(194) = [X314]
P(195) = [AD314]
P(196) = [AK314]
P(197) = [I316]
P(198) = [O316]
P(199) = [S316]
P(200) = [X316]
P(201) = [AD316]
P(202) = [AK316]
P(203) = [I319]
P(204) = [O319]
P(205) = [S319]
P(206) = [X319]
P(207) = [AD319]
P(208) = [AK319]
P(209) = [I329]
P(210) = [O329]
P(211) = [S329]
P(212) = [X329]
P(213) = [AD329]
P(214) = [AK329]
P(215) = [I331]
P(216) = [O331]
P(217) = [S331]
P(218) = [X331]
P(219) = [AD331]
P(220) = [AK331]
P(221) = [I333]
P(222) = [O333]
P(223) = [S333]
P(224) = [X333]
P(225) = [AD333]
P(226) = [AK333]
P(227) = [AD338]
P(228) = [AD340]
P(229) = [AD344]
P(230) = [AD346]
P(231) = [AD348]
P(232) = [AD351]
P(233) = [AD353]
P(234) = [AD356]
P(235) = [I363]
P(236) = [O363]
P(237) = [S363]
P(238) = [X363]
P(239) = [AD363]
P(240) = [AK363]
P(241) = [I365]
P(242) = [O365]
P(243) = [S365]
P(244) = [X365]
P(245) = [AD365]
P(246) = [AK365]
P(247) = [I368]
P(248) = [O368]
P(249) = [S368]
P(250) = [X368]
P(251) = [AD368]
P(252) = [AK368]
P(253) = [I370]
P(254) = [O370]
P(255) = [S370]
P(256) = [X370]
P(257) = [AD370]
P(258) = [AK370]
P(259) = [I373]
P(260) = [O373]
P(261) = [S373]
P(262) = [X373]
P(263) = [AD373]
P(264) = [AK373]
P(265) = [I375]
P(266) = [O375]
P(267) = [S375]
P(268) = [X375]
P(269) = [AD375]
P(270) = [AK375]
P(271) = [I378]
P(272) = [O378]
P(273) = [S378]
P(274) = [X378]
P(275) = [AD378]
P(276) = [I380]
P(277) = [O380]
P(278) = [S380]
P(279) = [X380]
P(280) = [AD380]
P(281) = [AH384]
P(282) = [AH386]
P(283) = [AH388]
P(284) = [AH390]
P(285) = [AR17]
P(286) = [D409]
P(287) = [D415]
P(288) = [D419]
P(289) = [D423]

Set PR = CreateObject("ADODB.Stream")
PR.Type = 2
PR.Charset = "utf-8"
PR.Open

'Zapisanie znacznika <xml>
PR.WriteText "<?xml version=""1.0"" encoding=""UTF-8""?>" & vbNewLine
PR.WriteText "<Deklaracja xmlns=""http://crd.gov.pl/wzor/2019/12/11/8928/"" xmlns:etd=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2018/08/24/eD/DefinicjeTypy/"">" & vbNewLine
PR.WriteText "<Naglowek>" & vbNewLine
PR.WriteText "<KodFormularza kodPodatku=""CIT"" kodSystemowy=""CIT-8 (28)"" rodzajZobowiazania=""Z"" wersjaSchemy=""1-0E"">CIT-8</KodFormularza>" & vbNewLine
PR.WriteText "<WariantFormularza>28</WariantFormularza>" & vbNewLine
PR.WriteText "<CelZlozenia poz=""P_7"">" & P(7) & "</CelZlozenia>" & vbNewLine
PR.WriteText "<OkresOd poz=""P_4"">" & DATAA(P(4)) & "</OkresOd>" & vbNewLine
PR.WriteText "<OkresDo poz=""P_5"">" & DATAA(P(5)) & "</OkresDo>" & vbNewLine
PR.WriteText "<KodUrzedu>" & P(6) & "</KodUrzedu>" & vbNewLine
PR.WriteText "</Naglowek>" & vbNewLine

PR.WriteText "<Podmiot1 rola=""Podatnik"">" & vbNewLine
PR.WriteText "<etd:OsobaNiefizyczna>" & vbNewLine
PR.WriteText "<etd:NIP>" & P(1) & "</etd:NIP>" & vbNewLine
PR.WriteText "<etd:PelnaNazwa>" & ZN(P(8)) & "</etd:PelnaNazwa>" & vbNewLine
PR.WriteText "</etd:OsobaNiefizyczna>" & vbNewLine

PR.WriteText "<etd:AdresSiedziby rodzajAdresu=""RAD"">" & vbNewLine
If P(9) = "PL" Then
PR.WriteText "<etd:AdresPol>" & vbNewLine
PR.WriteText "<etd:KodKraju>" & P(9) & "</etd:KodKraju>" & vbNewLine
PR.WriteText "<etd:Wojewodztwo>" & ZN(P(10)) & "</etd:Wojewodztwo>" & vbNewLine
PR.WriteText "<etd:Powiat>" & ZN(P(11)) & "</etd:Powiat>" & vbNewLine
PR.WriteText "<etd:Gmina>" & ZN(P(12)) & "</etd:Gmina>" & vbNewLine
If P(13) <> "" Then PR.WriteText "<etd:Ulica>" & ZN(P(13)) & "</etd:Ulica>" & vbNewLine
PR.WriteText "<etd:NrDomu>" & P(14) & "</etd:NrDomu>" & vbNewLine
If P(15) <> "" Then PR.WriteText "<etd:NrLokalu>" & ZN(P(15)) & "</etd:NrLokalu>" & vbNewLine
PR.WriteText "<etd:Miejscowosc>" & ZN(P(16)) & "</etd:Miejscowosc>" & vbNewLine
PR.WriteText "<etd:KodPocztowy>" & ZN(P(17)) & "</etd:KodPocztowy>" & vbNewLine
PR.WriteText "</etd:AdresPol>" & vbNewLine
Else
PR.WriteText "<etd:AdresZagr>" & vbNewLine
PR.WriteText "<etd:KodKraju>" & P(9) & "</etd:KodKraju>" & vbNewLine
If P(17) <> "" Then PR.WriteText "<etd:KodPocztowy>" & ZN(P(17)) & "</etd:KodPocztowy>" & vbNewLine
PR.WriteText "<etd:Miejscowosc>" & ZN(P(16)) & "</etd:Miejscowosc>" & vbNewLine
If P(13) <> "" Then PR.WriteText "<etd:Ulica>" & ZN(P(13)) & "</etd:Ulica>" & vbNewLine
If P(14) <> "" Then PR.WriteText "<etd:NrDomu>" & ZN(P(14)) & "</etd:NrDomu>" & vbNewLine
If P(15) <> "" Then PR.WriteText "<etd:NrLokalu>" & ZN(P(15)) & "</etd:NrLokalu>" & vbNewLine
PR.WriteText "</etd:AdresZagr>" & vbNewLine
End If
PR.WriteText "</etd:AdresSiedziby>" & vbNewLine
PR.WriteText "</Podmiot1>" & vbNewLine

PR.WriteText "<PozycjeSzczegolowe>" & vbNewLine

For a = 17 To 287
Select Case a
Case 17
    If P(2) > 0 Then PR.WriteText "<P_7A>" & UL(P(2)) & "</P_7A>" & vbNewLine
'Pola nieobowi|fffd|zkowe 0
Case 18, 21, 25, 26, 27, 28, 29, 30, 31, 33, 36 To 47, 130, 229, 230, 231, 232, 283, 284
    If P(a) <> 0 Then PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
'Pola nieobowi|fffd|zkowe 0,00
Case 22, 23, 58 To 71, 78 To 85, 90, 91, 92 To 105, 109, 113, 114, 115, 117, 118, 122, 124, 125, 127
    If P(a) > 0 Then PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
    
Case 48 To 55
    If P(a) <> "" Then PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
    
Case 110, 111
    If P(a) > 0 Then PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
Case 19
    If P(a + 1) > 0 Then
    PR.WriteText "<P_" & a & ">1</P_" & a & ">" & vbNewLine '19
    PR.WriteText "<P_" & a + 1 & ">" & UT(P(a + 1)) & "</P_" & a + 1 & ">" & vbNewLine ' 20
    End If
'Pola obowi|fffd|zkowe 0
Case 24, 32, 119, 128, 285
    PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
Case 34
If P(a) <> 0 Then PR.WriteText "<P_" & a & ">" & DATAA(P(a)) & "</P_" & a & ">" & vbNewLine
Case 35
PR.WriteText "<P_" & a & ">1</P_" & a & ">" & vbNewLine '35
If P(a) = 1 Then PR.WriteText "<P_35A>" & UL(P(3)) & "</P_35A>" & vbNewLine    ' 35A
    
'Pola obowi|fffd|zkowe 0,00
Case 56, 57, 72, 73, 106, 107, 108, 126
    PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
    
Case 74, 75, 86, 87
    If P(a) > P(a + 2) Then
    PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
    Else
    PR.WriteText "<P_" & a + 2 & ">" & UT(P(a + 2)) & "</P_" & a + 2 & ">" & vbNewLine
    End If
    
Case 112
  If P(110) + P(111) > 0 Then PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
    
Case 116
If P(117) > 0 Then PR.WriteText "<P_" & a & ">" & ZN(P(a)) & "</P_" & a & ">" & vbNewLine
    
Case 120
    If P(123) = 1 Then
    PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
    PR.WriteText "<P_123_1>1</P_123_1>" & vbNewLine
    Else
    PR.WriteText "<P_" & a + 1 & ">" & UL(P(a + 1)) & "</P_" & a + 1 & ">" & vbNewLine
    PR.WriteText "<P_123_2>1</P_123_2>" & vbNewLine
    End If
    
Case 129
    If P(a + 1) > 0 Then PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine

Case 131 To 136, 155 To 160, 179 To 184, 203 To 208
    If P(a) > 0 Then PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
    If P(a + 6) > 0 Then PR.WriteText "<P_" & a + 6 & ">" & UL(P(a + 6)) & "</P_" & a + 6 & ">" & vbNewLine
    If P(a + 12) > 0 Then PR.WriteText "<P_" & a + 12 & ">" & UL(P(a + 12)) & "</P_" & a + 12 & ">" & vbNewLine
    If P(a + 18) > 0 Then PR.WriteText "<P_" & a + 18 & ">" & UL(P(a + 18)) & "</P_" & a + 18 & ">" & vbNewLine
    
Case 227, 233
    If P(a) > P(a + 1) Then
    PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
    Else
    PR.WriteText "<P_" & a + 1 & ">" & UL(P(a + 1)) & "</P_" & a + 1 & ">" & vbNewLine
    End If
    
Case 235 To 240, 247 To 252, 259 To 264
    If P(a) + P(a + 6) > 0 Then
    PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
    PR.WriteText "<P_" & a + 6 & ">" & UL(P(a + 6)) & "</P_" & a + 6 & ">" & vbNewLine
    End If
    
Case 271 To 275
    If P(a) + P(a + 5) > 0 Then
    PR.WriteText "<P_" & a & ">" & UL(P(a)) & "</P_" & a & ">" & vbNewLine
    PR.WriteText "<P_" & a + 5 & ">" & UL(P(a + 5)) & "</P_" & a + 5 & ">" & vbNewLine
    End If
    
Case 281
    If P(a) + P(a + 1) > 0 Then
    PR.WriteText "<P_" & a & ">" & UT(P(a)) & "</P_" & a & ">" & vbNewLine
    PR.WriteText "<P_" & a + 1 & ">" & UL(P(a + 1)) & "</P_" & a + 1 & ">" & vbNewLine
    End If
    
Case 286, 287
    If P(a) <> "" Then PR.WriteText "<P_" & a & ">" & ZN(P(a)) & "</P_" & a & ">" & vbNewLine
   
End Select
Next

PR.WriteText "</PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "<Pouczenia>1</Pouczenia>" & vbNewLine

'ZA|fffd||fffd|CZNIKI
If P(3) + P(37) + P(38) + P(39) + P(40) + P(41) + P(42) + P(43) + P(44) + P(45) + P(46) + P(47) > 0 Then
PR.WriteText "<Zalaczniki>" & vbNewLine

'CIT-ST
If P(3) = 1 Then
Sheets("CIT-ST").Select
PR.WriteText "<czst:Zalacznik_CIT-ST xmlns:czst=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/01/24/eD/CITSTZ/"">" & vbNewLine
PR.WriteText "<czst:Naglowek>" & vbNewLine
PR.WriteText "<czst:KodFormularza kodSystemowy=""CT-STR (7)"" wersjaSchemy=""6-0E"">CIT-ST</czst:KodFormularza>" & vbNewLine
PR.WriteText "<czst:WariantFormularza>7</czst:WariantFormularza>" & vbNewLine
PR.WriteText "<czst:OkresOd poz=""P_4"">" & DATAA([K15]) & "</czst:OkresOd>" & vbNewLine
PR.WriteText "<czst:OkresDo poz=""P_5"">" & DATAA([AQ15]) & "</czst:OkresDo>" & vbNewLine
PR.WriteText "</czst:Naglowek>" & vbNewLine
PR.WriteText "<czst:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "<czst:P_6>1</czst:P_6>" & vbNewLine
PR.WriteText "<czst:P_9>2</czst:P_9>" & vbNewLine
PR.WriteText "<czst:P_22>" & UL([BR60]) & "</czst:P_22>" & vbNewLine
a = 84
For k = 1 To 18
If Cells(a, 3) <> "" Then
PR.WriteText "<czst:P_E typ=""G"">" & vbNewLine
PR.WriteText "<czst:P_A>" & ZN(Cells(a, 3)) & "</czst:P_A>" & vbNewLine
PR.WriteText "<czst:P_B>" & ZN(Cells(a, 18)) & "</czst:P_B>" & vbNewLine
PR.WriteText "<czst:P_C>" & ZN(Cells(a, 41)) & "</czst:P_C>" & vbNewLine
PR.WriteText "<czst:P_D>" & Cells(a, 64) & "</czst:P_D>" & vbNewLine ' 0201011
If Cells(a, 75) <> "" Then PR.WriteText "<czst:P_E1>" & ZN(Cells(a, 75)) & "</czst:P_E1>" & vbNewLine ' nazwa
If Cells(a, 94) <> "" Then PR.WriteText "<czst:P_F1>" & Cells(a, 94) & "</czst:P_F1>" & vbNewLine  ' Regon
If Cells(a + 2, 94) <> "" Then PR.WriteText "<czst:P_F2>" & Cells(a + 2, 94) & "</czst:P_F2>" & vbNewLine ' NIP
PR.WriteText "<czst:P_G>" & Cells(a, 96) & "</czst:P_G>" & vbNewLine ' liczba zatr
PR.WriteText "</czst:P_E>" & vbNewLine
End If
a = a + 4
If a = 116 Then a = 123
Next

PR.WriteText "<czst:P_169>" & DATAA([BS177]) & "</czst:P_169>" & vbNewLine
PR.WriteText "</czst:PozycjeSzczegolowe>" & vbNewLine
If [CR3] = 1 Then
Sheets("CIT-STA").Select
PR.WriteText "<czst:Zalaczniki>" & vbNewLine
PR.WriteText "<csta:Zalacznik_CIT-ST_A xmlns:csta=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/01/24/eD/CITSTA/"">" & vbNewLine
PR.WriteText "<csta:Naglowek>" & vbNewLine
PR.WriteText "<csta:KodFormularza kodSystemowy=""CTSTAR (5)"" wersjaSchemy=""4-0E"">CIT-ST/A</csta:KodFormularza>" & vbNewLine
PR.WriteText "<csta:WariantFormularza>5</csta:WariantFormularza>" & vbNewLine
PR.WriteText "</csta:Naglowek>" & vbNewLine
PR.WriteText "<csta:PozycjeSzczegolowe>" & vbNewLine

    For a = 1 To 4
    If a = 1 Then c = 26
    If a = 2 Then c = 147
    If a = 3 Then c = 268
    If a = 4 Then c = 389
    For b = 0 To 4
    If b = 1 Then d = 17
    If b = 2 Then d = 44
    If b = 3 Then d = 61
    If b = 4 Then d = 78

    If Cells(c + d, 4) <> "" Then
    PR.WriteText "<csta:P_B1 typ=""G"">" & vbNewLine
    PR.WriteText "<csta:P_1>" & ZN(Cells(c + d, 4)) & "</csta:P_1>" & vbNewLine 'nazwa
    If Cells(c + d + 2, 4) <> "" Then PR.WriteText "<csta:P_2>" & ZN(Cells(c + d + 2, 4)) & "</csta:P_2>" & vbNewLine 'nazwa skr
    If Cells(c + d + 4, 4) <> "" Then PR.WriteText "<csta:P_3>" & ZN(Cells(c + d + 4, 4)) & "</csta:P_3>" & vbNewLine 'regon
    If Cells(c + d + 4, 24) <> "" Then PR.WriteText "<csta:P_4>" & ZN(Cells(c + d + 4, 24)) & "</csta:P_4>" & vbNewLine 'nip
    PR.WriteText "<csta:P_5>" & DATAA(Cells(c + d + 6, 32)) & "</csta:P_5>" & vbNewLine 'data
    PR.WriteText "<csta:P_6A>" & Cells(c + d + 9, 3) & "</csta:P_6A>" & vbNewLine 'kraj
    If Cells(c + d + 9, 10) <> "" Then PR.WriteText "<csta:P_7>" & ZN(Cells(c + d + 9, 10)) & "</csta:P_7>" & vbNewLine 'woj
    If Cells(c + d + 9, 30) <> "" Then PR.WriteText "<csta:P_8>" & ZN(Cells(c + d + 9, 30)) & "</csta:P_8>" & vbNewLine 'pow
    If Cells(c + d + 11, 4) <> "" Then PR.WriteText "<csta:P_9>" & ZN(Cells(c + d + 11, 4)) & "</csta:P_9>" & vbNewLine 'gmi
    If Cells(c + d + 11, 12) <> "" Then PR.WriteText "<csta:P_10>" & ZN(Cells(c + d + 11, 12)) & "</csta:P_10>" & vbNewLine 'ulica
    If Cells(c + d + 11, 33) <> "" Then PR.WriteText "<csta:P_11>" & ZN(Cells(c + d + 11, 33)) & "</csta:P_11>" & vbNewLine 'nrd
    If Cells(c + d + 11, 35) <> "" Then PR.WriteText "<csta:P_12>" & ZN(Cells(c + d + 11, 35)) & "</csta:P_12>" & vbNewLine 'nrl
    PR.WriteText "<csta:P_13>" & ZN(Cells(c + d + 13, 4)) & "</csta:P_13>" & vbNewLine 'miejscowosc
    If Cells(c + d + 13, 19) <> "" Then PR.WriteText "<csta:P_14>" & ZN(Cells(c + d + 13, 19)) & "</csta:P_14>" & vbNewLine 'kod
    If Cells(c + d + 13, 27) <> "" Then PR.WriteText "<csta:P_15>" & ZN(Cells(c + d + 13, 27)) & "</csta:P_15>" & vbNewLine 'poczta
    PR.WriteText "</csta:P_B1>" & vbNewLine
    End If
    Next b
    d = 0
    Next a


PR.WriteText "</csta:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</csta:Zalacznik_CIT-ST_A>" & vbNewLine
PR.WriteText "</czst:Zalaczniki>" & vbNewLine
End If

PR.WriteText "</czst:Zalacznik_CIT-ST>" & vbNewLine

Sheets("CIT-8").Select
End If

'CIT-8O
If P(37) = 1 Then
Sheets("CIT-8O").Select
CO(4) = [K12]
CO(5) = [P12]
CO(6) = [D18]
CO(7) = [Q27]
CO(8) = [T27]
CO(9) = [Q29]
CO(10) = [T29]
CO(11) = [Q31]
CO(12) = [T31]
CO(13) = [Q33]
CO(14) = [T33]
CO(15) = [Q35]
CO(16) = [T35]
CO(17) = [Q37]
CO(18) = [T37]
CO(19) = [Q39]
CO(20) = [T39]
CO(21) = [Q41]
CO(22) = [T41]
CO(23) = [Q43]
CO(24) = [T43]
CO(25) = [Q45]
CO(26) = [T45]
CO(27) = [Q47]
CO(28) = [T47]
CO(29) = [Q51]
CO(30) = [T51]
CO(31) = [Q53]
CO(32) = [T53]
CO(33) = [Q55]
CO(34) = [T55]
CO(35) = [Q60]
CO(36) = [T60]
CO(37) = [Q62]
CO(38) = [T62]
CO(39) = [Q66]
CO(40) = [T66]
CO(41) = [Q68]
CO(42) = [T68]
CO(43) = [Q70]
CO(44) = [T70]
CO(45) = [Q80]
CO(46) = [T80]
CO(47) = [Q82]
CO(48) = [T82]
CO(49) = [Q84]
CO(50) = [T84]
CO(51) = [Q86]
CO(52) = [T86]
CO(53) = [Q88]
CO(54) = [T88]
CO(55) = [Q90]
CO(56) = [T90]
CO(57) = [Q92]
CO(58) = [T92]
CO(59) = [Q94]
CO(60) = [T94]
CO(61) = [Q97]
CO(62) = [T97]
CO(63) = [Q99]
CO(64) = [T99]
CO(65) = [Q102]
CO(66) = [T102]
CO(67) = [Q106]
CO(68) = [T106]
CO(69) = [Q108]
CO(70) = [T108]
CO(71) = [L111]
CO(72) = [Q111]
CO(73) = [T111]
CO(74) = [Q115]
CO(75) = [T115]
CO(76) = [D127]
CO(77) = [H127]
CO(78) = [M127]
CO(79) = [P127]
CO(80) = [D129]
CO(81) = [H129]
CO(82) = [M129]
CO(83) = [P129]
CO(84) = [D131]
CO(85) = [H131]
CO(86) = [M131]
CO(87) = [P131]
CO(88) = [D133]
CO(89) = [H133]
CO(90) = [M133]
CO(91) = [P133]
CO(92) = [D135]
CO(93) = [H135]
CO(94) = [M135]
CO(95) = [P135]
CO(96) = [Q135]
CO(97) = [D142]
CO(98) = [H142]
CO(99) = [M142]
CO(100) = [P142]
CO(101) = [D144]
CO(102) = [H144]
CO(103) = [M144]
CO(104) = [P144]
CO(105) = [D146]
CO(106) = [H146]
CO(107) = [M146]
CO(108) = [P146]
CO(109) = [D148]
CO(110) = [H148]
CO(111) = [M148]
CO(112) = [P148]
CO(113) = [D158]
CO(114) = [H158]
CO(115) = [M158]
CO(116) = [P158]
CO(117) = [Q158]
CO(118) = [D165]
CO(119) = [H165]
CO(120) = [M165]
CO(121) = [P165]
CO(122) = [D167]
CO(123) = [H167]
CO(124) = [M167]
CO(125) = [P167]
CO(126) = [D169]
CO(127) = [H169]
CO(128) = [M169]
CO(129) = [P169]
CO(130) = [D171]
CO(131) = [H171]
CO(132) = [M171]
CO(133) = [P171]
CO(134) = [D173]
CO(135) = [H173]
CO(136) = [M173]
CO(137) = [P173]
CO(138) = [Q173]
CO(139) = [Q184]
CO(140) = [T184]
CO(141) = [Q187]
CO(142) = [T187]
CO(143) = [Q190]
CO(144) = [T190]
CO(145) = [Q193]
CO(146) = [T193]
CO(147) = [Q195]
CO(148) = [T195]
CO(149) = [Q200]
CO(150) = [T200]
CO(151) = [J203]
CO(152) = [Q203]
CO(153) = [T203]
CO(154) = [Q207]
CO(155) = [T207]
CO(156) = [Q211]
CO(157) = [T211]
CO(158) = [Q218]
CO(159) = [T218]
CO(160) = [Q220]
CO(161) = [T220]
CO(162) = [Q224]
CO(163) = [T224]
CO(164) = [Q230]
CO(165) = [Q242]
CO(166) = [Q244]
CO(167) = [N246]
CO(168) = [Q247]
CO(169) = [N249]
CO(170) = [N251]
CO(171) = [Q252]
CO(172) = [G253]
CO(173) = [G255]
CO(174) = [Q255]
CO(175) = [Q257]
CO(176) = [Q259]
CO(177) = [Q266]
CO(178) = [Q269]
CO(179) = [Q272]
CO(180) = [Q274]
CO(181) = [Q277]
CO(182) = [Q282]
CO(183) = [Q287]
CO(184) = [Q289]

PR.WriteText "<cz8o:Zalacznik_CIT-8_O xmlns:cz8o=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CIT8O/"">" & vbNewLine
PR.WriteText "<cz8o:Naglowek>" & vbNewLine
PR.WriteText "<cz8o:KodFormularza kodSystemowy=""CIT8/O (15)"" wersjaSchemy=""1-0E"">CIT-8/O</cz8o:KodFormularza>" & vbNewLine
PR.WriteText "<cz8o:WariantFormularza>15</cz8o:WariantFormularza>" & vbNewLine
PR.WriteText "<cz8o:OkresOd poz=""P_4"">" & DATAA(CO(4)) & "</cz8o:OkresOd>" & vbNewLine
PR.WriteText "<cz8o:OkresDo poz=""P_5"">" & DATAA(CO(5)) & "</cz8o:OkresDo>" & vbNewLine
PR.WriteText "</cz8o:Naglowek>" & vbNewLine

PR.WriteText "<cz8o:PozycjeSzczegolowe>" & vbNewLine
For a = 7 To 184
Select Case a
'obow 0,00
Case 152, 153, 154, 155, 160, 161, 174
    PR.WriteText "<cz8o:P_" & a & ">" & UT(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
'nieobow 0
Case a '96, 117, 138
    If CO(a) > 0 Then PR.WriteText "<cz8o:P_" & a & ">" & UL(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine

'nieobow 0,00
Case 7 To 70, 74, 75, 139 To 148, 156, 157, 158, 159, 162, 163, 164, 173, 175 To 182
    If CO(a) > 0 Then PR.WriteText "<cz8o:P_" & a & ">" & UT(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
Case a '71, 149
    If CO(a + 1) + CO(a + 2) > 0 Then
    PR.WriteText "<cz8o:P_" & a & ">" & ZN(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
    If CO(a + 1) > 0 Then PR.WriteText "<cz8o:P_" & a + 1 & ">" & UT(CO(a + 1)) & "</cz8o:P_" & a + 1 & ">" & vbNewLine
    If CO(a + 2) > 0 Then PR.WriteText "<cz8o:P_" & a + 2 & ">" & UT(CO(a + 2)) & "</cz8o:P_" & a + 2 & ">" & vbNewLine
    End If
Case a '76, 80, 84, 88, 92, 97, 101, 105, 109, 113, 118, 122, 126, 130, 134
    If CO(a) > 0 Then
    PR.WriteText "<cz8o:P_" & a & ">" & UL(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a + 1 & ">" & UT(CO(a + 1)) & "</cz8o:P_" & a + 1 & ">" & vbNewLine
    If CO(a + 2) > 0 Then PR.WriteText "<cz8o:P_" & a + 2 & ">" & UT(CO(a + 2)) & "</cz8o:P_" & a + 2 & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a + 3 & ">" & UT(CO(a + 3)) & "</cz8o:P_" & a + 3 & ">" & vbNewLine
    End If
Case a '165
    If CO(a) > 0 Then
    PR.WriteText "<cz8o:P_" & a - 1 & ">" & ZN(CO(a - 1)) & "</cz8o:P_" & a - 1 & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a & ">" & UT(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a + 1 & ">" & DATAA(CO(a + 1)) & "</cz8o:P_" & a + 1 & ">" & vbNewLine
    End If
Case a '169
    If CO(a) > 0 Then
    PR.WriteText "<cz8o:P_" & a - 1 & ">" & DATAA(CO(a - 1)) & "</cz8o:P_" & a - 1 & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a & ">" & UT(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a + 1 & ">" & ZN(CO(a + 1)) & "</cz8o:P_" & a + 1 & ">" & vbNewLine
    End If
Case a '172
    If CO(a) > 0 Then
    PR.WriteText "<cz8o:P_" & a - 1 & ">" & ZN(CO(a - 1)) & "</cz8o:P_" & a - 1 & ">" & vbNewLine
    PR.WriteText "<cz8o:P_" & a & ">" & UT(CO(a)) & "</cz8o:P_" & a & ">" & vbNewLine
    End If
End Select
Next

PR.WriteText "</cz8o:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</cz8o:Zalacznik_CIT-8_O>" & vbNewLine
Sheets("CIT-8").Select
End If

'CIT-BR
If P(38) = 1 Then
Sheets("CIT-BR").Select

BR(4) = [I13]
BR(5) = [P13]
BR(6) = [AJ13]
BR(7) = [D21]
BR(8) = [AO1]
BR(9) = [O26]
BR(10) = [AF26]
BR(11) = [AO2]
BR(12) = [Y40]
BR(13) = [AI40]
BR(14) = [Y42]
BR(15) = [AI42]
BR(16) = [Y44]
BR(17) = [AI44]
BR(18) = [Y46]
BR(19) = [AI46]
BR(20) = [Y48]
BR(21) = [AI48]
BR(22) = [Y50]
BR(23) = [AI50]
BR(24) = [Y52]
BR(25) = [AI52]
BR(26) = [Y55]
BR(27) = [AI55]
BR(28) = [Y57]
BR(29) = [AI57]
BR(30) = [Y59]
BR(31) = [AI59]
BR(32) = [Y75]
BR(33) = [Y77]
BR(34) = [Y80]
BR(35) = [Y84]
BR(36) = [Y89]
BR(37) = [Y92]
BR(38) = [Y94]
BR(39) = [Y96]
BR(40) = [Y99]
BR(41) = [Y102]
BR(42) = [Y104]
BR(43) = [Y106]
BR(44) = [Y108]
BR(45) = [Y110]
BR(46) = [Y112]
BR(47) = [Y115]
BR(48) = [Y126]
BR(49) = [Y130]
BR(50) = [Y132]
BR(51) = [Y134]
BR(52) = [D149]
BR(53) = [D151]
BR(54) = [AO3]
BR(55) = [X159]
BR(56) = [X163]
BR(57) = [X165]
BR(58) = [X167]
BR(59) = [AO4]
BR(60) = [AO5]
BR(61) = [AO6]
BR(62) = [D182] '1
BR(63) = [AO185]
BR(64) = [K185]
BR(65) = [AD185]
BR(66) = [D187]
BR(67) = [M187]
BR(68) = [AH187]
BR(69) = [AK187]
BR(70) = [D189]
BR(71) = [AG189]
BR(72) = [D201] '2
BR(73) = [AO204]
BR(74) = [K204]
BR(75) = [AD204]
BR(76) = [D206]
BR(77) = [M206]
BR(78) = [AH206]
BR(79) = [AK206]
BR(80) = [D208]
BR(81) = [AG208]
BR(82) = [D212] '3
BR(83) = [AO215]
BR(84) = [K215]
BR(85) = [AD215]
BR(86) = [D217]
BR(87) = [M217]
BR(88) = [AH217]
BR(89) = [AK217]
BR(90) = [D219]
BR(91) = [AG219]

PR.WriteText "<czbr:Zalacznik_CIT_BR xmlns:czbr=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITBR/"">" & vbNewLine
PR.WriteText "<czbr:Naglowek>" & vbNewLine
PR.WriteText "<czbr:KodFormularza kodSystemowy=""CIT/BR (6)"" wersjaSchemy=""1-0E"">CIT/BR</czbr:KodFormularza>" & vbNewLine
PR.WriteText "<czbr:WariantFormularza>6</czbr:WariantFormularza>" & vbNewLine
PR.WriteText "<czbr:OkresOd poz=""P_4"">" & DATAA(BR(4)) & "</czbr:OkresOd>" & vbNewLine
PR.WriteText "<czbr:OkresDo poz=""P_5"">" & DATAA(BR(5)) & "</czbr:OkresDo>" & vbNewLine
PR.WriteText "</czbr:Naglowek>" & vbNewLine
PR.WriteText "<czbr:PozycjeSzczegolowe>" & vbNewLine

For a = 8 To 91
Select Case a
Case 8
    PR.WriteText "<czbr:P_" & a & ">" & UL(BR(a)) & "</czbr:P_" & a & ">" & vbNewLine
    If BR(a) = 1 Then
        PR.WriteText "<czbr:P_" & a + 1 & ">" & DATAA(BR(a + 1)) & "</czbr:P_" & a + 1 & ">" & vbNewLine
        PR.WriteText "<czbr:P_" & a + 2 & ">" & DATAA(BR(a + 2)) & "</czbr:P_" & a + 2 & ">" & vbNewLine
        If BR(a + 3) <> 0 Then PR.WriteText "<czbr:P_" & a + 3 & ">" & UL(BR(a + 3)) & "</czbr:P_" & a + 3 & ">" & vbNewLine
    End If
'obow 0
Case 59, 60
PR.WriteText "<czbr:P_" & a & ">" & UL(BR(a)) & "</czbr:P_" & a & ">" & vbNewLine
'obow 0,00
Case 41, 44
    PR.WriteText "<czbr:P_" & a & ">" & UT(BR(a)) & "</czbr:P_" & a & ">" & vbNewLine
'nieobow 0,00
Case 12 To 40, 42, 43, 45 To 51
    If BR(a) > 0 Then PR.WriteText "<czbr:P_" & a & ">" & UT(BR(a)) & "</czbr:P_" & a & ">" & vbNewLine

'nieobow 0
Case 52
    If BR(a) <> "" Then
    PR.WriteText "<czbr:P_" & a & ">" & ZN(BR(a)) & "</czbr:P_" & a & ">" & vbNewLine
    PR.WriteText "<czbr:P_" & a + 1 & ">" & ZN(BR(a + 1)) & "</czbr:P_" & a + 1 & ">" & vbNewLine
    PR.WriteText "<czbr:P_" & a + 2 & ">" & UL(BR(a + 2)) & "</czbr:P_" & a + 2 & ">" & vbNewLine
    PR.WriteText "<czbr:P_" & a + 3 & ">" & UT(BR(a + 3)) & "</czbr:P_" & a + 3 & ">" & vbNewLine
    PR.WriteText "<czbr:P_" & a + 4 & ">" & UT(BR(a + 4)) & "</czbr:P_" & a + 4 & ">" & vbNewLine
    PR.WriteText "<czbr:P_" & a + 5 & ">" & UT(BR(a + 5)) & "</czbr:P_" & a + 5 & ">" & vbNewLine
    PR.WriteText "<czbr:P_" & a + 6 & ">" & UT(BR(a + 6)) & "</czbr:P_" & a + 6 & ">" & vbNewLine
    End If
Case 61
If BR(8) = 2 Then
    If BR(61) > 0 Then PR.WriteText "<czbr:P_61>" & UL(BR(61)) & "</czbr:P_61>" & vbNewLine
    If BR(62) > 0 Then PR.WriteText "<czbr:P_62>" & UL(BR(62)) & "</czbr:P_62>" & vbNewLine
End If

End Select
Next

If BR(59) = 1 Then
    For a = 1 To 3
    If a = 1 Then c = 63
    If a = 2 Then c = 74
    If a = 3 Then c = 85
    
    If BR(c) <> "" Then
    PR.WriteText "<czbr:P_F typ=""G"">" & vbNewLine
    PR.WriteText "<czbr:P_F63>" & ZN(BR(c)) & "</czbr:P_F63>" & vbNewLine 'nazwa
    PR.WriteText "<czbr:P_F64A>" & BR(c + 1) & "</czbr:P_F64A>" & vbNewLine 'kraj
    If BR(c + 2) <> "" Then PR.WriteText "<czbr:P_F65>" & ZN(BR(c + 2)) & "</czbr:P_F65>" & vbNewLine 'woj
    If BR(c + 3) <> "" Then PR.WriteText "<czbr:P_F66>" & ZN(BR(c + 3)) & "</czbr:P_F66>" & vbNewLine 'pow
    If BR(c + 4) <> "" Then PR.WriteText "<czbr:P_F67>" & ZN(BR(c + 4)) & "</czbr:P_F67>" & vbNewLine 'gmi
    If BR(c + 5) <> "" Then PR.WriteText "<czbr:P_F68>" & ZN(BR(c + 5)) & "</czbr:P_F68>" & vbNewLine 'ulica
    If BR(c + 6) <> "" Then PR.WriteText "<czbr:P_F69>" & ZN(BR(c + 6)) & "</czbr:P_F69>" & vbNewLine 'nrd
    If BR(c + 7) <> "" Then PR.WriteText "<czbr:P_F70>" & ZN(BR(c + 7)) & "</czbr:P_F70>" & vbNewLine 'nrl
    PR.WriteText "<czbr:P_F71>" & ZN(BR(c + 8)) & "</czbr:P_F71>" & vbNewLine 'miejscowosc
    If BR(c + 9) <> "" Then PR.WriteText "<czbr:P_F72>" & ZN(BR(c + 9)) & "</czbr:P_F72>" & vbNewLine 'kod
    If BR(c + 10) <> "" Then PR.WriteText "<czbr:P_F73>" & ZN(BR(c + 10)) & "</czbr:P_F73>" & vbNewLine 'poczta
    PR.WriteText "</czbr:P_F>" & vbNewLine
    End If
    Next a
End If

PR.WriteText "</czbr:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czbr:Zalacznik_CIT_BR>" & vbNewLine
Sheets("CIT-8").Select
End If


'CIT-D
If P(39) = 1 Then
Sheets("CIT-D").Select
CITCD

PR.WriteText "<czd:Zalacznik_CIT-D xmlns:czd=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITD/"">" & vbNewLine
PR.WriteText "<czd:Naglowek>" & vbNewLine
PR.WriteText "<czd:KodFormularza kodSystemowy=""CIT-D (7)"" wersjaSchemy=""2-0E"">CIT-D</czd:KodFormularza>" & vbNewLine
PR.WriteText "<czd:WariantFormularza>7</czd:WariantFormularza>" & vbNewLine
PR.WriteText "<czd:OkresOd poz=""P_4"">" & DATAA(P(4)) & "</czd:OkresOd>" & vbNewLine
PR.WriteText "<czd:OkresDo poz=""P_5"">" & DATAA(P(5)) & "</czd:OkresDo>" & vbNewLine
PR.WriteText "</czd:Naglowek>" & vbNewLine
PR.WriteText "<czd:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "<czd:P_6>1</czd:P_6>" & vbNewLine
PR.WriteText "<czd:P_8>2</czd:P_8>" & vbNewLine
PR.WriteText "<czd:P_10>" & CD(10) & "</czd:P_10>" & vbNewLine

For a = 22 To 118
Select Case a
'nieobow 0,00
Case 22 To 25
    If CD(a) > 0 Then PR.WriteText "<czd:P_" & a & ">" & UT(CD(a)) & "</czd:P_" & a & ">" & vbNewLine
'nieobow
Case 26, 37, 48
    If CD(a) <> "" Then
        PR.WriteText "<czd:P_" & a & ">" & ZN(CD(a)) & "</czd:P_" & a & ">" & vbNewLine
        PR.WriteText "<czd:P_" & a + 1 & "A>" & ZN(CD(a + 1)) & "</czd:P_" & a + 1 & "A>" & vbNewLine
        If CD(a + 2) <> "" Then PR.WriteText "<czd:P_" & a + 2 & ">" & ZN(CD(a + 2)) & "</czd:P_" & a + 2 & ">" & vbNewLine '28
        If CD(a + 3) <> "" Then PR.WriteText "<czd:P_" & a + 3 & ">" & ZN(CD(a + 3)) & "</czd:P_" & a + 3 & ">" & vbNewLine '29
        If CD(a + 4) <> "" Then PR.WriteText "<czd:P_" & a + 4 & ">" & ZN(CD(a + 4)) & "</czd:P_" & a + 4 & ">" & vbNewLine '30
        If CD(a + 5) <> "" Then PR.WriteText "<czd:P_" & a + 5 & ">" & ZN(CD(a + 5)) & "</czd:P_" & a + 5 & ">" & vbNewLine '31
        If CD(a + 6) <> "" Then PR.WriteText "<czd:P_" & a + 6 & ">" & ZN(CD(a + 6)) & "</czd:P_" & a + 6 & ">" & vbNewLine '32
        If CD(a + 7) <> "" Then PR.WriteText "<czd:P_" & a + 7 & ">" & ZN(CD(a + 7)) & "</czd:P_" & a + 7 & ">" & vbNewLine '33
        PR.WriteText "<czd:P_" & a + 8 & ">" & ZN(CD(a + 8)) & "</czd:P_" & a + 8 & ">" & vbNewLine '34
        If CD(a + 9) <> "" Then PR.WriteText "<czd:P_" & a + 9 & ">" & ZN(CD(a + 9)) & "</czd:P_" & a + 9 & ">" & vbNewLine '35
        If CD(a + 10) <> "" Then PR.WriteText "<czd:P_" & a + 10 & ">" & ZN(CD(a + 10)) & "</czd:P_" & a + 10 & ">" & vbNewLine '36
    End If
'nieobow 0
Case 59 To 73
    If CD(a) > 0 Then PR.WriteText "<czd:P_" & a & ">" & UL(CD(a)) & "</czd:P_" & a & ">" & vbNewLine

Case 74, 89, 104
    If CD(a) > 0 Then
        PR.WriteText "<czd:P_" & a & ">" & UT(CD(a)) & "</czd:P_" & a & ">" & vbNewLine
        PR.WriteText "<czd:P_" & a + 1 & ">" & UT(CD(a + 1)) & "</czd:P_" & a + 1 & ">" & vbNewLine
        PR.WriteText "<czd:P_" & a + 2 & ">" & ZN(CD(a + 2)) & "</czd:P_" & a + 2 & ">" & vbNewLine '76
        PR.WriteText "<czd:P_" & a + 3 & ">" & ZN(CD(a + 3)) & "</czd:P_" & a + 3 & ">" & vbNewLine '77
        PR.WriteText "<czd:P_" & a + 4 & ">" & ZN(CD(a + 4)) & "</czd:P_" & a + 4 & ">" & vbNewLine '78
        PR.WriteText "<czd:P_" & a + 5 & "A>" & ZN(CD(a + 5)) & "</czd:P_" & a + 5 & "A>" & vbNewLine '79
        If CD(a + 6) <> "" Then PR.WriteText "<czd:P_" & a + 6 & ">" & ZN(CD(a + 6)) & "</czd:P_" & a + 6 & ">" & vbNewLine '80
        If CD(a + 7) <> "" Then PR.WriteText "<czd:P_" & a + 7 & ">" & ZN(CD(a + 7)) & "</czd:P_" & a + 7 & ">" & vbNewLine '81
        If CD(a + 8) <> "" Then PR.WriteText "<czd:P_" & a + 8 & ">" & ZN(CD(a + 8)) & "</czd:P_" & a + 8 & ">" & vbNewLine '82
        If CD(a + 9) <> "" Then PR.WriteText "<czd:P_" & a + 9 & ">" & ZN(CD(a + 9)) & "</czd:P_" & a + 9 & ">" & vbNewLine '83
        If CD(a + 10) <> "" Then PR.WriteText "<czd:P_" & a + 10 & ">" & ZN(CD(a + 10)) & "</czd:P_" & a + 10 & ">" & vbNewLine '84
        If CD(a + 11) <> "" Then PR.WriteText "<czd:P_" & a + 11 & ">" & ZN(CD(a + 11)) & "</czd:P_" & a + 11 & ">" & vbNewLine '85
        PR.WriteText "<czd:P_" & a + 12 & ">" & ZN(CD(a + 12)) & "</czd:P_" & a + 12 & ">" & vbNewLine '86
        If CD(a + 13) <> "" Then PR.WriteText "<czd:P_" & a + 13 & ">" & ZN(CD(a + 13)) & "</czd:P_" & a + 13 & ">" & vbNewLine '87
        If CD(a + 14) <> "" Then PR.WriteText "<czd:P_" & a + 14 & ">" & ZN(CD(a + 14)) & "</czd:P_" & a + 14 & ">" & vbNewLine '88
    End If
End Select
Next a

PR.WriteText "</czd:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czd:Zalacznik_CIT-D>" & vbNewLine
Sheets("CIT-8").Select
End If


'sprawozdanie SPRMT
If P(40) = 1 Then
Sheets("SPRMT").Select
Dim SPR(34)
SPR(7) = DATAA([D27])
SPR(8) = [P27]
SPR(9) = DATAA([G29])
SPR(10) = DATAA([T29])
SPR(11) = [AE1]
SPR(12) = ZN([D41])
SPR(13) = [D43]
SPR(14) = [d45]
SPR(15) = [K45]
SPR(16) = [AB45]
SPR(17) = [AE47]
SPR(18) = [h47]
SPR(19) = [T47]
SPR(20) = [D49]
SPR(21) = [J49]
SPR(22) = [X49]
SPR(23) = [AA49]
SPR(24) = [D51]
SPR(25) = [N51]
SPR(26) = [S51]
SPR(27) = [D58]
SPR(28) = [D60]
SPR(29) = [D62]
SPR(30) = [D64]
SPR(31) = [D80]
SPR(32) = [D82]
SPR(33) = [D84]
SPR(34) = DATAA([D86])
PR.WriteText "<czmt:Zalacznik_SPR_MT xmlns:czmt=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2018/11/30/eD/SPRMT/"">"
PR.WriteText "<czmt:Naglowek>"
PR.WriteText "<czmt:KodFormularza kodSystemowy=""SPR/MT (1)"" wersjaSchemy=""3-0E"">SPR/MT</czmt:KodFormularza>"
PR.WriteText "<czmt:WariantFormularza>1</czmt:WariantFormularza>"
PR.WriteText "<czmt:OkresOd poz=""P_4"">" & DATAA([I14]) & "</czmt:OkresOd>"
PR.WriteText "<czmt:OkresDo poz=""P_5"">" & DATAA([Q14]) & "</czmt:OkresDo>"
PR.WriteText "</czmt:Naglowek>"
PR.WriteText "<czmt:Podmiot1 rola=""Podatnik"">"
PR.WriteText "<etd:OsobaNiefizyczna>"
PR.WriteText "<etd:NIP>" & [C8] & "</etd:NIP>"
PR.WriteText "<etd:PelnaNazwa>" & [D21] & "</etd:PelnaNazwa>"
PR.WriteText "</etd:OsobaNiefizyczna>"
PR.WriteText "</czmt:Podmiot1>"
PR.WriteText "<czmt:PozycjeSzczegolowe>"

For a = 7 To 34
Select Case a
Case 7 To 10, 12, 24
If SPR(a) = 0 Then MsgBox "Nie wype|fffd|niono poz. " & a, 16, "B|fffd||fffd|d  w SPR/MT": GoTo KILLE
PR.WriteText "<czmt:P_" & a & ">" & UT(SPR(a)) & "</czmt:P_" & a & ">" & vbNewLine
Case 11
If SPR(a) = 0 Then MsgBox "Nie wype|fffd|niono poz. " & a, 16, "B|fffd||fffd|d  w SPR/MT": GoTo KILLE
PR.WriteText "<czmt:P_" & a & ">" & UL(SPR(a)) & "</czmt:P_" & a & ">" & vbNewLine
Case 17
If SPR(a) = 0 Then MsgBox "Nie wype|fffd|niono poz. " & a, 16, "B|fffd||fffd|d  w SPR/MT": GoTo KILLE
PR.WriteText "<czmt:P_17A>" & UT(SPR(a)) & "</czmt:P_17A>" & vbNewLine
Case 13, 14, 15, 16, 18 To 23, 25, 26, 27 To 33
If SPR(a) <> "" Then PR.WriteText "<czmt:P_" & a & ">" & ZN(SPR(a)) & "</czmt:P_" & a & ">" & vbNewLine
Case 34
If SPR(a) = 0 Then MsgBox "Nie wype|fffd|niono poz. " & a, 16, "B|fffd||fffd|d  w SPR/MT": GoTo KILLE
PR.WriteText "<czmt:P_" & a & ">" & UT(SPR(a)) & "</czmt:P_" & a & ">" & vbNewLine
End Select
Next
PR.WriteText "</czmt:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czmt:Zalacznik_SPR_MT>" & vbNewLine
Sheets("CIT-8").Select
End If

'sprawozdanie CIT-MIT
If P(41) = 1 Then
Sheets("CIT-MIT").Select
CITMIT

PR.WriteText "<czmit:Zalacznik_CIT_MIT xmlns:czmit=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITMIT/"">" & vbNewLine
PR.WriteText "<czmit:Naglowek>" & vbNewLine
PR.WriteText "<czmit:KodFormularza kodSystemowy=""CITMIT (3)"" wersjaSchemy=""1-0E"">CIT/MIT</czmit:KodFormularza>" & vbNewLine
PR.WriteText "<czmit:WariantFormularza>3</czmit:WariantFormularza>" & vbNewLine
PR.WriteText "<czmit:OkresOd poz=""P_4"">" & DATAA(P(4)) & "</czmit:OkresOd>" & vbNewLine
PR.WriteText "<czmit:OkresDo poz=""P_5"">" & DATAA(P(5)) & "</czmit:OkresDo>" & vbNewLine
PR.WriteText "</czmit:Naglowek>" & vbNewLine
PR.WriteText "<czmit:PozycjeSzczegolowe>" & vbNewLine


    For a = 1 To 4
    If a = 1 Then c = 8
    If a = 2 Then c = 35
    If a = 3 Then c = 62
    If a = 4 Then c = 89
    
    If M(c) <> "" Then
    PR.WriteText "<czmit:P_B typ=""G"">" & vbNewLine
    PR.WriteText "<czmit:P_B8>" & ZN(M(c)) & "</czmit:P_B8>" & vbNewLine 'nazwa
    PR.WriteText "<czmit:P_B9>" & UL(M(c + 1)) & "</czmit:P_B9>" & vbNewLine 'warto|fffd||fffd|
    
    If M(c + 2) > 0 Or M(c + 3) > 0 Then
        PR.WriteText "<czmit:P_B10>" & M(c + 2) & "</czmit:P_B10>" & vbNewLine '10
        PR.WriteText "<czmit:P_B11>" & UL(M(c + 3)) & "</czmit:P_B11>" & vbNewLine '11
    End If
    For i = 12 To 34
    If M(c + i - 8) > 0 Then PR.WriteText "<czmit:P_B" & i & ">" & UL(M(c + i - 8)) & "</czmit:P_B" & i & ">" & vbNewLine
    Next
    PR.WriteText "</czmit:P_B>" & vbNewLine
    End If
    Next a

PR.WriteText "</czmit:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czmit:Zalacznik_CIT_MIT>" & vbNewLine
Sheets("CIT-8").Select
End If

'sprawozdanie CIT-NZI
If P(42) = 1 Then
Sheets("CIT-NZI").Select
CITNZ

PR.WriteText "<cznz:Zalacznik_CIT_NZI xmlns:cznz=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITMIT/"">" & vbNewLine
PR.WriteText "<cznz:Naglowek>" & vbNewLine
PR.WriteText "<cznz:KodFormularza kodSystemowy=""CITNZI (2)"" wersjaSchemy=""1-0E"">CIT/NZI</cznz:KodFormularza>" & vbNewLine
PR.WriteText "<cznz:WariantFormularza>2</cznz:WariantFormularza>" & vbNewLine
PR.WriteText "<cznz:OkresOd poz=""P_4"">" & DATAA(P(4)) & "</cznz:OkresOd>" & vbNewLine
PR.WriteText "<cznz:OkresDo poz=""P_5"">" & DATAA(P(5)) & "</cznz:OkresDo>" & vbNewLine
PR.WriteText "</cznz:Naglowek>" & vbNewLine
PR.WriteText "<cznz:PozycjeSzczegolowe>" & vbNewLine



PR.WriteText "</cznz:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</cznz:Zalacznik_CIT_NZI>" & vbNewLine
Sheets("CIT-8").Select
End If

'sprawozdanie CIT-8SP
If P(43) = 1 Then
Sheets("CIT-SP").Select
CIT8SP


PR.WriteText "<cz8sp:Zalacznik_CIT_8SP xmlns:cz8sp=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CIT8SP/"">" & vbNewLine
PR.WriteText "<cz8sp:Naglowek>" & vbNewLine
PR.WriteText "<cz8sp:KodFormularza kodSystemowy=""CIT8SP (3)"" wersjaSchemy=""1-0E"">CIT/8SP</cz8sp:KodFormularza>" & vbNewLine
PR.WriteText "<cz8sp:WariantFormularza>3</cz8sp:WariantFormularza>" & vbNewLine
PR.WriteText "<cz8sp:OkresOd poz=""P_4"">" & DATAA(SP(4)) & "</cz8sp:OkresOd>" & vbNewLine
PR.WriteText "<cz8sp:OkresDo poz=""P_5"">" & DATAA(SP(5)) & "</cz8sp:OkresDo>" & vbNewLine
PR.WriteText "</cz8sp:Naglowek>" & vbNewLine
PR.WriteText "<cz8sp:PozycjeSzczegolowe>" & vbNewLine


    For a = 1 To 2
    If a = 1 Then c = 8
    If a = 2 Then c = 36
        If SP(c) <> "" Then
        PR.WriteText "<cz8sp:P_B typ=""G"">" & vbNewLine
        PR.WriteText "<cz8sp:P_B8>" & ZN(SP(c)) & "</cz8sp:P_B8>" & vbNewLine 'nazwa
        PR.WriteText "<cz8sp:P_B9>" & DATAA(SP(c + 1)) & "</cz8sp:P_B9>" & vbNewLine 'data
        PR.WriteText "<cz8sp:P_B10>" & DATAA(SP(c + 2)) & "</cz8sp:P_B10>" & vbNewLine 'data
        PR.WriteText "<cz8sp:P_B11>" & ZN(SP(c + 3)) & "</cz8sp:P_B11>" & vbNewLine 'nazwa
        PR.WriteText "<cz8sp:P_B12>" & ZN(SP(c + 4)) & "</cz8sp:P_B12>" & vbNewLine 'nip
        PR.WriteText "<cz8sp:P_B13>" & UT(SP(c + 5)) & "</cz8sp:P_B13>" & vbNewLine 'nazwa
        For i = 14 To 21
        PR.WriteText "<cz8sp:P_B" & i & ">" & UT(SP(c + i - 8)) & "</cz8sp:P_B" & i & ">" & vbNewLine
        Next
        PR.WriteText "</cz8sp:P_B>" & vbNewLine
        End If
    Next a

    For a = 1 To 3
    If a = 1 Then c = 22
    If a = 2 Then c = 50
    If a = 3 Then c = 56
        If SP(c) <> "" Then
        PR.WriteText "<cz8sp:P_C typ=""G"">" & vbNewLine
        PR.WriteText "<cz8sp:P_C22>" & ZN(SP(c)) & "</cz8sp:P_C22>" & vbNewLine 'nazwa
        PR.WriteText "<cz8sp:P_C23>" & DATAA(SP(c + 1)) & "</cz8sp:P_C23>" & vbNewLine 'data
        PR.WriteText "<cz8sp:P_C24>" & UT(SP(c + 2)) & "</cz8sp:P_C24>" & vbNewLine 'data
        PR.WriteText "<cz8sp:P_C25>" & UT(SP(c + 3)) & "</cz8sp:P_C25>" & vbNewLine 'nazwa
        PR.WriteText "<cz8sp:P_C26>" & UT(SP(c + 4)) & "</cz8sp:P_C26>" & vbNewLine 'nip
        PR.WriteText "<cz8sp:P_C27>" & UT(SP(c + 5)) & "</cz8sp:P_C27>" & vbNewLine 'nazwa
        PR.WriteText "</cz8sp:P_C>" & vbNewLine
        End If
    Next a
    PR.WriteText "<cz8sp:P_28>" & UT(SP(28)) & "</cz8sp:P_28>" & vbNewLine 'nazwa

    c = 29
        If SP(c) <> "" Then
        PR.WriteText "<cz8sp:P_D typ=""G"">" & vbNewLine
        PR.WriteText "<cz8sp:P_D29>" & ZN(SP(c)) & "</cz8sp:P_D29>" & vbNewLine 'nazwa
        PR.WriteText "<cz8sp:P_D30>" & DATAA(SP(c + 1)) & "</cz8sp:P_D30>" & vbNewLine 'data
        PR.WriteText "<cz8sp:P_D31>" & UT(SP(c + 2)) & "</cz8sp:P_D31>" & vbNewLine 'kwota
        PR.WriteText "<cz8sp:P_D32>" & UT(SP(c + 3)) & "</cz8sp:P_D32>" & vbNewLine 'kwota
        PR.WriteText "</cz8sp:P_D>" & vbNewLine
        End If
    PR.WriteText "<cz8sp:P_33>" & UT(SP(33)) & "</cz8sp:P_33>" & vbNewLine 'nazwa

If SP(35) <> "" Then
PR.WriteText "<cz8sp:P_34>" & UT(SP(34)) & "</cz8sp:P_34>" & vbNewLine
PR.WriteText "<cz8sp:P_35>" & ZN(SP(35)) & "</cz8sp:P_35>" & vbNewLine 'nazwa
End If

PR.WriteText "</cz8sp:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</cz8sp:Zalacznik_CIT_8SP>" & vbNewLine

Sheets("CIT-8").Select
End If

'sprawozdanie CIT-8S
If P(44) = 1 Then
CITS
Sheets("CIT-8S").Select
PR.WriteText "<cz8s:Zalacznik_CIT_8S xmlns:cz8s=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CIT8S/"">" & vbNewLine
PR.WriteText "<cz8s:Naglowek>" & vbNewLine
PR.WriteText "<cz8s:KodFormularza kodSystemowy=""CIT/8S (3)"" wersjaSchemy=""1-0E"">CIT/8S</cz8s:KodFormularza>" & vbNewLine
PR.WriteText "<cz8s:WariantFormularza>3</cz8s:WariantFormularza>" & vbNewLine
PR.WriteText "<cz8s:OkresOd poz=""P_4"">" & DATAA(S(4)) & "</cz8s:OkresOd>" & vbNewLine
PR.WriteText "<cz8s:OkresDo poz=""P_5"">" & DATAA(S(5)) & "</cz8s:OkresDo>" & vbNewLine
PR.WriteText "</cz8s:Naglowek>" & vbNewLine
PR.WriteText "<cz8s:PozycjeSzczegolowe>" & vbNewLine


    For a = 1 To 2
    If a = 1 Then c = 8
    If a = 2 Then c = 33
    
    If S(c) <> "" Then
    PR.WriteText "<cz8s:P_B typ=""G"">" & vbNewLine
    PR.WriteText "<cz8s:P_B8>" & ZN(S(c)) & "</cz8s:P_B8>" & vbNewLine 'nr zezw
    PR.WriteText "<cz8s:P_B9>" & DATAA(S(c + 1)) & "</cz8s:P_B9>" & vbNewLine 'data
    PR.WriteText "<cz8s:P_B10>" & DATAA(S(c + 2)) & "</cz8s:P_B10>" & vbNewLine 'data
    
    PR.WriteText "<cz8s:P_B11>" & UT(S(c + 3)) & "</cz8s:P_B11>" & vbNewLine
    PR.WriteText "<cz8s:P_B12>" & UT(S(c + 4)) & "</cz8s:P_B12>" & vbNewLine
    PR.WriteText "<cz8s:P_B13>" & UT(S(c + 5)) & "</cz8s:P_B13>" & vbNewLine
    PR.WriteText "<cz8s:P_B14>" & UT(S(c + 6)) & "</cz8s:P_B14>" & vbNewLine
    PR.WriteText "<cz8s:P_B15>" & UT(S(c + 7)) & "</cz8s:P_B15>" & vbNewLine
    PR.WriteText "<cz8s:P_B16>" & UT(S(c + 8)) & "</cz8s:P_B16>" & vbNewLine
    PR.WriteText "<cz8s:P_B17>" & UT(S(c + 9)) & "</cz8s:P_B17>" & vbNewLine
    PR.WriteText "<cz8s:P_B18>" & UT(S(c + 10)) & "</cz8s:P_B18>" & vbNewLine
    PR.WriteText "</cz8s:P_B>" & vbNewLine
    End If
    Next
    
    For a = 1 To 2
    If a = 1 Then c = 19
    If a = 2 Then c = 44
    If S(c) <> "" Then
        PR.WriteText "<cz8s:P_C typ=""G"">" & vbNewLine
        PR.WriteText "<cz8s:P_C19>" & ZN(S(c)) & "</cz8s:P_C19>" & vbNewLine 'nr zezw
        PR.WriteText "<cz8s:P_C20>" & DATAA(S(c + 1)) & "</cz8s:P_C20>" & vbNewLine 'data
        PR.WriteText "<cz8s:P_C21>" & UT(S(c + 2)) & "</cz8s:P_C21>" & vbNewLine
        PR.WriteText "<cz8s:P_C22>" & UT(S(c + 3)) & "</cz8s:P_C22>" & vbNewLine
        PR.WriteText "<cz8s:P_C23>" & UT(S(c + 4)) & "</cz8s:P_C23>" & vbNewLine
        PR.WriteText "<cz8s:P_C24>" & UT(S(c + 5)) & "</cz8s:P_C24>" & vbNewLine
        PR.WriteText "</cz8s:P_C>" & vbNewLine
    End If
    Next
    PR.WriteText "<cz8s:P_25>" & UT(S(25)) & "</cz8s:P_25>" & vbNewLine

c = 26
    If S(c) <> "" Then
        PR.WriteText "<cz8s:P_D typ=""G"">" & vbNewLine
        PR.WriteText "<cz8s:P_D26>" & ZN(S(c)) & "</cz8s:P_D26>" & vbNewLine 'nr zezw
        PR.WriteText "<cz8s:P_D27>" & DATAA(S(c + 1)) & "</cz8s:P_D27>" & vbNewLine 'data
        PR.WriteText "<cz8s:P_D28>" & UT(S(c + 2)) & "</cz8s:P_D28>" & vbNewLine
        PR.WriteText "<cz8s:P_D29>" & UT(S(c + 3)) & "</cz8s:P_D29>" & vbNewLine
        PR.WriteText "</cz8s:P_D>" & vbNewLine
    End If
PR.WriteText "<cz8s:P_30>" & UT(S(30)) & "</cz8s:P_30>" & vbNewLine

If S(31) > 0 Then
PR.WriteText "<cz8s:P_31>" & UT(S(31)) & "</cz8s:P_31>" & vbNewLine
PR.WriteText "<cz8s:P_32>" & ZN(S(32)) & "</cz8s:P_32>" & vbNewLine
End If
    
PR.WriteText "</cz8s:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</cz8s:Zalacznik_CIT_8S>" & vbNewLine

Sheets("CIT-8").Select
End If

'sprawozdanie CIT-PM
If P(45) = 1 Then
Sheets("CIT-PM").Select
CITPM

PR.WriteText "<czpm:Zalacznik_CIT_PM xmlns:czpm=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITMIT/"">" & vbNewLine
PR.WriteText "<czpm:Naglowek>" & vbNewLine
PR.WriteText "<czpm:KodFormularza kodSystemowy=""CITNZI (2)"" wersjaSchemy=""1-0E"">CIT/NZI</czpm:KodFormularza>" & vbNewLine
PR.WriteText "<czpm:WariantFormularza>2</czpm:WariantFormularza>" & vbNewLine
PR.WriteText "<czpm:OkresOd poz=""P_4"">" & DATAA(P(4)) & "</czpm:OkresOd>" & vbNewLine
PR.WriteText "<czpm:OkresDo poz=""P_5"">" & DATAA(P(5)) & "</czpm:OkresDo>" & vbNewLine
PR.WriteText "</czpm:Naglowek>" & vbNewLine
PR.WriteText "<czpm:PozycjeSzczegolowe>" & vbNewLine



PR.WriteText "</czpm:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czpm:Zalacznik_CIT_PM>" & vbNewLine
Sheets("CIT-8").Select
End If

'sprawozdanie CIT-IP
If P(46) = 1 Then
Sheets("CIT-IP").Select
CITIP

PR.WriteText "<czip:Zalacznik_CIT_IP xmlns:czip=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITMIT/"">" & vbNewLine
PR.WriteText "<czip:Naglowek>" & vbNewLine
PR.WriteText "<czip:KodFormularza kodSystemowy=""CITIP (1)"" wersjaSchemy=""1-0E"">CIT/IP</czip:KodFormularza>" & vbNewLine
PR.WriteText "<czip:WariantFormularza>2</czip:WariantFormularza>" & vbNewLine
PR.WriteText "<czip:OkresOd poz=""P_4"">" & DATAA(P(4)) & "</czip:OkresOd>" & vbNewLine
PR.WriteText "<czip:OkresDo poz=""P_5"">" & DATAA(P(5)) & "</czip:OkresDo>" & vbNewLine
PR.WriteText "</czip:Naglowek>" & vbNewLine
PR.WriteText "<czip:PozycjeSzczegolowe>" & vbNewLine



PR.WriteText "</czip:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czip:Zalacznik_CIT_IP>" & vbNewLine
Sheets("CIT-8").Select
End If

'sprawozdanie CIT-WW
If P(47) = 1 Then
Sheets("CIT-WW").Select
CITWW

PR.WriteText "<czww:Zalacznik_CIT_WW xmlns:czww=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2019/11/29/eD/CITMIT/"">" & vbNewLine
PR.WriteText "<czww:Naglowek>" & vbNewLine
PR.WriteText "<czww:KodFormularza kodSystemowy=""CIT_WW (1)"" wersjaSchemy=""1-0E"">CITWW</czww:KodFormularza>" & vbNewLine
PR.WriteText "<czww:WariantFormularza>1</czww:WariantFormularza>" & vbNewLine
PR.WriteText "<czww:OkresOd poz=""P_4"">" & DATAA(P(4)) & "</czww:OkresOd>" & vbNewLine
PR.WriteText "<czww:OkresDo poz=""P_5"">" & DATAA(P(5)) & "</czww:OkresDo>" & vbNewLine
PR.WriteText "</czww:Naglowek>" & vbNewLine
PR.WriteText "<czww:PozycjeSzczegolowe>" & vbNewLine



PR.WriteText "</czww:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</czww:Zalacznik_CIT_WW>" & vbNewLine
Sheets("CIT-8").Select
End If

'ORD-ZU
If Sheets("CIT-8").Range("AR2") = 2 Then
PR.WriteText "<zzu:Zalacznik_ORD-ZU xmlns:zzu=""http://crd.gov.pl/xml/schematy/dziedzinowe/mf/2018/08/24/eD/ORDZU/"">" & vbNewLine
PR.WriteText "<zzu:Naglowek>" & vbNewLine
PR.WriteText "<zzu:KodFormularza kodSystemowy=""ORD-ZU (3)"" wersjaSchemy=""2-0E"">ORD-ZU</zzu:KodFormularza>" & vbNewLine
PR.WriteText "<zzu:WariantFormularza>3</zzu:WariantFormularza>" & vbNewLine
PR.WriteText "</zzu:Naglowek>" & vbNewLine
PR.WriteText "<zzu:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "<zzu:P_13>" & UT(Sheets("ORD-ZU").Range("D26")) & "</zzu:P_13>" & vbNewLine
PR.WriteText "</zzu:PozycjeSzczegolowe>" & vbNewLine
PR.WriteText "</zzu:Zalacznik_ORD-ZU>" & vbNewLine
End If

PR.WriteText "</Zalaczniki>" & vbNewLine
End If

PR.WriteText "</Deklaracja>"

PR.SaveToFile Nplik, 2
Set PR = Nothing
Sheets("CIT-8").Select
If eDek = 3 Then XSDValid (Nplik)

Exit Sub

KILLE:
Sheets("CIT-8").Select
If Dir(Nplik) <> "" Then Kill Nplik
Application.EnableEvents = True
End
End Sub

Sub Doplikuxml()
Doxml
MsgBox "Plik XML zapisany pod nazw|fffd|" & Chr(13) & Chr(13) & Nplik, vbInformation, "OK"
End Sub
Sub CITCD()
CD(4) = [I12]
CD(5) = [R12]
CD(6) = [AH12]
CD(7) = [AL23]
CD(8) = [AL1]
CD(9) = [AL2]
CD(10) = [AL3]
CD(11) = [D33]
CD(12) = [AL35]
CD(13) = [J36]
CD(14) = [Y36]
CD(15) = [D38]
CD(16) = [L38]
CD(17) = [AB38]
CD(18) = [AG38]
CD(19) = [D40]
CD(20) = [Y40]
CD(21) = [AB46]
CD(22) = [AB48]
CD(23) = [AB50]
CD(24) = [AB52]
CD(25) = [D57]
CD(26) = [AL67]
CD(27) = [J68]
CD(28) = [Y68]
CD(29) = [D70]
CD(30) = [L70]
CD(31) = [AB70]
CD(32) = [AG70]
CD(33) = [D72]
CD(34) = [Y72]
CD(35) = [D77]
CD(36) = [AL79]
CD(37) = [J80]
CD(38) = [Y80]
CD(39) = [D82]
CD(40) = [L82]
CD(41) = [AB82]
CD(42) = [AG82]
CD(43) = [D84]
CD(44) = [Y84]
CD(45) = [D89]
CD(46) = [AL91]
CD(47) = [J92]
CD(48) = [Y92]
CD(49) = [D94]
CD(50) = [L94]
CD(51) = [AB94]
CD(52) = [AG94]
CD(53) = [D96]
CD(54) = [Y96]
CD(55) = [AL4]
CD(56) = [AL5]
CD(57) = [AL6]
CD(58) = [AL7]
CD(59) = [AL8]
CD(60) = [AL9]
CD(61) = [AL10]
CD(62) = [AL11]
CD(63) = [AL12]
CD(64) = [AL13]
CD(65) = [AL14]
CD(66) = [AL15]
CD(67) = [AL16]
CD(68) = [AL17]
CD(69) = [AL18]
CD(70) = [AL20]
CD(71) = [K133]
CD(72) = [AA133]
CD(73) = [D139]
CD(74) = [AF138]
CD(75) = [D141]
CD(76) = [AL143]
CD(77) = [J144]
CD(78) = [Y144]
CD(79) = [D146]
CD(80) = [L146]
CD(81) = [AB146]
CD(82) = [AG146]
CD(83) = [D148]
CD(84) = [Y148]
CD(85) = [K151]
CD(86) = [AA151]
CD(87) = [D157]
CD(88) = [AF156]
CD(89) = [D159]
CD(90) = [AL161]
CD(91) = [J162]
CD(92) = [Y162]
CD(93) = [D164]
CD(94) = [L164]
CD(95) = [AB164]
CD(96) = [AG164]
CD(97) = [D166]
CD(98) = [Y166]
CD(99) = [K169]
CD(100) = [AA169]
CD(101) = [D175]
CD(102) = [AF174]
CD(103) = [D177]
CD(104) = [AL179]
CD(105) = [J180]
CD(106) = [Y180]
CD(107) = [D190]
CD(108) = [L190]
CD(109) = [AB190]
CD(110) = [AG190]
CD(111) = [D192]
CD(112) = [Y192]
CD(113) = [D195]
CD(114) = [D197]

End Sub
Sub CITMIT()
M(4) = [G14]
M(5) = [J14]
M(6) = [R14]
M(7) = [D20]
M(8) = [D25] '1
M(9) = [O25]
M(10) = [D28] '2
M(11) = [O28]
M(12) = [D31] '3
M(13) = [O31]
M(14) = [D34] '4
M(15) = [O34]
M(16) = [D37] '5
M(17) = [O37] '5
M(18) = [H42] 'Miesi|fffd|ce
M(19) = [I42]
M(20) = [K42]
M(21) = [L42]
M(22) = [N42]
M(23) = [R42]
M(24) = [H45]
M(25) = [I45]
M(26) = [K45]
M(27) = [L45]
M(28) = [N45]
M(29) = [R45]
M(30) = [H48]
M(31) = [I48]
M(32) = [K48]
M(33) = [L48]
M(34) = [N48]
M(35) = [R48]
M(36) = [H51]
M(37) = [I51]
M(38) = [K51]
M(39) = [L51]
M(40) = [N51]
End Sub

Sub CITNZ()
NZ(4) = [G15]
NZ(5) = [J15]
NZ(6) = [S15]
NZ(7) = [D24]
NZ(8) = [D28]
NZ(9) = [L28]
NZ(10) = [L34]
NZ(11) = [L36]
NZ(12) = [W1]
NZ(13) = [L40]
NZ(14) = [W2]
NZ(15) = [L46]
NZ(16) = [L48]
NZ(17) = [W3]
NZ(18) = [L52]
NZ(19) = [W4]
NZ(20) = [L58]
NZ(21) = [L60]
NZ(22) = [W5]
NZ(23) = [L72]
NZ(24) = [W6]
NZ(25) = [L78]
NZ(26) = [L80]
NZ(27) = [W7]
NZ(28) = [L84]
NZ(29) = [W8]
End Sub

Sub CIT8SP()
SP(4) = [G13]
SP(5) = [I13]
SP(6) = [T13]
SP(7) = [D21]
SP(8) = [D27] 'B1
SP(9) = [D29]
SP(10) = [L29]
SP(11) = [D31]
SP(12) = [D33]
SP(13) = [D35]
SP(14) = [K44]
SP(15) = [P44]
SP(16) = [K46]
SP(17) = [P46]
SP(18) = [K48]
SP(19) = [P48]
SP(20) = [K50]
SP(21) = [P50]
SP(22) = [D96] 'C1
SP(23) = [D98]
SP(24) = [M100]
SP(25) = [M102]
SP(26) = [M104]
SP(27) = [M107]
SP(28) = [M109] 'C1
SP(29) = [M150]
SP(30) = [D155]
SP(31) = [D157]
SP(32) = [M159]
SP(33) = [M161]
SP(34) = [M164]
SP(35) = [M170]
SP(36) = [D172]
SP(37) = [D54] 'B2
SP(38) = [D56]
SP(39) = [L56]
SP(40) = [D58]
SP(41) = [D60]
SP(42) = [D62]
SP(43) = [K79]
SP(44) = [P79]
SP(45) = [K81]
SP(46) = [P81]
SP(47) = [K83]
SP(48) = [P83]
SP(49) = [K85]
SP(50) = [P85] 'B2
SP(51) = [D112] 'C2
SP(52) = [D114]
SP(53) = [M116]
SP(54) = [M118]
SP(55) = [M120]
SP(56) = [M123]
SP(57) = [M125] 'C2
SP(58) = [D128] 'C3
SP(59) = [D130]
SP(60) = [M132]
SP(61) = [M134]
SP(62) = [M144]
SP(63) = [M146]
SP(64) = [M148] 'C3
End Sub

Sub CITS()
Sheets("CIT-8S").Select
S(4) = [G13]
S(5) = [I13]
S(6) = [S13]
S(7) = [D21]
S(8) = [D27] 'B1
S(9) = [D29]
S(10) = [L29]
S(11) = [K39]
S(12) = [O39]
S(13) = [K41]
S(14) = [O41]
S(15) = [K43]
S(16) = [O43]
S(17) = [K45]
S(18) = [O45] 'B1
S(19) = [D83] 'C1
S(20) = [D85]
S(21) = [P86]
S(22) = [L88]
S(23) = [L90]
S(24) = [L92]
S(25) = [L95]
S(26) = [L97] 'C1
S(27) = [L118]
S(28) = [D123]
S(29) = [D125]
S(30) = [L127]
S(31) = [L129]
S(32) = [L132]
S(33) = [L139]
S(34) = [D141]
S(35) = [D48] 'B2
S(36) = [D50]
S(37) = [L50]
S(38) = [K60]
S(39) = [O60]
S(40) = [K62]
S(41) = [O62]
S(42) = [K64]
S(43) = [O64]
S(44) = [K66]
S(45) = [O66] 'B2
S(46) = [D101] 'C2
S(47) = [D103]
S(48) = [P104]
S(49) = [L106]
S(50) = [L108]
S(51) = [L110]
S(52) = [L113]
S(53) = [L115] 'C2
End Sub

Sub CITPM()
Sheets("CIT-PM").Select
PM(4) = [G13]
PM(5) = [J13]
PM(6) = [Q13]
PM(7) = [D22]
PM(8) = [I26]
PM(9) = [K26]
PM(10) = [K32] 'C1
PM(11) = [K34]
PM(12) = [K36]
PM(13) = [K38]
PM(14) = [K40] 'C1
PM(15) = [K44] 'C2
PM(16) = [K46]
PM(17) = [K48]
PM(18) = [K50]
PM(19) = [K52] 'C2
PM(20) = [K56] 'C3
PM(21) = [K58]
PM(22) = [K60]
PM(23) = [K62]
PM(24) = [K64] 'C3
PM(25) = [K76] 'C4
PM(26) = [K78]
PM(27) = [K80]
PM(28) = [K82]
PM(29) = [K84] 'C4
PM(30) = [K88] 'C5
PM(31) = [K90]
PM(32) = [K92]
PM(33) = [K94]
PM(34) = [K96] 'C5
PM(35) = [K100] 'C6
PM(36) = [K102]
PM(37) = [K104]
PM(38) = [K106]
PM(39) = [K108] 'C6
PM(40) = [K112] 'C7
PM(41) = [K114]
PM(42) = [K116]
PM(43) = [K118]
PM(44) = [K120] 'C7
End Sub

Sub CITIP()
Sheets("CIT-IP").Select
IP(4) = [F12]
IP(5) = [H12]
IP(6) = [O12]
IP(7) = [D20]
IP(8) = [K26]
IP(9) = [K28]
IP(10) = [K30]
IP(11) = [K32]
IP(12) = [K34]
IP(13) = [K36]
IP(14) = [K38]
IP(15) = [K40]
IP(16) = [K42]
IP(17) = [S1]
IP(18) = [K49]
IP(19) = [K51]
IP(20) = [K53]
IP(21) = [K57]
IP(22) = [K59]
IP(23) = [K62]
IP(24) = [J73]
IP(25) = [J76]
IP(26) = [D84] 'E1
IP(27) = [D86]
IP(28) = [K87]
IP(29) = [K90] 'E1
IP(30) = [D93] 'E2
IP(31) = [D95]
IP(32) = [K96]
IP(33) = [K99] 'E2

End Sub

Sub CITWW()
Sheets("CIT-WW").Select
WW(4) = [H13]
WW(5) = [K13]
WW(6) = [D24]
WW(7) = [G39]
WW(8) = [I39]
WW(9) = [L39]
WW(10) = [M39]
WW(11) = [Q39]
WW(12) = [N53]
WW(13) = [N55]
WW(14) = [N57]
WW(15) = [N59]
End Sub

Sub Walid(st)
Dim w, c
Application.ScreenUpdating = False
Sheets("CIT-8").Select
Wal "c8": NIP "c8": Wal "l14": Wal "u14": Wal "d29"
Wal "d37"
Wal "d40"
If [D40] = "POLSKA" Then
Wal "l40": Wal "ac40": Wal "d42": Wal "af42": Wal "d44": Wal "ac44"
Else
Wal "d44"
End If

If [AD253] > 0 And [M253] = "" Then Wal "M253"
If [AD285] > 0 And [W285] = "" Then Wal "W285"

Wal "d423"
'xxxxxxxxxxxxxxxxx

'CIT-8O
If Sheets("CIT-8").[R87] = 1 Then
Sheets("CIT-8O").Select
If [Q109] + [T109] > 0 And [L109] = "" Then Wal "L109"
If [H125] > 0 And [D125] = "" Then Wal "D125"
If [H127] > 0 And [D127] = "" Then Wal "D127"
If [H129] > 0 And [D129] = "" Then Wal "D129"
If [H131] > 0 And [D131] = "" Then Wal "D131"
If [H133] > 0 And [D133] = "" Then Wal "D133"
If [H140] > 0 And [D140] = "" Then Wal "D140"
If [H142] > 0 And [D142] = "" Then Wal "D142"
If [H144] > 0 And [D144] = "" Then Wal "D144"
If [H146] > 0 And [D146] = "" Then Wal "D146"
If [H156] > 0 And [D156] = "" Then Wal "D156"

If [H163] > 0 And [D163] = "" Then Wal "D163"
If [H165] > 0 And [D165] = "" Then Wal "D165"
If [H167] > 0 And [D167] = "" Then Wal "D167"
If [H169] > 0 And [D169] = "" Then Wal "D169"
If [H171] > 0 And [D171] = "" Then Wal "D171"
If [Q198] + [T198] > 0 And [J198] = "" Then Wal "J198"
If [Q242] > 0 And [n241] = "" Then Wal "n241"
If [Q242] > 0 And [n244] = "" Then Wal "n244"
If [Q247] > 0 And [N246] = "" Then Wal "n246"
If [Q247] > 0 And [g248] = "" Then Wal "g248"
If [q250] > 0 And [g250] = "" Then Wal "g250"
Sheets("CIT-8").Select
End If

'CIT-ST
If Sheets("CIT-8").[D87] = 1 Then
Sheets("CIT-ST").Select
If [BR60] = "" Then MsgBox "Uzupe|fffd|nij poz. 22", 16, "Uwaga": [BR60].Select: GoTo POZYC
If [CR84] = "" Then MsgBox "Uzupe|fffd|nij liczb|fffd| zatrudnionych w poz. 29", 16, "Uwaga": [CR84].Select: GoTo POZYC
If [CR3] = 1 Then
    Sheets("CIT-STA").Select
    If Cells(26, 4) = "" Then MsgBox "Uzupe|fffd|nij nazw|fffd| pe|fffd|n|fffd|", 16, "Uwaga": Cells(26, 4).Select: GoTo POZYC
    For a = 1 To [AP1]
    If a = 1 Then c = 26
    If a = 2 Then c = 147
    If a = 3 Then c = 268
    If a = 4 Then c = 389
    For b = 0 To 4
    If b = 1 Then d = 17
    If b = 2 Then d = 44
    If b = 3 Then d = 61
    If b = 4 Then d = 78
    If Cells(c + d, 4) <> "" Then
    If Cells(c + d + 6, 32) = "" Then MsgBox "Uzupe|fffd|nij dat|fffd| rozpocz|fffd|cia dzia|fffd|ano|fffd|ci", 16, "Uwaga": Cells(c + d + 6, 32).Select: GoTo POZYC
    If Cells(c + d + 9, 4) = "" Then MsgBox "Uzupe|fffd|nij kraj", 16, "Uwaga": Cells(c + d + 9, 4).Select: GoTo POZYC
    If Cells(c + d + 9, 4) = "POLSKA" Then
        If Cells(c + d + 9, 10) = "" Then MsgBox "Uzupe|fffd|nij wojew|fffd|dztwo", 16, "Uwaga": Cells(c + d + 9, 10).Select: GoTo POZYC
        If Cells(c + d + 9, 30) = "" Then MsgBox "Uzupe|fffd|nij powiat", 16, "Uwaga": Cells(c + d + 9, 30).Select: GoTo POZYC
        If Cells(c + d + 11, 4) = "" Then MsgBox "Uzupe|fffd|nij gmin|fffd|", 16, "Uwaga": Cells(c + d + 11, 4).Select: GoTo POZYC
        If Cells(c + d + 11, 33) = "" Then MsgBox "Uzupe|fffd|nij numer domu", 16, "Uwaga": Cells(c + d + 11, 33).Select: GoTo POZYC
        If Cells(c + d + 13, 4) = "" Then MsgBox "Uzupe|fffd|nij miejscowo|fffd||fffd|", 16, "Uwaga": Cells(c + d + 13, 4).Select: GoTo POZYC
        If Cells(c + d + 13, 19) = "" Then MsgBox "Uzupe|fffd|nij kod pocztowy", 16, "Uwaga": Cells(c + d + 13, 19).Select: GoTo POZYC
        If Cells(c + d + 13, 27) = "" Then MsgBox "Uzupe|fffd|nij poczt|fffd|", 16, "Uwaga": Cells(c + d + 13, 27).Select: GoTo POZYC
        Else
        If Cells(c + d + 13, 4) = "" Then MsgBox "Uzupe|fffd|nij miejscowo|fffd||fffd|", 16, "Uwaga": Cells(c + d + 13, 4).Select: GoTo POZYC
    End If
    End If
    Next b
    d = 0
    Next a
Else
    If Sheets("CIT-STA").Range("D26") <> "" Then
    MsgBox "CIT-ST/A zawiera dane a nie zaznaczono kwadratu w poz. 168 CIT-ST", 16, "Uwaga"
    Sheets("CIT-ST").Activate
    [E174].Select
    GoTo POZYC
    End If
End If
Sheets("CIT-8").Select
End If

'CIT-D
If Sheets("CIT-8").[AI87] = 1 Then
Sheets("CIT-D").Select
If [AL3] = 0 Then MsgBox "Zaznacz kwadrat w poz. 10", 16, "Uwaga": [D29].Select: GoTo POZYC
If [AB48] > 0 Then
    Wal "d57": Wal "d68"
    If [AL67] = "PL" Then
    Wal "j68": Wal "y68": Wal "d70": Wal "ab70": Wal "d72": Wal "p72": Wal "w72"
    Else
    Wal "d72"
    End If
End If
If [AB50] > 0 Then
    Wal "D77": Wal "D80"
    If [AL79] = "PL" Then
    Wal "J80": Wal "Y80": Wal "D82": Wal "AB82": Wal "D84": Wal "P84": Wal "W84"
    Else
    Wal "D84"
    End If
End If
If [AB52] > 0 Then
    Wal "D89": Wal "D92"
    If [AL91] = "PL" Then
    Wal "J92": Wal "y92": Wal "D94": Wal "Ab94": Wal "D96": Wal "P96": Wal "w96"
    Else
    Wal "D96"
    End If
End If
If [AB46] > 0 And [AL19] = 0 Then MsgBox "Zaznacz kwadrat w Cz|fffd|ci C.4.", 16, "Uwaga": [D102].Select: GoTo POZYC

If [K130] > 0 Then
    Wal "AA130": Wal "D136": Wal "AF135": Wal "D138": Wal "D141":
    If [AL140] = "PL" Then
    Wal "J141": Wal "y141": Wal "D143": Wal "Ab143": Wal "D145": Wal "P145": Wal "w145"
    Else
    Wal "D145"
    End If
End If
If [K148] > 0 Then
    Wal "aa148": Wal "D154": Wal "Af153": Wal "D156": Wal "D159"
    If [AL158] = "PL" Then
    Wal "J159": Wal "y159": Wal "D161": Wal "Ab161": Wal "D163": Wal "P163": Wal "w163"
    Else
    Wal "D163"
    End If
End If
If [K166] > 0 Then
    Wal "aa166": Wal "D172": Wal "Af171": Wal "D174": Wal "D177"
    If [AL176] = "PL" Then
    Wal "J177": Wal "y177": Wal "D179": Wal "Ab179": Wal "D181": Wal "P181": Wal "w181"
    Else
    Wal "D181"
    End If
End If
Sheets("CIT-8").Select
End If

'SPRMT
If Sheets("CIT-8").[D89] = 1 Then
Sheets("SPRMT").Select
Wal "D27": Wal "P27": Wal "G29": Wal "T29": Wal "D34": Wal "D41": NIP "d45": Wal "D47"
    If [AE47] = "PL" Then
    Wal "h47": Wal "T47": Wal "D49": Wal "X49": Wal "D51": Wal "N51": Wal "S51"
    Else
    Wal "D51"
    End If
Wal "D58": Wal "D60": Wal "D62": Wal "D64": Wal "D80": Wal "D82": Wal "D84"
If [K45] = "" And [W45] <> "" Then MsgBox "Wype|fffd|nij poz. 15", 16: [K45].Select: GoTo POZYC
Sheets("CIT-8").Select
End If

'CIT-BR
If Sheets("CIT-8").[Y87] = 1 Then
Sheets("CIT-BR").Select

If [AO1] = 1 Then
Wal "o26"
Wal "af26"
If [AO2] = 0 Then MsgBox "Zaznacz w|fffd|a|fffd|ciwy kwadrat w poz.11", 16: [D28].Select: GoTo POZYC
End If

If [AO1] = 2 Then
If [AO6] + [AO7] + [AO8] = 0 Then MsgBox "Zaznacz w|fffd|a|fffd|ciwy kwadrat w Cz|fffd|ci E.1", 16: [D174].Select: GoTo POZYC
End If

If [D149] <> "" Then
Wal "d151"
If [AO3] = 0 Then MsgBox "Zaznacz w|fffd|a|fffd|ciwy kwadrat w poz.54", 16: [D152].Select: GoTo POZYC
End If


If [AO4] = 1 Then
Wal "D181"
If [D181] <> "" Then
Wal "d184"
    If [AO184] = "PL" Then
    Wal "K184": Wal "AD184": Wal "D186": Wal "AH186": Wal "D188": Wal "Q188": Wal "W188"
    Else
    Wal "D188"
    End If
End If
If [D200] <> "" Then
Wal "d203"
    If [AO203] = "PL" Then
    Wal "K203": Wal "AD203": Wal "D205": Wal "AH205": Wal "D207": Wal "Q207": Wal "W207"
    Else
    Wal "D207"
    End If
End If
If [D211] <> "" Then
Wal "d214"
    If [AO214] = "PL" Then
    Wal "K214": Wal "AD214": Wal "D216": Wal "AH216": Wal "D218": Wal "Q218": Wal "W218"
    Else
    Wal "D218"
    End If
End If
End If
Sheets("CIT-8").Select
End If

'CIT-MIT
If Sheets("CIT-8").[Y89] = 1 Then
Sheets("CIT-MIT").Select
Wal "d24"
If [X1] = 1 And [q30] = 0 Then Wal "q30"
If [X2] = 1 And [Q52] = 0 Then Wal "q52"
If [X3] = 1 And [Q82] = 0 Then Wal "q82"
If [X4] = 1 And [Q104] = 0 Then Wal "q104"
End If

'CIT-8SP
If Sheets("CIT-8").[D91] = 1 Then
Sheets("CIT-8SP").Select
If [D27] <> "" Then
    Wal "d29"
    Wal "L29"
    Wal "d31"
    Wal "d33"
    Wal "d35"
End If
If [D54] <> "" Then
    Wal "d56"
    Wal "L56"
    Wal "d58"
    Wal "d60"
    Wal "d62"
End If
Wal "d96"
If [D96] <> "" Then Wal "d98"
If [d109] <> "" Then Wal "d111"
If [d122] <> "" Then Wal "d124"
If [D146] <> "" Then Wal "d148"
If [M161] > 0 Then Wal "d163"
End If

'CIT-8S
If Sheets("CIT-8").[U91] = 1 Then
Sheets("CIT-8S").Select
If [D27] <> "" Then
    Wal "d29"
    Wal "k29"
End If
If [D48] <> "" Then
    Wal "d50"
    Wal "k50"
End If
If [D48] <> "" Then
    Wal "d50"
    Wal "k50"
End If
If [D83] <> "" Then Wal "d85"
If [D98] <> "" Then Wal "d100"
If [d117] <> "" Then Wal "d119"
If [L133] > 0 Then Wal "d135"
End If


Sheets("CIT-8").Select
If [K87] <> 0 Then MsgBox "Ten program nie zapisuje do XML danych z za|fffd||fffd|cznika SSE-R.", 16, "Wysy|fffd|ka do e-Dekraracje przerwana": End


If [AR2] = 2 Then
Sheets("ORD-ZU").Select
Wal "d26"
End If
Sheets("CIT-8").Select
Application.ScreenUpdating = True
Exit Sub
POZYC:
w = Selection.Row
c = Selection.Column
Application.GoTo Cells(w - 5, 1)
Cells(w, c).Select
End
End Sub

Function Wal(Adr) 'Wal ""
If Range(Adr) = "" Then
Application.EnableEvents = False
Range(Adr).Select
w = Selection.Row
c = Selection.Column
Application.GoTo Cells(w - 5, 1)
Cells(w, c).Select
Application.EnableEvents = True
MsgBox "Uzupe|fffd|nij rubryk|fffd| " & Cells(w - 1, c), 16, "Uwaga"
End
End If
End Function






Attribute VB_Name = "eDeklaracja"
Attribute VB_Base = "0{FA14A92E-14CC-43D1-8DE6-C5D5E1ED6F67}{E9EC9F93-C590-4A45-B6E3-8AB3C3855A5F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Const Osob = 2

Private Sub Anuluj_Click()
Unload Me
End
End Sub


Private Sub Opt1_Click()
eDek = 1
End Sub

Private Sub Opt2_Click()
eDek = 2
End Sub

Private Sub Opt3_Click()
eDek = 3
End Sub

Private Sub Opt4_Click()
eDek = 4
End Sub

Private Sub Opt5_Click()
ePod = 1
End Sub

Private Sub Opt6_Click()
ePod = 2
End Sub

Private Sub Opt7_Click()
eDek = 5
End Sub

Private Sub UserForm_Initialize()
Nplik = Empty
Opt2.Value = True
eDek = 2

If Range("Osoba").Value = 1 Then
Opt5.Value = True
Opt6.Enabled = False
Else
If Osob = 2 Then
    Opt6.Value = True
Else
Opt5.Value = True
Opt6.Value = False
Opt6.Enabled = False
End If
End If

If Range("Korekta").Value = 2 Then Label1.Caption = "Wy|fffd|lij korekt|fffd| deklaracji do:"
If Range("Status").Value > 303 Then
Opt1.Value = True
eDek = 1
End If

If Range("Status").Value = 301 Or Range("Status").Value = 302 Or Range("Status").Value = 303 Then
Opt1.Enabled = False
Opt2.Enabled = False
Opt5.Enabled = False
Opt6.Enabled = False
Opt5.Value = False
Opt6.Value = False
Opt4.Value = True
eDek = 4
End If

If Range("Korekta").Value = 1 And Range("Status").Value = 200 Then
If Range("Test").Value = "" Then Opt1.Enabled = False
Opt4.Value = True
eDek = 4
End If

End Sub

Private Sub OK_Click()
Dim oWinHttp As Object
Dim answ As String
Dim UPOr(14) As String
Dim strDoWysylki As String
Dim a As Integer, b As Integer
Dim nrRef As String
Dim Przych As String
Dim pyt(2) As String
Dim nr As Integer: nr = VBA.FreeFile
Dim strBinFile As String
Dim sSoapAction As String
Dim sWebServiceURL As String
Dim bramka_prod_Soap As String
Dim bramka_test_Soap As String
Dim bramka_prod_Web As String
Dim bramka_test_Web As String
Dim Npliks As String
Dim PEMI As Integer
Dim Blad408 As String
Unload Me

bramka_prod_Soap = "https://bramka.e-deklaracje.mf.gov.pl/uslugi/dokumenty?wsdl"
bramka_prod_Web = "https://bramka.e-deklaracje.mf.gov.pl/uslugi/dokumenty"
bramka_test_Soap = "https://test-bramka.edeklaracje.gov.pl/uslugi/dokumenty?wsdl"
bramka_test_Web = "https://test-bramka.edeklaracje.gov.pl/uslugi/dokumenty/"

If eDek < 3 Then
If Range("Test") = "" And Range("Status") = 200 Then
b = MsgBox("Bie|fffd||fffd|cy Numer dokumentu z systemu e-Deklaracje" & vbCrLf & _
"                  " & Range("Nrdok") & vbCrLf & _
"zostanie bezpowrotnie skasowany." & vbCrLf & _
             "Czy zosta|fffd| on zachowany w wydrukowanym lub zapisanym w pdf UPO?", vbYesNo + vbQuestion, "e-Deklaracje")
End If
If b = 7 Then End
If ePod = 2 Then
Przych = Range("Przychod").Value
Przych = InputBox("Wpisz przych|fffd|d z zeznania PIT za " & Year(Now) - 2 & " rok, np.:" & vbCrLf & _
"PIT-28 - poz. 42 lub" & vbCrLf & _
"PIT-36 - poz. 86 lub" & vbCrLf & _
"PIT-36 - poz. 133 je|fffd|eli podatnik wyst|fffd|powa|fffd| jako ma|fffd||fffd|onek lub" & vbCrLf & _
"PIT-36L - poz. 13 lub 18 lub" & vbCrLf & _
"PIT-37 - poz. 64 lub" & vbCrLf & _
"PIT-37 - poz. 95 je|fffd|eli podatnik wyst|fffd|powa|fffd| jako ma|fffd||fffd|onek lub" & vbCrLf & _
"PIT-38 - poz. 24 lub" & vbCrLf & _
"PIT-39 - poz. 20 lub" & vbCrLf & _
"PIT-40 - poz. 53 lub" & vbCrLf & _
"PIT-40A - poz. 53." & vbCrLf & _
"Je|fffd|eli podatnik nie sk|fffd|ada|fffd| zeznania nale|fffd|y wpisa|fffd| 0", "e-Deklaracje", Przych)
If IsNumeric(Przych) Then
Range("Przychod").Value = Przych
Else
MsgBox "Nie wpisano kwoty przychodu!", vbCritical, "Przerwanie wysy|fffd|ki"
End
End If
End If
'-----------------------------------------------------
Doxml
Application.ScreenUpdating = True
On Error GoTo PNXML
    Npliks = ThisWorkbook.Path & "\.PLIK XML DO PODPISU CYFROWEGO.xml"
    If Dir(Npliks) <> "" Then Kill Npliks
On Error GoTo 0
On Error Resume Next
    Name Nplik As Npliks
    Nplik = Npliks
'-----------------------------------------------------
If ePod = 1 Then
POWT:
MsgBox "Plik o nazwie ''.PLIK XML DO PODPISU CYFROWEGO.xml'' jest w folderze " & ThisWorkbook.Path & vbCrLf & vbCrLf & _
"Otw|fffd|rz TERAZ program do podpisu cyfrowego (np. Szafir, Sigillum, ProCertum lub inny)" & vbCrLf & vbCrLf & _
"i podpisz ''.PLIK XML DO PODPISU CYFROWEGO.xml'' podpisem cyfrowym." & vbCrLf & vbCrLf & _
"(Program do podpisu winien by|fffd| wcze|fffd|niej otwarty i zminimalizowany do paska zada|fffd| w dole ekranu." & vbCrLf & _
" Aby wykona|fffd| podpis KLIKNIJ TERAZ w pasku zada|fffd| ikon|fffd| tego programu i podpisz ten plik." & vbCrLf & _
" Po podpisaniu pliku KLIKNIJ EXCEL w pasku zada|fffd| i kliknij ni|fffd|ej OK.)", vbInformation, "e-Deklaracje"
On Error Resume Next
Npliks = Nplik & ".xades"
    If Dir(Npliks) = "" Then
    b = MsgBox("Plik ''.PLIK XML DO PODPISU CYFROWEGO.xml'' w folderze " & ThisWorkbook.Path & vbCrLf & vbCrLf & _
    "nie zosta|fffd| podpisany podpisem cyfrowym. Czy przerwa|fffd| wysy|fffd|k|fffd|?", 20, "e-Deklaracje")
    If b = 7 Then GoTo POWT
        MsgBox "Plik nie zosta|fffd| podpisany podpisem cyfrowym. Wysy|fffd|ka przerwana.", 16, "e-Deklaracje"
        If Dir(Nplik) <> "" Then Kill Nplik
        End
    End If
    Kill Nplik
    If Dir(Npliks) <> "" Then Name Npliks As Nplik
End If
b = MsgBox("Czy pokaza|fffd| dane XML przygotowane do wysy|fffd|ki?", vbYesNo + vbQuestion, "Podgl|fffd|d")
If b = 6 Then Call ShowWindow
On Error GoTo 0
'-----------------------------------------------------
If eDek = 1 Then
pyt(1) = "Teraz nast|fffd|pi WYSY|fffd|KA DO SYSTEMU e-DEKLARACJE."
If ePod = 1 Then
pyt(2) = "przy podpisie cyfrowym mo|fffd|na pobra|fffd| w ci|fffd|gu 2 godzin."
Else
pyt(2) = "przy danych autoryzuj|fffd|cych mo|fffd|na pobra|fffd| do 2 minut."
End If
Else
pyt(1) = "Teraz nast|fffd|pi WYSY|fffd|KA DO BRAMKI TESTOWEJ."
pyt(2) = "z bramki testowej nie potwierdza przyj|fffd|cia dokumentu."
End If
a = MsgBox(pyt(1) & vbCrLf & vbCrLf & _
"KONTYNUOWA|fffd|?" & vbCrLf & vbCrLf & _
"Uwaga - Urz|fffd|dowe Po|fffd|wiadczenie Odbioru (UPO)" & vbCrLf & _
pyt(2) & vbCrLf, vbExclamation + vbYesNo, "e-Deklaracje")
If a = 7 Then
If Dir(Nplik) <> "" Then Kill Nplik
End
End If
If eDek = 1 Then
sSoapAction = bramka_prod_Soap
sWebServiceURL = bramka_prod_Web
End If
If eDek = 2 Then
sSoapAction = bramka_test_Soap
sWebServiceURL = bramka_test_Web
End If
    Open Nplik For Binary Access Read As nr
        strBinFile = String(LOF(nr), " ")
        Get nr, , strBinFile
    Close nr
strBinFile = Mid(strBinFile, InStr(1, strBinFile, "<", 0))
strBinFile = Base64_Encode(strBinFile)

    Set oWinHttp = CreateObject("WinHttp.WinHttpRequest.5.1")
    oWinHttp.Open "POST", sWebServiceURL, False
    oWinHttp.setRequestHeader "SOAPAction", sSoapAction
    On Error GoTo CONNECT
If ePod = 1 Then
    oWinHttp.Send "<?xml version=""1.0"" encoding=""UTF-8""?>" & _
              "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" " & _
                                "xmlns:xsd=""https://bramka.e-deklaracje.mf.gov.pl/xsd"">" & _
              "<soapenv:Header/>" & _
              "<soapenv:Body>" & _
                "<xsd:sendDocument>" & _
                  "<xsd:document>" & strBinFile & "</xsd:document>" & _
                "</xsd:sendDocument>" & _
              "</soapenv:Body>" & _
              "</soapenv:Envelope>"
Else
    oWinHttp.Send "<?xml version=""1.0"" encoding=""UTF-8""?>" & _
              "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" " & _
                                "xmlns:xsd=""https://bramka.e-deklaracje.mf.gov.pl/xsd"">" & _
              "<soapenv:Header/>" & _
              "<soapenv:Body>" & _
                "<xsd:sendUnsignDocument>" & _
                  "<xsd:document>" & strBinFile & "</xsd:document>" & _
                "</xsd:sendUnsignDocument>" & _
              "</soapenv:Body>" & _
              "</soapenv:Envelope>"
End If
    On Error GoTo 0
    answ = oWinHttp.ResponseText
    Set oWinHttp = Nothing
On Error Resume Next
ActiveSheet.Unprotect
Application.EnableEvents = False
Range("Nrdok").Value = Mid(answ, InStr(1, answ, "<ns:refId>", 1) + 10, InStr(1, answ, "</ns:refId>", 1) - InStr(1, answ, "<ns:refId>", 1) - 10)
Range("Status").Value = Mid(answ, InStr(1, answ, "<ns:status>", 1) + 11, InStr(1, answ, "</ns:status>", 1) - InStr(1, answ, "<ns:status>", 1) - 11)
Range("Status").Select
Selection.NumberFormat = "General"
MsgBox "Kod statusu wysy|fffd|ki - " & Range("Status").Value & vbCrLf & vbCrLf & Mid(answ, InStr(1, answ, "<ns:statusOpis>", 1) + 15, InStr(1, answ, "</ns:statusOpis>", 1) - InStr(1, answ, "<ns:statusOpis>", 1) - 15), vbInformation, "Status/UPO"
If eDek = 1 Then Range("Test").Value = ""
If eDek = 2 Then Range("Test").Value = "testowy"
Application.EnableEvents = True
ActiveSheet.Protect
On Error GoTo 0
ThisWorkbook.Save
If Dir(Nplik) <> "" Then Kill Nplik
End If
'------------------------------------------------------
If eDek = 3 Then
ThisWorkbook.Save
Walid xlOn
Doxml
MsgBox "Plik XML zapisany pod nazw|fffd|" & Chr(13) & Chr(13) & Nplik, vbInformation, "OK"
End If
'------------------------------------------------------
If eDek = 5 Then
ThisWorkbook.Save
Walid xlOn
Doxml
XSDValid (Nplik)
Kill Nplik
MsgBox "Plik XML zgodny ze schematem XSD.", vbInformation, "OK"
End If
'------------------------------------------------------
If eDek = 4 Then
    nrRef = Range("Nrdok").Value
        If Range("Test").Value = "" Then
        sSoapAction = bramka_prod_Soap
        sWebServiceURL = bramka_prod_Web
        End If
        If Range("Test").Value = "testowy" Then
        sSoapAction = bramka_test_Soap
        sWebServiceURL = bramka_test_Web
        End If
         
        Set oWinHttp = CreateObject("WinHttp.WinHttpRequest.5.1")
        oWinHttp.Open "POST", sWebServiceURL, False
        oWinHttp.setRequestHeader "SOAPAction", sSoapAction
        On Error GoTo CONNECT
        oWinHttp.Send "<?xml version=""1.0"" encoding=""UTF-8""?>" & _
                      "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" " & _
                                        "xmlns:xsd=""https://bramka.e-deklaracje.mf.gov.pl/xsd"">" & _
                      "<soapenv:Header/>" & _
                      "<soapenv:Body>" & _
                        "<xsd:requestUPO>" & _
                          "<xsd:refId>" & nrRef & "</xsd:refId>" & _
                        "</xsd:requestUPO>" & _
                      "</soapenv:Body>" & _
                      "</soapenv:Envelope>"
        On Error GoTo 0
        answ = oWinHttp.ResponseText
        
        Set oWinHttp = Nothing
        
    answ = Replace(answ, "&lt;", "<")
Application.EnableEvents = False
    Application.EnableEvents = True
    On Error Resume Next
    ActiveSheet.Unprotect
    Application.EnableEvents = False
    Range("Status").Value = Mid(answ, InStr(1, answ, "<ns:status>", 1) + 11, InStr(1, answ, "</ns:status>", 1) - InStr(1, answ, "<ns:status>", 1) - 11)
    Range("Status").Select
    Selection.NumberFormat = "General"
    If Range("Status").Value = 403 Or Range("Status").Value = 408 Then
    Blad408 = "Sprawd|fffd| zgodno|fffd||fffd| konfiguracji swojego programu do podpisu elektronicznego z Instrukcj|fffd| Ministerstwa Finans|fffd|w (wyszukiwarka: podatki.gov.pl oprogramowanie do podpisu)"
    Else
    Blad408 = ""
    End If
    MsgBox "Kod statusu wysy|fffd|ki - " & Range("Status").Value & vbCrLf & vbCrLf & Mid(answ, InStr(1, answ, "<ns:statusOpis>", 1) + 15, InStr(1, answ, "</ns:statusOpis>", 1) - InStr(1, answ, "<ns:statusOpis>", 1) - 15) & vbCrLf & vbCrLf & Blad408, vbInformation, "Status/UPO"
    Application.EnableEvents = True
    ActiveSheet.Protect
    If Range("Status").Value <> 200 Then End
    UPOr(1) = Mid(answ, InStr(1, answ, "<NazwaPodmiotuPrzyjmujacego>", 1) + 28, InStr(1, answ, "</NazwaPodmiotuPrzyjmujacego>", 1) - InStr(1, answ, "<NazwaPodmiotuPrzyjmujacego>", 1) - 28)
    UPOr(2) = Mid(answ, InStr(1, answ, "<NumerReferencyjny>", 1) + 19, InStr(1, answ, "</NumerReferencyjny>", 1) - InStr(1, answ, "<NumerReferencyjny>", 1) - 19)
    UPOr(3) = Mid(answ, InStr(1, answ, "<DataWplyniecia>", 1) + 16, InStr(1, answ, "</DataWplyniecia>", 1) - InStr(1, answ, "<DataWplyniecia>", 1) - 16)
    UPOr(4) = Mid(answ, InStr(1, answ, "<SkrotDokumentu>", 1) + 16, InStr(1, answ, "</SkrotDokumentu>", 1) - InStr(1, answ, "<SkrotDokumentu>", 1) - 16)
    UPOr(5) = Mid(answ, InStr(1, answ, "<SkrotZlozonejStruktury>", 1) + 24, InStr(1, answ, "</SkrotZlozonejStruktury>", 1) - InStr(1, answ, "<SkrotZlozonejStruktury>", 1) - 24)
    UPOr(6) = Mid(answ, InStr(1, answ, "<NazwaStrukturyLogicznej>", 1) + 25, InStr(1, answ, "</NazwaStrukturyLogicznej>", 1) - InStr(1, answ, "<NazwaStrukturyLogicznej>", 1) - 25)
    UPOr(7) = Mid(answ, InStr(1, answ, "1>", 1) + 2, InStr(InStr(1, answ, "1>", 1) + 5, answ, "</", 1) - InStr(1, answ, "1>", 1) - 2)
    If Len(UPOr(7)) = 11 Then UPOr(8) = " numer PESEL"
    If Len(UPOr(7)) = 10 Then UPOr(8) = " NIP"
    UPOr(9) = Mid(answ, InStr(1, answ, "2>", 1) + 2, InStr(InStr(1, answ, "2>", 1) + 5, answ, "</", 1) - InStr(1, answ, "2>", 1) - 2)
    If Len(UPOr(9)) = 11 Then UPOr(10) = " numer PESEL"
    If Len(UPOr(9)) = 10 Then UPOr(10) = " NIP"
    If Len(UPOr(9)) > 11 Then UPOr(9) = ""
    UPOr(11) = Mid(answ, InStr(1, answ, "<KodUrzedu>", 1) + 11, InStr(1, answ, "</KodUrzedu>", 1) - InStr(1, answ, "<KodUrzedu>", 1) - 11)
    tabl = Range("US")
    For a = 1 To UBound(tabl, 1)
     If tabl(a, 2) = UPOr(11) Then UPOr(11) = tabl(a, 1)
    Next
    UPOr(12) = Mid(answ, InStr(1, answ, "<StempelCzasu>", 1) + 14, InStr(1, answ, "</StempelCzasu>", 1) - InStr(1, answ, "<StempelCzasu>", 1) - 14)
    UPOr(13) = Mid(answ, InStr(1, answ, "SigningTime>", 1) + 12, InStr(InStr(1, answ, "SigningTime>", 1) + 20, answ, "</", 1) - InStr(1, answ, "SigningTime", 1) - 12)
    
    Sheets("UPO").Visible = True
    Application.EnableEvents = False
    With Sheets("UPO")
    .[D6] = UPOr(1)
    .[D11] = UPOr(2)
    .[G11] = UPOr(3)
    .[D13] = UPOr(4)
    .[D15] = UPOr(5)
    .[D17] = UPOr(6)
    .[E20] = UPOr(7)
    .[D20] = UPOr(8)
    .[H20] = UPOr(9)
    .[G20] = UPOr(10)
    .[D22] = UPOr(11)
    .[D24] = UPOr(12)
    .[F26] = UPOr(13)
    End With
    Application.EnableEvents = True
    Sheets("UPO").Select
    Exit Sub
End If
Exit Sub
PNXML:
MsgBox "W folderze '" & ThisWorkbook.Path & "' znajduje si|fffd| ju|fffd| plik '.PLIK XML DO PODPISU CYFROWEGO.xml'," & _
"kt|fffd|ry jest otwarty w innym programie. USU|fffd| TEN PLIK!", 16, "Wysy|fffd|ka do e-Deklaracje przerwana"
Exit Sub

CONNECT:
If eDek < 3 Then Kill Nplik
If eDek = 1 And Range("Test").Value = "" Then
kon = MsgBox("Brak po|fffd||fffd|czenia lub zainstalowanego na komputerze certyfikatu SSL potrzebnego do komunikacji z systemem e-Deklaracje." & vbCrLf & vbCrLf & _
"Czy przej|fffd||fffd| do strony internetowej z Instrukcj|fffd| instalacji certyfikatu?", 16 + vbYesNo, "Uwaga")
Else
kon = MsgBox("Brak po|fffd||fffd|czenia lub zainstalowanego na komputerze certyfikatu SSL potrzebnego do komunikacji z bramk|fffd| testow|fffd| e-Deklaracje." & vbCrLf & vbCrLf & _
"Czy przej|fffd||fffd| do strony internetowej z Instrukcj|fffd| instalacji certyfikatu?", 16 + vbYesNo, "Uwaga")
End If
If kon = 6 Then ActiveWorkbook.FollowHyperlink Address:="http://pit.waw.pl/e-pity.htm#certyfikat"
'If kon = 6 Then ActiveWorkbook.FollowHyperlink Address:="http://pomoc.wolterskluwer.pl/wysylanie-deklaracji-przez-internet/"
End Sub

'    MsgBox "Deklaracja jest zgodna ze wzorem Ministerstwa Finans|fffd|w.", 64, ""


' InQuest injected base64 decoded content
' :'z4

INQUEST-PP=macro
