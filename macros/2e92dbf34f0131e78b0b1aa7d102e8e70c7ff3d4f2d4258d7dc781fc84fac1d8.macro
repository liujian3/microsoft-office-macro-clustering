Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Modul1"
Public Function UserName()
    UserName = Environ$("UserName")
End Function
Public Function blattname() As String
 Application.Volatile
 blattname = ActiveSheet.Name
End Function
Private Sub SchutzEin()
    Worksheets(blattname()).Protect Password:="747"
End Sub
Private Sub SchutzAus()
    Worksheets(blattname()).Unprotect Password:="747"
End Sub
Sub AqStarten()

'1. Check wegen Dateinamen
    varDateiname = ActiveWorkbook.Name
    If varDateiname = "AQ-Master.xlsm" Then
      MsgBox "Please save this file under a new name and in the good directory. Then you can start to work with it."
      GoTo Endeansprung
    End If
    varDateiname1 = Mid(varDateiname, 1, 8)
    If varDateiname1 = "template" Then
        MsgBox "Please save this file under a new name and in the good directory. Then you can start to work with it."
        GoTo Endeansprung
    End If

'2. Check wegen Eintrag in Freeze Histroy (das verstehe ich heute nicht mehr aber alles funktioniert wie gew|fffd|nscht)
    Range("E10").Select
    If ActiveCell.Value <> 0 Then GoTo Endeansprung

'3. Textfeld zum AQ wird sichtbar gemacht
    Application.Run "SchutzAus"
    ActiveSheet.Shapes.Range(Array("TextBox 59")).Select
    Selection.ShapeRange.ZOrder msoBringToFront
    Selection.OnAction = "AqStarten2"
    Application.Run "SchutzEin"

' Jetzt wird falls notwendig die erste Zeile in der Freeze History beschrieben

Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select
    Application.Run "SchutzAus"
    Range("D11").Select
    ActiveCell.FormulaR1C1 = "=NOW()"
    Range("E11").Select
    ActiveCell.Value = Environ("Username")
    
    Range("F12").Select
    varText = ActiveCell.Value
    Range("F11").Select
    If varText = "" Then ActiveCell.FormulaR1C1 = "Process started"
    Range("D11:F11").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("C11").Select
    Application.Run "SchutzEin"

Sheets("AQ").Visible = True
Sheets("AQ").Select
Sheets("Start").Visible = False
Sheets("Freeze history").Visible = False

Endeansprung:

End Sub
Sub AqStarten2()

    Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
End Sub
Sub InfofeldKonzentrationenZeigen()

Sheets("Infoboxes").Visible = True
ActiveSheet.Visible = False
Sheets("Infoboxes").Select
    Application.Run "SchutzAus"
    Rows("6:6").Select
    Selection.EntireRow.Hidden = False
    Application.CutCopyMode = False
    Application.Run "SchutzEin"
    Range("A1").Select
End Sub
Sub ZurueckVomInfofeld()

    Sheets("Infoboxes").Select
    Application.Run "SchutzAus"
    Rows("5:25").Select
    Selection.EntireRow.Hidden = True
    Range("A1").Select
    Application.Run "SchutzEin"
    Sheets("AQ").Visible = True
    ActiveSheet.Visible = False
    Sheets("AQ").Select
End Sub
Sub ZurueckZumAQ()

    Application.Run "SchutzEin"
    Sheets("AQ").Visible = True
    ActiveSheet.Visible = False
    Sheets("AQ").Select
End Sub
Sub ZurueckZumAQ2()

    Application.Run "SchutzEin"
    Sheets("AQ").Visible = True
    ActiveSheet.Visible = False
    Sheets("AQ").Select
End Sub
Sub ZurueckZumStart()

    Sheets("Start").Visible = True
    ActiveSheet.Visible = False
    Sheets("Start").Select
    Range("A1").Select
End Sub
Sub UnFreeze()

    varBackgroundinfo = ""
    varBackgroundinfo = InputBox("Please enter the background information for this Unfreeze process. With no input the Unfreeze will not be done.")
    
    If varBackgroundinfo = "" Then
        Range("B14").Select
        GoTo Endeansprung
    End If
    
    Application.Run "SchutzAus"
    Application.ScreenUpdating = False
    
    Range("K5:M5").Select
    Selection.ClearContents
    Range("M12").Select
    Selection.ClearContents
    
    ActiveSheet.Shapes.Range(Array("TextBox 40")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = "New Freeze"
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 8). _
        ParagraphFormat
        .FirstLineIndent = 0
        .Alignment = msoAlignCenter
    End With
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 8).Font
        .Bold = msoTrue
        .NameComplexScript = "+mn-cs"
        .NameFarEast = "+mn-ea"
        .Fill.Visible = msoTrue
        .Fill.ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .Fill.ForeColor.TintAndShade = 0
        .Fill.ForeColor.Brightness = 0
        .Fill.Transparency = 0
        .Fill.Solid
        .Size = 11
        .Name = "+mn-lt"
    End With
    ActiveSheet.Shapes.Range(Array("TextBox 40")).Select
    Selection.OnAction = "FreezeOrga"
        
    ActiveSheet.Shapes.Range(Array("TextBox 46")).Select
    Selection.OnAction = "ZurueckZumStart"
    
    ActiveSheet.Shapes.Range(Array("TextBox 46")).Select
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 10).Font.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = 0
        .Transparency = 0
        .Solid
    End With
    
    ActiveSheet.Shapes.Range(Array("TextBox 37")).Select
    Selection.OnAction = "EinheitenUmrechnen"
        
    Cells.Select
    Selection.EntireColumn.Hidden = False
    ActiveSheet.Shapes.Range(Array("Rectangle 47")).Select
    Selection.ShapeRange.IncrementLeft 7181.3603149751
    Columns("R:XFD").Select
    Selection.EntireColumn.Hidden = True
    
' Schutz aufheben bei den zu beschreibenden Zellen - erst alle auf dann die mittleren wieder zu

    Range("C35:M54").Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Range("I6:M178").Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    
    Range("I14:M15").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("L16:L24").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K26:L30").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I32:M34").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I57:M58").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J66:L67").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K68:L68").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J69:L74").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I76:M77").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I80").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K81:L81").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
   Range("J82:L83").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K84:L84").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J85:L86").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
        
        
        
    Range("I88:M89").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K92:L93").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    
    Range("J94:L94").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K95:L95").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J96:L99").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    
    Range("I101:M102").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
   
    Range("J103:L103").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K104:L104").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J105:L106").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I107:M107").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("L108").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("L108").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K110:L115").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I111").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J115").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I117:M118").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J119:L129").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I131:M132").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J133:L133").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K134:L134").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J135:L143").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I145:M146").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J147:L149").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I152:M153").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("K150:L150").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("J154:L161").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("I163:M164").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    Range("L165:L177").Select
        Selection.Locked = True
        Selection.FormulaHidden = False
    
    Range("I14").Select
    Range("B14").Select
        
    Application.Run "SchutzEin"
    
Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select
    Application.Run "SchutzAus"
    
    varBackgroundinfo = Environ("Username") & ", " & Now() & ": " & varBackgroundinfo
    Range("G11").Select
    ActiveCell.Value = varBackgroundinfo
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    
Sheets("AQ").Visible = True
    Sheets("AQ").Select
    
    Sheets("Freeze history").Visible = False
    
Endeansprung:
    
End Sub
Private Sub FreezeOrga()

' Sheet AQ ist schon aktiv aber zur Sicherheit nochmal

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    
    Application.ScreenUpdating = False
    
' Auf die lange Dauer und das Speichern wird hingewiesen und der Freezegrund wird gefragt - wenn nichts eingegeben wird dann kein Freeze
    
    varBackgroundinfo = ""
    varBackgroundinfo = InputBox("Please note that the Freeze process may need a couple of seconds. Do not interact. The AQ will be saved automatically before and after the Freeze." & Chr$(10) & Chr$(10) & "Please enter the background information for this Freeze. Without input nothing will be done.")
    
    If varBackgroundinfo = "" Then
        Sheets("AQ").Select
        Range("B14").Select
        GoTo Endeansprung
    End If

    ActiveWorkbook.Save
    
    Application.Run "AlleZeilenEin"
    Application.ScreenUpdating = False
        
Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select

' Die neue Zeile in der Freeze-History wird geschrieben benummert und mit Namen und Zeitstempel beschrieben

    Application.Run "SchutzAus"
    Rows("11:11").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow
    Range("C12:F12").Select
    Selection.Copy
    Range("C11").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    
    Range("D11").Select
    ActiveCell.FormulaR1C1 = "=MAX(C[-2])+1"
    Range("D11").Select
    Selection.Copy
    
    Range("C11").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("B11").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False
    
    Range("D11").Select
    ActiveCell.FormulaR1C1 = "=NOW()"
    Range("D11").Select
    Selection.Copy
    ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Range("E11").Select
    ActiveCell.Value = Environ("Username")
    Range("E10").Select
    Range("B11").Select
    
' Der pdf-Druck wird vorbereitet - Namen etc.


Application.ScreenUpdating = False
    
    varSuffix = ".xlsm"
    varDateiname = ActiveWorkbook.Name
    iLaenge = Len(varDateiname)
    If Mid$(varDateiname, iLaenge - 3, 4) = ".xls" Then varSuffix = ".xls"  ' falls ein altes Excel zum Einsatz kommt
    If Mid$(varDateiname, iLaenge - 4, 1) = "." Then varDateiname = Mid$(varDateiname, 1, iLaenge - 5)
    
    varFreezeNummer = ActiveCell.Value
    
    varPdfName = varDateiname & "-" & "Freeze-" & varFreezeNummer & ".pdf" ' wird erst am Ende benutzt
    
    Range("F11").Select
    ActiveCell.Value = varBackgroundinfo
    
    Range("C11").Select

Sheets("AQ").Select
    Application.Run "SchutzAus"
    Range("K5").Select
    ActiveCell.Value = varPdfName
    Range("L5").Select
    ActiveCell.FormulaR1C1 = "='Freeze history'!R[6]C[-7]"
    Range("M5").Select
    ActiveCell.FormulaR1C1 = "='Freeze history'!R[6]C[-9]"
    Range("K5:M5").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("B14").Select
    
' hier wir die erste pdf mit nur dem AQ ohne die Zusatzblaetter erstellt - nur der AQ ist offen

    varPfad = ActiveWorkbook.Path     ' pdf-Namen sind schon da
    
    Sheets(Array("AQ")).Select
    
    On Error Resume Next
    
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        varPfad & "\" & varPdfName, Quality:= _
        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
    
    On Error GoTo 0
    
' hier beginnen die Vorbereitung auf das zweite pdf - die zwei evtl benoetigten Zusatz-Tabellenblaetter werden geoeffnet
    
    Sheets("IO-Details").Visible = True
    Sheets("Test gas details").Visible = True
   
' Produkt wird ermittelt und geschaut ob die Anhaenge  Daten enthalten
    
    Sheets("AQ").Select:  ' eigentlich nicht notwendig aber zur Sicherheit bei Excel 2016 notwendig
    
    Range("D12").Select
    varDevice = ActiveCell.Value
    
    Range("J138").Select
    varVentile = ActiveCell.Value
    If varVentile <> "" Then varVentile = 1 Else varVentile = 0
    
    Range("J153").Select
    varIO = ActiveCell.Value
    If varIO <> "" Then varIO = 1 Else varIO = 0
    
' Einheiten werden ggf eingestellt
    
    iUnit = 0
    If varDevice = "GM35-EMI" Then iUnit = 1
    If varDevice = "GM35-Process" Then iUnit = 1
    If varDevice = "GM700-EMI" Then iUnit = 2
    If varDevice = "GM700-Process" Then iUnit = 2
    If varDevice = "GM901-EMI" Then iUnit = 3
    If varDevice = "GM901-Process" Then iUnit = 3
    If varDevice = "GM32-EMI" Then iUnit = 4
    If varDevice = "GM32-Process" Then iUnit = 4
    
    
    
    If iUnit = 0 Then GoTo EinheitenBleiben

    If iUnit = 1 Then
        Range("P59").Select
        ActiveCell.Value = "|fffd|C"
        Range("P61").Select
        ActiveCell.Value = "hPa"
        Range("P64").Select
        ActiveCell.Value = "m/s"
        Range("P65").Select
        ActiveCell.Value = "|fffd|C"
        Range("P78").Select
        ActiveCell.Value = "|fffd|C"
        Range("P108").Select
        ActiveCell.Value = "mm"
        Range("P109").Select
        ActiveCell.Value = "mm"
        Range("P110").Select
        ActiveCell.Value = "mm"
        Range("P111").Select
        ActiveCell.Value = "mm"
        Range("P112").Select
        ActiveCell.Value = "mm"
    End If
        
    If iUnit = 2 Then
        Range("P59").Select
        ActiveCell.Value = "|fffd|C"
        Range("P78").Select
        ActiveCell.Value = "|fffd|C"
        Range("P112").Select
        ActiveCell.Value = "mm"
    End If
        
    If iUnit = 3 Then
        Range("P59").Select
        ActiveCell.Value = "|fffd|C"
        Range("P108").Select
        ActiveCell.Value = "mm"
        Range("P112").Select
        ActiveCell.Value = "mm"
    End If
    
    If iUnit = 4 Then
        Range("P59").Select
        ActiveCell.Value = "|fffd|C"
    End If
    
    Application.Run "EinheitenUmrechnen"
    Application.ScreenUpdating = False
    Application.Run "SchutzAus"
        
EinheitenBleiben:

' Oeffnen der produktspezifischen Tabellenblaetter

    Sheets("Technische Daten GM32").Visible = True
    Sheets("Technische Daten GM35").Visible = True
    Sheets("Technische Daten GM700").Visible = True
    Sheets("Technische Daten GM901").Visible = True
    

    If varVentile = 0 And varIO = 0 Then Sheets(Array("AQ")).Select
    If varVentile = 1 And varIO = 0 Then Sheets(Array("AQ", "Test gas details")).Select
    If varVentile = 0 And varIO = 1 Then Sheets(Array("AQ", "IO-Details")).Select
    If varVentile = 1 And varIO = 1 Then Sheets(Array("AQ", "Test gas details", "IO-Details")).Select
    
    If varDevice = "GM32-EMI" Or varDevice = "GM32-Process" Then
        If varVentile = 0 And varIO = 0 Then Sheets(Array("Technische Daten GM32")).Select
        If varVentile = 1 And varIO = 0 Then Sheets(Array("Technische Daten GM32", "Test gas details")).Select
        If varVentile = 0 And varIO = 1 Then Sheets(Array("Technische Daten GM32", "IO-Details")).Select
        If varVentile = 1 And varIO = 1 Then Sheets(Array("Technische Daten GM32", "Test gas details", "IO-Details")).Select
    End If
    
    If varDevice = "GM35-EMI" Or varDevice = "GM35-Process" Then
        If varVentile = 0 And varIO = 0 Then Sheets(Array("Technische Daten GM35")).Select
        If varVentile = 1 And varIO = 0 Then Sheets(Array("Technische Daten GM35", "Test gas details")).Select
        If varVentile = 0 And varIO = 1 Then Sheets(Array("Technische Daten GM35", "IO-Details")).Select
        If varVentile = 1 And varIO = 1 Then Sheets(Array("Technische Daten GM35", "Test gas details", "IO-Details")).Select
    End If
    
    If varDevice = "GM700-EMI" Or varDevice = "GM700-Process" Then
        If varVentile = 0 And varIO = 0 Then Sheets(Array("Technische Daten GM700")).Select
        If varVentile = 1 And varIO = 0 Then Sheets(Array("Technische Daten GM700", "Test gas details")).Select
        If varVentile = 0 And varIO = 1 Then Sheets(Array("Technische Daten GM700", "IO-Details")).Select
        If varVentile = 1 And varIO = 1 Then Sheets(Array("Technische Daten GM700", "Test gas details", "IO-Details")).Select
    End If
    
    If varDevice = "GM901-EMI" Or varDevice = "GM901-Process" Then
        If varVentile = 0 And varIO = 0 Then Sheets(Array("Technische Daten GM901")).Select
        If varVentile = 1 And varIO = 0 Then Sheets(Array("Technische Daten GM901", "Test gas details")).Select
        If varVentile = 0 And varIO = 1 Then Sheets(Array("Technische Daten GM901", "IO-Details")).Select
        If varVentile = 1 And varIO = 1 Then Sheets(Array("Technische Daten GM901", "Test gas details", "IO-Details")).Select
    End If
    
' Fuer varPdfName2 wird Blank gesetzt falls kein Productionsheet eingebunden werden soll

    varPdfName2 = ""
    
    If varDevice = "GM32-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM32-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM35-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM35-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM700-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM700-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM901-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "GM901-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "MCS100E-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "MCS100E-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "MCS100FT-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "MCS100FT-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "MCS300P-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "MCS300P-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "Mercem300Z-EMI" Then varPdfName2 = "Nichtleer"
    If varDevice = "Mercem300Z-Process" Then varPdfName2 = "Nichtleer"
    If varDevice = "Power CEMS" Then varPdfName2 = "Nichtleer"
    If varDevice = "MKAS" Then varPdfName2 = "Nichtleer"
    
    ' Jetzt noch die Produkte ohne Production sheet aber mit Eintraegen in den Anhaengen
    
    If varPdfName2 = "" And varVentile + varIO > 0 Then
        varPdfName2 = "Nichtleer"
        If varVentile = 1 And varIO = 0 Then Sheets(Array("Test gas details")).Select
        If varVentile = 0 And varIO = 1 Then Sheets(Array("IO-Details")).Select
        If varVentile = 1 And varIO = 1 Then Sheets(Array("Test gas details", "IO-Details")).Select
    End If
    
    If varPdfName2 = "Nichtleer" Then varPdfName2 = varDateiname & "-" & "Production-Sheet-" & varFreezeNummer & ".pdf"
        
    On Error Resume Next
        
    If varPdfName2 <> "" Then ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        varPfad & "\" & varPdfName2, Quality:= _
        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
        OpenAfterPublish:=False

    On Error GoTo 0
    
' jetzt Schlie|fffd|en der produktspezifischen Tabellenblaetter

    Sheets("Technische Daten GM32").Visible = False
    Sheets("Technische Daten GM35").Visible = False
    Sheets("Technische Daten GM700").Visible = False
    Sheets("Technische Daten GM901").Visible = False
  
' jetzt werden bei Freeze History die Links gesetzt und formatiert

Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select
    
    Range("B11").Select
    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=varPfad & "\" & varPdfName, _
        TextToDisplay:="1"
    
    With Selection.Font
    Range("B11").Select
        .Name = "Calibri"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleSingle
        .ThemeColor = xlThemeColorHyperlink
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Selection.Font.Bold = True

    Range("C11").Select
    If varPdfName2 <> "" Then ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=varPfad & "\" & varPdfName2, _
        TextToDisplay:="1"
    If varPdfName2 = "" Then ActiveCell.Value = ""
    
    Range("C11").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleSingle
        .ThemeColor = xlThemeColorHyperlink
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Selection.Font.Bold = True

' jetzt das Einbetten der beiden pdf's

Sheets("Embedded pdf").Visible = True
    Sheets("Embedded pdf").Select
'   Sheets("AQ").Visible = False
'   Range("A1").Select
    Application.Run "SchutzAus"
    
    Rows("3:3").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow
    
    Range("B3").Select
    ActiveCell.Value = varFreezeNummer
        
StartEinbetten:

    On Error Resume Next
   
    Range("C3").Select
    varIconTitel = "AQ-Freeze-" & varFreezeNummer
    ActiveSheet.OLEObjects.Add(Filename:= _
        varPfad & "\" & varPdfName, Link:=False, _
        DisplayAsIcon:=True, IconFileName:= _
        "C:\Windows\Installer\{AC76BA86-7AD7-1031-7B44-AB0000000001}\PDFFile_8.ico", _
        IconIndex:=0, IconLabel:=varIconTitel).Select
    
    Range("E3").Select
    varIconTitel = "Production-Sheet-" & varFreezeNummer
    If varPdfName2 <> "" Then ActiveSheet.OLEObjects.Add(Filename:= _
        varPfad & "\" & varPdfName2, Link:=False, _
        DisplayAsIcon:=True, IconFileName:= _
        "C:\Windows\Installer\{AC76BA86-7AD7-1031-7B44-AB0000000001}\PDFFile_8.ico", _
        IconIndex:=0, IconLabel:=varIconTitel).Select
    
    varFehlername = Error$
      
    If varFehlername <> "" Then MsgBox ("A problem occured: The creation or embedding of the pdf(s) did not work. Please check.")
            
    On Error GoTo 0
    
    Range("G1").Select

' jetzt wird im AQ der gefreezte Zustand herbeigef|fffd|hrt

Sheets("AQ").Visible = True
    Sheets("AQ").Select

    Range("M12").Select
    ActiveCell.FormulaR1C1 = "AQ is frozen"

    ActiveSheet.Shapes.Range(Array("TextBox 40")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = "Unfreeze"
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 8). _
        ParagraphFormat
        .FirstLineIndent = 0
        .Alignment = msoAlignCenter
    End With
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 8).Font
        .Bold = msoTrue
        .NameComplexScript = "+mn-cs"
        .NameFarEast = "+mn-ea"
        .Fill.Visible = msoTrue
        .Fill.ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .Fill.ForeColor.TintAndShade = 0
        .Fill.ForeColor.Brightness = 0
        .Fill.Transparency = 0
        .Fill.Solid
        .Size = 11
        .Name = "+mn-lt"
    End With
    ActiveSheet.Shapes.Range(Array("TextBox 40")).Select
    Selection.OnAction = "UnFreeze"
    
    ActiveSheet.Shapes.Range(Array("TextBox 46")).Select
    Selection.OnAction = ""
    
    ActiveSheet.Shapes.Range(Array("TextBox 46")).Select
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 10).Font.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = -0.5
        .Transparency = 0
        .Solid
    End With
    
    ActiveSheet.Shapes.Range(Array("TextBox 37")).Select
    Selection.OnAction = ""
    
    Cells.Select
    Selection.EntireColumn.Hidden = False
    ActiveSheet.Shapes.Range(Array("Rectangle 47")).Select
'   Selection.ShapeRange.IncrementLeft -7181.3603149751
    Selection.ShapeRange.IncrementLeft -10000
    For i = 1 To 88
        Selection.ShapeRange.IncrementLeft 0.75
    Next i
    
'   If varSuffix = ".xlsm" Then Columns("R:XFD").Select Else Columns("R:FI").Select ' das habe ich wieder rasugenommen weil der Fehler mit den nicht vorhandenen Spalten nicht mehr aufgetreten ist und weil sonst nicht genug Platz f|fffd|r alle Sprachen ist
    Columns("R:XFD").Select
    Selection.EntireColumn.Hidden = True
    
    Range("B3:M179").Select
    Selection.Locked = True
    Selection.FormulaHidden = False
 
    Range("I14").Select
    Application.Run "SchutzEin"
    
' jetzt werden die nicht benoetigten Tabellenblaetter geschlossen und Freeze history geoeffnet

    Sheets("IO-Details").Visible = False
    Sheets("Test gas details").Visible = False
    
Application.ScreenUpdating = True
    
Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select
    Sheets("AQ").Visible = False
    Application.Run "SchutzEin"
    ActiveWorkbook.Save
    
If varPdfName2 <> "" Then MsgBox "Please note that a production sheet has been created (see the link in cell C11). Please transfer it when you place the order."

Endeansprung:

End Sub
Sub AqZeigen()
'
    Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Freeze history").Visible = False
    Sheets("Embedded pdf").Visible = False
    Range("I14").Select
    Range("B14").Select
End Sub
Sub FreezeHistoryZeigen()
'
    Sheets("Freeze history").Visible = True
    Sheets("Embedded pdf").Visible = True
'   ActiveSheet.Visible = False
    Sheets("AQ").Visible = False
    Sheets("Freeze history").Select
    Range("C11").Select
End Sub
Sub IoAnzeigen()
'
    Sheets("AQ").Select
    Sheets("IO-Details").Visible = True
    ActiveSheet.Visible = False
    Sheets("IO-Details").Select
End Sub
Sub TestGasDetailsAnzeigen()
'
    Sheets("AQ").Select
    Sheets("Test gas details").Visible = True
    ActiveSheet.Visible = False
    Sheets("Test gas details").Select
End Sub
Sub ProjektdatenEin()
'
    iErsteZeile = 14
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub ProjektdatenAus()
'
    Application.Run "SchutzAus"
    Rows("15:31").Select
    Selection.EntireRow.Hidden = True
    Range("B14").Select
    Application.Run "SchutzEin"
End Sub
Sub AlleZeilenEin()
'
    iErsteZeile = 1
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    
    Application.ScreenUpdating = False
    
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    
    Application.ScreenUpdating = True
    
    Range("B14").Select
    
    Application.Run "SchutzEin"
End Sub
Private Sub Einschub()

    ' Der Einschub sorgt daf|fffd|r, dass beim Oeffnen nur die Zeilen gezeigt werden, die je nach Produktwahl ben|fffd|tigt werden
    
    Dim iBlock(12) As Integer
    iBlock(1) = 14
    iBlock(2) = 32
    iBlock(3) = 57
    iBlock(4) = 76
    iBlock(5) = 88
    iBlock(6) = 101
    iBlock(7) = 117
    iBlock(8) = 131
    iBlock(9) = 145
    iBlock(10) = 152
    iBlock(11) = 163
    iBlock(12) = 179
    
    For i = 1 To 11
        If ActiveCell.Row = iBlock(i) Then
            iAnfang = iBlock(i)
            iEnde = iBlock(i + 1) - 1
            i = 11
        End If
    Next i

' Wenn alles gezeigt werden soll dann werden alle Bloecke zusammengefasst und nicht mehr einzeln angefahren

    If ActiveCell.Row = 1 Then
        iAnfang = iBlock(1)
        iEnde = iBlock(12) - 1
    End If
    
' jetzt geht's los

    varRows = iAnfang & ":" & iEnde
    Rows(varRows).Select
    Selection.EntireRow.Hidden = False
    
    Range("AA" & iAnfang - 1).Activate
    
    For i = iAnfang To iEnde
        ActiveCell.Offset(1, 0).Select
        varPflicht1 = ActiveCell.Value
        If varPflicht1 <> -1 Then GoTo Weiter
        varZeile1 = ActiveCell.Row
    
        For ii = 1 To iEnde - iAnfang
            If ii = 1 Then varZeile2 = varZeile1
            ActiveCell.Offset(1, 0).Select
            varPflicht2 = ActiveCell.Value
            If varPflicht2 <> -1 Then ii = iEnde - iAnfang
            If varPflicht2 <> -1 Then GoTo Weiter_ii
            varZeile2 = ActiveCell.Row
            If varZeile2 = iEnde Then ii = iEnde - iAnfang
Weiter_ii:
        Next ii
    
        varZeilen = varZeile1 & ":" & varZeile2
        Rows(varZeilen).Select
        Selection.EntireRow.Hidden = True
        Rows(varZeile2).Select
        ActiveCell.Offset(0, 26).Select
Weiter:
        i = ActiveCell.Row
    Next i

End Sub
Sub GasmatrixEin()
'
    iErsteZeile = 32
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub GasmatrixAus()
'
    Application.Run "SchutzAus"
    Rows("33:56").Select
    Selection.EntireRow.Hidden = True
    Range("B32").Select
    Application.Run "SchutzEin"
End Sub
Sub MessgasbedingungenEin()
'
    iErsteZeile = 57
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub MessgasbedingungenAus()
'
    Application.Run "SchutzAus"
    Rows("58:75").Select
    Selection.EntireRow.Hidden = True
    Range("B51").Select
    Application.Run "SchutzEin"
End Sub
Sub MessstelleEin()
'
    iErsteZeile = 76
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub MessstelleAus()
'
    Application.Run "SchutzAus"
    Rows("77:87").Select
    Selection.EntireRow.Hidden = True
    Range("B73").Select
    Application.Run "SchutzEin"
End Sub
Sub AufstellortEin()
'
    iErsteZeile = 88
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub AufstellortAus()
'
    Application.Run "SchutzAus"
    Rows("89:100").Select
    Selection.EntireRow.Hidden = True
    Range("B85").Select
    Application.Run "SchutzEin"
End Sub
Sub MontageortEin()
'
    iErsteZeile = 101
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub MontageortAus()
'
    Application.Run "SchutzAus"
    Rows("102:116").Select
    Selection.EntireRow.Hidden = True
    Range("B98").Select
    Application.Run "SchutzEin"
End Sub
Sub EnergieversorgungEin()
'
    iErsteZeile = 117
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub EnergieversorgungAus()
'
    Application.Run "SchutzAus"
    Rows("118:130").Select
    Selection.EntireRow.Hidden = True
    Range("B114").Select
    Application.Run "SchutzEin"
End Sub
Sub ILuftEin()
'
    iErsteZeile = 131
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub ILuftAus()
'
    Application.Run "SchutzAus"
    Rows("132:144").Select
    Selection.EntireRow.Hidden = True
    Range("B122").Select
    Application.Run "SchutzEin"
End Sub
Sub MessgasrueckfuehrungEin()
'
    iErsteZeile = 145
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub MessgasrueckfuehrungAus()
'
    Application.Run "SchutzAus"
    Rows("146:151").Select
    Selection.EntireRow.Hidden = True
    Range("B142").Select
    Application.Run "SchutzEin"
End Sub
Sub DatenmanagementEin()
'
    iErsteZeile = 152
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub DatenmanagementAus()
'
    Application.Run "SchutzAus"
    Rows("153:162").Select
    Selection.EntireRow.Hidden = True
    Range("B149").Select
    Application.Run "SchutzEin"
End Sub
Sub RisikobetrachtungEin()
'
    iErsteZeile = 163
    Application.Run "SchutzAus"
    Range("B" & iErsteZeile).Select
    Application.Run "Einschub"
    Range("I" & iErsteZeile).Select
    Range("B" & iErsteZeile).Select
    Application.Run "SchutzEin"
End Sub
Sub RisikobetrachtungAus()
'
    Application.Run "SchutzAus"
    Rows("164:178").Select
    Selection.EntireRow.Hidden = True
    Range("B160").Select
    Application.Run "SchutzEin"
End Sub
Private Sub AuswahlG00()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AE5:AE600").Select
    Selection.Copy
    
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Der evtl. vorhandene Eintrag bei der Produktwahl wird geloescht da unzutreffend
    Range("I29:J29").Select
    Selection.ClearContents

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select

    
End Sub
Private Sub AuswahlG01()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AF5:AF600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Der zuvor gemachte Eintrag bei der Produktwahl wird geloescht da unzutreffend
    Range("I29:J29").Select
    Selection.ClearContents

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG02()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AG5:AG600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG03()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AH5:AH600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG04()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AI5:AI600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG05()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AJ5:AJ600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG06()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AK5:AK600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG07()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AL5:AL600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG08()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AM5:AM600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG09()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AN5:AN600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG10()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AO5:AO600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG11()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AP5:AP600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG12()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AQ5:AQ600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG13()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AR5:AR600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG14()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AS5:AS600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG15()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AT5:AT600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG16()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AU5:AU600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG17()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AV5:AV600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Der zuvor gemachte Eintrag bei der Produktwahl wird geloescht da unzutreffend
    Range("I29:J29").Select
    Selection.ClearContents

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG18()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AW5:AW600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG19()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AX5:AX600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG20()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AY5:AY600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG21()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("AZ5:AZ600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG22()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BA5:BA600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG23()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BB5:BB600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG24()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BC5:BC600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG25()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BD5:BD600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG26()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BE5:BE600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG27()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BF5:BF600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG28()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BG5:BG600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG29()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BH5:BH600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG30()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BI5:BI600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG31()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BJ5:BJ600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG32()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BK5:BK600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG33()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BL5:BL600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG34()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BM5:BM600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Der zuvor gemachte Eintrag bei der Produktwahl wird geloescht da unzutreffend
    Range("I29:J29").Select
    Selection.ClearContents

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG35()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BN5:BN600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Private Sub AuswahlG36()

Application.ScreenUpdating = False
Application.Run "AqStarten"

Range("E10").Select
If ActiveCell.Value = 0 Then Range("A1").Select: End

Sheets("AQ").Visible = True
    Sheets("AQ").Select
    Sheets("Start").Visible = False
    
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Range("BO5:BO600").Select
    Selection.Copy
    Range("AC5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Application.Run "AlleZeilenEin"
    
' Hier wird jetzt die Produktauswahl vorbelegt gemaess der getroffenen Auswahl
    Range("AC5").Select
    varProd = ActiveCell.Value
    Range("I29").Select
    ActiveCell.Value = varProd

    Application.Run "AlleZeilenAus"
    Application.Run "SchutzEin"
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Sub AlleZeilenEinDirekt()
Attribute AlleZeilenEinDirekt.VB_ProcData.VB_Invoke_Func = "I\n14"
'
    Range("B14").Select
    Application.ScreenUpdating = False
    Application.Run "SchutzAus"
    Rows("14:178").Select
    Selection.EntireRow.Hidden = False
    Range("B14").Select
    Application.Run "SchutzEin"
    
End Sub
Sub AlleZeilenEinAlt()
'
    Range("B14").Select
    Application.ScreenUpdating = False
    Application.Run "ProjektdatenEin"
    Application.Run "GasmatrixEin"
    Application.Run "MessgasbedingungenEin"
    Application.Run "MessstelleEin"
    Application.Run "AufstellortEin"
    Application.Run "MontageortEin"
    Application.Run "EnergieversorgungEin"
    Application.Run "ILuftEin"
    Application.Run "MessgasrueckfuehrungEin"
    Application.Run "DatenmanagementEin"
    Application.Run "RisikobetrachtungEin"
    Range("B14").Select
    
End Sub
Sub AlleZeilenAus()
'
    Range("B14").Select
    Application.ScreenUpdating = False
    Application.Run "ProjektdatenAus"
    Application.Run "GasmatrixAus"
    Application.Run "MessgasbedingungenAus"
    Application.Run "MessstelleAus"
    Application.Run "AufstellortAus"
    Application.Run "MontageortAus"
    Application.Run "EnergieversorgungAus"
    Application.Run "ILuftAus"
    Application.Run "MessgasrueckfuehrungAus"
    Application.Run "DatenmanagementAus"
    Application.Run "RisikobetrachtungAus"
    Range("B14").Select
End Sub
Sub ZeileHoeheGross()
    Application.Run "SchutzAus"
    varHoehe = ActiveCell.Height
    If varHoehe < 300 Then Selection.RowHeight = varHoehe + 5
    Application.Run "SchutzEin"
End Sub
Sub ZeileHoeheKlein()
    Application.Run "SchutzAus"
    varHoehe = ActiveCell.Height
    If varHoehe > 40 Then Selection.RowHeight = varHoehe - 5
    Application.Run "SchutzEin"
End Sub
Sub Block1HoeheGross()
    Range("B31").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block1HoeheKlein()
    Range("B31").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block1bHoeheGross()
    Range("B25").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block1bHoeheKlein()
    Range("B25").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block2HoeheGross()
    Range("B56").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block2HoeheKlein()
    Range("B56").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block3HoeheGross()
    Range("B75").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block3HoeheKlein()
    Range("B75").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block4HoeheGross()
    Range("B87").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block4HoeheKlein()
    Range("B87").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block5HoeheGross()
    Range("B100").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block5HoeheKlein()
    Range("B100").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block6HoeheGross()
    Range("B116").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block6HoeheKlein()
    Range("B116").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block7HoeheGross()
    Range("B130").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block7HoeheKlein()
    Range("B130").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block8HoeheGross()
    Range("B144").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block8HoeheKlein()
    Range("B144").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block9HoeheGross()
    Range("B151").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block9HoeheKlein()
    Range("B151").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block10HoeheGross()
    Range("B162").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block10HoeheKlein()
    Range("B162").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Sub Block11HoeheGross()
    Range("B178").Select
    Application.Run "ZeileHoeheGross"
End Sub
Sub Block11HoeheKlein()
    Range("B178").Select
    Application.Run "ZeileHoeheKlein"
End Sub
Attribute VB_Name = "Modul2"
Sub SchriftAuf11Setzen()

Sheets("AQ").Select
    Application.Run "SchutzAus"
    
    Columns("J:L").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 11
    End With
    
    Range("C3").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
    End With
    
    Range("A1").Select
End Sub
Sub SpracheDeutsch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("DN1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheEnglisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("EA1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheChinesisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("EM1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheItalienisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("J115").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 8
    End With
    Range("EY1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheFranzoesisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("FK1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SprachePortugiesisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("J105").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 10
    End With
    Range("K112").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 7
    End With
    Range("FW1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheRussisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
        
    Range("C3").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 14
    End With
    
    Range("J105").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 8
    End With
    Range("J115").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 9
    End With
    Range("GI1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheSpanisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("J105").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 8
    End With
    Range("J115").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 8
    End With
    Range("GU1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheJapanisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("J70").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 10
    End With
    Range("J86").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 9
    End With
    Range("J105").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 8
    End With
    Range("J115").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 9
    End With
    Range("K112").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 9
    End With
    Range("J122").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 9
    End With
    Range("J128").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 9
    End With
    Range("HG1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SprachePolnisch()

Sheets("AQ").Select
    Application.ScreenUpdating = False
    Application.Run "SchriftAuf11Setzen"
    Range("J86").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 10
    End With
    Range("J115").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 10
    End With
    Range("HS1").Select:  ' durch die Wahl dieser Zelle wird die Sprache festgelegt
    Application.Run "SpracheAlle"

End Sub
Sub SpracheAlle()

' die aktive Zelle ist die die am linken oberen Anfang des Spaltenbereichs der neuen Sprache steht - damit ist die neue Sprache festgelegt

    varSpalte = ActiveCell.Column
    If varSpalte = 118 Then varSpaltenname1 = "DN": varSpaltenname2 = "DU": varSpaltenname3 = "DX":  ' Deutsch
    If varSpalte = 131 Then varSpaltenname1 = "EA": varSpaltenname2 = "EH": varSpaltenname3 = "EK":  ' Englisch
    If varSpalte = 143 Then varSpaltenname1 = "EM": varSpaltenname2 = "ET": varSpaltenname3 = "EW":  ' Chinesisch
    If varSpalte = 155 Then varSpaltenname1 = "EY": varSpaltenname2 = "FF": varSpaltenname3 = "FI":  ' Italienisch
    If varSpalte = 167 Then varSpaltenname1 = "FK": varSpaltenname2 = "FR": varSpaltenname3 = "FU":  ' Franzoesisch
        
    If varSpalte = 179 Then varSpaltenname1 = "FW": varSpaltenname2 = "GD": varSpaltenname3 = "GG":  ' Portugiesisch
    If varSpalte = 191 Then varSpaltenname1 = "GI": varSpaltenname2 = "GP": varSpaltenname3 = "GS":  ' Russisch
    If varSpalte = 203 Then varSpaltenname1 = "GU": varSpaltenname2 = "HB": varSpaltenname3 = "HE":  ' Spanisch
    If varSpalte = 215 Then varSpaltenname1 = "HG": varSpaltenname2 = "HN": varSpaltenname3 = "HQ":  ' Japanisch
    If varSpalte = 227 Then varSpaltenname1 = "HS": varSpaltenname2 = "HZ": varSpaltenname3 = "IC":  ' Polnisch
        
' nur ein wenig die Anzeige aufraeumen

    Range("I14").Select
    Range("B14").Select
    Application.Run "AlleZeilenEinDirekt"
    Application.Run "SchutzAus"
    Cells.Select
    Selection.EntireColumn.Hidden = False
    
' jetzt geht es los

    Range(varSpaltenname2 & "179:" & varSpaltenname2 & "529").Select
    ' 529 ergibt sich aus 179 und den 350 die gleich der iAnzTexte aus dem VorspannSprachwechsel sind
    Selection.Copy
    Range("DI179").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
Application.Run "VorspannSprachwechsel"

    Range(varSpaltenname1 & ":" & varSpaltenname3).Select
    Selection.Copy
    Range("DA1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
 
    Application.Run "SchutzEin"
    
Sheets("Infoboxes").Visible = True
Sheets("Infoboxes").Select
    
    Application.Run "SchutzAus"
    Columns("H:R").Select
    Selection.EntireColumn.Hidden = False
    Columns("L:N").Select
    Selection.Copy
    Range("H1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("H1").Select
    Application.CutCopyMode = False
    Columns("H:R").Select
    Selection.EntireColumn.Hidden = True
    Range("A1").Select

    ActiveSheet.Shapes.Range(Array("TextBox 1")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = "Back"
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 4). _
        ParagraphFormat
        .FirstLineIndent = 0
        .Alignment = msoAlignCenter
    End With
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 4).Font
        .Bold = msoTrue
        .NameComplexScript = "+mn-cs"
        .NameFarEast = "+mn-ea"
        .Fill.Visible = msoTrue
        .Fill.ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .Fill.ForeColor.TintAndShade = 0
        .Fill.ForeColor.Brightness = 0
        .Fill.Transparency = 0
        .Fill.Solid
        .Size = 11
        .Name = "+mn-lt"
    End With
 
    Application.Run "SchutzEin"
    
Sheets("Infoboxes").Visible = False
    
Sheets("AQ").Select
    Application.Run "AlleZeilenEin"
    Application.Run "SchutzAus"
    Columns("R:XFD").Select
    Selection.EntireColumn.Hidden = True
    Application.Run "SchutzEin"
    Range("B14").Select
    Application.ScreenUpdating = True
    Range("I14").Select
    Range("B14").Select
    
End Sub
Sub VorspannSprachwechsel()
'
    iAnzTexte = 350
    Dim varAuswahltextAlt(350)
    Dim varAuswahltextNeu(350)
    
' Einlesen Feldvariablen

    Range("DH179").Select
        
    For i = 1 To iAnzTexte
        ActiveCell.Offset(1, 0).Select
        varAuswahltextAlt(i) = ActiveCell.Value
        ActiveCell.Offset(0, 1).Select
        varAuswahltextNeu(i) = ActiveCell.Value
        ActiveCell.Offset(0, -1).Select
    
'    If i = 306 Then Stop
    Next i
 
' Zu aendernde Auswahltexte einzeln anfahren

    Range("I11").Select

    For i = -1 To 155
    
        If i = -1 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 0 Then ActiveCell.Offset(7, 0).Select: GoTo ZelleGefunden
        If i = 1 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 2 Then ActiveCell.Offset(7, 0).Select: GoTo ZelleGefunden
        If i = 2 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 3 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 4 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
      
        If i = 5 Then ActiveCell.Offset(6, -5).Select: GoTo ZelleGefunden
        
        If i = 6 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 7 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 8 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 9 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 10 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 11 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 12 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 13 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 14 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 15 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 16 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 17 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 18 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 19 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 20 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 21 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 22 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 23 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 24 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden

        If i = 25 Then ActiveCell.Offset(-19, -1).Select: GoTo ZelleGefunden
        If i = 26 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 27 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 28 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 29 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 30 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 31 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 32 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 33 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 34 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 35 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 36 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 37 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 38 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 39 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 40 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 41 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 42 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 43 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 44 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 49 Then ActiveCell.Offset(0, 6).Select
        If i = 49 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
  
  
  If i = 50 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        If i = 51 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 52 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 53 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 54 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 55 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 56 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 57 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 58 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 59 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 60 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 61 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 62 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 63 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 64 Then ActiveCell.Offset(2, 0).Select: GoTo ZelleGefunden
        
        If i = 65 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        
        If i = 66 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 67 Then ActiveCell.Offset(2, 0).Select: GoTo ZelleGefunden
        If i = 68 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 69 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 70 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
       
        If i = 71 Then ActiveCell.Offset(2, 0).Select: GoTo ZelleGefunden
        
        If i = 72 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        If i = 73 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 74 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 75 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 76 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 77 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 78 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 79 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 80 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 81 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 82 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        If i = 83 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 84 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 86 Then ActiveCell.Offset(1, -1).Select: GoTo ZelleGefunden
        If i = 87 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 88 Then ActiveCell.Offset(2, 0).Select: GoTo ZelleGefunden
        If i = 89 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 90 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 91 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 92 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 93 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 94 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 95 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 96 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        If i = 97 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 98 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 99 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 100 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 101 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 102 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 103 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 104 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 105 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 106 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 107 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        
        If i = 108 Then ActiveCell.Offset(2, 0).Select: GoTo ZelleGefunden
        If i = 109 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 110 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 111 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 112 Then ActiveCell.Offset(2, 0).Select: GoTo ZelleGefunden
        If i = 113 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 114 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 115 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 116 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        If i = 117 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 118 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        
        If i = 119 Then ActiveCell.Offset(9, 0).Select: GoTo ZelleGefunden
        If i = 120 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 121 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden
        If i = 122 Then ActiveCell.Offset(1, 0).Select: GoTo ZelleGefunden

        If i = 123 Then ActiveCell.Offset(4, 0).Select: GoTo ZelleGefunden
        If i = 124 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 125 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 126 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 127 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 128 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 129 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 130 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 131 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 132 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 133 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 134 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 135 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 136 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 137 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 138 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 139 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 140 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        
        If i = 141 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 142 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 143 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 144 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 145 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 146 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 147 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 148 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 149 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 150 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        
        If i = 151 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 152 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 153 Then ActiveCell.Offset(1, -2).Select: GoTo ZelleGefunden
        If i = 154 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        If i = 155 Then ActiveCell.Offset(0, 1).Select: GoTo ZelleGefunden
        
    GoTo NixZuTun

ZelleGefunden:

'   Zur Kontrolle ob die richtigen Felder angefahren werden kann man die beiden folgenden Zeilen aktivieren
'   Stop
'   GoTo NixZuTun
            
' Alten Text aus Zelle holen dann fuer alten und neuen Text einlesen dann neuen Text ueberschreiben

        varInhaltAlt = ActiveCell.Value
        varInhaltNeu = ActiveCell.Value
        If varInhaltAlt = "" Then GoTo NixZuTun
        
        For i2 = 1 To iAnzTexte
            If varInhaltAlt = varAuswahltextAlt(i2) Then varInhaltNeu = varAuswahltextNeu(i2)
            If varInhaltAlt = varAuswahltextAlt(i2) Then i2 = iAnzTexte
          
        Next i2
          
        ActiveCell.Value = varInhaltNeu

NixZuTun:

    Next i

End Sub
Sub EinheitenUmrechnen()
'
    Application.ScreenUpdating = False
    Dim varUmrechnungsfaktor(31, 31)
    Dim varNameEinheit(31)
    izeileAnz = 30         ' Zeilenzahl auf dem Tabellenblatt Factors
    ispalteAnz = izeileAnz
    iTqZeileAnz = 140
    iFehler = 0

'   Umrechnungsfaktoren werden geholt...................................................................................

Sheets("Factors").Visible = True
Sheets("Factors").Activate
    Range("C10").Select
    For iZeile = 1 To izeileAnz
          ActiveCell.Offset(1, 0).Select
      varNameEinheit(iZeile) = ActiveCell.Value
    Next iZeile
    Range("C10").Select
    For iZeile = 1 To izeileAnz
      ActiveCell.Offset(1, 0).Select
      For ispalte = 1 To ispalteAnz
        ActiveCell.Offset(0, 1).Select
        varUmrechnungsfaktor(iZeile, ispalte) = ActiveCell.Value
      Next ispalte
      ActiveCell.Offset(0, -ispalteAnz).Select
    Next iZeile
    Range("A11").Select
    Range("A1").Select
    Sheets("Factors").Visible = False

Sheets("AQ").Visible = True
Sheets("AQ").Activate

' Eventuell schon vorhandene Gase ausserhalb der auswaehlbaren werden in Feldvariablen eingelesen

    Dim varSondergasname(20)
    Dim varSondergasmolgewicht(20)
    Range("R176").Select
    For i = 1 To 20
        ActiveCell.Offset(1, 0).Select
        varSondergasname(i) = ActiveCell.Value
        ActiveCell.Offset(0, 2).Select
        varSondergasmolgewicht(i) = ActiveCell.Value
        ActiveCell.Offset(0, -2).Select
    Next i
 
 ' jetzt geht es los - Zeilen werden alle gezeigt der Schutz geht raus und dann wird in die Startposition gegangen
 
    Application.Run "AlleZeilenEin"
    Application.Run "SchutzAus"
    Range("P34").Select

For iTqZeile = 1 To iTqZeileAnz
    ActiveCell.Offset(1, 0).Select
    varNeueEinheit = ActiveCell.Value
    If varNeueEinheit = "" Then GoTo NixTun
        
    ' Hier ist klar dass eine Umrechnung notwedig ist und iVariante wird eingelesen
    ' iVariante=1: Umrechung Konzentrationen
    ' iVariante=2: Umrechung Temperaturen Celsius Fahrenheit
    ' iVariante=3: Umrechung Druck etc mit je einem umzurechnenden Feld
    ' iVariante=4: Umrechung Druck etc mit je zwei umzurechnenden Feldern
    ' iVariante=5: Umrechung Druck etc mit je drei umzurechnenden Feldern
    ' iVariante=6: Umrechung Druck etc mit der Einheit nach der Zahl
    ' iVariante=7: Umrechung Flow mit je drei umzurechnenden Feldern
    

    iVariante = 0
    ActiveCell.Offset(0, 2).Select
    iVariante = ActiveCell.Value
    ActiveCell.Offset(0, -2).Select
    
    If iVariante = 1 Then GoTo BeginnVariante1
    If iVariante = 2 Then GoTo BeginnVariante2
    If iVariante = 3 Then GoTo BeginnVariante3
    If iVariante = 4 Then GoTo BeginnVariante4
    If iVariante = 5 Then GoTo BeginnVariante5
    If iVariante = 6 Then GoTo BeginnVariante6
    If iVariante = 7 Then GoTo BeginnVariante7
    
    GoTo NixTun ' wenn der Ablauf hier hin kommt ist was schief gegangen deshalb ohne Aktion zur naechsten Zeile
    
' Variante 1 beginnt
    
BeginnVariante1:
        
    ActiveCell.Offset(0, -11).Select
    varAlteEinheit = ActiveCell.Value
    iAlteEinheit = 0
    iNeueEinheit = 0
    
    For iZeile = 1 To izeileAnz
      If varNeueEinheit = varNameEinheit(iZeile) Then iNeueEinheit = iZeile
      If varAlteEinheit = varNameEinheit(iZeile) Then iAlteEinheit = iZeile
    Next iZeile
    
    If iNeueEinheit = 0 Then
        ActiveCell.Offset(0, 11).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If iAlteEinheit = 0 Then
        ActiveCell.Offset(0, 11).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    
    varFaktor = 0
    varFaktor = varUmrechnungsfaktor(iAlteEinheit, iNeueEinheit)
    
    If varFaktor = 0 Then
        ActiveCell.Offset(0, 11).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    
    If varFaktor = "Calc" Then GoTo AnsprungCalc
    
    ActiveCell.Value = varNeueEinheit

    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    
    ActiveCell.Offset(0, 4).Select
    ActiveCell.Value = ""

GoTo NixTun
    
AnsprungCalc:

' Molvolumen, Normtemperaturen und -druecke holen

Sheets("Factors").Visible = True
Sheets("Factors").Activate
    
    Range("J4").Select
    varNormvolDIN = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varDruckDIN = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varTempDIN = ActiveCell.Value
    
    Range("K4").Select
    varNormvolIso = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varDruckISO = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varTempISO = ActiveCell.Value
    
    Range("I4").Select
    varNormvolBetrieb = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varDruckBetrieb = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varTempBetrieb = ActiveCell.Value
    
    Range("A11").Select
    Range("A1").Select
    Sheets("Factors").Visible = False

Sheets("AQ").Activate
    
    ActiveCell.Offset(0, 14).Select ' Molgewicht holen
    varMolgewicht = ActiveCell.Value
    ActiveCell.Offset(0, -14).Select
    
    If varMolgewicht < 1 Then       ' wenn kein Molgewicht zu finden ist dann bei den Sondergasen schauen
        varGasname = ""
        ActiveCell.Offset(0, -2).Select
        varGasname = ActiveCell.Value
        ActiveCell.Offset(0, 2).Select

        For i = 1 To 20
            If varGasname = varSondergasname(i) Then varMolgewicht = varSondergasmolgewicht(i): i = 20
        Next i
        
    End If

' Jetzt kommt ein langer Einschub zum Abfragen des Molgewichts eines unbekannten Gases und das wird dann auch gleich gespeichert
    If varMolgewicht < 1 Then
        ' Position merken
        varAktuelleZeile = ActiveCell.Row
        varAktuelleSpalte = ActiveCell.Column
        ' Name holen und Molgewicht fragen
            varGasname = ""
            ActiveCell.Offset(0, -2).Select
            varGasname = ActiveCell.Value
            ActiveCell.Offset(0, 2).Select
            varMolgewicht = InputBox("Please enter here the molar weight of " & varGasname & " in gramm.")
            varGasnameNeu = varGasname
            varMolgewichtNeu = varMolgewicht
            If varMolgewichtNeu = 0 Then GoTo EndeGasMerken
            If varMolgewichtNeu = "" Then GoTo EndeGasMerken
            
        ' Name und neues Molgewicht speichern
            Range("R183").Select
StartGasMerken:
        If ActiveCell.Value = "" Then
            ActiveCell.Offset(0, 2).Select
            If ActiveCell.Value = "" Then
                ActiveCell.Value = varMolgewichtNeu
                ActiveCell.Offset(0, -2).Select
                ActiveCell.Value = varGasnameNeu
            Else
                ActiveCell.Offset(0, -2).Select
                ActiveCell.Offset(1, 0).Select
                GoTo StartGasMerken
            End If
        Else
            ActiveCell.Offset(1, 0).Select
            GoTo StartGasMerken
        End If
        varGasnameNeu = ""
        varMolgewichtNeu = ""
        ' An alte Position fahren
        Cells(varAktuelleZeile, varAktuelleSpalte).Select
EndeGasMerken:
   End If
' Hier ist der Einschub zu Ende

    If varMolgewicht = "" Or varMolgewicht = 0 Then      ' Wenn trotz Abfrage kein Molgewicht eingegeben wird dann Nichtstun
        ActiveCell.Offset(0, 11).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If

' Jetzt wird vermieden dass fehlende Betriebsbedingungen zu Fehlern fuehren obwohl die nicht gebraucht werden

If iAlteEinheit = 1 Then GoTo SprungpunktBetrieb
If iAlteEinheit = 6 Then GoTo SprungpunktBetrieb
If iNeueEinheit = 1 Then GoTo SprungpunktBetrieb
If iNeueEinheit = 6 Then GoTo SprungpunktBetrieb
    
GoTo WeiterNachBetrieb

SprungpunktBetrieb:
    
    If varNormvolBetrieb = "Fehler" Then ' Wenn die Betriebstemperatur oder -druck nicht i.O. dann Nichtstun
        ActiveCell.Offset(0, 11).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    
WeiterNachBetrieb:


    ActiveCell.Value = varNeueEinheit   ' jetzt gehts mit den Umrechnungen erst los
    
  For iFelder = 1 To 7
    
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    
    If iAlteEinheit = 1 Then varWertInPPM = varAlterWert * varNormvolBetrieb / varMolgewicht
    If iAlteEinheit = 2 Then varWertInPPM = varAlterWert * varNormvolIso / varMolgewicht
    If iAlteEinheit = 3 Then varWertInPPM = varAlterWert * varNormvolDIN / varMolgewicht
    If iAlteEinheit = 4 Then varWertInPPM = varAlterWert
    If iAlteEinheit = 5 Then varWertInPPM = varAlterWert * 10000
    If iAlteEinheit = 6 Then varWertInPPM = varAlterWert * varNormvolBetrieb / varMolgewicht / 1000
    If iAlteEinheit = 7 Then varWertInPPM = varAlterWert * varNormvolIso / varMolgewicht / 1000
    If iAlteEinheit = 8 Then varWertInPPM = varAlterWert * varNormvolDIN / varMolgewicht / 1000
    
    ' Jetzt ist der Wert in ppm bestimmt

    If iNeueEinheit = 1 Then varNeuerWert = varWertInPPM / varNormvolBetrieb * varMolgewicht
    If iNeueEinheit = 2 Then varNeuerWert = varWertInPPM / varNormvolIso * varMolgewicht
    If iNeueEinheit = 3 Then varNeuerWert = varWertInPPM / varNormvolDIN * varMolgewicht
    If iNeueEinheit = 4 Then varNeuerWert = varWertInPPM
    If iNeueEinheit = 5 Then varNeuerWert = varWertInPPM / 10000
    If iNeueEinheit = 6 Then varNeuerWert = varWertInPPM / varNormvolBetrieb * varMolgewicht * 1000
    If iNeueEinheit = 7 Then varNeuerWert = varWertInPPM / varNormvolIso * varMolgewicht * 1000
    If iNeueEinheit = 8 Then varNeuerWert = varWertInPPM / varNormvolDIN * varMolgewicht * 1000
    
    If varAlterWert = "" Then varNeuerWert = ""
    ActiveCell.Value = varNeuerWert

  Next iFelder

    ActiveCell.Offset(0, 4).Select
    ActiveCell = ""

GoTo NixTun

' Variante 2 beginnt.........................................................................

BeginnVariante2:
    ActiveCell.Offset(0, -7).Select
    varAlteEinheit = ActiveCell.Value
    If varAlteEinheit = varNeueEinheit Then
        ActiveCell.Offset(0, 7).Select
        ActiveCell.Value = ""
        GoTo NixTun
    End If
    If varAlteEinheit <> "|fffd|F" And varAlteEinheit <> "|fffd|C" Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If varNeueEinheit <> "|fffd|F" And varNeueEinheit <> "|fffd|C" Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    ActiveCell.Value = varNeueEinheit
    For i = 1 To 3
        ActiveCell.Offset(0, 1).Select
        varAlterWert = ActiveCell.Value
        varNeuerWert = varAlterWert
        If varAlteEinheit = "|fffd|F" Then varNeuerWert = (varAlterWert - 32) * 10 / 18
        If varAlteEinheit = "|fffd|C" Then varNeuerWert = varAlterWert * 18 / 10 + 32
        If varAlterWert = "" Then varNeuerWert = ""
        ActiveCell.Value = varNeuerWert
    Next i
    ActiveCell.Offset(0, 4).Select
    ActiveCell.Value = ""
GoTo NixTun

' Variante 3 beginnt............................................................................

BeginnVariante3:
    ActiveCell.Offset(0, -7).Select
    varAlteEinheit = ActiveCell.Value
    iAlteEinheit = 0
    iNeueEinheit = 0
    For iZeile = 1 To izeileAnz
      If varNeueEinheit = varNameEinheit(iZeile) Then iNeueEinheit = iZeile
      If varAlteEinheit = varNameEinheit(iZeile) Then iAlteEinheit = iZeile
    Next iZeile
    If iNeueEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If iAlteEinheit = 0 Then
       ActiveCell.Offset(0, 7).Select
       iFehler = iFehler + 1
       GoTo NixTun
    End If
    varFaktor = varUmrechnungsfaktor(iAlteEinheit, iNeueEinheit)
    If varFaktor = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    ActiveCell.Value = varNeueEinheit
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 6).Select
    ActiveCell.Value = ""
GoTo NixTun

' Variante 4 beginnt.............................................................................

BeginnVariante4:
    ActiveCell.Offset(0, -7).Select
    varAlteEinheit = ActiveCell.Value
    iAlteEinheit = 0
    iNeueEinheit = 0
    For iZeile = 1 To izeileAnz
      If varNeueEinheit = varNameEinheit(iZeile) Then iNeueEinheit = iZeile
      If varAlteEinheit = varNameEinheit(iZeile) Then iAlteEinheit = iZeile
    Next iZeile
    If iNeueEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If iAlteEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    varFaktor = varUmrechnungsfaktor(iAlteEinheit, iNeueEinheit)
    If varFaktor = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    ActiveCell.Value = varNeueEinheit
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 5).Select
    ActiveCell.Value = ""
GoTo NixTun

' Variante 5 beginnt

BeginnVariante5:
    ActiveCell.Offset(0, -7).Select
    varAlteEinheit = ActiveCell.Value
    iAlteEinheit = 0
    iNeueEinheit = 0
    For iZeile = 1 To izeileAnz
      If varNeueEinheit = varNameEinheit(iZeile) Then iNeueEinheit = iZeile
      If varAlteEinheit = varNameEinheit(iZeile) Then iAlteEinheit = iZeile
    Next iZeile
    If iNeueEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If iAlteEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    varFaktor = varUmrechnungsfaktor(iAlteEinheit, iNeueEinheit)
    If varFaktor = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    ActiveCell.Value = varNeueEinheit
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 4).Select
    ActiveCell.Value = ""
GoTo NixTun

' Variante 6 beginnt

BeginnVariante6:
    ActiveCell.Offset(0, -6).Select
    varAlteEinheit = ActiveCell.Value
    iAlteEinheit = 0
    iNeueEinheit = 0
    For iZeile = 1 To izeileAnz
      If varNeueEinheit = varNameEinheit(iZeile) Then iNeueEinheit = iZeile
      If varAlteEinheit = varNameEinheit(iZeile) Then iAlteEinheit = iZeile
    Next iZeile
    If iNeueEinheit = 0 Then
        ActiveCell.Offset(0, 6).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If iAlteEinheit = 0 Then
        ActiveCell.Offset(0, 6).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    varFaktor = varUmrechnungsfaktor(iAlteEinheit, iNeueEinheit)
    If varFaktor = 0 Then
        ActiveCell.Offset(0, 6).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    ActiveCell.Value = varNeueEinheit
    ActiveCell.Offset(0, -1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor
    ActiveCell.Offset(0, 7).Select
    ActiveCell.Value = ""
GoTo NixTun



BeginnVariante7:
        
    ActiveCell.Offset(0, -7).Select
    varAlteEinheit = ActiveCell.Value
    iAlteEinheit = 0
    iNeueEinheit = 0
    
    For iZeile = 1 To izeileAnz
      If varNeueEinheit = varNameEinheit(iZeile) Then iNeueEinheit = iZeile
      If varAlteEinheit = varNameEinheit(iZeile) Then iAlteEinheit = iZeile
    Next iZeile
    
    If iNeueEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    If iAlteEinheit = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    
    varFaktor = 0
    varFaktor = varUmrechnungsfaktor(iAlteEinheit, iNeueEinheit)
    
    If varFaktor = 0 Then
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    
    If varFaktor = "Calc" Then GoTo AnsprungCalc7
    
    ActiveCell.Value = varNeueEinheit

    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    If varAlterWert <> "" Then ActiveCell.Value = varAlterWert * varFaktor Else ActiveCell.Value = ""
    
    ActiveCell.Offset(0, 4).Select
    ActiveCell.Value = ""

GoTo NixTun
    
AnsprungCalc7:

' Molvolumen Betrieb und ISO holen

Sheets("Factors").Visible = True
Sheets("Factors").Activate
   
    Range("K4").Select
    varNormvolIso = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
    varNormvolIso2 = varNormvolIso / 1013 * 1000 ' weil die Amis nicht die 1000mbar aus der Iso anwenden sondern 1013 nehmen wird das Normvolumen etwas kleiner
'    varDruckISO = ActiveCell.Value
'    ActiveCell.Offset(1, 0).Select
'    varTempISO = ActiveCell.Value
    
    Range("I4").Select
    varNormvolBetrieb = ActiveCell.Value
    ActiveCell.Offset(1, 0).Select
'    varDruckBetrieb = ActiveCell.Value
'    ActiveCell.Offset(1, 0).Select
'    varTempBetrieb = ActiveCell.Value
    
    Range("A11").Select
    Range("A1").Select
    Sheets("Factors").Visible = False

Sheets("AQ").Activate
    
    If varNormvolBetrieb = "Fehler" Then ' Wenn die Betriebstemperatur oder -druck nicht i.O. dann Nichtstun
        ActiveCell.Offset(0, 7).Select
        iFehler = iFehler + 1
        GoTo NixTun
    End If
    
    ActiveCell.Value = varNeueEinheit   ' jetzt gehts mit den Umrechnungen erst los
    
  For iFelder = 1 To 3
    
    ActiveCell.Offset(0, 1).Select
    varAlterWert = ActiveCell.Value
    
    ' Einheit 18: m3/h, 19: l/h, 26: SCFM (standard cubic feet per minute), 27: SCFH (...hour), 28: ACFM (actual cubic feet per minute), 29: ACFH (...hour)
    
    If iAlteEinheit = 18 Then varWertInSCFH = varAlterWert / varNormvolBetrieb * varNormvolIso2 * varUmrechnungsfaktor(18, 29)
    If iAlteEinheit = 19 Then varWertInSCFH = varAlterWert / varNormvolBetrieb * varNormvolIso2 / 1000 * varUmrechnungsfaktor(18, 29)
    If iAlteEinheit = 26 Then varWertInSCFH = varAlterWert / 60
    If iAlteEinheit = 27 Then varWertInSCFH = varAlterWert
    If iAlteEinheit = 28 Then varWertInSCFH = varAlterWert / varNormvolBetrieb * varNormvolIso2 / 60
    If iAlteEinheit = 29 Then varWertInSCFH = varAlterWert / varNormvolBetrieb * varNormvolIso2
    
    ' Jetzt ist der Wert in SCFH (Standardbedingungen pro Stunde aber in Kubikfuss nicht Kubikmeter)

    If iNeueEinheit = 18 Then varNeuerWert = varWertInSCFH * varNormvolBetrieb / varNormvolIso2 / varUmrechnungsfaktor(18, 29)
    If iNeueEinheit = 19 Then varNeuerWert = varWertInSCFH * varNormvolBetrieb / varNormvolIso2 * 1000 / varUmrechnungsfaktor(18, 29)
    If iNeueEinheit = 26 Then varNeuerWert = varWertInSCFH * 60
    If iNeueEinheit = 27 Then varNeuerWert = varWertInSCFH
    If iNeueEinheit = 28 Then varNeuerWert = varWertInSCFH * varNormvolBetrieb / varNormvolIso2 * 60
    If iNeueEinheit = 29 Then varNeuerWert = varWertInSCFH * varNormvolBetrieb / varNormvolIso2
    
    
    If varAlterWert = "" Then varNeuerWert = ""
    ActiveCell.Value = varNeuerWert

  Next iFelder

    ActiveCell.Offset(0, 4).Select
    ActiveCell = ""

GoTo NixTun

NixTun:
         
Next iTqZeile

'Sheets("Factors").Visible = False

'Stop
'If varMolgewichtNeu = "" Or varGasnameNeu = "" Then GoTo EndeGasMerken
 
Application.Run "SchutzEin"
 
Application.ScreenUpdating = True

If iFehler > 0 Then MsgBox ("At least one unit could not be converted, in column P you will see it. Perhaps an input is missing (e.g. regarding the process conditions). Please check.")

Range("A14").Select
Range("I14").Select
Range("B14").Select

End Sub
Sub SondergaseSpeichern()

' Position merken
    
    varAktuelleZeile = ActiveCell.Row
    varAktuelleSpalte = ActiveCell.Column
    
' Name holen und Molgewicht fragen

        varGasname = ""
        ActiveCell.Offset(0, -2).Select
        varGasname = ActiveCell.Value
        ActiveCell.Offset(0, 2).Select
        varMolgewicht = InputBox("Please enter here the molar weight of " & varGasname & " in gramm.")
        
        varGasnameNeu = varGasname
        varMolgewichtNeu = varMolgewicht


' Name und neues Molgewicht speichern

    Range("R177").Select

StartGasMerken:
    
    If ActiveCell.Value = "" Then
        
        ActiveCell.Offset(0, 2).Select
        
        If ActiveCell.Value = "" Then
            ActiveCell.Value = varMolgewichtNeu
            ActiveCell.Offset(0, -2).Select
            ActiveCell.Value = varGasnameNeu
        Else
            ActiveCell.Offset(0, -2).Select
            ActiveCell.Offset(1, 0).Select
            GoTo StartGasMerken
        End If
    
    Else
    
        ActiveCell.Offset(1, 0).Select
        GoTo StartGasMerken
    
    End If
    
    varGasnameNeu = ""
    varMolgewichtNeu = ""


' An alte Position fahren

    Cells(varAktuelleZeile, varAktuelleSpalte).Select

End Sub

Attribute VB_Name = "Modul3"
Sub Print4Data()
    
    If MsgBox("If you continue " & Chr$(10) & Chr$(10) & "- this file will be saved in the actual state,          " & Chr$(10) & "- a pdf-file will be created and opened and then" & Chr$(10) & "- this Excel-file will be closed. " & Chr$(10) & Chr$(10) & "Do you want to continue?", vbYesNo) = vbYes Then
        varAntwort = "Ja"
    Else
        varAntwort = "Nein"
    End If
    
    If varAntwort <> "Ja" Then GoTo Endeansprung

    ActiveWorkbook.Save
            
    Application.ScreenUpdating = False
    
' jetzt wird der pdf-Druck vorbereitet - Name ermittelt etc.

    Application.Run "AlleZeilenEin"
    
    Application.Run "SchutzAus"

    varPfad = ActiveWorkbook.Path
    varDateiname = ActiveWorkbook.Name
    
    iLaenge = Len(varDateiname)
    If Mid$(varDateiname, iLaenge - 3, 4) = ".xls" Then varDateiname = Mid$(varDateiname, 1, iLaenge - 4) Else varDateiname = Mid$(varDateiname, 1, iLaenge - 5)
    varPdfName = varDateiname + ".pdf"
       
    Application.Run "Druckformat4Data"
        
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        varPfad & "\" & varPdfName, Quality:= _
        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
        OpenAfterPublish:=True
   
    varDateiname = ActiveWorkbook.Name
    
    Application.ScreenUpdating = True
       
    Workbooks(varDateiname).Close savechanges:=False

Endeansprung:
        
End Sub
Sub Druckformat4Data()

' zuerst werden die Zeilenhoehen angepasst

    Columns("A:A").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
' dann wird der Druckbereich um zwei Spalten reduziert und der Risikoteil ausgeblendet

    ActiveSheet.PageSetup.PrintArea = "$C$3:$M$162"
    Rows("163:178").Select
    Selection.EntireRow.Hidden = True
    
' die Seitenumbrueche werden gesetzt sofern der Block nicht ganz ausgeblendet ist
    
    Range("AC32").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC57").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC76").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC88").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC101").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC117").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC131").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC145").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
    Range("AC152").Select
    varBlockzeigen = ActiveCell.Value
    If varBlockzeigen <> "" Then ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell
    
 ' alle Felder werden weiss gemacht
 
    Range("AE2").Select
    varImax = ActiveCell.Value
    Range("AC13").Select
    For i = 1 To varImax
        varInhalt = ActiveCell.Value
        If varInhalt <> "" Then ActiveCell.Value = 0
        ActiveCell.Offset(1, 0).Select
    Next i
 
' und dann noch auf Querformat eingestellt der Zoomfaktor der linke und der obere Rand gesetzt und die Kopfzeile gef|fffd|llt
    
    With ActiveSheet.PageSetup
        .PrintComments = xlPrintNoComments
        .Orientation = xlLandscape
        '.Zoom = 79
        .FitToPagesWide = 1
        .LeftMargin = Application.InchesToPoints(0.19685039370079)
        .TopMargin = Application.InchesToPoints(0.78740157480315)
        .HeaderMargin = Application.InchesToPoints(0.393700787401575)
        .LeftHeader = "&18&F"
        .CenterHeader = ""
        .RightHeader = "&18Page &P & from &N &    "
    End With
    
 ' und: falls gefreezed wird die Abdeckflaeche transparanet gemacht
    
    ActiveSheet.Shapes.Range(Array("Rectangle 47")).Select
    With Selection.ShapeRange.Fill
        .Transparency = 1
    End With

End Sub
Sub Print4Contract()

Dim varPdfName As String
Dim varFreezeNummer As String


Application.ScreenUpdating = False

' Vorbedingungen 1: Ist der AQ frozen?

Sheets("Freeze history").Visible = True
Sheets("AQ").Visible = True
    Sheets("AQ").Select

    Range("M12").Select
    varCheck = Range("M12").Value
    
    If varCheck <> "" Then GoTo Weiter
    MsgBox ("The AQ is not frozen. Please make a freeze to enable this function.")
    GoTo Endeansprung
    
Weiter:
    
' Vorbedingung 2: Ist schon eine eingebettete pdf vorhanden?

Sheets("Embedded pdf").Visible = True
    Sheets("Embedded pdf").Select
    Range("G3").Select
    varCheck = ActiveCell.Value
    If varCheck = "." Then
        MsgBox ("There is allready an embedded pdf for this Freeze. Continue with 'OK' and find the icon in cell G3. Doubleclick it and then Adobe appears in the bottom line of your screen." & Chr$(10) & "Click on OK to continue")
        Range("G1").Select
        GoTo Endeansprung
    End If

' Vorbedingungen sind erfuellt - Pfad und Dateinamen werden eingelesen und fuer dei pdf vorbereitet

' Anfang noch im Tabellenblatt embedded pdf:

    Range("B3").Select
    varFreezeNummer = ActiveCell.Value


Sheets("AQ").Visible = True
    Sheets("AQ").Select

' Hinweis auf Ausblenden geben
    
    If MsgBox("Before you create a 'Print4Contract' you should select the comments that you want to exclude by selecting 'SICK' in the hidden drop box at the end of each row in columne N." & Chr$(10) & "Please ensure that all comments that are relevant to the contractual agreement with the customer remain visible." & Chr$(10) & "Do you want to continue with the printout?", vbYesNo) = vbYes Then
        varAntwort = "Ja"
    Else
        varAntwort = "Nein"
    End If
    
    If varAntwort <> "Ja" Then GoTo Endeansprung
    
' los gehts

    Application.Run "AlleZeilenEin"
    
    Application.Run "SchutzAus"
    
' die Ampel wird ausgeschaltet und dann der Pfad und der Dateiname eingelesen

    Range("AA2").Select
    ActiveCell.Value = "Aus"
    
    varPfad = ActiveWorkbook.Path
    varDateiname = ActiveWorkbook.Name
    
    iLaenge = Len(varDateiname)
    If Mid$(varDateiname, iLaenge - 3, 4) = ".xls" Then varDateiname = Mid$(varDateiname, 1, iLaenge - 4) Else varDateiname = Mid$(varDateiname, 1, iLaenge - 5)
    varPdfName = varDateiname + "-Contract-" + varFreezeNummer + ".pdf"
    
' die auszublendenden Felder werden auf die gleiche Schriftfarbe gesetzt
       
    Application.ScreenUpdating = False

    Application.Run "DontShow4Contract"
    
' Erzeugen der pdf

On Error Resume Next
    
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        varPfad & "\" & varPdfName, Quality:= _
        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
   
    ' Verlinken der pdf
   
    Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select
    
    Application.Run "SchutzAus"
    
    Range("I11").Select
    ActiveCell.Value = varFreezeNummer
    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=varPfad & "\" & varPdfName, _
        TextToDisplay:=varFreezeNummer
    
    Range("I11").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleSingle
        .ThemeColor = xlThemeColorHyperlink
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Selection.Font.Bold = True
   
   Application.Run "SchutzEin"
   
On Error GoTo 0
   
' jetzt das Einbetten der pdf

Sheets("Embedded pdf").Visible = True
    Sheets("Embedded pdf").Select
    Application.Run "SchutzAus"
    
'   Range("B3").Select
'   varFreezeNummer = ActiveCell.Value

StartEinbetten:
    
    On Error Resume Next
       
    Range("G3").Select
    ActiveCell.Value = "."
    varIconTitel = "For Contract-" & varFreezeNummer
    ActiveSheet.OLEObjects.Add(Filename:= _
        varPfad & "\" & varPdfName, Link:=False, _
        DisplayAsIcon:=True, IconFileName:= _
        "C:\Windows\Installer\{AC76BA86-7AD7-1031-7B44-AB0000000001}\PDFFile_8.ico", _
        IconIndex:=0, IconLabel:=varIconTitel).Select

    varFehlername = Error$
      
    If varFehlername <> "" Then MsgBox ("A problem occured: The creation or embedding of the pdf did not work. Please check.")
            
    On Error GoTo 0
    
    Range("G1").Select

' die ausgebendeten Felder werden wieder sichtbar gemacht und die Ampel wird wieder eingeschaltet
    
    Sheets("AQ").Visible = True
    Sheets("Embedded pdf").Visible = True
    Sheets("Freeze history").Visible = True
    
    Sheets("AQ").Select
    
    Application.Run "ShowAgain"
    
    Range("AA2").Select
    ActiveCell.Value = "Ein"
    
' Ende ohne Speichern wird eingelaeutet

    Application.ScreenUpdating = True
    
    Application.Run "SchutzEin"
        
    Range("I14").Select
    Range("B14").Select
    
    Sheets("Freeze history").Visible = True
    Sheets("Freeze history").Select
    Range("I11").Select
    
Endeansprung:

End Sub
Sub DontShow4Contract()

' Zuerst wird der Risikoteil ausgeblendet
    
    Rows("163:178").Select
    Selection.EntireRow.Hidden = True
    
' dann das selektive Ausblenden der freien Bemerkungen

    Range("AE2").Select
    varImax = ActiveCell.Value
    Range("N15").Select
    
    For i = 1 To varImax
    
        ActiveCell.Offset(1, 0).Select
        varInhalt = ActiveCell.Value
        If varInhalt <> "SICK" Then GoTo Endeansprung
        
    ' hier gehts nur hin wenn da SICK steht

        ActiveCell.Offset(0, -1).Select

        With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
        End With
        
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        End With

        ActiveCell.Offset(0, 1).Select
    
Endeansprung:
    
    Next i

    Range("N15:N178").Select
   
    With Selection.Font
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.399975585192419
    End With
   
    ActiveSheet.Shapes.Range(Array("Rectangle 47")).Select
    Application.CommandBars("Format Object").Visible = False
    With Selection.ShapeRange.Fill
        .Transparency = 1
    End With

End Sub
Sub ShowAgain()
    
    Range("N15:N178").Select
   
    With Selection.Font
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = -0.249977111117893
    End With
    
    Range("AE2").Select
    varImax = ActiveCell.Value
    Range("N15").Select
    
    For i = 1 To varImax
    
        ActiveCell.Offset(1, 0).Select
        varInhalt = ActiveCell.Value
        If varInhalt <> "SICK" Then GoTo Endeansprung
        
        ' hier gehts nur hin wenn da SICK steht

        ActiveCell.Offset(0, -1).Select
    
        With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
    
        ActiveCell.Offset(0, 1).Select
Endeansprung:
    
    Next i
    
    ActiveSheet.Shapes.Range(Array("Rectangle 47")).Select
    Application.CommandBars("Format Object").Visible = False
    With Selection.ShapeRange.Fill
        .Transparency = 0.72
    End With



End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub OptionButton1_Click()

End Sub
Attribute VB_Name = "Tabelle18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' &F(!
' )^J)

INQUEST-PP=macro
