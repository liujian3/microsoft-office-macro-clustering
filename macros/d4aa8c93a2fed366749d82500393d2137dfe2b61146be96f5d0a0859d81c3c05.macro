Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OptionButton28, 101, 0, MSForms, OptionButton"
Attribute VB_Control = "OptionButton27, 100, 1, MSForms, OptionButton"
Attribute VB_Control = "OptionButton1, 42, 2, MSForms, OptionButton"
Attribute VB_Control = "OptionButton26, 43, 3, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 16, 4, MSForms, OptionButton"
Attribute VB_Control = "OptionButton3, 17, 5, MSForms, OptionButton"
Attribute VB_Control = "OptionButton4, 18, 6, MSForms, OptionButton"
Attribute VB_Control = "OptionButton6, 20, 8, MSForms, OptionButton"
Attribute VB_Control = "OptionButton7, 21, 9, MSForms, OptionButton"
Attribute VB_Control = "OptionButton8, 22, 10, MSForms, OptionButton"
Attribute VB_Control = "OptionButton9, 23, 11, MSForms, OptionButton"
Attribute VB_Control = "OptionButton10, 24, 12, MSForms, OptionButton"
Attribute VB_Control = "OptionButton11, 25, 13, MSForms, OptionButton"
Attribute VB_Control = "OptionButton12, 26, 14, MSForms, OptionButton"
Attribute VB_Control = "OptionButton13, 27, 15, MSForms, OptionButton"
Attribute VB_Control = "OptionButton14, 28, 16, MSForms, OptionButton"
Attribute VB_Control = "OptionButton15, 29, 17, MSForms, OptionButton"
Attribute VB_Control = "OptionButton16, 30, 18, MSForms, OptionButton"
Attribute VB_Control = "OptionButton17, 31, 19, MSForms, OptionButton"
Attribute VB_Control = "OptionButton18, 32, 20, MSForms, OptionButton"
Attribute VB_Control = "OptionButton19, 33, 21, MSForms, OptionButton"
Attribute VB_Control = "OptionButton20, 34, 22, MSForms, OptionButton"
Attribute VB_Control = "OptionButton21, 35, 23, MSForms, OptionButton"
Attribute VB_Control = "OptionButton22, 36, 24, MSForms, OptionButton"
Attribute VB_Control = "OptionButton23, 37, 25, MSForms, OptionButton"
Attribute VB_Control = "OptionButton24, 38, 26, MSForms, OptionButton"
Attribute VB_Control = "OptionButton25, 39, 27, MSForms, OptionButton"
Attribute VB_Control = "OptionButton36, 109, 28, MSForms, OptionButton"
Attribute VB_Control = "ComboBox1, 59, 29, MSForms, ComboBox"
Attribute VB_Control = "OptionButton35, 108, 30, MSForms, OptionButton"
Attribute VB_Control = "opbvelikost_velika, 64, 31, MSForms, OptionButton"
Attribute VB_Control = "ComboBox2, 60, 32, MSForms, ComboBox"
Attribute VB_Control = "ComboBox3, 61, 33, MSForms, ComboBox"
Attribute VB_Control = "ComboBox4, 62, 34, MSForms, ComboBox"
Attribute VB_Control = "ComboBox5, 63, 35, MSForms, ComboBox"
Attribute VB_Control = "OptionButton29, 102, 36, MSForms, OptionButton"
Attribute VB_Control = "OptionButton30, 103, 37, MSForms, OptionButton"
Attribute VB_Control = "OptionButton31, 104, 38, MSForms, OptionButton"
Attribute VB_Control = "OptionButton32, 105, 39, MSForms, OptionButton"
Attribute VB_Control = "OptionButton33, 106, 40, MSForms, OptionButton"
Attribute VB_Control = "OptionButton34, 107, 41, MSForms, OptionButton"
Attribute VB_Control = "OptionButton37, 110, 42, MSForms, OptionButton"
Attribute VB_Control = "OptionButton38, 111, 43, MSForms, OptionButton"
Attribute VB_Control = "OptionButton39, 114, 46, MSForms, OptionButton"
Attribute VB_Control = "OptionButton40, 115, 47, MSForms, OptionButton"
Attribute VB_Control = "OptionButton41, 116, 48, MSForms, OptionButton"
Attribute VB_Control = "OptionButton42, 117, 49, MSForms, OptionButton"
Attribute VB_Control = "OptionButton43, 118, 50, MSForms, OptionButton"
Attribute VB_Control = "OptionButton44, 119, 51, MSForms, OptionButton"
Attribute VB_Control = "OptionButton45, 120, 52, MSForms, OptionButton"
Attribute VB_Control = "OptionButton46, 121, 53, MSForms, OptionButton"
Attribute VB_Control = "OptionButton47, 122, 54, MSForms, OptionButton"
Attribute VB_Control = "OptionButton48, 123, 55, MSForms, OptionButton"
Option Explicit
Public velikost, velikost_opr, obr_velikost, velikost_tekoce, velikost_preteklo, velikost_predp As Range




Private Sub ComboBox1_Change()
    Dim Sourcerange As Range
    Dim Val1 As String, Val2 As String, Val3 As String
    Dim temp As Double
    Dim temp1 As String

10  On Error GoTo ComboBox1_Change_Error

    'Get Range that the ListBox is bound to
20  Set Sourcerange = Range(ComboBox1.ListFillRange)

30  Val1 = ComboBox1.Value
    'Get the value of the second column
40  Val2 = Sourcerange.Offset(ComboBox1.ListIndex, 1).Resize(1, 1).Value
50  temp1 = "9999" & Val2
60  temp = CDbl(temp1)
    'Concatenate the three values together and display them in Label1
70  If Val2 = "705" Then
80      Worksheets("Opredelitev").Range("d53").ClearContents
90  Else
100     Worksheets("Opredelitev").Range("d53").Value = temp
110 End If

120 On Error GoTo 0
130 Exit Sub

ComboBox1_Change_Error:

140 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri ComboBox1_Change v VBA Document List10"
End Sub

Private Sub ComboBox2_Change()
    Dim Sourcerange As Range
    Dim Val1 As String, Val2 As String, Val3 As String
    Dim temp As Double
    Dim temp1 As String

10  On Error GoTo ComboBox2_Change_Error

    'Get Range that the ListBox is bound to
20  Set Sourcerange = Range(ComboBox2.ListFillRange)

30  Val1 = ComboBox2.Value
    'Get the value of the second column
40  Val2 = Sourcerange.Offset(ComboBox2.ListIndex, 1).Resize(1, 1).Value
50  temp1 = "9999" & Val2
60  temp = CDbl(temp1)
    'Concatenate the three values together and display them in Label1
70  If Val2 = "705" Then
80      Worksheets("Opredelitev").Range("d56").ClearContents
90  Else
100     Worksheets("Opredelitev").Range("d56").Value = temp
110 End If

120 On Error GoTo 0
130 Exit Sub

ComboBox2_Change_Error:

140 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri ComboBox2_Change v VBA Document List10"

End Sub

Private Sub ComboBox3_Change()
    Dim Sourcerange As Range
    Dim Val1 As String, Val2 As String, Val3 As String
    Dim temp As Double
    Dim temp1 As String

10  On Error GoTo ComboBox3_Change_Error

    'Get Range that the ListBox is bound to
20  Set Sourcerange = Range(ComboBox3.ListFillRange)

30  Val1 = ComboBox3.Value
    'Get the value of the second column
40  Val2 = Sourcerange.Offset(ComboBox3.ListIndex, 1).Resize(1, 1).Value
50  temp1 = "9999" & Val2
60  temp = CDbl(temp1)
    'Concatenate the three values together and display them in Label1
70  If Val2 = "705" Then
80      Worksheets("Opredelitev").Range("d59").ClearContents
90  Else
100     Worksheets("Opredelitev").Range("d59").Value = temp
110 End If

120 On Error GoTo 0
130 Exit Sub

ComboBox3_Change_Error:

140 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri ComboBox3_Change v VBA Document List10"

End Sub

Private Sub ComboBox4_Change()
    Dim Sourcerange As Range
    Dim Val1 As String, Val2 As String, Val3 As String
    Dim temp As Double
    Dim temp1 As String

10  On Error GoTo ComboBox4_Change_Error

    'Get Range that the ListBox is bound to
20  Set Sourcerange = Range(ComboBox4.ListFillRange)

30  Val1 = ComboBox4.Value
    'Get the value of the second column
40  Val2 = Sourcerange.Offset(ComboBox4.ListIndex, 1).Resize(1, 1).Value
50  temp1 = "9999" & Val2
60  temp = CDbl(temp1)
    'Concatenate the three values together and display them in Label1
70  If Val2 = "705" Then
80      Worksheets("Opredelitev").Range("d75").ClearContents
90  Else
100     Worksheets("Opredelitev").Range("d75").Value = Val2
110 End If

120 On Error GoTo 0
130 Exit Sub

ComboBox4_Change_Error:

140 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri ComboBox4_Change v VBA Document List10"

End Sub

Private Sub ComboBox5_Change()
    Dim Sourcerange As Range
    Dim Val1 As String, Val2 As String, Val3 As String
    Dim temp As Double
    Dim temp1 As String

10  On Error GoTo ComboBox5_Change_Error

    'Get Range that the ListBox is bound to
20  Set Sourcerange = Range(ComboBox5.ListFillRange)

30  Val1 = ComboBox5.Value
    'Get the value of the second column
40  Val2 = Sourcerange.Offset(ComboBox5.ListIndex, 1).Resize(1, 1).Value
50  temp1 = "9999" & Val2
60  temp = CDbl(temp1)
    'Concatenate the three values together and display them in Label1
70  If Val2 = "705" Then
80      Worksheets("Opredelitev").Range("d78").ClearContents
90  Else
100     Worksheets("Opredelitev").Range("d78").Value = Val2
110 End If

120 On Error GoTo 0
130 Exit Sub

ComboBox5_Change_Error:

140 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri ComboBox5_Change v VBA Document List10"

End Sub

Private Sub opbvelikost_velika_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
    Dim sht As Worksheet, sht1 As Worksheet, velikost As Range, velikost_opr As Range, obr_velikost As Range, velikost_tekoce As Range, velikost_preteklo As Range, obravn_vel_pret As Range
10  On Error GoTo opbvelikost_velika_Click_Error

20  Set sht = Worksheets("Status_vnosa")
30  Set sht1 = Worksheets("opredelitev")
40  Set velikost = sht.Range("b90")
50  Set velikost_opr = Range("kap_velikost")
60  Set obr_velikost = sht.Range("a141")    ' obravnavana velikost
70  Set velikost_tekoce = sht.Range("b85")    ' izracuna velikost tekoce leto
80  Set velikost_preteklo = sht.Range("d85")    ' izracunana velikost preteklo leto
90  Set obravn_vel_pret = sht.Range("f85")    ' obravnavana velikost preteklo
100 For Each objole In ActiveSheet.OLEObjects
110     If TypeOf objole.Object Is MSForms.OptionButton Then
120         Set cb = objole.Object
130         If cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_place" _
               Or cb.GroupName = "javna_objava" Then
140             cb.Enabled = False
150             cb.Value = False
160         End If
170         If cb.GroupName = "Povezanost" Then
180             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
190                 cb.Enabled = True
200                 cb.Value = False
210             Else
220                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
230                     cb.Enabled = False
240                     cb.Value = False
250                 End If
260             End If
270         End If
280         If OptionButton6.Value = True Then
290             If cb.GroupName = "Vrsta_podruznice" Then
300                 cb.Enabled = True
310                 cb.Value = False
320             End If
330         End If
340         If Left(cb.GroupName, 10) = "poslovanje" Then
350             If sht1.Range("kap_vrsta") = 3 Then
360                 cb.Enabled = False
370                 cb.Value = False
380             Else
390                 cb.Enabled = True
400                 cb.Value = False
410             End If
420         End If
430         If cb.GroupName = "Velikost" Then
440             cb.Value = False
450         End If
460     End If
470 Next objole
480 If opbvelikost_velika.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
490     Worksheets("opredelitev").Range("c44").Select
500     Worksheets("opredelitev").Unprotect Password:="nuladva"
510     ActiveSheet.Range("kap_rac_post").ClearContents
520     ActiveSheet.Range("kap_inv_holding").ClearContents
530     ActiveSheet.Range("kap_poj_razkritja").ClearContents
540     ActiveSheet.Range("kap_opredelitev").ClearContents
550     ActiveSheet.Range("kap_zavezanost").ClearContents
560     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
570     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
580     ActiveSheet.Range("kap_vrsta_podr").ClearContents
590     ActiveSheet.Range("kap_javna_objava").ClearContents
600     ActiveSheet.Range("kap_posl_tujina").ClearContents
610     ActiveSheet.Range("kap_velikost").Value = 4
620     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
630 End If
640 If velikost.Value <> velikost_opr.Value Then
650     MsgBox ("Izra|fffd|unana velikost za teko|fffd|e leto je " & velikost_tekoce.Value & ", " _
              & "izra|fffd|unana velikost za preteklo leto " & "je " & velikost_preteklo.Value & "," & " obravnavana velikost " _
              & "iz predhodnega letnega poro|fffd|ila je " & obravn_vel_pret.Value & ", " _
              & "zato je obravnavana velikost " & obr_velikost.Value & "." & "Ponovno preverite bilan|fffd|ne podatke za teko|fffd|e " _
              & "in preteklo leto in obravnavano velikost iz predhodnega letnega poro|fffd|ila oz. popravite velikost, " _
              & "za katero ste se opredelili.")
660 End If

670 On Error GoTo 0
680 Exit Sub

opbvelikost_velika_Click_Error:

690 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton12_Click v VBA Document List10"
End Sub

Private Sub OptionButton1_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton1_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Poslovno_leto" Or cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Subjekt_jav_interes" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton1.Value = True Then
        '  Application.EnableEvents = False
        '  Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c16").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_jav_interes").ClearContents
200     ActiveSheet.Range("kap_poslovno_leto").ClearContents
210     ActiveSheet.Range("kap_velikost").ClearContents
220     ActiveSheet.Range("kap_rac_post").ClearContents
230     ActiveSheet.Range("kap_inv_holding").ClearContents
240     ActiveSheet.Range("kap_poj_razkritja").ClearContents
250     ActiveSheet.Range("kap_opredelitev").ClearContents
260     ActiveSheet.Range("kap_zavezanost").ClearContents
270     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
280     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
290     ActiveSheet.Range("kap_vrsta_podr").ClearContents
300     ActiveSheet.Range("kap_javna_objava").ClearContents
310     ActiveSheet.Range("kap_posl_tujina").ClearContents
320     ActiveSheet.Range("kap_vrsta").Value = 1
330     Worksheets("opredelitev").Protect Password:="nuladva"
        '  Application.EnableEvents = True
        '  Application.Calculation = xlCalculationAutomatic
340 End If
    ' Dodano 12.12.2005 po zahtevku
350 If OptionButton1.Value = True Then
360     If Sheets("BS").Range("e84").Value < 7500 Then
370         MsgBox ("Opozorilo: Osnovni kapital (AOP 058)" & vbCrLf _
                  & "je manj|fffd|i od predpisanega. Prosim preverite.")
380     End If
390 End If

400 On Error GoTo 0
410 Exit Sub

OptionButton1_Click_Error:

420 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton1_Click v VBA Document List10"
End Sub


Sub ListControlsInSheet()
    Dim objole As Excel.OLEObject

    Dim cb As MSForms.OptionButton
    Dim TB As MSForms.TextBox
    '
    ' and so on
    '
    Dim Ctrl As Object
10  On Error GoTo ListControlsInSheet_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          cb.AutoSize = False



60      End If



70  Next objole

80  On Error GoTo 0
90  Exit Sub

ListControlsInSheet_Error:

100 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri ListControlsInSheet v VBA Document List10"
End Sub



Private Sub OptionButton10_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

    Dim sht As Worksheet, sht1 As Worksheet, velikost As Range, velikost_opr As Range, obr_velikost As Range, velikost_tekoce As Range, velikost_preteklo As Range, obravn_vel_pret As Range
10  On Error GoTo OptionButton10_Click_Error

20  Set sht = Worksheets("Status_vnosa")
30  Set sht1 = Worksheets("opredelitev")
40  Set velikost = sht.Range("b90")
50  Set velikost_opr = Range("kap_velikost")
60  Set obr_velikost = sht.Range("a141")    ' obravnavana velikost
70  Set velikost_tekoce = sht.Range("b85")    ' izracuna velikost tekoce leto
80  Set velikost_preteklo = sht.Range("d85")    ' izracunana velikost preteklo leto
90  Set obravn_vel_pret = sht.Range("f85")    ' obravnavana velikost preteklo
100 For Each objole In ActiveSheet.OLEObjects
110     If TypeOf objole.Object Is MSForms.OptionButton Then
120         Set cb = objole.Object
130         If cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_place" _
               Or cb.GroupName = "javna_objava" Then
140             cb.Enabled = False
150             cb.Value = False
160         End If
170         If cb.GroupName = "Povezanost" Then
180             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
190                 cb.Enabled = True
200                 cb.Value = False
210             Else
220                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
230                     cb.Enabled = False
240                     cb.Value = False
250                 End If
260             End If
270         End If
280         If cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" Then    'velja samo za mikro druzbe in zadruge
290             If sht1.Range("kap_vrsta") = 1 Or sht1.Range("kap_vrsta") = 3 Then
300                 cb.Enabled = True
310                 cb.Value = False
320             Else
330                 cb.Enabled = False
340                 cb.Value = False
350             End If
360         End If
370         If cb.GroupName = "Poj_or_razkritja" Then
380             cb.Enabled = False
390             cb.Value = False
400         End If
410         If OptionButton6.Value = True Then
420             If cb.GroupName = "Vrsta_podruznice" Then
430                 cb.Enabled = True
440                 cb.Value = False
450             End If
460         End If
470         If Left(cb.GroupName, 10) = "poslovanje" Then
480             If sht1.Range("kap_vrsta") = 3 Then
490                 cb.Enabled = False
500                 cb.Value = False
510             Else
520                 cb.Enabled = True
530                 cb.Value = False
540             End If
550         End If
560         If cb.GroupName = "Velikost_velika" Then
570             cb.Value = False
580         End If
590     End If
600 Next objole
610 If OptionButton10.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
620     Worksheets("opredelitev").Range("c33").Select
630     Worksheets("opredelitev").Unprotect Password:="nuladva"
640     ActiveSheet.Range("kap_rac_post").ClearContents
650     ActiveSheet.Range("kap_inv_holding").ClearContents
660     ActiveSheet.Range("kap_poj_razkritja").ClearContents
670     ActiveSheet.Range("kap_opredelitev").ClearContents
680     ActiveSheet.Range("kap_zavezanost").ClearContents
690     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
700     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
710     ActiveSheet.Range("kap_vrsta_podr").ClearContents
720     ActiveSheet.Range("kap_javna_objava").ClearContents
730     ActiveSheet.Range("kap_posl_tujina").ClearContents
740     ActiveSheet.Range("kap_velikost").Value = 1
750     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
760 End If
770 If velikost.Value <> velikost_opr.Value Then
780     MsgBox ("Izra|fffd|unana velikost za teko|fffd|e leto je " & velikost_tekoce.Value & ", " _
              & "izra|fffd|unana velikost za preteklo leto " & "je " & velikost_preteklo.Value & "," & " obravnavana velikost " _
              & "iz predhodnega letnega poro|fffd|ila je " & obravn_vel_pret.Value & ", " _
              & "zato je obravnavana velikost " & obr_velikost.Value & "." & "Ponovno preverite bilan|fffd|ne podatke za teko|fffd|e " _
              & "in preteklo leto in obravnavano velikost iz predhodnega letnega poro|fffd|ila oz. popravite velikost, " _
              & "za katero ste se opredelili.")
790 End If

800 On Error GoTo 0
810 Exit Sub

OptionButton10_Click_Error:

820 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton10_Click v VBA Document List10"
End Sub

Private Sub OptionButton13_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet

10  On Error GoTo OptionButton13_Click_Error
20  Set sht = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vrsta_podruznice" _
               Or cb.GroupName = "javna_objava" Then
70              cb.Enabled = False
80              cb.Value = False
90          End If
100         If cb.GroupName = "Zavezanost_reviziji" Then
110             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
120                 cb.Enabled = True
130                 cb.Value = False
140             Else
150                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
160                     cb.Enabled = False
170                     cb.Value = False
180                 End If
190             End If
200         End If
210         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
220             If sht.Range("kap_pog_preiskavi").Value = 1 Then
230                 cb.Enabled = True
240                 cb.Value = False
250             Else
260                 cb.Enabled = False
270                 cb.Value = False
280             End If
290         End If
300         If cb.GroupName = "Zavezanost_por_plac" Then
310             If sht.Range("kap_velikost").Value = 4 Then
320                 cb.Enabled = True
330                 cb.Value = False
340             Else
350                 cb.Enabled = False
360                 cb.Value = False
370             End If
380         End If

390     End If
400 Next objole
410 If OptionButton13.Value = True Then
        'application.enableevents = False
420     Worksheets("opredelitev").Range("c48").Select
430     Worksheets("opredelitev").Unprotect Password:="nuladva"
440     ActiveSheet.Range("kap_opredelitev").Value = 1
450     ActiveSheet.Range("kap_zavezanost").ClearContents
460     ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
470     ActiveSheet.Range("Kap_por_plac_vladam").ClearContents
480     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
490 End If

500 On Error GoTo 0
510 Exit Sub

OptionButton13_Click_Error:

520 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton13_Click v VBA Document List10"
End Sub

Private Sub OptionButton14_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
    Dim sht As Worksheet
10  On Error GoTo OptionButton14_Click_Error

20  Set sht = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vrsta_podruznice" _
               Or cb.GroupName = "javna_objava" Then
70              cb.Enabled = False
80              cb.Value = False
90          End If
100         If cb.GroupName = "Zavezanost_reviziji" Then
110             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
120                 cb.Enabled = True
130                 cb.Value = False
140             Else
150                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
160                     cb.Enabled = False
170                     cb.Value = False
180                 End If
190             End If
200         End If
210         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
220             If sht.Range("kap_pog_preiskavi").Value = 1 Then
230                 cb.Enabled = True
240                 cb.Value = False
250             Else
260                 cb.Enabled = False
270                 cb.Value = False
280             End If
290         End If
300         If cb.GroupName = "Zavezanost_por_plac" Then
310             If sht.Range("kap_velikost").Value = 4 Then
320                 cb.Enabled = True
330                 cb.Value = False
340             Else
350                 cb.Enabled = False
360                 cb.Value = False
370             End If
380         End If
390     End If
400 Next objole
410 If OptionButton14.Value = True Then
        'application.enableevents = False
420     Worksheets("opredelitev").Range("c49").Select
430     Worksheets("opredelitev").Unprotect Password:="nuladva"
440     ActiveSheet.Range("kap_opredelitev").Value = 2
450     ActiveSheet.Range("kap_zavezanost").ClearContents
460     ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
470     ActiveSheet.Range("Kap_por_plac_vladam").ClearContents
480     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
490 End If
500 If Not sht.Range("kap_velikost").Value = 4 Then
510     MsgBox ("Dru|fffd|ba je zavezana za konsolidacijo, zato je obravnavana velikost avtomatsko" _
              & " velika. Ponovno preverite oz. popravite opredelitev (velikost, zavezanost za konsolidacijo).")
520 End If

530 On Error GoTo 0
540 Exit Sub

OptionButton14_Click_Error:

550 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton14_Click v VBA Document List10"
End Sub

Private Sub OptionButton15_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
    Dim sht As Worksheet
10  On Error GoTo OptionButton15_Click_Error

20  Set sht = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vrsta_podruznice" _
               Or cb.GroupName = "javna_objava" Then
70              cb.Enabled = False
80              cb.Value = False
90          End If
100         If cb.GroupName = "Zavezanost_reviziji" Then
110             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
120                 cb.Enabled = True
130                 cb.Value = False
140             Else
150                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
160                     cb.Enabled = False
170                     cb.Value = False
180                 End If
190             End If
200         End If
210         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
220             If sht.Range("kap_pog_preiskavi").Value = 1 Then
230                 cb.Enabled = True
240                 cb.Value = False
250             Else
260                 cb.Enabled = False
270                 cb.Value = False
280             End If
290         End If
300         If cb.GroupName = "Zavezanost_por_plac" Then
310             If sht.Range("kap_velikost").Value = 4 Then
320                 cb.Enabled = True
330                 cb.Value = False
340             Else
350                 cb.Enabled = False
360                 cb.Value = False
370             End If
380         End If
390     End If
400 Next objole
410 If OptionButton15.Value = True Then
        'application.enableevents = False
420     Worksheets("opredelitev").Range("c50").Select
430     Worksheets("opredelitev").Unprotect Password:="nuladva"
440     ActiveSheet.Range("kap_opredelitev").Value = 3
450     ActiveSheet.Range("kap_zavezanost").ClearContents
460     ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
470     ActiveSheet.Range("Kap_por_plac_vladam").ClearContents
480     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
490 End If

500 On Error GoTo 0
510 Exit Sub

OptionButton15_Click_Error:

520 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton15_Click v VBA Document List10"
End Sub

Private Sub OptionButton16_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
    Dim sht As Worksheet

10  On Error GoTo OptionButton16_Click_Error

20  Set sht = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vrsta_podruznice" _
               Or cb.GroupName = "javna_objava" Then
70              cb.Enabled = False
80              cb.Value = False
90          End If
100         If cb.GroupName = "Zavezanost_reviziji" Then
110             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
120                 cb.Enabled = True
130                 cb.Value = False
140             Else
150                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
160                     cb.Enabled = False
170                     cb.Value = False
180                 End If
190             End If
200         End If
210         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
220             If sht.Range("kap_pog_preiskavi").Value = 1 Then
230                 cb.Enabled = True
240                 cb.Value = False
250             Else
260                 cb.Enabled = False
270                 cb.Value = False
280             End If
290         End If
300         If cb.GroupName = "Zavezanost_por_plac" Then
310             If sht.Range("kap_velikost").Value = 4 Then
320                 cb.Enabled = True
330                 cb.Value = False
340             Else
350                 cb.Enabled = False
360                 cb.Value = False
370             End If
380         End If
390     End If
400 Next objole
410 If OptionButton16.Value = True Then
        'application.enableevents = False
420     Worksheets("opredelitev").Range("c51").Select
430     Worksheets("opredelitev").Unprotect Password:="nuladva"
440     ActiveSheet.Range("kap_opredelitev").Value = 4
450     ActiveSheet.Range("kap_zavezanost").ClearContents
460     ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
470     ActiveSheet.Range("Kap_por_plac_vladam").ClearContents
480     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
490 End If
500 If Not sht.Range("kap_velikost").Value = 4 Then
510     MsgBox ("Dru|fffd|ba je zavezana za konsolidacijo, zato je obravnavana velikost avtomatsko" _
              & " velika. Ponovno preverite oz. popravite opredelitev (velikost, zavezanost za konsolidacijo).")
520 End If
530 On Error GoTo 0
540 Exit Sub

OptionButton16_Click_Error:

550 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton16_Click v VBA Document List10"
End Sub

Private Sub OptionButton17_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet

10  On Error GoTo OptionButton17_Click_Error

20  Set sht = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vrsta_podruznice" _
               Or cb.GroupName = "javna_objava" Then
70              cb.Enabled = False
80              cb.Value = False
90          End If
100         If cb.GroupName = "Zavezanost_reviziji" Then
110             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
120                 cb.Enabled = True
130                 cb.Value = False
140             Else
150                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
160                     cb.Enabled = False
170                     cb.Value = False
180                 End If
190             End If
200         End If
210         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
220             If sht.Range("kap_pog_preiskavi").Value = 1 Then
230                 cb.Enabled = True
240                 cb.Value = False
250             Else
260                 cb.Enabled = False
270                 cb.Value = False
280             End If
290         End If
300         If cb.GroupName = "Zavezanost_por_plac" Then
310             If sht.Range("kap_velikost").Value = 4 Then
320                 cb.Enabled = True
330                 cb.Value = False
340             Else
350                 cb.Enabled = False
360                 cb.Value = False
370             End If
380         End If
390     End If
400 Next objole
410 If OptionButton17.Value = True Then
        'application.enableevents = False
420     Worksheets("opredelitev").Range("c54").Select
430     Worksheets("opredelitev").Unprotect Password:="nuladva"
440     ActiveSheet.Range("kap_opredelitev").Value = 5
450     ActiveSheet.Range("kap_zavezanost").ClearContents
460     ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
470     ActiveSheet.Range("Kap_por_plac_vladam").ClearContents
480     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
490 End If

500 On Error GoTo 0
510 Exit Sub

OptionButton17_Click_Error:

520 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton17_Click v VBA Document List10"
End Sub

Private Sub OptionButton18_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet

10  On Error GoTo OptionButton18_Click_Error

20  Set sht = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vrsta_podruznice" _
               Or cb.GroupName = "javna_objava" Then
70              cb.Enabled = False
80              cb.Value = False
90          End If
100         If cb.GroupName = "Zavezanost_reviziji" Then
110             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
120                 cb.Enabled = True
130                 cb.Value = False
140             Else
150                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
160                     cb.Enabled = False
170                     cb.Value = False
180                 End If
190             End If
200         End If
210         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
220             If sht.Range("kap_pog_preiskavi").Value = 1 Then
230                 cb.Enabled = True
240                 cb.Value = False
250             Else
260                 cb.Enabled = False
270                 cb.Value = False
280             End If
290         End If
300         If cb.GroupName = "Zavezanost_por_plac" Then
310             If sht.Range("kap_velikost").Value = 4 Then
320                 cb.Enabled = True
330                 cb.Value = False
340             Else
350                 cb.Enabled = False
360                 cb.Value = False
370             End If
380         End If
390     End If
400 Next objole
410 If OptionButton18.Value = True Then
        'application.enableevents = False
420     Worksheets("opredelitev").Range("c57").Select
430     Worksheets("opredelitev").Unprotect Password:="nuladva"
440     ActiveSheet.Range("kap_opredelitev").Value = 6
450     ActiveSheet.Range("kap_zavezanost").ClearContents
460     ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
470     ActiveSheet.Range("Kap_por_plac_vladam").ClearContents
480     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
490 End If

500 On Error GoTo 0
510 Exit Sub

OptionButton18_Click_Error:

520 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton18_Click v VBA Document List10"
End Sub

Private Sub OptionButton19_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton19_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "javna_objava" Then
60              cb.Enabled = False
70              cb.Value = False
80          End If
90          If cb.GroupName = "Vrsta_podruznice" Then
100             If OptionButton6.Value = True Then
110                 cb.Enabled = True
120                 cb.Value = False
130             Else
140                 If OptionButton1.Value = True Or OptionButton2.Value = True Or OptionButton3.Value = True _
                       Or OptionButton4.Value = True Or OptionButton7.Value = True Then
150                     cb.Enabled = False
160                     cb.Value = False
170                 End If
180             End If
190         End If
200         If cb.GroupName = "Zavezanost_preiskavi_lp" Then
210             If ActiveSheet.Range("kap_pog_preiskavi").Value = 1 Then
                    'ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
220                 cb.Enabled = True
230                 cb.Value = False
240             End If
250         End If
260     End If
270 Next objole
280 If OptionButton19.Value = True Then
        'application.enableevents = False
290     Worksheets("opredelitev").Range("c62").Select
300     Worksheets("opredelitev").Unprotect Password:="nuladva"
        'ActiveSheet.Range("kap_javna_objava").ClearContents
        'ActiveSheet.Range("kap_posl_tujina").ClearContents
310     ActiveSheet.Range("kap_zavezanost").Value = 1
320     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
330 End If

340 On Error GoTo 0
350 Exit Sub

OptionButton19_Click_Error:

360 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton19_Click v VBA Document List10"
End Sub

Private Sub OptionButton2_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton2_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Poslovno_leto" Or cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Subjekt_jav_interes" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton2.Value = True Then
        '  Application.EnableEvents = False
        '  Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c17").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_jav_interes").ClearContents
200     ActiveSheet.Range("kap_poslovno_leto").ClearContents
210     ActiveSheet.Range("kap_velikost").ClearContents
220     ActiveSheet.Range("kap_rac_post").ClearContents
230     ActiveSheet.Range("kap_inv_holding").ClearContents
240     ActiveSheet.Range("kap_poj_razkritja").ClearContents
250     ActiveSheet.Range("kap_opredelitev").ClearContents
260     ActiveSheet.Range("kap_zavezanost").ClearContents
270     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
280     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
290     ActiveSheet.Range("kap_vrsta_podr").ClearContents
300     ActiveSheet.Range("kap_javna_objava").ClearContents
310     ActiveSheet.Range("kap_posl_tujina").ClearContents
320     ActiveSheet.Range("kap_vrsta").Value = 2
330     Worksheets("opredelitev").Protect Password:="nuladva"
        '  Application.EnableEvents = True
        '  Application.Calculation = xlCalculationAutomatic
340 End If

350 On Error GoTo 0
360 Exit Sub

OptionButton2_Click_Error:

370 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton2_Click v VBA Document List10"
End Sub

Private Sub OptionButton20_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton20_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "javna_objava" Then
60              cb.Enabled = False
70              cb.Value = False
80          End If
90          If cb.GroupName = "Vrsta_podruznice" Then
100             If OptionButton6.Value = True Then
110                 cb.Enabled = True
120                 cb.Value = False
130             Else
140                 If OptionButton1.Value = True Or OptionButton2.Value = True Or OptionButton3.Value = True _
                       Or OptionButton4.Value = True Or OptionButton7.Value = True Then
150                     cb.Enabled = False
160                     cb.Value = False
170                 End If
180             End If
190             If cb.GroupName = "Zavezanost_preiskavi_lp" Then
200                 If ActiveSheet.Range("kap_pog_preiskavi").Value = 1 Then
                        'ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
210                     cb.Enabled = True
220                     cb.Value = False
230                 End If
240             End If
250         End If
260     End If
270 Next objole
280 If OptionButton20.Value = True Then
        'application.enableevents = False
290     Worksheets("opredelitev").Range("c63").Select
300     Worksheets("opredelitev").Unprotect Password:="nuladva"
        'ActiveSheet.Range("kap_javna_objava").ClearContents
        'ActiveSheet.Range("kap_posl_tujina").ClearContents
310     ActiveSheet.Range("kap_zavezanost").Value = 2
320     Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
330 End If

340 On Error GoTo 0
350 Exit Sub

OptionButton20_Click_Error:

360 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton20_Click v VBA Document List10"
End Sub

Private Sub OptionButton21_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

    On Error GoTo OptionButton21_Click_Error

    For Each objole In ActiveSheet.OLEObjects
        If TypeOf objole.Object Is MSForms.OptionButton Then
            Set cb = objole.Object
            If cb.GroupName = "javna_objava" Then
                cb.Enabled = False
                cb.Value = False
            End If
            If cb.GroupName = "Vrsta_podruznice" Then
                If OptionButton6.Value = True Then
                    cb.Enabled = True
                    cb.Value = False
                Else
                    If OptionButton1.Value = True Or OptionButton2.Value = True Or OptionButton3.Value = True _
                       Or OptionButton4.Value = True Or OptionButton7.Value = True Then
                        cb.Enabled = False
                        cb.Value = False
                    End If
                End If
            End If
            If cb.GroupName = "Zavezanost_preiskavi_lp" Then
                If ActiveSheet.Range("kap_pog_preiskavi").Value = 1 Then
                    Worksheets("opredelitev").Unprotect Password:="nuladva"
                    ActiveSheet.Range("Kap_preisk_rac_izkazov").ClearContents
                    cb.Enabled = False
                    cb.Value = False
                    Worksheets("opredelitev").Protect Password:="nuladva"
                End If
            End If
        End If
    Next objole
    If OptionButton21.Value = True Then
        'application.enableevents = False
        Worksheets("opredelitev").Range("c64").Select
        Worksheets("opredelitev").Unprotect Password:="nuladva"
        'ActiveSheet.Range("kap_javna_objava").ClearContents
        'ActiveSheet.Range("kap_posl_tujina").ClearContents
        ActiveSheet.Range("kap_zavezanost").Value = 3
        Worksheets("opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
    End If

    On Error GoTo 0
    Exit Sub

OptionButton21_Click_Error:

    MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton21_Click v VBA Document List10"
End Sub

Private Sub OptionButton22_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, ws As Worksheet

10  On Error GoTo OptionButton22_Click_Error
20  Set ws = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If OptionButton6.Value = True Then
70              If cb.GroupName = "javna_objava" Then
80                  cb.Enabled = True
90                  cb.Value = False
100             End If
110         End If
120         If Left(cb.GroupName, 10) = "poslovanje" Then
130             If Not ws.Range("kap_vrsta").Value = 3 Then
140                 cb.Enabled = True
150                 cb.Value = False
160             End If
170         End If
180     End If
190 Next objole
200 If OptionButton22.Value = True Then
        'application.enableevents = False
210     Worksheets("opredelitev").Range("c73").Select
220     Worksheets("Opredelitev").Unprotect Password:="nuladva"
230     ActiveSheet.Range("kap_vrsta_podr").Value = 1
240     ActiveSheet.Range("neizbrana_podr_sifra_dr").ClearContents
250     ActiveSheet.Range("Neizbrana_podr_ime_podj").Value = ""
260     ActiveSheet.Range("kap_javna_objava").ClearContents
270     Worksheets("Opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
280 End If

290 On Error GoTo 0
300 Exit Sub

OptionButton22_Click_Error:

310 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton22_Click v VBA Document List10"
End Sub

Private Sub OptionButton23_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, ws As Worksheet

10  On Error GoTo OptionButton23_Click_Error

20  Set ws = Worksheets("opredelitev")
30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If OptionButton6.Value = True Then
70              If cb.GroupName = "javna_objava" Then
80                  cb.Enabled = True
90                  cb.Value = False
100             End If
110         End If
120         If Left(cb.GroupName, 10) = "poslovanje" Then
130             If Not ws.Range("kap_vrsta").Value = 3 Then
140                 cb.Enabled = True
150                 cb.Value = False
160             End If
170         End If
180     End If
190 Next objole
200 If OptionButton23.Value = True Then
        'application.enableevents = False
210     Worksheets("opredelitev").Range("c76").Select
220     Worksheets("Opredelitev").Unprotect Password:="nuladva"
230     ActiveSheet.Range("kap_vrsta_podr").Value = 2
240     ActiveSheet.Range("Izbrana_podr_ime_podj").Value = ""
250     ActiveSheet.Range("izbrana_podr_sifra_dr").ClearContents
260     ActiveSheet.Range("kap_javna_objava").ClearContents
270     Worksheets("Opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
280 End If


290 On Error GoTo 0
300 Exit Sub

OptionButton23_Click_Error:

310 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton23_Click v VBA Document List10"

End Sub

Private Sub OptionButton24_Click()
10  On Error GoTo OptionButton24_Click_Error

20  If OptionButton24.Value = True Then
        'application.enableevents = False
30      Worksheets("opredelitev").Range("c81").Select
40      Worksheets("Opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_javna_objava").Value = 1
60      Worksheets("Opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
70  End If
80  MsgBox ("Za namen dr|fffd|avne statistike mora vsaka podru|fffd|nica, ne glede nato " & vbCrLf _
          & "ali je izbrana ali ne, predlo|fffd|iti Podatke iz bilance stanja, Podatke iz" & vbCrLf _
          & "izkaza poslovnega izida, Podatke iz izkaza bilan|fffd|nega dobi|fffd|ka/bilan|fffd|ne " & vbCrLf _
          & "izgube, Dodatne podatke k podatkom iz bilance stanja in Dodatne podatke" & vbCrLf _
          & "k podatkom iz izkaza poslovnega izida.")

90  On Error GoTo 0
100 Exit Sub

OptionButton24_Click_Error:

110 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton24_Click v VBA Document List10"

End Sub

Private Sub OptionButton25_Click()
10  On Error GoTo OptionButton25_Click_Error

20  If OptionButton25.Value = True Then
        'application.enableevents = False
30      Worksheets("opredelitev").Range("c82").Select
40      Worksheets("Opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_javna_objava").Value = 2
60      Worksheets("Opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
70  End If
80  MsgBox ("Za namen dr|fffd|avne statistike mora vsaka podru|fffd|nica, ne glede nato " & vbCrLf _
          & "ali je izbrana ali ne, predlo|fffd|iti Podatke iz bilance stanja, Podatke iz" & vbCrLf _
          & "izkaza poslovnega izida, Podatke iz izkaza bilan|fffd|nega dobi|fffd|ka/bilan|fffd|ne " & vbCrLf _
          & "izgube, Dodatne podatke k podatkom iz bilance stanja in Dodatne podatke" & vbCrLf _
          & "k podatkom iz izkaza poslovnega izida.")
90  MsgBox ("V kolikor ste po velikosti majhna podru|fffd|nica, lahko uporabite poenostavitev," & vbCrLf _
          & "tako da ob predlo|fffd|itvi pojasnil k izkazom in izjave, podatke iz poenotenih obrazcev" & vbCrLf _
          & "predlo|fffd|ite za javno objavo in dr|fffd|avno statistiko hkrati.V kolikor poenostavitve ne" & vbCrLf _
          & "uporabite ali pa je ne morete uporabiti (va|fffd|e poslovno leto je razli|fffd|no od koledarskega " & vbCrLf _
          & "ali pa ste po velikosti srednja ali velika podru|fffd|nica) lahko letno poro|fffd|ilo za namen" & vbCrLf _
          & "javne objave predlo|fffd|ite AJPES v osmih mesecih po koncu poslovnega leta.")

100 On Error GoTo 0
110 Exit Sub

OptionButton25_Click_Error:

120 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton25_Click v VBA Document List10"

End Sub

Private Sub OptionButton26_Click()
10  On Error GoTo OptionButton26_Click_Error

20  If OptionButton26.Value = True Then
        'application.enableevents = False
30      Worksheets("opredelitev").Range("c83").Select
40      Worksheets("Opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_javna_objava").Value = 3
60      Worksheets("Opredelitev").Protect Password:="nuladva"
        'application.enableevents = True
70  End If
80  MsgBox ("Za namen dr|fffd|avne statistike mora vsaka podru|fffd|nica, ne glede nato " & vbCrLf _
          & "ali je izbrana ali ne, predlo|fffd|iti Podatke iz bilance stanja, Podatke iz" & vbCrLf _
          & "izkaza poslovnega izida, Podatke iz izkaza bilan|fffd|nega dobi|fffd|ka/bilan|fffd|ne " & vbCrLf _
          & "izgube, Dodatne podatke k podatkom iz bilance stanja in Dodatne podatke" & vbCrLf _
          & "k podatkom iz izkaza poslovnega izida.")

90  On Error GoTo 0
100 Exit Sub

OptionButton26_Click_Error:

110 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton26_Click v VBA Document List10"

End Sub

Private Sub OptionButton27_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton27_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Poslovno_leto" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton27.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c23").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_poslovno_leto").ClearContents
200     ActiveSheet.Range("kap_velikost").ClearContents
210     ActiveSheet.Range("kap_rac_post").ClearContents
220     ActiveSheet.Range("kap_inv_holding").ClearContents
230     ActiveSheet.Range("kap_poj_razkritja").ClearContents
240     ActiveSheet.Range("kap_opredelitev").ClearContents
250     ActiveSheet.Range("kap_zavezanost").ClearContents
260     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
270     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
280     ActiveSheet.Range("kap_vrsta_podr").ClearContents
290     ActiveSheet.Range("kap_javna_objava").ClearContents
300     ActiveSheet.Range("kap_posl_tujina").ClearContents
310     ActiveSheet.Range("kap_jav_interes").Value = 1    ' subjekt javnega interesa da
320     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
330 End If

340 On Error GoTo 0
350 Exit Sub

OptionButton27_Click_Error:

360 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton27_Click v VBA Document List10"
End Sub

Private Sub OptionButton28_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton28_Click_Error


20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Poslovno_leto" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton28.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c24").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_poslovno_leto").ClearContents
200     ActiveSheet.Range("kap_velikost").ClearContents
210     ActiveSheet.Range("kap_rac_post").ClearContents
220     ActiveSheet.Range("kap_inv_holding").ClearContents
230     ActiveSheet.Range("kap_poj_razkritja").ClearContents
240     ActiveSheet.Range("kap_opredelitev").ClearContents
250     ActiveSheet.Range("kap_zavezanost").ClearContents
260     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
270     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
280     ActiveSheet.Range("kap_vrsta_podr").ClearContents
290     ActiveSheet.Range("kap_javna_objava").ClearContents
300     ActiveSheet.Range("kap_posl_tujina").ClearContents
310     ActiveSheet.Range("kap_jav_interes").Value = 2    ' subjekt javnega interesa ne
320     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
330 End If

340 On Error GoTo 0
350 Exit Sub

OptionButton28_Click_Error:

360 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton28_Click v VBA Document List10"
End Sub

Private Sub OptionButton29_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton29_Click_Error

20  If OptionButton29.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
30      Worksheets("opredelitev").Range("c35").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_poj_razkritja").ClearContents
60      ActiveSheet.Range("kap_rac_post").Value = 1    ' izvirne vrednosti
70      Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton29_Click_Error:

110 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton29_Click v VBA Document List10"
End Sub

Private Sub OptionButton3_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton3_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Poslovno_leto" Or cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Subjekt_jav_interes" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton3.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c18").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_jav_interes").ClearContents
200     ActiveSheet.Range("kap_poslovno_leto").ClearContents
210     ActiveSheet.Range("kap_velikost").ClearContents
220     ActiveSheet.Range("kap_rac_post").ClearContents
230     ActiveSheet.Range("kap_inv_holding").ClearContents
240     ActiveSheet.Range("kap_poj_razkritja").ClearContents
250     ActiveSheet.Range("kap_opredelitev").ClearContents
260     ActiveSheet.Range("kap_zavezanost").ClearContents
270     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
280     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
290     ActiveSheet.Range("kap_vrsta_podr").ClearContents
300     ActiveSheet.Range("kap_javna_objava").ClearContents
310     ActiveSheet.Range("kap_posl_tujina").ClearContents
320     ActiveSheet.Range("kap_vrsta").Value = 3
330     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
340 End If
350 On Error GoTo 0
360 Exit Sub

OptionButton3_Click_Error:

370 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton3_Click v VBA Document List10"
End Sub

Private Sub OptionButton30_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton30_Click_Error

20  If OptionButton30.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
30      Worksheets("opredelitev").Range("c36").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_poj_razkritja").ClearContents
60      ActiveSheet.Range("kap_rac_post").Value = 2    ' postene vrednosti
70      Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton30_Click_Error:

110 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton30_Click v VBA Document List10"
End Sub

Private Sub OptionButton31_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton31_Click_Error

20  If OptionButton31.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
30      Worksheets("opredelitev").Range("c38").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_poj_razkritja").ClearContents
60      ActiveSheet.Range("kap_inv_holding").Value = 1    ' financno podjetje ali holding
70      Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton31_Click_Error:

110 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton31_Click v VBA Document List10"
End Sub

Private Sub OptionButton32_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton32_Click_Error

20  If OptionButton32.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
30      Worksheets("opredelitev").Range("c39").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_poj_razkritja").ClearContents
60      ActiveSheet.Range("kap_inv_holding").Value = 2    ' ni financno podjetje ali holding
70      Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton32_Click_Error:

110 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton32_Click v VBA Document List10"
End Sub

Private Sub OptionButton33_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton33_Click_Error

20  If OptionButton33.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
30      Worksheets("opredelitev").Range("c41").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_poj_razkritja").Value = 1    ' POJ
60      Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
70  End If

80  On Error GoTo 0
90  Exit Sub

OptionButton33_Click_Error:

100 MsgBox "napaka " & Err.Number & " (" & Err.Description & ") v proceduri OptionButton33_Click v VBA Document List10"
End Sub

Private Sub OptionButton34_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton34_Click_Error

20  If OptionButton34.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
30      Worksheets("opredelitev").Range("c42").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("kap_poj_razkritja").Value = 2    ' razkritja
60      Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
70  End If

80  On Error GoTo 0
90  Exit Sub

OptionButton34_Click_Error:

100 MsgBox "Napaka " & Err.Number & " (" & Err.Description & ") v proceduri OptionButton34_Click v VBA Document List10"
End Sub

Private Sub OptionButton35_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton35_Click_Error

20  If OptionButton35.Value = True Then
30      Worksheets("opredelitev").Range("c66").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("Kap_preisk_rac_izkazov").Value = 1
60      Worksheets("opredelitev").Protect Password:="nuladva"
70  End If


80  On Error GoTo 0
90  Exit Sub

OptionButton35_Click_Error:

100 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton35_Click of VBA Document List10"

End Sub

Private Sub OptionButton36_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton36_Click_Error

20  If OptionButton36.Value = True Then
30      Worksheets("opredelitev").Range("c67").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("Kap_preisk_rac_izkazov").Value = 2
60      Worksheets("opredelitev").Protect Password:="nuladva"
70  End If

80  On Error GoTo 0
90  Exit Sub

OptionButton36_Click_Error:

100 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton36_Click of VBA Document List10"
End Sub

Private Sub OptionButton37_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton37_Click_Error

20  If OptionButton37.Value = True Then
30      Worksheets("opredelitev").Range("c69").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("Kap_por_plac_vladam").Value = 1
60      Worksheets("opredelitev").Protect Password:="nuladva"
70  End If

80  On Error GoTo 0
90  Exit Sub

OptionButton37_Click_Error:

100 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton37_Click of VBA Document List10"
End Sub

Private Sub OptionButton38_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
10  On Error GoTo OptionButton38_Click_Error

20  If OptionButton38.Value = True Then
30      Worksheets("opredelitev").Range("c70").Select
40      Worksheets("opredelitev").Unprotect Password:="nuladva"
50      ActiveSheet.Range("Kap_por_plac_vladam").Value = 2
60      Worksheets("opredelitev").Protect Password:="nuladva"
70  End If

80  On Error GoTo 0
90  Exit Sub

OptionButton38_Click_Error:

100 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton38_Click of VBA Document List10"
End Sub

Private Sub OptionButton39_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton39_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton39.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_a").Value = 0
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton39_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton39_Click of VBA Document List10"
End Sub

Private Sub OptionButton4_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton4_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Poslovno_leto" Or cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Subjekt_jav_interes" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton4.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c19").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_jav_interes").ClearContents
200     ActiveSheet.Range("kap_poslovno_leto").ClearContents
210     ActiveSheet.Range("kap_velikost").ClearContents
220     ActiveSheet.Range("kap_rac_post").ClearContents
230     ActiveSheet.Range("kap_inv_holding").ClearContents
240     ActiveSheet.Range("kap_poj_razkritja").ClearContents
250     ActiveSheet.Range("kap_opredelitev").ClearContents
260     ActiveSheet.Range("kap_zavezanost").ClearContents
270     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
280     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
290     ActiveSheet.Range("kap_vrsta_podr").ClearContents
300     ActiveSheet.Range("kap_javna_objava").ClearContents
310     ActiveSheet.Range("kap_posl_tujina").ClearContents
320     ActiveSheet.Range("kap_vrsta").Value = 4
330     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
340 End If

350 On Error GoTo 0
360 Exit Sub

OptionButton4_Click_Error:

370 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton4_Click v VBA Document List10"
End Sub

'Private Sub OptionButton5_Click()
'    Dim objole As Excel.OLEObject
'    Dim CB As MSForms.OptionButton
'    Dim velikost As Range
'    Dim sht As Worksheet
'10  On Error GoTo OptionButton5_Click_Error
'
'20  Set sht = Worksheets("Status_vnosa")
'30  Set velikost = sht.Range("b43")
'40  For Each objole In ActiveSheet.OLEObjects
'50      If TypeOf objole.Object Is MSForms.OptionButton Then
'60          Set CB = objole.Object
'
'70          If CB.GroupName = "Velikost" Or CB.GroupName = "Povezanost" _
 '               Or CB.GroupName = "Zavezanost_reviziji" Or CB.GroupName = "Vrsta_podruznice" _
 '               Or CB.GroupName = "javna_objava" Then
'
'80              CB.Enabled = False
'90              CB.Value = False
'100         Else
'110             If CB.GroupName = "Poslovno_leto" Then
'120                 CB.Value = False
'130                 CB.Enabled = True
'140             End If
'
'150         End If
'
'160     End If
'
'
'
'170 Next objole
'180 If OptionButton5.Value = True Then
'        'application.enableevents = False
'190     Worksheets("opredelitev").Range("c20").Select
'200     Worksheets("opredelitev").Unprotect Password:="nuladva"
'210     ActiveSheet.Range("kap_poslovno_leto").ClearContents
'220     ActiveSheet.Range("kap_velikost").ClearContents
'230     ActiveSheet.Range("kap_opredelitev").ClearContents
'240     ActiveSheet.Range("kap_zavezanost").ClearContents
'250     ActiveSheet.Range("kap_vrsta_podr").ClearContents
'260     ActiveSheet.Range("kap_javna_objava").ClearContents
'270     ActiveSheet.Range("kap_vrsta").Value = 5
'280     Worksheets("opredelitev").Protect Password:="nuladva"
'        'application.enableevents = True
'290 End If
'300 If velikost.Value = 1 Then
'310     MsgBox ("Aplikacija, v katero vna|fffd|ate podatke ni" & vbCrLf _
 '                & "namenjena mikro samostojnim podjetnikom.")
'320 End If
'330 If velikost.Value = 2 Then
'340     MsgBox ("Aplikacija, v katero vna|fffd|ate podatke ni" & vbCrLf _
 '                & "namenjena majhnim samostojnim podjetnikom.")
'350 End If
'360 On Error GoTo 0
'370 Exit Sub
'
'OptionButton5_Click_Error:
'
'380 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton5_Click v VBA Document List10"
'
'End Sub



Private Sub OptionButton40_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton40_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton40.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_b").Value = 0
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton40_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton40_Click of VBA Document List10"

End Sub

Private Sub OptionButton41_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton41_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton41.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_c").Value = 0
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton41_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton41_Click of VBA Document List10"

End Sub

Private Sub OptionButton42_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton42_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton42.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_d").Value = 0
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton42_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton42_Click of VBA Document List10"

End Sub

Private Sub OptionButton43_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton43_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton43.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_e").Value = 0
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton43_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton43_Click of VBA Document List10"

End Sub

Private Sub OptionButton44_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton44_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton44.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_a").Value = 1
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton44_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton44_Click of VBA Document List10"

End Sub

Private Sub OptionButton45_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton45_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton45.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_b").Value = 1
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton45_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton45_Click of VBA Document List10"
End Sub

Private Sub OptionButton46_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton46_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton46.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_c").Value = 1
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton46_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton46_Click of VBA Document List10"
End Sub

Private Sub OptionButton47_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton47_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton47.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_d").Value = 1
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton47_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton47_Click of VBA Document List10"
End Sub

Private Sub OptionButton48_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  On Error GoTo OptionButton48_Click_Error

20  Set sht = Worksheets("xml")
30  If OptionButton48.Value = True Then
40      Worksheets("opredelitev").Range("c86").Select
50      Worksheets("xml").Unprotect Password:="nuladva"
60      sht.Range("OPR_poslovanje_tujina_e").Value = 1
70      Worksheets("xml").Protect Password:="nuladva"
80  End If

90  On Error GoTo 0
100 Exit Sub

OptionButton48_Click_Error:

110 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure OptionButton48_Click of VBA Document List10"
End Sub

Private Sub OptionButton6_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton6_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Poslovno_leto" Or cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Subjekt_jav_interes" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton6.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c20").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_jav_interes").ClearContents
200     ActiveSheet.Range("kap_poslovno_leto").ClearContents
210     ActiveSheet.Range("kap_velikost").ClearContents
220     ActiveSheet.Range("kap_rac_post").ClearContents
230     ActiveSheet.Range("kap_inv_holding").ClearContents
240     ActiveSheet.Range("kap_poj_razkritja").ClearContents
250     ActiveSheet.Range("kap_opredelitev").ClearContents
260     ActiveSheet.Range("kap_zavezanost").ClearContents
270     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
280     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
290     ActiveSheet.Range("kap_vrsta_podr").ClearContents
300     ActiveSheet.Range("kap_javna_objava").ClearContents
310     ActiveSheet.Range("kap_posl_tujina").ClearContents
320     ActiveSheet.Range("kap_vrsta").Value = 6
330     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
340 End If

350 On Error GoTo 0
360 Exit Sub

OptionButton6_Click_Error:

370 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton6_Click v VBA Document List10"
End Sub

Private Sub OptionButton7_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton

10  On Error GoTo OptionButton7_Click_Error

20  For Each objole In ActiveSheet.OLEObjects
30      If TypeOf objole.Object Is MSForms.OptionButton Then
40          Set cb = objole.Object
50          If cb.GroupName = "Poslovno_leto" Or cb.GroupName = "Velikost" Or cb.GroupName = "Velikost_velika" Or cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
60              cb.Enabled = False
70              cb.Value = False
80          Else
90              If cb.GroupName = "Subjekt_jav_interes" Then
100                 cb.Value = False
110                 cb.Enabled = True
120             End If
130         End If
140     End If
150 Next objole
160 If OptionButton7.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
170     Worksheets("opredelitev").Range("c21").Select
180     Worksheets("opredelitev").Unprotect Password:="nuladva"
190     ActiveSheet.Range("kap_jav_interes").ClearContents
200     ActiveSheet.Range("kap_poslovno_leto").ClearContents
210     ActiveSheet.Range("kap_velikost").ClearContents
220     ActiveSheet.Range("kap_rac_post").ClearContents
230     ActiveSheet.Range("kap_inv_holding").ClearContents
240     ActiveSheet.Range("kap_poj_razkritja").ClearContents
250     ActiveSheet.Range("kap_opredelitev").ClearContents
260     ActiveSheet.Range("kap_zavezanost").ClearContents
270     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
280     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
290     ActiveSheet.Range("kap_vrsta_podr").ClearContents
300     ActiveSheet.Range("kap_javna_objava").ClearContents
310     ActiveSheet.Range("kap_posl_tujina").ClearContents
320     ActiveSheet.Range("kap_vrsta").Value = 7
330     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
340 End If

350 On Error GoTo 0
360 Exit Sub

OptionButton7_Click_Error:

370 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton7_Click v VBA Document List10"
End Sub

Private Sub OptionButton12_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
    Dim sht As Worksheet, sht1 As Worksheet, velikost As Range, velikost_opr As Range, obr_velikost As Range, velikost_tekoce As Range, velikost_preteklo As Range, obravn_vel_pret As Range
10  On Error GoTo OptionButton12_Click_Error

20  Set sht = Worksheets("Status_vnosa")
30  Set sht1 = Worksheets("opredelitev")
40  Set velikost = sht.Range("b90")
50  Set velikost_opr = Range("kap_velikost")
60  Set obr_velikost = sht.Range("a141")    ' obravnavana velikost
70  Set velikost_tekoce = sht.Range("b85")    ' izracuna velikost tekoce leto
80  Set velikost_preteklo = sht.Range("d85")    ' izracunana velikost preteklo leto
90  Set obravn_vel_pret = sht.Range("f85")    ' obravnavana velikost preteklo
100 For Each objole In ActiveSheet.OLEObjects
110     If TypeOf objole.Object Is MSForms.OptionButton Then
120         Set cb = objole.Object
130         If cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_place" _
               Or cb.GroupName = "javna_objava" Then
140             cb.Enabled = False
150             cb.Value = False
160         End If
170         If cb.GroupName = "Povezanost" Then
180             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
190                 cb.Enabled = True
200                 cb.Value = False
210             Else
220                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
230                     cb.Enabled = False
240                     cb.Value = False
250                 End If
260             End If
270         End If
280         If OptionButton6.Value = True Then
290             If cb.GroupName = "Vrsta_podruznice" Then
300                 cb.Enabled = True
310                 cb.Value = False
320             End If

330         End If
340         If Left(cb.GroupName, 10) = "poslovanje" Then
350             If sht1.Range("kap_vrsta") = 3 Then
360                 cb.Enabled = False
370                 cb.Value = False
380             Else
390                 cb.Enabled = True
400                 cb.Value = False
410             End If
420         End If
430         If cb.GroupName = "Velikost_velika" Then
440             cb.Value = False
450         End If
460     End If
470 Next objole
480 If OptionButton12.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
490     Worksheets("opredelitev").Range("c44").Select
500     Worksheets("opredelitev").Unprotect Password:="nuladva"
510     ActiveSheet.Range("kap_rac_post").ClearContents
520     ActiveSheet.Range("kap_inv_holding").ClearContents
530     ActiveSheet.Range("kap_poj_razkritja").ClearContents
540     ActiveSheet.Range("kap_opredelitev").ClearContents
550     ActiveSheet.Range("kap_zavezanost").ClearContents
560     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
570     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
580     ActiveSheet.Range("kap_vrsta_podr").ClearContents
590     ActiveSheet.Range("kap_javna_objava").ClearContents
600     ActiveSheet.Range("kap_posl_tujina").ClearContents
610     ActiveSheet.Range("kap_velikost").Value = 3
620     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
630 End If
640 If velikost.Value <> velikost_opr.Value Then
650     MsgBox ("Izra|fffd|unana velikost za teko|fffd|e leto je " & velikost_tekoce.Value & ", " _
              & "izra|fffd|unana velikost za preteklo leto " & "je " & velikost_preteklo.Value & "," & " obravnavana velikost " _
              & "iz predhodnega letnega poro|fffd|ila je " & obravn_vel_pret.Value & ", " _
              & "zato je obravnavana velikost " & obr_velikost.Value & "." & "Ponovno preverite bilan|fffd|ne podatke za teko|fffd|e " _
              & "in preteklo leto in obravnavano velikost iz predhodnega letnega poro|fffd|ila oz. popravite velikost, " _
              & "za katero ste se opredelili.")
660 End If

670 On Error GoTo 0
680 Exit Sub

OptionButton12_Click_Error:

690 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton12_Click v VBA Document List10"
End Sub

Private Sub OptionButton11_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton
    Dim sht As Worksheet, sht1 As Worksheet, velikost As Range, velikost_opr As Range, obr_velikost As Range, velikost_tekoce As Range, velikost_preteklo As Range, obravn_vel_pret As Range
10  On Error GoTo OptionButton11_Click_Error

20  Set sht = Worksheets("Status_vnosa")
30  Set sht1 = Worksheets("opredelitev")
40  Set velikost = sht.Range("b90")
50  Set velikost_opr = Range("kap_velikost")
60  Set obr_velikost = sht.Range("a141")    ' obravnavana velikost
70  Set velikost_tekoce = sht.Range("b85")    ' izracuna velikost tekoce leto
80  Set velikost_preteklo = sht.Range("d85")    ' izracunana velikost preteklo leto
90  Set obravn_vel_pret = sht.Range("f85")    ' obravnavana velikost preteklo
100 For Each objole In ActiveSheet.OLEObjects
110     If TypeOf objole.Object Is MSForms.OptionButton Then
120         Set cb = objole.Object
130         If cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_place" _
               Or cb.GroupName = "javna_objava" Then
140             cb.Enabled = False
150             cb.Value = False
160         End If
170         If cb.GroupName = "Povezanost" Then
180             If OptionButton1.Value = True Or OptionButton3.Value = True Or OptionButton4.Value = True _
                   Or OptionButton7.Value = True Then
190                 cb.Enabled = True
200                 cb.Value = False
210             Else
220                 If OptionButton2.Value = True Or OptionButton6.Value = True Then
230                     cb.Enabled = False
240                     cb.Value = False
250                 End If
260             End If
270         End If
280         If OptionButton6.Value = True Then
290             If cb.GroupName = "Vrsta_podruznice" Then
300                 cb.Enabled = True
310                 cb.Value = False
320             End If
330         End If
340         If Left(cb.GroupName, 10) = "poslovanje" Then
350             If sht1.Range("kap_vrsta") = 3 Then
360                 cb.Enabled = False
370                 cb.Value = False
380             Else
390                 cb.Enabled = True
400                 cb.Value = False
410             End If
420         End If
430         If cb.GroupName = "Velikost_velika" Then
440             cb.Value = False
450         End If
460     End If
470 Next objole
480 If OptionButton11.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
490     Worksheets("opredelitev").Range("c43").Select
500     Worksheets("opredelitev").Unprotect Password:="nuladva"
510     ActiveSheet.Range("kap_rac_post").ClearContents
520     ActiveSheet.Range("kap_inv_holding").ClearContents
530     ActiveSheet.Range("kap_poj_razkritja").ClearContents
540     ActiveSheet.Range("kap_opredelitev").ClearContents
550     ActiveSheet.Range("kap_zavezanost").ClearContents
560     ActiveSheet.Range("kap_preisk_rac_izkazov").ClearContents
570     ActiveSheet.Range("kap_por_plac_vladam").ClearContents
580     ActiveSheet.Range("kap_vrsta_podr").ClearContents
590     ActiveSheet.Range("kap_javna_objava").ClearContents
600     ActiveSheet.Range("kap_posl_tujina").ClearContents
610     ActiveSheet.Range("kap_velikost").Value = 2
620     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
630 End If
640 If velikost.Value <> velikost_opr.Value Then
650     MsgBox ("Izra|fffd|unana velikost za teko|fffd|e leto je " & velikost_tekoce.Value & ", " _
              & "izra|fffd|unana velikost za preteklo leto " & "je " & velikost_preteklo.Value & "," & " obravnavana velikost " _
              & "iz predhodnega letnega poro|fffd|ila je " & obravn_vel_pret.Value & ", " _
              & "zato je obravnavana velikost " & obr_velikost.Value & "." & "Ponovno preverite bilan|fffd|ne podatke za teko|fffd|e " _
              & "in preteklo leto in obravnavano velikost iz predhodnega letnega poro|fffd|ila oz. popravite velikost, " _
              & "za katero ste se opredelili.")
660 End If


670 On Error GoTo 0
680 Exit Sub

OptionButton11_Click_Error:

690 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton11_Click v VBA Document List10"
End Sub

Private Sub OptionButton8_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  Set sht = Worksheets("Opredelitev")
20  On Error GoTo OptionButton8_Click_Error

30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
70              cb.Enabled = False
80              cb.Value = False
90          ElseIf cb.GroupName = "Velikost" Then
100             If sht.Range("kap_jav_interes").Value = 1 Then
110                 cb.Value = False
120                 cb.Enabled = False
130             Else
140                 cb.Value = False
150                 cb.Enabled = True
160             End If
170         Else
180             If cb.GroupName = "Velikost_velika" Then
190                 cb.Value = False
200                 cb.Enabled = True
210             End If
220         End If
230     End If
240 Next objole
250 If OptionButton8.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
260     Worksheets("opredelitev").Range("c27").Select
270     Worksheets("opredelitev").Unprotect Password:="nuladva"
280     ActiveSheet.Range("kap_zacetek").ClearContents
290     ActiveSheet.Range("kap_konec").ClearContents
300     ActiveSheet.Range("kap_poslovno_leto").Value = 1    ' poslovno enako koledarskemu
310     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
320 End If
330 On Error GoTo 0
340 Exit Sub

OptionButton8_Click_Error:

350 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton8_Click v VBA Document List10"
End Sub


Private Sub OptionButton9_Click()
    Dim objole As Excel.OLEObject
    Dim cb As MSForms.OptionButton, sht As Worksheet
10  Set sht = Worksheets("Opredelitev")
20  On Error GoTo OptionButton9_Click_Error

30  For Each objole In ActiveSheet.OLEObjects
40      If TypeOf objole.Object Is MSForms.OptionButton Then
50          Set cb = objole.Object
60          If cb.GroupName = "Vred_rac_post" Or cb.GroupName = "Inv_or_holding" _
               Or cb.GroupName = "Poj_or_razkritja" Or cb.GroupName = "Povezanost" _
               Or cb.GroupName = "Zavezanost_reviziji" Or cb.GroupName = "Zavezanost_preiskavi_lp" Or cb.GroupName = "Zavezanost_por_plac" _
               Or cb.GroupName = "Vrsta_podruznice" Or cb.GroupName = "javna_objava" Or Left(cb.GroupName, 10) = "poslovanje" Then
70              cb.Enabled = False
80              cb.Value = False
90          ElseIf cb.GroupName = "Velikost" Then
100             If sht.Range("kap_jav_interes").Value = 1 Then
110                 cb.Value = False
120                 cb.Enabled = False
130             Else
140                 cb.Value = False
150                 cb.Enabled = True
160             End If
170         Else
180             If cb.GroupName = "Velikost_velika" Then
190                 cb.Value = False
200                 cb.Enabled = True
210             End If
220         End If
230     End If
240 Next objole
250 If OptionButton9.Value = True Then
        '        Application.EnableEvents = False
        '        Application.Calculation = xlCalculationManual
260     Worksheets("opredelitev").Range("c28").Select
270     Worksheets("opredelitev").Unprotect Password:="nuladva"
280     ActiveSheet.Range("kap_poslovno_leto").Value = 2    ' poslovno  ni enako koledarskemu
290     Worksheets("opredelitev").Protect Password:="nuladva"
        '        Application.EnableEvents = True
        '        Application.Calculation = xlCalculationAutomatic
300 End If

310 On Error GoTo 0
320 Exit Sub

OptionButton9_Click_Error:

330 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri OptionButton9_Click v VBA Document List10"
End Sub





Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim sht As Worksheet, sht1 As Worksheet
    Dim a As String
    Dim cell As Range, vrange As Range, cell1 As Range, obmocje As Range, cell2 As Range, obmocje1 As Range
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("mat_nadpod_zavezane")
30  Set obmocje = Range("Mat_nadpod_nezavezane")
40  Set obmocje1 = Range("mat_nadrejene")
50  Set sht = Worksheets("Opredelitev")
60  Set sht1 = Worksheets("Izjava")
70  a = sht1.Range("a102").Value
80  Application.ScreenUpdating = False
90  If Left(a, 15) = "Izjava ni mo|fffd|na" Then
100     sht1.Unprotect Password:="nuladva"
110     sht1.Range("Izjava_opredelitev").Locked = True
120     Application.EnableEvents = False
130     sht1.Range("Izjava_opredelitev").Value = "NE"
140     Application.EnableEvents = True
150     sht1.Protect Password:="nuladva"
160 End If
170 If a = "Izjava je mo|fffd|na" Then
180     sht1.Unprotect Password:="nuladva"
190     sht1.Range("Izjava_opredelitev").Locked = False
200     Application.EnableEvents = False
210     sht1.Range("Izjava_opredelitev").Value = "DA"
220     Application.EnableEvents = True
230     sht1.Protect Password:="nuladva"
240 End If
250 If sht.Range("pog_poj_razkritja").Value = 1 Then
260     OptionButton33.Enabled = True
270     OptionButton34.Enabled = True
280 Else
290     OptionButton33.Enabled = False
300     OptionButton33.Value = False
310     OptionButton34.Enabled = False
320     OptionButton34.Value = False
330 End If
340 Application.ScreenUpdating = True
    'Debug.Print a
350 For Each cell In target
360     If Union(cell, vrange).Address = vrange.Address Then
370         If (Not Worksheets("dod.bs.").Range("t254_").Value > 0 Or Not Worksheets("dod.bs.").Range("p254_").Value > 0) And Left(Range("mat_nadpod_zavezane").Value, 4) = 9999 Then
380             MsgBox "Vrednost postavke AOP 254 (Kapital nerezidentov) je 0, |fffd|eprav je va|fffd|a nadrejena dru|fffd|ba nerezident (tuj subjekt)."
390         End If
400     End If
410 Next cell
420 For Each cell1 In target
430     If Union(cell1, obmocje).Address = obmocje.Address Then
440         If (Not Worksheets("dod.bs.").Range("t254_").Value > 0 Or Not Worksheets("dod.bs.").Range("p254_").Value > 0) And Left(Range("mat_nadpod_zavezane").Value, 4) = 9999 Then
450             MsgBox "Vrednost postavke AOP 254 (Kapital nerezidentov) je 0, |fffd|eprav je va|fffd|a nadrejena dru|fffd|ba nerezident (tuj subjekt)."
460         End If
470     End If
480 Next cell1
490 For Each cell2 In target
500     If Union(cell2, obmocje1).Address = obmocje1.Address Then
510         If (Not Worksheets("dod.bs.").Range("t254_").Value > 0 Or Not Worksheets("dod.bs.").Range("p254_").Value > 0) And Left(Range("mat_nadpod_zavezane").Value, 4) = 9999 Then
520             MsgBox "Vrednost postavke AOP 254 (Kapital nerezidentov) je 0, |fffd|eprav je va|fffd|a nadrejena dru|fffd|ba nerezident (tuj subjekt)."
530         End If
540     End If
550 Next cell2

560 On Error GoTo 0
570 Exit Sub

Worksheet_Change_Error:

580 MsgBox "Error " & Err.Number & " (" & Err.Description & ") in procedure Worksheet_Change of VBA Document List10"

End Sub


Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim vrange As Range, cell As Range
    Dim Msg As String
    Dim ValidateCode As Variant
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("vnos_dod_ipiz")
30  For Each cell In target
40      If Union(cell, vrange).Address = vrange.Address Then
50          ValidateCode = EntryIsValid(cell)
60          If ValidateCode = True Then
70              Exit Sub
80          Else
90              Msg = "V celico " & cell.Address(False, False) & ":"
100             Msg = Msg & vbCrLf & vbCrLf & ValidateCode
110             MsgBox Msg, vbCritical, "Napa|fffd|en vnos"
120             Application.EnableEvents = False
130             cell.ClearContents
140             cell.Activate
150             Application.EnableEvents = True
160         End If
170     End If
180 Next cell

190 On Error GoTo 0
200 Exit Sub

Worksheet_Change_Error:

210 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri worksheet_change v VBA Document List7"
End Sub

Private Function EntryIsValid(cell) As Variant
'   Returns True if cell is an integer between 1 and 12
'   Otherwise it returns a string that describes the problem

'   Blank
10  If cell = "" Then
20      EntryIsValid = True
30      Exit Function
40  End If

    '   Numeric
50  If Not IsNumeric(cell) Then
60      EntryIsValid = "morate vnesti |fffd|tevilo!"
70      Exit Function
80  End If

    '   Integer?
    ' If CInt(cell) <> cell Then
    '    EntryIsValid = "Integer required."
    '   Exit Function
    'End If

    ' Manjse od nic
    'If cell < 0 Then
    '   EntryIsValid = "Vnos negativnih |fffd|tevil v tem obrazcu ni dovoljen!"
    '  Exit Function
    'End If
    'If cell.Value <> Int(cell.Value) Then
    '  EntryIsValid = "vnos decimalnih |fffd|tevil ni dovoljen!"
    '  Exit Function
    '
    'End If

    '   It passed all the tests
90  EntryIsValid = True
End Function

Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton3, 61, 30, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 55, 33, MSForms, CommandButton"
Attribute VB_Control = "TextBox1, 53, 34, MSForms, TextBox"
Private Sub TextBox1_GotFocus()
    Dim lngSelStart As Long
    On Error Resume Next
    If Val(Application.Version) >= 15 Then    ' ce je verzija excela 2013
        lngSelStart = Me.TextBox1.SelStart    ' shrani se polozaj kurzorja
        Me.TextBox1.MultiLine = False    'multiline lastnost  nastavi najprej na false
        Me.TextBox1.MultiLine = True    ' in potem takoj na true
        Me.TextBox1.SelStart = lngSelStart
    End If
End Sub

Private Sub CommandButton1_Click()
    Dim sht As Worksheet, sht1 As Worksheet, sht2 As Worksheet, sht3 As Worksheet
    Dim vrednost, stat_poj
    Set sht = Worksheets("xml")
    Set sht1 = Worksheets("status_vnosa")
    Set sht2 = Worksheets("Izpis_pojasnil")
    Set sht3 = Worksheets("Pojasnila")
    vrednost = sht.Range("b33").Value    ' poj oddal
    stat_poj = sht1.Range("c30").Value    '0 vneseno vec kot 100 znakov
    If vrednost = 1 Then
        If stat_poj = 0 Then
            Application.EnableEvents = False
            Call izpis_poj
            sht2.Activate
            sht2.PrintOut
            Application.EnableEvents = True
            sht3.Activate
        Else
            MsgBox "Tiskanje pojasnil ni mo|fffd|no zaradi nepopolnega vnosa."
        End If
    End If

End Sub





Private Sub CommandButton3_Click()
    Dim sht As Worksheet, sht1 As Worksheet, sht2 As Worksheet, sht3 As Worksheet
    Dim vrednost, stat_poj
10  Set sht = Worksheets("xml")
20  Set sht1 = Worksheets("status_vnosa")
30  Set sht2 = Worksheets("Izpis_pojasnil")
40  Set sht3 = Worksheets("Pojasnila")
50  vrednost = sht.Range("b33").Value    'poj oddal
60  stat_poj = sht1.Range("c30").Value
70  If vrednost = 1 Then
80      If stat_poj = 0 Then
90          Application.EnableEvents = False
100         Call izpis_poj
110         sht2.Activate
120         sht2.PrintOut
130         Application.EnableEvents = True
140         sht3.Activate
150     Else
160         MsgBox "Tiskanje pojasnil ni mo|fffd|no zaradi nepopolnega vnosa."
170     End If
180 End If
End Sub






Private Sub Worksheet_Activate()
    Dim sht As Worksheet, sht1 As Worksheet, sht2 As Worksheet
    Dim obmocje As Range
    Dim izj_stat As String
    Set sht = Worksheets("Izjava")
    Set sht1 = Worksheets("Opredelitev")
    Set sht2 = Worksheets("xml")
    Set obmocje = sht.Range("Izjava_opredelitev")
    izj_stat = Left(StrConv(obmocje.Value, vbUpperCase), 2)
    If izj_stat = "NE" Then
        TextBox1.Enabled = False
        CommandButton1.Enabled = False
        CommandButton3.Enabled = False
    Else
        If izj_stat = "DA" Then
            If sht2.Range("b33").Value = 1 Then
                TextBox1.Enabled = True
                CommandButton1.Enabled = True
                CommandButton3.Enabled = True
            Else
                TextBox1.Enabled = False
                CommandButton1.Enabled = False
                CommandButton3.Enabled = False
            End If
        End If
    End If
End Sub


Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ComboBox1, 45, 0, MSForms, ComboBox"
Option Explicit

Private Sub ComboBox1_Change()
    Dim vrednost
    Dim izvor As Range
    Set izvor = Range(ComboBox1.ListFillRange)
    vrednost = izvor.Offset(ComboBox1.ListIndex, 0).Resize(1, 1).Value
    Worksheets("Osnovni podatki").Range("c40").Value = vrednost
End Sub

Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim vrange As Range, cell, celica, celica1 As Range
    Dim obmocje, obmocje1, obmocje2 As Range
    Dim stat_sprem As Integer
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("m")
30  Set obmocje = Range("c45")
40  Set obmocje1 = Range("c29")

50  For Each cell In target
60      If Union(cell, vrange).Address = vrange.Address And Len(vrange.Value) = 7 And IsNumeric(vrange) Then
70          vrange.Value = vrange.Value * 1000


80      End If

90  Next cell
100 For Each celica In target
110     If Union(celica, obmocje).Address = obmocje.Address Then
120         Worksheets("Osnovni podatki").Unprotect Password:="nuladva"
130         celica.Hyperlinks.Delete
140         Range("c45").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
            '      Range("c47").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
            '      Range("c47").Interior.ColorIndex = 19
150         Range("c45").Interior.ColorIndex = 19
160         With Range("c45").Font
170             .Name = "Arial"
180             .Size = 12
190         End With
            '      Range("c47").Locked = False
200         Range("c45").Locked = False

            '      With Range("c47").Font
            '          .Name = "Arial"
            '          .Size = 12
            '      End With
210         Worksheets("Osnovni podatki").Protect Password:="nuladva"
220     End If

230 Next celica
240 For Each celica1 In target
250     If Union(celica1, obmocje1).Address = obmocje1.Address And IsNumeric(Range("c29").Value) Then

260         stat_sprem = Range("c29").Value

270         Select Case stat_sprem
            Case 0, 5, 6, 7, 8
280             Worksheets("Osnovni podatki").Unprotect Password:="nuladva"
290             With Range("c33")
300                 Application.EnableEvents = False
                    '.Value = DateValue("01.01.2006")
310                 .Value = 42370
320                 .Locked = True
330             End With
340             Application.EnableEvents = True
350             With Range("c35")
360                 Application.EnableEvents = False
370                 .Value = 42735
380                 .Locked = True
390             End With
400             Application.EnableEvents = True
410             Worksheets("Osnovni podatki").Protect Password:="nuladva"
420         Case 1, 3
430             Worksheets("Osnovni podatki").Unprotect Password:="nuladva"
440             With Range("c33")
450                 Application.EnableEvents = False
460                 .Value = 42370
470                 .Locked = True
480             End With
490             Application.EnableEvents = True
500             With Range("c35")
510                 Application.EnableEvents = False
520                 .Value = ""
530                 .Locked = False
540             End With
550             Application.EnableEvents = True
560             Worksheets("Osnovni podatki").Protect Password:="nuladva"
570         Case 2, 4
580             Worksheets("Osnovni podatki").Unprotect Password:="nuladva"
590             With Range("c33")
600                 Application.EnableEvents = False
610                 .Value = ""
620                 .Locked = False
630             End With
640             Application.EnableEvents = True
650             With Range("c35")
660                 Application.EnableEvents = False
670                 .Value = 42735
680                 .Locked = True
690             End With
700             Application.EnableEvents = True
710             Worksheets("Osnovni podatki").Protect Password:="nuladva"
720         Case Else
730             Worksheets("Osnovni podatki").Unprotect Password:="nuladva"
740             With Range("c33")
750                 Application.EnableEvents = False
760                 .Value = ""
770                 .Locked = False
780             End With
790             With Range("c35")
800                 .Value = ""
810                 .Locked = False
820             End With
830             Application.EnableEvents = True
840             Worksheets("Osnovni podatki").Protect Password:="nuladva"
850         End Select

860     End If

870 Next celica1

880 On Error GoTo 0
890 Exit Sub

Worksheet_Change_Error:

900 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri worksheet_change v VBA Document List2"

End Sub
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit

Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim vrange As Range, cell As Range, celica As Range, celica1 As Range, sredstva_tek As Range, sredstva_pret As Range
    Dim Msg As String, meseci_sredstva As Range, obmocje As Range
    Dim ValidateCode As Variant, sred_tek_vred As Variant, sred_pret_vred As Variant, sporocilo As Variant
    Dim rezultat, rezultat1, sht As Worksheet, kontrola_mes_sred As Boolean
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("vnos_bs")
30  Set obmocje = Range("vnos_razkritij")
40  Set sredstva_tek = Range("T001_")
50  Set sredstva_pret = Range("P001_")
60  Set meseci_sredstva = Range("kontrola_mes_sredstva")
70  sred_tek_vred = sredstva_tek.Value
80  sred_pret_vred = sredstva_pret.Value
90  kontrola_mes_sred = meseci_sredstva.Value
100 Set sht = Worksheets("Osnovni podatki")
110 sporocilo = "Podatek AOP 001, ki ste ga vpisali v stolpec za teko|fffd|e leto," & vbCrLf _
              & "se razlikuje za ve|fffd| kot 500 % od podatka za preteklo leto."
120 For Each cell In target
130     If Union(cell, vrange).Address = vrange.Address Then
140         ValidateCode = EntryIsValid(cell)
150         If Not ValidateCode = True Then
160             Msg = "V celico " & cell.Address(False, False) & ":"
170             Msg = Msg & vbCrLf & vbCrLf & ValidateCode
180             MsgBox Msg, vbCritical, "Napa|fffd|en vnos"
190             Application.EnableEvents = False
200             cell.ClearContents
210             cell.Activate
220             Application.EnableEvents = True
230         End If
240     End If
250 Next cell
260 For Each celica In target
270     If Union(celica, obmocje).Address = obmocje.Address Then
280         Application.ScreenUpdating = False
290         Call MergedAreaRowAutofit
300         Application.ScreenUpdating = True
310     End If
320 Next celica
330 On Error GoTo 0
340 Exit Sub

Worksheet_Change_Error:

350 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri worksheet_change v VBA Document List4"
End Sub

Private Function EntryIsValid(cell) As Variant
'   Returns True if cell is an integer between 1 and 12
'   Otherwise it returns a string that describes the problem

'   Blank
    If cell = "" Then
        EntryIsValid = True
        Exit Function
    End If

    '   Numeric
    If Not IsNumeric(cell) Then
        EntryIsValid = "morate vnesti |fffd|tevilo!"
        Exit Function
    End If

    '   Integer?
    ' If CInt(cell) <> cell Then
    '    EntryIsValid = "Integer required."
    '   Exit Function
    'End If

    ' Manjse od nic
    'If cell < 0 Then
    '   EntryIsValid = "Vnos negativnih |fffd|tevil v tem obrazcu ni dovoljen!"
    '  Exit Function
    'End If
    'If cell.Value <> Int(cell.Value) Then
    '  EntryIsValid = "vnos decimalnih |fffd|tevil ni dovoljen!"
    '  Exit Function
    '
    'End If

    '   It passed all the tests
    EntryIsValid = True
End Function




Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit

Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim vrange As Range, cell As Range, celica As Range, celica1 As Range, celica2 As Range, obmocje As Range
    Dim Msg As String, meseci_prih As Range
    Dim ValidateCode As Variant, prih_tek As Range, prih_pret As Range, sht As Worksheet
    Dim str_plac As Variant, str_pok_zav As Variant, str_soc_zav As Variant
    Dim str_plac_pret As Variant, str_pok_pret As Variant, str_soc_pret As Variant
    Dim prih_tek_vred As Variant, prih_pret_vred As Variant, kontrola_mes_prih As Boolean
    Dim rezultat As Variant, rezultat1 As Variant, sporocilo As Variant
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("vnos_ipiz")
30  Set obmocje = Range("vnos_zav_tek")
40  Set meseci_prih = Range("kontrola_mes_prihodki")
50  str_plac = Range("e50").Value
60  str_pok_zav = Range("e51").Value
70  str_soc_zav = Range("e52").Value
80  str_plac_pret = Range("f50").Value
90  str_pok_pret = Range("f51").Value
100 str_soc_pret = Range("f52").Value
110 Set prih_tek = Range("T110_")
120 Set prih_pret = Range("P110_")
130 prih_tek_vred = prih_tek.Value
140 prih_pret_vred = prih_pret.Value
150 kontrola_mes_prih = meseci_prih.Value
160 Set sht = Worksheets("Osnovni podatki")
    '    Debug.Print rezultat
170 sporocilo = "Podatek AOP 110, ki ste ga vpisali v stolpec za teko|fffd|e leto," & vbCrLf _
              & "se razlikuje za ve|fffd| kot 500 % od podatka za preteklo leto."
180 For Each cell In target
190     If Union(cell, vrange).Address = vrange.Address Then
200         ValidateCode = EntryIsValid(cell)
210         If Not ValidateCode = True Then
220             Msg = "V celico " & cell.Address(False, False) & ":"
230             Msg = Msg & vbCrLf & vbCrLf & ValidateCode
240             MsgBox Msg, vbCritical, "Napa|fffd|en vnos"
250             Application.EnableEvents = False
260             cell.ClearContents
270             cell.Activate
280             Application.EnableEvents = True
290         End If
300     End If
310 Next cell
320 For Each celica In target
330     If Union(celica, obmocje).Address = obmocje.Address Then
340         If Application.WorksheetFunction.IsNumber(str_plac) Then
350             If str_plac > 0 Then
360                 If str_pok_zav <= 0 Then
370                     MsgBox ("AOP 140 (teko|fffd|e leto) je > 0, zato mora biti tudi AOP 141 (teko|fffd|e leto) > 0.")
380                 End If
390             End If
400         End If
410         If Application.WorksheetFunction.IsNumber(str_pok_zav) Then
420             If str_pok_zav > 0 Then
430                 If str_soc_zav <= 0 Then
440                     MsgBox ("AOP 141 (teko|fffd|e leto) je > 0, zato mora biti tudi AOP 142 (teko|fffd|e leto) > 0.")
450                 End If
460             End If
470         End If
480         If Application.WorksheetFunction.IsNumber(str_soc_zav) Then
490             If str_soc_zav > 0 Then
500                 If str_pok_zav <= 0 Then
510                     MsgBox ("AOP 142 (teko|fffd|e leto) je > 0, zato mora biti tudi AOP 141 (teko|fffd|e leto) > 0.")
520                 End If
530             End If
540         End If
550         If Application.WorksheetFunction.IsNumber(str_plac_pret) Then
560             If str_plac_pret > 0 Then
570                 If str_pok_pret <= 0 Then
580                     MsgBox ("AOP 140 (preteklo leto) je > 0, zato mora biti tudi AOP 141 (preteklo leto) > 0.")
590                 End If
600             End If
610         End If
620         If Application.WorksheetFunction.IsNumber(str_pok_pret) Then
630             If str_pok_pret > 0 Then
640                 If str_soc_pret <= 0 Then
650                     MsgBox ("AOP 141 (preteklo leto) je > 0, zato mora biti tudi AOP 142 (preteklo leto) > 0.")
660                 End If
670             End If
680         End If
690         If Application.WorksheetFunction.IsNumber(str_soc_pret) Then
700             If str_soc_pret > 0 Then
710                 If str_pok_pret <= 0 Then
720                     MsgBox ("AOP 142 (preteklo leto) je > 0, zato mora biti tudi AOP 141 (preteklo leto) > 0.")
730                 End If
740             End If
750         End If
760     End If
770 Next celica

780 On Error GoTo 0
790 Exit Sub

Worksheet_Change_Error:

800 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri worksheet_change v VBA Document List5"
End Sub

Private Function EntryIsValid(cell) As Variant
'   Returns True if cell is an integer between 1 and 12
'   Otherwise it returns a string that describes the problem

'   Blank
    If cell = "" Then
        EntryIsValid = True
        Exit Function
    End If

    '   Numeric
    If Not IsNumeric(cell) Then
        EntryIsValid = "morate vnesti |fffd|tevilo!"
        Exit Function
    End If

    '   Integer?
    ' If CInt(cell) <> cell Then
    '    EntryIsValid = "Integer required."
    '   Exit Function
    'End If

    ' Manjse od nic
    'If cell < 0 Then
    '   EntryIsValid = "Vnos negativnih |fffd|tevil v tem obrazcu ni dovoljen!"
    '  Exit Function
    'End If
    'If cell.Value <> Int(cell.Value) Then
    '  EntryIsValid = "vnos decimalnih |fffd|tevil ni dovoljen!"
    '  Exit Function
    '
    'End If

    '   It passed all the tests
    EntryIsValid = True
End Function




Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit

Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim vrange As Range, cell As Range
    Dim Msg As String
    Dim ValidateCode As Variant
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("vnos_ibd")
30  For Each cell In target
40      If Union(cell, vrange).Address = vrange.Address Then
50          ValidateCode = EntryIsValid(cell)
60          If ValidateCode = True Then
70              Exit Sub
80          Else
90              Msg = "V celico " & cell.Address(False, False) & ":"
100             Msg = Msg & vbCrLf & vbCrLf & ValidateCode
110             MsgBox Msg, vbCritical, "Napa|fffd|en vnos"
120             Application.EnableEvents = False
130             cell.ClearContents
140             cell.Activate
150             Application.EnableEvents = True
160         End If
170     End If
180 Next cell

190 On Error GoTo 0
200 Exit Sub

Worksheet_Change_Error:

210 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri worksheet_change v VBA Document List6"
End Sub

Private Function EntryIsValid(cell) As Variant
'   Returns True if cell is an integer between 1 and 12
'   Otherwise it returns a string that describes the problem

'   Blank
10  If cell = "" Then
20      EntryIsValid = True
30      Exit Function
40  End If

    '   Numeric
50  If Not IsNumeric(cell) Then
60      EntryIsValid = "morate vnesti |fffd|tevilo!"
70      Exit Function
80  End If

    '   Integer?
    ' If CInt(cell) <> cell Then
    '    EntryIsValid = "Integer required."
    '   Exit Function
    'End If

    ' Manjse od nic
    'If cell < 0 Then
    '   EntryIsValid = "Vnos negativnih |fffd|tevil v tem obrazcu ni dovoljen!"
    '  Exit Function
    'End If
    'If cell.Value <> Int(cell.Value) Then
    '  EntryIsValid = "vnos decimalnih |fffd|tevil ni dovoljen!"
    '  Exit Function
    '
    'End If

    '   It passed all the tests
90  EntryIsValid = True
End Function





Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit

Private Sub Worksheet_Change(ByVal target As Excel.Range)
    Dim vrange As Range, cell As Range
    Dim Msg As String
    Dim ValidateCode As Variant
10  On Error GoTo Worksheet_Change_Error

20  Set vrange = Range("vnos_dod_pod")
30  For Each cell In target
40      If Union(cell, vrange).Address = vrange.Address Then
50          ValidateCode = EntryIsValid(cell)
60          If ValidateCode = True Then
70              Exit Sub
80          Else
90              Msg = "V celico " & cell.Address(False, False) & ":"
100             Msg = Msg & vbCrLf & vbCrLf & ValidateCode
110             MsgBox Msg, vbCritical, "Napa|fffd|en vnos"
120             Application.EnableEvents = False
130             cell.ClearContents
140             cell.Activate
150             Application.EnableEvents = True
160         End If
170     End If
180 Next cell

190 On Error GoTo 0
200 Exit Sub

Worksheet_Change_Error:

210 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri worksheet_change v VBA Document List7"
End Sub

Private Function EntryIsValid(cell) As Variant
'   Returns True if cell is an integer between 1 and 12
'   Otherwise it returns a string that describes the problem

'   Blank
10  If cell = "" Then
20      EntryIsValid = True
30      Exit Function
40  End If

    '   Numeric
50  If Not IsNumeric(cell) Then
60      EntryIsValid = "morate vnesti |fffd|tevilo!"
70      Exit Function
80  End If

    '   Integer?
    ' If CInt(cell) <> cell Then
    '    EntryIsValid = "Integer required."
    '   Exit Function
    'End If

    ' Manjse od nic
    'If cell < 0 Then
    '   EntryIsValid = "Vnos negativnih |fffd|tevil v tem obrazcu ni dovoljen!"
    '  Exit Function
    'End If
    'If cell.Value <> Int(cell.Value) Then
    '  EntryIsValid = "vnos decimalnih |fffd|tevil ni dovoljen!"
    '  Exit Function
    '
    'End If

    '   It passed all the tests
90  EntryIsValid = True
End Function






Attribute VB_Name = "List8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Module1"
Option Explicit
Option Base 1



Public Function naredi_xml(ImeIzhodneDatoteke As Variant) As Boolean
10  On Error GoTo naredi_xml_Error


    Dim xmldoc As DOMDocument
    Dim obj_pi As IXMLDOMProcessingInstruction
    Dim obj_root As IXMLDOMElement    ' root element
    Dim obj_nmspace As IXMLDOMAttribute    ' atribut za nonamespace
    Dim obj_ident As IXMLDOMElement    ' node IDENT
    Dim ident_atribut As IXMLDOMAttribute    ' atribut za node IDENT
    Dim ident_ura As IXMLDOMElement    ' element ura
    Dim ident_datum As IXMLDOMElement    ' element datum
    Dim ident_nacin As IXMLDOMElement    ' element nacin_predlozitve
    Dim ident_pravice As IXMLDOMElement    ' element vse_pravice_ajpes
    Dim obj_osnovni As IXMLDOMElement    ' node Osnovni podatki
    Dim osnovni_element As IXMLDOMElement
    Dim obj_podatki As IXMLDOMElement    ' node Podatki
    Dim osnovni_atribut As IXMLDOMAttribute    'atribut za node osnovni in sicer vrstaPoslovnegaSubjekta
    Dim obj_aop As IXMLDOMElement    ' element aop
    Dim aop_atribut As IXMLDOMAttribute    ' atribut id od aop
    Dim obj_podatek As IXMLDOMElement    ' element podatek
    Dim podatek_atribut As IXMLDOMAttribute    ' atribut tip od el. podatek
    Dim obj_pojasnila As IXMLDOMElement    ' element Pojasnila
    Dim obj_cdata As IXMLDOMCDATASection    ' cdata pojasnila
    Dim obj_razk_4_clen As IXMLDOMElement    ' razkritja 4. |fffd|len
    Dim obj_cdata_razk_4_clen As IXMLDOMCDATASection
    Dim obj_razk_5_clen As IXMLDOMElement    ' razkritja 5. |fffd|len
    Dim obj_cdata_razk_5_clen As IXMLDOMCDATASection
    Dim obj_razk_6_clen As IXMLDOMElement    ' razkritja 6. |fffd|len
    Dim obj_cdata_razk_6_clen As IXMLDOMCDATASection
    Dim obj_razk_10_clen As IXMLDOMElement    ' razkritja 10. |fffd|len
    Dim obj_cdata_razk_10_clen As IXMLDOMCDATASection
    Dim obj_razk_razp_dobicek As IXMLDOMElement    ' razkritja predlog razp. dobi|fffd|ka
    Dim obj_cdata_razk_razp_dobicek As IXMLDOMCDATASection
    Dim sht As Worksheet, sht1 As Worksheet
20  Set sht = Worksheets("BS")
30  Set sht1 = Worksheets("xml")
    Dim o_osnovni As Range
40  Set o_osnovni = sht1.Range("b10:b57")
    Dim o_podatki_tekoce As Range
50  Set o_podatki_tekoce = sht1.Range("b60:b322")
    Dim o_podatki_pret As Range
60  Set o_podatki_pret = sht1.Range("D60:d322")
    Dim podatki_tekoce As Variant, podatki_pret As Variant  ' polja za aop-je T, P
70  podatki_tekoce = Application.WorksheetFunction.Transpose(o_podatki_tekoce)
80  podatki_pret = Application.WorksheetFunction.Transpose(o_podatki_pret)
    Dim podatki_tekoce_polje, podatki_pret_polje, aop_elem
    Dim o_aop As Range
90  Set o_aop = sht1.Range("i60:i322")
    Dim aop_polje As Variant
100 aop_polje = Application.WorksheetFunction.Transpose(o_aop)
    Dim o_pojasnila As Range
110 Set o_pojasnila = sht1.Range("b324")
    Dim tekst_poj As Variant
    'tekst_poj = RTrim(o_pojasnila.Value)
120 tekst_poj = razdeli_tekst_vrstice(o_pojasnila, vbCrLf)   ' na koncu vsake vrstice je pred CRLF dodana html oznaka br
130 tekst_poj = Replace(tekst_poj, Chr(12), "")    ' iz teksta pojasnil odstranjen znak FF (form feed)
    Dim o_razkr_4_clen As Range, o_razkr_5_clen As Range, o_razkr_6_clen As Range, o_razkr_10_clen As Range, o_prerazp_dobicka As Range
140 Set o_razkr_4_clen = sht1.Range("B327")
150 Set o_razkr_5_clen = sht1.Range("B330")
160 Set o_razkr_6_clen = sht1.Range("B333")
170 Set o_razkr_10_clen = sht1.Range("B336")
180 Set o_prerazp_dobicka = sht1.Range("B339")
    Dim tekst_razkr_4, tekst_razkr_5, tekst_razkr_6, tekst_razkr_10, tekst_prerazp_dobicek
190 tekst_razkr_4 = o_razkr_4_clen.Value
200 tekst_razkr_5 = o_razkr_5_clen.Value
210 tekst_razkr_6 = o_razkr_6_clen.Value
220 tekst_razkr_10 = o_razkr_10_clen.Value
230 tekst_prerazp_dobicek = o_prerazp_dobicka.Value
    Dim imena_tipov As Variant
    Dim ime_tipa As Variant
240 imena_tipov = Array("T", "P")
    Dim osn_excel As Variant    ' polja osnovnih pod. excel
    Dim osn_xml As Variant    ' polja v nodu osnovni_podatki
    Dim osn_excel_polje As Variant    'posaz. el
    Dim osn_xml_polje As Variant   ' posamezen  el.
250 osn_excel = Application.WorksheetFunction.Transpose(o_osnovni)
260 osn_xml = Array("OSN_Maticna_stevilka", "OSN_Davcna_stevilka", "OSN_Ime", "OSN_Sedez", "OSN_Statusna_sprememba", "OSN_MS_pred_spremembo", _
                    "OSN_Odgovorna_oseba_za_bilanco", "OSN_Telefonska_stevilka", "OSN_Enaslov_kontaktne_osebe", "OSN_Enaslov_za_obvestila_eracune", _
                    "OSN_Vodja_podjetja", "OSN_Datum_sestave_bilance", "OSN_Kraj_sestave_bilance", "OSN_Datum_posl_zacetek", "OSN_Datum_posl_konec", _
                    "OSN_Racunovodimo", "OSN_Velikost", "OSN_Velikost_izracunana_preteklo", "OSN_Velikost_izracunana_tekoce", _
                    "OSN_Velikost_obravnavana_preteklo", "OSN_Velikost_obravnavana_tekoce", "OSN_Izracunana_zavezanost_reviziji", "IZJ_Oddal_izjavo", _
                    "POJ_Oddal", "OPR_Vrsta_druzbe", "OPR_Subjekt_javnega_interesa", "OPR_Poslovno_leto_vrsta", "OPR_Poslovno_leto_zacetek", _
                    "OPR_Poslovno_leto_konec", "OPR_Velikost_vrednotenje_racunovodskih_postavk_po_nacelu", _
                    "OPR_Velikost_investicijsko_podjetje_ali_financni_holding", "OPR_Velikost_pojasnila_k_izkazom_ali_razkritja_informacij", "OPR_Opredelitev", _
                    "OPR_Ime_sedez_nadrejene", "OPR_MS_nadrejene_druzbe", "OPR_Revizija", "OPR_Revizija_Zavezanost_k_preiskavi_letnih_racunovodskih_izkazov", _
                    "OPR_Revizija_Zavezanost_za_sestavitev_porocila_o_placilih_vladam", "OPR_Vrsta_podruznice", "OPR_Ime_podruznice", _
                    "OPR_Sifra_drzave", "OPR_Javna_objava", "OPR_Javna_objava_ms", "OPR_Poslovanje_s_tujino_poslovne_terjatve", _
                    "OPR_Poslovanje_s_tujino_poslovne_obveznosti", "OPR_Poslovanje_s_tujino_financne_obveznosti", _
                    "OPR_Poslovanje_s_tujino_financne_terjatve", "OPR_Poslovanje_s_tujino_najmanj_10_odstotni_lastnik")
    Dim stevec, x, i, j, k, l, m As Integer
270 x = 0
280 Set xmldoc = New DOMDocument    ' kreiram dom dokument
290 Set obj_pi = xmldoc.createProcessingInstruction("xml", "version=""1.0"" encoding=""UTF-8""")    ' sprememba
300 xmldoc.appendChild obj_pi
310 Set obj_root = xmldoc.createElement("AjpesDokument")
320 xmldoc.appendChild obj_root
330 Set obj_nmspace = xmldoc.createNode(NODE_ATTRIBUTE, _
                                        "xsi:noNamespaceSchemaLocation", _
                                        "http://www.w3.org/2001/XMLSchema-instance")
340 obj_nmspace.Value = "http://www.ajpes.si/XML_Sheme/LP_V1_0.xsd"    'sprememba
350 xmldoc.documentElement.Attributes.setNamedItem obj_nmspace
360 Set obj_ident = xmldoc.createElement("Ident")
370 obj_root.appendChild obj_ident
380 Set ident_atribut = xmldoc.createAttribute("Vrsta")
390 obj_ident.setAttributeNode ident_atribut
400 ident_atribut.Value = "LP"    'spremenjeno
410 Set ident_datum = xmldoc.createElement("Datum")
420 obj_ident.appendChild ident_datum
430 ident_datum.Text = Format(Date, "yyyy-mm-dd")
440 Set ident_ura = xmldoc.createElement("Ura")
450 obj_ident.appendChild ident_ura
460 ident_ura.Text = Format(Time, "hh:mm:ss")
470 Set ident_nacin = xmldoc.createElement("Nacin_predlozitve")
480 obj_ident.appendChild ident_nacin
490 ident_nacin.Text = "DISKETA"
500 Set ident_pravice = xmldoc.createElement("Vse_pravice")
510 obj_ident.appendChild ident_pravice
520 ident_pravice.Text = "Vse pravice AJPES 2016"
530 Set obj_osnovni = xmldoc.createElement("Osnovni_podatki")
540 obj_root.appendChild obj_osnovni
550 Set osnovni_atribut = xmldoc.createAttribute("vrstaPoslovnegaSubjekta")
560 obj_osnovni.setAttributeNode osnovni_atribut
570 osnovni_atribut.Value = "GD"
580 For stevec = 1 To 48
590     osn_excel_polje = osn_excel(stevec)
600     osn_xml_polje = osn_xml(stevec)
610     Set osnovni_element = xmldoc.createElement(osn_xml_polje)
620     obj_osnovni.appendChild osnovni_element
630     osnovni_element.Text = osn_excel_polje
640     If osnovni_element.Text = "" Then
650         obj_osnovni.removeChild osnovni_element
660     End If
670     x = x + 1
680 Next stevec
690 Set obj_podatki = xmldoc.createElement("Podatki")
700 obj_root.appendChild obj_podatki
710 For k = 1 To 263
720     Set obj_aop = xmldoc.createElement("AOP")
730     obj_podatki.appendChild obj_aop
740     Set aop_atribut = xmldoc.createAttribute("ID")
750     obj_aop.setAttributeNode aop_atribut
760     aop_elem = aop_polje(k)
770     aop_atribut.Value = aop_elem
780     For l = 1 To 2
790         ime_tipa = imena_tipov(l)
800         Set obj_podatek = xmldoc.createElement("PODATEK")
810         obj_aop.appendChild obj_podatek
820         Set podatek_atribut = xmldoc.createAttribute("TIP")
830         obj_podatek.setAttributeNode podatek_atribut
840         podatek_atribut.Value = ime_tipa
850         If ime_tipa = "T" Then
860             If podatki_tekoce(k) = "" Then
870                 podatki_tekoce(k) = 0
880             End If
890             obj_podatek.Text = Application.WorksheetFunction.Substitute(Format(podatki_tekoce(k), "###0.00"), ",", ".")
900         ElseIf ime_tipa = "P" Then
910             If podatki_pret(k) = "" Then
920                 podatki_pret(k) = 0
930             End If
940             obj_podatek.Text = Application.WorksheetFunction.Substitute(Format(podatki_pret(k), "###0.00"), ",", ".")
950         End If
960     Next l
970 Next k
980 If sht1.Range("b33").Value = 1 Then
990     Set obj_pojasnila = xmldoc.createElement("Pojasnila")
1000    obj_root.appendChild obj_pojasnila
1010    Set obj_cdata = xmldoc.createCDATASection(tekst_poj)
1020    obj_pojasnila.appendChild obj_cdata
1030 End If
1040 If sht1.Range("b41").Value = 2 Then
1050    Set obj_razk_4_clen = xmldoc.createElement("Razkritje_informacij_iz_4_tocke")
1060    obj_root.appendChild obj_razk_4_clen
1070    Set obj_cdata_razk_4_clen = xmldoc.createCDATASection(tekst_razkr_4)
1080    obj_razk_4_clen.appendChild obj_cdata_razk_4_clen
1090    Set obj_razk_5_clen = xmldoc.createElement("Razkritje_informacij_iz_5_tocke")
1100    obj_root.appendChild obj_razk_5_clen
1110    Set obj_cdata_razk_5_clen = xmldoc.createCDATASection(tekst_razkr_5)
1120    obj_razk_5_clen.appendChild obj_cdata_razk_5_clen
1130    Set obj_razk_6_clen = xmldoc.createElement("Razkritje_informacij_iz_6_tocke")
1140    obj_root.appendChild obj_razk_6_clen
1150    Set obj_cdata_razk_6_clen = xmldoc.createCDATASection(tekst_razkr_6)
1160    obj_razk_6_clen.appendChild obj_cdata_razk_6_clen
1170    Set obj_razk_10_clen = xmldoc.createElement("Razkritje_informacij_iz_10_tocke")
1180    obj_root.appendChild obj_razk_10_clen
1190    Set obj_cdata_razk_10_clen = xmldoc.createCDATASection(tekst_razkr_10)
1200    obj_razk_10_clen.appendChild obj_cdata_razk_10_clen
1210    Set obj_razk_razp_dobicek = xmldoc.createElement("Predlog_razporeditve_dobicka")
1220    obj_root.appendChild obj_razk_razp_dobicek
1230    Set obj_cdata_razk_razp_dobicek = xmldoc.createCDATASection(tekst_prerazp_dobicek)
1240    obj_razk_razp_dobicek.appendChild obj_cdata_razk_razp_dobicek
1250 End If
1260 Call FormatXmlDocument(xmldoc)
1270 xmldoc.Save (ImeIzhodneDatoteke)
1280 Set osn_excel = Nothing
1290 Set osn_xml = Nothing
1300 Set imena_tipov = Nothing
1310 Set podatki_tekoce = Nothing
1320 Set podatki_pret = Nothing
1330 Set aop_polje = Nothing
1340 naredi_xml = True    ' |fffd|e ni ni|fffd| napak
1350 On Error GoTo 0
1360 Exit Function

naredi_xml_Error:
1370 naredi_xml = False
1380 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri naredi_xml v Module Module1"
End Function
Private Sub FormatXmlDocument(ByVal xmldoc As DOMDocument)
10  FormatXmlNode xmldoc.documentElement, 0
End Sub
Private Sub FormatXmlNode(ByVal node As IXMLDOMNode, ByVal indent As Integer)

    Dim child As IXMLDOMNode
    Dim text_only As Boolean

    ' Do nothing if this is a text node.
10  If TypeOf node Is IXMLDOMText Then Exit Sub

    ' See if this node contains only text.
20  text_only = True
30  If node.hasChildNodes Then
40      For Each child In node.childNodes
50          If Not (TypeOf child Is IXMLDOMText) Then
60              text_only = False
70              Exit For
80          End If
90      Next child
100 End If

    ' Process child nodes.
110 If node.hasChildNodes Then
        ' Add a carriage return before the children.
120     If Not text_only Then
130         node.insertBefore _
                    node.ownerDocument.createTextNode(vbCrLf), _
                    node.FirstChild
140     End If

        ' Format the children.
150     For Each child In node.childNodes
160         FormatXmlNode child, indent + 2
170     Next child
180 End If

    ' Format this element.
190 If indent > 0 Then
        ' Indent before this element.
200     node.parentNode.insertBefore _
                node.ownerDocument.createTextNode(Space$(indent)), _
 _
        node

        ' Indent after the last child node.
210     If Not text_only Then _
           node.appendChild _
           node.ownerDocument.createTextNode(Space$(indent))

        ' Add a carriage return after this node.
220     If node.nextSibling Is Nothing Then
230         node.parentNode.appendChild _
                    node.ownerDocument.createTextNode(vbCrLf)
240     Else
250         node.parentNode.insertBefore _
                    node.ownerDocument.createTextNode(vbCrLf), _
                    node.nextSibling
260     End If
270 End If
End Sub

Attribute VB_Name = "Module2"
Option Explicit
Sub Uvozpodatkov()

'Uvoz podatkov iz preglednice,ki jo izbere uporabnik
    Dim ime_datoteke, wb1 As Workbook, wb2 As Workbook
    Dim sht As Worksheet, sht1 As Worksheet, sht2 As Worksheet
    Dim sht3 As Worksheet, sht4 As Worksheet, sht5 As Worksheet
    Dim sht6 As Worksheet, sht7 As Worksheet, sht8 As Worksheet, sht9 As Worksheet, sht10 As Worksheet
    Dim i As Integer, j As Integer, k As Integer, l As Integer, m As Integer, n As Integer
    Dim maticna As String, maticna1 As String, test As String, TEST1 As String
    Dim vred_bs As Double, vred_ipi As Double, vred_ibd As Double, vred_dod_bs As Double, vred_dod_ipiz As Double
    Dim obravn_velikost_pret As Long

10  On Error GoTo Uvozpodatkov_Error
20  MsgBox "Izberite lanskoletno Excelovo preglednico LPGD_2015." & vbCrLf _
         & "|fffd|e te preglednice nimate, uvoz podatkov za lansko leto v to preglednico ni mo|fffd|en."
30  ime_datoteke = Application.GetOpenFilename("Vse datoteke (*.*),*.*")    'popravek 12.2.2015 prej filter samo na xls datoteke
40  If ime_datoteke = False Then
50      MsgBox ("Izbrali ste gumb prekli|fffd|i," & vbCrLf _
              & "zato lanskoletni podatki niso bili uvo|fffd|eni!")
60      Exit Sub
70  End If
    'If Err <> 0 Then Exit Sub

    'On Error GoTo 0

    'Application.EnableEvents = False
80  Application.ScreenUpdating = False

90  Set wb2 = ActiveWorkbook
100 Set wb1 = Workbooks.Open(ime_datoteke)

110 If DoesWorkSheetExist("bs", wb1) = True And DoesWorkSheetExist("ipiz", wb1) = True _
       And DoesWorkSheetExist("Dod.BS.", wb1) = True And DoesWorkSheetExist("Dod.IPIZ", wb1) _
       And DoesWorkSheetExist("ibd-bi", wb1) = True Then
120     Set sht = wb1.Worksheets("bs")
130     Set sht1 = wb2.Worksheets("bs")
140     Set sht2 = wb1.Worksheets("ipiz")
150     Set sht3 = wb2.Worksheets("IPI")
160     Set sht4 = wb1.Worksheets("ibd-bi")
170     Set sht5 = wb2.Worksheets("ibd-bi")
180     Set sht6 = wb1.Worksheets("Dod.BS.")
190     Set sht7 = wb2.Worksheets("Dod.BS.")
200     Set sht8 = wb2.Worksheets("Status_vnosa")
210     Set sht9 = wb1.Worksheets("Dod.IPIZ")
220     Set sht10 = wb2.Worksheets("Dod.IPI")
        'MsgBox ("OBSTAJA")
230     test = wb1.Worksheets("xml").Range("a3").Value
        ' Debug.Print test
240     maticna = wb2.Worksheets("xml").Range("b10").Value
250     maticna1 = wb1.Worksheets("xml").Range("b12").Value
260     If Mid(test, 15, 9) = "LPGD_2015" Then
270         If CStr(Left(maticna, 7)) = CStr(Left(maticna1, 7)) Then
280             Application.EnableEvents = False
290             For i = 27 To 92
300                 vred_bs = sht.Range("E" & i).Value
310                 If Not sht1.Range("F" & i).HasFormula = True Then
320                     sht1.Range("F" & i).Value = vred_bs
330                 End If
340             Next i
350             For n = 94 To 122
360                 vred_bs = sht.Range("E" & n).Value
370                 If Not sht1.Range("F" & n + 1).HasFormula = True Then
380                     sht1.Range("F" & n + 1).Value = vred_bs
390                 End If
400             Next n
410             For j = 20 To 99
420                 vred_ipi = sht2.Range("E" & j).Value
430                 If Not sht3.Range("F" & j).HasFormula = True Then
440                     sht3.Range("F" & j).Value = vred_ipi
450                 End If
460             Next j
470             For k = 20 To 34
480                 vred_ibd = sht4.Range("E" & k).Value
490                 If Not sht5.Range("F" & k).HasFormula = True Then
500                     sht5.Range("F" & k).Value = vred_ibd
510                 End If
520             Next k
530             For l = 21 To 81
540                 vred_dod_bs = sht6.Range("E" & l).Value
550                 If Not sht7.Range("F" & l).HasFormula = True Then
560                     sht7.Range("F" & l).Value = vred_dod_bs
570                 End If
580             Next l
590             For m = 21 To 27
600                 vred_dod_ipiz = sht9.Range("E" & m).Value
610                 If Not sht10.Range("F" & m).HasFormula = True Then
620                     sht10.Range("F" & m).Value = vred_dod_ipiz
630                 End If
640             Next m
650             obravn_velikost_pret = wb1.Worksheets("xml").Range("b15").Value
660             sht8.Range("f75").Value = obravn_velikost_pret
670             Application.EnableEvents = True
680             MsgBox ("V kolikor je va|fffd|a dru|fffd|ba v predhodnem letu imela revizijo," & vbCrLf & _
                        "potem morate popraviti tiste podatke,ki so se v postopku revizije spremenili.")
690             wb1.Close False
700         Else: MsgBox ("Mati|fffd|na |fffd|tevilka " & Left(maticna, 7) & "," & " ki je vne|fffd|ena v tej preglednici," _
                        & "se ne ujema z mati|fffd|no |fffd|tevilko " & maticna1 & "," & vbCrLf & "ki je v preglednici " & ime_datoteke & "." & vbCrLf & _
                          "Uvoz ni mo|fffd|en.")
710             wb1.Close False
                'Application.EnableEvents = True
720             Set wb1 = Nothing
730             Set wb2 = Nothing
740             Exit Sub
750         End If

760     Else: TEST1 = Mid(test, 15, 9)
770         MsgBox (ime_datoteke & " (" & TEST1 & ") " & "ni Excelova preglednica s podatki," & vbCrLf & _
                    "ki ste jih predlo|fffd|ili AJPES v lanskem letu.")
780         wb1.Close False
790         Set wb1 = Nothing
800         Set wb2 = Nothing
            'Application.EnableEvents = True
810         Exit Sub
820     End If
830 Else: MsgBox (ime_datoteke & " ni Excelova preglednica s podatki," & vbCrLf & _
                  "ki ste jih predlo|fffd|ili AJPES v lanskem letu.")
840     wb1.Close False
850     Set wb1 = Nothing
860     Set wb2 = Nothing
        'Application.EnableEvents = True
870     Exit Sub
880 End If
890 Set wb2 = Nothing
900 Set wb1 = Nothing
    'Application.EnableEvents = True
910 Application.ScreenUpdating = True
920 MsgBox "UVoz podatkov je kon|fffd|an!"

930 On Error GoTo 0
940 Exit Sub

Uvozpodatkov_Error:
950 Select Case Err.Number
    Case 13
960     MsgBox ("Uvoz podatkov ni bil uspe|fffd|en." & vbCrLf & _
                "Do napake je pri|fffd|lo zaradi napa|fffd|nega tipa podatkov!" & vbCrLf & _
                "Preverite podatke v preglednici, iz katere uva|fffd|ate podatke!")
970     wb1.Close False
980 Case Else
990     MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri Uvozpodatkov v Module Module2"
1000 End Select
End Sub

'Function WorksheetExists(SheetName As String, _
 '                         Optional WhichBook As Workbook) As Boolean
'    Dim WB As Workbook
'10  Set WB = IIf(WhichBook Is Nothing, ThisWorkbook, WhichBook)
'20  On Error Resume Next
'30  WorksheetExists = Len(WB.Worksheets(SheetName).Name) > 0
'End Function


Public Sub izpis_napak_bs()
    Dim sht, sht1 As Worksheet
    Dim obmocje, obmocje1, obmocje2, obmocje3 As Range
    Dim stevec As Integer
10  On Error GoTo izpis_napak_bs_Error

20  Set sht = ActiveSheet
30  Application.ScreenUpdating = False
40  Set sht1 = Worksheets.Add
50  Set obmocje = sht1.Range("b21")
60  Set obmocje1 = sht1.Range("c21")
70  Set obmocje2 = sht1.Range("d21")
80  Set obmocje3 = sht1.Range("c18")

90  Worksheets("bs").Range("a1:f11").Copy sht1.Range("A1")
100 Worksheets("bs").Range("a18:a19").Copy sht1.Range("a14")
110 sht1.Range("a10:c10").MergeCells = True    ' dodano
120 sht1.Range("a11:c12").MergeCells = True    ' dodano
130 sht1.Range("a11:c12").WrapText = True    'dodano
140 sht1.Range("a14:f14").MergeCells = True
150 sht1.Range("a15:f15").MergeCells = True
160 Worksheets("bs").Range("d27:d123").Copy
170 sht1.Range("b22").PasteSpecial Paste:=xlPasteValues
180 Worksheets("bs").Range("h27:h128").Copy
190 sht1.Range("c22").PasteSpecial Paste:=xlPasteValues
200 Worksheets("bs").Range("j27:j128").Copy
210 sht1.Range("d22").PasteSpecial Paste:=xlPasteValues
    'sht1.Columns("b").ColumnWidth = 29
220 sht1.Columns("a").ColumnWidth = 4
230 sht1.Columns("d").ColumnWidth = 31

240 sht1.Columns("c").ColumnWidth = 31
250 sht1.Columns("f").ColumnWidth = 11
260 obmocje.Value = "AOP"
270 obmocje1.Value = "Teko|fffd|e leto"
280 obmocje2.Value = "Preteklo leto"
290 obmocje3.Value = "Izpis napak"
300 sht1.Range("a18:f18").MergeCells = True
310 sht1.Range("a18:f18").VerticalAlignment = xlVAlignCenter
320 sht1.Range("a18:f18").HorizontalAlignment = xlHAlignCenter
330 sht1.Range("d10:e11").MergeCells = True
340 sht1.Range("d10:e11").VerticalAlignment = xlVAlignBottom
350 sht1.Range("d10:e11").HorizontalAlignment = xlHAlignRight
360 sht1.Range("a10:b10").MergeCells = True
370 sht1.Range("a18:d123").WrapText = True
380 sht1.Range("a18:d123").VerticalAlignment = xlVAlignCenter
390 sht1.Range("a18:d123").HorizontalAlignment = xlHAlignCenter
400 With sht1.Range("a18:d21").Font
410     .Name = "Arial"
420     .Size = 12
430     .Bold = True
440 End With
450 With sht1.Range("a22:d123").Font
460     .Name = "Arial"
470     .Size = 10
480 End With
490 sht1.Range("b21:d123").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
500 With sht1.Range("b21:d123").Borders(xlInsideVertical)
510     .LineStyle = xlContinuous
520     .Weight = xlThin
530 End With
540 With sht1.Range("b21:d123").Borders(xlInsideHorizontal)
550     .LineStyle = xlContinuous
560     .Weight = xlThin
570 End With
580 For stevec = 123 To 22 Step -1
590     If sht1.Range("c" & stevec).Value = "V redu" And sht1.Range("d" & stevec).Value = "V redu" Then
600         sht1.Range("B" & stevec).EntireRow.Delete
610     End If
620 Next stevec
630 With sht1.PageSetup
640     .Zoom = False
650     .FitToPagesTall = 1
660     .FitToPagesWide = 1
670 End With
680 sht1.PrintOut
690 Application.DisplayAlerts = False
700 sht1.Delete
710 Application.DisplayAlerts = True
720 Application.ScreenUpdating = True

730 On Error GoTo 0
740 Exit Sub

izpis_napak_bs_Error:
750 Select Case Err.Number
    Case 13
760     MsgBox "Izpis napak na listu BS ni mo|fffd|en,ker je(so) v" & vbCrLf & _
               "stolpcu 4f oz. 5f napaka(e) pri kontrolnih formulah!"
770     Application.DisplayAlerts = False
780     sht1.Delete
790     Application.DisplayAlerts = True
800 Case Else
810     MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri izpis_napak_bs v Modulu Module2"
820 End Select
End Sub

Public Sub izpis_napak_ipiz()
    Dim sht, sht1 As Worksheet
    Dim obmocje, obmocje1, obmocje2, obmocje3 As Range
    Dim stevec As Integer
10  On Error GoTo izpis_napak_ipiz_Error

20  Set sht = ActiveSheet
30  Application.ScreenUpdating = False
40  Set sht1 = Worksheets.Add
50  Set obmocje = sht1.Range("b19")
60  Set obmocje1 = sht1.Range("c19")
70  Set obmocje2 = sht1.Range("d19")
80  Set obmocje3 = sht1.Range("c16")
90  Worksheets("IPI").Range("a1:f14").Copy sht1.Range("A1")
    'sht1.Range("a10:c10").Borders(xlInsideHorizontal).LineStyle = xlNone ' dodano
100 sht1.Range("a10:c11").MergeCells = True    ' dodano
110 sht1.Range("a10:c11").WrapText = True    'dodano
120 sht1.Range("a10:c11").HorizontalAlignment = xlHAlignGeneral    ' dodano
130 Worksheets("IPI").Range("d20:d99").Copy
140 sht1.Range("b20").PasteSpecial Paste:=xlPasteValues
150 Worksheets("IPI").Range("h20:h99").Copy
160 sht1.Range("c20").PasteSpecial Paste:=xlPasteValues
170 Worksheets("IPI").Range("j20:j99").Copy
180 sht1.Range("d20").PasteSpecial Paste:=xlPasteValues
    'sht1.Columns("b").ColumnWidth = 29
190 sht1.Columns("a").ColumnWidth = 4
200 sht1.Columns("d").ColumnWidth = 31

210 sht1.Columns("c").ColumnWidth = 31
220 sht1.Columns("f").ColumnWidth = 11
230 obmocje.Value = "AOP"
240 obmocje1.Value = "Teko|fffd|e leto"
250 obmocje2.Value = "Preteklo leto"
260 obmocje3.Value = "Izpis napak"
270 sht1.Range("a16:f16").MergeCells = True
280 sht1.Range("a16:f16").VerticalAlignment = xlVAlignCenter
290 sht1.Range("a16:f16").HorizontalAlignment = xlHAlignCenter

300 Application.ScreenUpdating = False
310 sht1.Range("a16:d99").WrapText = True
320 sht1.Range("a16:d99").VerticalAlignment = xlVAlignCenter
330 sht1.Range("a16:d99").HorizontalAlignment = xlHAlignCenter
340 With sht1.Range("a16:d19").Font
350     .Name = "Arial"
360     .Size = 12
370     .Bold = True
380 End With
390 With sht1.Range("a19:d99").Font
400     .Name = "Arial"
410     .Size = 10
420 End With
430 sht1.Range("b19:d99").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
440 With sht1.Range("b19:d99").Borders(xlInsideVertical)
450     .LineStyle = xlContinuous
460     .Weight = xlThin
470 End With
480 With sht1.Range("b19:d99").Borders(xlInsideHorizontal)
490     .LineStyle = xlContinuous
500     .Weight = xlThin
510 End With
520 For stevec = 99 To 20 Step -1
530     If sht1.Range("c" & stevec).Value = "V redu" And sht1.Range("d" & stevec).Value = "V redu" Then
540         sht1.Range("B" & stevec).EntireRow.Delete
550     End If
560 Next stevec
570 With sht1.PageSetup
580     .Zoom = False
590     .FitToPagesTall = 1
600     .FitToPagesWide = 1
610 End With
620 sht1.PrintOut
630 Application.DisplayAlerts = False
640 sht1.Delete
650 Application.DisplayAlerts = True
660 Application.ScreenUpdating = True

670 On Error GoTo 0
680 Exit Sub

izpis_napak_ipiz_Error:
690 Select Case Err.Number
    Case 13
700     MsgBox "Izpis napak na listu IPI ni mo|fffd|en,ker je(so) v" & vbCrLf & _
               "stolpcu 4f oz. 5f napaka(e) pri kontrolnih formulah!"
710     Application.DisplayAlerts = False
720     sht1.Delete
730     Application.DisplayAlerts = True
740 Case Else
750     MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri izpis_napak_ipiz v Modulu Module2"
760 End Select
End Sub
Public Sub izpis_napak_ibd()
    Dim sht As Worksheet, sht1 As Worksheet
    Dim obmocje As Range, obmocje1 As Range, obmocje2 As Range, obmocje3 As Range
    Dim stevec As Integer
10  On Error GoTo izpis_napak_ibd_Error

20  Set sht = ActiveSheet
30  Application.ScreenUpdating = False
40  Set sht1 = Worksheets.Add
50  Set obmocje = sht1.Range("b19")
60  Set obmocje1 = sht1.Range("c19")
70  Set obmocje2 = sht1.Range("d19")
80  Set obmocje3 = sht1.Range("c16")

90  Worksheets("ibd-bi").Range("a1:f14").Copy sht1.Range("A1")
100 sht1.Range("a10:c11").MergeCells = True    ' dodano
110 sht1.Range("a10:c11").WrapText = True    'dodano
120 sht1.Range("a10:c11").HorizontalAlignment = xlHAlignGeneral    ' dodano
130 Worksheets("ibd-bi").Range("d20:d37").Copy
140 sht1.Range("b20").PasteSpecial Paste:=xlPasteValues
150 Worksheets("ibd-bi").Range("h20:h37").Copy
160 sht1.Range("c20").PasteSpecial Paste:=xlPasteValues
170 Worksheets("ibd-bi").Range("j20:j37").Copy
180 sht1.Range("d20").PasteSpecial Paste:=xlPasteValues
    'sht1.Columns("b").ColumnWidth = 29
190 sht1.Columns("a").ColumnWidth = 4
200 sht1.Columns("d").ColumnWidth = 31

210 sht1.Columns("c").ColumnWidth = 31
220 sht1.Columns("f").ColumnWidth = 11
230 obmocje.Value = "AOP"
240 obmocje1.Value = "Teko|fffd|e leto"
250 obmocje2.Value = "Preteklo leto"
260 obmocje3.Value = "Izpis napak"
270 sht1.Range("a16:f16").MergeCells = True
280 sht1.Range("a16:f16").VerticalAlignment = xlVAlignCenter
290 sht1.Range("a16:f16").HorizontalAlignment = xlHAlignCenter
300 Application.ScreenUpdating = False
310 sht1.Range("a16:d37").WrapText = True
320 sht1.Range("a16:d37").VerticalAlignment = xlVAlignCenter
330 sht1.Range("a16:d37").HorizontalAlignment = xlHAlignCenter
340 With sht1.Range("a16:d19").Font
350     .Name = "Arial"
360     .Size = 12
370     .Bold = True
380 End With
390 With sht1.Range("a20:d37").Font
400     .Name = "Arial"
410     .Size = 10
420 End With
430 sht1.Range("b19:d37").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
440 With sht1.Range("b19:d37").Borders(xlInsideVertical)
450     .LineStyle = xlContinuous
460     .Weight = xlThin
470 End With
480 With sht1.Range("b19:d37").Borders(xlInsideHorizontal)
490     .LineStyle = xlContinuous
500     .Weight = xlThin
510 End With
520 For stevec = 37 To 20 Step -1
530     If sht1.Range("d" & stevec).Value = "V redu" And sht1.Range("c" & stevec).Value = "V redu" Then
540         sht1.Range("B" & stevec).EntireRow.Delete
550     End If
560 Next stevec
570 With sht1.PageSetup
580     .Zoom = False
590     .FitToPagesTall = 1
600     .FitToPagesWide = 1
610 End With
620 sht1.PrintOut
630 Application.DisplayAlerts = False
640 sht1.Delete
650 Application.DisplayAlerts = True
660 Application.ScreenUpdating = True

670 On Error GoTo 0
680 Exit Sub

izpis_napak_ibd_Error:
690 Select Case Err.Number
    Case 13
700     MsgBox "Izpis napak na listu IBD-BI ni mo|fffd|en,ker je(so) v" & vbCrLf & _
               "stolpcu 4f oz. 5f napaka(e) pri kontrolnih formulah!"
710     Application.DisplayAlerts = False
720     sht1.Delete
730     Application.DisplayAlerts = True
740 Case Else
750     MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri izpis_napak_ibd v Modulu Module2"
760 End Select
End Sub
Public Sub izpis_napak_dod()
    Dim sht As Worksheet, sht1 As Worksheet
    Dim obmocje As Range, obmocje1 As Range, obmocje2 As Range, obmocje3 As Range
    Dim stevec As Integer
10  On Error GoTo izpis_napak_dod_Error

20  Set sht = ActiveSheet
30  Application.ScreenUpdating = False
40  Set sht1 = Worksheets.Add
50  Set obmocje = sht1.Range("b21")
60  Set obmocje1 = sht1.Range("c21")
70  Set obmocje2 = sht1.Range("d21")
80  Set obmocje3 = sht1.Range("c18")

90  Worksheets("dod.bs.").Range("a1:f16").Copy sht1.Range("A1")
100 sht1.Range("a10:c11").MergeCells = True    ' dodano
110 sht1.Range("a10:c11").WrapText = True    'dodano
120 Worksheets("dod.bs.").Range("d21:d81").Copy
130 sht1.Range("b22").PasteSpecial Paste:=xlPasteValues
140 Worksheets("dod.bs.").Range("h21:h81").Copy
150 sht1.Range("c22").PasteSpecial Paste:=xlPasteValues
160 Worksheets("dod.bs.").Range("j21:j81").Copy
170 sht1.Range("d22").PasteSpecial Paste:=xlPasteValues
    'sht1.Columns("b").ColumnWidth = 29
180 sht1.Columns("a").ColumnWidth = 4
190 sht1.Columns("d").ColumnWidth = 31

200 sht1.Columns("c").ColumnWidth = 31
210 sht1.Columns("f").ColumnWidth = 11
220 obmocje.Value = "AOP"
230 obmocje1.Value = "Teko|fffd|e leto"
240 obmocje2.Value = "Preteklo leto"
250 obmocje3.Value = "Izpis napak"
260 sht1.Range("a18:f18").MergeCells = True
270 sht1.Range("a18:f18").VerticalAlignment = xlVAlignCenter
280 sht1.Range("a18:f18").HorizontalAlignment = xlHAlignCenter
290 Application.ScreenUpdating = False
300 sht1.Range("a18:d83").WrapText = True
310 sht1.Range("a18:d83").VerticalAlignment = xlVAlignCenter
320 sht1.Range("a18:d83").HorizontalAlignment = xlHAlignCenter
330 With sht1.Range("a18:d21").Font
340     .Name = "Arial"
350     .Size = 12
360     .Bold = True
370 End With
380 With sht1.Range("a22:d83").Font
390     .Name = "Arial"
400     .Size = 10
410 End With
420 sht1.Range("b21:d82").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
430 With sht1.Range("b21:d82").Borders(xlInsideVertical)
440     .LineStyle = xlContinuous
450     .Weight = xlThin
460 End With
470 With sht1.Range("b21:d82").Borders(xlInsideHorizontal)
480     .LineStyle = xlContinuous
490     .Weight = xlThin
500 End With
510 For stevec = 82 To 22 Step -1
520     If sht1.Range("c" & stevec).Value = "V redu" And sht1.Range("d" & stevec).Value = "V redu" Then
530         sht1.Range("B" & stevec).EntireRow.Delete
540     End If
550 Next stevec
560 With sht1.PageSetup
570     .Zoom = False
580     .FitToPagesTall = 1
590     .FitToPagesWide = 1
600 End With
610 sht1.PrintOut
620 Application.DisplayAlerts = False
630 sht1.Delete
640 Application.DisplayAlerts = True
650 Application.ScreenUpdating = True

660 On Error GoTo 0
670 Exit Sub

izpis_napak_dod_Error:
680 Select Case Err.Number
    Case 13
690     MsgBox "Izpis napak na listu Dod.BS ni mo|fffd|en,ker je(so) v" & vbCrLf & _
               "stolpcu 4f oz. 5f napaka(e) pri kontrolnih formulah!"
700     Application.DisplayAlerts = False
710     sht1.Delete
720     Application.DisplayAlerts = True
730 Case Else
740     MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri izpis_napak_dod v Modulu Module2"
750 End Select
End Sub

Public Sub izpis_napak_dod_ipiz()
    Dim sht As Worksheet, sht1 As Worksheet
    Dim obmocje As Range, obmocje1 As Range, obmocje2 As Range, obmocje3 As Range
    Dim stevec As Integer

10  On Error GoTo izpis_napak_dod_ipiz_Error

20  Set sht = ActiveSheet
30  Application.ScreenUpdating = False
40  Set sht1 = Worksheets.Add
50  Set obmocje = sht1.Range("b21")
60  Set obmocje1 = sht1.Range("c21")
70  Set obmocje2 = sht1.Range("d21")
80  Set obmocje3 = sht1.Range("c18")

90  Worksheets("dod.IPI").Range("a1:f16").Copy sht1.Range("A1")
100 sht1.Range("a10:c11").MergeCells = True    ' dodano
110 sht1.Range("a10:c11").WrapText = True    'dodano
120 Worksheets("dod.IPI").Range("d21:d27").Copy
130 sht1.Range("b22").PasteSpecial Paste:=xlPasteValues
140 Worksheets("dod.IPI").Range("h21:h27").Copy
150 sht1.Range("c22").PasteSpecial Paste:=xlPasteValues
160 Worksheets("dod.IPI").Range("j21:j27").Copy
170 sht1.Range("d22").PasteSpecial Paste:=xlPasteValues
    'sht1.Columns("b").ColumnWidth = 29
180 sht1.Columns("a").ColumnWidth = 4
190 sht1.Columns("d").ColumnWidth = 31

200 sht1.Columns("c").ColumnWidth = 31
210 sht1.Columns("f").ColumnWidth = 11
220 obmocje.Value = "AOP"
230 obmocje1.Value = "Teko|fffd|e leto"
240 obmocje2.Value = "Preteklo leto"
250 obmocje3.Value = "Izpis napak"
260 sht1.Range("a18:f18").MergeCells = True
270 sht1.Range("a18:f18").VerticalAlignment = xlVAlignCenter
280 sht1.Range("a18:f18").HorizontalAlignment = xlHAlignCenter
290 Application.ScreenUpdating = False
300 sht1.Range("a18:d29").WrapText = True
310 sht1.Range("a18:d29").VerticalAlignment = xlVAlignCenter
320 sht1.Range("a18:d29").HorizontalAlignment = xlHAlignCenter
330 With sht1.Range("a18:d21").Font
340     .Name = "Arial"
350     .Size = 12
360     .Bold = True
370 End With
380 With sht1.Range("a22:d29").Font
390     .Name = "Arial"
400     .Size = 10
410 End With
420 sht1.Range("b21:d28").BorderAround LineStyle:=xlContinuous, Weight:=xlThin
430 With sht1.Range("b21:d28").Borders(xlInsideVertical)
440     .LineStyle = xlContinuous
450     .Weight = xlThin
460 End With
470 With sht1.Range("b21:d28").Borders(xlInsideHorizontal)
480     .LineStyle = xlContinuous
490     .Weight = xlThin
500 End With
510 For stevec = 28 To 22 Step -1
520     If sht1.Range("c" & stevec).Value = "V redu" And sht1.Range("d" & stevec).Value = "V redu" Then
530         sht1.Range("B" & stevec).EntireRow.Delete
540     End If
550 Next stevec
560 With sht1.PageSetup
570     .Zoom = False
580     .FitToPagesTall = 1
590     .FitToPagesWide = 1
600 End With
610 sht1.PrintOut
620 Application.DisplayAlerts = False
630 sht1.Delete
640 Application.DisplayAlerts = True
650 Application.ScreenUpdating = True

660 On Error GoTo 0
670 Exit Sub

izpis_napak_dod_ipiz_Error:
680 Select Case Err.Number
    Case 13
690     MsgBox "Izpis napak na listu Dod.IPI ni mo|fffd|en,ker je(so) v" & vbCrLf & _
               "stolpcu 4f oz. 5f napaka(e) pri kontrolnih formulah!"
700     Application.DisplayAlerts = False
710     sht1.Delete
720     Application.DisplayAlerts = True
730 Case Else
740     MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri izpis_napak_dod_ipiz v Modulu Module2"
750 End Select
End Sub
Public Function DoesWorkSheetExist(WorkSheetName As String, Optional WorkBookName As Variant)
    Dim ws As Worksheet
10  On Error Resume Next
20  If WorkBookName = vbNullString Then
30      Set ws = Sheets(WorkSheetName)
40  Else
50      Set ws = Workbooks(WorkBookName).Sheets(WorkSheetName)
60  End If
70  On Error GoTo 0
80  DoesWorkSheetExist = Not ws Is Nothing
End Function
Attribute VB_Name = "Module3"

Public Function stejdec(num)

10  d = InStr(1, num, ",")
20  If d = 0 Then
30      stejdec = 0
40  Else
50      stejdec = Len(num) - d
60  End If
End Function

Public Function testtelst(vrednost As String) As Boolean    ' funkcija dodana 15.12.2004
    Dim dolzina As Integer
    Dim pozicija As Integer
    Dim znak As String
    Dim vzorec
10  dolzina = Len(vrednost)
20  For pozicija = 1 To dolzina
30      znak = Mid(vrednost, pozicija, 1)
40      vzorec = znak Like "[0-9()/, -]"
50      If vzorec = True Then
60          testtelst = True
70      Else
80          testtelst = False
90          Exit Function
100     End If

110 Next pozicija

End Function
Public Function testsifra_dr(vrednost As String) As Boolean    ' funkcija dodana 15.12.2004
    Dim dolzina As Integer
    Dim pozicija As Integer
    Dim znak As String
    Dim vzorec
10  dolzina = Len(vrednost)
20  For pozicija = 1 To dolzina
30      znak = Mid(vrednost, pozicija, 1)
40      vzorec = znak Like "[0-9]"
50      If vzorec = True Then
60          testsifra_dr = True
70      Else
80          testsifra_dr = False
90          Exit Function
100     End If

110 Next pozicija

End Function
Public Sub izpis_poj()
    Dim zadnja As Long
    Dim tekst As Variant
    Dim sht As Worksheet
    Dim sht1 As Worksheet, sht2 As Worksheet, sht3 As Worksheet
    Dim temp_pot As String
    Dim myLastRow As Long
    Dim dummyRng As Range
    Dim myLastCol As Long
10  temp_pot = temp_mapa()
    Dim ime_datoteke As String
    Dim zadnja_vrst As Long
20  ime_datoteke = temp_pot & "izpis_poj.txt"
30  On Error GoTo izpis_poj_Error
40  Set sht1 = Worksheets("Pojasnila")
50  Set sht2 = Worksheets("bs")
60  tekst = sht1.OLEObjects("TextBox1").Object.Text
70  Application.ScreenUpdating = False
80  Set sht = Worksheets("Izpis_pojasnil")
90  Open ime_datoteke For Output As #1    'prepis vsebine tekstovnih oken v zacasno txt datoteko
100 Print #1, tekst
110 Close #1
    '    sht.Activate

120 With sht
130     myLastRow = 0
140     myLastCol = 0
150     Set dummyRng = .UsedRange
160     On Error Resume Next
170     myLastRow = _
        .Cells.Find("*", after:=.Cells(1), _
                    LookIn:=xlFormulas, lookat:=xlWhole, _
                    searchdirection:=xlPrevious, _
                    searchorder:=xlByRows).Row
180     myLastCol = _
        .Cells.Find("*", after:=.Cells(1), _
                    LookIn:=xlFormulas, lookat:=xlWhole, _
                    searchdirection:=xlPrevious, _
                    searchorder:=xlByColumns).Column
190     On Error GoTo 0
        '        Debug.Print myLastRow, myLastCol
200     dummyRng.ClearContents
        '        If myLastRow * myLastCol = 0 Then
        '        .Columns.Delete
        '    Else
210     .Range(.Cells(myLastRow + 1, 1), _
               .Cells(.Rows.Count, 1)).EntireRow.Delete
        '           End If
220 End With
230 sht.Columns("a").ColumnWidth = 12
240 sht.Columns("b").ColumnWidth = 3
250 sht.Columns("c").ColumnWidth = 36
260 sht.Columns("d").ColumnWidth = 8
270 sht.Columns("e").ColumnWidth = 8
280 sht.Columns("f").ColumnWidth = 24
290 sht.Columns("g").ColumnWidth = 17
300 sht2.Range("a1:c15").Copy sht.Range("A1")
310 sht2.Range("d1:f15").Copy sht.Range("e1")
320 sht.Range("G10").Value = sht.Range("G11").Value
330 sht.Range("G11").Value = ""
340 ColNdx = 1
350 RowNdx = 19    ' popravljeno 16.03.05 v.2.4
360 Fname = ime_datoteke
370 Open Fname For Input Access Read As #1
380 While Not EOF(1)
390     Line Input #1, WholeLine
400     sht.Cells(RowNdx, 1).Value = WholeLine
410     RowNdx = RowNdx + 1
420 Wend
430 Close #1
    'sht.Range("e9:f10").MergeCells = True
    'sht.Range("a16:F16").MergeCells = True
440 sht.Range("d17").Value = "Pojasnila k izkazom"
450 sht.Range("d17").HorizontalAlignment = xlHAlignCenter
460 With sht.Range("d17").Font
470     .Name = "Arial"
480     .Bold = True
490     .Size = 14
500 End With
510 With sht.Range("F3:G11").Font
520     .Name = "Arial"
530     .Size = 11
540 End With
    'sht.PageSetup.CenterHorizontally = True
550 myLastRow = _
    sht.Cells.Find("*", after:=sht.Cells(1), _
                   LookIn:=xlFormulas, lookat:=xlWhole, _
                   searchdirection:=xlPrevious, _
                   searchorder:=xlByRows).Row
    '    Debug.Print myLastRow
560 sht.Range("D" & myLastRow + 3).Value = "Vodja poslovnega subjekta:"
570 sht.Range("D" & myLastRow + 5).Value = sht1.Range("c65").Value
580 zadnja_vrst = myLastRow + 5
590 With sht.Range("A19:g" & zadnja_vrst).Font
600     .Name = "Arial"
610     .Size = 13
620 End With
630 With sht.PageSetup
640     .Zoom = False
650     .FitToPagesWide = 1
660     .FitToPagesTall = 2
670 End With
    '    sht.PrintOut
    'Application.DisplayAlerts = False
680 Application.ScreenUpdating = True
690 On Error GoTo 0
700 Exit Sub
izpis_poj_Error:
710 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri izpis_poj v modulu Module3"

End Sub

Attribute VB_Name = "Module4"
Option Explicit
#If Win64 Then
    Private Declare PtrSafe Function GetTempPath Lib "kernel32" Alias "GetTempPathA" _
            (ByVal nBufferLength As LongPtr, ByVal lpBuffer As String) As Long

    Private Declare PtrSafe Function GetLongPathName Lib "kernel32" Alias "GetLongPathNameA" _
            (ByVal lpszShortPath As String, ByVal lpszLongPath As String, _
             ByVal cchBuffer As LongPtr) As Long
#Else
    Private Declare Function GetTempPath Lib "kernel32" Alias "GetTempPathA" _
                                         (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long

    Private Declare Function GetLongPathName Lib "kernel32" Alias "GetLongPathNameA" _
                                             (ByVal lpszShortPath As String, ByVal lpszLongPath As String, _
                                              ByVal cchBuffer As Long) As Long
#End If

Public Function stringtonumber(vrednost As String)
10  stringtonumber = CLng(vrednost)
End Function
Public Function temp_mapa()

    Dim TempPath As String
    Dim dolgo_ime As String
    Dim temp_dir_dolg As String
    Dim l As Long
    Dim y As Long
    Dim temp_ime As String
10  dolgo_ime = String(255, " ")
20  TempPath = String(255, " ")
30  l = GetTempPath(Len(TempPath), TempPath)
40  temp_ime = Left(TempPath, l)
50  y = GetLongPathName(temp_ime, dolgo_ime, 255)
60  temp_dir_dolg = Left(dolgo_ime, y)

70  temp_mapa = temp_dir_dolg
End Function
Public Function brez_desnih_presled(niz As Variant) As Variant
    brez_desnih_presled = RTrim(niz)
End Function
Attribute VB_Name = "Module5"
Option Explicit

Private Sub SaveWsOnFile(IzbranoImeIzhodneDatoteke As String)

    Dim str, Fmt, FmtStr, TmpStr
    Dim LineCnt As Integer
    Dim ColCnt As Integer
    Dim LineOut

10  On Error GoTo SaveWsOnFile_Error

20  Open UCase(IzbranoImeIzhodneDatoteke) For Output As #1
30  LineCnt = 0
40  ColCnt = 0
50  LineOut = ""
60  Do While Not (IsEmpty(Range("A1").Offset(LineCnt, 0)))
70      TmpStr = Range("A1").Offset(LineCnt, ColCnt).Value
80      str = Trim(Range("A1").Offset(LineCnt, ColCnt).Value)
90      Fmt = Range("A1").Offset(LineCnt, ColCnt).NumberFormat
100     FmtStr = ""
110     If str <> "" Then
120         If Left(Fmt, 2) = "h:" Or Left(Fmt, 3) = "hh:" _
               Then
130             FmtStr = Format(str, "hh:mm:ss")
                '            Else
                '                 If Left(Fmt, 10) = "dd/mm/yyyy" _
                                  '                 Then
                '                    If Str = "0:00:00" Then
                '                        FmtStr = "0"
                '                    Else
                '                        FmtStr = Format(Str, "dd.mm.yyyy")
                '                    End If
                '                 End If
140         Else
150             If LineCnt = 211 Then
160                 FmtStr = Application.WorksheetFunction.Substitute(str, ",", ".")
170             End If

180         End If

190         If (FmtStr <> "") Then
200             LineOut = LineOut + FmtStr
210         Else
220             LineOut = LineOut + str
230         End If
240     End If
250     If (ColCnt < 5) Then
260         ColCnt = ColCnt + 1
270     Else
280         Print #1, LineOut
290         ColCnt = 0
300         LineCnt = LineCnt + 1
310         LineOut = ""
320     End If
330 Loop
340 Close #1

350 On Error GoTo 0
360 Exit Sub

SaveWsOnFile_Error:

370 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri SaveWsOnFile v VBA Document ThisWorkbook"
End Sub


Public Sub Shrani_Klikni()
    Dim ImeXlsDatoteke
    Dim ImeIzhodneDatoteke, IzbranoImeIzhodneDatoteke, filter
    Dim MatStr
    Dim DateTimeStr As String
    Dim AkcijaStr
    Dim Msg, Style, Title, Help, Ctxt, Response, MyString
10  On Error GoTo Shrani_Klikni_Error
20  filter = "XML datoteke (*.xml),*.xml)"
    ' Define message
30  Msg = "Izvedene bodo naslednje akcije:" & vbCrLf & vbCrLf _
        & "1. Shranjevanje preglednice (XLS datoteke)" & vbCrLf _
        & "2. Priprava in shranjevanje datoteke za AJPES (XML datoteke)" & vbCrLf _
        & "3. Vrnitev na trenutni list preglednice" & vbCrLf & vbCrLf _
        & "|fffd|elite nadaljevati ?"
40  Style = vbYesNo + vbQuestion    ' Define buttons.
50  Title = "Shranjevanje preglednice ...."    ' Define title.
60  Help = ""    ' Define Help file.
70  Ctxt = 1000    ' Define topic
    ' context.
    ' Display message.
80  If Left(Sheets("Status_vnosa").Range("NAPAKE_SKUPAJ").Value, 5) <> "NAPAK" Or _
       (StrConv(Sheets("Status_vnosa").Range("FORSIRAJ").Value, vbUpperCase) = "Z NAPAKAMI") _
       Then
        '
        '       Najprej shranimo XLS datoteko
        '
90      Response = MsgBox(Msg, Style, Title, Help, Ctxt)
100     If Response = vbYes Then    ' User chose Yes.
110         ImeXlsDatoteke = ActiveWorkbook.FullName
            '        MsgBox ImeDatoteke
120         ActiveWorkbook.Save
            '
            '       Sestavimo ime izhodne datoteke
            '
130         MatStr = Sheets("Osnovni podatki").Range("c21").Value
140         DateTimeStr = Format(Now(), "_yyyymmdd_hhmmss")
150         If Left(Sheets("Status_vnosa").Range("NAPAKE_SKUPAJ").Value, 5) = "NAPAK" _
               Then
160             ImeIzhodneDatoteke = "LPGD_" & MatStr & DateTimeStr & "_NAPAKE" & ".xml"
170         Else
180             ImeIzhodneDatoteke = "LPGD_" & MatStr & DateTimeStr & ".xml"
190         End If
200         Msg = "Ime XML datoteke se kreira avtomati|fffd|no." & vbCrLf & vbCrLf _
                & "Prosimo,da ga ne spreminjate!"
210         Style = vbInformation    ' Define buttons.
220         Title = "Shranjevanje XML datoteke.."    ' Define title.
230         Response = MsgBox(Msg, Style, Title, Help, Ctxt)
240         IzbranoImeIzhodneDatoteke = Application.GetSaveAsFilename(ImeIzhodneDatoteke, filter)
250         If (IzbranoImeIzhodneDatoteke <> False) Then
260             Application.ScreenUpdating = False     ' Disable screen flickering
270             Sheets("XML").Select
280             If Not naredi_xml(IzbranoImeIzhodneDatoteke) = False Then
290                 Sheets("Status_vnosa").Select
300                 Range("A14").Select
310                 Application.ScreenUpdating = True     ' Enable it again
320                 Msg = "Datoteka:" & IzbranoImeIzhodneDatoteke & vbCrLf _
                        & "je bila shranjena! To je datoteka za prenos na AJPES!"
330                 Style = vbInformation    ' Define buttons.
340                 Title = "Datoteka shranjena"    ' Define title.
350                 Response = MsgBox(Msg, Style, Title, Help, Ctxt)
360             Else
370                 Sheets("Status_vnosa").Select
380                 Range("A14").Select
390                 Msg = "Priprava XML datoteke ni bila uspe|fffd|na!"
400                 Style = vbCritical    ' Define buttons.
410                 Title = "Priprava ni mo|fffd|na"    ' Define title.
420                 Response = MsgBox(Msg, Style, Title, Help, Ctxt)
430                 Exit Sub
440             End If
450         End If
460     Else    ' User chose No.
470         Msg = "Preglednica NI shranjena in datoteka za AJPES NI pripravljena!"
480         Style = vbExclamation    ' Define buttons.
490         Title = "Preglednica ni shranjena"    ' Define title.
500         Response = MsgBox(Msg, Style, Title, Help, Ctxt)
510     End If
520 Else
530     Msg = "Priprava in shranjevanje datoteke za AJPES NI mo|fffd|no, ker so v podatkih napake!"
540     Style = vbCritical    ' Define buttons.
550     Title = "Priprava ni mo|fffd|na"    ' Define title.
560     Response = MsgBox(Msg, Style, Title, Help, Ctxt)
570 End If

580 On Error GoTo 0
590 Exit Sub

Shrani_Klikni_Error:

600 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri Shrani_Klikni v modulu Module5"

End Sub



Public Sub TiskajObrazce()
'
' TiskajObrazce Makro
' Makro ustvaril: Marjan, dne 24.11.2002
'
' Bli|fffd|njica: Ctrl+Shift+P
'
    Dim Help, Ctxt, Style, Title, Response
    Dim Msg, status_poj
    Dim sht As Worksheet, sht1 As Worksheet
10  On Error GoTo TiskajObrazce_Error
20  Set sht = Worksheets("XML")
30  Set sht1 = Worksheets("Status_vnosa")
40  status_poj = sht1.Range("c30").Value
50  Help = ""    ' Define Help file.
60  Ctxt = 1000    ' Define topic
70  If (Sheets("Status_vnosa").Range("NAPAKE_SKUPAJ").Value = "NAPAKA(E)") Then
80      Msg = "Obrazci |fffd|e vedno vsebujejo napake." & vbCrLf & _
              "Nadaljujem s tiskanjem vseh izpolnjenih obrazcev?"
90  Else
100     Msg = "Nadaljujem?"
110 End If
120 Style = vbYesNo + vbInformation + vbDefaultButton2    ' Define buttons.
130 Title = "Izpis obrazcev"    ' Define title.
140 Response = MsgBox(Msg, Style, Title, Help, Ctxt)
150 If Response = vbYes Then    ' User chose Yes.
        '        If Val(Application.Version) > 8 Then
        '
        '            Call izpis_md5
        '        End If
160     Application.ScreenUpdating = False     ' Disable screen flickering
        ' izpi|fffd|i obrazce
170     Worksheets("Osnovni podatki").Activate
180     ActiveSheet.PrintOut
190     Worksheets("BS").Activate
200     ActiveSheet.PrintOut
210     Worksheets("IPI").Activate
220     ActiveSheet.PrintOut
230     Worksheets("IBD-BI").Activate
240     ActiveSheet.PrintOut
250     Worksheets("Opredelitev").Activate
260     ActiveSheet.PrintOut
270     Worksheets("Dod.bs.").Activate
280     If (ActiveSheet.Range("Dodatni_podatki").Value = "") _
           Then
290         ActiveSheet.PrintOut
300     End If
310     Worksheets("Dod.IPI").Activate
320     If (ActiveSheet.Range("h16").Value = "") _
           Then
330         ActiveSheet.PrintOut
340     End If
350     Worksheets("Izjava").Activate
360     If (Left(StrConv(ActiveSheet.Range("Izjava_opredelitev").Value, vbUpperCase), 2) = "DA" And _
            ActiveSheet.Range("Izjava_status").Value <> "<- Vrednost NI DA ali NE") _
            Then
370         ActiveSheet.PrintOut
380     End If
        'Worksheets("Soglasje").Activate
        'If (Left(StrConv(ActiveSheet.Range("Soglasje_opredelitev").Value, vbUpperCase), 2) = "DA" And _
         '  ActiveSheet.Range("Soglasje_status").Value = "V redu") _
         'Then
        '  ActiveSheet.PrintOut
        'End If
390     If sht.Range("b33").Value = 1 And status_poj = 0 Then
400         Call izpis_poj
410         Worksheets("Izpis_pojasnil").Activate
420         ActiveSheet.PrintOut
430     End If
440     sht1.Activate
450     sht1.Range("a15").Select
        'ActiveSheet.PrintOut
460     Application.ScreenUpdating = True
470 End If

480 On Error GoTo 0
490 Exit Sub

TiskajObrazce_Error:

500 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri TiskajObrazce v modulu Module5"
End Sub
Public Function RDB_Create_PDF(Myvar As Object, FixedFilePathName As String, _
                               OverwriteIfFileExist As Boolean, OpenPDFAfterPublish As Boolean) As String
    Dim FileFormatstr As String
    Dim Fname As Variant
    'Test to see if the Microsoft Create/Send add-in is installed.
    If Dir(Environ("commonprogramfiles") & "\Microsoft Shared\OFFICE" _
         & Format(Val(Application.Version), "00") & "\EXP_PDF.DLL") <> "" Then
        If FixedFilePathName = "" Then
            'Open the GetSaveAsFilename dialog to enter a file name for the PDF file.
            FileFormatstr = "PDF Files (*.pdf), *.pdf"
            Fname = Application.GetSaveAsFilename("", filefilter:=FileFormatstr, _
                                                  Title:="Ustvari PDF")
            'If you cancel this dialog, exit the function.
            If Fname = False Then Exit Function
        Else
            Fname = FixedFilePathName
        End If
        'If OverwriteIfFileExist = False then test to see if the PDF
        'already exists in the folder and exit the function if it does.
        If OverwriteIfFileExist = False Then
            If Dir(Fname) <> "" Then Exit Function
        End If
        'Now export the PDF file.
        On Error Resume Next
        Myvar.ExportAsFixedFormat _
                Type:=xlTypePDF, _
                FileName:=Fname, _
                Quality:=xlQualityStandard, _
                IncludeDocProperties:=True, _
                IgnorePrintAreas:=False, _
                OpenAfterPublish:=OpenPDFAfterPublish
        On Error GoTo 0
        'If the export is successful, return the file name.
        If Dir(Fname) <> "" Then RDB_Create_PDF = Fname
    End If
End Function
Public Sub shrani_pdf()
    Dim sht As Worksheet, sht1 As Worksheet, sht2 As Worksheet
    Dim FileName As String, status_poj, objole As Excel.OLEObject
    Dim cb_h, cb_w, cb_t, cb_l
10  On Error GoTo shrani_pdf_Error

20  Set sht = Worksheets("xml")
30  Set sht1 = Worksheets("Status_vnosa")
40  Set sht2 = Worksheets("Osnovni podatki")
50  For Each objole In sht2.OLEObjects
60      If objole.progID = "Forms.ComboBox.1" Then
70          With objole
80              cb_h = .Height
90              cb_w = .Width
100             cb_t = .Top
110             cb_l = .Left
120         End With
130     End If
140 Next objole
150 status_poj = sht1.Range("c30").Value
160 If Val(Application.Version) > 11 Then
170     Application.ScreenUpdating = False
180     If sht.Range("b33").Value = 1 And status_poj = 0 Then
190         Call izpis_poj
200         Sheets(Array("Osnovni podatki", "BS", "IPI", "IBD-BI", "Dod.BS.", "Dod.IPI", "Opredelitev", "Izjava", "Izpis_pojasnil")).Select
210         Sheets("Opredelitev").Activate
220     Else
230         Sheets(Array("Osnovni podatki", "BS", "IPI", "IBD-BI", "Dod.BS.", "Dod.IPI", "Opredelitev", "Izjava")).Select
240         Sheets("Opredelitev").Activate
250     End If
        '    If ActiveWindow.SelectedSheets.Count > 1 Then
        '        MsgBox "There is more than one sheet selected," & vbNewLine & _
                 '               "and every selected sheet will be published."
        '    End If
        'Call the function with the correct arguments.
        'You can also use Sheets("Sheet3") instead of ActiveSheet in the code(the sheet does not need to be active then).
260     FileName = RDB_Create_PDF(ActiveSheet, "", False, True)
        'For a fixed file name and to overwrite it each time you run the macro, use the following statement.
        'RDB_Create_PDF(ActiveSheet, "C:\Users\Ron\Test\YourPdfFile.pdf", True, True)
270     If FileName <> "" Then
            'Uncomment the following statement if you want to send the PDF by e-mail.
            'RDB_Mail_PDF_Outlook FileName, "ron@debruin.nl", "This is the subject", _
             "See the attached PDF file with the last figures" _
             & vbNewLine & vbNewLine & "Regards Ron de bruin", False
280     Else
290         Application.ScreenUpdating = True
300         MsgBox "Ni mo|fffd|no ustvariti PDF datoteke. Mo|fffd|ni vzroki:" & vbNewLine & _
                   "Dodatek Microsoft Save as PDF ni name|fffd||fffd|en (za Microsoft Office 2007)." & vbNewLine & _
                   "Prekinili ste Shrani kot dialog." & vbNewLine & _
                   "Datoteka z istim imenom |fffd|e obstaja."
310     End If
320     If Val(Application.Version) = 14 Or Val(Application.Version) = 15 Then
330         Sheets("BS").Activate
340         Sheets("BS").Range("e31").Select
350         ActiveWindow.View = xlPageBreakPreview
360         ActiveWindow.View = xlNormalView
370         Sheets("IPI").Activate
380         Sheets("IPI").Range("e22").Select
390         ActiveWindow.View = xlPageBreakPreview
400         ActiveWindow.View = xlNormalView
410         Sheets("IBD-BI").Activate
420         Sheets("ibd-bi").Range("e20").Select
430         ActiveWindow.View = xlPageBreakPreview
440         ActiveWindow.View = xlNormalView
450         Sheets("Dod.BS.").Activate
460         Sheets("Dod.BS.").Range("e22").Select
470         ActiveWindow.View = xlPageBreakPreview
480         ActiveWindow.View = xlNormalView
490         Sheets("Dod.IPI").Activate
500         Sheets("Dod.IPI").Range("e22").Select
510         ActiveWindow.View = xlPageBreakPreview
520         ActiveWindow.View = xlNormalView
530         Sheets("opredelitev").Activate
540         Sheets("opredelitev").Range("a11").Select
550         ActiveWindow.View = xlPageBreakPreview
560         ActiveWindow.View = xlNormalView
570     End If
580     Sheets("Status_vnosa").Activate
590     sht1.Range("A15").Select
600     For Each objole In sht2.OLEObjects
610         If objole.progID = "Forms.ComboBox.1" Then
620             With objole
630                 .Height = cb_h
640                 .Width = cb_w
650                 .Left = cb_l
660                 .Top = cb_t
670             End With
680         End If
690     Next objole
700     Application.ScreenUpdating = True
710 Else
        '    Sheets("Status_vnosa").Activate
720     MsgBox "Va|fffd|a verzija Excela ne podpira shranjevanja v pdf."
730     sht1.Range("A15").Select
740     Exit Sub
750 End If

760 On Error GoTo 0
770 Exit Sub

shrani_pdf_Error:

780 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri shrani_pdf v Modulu Module5"
End Sub
Attribute VB_Name = "Module6"
Option Explicit


Public Sub Popravi_gumbe_velikost()
    Dim opb1 As Shape, opb2 As Shape, opb3 As Shape, opb4 As Shape, opb6 As Shape
    Dim opb7 As Shape, opb8 As Shape, opb9 As Shape, opb10 As Shape, opb11 As Shape, opb12 As Shape
    Dim opb13 As Shape, opb14 As Shape, opb15 As Shape, opb16 As Shape, opb17 As Shape, opb18 As Shape
    Dim opb19 As Shape, opb20 As Shape, opb21 As Shape, opb22 As Shape, opb23 As Shape, opb24 As Shape
    Dim opb25 As Shape, opb26 As Shape, opbvelik As Shape, opb27 As Shape, opb28 As Shape, opb29 As Shape
    Dim opb30 As Shape, opb31 As Shape, opb32 As Shape, opb33 As Shape, opb34 As Shape, opb35 As Shape, opb36 As Shape
    Dim opb37 As Shape, opb38 As Shape, opb39 As Shape, opb40 As Shape, opb41 As Shape, opb42 As Shape, opb43 As Shape
    Dim opb44 As Shape, opb45 As Shape, opb46 As Shape, opb47 As Shape, opb48 As Shape
    Dim cmb1 As Shape, cmb2 As Shape, cmb3 As Shape
    Dim cmb4 As Shape, cmb5 As Shape, cmb6 As Shape, cb1 As Shape, cb2 As Shape, cb3 As Shape, cb4 As Shape, cb5 As Shape, cb6 As Shape
    Dim objole As Excel.OLEObject, cb As MSForms.OptionButton, objo As Excel.OLEObject
    Dim ws As Worksheet, ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet
    Dim ws4 As Worksheet, ws5 As Worksheet, ws6 As Worksheet
    On Error GoTo Popravi_gumbe_velikost_Error

    Set ws = Worksheets("Opredelitev")
    Set ws1 = Worksheets("BS")
    Set ws2 = Worksheets("IPI")
    Set ws3 = Worksheets("Dod.BS.")
    Set ws4 = Worksheets("Dod.IPI")
    Set ws5 = Worksheets("IBD-BI")
    Set ws6 = Worksheets("Osnovni podatki")
    Set cb1 = ws1.Shapes("Button 65")    ' bs list gumb izpis napak
    Set cb2 = ws1.Shapes("Button 162")    ' uvoz podatkov
    Set cb3 = ws2.Shapes("Button 30")    ' list IPI
    Set cb4 = ws3.Shapes("Button 8")    ' list dod.bs
    Set cb5 = ws4.Shapes("Button 15")    ' list dod.IPI.
    Set cb6 = ws5.Shapes("Button 85")    ' list ibd-bi
    Set opb1 = ws.Shapes("OptionButton1")
    Set opb2 = ws.Shapes("OptionButton2")
    Set opb3 = ws.Shapes("OptionButton3")
    Set opb4 = ws.Shapes("OptionButton4")
    Set opb6 = ws.Shapes("OptionButton6")
    Set opb7 = ws.Shapes("OptionButton7")
    Set opb8 = ws.Shapes("OptionButton8")
    Set opb9 = ws.Shapes("OptionButton9")
    Set opb10 = ws.Shapes("OptionButton10")
    Set opb11 = ws.Shapes("OptionButton11")
    Set opb12 = ws.Shapes("OptionButton12")
    Set opb13 = ws.Shapes("OptionButton13")
    Set opb14 = ws.Shapes("OptionButton14")
    Set opb15 = ws.Shapes("OptionButton15")
    Set opb16 = ws.Shapes("OptionButton16")
    Set opb17 = ws.Shapes("OptionButton17")
    Set opb18 = ws.Shapes("OptionButton18")
    Set opb19 = ws.Shapes("OptionButton19")
    Set opb20 = ws.Shapes("OptionButton20")
    Set opb21 = ws.Shapes("OptionButton21")
    Set opb22 = ws.Shapes("OptionButton22")
    Set opb23 = ws.Shapes("OptionButton23")
    Set opb24 = ws.Shapes("OptionButton24")
    Set opb25 = ws.Shapes("OptionButton25")
    Set opb26 = ws.Shapes("OptionButton26")
    Set opbvelik = ws.Shapes("opbvelikost_velika")
    Set opb27 = ws.Shapes("OptionButton27")
    Set opb28 = ws.Shapes("OptionButton28")
    Set opb29 = ws.Shapes("OptionButton29")
    Set opb30 = ws.Shapes("OptionButton30")
    Set opb31 = ws.Shapes("OptionButton31")
    Set opb32 = ws.Shapes("OptionButton32")
    Set opb33 = ws.Shapes("OptionButton33")
    Set opb34 = ws.Shapes("OptionButton34")
    Set opb35 = ws.Shapes("OptionButton35")
    Set opb36 = ws.Shapes("OptionButton36")
    Set opb37 = ws.Shapes("OptionButton37")
    Set opb38 = ws.Shapes("OptionButton38")
    Set opb39 = ws.Shapes("OptionButton39")
    Set opb40 = ws.Shapes("OptionButton40")
    Set opb41 = ws.Shapes("OptionButton41")
    Set opb42 = ws.Shapes("OptionButton42")
    Set opb43 = ws.Shapes("OptionButton43")
    Set opb44 = ws.Shapes("OptionButton44")
    Set opb45 = ws.Shapes("OptionButton45")
    Set opb46 = ws.Shapes("OptionButton46")
    Set opb47 = ws.Shapes("OptionButton47")
    Set opb48 = ws.Shapes("OptionButton48")
    Set cmb1 = ws.Shapes("ComboBox1")
    Set cmb2 = ws.Shapes("ComboBox2")
    Set cmb3 = ws.Shapes("ComboBox3")
    Set cmb4 = ws.Shapes("ComboBox4")
    Set cmb5 = ws.Shapes("ComboBox5")
    Set cmb6 = ws6.Shapes("ComboBox1")
    'popravek pozicije in velikosti izbirnih gumbov
    If Not opb1.Left = 537 Then
        For Each objole In ws.OLEObjects
            If TypeOf objole.Object Is MSForms.OptionButton Then
                Set cb = objole.Object
                Dim ime_skupine
                ime_skupine = cb.GroupName
                If Not Left(ime_skupine, 10) = "poslovanje" Then
                    With cb
                        .Height = 15.75
                        .Width = 18.75
                        .Left = 537
                    End With
                End If
                If Left(ime_skupine, 10) = "poslovanje" Then
                    If Right(cb.Name, 2) <= 43 Then
                        With cb
                            .Height = 19.5
                            .Width = 63.75
                            .Left = 506.25
                        End With
                    Else
                        With cb
                            .Height = 19.5
                            .Width = 63.75
                            .Left = 431.25
                        End With
                    End If
                End If
                '                With objole
                '                    'opb.Top = 268.5
                '                    'opb.Left = 537
                '                    .Height = 15.75
                '                    .Width = 18.75
                '                    .Left = 537
                '                End With
            End If
        Next objole
        opb1.Top = 268.5
        opb10.Top = 587.25
        opb11.Top = 751.5
        opb12.Top = 768
        opb13.Top = 830.25
        opb14.Top = 847.5
        opb15.Top = 862.5
        opb16.Top = 892.5
        opb17.Top = 987.75
        opb18.Top = 1077.75
        opb19.Top = 1183.5
        opb2.Top = 285
        opb20.Top = 1200.75
        opb21.Top = 1216.5
        opb22.Top = 1361.25
        opb23.Top = 1437
        opb24.Top = 1540.5
        opb25.Top = 1554.75
        opb26.Top = 1572.75
        opb27.Top = 383.25
        opb28.Top = 399.75
        opb29.Top = 619.5
        opb3.Top = 301.5
        opb30.Top = 636
        opb31.Top = 669
        opb32.Top = 685.5
        opb33.Top = 718.5
        opb34.Top = 735
        opb35.Top = 1249.5
        opb36.Top = 1266
        opb37.Top = 1299
        opb38.Top = 1315.5
        opb39.Top = 1639.5
        opb4.Top = 318.75
        opb40.Top = 1668
        opb41.Top = 1696.5
        opb42.Top = 1725
        opb43.Top = 1753.5
        opb44.Top = 1639.5
        opb45.Top = 1668
        opb46.Top = 1696.5
        opb47.Top = 1725
        opb48.Top = 1753.5
        opb6.Top = 333
        opb7.Top = 350.25
        opb8.Top = 444.75
        opb9.Top = 461.25
        opbvelik.Top = 786

    End If
    'popravek pozicije in velikosti comboboxov
    If Not cmb6.Left = 247.5 Then
        With cmb1
            .Height = 18
            .Width = 172.5
            .Left = 324
            .Top = 963
        End With
        With cmb2
            .Height = 18
            .Width = 172.5
            .Left = 323.25
            .Top = 1063.5
        End With
        With cmb3
            .Height = 18
            .Width = 172.5
            .Left = 323.25
            .Top = 1140
        End With
        With cmb4
            .Height = 18
            .Width = 172.5
            .Left = 323.25
            .Top = 1424.25
        End With
        With cmb5
            .Height = 18
            .Width = 172.5
            .Left = 323.25
            .Top = 1499.25
        End With
        With cmb6
            .Height = 16.5
            .Width = 285
            .Left = 247.5
            .Top = 513.75
        End With
    End If
    'popravek pozicije in velikosti ukaznih gumbov
    If Not cb3.Left = 659.25 Then
        With cb1
            .Height = 29.25
            .Width = 170.25
            .Left = 747
            .Top = 206.25
        End With
        With cb2
            .Height = 33
            .Width = 170.25
            .Left = 747
            .Top = 258
        End With
        With cb3
            .Height = 26.25
            .Width = 155.25
            .Left = 659.25
            .Top = 182.75
        End With
        With cb4
            .Height = 28.5
            .Width = 153.75
            .Left = 774.75
            .Top = 153.75
        End With
        With cb5
            .Height = 26.25
            .Width = 147
            .Left = 645
            .Top = 157.5
        End With
        With cb6
            .Height = 30.75
            .Width = 132
            .Left = 609
            .Top = 173.25
        End With
    End If

    On Error GoTo 0
    Exit Sub

Popravi_gumbe_velikost_Error:

    MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri Popravi_gumbe_velikost v modulu  Module6"
End Sub
Public Function razdeli_tekst_vrstice(obm As Excel.Range, delim As Variant)
'Tekst pojasnil se razbije po vrsticah, doda html oznaka za novo vrstico
    Dim TempArr As Variant, i As Long, vrstica, besedilo
    On Error GoTo razdeli_tekst_vrstice_Error

10  besedilo = ""
20  TempArr = Split(obm.Value, delim)
30  For i = 0 To UBound(TempArr)
40      vrstica = TempArr(i)
50      vrstica = vrstica & "<br>"
60      besedilo = besedilo & vrstica & vbCrLf
70  Next i
80  razdeli_tekst_vrstice = besedilo
90  Erase TempArr

    On Error GoTo 0
    Exit Function

razdeli_tekst_vrstice_Error:

    MsgBox "Error " & Err.Number & " (" & Err.Description & ") v funkciji razdeli_tekst_vrstice v modulu Module6"
End Function


Sub CenterOptionButtons()
    Const Fudge = 7
    Dim opt, i
    Dim rng As Range, ws As Worksheet, objo As Excel.OLEObject
    Set ws = Worksheets("opredelitev")
    For Each objo In ws.OLEObjects
        If objo.progID = "Forms.OptionButton.1" Then
            'opt.Characters.Text = ""
            Set rng = objo.TopLeftCell
            objo.Top = rng.Top
            objo.Height = rng.Height
            'objo.Height = 15.75
            objo.Left = rng.Left + rng.Width / 2 - Fudge
            objo.Width = rng.Width / 2 + Fudge
            'Debug.Print objo.Name, rng.Address, objo.Top, objo.Left, objo.Width, objo.Height
        End If
    Next objo
End Sub
Public Sub MergedAreaRowAutofit()
    Dim j As Long
    Dim n As Long
    Dim i As Long
    Dim MW As Double    'merge width
    Dim RH As Double    'row height
    Dim MaxRH As Double
    Dim rngMArea As Range
    Dim rng As Range, sht As Worksheet
10  On Error GoTo MergedAreaRowAutofit_Error

20  Set sht = Worksheets("Bs")
    Const SpareCol As Long = 40
30  Set rng = sht.Range("vnos_razkritij")
    '    Application.ScreenUpdating = False
40  sht.Unprotect Password:="nuladva"
50  With rng
60      For j = 1 To 5
            'if the row is not hidden
70          If Not .Parent.Rows(.Cells(j, 1).Row).Hidden Then
                'if the cells have data
80              If Application.WorksheetFunction.CountA(.Rows(j)) Then
90                  MaxRH = 0
100                 For n = .Columns.Count To 1 Step -1
110                     If Len(.Cells(j, n).Value) Then
                            'mergecells
120                         If .Cells(j, n).MergeCells Then
130                             Set rngMArea = .Cells(j, n).MergeArea
140                             With rngMArea
150                                 MW = 0
160                                 If .WrapText Then
                                        'get the total width
170                                     For i = 1 To .Cells.Count
180                                         MW = MW + .Columns(i).ColumnWidth
190                                     Next
200                                     MW = MW + .Cells.Count * 0.66
                                        'use the spare column and put the value, make autofit, get the row height
210                                     With .Parent.Cells(.Row, SpareCol)
220                                         .Value = rngMArea.Value
230                                         .ColumnWidth = MW
240                                         .WrapText = True
250                                         .EntireRow.AutoFit
260                                         RH = .RowHeight
270                                         MaxRH = Application.Max(RH, MaxRH)
280                                         .Value = vbNullString
290                                         .WrapText = False
300                                         .ColumnWidth = 8.43
310                                     End With
320                                     If Not MaxRH < 33.8 Then
330                                         .RowHeight = MaxRH
340                                     Else
350                                         .RowHeight = 33.8
360                                     End If
370                                 End If
380                             End With
390                         End If
400                     End If
410                 Next
420             End If
430         End If
440     Next
450 End With
    '    Application.ScreenUpdating = True
460 sht.Protect Password:="nuladva"

470 On Error GoTo 0
480 Exit Sub

MergedAreaRowAutofit_Error:

490 MsgBox "Napaka " & Err.Number & " v vrstici:" & Erl & " (" & Err.Description & ") v proceduri MergedAreaRowAutofit v Modulu Module6"
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
'Call Popravi_gumbe_velikost
End Sub


INQUEST-PP=macro
