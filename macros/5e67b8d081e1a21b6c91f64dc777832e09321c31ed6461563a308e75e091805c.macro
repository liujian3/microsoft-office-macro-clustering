Attribute VB_Name = "BancoRemarks"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Bloqueio"
Option Explicit
Option Private Module

Public Const SENHA_PASTA As String = "phgdzs*963,   "

Sub ExibeTelaLogon()
    frmAcesso.Show vbModal
End Sub

Sub ocultarTodasPlanilhas()
    Dim sht As Worksheet
    ActiveWorkbook.Unprotect SENHA_PASTA
    For Each sht In PastaDeTrabalhoGalgos.Sheets
       If Not sht Is PlanVazio Then
            sht.Visible = xlSheetHidden
       End If
    Next sht
    ActiveWorkbook.Protect Password:=SENHA_PASTA, Structure:=True, Windows:=False
End Sub

Sub exibePlanilhas()
    Dim sht As Worksheet
    ActiveWorkbook.Unprotect SENHA_PASTA
    For Each sht In PastaDeTrabalhoGalgos.Sheets
        If Not sht Is PlanTEMP Then
            sht.Visible = xlSheetVisible
        End If
    Next sht
    Sheets("Resumo").Select
    Call carregaCombobox
    Call carregaComboboxTradutor
    
End Sub

Sub PlanilhasCliente()
    Dim sht As Worksheet
    ActiveWorkbook.Unprotect SENHA_PASTA
    For Each sht In PastaDeTrabalhoGalgos.Sheets
        If sht Is PlanBaseR Or sht Is PlanResumo Then
            sht.Visible = xlSheetVisible
        End If
    Next sht
    ActiveWorkbook.Protect Password:=SENHA_PASTA, Structure:=True, Windows:=False
End Sub


Attribute VB_Name = "CallMacros"
Option Private Module

Sub chamada()
    
    Application.ScreenUpdating = False
    Sheets("TEMP").Visible = xlSheetVisible
    
    Call BASEracingPost
    Call formatDateBaseR
    Call formatBaseRP
    Call limpaAvB
    Call search_rmk
    Call calcs
    Call carregaCombobox
    Call carregaComboboxTradutor
    
    
    If Sheets("BaseR").Range("G6") = "" Then MsgBox "ATEN|fffd||fffd|O: EXISTE UM/OU MAIS GALGO(S) QUE N|fffd|O IR|fffd|(|fffd|O) CORRER." & Chr(13) & Chr(13) & "CUIDADO COM A ORDEM DAS TRAPS!!!" & Chr(13) & Chr(13) & "ANALISE PELO NOME DO GALGO!!!", vbCritical
    Sheets("TEMP").Visible = xlVeryHidden
    Application.ScreenUpdating = True
    ThisWorkbook.Save
End Sub
Attribute VB_Name = "Cods"
Option Private Module

Sub BASEracingPost()
On Error Resume Next
Sheets("TEMP").Select
Columns("A:AT").Select
Selection.ClearContents
Range("A1").Select
ActiveSheet.PasteSpecial Format:="HTML", Link:=False, DisplayAsIcon:= _
False, NoHTMLFormatting:=True

ulin = Sheets("TEMP").Range("A1048576").End(xlUp).Row
constante = 4

Sheets("BaseR").Select
Range("B2:D8").Select
Selection.ClearContents

Range("A11:AM1000").Select
Selection.ClearContents


g = 2
For i = 1 To ulin
    
    If Sheets("TEMP").Cells(i, 1) = "" Then
        Sheets("BaseR").Range("B4") = Sheets("TEMP").Cells(i - 2, 1)
        Sheets("BaseR").Range("B5") = Sheets("TEMP").Cells(i - 1, 1)
        Sheets("BaseR").Range("B6") = Sheets("TEMP").Cells(i, 2)
        If Sheets("BaseR").Range("B6") > 0.125 Then Sheets("BaseR").Range("B7") = Sheets("BaseR").Range("B6") - 0.125
        'If Sheets("BaseR").Range("B6") = 0.125 Then Sheets("BaseR").Range("B7") = 0.5
        'If Sheets("BaseR").Range("B6") >= 2 * 4.16666666666667E-02 And Sheets("BaseR").Range("B6") < 0.125 Then Sheets("BaseR").Range("B7") = 0.458333333333333 + Round(Sheets("BaseR").Range("B6"), 22)
        'If Sheets("BaseR").Range("B6") >= 4.16666666666667E-02 And Sheets("BaseR").Range("B6") < 2 * 4.16666666666667E-02 Then Sheets("BaseR").Range("B7") = 0.416666666666667 + Round(Sheets("BaseR").Range("B6"), 22)
    End If
    
    If Sheets("TEMP").Cells(i, 1) = "Print" Then
        '---- pesquisa de pos1 n|fffd|o |fffd| um espa|fffd|o
        pos1 = InStr(1, Sheets("TEMP").Cells(i + 1, 1), "|fffd|")
        pos2 = WorksheetFunction.Find(" ", Sheets("TEMP").Cells(i + 1, 1), WorksheetFunction.Find(" ", Sheets("TEMP").Cells(i + 1, 1)) + 1)
        
        s1 = Trim(Mid(Sheets("TEMP").Cells(i + 1, 1), pos1 + 1, pos2 - pos1))
    
        Sheets("BaseR").Range("B2") = s1
        If Len(s1) = 2 And Left(s1, 2) <> "OR" And Left(s1, 2) <> "HP" Then
            Sheets("BaseR").Range("C2") = Left(s1, 1)
            Sheets("BaseR").Range("D2") = Right(s1, 1)
        ElseIf Len(s1) > 2 And Left(s1, 2) <> "OR" And Left(s1, 2) <> "HP" Then
            Sheets("BaseR").Range("C2") = Left(s1, 1)
            Sheets("BaseR").Range("D2") = Right(s1, 2)
        Else
            Sheets("BaseR").Range("C2") = Left(s1, 2)
        End If
        
        pos = InStr(1, Sheets("TEMP").Cells(i + 1, 1), "-")
        S2 = Trim(Mid(Sheets("TEMP").Cells(i + 1, 1), pos + 2, 4))
        Sheets("BaseR").Range("B3") = S2
    End If
    
    If Sheets("TEMP").Cells(i, 1) = "Card" Then
       Sheets("BaseR").Range("B8") = Sheets("TEMP").Cells(i + 6, 1)
    End If
    
    '---- NOME E NASCIMENTO DOS GALGOS
    If Left(Sheets("TEMP").Cells(i, 1), 13) = "|fffd|Race Status:" Then
        If UCase(Mid(Sheets("TEMP").Cells(i + 1, 1), 1, 3)) = "WAT" Then
            Sheets("BaseR").Range("G1") = Sheets("TEMP").Cells(i + 2, 1)
        Else
            Sheets("BaseR").Range("G1") = Sheets("TEMP").Cells(i + 1, 1)
         End If
    End If
       
    If Sheets("TEMP").Cells(i, 2) = "Track" Then
       ulinG = Sheets("TEMP").Cells(i, 2).End(xlDown).Offset(1, 0).Row
       Sheets("BaseR").Cells(g, 7) = Sheets("TEMP").Cells(ulinG, 1)
       'Sheets("BaseR").Cells(g, 11) = Right(Sheets("TEMP").Cells(ulinG + 1, 1), 5)
       Sheets("BaseR").Cells(g - 1, 11) = Right(Sheets("TEMP").Cells(i - 2, 1), 5)
       
       sexo = Mid(Sheets("TEMP").Cells(i - 2, 1), InStr(1, Sheets("TEMP").Cells(i - 2, 1), " ") + 1, 1)
       If sexo = "d" Then
       Sheets("BaseR").Cells(g - 1, 12) = "Macho"
       Else
       Sheets("BaseR").Cells(g - 1, 12) = "F|fffd|mea"
       End If
       
       g = g + 1
    End If
    
Next

n = 0
g = 0
For i = 1 To ulin
Sheets("TEMP").Select

    If Sheets("TEMP").Cells(i, 3) = "Dis" Then
        n = n + 1
        g = g + 1
        Sheets("TEMP").Select
        Sheets("TEMP").Cells(i, 3).Select
        
        ulin2 = Sheets("TEMP").Cells(i, 3).End(xlDown).Offset(1, 0).Row - 1
        ulin3 = Sheets("BaseR").Range("c1048576").End(xlUp).Row
        k = i + 1
        
            For j = 1 To ulin2 - i
                
                Sheets("BaseR").Cells(j + ulin3, 1) = Sheets("BaseR").Cells(g, 7)
                Sheets("BaseR").Cells(j + ulin3, 2) = n
                
                Sheets("BaseR").Cells(j + ulin3, 3) = Sheets("TEMP").Cells(k, 1)
                Sheets("BaseR").Cells(j + ulin3, 4) = Sheets("TEMP").Cells(k, 2)
                Sheets("BaseR").Cells(j + ulin3, 5) = Sheets("TEMP").Cells(k, 3)
                Sheets("BaseR").Cells(j + ulin3, 6) = Mid(Sheets("TEMP").Cells(k, 4), 2, 1)
                Sheets("BaseR").Cells(j + ulin3, 7) = Sheets("TEMP").Cells(k, 5)
                Sheets("BaseR").Cells(j + ulin3, 8) = Sheets("TEMP").Cells(k, 6)
                Sheets("BaseR").Cells(j + ulin3, 9) = Left(Sheets("TEMP").Cells(k, 7), 1)
                Sheets("BaseR").Cells(j + ulin3, 10) = Sheets("TEMP").Cells(k, 8)
                Sheets("BaseR").Cells(j + ulin3, 11) = Sheets("TEMP").Cells(k, 9)
                Sheets("BaseR").Cells(j + ulin3, 12) = Sheets("TEMP").Cells(k, 10)
                Sheets("BaseR").Cells(j + ulin3, 13) = Sheets("TEMP").Cells(k, 11)
                Sheets("BaseR").Cells(j + ulin3, 14) = Sheets("TEMP").Cells(k, 12)
                Sheets("BaseR").Cells(j + ulin3, 15) = Sheets("TEMP").Cells(k, 13)
                Sheets("BaseR").Cells(j + ulin3, 16) = Sheets("TEMP").Cells(k, 14)
                Sheets("BaseR").Cells(j + ulin3, 17) = Sheets("TEMP").Cells(k, 15)
                Sheets("BaseR").Cells(j + ulin3, 18) = Sheets("TEMP").Cells(k, 16)
                
                Sheets("BaseR").Cells(j + ulin3, 19) = Mid(Sheets("TEMP").Cells(i - 1, 1), 6, 5)
                Sheets("BaseR").Cells(j + ulin3, 20) = Trim(Mid(Sheets("TEMP").Cells(i - 1, 1), 12, 3))
                Sheets("BaseR").Cells(j + ulin3, 21) = Mid(Sheets("TEMP").Cells(i - 1, 1), 15, 10)
                Sheets("BaseR").Cells(j + ulin3, 22) = Sheets("TEMP").Cells(i - 1, 2)
                
                s1 = Sheets("BaseR").Cells(j + ulin3, 17)
                If Len(s1) = 2 And Left(s1, 2) <> "OR" And Left(s1, 2) <> "HP" Then
                Sheets("BaseR").Cells(j + ulin3, 23) = Left(s1, 1)
                ElseIf Len(s1) > 2 And Left(s1, 2) <> "OR" And Left(s1, 2) <> "HP" Then
                Sheets("BaseR").Cells(j + ulin3, 23) = Left(s1, 1)
                Else
                Sheets("BaseR").Cells(j + ulin3, 23) = Left(s1, 2)
                End If
        
                Sheets("BaseR").Cells(j + ulin3, 24) = lfRetiraNumeros(Sheets("BaseR").Cells(j + ulin3, 17))
                Sheets("BaseR").Cells(j + ulin3, 26) = 0.2 * (Left(Sheets("BaseR").Cells(j + ulin3, 8), 1) - Sheets("BaseR").Cells(j + ulin3, 9))
                
                k = k + 1
            Next
    End If
Next
Sheets("BaseR").Select

End Sub


Sub formatBaseRP()
On Error Resume Next
ulin = Sheets("BaseR").Range("A1048576").End(xlUp).Row

Sheets("BaseR").Select
Range("A11:V" & ulin).Select

Selection.Find(What:=".", After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    Selection.Replace What:=".", Replacement:=",", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        

    For i = 11 To ulin
        Sheets("BaseR").Cells(i, 7) = CDec(Sheets("BaseR").Cells(i, 7))
        Sheets("BaseR").Cells(i, 13) = CDec(Sheets("BaseR").Cells(i, 13))
        Sheets("BaseR").Cells(i, 15) = CDec(Sheets("BaseR").Cells(i, 15))
        Sheets("BaseR").Cells(i, 18) = CDec(Sheets("BaseR").Cells(i, 18))
        Sheets("BaseR").Cells(i, 19) = CDec(Sheets("BaseR").Cells(i, 19))
    Next

End Sub
Sub formatDateBaseR()

ulin = Sheets("BaseR").Range("A1048576").End(xlUp).Row
For i = 11 To ulin
d = Mid(Sheets("BaseR").Cells(i, 3), 1, 2)

    If Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Dec" Then
        tdata = CDate(d & "/" & 12 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Nov" Then
        tdata = CDate(d & "/" & 11 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Oct" Then
        tdata = CDate(d & "/" & 10 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Sep" Then
        tdata = CDate(d & "/" & 9 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Aug" Then
        tdata = CDate(d & "/" & 8 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Jul" Then
        tdata = CDate(d & "/" & 7 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Jun" Then
        tdata = CDate(d & "/" & 6 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "May" Then
        tdata = CDate(d & "/" & 5 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Apr" Then
        tdata = CDate(d & "/" & 4 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Mar" Then
        tdata = CDate(d & "/" & 3 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Feb" Then
        tdata = CDate(d & "/" & 2 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata
    ElseIf Mid(Sheets("BaseR").Cells(i, 3), 3, 3) = "Jan" Then
        tdata = CDate(d & "/" & 1 & "/" & Mid(Sheets("BaseR").Cells(i, 3), 6, 2))
        Sheets("BaseR").Cells(i, 3) = tdata

    Else
    End If
    
Next
     
     
End Sub

Sub calcs()
Sheets("BaseR").Select
ulin = Sheets("BaseR").Range("A1048576").End(xlUp).Row
    'split
On Error Resume Next
Sheets("Resumo").Select
Range("A8:F8").Value = ""

Range("E11:I16").Value = ""

Sheets("Resumo").Label1 = ""

Call limpaAvB

Sheets("BaseR").Select

    Sheets("Resumo").Range("E11") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 1)
    Sheets("Resumo").Range("E12") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 2)
    Sheets("Resumo").Range("E13") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 3)
    Sheets("Resumo").Range("E14") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 4)
    Sheets("Resumo").Range("E15") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 5)
    Sheets("Resumo").Range("E16") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 6)

    'tp-final
    Sheets("Resumo").Range("F11") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 1)
    Sheets("Resumo").Range("F12") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 2)
    Sheets("Resumo").Range("F13") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 3)
    Sheets("Resumo").Range("F14") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 4)
    Sheets("Resumo").Range("F15") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 5)
    Sheets("Resumo").Range("F16") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), 6)
    
    'Dis-------------
    Sheets("Resumo").Range("G11") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 1, Sheets("BaseR").Range("E11:E" & ulin), "<>" & Sheets("BaseR").Range("B3"))
    Sheets("Resumo").Range("G12") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 2, Sheets("BaseR").Range("E11:E" & ulin), "<>" & Sheets("BaseR").Range("B3"))
    Sheets("Resumo").Range("G13") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 3, Sheets("BaseR").Range("E11:E" & ulin), "<>" & Sheets("BaseR").Range("B3"))
    Sheets("Resumo").Range("G14") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 4, Sheets("BaseR").Range("E11:E" & ulin), "<>" & Sheets("BaseR").Range("B3"))
    Sheets("Resumo").Range("G15") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 5, Sheets("BaseR").Range("E11:E" & ulin), "<>" & Sheets("BaseR").Range("B3"))
    Sheets("Resumo").Range("G16") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 6, Sheets("BaseR").Range("E11:E" & ulin), "<>" & Sheets("BaseR").Range("B3"))
    
    'Categ-------------
    Sheets("Resumo").Range("H11") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 1, Sheets("BaseR").Range("W11:W" & ulin), "<>" & Sheets("BaseR").Range("C2"))
    Sheets("Resumo").Range("H12") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 2, Sheets("BaseR").Range("W11:W" & ulin), "<>" & Sheets("BaseR").Range("C2"))
    Sheets("Resumo").Range("H13") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 3, Sheets("BaseR").Range("W11:W" & ulin), "<>" & Sheets("BaseR").Range("C2"))
    Sheets("Resumo").Range("H14") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 4, Sheets("BaseR").Range("W11:W" & ulin), "<>" & Sheets("BaseR").Range("C2"))
    Sheets("Resumo").Range("H15") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 5, Sheets("BaseR").Range("W11:W" & ulin), "<>" & Sheets("BaseR").Range("C2"))
    Sheets("Resumo").Range("H16") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), 6, Sheets("BaseR").Range("W11:W" & ulin), "<>" & Sheets("BaseR").Range("C2"))
    
    'Rmk-------------
    Sheets("Resumo").Range("I11") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), 1))
    Sheets("Resumo").Range("I12") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), 2))
    Sheets("Resumo").Range("I13") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), 3))
    Sheets("Resumo").Range("I14") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), 4))
    Sheets("Resumo").Range("I15") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), 5))
    Sheets("Resumo").Range("I16") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), 6))
    
Sheets("Resumo").Select

    '-Sequencia sugerida
    Dim med(5), pos(5), rank(5) As Double
    med(0) = WorksheetFunction.Average(Sheets("Resumo").Range("E11:F11"))
    med(1) = WorksheetFunction.Average(Sheets("Resumo").Range("E12:F12"))
    med(2) = WorksheetFunction.Average(Sheets("Resumo").Range("E13:F13"))
    med(3) = WorksheetFunction.Average(Sheets("Resumo").Range("E14:F14"))
    med(4) = WorksheetFunction.Average(Sheets("Resumo").Range("E15:F15"))
    med(5) = WorksheetFunction.Average(Sheets("Resumo").Range("E16:F16"))
     
    For i = 0 To 5
    j = 0
        While j <= 5
        If i = j Then j = j + 1
        If med(i) = med(j) Then med(i) = med(i) + 0.0000000001
        j = j + 1
        Wend
    Next
    
    
    For i = 0 To 5
        pos(i) = med(i)
        If pos(i) < 0.01 Then pos(i) = 1000 + i
    Next
    
    For i = 0 To 5
        For j = 0 To 5
            If med(i) <= 0.01 Then med(i) = 1000 + i
            If med(i) <= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
            
        Next
    Next


    For i = 0 To 5
        For j = 0 To 5
            If pos(i) = med(j) Then
                rank(j) = i + 1
            Exit For
            End If
        Next
    Next


     For i = 0 To 5
            Sheets("Resumo").Cells(7, i + 1) = rank(i)
    
     Next
    
End Sub

Public Function lfRetiraNumeros(ByVal vValor As String) As String
    'Atualiza o c|fffd|lculo automaticamente
    Application.Volatile
    
    'Conta a quantidade de caracteres
    Dim vQtdeCaract As Long
    Dim vControle   As Boolean
    
    vQtdeCaract = Len(vValor)
    vControle = False
    
    'Para cada caractere identifica se |fffd| n|fffd|mero ou texto
    For i = 1 To vQtdeCaract
        'Se for n|fffd|mero adiciona no retorno da fun|fffd||fffd|o
        If IsNumeric(Mid(vValor, i, 1)) Then
            If vControle = True And lfRetiraNumeros = vbNullString Then
                lfRetiraNumeros = lfRetiraNumeros + " "
            End If
            vControle = False
            lfRetiraNumeros = lfRetiraNumeros & Mid(vValor, i, 1)
        Else
            vControle = True
        End If
    Next
    
    'Substitui espa|fffd|os em branco por / e tira espa|fffd|os em branco no final do retorno da fun|fffd||fffd|o
    lfRetiraNumeros = Replace(Trim(lfRetiraNumeros), " ", "/")

End Function


Sub carregaCombobox()

Sheets("Resumo").ComboBox1.Clear


    Sheets("Resumo").ComboBox1.AddItem "1x2", 0
    Sheets("Resumo").ComboBox1.AddItem "1x3", 1
    Sheets("Resumo").ComboBox1.AddItem "1x4", 2
    Sheets("Resumo").ComboBox1.AddItem "1x5", 3
    Sheets("Resumo").ComboBox1.AddItem "1x6", 4
    Sheets("Resumo").ComboBox1.AddItem "2x3", 5
    Sheets("Resumo").ComboBox1.AddItem "2x4", 6
    Sheets("Resumo").ComboBox1.AddItem "2x5", 7
    Sheets("Resumo").ComboBox1.AddItem "2x6", 8
    Sheets("Resumo").ComboBox1.AddItem "3x4", 9
    Sheets("Resumo").ComboBox1.AddItem "3x5", 10
    Sheets("Resumo").ComboBox1.AddItem "3x6", 11
    Sheets("Resumo").ComboBox1.AddItem "4x5", 12
    Sheets("Resumo").ComboBox1.AddItem "4x6", 13
    Sheets("Resumo").ComboBox1.AddItem "5x6", 14

End Sub

Sub carregaComboboxTradutor()
ulin = Sheets("BDRmk").Range("A100000").End(xlUp).Row
Sheets("Resumo").ComboBox2.Clear

For i = 2 To ulin
    Sheets("Resumo").ComboBox2.AddItem Sheets("BDRmk").Cells(i, 1), i - 2
Next

End Sub


Sub avb()
Dim med(5) As Double
On Error Resume Next

Call limpaAvB

ulin = Sheets("BaseR").Range("A1048576").End(xlUp).Row
G1 = CInt(Left(Sheets("Resumo").ComboBox1.Value, 1))
G2 = CInt(Right(Sheets("Resumo").ComboBox1.Value, 1))


'---HISTORICO AVB GALGO 1
Sheets("Resumo").Range("A18") = G1
Sheets("Resumo").Range("B18") = WorksheetFunction.VLookup("Galgo" & G1, Sheets("BaseR").Range("F1:L6"), 2, False)
Sheets("Resumo").Range("B19") = WorksheetFunction.VLookup("Galgo" & G1, Sheets("BaseR").Range("F1:L6"), 7, False)

'--- Date
For i = 11 To ulin
For j = 21 To 28
    If Sheets("BaseR").Cells(i, 2) = G1 Then
        Sheets("Resumo").Cells(j, 1) = Sheets("BaseR").Cells(i, 3)
        Sheets("Resumo").Cells(j, 2) = Sheets("BaseR").Cells(i, 6)
        Sheets("Resumo").Cells(j, 3) = Sheets("BaseR").Cells(i, 5)
        Sheets("Resumo").Cells(j, 4) = Sheets("BaseR").Cells(i, 8)
        Sheets("Resumo").Cells(j, 5) = Sheets("BaseR").Cells(i, 7)
        Sheets("Resumo").Cells(j, 6) = Sheets("BaseR").Cells(i, 18)
        Sheets("Resumo").Cells(j, 7) = Sheets("BaseR").Cells(i, 26)
        Sheets("Resumo").Cells(j, 8) = Sheets("BaseR").Cells(i, 12)
        i = i + 1
    End If
Next
Next
Sheets("Resumo").Range("A21:H28").SpecialCells(xlCellTypeBlanks).Select
Selection.FormulaR1C1 = "-"
    
'---HISTORICO AVB GALGO 2
Sheets("Resumo").Range("A30") = G2
Sheets("Resumo").Range("B30") = WorksheetFunction.VLookup("Galgo" & G2, Sheets("BaseR").Range("F1:L6"), 2, False)
Sheets("Resumo").Range("B31") = WorksheetFunction.VLookup("Galgo" & G2, Sheets("BaseR").Range("F1:L6"), 7, False)

'--- Date
For i = 11 To ulin
For j = 33 To 40
    If Sheets("BaseR").Cells(i, 2) = G2 Then
        Sheets("Resumo").Cells(j, 1) = Sheets("BaseR").Cells(i, 3)
        Sheets("Resumo").Cells(j, 2) = Sheets("BaseR").Cells(i, 6)
        Sheets("Resumo").Cells(j, 3) = Sheets("BaseR").Cells(i, 5)
        Sheets("Resumo").Cells(j, 4) = Sheets("BaseR").Cells(i, 8)
        Sheets("Resumo").Cells(j, 5) = Sheets("BaseR").Cells(i, 7)
        Sheets("Resumo").Cells(j, 6) = Sheets("BaseR").Cells(i, 18)
        Sheets("Resumo").Cells(j, 7) = Sheets("BaseR").Cells(i, 26)
        Sheets("Resumo").Cells(j, 8) = Sheets("BaseR").Cells(i, 12)
        i = i + 1
    End If
Next
Next
Sheets("Resumo").Range("A33:H40").SpecialCells(xlCellTypeBlanks).Select
Selection.FormulaR1C1 = "-"

'----Sexo

Sheets("Resumo").Range("M5") = WorksheetFunction.VLookup("Galgo" & G1, Sheets("BaseR").Range("F1:L6"), 7, False)
Sheets("Resumo").Range("Q5") = WorksheetFunction.VLookup("Galgo" & G2, Sheets("BaseR").Range("F1:L6"), 7, False)

'----Nomes

Sheets("Resumo").Range("M6") = WorksheetFunction.VLookup("Galgo" & G1, Sheets("BaseR").Range("F1:L6"), 2, False)
Sheets("Resumo").Range("Q6") = WorksheetFunction.VLookup("Galgo" & G2, Sheets("BaseR").Range("F1:L6"), 2, False)

'----- Numeros dos galgos nos menus
Sheets("Resumo").Range("M7") = G1
Sheets("Resumo").Range("Q7") = G2

Sheets("Resumo").Range("M19") = G1
Sheets("Resumo").Range("O19") = G2
Sheets("Resumo").Range("Q19") = G1
Sheets("Resumo").Range("S19") = G2
'---- Idade
Dim nasc, mesid As String
nasc = 0
nasc = WorksheetFunction.VLookup("Galgo" & G1, Sheets("BaseR").Range("F1:K6"), 6, False)
mesid = Mid(nasc, 1, 3)
For i = 1 To 12
    If mesid = "Dec" Then
        mesid = "/" & 12 & "/"
    Exit For
    
    ElseIf mesid = "Nov" Then
        mesid = "/" & 11 & "/"
    Exit For
    
    ElseIf mesid = "Oct" Then
        mesid = "/" & 10 & "/"
    Exit For
    
    ElseIf mesid = "Sep" Then
        mesid = "/" & 9 & "/"
    Exit For
    
    ElseIf mesid = "Aug" Then
        mesid = "/" & 8 & "/"
    Exit For
    
    ElseIf mesid = "Jul" Then
        mesid = "/" & 7 & "/"
    Exit For
    
    ElseIf mesid = "Jun" Then
        mesid = "/" & 6 & "/"
    Exit For
    
    ElseIf mesid = "May" Then
        mesid = "/" & 5 & "/"
    Exit For
    
    ElseIf mesid = "Apr" Then
        mesid = "/" & 4 & "/"
    Exit For
    
    ElseIf mesid = "Mar" Then
        mesid = "/" & 3 & "/"
    Exit For
    
    ElseIf mesid = "Feb" Then
        mesid = "/" & 2 & "/"
    Exit For
    
    ElseIf mesid = "Jan" Then
        mesid = "/" & 1 & "/"
    Exit For
    
    End If
Next
IDADE = (Date - CDate("01" & mesid & Mid(nasc, 4, 2))) / 30
If IDADE = 0 Then
Sheets("Resumo").Range("M8") = "Engravidou!"
Else
Sheets("Resumo").Range("M8") = WorksheetFunction.RoundDown(IDADE, 0)
End If

IDADE = 0
nasc = WorksheetFunction.VLookup("Galgo" & G2, Sheets("BaseR").Range("F1:K6"), 6, False)
mesid = Mid(nasc, 1, 3)
For i = 1 To 12
    If mesid = "Dec" Then
        mesid = "/" & 12 & "/"
    Exit For
    
    ElseIf mesid = "Nov" Then
        mesid = "/" & 11 & "/"
    Exit For
    
    ElseIf mesid = "Oct" Then
        mesid = "/" & 10 & "/"
    Exit For
    
    ElseIf mesid = "Sep" Then
        mesid = "/" & 9 & "/"
    Exit For
    
    ElseIf mesid = "Aug" Then
        mesid = "/" & 8 & "/"
    Exit For
    
    ElseIf mesid = "Jul" Then
        mesid = "/" & 7 & "/"
    Exit For
    
    ElseIf mesid = "Jun" Then
        mesid = "/" & 6 & "/"
    Exit For
    
    ElseIf mesid = "May" Then
        mesid = "/" & 5 & "/"
    Exit For
    
    ElseIf mesid = "Apr" Then
        mesid = "/" & 4 & "/"
    Exit For
    
    ElseIf mesid = "Mar" Then
        mesid = "/" & 3 & "/"
    Exit For
    
    ElseIf mesid = "Feb" Then
        mesid = "/" & 2 & "/"
    Exit For
    
    ElseIf mesid = "Jan" Then
        mesid = "/" & 1 & "/"
    Exit For
    
    End If
Next
IDADE = (Date - CDate("01" & mesid & Mid(nasc, 4, 2))) / 30

If IDADE = 0 Then
Sheets("Resumo").Range("Q8") = "Engravidou!"
Else
Sheets("Resumo").Range("Q8") = WorksheetFunction.RoundDown(IDADE, 0)
End If


'----peso
Sheets("Resumo").Range("M9") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("O11:O" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("Q9") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("O11:O" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G2)

'----Dias sem Correr

Sheets("Resumo").Range("M10") = Date - WorksheetFunction.VLookup(G1, Sheets("BaseR").Range("B11:C" & ulin), 2, False)
Sheets("Resumo").Range("Q10") = Date - WorksheetFunction.VLookup(G2, Sheets("BaseR").Range("B11:C" & ulin), 2, False)

'---- M|fffd|dia Remarks Ruins
Sheets("Resumo").Range("M11") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G1))
Sheets("Resumo").Range("Q11") = Round(WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Y11:Y" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G2))

'----|fffd|ltimas corridas Categoria
str1 = ""
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 Then str1 = str1 & "-" & Sheets("BaseR").Cells(i, 17)
Next
Sheets("Resumo").Range("M12") = str1

str1 = ""
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 Then str1 = str1 & "-" & Sheets("BaseR").Cells(i, 17)
Next
Sheets("Resumo").Range("Q12") = str1

'----|fffd|ltimas corridas Posi|fffd||fffd|es
str1 = ""
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 Then str1 = str1 & "-" & Sheets("BaseR").Cells(i, 9)
Next
Sheets("Resumo").Range("M13") = str1

str1 = ""
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 Then str1 = str1 & "-" & Sheets("BaseR").Cells(i, 9)
Next
Sheets("Resumo").Range("Q13") = str1


'----tempo ultima corrida
Sheets("Resumo").Range("M14") = WorksheetFunction.VLookup(G1, Sheets("BaseR").Range("B11:AA" & ulin), 17, False)
Sheets("Resumo").Range("Q14") = WorksheetFunction.VLookup(G2, Sheets("BaseR").Range("B11:AA" & ulin), 17, False)

'----|fffd|ltima Corrida na Dis
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Sheets("BaseR").Cells(i, 5) = Sheets("BaseR").Cells(3, 2) Then
        Sheets("Resumo").Range("M15") = Sheets("BaseR").Cells(i, 18)
    Exit For
    End If
Next

For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Sheets("BaseR").Cells(i, 5) = Sheets("BaseR").Cells(3, 2) Then
        Sheets("Resumo").Range("Q15") = Sheets("BaseR").Cells(i, 18)
    Exit For
    End If
Next

'----|fffd|ltima Corrida na Categoria
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Sheets("BaseR").Cells(i, 17) = Sheets("BaseR").Cells(2, 2) Then
        Sheets("Resumo").Range("M16") = Sheets("BaseR").Cells(i, 18)
    Exit For
    End If
Next

For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Sheets("BaseR").Cells(i, 17) = Sheets("BaseR").Cells(2, 2) Then
        Sheets("Resumo").Range("Q16") = Sheets("BaseR").Cells(i, 18)
    Exit For
    End If
Next

'----Na Categoria ou acima
Sheets("Resumo").Range("M17") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("X11:X" & ulin), "<=" & Sheets("BaseR").Range("D2"))
Sheets("Resumo").Range("Q17") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("X11:X" & ulin), "<=" & Sheets("BaseR").Range("D2"))


'----BRT
Sheets("Resumo").Range("M18") = WorksheetFunction.VLookup(G1, Sheets("BaseR").Range("B11:AA" & ulin), 18, False) & " " & WorksheetFunction.VLookup(G1, Sheets("BaseR").Range("B11:AA" & ulin), 19, False) & " " & WorksheetFunction.VLookup(G1, Sheets("BaseR").Range("B11:AA" & ulin), 20, False)
Sheets("Resumo").Range("Q18") = WorksheetFunction.VLookup(G2, Sheets("BaseR").Range("B11:AA" & ulin), 18, False) & " " & WorksheetFunction.VLookup(G2, Sheets("BaseR").Range("B11:AA" & ulin), 19, False) & " " & WorksheetFunction.VLookup(G2, Sheets("BaseR").Range("B11:AA" & ulin), 20, False)

'-----LIMPOS
'----split m|fffd|dio limpo
Sheets("Resumo").Range("M20") = WorksheetFunction.AverageIfs(Sheets("Resumo").Range("E11:E16"), Sheets("Resumo").Range("D11:D16"), G1)
Sheets("Resumo").Range("O20") = WorksheetFunction.AverageIfs(Sheets("Resumo").Range("E11:E16"), Sheets("Resumo").Range("D11:D16"), G2)
   
'----tp final m|fffd|dio limpo
Sheets("Resumo").Range("M21") = WorksheetFunction.AverageIfs(Sheets("Resumo").Range("F11:F16"), Sheets("Resumo").Range("D11:D16"), G1)
Sheets("Resumo").Range("O21") = WorksheetFunction.AverageIfs(Sheets("Resumo").Range("F11:F16"), Sheets("Resumo").Range("D11:D16"), G2)
   
'----Vit|fffd|rias Limpas
Sheets("Resumo").Range("M22") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("I11:I" & ulin), 1)
Sheets("Resumo").Range("O22") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("I11:I" & ulin), 1)

'----Entre os 3 Limpas
Sheets("Resumo").Range("M23") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("I11:I" & ulin), "<=" & 3)
Sheets("Resumo").Range("O23") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("I11:I" & ulin), "<=" & 3)

'----Posi|fffd||fffd|o m|fffd|dia limpo
Sheets("Resumo").Range("M24") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("I11:I" & ulin), Sheets("BaseR").Range("I11:I" & ulin), "<>", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("O24") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("I11:I" & ulin), Sheets("BaseR").Range("I11:I" & ulin), "<>", Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), G2)

'----Na Trap
Sheets("Resumo").Range("M25") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("F11:F" & ulin), G1)
Sheets("Resumo").Range("O25") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("F11:F" & ulin), G2)

'----Melhor tempo

a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Sheets("BaseR").Cells(i, 23) = Sheets("BaseR").Cells(2, 3) And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) <= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("M26") = med(0)
    
Erase med
a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Sheets("BaseR").Cells(i, 23) = Sheets("BaseR").Cells(2, 3) And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) <= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("O26") = med(0)

'----Pior tempo

a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Sheets("BaseR").Cells(i, 23) = Sheets("BaseR").Cells(2, 3) And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) >= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("M27") = med(0)
    
Erase med
a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Sheets("BaseR").Cells(i, 23) = Sheets("BaseR").Cells(2, 3) And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) >= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("O27") = med(0)

'---Recupera|fffd||fffd|o
Sheets("Resumo").Range("M28") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Z11:Z" & ulin), Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("O28") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Z11:Z" & ulin), Sheets("BaseR").Range("W11:W" & ulin), Sheets("BaseR").Range("C2"), Sheets("BaseR").Range("E11:E" & ulin), Sheets("BaseR").Range("B3"), Sheets("BaseR").Range("B11:B" & ulin), G2)

'---M|fffd|dia de Bands

media1 = 0
media2 = 0
media3 = 0
media4 = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Mid(Sheets("BaseR").Cells(i, 8), 2, 1) <> "-" And Sheets("BaseR").Cells(i, 23) = Sheets("BaseR").Cells(2, 3) Then
        media1 = media1 + Left(Sheets("BaseR").Cells(i, 8), 1)
        media2 = media2 + Mid(Sheets("BaseR").Cells(i, 8), 2, 1)
        media3 = media3 + Mid(Sheets("BaseR").Cells(i, 8), 3, 1)
        media4 = media4 + Mid(Sheets("BaseR").Cells(i, 8), 4, 1)
    End If
    
Next
k = (WorksheetFunction.CountIf(Sheets("BaseR").Range("B11:B" & ulin), G1))
media1 = Round((media1 / k))
media2 = Round((media2 / k))
media3 = Round((media3 / k))
media4 = Round((media4 / k))

Sheets("Resumo").Range("M29") = media1 & media2 & media3 & media4

media1 = 0
media2 = 0
media3 = 0
media4 = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Mid(Sheets("BaseR").Cells(i, 8), 2, 1) <> "-" And Sheets("BaseR").Cells(i, 23) = Sheets("BaseR").Cells(2, 3) Then
        media1 = media1 + Left(Sheets("BaseR").Cells(i, 8), 1)
        media2 = media2 + Mid(Sheets("BaseR").Cells(i, 8), 2, 1)
        media3 = media3 + Mid(Sheets("BaseR").Cells(i, 8), 3, 1)
        media4 = media4 + Mid(Sheets("BaseR").Cells(i, 8), 4, 1)
    End If
    
Next
k = (WorksheetFunction.CountIf(Sheets("BaseR").Range("B11:B" & ulin), G1))
media1 = Round((media1 / k))
media2 = Round((media2 / k))
media3 = Round((media3 / k))
media4 = Round((media4 / k))

Sheets("Resumo").Range("O29") = media1 & media2 & media3 & media4


'--COMPLETOS
'----split m|fffd|dio
Sheets("Resumo").Range("Q20") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("S20") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("G11:G" & ulin), Sheets("BaseR").Range("G11:G" & ulin), "<>0", Sheets("BaseR").Range("B11:B" & ulin), G2)
   
'----tp final m|fffd|dio
Sheets("Resumo").Range("Q21") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("S21") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("R11:R" & ulin), Sheets("BaseR").Range("R11:R" & ulin), "<>0", Sheets("BaseR").Range("B11:B" & ulin), G2)
   
'----Vit|fffd|rias
Sheets("Resumo").Range("Q22") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("I11:I" & ulin), 1)
Sheets("Resumo").Range("S22") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("I11:I" & ulin), 1)

'----Entre os 3
Sheets("Resumo").Range("Q23") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("I11:I" & ulin), "<=" & 3)
Sheets("Resumo").Range("S23") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("I11:I" & ulin), "<=" & 3)

'----Posi|fffd||fffd|o m|fffd|dia
Sheets("Resumo").Range("Q24") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("I11:I" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("S24") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("I11:I" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G2)

'----Na Trap
Sheets("Resumo").Range("Q25") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G1, Sheets("BaseR").Range("F11:F" & ulin), G1)
Sheets("Resumo").Range("S25") = WorksheetFunction.CountIfs(Sheets("BaseR").Range("B11:B" & ulin), G2, Sheets("BaseR").Range("F11:F" & ulin), G2)

'----Melhor tempo

a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) <= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("Q26") = med(0)
    
Erase med
a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) <= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("S26") = med(0)

'----Pior tempo

a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) >= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("Q27") = med(0)
    
Erase med
a = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Sheets("BaseR").Cells(i, 18) <> 0 Then
        med(a) = Sheets("BaseR").Cells(i, 18)
        a = a + 1
    End If
Next

For i = 0 To a - 1
        For j = 0 To a - 1
            If med(i) >= med(j) Then
                temp = med(i)
                med(i) = med(j)
                med(j) = temp
            End If
        Next
Next
    
Sheets("Resumo").Range("S27") = med(0)

'---Recupera|fffd||fffd|o
Sheets("Resumo").Range("Q28") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Z11:Z" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G1)
Sheets("Resumo").Range("S28") = WorksheetFunction.AverageIfs(Sheets("BaseR").Range("Z11:Z" & ulin), Sheets("BaseR").Range("B11:B" & ulin), G2)

'---M|fffd|dia de Bands

media1 = 0
media2 = 0
media3 = 0
media4 = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G1 And Mid(Sheets("BaseR").Cells(i, 8), 2, 1) <> "-" Then
        media1 = media1 + Left(Sheets("BaseR").Cells(i, 8), 1)
        media2 = media2 + Mid(Sheets("BaseR").Cells(i, 8), 2, 1)
        media3 = media3 + Mid(Sheets("BaseR").Cells(i, 8), 3, 1)
        media4 = media4 + Mid(Sheets("BaseR").Cells(i, 8), 4, 1)
    End If
    
Next
k = (WorksheetFunction.CountIf(Sheets("BaseR").Range("B11:B" & ulin), G1))
media1 = Round((media1 / k))
media2 = Round((media2 / k))
media3 = Round((media3 / k))
media4 = Round((media4 / k))

Sheets("Resumo").Range("Q29") = media1 & media2 & media3 & media4

media1 = 0
media2 = 0
media3 = 0
media4 = 0
For i = 11 To ulin
    If Sheets("BaseR").Cells(i, 2) = G2 And Mid(Sheets("BaseR").Cells(i, 8), 2, 1) <> "-" Then
        media1 = media1 + Left(Sheets("BaseR").Cells(i, 8), 1)
        media2 = media2 + Mid(Sheets("BaseR").Cells(i, 8), 2, 1)
        media3 = media3 + Mid(Sheets("BaseR").Cells(i, 8), 3, 1)
        media4 = media4 + Mid(Sheets("BaseR").Cells(i, 8), 4, 1)
    End If
    
Next
k = (WorksheetFunction.CountIf(Sheets("BaseR").Range("B11:B" & ulin), G1))
media1 = Round((media1 / k))
media2 = Round((media2 / k))
media3 = Round((media3 / k))
media4 = Round((media4 / k))

Sheets("Resumo").Range("S29") = media1 & media2 & media3 & media4

Sheets("Resumo").Range("Q7").Select

End Sub

Sub search_rmk()
On Error Resume Next
ulinB = Sheets("BaseR").Cells(11, 1).End(xlDown).Offset(1, 0).Row

ulin = Sheets("BDRmk").Cells(1, 1).End(xlDown).Offset(1, 0).Row

For i = 11 To ulinB
cel = Sheets("BaseR").Cells(i, 12)
ncar = InStr(1, cel, ",") - 1
Dim vetRmk() As String
vetRmk = Split(cel, ",")
tamvet = UBound(vetRmk)
contenc = 0
pontRmk = 0
Sheets("BaseR").Cells(i, 28) = tamvet + 1
    For l = 0 To tamvet
    cod = vetRmk(l)
    enc = False
    
        For j = Len(cod) To 1 Step -1
        If Len(cod) = 1 And cod <> "W" Then Exit For
            k = 2
            codsearch = Mid(cod, 1, j)
            If enc = False Then
            For k = 2 To ulin
                If UCase(codsearch) = UCase(Sheets("BDRmk").Cells(k, 1)) Then
                    enc = True
                    pontRmk = pontRmk + WorksheetFunction.VLookup(Sheets("BDRmk").Cells(k, 1), Sheets("BDRmk").Range("A2:C" & ulin), 3, False)
                    contenc = contenc + 1
                    
                    Sheets("BaseR").Cells(i, 25) = pontRmk
                    Sheets("BaseR").Cells(i, 27) = contenc
                End If
            Next
            End If
        Next
    Next
Next
End Sub

Sub tradutorRmk()
On Error Resume Next
ulin = Sheets("BDRmk").Range("A100000").End(xlUp).Row

Sheets("Resumo").Label1 = WorksheetFunction.VLookup(Sheets("Resumo").ComboBox2.Value, Sheets("BDRmk").Range("A2:B" & ulin), 2, False)


End Sub
Sub limpaAvB()

Sheets("Resumo").Select
Range("M5") = ""
Range("Q5") = ""
Range("M6") = ""
Range("Q6") = ""

Range("M8:M18") = ""
Range("Q8:Q18") = ""

Range("M20:M29") = ""
Range("O20:O29") = ""
Range("Q20:Q29") = ""
Range("S20:S29") = ""

Sheets("Resumo").Range("M7") = ""
Sheets("Resumo").Range("Q7") = ""

Sheets("Resumo").Range("M19") = ""
Sheets("Resumo").Range("O19") = ""
Sheets("Resumo").Range("Q19") = ""
Sheets("Resumo").Range("S19") = ""

'---Limpa o historico que esta na capa
Sheets("Resumo").Range("A18:B19") = ""
Sheets("Resumo").Range("A30:B31") = ""

Sheets("Resumo").Range("A21:H28") = ""
Sheets("Resumo").Range("A33:H40") = ""

End Sub
Attribute VB_Name = "PastaDeTrabalhoGalgos"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Sub Workbook_Open()
    Call ocultarTodasPlanilhas
    frmAcesso.Show vbModal

End Sub



Private Sub Workbook_BeforeClose(Cancel As Boolean)
    ocultarTodasPlanilhas
End Sub



Attribute VB_Name = "PlanBaseR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanResumo"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ComboBox1, 9, 3, MSForms, ComboBox"
Attribute VB_Control = "ComboBox2, 11, 4, MSForms, ComboBox"
Attribute VB_Control = "Label1, 16, 5, MSForms, Label"
Attribute VB_Name = "PlanTEMP"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanVazio"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "frmAcesso"
Attribute VB_Base = "0{40FFBD75-1086-4F3B-8F51-F48B4C4751C8}{A1A404AF-0843-4CA1-B96B-D93D57E90627}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub btnAcessar_Click()
On Local Error Resume Next
    Dim lngUsuario As Long
    lngUsuario = WorksheetFunction.Match(txtUser.Text, shtUsuarioSenha.ListObjects("tabUsuarioSenha").ListColumns("usuario").DataBodyRange, 0)
    If lngUsuario > 0 Then
        If shtUsuarioSenha.ListObjects("tabUsuarioSenha").ListColumns("usuario").DataBodyRange(lngUsuario, 2).Value = txtPass.Text Then
            logonSucesso
            Exit Sub
        End If
    End If
    Err.Clear
    MsgBox "Nome de usu|fffd|rio ou senha inv|fffd|lidos", vbInformation
End Sub

Private Sub btnCancelar_Click()
    Unload Me
End Sub

Private Sub logonSucesso()
    Unload Me
    exibePlanilhas
    'MsgBox "Acesso permitido, 'Planilha2' dispon|fffd|vel.", vbInformation
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "shtUsuarioSenha"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
