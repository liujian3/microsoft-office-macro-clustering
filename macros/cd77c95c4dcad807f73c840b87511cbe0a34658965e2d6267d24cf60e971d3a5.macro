Attribute VB_Name = "Asset"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Budget"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "FReport"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "List"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
'The copyright of this excle and macro are by 17rich.com. All right reserved.
'=========================================
Option Explicit
Dim ActSheet As Worksheet
Dim RAItemA, RAItemZ, RABottomLineS, RABottomLineA, RABottomLineZ As Range
' RA = Running Account (day-to-day account)
'=========================================

Private Sub Account_RefSet()
    Dim x As Integer
    Set ActSheet = ThisWorkbook.ActiveSheet
    With ActSheet
        x = Range("B1").Value
        Set RAItemA = .Range("RAItemA" & "_" & x)
        Set RAItemZ = RAItemA.Cells(1, 6)
        Set RABottomLineS = .Range("RABottomLineS" & "_" & x)
        Set RABottomLineA = RABottomLineS.Cells(1, 2)
        Set RABottomLineZ = RABottomLineS.Cells(1, 8)
        '-------------------------------------------------------------
    End With
End Sub

Private Sub Account_NewBlankRow()
Dim RANewNum As Integer
Application.ScreenUpdating = False
ActiveSheet.Unprotect
Call Account_RefSet
'===================================
    RANewNum = ShSetup.Range("J6")
    ShBlank.Range("B1:I" & RANewNum).Copy
    Range(RABottomLineS.Cells(1, 1), RABottomLineZ(1, 1)).Insert Shift:=xlDown
'===================================
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True
Application.ScreenUpdating = True
RABottomLineA.Cells(0, 1).Select
End Sub

Private Sub Account_DeleteRow()
Dim ActColumn As Integer
Dim ActRange As Range
Application.ScreenUpdating = False
ActiveSheet.Unprotect
Call Account_RefSet
'===================================
Set ActRange = ActiveCell
If ActRange.Row <= RAItemA.Row Or ActRange.Row >= RABottomLineS.Row Or ActRange.Column < RAItemA.Column Or ActRange.Column > RAItemZ.Column _
   Then MsgBox "|fffd||fffd||fffd|x|fffd|s|fffd||fffd|T|fffd||fffd|R|fffd||fffd|" & vbCrLf & _
   "The location can't be deleted.", 0 + 16, "Stop message": GoTo close1
   ActColumn = ActRange.Column - RAItemA.Column
If Cells(ActRange.Row, RABottomLineZ.Cells(1, -1).Column) <> 0 Then
   If MsgBox("|fffd|T|fffd|w|fffd|n|fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1a1|H" & vbCrLf & _
   "Please confirm to delete this record.", 4 + 32 + 256, "Message") = vbNo Then GoTo close1
End If
Set ActRange = ActRange.Cells(1, 1 - ActColumn) 'Back to the DATE position
If RABottomLineA.Row - RAItemA.Row <= 2 Then Range(ActRange, ActRange.Cells(1, 6)).ClearContents: GoTo close1
If RABottomLineA.Row - ActRange.Row = 1 Then ActRange.Cells(0, 1).Select 'Back to the bottom row of Blankform after deleting
If RABottomLineA.Row - RAItemA.Row > 2 Then Range(Cells(ActRange.Row, RABottomLineS.Column), Cells(ActRange.Row, RABottomLineZ.Column)).Delete
'===================================
close1:
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True
RABottomLineA.Cells(0, 1).Select
Application.ScreenUpdating = True
End Sub

Private Sub Account_FinalRow()
Dim y As Integer
Call Account_RefSet
y = ActSheet.Range("AI5") + 1
RAItemA.Cells(y, 1).Select
End Sub

Private Sub PrintIncomeCost_Click()
ActiveSheet.PageSetup.PrintArea = "B2:AG48"
ActiveSheet.PrintPreview
ActiveSheet.PageSetup.PrintArea = "$AQ2:AU2"
End Sub

Private Sub PrintFinancialReport_Click()
ActiveSheet.PageSetup.PrintArea = "B50:AG113"
ActiveSheet.PrintPreview
ActiveSheet.PageSetup.PrintArea = "$AQ2:AU2"
End Sub

Private Sub UpdateOldData()
UpdateData.Show
End Sub

Private Sub HideUpperRow()
    Application.ScreenUpdating = False
    Rows("3:15").Select
    Selection.EntireRow.Hidden = True
    Month01.Select
    Calculate
    SummaryForm.Select
    Range("K1").Select
    Application.ScreenUpdating = True
End Sub

Private Sub ShowUpperRow()
    Application.ScreenUpdating = False
    Rows("2:15").Select
    Selection.EntireRow.Hidden = False
    Month01.Select
    Calculate
    SummaryForm.Select
    Range("K1").Select
    Application.ScreenUpdating = True
End Sub

Private Sub ShowHidebroadcast()
    Dim Actcell As String
    Application.ScreenUpdating = False
    Actcell = Selection.Address
    If Range("N1") = 0 Then
    Columns("L:N").Select
    Selection.EntireColumn.Hidden = True
    Range("N1") = 1
    Else
    Columns("L:N").Select
    Selection.EntireColumn.Hidden = False
    Range("N1") = 0
    End If
    Range(Actcell).Select
    Application.ScreenUpdating = True
End Sub

Private Sub SummaryFormProtect()
    Application.ScreenUpdating = False
    If Range("AQ1") = True Then
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
    Else
    ActiveSheet.Unprotect
    End If
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Month01"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Month02"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month03"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Month04"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month06"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month07"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month08"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month09"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Month11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Month12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "SHRFo"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "ShBlank"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ShSetup"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SummaryChart"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SummaryForm"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Workbook_Open()
'If Sheets("|fffd|]|fffd|w").Range("F200") = "11" Then
'MsgBox _
'"|fffd|w|fffd||fffd||3e5||3b4|I|fffd|B|fffd||370|O|fffd|b|fffd||fffd|" & vbCrLf & _
'" " & vbCrLf & _
'":: |fffd||337|s|fffd||fffd||fffd||fffd||fffd||428||cce1||fffd||fffd||fffd||fffd|ihttp://blog.17rich.com|fffd|j|fffd|U|fffd||fffd|" & vbCrLf & _
'" " & vbCrLf & _
'":: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|p|fffd||6e5||3a9||fffd||4f7|~|fffd||6b30||fffd|A|fffd||fffd||fffd|v|fffd||774|I|fffd|B|fffd||369||4a6||fffd|" & vbCrLf & _
'" " & vbCrLf & _
'":: |fffd||fffd||fffd||4f7|||fffd||326||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd||4966||fffd|z|fffd|]|fffd|\|fffd||fffd|A|fffd||fffd||133||fffd||fffd||fffd|n|fffd||730||2ae||69a1|" & vbCrLf & _
'" " & vbCrLf & _
'"(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||124|@|fffd||fffd||fffd||3e5||3ae||264|~|fffd|||fffd|X|fffd|{|fffd|A|fffd||fffd||fffd||6b30||fffd||fffd||fffd|s|fffd||429||fffd||7e8||3e5||fffd|)" _
', , "|fffd|w|fffd||fffd|T|fffd||fffd|"
'Sheets("|fffd|]|fffd|w").Range("F200") = ""
'End If
'End Sub
Attribute VB_Name = "UpdateData"
Attribute VB_Base = "0{A4299B69-B3A3-4723-BC77-143F78CC0847}{0B0EDF0E-BA48-481D-A7C6-AC15A8637399}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Activate()
    UpdateData.Height = 143
    UpdateData.LabelProgress.Width = 0
End Sub

Private Sub UpdateCancel_Click()
Unload Me
End Sub

Private Sub ButtonFind_Click()
Dim WorkName, WorkNameFullN, WorkNameFromFullN As String
On Error Resume Next
    WorkName = ActiveWorkbook.Name
    WorkNameFullN = ActiveWorkbook.FullName
close2:  WorkNameFromFullN = Application.GetOpenFilename
    If WorkNameFromFullN = WorkNameFullN Then
    MsgBox "|fffd||fffd||fffd||fffd||fffd||726|P|fffd|@|fffd||fffd||fffd||26e||5e7||fffd|s|fffd|I", 16
    GoTo close2
    End If
    TextBox1.Value = WorkNameFromFullN
End Sub

Private Sub UpdateConfirm_Click()
    Dim k, H, U, CountA, CountBOld, CountBNew, x, RANewNum, n, i, j, L, TempNum As Integer
    Dim ActSheet, SCH As Worksheet
    Dim RAItemA, RAItemZ, RABottomLineS, RABottomLineA, RABottomLineZ As Range
    Dim WorkName, WorkNameFrom, WorkNameFullN, WorkNameFromFullN, theSheet As String
    Dim SumFormSheet, SetupSheet, ListSheet, AssetSheet, BudgetSheet, FReportSheet As String
    Dim varSheet, MonSheet As Variant
    Dim m, Pct, PctTotal, PctDone As Single
    
    SetupSheet = ShSetup.Name
    AssetSheet = Asset.Name
    ListSheet = List.Name
    BudgetSheet = Budget.Name
    FReportSheet = FReport.Name
    SumFormSheet = SummaryForm.Name
    MonSheet = Array(Month01.Name, Month02.Name, Month03.Name, Month04.Name, Month05.Name, Month06.Name, _
                     Month07.Name, Month08.Name, Month09.Name, Month10.Name, Month11.Name, Month12.Name)
    
    WorkNameFromFullN = TextBox1.Value
    WorkName = ActiveWorkbook.Name
    WorkNameFullN = ActiveWorkbook.FullName
    If WorkNameFromFullN = "" Then
        MsgBox "|fffd||4f7||fffd||fffd||26e||5e6|W|fffd||66a||165||561|A|fffd||43f||fffd|J|fffd||26e||5f8||fffd||fffd|||fffd|P|fffd|W|fffd||669||3bf||fffd||728||4f7||fffd||fffd||26e||fffd|" & vbCrLf, 48
        TextBox1.SetFocus
        Exit Sub
    End If

'====|fffd||fffd||fffd|@|fffd||fffd||736||5e4|J|fffd||b8||fffd||fffd|====
If InsertOLDbook Then
    If MsgBox("|fffd||5e4|J|fffd||b0|O|fffd|b|fffd||fffd||fffd||fffd||fffd||fffd||1b1|N|fffd|Q|fffd||43b|\|fffd|A|fffd|T|fffd|w|fffd|n|fffd||5e4|J|fffd||fffd||1b6||721|H" & vbCrLf & "|fffd||fffd||fffd|T|fffd|w|fffd||42b||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|U|fffd|T|fffd|w|fffd|}|fffd|l|fffd||5e4|J", _
    1 + 32 + 256, "|fffd||fffd||fffd||fffd|") = vbCancel Then GoTo close1
    UpdateData.Height = 183.75
    PctTotal = 20
    Pct = 0
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Workbooks.Open FileName:=WorkNameFromFullN
    WorkNameFrom = ActiveWorkbook.Name

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    k = Range("J4")

  If k <> "" Then

    m = 1
    For Each varSheet In MonSheet
'=====|fffd||5e4|J|fffd||fffd||fffd||26e||5e5||fffd||fffd||fffd|z|fffd|]|fffd|O|fffd||fffd|======
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Select
    ActiveSheet.Unprotect
    Cells.Find(What:="MonthNote", After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, MatchByte:=False, SearchFormat:=False).Activate
    H = Application.ActiveCell.Row
    Range("AH" & H + 2, "AM" & H + 17).Select
    Selection.Copy
    Windows(WorkName).Activate
    Cells.Find(What:="MonthNote", After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, MatchByte:=False, SearchFormat:=False).Activate
    U = Application.ActiveCell.Row
    Range("AH" & U + 2, "AM" & U + 17).Select
    ActiveSheet.Paste
    Range("AH7").Select
'-------------------------------------------
    Pct = (m - 0.9) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------

'======|fffd|P|fffd|_|fffd||4e4||b9b3||fffd|S|fffd||fffd||fffd|O|fffd|b|fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Select
    CountA = Range("AI5")
    CountBOld = Range("AG5")
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    CountBNew = Range("AG5")
    If CountA = 0 Then GoTo 3 '|fffd|p|fffd|G|fffd|S|fffd||fffd||fffd|O|fffd|b|fffd||fffd||1b4|N|fffd||fffd||fffd|U|fffd|@|fffd||4e4||fffd|

'======|fffd|O|fffd|b|fffd|q|fffd||3b0||477||4f3|]|fffd|w=====
    Set ActSheet = ThisWorkbook.ActiveSheet
    With ActSheet
        x = Range("B1").Value
        Set RAItemA = .Range("RAItemA" & "_" & x):
        Set RABottomLineS = .Range("RABottomLineS" & "_" & x)
        Set RAItemZ = RAItemA.Cells(1, 6)
        Set RABottomLineA = RABottomLineS.Cells(1, 2)
        Set RABottomLineZ = RABottomLineS.Cells(1, 8)
        '-------------------------------------------------------------
    End With

'-------------------------------------------
    Pct = (m - 0.8) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------
'======|fffd|s|fffd|W|fffd||4bb||76d|n|fffd||fffd||fffd||165||56a||fffd||fffd||fffd|===============
    If CountBOld > CountBNew Then
    RANewNum = CountBOld - CountBNew
    ShBlank.Range("B1:J" & RANewNum).Copy
    Range(RABottomLineS.Cells(1, 1), RABottomLineZ(1, 1)).Insert Shift:=xlDown
    Range(RABottomLineA, RABottomLineZ).ClearContents
    End If

'=======|fffd||1bb|s|fffd||4e4||fffd||fffd||ac|y|fffd||fffd||fffd|b|fffd||fffd||fffd|==============
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Select
    Range("AH7:AM" & CountBOld + 6).Select 'CountBOld + 6 |fffd|]|fffd||fffd||fffd||1be||6ac|O|fffd|qRow7|fffd|}|fffd|l
    Selection.Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("AH7").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("AH7").Select
'-------------------------------------------
    Pct = (m - 0.7) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------
        
'======|fffd||5e4|J|fffd||fffd||fffd||b9ac||fffd|J|fffd|i|fffd|b|fffd||fffd|=========
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("N10:O18").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("N10").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

'======|fffd||5e4|J|fffd||226||fffd||1b5||fffd|=======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("AB96:AD106").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("AB96").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

'-------------------------------------------
    Pct = (m - 0.6) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------

'======|fffd||5e4|J|fffd|T|fffd|w|fffd||fffd|X|fffd||fffd||2a4||fffd|I|fffd||89a1|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("J50:M69").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("J50").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|T|fffd|w|fffd||fffd|X|fffd||fffd||2bf||fffd|J|fffd||fffd||fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("N50:S69").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("N50").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|T|fffd|w|fffd||fffd|X|fffd||fffd||2bf||fffd|J|fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("T50:W69").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("T50").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

'-------------------------------------------
    Pct = (m - 0.5) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------
    
        
'======|fffd||5e4|J|fffd|U|fffd||6a4||fffd|X|fffd||fffd||2a4||fffd|I|fffd||89a1|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("J74:M81").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("J74").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|U|fffd||6a4||fffd|X|fffd||fffd||2bf||fffd|J|fffd||fffd||fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("N74:S81").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("N74").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

'-------------------------------------------
    Pct = (m - 0.4) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------
'======|fffd||5e4|J|fffd|U|fffd||6a4||fffd|X|fffd||fffd||2bf||fffd|J|fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("T74:W81").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("T74").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|U|fffd||6a4||fffd|X|fffd||1b5||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("AB74:AD81").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("AB74").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        
'---------------------------------------------
    Pct = (m - 0.3) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||5e4|J|fffd|S|fffd|O|fffd||fffd|X|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("E86:I91").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("E86").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|S|fffd|O|fffd||fffd|X|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("J86:M91").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("J86").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|S|fffd|O|fffd||fffd|X|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("N86:S91").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("N86").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|S|fffd|O|fffd||fffd|X|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("T86:W91").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("T86").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|S|fffd|O|fffd||fffd|X|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("X86:AD91").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("X86").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

'-------------------------------------------
    Pct = (m - 0.2) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------
    

'======|fffd||5e4|J|fffd|H|fffd||3a5|d|fffd||3e5||fffd||fffd||fffd||fa||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("N110:S119").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("N110").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fffd|H|fffd||3a5|d|fffd||fffd||fa||fffd||6a4||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("AB110:AD119").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("AB110").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
'-------------------------------------------
    Pct = (m - 0.1) * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------


'======|fffd||5e4|J|fa||fffd|U|fffd||6b0||3e5||fffd||fffd||fffd||fffd||665||fffd||fffd||fffd|=======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("N124:S131").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("N124").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
'======|fffd||5e4|J|fa||fffd|U|fffd||6b0||3f3||1b5||fffd|=======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Range("AB124:AD131").Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("AB124").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        

3:  Range("AH7").Select

    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True

'---------------------------------------------
    Pct = m * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    m = m + 1
    Next varSheet


'======|fffd||5e4|J|fffd|]|fffd|w|fffd||fffd||fffd|======
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    ActiveSheet.Unprotect
    Range("B10:J124").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("B10:C10").Select
    ActiveSheet.Paste

'---------------------------------------------
    Pct = Pct + 0.33
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("J4:J7").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("J4:J7").Select
    ActiveSheet.Paste
    
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("M4:M102").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("M4").Select
    ActiveSheet.Paste
    Range("J6").Select
    
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True                                              '|fffd|]|fffd|w|fffd|O|fffd|@|fffd|u|fffd|@|fffd||fffd|
        
'---------------------------------------------
    Pct = Pct + 0.33
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    
    

'======|fffd||5e4|J|fffd||aca3||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd|O&|fffd||fffd||fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("F2:G6").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("F2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("I2:J6").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("I2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

'---------------------------------------------
    Pct = Pct + 0.33
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||5e4|J|fffd||aca3||fffd||fffd||fffd||fffd||fffd||fffd|P|fffd|R|fffd|i|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("B34:E1033").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("B34").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("B34").Select

'---------------------------------------------
    Pct = Pct + 0.33
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


'======|fffd||5e4|J|fffd|M|fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(ListSheet).Range("B4:B28").Copy
    Windows(WorkName).Activate
    Sheets(ListSheet).Select
    Range("B4:B28").Select
    ActiveSheet.Paste
    Windows(WorkNameFrom).Activate
    Sheets(ListSheet).Range("AU4:BT28").Copy
    Windows(WorkName).Activate
    Sheets(ListSheet).Select
    Range("AU4:BT28").Select
    ActiveSheet.Paste
    Range("B4").Select

'---------------------------------------------
    Pct = Pct + 0.33
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    

'======|fffd||5e4|J|fffd||fffd||fffd|i|fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(FReportSheet).Select
    Range("P157:P164").Copy
    Windows(WorkName).Activate
    Sheets(FReportSheet).Select
    Range("P157").Select
    ActiveSheet.Paste

    Windows(WorkNameFrom).Activate
    Sheets(FReportSheet).Select
    Range("G125:AG126").Copy
    Windows(WorkName).Activate
    Sheets(FReportSheet).Select
    Range("G125:AG126").Select
    ActiveSheet.Paste
    Range("B2").Select
    
'---------------------------------------------
    Pct = Pct + 0.33
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


'======|fffd||5e4|J|fffd|w|fffd||fffd||fffd|======
    Windows(WorkName).Activate
    Sheets(BudgetSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(BudgetSheet).Select
    ActiveSheet.Unprotect
    Range("D4:AM49").Copy
    Windows(WorkName).Activate
    Sheets(BudgetSheet).Select
    Range("D4").Select
    ActiveSheet.Paste
    Range("D4").Select
    
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True                                              '|fffd|]|fffd|w|fffd|O|fffd|@|fffd|u|fffd|@|fffd||fffd|
    
'---------------------------------------------
    PctDone = 1
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

Else

MsgBox "|fffd||fffd||fffd||fffd||fffd||5e4|J 2.x |fffd||fffd||fffd||fffd||fffd||fffd||1a1|A|fffd|]|fffd||fffd||fffd|s|fffd||fffd||fffd||69a1||fffd|t|fffd||fffd||fffd|A" & vbCrLf & _
"|fffd|n|fffd||fffd|u|fffd|||fffd||6f0||2b6||5e4|J|fffd||aa||fffd||fffd|C|fffd||baba||fffd|y|fffd||fffd||fffd|b|fffd|B|fffd|]|fffd|w|fffd|P|fffd|M|fffd||fffd|C" & vbCrLf & _
"|fffd||5e4|J|fffd||fffd||fffd||fffd||fffd||424||fffd||2bd||1bb|s|fffd|H|fffd|U|fffd||fffd||1a1|G" & vbCrLf & _
"|fffd|D|fffd|u|fffd|@|fffd||fffd||fffd|i|fffd||aca3||fffd|j|fffd||fffd||fffd|" & vbCrLf & _
"|fffd|D|fffd|C|fffd||fffd||fffd||fffd|T|fffd|w|fffd||fffd|X" & vbCrLf & _
"|fffd|D|fffd|C|fffd||fffd||fffd||fffd|U|fffd||6a4||fffd|X" & vbCrLf & _
"|fffd|D|fffd|C|fffd||fffd||fffd||fffd|H|fffd||3a5|d|fa||fffd|O|fffd||fffd||fffd|B"

    m = 1
    For Each varSheet In MonSheet
'==================================
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Select
    ActiveSheet.Unprotect

'======|fffd|P|fffd|_|fffd||4e4||b9b3||fffd|S|fffd||fffd||fffd|O|fffd|b|fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Select
    CountA = Range("AG5")
    CountBOld = Range("AB5")
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    CountBNew = Range("AG5")
    If CountA = 0 Then GoTo 4 '|fffd|p|fffd|G|fffd|S|fffd||fffd||fffd|O|fffd|b|fffd||fffd||1b4|N|fffd||fffd||fffd|U|fffd|@|fffd||4e4||fffd|

'======|fffd|O|fffd|b|fffd|q|fffd||3b0||477||4f3|]|fffd|w=====
    Set ActSheet = ThisWorkbook.ActiveSheet
    With ActSheet
        x = Range("B1").Value
        Set RAItemA = .Range("RAItemA" & "_" & x):
        Set RABottomLineS = .Range("RABottomLineS" & "_" & x)
        Set RAItemZ = RAItemA.Cells(1, 6)
        Set RABottomLineA = RABottomLineS.Cells(1, 2)
        Set RABottomLineZ = RABottomLineS.Cells(1, 8)
        '-------------------------------------------------------------
    End With

'======|fffd|s|fffd|W|fffd||4bb||76d|n|fffd||fffd||fffd||165||56a||fffd||fffd||fffd|===============
    If CountBOld > CountBNew Then
    RANewNum = CountBOld - CountBNew
    ShBlank.Range("B1:J" & RANewNum).Copy
    Range(RABottomLineS.Cells(1, 1), RABottomLineZ(1, 1)).Insert Shift:=xlDown
    Range(RABottomLineA, RABottomLineZ).ClearContents
    End If

'=======|fffd||1bb|s|fffd||4e4||fffd||fffd||ac|y|fffd||fffd||fffd|b|fffd||fffd||fffd|==============
    Windows(WorkNameFrom).Activate
    Sheets(varSheet).Select
    Range("AC7:AH" & CountBOld + 6).Select 'CountBOld + 6 |fffd|]|fffd||fffd||fffd||1be||6ac|O|fffd|qRow7|fffd|}|fffd|l
    Selection.Copy
    Windows(WorkName).Activate
    Sheets(varSheet).Select
    Range("AH7").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

4:  Range("AH7").Select
    
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True

'-------------------------------------------
    Pct = m * 1.5
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'-------------------------------------------

    m = m + 1
    Next varSheet

'======|fffd||5e4|J|fffd|M|fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(ListSheet).Range("B4:B18").Copy
    Windows(WorkName).Activate
    Sheets(ListSheet).Select
    Range("B4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Windows(WorkNameFrom).Activate
    Sheets(ListSheet).Range("Y4:AN18").Copy
    Windows(WorkName).Activate
    Sheets(ListSheet).Select
    Range("AU4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("B4").Select

'---------------------------------------------
    PctDone = 0.93
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||5e4|J|fffd|]|fffd|w======
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    ActiveSheet.Unprotect
    Range("B10:J43").Select
    With Selection.Borders(xlInsideHorizontal)
        .Weight = xlThin
    End With

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("B11:E18").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("B11").Select
    ActiveSheet.Paste

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("B20:C34").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("B22").Select
    ActiveSheet.Paste

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("B36:C43").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("B43").Select
    ActiveSheet.Paste

'---------------------------------------------
    PctDone = 0.95
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("G11:H18").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("G11").Select
    ActiveSheet.Paste

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("I11:J16").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("I11").Select
    ActiveSheet.Paste

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("G20:H24").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("G22").Select
    ActiveSheet.Paste

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("M4:M102").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("M4").Select
    ActiveSheet.Paste

    Range("B10:C10,D10:E10,G10:H10,I10:J10,B21:C21,D21:E21,G21:H21,B42:C42,D42:E42").Select
    With Selection.Borders
        .Weight = xlMedium
    End With

'---------------------------------------------
    PctDone = 0.96
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'=====|fffd||fffd|J|fffd|`|fffd||fffd||fffd|}|fffd|l|fffd|O|fffd|b|fffd||fffd||fffd|=====
    Windows(WorkName).Activate
    Sheets(SumFormSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(SumFormSheet).Select
    ActiveSheet.Unprotect
    TempNum = Range("O5").Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("J5").Select
    ActiveCell.FormulaR1C1 = TempNum
    Range("J4").Select
    ActiveCell.FormulaR1C1 = Year(Date)
    Sheets(SumFormSheet).Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
    
'=====|fffd||fffd|J|fffd||aa||fffd||fffd|]|fffd||226||6e5||46a||fffd||fffd|B======
    For j = 53 To 60
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    i = Range("D" & j).Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("D" & j + 6).Select
    ActiveCell.FormulaR1C1 = i
    Next j

'=====|fffd||fffd|J|fffd||aa||fffd||fffd||226||fffd||fffd||fffd|B======
    For j = 53 To 60
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    i = Range("I" & j).Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("D" & j + 17).Select
    ActiveCell.FormulaR1C1 = i
    Next j

'---------------------------------------------
    PctDone = 0.97
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'=====|fffd||fffd|J|fffd||aa||fffd||fffd|U|fffd||6aa||fffd||fffd|B======
    For j = 64 To 71
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    i = Range("D" & j).Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("D" & j + 19).Select
    ActiveCell.FormulaR1C1 = i
    Next j

'=====|fffd||fffd|J|fffd||aa||fffd||fffd|H|fffd||3a5|d|fffd||fffd||fa||fffd||fffd||fffd|B======
    For j = 64 To 69
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    i = Range("I" & j).Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("I" & j + 6).Select
    ActiveCell.FormulaR1C1 = i
    Next j

'=====|fffd||fffd|J|fffd||aa||fffd||fffd|q|fffd|l|fffd||fffd||fffd|]|fffd||fffd||fa||fffd||fffd||fffd|B======
    For j = 75 To 79
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    i = Range("D" & j).Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("I" & j - 16).Select
    ActiveCell.FormulaR1C1 = i
    Next j

'=====|fffd||fffd|J|fffd||aa||fffd||fffd||fffd|l|fffd|i|fffd||3aa||fffd||fffd|B
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    i = Range("C48").Value
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("C54").Select
    ActiveCell.FormulaR1C1 = i

    
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True

'---------------------------------------------
    PctDone = 1
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


  End If

'=====|fffd||fffd||fffd||fffd||fffd||fffd||fffd||26e||fffd|=====
Windows(WorkNameFrom).Close
Windows(WorkName).Activate
Month01.Select
Application.CalculateFullRebuild
Sheets(SetupSheet).Select
Range("J6").Select
Application.DisplayAlerts = True
Application.ScreenUpdating = True
ActiveWorkbook.Save

'=======|fffd||fffd||fffd||fffd||fffd||1bb|s|fffd||fffd||fffd|======
    Unload Me
    MsgBox "|fffd||5e4|J|fffd||b0|O|fffd|b|fffd||fffd||fffd||fffd||fffd|\|fffd|I"
    Exit Sub
End If



'===========|fffd||fffd||735||fffd||fffd||fffd|h|fffd|~|fffd||fffd||fffd|====================================================================================
'===============================================================================================================
If TransLYData Then
    If MsgBox("|fffd||fffd||fffd||fffd|h|fffd|~|fffd||fffd||1ab||fffd|~|fffd||5f8||fffd||1b1|N|fffd|Q|fffd||43b|\|fffd|A|fffd|T|fffd|w|fffd|n|fffd||fffd||fffd||fffd||721|H" & vbCrLf & _
    "|fffd||fffd||fffd|T|fffd|w|fffd||42b||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|U|fffd|T|fffd|w|fffd||fffd|}|fffd|l|fffd||fffd||fffd||fffd|C", 1 + 32 + 256, "|fffd||fffd||fffd||fffd|") = vbCancel Then GoTo close1
    UpdateData.Height = 183.75
    PctTotal = 20
    Pct = 0
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    Workbooks.Open FileName:=WorkNameFromFullN
    WorkNameFrom = Excel.ActiveWorkbook.Name

    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    k = Range("J4")

  If k <> "" Then
    
'======|fffd||5e4|J|fffd|]|fffd|w|fffd||fffd||fffd|======
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    ActiveSheet.Unprotect
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    ActiveSheet.Unprotect
    Range("B10:J50").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("B10:C10").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("B95:J124").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("B95").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("M4:M102").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("M4").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
    
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Range("J4:J7").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("J4:J7").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


'======|fffd||5e4|J|fffd|M|fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(ListSheet).Range("B4:B28").Copy
    Windows(WorkName).Activate
    Sheets(ListSheet).Select
    Range("B4:B28").Select
    ActiveSheet.Paste
    Windows(WorkNameFrom).Activate
    Sheets(ListSheet).Range("AU4:BT28").Copy
    Windows(WorkName).Activate
    Sheets(ListSheet).Select
    Range("AU4:BT28").Select
    ActiveSheet.Paste
    Range("B4").Select
'---------------------------------------------
    Pct = Pct + 0.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


'======|fffd||5e4|J|fffd||aca3||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd|O&|fffd||fffd||fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("F2:F6").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("F2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("H2:H6").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("G2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("I2:I6").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("I2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

    Windows(WorkNameFrom).Activate
    Sheets(AssetSheet).Range("K2:K6").Copy
    Windows(WorkName).Activate
    Sheets(AssetSheet).Select
    Range("J2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("B34").Select

'---------------------------------------------
    Pct = Pct + 1
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd|l|fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Select
    Sheets(SetupSheet).Range("E236:E237").Copy
    Range("E236").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("E236:E237").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("C54").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
        
'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd|{|fffd||fffd||fffd|l|fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Range("H236:H237").Copy
    Range("H236").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("H236:H237").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("E54").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------
        
'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd|]|fffd||233|W|fffd||fffd||fffd||fffd||fffd|B======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Range("D240:E247").Copy
    Range("D240").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("D240:E247").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("D59:E66").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd|q|fffd|l|fffd||fffd||fffd|]======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Range("I240:J247").Copy
    Range("I240").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("I240:J247").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("I59:J66").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd||226||fffd|s|fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Range("D251:E260").Copy
    Range("D251").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("D251:E260").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("D70:E79").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd|H|fffd||3a5|d|fffd|||fffd||fffd||fa||fffd|M======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Range("I251:J260").Copy
    Range("I251").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("I251:J260").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("I70:J79").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

'======|fffd||fffd||fffd||fffd|h|fffd|~|fffd|U|fffd||6b3||47e|l|fffd||fffd||fffd||fffd|======
    Windows(WorkNameFrom).Activate
    Sheets(SetupSheet).Range("D264:E271").Copy
    Range("D264").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets(SetupSheet).Range("D264:E271").Copy
    Windows(WorkName).Activate
    Sheets(SetupSheet).Select
    Range("D83:E90").Select
    ActiveSheet.Paste
'---------------------------------------------
    Pct = Pct + 1.6
    PctDone = Pct / PctTotal
    Call UpdateProgressBar(PctDone)
'---------------------------------------------


    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True '|fffd|]|fffd|w|fffd|O|fffd|@|fffd|u|fffd|@|fffd||fffd|
        
    Range("J6").Select

'---------------------------------------------
    PctDone = 0.99
    Call UpdateProgressBar(PctDone)
'---------------------------------------------

    Windows(WorkNameFrom).Close
    Windows(WorkName).Activate
    ActiveWorkbook.Save
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Unload Me
    MsgBox "|fffd||fffd||fffd||fffd|h|fffd|~|fffd|O|fffd|b|fffd||fffd||1a6||fffd||fffd|\"

Else

    Windows(WorkNameFrom).Close
    Windows(WorkName).Activate
    ActiveWorkbook.Save
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Unload Me
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2.x |fffd||fffd||fffd||fffd||fffd||fffd||1a1|A|fffd||fffd||fffd|A|fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A" & vbCrLf & _
    "|fffd||425||fffd||fffd||5e4|J|fffd||b0|O|fffd|b|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||d72||fffd|l|fffd||fffd||fffd|"

End If

    Exit Sub

End If

    MsgBox "|fffd||43f||fffd||738||fffd||1a7||fffd|s|fffd||fffd||fffd||fffd|" ' no choose update item

close1: End Sub

Sub UpdateProgressBar(PctDone As Single)
    With UpdateData
        .ProgressTitle.Caption = Format(PctDone, "0% |fffd|w|fffd||fffd||fffd||fffd|")
        .WarnningLabel.Caption = "|fffd||fffd||1a7||fffd|s|fffd||fffd||fffd||424||17e||7a7|@|fffd|q|fffd||fffd|"
        .LabelProgress.Width = PctDone * (.FrameProgress.Width)
        .LabelProgress.BackColor = RGB(49, 139, 245)
    End With

    ' The DoEvents allows the UserForm to update.
    DoEvents
End Sub




INQUEST-PP=macro
