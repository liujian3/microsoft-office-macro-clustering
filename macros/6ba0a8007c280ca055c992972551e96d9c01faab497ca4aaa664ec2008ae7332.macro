Attribute VB_Name = "A_Pasta"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public G_Salva_Html As Boolean
Public UltimaPlan As String
Public ultimaCelula As String

Private Sub Workbook_Open()
'    Exit Sub
    On Error Resume Next
    Application.DisplayFullScreen = False
    ActiveWindow.WindowState = xlMaximized
    'Prepara o ambiente para dar mais espaco ha planilha....
    Application.CommandBars("Standard").Visible = False
    Application.CommandBars("Formatting").Visible = False
    Application.DisplayStatusBar = False
    Application.DisplayFormulaBar = False
'    ActiveWindow.Zoom = 85
    Application.Caption = ""

'   Emagrece a barra de menus, deixando so ARQUIVO...
    Application.CommandBars("Worksheet Menu Bar").Controls(10).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(7).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(8).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(5).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(5).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(4).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(3).Delete
    Application.CommandBars("Worksheet Menu Bar").Controls(2).Delete

    'Coloca o ZOOM na barra...
    Application.CommandBars("Worksheet Menu Bar").Controls.Add Type:= _
        msoControlComboBox, ID:=1733, Before:=2
        
    'Call MenuSig
    G_Salva_Html = False
    
End Sub
Private Sub Workbook_BeforeClose(Cancel As Boolean)

    On Error Resume Next
    'Restaura o ambiente para o DEFAULT do excel...

    Application.DisplayFullScreen = False
    Application.CommandBars("Standard").Visible = True
    Application.CommandBars("Formatting").Visible = True
    Application.DisplayStatusBar = True
    Application.DisplayFormulaBar = True
    ActiveWindow.Zoom = 100

    Application.CommandBars("Worksheet Menu Bar").Reset
    Application.CommandBars("Standard").Reset

    ThisWorkbook.Saved = True
    Application.Quit
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    ThisWorkbook.Saved = True
    Cancel = False
End Sub



Private Sub Workbook_SheetActivate(ByVal Sh As Object)
On Error Resume Next
    
    'n|fffd|o executa nesta planilha, caso contr|fffd|rio entraria em loop eterno
    If Sh.Name = PlanD6G7.Name Or Sh.Name = PlanD6.Name Then
        Exit Sub
    End If
    
    'Executa a fun|fffd||fffd|o Click_Grafico sempre que existir na sheet - para n|fffd|o precisar clicar nos graficos para atualizar
    'Trata a planilha Cesareanas pois esta ativa outras planilhas e se ativa, entrando em loop - quando n|fffd|o tratada
    If Sh.Name = "Cesarianas" Then
        If Range("D37") = 1 And Range("D38") = 1 Then
            Sheets(Sh.Name).Click_Grafico
        End If
    Else
        Sheets(Sh.Name).Click_Grafico
    End If
End Sub
Attribute VB_Name = "Abertura"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Impr8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ModComp"
Public LinhaSoma

Sub CompFim()
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
End Sub

Sub Calcula()
Attribute Calcula.VB_Description = "Macro recorded 09/11/2001 by Rodrigo"
Attribute Calcula.VB_ProcData.VB_Invoke_Func = " \n14"
    On Error Resume Next
    
    'Seleciona a celula mae da regiao
    LinhaSoma = 9 + Range("H9").CurrentRegion.Rows.Count - 1
    
    'Coloca as formulas...
    For lin = 10 To LinhaSoma - 1
       Range("K" & lin).Formula = Range("I" & lin).Value * Range("J" & lin).Value / 100
    Next lin

    'Traca a linha pontilhada...
    Range("C" & LinhaSoma & ":K" & LinhaSoma).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    
    'Escreve TOTAL...
    Range("C" & LinhaSoma).Select
    ActiveCell.Formula = "TOTAL"
    
    'Infec Observada...
    Range("H" & LinhaSoma).Select
    ActiveCell.Formula = "=SUM(H10:H" & (LinhaSoma - 1) & ")"
    InfecObs = Range("H" & LinhaSoma).Value
        
    'Cirurgias realizadas...
    Range("I" & LinhaSoma).Select
    ActiveCell.Formula = "=SUM(I10:I" & (LinhaSoma - 1) & ")"
    CirReal = Range("I" & LinhaSoma).Value
    
    'Infeccoes esperadas...
    Range("K" & LinhaSoma).Select
    ActiveCell.Formula = "=SUM(K10:K" & (LinhaSoma - 1) & ")"
    InfecEsp = Range("K" & LinhaSoma).Value
    
    'Taxa padronizada...
    Range("C" & Trim(Str(LinhaSoma + 2))).Select
    ActiveCell.FormulaR1C1 = "Taxa Padronizada :"
    
    'Calculo da taxa padronizada...
    If InfecEsp <> 0 Then
        taxapadron = InfecObs / InfecEsp
    End If
    Range("E" & Trim(Str(LinhaSoma + 2))).Select
    Selection.NumberFormat = "0.00"
    ActiveCell.Value = taxapadron
    
    'Estatistica...
    numerador = (taxapadron / 100) - 0.01
    If CirReal <> 0 Then
        denominador = Sqr((taxapadron / 100) * (1 - (taxapadron / 100)) / CirReal)
    End If
    If denominador <> 0 Then
        ntotal = numerador / denominador
    End If
    Range("C" & Trim(Str(LinhaSoma + 3))).Select
    Selection.NumberFormat = "0.0000"
    ActiveCell.FormulaR1C1 = ntotal
    
    'Deducao...
    Range("E" & Trim(Str(LinhaSoma + 3))).Select
    Selection.Font.Bold = True
    If ntotal < 1.96 Then
       ActiveCell.FormulaR1C1 = " -> O n|fffd|mero de infec|fffd||fffd|es |fffd| MENOR OU IGUAL ao esperado."
       Selection.Font.ColorIndex = 50
    Else
       ActiveCell.FormulaR1C1 = " -> O n|fffd|mero de infec|fffd||fffd|es |fffd| MAIOR que o esperado."
       Selection.Font.ColorIndex = 3
    End If
End Sub

Sub Limpa()
Attribute Limpa.VB_Description = "Macro recorded 09/11/2001 by Rodrigo"
Attribute Limpa.VB_ProcData.VB_Invoke_Func = " \n14"
    On Error Resume Next
    
    'Limpa...
    Rows("10:300").Select
    Selection.Delete Shift:=xlUp
End Sub
Attribute VB_Name = "ModDesc1"
'Carrega os dados...
Public Sub Desc1_Q1( _
ByVal contador As Integer, _
ByVal DataInternacao As Date, _
ByVal DataAlta As Date, _
ByVal TipoSaida As String _
)
   
   On Error Resume Next
   'Copia os dados...
   
   Range("Cabec").Offset(contador + 1, -1).Value = 1
   Range("Cabec").Offset(contador + 1, 0).Value = DataInternacao
   'Valida data...
   If DataAlta = 0 Then
      Range("Cabec").Offset(contador + 1, 1).Value = ""
   Else
      Range("Cabec").Offset(contador + 1, 1).Value = DataAlta
   End If
   
   Range("Cabec").Offset(contador + 1, 2).Value = TipoSaida

End Sub

'Carrega os dados...
Public Sub Desc1_Q2( _
ByVal contador As Integer, _
ByVal CompCritico As String, _
ByVal DataAdmissao As Date, _
ByVal DataAlta As Date _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 2
   Range("Cabec").Offset(contador + 1, 0).Value = CompCritico
   Range("Cabec").Offset(contador + 1, 1).Value = DataAdmissao
   If DataAlta = 0 Then
      Range("Cabec").Offset(contador + 1, 2).Value = ""
   Else
      Range("Cabec").Offset(contador + 1, 2).Value = DataAlta
   End If
End Sub

'Carrega os dados...
Public Sub Desc1_Q2A( _
ByVal contador As Integer, _
ByVal ProcInvasivo As String, _
ByVal DataInicio As Date, _
ByVal DataFim As Date _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 21
   Range("Cabec").Offset(contador + 1, 0).Value = ProcInvasivo
   Range("Cabec").Offset(contador + 1, 1).Value = DataInicio
   If DataFim = 0 Then
      Range("Cabec").Offset(contador + 1, 2).Value = ""
   Else
      Range("Cabec").Offset(contador + 1, 2).Value = DataFim
   End If
End Sub

'Carrega os dados...
Public Sub Desc1_Q3( _
ByVal contador As Integer, _
ByVal UnidadeClinica As String, _
ByVal DataPedidoAntibiotico As Date, _
ByVal Indicacao As String, _
ByVal TipoInfeccao As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 3
   Range("Cabec").Offset(contador + 1, 0).Value = UnidadeClinica
   Range("Cabec").Offset(contador + 1, 1).Value = DataPedidoAntibiotico
   Range("Cabec").Offset(contador + 1, 2).Value = Indicacao
   Range("Cabec").Offset(contador + 1, 3).Value = TipoInfeccao
End Sub

'Carrega os dados...
Public Sub Desc1_Q3A( _
ByVal contador As Integer, _
ByVal Antibiotico As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 31
   Range("Cabec").Offset(contador + 1, 0).Value = Antibiotico
End Sub

'Carrega os dados...
Public Sub Desc1_Q3B( _
ByVal contador As Integer, _
ByVal Sitio As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 32
   Range("Cabec").Offset(contador + 1, 0).Value = Sitio
End Sub

'Carrega os dados...
Public Sub Desc1_Q4( _
ByVal contador As Integer, _
ByVal UnidadeClinica As String, _
ByVal DataCultura As Date, _
ByVal Infeccao As String, _
ByVal Material As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 4
   Range("Cabec").Offset(contador + 1, 0).Value = UnidadeClinica
   Range("Cabec").Offset(contador + 1, 1).Value = DataCultura
   Range("Cabec").Offset(contador + 1, 2).Value = Infeccao
   Range("Cabec").Offset(contador + 1, 3).Value = Material
End Sub

'Carrega os dados...
Public Sub Desc1_Q4A( _
ByVal contador As Integer, _
ByVal Germe As String, _
ByVal Sensibilidade As String, _
ByVal Multirresistente As Boolean _
)
   On Error Resume Next
   
   'Copia os dados...
   If Multirresistente Then
       Range("Cabec").Offset(contador + 1, -1).Value = 40
   Else
       Range("Cabec").Offset(contador + 1, -1).Value = 41
   End If

   Range("Cabec").Offset(contador + 1, 0).Value = Germe
   
   If Trim(Sensibilidade) <> "" Then
     Range("Cabec").Offset(contador + 1, 0).Select
     Range("Cabec").Offset(contador + 1, 0).AddComment
     Range("Cabec").Offset(contador + 1, 0).Comment.Visible = False
     'Substitui os <br> por uma quebra de verdade
     Sensibilidade = Replace(Sensibilidade, "<br>", Chr(10))
     Range("Cabec").Offset(contador + 1, 0).Comment.Text Text:=Sensibilidade
   End If
   
End Sub

'Carrega os dados...
Public Sub Desc1_Q4B( _
ByVal contador As Integer, _
ByVal Sitio As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 42
   Range("Cabec").Offset(contador + 1, 0).Value = Sitio
End Sub

'Carrega os dados...
Public Sub Desc1_Q5( _
ByVal contador As Integer, _
ByVal DataCirurgia As Date, _
ByVal Cirurgiao As String, _
ByVal Anestesista As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 5
   Range("Cabec").Offset(contador + 1, 0).Value = DataCirurgia
   Range("Cabec").Offset(contador + 1, 1).Value = Cirurgiao
   Range("Cabec").Offset(contador + 1, 2).Value = Anestesista
End Sub

'Carrega os dados...
Public Sub Desc1_Q5C( _
ByVal contador As Integer, _
ByVal ProcCirurgico As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 51
   Range("Cabec").Offset(contador + 1, 0).Value = ProcCirurgico
End Sub

'Carrega os dados...
Public Sub Desc1_Q5D( _
ByVal contador As Integer, _
ByVal Sitio As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 52
   Range("Cabec").Offset(contador + 1, 0).Value = Sitio
End Sub

'Carrega os dados...
Public Sub Desc1_Q6( _
ByVal contador As Integer, _
ByVal DataInfeccao As Date, _
ByVal Clinica As String, _
ByVal Sitio As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 6
   Range("Cabec").Offset(contador + 1, 0).Value = DataInfeccao
   Range("Cabec").Offset(contador + 1, 1).Value = Clinica
   Range("Cabec").Offset(contador + 1, 2).Value = Sitio
End Sub

'Carrega os dados...
Public Sub Desc1_Q7( _
ByVal contador As Integer, _
ByVal DataMotivo As Date, _
ByVal Evento As String, _
ByVal Motivo As String, _
ByVal Uclinica As String, _
ByVal UEspecialidade As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabec").Offset(contador + 1, -1).Value = 7
   
   'Consiste DataMotivo...
   If DataMotivo > 1 Then
      Range("Cabec").Offset(contador + 1, 0).Value = DataMotivo
   End If
   
   Range("Cabec").Offset(contador + 1, 1).Value = ConsisteString(Evento)
   Range("Cabec").Offset(contador + 1, 2).Value = ConsisteString(Motivo)
   Range("Cabec").Offset(contador + 1, 3).Value = ConsisteString(Uclinica)
   Range("Cabec").Offset(contador + 1, 4).Value = ConsisteString(UEspecialidade)
   
End Sub

''...
Public Sub Desc1_Fim( _
ByVal Registro As String, _
ByVal Nome As String, _
ByVal Idade As Integer _
)
'...
'Public Sub Desc1_Fim()
Dim Hea2, Hea3, Hea4, Hea5, Hea6, Hea7 As Boolean
Dim auxInicioFormata As Integer
        
    On Error Resume Next
    'GoTo fim

    Sheets("Desc1").Select
    Call PoeGrid(Range("Cabec"))

    'Inicializacoes...
    auxInicioFormata = 0
    Worksheets("Desc1Pac").Visible = True
    Sheets("Desc1Pac").Select
    Range("Cabecalhos").EntireRow.Hidden = False
    linhaRel = 38
    linhavez = 4
    umReg = Range("Desc1!A" & linhavez).Value

    'Stop
    'Loop dos regs...
    While umReg > 0

       '------------------------------------------------------------ 1
       If umReg = 1 Then
          linhaRel = linhaRel + 1
          'Copia o separador vermelho bonitinho...
          Range("Separador").Copy Destination:=Range("A" & linhaRel)
          Range("C" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("F" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("G" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          'Zera flags de header...
          Hea2 = False
          Hea3 = False
          Hea4 = False
          Hea5 = False
          Hea6 = False
          linhaRel = linhaRel + 1
       End If
       
       '------------------------------------------------------------ 2
       If umReg = 2 Then
          'Copia o header bonitinho...
          If Not Hea2 Then
             'Copia e destroi...
             Range("Hea2").Copy Destination:=Range("A" & linhaRel)
             'Prepara a ref da Formata...
             auxInicioFormata = linhaRel + 1
             'Avanca para o ponto dos dados...
             linhaRel = linhaRel + 2
             'Destroi...
             Hea2 = True
          End If
          'Copia o registro bonitinho...
          Range("Reg2").Copy Destination:=Range("B" & linhaRel)
          'Copia os 3 campos...
          Range("B" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("C" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("D" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          'Poe a linha...
          Range("B" & (linhaRel - 1) & ":G" & (linhaRel - 1)).Select
          With Selection.Borders(xlEdgeBottom)
              .LineStyle = xlContinuous
              .Weight = xlMedium
              .ColorIndex = xlAutomatic
          End With
          'Avanca para o ponto dos dados...
          linhaRel = linhaRel + 1
          
       End If
       
       '------------------------------------------------------------ 21
       If umReg = 21 Then
          'Copia o registro bonitinho...
          Range("Reg2A").Copy Destination:=Range("E" & linhaRel)
          'Copia os 3 campos...
          Range("E" & linhaRel).Value = Range("E" & linhaRel).Value & Range("Desc1!B" & linhavez).Value & ctSpc
          Range("F" & linhaRel).Value = Range("F" & linhaRel).Value & Range("Desc1!C" & linhavez).Value & ctSpc
          Range("G" & linhaRel).Value = Range("G" & linhaRel).Value & Range("Desc1!D" & linhavez).Value & ctSpc
          linhaRel = linhaRel + 1
       End If
       
       '------------------------------------------------------------ 3
       If umReg = 3 Then
          'Copia o header bonitinho...
          If Not Hea3 Then
             'Formata a anterior...
             Call MolduraDesc1(auxInicioFormata, linhaRel - 1)
             'Espaco entre secoes vermelinhas...
             'linhaRel = linhaRel + 2
             'Copia e destroi...
             Range("Hea3").Copy Destination:=Range("A" & linhaRel)
             'Prepara a ref da Formata...
             auxInicioFormata = linhaRel + 1
             'Avanca para o ponto dos dados...
             linhaRel = linhaRel + 2
             'Destroi...
             Hea3 = True
          End If
          'Copia o registro bonitinho...
          Range("Reg3").Copy Destination:=Range("B" & linhaRel)
          'Copia os 3 campos...
          Range("B" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("C" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("D" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          Range("E" & linhaRel).Value = Range("Desc1!E" & linhavez).Value
          'Poe a linha...
          Range("B" & (linhaRel - 1) & ":G" & (linhaRel - 1)).Select
          With Selection.Borders(xlEdgeBottom)
              .LineStyle = xlContinuous
              .Weight = xlMedium
              .ColorIndex = xlAutomatic
          End With
          linhaRel = linhaRel + 1
       End If
       
       '------------------------------------------------------------ 31
       If umReg = 31 Then
          'Copia o registro bonitinho...
          Range("Reg3").Copy Destination:=Range("B" & linhaRel)
          'Copia os 1 campos...
          Range("F" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          linhaRel = linhaRel + 1
       End If
     
       '------------------------------------------------------------ 32
       If umReg = 32 Then
          'Copia o registro bonitinho...
          Range("Reg3").Copy Destination:=Range("B" & linhaRel)
          'Copia os 1 campos...
          Range("G" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          linhaRel = linhaRel + 1
       End If
     
       '------------------------------------------------------------ 4
       If umReg = 4 Then
          'Copia o header bonitinho...
          If Not Hea4 Then
             'Formata a anterior...
             Call MolduraDesc1(auxInicioFormata, linhaRel - 1)
             'Espaco entre secoes vermelinhas...
             'linhaRel = linhaRel + 2
             'Copia e destroi...
             Range("Hea4").Copy Destination:=Range("A" & linhaRel)
             'Prepara a ref da Formata...
             auxInicioFormata = linhaRel + 1
             'Avanca para o ponto dos dados...
             linhaRel = linhaRel + 2
             'Destroi...
             Hea4 = True
          End If
          'Copia o registro bonitinho...
          Range("Reg4").Copy Destination:=Range("B" & linhaRel)
          'Copia os 3 campos...
          Range("B" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("C" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("D" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          Range("E" & linhaRel).Value = Range("Desc1!E" & linhavez).Value
          'Poe a linha...
          Range("B" & (linhaRel - 1) & ":G" & (linhaRel - 1)).Select
          With Selection.Borders(xlEdgeBottom)
              .LineStyle = xlContinuous
              .Weight = xlMedium
              .ColorIndex = xlAutomatic
          End With
          linhaRel = linhaRel + 1
       End If
       
       '------------------------------------------------------------ 40 ou 41
       If umReg = 40 Or umReg = 41 Then
          'Copia o registro bonitinho...
          Range("Reg4").Copy Destination:=Range("B" & linhaRel)
          'Copia os 1 campos...
          Range("F" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          
          If Trim(Range("Desc1!B" & linhavez).Comment.Text) <> "" Then
             Range("F" & linhaRel).Select
             Range("F" & linhaRel).AddComment
             Range("F" & linhaRel).Comment.Visible = False
             'Substitui os <br> por uma quebra de verdade
             Range("F" & linhaRel).Comment.Text Text:=Range("Desc1!B" & linhavez).Comment.Text
          End If
          
          'flag para multirresistente
          If umReg = 40 Then
            Range("F" & linhaRel).EntireRow.Select
            Selection.Font.Bold = True
            Selection.Font.Color = vbRed
          End If
          

          linhaRel = linhaRel + 1
       End If
     
       '------------------------------------------------------------ 42
       If umReg = 42 Then
          'Copia o registro bonitinho...
          Range("Reg4").Copy Destination:=Range("B" & linhaRel)
          'Copia os 1 campos...
          Range("G" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          linhaRel = linhaRel + 1
       End If

       '------------------------------------------------------------ 5
       If umReg = 5 Then
          'Copia o header bonitinho...
          If Not Hea5 Then
             'Formata a anterior...
             Call MolduraDesc1(auxInicioFormata, linhaRel - 1)
             'Espaco entre secoes vermelinhas...
             'linhaRel = linhaRel + 2
             'Copia e destroi...
             Range("Hea5").Copy Destination:=Range("A" & linhaRel)
             'Prepara a ref da Formata...
             auxInicioFormata = linhaRel + 1
             'Avanca para o ponto dos dados...
             linhaRel = linhaRel + 2
             'Destroi...
             Hea5 = True
          End If
          'Copia o registro bonitinho...
          Range("Reg5").Copy Destination:=Range("B" & linhaRel)
          'Copia os 3 campos...
          Range("B" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("C" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("E" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          'Poe a linha...
          Range("B" & (linhaRel - 1) & ":G" & (linhaRel - 1)).Select
          With Selection.Borders(xlEdgeBottom)
              .LineStyle = xlContinuous
              .Weight = xlMedium
              .ColorIndex = xlAutomatic
          End With
          linhaRel = linhaRel + 1
       End If
       
       '------------------------------------------------------------ 51
       If umReg = 51 Then
          'Copia o registro bonitinho...
          Range("Reg5").Copy Destination:=Range("B" & linhaRel)
          'Copia os 1 campos...
          Range("F" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          linhaRel = linhaRel + 1
       End If
     
       '------------------------------------------------------------ 52
       If umReg = 52 Then
          'Copia o registro bonitinho...
          Range("Reg5").Copy Destination:=Range("B" & linhaRel)
          'Copia os 1 campos...
          Range("G" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          linhaRel = linhaRel + 1
       End If

       '------------------------------------------------------------ 6
       If umReg = 6 Then
          'Copia o header bonitinho...
          If Not Hea6 Then
             'Formata a anterior...
             Call MolduraDesc1(auxInicioFormata, linhaRel - 1)
             'Espaco entre secoes vermelinhas...
             'linhaRel = linhaRel + 2
             'Copia e destroi...
             Range("Hea6").Copy Destination:=Range("A" & linhaRel)
             'Prepara a ref da Formata...
             auxInicioFormata = linhaRel + 1
             'Avanca para o ponto dos dados...
             linhaRel = linhaRel + 2
             'Destroi...
             Hea6 = True
          End If
          'Copia o registro bonitinho...
          Range("Reg6").Copy Destination:=Range("B" & linhaRel)
          'Copia os 3 campos...
          Range("B" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("C" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("G" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          linhaRel = linhaRel + 1
       End If

       '------------------------------------------------------------ 7
       If umReg = 7 Then
          'Copia o header bonitinho...
          If Not Hea7 Then
             'Formata a anterior...
             Call MolduraDesc1(auxInicioFormata, linhaRel - 1)
             'Espaco entre secoes vermelinhas...
             'linhaRel = linhaRel + 2
             'Copia e destroi...
             Range("Hea7").Copy Destination:=Range("A" & linhaRel)
             'Prepara a ref da Formata...
             auxInicioFormata = linhaRel + 1
             'Avanca para o ponto dos dados...
             linhaRel = linhaRel + 2
             'Destroi...
             Hea6 = True
          End If
          'Copia o registro bonitinho...
          Range("Reg7").Copy Destination:=Range("B" & linhaRel)
          'Copia os 3 campos...
          Range("B" & linhaRel).Value = Range("Desc1!B" & linhavez).Value
          Range("C" & linhaRel).Value = Range("Desc1!C" & linhavez).Value
          Range("E" & linhaRel).Value = Range("Desc1!D" & linhavez).Value
          Range("F" & linhaRel).Value = Range("Desc1!E" & linhavez).Value
          Range("G" & linhaRel).Value = Range("Desc1!F" & linhavez).Value
          linhaRel = linhaRel + 1
       End If
       
       '------------------------------------------------------------ AVANCA
       'Incrementa controles...
       linhavez = linhavez + 1
       umReg = Range("Desc1!A" & linhavez).Value
      
    Wend
    
fim:
    'Atualiza e exibe...
    Range("C2").Value = Registro
    Range("C4").Value = Nome
    Range("C5").Value = Idade

    'Posiciona la em cima...
    Range("C2").Select
    Range("Cabecalhos").EntireRow.Hidden = True

    'Muda o Tamanho de todos coment|fffd|rios
    Set myDocument = Worksheets(PlanD1Pac.Name)
    For Each s In myDocument.Shapes
        Select Case s.Type
        Case msoEmbeddedOLEObject, _
                msoLinkedOLEObject, _
                msoOLEControlObject, _
                msoLinkedPicture, msoPicture
            'Faz nada
        Case Else
            s.ScaleHeight 4, msoFalse
            s.ScaleWidth 1.5, msoFalse
        End Select
    Next

    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD1.Visible = False
    PlanD1.Name = "Paciente"
    
    Call Salva_Html

End Sub




Sub MolduraDesc1(Inicio As Integer, fim As Integer)
'
' Macro1 Macro
' Macro recorded 07/10/2002 by Rodrigo
'

'
    If Inicio = 0 Then
       Exit Sub
    End If
    'Stop
    Range("B" & Inicio & ":G" & fim).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Range("B38").Select
End Sub

Attribute VB_Name = "ModDesc2"
'Carrega os dados...
Public Sub Desc2_Q1( _
ByVal contador As Integer, _
ByVal Medico As String, _
ByVal DataCiru As Date, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Procedimento As String, _
ByVal tipo As String, _
ByVal ASA As Integer, _
ByVal Anestesista As String, _
ByVal SitioSec As String, _
ByVal SitioPri As String, _
ByVal Uclinica As String, _
ByVal TPHos As Integer, _
ByVal TPHosFaixa As String, _
ByVal tipoFerida As String, _
ByVal IRIC As String, _
ByVal StatusImport As String, _
ByVal TempoFerida As String, _
ByVal Video As String, _
ByVal Protese As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = ConsisteString(Medico)
   Range("Cabecalho").Offset(contador + 1, 1).Value = DataCiru
   Range("Cabecalho").Offset(contador + 1, 2).Value = ConsisteString(Registro)
   Range("Cabecalho").Offset(contador + 1, 3).Value = ConsisteString(Paciente)
   Range("Cabecalho").Offset(contador + 1, 4).Value = ConsisteString(Procedimento)
   Range("Cabecalho").Offset(contador + 1, 5).Value = ConsisteString(tipoFerida)
   Range("Cabecalho").Offset(contador + 1, 6).Value = ConsisteString(tipo)
   
   If ASA > 0 Then
   Range("Cabecalho").Offset(contador + 1, 7).Value = ASA
   Else
   Range("Cabecalho").Offset(contador + 1, 7).Value = "."
   End If
   
   Range("Cabecalho").Offset(contador + 1, 8).Value = ConsisteString(IRIC)
   Range("Cabecalho").Offset(contador + 1, 9).Value = ConsisteString(Anestesista)
   Range("Cabecalho").Offset(contador + 1, 10).Value = ConsisteString(SitioSec)
   Range("Cabecalho").Offset(contador + 1, 11).Value = ConsisteString(SitioPri)
   Range("Cabecalho").Offset(contador + 1, 12).Value = ConsisteString(Uclinica)

   'Consiste dataalta...
   If TPHos >= 0 Then
      'Poe TPHos...
      Range("Cabecalho").Offset(contador + 1, 13).Value = TPHos
      Range("Cabecalho").Offset(contador + 1, 14).Value = TPHosFaixa
   End If
   
   Range("Cabecalho").Offset(contador + 1, 15).Value = StatusImport
   Range("Cabecalho").Offset(contador + 1, 16).Value = TempoFerida
   Range("Cabecalho").Offset(contador + 1, 17).Value = Video
   Range("Cabecalho").Offset(contador + 1, 18).Value = Protese
   
End Sub

'...
Public Sub Desc2_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal nomeHospital As String, _
ByVal qGrafico As String, _
ByVal nomeRelat As String _
)

'Sub x()

    On Error Resume Next
   
    'Ordena os dados brutos da desc2...
    PlanD2.Select
    Range("Cabecalho").Select
    
    qtsLinhas = Range("Cabecalho").CurrentRegion.Rows.Count + 6
    
    Selection.Sort _
       Key1:=Range("B6"), Order1:=xlAscending, _
       Key2:=Range("C6"), Order2:=xlAscending, _
       Key3:=Range("E6"), Order3:=xlAscending, _
       Header:=xlYes, _
       OrderCustom:=1, _
       MatchCase:=False, _
       Orientation:=xlTopToBottom
    
    'Poe a grid...
    Call PoeGrid(Range("Cabecalho"))
    
    'Inicializacoes...
    antMedico = ""
    umMedico = Trim(PlanD2.Range("B7").Value)
    linhaRel = 11
    linhavez = 7
    
    'Loop dos Medicos...
    While umMedico <> ""
      
       'Verifica se mudou de Medico...
       If umMedico <> antMedico Then
          
          'Salta um branco...
          linhaRel = linhaRel + 1
          
          'Preenche o nome do medico na linha...
          PlanD2Quad.Range("B9").Value = umMedico
          
          'Copia o medico header bonitinho...
          PlanD2Quad.Range("umMedico").Copy Destination:=PlanD2Quad.Range("B" & linhaRel)
          
          'Preenche os dados do paciente...Data...
          PlanD2Quad.Range("B7").Value = PlanD2.Range("C" & linhavez).Value
          'Registro...
          PlanD2Quad.Range("C7").Value = PlanD2.Range("D" & linhavez).Value
          'Paciente...
          PlanD2Quad.Range("D7").Value = PlanD2.Range("E" & linhavez).Value
          'Proced...
          PlanD2Quad.Range("H7").Value = PlanD2.Range("F" & linhavez).Value
          'Sitio sec...
          PlanD2Quad.Range("K7").Value = PlanD2.Range("L" & linhavez).Value
          'Sitio pri...
          PlanD2Quad.Range("N7").Value = PlanD2.Range("M" & linhavez).Value
          
          'Incrementa controles...
          linhaRel = linhaRel + 2
          
          'Copia os dados header bonitinho...
          PlanD2Quad.Range("umPaciente").Copy Destination:=PlanD2Quad.Range("B" & linhaRel)
          
          'Atualiza...
          antMedico = umMedico
       
       Else
       
          'Preenche os dados do paciente...Data...
          PlanD2Quad.Range("B7").Value = PlanD2.Range("C" & linhavez).Value
          'Registro...
          PlanD2Quad.Range("C7").Value = PlanD2.Range("D" & linhavez).Value
          'Paciente...
          PlanD2Quad.Range("D7").Value = PlanD2.Range("E" & linhavez).Value
          'Proced...
          PlanD2Quad.Range("H7").Value = PlanD2.Range("F" & linhavez).Value
          'Sitio sec...
          PlanD2Quad.Range("K7").Value = PlanD2.Range("L" & linhavez).Value
          'Sitio pri...
          PlanD2Quad.Range("N7").Value = PlanD2.Range("M" & linhavez).Value
          
          'Copia os dados header bonitinho...
          PlanD2Quad.Range("umPaciente").Copy Destination:=PlanD2Quad.Range("B" & linhaRel)
          
       End If
       
       'Incrementa controles...
       linhaRel = linhaRel + 1
       linhavez = linhavez + 1
       umMedico = Trim(PlanD2.Range("B" & linhavez).Value)
      
    Wend
    
    'Poe as datas...
    PlanD2.Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Poe o nome do hospital...
    PlanD2.Range("G4").Value = nomeHospital
    
    'Poe o nome do relat|fffd|rio...
    PlanD2.Range("B2").Value = nomeRelat
    
    'Posiciona la em cima...
    PlanD2.Range("C2").Select
 
    'Seleciona...
    PlanD2TD.Visible = True
    PlanD2TD.Select
    
    'Arma a tabela dinamica...
    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, _
        SourceData:="[Janus.xls]Desc2!R6C2:R" & Trim(Str(qtsLinhas)) & "C16").CreatePivotTable _
        TableDestination:="[Janus.xls]Desc2TD!R8C3", _
        TableName:="TDMedicoCirurgia"
    'Formata...
    With ActiveSheet.PivotTables("TDMedicoCirurgia")
        .HasAutoFormat = False
        .EnableDrilldown = False
        .PreserveFormatting = False
        .SaveData = False
    End With
    
    
    ActiveSheet.PivotTables("TDMedicoCirurgia").AddFields RowFields:="M|fffd|dico", PageFields:="Procedimento"
    ActiveSheet.PivotTables("TDMedicoCirurgia").PivotFields("Paciente").Orientation = xlDataField
    ActiveSheet.PivotTables("TDMedicoCirurgia").PivotFields("M|fffd|dico").AutoSort xlDescending, "Contar de Paciente"
    'ActiveSheet.PivotTables("TDMedicoCirurgia").PivotFields("M|fffd|dico").AutoSort xlDescending, "Count of Paciente"
   
    ActiveWorkbook.ShowPivotTableFieldList = False
    Application.CommandBars("PivotTable").Visible = False
    
    'Oculta...
    PlanD2TD.Visible = False
    
    'Exibe e renomeia...
    PlanD2.Visible = True
    PlanD2.Name = "Desc.Cirurgia"
    
    Select Case qGrafico
    Case "Todos"
       PlanD2G1.Visible = True
       PlanD2G2.Visible = True
       PlanD2G3.Visible = True
       PlanD2G4.Visible = True
       PlanD2G5.Visible = True
       PlanD2Quad.Visible = True
       PlanD2TD.Visible = True
       PlanD2G7.Visible = True
       'Renomeia...
       PlanD2G1.Name = "Proc.Cirurgico"
       PlanD2G2.Name = "Especialidade"
       PlanD2G3.Name = "Anestesista"
       PlanD2G4.Name = "Proc.Cir.X T.P.Hos"
       PlanD2G5.Name = "Cesarianas"
       PlanD2Quad.Name = "M|fffd|dicos"
       PlanD2TD.Name = "Ranking"
       PlanD2G7.Name = "IRIC"
    Case "G1"
       PlanD2G1.Visible = True
       PlanD2G1.Name = "Proc.Cirurgico"
       PlanD2G1.Select
       Call PlanD2G1.Click_Grafico
    Case "G2"
       PlanD2G2.Visible = True
       PlanD2G2.Name = "Especialidade"
       PlanD2G2.Select
       Call PlanD2G2.Click_Grafico
    Case "G3"
       PlanD2G3.Visible = True
       PlanD2G3.Name = "Anestesista"
       PlanD2G3.Select
       Call PlanD2G3.Click_Grafico
    Case "G4"
       PlanD2G4.Visible = True
       PlanD2G4.Name = "Proc.Cir.X T.P.Hos"
       PlanD2G4.Select
       Call PlanD2G4.Click_Grafico
    Case "G5"
       PlanD2G5.Visible = True
       PlanD2G5.Name = "Cesarianas"
       PlanD2G5.Select
       Call PlanD2G5.Click_Grafico
    Case "G6"
       PlanD2G6.Visible = True
       PlanD2G6.Name = "Proc.Cir.X M.P.Hos"
       PlanD2G6.Select
       Call PlanD2G6.Click_Grafico
    End Select
    
    Call Desc2_Atualiza_Cesareana

    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
            
    Call Salva_Html
    
End Sub

''...
Public Sub Desc2_eMail_Medico()
    Application.ScreenUpdating = False
    
    Sheets("e-Mail-Medico").Visible = True
    Sheets("e-Mail-Medico").Select
    
    qtslin = Range("C6").CurrentRegion.Rows.Count
    If qtslin > 1 Then
       Rows("6:" & 5 + qtslin).Select
       Selection.Delete Shift:=xlUp
    End If
    
    Sheets("M|fffd|dicos").Select
    qMedico = ActiveCell.Value
    ActiveCell.Offset(1, 0).CurrentRegion.Select
    Selection.Copy
    
    Sheets("e-Mail-Medico").Visible = True
    Sheets("e-Mail-Medico").Select
    Range("C6").Select
    Selection.Insert Shift:=xlDown
    
    Rows("6:6").Select
    Selection.Delete Shift:=xlUp
    
    Range("Cabecalho").Select
    Range("Cabecalho").Value = qMedico
    Range("C6").Select
    
    Application.ScreenUpdating = True

End Sub
''...
Public Sub Desc2_eMail_Paciente()
        
    qLin = ActiveCell.Row
    If qLin < 7 Then
       Call Filtra
       Exit Sub
    End If
    
    qpaciente = Range("E" & qLin).Value
    qnomeHospital = Range("G4").Value + ","
    
    PlanEmail3.Range("H4").Value = qnomeHospital
    
    Sheets("e-Mail-Paciente").Visible = True
    Sheets("e-Mail-Paciente").Select
    Range("Cabecalho").Value = qpaciente
    Range("A1").Select
    
End Sub

''...
Public Sub Desc2_Atualiza_Cesareana()
        
    PlanD2G5.Select
 
   'Limpa os dados...
   Range("$D$37:$D$38").Value = 0
    
    PlanD2.Select
    
    'Filtra...
    PlanD2.Range("F6").Select
    Selection.AutoFilter Field:=5, Criteria1:="PARTO VAGINAL (NORMAL)"
    Normal = PlanD2.Range("D2").Value
    
    'Filtra...
    PlanD2.Range("F6").Select
    Selection.AutoFilter Field:=5, Criteria1:="CESARIANA"
    Cesarea = PlanD2.Range("D2").Value
    
    'Tira Filtro
    PlanD2.Range("B6").Select
    Selection.AutoFilter

    PlanD2G5.Select
    'Poe na tabela...
    Range("D37").Value = Cesarea
    Range("D38").Value = Normal
    
    PlanD2.Select
    
End Sub




Attribute VB_Name = "ModDesc2G8"
'Carrega os dados...
Public Sub Desc2G8_Q1( _
ByVal contador As Integer, _
ByVal Medico As String, _
ByVal DataCiru As Date, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Procedimento As String, _
ByVal tipo As String, _
ByVal ASA As Integer, _
ByVal Anestesista As String, _
ByVal SitioSec As String, _
ByVal SitioPri As String, _
ByVal Uclinica As String, _
ByVal TPHos As Integer, _
ByVal TPHosFaixa As String, _
ByVal tipoFerida As String, _
ByVal IRIC As String, _
ByVal StatusImport As String, _
ByVal TempoFerida As String, _
ByVal Video As String, _
ByVal Protese As String _
)
   On Error Resume Next
   
   ActiveSheet.Names.Add Name:="Cabecalho", RefersTo:="=$B$7"
   Sheets("Desc2").Visible = False
   
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = ConsisteString(Medico)
   Range("Cabecalho").Offset(contador + 1, 1).Value = DataCiru
   Range("Cabecalho").Offset(contador + 1, 2).Value = ConsisteString(Registro)
   Range("Cabecalho").Offset(contador + 1, 3).Value = ConsisteString(Paciente)
   Range("Cabecalho").Offset(contador + 1, 4).Value = ConsisteString(Procedimento)
   Range("Cabecalho").Offset(contador + 1, 5).Value = ConsisteString(tipoFerida)
   Range("Cabecalho").Offset(contador + 1, 6).Value = ConsisteString(tipo)
   
   If ASA > 0 Then
   Range("Cabecalho").Offset(contador + 1, 7).Value = ASA
   Else
   Range("Cabecalho").Offset(contador + 1, 7).Value = "."
   End If
   
   Range("Cabecalho").Offset(contador + 1, 8).Value = ConsisteString(IRIC)
   Range("Cabecalho").Offset(contador + 1, 9).Value = ConsisteString(Anestesista)
   Range("Cabecalho").Offset(contador + 1, 10).Value = ConsisteString(SitioSec)
   Range("Cabecalho").Offset(contador + 1, 11).Value = ConsisteString(SitioPri)
   Range("Cabecalho").Offset(contador + 1, 12).Value = ConsisteString(Uclinica)

   'Consiste dataalta...
   If TPHos >= 0 Then
      'Poe TPHos...
      Range("Cabecalho").Offset(contador + 1, 13).Value = TPHos
      Range("Cabecalho").Offset(contador + 1, 14).Value = TPHosFaixa
   End If
   
   Range("Cabecalho").Offset(contador + 1, 15).Value = StatusImport
   Range("Cabecalho").Offset(contador + 1, 16).Value = TempoFerida
   Range("Cabecalho").Offset(contador + 1, 17).Value = Video
   Range("Cabecalho").Offset(contador + 1, 18).Value = Protese
   
End Sub

'...
Public Sub Desc2G8_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal nomeHospital As String, _
ByVal qGrafico As String _
)

'Sub x()

    On Error Resume Next
   
    'Ordena os dados brutos da desc2...
    PlandD2G8.Select
    Range("Cabecalho").Select
    
    qtsLinhas = Range("Cabecalho").CurrentRegion.Rows.Count + 6
    
    Selection.Sort _
       Key1:=Range("B6"), Order1:=xlAscending, _
       Key2:=Range("C6"), Order2:=xlAscending, _
       Key3:=Range("E6"), Order3:=xlAscending, _
       Header:=xlYes, _
       OrderCustom:=1, _
       MatchCase:=False, _
       Orientation:=xlTopToBottom
    
    'Poe a grid...
    Call PoeGrid(Range("Cabecalho"))
    
    'Inicializacoes...
    antMedico = ""
    umMedico = Trim(PlandD2G8.Range("B7").Value)
    linhaRel = 11
    linhavez = 7
    
    'Loop dos Medicos...
    While umMedico <> ""
      
       'Verifica se mudou de Medico...
       If umMedico <> antMedico Then
          
          'Salta um branco...
          linhaRel = linhaRel + 1
          
          'Preenche o nome do medico na linha...
          PlandD2Quad.Range("B9").Value = umMedico
          
          'Copia o medico header bonitinho...
          PlandD2Quad.Range("umMedico").Copy Destination:=PlandD2Quad.Range("B" & linhaRel)
          
          'Preenche os dados do paciente...Data...
          PlandD2Quad.Range("B7").Value = PlandD2G8.Range("C" & linhavez).Value
          'Registro...
          PlandD2Quad.Range("C7").Value = PlandD2G8.Range("D" & linhavez).Value
          'Paciente...
          PlandD2Quad.Range("D7").Value = PlandD2G8.Range("E" & linhavez).Value
          'Proced...
          PlandD2Quad.Range("H7").Value = PlandD2G8.Range("F" & linhavez).Value
          'Sitio sec...
          PlandD2Quad.Range("K7").Value = PlandD2G8.Range("L" & linhavez).Value
          'Sitio pri...
          PlandD2Quad.Range("N7").Value = PlandD2G8.Range("M" & linhavez).Value
          
          'Incrementa controles...
          linhaRel = linhaRel + 2
          
          'Copia os dados header bonitinho...
          PlandD2Quad.Range("umPaciente").Copy Destination:=PlandD2Quad.Range("B" & linhaRel)
          
          'Atualiza...
          antMedico = umMedico
       
       Else
       
          'Preenche os dados do paciente...Data...
          PlandD2Quad.Range("B7").Value = PlandD2G8.Range("C" & linhavez).Value
          'Registro...
          PlandD2Quad.Range("C7").Value = PlandD2G8.Range("D" & linhavez).Value
          'Paciente...
          PlandD2Quad.Range("D7").Value = PlandD2G8.Range("E" & linhavez).Value
          'Proced...
          PlandD2Quad.Range("H7").Value = PlandD2G8.Range("F" & linhavez).Value
          'Sitio sec...
          PlandD2Quad.Range("K7").Value = PlandD2G8.Range("L" & linhavez).Value
          'Sitio pri...
          PlandD2Quad.Range("N7").Value = PlandD2G8.Range("M" & linhavez).Value
          
          'Copia os dados header bonitinho...
          PlandD2Quad.Range("umPaciente").Copy Destination:=PlandD2Quad.Range("B" & linhaRel)
          
       End If
       
       'Incrementa controles...
       linhaRel = linhaRel + 1
       linhavez = linhavez + 1
       umMedico = Trim(PlandD2G8.Range("B" & linhavez).Value)
      
    Wend
    
    'Poe as datas...
    PlandD2G8.Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Poe o nome do hospital...
    PlandD2G8.Range("G4").Value = nomeHospital
    
    'Posiciona la em cima...
    PlandD2G8.Range("C2").Select
 
    'Seleciona...
    PlandD2TD.Visible = True
    PlandD2TD.Select
    
    'Arma a tabela dinamica...
    ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, _
        SourceData:="[Janus.xls]Desc2!R6C2:R" & Trim(Str(qtsLinhas)) & "C16").CreatePivotTable _
        TableDestination:="[Janus.xls]Desc2TD!R8C3", _
        TableName:="TDMedicoCirurgia"
    'Formata...
    With ActiveSheet.PivotTables("TDMedicoCirurgia")
        .HasAutoFormat = False
        .EnableDrilldown = False
        .PreserveFormatting = False
        .SaveData = False
    End With
    
    
    ActiveSheet.PivotTables("TDMedicoCirurgia").AddFields RowFields:="M|fffd|dico", PageFields:="Procedimento"
    ActiveSheet.PivotTables("TDMedicoCirurgia").PivotFields("Paciente").Orientation = xlDataField
    ActiveSheet.PivotTables("TDMedicoCirurgia").PivotFields("M|fffd|dico").AutoSort xlDescending, "Contar de Paciente"
    'ActiveSheet.PivotTables("TDMedicoCirurgia").PivotFields("M|fffd|dico").AutoSort xlDescending, "Count of Paciente"
   
    ActiveWorkbook.ShowPivotTableFieldList = False
    Application.CommandBars("PivotTable").Visible = False
    
    'Oculta...
    PlandD2TD.Visible = False
    
    'Exibe e renomeia...
    PlandD2G8.Visible = True
    PlandD2G8.Name = "Desc.Cirurgia"
    
    Select Case qGrafico
    Case "Todos"
       PlandD2G1.Visible = True
       PlandD2G2.Visible = True
       PlandD2G3.Visible = True
       PlandD2G4.Visible = True
       PlandD2G5.Visible = True
       PlandD2Quad.Visible = True
       PlandD2TD.Visible = True
       PlandD2G7.Visible = True
       'Renomeia...
       PlandD2G1.Name = "Proc.Cirurgico"
       PlandD2G2.Name = "Especialidade"
       PlandD2G3.Name = "Anestesista"
       PlandD2G4.Name = "Proc.Cir.X T.P.Hos"
       PlandD2G5.Name = "Cesarianas"
       PlandD2Quad.Name = "M|fffd|dicos"
       PlandD2TD.Name = "Ranking"
       PlandD2G7.Name = "IRIC"
    Case "G1"
       PlandD2G1.Visible = True
       PlandD2G1.Name = "Proc.Cirurgico"
       PlandD2G1.Select
       Call PlandD2G1.Click_Grafico
    Case "G2"
       PlandD2G2.Visible = True
       PlandD2G2.Name = "Especialidade"
       PlandD2G2.Select
       Call PlandD2G2.Click_Grafico
    Case "G3"
       PlandD2G3.Visible = True
       PlandD2G3.Name = "Anestesista"
       PlandD2G3.Select
       Call PlandD2G3.Click_Grafico
    Case "G4"
       PlandD2G4.Visible = True
       PlandD2G4.Name = "Proc.Cir.X T.P.Hos"
       PlandD2G4.Select
       Call PlandD2G4.Click_Grafico
    Case "G5"
       PlandD2G5.Visible = True
       PlandD2G5.Name = "Cesarianas"
       PlandD2G5.Select
       Call PlandD2G5.Click_Grafico
    Case "G6"
       PlandD2G6.Visible = True
       PlandD2G6.Name = "Proc.Cir.X M.P.Hos"
       PlandD2G6.Select
       Call PlandD2G6.Click_Grafico
    End Select
    
    Call Desc2_Atualiza_Cesareana

    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
            
    Call Salva_Html
    
End Sub

''...
Public Sub Desc2G8_eMail_Medico()
    Application.ScreenUpdating = False
    
    Sheets("e-Mail-Medico").Visible = True
    Sheets("e-Mail-Medico").Select
    
    qtslin = Range("C6").CurrentRegion.Rows.Count
    If qtslin > 1 Then
       Rows("6:" & 5 + qtslin).Select
       Selection.Delete Shift:=xlUp
    End If
    
    Sheets("M|fffd|dicos").Select
    qMedico = ActiveCell.Value
    ActiveCell.Offset(1, 0).CurrentRegion.Select
    Selection.Copy
    
    Sheets("e-Mail-Medico").Visible = True
    Sheets("e-Mail-Medico").Select
    Range("C6").Select
    Selection.Insert Shift:=xlDown
    
    Rows("6:6").Select
    Selection.Delete Shift:=xlUp
    
    Range("Cabecalho").Select
    Range("Cabecalho").Value = qMedico
    Range("C6").Select
    
    Application.ScreenUpdating = True

End Sub
''...
Public Sub Desc2G8_eMail_Paciente()
        
    qLin = ActiveCell.Row
    If qLin < 7 Then
       Call Filtra
       Exit Sub
    End If
    
    qpaciente = Range("E" & qLin).Value
    qnomeHospital = Range("G4").Value + ","
    
    PlanEmail3.Range("H4").Value = qnomeHospital
    
    Sheets("e-Mail-Paciente").Visible = True
    Sheets("e-Mail-Paciente").Select
    Range("Cabecalho").Value = qpaciente
    Range("A1").Select
    
End Sub

''...
Public Sub Desc2G8_Atualiza_Cesareana()
        
    PlandD2G5.Select
 
   'Limpa os dados...
   Range("$D$37:$D$38").Value = 0
    
    PlandD2G8.Select
    
    'Filtra...
    PlandD2G8.Range("F6").Select
    Selection.AutoFilter Field:=5, Criteria1:="PARTO VAGINAL (NORMAL)"
    Normal = PlandD2G8.Range("D2").Value
    
    'Filtra...
    PlandD2G8.Range("F6").Select
    Selection.AutoFilter Field:=5, Criteria1:="CESARIANA"
    Cesarea = PlandD2G8.Range("D2").Value
    
    'Tira Filtro
    PlandD2G8.Range("B6").Select
    Selection.AutoFilter

    PlandD2G5.Select
    'Poe na tabela...
    Range("D37").Value = Cesarea
    Range("D38").Value = Normal
    
    PlandD2G8.Select
    
End Sub

Attribute VB_Name = "ModDesc3"
'Carrega os dados...
Public Sub Desc3( _
ByVal contador As Integer, _
ByVal Registro As String, _
ByVal Nome As String, _
ByVal DataMotivo As Date, _
ByVal Evento As String, _
ByVal Motivo As String, _
ByVal Uclinica As String, _
ByVal UFisica As String _
)
   
   On Error Resume Next
   'Copia os dados...
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   
   'Consiste DataMotivo...
   If DataMotivo > 1 Then
      Range("Cabecalho").Offset(contador + 1, 2).Value = DataMotivo
   End If
   
   Range("Cabecalho").Offset(contador + 1, 3).Value = ConsisteString(Evento)
   Range("Cabecalho").Offset(contador + 1, 4).Value = ConsisteString(Motivo)
   Range("Cabecalho").Offset(contador + 1, 5).Value = ConsisteString(Uclinica)
   Range("Cabecalho").Offset(contador + 1, 6).Value = ConsisteString(UFisica)
   
End Sub

''...
Public Sub Desc3_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)

    On Error Resume Next
   
    'Ordena os dados brutos da desc2...
    Sheets("Desc3").Select
    Range("Cabecalho").Select
    
    'Poe a grid...
    Call PoeGrid(Range("Cabecalho"))
    
    'Poe as datas...
    Worksheets("Desc3").Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Posiciona la em cima...
    Range("Cabecalho").Select
       
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD3.Visible = True
    PlanD3G1.Visible = True
    PlanD3G2.Visible = True
    
    PlanD3.Name = "Desc.Eventos Adversos"
    PlanD3G1.Name = "Evento"
    PlanD3G2.Name = "Motivo-Consequ|fffd|ncia"
        
    Call Salva_Html
    
End Sub






Attribute VB_Name = "ModDesc4"
'Carrega os dados...
Public Sub Desc4_Q1( _
ByVal contador As Integer, _
ByVal DataCultura As Date, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Material As String, _
ByVal CrescBac As String, _
ByVal Germe As String, _
ByVal Infeccao As String, _
ByVal SitioSecundario As String, _
ByVal SitioPrimario As String, _
ByVal Uclinica As String, _
ByVal UFisica As String, _
ByVal MaterialDet As String, _
ByVal Sensibilidade As String, _
ByVal RelevanciaClinica As String, _
ByVal StatusImport As String, _
ByVal Multirresistente As Boolean _
)
   
   On Error Resume Next
   'Copia os dados...
   'Consiste DataCultura...
   If DataCultura > 1 Then
      Range("Cabecalho").Offset(contador + 1, 0).Value = DataCultura
   End If
   Range("Cabecalho").Offset(contador + 1, 1).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 2).Value = Paciente
   Range("Cabecalho").Offset(contador + 1, 3).Value = ConsisteString(Material)
   Range("Cabecalho").Offset(contador + 1, 4).Value = ConsisteString(MaterialDet)
   Range("Cabecalho").Offset(contador + 1, 5).Value = ConsisteString(CrescBac)
   Range("Cabecalho").Offset(contador + 1, 6).Value = RelevanciaClinica
   Range("Cabecalho").Offset(contador + 1, 7).Value = ConsisteString(Infeccao)
   Range("Cabecalho").Offset(contador + 1, 8).Value = ConsisteString(Germe)
   
   'Colocar sensibilidade com coment|fffd|rio nesta c|fffd|lula (Germe)
   If Trim(Sensibilidade) <> "" Then
     Range("Cabecalho").Offset(contador + 1, 8).Select
     Range("Cabecalho").Offset(contador + 1, 8).AddComment
     Range("Cabecalho").Offset(contador + 1, 8).Comment.Visible = False
     'Substitui os <br> por uma quebra de verdade
     Sensibilidade = Replace(Sensibilidade, "<br>", Chr(10))
     Range("Cabecalho").Offset(contador + 1, 8).Comment.Text Text:=Sensibilidade
   End If

   Range("Cabecalho").Offset(contador + 1, 9).Value = ConsisteString(SitioSecundario)
   Range("Cabecalho").Offset(contador + 1, 10).Value = ConsisteString(SitioPrimario)
   Range("Cabecalho").Offset(contador + 1, 11).Value = ConsisteString(Uclinica)
   Range("Cabecalho").Offset(contador + 1, 12).Value = ConsisteString(UFisica)
   Range("Cabecalho").Offset(contador + 1, 13).Value = StatusImport
   
   Dim multi As String
   multi = "N|fffd|o"
   
   If Multirresistente Then
      multi = "Sim"
      Range("Cabecalho").Offset(contador + 1, 0).EntireRow.Select
      Selection.Font.Bold = True
      Selection.Font.Color = vbRed
   End If
   
   Range("Cabecalho").Offset(contador + 1, 14).Value = multi
   
End Sub

''...
Public Sub Desc4_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
'
'Sub x()

    On Error Resume Next
    
    'Poe a grid...
    Call PoeGrid(Range("B6"))
       
    
    'Poe as datas...
    Worksheets("Desc4").Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Posiciona la em cima...
    Worksheets("Desc4").Range("B4").Select
        
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD4.Visible = True
    PlanD4G1.Visible = True
    PlanD4G2.Visible = True
    PlanD4G3.Visible = True
    PlanD4G4.Visible = True
    
    PlanD4.Name = "Desc. Cultura"
    PlanD4G1.Name = "Germe"
    PlanD4G2.Name = "Grupo de Material"
    PlanD4G3.Name = "S|fffd|t.Prim|fffd|rio"
    PlanD4G4.Name = "S|fffd|t.Secund|fffd|rio"
    
    Set myDocument = Worksheets(PlanD4.Name)
    For Each s In myDocument.Shapes
        Select Case s.Type
        Case msoEmbeddedOLEObject, _
                msoLinkedOLEObject, _
                msoOLEControlObject, _
                msoLinkedPicture, msoPicture
            'Faz nada
        Case Else
            s.ScaleHeight 4, msoFalse
            s.ScaleWidth 1.5, msoFalse
        End Select
    Next

    Call Salva_Html

End Sub






Attribute VB_Name = "ModDesc5"
'Carrega os dados...
Public Sub Desc5_Q1( _
ByVal contador As Integer, _
ByVal DataInfeccao As Date, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Peso As Integer, _
ByVal SitioSecundario As String, _
ByVal SitioPrimario As String, _
ByVal Procedimento As String, _
ByVal Uclinica As String, _
ByVal UFisica As String, _
ByVal MetodoDeteccao As String _
)
   
   On Error Resume Next
   'Copia os dados...
   
   'Consiste DataInfeccao...
   If DataInfeccao > 1 Then
      Range("Cabecalho").Offset(contador + 1, 0).Value = DataInfeccao
   End If
   
   Range("Cabecalho").Offset(contador + 1, 1).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 2).Value = Paciente
   Range("Cabecalho").Offset(contador + 1, 3).Value = Peso
   Range("Cabecalho").Offset(contador + 1, 4).Value = ConsisteString(SitioSecundario)
   Range("Cabecalho").Offset(contador + 1, 5).Value = ConsisteString(SitioPrimario)
   Range("Cabecalho").Offset(contador + 1, 6).Value = ConsisteString(MetodoDeteccao)
   Range("Cabecalho").Offset(contador + 1, 7).Value = ConsisteString(Procedimento)
   Range("Cabecalho").Offset(contador + 1, 8).Value = ConsisteString(Uclinica)
   Range("Cabecalho").Offset(contador + 1, 9).Value = ConsisteString(UFisica)
   
End Sub

''...
Public Sub Desc5_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
'
'Sub x()

    On Error Resume Next
    
    'Poe a grid...
    Call PoeGrid(Range("B6"))
       
    
    'Poe as datas...
    Worksheets("Desc5").Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Posiciona la em cima...
    Worksheets("Desc5").Range("B4").Select
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD5.Visible = True
    PlanD5G1.Visible = True
    PlanD5G2.Visible = True
    PlanD5G3.Visible = True
    PlanD5G4.Visible = True
    PlanD5G5.Visible = True
    PlanD5G6.Visible = True
    
    PlanD5.Name = "Desc. Infec|fffd||fffd|o"
    PlanD5G1.Name = "Proc.Invasivo"
    PlanD5G2.Name = "S|fffd|t. Prim|fffd|rio"
    PlanD5G3.Name = "S|fffd|t. Secund|fffd|rio"
    PlanD5G4.Name = "Unidade Cl|fffd|nica"
    PlanD5G5.Name = "Especialidade"
    PlanD5G6.Name = "M|fffd|todo de Detec|fffd||fffd|o"

    Call Salva_Html
End Sub








Attribute VB_Name = "ModDesc6"
'Carrega os dados...
Public Sub Desc6_Q1( _
ByVal contador As Integer, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Convenio As String, _
ByVal DataInternacao As Date, _
ByVal DataAlta As Date, _
ByVal tipo As String, _
ByVal Uclinica As String, _
ByVal UFisica As String, _
ByVal DataNascimento As Date, _
ByVal Sexo As String, _
ByVal FaixaEtaria As String, _
ByVal TPHos As Integer, _
ByVal FxTPHos As String, _
ByVal Cidade As String, _
ByVal numLeitos As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 1).Value = Paciente
   
   Range("Cabecalho").Offset(contador + 1, 2).Value = ConsisteString(Convenio)
   
   'Consiste datainternacao...
   If DataInternacao > 1 Then
      Range("Cabecalho").Offset(contador + 1, 3).Value = DataInternacao
   End If
   
   'Consiste dataalta...
   If DataAlta > 1 Then
      Range("Cabecalho").Offset(contador + 1, 4).Value = DataAlta
      'Poe o dias...
      Range("Cabecalho").Offset(contador + 1, 8).Value = DataAlta - DataInternacao
      'Poe TPHos...
      Range("Cabecalho").Offset(contador + 1, 12).Value = TPHos
      
      'Consiste faixa...
      Range("Cabecalho").Offset(contador + 1, 13).Value = FxTPHos
   End If
   
   'Outros dados...
   Range("Cabecalho").Offset(contador + 1, 5).Value = ConsisteString(tipo)
   Range("Cabecalho").Offset(contador + 1, 6).Value = ConsisteString(Uclinica)
   Range("Cabecalho").Offset(contador + 1, 7).Value = ConsisteString(UFisica)
   Range("Cabecalho").Offset(contador + 1, 9).Value = Sexo

   'Consiste datanascimento...
   If DataNascimento > 1 Then
      Range("Cabecalho").Offset(contador + 1, 10).Value = DataNascimento

      'Consiste faixa...
      Range("Cabecalho").Offset(contador + 1, 11).Value = FaixaEtaria
   End If
   
   'Outros dados...cidade...
   Range("Cabecalho").Offset(contador + 1, 14).Value = Cidade
   Range("Cabecalho").Offset(contador + 1, 15).Value = numLeitos

End Sub

''...
Public Sub Desc6_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal qOpcao As String, _
ByVal qGrafico As String _
)
'Sub x()

    On Error Resume Next
    
    'Poe a grid...
    Call PoeGrid(Range("B6"))
       
    
    'Poe as datas...e titulo...
    PlanD6.Range("C2").Value = "Descritivo de Interna|fffd||fffd|o - " & qOpcao
    PlanD6.Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    'Poe as datas para o grafico...
    PlanD6.Range("Q1").Value = Inicio
    PlanD6.Range("R1").Value = fim
    
    'Posiciona la em cima...
    PlanD6.Range("B4").Select
        
    'Exibe e renomeia...
    PlanD6.Visible = True
    If PlanD6.Cells(2, 3) = "Descritivo de Interna|fffd||fffd|o - Internados" Then
        PlanD6.Name = "Desc.Internados"
    Else
        If PlanD6.Cells(2, 3) = "Descritivo de Interna|fffd||fffd|o - Alta" Then
            PlanD6.Name = "Desc.Alta"
        Else
            If PlanD6.Cells(2, 3) = "Descritivo de Interna|fffd||fffd|o - Admiss|fffd|o" Then
                PlanD6.Name = "Desc.Admiss|fffd|o"
            Else
                PlanD6.Name = "Desc.Interna|fffd||fffd|o"
            End If
        End If
    End If
    
    Select Case qGrafico
    Case "Todos"
       PlanD6G1.Visible = True
       PlanD6G2.Visible = True
       PlanD6G3.Visible = True
       PlanD6G5.Visible = True
       PlanD6G6.Visible = True
       If PlanD6.Cells(2, 3) = "Descritivo de Interna|fffd||fffd|o - Internados" Then
           PlanD6G7.Visible = True
       End If
       PlanD6G8.Visible = True
       'Renomeia...
       PlanD6G1.Name = "Faixa et|fffd|ria"
       PlanD6G2.Name = "Especialidade"
       PlanD6G3.Name = "Cidade"
       PlanD6G4.Name = "Unidade"
       PlanD6G5.Name = "Espec. X T.P.Hos."
       PlanD6G6.Name = "Conv|fffd|nio X Fx.et|fffd|ria"
       PlanD6G7.Name = "Tx. Ocupa|fffd||fffd|o"
       PlanD6G8.Name = "Conv|fffd|nio"
       PlanD6G10.Visible = xlSheetVisible
       PlanD6G10.Name = "Tipo de Alta"
    Case "G1"
       PlanD6G1.Visible = True
       PlanD6G1.Name = "Faixa et|fffd|ria"
       PlanD6G1.Select
       Call PlanD6G1.Click_Grafico
    Case "G2"
       PlanD6G2.Visible = True
       PlanD6G2.Name = "Especialidade"
       PlanD6G2.Select
       Call PlanD6G2.Click_Grafico
    Case "G3"
       PlanD6G3.Visible = True
       PlanD6G3.Name = "Cidade"
       PlanD6G3.Select
       Call PlanD6G3.Click_Grafico
    Case "G4"
       PlanD6G4.Visible = True
       PlanD6G4.Name = "Unidade"
       PlanD6G4.Select
       Call PlanD6G4.Click_Grafico
    Case "G5"
       PlanD6G5.Visible = True
       PlanD6G5.Name = "Espec. X T.P.Hos."
       PlanD6G5.Select
       Call PlanD6G5.Click_Grafico
    Case "G6"
       PlanD6G6.Visible = True
       PlanD6G6.Name = "Conv|fffd|nio X Fx.et|fffd|ria"
       PlanD6G6.Select
       Call PlanD6G6.Click_Grafico
    Case "G7"
       PlanD6G7.Visible = True
       PlanD6G7.Name = "Tx. Ocupa|fffd||fffd|o"
       PlanD6G7.Select
       Call PlanD6G7.Click_Grafico
    Case "G8"
       PlanD6G8.Visible = True
       PlanD6G8.Name = "Conv|fffd|nio"
       PlanD6G8.Select
       Call PlanD6G8.Click_Grafico
    Case "G9"
       PlanD6G9.Visible = True
       PlanD6G9.Name = "Espec. X M.P.Hos."
       PlanD6G9.Select
       Call PlanD6G9.Click_Grafico
    End Select
        
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    Call Salva_Html
    
End Sub

'Carrega Unidades Clinicas, para taxa de ocupa|fffd||fffd|o por unidade cl|fffd|nica
Public Sub Desc6_PreencheUClinica(ByVal contador As Integer, ByVal Uclinica As String)
    Sheets(PlanD6G7.Name).Range("W1").Offset(contador + 1, 0).Value = Uclinica
End Sub








Attribute VB_Name = "ModDesc7"
'Carrega os dados...
Public Sub Desc7_Q1( _
ByVal contador As Integer, _
ByVal DataAntibiotico As Date, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Antibiotico As String, _
ByVal SitioSecundario As String, _
ByVal SitioPrimario As String, _
ByVal tipo As String, _
ByVal tipoCirurgia As String, _
ByVal Uclinica As String, _
ByVal UFisica As String, _
ByVal Indicacao As String, _
ByVal Validado As String, _
ByVal DataDispensacao As Date _
)
   
   On Error Resume Next
   
   'Consiste DataAntibiotico...
   If DataAntibiotico > 1 Then
      Range("Cabecalho").Offset(contador + 1, 0).Value = DataAntibiotico
   End If

   Range("Cabecalho").Offset(contador + 1, 1).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 2).Value = Paciente
   Range("Cabecalho").Offset(contador + 1, 3).Value = ConsisteString(Antibiotico)
   Range("Cabecalho").Offset(contador + 1, 4).Value = Indicacao
   Range("Cabecalho").Offset(contador + 1, 5).Value = tipo
   Range("Cabecalho").Offset(contador + 1, 6).Value = tipoCirurgia
   Range("Cabecalho").Offset(contador + 1, 7).Value = ConsisteString(SitioSecundario)
   Range("Cabecalho").Offset(contador + 1, 8).Value = ConsisteString(SitioPrimario)
   Range("Cabecalho").Offset(contador + 1, 9).Value = ConsisteString(Uclinica)
   Range("Cabecalho").Offset(contador + 1, 10).Value = ConsisteString(UFisica)
   Range("Cabecalho").Offset(contador + 1, 11).Value = Validado
   
   If DataDispensacao > 1 Then
    Range("Cabecalho").Offset(contador + 1, 12).Value = DataDispensacao
   End If

End Sub

''...
Public Sub Desc7_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
'
'Sub x()

    On Error Resume Next
    
    'Poe a grid...
    Call PoeGrid(Range("B6"))
       
    
    'Poe as datas...
    Worksheets("Desc7").Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Posiciona la em cima...
    Worksheets("Desc7").Range("B4").Select
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD7.Visible = True
    PlanD7G1.Visible = True
    
    PlanD7.Name = "Desc.Antibi|fffd|tico"
    PlanD7G1.Name = "Antibi|fffd|tico"
    
    Call Salva_Html
            
End Sub








Attribute VB_Name = "ModDesc8"
'Carrega os dados...
Public Sub Desc8_Q1( _
ByVal contador As Integer, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal UCritica As String, _
ByVal DataAdmissao As Date, _
ByVal DataAlta As Date, _
ByVal Peso As Integer, _
ByVal ProcInvasivo As String, _
ByVal Inicio As Date, _
ByVal Termino As Date _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 1).Value = Paciente
   
   Range("Cabecalho").Offset(contador + 1, 2).Value = ConsisteString(UCritica)
   
   'Consiste DataAdmissao...
   If DataAdmissao > 1 Then
      Range("Cabecalho").Offset(contador + 1, 3).Value = DataAdmissao
   End If
   
   'Consiste DataAlta...
   If DataAlta > 1 Then
      Range("Cabecalho").Offset(contador + 1, 4).Value = DataAlta
   End If
   
   'Consiste Peso...
   If Peso > 1 Then
      Range("Cabecalho").Offset(contador + 1, 5).Value = Peso
   End If
   
   Range("Cabecalho").Offset(contador + 1, 6).Value = ConsisteString(ProcInvasivo)
   
   'Consiste Inicio...
   If Inicio > 1 Then
      Range("Cabecalho").Offset(contador + 1, 7).Value = Inicio
   End If
   
   'Consiste Termino...
   If Termino > 1 Then
      Range("Cabecalho").Offset(contador + 1, 8).Value = Termino
   End If
   
   
End Sub

''...
Public Sub Desc8_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
'
'Sub x()

    On Error Resume Next
    
    'Poe a grid...
    Call PoeGrid(Range("B6"))
       
    
    'Poe as datas...
    Worksheets("Desc8").Range("C4").Value = FormatDateTime(Inicio) & " a " & FormatDateTime(fim)
    
    'Posiciona la em cima...
    Worksheets("Desc8").Range("B4").Select
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD8.Visible = True
    'PlanD8G1.Visible = True
    
    PlanD8.Name = "Desc.Mov.Leitos"
    'PlanD8G1.Name = "Proc.Invasivo"
    
    Call Salva_Html
    
End Sub












Attribute VB_Name = "ModDesc9"
'Carrega os dados...
Public Sub Desc9_Q1( _
ByVal contador As Integer, _
ByVal OS As String, _
ByVal DataColheta As Date, _
ByVal Material As String, _
ByVal Registro As String, _
ByVal Paciente As String, _
ByVal Unid As String, _
ByVal DataAtualizacao As Date, _
ByVal Andamento As String, _
ByVal Gran As String, _
ByVal Parcial As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = ConsisteString(OS)
   'Consiste DataColheta...
   If DataColheta > 1 Then
      Range("Cabecalho").Offset(contador + 1, 1).Value = DataColheta
   End If
   Range("Cabecalho").Offset(contador + 1, 2).Value = ConsisteString(Material)
   Range("Cabecalho").Offset(contador + 1, 3).Value = Registro
   Range("Cabecalho").Offset(contador + 1, 4).Value = Paciente
   Range("Cabecalho").Offset(contador + 1, 5).Value = Unid
   Range("Cabecalho").Offset(contador + 1, 6).Value = DataAtualizacao
   
   Range("Cabecalho").Offset(contador + 1, 7).Value = Andamento
   Range("Cabecalho").Offset(contador + 1, 7).WrapText = True
   Range("Cabecalho").Offset(contador + 1, 8).Value = Gran
   Range("Cabecalho").Offset(contador + 1, 8).WrapText = True
   Range("Cabecalho").Offset(contador + 1, 9).Value = Parcial
   Range("Cabecalho").Offset(contador + 1, 9).WrapText = True

End Sub

''...
Public Sub Desc9_Fim()
'
'Sub x()

    On Error Resume Next
    
    'Poe a grid...
    Call PoeGrid(Range("B6"))
       
    'Posiciona la em cima...
    Worksheets("Desc9").Range("B4").Select
    
    'Atualiza e exibe...
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    PlanD9.Visible = True
    PlanD9.Select
    
    Application.ScreenUpdating = False
    
    Columns("H:H").Select
    Selection.NumberFormat = "dd/mm/yy;@"
    Range("A1").Select
    
    Application.ScreenUpdating = True
    
    PlanD9.Name = "Desc.Cultura parcial"
    
    Call Salva_Html
        
End Sub








Attribute VB_Name = "ModDescGraf"
Sub ColapsaRank(Target As Range)

   'Pega a linha do rank
   qLinRank = Target.Row
   'Coloca o nome Outros na celula ao lado...
   Target.Offset(0, 1).Value = "Outros"
   
   'Na celula de contagem vai somando...
   While Target.Offset(1, 2).Value > 0
     'Esta e a celula do colapso...
     Target.Offset(0, 2).Value = Target.Offset(0, 2).Value + Target.Offset(1, 2).Value
     'Seleciona a linha de baixo...e deleta...
     Target.Worksheet.Rows((Target.Row + 1) & ":" & (Target.Row + 1)).Select
     Selection.Delete Shift:=xlUp
   Wend
   
   'Para no lado...
   Target.Offset(0, 1).Select
   

End Sub

Sub AtualizaDescGraf(xDesc As String, xGraf As String, qColuna As String)
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = Worksheets(xGraf).Range("Cabecalho").Row + 1
   linfim = Worksheets(xGraf).Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      Worksheets(xGraf).Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = Worksheets(xDesc).Range("Cabecalho").Row + 1
   linfim = Worksheets(xDesc).Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = Worksheets(xGraf).Range("Cabecalho").Row + 1
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...e nao vazias...
   For lin = LinIni To linfim
      If (Not Worksheets(xDesc).Rows(lin & ":" & lin).EntireRow.Hidden) And _
         (Trim(Worksheets(xDesc).Range(qColuna & lin).Value) <> "") Then
          Worksheets(xGraf).Range("C" & qLin).Value = Worksheets(xDesc).Range(qColuna & lin).Value
          qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica...
   Worksheets(xGraf).Visible = True
   Worksheets(xGraf).Range("Cabecalho").Select
   Selection.Sort Key1:=Range("C37"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
        
  'Colapsa contando...
   LinIni = Worksheets(xGraf).Range("Cabecalho").Row + 1
   linfim = Worksheets(xGraf).Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = Worksheets(xGraf).Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   Worksheets(xGraf).Range("B" & LinIni).Value = 1
   Worksheets(xGraf).Range("D" & LinIni).Value = 1
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   For lin = LinIni To linfim
      'Pega o proximo nome...
      qNomeProximo = Worksheets(xGraf).Range("C" & lin).Value
      ' Se for igual ao de cima inc emcima e deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         Worksheets(xGraf).Range("D" & LinAnt).Value = Worksheets(xGraf).Range("D" & LinAnt).Value + 1
         Worksheets(xGraf).Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         qNome = qNomeProximo
         'Testa o fim...
         If qNome <> "" Then
            Worksheets(xGraf).Range("B" & lin).Value = 1
            Worksheets(xGraf).Range("D" & lin).Value = 1
            LinAnt = lin
         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim
      End If
   Next lin
   
   'Ordena por Qtd...
   Worksheets(xGraf).Range("Cabecalho").Select
   Selection.Sort Key1:=Range("D37"), _
      Order1:=xlDescending, _
      Header:=xlGuess, _
      OrderCustom:=1, _
      MatchCase:=False, _
      Orientation:=xlTopToBottom
   
   'Aponta para o inicio e fim da legenda...
   LinIni = Worksheets(xGraf).Range("Cabecalho").Row + 1
   linfim = Worksheets(xGraf).Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qLin = 1
   'Iterage na tabela pondo ordinal...
   For lin = LinIni To linfim
      Worksheets(xGraf).Range("B" & lin).Value = qLin & "|fffd|"
      qLin = qLin + 1
   Next lin
   
   'Chama o frame...
   Call PoeGrid(Worksheets(xGraf).Range("Cabecalho"))
   
   'Atualiza Grafico...
   Worksheets(xGraf).ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Worksheets(xGraf).Range("B37:B" & linfim & _
                                                             ",D37:D" & linfim), _
                                                             PlotBy:=xlColumns
        
   'Atualiza Pizza...
   Worksheets(xGraf).ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Worksheets(xGraf).Range("B37:B" & linfim & _
                                                             ",D37:D" & linfim), _
                                                             PlotBy:=xlColumns
   'Seleciona o Exb...
   Worksheets(xGraf).Range("E36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True
   
End Sub

Sub AtualizaDescGrafCirurgia(xDesc As Worksheet, xGraf As Worksheet, qColuna As String, qColunaRepete As String)
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = xGraf.Range("Cabecalho").Row + 1
   linfim = xGraf.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      xGraf.Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = xDesc.Range("Cabecalho").Row + 1
   linfim = xDesc.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = xGraf.Range("Cabecalho").Row + 1
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...
   For lin = LinIni To linfim
      If (Not xDesc.Rows(lin & ":" & lin).EntireRow.Hidden) Then
          'Traz a clinica ou anestesista...
          xGraf.Range("C" & qLin).Value = xDesc.Range(qColuna & lin).Value
          'Traz a data ou procedimento...
          xGraf.Range("F" & qLin).Value = xDesc.Range(qColunaRepete & lin).Value
          'Traz o paciente...
          xGraf.Range("G" & qLin).Value = xDesc.Range("E" & lin).Value
          qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica de objeto, qcolunarepete, paciente...
   xGraf.Range("Cabecalho").Select
   Selection.Sort _
        Key1:=Range("C36"), Order1:=xlAscending, _
        Key2:=Range("F36"), Order2:=xlAscending, _
        Key3:=Range("G36"), Order3:=xlAscending, _
        Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
        
  'Colapsa contando...
   LinIni = xGraf.Range("Cabecalho").Row + 1
   linfim = xGraf.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = xGraf.Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   xGraf.Range("B" & LinIni).Value = 1
   xGraf.Range("D" & LinIni).Value = 1
   xGraf.Range("E" & LinIni).Value = "v"
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   For lin = LinIni To linfim
      'Pega o proximo nome...
      qNomeProximo = xGraf.Range("C" & lin).Value
      'Se for igual ao de cima : inc em cima, deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         'Pega datas/proc e pac para comparar...
         qRepete = xGraf.Range("F" & LinAnt).Value
         qRepeteProximo = xGraf.Range("F" & lin).Value
         qPac = xGraf.Range("G" & LinAnt).Value
         qPacProximo = xGraf.Range("G" & lin).Value
         'Verifica se deve contar por pac sem repetir a data...
         If ((qRepete <> qRepeteProximo) Or (qPac <> qPacProximo)) Then
            xGraf.Range("D" & LinAnt).Value = xGraf.Range("D" & LinAnt).Value + 1
         End If
         'Repassa a data e pac da vez...
          xGraf.Range("F" & LinAnt).Value = qRepeteProximo
          xGraf.Range("G" & LinAnt).Value = qPacProximo
         'Elimina a linha...
         xGraf.Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         qNome = qNomeProximo
         'Testa o fim...
         If qNome <> "" Then
            xGraf.Range("B" & lin).Value = 1
            xGraf.Range("D" & lin).Value = 1
            xGraf.Range("E" & lin).Value = "v"
            LinAnt = lin
         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim
      End If
   Next lin
   
   'Ordena por Qtd...
   xGraf.Range("Cabecalho").Select
   Selection.Sort Key1:=Range("D37"), _
      Order1:=xlDescending, _
      Header:=xlGuess, _
      OrderCustom:=1, _
      MatchCase:=False, _
      Orientation:=xlTopToBottom
   
   'Aponta para o inicio e fim da legenda...
   LinIni = xGraf.Range("Cabecalho").Row + 1
   linfim = xGraf.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qLin = 1
   'Iterage na tabela pondo ordinal...
   For lin = LinIni To linfim
      xGraf.Range("B" & lin).Value = qLin & "|fffd|"
      qLin = qLin + 1
   Next lin
   
   'Oculta colunas auxiliares dat/proc e pac...
    Range("F36:G" & linfim).Select
    Selection.Delete Shift:=xlToLeft
   
   'Chama o frame...
   Call PoeGrid(xGraf.Range("Cabecalho"))
   
   'Atualiza Grafico...
   xGraf.ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=xGraf.Range("B37:B" & linfim & _
                                                             ",D37:D" & linfim), _
                                                             PlotBy:=xlColumns
        
   'Atualiza Pizza...
   xGraf.ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=xGraf.Range("B37:B" & linfim & _
                                                             ",D37:D" & linfim), _
                                                             PlotBy:=xlColumns
   'Seleciona o Exb...
   xGraf.Range("E36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True
   
End Sub
Attribute VB_Name = "ModEst1"
Public Sub Est1A( _
ByVal nInfeccoes As Long, _
ByVal nPacientesInfectados As Long, _
ByVal nAdmissoes As Long, ByVal nAdmissoesNISS As Long, ByVal nAdmissoesNaoNISS As Long, _
ByVal nPacientesDia As Long, _
ByVal nDiasPrevios As Long, _
ByVal nDiasFuturos As Long, _
ByVal nPacientesPrevios As Long, _
ByVal nITU As Long, _
ByVal nITUSVD As Long, _
ByVal nSVDDia As Long, _
ByVal nSVD As Long, _
ByVal nPneu As Long, _
ByVal nPneuVAP As Long, _
ByVal nVAPDia As Long, _
ByVal nVAP As Long, _
ByVal nSepse As Long, _
ByVal nSepseCVCP As Long, _
ByVal nSepseCVCD As Long, _
ByVal nCVCPDia As Long, _
ByVal nCVCDDia As Long, _
ByVal nCVCP As Long, _
ByVal nCVCD As Long _
)
   
   On Error Resume Next
   
   'Stop
   Range("nInfeccoes").Value = nInfeccoes
   Range("nPacientesInfectados").Value = nPacientesInfectados
   Range("nAdmissoes").Value = nAdmissoes
   Range("nAdmissoesNISS").Value = nAdmissoesNISS
   Range("nAdmissoesNaoNISS").Value = nAdmissoesNaoNISS
   Range("nPacientesDia").Value = nPacientesDia
   
   If (nAdmissoes + nPacientesPrevios) > 0 Then
      Range("nTaxaPermanenciaMedia").Value = (nDiasPrevios + nPacientesDia + nDiasFuturos) / _
                                                            (nAdmissoes + nPacientesPrevios)
   Else
      Range("nTaxaPermanenciaMedia").Value = 0
   End If
   
   Range("nITU").Value = nITU
   Range("nITUSVD").Value = nITUSVD
   Range("nSVD").Value = nSVD
   Range("nSVDDia").Value = nSVDDia
   Range("nSVDMedia").Value = nSVDDia / nSVD
   
   Range("nPneu").Value = nPneu
   Range("nPneuVAP").Value = nPneuVAP
   Range("nVAP").Value = nVAP
   Range("nVAPDia").Value = nVAPDia
   Range("nVAPMedia").Value = nVAPDia / nVAP
   
   Range("nSepse").Value = nSepse
   Range("nSepseCVCP").Value = nSepseCVCP
   Range("nSepseCVCD").Value = nSepseCVCD
   Range("nCVCP").Value = nCVCP
   Range("nCVCPDia").Value = nCVCPDia
   Range("nCVCD").Value = nCVCD
   Range("nCVCDDia").Value = nCVCDDia
   Range("nCVCPMedia").Value = nCVCPDia / nCVCP
   Range("nCVCDMedia").Value = nCVCDDia / nCVCD
   
End Sub

Public Sub Est1B( _
ByVal contador As Integer, _
ByVal Nome As String, _
ByVal Total As Long _
)
   On Error Resume Next
   Sheets(PlanE1.Name).Select

   'Copia o frame...
   Range("C49:H49").Select
   Selection.Copy
   Range("C" & Trim(Str(48 + contador + 2)) & ":H" & Trim(Str(48 + contador + 2))).Select
   ActiveSheet.Paste
   Application.CutCopyMode = False

   Range("SitiosEspecificos").Offset(contador + 2, 0).Value = Nome

   'se for s|fffd|tio prim|fffd|rio, coloca em negrito
   If Trim(Mid(Nome, 1, 4)) <> "" Then
      Range("SitiosEspecificos").Offset(contador + 2, 0).Font.Bold = True
   End If

   Range("SitiosEspecificos").Offset(contador + 2, 1).Value = Total
   If Sheets(PlanE1.Name).Range("H10") <> 0 Then
      Range("SitiosEspecificos").Offset(contador + 2, 2).Value = CDbl(Total / (Sheets(PlanE1.Name).Range("H10")))
   Else
      Range("SitiosEspecificos").Offset(contador + 2, 2).Value = 0
   End If
   If Sheets(PlanE1.Name).Range("H11") <> 0 Then
      Range("SitiosEspecificos").Offset(contador + 2, 3).Value = CDbl(Total / (Sheets(PlanE1.Name).Range("H13")) * 1000)
   Else
      Range("SitiosEspecificos").Offset(contador + 2, 3).Value = 0
   End If
   
End Sub

Public Sub Est1C( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String _
)
   Sheets("Est1").Select
   Range("D4").Value = CDate(Inicio)
   Range("F4").Value = CDate(fim)
   Range("D6").Value = Clinica
   Range("D6").Select
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
   Call Salva_Html
End Sub

Attribute VB_Name = "ModEst10"

'Carrega o nome dos grupos...
Public Sub Est10_Q1( _
ByVal contador As Integer, _
ByVal pPrincipal As String _
)
   'Stop
   On Error Resume Next
   
   'Valida os parametros...
   pPrincipal = validaParamString(pPrincipal)
   
   'Inicializacoes...
   Sheets("Est10aux1").Select
   
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = pPrincipal
End Sub

'Carrega o nome das colunas...
Public Sub Est10_Q2( _
ByVal contador As Integer, _
ByVal pColuna As String _
)
   'Stop
   On Error Resume Next
   
   'Valida os parametros...
   pColuna = validaParamString(pColuna)
   
   'Inicializacoes...
   Sheets("Est10").Select
   
   'Copia os dados...
   Range("nomeColuna").Value = pColuna
   Range("UmaColuna").Select
   Selection.Copy Destination:=Range("G6").Offset(0, 3 * contador)
   
   'Incrementa o numero de colunas...
   Range("Est10!B4").Value = Range("Est10!B4").Value + 1
   
End Sub

'Carrega o nome : Principal, Linha, Coluna, total ...
Public Sub Est10_Q3( _
ByVal contador As Integer, _
ByVal pPrincipal As String, _
ByVal pLinha As String, _
ByVal pColuna As String, _
ByVal Total As Long _
)
   'Stop
   On Error Resume Next
   
   'Valida os parametros...
   pPrincipal = validaParamString(pPrincipal)
   pLinha = validaParamString(pLinha)
   pColuna = validaParamString(pColuna)
   
   'Inicializacoes...
   Sheets("Est10aux2").Select
   
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = pPrincipal & "_" & pLinha & "_" & pColuna
   Range("Cabecalho").Offset(contador + 1, 1).Value = pPrincipal
   Range("Cabecalho").Offset(contador + 1, 2).Value = pLinha
   Range("Cabecalho").Offset(contador + 1, 3).Value = pColuna
   Range("Cabecalho").Offset(contador + 1, 4).Value = Total
   
End Sub

'Carrega as infeccoes...
Public Sub Est10_Q4( _
ByVal pPrincipal As String, _
ByVal pLinha As String, _
ByVal pColuna As String, _
ByVal Total As Long _
)
'   Stop
'   Application.ScreenUpdating = True
'   Application.Visible = True
'   PlanE10.Visible = xlSheetVisible
'   PlanE10aux1.Visible = xlSheetVisible
'   PlanE10aux2.Visible = xlSheetVisible
   
   On Error Resume Next
   
   'Valida os parametros...
   pPrincipal = validaParamString(pPrincipal)
   pLinha = validaParamString(pLinha)
   pColuna = validaParamString(pColuna)
   
   'Inicializacoes...
   Sheets("Est10aux2").Select
   
   'Faz o match da coluna...
   linha = Application.WorksheetFunction.Match(pPrincipal & "_" & pLinha & "_" & pColuna, Range("B5:B2000"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 5).Value = Total
End Sub

'...
Public Sub Est10_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal pPrincipal As String, _
ByVal pLinha As String, _
ByVal pColuna As String _
)

    On Error Resume Next
    'Valida os parametros...
    pPrincipal = validaParamString(pPrincipal)
    pLinha = validaParamString(pLinha)
    pColuna = validaParamString(pColuna)
    
    'Inicializacoes...
    Sheets("Est10").Select
    Range("C7").Value = pColuna
    Range("C8").Value = pLinha
    
    'Exibe a forma...
    Rows("4:19").Select
    Selection.EntireRow.Hidden = False
    
    'Inicializacoes...
    linhavez = 5
    linhaRel = 18
    auxpri = Trim(Range("Est10aux2!C5").Value)
    antpri = ""
    
    'Loop do principal...
    While auxpri <> ""
      
      'Se mudou de principal...
      If auxpri <> antpri Then
         'Incrementa a linha rel...
         linhaRel = linhaRel + 2
         'Poe o nome do procedimento na linha...
         Range("nomeGrupo") = auxpri
         'Copia o grupo bonitinho...
         Range("umGrupo").Copy Destination:=Range(linhaRel & ":" & linhaRel)
         'Incrementa controles...
         antpri = auxpri
         AuxLin = Trim(Range("Est10aux2!D" & linhavez).Value)
         antlin = ""
         'Incrementa a linha rel...
         linhaRel = linhaRel + 2
      End If
      
      'Se mudou de linha...
      If AuxLin <> antlin Then
         linhaRel = linhaRel + 1
         'Poe o nome da linha...
         Range("C9") = AuxLin
         'Copia a linha bonitinha...
         Range("linhaRegistro").Copy Destination:=Range(linhaRel & ":" & linhaRel)
         'Incrementa controles...
         antlin = AuxLin
      End If
      
      'Processa cada coluna...
      While (auxpri = antpri) And (AuxLin = antlin)
         'Pega os dados do registro...
         coluna = Trim(Range("Est10aux2!E" & linhavez).Value)
         cir = CInt(Range("Est10aux2!F" & linhavez).Value)
         Infec = CInt(Range("Est10aux2!G" & linhavez).Value)
         
         'Procura a coluna no header...
         posicao = Application.WorksheetFunction.Match(coluna, Range("G7:IS7"), 0)
         
         Dim cont As Integer
         cont = 0
         
         'Replica ou n|fffd|o o valor da cirurgia, dependendo dos parametros
         If pLinha = "Procedimento Cir|fffd|rgico" And pColuna = "S|fffd|tio Prim|fffd|rio" Then
            While (Range("A" & linhaRel).Offset(-1, 7 + cont).Value <> "")
                Range("A" & linhaRel).Offset(0, 7 + cont).Value = cir
                cont = cont + 3
            Wend
         Else
            If posicao > 0 Then
               'Infecao e cirurgias...
               Range("F" & linhaRel).Offset(0, posicao).Value = Infec
               Range("F" & linhaRel).Offset(0, posicao + 1).Value = cir
               'Calcula a taxa...
               If cir > 0 Then
                  Range("F" & linhaRel).Offset(0, posicao + 2).Value = Infec / cir * 100
               End If
            End If
         End If
         
         If posicao > 0 Then
            'Infecao e cirurgias...
            Range("F" & linhaRel).Offset(0, posicao).Value = Infec
            'Agora joga o Procedimento para todas colunas
            'Range("F" & linhaRel).Offset(0, posicao + 1).Value = cir
            'Calcula a taxa...
            If cir > 0 Then
               Range("F" & linhaRel).Offset(0, posicao + 2).Value = Infec / cir * 100
            End If
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         antpri = auxpri
         auxpri = Trim(Range("Est10aux2!C" & linhavez).Value)
         antlin = AuxLin
         AuxLin = Trim(Range("Est10aux2!D" & linhavez).Value)
      
      Wend 'While das colunas
      
      'Se mudou de principal entao faz o total...
      If auxpri <> antpri Then
         'Stop
         linhaRel = linhaRel + 1
         'Copia o total bonitao...
         Range("oTotal").Copy Destination:=Range("C" & linhaRel)
      
         'Determina o comeco desta tabela...
         auxlinha = linhaRel - 1
         While Range("C" & auxlinha).Value <> ""
           auxlinha = auxlinha - 1
         Wend
         auxlinha = auxlinha + 4
    
         'Iterage em todas as colunas...
         For i = 0 To Range("B4").Value - 1
         
           'Copia um total bonitinho..
           Range("umTotal").Copy Destination:=Range("C" & linhaRel).Offset(0, i * 3 + 1)
         
           'Poe os totais...
           adr = Range("C" & linhaRel).Offset(auxlinha - linhaRel, i * 3 + 1).AddressLocal & ":" & _
                Range("C" & linhaRel).Offset(-1, i * 3 + 1).AddressLocal
           Num = WorksheetFunction.Sum(Range(adr))
           adr = Range("C" & linhaRel).Offset(auxlinha - linhaRel, i * 3 + 2).AddressLocal & ":" & _
                Range("C" & linhaRel).Offset(-1, i * 3 + 2).AddressLocal
           den = WorksheetFunction.Sum(Range(adr))
           Range("C" & linhaRel).Offset(0, i * 3 + 1).Value = Num
           Range("C" & linhaRel).Offset(0, i * 3 + 2).Value = den
           'Calcula as taxas totais ...
           If Val(den) > 0 Then
               Range("C" & linhaRel).Offset(0, i * 3 + 3).Value = Num / den * 100
           End If
         
         Next i 'For
         
      End If '<>
    
    Wend 'While das linhas
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim

    'Oculta a forma...
    Rows("5:18").Select
    Selection.EntireRow.Hidden = True
    
    'Posiciona la em cima...
    Range("D2").Select
    Range("D2").Value = "Taxa Cir|fffd|rgica: " & pPrincipal & " X " & pColuna & " X " & pLinha
    
    'Atualiza e exibe...
    Sheets("Est10aux1").Visible = False
    Sheets("Est10aux2").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    
    Call Salva_Html
End Sub


'Carrega o total de cirurgias para sitio primario...
Public Sub Est10_SP( _
ByVal pCampo1 As String, _
ByVal pCampo2 As String, _
ByVal Total As Long, _
ByVal cCampoColuna As String _
)
   'Stop
   On Error Resume Next
   'Exit Sub
   Dim cont As Integer
   cont = 1
   
   'Valida os parametros...
   pCampo1 = validaParamString(pCampo1)
   pCampo2 = validaParamString(pCampo2)
   
   'Inicializacoes...
   Sheets("Est10aux2").Select
   
   'Faz o match na K_sp...
    linha = Application.WorksheetFunction.Match(pCampo1 & "_" & pCampo2, Range("A5:A3000"), 0)
   
   'Copia os dados...s|fffd| se achou...
   If linha > 0 Then
      'Poe no primeiro achado...
      Range("Cabecalho").Offset(linha, 4).Value = Total
      
      'Replica nas linhas seguintes, pois o match so faz o primeiro...
      Nome = Range("Cabecalho").Offset(linha, -1).Value
      linha = linha + 1
      nomeaux = Range("Cabecalho").Offset(linha, -1).Value
      While Nome = nomeaux
         Range("Cabecalho").Offset(linha, 4).Value = Total
         linha = linha + 1
         nomeaux = Range("Cabecalho").Offset(linha, -1).Value
      Wend
   Else
      'Acha a |fffd|ltima linha
      If cCampoColuna = "S|fffd|tio Prim|fffd|rio" Then
         While Range("Cabecalho").Offset(cont, 1) <> ""
           cont = cont + 1
         Wend

''''''        Stop
''''''        Application.ScreenUpdating = True
''''''        Application.Visible = True
''''''        PlanE10.Visible = xlSheetVisible
''''''        PlanE10aux1.Visible = xlSheetVisible
''''''        PlanE10aux2.Visible = xlSheetVisible

         Range("Cabecalho").Offset(cont, -1).Value = pCampo1 & "_" & pCampo2
         Range("Cabecalho").Offset(cont, 0).Value = pCampo1 & "_" & pCampo2 & "_<Sem S|fffd|tio>"
         Range("Cabecalho").Offset(cont, 1).Value = pCampo1
         Range("Cabecalho").Offset(cont, 2).Value = pCampo2
         Range("Cabecalho").Offset(cont, 3).Value = "<Sem S|fffd|tio>"
         Range("Cabecalho").Offset(cont, 4).Value = Total
         Range("Cabecalho").Offset(cont, 5).Value = 0
      End If
   End If
   
End Sub

'Vai
Public Sub Est10_MoveVai( _
ByVal pOpcao As String _
)
  'Inicializacoes...
  PlanE10aux2.Select
  cont = 1
  aux = Range("Cabecalho").Offset(cont, 0).Value
  
  'Se sp for grupo entao ordena L_C...
  If pOpcao = "P" Then
     While Trim(aux) <> ""
        Range("Cabecalho").Offset(cont, -1).Value = Range("Cabecalho").Offset(cont, 2).Value & "_" & Range("Cabecalho").Offset(cont, 3).Value
        cont = cont + 1
        aux = Range("Cabecalho").Offset(cont, 0).Value
     Wend
  ElseIf pOpcao = "L" Then
     While Trim(aux) <> ""
        Range("Cabecalho").Offset(cont, -1).Value = Range("Cabecalho").Offset(cont, 1).Value & "_" & Range("Cabecalho").Offset(cont, 3).Value
        cont = cont + 1
        aux = Range("Cabecalho").Offset(cont, 0).Value
     Wend
  ElseIf pOpcao = "C" Then
     While Trim(aux) <> ""
        Range("Cabecalho").Offset(cont, -1).Value = Range("Cabecalho").Offset(cont, 1).Value & "_" & Range("Cabecalho").Offset(cont, 2).Value
        cont = cont + 1
        aux = Range("Cabecalho").Offset(cont, 0).Value
     Wend
  End If

  'Ordena por K_sp...
  Range("A4").Select
  Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Header:=xlGuess, _
      OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
  
End Sub

'Volta
Public Sub Est10_MoveVolta()
    
    'Volta a ordenacao por P_L_C...
    Range("B4").Select
    Selection.Sort Key1:=Range("B5"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub




Attribute VB_Name = "ModEst11"
'Carrega os dados...
Public Sub Est11_Q1( _
ByVal contador As Integer, _
ByVal NomeGerme As String, _
ByVal Infeccao As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = NomeGerme
   Range("Cabecalho").Offset(contador + 1, 1).Value = Infeccao
End Sub

'...
Public Sub Est11_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String, _
ByVal sitios As String, _
ByVal Material As String, _
ByVal Grupo As String _
)
   
    Sheets("Est11aux").Select
        
    'Inicializacoes...
    Sheets("Est11").Select
    linhavez = 5
    linhaRel = 15
    antGerme = ""
    umGerme = Trim(Range("Est11aux!B5").Value)
    
    'Loop dos germes...
    While umGerme <> ""
      
       'Verifica se mudou de germe...
       If umGerme <> antGerme Then
          
          'Incrementa controles...
          linhaRel = linhaRel + 1
          
          'Copia a linha bonitinha...
          Range("Est11!umRegistro").Copy Destination:=Range("Est11!C" & linhaRel)
       
          'Poe o nome do germe na linha...
          Range("Est11!C" & linhaRel).Value = Range("Est11aux!B" & linhavez).Value
          
          'Pega o tipo...
          oTipo = Trim(Range("Est11aux!C" & linhavez).Value)
          
          'Dependendo do tipo poe no Com ou Hos...
          If oTipo = "C" Then
             Range("Est11!G" & linhaRel).Value = 1
          Else
             Range("Est11!I" & linhaRel).Value = 1
          End If
          
          'Atualiza...
          antGerme = umGerme
       
       Else
       
          'Pega o tipo...
          oTipo = Trim(Range("Est11aux!C" & linhavez).Value)
          
          'Dependendo do tipo poe no Com ou Hos...
          If oTipo = "C" Then
             Range("Est11!G" & linhaRel).Value = Range("Est11!G" & linhaRel).Value + 1
          Else
             Range("Est11!I" & linhaRel).Value = Range("Est11!I" & linhaRel).Value + 1
          End If
       
       End If
       
       'Incrementa controles...
       linhavez = linhavez + 1
       umGerme = Trim(Range("Est11aux!B" & linhavez).Value)
      
    Wend
    
    'Poe os toalizadores...
    Range("G" & linhaRel + 1).Value = WorksheetFunction.Sum(Range("G10:G" & Trim(Str(linhaRel))))
    totCom = Range("G" & linhaRel + 1).Value
    Range("I" & linhaRel + 1).Value = WorksheetFunction.Sum(Range("I10:I" & Trim(Str(linhaRel))))
    TotHos = Range("I" & linhaRel + 1).Value
    
    'Embelezamento...centralizado e azul
    Range("G" & linhaRel + 1).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .Font.ColorIndex = 5
    End With
    Range("I" & linhaRel + 1).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .Font.ColorIndex = 5
    End With
    
    'Linha dupla no total...
    Range("C" & linhaRel + 1 & ":K" & linhaRel + 1).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDouble
        .Weight = xlThick
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    
    'Aplica as taxas e o total...
    For linhavez = 16 To linhaRel
       'Taxa com..
       If totCom > 0 Then
          Range("H" & linhavez).Value = Range("G" & linhavez).Value / totCom * 100
       End If
       'Taxa hos..
       If TotHos > 0 Then
          Range("J" & linhavez).Value = Range("I" & linhavez).Value / TotHos * 100
       End If
       'Somatorio...
       Range("K" & linhavez).Value = Range("G" & linhavez).Value + Range("I" & linhavez).Value
    Next
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Cabecalhos..
    Range("I4").Value = Clinica
    If Trim(sitios) = "" Then
       Range("D6").Value = "< todos os s|fffd|tios >"
    Else
       Range("D6").Value = sitios
    End If
    Range("D8").Value = Material
    Range("D10").Value = Grupo
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    Worksheets("Est11aux").Visible = False
    Worksheets("Grafico11").Visible = True
    Call Salva_Html
    
End Sub




Attribute VB_Name = "ModEst12"
Dim linhaRel As Long
Dim linhavez As Long
Dim linhavezSen As Long

'Carrega os dados...
Public Sub Est12_Q1( _
ByVal contador As Long, _
ByVal NomeGerme As String, _
ByVal Infeccao As String _
)

   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = NomeGerme
   Range("Cabecalho").Offset(contador + 1, 1).Value = Infeccao
End Sub

'Carrega os dados...
Public Sub Est12_Q2( _
ByVal contador As Long, _
ByVal NomeGerme As String, _
ByVal NomeAntibiotico As String, _
ByVal Infeccao As String, _
ByVal resultado As String _
)

   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = NomeGerme
   Range("Cabecalho").Offset(contador + 1, 1).Value = NomeAntibiotico
   Range("Cabecalho").Offset(contador + 1, 2).Value = Infeccao
   Range("Cabecalho").Offset(contador + 1, 3).Value = resultado
End Sub

'...
Public Sub Est12_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String, _
ByVal sitios As String, _
ByVal Material As String, _
ByVal Grupo As String _
)
   
       
    'Inicializacoes...
    Sheets("Est12").Select
    antGerme = ""
    umGerme = Trim(Range("Est12aux1!B5").Value)
    linhaRel = 16
    linhavez = 5
    linhavezSen = 5
    
    'Stop
    
    'Loop dos germes...
    While umGerme <> ""
      
       'Verifica se mudou de germe...
       If umGerme <> antGerme Then
          
          'Preenche os antibioticos do antGerme...
          Call PoeAntibioticos(antGerme)
          
          'Incrementa controles...
          linhaRel = linhaRel + 4
          
          'Poe o nome do germe na linha...
          Range("Est12!C15").Value = umGerme
          
          'Copia o germe header bonitinho...
          Range("Est12!umGerme").Copy Destination:=Range("Est12!C" & linhaRel)
       
          'Pega o tipo...
          oTipo = Trim(Range("Est12aux1!C" & linhavez).Value)
          
          'Dependendo do tipo poe no Com ou Hos...
          If oTipo = "C" Then
             Range("Est12!G" & linhaRel + 2).Value = 1
          Else
             Range("Est12!J" & linhaRel + 2).Value = 1
          End If
          
          'Atualiza...
          antGerme = umGerme
       
       Else
       
          'Pega o tipo...
          oTipo = Trim(Range("Est12aux1!C" & linhavez).Value)
          
          'Dependendo do tipo poe no Com ou Hos...
          If oTipo = "C" Then
             Range("Est12!G" & linhaRel + 2).Value = Range("Est12!G" & linhaRel + 2).Value + 1
          Else
             Range("Est12!J" & linhaRel + 2).Value = Range("Est12!J" & linhaRel + 2).Value + 1
          End If
       
       End If
       
       'Incrementa controles...
       linhavez = linhavez + 1
       umGerme = Trim(Range("Est12aux1!B" & linhavez).Value)
      
    Wend
    
    'Preenche os antibioticos do antGerme...
    Call PoeAntibioticos(antGerme)
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Cabecalhos..
    Range("J4").Value = Clinica
    If Trim(sitios) = "" Then
       Range("D6").Value = "< todos os s|fffd|tios >"
    Else
       Range("D6").Value = sitios
    End If
    Range("D8").Value = Material
    Range("D10").Value = Grupo
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    Worksheets("Est12aux1").Visible = False
    Worksheets("Est12aux2").Visible = False
    Worksheets("Grafico12").Visible = True
    Call Salva_Html
    
End Sub


Private Sub PoeAntibioticos(ByVal antGerme As String)
    
    'Evita o primeiro...
    If antGerme = "" Then
       Exit Sub
    End If
    
    'Incrementa controles...
    linhaRel = linhaRel + 3
    
    'Pega o germe da sensibilidade...
    umGerme = Trim(Range("Est12aux2!B" & linhavezSen).Value)
    
    'Pega o antibiotico da sensibilidade...
    umAntibiotico = Trim(Range("Est12aux2!C" & linhavezSen).Value)
    antAntibiotico = ""
    
    'Loop dos germes...
    While umGerme = antGerme
      
       'Verifica se mudou de Antibiotico...
       If umAntibiotico <> antAntibiotico Then
          
          'Poe a taxa do antibiotico anterior...
          If antAntibiotico <> "" Then
             
             'Trata a com...
             den = Range("Est12!G" & linhaRel).Value
             Num = Range("Est12!H" & linhaRel).Value
             'Verifica divisao por zero...
             If den > 0 Then
                Range("Est12!I" & linhaRel).Value = Num / den * 100
             End If
             
             'Trata a hos...
             den = Range("Est12!J" & linhaRel).Value
             Num = Range("Est12!K" & linhaRel).Value
             'Verifica divisao por zero...
             If den > 0 Then
                Range("Est12!L" & linhaRel).Value = Num / den * 100
             End If
             
          End If
          
          'Incrementa controles...
          linhaRel = linhaRel + 1
          
          'Poe o nome do antibiotico na linha...
          Range("Est12!C12").Value = umAntibiotico
          
          'Copia o germe header bonitinho...
          Range("Est12!umAntibiotico").Copy Destination:=Range("Est12!C" & linhaRel)
       
          'Pega o tipo...
          oTipo = Trim(Range("Est12aux2!D" & linhavezSen).Value)
          
          'Pega o resultado...
          oResultado = Trim(Range("Est12aux2!E" & linhavezSen).Value)
          
          'Dependendo do tipo poe no Com ou Hos...
          If oTipo = "C" Then
             'Inicializa o testados...
             Range("Est12!G" & linhaRel).Value = 1
             'Testa a sensibilidade...
             If oResultado = "S" Then
                Range("Est12!H" & linhaRel).Value = 1
             End If
          Else
             'Inicializa o testados...
             Range("Est12!J" & linhaRel).Value = 1
             'Testa a sensibilidade...
             If oResultado = "S" Then
                Range("Est12!K" & linhaRel).Value = 1
             End If
          End If
          
          'Atualiza...
          antAntibiotico = umAntibiotico
       
       Else
       
          'Pega o tipo...
          oTipo = Trim(Range("Est12aux2!D" & linhavezSen).Value)
          
          'Pega o resultado...
          oResultado = Trim(Range("Est12aux2!E" & linhavezSen).Value)
          
          'Dependendo do tipo poe no Com ou Hos...
          If oTipo = "C" Then
             'Incrementa o testados...
             Range("Est12!G" & linhaRel).Value = Range("Est12!G" & linhaRel).Value + 1
             'Testa a sensibilidade...
             If oResultado = "S" Then
                Range("Est12!H" & linhaRel).Value = Range("Est12!H" & linhaRel).Value + 1
             End If
          Else
             'Incrementa o testados...
             Range("Est12!J" & linhaRel).Value = Range("Est12!J" & linhaRel).Value + 1
             'Testa a sensibilidade...
             If oResultado = "S" Then
                Range("Est12!K" & linhaRel).Value = Range("Est12!K" & linhaRel).Value + 1
             End If
          End If
          
       End If
       
       'Incrementa controles...
       linhavezSen = linhavezSen + 1
       umGerme = Trim(Range("Est12aux2!B" & linhavezSen).Value)
       umAntibiotico = Trim(Range("Est12aux2!C" & linhavezSen).Value)
      
    Wend
    
    'Poe a taxa do ultimo antibiotico ...
    If antAntibiotico <> "" Then
             
       'Trata a com...
       den = Range("Est12!G" & linhaRel).Value
       Num = Range("Est12!H" & linhaRel).Value
       'Verifica divisao por zero...
       If den > 0 Then
          Range("Est12!I" & linhaRel).Value = Num / den * 100
       End If
             
       'Trata a hos...
       den = Range("Est12!J" & linhaRel).Value
       Num = Range("Est12!K" & linhaRel).Value
       'Verifica divisao por zero...
       If den > 0 Then
          Range("Est12!L" & linhaRel).Value = Num / den * 100
       End If
             
    End If
    
    
    
End Sub





Attribute VB_Name = "ModEst13"
'Carrega os dados...
Public Sub Est13_Q1( _
ByVal contador As Integer, _
ByVal codClinica As String, _
ByVal Indicacao As String, _
ByVal TipoInfeccao As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("B4").Offset(contador + 1, 0).Value = codClinica
   Range("B4").Offset(contador + 1, 1).Value = Indicacao
   Range("B4").Offset(contador + 1, 2).Value = TipoInfeccao
End Sub

'...
Public Sub Est13_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String _
)
    'Inicializacoes...
    Sheets("Est13").Select
    linhaRel = 6
    linhavez = 5
    
    'Pega a primeira clinica...
    umaClinica = Trim(Range("Est13aux!B5").Value)
    'Engana..
    If (Clinica = "Todo Hospital") And (Trim(umaClinica) <> "") Then
       umaClinica = "Todo Hospital"
    End If
    antClinica = umaClinica
    
    'Stop
    indPro = 0
    indTer = 0
    infCom = 0
    infHos = 0
    infOut = 0
    
    'Loop das clinicas...
    While umaClinica <> ""
      
       'Verifica se mudou de clinica...
       If antClinica <> umaClinica Then
          
          'Poe os contadores...
          Range("E10").Value = indPro
          Range("E11").Value = indTer
          Range("I10").Value = infCom
          Range("I11").Value = infHos
          Range("I12").Value = infOut   'Hospitalar de Outra Institui|fffd||fffd|o

          'Arma e Testa os denominadors azuis...
          If Range("Est13!E12").Value > 0 Then
             Range("F10").Value = Range("E10").Value / (indPro + indTer)
             Range("F11").Value = Range("E11").Value / (indPro + indTer)
          End If

          'Arma e Testa os denominadors azuis...
          If Range("Est13!I13").Value > 0 Then
             Range("J10").Value = Range("I10").Value / (infCom + infHos + infOut)
             Range("J11").Value = Range("I11").Value / (infCom + infHos + infOut)
             Range("J12").Value = Range("I12").Value / (infCom + infHos + infOut)
          End If

          'Incrementa controles...
          linhaRel = linhaRel + 8

          'Poe o nome da clinica na linha...
          Range("Est13!C6").Value = antClinica
          
          'Copia o header bonitinho...
          Range("Est13!C6:K13").Copy Destination:=Range("Est13!C" & linhaRel)
       
          'Atualiza...
          antClinica = umaClinica
       
          'Zera contadores...
          indPro = 0
          indTer = 0
          infCom = 0
          infHos = 0
          infOut = 0
       
       Else
       
          'Pega a Indicacao...
          aInd = Trim(Range("Est13aux!C" & linhavez).Value)
       
          'Pega a Infeccao...
          aInf = Trim(Range("Est13aux!D" & linhavez).Value)
       
          'Incremena os contadores...
          If aInd = "P" Then
            indPro = indPro + 1
          Else
            indTer = indTer + 1
            'verifica qual infeccao...
            If aInf = "C" Then
               infCom = infCom + 1
            ElseIf aInf = "H" Then
               infHos = infHos + 1
            ElseIf aInf = "O" Then
               infOut = infOut + 1
            End If
          End If
       
          'Incrementa controles...
          linhavez = linhavez + 1
          
          'Pega a prox clinica...
          umaClinica = Trim(Range("Est13aux!B" & linhavez).Value)
          
          'Engana..
          If (Clinica = "Todo Hospital") And (Trim(umaClinica) <> "") Then
             umaClinica = "Todo Hospital"
          End If
          
       End If
       
    Wend
    
       'Verifica se mudou de clinica...
       If antClinica <> "" Then
          
          'Poe os contadores...
          Range("E10").Value = indPro
          Range("E11").Value = indTer
          Range("I10").Value = infCom
          Range("I11").Value = infHos
          Range("I12").Value = infOut
    
          'Arma e Testa os denominadors azuis...
          If Range("Est13!E12").Value > 0 Then
             Range("F10").Value = Range("E10").Value / (indPro + indTer)
             Range("F11").Value = Range("E11").Value / (indPro + indTer)
          End If
    
          'Arma e Testa os denominadors azuis...
          If Range("Est13!I13").Value > 0 Then
             Range("J10").Value = Range("I10").Value / (infCom + infHos + infOut)
             Range("J11").Value = Range("I11").Value / (infCom + infHos + infOut)
             Range("J12").Value = Range("I12").Value / (infCom + infHos + infOut)
          End If
          
          'Incrementa controles...
          linhaRel = linhaRel + 8
          
          'Poe o nome da clinica na linha...
          Range("Est13!C6").Value = antClinica
          
          'Copia o header bonitinho...
          Range("Est13!C6:K13").Copy Destination:=Range("Est13!C" & linhaRel)
       
          'Atualiza...
          antClinica = umaClinica
       
          'Zera contadores...
          indPro = 0
          indTer = 0
          infCom = 0
          infHos = 0
          infOut = 0
       End If

    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim

    'Posiciona la em cima...
    Range("D2").Select

    'Atualiza e exibe...
    Sheets("Est13aux").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html
    
End Sub


Attribute VB_Name = "ModEst14"
'Carrega os dados...
Public Sub Est14_Q1( _
ByVal contador As Integer, _
ByVal UnidClinica As String, _
ByVal Antibiotico As String, _
ByVal Indicacao As String _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("B4").Offset(contador + 1, 0).Value = UnidClinica
   Range("B4").Offset(contador + 1, 1).Value = Antibiotico
   Range("B4").Offset(contador + 1, 2).Value = Indicacao
End Sub

'...
Public Sub Est14_Fim( _
ByVal contador As Integer, _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String _
)
    'Stop
    On Error Resume Next
    
    'Engana..
    If (Clinica = "Todo Hospital") Then
       'Transforma unidade clinica...
       Range("Est14aux!B5:B" & contador + 4).Value = "-"
       'Ordena por antibiotico...
       Range("Est14aux!B4").Select
       Selection.Sort Key1:=Range("Est14aux!C4"), Order1:=xlAscending, Header:=xlGuess, _
       OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    End If
    
    'Inicializacoes...
    Sheets("Est14").Select
    
    'Inicializacoes...
    linhavez = 5
    linhaRel = 11
    
    'Pega a primeira clinica...
    umaClinica = Trim(Range("Est14aux!B5").Value)
    antClinica = ""
    
    umAntib = Trim(Range("Est14aux!C5").Value)
    antAntib = ""

    'Loop das clinicas...
    While umaClinica <> ""
      
      'Se mudou de clinica entao faz o cabecalho...
      If antClinica <> umaClinica Then
         'Stop
         linhaRel = linhaRel + 3
         'Poe o nome da clinica...
         Range("C7").Value = umaClinica
         'Copia o cabecalho bonitao...
         Range("umCabecalho").Copy Destination:=Range("C" & linhaRel)
         'Controles...
         linhaCalculo = linhaRel + 3
         linhaRel = linhaRel + 2
         antClinica = umaClinica
         totPro = 0
         totTer = 0
         totTot = 0
      End If '<>
      
      'Se mudou de antibiotico...
      If antAntib <> umAntib Then
         linhaRel = linhaRel + 1
         'Copia o registro bonitinho...
         Range("umRegistro").Copy Destination:=Range("C" & linhaRel)
         'Poe o nome do antib...
         Range("C" & linhaRel).Value = umAntib
         'Zera contadores...
         indPro = 0
         indTer = 0
         antAntib = umAntib
      End If
      
      'Processa cada registro...
      While (antClinica = umaClinica) And (antAntib = umAntib)
         
         'Pega o tipo da indicacao..
         If Range("Est14aux!D" & linhavez).Value = "P" Then
            indPro = indPro + 1
            totPro = totPro + 1
         Else
            indTer = indTer + 1
            totTer = totTer + 1
         End If
         totTot = totTot + 1
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         
         antClinica = umaClinica
         umaClinica = Range("Est14aux!B" & linhavez).Value
         
         antAntib = umAntib
         umAntib = Range("Est14aux!C" & linhavez).Value
      
      Wend 'While das colunas
      
      'Se mudou de antibiotico...poe as contagens...
      If antAntib <> umAntib Then
         Range("G" & linhaRel).Value = indPro
         Range("I" & linhaRel).Value = indTer
      End If
      
      'Se mudou de clinica entao faz o total...
      If antClinica <> umaClinica Then
         'Stop
         linhaRel = linhaRel + 1
         'Copia o total bonitao...
         Range("umTotal").Copy Destination:=Range("C" & linhaRel)
         'Poe os totais...
         Range("G" & linhaRel).Value = totPro
         Range("I" & linhaRel).Value = totTer
         Range("K" & linhaRel).Value = totTot
         'Calcula taxas...
         For i = linhaCalculo To linhaRel - 1
            'taxa do profilatico...
            If totPro > 0 Then
               Range("H" & i).Value = Range("G" & i).Value / totPro * 100
            End If
            'taxa do terapeutico...
            If totTer > 0 Then
               Range("J" & i).Value = Range("I" & i).Value / totTer * 100
            End If
            'taxa do total...
            If totTot > 0 Then
               Range("L" & i).Value = Range("K" & i).Value / totTot * 100
            End If
         Next i
      End If '<>
      
    
    Wend 'While das linhas
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Verifica o nome de todo Hospital
    If (Clinica = "Todo Hospital") Then
       Range("C14").Value = Clinica
    End If
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Sheets("Est14aux").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html

End Sub


Attribute VB_Name = "ModEst15"
'Carrega os dados...
Public Sub Est15_Q1( _
ByVal contador As Integer, _
ByVal UnidClinica As String, _
ByVal Antibiotico As String, _
ByVal TipoCir As String, _
ByVal Total As Integer _
)
   On Error Resume Next
   'Copia os dados...
   Range("B4").Offset(contador + 1, 0).Value = UnidClinica
   Range("B4").Offset(contador + 1, 1).Value = Antibiotico
   Range("B4").Offset(contador + 1, 2).Value = TipoCir
   Range("B4").Offset(contador + 1, 3).Value = Total
End Sub

'...
Public Sub Est15_Fim( _
ByVal contador As Integer, _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String _
)
    'Stop
    On Error Resume Next
   
    'Engana..
    If (Clinica = "Todo Hospital") Then
       'Transforma unidade clinica...
       Range("Est15aux!B5:B" & contador + 4).Value = "-"
       'Ordena por antibiotico...
       Range("Est15aux!B4").Select
       Selection.Sort Key1:=Range("Est15aux!C4"), Order1:=xlAscending, Header:=xlGuess, _
       OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    End If
    
    'Inicializacoes...
    Sheets("Est15").Select
    
    'Inicializacoes...
    linhavez = 5
    linhaRel = 11
    
    'Pega a primeira clinica...
    umaClinica = Trim(Range("Est15aux!B5").Value)
    antClinica = ""
    
    umAntib = Trim(Range("Est15aux!C5").Value)
    antAntib = ""

    'Loop das clinicas...
    While umaClinica <> ""
      
      'Se mudou de clinica entao faz o cabecalho...
      If antClinica <> umaClinica Then
         'Stop
         linhaRel = linhaRel + 3
         'Poe o nome da clinica...
         Range("C7").Value = umaClinica
         'Copia o cabecalho bonitao...
         Range("umCabecalho").Copy Destination:=Range("C" & linhaRel)
         'Controles...
         linhaCalculo = linhaRel + 3
         linhaRel = linhaRel + 2
         antClinica = umaClinica
         totLim = 0
         totPot = 0
         totCon = 0
         totInf = 0
         totInd = 0
      End If '<>
      
      'Se mudou de antibiotico...
      If antAntib <> umAntib Then
         linhaRel = linhaRel + 1
         'Copia o registro bonitinho...
         Range("umRegistro").Copy Destination:=Range("C" & linhaRel)
         'Poe o nome do antib...
         Range("C" & linhaRel).Value = umAntib
         'Zera contadores...
         contLim = 0
         contPot = 0
         contCon = 0
         contInf = 0
         contInd = 0
         antAntib = umAntib
      End If
      
      'Processa cada registro...
      While (antClinica = umaClinica) And (antAntib = umAntib)
         
         'Pega o tipo da indicacao..
         TipoCir = Range("Est15aux!D" & linhavez).Value
         qtd = Range("Est15aux!E" & linhavez).Value
         'Soma no tipo...
         If (TipoCir = "L") Or (TipoCir = "Lim") Then
            contLim = contLim + qtd
            totLim = totLim + qtd
         ElseIf (TipoCir = "P") Or (TipoCir = "Pot") Then
            contPot = contPot + qtd
            totPot = totPot + qtd
         ElseIf (TipoCir = "C") Or (TipoCir = "Con") Then
            contCon = contCon + qtd
            totCon = totCon + qtd
         ElseIf (TipoCir = "Inf") Or (TipoCir = "I") Then
            contInf = contInf + qtd
            totInf = totInf + qtd
         ElseIf (TipoCir = "Ind") Or (TipoCir = "D") Then
            contInd = contInd + qtd
            totInd = totInd + qtd
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         
         antClinica = umaClinica
         umaClinica = Range("Est15aux!B" & linhavez).Value
         
         antAntib = umAntib
         umAntib = Range("Est15aux!C" & linhavez).Value
      
      Wend 'While das colunas
      
      'Se mudou de antibiotico...poe as contagens...
      If antAntib <> umAntib Then
         Range("G" & linhaRel).Value = contLim
         Range("I" & linhaRel).Value = contPot
         Range("K" & linhaRel).Value = contCon
         Range("M" & linhaRel).Value = contInf
         Range("O" & linhaRel).Value = contInd
      End If
      
      'Se mudou de clinica entao faz o total...
      If antClinica <> umaClinica Then
         'Stop
         linhaRel = linhaRel + 1
         'Copia o total bonitao...
         Range("umTotal").Copy Destination:=Range("C" & linhaRel)
         'Poe os totais...
         Range("G" & linhaRel).Value = totLim
         Range("I" & linhaRel).Value = totPot
         Range("K" & linhaRel).Value = totCon
         Range("M" & linhaRel).Value = totInf
         Range("O" & linhaRel).Value = totInd
         'Calcula taxas...
         For i = linhaCalculo To linhaRel - 1
            'taxa da Limpa...
            If totLim > 0 Then
               Range("H" & i).Value = Range("G" & i).Value / totLim * 100
            End If
            'taxa da potencialmente...
            If totPot > 0 Then
               Range("J" & i).Value = Range("I" & i).Value / totPot * 100
            End If
            'taxa da Contaminada...
            If totCon > 0 Then
               Range("L" & i).Value = Range("K" & i).Value / totCon * 100
            End If
            'taxa da Infectada...
            If totInf > 0 Then
               Range("N" & i).Value = Range("M" & i).Value / totInf * 100
            End If
            'taxa da Indicacao...
            If totInd > 0 Then
               Range("P" & i).Value = Range("O" & i).Value / totInd * 100
            End If
         Next i
      End If '<>
      
    
    Wend 'While das linhas
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Verifica o nome de todo Hospital
    If (Clinica = "Todo Hospital") Then
       Range("C14").Value = Clinica
    End If
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Sheets("Est15aux").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html

End Sub




Attribute VB_Name = "ModEst16"
Dim linhaRel As Integer
Public Sub Est16_LimpaDados()
    Sheets(PlanE16aux.Name).Visible = True
    PlanE16aux.Select
    PlanE16aux.Range("B5:E65000").Select
    Selection.Clear
    PlanE16aux.Range("A1").Select
End Sub
Public Sub Est16_ColocaNomeUC(Nome As String)
'    Sheets(PlanE16.Name).Visible = True
'    PlanE16.Select
    If linhaRel < 11 Then
        linhaRel = 11
    End If
    PlanE16.Cells(linhaRel + 2, 2) = Nome
End Sub

'Carrega os dados...
Public Sub Est16_Q1( _
ByVal contador As Integer, _
ByVal Sitio As String, _
ByVal Antibiotico As String, _
ByVal TipoInf As String, _
ByVal Total As Integer _
)
   On Error Resume Next
   'Copia os dados...
   Range("B4").Offset(contador + 1, 0).Value = Sitio
   Range("B4").Offset(contador + 1, 1).Value = Antibiotico
   Range("B4").Offset(contador + 1, 2).Value = TipoInf
   Range("B4").Offset(contador + 1, 3).Value = Total
End Sub

'...
Public Sub Est16_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String, _
Optional mostra As String = "sim" _
)

    'Stop
    On Error Resume Next
   
    'Inicializacoes...
    Sheets("Est16").Select
    
    'Inicializacoes...
    linhavez = 5
    'Inicializa linhaRel se for a primeira entrada
    If linhaRel < 11 Then
        linhaRel = 11
    End If
    
    
    'Pega a primeira Sitio...
    umaSitio = Trim(Range("Est16aux!B5").Value)
    antSitio = ""
    
    umAntib = Trim(Range("Est16aux!C5").Value)
    antAntib = ""

    'Loop das Sitios...
    While umaSitio <> ""
      
      'Se mudou de Sitio entao faz o cabecalho...
      If antSitio <> umaSitio Then
         'Stop
         linhaRel = linhaRel + 3
         'Poe o nome da Sitio...
         Range("C7").Value = umaSitio
         'Copia o cabecalho bonitao...
         Range("umCabecalho").Copy Destination:=Range("C" & linhaRel)
         'Controles...
         linhaCalculo = linhaRel + 3
         linhaRel = linhaRel + 2
         antSitio = umaSitio
         totCom = 0
         totHosp = 0
      End If '<>
      
      'Se mudou de antibiotico...
      If antAntib <> umAntib Then
         linhaRel = linhaRel + 1
         'Copia o registro bonitinho...
         Range("umRegistro").Copy Destination:=Range("C" & linhaRel)
         'Poe o nome do antib...
         Range("C" & linhaRel).Value = umAntib
         'Zera contadores...
         contCom = 0
         contHosp = 0
         antAntib = umAntib
      End If
      
      'Processa cada registro...
      While (antSitio = umaSitio) And (antAntib = umAntib)
         
         'Pega o tipo da infeccao..
         TipoInf = Range("Est16aux!D" & linhavez).Value
         qtd = Range("Est16aux!E" & linhavez).Value
         'Soma no tipo...
         If TipoInf = "C" Then
            contCom = contCom + qtd
            totCom = totCom + qtd
         Else
            contHosp = contHosp + qtd
            totHosp = totHosp + qtd
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         antSitio = umaSitio
         umaSitio = Range("Est16aux!B" & linhavez).Value
         antAntib = umAntib
         umAntib = Range("Est16aux!C" & linhavez).Value
      
      Wend 'While das colunas
      
      'Se mudou de antibiotico...poe as contagens...
      If antAntib <> umAntib Then
         Range("G" & linhaRel).Value = contCom
         Range("I" & linhaRel).Value = contHosp
      End If
      
      'Se mudou de Sitio entao faz o total...
      If antSitio <> umaSitio Then
         'Stop
         linhaRel = linhaRel + 1
         'Copia o total bonitao...
         Range("umTotal").Copy Destination:=Range("C" & linhaRel)
         'Poe os totais...
         Range("G" & linhaRel).Value = totCom
         Range("I" & linhaRel).Value = totHosp
         'Calcula taxas...
         For i = linhaCalculo To linhaRel - 1
            'taxa da Comunitaria...
            If totCom > 0 Then
               Range("H" & i).Value = Range("G" & i).Value / totCom * 100
            End If
            'taxa da Hospitalar...
            If totHosp > 0 Then
               Range("J" & i).Value = Range("I" & i).Value / totHosp * 100
            End If
         Next i
      End If '<>
      
    
    Wend 'While das linhas
    
    'Poe as datas...
    Range("D5").Value = Inicio
    Range("F5").Value = fim
    
    'Poe a unid. clinica...
    Range("D3").Value = Clinica
    
    'Posiciona la em cima...
    Range("D5").Select
    
    'Atualiza e exibe...
    If mostra = "sim" Then
        Sheets("Est16aux").Visible = False
        Application.ScreenUpdating = True
        Application.Visible = True
        Call Salva_Html
    End If
End Sub

Public Sub mostraE16()
        Sheets("Est16aux").Visible = False
        Application.ScreenUpdating = True
        Application.Visible = True
        Call Salva_Html
End Sub




Attribute VB_Name = "ModEst17"
Dim indiceUnidadeClinica As Integer

'Carrega os dados...
Public Sub Est17A( _
ByVal tipo As String, _
ByVal valor As Long _
)
   If indiceUnidadeClinica = 0 Then
      indiceUnidadeClinica = 1
   End If
   
   On Error Resume Next
   'Copia os dados...
   If tipo = "I" Then
      Range("E8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = valor
   ElseIf tipo = "U" Then
      Range("D8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = valor
   ElseIf tipo = "C" Then
      Range("E12").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = valor
   ElseIf tipo = "H" Then
      Range("E13").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = valor
   ElseIf tipo = "O" Then
      Range("E14").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = valor
   End If

End Sub

Public Sub Est17_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String _
)
   If Clinica = "Todo Hospital" Then
     indiceUnidadeClinica = 1
   End If
        
   'Verifica a fracao...
   If Range("E8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value > 0 Then
      Range("F8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = Range("D8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value / Range("E8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value
      Range("F12").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = Range("E12").Offset((indiceUnidadeClinica - 1) * 12, 0).Value / Range("E8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value
      Range("F13").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = Range("E13").Offset((indiceUnidadeClinica - 1) * 12, 0).Value / Range("E8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value
      Range("F14").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = Range("E14").Offset((indiceUnidadeClinica - 1) * 12, 0).Value / Range("E8").Offset((indiceUnidadeClinica - 1) * 12, 0).Value
   End If

   'Poe as datas...
   Range("D4").Value = Inicio
   Range("F4").Value = fim

   'Poe a unid. clinica...
   Range("D5").Offset((indiceUnidadeClinica - 1) * 12, 0).Value = Clinica

   'Posiciona la em cima...
   Range("D4").Offset((indiceUnidadeClinica - 1) * 12, 0).Select
End Sub

Public Sub MostraE17()
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
   Call Salva_Html
End Sub

Public Sub ajustaFormatos()
    'Incrementa para desenhar na parte de baixo
    indiceUnidadeClinica = indiceUnidadeClinica + 1

    Range("D5:F14").Select
    Selection.Copy
    Range("D5").Offset((indiceUnidadeClinica - 1) * 12, 0).Select
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
End Sub
 
Attribute VB_Name = "ModEst18"
Public Sub Est18A( _
ByVal contador As Integer, _
ByVal Nome As String, _
ByVal TipoProcedimento As String, _
ByVal Total As Long _
)
   
   'Stop
   Sheets("Est18").Select
   
   'Mergeia
   Range("C" & (contador + 15) & ":G" & (contador + 15)).Select
   With Selection
       .MergeCells = True
   End With
   ' Preenche...
   Range("EventoAdverso").Offset(contador + 1, 0).Value = Nome
   Range("EventoAdverso").Offset(contador + 1, 1).Value = TipoProcedimento
   Range("EventoAdverso").Offset(contador + 1, 2).Value = Total
   'Taxa
   Range("EventoAdverso").Offset(contador + 1, 3).Value = 1
   Range("EventoAdverso").Offset(contador + 1, 4).FormulaR1C1 = "=RC[-2]/RC[-1]*1000"
    
   
End Sub

Public Sub Est18B( _
ByVal nPacientesDia As Long, _
ByVal nSVDDia As Long, _
ByVal nVAPDia As Long, _
ByVal nCVCPDia As Long, _
ByVal nCVCDDia As Long _
)
   
   On Error Resume Next
      
   'Stop
   Sheets("Est18").Select
   Range("nPacientesDia").Value = nPacientesDia
   Range("nSVDDia").Value = nSVDDia
   Range("nVAPDia").Value = nVAPDia
   Range("nCVCPDia").Value = nCVCPDia
   Range("nCVCDDia").Value = nCVCDDia
   
End Sub

Public Sub Est18C( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String _
)
   Sheets("Est18").Select
   Range("D4").Value = CDate(Inicio)
   Range("F4").Value = CDate(fim)
   Range("D6").Value = Clinica
   'Bordeia...
   Call PoeGrid(Range("EventoAdverso"))
   Range("H15").Select
   'Poe os denominadores...
   i = 15
   qNum = Trim(Range("I" & i).Value)
   While qNum <> ""
      If Trim(Range("H" & i).Value) = "" Then
         Range("J" & i).Value = Range("H8").Value
      ElseIf Trim(Range("H" & i).Value) = "SVD" Then
         Range("J" & i).Value = Range("H9").Value
      ElseIf Trim(Range("H" & i).Value) = "VAP" Then
         Range("J" & i).Value = Range("H10").Value
      ElseIf Trim(Range("H" & i).Value) = "CVCP" Then
         Range("J" & i).Value = Range("H11").Value
      ElseIf Trim(Range("H" & i).Value) = "CVCD" Then
         Range("J" & i).Value = Range("H12").Value
      End If
      i = i + 1
      qNum = Trim(Range("I" & i).Value)
   Wend
   
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
    Call Salva_Html
   
End Sub



Attribute VB_Name = "ModEst19"
'...
Public Sub Est19_Q1( _
ByVal contador As Integer, _
ByVal CodMedico As String, _
ByVal NomeMedico As String, _
ByVal CodProcedimento As String, _
ByVal NomeProcedimento As String, _
ByVal IRIC As String, _
ByVal Total As Long _
)
   
   
   On Error Resume Next
   'Stop
   IRIC = validaParamString(IRIC)

   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = Trim(CodMedico) _
                                              & "_" & Trim(CodProcedimento) _
                                              & "_" & Trim(IRIC)
   Range("Cabecalho").Offset(contador + 1, 1).Value = NomeMedico
   Range("Cabecalho").Offset(contador + 1, 2).Value = NomeProcedimento
   Range("Cabecalho").Offset(contador + 1, 3).Value = IRIC
   Range("Cabecalho").Offset(contador + 1, 4).Value = Total
End Sub

'...
Public Sub Est19_Q2( _
ByVal CodMedico As String, _
ByVal CodProcedimento As String, _
ByVal IRIC As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   IRIC = validaParamString(IRIC)
   'Procura...<R> melhorar o 10000...
   linha = Application.WorksheetFunction.Match(Trim(CodMedico) _
                                       & "_" & Trim(CodProcedimento) _
                                       & "_" & Trim(IRIC) _
                                       , Range("B5:B10000"), 0)

   'Copia os dados...
   Range("Cabecalho").Offset(linha, 5).Value = Total
End Sub

'...
Public Sub Est19_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
    'Application.ScreenUpdating = True
    'Application.Visible = True
    'Stop
    
    'Ordena por medico, procedimento, iric
    Sheets(PlanE19aux.Name).Select
    Range("B4").Select
    Selection.Sort Key1:=Range("C5"), Order1:=xlAscending, Key2:=Range("D5") _
        , Order2:=xlAscending, Key3:=Range("E5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
        
    'Inicializacoes...
    Sheets(PlanE19.Name).Select
    linhavez = 5
    linhaRel = 13
    auxmedico = Trim(Range("Est19aux!C5").Value)
    antMedico = ""
    
    'Loop dos medicos...
    While auxmedico <> ""
      
      'Se mudou de medico...
      If auxmedico <> antMedico Then
         'Pula uma linha em branco...
         Rows(linhaRel & ":" & linhaRel).Select
         Selection.RowHeight = 17
         linhaRel = linhaRel + 1
         'Copia o cabecalho bonitao...
         Range("Est19!umCabecalho").Copy Destination:=Range("Est19!C" & linhaRel)
         'Poe o nome do medico no cabecalho...
         Range("Est19!C" & linhaRel) = auxmedico
         'Incrementa controles...
         linhaRel = linhaRel + 3
         antMedico = auxmedico
         auxproc = Trim(Range("Est19aux!D" & linhavez).Value)
         antproc = ""
      End If
      
      'Se mudou de procedimento...
      If auxproc <> antproc Then
         'Copia a linha bonitinha...
         Range("Est19!umRegistro").Copy Destination:=Range("Est19!C" & linhaRel)
         'Poe o nome do procedimento na linha...
         Range("Est19!C" & linhaRel) = auxproc
         'Incrementa controles...
         antproc = auxproc
      End If
      
      'Processa os IRICS do procedimento...
      While (auxproc = antproc) And (auxmedico = antMedico)
         
         'Pega os dados da linha...
         IRIC = Range("Est19aux!E" & linhavez).Value
         cir = Range("Est19aux!F" & linhavez).Value
         inf = Range("Est19aux!G" & linhavez).Value
         
         'Aplica  o iric...
         If IRIC = ".0." Then
            Range("Est19!G" & linhaRel).Value = Range("Est19!G" & linhaRel).Value + Val(inf)
            Range("Est19!H" & linhaRel).Value = Range("Est19!H" & linhaRel).Value + Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est19!I" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         ElseIf IRIC = ".1." Then
            Range("Est19!J" & linhaRel).Value = Range("Est19!J" & linhaRel).Value + Val(inf)
            Range("Est19!K" & linhaRel).Value = Range("Est19!K" & linhaRel).Value + Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est19!L" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         ElseIf IRIC = ".2." Then
            Range("Est19!M" & linhaRel).Value = Range("Est19!M" & linhaRel).Value + Val(inf)
            Range("Est19!N" & linhaRel).Value = Range("Est19!N" & linhaRel).Value + Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est19!O" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         ElseIf IRIC = ".3." Then
            Range("Est19!P" & linhaRel).Value = Range("Est19!P" & linhaRel).Value + Val(inf)
            Range("Est19!Q" & linhaRel).Value = Range("Est19!Q" & linhaRel).Value + Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est19!R" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         Else
            Range("Est19!S" & linhaRel).Value = Range("Est19!S" & linhaRel).Value + Val(inf)
            Range("Est19!T" & linhaRel).Value = Range("Est19!T" & linhaRel).Value + Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est19!U" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         antproc = auxproc
         antMedico = auxmedico
         auxmedico = Trim(Range("Est19aux!C" & linhavez).Value)
         auxproc = Trim(Range("Est19aux!D" & linhavez).Value)
         
      Wend
      
      'Incrementa controles...
      linhaRel = linhaRel + 1
      
      'Se mudou de medico... poe o total
      If auxmedico <> antMedico Then
         'Copia o total bonitao...
         Range("Est19!umTotal").Copy Destination:=Range("Est19!C" & linhaRel)
         'Determina o comeco desta tabela...
         auxlinha = linhaRel - 1
         While Range("C" & auxlinha).Value <> "Procedimentos"
           auxlinha = auxlinha - 1
         Wend
         auxlinha = auxlinha + 1
         'Poe os totais...
         Range("G" & linhaRel).Value = WorksheetFunction.Sum(Range("G" & Trim(Str(auxlinha)) & ":G" & Trim(Str(linhaRel - 1))))
         Range("H" & linhaRel).Value = WorksheetFunction.Sum(Range("H" & Trim(Str(auxlinha)) & ":H" & Trim(Str(linhaRel - 1))))
         Range("J" & linhaRel).Value = WorksheetFunction.Sum(Range("J" & Trim(Str(auxlinha)) & ":J" & Trim(Str(linhaRel - 1))))
         Range("K" & linhaRel).Value = WorksheetFunction.Sum(Range("K" & Trim(Str(auxlinha)) & ":K" & Trim(Str(linhaRel - 1))))
         Range("M" & linhaRel).Value = WorksheetFunction.Sum(Range("M" & Trim(Str(auxlinha)) & ":M" & Trim(Str(linhaRel - 1))))
         Range("N" & linhaRel).Value = WorksheetFunction.Sum(Range("N" & Trim(Str(auxlinha)) & ":N" & Trim(Str(linhaRel - 1))))
         Range("P" & linhaRel).Value = WorksheetFunction.Sum(Range("P" & Trim(Str(auxlinha)) & ":P" & Trim(Str(linhaRel - 1))))
         Range("Q" & linhaRel).Value = WorksheetFunction.Sum(Range("Q" & Trim(Str(auxlinha)) & ":Q" & Trim(Str(linhaRel - 1))))
         Range("S" & linhaRel).Value = WorksheetFunction.Sum(Range("S" & Trim(Str(auxlinha)) & ":S" & Trim(Str(linhaRel - 1))))
         Range("T" & linhaRel).Value = WorksheetFunction.Sum(Range("T" & Trim(Str(auxlinha)) & ":T" & Trim(Str(linhaRel - 1))))
         'Calcula a taxa da linha TOTAL...
         If Val(Range("Est19!H" & linhaRel).Value) > 0 Then
            Range("Est19!I" & linhaRel).Value = Val(Range("Est19!G" & linhaRel).Value) / Val(Range("Est19!H" & linhaRel).Value) * 100
         End If
         If Val(Range("Est19!K" & linhaRel).Value) > 0 Then
            Range("Est19!L" & linhaRel).Value = Val(Range("Est19!J" & linhaRel).Value) / Val(Range("Est19!K" & linhaRel).Value) * 100
         End If
         If Val(Range("Est19!N" & linhaRel).Value) > 0 Then
            Range("Est19!O" & linhaRel).Value = Val(Range("Est19!M" & linhaRel).Value) / Val(Range("Est19!N" & linhaRel).Value) * 100
         End If
         If Val(Range("Est19!Q" & linhaRel).Value) > 0 Then
            Range("Est19!R" & linhaRel).Value = Val(Range("Est19!P" & linhaRel).Value) / Val(Range("Est19!Q" & linhaRel).Value) * 100
         End If
         If Val(Range("Est19!T" & linhaRel).Value) > 0 Then
            Range("Est19!U" & linhaRel).Value = Val(Range("Est19!S" & linhaRel).Value) / Val(Range("Est19!T" & linhaRel).Value) * 100
         End If
         'Avanca a linha...
         linhaRel = linhaRel + 1
      End If
      
    Wend
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Sheets("Est19aux").Visible = False
    PlanE19.Name = "Esp. x Proced. x IRIC"
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html
    
End Sub



Attribute VB_Name = "ModEst2"
Public Sub Est2A( _
ByVal nInfeccoes As Long, _
ByVal nPacientesInfectados As Long, _
ByVal nAdmissoes As Long, ByVal nAdmissoesNISS As Long, ByVal nAdmissoesNaoNISS As Long, _
ByVal nPacientesDia As Long, _
ByVal nDiasPrevios As Long, _
ByVal nDiasFuturos As Long, _
ByVal nPacientesPrevios As Long, _
ByVal nITU As Long, _
ByVal nITUSVD As Long, _
ByVal nSVDDia As Long, _
ByVal nSVD As Long, _
ByVal nPneu As Long, _
ByVal nPneuVAP As Long, _
ByVal nVAPDia As Long, _
ByVal nVAP As Long, _
ByVal nSepse As Long, _
ByVal nSepseCVCP As Long, _
ByVal nSepseCVCD As Long, _
ByVal nCVCPDia As Long, ByVal nCVCDDia As Long, ByVal nCVCP As Long, ByVal nCVCD As Long, _
ByVal coluna As Integer _
)
   
   On Error Resume Next
   'Stop
   Range("nInfeccoes" & Trim(coluna)).Value = nInfeccoes
   Range("nPacientesInfectados" & Trim(coluna)).Value = nPacientesInfectados
   Range("nAdmissoes" & Trim(coluna)).Value = nAdmissoes
   Range("nAdmissoesNISS" & Trim(coluna)).Value = nAdmissoesNISS
   Range("nAdmissoesNaoNISS" & Trim(coluna)).Value = nAdmissoesNaoNISS
   Range("nPacientesDia" & Trim(coluna)).Value = nPacientesDia
   
   If (nAdmissoes + nPacientesPrevios) > 0 Then
      Range("nTaxaPermanenciaMedia" & Trim(coluna)).Value = (nDiasPrevios + nPacientesDia + nDiasFuturos) / _
                                                            (nAdmissoes + nPacientesPrevios)
   Else
      Range("nTaxaPermanenciaMedia" & Trim(coluna)).Value = 0
   End If
   
   Range("nITU" & Trim(coluna)).Value = nITU
   Range("nITUSVD" & Trim(coluna)).Value = nITUSVD
   Range("nSVD" & Trim(coluna)).Value = nSVD
   Range("nSVDDia" & Trim(coluna)).Value = nSVDDia
   Range("nSVDMedia" & Trim(coluna)).Value = nSVDDia / nSVD
   
   Range("nPneu" & Trim(coluna)).Value = nPneu
   Range("nPneuVAP" & Trim(coluna)).Value = nPneuVAP
   Range("nVAP" & Trim(coluna)).Value = nVAP
   Range("nVAPDia" & Trim(coluna)).Value = nVAPDia
   Range("nVAPMedia" & Trim(coluna)).Value = nVAPDia / nVAP
   
   Range("nSepse" & Trim(coluna)).Value = nSepse
   Range("nSepseCVCP" & Trim(coluna)).Value = nSepseCVCP
   Range("nSepseCVCD" & Trim(coluna)).Value = nSepseCVCD
   Range("nCVCP" & Trim(coluna)).Value = nCVCP
   Range("nCVCPDia" & Trim(coluna)).Value = nCVCPDia
   Range("nCVCD" & Trim(coluna)).Value = nCVCD
   Range("nCVCDDia" & Trim(coluna)).Value = nCVCDDia
   Range("nCVCPMedia" & Trim(coluna)).Value = nCVCPDia / nCVCP
   Range("nCVCDMedia" & Trim(coluna)).Value = nCVCDDia / nCVCD
   
End Sub

Public Sub Est2B( _
ByVal contador As Integer, _
ByVal Nome As String, _
ByVal Total As Long _
)
    On Error Resume Next
   Sheets(PlanE2.Name).Select
   
   'Copia o frame...
   Range("C49:I49").Select
   Selection.Copy
   Range("C" & Trim(Str(48 + contador + 2)) & ":I" & Trim(Str(48 + contador + 2))).Select
   ActiveSheet.Paste
   Application.CutCopyMode = False
   
   Range("SitiosEspecificos").Offset(contador + 2, 0).Value = Nome

   'se for s|fffd|tio prim|fffd|rio, coloca em negrito
   If Trim(Mid(Nome, 1, 4)) <> "" Then
      Range("SitiosEspecificos").Offset(contador + 2, 0).Font.Bold = True
   End If

   Range("SitiosEspecificos").Offset(contador + 2, 2).Value = Total
   If Sheets(PlanE2.Name).Range("Q10") <> 0 Then
      Range("SitiosEspecificos").Offset(contador + 2, 4).Value = CDbl(Total / (Sheets(PlanE2.Name).Range("Q10")))
   Else
      Range("SitiosEspecificos").Offset(contador + 2, 4).Value = 0
   End If
   If Sheets(PlanE2.Name).Range("Q11") <> 0 Then
      Range("SitiosEspecificos").Offset(contador + 2, 6).Value = CDbl(Total / (Sheets(PlanE2.Name).Range("Q13")) * 1000)
   Else
      Range("SitiosEspecificos").Offset(contador + 2, 6).Value = 0
   End If
   
End Sub

Public Sub Est2C( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal Clinica As String, _
ByVal faixa1 As Integer, _
ByVal faixa2 As Integer, _
ByVal faixa3 As Integer _
)
   Sheets("Est2").Select
   Range("D4").Value = CDate(Inicio)
   Range("F4").Value = CDate(fim)
   Range("D6").Value = Clinica
   Range("faixa1").Value = "<= " + Str(faixa1)
   Range("faixa2").Value = "<= " + Str(faixa2)
   Range("faixa3").Value = "<= " + Str(faixa3)
   Range("faixa4").Value = "> " + Str(faixa3)
   Range("D6").Select
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
   Call Salva_Html
   
End Sub



Attribute VB_Name = "ModEst3"
'Carrega as unidades clinicas
Public Sub Est3A( _
ByVal contador As Integer, _
ByVal txgeral As String, _
ByVal Nome As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Se tipo for B2 so soma o totPacientes e sai fora...
   If txgeral = "B2" Then
      Range("totPac").Value = Range("totPac").Value + Total
      Exit Sub
   End If
   
   'Copia os dados...
   Range("Cabecalho").Offset(contador, 0).Value = txgeral
   Range("Cabecalho").Offset(contador, 1).Value = Nome
   Range("Cabecalho").Offset(contador, 6).Value = Total
   
   'Stop
   'Poe formulas nos verdes...
   If Range("H" & Trim(Str(contador + 8))).Value > 0 Then
      'Infeccoes...
      Range("J" & Trim(Str(contador + 8))).Formula = "=I" & Trim(Str(contador + 8)) & "/ H" & Trim(Str(contador + 8))
      Range("K" & Trim(Str(contador + 8))).Formula = "=I" & Trim(Str(contador + 8)) & "/ H" & Trim(Str(contador + 8) & " / ((F4-D4)+1)*1000")
      'Infectados...
      Range("M" & Trim(Str(contador + 8))).Formula = "=L" & Trim(Str(contador + 8)) & "/ H" & Trim(Str(contador + 8))
      Range("N" & Trim(Str(contador + 8))).Formula = "=L" & Trim(Str(contador + 8)) & "/ H" & Trim(Str(contador + 8) & " / ((F4-D4)+1)*1000")
   Else
      'Infeccoes...
      Range("J" & Trim(Str(contador + 8))).Value = 0
      Range("K" & Trim(Str(contador + 8))).Value = 0
      'Infectados...
      Range("M" & Trim(Str(contador + 8))).Value = 0
      Range("N" & Trim(Str(contador + 8))).Value = 0
   End If
   
   'Infeccoes...
   Range("I" & Trim(Str(contador + 8))).Value = 0
   'Infectados...
   Range("L" & Trim(Str(contador + 8))).Value = 0
   
   'Merge nas celulas...
   Range("C" & Trim(Str(contador + 8)) & ":G" & Trim(Str(contador + 8))).Select
   With Selection
       .MergeCells = True
   End With
   
   'Se tipo for B ou branco, NAO soma o totPacientes e destaca...
   If txgeral = "B" Or txgeral = "" Then
      'D|fffd| o destaque...
      Range("Cabecalho").Offset(contador, 6).Select
      With Selection.Interior
        .ColorIndex = 19
      End With
   Else
      'Casos A e C soma no totpac...
      Range("totPac").Value = Range("totPac").Value + Total
   End If
   
   
End Sub

'Incrementa as infeccoes
Public Sub Est3B( _
ByVal Nome As String, _
ByVal Total As Long _
)
   On Error Resume Next
   'Stop
   linha = Application.WorksheetFunction.Match(Nome, Range("C9:C300"), 0)
'   Range("H1").Value = nome
'   Range("I1").Value = Linha
   'Copia os dados...
   If linha > 0 Then
      Range("Cabecalho").Offset(linha, 7).Value = Total
   End If
   
End Sub

'Incrementa as infeccoes
Public Sub Est3C( _
ByVal Nome As String, _
ByVal Total As Long _
)
   On Error Resume Next
   'Stop
   linha = Application.WorksheetFunction.Match(Nome, Range("C9:C300"), 0)
'   Range("J1").Value = nome
'   Range("K1").Value = Linha
'   Copia os dados...
   If linha > 0 Then
      Range("Cabecalho").Offset(linha, 10).Value = Total
   End If
End Sub


Public Sub Est3Fim( _
ByVal contador As Integer, _
ByVal Inicio As String, _
ByVal fim As String _
)
   Sheets(PlanE3.Name).Select
   Call PoeGrid(Range("Cabecalho"))
   Range("D4").Value = CDate(Inicio)
   Range("F4").Value = CDate(fim)
   
   contador = contador + 8
   
   'Stop
   'Copia a linha total pro lugar do contador
   'Application.GoTo Reference:="Total"
   Range("B6:N6").Select
   Selection.Copy Destination:=Range("B" & contador & ":N" & contador)
   
   'Poe os totais ...
    totInf = Application.WorksheetFunction.Sum(Range("I9:I" & contador - 1))
    totIns = Application.WorksheetFunction.Sum(Range("L9:L" & contador - 1))
    
    'Poe os valores nas celulas...
    totPac = Range("H" & contador).Value
    Range("I" & contador).Value = totInf
    Range("L" & contador).Value = totIns

    'Poe as taxas se forem ok...
    If totPac > 0 Then
       Range("J" & contador).Value = totInf / totPac
       Range("M" & contador).Value = totIns / totPac
    End If

    'Seleciona...
    Range("D4").Select
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    PlanE3.Name = "Taxa Global"
    Call Salva_Html

End Sub

Public Sub Est3Configura(Titulo As String)
    Range("C8").Value = Titulo
End Sub

    
Attribute VB_Name = "ModEst5"
'Carrega as cirurgias
Public Sub Est5_Q1( _
ByVal contador As Integer, _
ByVal codproc As String, _
ByVal Procedimento As String, _
ByVal tipoCirurgia As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = codproc & "_" & tipoCirurgia
   Range("Cabecalho").Offset(contador + 1, 1).Value = Procedimento
   Range("Cabecalho").Offset(contador + 1, 2).Value = tipoCirurgia
   Range("Cabecalho").Offset(contador + 1, 3).Value = Total
End Sub

'Carrega as infec Todos Sitios
Public Sub Est5_Q2( _
ByVal codproc As String, _
ByVal tipoCirurgia As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   linha = Application.WorksheetFunction.Match(codproc & "_" & tipoCirurgia, Range("B5:B300"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 4).Value = Total
End Sub

'Carrega as infec Sitios Cirurgicos
Public Sub Est5_Q3( _
ByVal codproc As String, _
ByVal tipoCirurgia As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   linha = Application.WorksheetFunction.Match(codproc & "_" & tipoCirurgia, Range("B5:B300"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 5).Value = Total
End Sub

'...
Public Sub Est5_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
   
    'Ordena por medico, procedimento, iric
    Sheets("Est5aux").Select
    Range("C4").Select
    Selection.Sort Key1:=Range("C5"), Order1:=xlAscending, Key2:=Range("D5") _
        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
        False, Orientation:=xlTopToBottom
        
    'Inicializacoes...
    Sheets("Est5").Select
    linhavez = 5
    linhaRel = 13
    auxproc = Trim(Range("Est5aux!C5").Value)
    antproc = ""
    
    'Loop dos medicos...
    While auxproc <> ""
      
      'Se mudou de medico...
      If auxproc <> antproc Then
         'Copia a linha bonitinha...
         Range("Est5!umRegistro").Copy Destination:=Range("Est5!C" & linhaRel)
         'Poe o nome do procedimento na linha...
         Range("Est5!C" & linhaRel) = auxproc
         'Incrementa controles...
         antproc = auxproc
      End If
      
      'Processa os tipos do procedimento...
      While (auxproc = antproc)
         
         'Pega os dados da linha...
         tipo = Trim(Range("Est5aux!D" & linhavez).Value)
         cir = Range("Est5aux!E" & linhavez).Value
         infTS = Range("Est5aux!F" & linhavez).Value
         infSC = Range("Est5aux!G" & linhavez).Value
         
         'Aplica  o iric...
         If tipo = "" Then
            'nao faz nada...
         ElseIf tipo = "E" Then
            'Preenche as qtds...
            Range("Est5!G" & linhaRel).Value = Val(infSC)
            Range("Est5!M" & linhaRel).Value = Val(infTS)
            Range("Est5!S" & linhaRel).Value = Val(cir)
            'Calcula as taxas...
            If Val(cir) > 0 Then
               Range("Est5!H" & linhaRel).Value = Val(infSC) / Val(cir) * 100
               Range("Est5!N" & linhaRel).Value = Val(infTS) / Val(cir) * 100
            End If
         ElseIf tipo = "T" Then
            'Preenche as qtds...
            Range("Est5!I" & linhaRel).Value = Val(infSC)
            Range("Est5!O" & linhaRel).Value = Val(infTS)
            Range("Est5!T" & linhaRel).Value = Val(cir)
            'Calcula as taxas...
            If Val(cir) > 0 Then
               Range("Est5!J" & linhaRel).Value = Val(infSC) / Val(cir) * 100
               Range("Est5!P" & linhaRel).Value = Val(infTS) / Val(cir) * 100
            End If
         ElseIf tipo = "U" Then
            'Preenche as qtds...
            Range("Est5!K" & linhaRel).Value = Val(infSC)
            Range("Est5!Q" & linhaRel).Value = Val(infTS)
            Range("Est5!U" & linhaRel).Value = Val(cir)
            'Calcula as taxas...
            If Val(cir) > 0 Then
               Range("Est5!L" & linhaRel).Value = Val(infSC) / Val(cir) * 100
               Range("Est5!R" & linhaRel).Value = Val(infTS) / Val(cir) * 100
            End If
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         antproc = auxproc
         auxproc = Trim(Range("Est5aux!C" & linhavez).Value)
         
      Wend
      
      'Incrementa controles...
      linhaRel = linhaRel + 1
      
    Wend
    
    'Copia o total bonitao...
    Range("Est5!umTotal").Copy Destination:=Range("Est5!C" & linhaRel)
    
    'Determina o comeco desta tabela...
    auxlinha = linhaRel - 1
    While Range("C" & auxlinha).Value <> "Procedimentos"
        auxlinha = auxlinha - 1
    Wend
    auxlinha = auxlinha + 1
    
    'Poe os totais...
    Range("G" & linhaRel).Value = WorksheetFunction.Sum(Range("G" & Trim(Str(auxlinha)) & ":G" & Trim(Str(linhaRel - 1))))
    Range("I" & linhaRel).Value = WorksheetFunction.Sum(Range("I" & Trim(Str(auxlinha)) & ":I" & Trim(Str(linhaRel - 1))))
    Range("K" & linhaRel).Value = WorksheetFunction.Sum(Range("K" & Trim(Str(auxlinha)) & ":K" & Trim(Str(linhaRel - 1))))
    Range("M" & linhaRel).Value = WorksheetFunction.Sum(Range("M" & Trim(Str(auxlinha)) & ":M" & Trim(Str(linhaRel - 1))))
    Range("O" & linhaRel).Value = WorksheetFunction.Sum(Range("O" & Trim(Str(auxlinha)) & ":O" & Trim(Str(linhaRel - 1))))
    Range("Q" & linhaRel).Value = WorksheetFunction.Sum(Range("Q" & Trim(Str(auxlinha)) & ":Q" & Trim(Str(linhaRel - 1))))
    Range("S" & linhaRel).Value = WorksheetFunction.Sum(Range("S" & Trim(Str(auxlinha)) & ":S" & Trim(Str(linhaRel - 1))))
    Range("T" & linhaRel).Value = WorksheetFunction.Sum(Range("T" & Trim(Str(auxlinha)) & ":T" & Trim(Str(linhaRel - 1))))
    Range("U" & linhaRel).Value = WorksheetFunction.Sum(Range("U" & Trim(Str(auxlinha)) & ":U" & Trim(Str(linhaRel - 1))))
    
    'Calcula as taxas totais E...
    If Val(Range("S" & linhaRel).Value) > 0 Then
       Range("Est5!H" & linhaRel).Value = Val(Range("G" & linhaRel).Value) / Val(Range("S" & linhaRel).Value) * 100
       Range("Est5!N" & linhaRel).Value = Val(Range("M" & linhaRel).Value) / Val(Range("S" & linhaRel).Value) * 100
    End If
    
    'Calcula as taxas totais T...
    If Val(Range("T" & linhaRel).Value) > 0 Then
       Range("Est5!J" & linhaRel).Value = Val(Range("I" & linhaRel).Value) / Val(Range("T" & linhaRel).Value) * 100
       Range("Est5!P" & linhaRel).Value = Val(Range("O" & linhaRel).Value) / Val(Range("T" & linhaRel).Value) * 100
    End If
    
    'Calcula as taxas totais U...
    If Val(Range("U" & linhaRel).Value) > 0 Then
       Range("Est5!L" & linhaRel).Value = Val(Range("K" & linhaRel).Value) / Val(Range("U" & linhaRel).Value) * 100
       Range("Est5!R" & linhaRel).Value = Val(Range("Q" & linhaRel).Value) / Val(Range("U" & linhaRel).Value) * 100
    End If
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Posiciona la em cima...
    Range("D2").Select
    
    'Atualiza e exibe...
    Sheets("Est5aux").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html
    
End Sub



Attribute VB_Name = "ModEst6"
'Carrega o total das cirurgias clinicas realizadas
Public Sub Est6_Q1( _
ByVal contador As Integer, _
ByVal codClinica As String, _
ByVal nomeclinica As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = codClinica
   Range("Cabecalho").Offset(contador + 1, 1).Value = nomeclinica
   Range("Cabecalho").Offset(contador + 1, 2).Value = Total
End Sub

'Carrega a total das infeccoes em todos os sitios sobre as cirurgias clinicas realizadas
Public Sub Est6_Q2( _
ByVal codClinica As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   linha = Application.WorksheetFunction.Match(codClinica, Range("B5:B300"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 3).Value = Total
End Sub


'Carrega as infec Sitios Cirurgicos
Public Sub Est6_Q3( _
ByVal codClinica As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   linha = Application.WorksheetFunction.Match(codClinica, Range("B5:B300"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 4).Value = Total
End Sub

'...
Public Sub Est6_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
   
    'Ordena por medico, procedimento, iric
    Sheets("Est6aux").Select
    Range("B4").Select
    Selection.Sort Key1:=Range("C5"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
        
    'Inicializacoes...
    Sheets("Est6").Select
    linhavez = 5
    linhaRel = 10
    auxcli = Trim(Range("Est6aux!C5").Value)
    
    'Loop dos medicos...
    While auxcli <> ""
      
       'Copia a linha bonitinha...
       Range("Est6!umRegistro").Copy Destination:=Range("Est6!C" & linhaRel)
       
       'Poe o nome da clinica na linha...
       Range("Est6!C" & linhaRel).Value = Range("Est6aux!C" & linhavez).Value
       
       'Poe o infSC da clinica na linha...
       Range("Est6!G" & linhaRel).Value = Val(Range("Est6aux!F" & linhavez).Value)
       
       'Poe o infTS da clinica na linha...
       Range("Est6!I" & linhaRel).Value = Val(Range("Est6aux!E" & linhavez).Value)
       
       'Poe o total da clinica na linha...
       Range("Est6!K" & linhaRel).Value = Val(Range("Est6aux!D" & linhavez).Value)
       
       'Calcula as taxas ...
       If Val(Range("K" & linhaRel).Value) > 0 Then
          Range("Est6!H" & linhaRel).Value = Val(Range("G" & linhaRel).Value) / Val(Range("K" & linhaRel).Value) * 100
          Range("Est6!J" & linhaRel).Value = Val(Range("I" & linhaRel).Value) / Val(Range("K" & linhaRel).Value) * 100
       End If
         
       'Incrementa controles...
       linhaRel = linhaRel + 1
       linhavez = linhavez + 1
       auxcli = Trim(Range("Est6aux!C" & linhavez).Value)
      
    Wend
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Sheets("Est6aux").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html
    
End Sub


Attribute VB_Name = "ModEst7"
'...
Public Sub Est7_Q1( _
ByVal contador As Integer, _
ByVal CodMedico As String, _
ByVal NomeMedico As String, _
ByVal CodProcedimento As String, _
ByVal NomeProcedimento As String, _
ByVal IRIC As String, _
ByVal Total As Long _
)
   
   
   On Error Resume Next
   'Stop
   IRIC = validaParamString(IRIC)

   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = Trim(CodMedico) _
                                              & "_" & Trim(CodProcedimento) _
                                              & "_" & Trim(IRIC)
   Range("Cabecalho").Offset(contador + 1, 1).Value = NomeMedico
   Range("Cabecalho").Offset(contador + 1, 2).Value = NomeProcedimento
   Range("Cabecalho").Offset(contador + 1, 3).Value = IRIC
   Range("Cabecalho").Offset(contador + 1, 4).Value = Total
End Sub

'...
Public Sub Est7_Q2( _
ByVal CodMedico As String, _
ByVal CodProcedimento As String, _
ByVal IRIC As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   IRIC = validaParamString(IRIC)
   'Procura...<R> melhorar o 10000...
   linha = Application.WorksheetFunction.Match(Trim(CodMedico) _
                                       & "_" & Trim(CodProcedimento) _
                                       & "_" & Trim(IRIC) _
                                       , Range("B5:B10000"), 0)
'   If linha = 0 Then
'     Stop
'   End If
     
   
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 5).Value = Total
End Sub

'...
Public Sub Est7_Fim( _
ByVal Inicio As String, _
ByVal fim As String _
)
   
    'Ordena por medico, procedimento, iric
    Sheets("Est7aux").Select
    Range("B4").Select
    Selection.Sort Key1:=Range("C5"), Order1:=xlAscending, Key2:=Range("D5") _
        , Order2:=xlAscending, Key3:=Range("E5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
        
    'Inicializacoes...
    Sheets("Est7").Select
    linhavez = 5
    linhaRel = 13
    auxmedico = Trim(Range("Est7aux!C5").Value)
    antMedico = ""
    
    'Loop dos medicos...
    While auxmedico <> ""
      
      'Se mudou de medico...
      If auxmedico <> antMedico Then
         'Pula uma linha em branco...
         Rows(linhaRel & ":" & linhaRel).Select
         Selection.RowHeight = 17
         linhaRel = linhaRel + 1
         'Copia o cabecalho bonitao...
         Range("Est7!umCabecalho").Copy Destination:=Range("Est7!C" & linhaRel)
         'Poe o nome do medico no cabecalho...
         Range("Est7!C" & linhaRel) = auxmedico
         'Incrementa controles...
         linhaRel = linhaRel + 3
         antMedico = auxmedico
         auxproc = Trim(Range("Est7aux!D" & linhavez).Value)
         antproc = ""
      End If
      
      'Se mudou de procedimento...
      If auxproc <> antproc Then
         'Copia a linha bonitinha...
         Range("Est7!umRegistro").Copy Destination:=Range("Est7!C" & linhaRel)
         'Poe o nome do procedimento na linha...
         Range("Est7!C" & linhaRel) = auxproc
         'Incrementa controles...
         antproc = auxproc
      End If
      
      'Processa os IRICS do procedimento...
      While (auxproc = antproc) And (auxmedico = antMedico)
         
         'Pega os dados da linha...
         IRIC = Range("Est7aux!E" & linhavez).Value
         cir = Range("Est7aux!F" & linhavez).Value
         inf = Range("Est7aux!G" & linhavez).Value
         
         'Aplica  o iric...
         If IRIC = ".0." Then
            Range("Est7!G" & linhaRel).Value = Val(inf)
            Range("Est7!H" & linhaRel).Value = Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est7!I" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         ElseIf IRIC = ".1." Then
            Range("Est7!J" & linhaRel).Value = Val(inf)
            Range("Est7!K" & linhaRel).Value = Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est7!L" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         ElseIf IRIC = ".2." Then
            Range("Est7!M" & linhaRel).Value = Val(inf)
            Range("Est7!N" & linhaRel).Value = Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est7!O" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         ElseIf IRIC = ".3." Then
            Range("Est7!P" & linhaRel).Value = Val(inf)
            Range("Est7!Q" & linhaRel).Value = Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est7!R" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         Else
            Range("Est7!S" & linhaRel).Value = Val(inf)
            Range("Est7!T" & linhaRel).Value = Val(cir)
            'Calcula a taxa...
            If Val(cir) > 0 Then
               Range("Est7!U" & linhaRel).Value = Val(inf) / Val(cir) * 100
            End If
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         antproc = auxproc
         antMedico = auxmedico
         auxmedico = Trim(Range("Est7aux!C" & linhavez).Value)
         auxproc = Trim(Range("Est7aux!D" & linhavez).Value)
         
      Wend
      
      'Incrementa controles...
      linhaRel = linhaRel + 1
      
      'Se mudou de medico... poe o total
      If auxmedico <> antMedico Then
         'Copia o total bonitao...
         Range("Est7!umTotal").Copy Destination:=Range("Est7!C" & linhaRel)
         'Determina o comeco desta tabela...
         auxlinha = linhaRel - 1
         While Range("C" & auxlinha).Value <> "Procedimentos"
           auxlinha = auxlinha - 1
         Wend
         auxlinha = auxlinha + 1
         'Poe os totais...
         Range("G" & linhaRel).Value = WorksheetFunction.Sum(Range("G" & Trim(Str(auxlinha)) & ":G" & Trim(Str(linhaRel - 1))))
         Range("H" & linhaRel).Value = WorksheetFunction.Sum(Range("H" & Trim(Str(auxlinha)) & ":H" & Trim(Str(linhaRel - 1))))
         Range("J" & linhaRel).Value = WorksheetFunction.Sum(Range("J" & Trim(Str(auxlinha)) & ":J" & Trim(Str(linhaRel - 1))))
         Range("K" & linhaRel).Value = WorksheetFunction.Sum(Range("K" & Trim(Str(auxlinha)) & ":K" & Trim(Str(linhaRel - 1))))
         Range("M" & linhaRel).Value = WorksheetFunction.Sum(Range("M" & Trim(Str(auxlinha)) & ":M" & Trim(Str(linhaRel - 1))))
         Range("N" & linhaRel).Value = WorksheetFunction.Sum(Range("N" & Trim(Str(auxlinha)) & ":N" & Trim(Str(linhaRel - 1))))
         Range("P" & linhaRel).Value = WorksheetFunction.Sum(Range("P" & Trim(Str(auxlinha)) & ":P" & Trim(Str(linhaRel - 1))))
         Range("Q" & linhaRel).Value = WorksheetFunction.Sum(Range("Q" & Trim(Str(auxlinha)) & ":Q" & Trim(Str(linhaRel - 1))))
         Range("S" & linhaRel).Value = WorksheetFunction.Sum(Range("S" & Trim(Str(auxlinha)) & ":S" & Trim(Str(linhaRel - 1))))
         Range("T" & linhaRel).Value = WorksheetFunction.Sum(Range("T" & Trim(Str(auxlinha)) & ":T" & Trim(Str(linhaRel - 1))))
         'Calcula a taxa da linha TOTAL...
         If Val(Range("Est7!H" & linhaRel).Value) > 0 Then
            Range("Est7!I" & linhaRel).Value = Val(Range("Est7!G" & linhaRel).Value) / Val(Range("Est7!H" & linhaRel).Value) * 100
         End If
         If Val(Range("Est7!K" & linhaRel).Value) > 0 Then
            Range("Est7!L" & linhaRel).Value = Val(Range("Est7!J" & linhaRel).Value) / Val(Range("Est7!K" & linhaRel).Value) * 100
         End If
         If Val(Range("Est7!N" & linhaRel).Value) > 0 Then
            Range("Est7!O" & linhaRel).Value = Val(Range("Est7!M" & linhaRel).Value) / Val(Range("Est7!N" & linhaRel).Value) * 100
         End If
         If Val(Range("Est7!Q" & linhaRel).Value) > 0 Then
            Range("Est7!R" & linhaRel).Value = Val(Range("Est7!P" & linhaRel).Value) / Val(Range("Est7!Q" & linhaRel).Value) * 100
         End If
         If Val(Range("Est7!T" & linhaRel).Value) > 0 Then
            Range("Est7!U" & linhaRel).Value = Val(Range("Est7!S" & linhaRel).Value) / Val(Range("Est7!T" & linhaRel).Value) * 100
         End If
         'Avanca a linha...
         linhaRel = linhaRel + 1
      End If
      
    Wend
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Atualiza e exibe...
    Sheets("Est7aux").Visible = False
    PlanE7.Name = "Cirur. x Proced. x IRIC"
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html
    
End Sub

Attribute VB_Name = "ModEst8"
'Carrega o total das cirurgias realizadas
Public Sub Est8_Q1( _
ByVal contador As Integer, _
ByVal pNome As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   
   'Valida o parametro...
   pNome = validaParamString(pNome)
   
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = pNome
   Range("Cabecalho").Offset(contador + 1, 1).Value = Total
End Sub

'Carrega a total das infeccoes
Public Sub Est8_Q2( _
ByVal pNome As String, _
ByVal Total As Long _
)
   
   On Error Resume Next
   'Stop
   
   'Valida o parametro...
   pNome = validaParamString(pNome)
   
   linha = Application.WorksheetFunction.Match(pNome, Range("B5:B300"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 2).Value = Total
End Sub

'...
Public Sub Est8_Fim( _
ByVal Titulo As String, _
ByVal Parametro As String, _
ByVal Inicio As String, _
ByVal fim As String _
)

    'Inicializacoes...
    Sheets("Est8").Select

    linhavez = 5
    linhaRel = 9
    auxcli = Trim(Range("Est8aux!B5").Value)

    'Loop ...
    While auxcli <> ""

       'Copia a linha bonitinha...
       Range("Est8!umRegistro").Copy Destination:=Range("Est8!C" & linhaRel)

       'Poe o nome na linha...
       Range("Est8!C" & linhaRel).Value = Range("Est8aux!B" & linhavez).Value
       
       'Poe o infec na linha...
       Range("Est8!G" & linhaRel).Value = Val(Range("Est8aux!D" & linhavez).Value)
       
       'Poe o cirur na linha...
       Range("Est8!I" & linhaRel).Value = Val(Range("Est8aux!C" & linhavez).Value)
       
       'Calcula as taxas ...
       If Val(Range("I" & linhaRel).Value) > 0 Then
          Range("Est8!H" & linhaRel).Value = Val(Range("G" & linhaRel).Value) / Val(Range("I" & linhaRel).Value) * 100
       End If
         
       'Incrementa controles...
       linhaRel = linhaRel + 1
       linhavez = linhavez + 1
       auxcli = Trim(Range("Est8aux!B" & linhavez).Value)
      
    Wend
    
    'Poe os titulos...
    Range("C2").Value = Titulo
    Range("C8").Value = Parametro
    
    'Poe as datas...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    
    'Posiciona la em cima...
    Range("C2").Select
    
    'Ordena os dados de forma decrescente
    Range("C8:I12").Sort Key1:=Range("H8"), Order1:=xlDescending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
    
    'Oculta auxiliares e mostra o grafico...
    Worksheets("Est8aux").Visible = False
    'S|fffd| mostra o gr|fffd|fico 8 se for relat|fffd|rio de "Taxa Infec|fffd||fffd|o Cirurgia X Pot. de Contamina|fffd||fffd|o"
    If Trim(Titulo) = "Taxa Infec|fffd||fffd|o Cirurgia X Pot. de Contamina|fffd||fffd|o" Then
        PlanG8.Visible = xlSheetVisible
    Else
        PlanG8.Visible = xlSheetHidden
    End If
    Call Salva_Html
    
End Sub




Attribute VB_Name = "ModEst9"
'Carrega o nome das colunas...
Public Sub Est9_Q1( _
ByVal contador As Integer, _
ByVal pColuna As String _
)
   
   'Stop
   'Application.ScreenUpdating = True
   'Application.Visible = True
   
   On Error Resume Next

   'Inicializacoes...
   Sheets("Est9").Select

   'Valida o parametro...
   pColuna = validaParamString(pColuna)

   'Copia os dados...
   Range("UmaColuna").Select
   Selection.Copy Destination:=Range("Cabecalho").Offset(0, 3 * contador + 1)
   Range("Cabecalho").Offset(0, 3 * contador + 1).Value = pColuna

   'Incrementa o numero de colunas...
   Range("Est9!C7").Value = Range("Est9!C7").Value + 1
End Sub

'Carrega o nome das linhas , colunas, total ...
Public Sub Est9_Q2( _
ByVal contador As Integer, _
ByVal pLinha As String, _
ByVal pColuna As String, _
ByVal Total As Long _
)
   
'   Stop
'
'   PlanE9.Visible = xlSheetVisible
'   PlanE9aux.Visible = xlSheetVisible
'   Application.ScreenUpdating = True
'   Application.Visible = True

   On Error Resume Next
   
   'Inicializacoes...
   Sheets("Est9aux").Select
   
   'Valida os parametros...
   pLinha = validaParamString(pLinha)
   pColuna = validaParamString(pColuna)
   
   'Copia os dados...
   Range("Cabecalho").Offset(contador + 1, 0).Value = pLinha & "_" & pColuna
   Range("Cabecalho").Offset(contador + 1, 1).Value = pLinha
   Range("Cabecalho").Offset(contador + 1, 2).Value = pColuna
   Range("Cabecalho").Offset(contador + 1, 3).Value = Total
   
End Sub

'Carrega as infeccoes...
Public Sub Est9_Q3( _
ByVal pLinha As String, _
ByVal pColuna As String, _
ByVal Total As Long _
)
   
   'Stop
   On Error Resume Next
   
   'Inicializacoes...
   Sheets("Est9aux").Select
   
   'Valida os parametros...
   pLinha = validaParamString(pLinha)
   pColuna = validaParamString(pColuna)
   
   linha = Application.WorksheetFunction.Match(pLinha & "_" & pColuna, Range("B5:B1000"), 0)
   'Copia os dados...
   Range("Cabecalho").Offset(linha, 4).Value = Total
   
End Sub

'Carrega o total de cirurgias para sitio primario...
Public Sub Est9_Q4( _
ByVal pParam As String, _
ByVal Total As Long, _
ByVal cCampoColuna As String, _
ByVal cCampoLinha As String _
)

   'Application.ScreenUpdating = True
   'Application.Visible = True
   'Stop
   
   On Error Resume Next
   Dim cont As Integer
   cont = 1
   
   
   'Inicializacoes...
   Sheets("Est9aux").Select
   
   'Valida os parametros...
   pParam = validaParamString(pParam)
   
   linha = Application.WorksheetFunction.Match(pParam, Range("C5:C1000"), 0)
   
   'Copia os dados...s|fffd| se achou...
   If linha > 0 Then
      'Poe no primeiro achado...
      Range("Cabecalho").Offset(linha, 3).Value = Total

      'Replica nas linhas seguintes, pois o match so faz o primeiro...
      Nome = Range("Cabecalho").Offset(linha, 1).Value
      linha = linha + 1
      nomeaux = Range("Cabecalho").Offset(linha, 1).Value
      While Nome = nomeaux
         Range("Cabecalho").Offset(linha, 3).Value = Total
         linha = linha + 1
         nomeaux = Range("Cabecalho").Offset(linha, 1).Value
      Wend
   Else
      'Acha a |fffd|ltima linha
      'If cCampoColuna = "S|fffd|tio Prim|fffd|rio" Then
         While Range("Cabecalho").Offset(cont, 1) <> ""
           cont = cont + 1
         Wend
         Range("Cabecalho").Offset(cont, 1) = cCampoColuna
         Range("Cabecalho").Offset(cont, 2) = cCampoLinha

         Range("Cabecalho").Offset(cont, 3) = Total
         Range("Cabecalho").Offset(cont, 4) = 0
      'Else
        If False And cCampoLinha = "S|fffd|tio Prim|fffd|rio" Then
           While Range("Cabecalho").Offset(cont, 1) <> ""
             cont = cont + 1
           Wend
           Range("Cabecalho").Offset(cont, 1) = "<Sem Infec|fffd||fffd|o>"
           Range("Cabecalho").Offset(cont, 2) = "<Sem Infec|fffd||fffd|o>"
           Range("Cabecalho").Offset(cont, 3) = Total
           Range("Cabecalho").Offset(cont, 4) = 0
        End If
      'End If
   End If
End Sub
'...
Public Sub Est9_Fim( _
ByVal Inicio As String, _
ByVal fim As String, _
ByVal pLinha As String, _
ByVal pColuna As String _
)
        
    On Error Resume Next

    'Valida os parametros...
    pLinha = validaParamString(pLinha)
    pColuna = validaParamString(pColuna)
     
    'Inicializacoes...
    Sheets("Est9").Select
    linhavez = 5
    linhaRel = 15
    auxlinha = Trim(Range("Est9aux!C5").Value)
    antLinha = ""
    
    'Loop das linhas...
    While auxlinha <> ""
      
      'Se mudou de linha...
      If auxlinha <> antLinha Then
         'Copia a linha bonitinha...
         Range("Est9!linhaRegistro").Copy Destination:=Range("Est9!C" & linhaRel)
         'Poe o nome do parametro na linha...
         Range("Est9!C" & linhaRel) = auxlinha
         'Copia os registros para acada coluna...
         For i = 0 To Range("Est9!C7").Value - 1
            Range("Est9!umRegistro").Copy Destination:=Range("Cabecalho").Offset(linhaRel - 15 + 2, 3 * i + 1)
         Next i
         'Incrementa controles...
         antLinha = auxlinha
      End If
      

      'Processa os tipos do procedimento...
      While (auxlinha = antLinha)
         
         'Pega os dados da linha...
         coluna = Trim(Range("Est9aux!D" & linhavez).Value)
         cir = CInt(Range("Est9aux!E" & linhavez).Value)
         Infec = CInt(Range("Est9aux!F" & linhavez).Value)
         
         'Procura a coluna no header...
         posicao = Application.WorksheetFunction.Match(coluna, Range("G13:IS13"), 0)
         'Se achou, entao poe os dados...
         If posicao > 0 Then
            'Procedimentos
            If pLinha = "Procedimento Cir|fffd|rgico" And pColuna = "S|fffd|tio Prim|fffd|rio" Then
                For i = 0 To Range("Est9!C7").Value - 1
                    Range("Est9!Cabecalho").Offset(linhaRel - 15 + 2, 3 * i + 2) = CInt(Range("Est9aux!E" & linhavez).Value)
                Next i
             Else
                For i = 0 To Range("Est9!C7").Value - 1
                  If Range("Est9aux!D" & linhavez).Value = Range("Est9!Cabecalho").Offset(0, 3 * i + 1).Value Then
                      Range("Est9!Cabecalho").Offset(linhaRel - 15 + 2, 3 * i + 2) = CInt(Range("Est9aux!E" & linhavez).Value)
                  End If
                Next i
             End If
         
            'Infecao e cirurgias...
            Range("Cabecalho").Offset(linhaRel - 15 + 2, posicao).Value = Infec
            'Range("Cabecalho").Offset(linhaRel - 15 + 2, posicao + 1).Value = cir
            'Calcula a taxa...
            If cir > 0 Then
               Range("Cabecalho").Offset(linhaRel - 15 + 2, posicao + 2).Value = Infec / cir * 100
            End If
         End If
         
         'Incrementa variaveis...
         linhavez = linhavez + 1
         antLinha = auxlinha
         auxlinha = Trim(Range("Est9aux!C" & linhavez).Value)
         
      Wend
      
      'Incrementa controles...
      linhaRel = linhaRel + 1
      
    Wend 'principal
    
    'Stop
   
    'Copia o total bonitao...
    Range("oTotal").Copy Destination:=Range("C" & linhaRel)
      
    'Determina o comeco desta tabela...
    auxlinha = 15
    
    'Iterage em todas as colunas...
    For i = 0 To Range("C7").Value - 1
         
       'Copia um total bonitinho..
       Range("umTotal").Copy Destination:=Range("C" & linhaRel).Offset(0, i * 3 + 1)
         
       'Poe os totais...
       adr = Range("C" & linhaRel).Offset(auxlinha - linhaRel, i * 3 + 1).AddressLocal & ":" & _
             Range("C" & linhaRel).Offset(-1, i * 3 + 1).AddressLocal
       Num = WorksheetFunction.Sum(Range(adr))
       adr = Range("C" & linhaRel).Offset(auxlinha - linhaRel, i * 3 + 2).AddressLocal & ":" & _
             Range("C" & linhaRel).Offset(-1, i * 3 + 2).AddressLocal
       den = WorksheetFunction.Sum(Range(adr))
       Range("C" & linhaRel).Offset(0, i * 3 + 1).Value = Num
       Range("C" & linhaRel).Offset(0, i * 3 + 2).Value = den
       'Calcula as taxas totais ...
       If Val(den) > 0 Then
            Range("C" & linhaRel).Offset(0, i * 3 + 3).Value = Num / den * 100
       End If
         
    Next i 'For
    
    'Poe as datas e titulos...
    Range("D4").Value = Inicio
    Range("F4").Value = fim
    Range("C13").Value = pColuna & "->"
    Range("C14").Value = pLinha
    Range("D2").Value = "Taxa Cir|fffd|rgica: " & pLinha & " X " & pColuna
    
    'Posiciona la em cima...
    Range("D2").Select
    
    'Atualiza e exibe...
    Sheets("Est9aux").Visible = False
    Application.ScreenUpdating = True
    Application.Visible = True
    Call Salva_Html
    
End Sub

'Vai
Public Sub Est9_MoveVai()
    
    'Salva a D na G...
    Columns("D:D").Select
    Selection.Copy Destination:=Columns("G:G")
    'Poe a C na D...
    Columns("C:C").Select
    Selection.Copy Destination:=Columns("D:D")
    'Poe a G na C...
    Columns("G:G").Select
    Selection.Copy Destination:=Columns("C:C")
    'Apaga a G....
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    'Pega a C e ordena...
    Range("C4").Select
    Selection.Sort Key1:=Range("C5"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub

'Volta
Public Sub Est9_MoveVolta()
    
    'Pega a C e salva na G...
    Columns("C:C").Select
    Selection.Copy Destination:=Columns("G:G")
    'Poe a D na C...
    Columns("D:D").Select
    Selection.Copy Destination:=Columns("C:C")
    'Poe a G na D...
    Columns("G:G").Select
    Selection.Copy Destination:=Columns("D:D")
    'Apaga a G...
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    'Pega a C e ordena...
    Range("C4").Select
    Selection.Sort Key1:=Range("C5"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub


Attribute VB_Name = "ModEstComp"
'Preenche - Acessada via Delphi
Public Sub PreencheProcedimentos(ByVal contador As Integer, _
                                 ByVal Nome As String, _
                                 ByVal taxaIric0 As Double, _
                                 ByVal taxaIric1 As Double, _
                                 ByVal taxaIric2 As Double, _
                                 ByVal taxaIric3 As Double)
    PlanECompAux.Cells(contador + 2, 1) = Nome
    PlanECompAux.Cells(contador + 2, 2) = taxaIric0
    PlanECompAux.Cells(contador + 2, 3) = taxaIric1
    PlanECompAux.Cells(contador + 2, 4) = taxaIric2
    PlanECompAux.Cells(contador + 2, 5) = taxaIric3
End Sub

'Copia os dados para a planilha do c|fffd|lculo do comparativo do cirurgi|fffd|o
Public Sub ExportaParaComparativo()
    Dim inicial, final, qtdLinhas As Integer
    
    Dim linha, coluna As Integer
    Dim valor As String
    Dim planilha As String

    Application.ScreenUpdating = False

    If ActiveSheet.Name = "Cirur. x Proced. x IRIC" Then
        planilha = PlanE7.Name
    Else
        If ActiveSheet.Name = "Esp. x Proced. x IRIC" Then
            planilha = PlanE19.Name
        Else
            Exit Sub
        End If
    End If


    linha = ActiveCell.Row
    coluna = ActiveCell.Column
    valor = ActiveCell.Value

    Dim i As Integer

    If (Cells(linha - 1, coluna) <> "") Or (Cells(linha + 2, coluna) <> "Procedimentos") Then
        MsgBox "Sele|fffd||fffd|o inv|fffd|lida, escolha o t|fffd|tulo de uma tabela e clique em 'C|fffd|lculo de Comparativo'", vbInformation
        Exit Sub
    End If

    inicial = linha + 3
    i = inicial
    Do While Cells(i, 3) <> "total"
        i = i + 1
    Loop

    final = (i - 1)
    qtdLinhas = final - inicial + 1
    
    PlanEComp.Visible = xlSheetVisible
    PlanEComp.Select
    Call Limpa
    PlanEComp.Range("D6").Value = "" 'Nome Cirurgi|fffd|o/Especialidade
    PlanEComp.Range("D4").Value = "" 'Data Inicio
    PlanEComp.Range("F4").Value = "" 'Data Fim

    'Copia os Valores e seleciona a planilha
    PlanEComp.Range("D6").Value = valor
    PlanEComp.Range("D4").Value = Sheets(planilha).Range("D4").Value
    PlanEComp.Range("F4").Value = Sheets(planilha).Range("F4").Value
    PlanEComp.Select
    PlanEComp.Range("C10").Select

    'Copia os Procedimentos 4x
    Sheets(planilha).Select
    Sheets(planilha).Range("C" & inicial & ":C" & final).Select
    Selection.Copy
    PlanEComp.Select
    PlanEComp.Range("C10").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    PlanEComp.Range("C" & (10 + qtdLinhas * 1)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    PlanEComp.Range("C" & (10 + qtdLinhas * 2)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    PlanEComp.Range("C" & (10 + qtdLinhas * 3)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    
    
    'IRIC 0
    Sheets(planilha).Select
    Sheets(planilha).Range("G" & inicial & ":H" & final).Select
    Selection.Copy
    PlanEComp.Select
    PlanEComp.Range("H10").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    'IRIC 1
    Sheets(planilha).Select
    Sheets(planilha).Range("J" & inicial & ":K" & final).Select
    Selection.Copy
    PlanEComp.Select
    PlanEComp.Range("H" & (10 + qtdLinhas * 1)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    'IRIC 2
    Sheets(planilha).Select
    Sheets(planilha).Range("M" & inicial & ":N" & final).Select
    Selection.Copy
    PlanEComp.Select
    PlanEComp.Range("H" & (10 + qtdLinhas * 2)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    'IRIC 3
    Sheets(planilha).Select
    Sheets(planilha).Range("P" & inicial & ":Q" & final).Select
    Selection.Copy
    Cells(linha, coluna).Select
    PlanEComp.Select
    PlanEComp.Range("H" & (10 + qtdLinhas * 3)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False

    'Preenche o numero do Iric
    i = 10
    Do While (Cells(i, 3).Value <> "")
        Cells(i, 7).Value = Int((i - 10) / qtdLinhas)
        Cells(i, 10).Formula = "=VLOOKUP(RC[-7],CompAux!R2C1:R500C5,Comp!RC[-3]+2,FALSE)"
        i = i + 1
    Loop
    
    Application.ScreenUpdating = True
    Range("A1").Select
End Sub
Attribute VB_Name = "ModIndicador"
'============================================================================
' <TODOS RELATORIOS>
'============================================================================
Public Sub Indicador(ByVal Num As Integer)
   
   'Display false para ser mais rapido
   Application.ScreenUpdating = False
   
   'Maximiza e oculta...
   Application.Visible = False
   
   'Mostra e selecioa a escolhida...
   Sheets("Indicador" & Num).Visible = True
   Sheets("Indicador" & Num).Select
   Sheets("JANUS").Visible = False
   
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
   Call Salva_Html
   
End Sub

Attribute VB_Name = "ModRelatorios"
'============================================================================
' <TODOS RELATORIOS>
'============================================================================
Public Sub Rel_Ini(ByVal Nome As String)
   
   'Display false para ser mais rapido
   Application.ScreenUpdating = False
   
   'Maximiza e oculta...
   'Application.DisplayFullScreen = True
   Application.Visible = False
   
   'Mostra e selecioa a escolhida...
   Sheets(Nome).Visible = True
   Sheets(Nome).Select
   Sheets("JANUS").Visible = False
   
End Sub

Public Sub Rel_Fim()
   
   'Poe o gridzinho...
   Call PoeGrid(Range("Cabecalho"))
   
   'Descelecionsa...
   Range("Cabecalho").Select
   
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
   Call Salva_Html
   
End Sub

'============================================================================
' GERMES
'============================================================================
Public Sub Rel_Germes( _
  ByVal contador As Integer, _
  ByVal Codigo As Long, _
  ByVal Nome As String, _
  ByVal Grupo As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = Grupo
End Sub


'============================================================================
' ANTIBIOTICOS
'============================================================================
Public Sub Rel_Antibioticos( _
  ByVal contador As Integer, _
  ByVal Codigo As Long, _
  ByVal Nome As String, _
  ByVal Grupo As String, _
  ByVal antibiograma As Boolean _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = Grupo
   Range("Cabecalho").Offset(contador + 1, 3).Value = antibiograma
End Sub

'============================================================================
' MATERIAIS
'============================================================================
Public Sub Rel_Materiais( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String, _
  ByVal Grupo As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = Grupo
End Sub

'============================================================================
' CONVENIOS
'============================================================================
Public Sub Rel_Convenios( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub

'============================================================================
' ESPECIALIDADES
'============================================================================
Public Sub Rel_Especialidades( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub

'============================================================================
' CADASTROMEDICO
'============================================================================
Public Sub Rel_CadastroMedicos( _
  ByVal contador As Integer, _
  ByVal Nome As String, _
  ByVal crm As String, _
  ByVal esp As String, _
  ByVal email As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 1).Value = crm
   Range("Cabecalho").Offset(contador + 1, 2).Value = esp
   Range("Cabecalho").Offset(contador + 1, 3).Value = email
End Sub

'============================================================================
' PROCCIRURGICO
'============================================================================
Public Sub Rel_ProcCirurgicos( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String, _
  ByVal cutoff As Integer, _
  ByVal iric0 As Double, _
  ByVal iric1 As Double, _
  ByVal iric2 As Double, _
  ByVal iric3 As Double _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = cutoff
   Range("Cabecalho").Offset(contador + 1, 3).Value = iric0
   Range("Cabecalho").Offset(contador + 1, 4).Value = iric1
   Range("Cabecalho").Offset(contador + 1, 5).Value = iric2
   Range("Cabecalho").Offset(contador + 1, 6).Value = iric3
End Sub

'============================================================================
' PROCINVASIVO
'============================================================================
Public Sub Rel_ProcInvasivos( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub

'============================================================================
' UNIDADES CLINICAS
'============================================================================
Public Sub Rel_UnidadesClinicas( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String, _
  ByVal taxageral As String _
)
   
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = taxageral
End Sub

'============================================================================
' SERVICO NISS
'============================================================================
Public Sub Rel_ServicoNISS( _
  ByVal contador As Integer, _
  ByVal Numero As Integer, _
  ByVal Nome As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Numero
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub

'============================================================================
' SITIO PRIMARIO
'============================================================================
Public Sub Rel_SitioPrimario( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String, _
  ByVal compcir As Boolean _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = compcir
End Sub

'============================================================================
' SITIO SECUNDARIO
'============================================================================
Public Sub Rel_SitioSecundario( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String, _
  ByVal SitioPri As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
   Range("Cabecalho").Offset(contador + 1, 2).Value = SitioPri
End Sub

'============================================================================
' SERVICO NISS
'============================================================================
Public Sub Rel_GrupoGermes( _
  ByVal contador As Integer, _
  ByVal Numero As Integer, _
  ByVal Nome As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Numero
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub
Public Sub Rel_GrupoAntibioticos( _
  ByVal contador As Integer, _
  ByVal Numero As Integer, _
  ByVal Nome As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Numero
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub


'============================================================================
' EQUIPE MEDICA
'============================================================================
Public Sub Rel_EquipeMedica( _
  ByVal contador As Integer, _
  ByVal Numero As Integer, _
  ByVal Nome As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Numero
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub

'============================================================================
' CID
'============================================================================
Public Sub Rel_CID( _
  ByVal contador As Integer, _
  ByVal Codigo As String, _
  ByVal Nome As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Codigo
   Range("Cabecalho").Offset(contador + 1, 1).Value = Nome
End Sub

'============================================================================
' EVENTOS ADVERSOS
'============================================================================
Public Sub Rel_EventosAdversos( _
  ByVal contador As Integer, _
  ByVal Evento As String, _
  ByVal tipo As String, _
  ByVal Motivo As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Evento
   Range("Cabecalho").Offset(contador + 1, 1).Value = tipo
   Range("Cabecalho").Offset(contador + 1, 2).Value = Motivo
End Sub

'============================================================================
' RESULTADO PATOLOGIA
'============================================================================
Public Sub Rel_ResultadoLab( _
  ByVal Registro As String, _
  ByVal OS As String, _
  ByVal Paciente As String, _
  ByVal Material As String, _
  ByVal Data As Date, _
  ByVal Unidade As String, _
  ByVal Gram As String, _
  ByVal TemParcial As Boolean, _
  ByVal Comentario As String, _
  ByVal Qualidade As String, _
  ByVal Coleta As Date, _
  ByVal Entrega As Date, _
  ByVal Processamento As Date _
)
   
   Range("Registro").Value = Registro
   Range("OS").Value = OS
   Range("Paciente").Value = Paciente
   Range("Material").Value = Material
   Range("Data").Value = Data
   Range("Unidade").Value = Unidade
   
   'Gram...oculta ou mostra...
   If Trim(Gram) = "" Then
      Rows("10:16").Select
      Selection.EntireRow.Hidden = True
      Application.CutCopyMode = False
   Else
      ActiveSheet.Shapes("cxtGram").Select
      Selection.Characters.Text = Gram
   End If
   
   
   'Comentario...oculta ou mostra...
   If Trim(Comentario) = "" Then
      Rows("17:22").Select
      Selection.EntireRow.Hidden = True
      Application.CutCopyMode = False
   Else
      ActiveSheet.Shapes("cxtComentario").Select
      Selection.Characters.Text = Comentario
   End If
   
   'Qualidade...oculta ou mostra...
   If Trim(Qualidade) = "" Then
      Rows("23:24").Select
      Selection.EntireRow.Hidden = True
      Application.CutCopyMode = False
   Else
      If Qualidade = "A" Then
         Range("Adequado").Value = "Adequado"
      End If
      If Qualidade = "I" Then
         Range("Adequado").Value = "Inadequado"
      End If
   End If
   
   'Horarios...oculta ou mostra...
   If Coleta = 0 Then
      Rows("25:27").Select
      Selection.EntireRow.Hidden = True
      Application.CutCopyMode = False
   Else
      Range("DHColeta").Value = Coleta
      Range("DHEntrega").Value = Entrega
      Range("DHProcessamento").Value = Processamento
   End If
   
   'Posiciona la em cima...
   Range("Registro").Select
   'Atualiza e exibe...
   Application.ScreenUpdating = True
   Application.Visible = True
   Call Salva_Html
   
End Sub

'============================================================================
Public Sub Rel_ResultadoLabGermes( _
  ByVal Germe As String, _
  ByVal Antib As String, _
  ByVal Result As String _
)

   qColGerme = ""
   'Procura se o germe ja existe...
   If Range("Germe1").Value = Germe Then
     qColGerme = "E"
   End If
   If Range("Germe2").Value = Germe Then
     qColGerme = "F"
   End If
   If Range("Germe3").Value = Germe Then
     qColGerme = "G"
   End If
   If Range("Germe4").Value = Germe Then
     qColGerme = "H"
   End If
   If Range("Germe5").Value = Germe Then
     qColGerme = "I"
   End If
   
   'se nao existe procura uma vaga...
   If qColGerme = "" Then
      If Range("Germe1").Value = "" Then
         qColGerme = "E"
         Range("Germe1").Value = Germe
      ElseIf Range("Germe2").Value = "" Then
         qColGerme = "F"
         Range("Germe2").Value = Germe
      ElseIf Range("Germe3").Value = "" Then
         qColGerme = "G"
         Range("Germe3").Value = Germe
      ElseIf Range("Germe4").Value = "" Then
         qColGerme = "H"
         Range("Germe4").Value = Germe
      ElseIf Range("Germe5").Value = "" Then
         qColGerme = "I"
         Range("Germe5").Value = Germe
      End If
   End If
   
   qLinAntib = 0
   'Procura se o antib ja existe...
   For i = 29 To 58
      If Range("B" & Trim(Str(i))).Value = Antib Then
         qLinAntib = i
      End If
   Next
   
   'se nao existe procura uma vaga...
   If qLinAntib = 0 Then
      For i = 29 To 58
         If Range("B" & Trim(Str(i))).Value = "" Then
            qLinAntib = i
            Range("B" & Trim(Str(i))).Value = Antib
            i = 59
         End If
      Next
   End If
   
   'Insere o result...
   If qLinAntib <> 0 Then
     Range(qColGerme & Trim(Str(qLinAntib))).Value = Result
     If Result = "S" Then
        Range(qColGerme & Trim(Str(qLinAntib))).Font.ColorIndex = 5
     ElseIf Result = "R" Then
        Range(qColGerme & Trim(Str(qLinAntib))).Font.ColorIndex = 3
     ElseIf Result = "I" Then
        Range(qColGerme & Trim(Str(qLinAntib))).Font.ColorIndex = 4
     End If
   End If
   
      
End Sub

'============================================================================
Public Sub Rel_ResultadoLabFinal( _
  ByVal TemGerme As Boolean, _
  ByVal Copias As Integer _
)

   'Ve se tem germe...
   If Not TemGerme Then
     Rows("27:59").Select
     Selection.Delete Shift:=xlUp
     'Exibe o nao houve...
     Range("NaoHouve").Font.ColorIndex = vbBlack
     'Posiciona la em cima...
     Range("Registro").Select
     Exit Sub
   End If
   
   'Colapsa linhas de antib...
   i = 29
   Do While Range("B" & Trim(Str(i))).Value <> ""
      i = i + 1
   Loop
   qLinha = i
      
   'Apaga linhas de antib...
   Rows(Trim(Str(qLinha)) & ":59").Select
   Selection.Delete Shift:=xlUp
   
   'Apaga colunas de germes
   If Range("Germe5").Value = "" Then
      Range("I28:I58").Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   End If
   If Range("Germe4").Value = "" Then
      Range("H28:H58").Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   End If
   If Range("Germe3").Value = "" Then
      Range("G28:G58").Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   End If
   If Range("Germe2").Value = "" Then
      Range("F28:F58").Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   End If
   If Range("Germe1").Value = "" Then
      Range("E28:E58").Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   End If
   
   
   'Posiciona la em cima...
   Range("Registro").Select
   
   'Verifica se deve imprimir...
   If Copias > 0 Then
      ActiveWindow.SelectedSheets.PrintOut Copies:=Copias, Collate:=True
   End If
   
End Sub


Public Sub Rel_TipoApresentacao( _
  ByVal contador As Integer, _
  ByVal Numero As Integer, _
  ByVal Apresentacao As String, _
  ByVal Via As String, _
  ByVal Apelido As String _
)
   Range("Cabecalho").Offset(contador + 1, 0).Value = Numero
   Range("Cabecalho").Offset(contador + 1, 1).Value = Apresentacao
   Range("Cabecalho").Offset(contador + 1, 2).Value = Via
   Range("Cabecalho").Offset(contador + 1, 3).Value = Apelido
   
End Sub

Attribute VB_Name = "ModToolbox"

Sub RefCabecalho()
    'Stop
    ActiveSheet.Names.Add Name:="Cabecalho", RefersTo:="=$B$36"
    'ActiveSheet.Names.Add Name:="UmCabecalho", RefersTo:="=$C$7:$U$9"
    'ActiveSheet.Names.Add Name:="UmRegistro", RefersTo:="=$G$9:$I$9"
    'ActiveSheet.Names.Add Name:="nomeColuna", RefersTo:="=$C$14"
    'ActiveSheet.Names.Add Name:="oTotal", RefersTo:="=$B$37:$G$37"
End Sub

Function ConsisteString(ByVal pParam As String) As String
   'Transforma branco...
   If Trim(pParam) = "" Then
      pParam = "."
   End If
   'Retorna...
   ConsisteString = Trim(pParam)
End Function

Function validaParamString(ByVal pParam As String) As String
   'Transforma branco...
   If Trim(pParam) = "" Then
      pParam = ". ."
   End If
   'Transforma numero...
   If IsNumeric(pParam) Then
      pParam = "." & pParam & "."
   End If
   'Transforma L...
   If pParam = "L" Then
      pParam = "Limpa"
   End If
   'Transforma P...
   If pParam = "P" Then
      pParam = "Pot.Contaminada"
   End If
   'Transforma C...
   If pParam = "C" Then
      pParam = "Contaminada"
   End If
   'Transforma I...
   If pParam = "I" Then
      pParam = "Infectada"
   End If
   'Retorna...
   validaParamString = Trim(pParam)
End Function

Sub ApagaRange(ByRef qRange As Range)
    
    On Error Resume Next
    'Seleciona a celula mae da regiao
    qRange.CurrentRegion.Offset(rowOffset:=1, columnOffset:=0).Select
    
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.ClearContents

    
End Sub

Sub PoeGrid(ByRef qRange As Range)

    On Error Resume Next
    'Seleciona a celula mae da regiao
    qRange.CurrentRegion.Offset(rowOffset:=0, columnOffset:=0).Select

    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With

    'Seleciona a celula mae da regiao e poe branco...
'    qRange.CurrentRegion.Select
'    With Selection.Interior
'        .ColorIndex = 2
'        .Pattern = xlSolid
'        .PatternColorIndex = xlAutomatic
'    End With

    
End Sub

Sub TogleFormula()
Attribute TogleFormula.VB_ProcData.VB_Invoke_Func = "F\n14"
    Application.DisplayFormulaBar = Not Application.DisplayFormulaBar
End Sub

Sub TogleHeading()
Attribute TogleHeading.VB_ProcData.VB_Invoke_Func = "H\n14"
    ActiveWindow.DisplayHeadings = Not ActiveWindow.DisplayHeadings
End Sub

Sub FazVisible()
   Application.Visible = True
End Sub

Sub DisplayFull()
Attribute DisplayFull.VB_ProcData.VB_Invoke_Func = "F\n14"
    Application.DisplayFullScreen = Not Application.DisplayFullScreen
End Sub

Sub MostraAll()
  For Each plan In Worksheets
    plan.Visible = True
  Next
  
End Sub

Sub Filtra()
    On Error Resume Next
    Range("Cabecalho").Select
    Selection.AutoFilter
End Sub

Sub MostraImpressos()
    'Mostra as impressos da Jussara...
    Sheets("Denominador cir|fffd|rgico").Visible = True
    Sheets("Ficha de Busca Ativa").Visible = True
    Sheets("IH n|fffd|o cir|fffd|rgica").Visible = True
    Sheets("Antibi|fffd|tico").Visible = True
    Sheets("Antibiograma").Visible = True
    Sheets("Censo do Ber|fffd||fffd|rio").Visible = True
    Sheets("Ind. Epidemiologico CTI").Visible = True
    Sheets("Ind. Epidemiologico UTIP").Visible = True

    'Oculta a abertura
    Sheets("JANUS").Visible = False

    'Atualiza e exibe...
    Application.ScreenUpdating = True
    Application.Visible = True
End Sub


Sub Salva_Html()
    
    'On Error GoTo fim
    
    'Verifca se esta salvando em html...
    If (Not A_Pasta.G_Salva_Html) Then
       Exit Sub
    End If
       
    'Cria uma pasta nova....
    Set NewBook = Workbooks.Add
    
    'Copia a planilha para pasta nova...
    Windows("Janus.xls").Activate
    ActiveSheet.Select
    ActiveSheet.Copy Before:=Workbooks(2).Sheets(1)
    
    'Pega a hora agora
    Momento = Trim(Str(CLng((Now - 10000) * 10000)))
    ChDir "C:\Janus\Web"
    ActiveWorkbook.SaveAs Filename:="C:\Janus\Web\Pg_" & Momento & ".htm", FileFormat:=xlHtml, _
        ReadOnlyRecommended:=False, CreateBackup:=False

    ' Fecha o html criado e volta pra janus.xls
    ActiveWorkbook.Close
    
fim:
        
End Sub



Sub Salva_xls()
Attribute Salva_xls.VB_ProcData.VB_Invoke_Func = "J\n14"
    
    Set NewBook = Workbooks.Add
    Do
       fName = Application.GetSaveAsFilename
    Loop Until fName <> False
    
    Windows("Janus.xls").Activate
    ActiveSheet.Select
    ActiveSheet.Copy Before:=Workbooks(2).Sheets(1)
    
    'Pega a hora agora
    ActiveWorkbook.SaveAs Filename:=fName & "xls", FileFormat:=xlNormal, _
        Password:="", WriteResPassword:="", ReadOnlyRecommended:=False, _
        CreateBackup:=False
    ActiveWorkbook.Close
End Sub




Function totaliza(colunaTot As String, colunaCriterio As String, criterio As String, plaNome As String, plaOrigem As String, linhaOrigem As String) As Boolean
    'para passar nos registros
    Dim i As Integer
    'para armazenar os valores e calcular a mediana
    Dim resultado, media, dp, dpAux, mediana As Double
    'para contar em casos como m|fffd|dia, e medianaAux para contar da segunda vez e comparar com cont/2
    Dim cont, medianaAux As Integer
    
    On Error Resume Next
    
    'inicializa variaveis
    medianaAux = 0
    cont = 0
    resultado = 0
    dp = 0
    
    'primeira linha com dados |fffd| a linha 7
    i = 7
    'Passa por todos os registros na planilha D2, somando e fazendo a m|fffd|dia
    Do While (Sheets(plaNome).Range("B" & i) <> "")
        If (Sheets(plaNome).Range(colunaCriterio & i) = criterio) And Sheets(plaNome).Range(colunaTot & i) <> "" And (Not Sheets(plaNome).Range(colunaTot & i).EntireRow.Hidden) Then
            resultado = resultado + Sheets(plaNome).Range(colunaTot & i)
            cont = cont + 1
        End If
        i = i + 1
    Loop

    If cont <> 0 Then
        media = (resultado / cont)
    Else
        media = 0
    End If

    If media <> 0 Then
        i = 7
        'outro loop para calculo do desvio padr|fffd|o
        Do While (Sheets(plaNome).Range("B" & i) <> "")
            If (Sheets(plaNome).Range(colunaCriterio & i) = criterio) And Sheets(plaNome).Range(colunaTot & i) <> "" Then
                dpAux = Sheets(plaNome).Range(colunaTot & i) - media
                dp = dp + (dpAux * dpAux)
                medianaAux = medianaAux + 1
                'Se estiver no meio joga o valor para mediana
                If (CInt((cont + 1) / 2) = medianaAux) Then
                    mediana = Sheets(plaNome).Range(colunaTot & i)
                End If
            End If
            i = i + 1
        Loop
        dp = Sqr(dp / (cont - 1))
    End If
    
    'Joga os valores nas respectivas colunas ***ATENTAR PARA AS COLUNAS MNO***
    Sheets(plaOrigem).Range("M" & linhaOrigem) = CDbl(FormatNumber(media, 2))
    Sheets(plaOrigem).Range("N" & linhaOrigem) = CDbl(FormatNumber(mediana, 2))
    Sheets(plaOrigem).Range("O" & linhaOrigem) = CDbl(FormatNumber(dp, 2))
End Function

Function totalizaAntigo(colunaTot As String, colunaCriterio As String, criterio As String, operacao As String, plaNome As String) As Double
    'para passar nos registros
    Dim i As Integer
    'para armazenar os valores e calcular a mediana
    Dim resultado, media, dp, dpAux, mediana As Double
    'para contar em casos como m|fffd|dia, e medianaAux para contar da segunda vez e comparar com cont/2
    Dim cont, medianaAux As Integer
    
    On Error GoTo erro
    
    'inicializa variaveis
    medianaAux = 0
    cont = 0
    resultado = 0
    dp = 0
    
    'primeira linha com dados |fffd| a linha 7
    i = 7
    'Passa por todos os registros na planilha D2, somando e fazendo a m|fffd|dia
    Do While (Sheets(plaNome).Range("B" & i) <> "")
        If (Sheets(plaNome).Range(colunaCriterio & i) = criterio) And Sheets(plaNome).Range(colunaTot & i) <> "" Then
            resultado = resultado + Sheets(plaNome).Range(colunaTot & i)
            cont = cont + 1
        End If
        i = i + 1
    Loop

    If cont <> 0 Then
        media = (resultado / cont)
    Else
        media = 0
    End If

    If (operacao = "DP" Or operacao = "Mediana") And media <> 0 Then
        i = 7
        'outro loop para calculo do desvio padr|fffd|o
        Do While (Sheets(plaNome).Range("B" & i) <> "")
            If (Sheets(plaNome).Range(colunaCriterio & i) = criterio) And Sheets(plaNome).Range(colunaTot & i) <> "" Then
                dpAux = Sheets(plaNome).Range(colunaTot & i) - media
                dp = dp + (dpAux * dpAux)
                medianaAux = medianaAux + 1
                'Se estiver no meio joga o valor para mediana
                If (CInt((cont + 1) / 2) = medianaAux) Then
                    mediana = Sheets(plaNome).Range(colunaTot & i)
                End If
            End If
            i = i + 1
        Loop
        dp = Sqr(dp / (cont - 1))
    End If

    If cont <> 0 Then
        media = (resultado / cont)
    Else
        media = 0
    End If
    
    'retorna a m|fffd|dia
    If operacao = "Media" Then
        totalizaAntigo = media
    Else
        If operacao = "DP" Then
            totalizaAntigo = dp
        Else
            If operacao = "Soma" Then
                totalizaAntigo = resultado
            Else
                If operacao = "Mediana" Then
                    totalizaAntigo = mediana
                Else
                    totalizaAntigo = 0
                End If
            End If
        End If
    End If
Exit Function
erro:
    totalizaAntigo = 0
End Function

Attribute VB_Name = "MudaGrafico"

'Planilha, nome do grafico e celula origem do listbox
Public Sub mudaTipoDeGrafico(planilha As String, grafico As String, tipo As Integer)
    Dim codTipo As Integer

    'pega o c|fffd|digo da escolha no listbox
    'codTipo = Worksheets(Planilha).Range(celula)
    codTipo = tipo
    
    'seleciona o gr|fffd|fico e o torna ativo
    ActiveSheet.Shapes(grafico).Select
    ActiveSheet.ChartObjects(grafico).Activate
    
    'muda o gr|fffd|fico de acordo com o tipo escolhido
    Select Case (codTipo)
        Case 1
            ActiveChart.ChartType = xl3DColumnClustered
        Case 2
            ActiveChart.ChartType = xl3DBarClustered
        Case 3
            ActiveChart.ChartType = xlLineMarkers
        Case 4
            ActiveChart.ChartType = xlPie
        Case 5
            ActiveChart.ChartType = xlAreaStacked
    End Select
    Range("A1").Select
End Sub

'------------------------Planilha G2D4 Grafico
Public Sub mudaTipoDeGraficoG2D4C()
    Call mudaTipoDeGrafico(PlanD4G1.Name, "Grafico", 1)
End Sub
Public Sub mudaTipoDeGraficoG2D4B()
    Call mudaTipoDeGrafico(PlanD4G1.Name, "Grafico", 2)
End Sub
Public Sub mudaTipoDeGraficoG2D4L()
    Call mudaTipoDeGrafico(PlanD4G1.Name, "Grafico", 3)
End Sub
Public Sub mudaTipoDeGraficoG2D4P()
    Call mudaTipoDeGrafico(PlanD4G1.Name, "Grafico", 4)
End Sub
'------------------------Planilha G2D4 Grafico

'------------------------Planilha G11 Gr|fffd|fico 1
Public Sub mudaTipoDeGraficoG11C()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 1", 1)
End Sub
Public Sub mudaTipoDeGraficoG11B()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 1", 2)
End Sub
Public Sub mudaTipoDeGraficoG11L()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 1", 3)
End Sub
Public Sub mudaTipoDeGraficoG11P()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 1", 4)
End Sub
'------------------------Planilha G11 Gr|fffd|fico 1

'------------------------Planilha G11 Gr|fffd|fico 2
Public Sub mudaTipoDeGraficoG112C()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 2", 1)
End Sub

Public Sub mudaTipoDeGraficoG112B()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 2", 2)
End Sub

Public Sub mudaTipoDeGraficoG112L()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 2", 3)
End Sub

Public Sub mudaTipoDeGraficoG112P()
    Call mudaTipoDeGrafico(PlanG11.Name, "Gr|fffd|fico 2", 4)
End Sub
'------------------------Planilha G11 Gr|fffd|fico 2

'------------------------Planilha G12 Gr|fffd|fico 1
Public Sub mudaTipoDeGraficoG12C()
    Call mudaTipoDeGrafico(PlanG12.Name, "Gr|fffd|fico 1", 1)
End Sub

Public Sub mudaTipoDeGraficoG12B()
    Call mudaTipoDeGrafico(PlanG12.Name, "Gr|fffd|fico 1", 2)
End Sub

Public Sub mudaTipoDeGraficoG12L()
    Call mudaTipoDeGrafico(PlanG12.Name, "Gr|fffd|fico 1", 3)
End Sub

Public Sub mudaTipoDeGraficoG12P()
    Call mudaTipoDeGrafico(PlanG12.Name, "Gr|fffd|fico 1", 4)
End Sub
'------------------------Planilha G12 Gr|fffd|fico 1
Attribute VB_Name = "M|fffd|dulo1"
Attribute VB_Name = "M|fffd|dulo2"
Sub Macro1()
Attribute Macro1.VB_Description = "Macro gravada em 27/01/2006 por leandrogarcia"
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
' Macro gravada em 27/01/2006 por leandrogarcia
'

'
End Sub
Attribute VB_Name = "PlanD1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD1Pac"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub ordenaPorQuantidade()
   Range("B6:P65000").Sort Key1:=Range("O6"), Order1:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub
Attribute VB_Name = "PlanD2G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD2.Name, PlanD2G1.Name, "F")
   AtualizandoGrafico = False
End Sub

'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD2G2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGrafCirurgia(PlanD2, PlanD2G2, "N", "C")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub




Attribute VB_Name = "PlanD2G3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGrafCirurgia(PlanD2, PlanD2G3, "K", "C")
   AtualizandoGrafico = False
End Sub

'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub


Attribute VB_Name = "PlanD2G4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean


Sub Click_Grafico()
   Dim indice As Integer    'indice para passar por todos registros e calcular m|fffd|dia, mediana e desvio padr|fffd|o

   AtualizandoGrafico = True
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = PlanD2.Range("Cabecalho").Row + 1
   linfim = PlanD2.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = 1
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...e nao vazias...
   For lin = LinIni To linfim
      If (Not PlanD2.Rows(lin & ":" & lin).EntireRow.Hidden) And _
         (Trim(PlanD2.Range("F" & lin).Value) <> "") Then
          'Poe o nome do proc. cirurgico...e zera outros campos...
          Range("Cabecalho").Offset(qLin, 1).Value = PlanD2.Range("F" & lin).Value
          Range("Cabecalho").Offset(qLin, 2).Value = 0
          Range("Cabecalho").Offset(qLin, 3).Value = 0
          Range("Cabecalho").Offset(qLin, 4).Value = 0
          Range("Cabecalho").Offset(qLin, 5).Value = 0
          Range("Cabecalho").Offset(qLin, 6).Value = 0
          Range("Cabecalho").Offset(qLin, 7).Value = 0
          Range("Cabecalho").Offset(qLin, 8).Value = 0
          Range("Cabecalho").Offset(qLin, 9).Value = 0
          'Poe a faixa TPHos...
          qCol = 0
          If PlanD2.Range("P" & lin).Value = "<= 1" Then
            qCol = 1
          ElseIf PlanD2.Range("P" & lin).Value = "2 a 3" Then
            qCol = 2
          ElseIf PlanD2.Range("P" & lin).Value = "4 a 5" Then
            qCol = 3
          ElseIf PlanD2.Range("P" & lin).Value = "6 a 7" Then
            qCol = 4
          ElseIf PlanD2.Range("P" & lin).Value = "8 a 10" Then
            qCol = 5
          ElseIf PlanD2.Range("P" & lin).Value = "11 a 20" Then
            qCol = 6
          ElseIf PlanD2.Range("P" & lin).Value = "21 a 30" Then
            qCol = 7
          ElseIf PlanD2.Range("P" & lin).Value = ">= 30" Then
            qCol = 8
         End If
          
         'Poe na tabela...
         If qCol > 0 Then
           Range("Cabecalho").Offset(qLin, qCol + 1).Value = 1
         End If
         qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica...
       Range("Cabecalho").Select
       Selection.Sort Key1:=Range("C37"), Order1:=xlAscending, Header:=xlGuess, _
       OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
       orderna = False
        
  'Colapsa contando...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   Range("B" & LinIni).Value = 1
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   
   For lin = LinIni To (linfim + 1)
      'Pega o proximo nome...
      qNomeProximo = Range("C" & lin).Value
      ' Se for igual ao de cima inc emcima e deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         Range("D" & LinAnt).Value = Range("D" & LinAnt).Value + Range("D" & lin).Value
         Range("E" & LinAnt).Value = Range("E" & LinAnt).Value + Range("E" & lin).Value
         Range("F" & LinAnt).Value = Range("F" & LinAnt).Value + Range("F" & lin).Value
         Range("G" & LinAnt).Value = Range("G" & LinAnt).Value + Range("G" & lin).Value
         Range("H" & LinAnt).Value = Range("H" & LinAnt).Value + Range("H" & lin).Value
         Range("I" & LinAnt).Value = Range("I" & LinAnt).Value + Range("I" & lin).Value
         Range("J" & LinAnt).Value = Range("J" & LinAnt).Value + Range("J" & lin).Value
         Range("K" & LinAnt).Value = Range("K" & LinAnt).Value + Range("K" & lin).Value
         Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         'Poe a soma em cima...
         Range("L" & LinAnt).FormulaR1C1 = "=SUM(RC[-8]:RC[-1])"
         'Avanca...
         qNome = qNomeProximo
         'Testa o fim...
         If qNome <> "" Then
            Range("B" & lin).Value = 1
            LinAnt = lin
         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim + 1
      End If
   Next lin
   
   'Ordena por Qtd...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("L37"), _
      Order1:=xlDescending, _
      Header:=xlGuess, _
      OrderCustom:=1, _
      MatchCase:=False, _
      Orientation:=xlTopToBottom
   
   'Aponta para o inicio e fim da legenda...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qLin = 1
   'Iterage na tabela pondo ordinal...
   For lin = LinIni To linfim
      Range("B" & lin).Value = qLin & "|fffd|"
      qLin = qLin + 1
   Next lin
   
   'Chama o frame...
   Call PoeGrid(Range("Cabecalho"))
   
   'Poe a soma...
   Range("C" & linfim + 1).Value = "Total"
   Range("D" & linfim + 1).Formula = "=Sum(D37:D" & linfim & ")"
   Range("E" & linfim + 1).Formula = "=Sum(E37:E" & linfim & ")"
   Range("F" & linfim + 1).Formula = "=Sum(F37:F" & linfim & ")"
   Range("G" & linfim + 1).Formula = "=Sum(G37:G" & linfim & ")"
   Range("H" & linfim + 1).Formula = "=Sum(H37:H" & linfim & ")"
   Range("I" & linfim + 1).Formula = "=Sum(I37:I" & linfim & ")"
   Range("J" & linfim + 1).Formula = "=Sum(J37:J" & linfim & ")"
   Range("K" & linfim + 1).Formula = "=Sum(K37:K" & linfim & ")"
   Range("L" & linfim + 1).Formula = "=Sum(L37:L" & linfim & ")"
   
   'Coloca formulas para c|fffd|lcular m|fffd|dia mediana e Desvio padr|fffd|o, partindo da linha 37 - Primeira linha
   'Atualiza Grafico...
   ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("B37:B" & linfim & _
                                            ",L37:L" & linfim), PlotBy:=xlColumns
        
   'Atualiza Pizza...
   ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("B37:B" & linfim & _
                                            ",L37:L" & linfim), PlotBy:=xlColumns
   
   
   'Seleciona o Exb...
   Range("E36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True
   
   AtualizandoGrafico = False
   
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
     
   'On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   'Se estiver fora da coluna de rank sai fora...
   If (Target.Column <> Range("Cabecalho").Offset(0, 1).Column) Or _
      (Target.Row < Range("Cabecalho").Row) Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Como e valida, pega a linha...
   qLin = Target.Row
      
   'Atualiza Grafico...
   ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C36:C" & qLin & ", K36:K" & qLin)
   'ActiveChart.SetSourceData Source:=Range("C36:C36," & "C" & qLin & ":K" & qLin), _
                                                             PlotBy:=xlLines
        
   'Atualiza Pizza...
   ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C36:C" & qLin & ", K36:K" & qLin)
   'ActiveChart.SetSourceData Source:=Range("C36:K36," & "C" & qLin & ":K" & qLin), _
                                                             PlotBy:=xlLines

   
   Exit Sub
    

End Sub





Attribute VB_Name = "PlanD2G5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub Click_Grafico()
   
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   'Limpa os dados...
   Range("$D$37:$D$38").Value = 0
    
    PlanD2.Select
    
    'Filtra...
    PlanD2.Range("F6").Select
    Selection.AutoFilter Field:=5, Criteria1:="PARTO VAGINAL (NORMAL)"
    Normal = PlanD2.Range("D2").Value
    
    'Filtra...
    PlanD2.Range("F6").Select
    Selection.AutoFilter Field:=5, Criteria1:="CESARIANA"
    Cesarea = PlanD2.Range("D2").Value
    
    'Tira Filtro
    PlanD2.Range("B6").Select
    Selection.AutoFilter

    PlanD2G5.Select
    'Poe na tabela...
    Range("D37").Value = Cesarea
    Range("D38").Value = Normal
   
    'Ganha velocidade...
   Application.ScreenUpdating = True
   
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   'On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   'Se estiver fora da coluna de rank sai fora...
   If (Target.Column <> Range("Cabecalho").Offset(0, 1).Column) Or _
      (Target.Row < Range("Cabecalho").Row) Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
End Sub
Attribute VB_Name = "PlanD2G6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean
Dim ordemCrescente As Boolean


Sub Click_Grafico()
   Dim indice As Integer    'indice para passar por todos registros e calcular m|fffd|dia, mediana e desvio padr|fffd|o

   AtualizandoGrafico = True
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = PlanD2.Range("Cabecalho").Row + 1
   linfim = PlanD2.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = 1
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...e nao vazias...
   For lin = LinIni To linfim
      If (Not PlanD2.Rows(lin & ":" & lin).EntireRow.Hidden) And _
         (Trim(PlanD2.Range("F" & lin).Value) <> "") Then
          'Poe o nome do proc. cirurgico...e zera outros campos...
          Range("Cabecalho").Offset(qLin, 1).Value = PlanD2.Range("F" & lin).Value
          qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica...
       Range("Cabecalho").Select
       Selection.Sort Key1:=Range("C37"), Order1:=xlAscending, Header:=xlGuess, _
       OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
       orderna = False
        
  'Colapsa contando...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   Range("B" & LinIni).Value = 1
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   For lin = LinIni To linfim
      'Pega o proximo nome...
      qNomeProximo = Range("C" & lin).Value
      ' Se for igual ao de cima inc emcima e deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         'Avanca...
         qNome = qNomeProximo
         'Testa o fim...
         If qNome <> "" Then
            Range("B" & lin).Value = 1
            LinAnt = lin
         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim
      End If
   Next lin

 'Chama o frame...
   Call PoeGrid(Range("Cabecalho"))
   
 
    'Para utilizar crit|fffd|rio
    Range("V27").Value = "Procedimento"

   'Coloca formulas para c|fffd|lcular m|fffd|dia mediana e Desvio padr|fffd|o, partindo da linha 37 - Primeira linha
   indice = 37
   Do While Range("C" & indice) <> "Total" And Range("C" & indice) <> ""
        'Celulas Auxiliares: U27->Calc  V27,V28->Crit|fffd|rio
        'Para utilizar crit|fffd|rio
        Range("V28").Value = Range("C" & indice).Value

        'Total
        Range("U27").Formula = "=DCOUNT(" & PlanD2.Name & "!R6C2:R65000C17,16,R27C22:R28C23)"
        Range("D" & indice).Value = Range("U27").Value

        'se a soma for 0 ent|fffd|o n|fffd|o calcula a m|fffd|dia e mediana
        If Range("U27").Value <> 0 Then
            'M|fffd|dia
            Range("U27").Formula = "=DAVERAGE(" & PlanD2.Name & "!R6C2:R65000C17,16,R27C22:R28C23)"
            Range("E" & indice).Value = Range("U27").Value
    
            'Desvio Padr|fffd|o
            Range("U27").Formula = "=DSTDEVP(" & PlanD2.Name & "!R6C2:R65000C17,16,R27C22:R28C23)"
            Range("F" & indice).Value = Range("U27").Value
        Else
            'M|fffd|dia
            Range("E" & indice).Value = 0
    
            'Desvio Padr|fffd|o
            Range("F" & indice).Value = 0
        End If

        'Proxima Linha
        indice = indice + 1
   Loop
   'Limpa c|fffd|lulas auxiliares U27->Calc  V27,V28->Crit|fffd|rio
   Sheets(PlanD2G6.Name).Range("U27").Clear
   Sheets(PlanD2G6.Name).Range("V27").Clear
   Sheets(PlanD2G6.Name).Range("V28").Clear
   

   'Ordena por m|fffd|dia decrescente
   Range("B36:F998").Sort Key1:=Range("E36"), Order1:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom

   'Refaz Numera|fffd||fffd|o de ranking
   indice = 37
   Do While Range("C" & indice) <> "Total" And Range("C" & indice) <> ""
        Range("B" & indice) = (indice - 36) & "|fffd|"
        indice = indice + 1
   Loop

   'Atualiza dados de origem do gr|fffd|fico
   ActiveSheet.ChartObjects("Gr|fffd|fico 18").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Sheets(PlanD2G6.Name).Range("B36:B" & (indice - 1) & ",E36:E" & (indice - 1)), PlotBy:=xlColumns

   'Seleciona o Exb...
   Range("B36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True

   AtualizandoGrafico = False
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim linha As Integer
    linha = Target.Row

    If AtualizandoGrafico Then
        Exit Sub
    End If

    'se posicionar em algum lugar no cabe|fffd|alho ordena...
    If Target.Row = 36 And (Target.Column >= 2 And Target.Column <= 6) Then
           If ordemCrescente Then
                Range("B36:F998").Sort Key1:=Target, Order1:=xlAscending, Header:= _
                    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
           Else
                Range("B36:F998").Sort Key1:=Target, Order1:=xlDescending, Header:= _
                    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
           End If
           Range("A1").Select
           ordemCrescente = Not ordemCrescente
    End If

    'se selecionar alguma coisa abaixo do cabe|fffd|alho, apaga todas as linha da sele|fffd||fffd|o pra baixo...
    If Target.Row > 36 And (Target.Column >= 2 And Target.Column <= 6) Then
         Application.ScreenUpdating = False
         AtualizandoGrafico = True
         Do While Sheets(PlanD2G6.Name).Range("C" & linha) <> ""
            Rows(linha & ":" & CStr(linha)).Select
            Selection.Delete Shift:=xlUp
         Loop
         AtualizandoGrafico = False
         Application.ScreenUpdating = True
         Range("A1").Select
    End If
End Sub


Attribute VB_Name = "PlanD2G7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGrafCirurgia(PlanD2, PlanD2G7, "J", "C")
   AtualizandoGrafico = False
End Sub

'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub


Attribute VB_Name = "PlanD2Quad"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD2TD"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD3G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD3.Name, PlanD3G1.Name, "E")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD3G2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD3.Name, PlanD3G2.Name, "F")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD4G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public AtualizandoGrafico As Boolean

Sub Click_Grafico()
    AtualizandoGrafico = True
    Call AtualizaDescGraf(PlanD4.Name, PlanD4G1.Name, "J")
    AtualizandoGrafico = False
End Sub




Private Sub Label1_Click()

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
   
   
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If



End Sub

Attribute VB_Name = "PlanD4G2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public AtualizandoGrafico As Boolean

Sub Click_Grafico()
    AtualizandoGrafico = True
    Call AtualizaDescGraf(PlanD4.Name, PlanD4G2.Name, "E")
    AtualizandoGrafico = False
End Sub




Private Sub Label1_Click()

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
   
   
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If



End Sub

Attribute VB_Name = "PlanD4G3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public AtualizandoGrafico As Boolean

Sub Click_Grafico()
    AtualizandoGrafico = True
    Call AtualizaDescGraf(PlanD4.Name, PlanD4G3.Name, "L")
    AtualizandoGrafico = False
End Sub




Private Sub Label1_Click()

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
   
   
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If



End Sub

Attribute VB_Name = "PlanD4G4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public AtualizandoGrafico As Boolean

Sub Click_Grafico()
    AtualizandoGrafico = True
    Call AtualizaDescGraf(PlanD4.Name, PlanD4G4.Name, "K")
    AtualizandoGrafico = False
End Sub




Private Sub Label1_Click()

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
   
   
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If



End Sub

Attribute VB_Name = "PlanD5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD5G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD5.Name, PlanD5G1.Name, "I")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD5G2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD5.Name, PlanD5G2.Name, "G")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD5G3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD5.Name, PlanD5G3.Name, "F")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD5G4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD5.Name, PlanD5G4.Name, "J")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD5G5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD5.Name, PlanD5G5.Name, "K")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD5G6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD5.Name, PlanD5G6.Name, "H")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD6G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub Click_Grafico()
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   'Limpa os dados...
   Range("$C$37:$D$43").Value = 0
   
   'Aponta para o inicio e fim da Desc...
   LinIni = PlanD6.Range("Cabecalho").Row + 1
   linfim = PlanD6.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   
   'Iterage na tabela Desc fazendo a contagem...
   For lin = LinIni To linfim
      If (Not PlanD6.Rows(lin & ":" & lin).EntireRow.Hidden) Then
         ' Faixas...
         If PlanD6.Range("M" & lin).Value = "< 15" Then
            qLin = 1
         ElseIf PlanD6.Range("M" & lin).Value = "15 a 29" Then
            qLin = 2
         ElseIf PlanD6.Range("M" & lin).Value = "30 a 44" Then
            qLin = 3
         ElseIf PlanD6.Range("M" & lin).Value = "45 a 59" Then
            qLin = 4
         ElseIf PlanD6.Range("M" & lin).Value = "60 a 74" Then
            qLin = 5
         ElseIf PlanD6.Range("M" & lin).Value = "75 a 84" Then
            qLin = 6
         ElseIf PlanD6.Range("M" & lin).Value = ">= 85" Then
            qLin = 7
         End If
         
         'Sexo...
         If PlanD6.Range("K" & lin).Value = "M" Then
            qCol = 1
         Else
            qCol = 2
         End If
          
         'Poe na tabela...
         Range("Cabecalho").Offset(qLin, qCol).Value = Range("Cabecalho").Offset(qLin, qCol).Value + 1
      End If
   Next lin
   
   'Seleciona o Exb...
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True
   
End Sub



Attribute VB_Name = "PlanD6G10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD6.Name, PlanD6G10.Name, "G")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub
Attribute VB_Name = "PlanD6G2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD6.Name, PlanD6G2.Name, "I")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub
Attribute VB_Name = "PlanD6G3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD6.Name, PlanD6G3.Name, "P")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
   
   
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub


Attribute VB_Name = "PlanD6G4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD6.Name, PlanD6G4.Name, "H")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
      'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
   
   
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub





Attribute VB_Name = "PlanD6G5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   
   AtualizandoGrafico = True
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = PlanD6.Range("Cabecalho").Row + 1
   linfim = PlanD6.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = 1
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...e nao vazias...
   For lin = LinIni To linfim
      If (Not PlanD6.Rows(lin & ":" & lin).EntireRow.Hidden) And _
         (Trim(PlanD6.Range("I" & lin).Value) <> "") Then
          'Poe o nome da especialidade...e zera outros campos...
          Range("Cabecalho").Offset(qLin, 1).Value = PlanD6.Range("I" & lin).Value
          Range("Cabecalho").Offset(qLin, 2).Value = 0
          Range("Cabecalho").Offset(qLin, 3).Value = 0
          Range("Cabecalho").Offset(qLin, 4).Value = 0
          Range("Cabecalho").Offset(qLin, 5).Value = 0
          Range("Cabecalho").Offset(qLin, 6).Value = 0
          Range("Cabecalho").Offset(qLin, 7).Value = 0
          Range("Cabecalho").Offset(qLin, 8).Value = 0
          Range("Cabecalho").Offset(qLin, 9).Value = 0
          'Poe a faixa TPHos...
          qCol = 0
          If PlanD6.Range("O" & lin).Value = "<= 1" Then
            qCol = 1
          ElseIf PlanD6.Range("O" & lin).Value = "2 a 3" Then
            qCol = 2
          ElseIf PlanD6.Range("O" & lin).Value = "4 a 5" Then
            qCol = 3
          ElseIf PlanD6.Range("O" & lin).Value = "6 a 7" Then
            qCol = 4
          ElseIf PlanD6.Range("O" & lin).Value = "8 a 10" Then
            qCol = 5
          ElseIf PlanD6.Range("O" & lin).Value = "11 a 20" Then
            qCol = 6
          ElseIf PlanD6.Range("O" & lin).Value = "21 a 30" Then
            qCol = 7
          ElseIf PlanD6.Range("O" & lin).Value = ">= 30" Then
            qCol = 8
         End If
          
         'Poe na tabela...
         If qCol > 0 Then
           Range("Cabecalho").Offset(qLin, qCol + 1).Value = 1
         End If
         qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("C37"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'  Stop
  'Colapsa contando...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   Range("B" & LinIni).Value = 1
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   For lin = LinIni To linfim
      'Pega o proximo nome...
      qNomeProximo = Range("C" & lin).Value
      ' Se for igual ao de cima inc emcima e deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         Range("D" & LinAnt).Value = Range("D" & LinAnt).Value + Range("D" & lin).Value
         Range("E" & LinAnt).Value = Range("E" & LinAnt).Value + Range("E" & lin).Value
         Range("F" & LinAnt).Value = Range("F" & LinAnt).Value + Range("F" & lin).Value
         Range("G" & LinAnt).Value = Range("G" & LinAnt).Value + Range("G" & lin).Value
         Range("H" & LinAnt).Value = Range("H" & LinAnt).Value + Range("H" & lin).Value
         Range("I" & LinAnt).Value = Range("I" & LinAnt).Value + Range("I" & lin).Value
         Range("J" & LinAnt).Value = Range("J" & LinAnt).Value + Range("J" & lin).Value
         Range("K" & LinAnt).Value = Range("K" & LinAnt).Value + Range("K" & lin).Value
         Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         'Poe a soma em cima...
         Range("L" & LinAnt).FormulaR1C1 = "=SUM(RC[-8]:RC[-1])"
         'Avanca...
         qNome = qNomeProximo
         'Testa o fim...
         If qNome <> "" Then
            Range("B" & lin).Value = 1
            LinAnt = lin
         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim
      End If
   Next lin
   
   'Ordena por Qtd...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("D37"), _
      Order1:=xlDescending, _
      Header:=xlGuess, _
      OrderCustom:=1, _
      MatchCase:=False, _
      Orientation:=xlTopToBottom
   
   'Aponta para o inicio e fim da legenda...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qLin = 1
   'Iterage na tabela pondo ordinal...
   For lin = LinIni To linfim
      Range("B" & lin).Value = qLin & "|fffd|"
      qLin = qLin + 1
   Next lin
   
   'Chama o frame...
   Call PoeGrid(Range("Cabecalho"))
   
   'Poe a soma...
   Range("C" & linfim + 1).Value = "Total"
   Range("D" & linfim + 1).Formula = "=Sum(D37:D" & linfim & ")"
   Range("E" & linfim + 1).Formula = "=Sum(E37:E" & linfim & ")"
   Range("F" & linfim + 1).Formula = "=Sum(F37:F" & linfim & ")"
   Range("G" & linfim + 1).Formula = "=Sum(G37:G" & linfim & ")"
   Range("H" & linfim + 1).Formula = "=Sum(H37:H" & linfim & ")"
   Range("I" & linfim + 1).Formula = "=Sum(I37:I" & linfim & ")"
   Range("J" & linfim + 1).Formula = "=Sum(J37:J" & linfim & ")"
   Range("K" & linfim + 1).Formula = "=Sum(K37:K" & linfim & ")"
   Range("L" & linfim + 1).Formula = "=Sum(L37:L" & linfim & ")"

   'Atualiza Grafico...
   ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("B37:B" & linfim & _
                                            ",L37:L" & linfim), PlotBy:=xlColumns

   'Atualiza Pizza...
   ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C37:C" & linfim & _
                                            ",L37:L" & linfim), PlotBy:=xlColumns

   'Seleciona o Exb...
   Range("E36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True

   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
     
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   'Se estiver fora da coluna de rank sai fora...
   If (Target.Column <> Range("Cabecalho").Offset(0, 1).Column) Or _
      (Target.Row < Range("Cabecalho").Row) Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Como e valida, pega a linha...
   qLin = Target.Row
      
   'Atualiza Grafico...
   ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C36:K36," & "C" & qLin & ":K" & qLin), _
                                                             PlotBy:=xlRows
        
   'Atualiza Pizza...
   ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C36:K36," & "C" & qLin & ":K" & qLin), _
                                                             PlotBy:=xlRows
   
   
   Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD6G6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   
   AtualizandoGrafico = True
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = PlanD6.Range("Cabecalho").Row + 1
   linfim = PlanD6.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = 1
   
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...e nao vazias...
   For lin = LinIni To linfim
      'Coluna D de CONVENIO...
      If (Not PlanD6.Rows(lin & ":" & lin).EntireRow.Hidden) And _
         (Trim(PlanD6.Range("D" & lin).Value) <> "") Then
          'Poe o nome do CONVENIO...e zera outros campos...
          Range("Cabecalho").Offset(qLin, 1).Value = PlanD6.Range("D" & lin).Value
          Range("Cabecalho").Offset(qLin, 2).Value = 0
          Range("Cabecalho").Offset(qLin, 3).Value = 0
          Range("Cabecalho").Offset(qLin, 4).Value = 0
          Range("Cabecalho").Offset(qLin, 5).Value = 0
          Range("Cabecalho").Offset(qLin, 6).Value = 0
          Range("Cabecalho").Offset(qLin, 7).Value = 0
          Range("Cabecalho").Offset(qLin, 8).Value = 0
          'Poe a faixa ETARIA...
          qCol = 0
          If PlanD6.Range("M" & lin).Value = "< 15" Then
            qCol = 1
          ElseIf PlanD6.Range("M" & lin).Value = "15 a 29" Then
            qCol = 2
          ElseIf PlanD6.Range("M" & lin).Value = "30 a 44" Then
            qCol = 3
          ElseIf PlanD6.Range("M" & lin).Value = "45 a 59" Then
            qCol = 4
          ElseIf PlanD6.Range("M" & lin).Value = "60 a 74" Then
            qCol = 5
          ElseIf PlanD6.Range("M" & lin).Value = "75 a 84" Then
            qCol = 6
          ElseIf PlanD6.Range("M" & lin).Value = ">= 85" Then
            qCol = 7
         End If
          
         'Poe na tabela...
         If qCol > 0 Then
           Range("Cabecalho").Offset(qLin, qCol + 1).Value = 1
         End If
         qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("C37"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'  Stop
  'Colapsa contando...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   Range("B" & LinIni).Value = 1
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   For lin = LinIni To linfim
      'Pega o proximo nome...
      qNomeProximo = Range("C" & lin).Value
      ' Se for igual ao de cima inc emcima e deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         Range("D" & LinAnt).Value = Range("D" & LinAnt).Value + Range("D" & lin).Value
         Range("E" & LinAnt).Value = Range("E" & LinAnt).Value + Range("E" & lin).Value
         Range("F" & LinAnt).Value = Range("F" & LinAnt).Value + Range("F" & lin).Value
         Range("G" & LinAnt).Value = Range("G" & LinAnt).Value + Range("G" & lin).Value
         Range("H" & LinAnt).Value = Range("H" & LinAnt).Value + Range("H" & lin).Value
         Range("I" & LinAnt).Value = Range("I" & LinAnt).Value + Range("I" & lin).Value
         Range("J" & LinAnt).Value = Range("J" & LinAnt).Value + Range("J" & lin).Value
         Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         'Poe a soma em cima...
         Range("k" & LinAnt).FormulaR1C1 = "=SUM(RC[-8]:RC[-1])"
         'Avanca...
         qNome = qNomeProximo
         'Testa o fim...
         If qNome <> "" Then
            Range("B" & lin).Value = 1
            LinAnt = lin
         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim
      End If
   Next lin
   
   'Ordena por TOTAL...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("K37"), _
      Order1:=xlDescending, _
      Header:=xlGuess, _
      OrderCustom:=1, _
      MatchCase:=False, _
      Orientation:=xlTopToBottom
   
   'Aponta para o inicio e fim da legenda...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qLin = 1
   'Iterage na tabela pondo ordinal...
   For lin = LinIni To linfim
      Range("B" & lin).Value = qLin & "|fffd|"
      qLin = qLin + 1
   Next lin
   
   'Chama o frame...
   Call PoeGrid(Range("Cabecalho"))
   
   'Poe a soma...
   Range("C" & linfim + 1).Value = "Total"
   Range("D" & linfim + 1).Formula = "=Sum(D37:D" & linfim & ")"
   Range("E" & linfim + 1).Formula = "=Sum(E37:E" & linfim & ")"
   Range("F" & linfim + 1).Formula = "=Sum(F37:F" & linfim & ")"
   Range("G" & linfim + 1).Formula = "=Sum(G37:G" & linfim & ")"
   Range("H" & linfim + 1).Formula = "=Sum(H37:H" & linfim & ")"
   Range("I" & linfim + 1).Formula = "=Sum(I37:I" & linfim & ")"
   Range("J" & linfim + 1).Formula = "=Sum(J37:J" & linfim & ")"
   Range("K" & linfim + 1).Formula = "=Sum(K37:K" & linfim & ")"
   
   'Atualiza Grafico...
   ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("B37:B" & linfim & _
                                            ",K37:K" & linfim), PlotBy:=xlColumns
        
   'Atualiza Pizza...
   ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C37:C" & linfim & _
                                            ",K37:K" & linfim), PlotBy:=xlColumns
   
   
   'Seleciona o Exb...
   Range("E36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True
   
   AtualizandoGrafico = False
   
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
        
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   'Se estiver fora da coluna de rank sai fora...
   If (Target.Column <> Range("Cabecalho").Offset(0, 1).Column) Or _
      (Target.Row < Range("Cabecalho").Row) Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Como e valida, pega a linha...
   qLin = Target.Row
      
   'Atualiza Grafico...
   ChartObjects("Grafico").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C36:J36," & "C" & qLin & ":J" & qLin), _
                                                             PlotBy:=xlRows
        
   'Atualiza Pizza...
   ChartObjects("Pizza").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Range("C36:J36," & "C" & qLin & ":J" & qLin), _
                                                             PlotBy:=xlRows
   
   
   Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub



Attribute VB_Name = "PlanD6G7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub Click_Grafico()
  Dim unidadeInicial As String
  
  'Congela...
  Application.ScreenUpdating = False
  
  'Pega as datas limites...
  DataIni = PlanD6.Range("Q1").Value
  DataFini = PlanD6.Range("R1").Value
  
  'P|fffd|e visivel e Arma o filtro...
  PlanD6.Visible = xlSheetVisible
  PlanD6.Select
  Call Filtra
  PlanD6G7.Select
  
  'Cria as linhas...
  AuxLin = 1
  unidadeInicial = Sheets(PlanD6G7.Name).Range("I36").Value
  For AuxData = DataIni To DataFini
     'Poe os dados ...
     Range("Cabecalho").Offset(AuxLin, 0).Value = AuxData
     Range("Cabecalho").Offset(AuxLin, 1).Value = CalculaOcupacao(AuxData)
     Range("Cabecalho").Offset(AuxLin, 2).Formula = "=$H$36"
     Range("Cabecalho").Offset(AuxLin, 3).FormulaR1C1 = "=RC[-2]/RC[-1]"

     AuxLin = AuxLin + 1
  Next AuxData
  
  If unidadeInicial <> Sheets(PlanD6G7.Name).Range("I36").Value Then
    MsgBox "Unidade Cl|fffd|nica n|fffd|o encontrada, neste per|fffd|odo", vbInformation, "RM Janus"
  End If
  
  'Desarma o filtro...
  PlanD6.Select
  Call Filtra
  PlanD6G7.Select
  
  'Poe o grid...
  Call PoeGrid(PlanD6G7.Range("Cabecalho"))
  
  'Atualiza o grafico...
  AuxLin = Trim(Str(AuxLin + 35))
  ActiveSheet.ChartObjects("Grafico").Activate
  ActiveChart.PlotArea.Select
  ActiveChart.SetSourceData _
    Source:=PlanD6G7.Range("B36:B" & AuxLin & ",E36:E" & AuxLin), PlotBy:=xlColumns
  
  'Descongela...
  Application.ScreenUpdating = False
End Sub

Private Function CalculaOcupacao(qData)
   Dim i As Integer
   Dim encontrou As Boolean
   encontrou = False
   i = 7    'primeira linha da D6
   
   PlanD6.Select
   PlanD6.Range("Cabecalho").Select
   strData = Trim(Str(Month(qData))) & "/" & Trim(Str(Day(qData))) & "/" & Trim(Str(Year(qData)))
   
   'Filtra tamb|fffd|m por Unidade Cl|fffd|nica
   If Sheets(PlanD6G7.Name).Range("I36").Value <> "" And Sheets(PlanD6G7.Name).Range("I36").Value <> "Todas Unidades" Then
       Do While (Sheets(PlanD6.Name).Range("C" & i).Value <> "")
          'se achar a unidade cl|fffd|nica
          If Sheets(PlanD6.Name).Range("H" & i).Value = Sheets(PlanD6G7.Name).Range("I36").Value Then
             encontrou = True
             If Sheets(PlanD6.Name).Range("Q" & i).Value > 0 Then
                'coloca numLeitos
                Sheets(PlanD6G7.Name).Range("H36").Value = Sheets(PlanD6.Name).Range("Q" & i).Value
             Else
                Sheets(PlanD6G7.Name).Range("H36").Value = 300
             End If
             Selection.AutoFilter Field:=7, Criteria1:="=" & Sheets(PlanD6G7.Name).Range("I36").Value, Operator:=xlAnd

             GoTo fim
          End If
          i = i + 1
       Loop
       If Not encontrou Then
          Sheets(PlanD6G7.Name).Range("H36").Value = 300
          Sheets(PlanD6G7.Name).Range("I36").Value = "Todas Unidades"
       End If
   Else
      Sheets(PlanD6G7.Name).Range("H36").Value = 300
      Sheets(PlanD6G7.Name).Range("I36").Value = "Todas Unidades"
   End If
fim:
  
   Selection.AutoFilter Field:=4, Criteria1:="<=" & strData, Operator:=xlAnd
   Selection.AutoFilter Field:=5, Criteria1:=">" & strData, Operator:=xlOr, Criteria2:="="
   CalculaOcupacao = PlanD6.Range("D2").Value
   PlanD6G7.Select
End Function
Attribute VB_Name = "PlanD6G8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD6.Name, PlanD6G8.Name, "D")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub
Attribute VB_Name = "PlanD6G9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean
Dim ordemCrescente As Boolean 'Crecente ou Decrescente

Sub Click_Grafico()
   
   AtualizandoGrafico = True
   
   Application.ScreenUpdating = False

   'Desarma o autofiltro...
   Range("Cabecalho").Select
   If Selection.AutoFilter Then
      Selection.AutoFilter
   End If
   
   'Limpa os dados...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   If linfim >= LinIni Then
      Rows(LinIni & ":" & linfim).Select
      Selection.Delete Shift:=xlUp
   End If
   
   'Aponta para o inicio e fim da Desc...
   LinIni = PlanD6.Range("Cabecalho").Row + 1
   linfim = PlanD6.Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   
   'Onde vai descarregar...
   qLin = 1
   
   'Iterage na tabela Desc trazendo as linhas nao ocultas...e nao vazias...
   For lin = LinIni To linfim
      If (Not PlanD6.Rows(lin & ":" & lin).EntireRow.Hidden) And _
         (Trim(PlanD6.Range("I" & lin).Value) <> "") Then
          'Poe o nome da especialidade...e zera outros campos...
          Range("Cabecalho").Offset(qLin, 1).Value = PlanD6.Range("I" & lin).Value
         qLin = qLin + 1
      End If
   Next lin
   
   'Ordena em ordem alfabetica...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("C37"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom

  'Colapsa contando...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qNome = Range("C" & LinIni).Value
   LinAnt = LinIni
   'Seta a primeira linha...
   Range("B" & LinIni).Value = 1
   'Avanca a linha...
   LinIni = LinIni + 1
   'Dispara...
   For lin = LinIni To linfim
      'Pega o proximo nome...
      qNomeProximo = Range("C" & lin).Value
      'Se for igual ao de cima inc emcima e deleta a linha e diminui limite...
      If (qNome = qNomeProximo) Then
         Rows(lin & ":" & lin).Select
         Selection.Delete Shift:=xlUp
         lin = lin - 1
      Else
         'Avanca...
         qNome = qNomeProximo
'         'Testa o fim...
'         If qNome <> "" Then
'            Range("B" & lin).Value = 1
'            LinAnt = lin
'         End If
      End If
      ' Testa o fim...
      If qNome = "" Then
         lin = linfim
      End If
   Next lin
   
   'Ordena por Qtd...
   Range("Cabecalho").Select
   Selection.Sort Key1:=Range("D37"), _
      Order1:=xlDescending, _
      Header:=xlGuess, _
      OrderCustom:=1, _
      MatchCase:=False, _
      Orientation:=xlTopToBottom
   
   'Aponta para o inicio e fim da legenda...
   LinIni = Range("Cabecalho").Row + 1
   linfim = Range("Cabecalho").CurrentRegion.Rows.Count + LinIni - 2
   qLin = 1
   'Iterage na tabela pondo ordinal...
   For lin = LinIni To linfim
      Range("B" & lin).Value = qLin & "|fffd|"
      qLin = qLin + 1
   Next lin

   'Chama o frame...
   Call PoeGrid(Range("Cabecalho"))


   Sheets(PlanD6G9.Name).Range("V27").Value = "Especialidade"

   'Coloca formulas para c|fffd|lcular m|fffd|dia mediana e Desvio padr|fffd|o, partindo da linha 37 - Primeira linha
   indice = 37
   Do While Range("C" & indice) <> "Total" And Range("C" & indice) <> ""
        'Celulas Auxiliares: U27->Calc  V27,V28->Crit|fffd|rio
        'Para utilizar crit|fffd|rio
        Range("V28").Value = Range("C" & indice).Value

        'Total
        Range("U27").Formula = "=DCOUNT(" & PlanD6.Name & "!R6C2:R65000C16,13,R27C22:R28C22)"
        Range("D" & indice).Value = Range("U27").Value

        'se a soma for 0 ent|fffd|o n|fffd|o calcula a m|fffd|dia e mediana
        If Range("U27").Value <> 0 Then
            'M|fffd|dia
            Range("U27").Formula = "=DAVERAGE(" & PlanD6.Name & "!R6C2:R65000C17,13,R27C22:R28C22)"
            Range("E" & indice).Value = Range("U27").Value
    
            'Desvio Padr|fffd|o
            Range("U27").Formula = "=DSTDEVP(" & PlanD6.Name & "!R6C2:R65000C16,13,R27C22:R28C22)"
            Range("F" & indice).Value = Range("U27").Value
        Else
            'M|fffd|dia
            Range("E" & indice).Value = 0
    
            'Desvio Padr|fffd|o
            Range("F" & indice).Value = 0
        End If

        'Proxima Linha
        indice = indice + 1
   Loop

   'Limpa c|fffd|lulas auxiliares U27->Calc  V27,V28->Crit|fffd|rio
   Sheets(PlanD2G6.Name).Range("U27").Clear
   Sheets(PlanD2G6.Name).Range("V27").Clear
   Sheets(PlanD2G6.Name).Range("V28").Clear

   'Ordena por m|fffd|dia decrescente
   Range("B36:F998").Sort Key1:=Range("E36"), Order1:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom

   'Refaz Numera|fffd||fffd|o de ranking
   indice = 37
   Do While Range("C" & indice) <> "Total" And Range("C" & indice) <> ""
        Range("B" & indice) = (indice - 36) & "|fffd|"
        indice = indice + 1
   Loop
   
   'Atualiza dados de origem do gr|fffd|fico
   ActiveSheet.ChartObjects("Gr|fffd|fico 19").Activate
   ActiveChart.PlotArea.Select
   ActiveChart.SetSourceData Source:=Sheets(PlanD6G9.Name).Range("B36:B" & (indice - 1) & ",E36:E" & (indice - 1)), PlotBy:=xlColumns

   'Seleciona o Exb...
   Range("B36").Select
   ActiveWindow.LargeScroll Down:=-100
   Application.ScreenUpdating = True

   AtualizandoGrafico = False
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim linha As Integer
    linha = Target.Row
    
    If AtualizandoGrafico Then
        Exit Sub
    End If
    
    'se posicionar em algum lugar no cabe|fffd|alho ordena...
    If Target.Row = 36 And (Target.Column >= 2 And Target.Column <= 6) Then
           If ordemCrescente Then
                Range("B36:F998").Sort Key1:=Target, Order1:=xlAscending, Header:= _
                    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
           Else
                Range("B36:F998").Sort Key1:=Target, Order1:=xlDescending, Header:= _
                    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
           End If
           Range("A1").Select
           ordemCrescente = Not ordemCrescente
    End If
    
    'se selecionar alguma coisa abaixo do cabe|fffd|alho, apaga todas as linha da sele|fffd||fffd|o pra baixo...
    If Target.Row > 36 And (Target.Column >= 2 And Target.Column <= 6) Then
         Application.ScreenUpdating = False
         AtualizandoGrafico = True
         Do While Sheets(PlanD6G9.Name).Range("C" & linha) <> ""
            Rows(linha & ":" & CStr(linha)).Select
            Selection.Delete Shift:=xlUp
         Loop
         AtualizandoGrafico = False
         Application.ScreenUpdating = True
         Range("A1").Select
    End If
End Sub
Attribute VB_Name = "PlanD7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    PlanD7G1.Name = "Freq.Antibi|fffd|tico"
End Sub
Attribute VB_Name = "PlanD7G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD7.Name, PlanD7G1.Name, "E")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanD8G1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim RankArmado As Boolean
Dim AtualizandoGrafico As Boolean

Sub Click_Grafico()
   AtualizandoGrafico = True
   Call AtualizaDescGraf(PlanD8.Name, PlanD8G1.Name, "H")
   AtualizandoGrafico = False
End Sub


'========================================================================================
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
      
   'se estiveratualizando sai fora...
   If AtualizandoGrafico Then
      Exit Sub
   End If
   
   
   'Se estiver fora da coluna de rank sai fora...
   If Target.Column <> Range("Cabecalho").Column Then
      Exit Sub
   End If
   
   'Se estiver vazia, sai fora...
   If Trim(Target.Text) = "" Then
      Exit Sub
   End If
   
   'Se estiver em cima da celula Rank, refresca dados e avisa trigado...
   If Target = Range("Cabecalho") Then
       Call Click_Grafico
       r = MsgBox("Rank armado" & Chr(10) & "Clique na posi|fffd||fffd|o m|fffd|xima desejada do rank.", vbOKOnly, "|fffd| Janus 2005")
       RankArmado = True
       Exit Sub
   End If
   'Ganha velocidade...
   Application.ScreenUpdating = False
   
   RankArmado = False

   AtualizandoGrafico = True
   Call ColapsaRank(Target)
   'Como ta numa posicao v|fffd|lida deve colapsar de baixo para cima... EXTRA SUB GERAL
   AtualizandoGrafico = False
      
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
    '<R> Atualiza a tela para ganhar velocidade
    Application.ScreenUpdating = True
    If Target.Row > 11 Then
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2005")
    End If


End Sub

Attribute VB_Name = "PlanD9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "PlanE10aux1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE10aux2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

'Usada para saber qual linha descelecionar...
Private TargetOld As Variant
'Status para saber se executa ou n|fffd|o a atualiza|fffd||fffd|o da linha
Private status As Integer


Private Sub Worksheet_Deactivate()
   ActiveWorkbook.UltimaPlan = "Est11"
End Sub

'==========================================================================================================
'                                           ROTINAS PUBLICAS  ( WORKSHEET METHODS )
'==========================================================================================================

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)
    'Ativa a execu|fffd||fffd|o da atualiza|fffd||fffd|o da linha
    If status = 1 Then
        status = 2
    Else
        status = 0
    End If
    
   'Ranqueia de acordo com a coluna escolhida
   If (Target.Row = 14) And (status <> 1) And (Target.Text <> "Germes") Then
        'Mant|fffd|m o Status = 1 enquanto executa o Ranking
        status = 1
       Call Ranqueia(Target)
        status = 0
    End If
   
    'S|fffd| Atualiza a linha se o Status = 0 - ou seja: n|fffd|o est|fffd| executando o Ranqueia
    If status = 0 Then
       On Error GoTo SelecaoNaoHeCelula
       'Exit Sub
       
       'Guarda a celula...
       ActiveWorkbook.ultimaCelula = Target.Address
        
       'Mudanca lateral de celula, ja esta destacado...
       If Range("A" & Target.Row).Font.Size = 11 Then
          Exit Sub
       End If
           
       '<R> Atualiza a tela para ganhar velocidade
       Application.ScreenUpdating = False
       
        On Error GoTo handle
        
        'Desceleciona a antiga
        With Range("A" & TargetOld & ":AA" & TargetOld)
            .Font.Size = 10
            .Font.Bold = False
        End With
        
    
handle:
        
        'Seleciona a nova
        With Range("A" & Target.Row & ":AA" & Target.Row)
            .Font.Size = 11
            .Font.Bold = True
        End With
        
        
        'Guarda a atual na OLD...
        TagetOld = Target.Row
      
       
       '<R> Atualiza a tela para ganhar velocidade
       Application.ScreenUpdating = True
        Exit Sub
    
SelecaoNaoHeCelula:
       '<R> Atualiza a tela para ganhar velocidade
       Application.ScreenUpdating = True
       r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| RM Janus 2005")
    'Fim IF Status=0
    End If

End Sub

'==========================================================================================================
'                                           Ranqueia de Acordo com a c|fffd|lula escolhida
'==========================================================================================================

Private Sub Ranqueia(celula As Excel.Range)
    Dim ordena, regiao As String
    Dim tam As Integer
   
    On Error Resume Next
        
    'Seleciona a regi|fffd|o onde deve ser feita a ordena|fffd||fffd|o
    regiao = Cells(celula.Row + 2, celula.Column).CurrentRegion.Address(RowAbsolute:=False)
    
    Select Case (Len(regiao))
        Case 9
            tam = 2
        Case 10 Or 11
            tam = 3
        Case 12 Or 13
            tam = 4
    End Select
    
    regiao = "C16:K" & Right(regiao, tam) - 1

    'Ordena a regi|fffd|o na coluna certa
    Range(regiao).Sort Key1:=Cells(celula.Row + 2, celula.Column), Order1:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub
Attribute VB_Name = "PlanE11aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
   ActiveWorkbook.UltimaPlan = "Est12"
End Sub

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
   'Guarda a celula...
   ActiveWorkbook.ultimaCelula = Target.Address
   
   If Target.Text = "%" Or Target.Text = "Testados" Then
        Call Ranqueia(Target)
   End If
   
End Sub

Private Sub Ranqueia(celula As Excel.Range)
    Dim ordena, regiao As String
    
    On Error Resume Next
        
    'Seleciona a regi|fffd|o onde deve ser feita a ordena|fffd||fffd|o
    regiao = Cells(celula.Row + 2, celula.Column).CurrentRegion.Address(RowAbsolute:=False)
    
    regiao = "C" & (celula.Row + 1) & ":L" & Mid(regiao, InStr(regiao, ":") + 3, 40)
    
    'Ordena a regi|fffd|o na coluna certa
    Range(regiao).Sort Key1:=Cells(celula.Row + 2, celula.Column), Order1:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub

Attribute VB_Name = "PlanE12aux1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE12aux2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "PlanE13aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE14aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE15aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE16aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "PlanE18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE19aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

'Usada para saber qual linha descelecionar...
Private TargetOld As Variant

'==========================================================================================================
'                                           ROTINAS PUBLICAS  ( WORKSHEET METHODS )
'==========================================================================================================

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)

   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
   
    'Mudanca lateral de celula, ja esta destacado...
    If Range("A" & Target.Row).Font.Size = 11 Then
       Exit Sub
       End If
       
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = False
   
    On Error GoTo handle
    
    'Desceleciona a antiga
    With Range("A" & TargetOld & ":AA" & TargetOld)
        .Font.Size = 10
        .Font.Bold = False
    End With
    

handle:
    
    'Seleciona a nova
    With Range("A" & Target.Row & ":AA" & Target.Row)
        .Font.Size = 11
        .Font.Bold = True
    End With
    
    
    'Guarda a atual na OLD...
    TagetOld = Target.Row
  
   
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
   r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2001")


End Sub




Attribute VB_Name = "PlanE5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

'Usada para saber qual linha descelecionar...
Private TargetOld As Variant

'==========================================================================================================
'                                           ROTINAS PUBLICAS  ( WORKSHEET METHODS )
'==========================================================================================================

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)

   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
   
    'Mudanca lateral de celula, ja esta destacado...
    If Range("A" & Target.Row).Font.Size = 11 Then
       Exit Sub
       End If
       
   '<R> Atualiza a tela para ganhar velocidade
   'Application.ScreenUpdating = False
   
    On Error GoTo handle
    
    'Desceleciona a antiga
    With Range("A" & TargetOld & ":AA" & TargetOld)
        .Font.Size = 10
        .Font.Bold = False
    End With
    

handle:
    
    'Seleciona a nova
    With Range("A" & Target.Row & ":AA" & Target.Row)
        .Font.Size = 11
        .Font.Bold = True
    End With
    
    
    'Guarda a atual na OLD...
    TagetOld = Target.Row
  
   
   '<R> Atualiza a tela para ganhar velocidade
   'Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
   r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2001")


End Sub


Attribute VB_Name = "PlanE5aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

'Usada para saber qual linha descelecionar...
Private TargetOld As Variant

'==========================================================================================================
'                                           ROTINAS PUBLICAS  ( WORKSHEET METHODS )
'==========================================================================================================

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)

   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
   
    'Mudanca lateral de celula, ja esta destacado...
    If Range("A" & Target.Row).Font.Size = 11 Then
       Exit Sub
       End If
       
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = False
   
    On Error GoTo handle
    
    'Desceleciona a antiga
    With Range("A" & TargetOld & ":AA" & TargetOld)
        .Font.Size = 10
        .Font.Bold = False
    End With
    

handle:
    
    'Seleciona a nova
    With Range("A" & Target.Row & ":AA" & Target.Row)
        .Font.Size = 11
        .Font.Bold = True
    End With
    
    
    'Guarda a atual na OLD...
    TagetOld = Target.Row
  
   
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
   r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2001")


End Sub



Attribute VB_Name = "PlanE6aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE7aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

'Usada para saber qual linha descelecionar...
Private TargetOld As Variant

Private Sub Worksheet_Deactivate()
   ActiveWorkbook.UltimaPlan = "Est8"
End Sub


'==========================================================================================================
'                                           ROTINAS PUBLICAS  ( WORKSHEET METHODS )
'==========================================================================================================

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)

   
   On Error GoTo SelecaoNaoHeCelula
   'Exit Sub
   
   'Guarda a celula...
   ActiveWorkbook.ultimaCelula = Target.Address
   
    'Mudanca lateral de celula, ja esta destacado...
    If Range("A" & Target.Row).Font.Size = 11 Then
       Exit Sub
       End If
       
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = False
   
    On Error GoTo handle
    
    'Desceleciona a antiga
    With Range("A" & TargetOld & ":AA" & TargetOld)
        .Font.Size = 10
        .Font.Bold = False
    End With
    

handle:
    
    'Seleciona a nova
    With Range("A" & Target.Row & ":AA" & Target.Row)
        .Font.Size = 11
        .Font.Bold = True
    End With
    
    
    'Guarda a atual na OLD...
    TagetOld = Target.Row
  
   
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
   r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2001")


End Sub



Attribute VB_Name = "PlanE8aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanE9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

'Usada para saber qual linha descelecionar...
Private TargetOld As Variant

'==========================================================================================================
'                                           ROTINAS PUBLICAS  ( WORKSHEET METHODS )
'==========================================================================================================

'Chamada quando muda a selecao de uma celula para outra....
Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)

   
   On Error GoTo SelecaoNaoHeCelula
   
    'Mudanca lateral de celula, ja esta destacado...
    If Range("A" & Target.Row).Font.Size = 11 Then
       Exit Sub
       End If
       
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = False
   
    On Error GoTo handle
    
    'Desceleciona a antiga
    With Range("A" & TargetOld & ":AA" & TargetOld)
        .Font.Size = 10
        .Font.Bold = False
    End With
    

handle:
    
    'Seleciona a nova
    With Range("A" & Target.Row & ":AA" & Target.Row)
        .Font.Size = 11
        .Font.Bold = True
    End With
    
    
    'Guarda a atual na OLD...
    TagetOld = Target.Row
  
   
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
    Exit Sub
    
SelecaoNaoHeCelula:
   '<R> Atualiza a tela para ganhar velocidade
   Application.ScreenUpdating = True
   r = MsgBox("Selecao inv|fffd|lida... Trabalhe com UMA C|fffd|LULA por vez.", vbOKOnly, "|fffd| Janus 2001")


End Sub




Attribute VB_Name = "PlanE9aux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanEComp"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Btn1, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "Btn2, 3, 1, MSForms, CommandButton"
Private Sub Btn1_Click()
  Call Calcula
  Range("D6").Select
End Sub

Private Sub Btn2_Click()
  Call Limpa
  Range("D6").Select
End Sub
Attribute VB_Name = "PlanECompAux"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanEmail1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
  Visible = xlSheetHidden
End Sub

Attribute VB_Name = "PlanEmail3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
  Visible = xlSheetHidden
End Sub


Attribute VB_Name = "PlanG11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
  Dim qPlan As String
  Dim qCel As String
  Dim qGerme As String
  Dim qTeste As Range
  Dim qTotal As Range
  Dim limite As String
  
  On Error Resume Next
  
  'Atualiza ...
  Application.ScreenUpdating = False
  
  'Limpa os dados antigos...
  Rows("27:500").Select
  Selection.Delete Shift:=xlUp
  Rows("27:500").Select
  Selection.Delete Shift:=xlUp
  Range("C4").Select
  
  
  'Pega a planilha e a celula...
  qPlan = ActiveWorkbook.UltimaPlan
  qCel = ActiveWorkbook.ultimaCelula
  
  '-------------------------------------------------------------------------------------------------------
  'Testa a planilha..
  If qPlan <> "Est11" Then
    Exit Sub
  End If

  'Pega a celula ...
  Set qTeste = Worksheets(qPlan).Range(qCel)
  qGerme = qTeste.Text
     
  'Pega o limite, onde ser|fffd| feito o corte
  limite = qTeste.Row + 1
  
  If limite - 16 < 1 Then
    MsgBox "Para gera|fffd||fffd|o do relat|fffd|rios escolha o Ponto de Corte", vbInformation, "Ponto de Corte"
    PlanE11.Select
    Exit Sub
  End If
  
  'Seta qTeste como a c|fffd|lula g|fffd|rme
  Set qTeste = Worksheets(PlanE11.Name).Range("C14")
  qGerme = qTeste.Text
  
  
  'Testa se he o flag 'Germes'...
  If qGerme <> "Germes" Then
    Exit Sub
  End If
     
'------------------------------------------------------------------------------- vai dar o tratamento....
  
  'Posiciona no 1. Germe...
  Set qTeste = qTeste.Offset(2, 0)
  
  'Prepara o contador e iterage...
  AuxLin = 0
  
  Do While (qTeste.Text <> "")
    'incrementa o nro de linhas...
    AuxLin = AuxLin + 1
    'pega a proxima linha...
    Set qTeste = qTeste.Offset(1, 0)
  Loop

  'seta AuxLin como o limite menos a linha de inicio
  'AuxLin = limite - (qTeste.Row)
  
  'Testa se nao h|fffd| dados...
  If AuxLin = 0 Then
    Exit Sub
  End If
  
  If AuxLin < (limite - 16) Then
    limite = AuxLin + 16
  End If
  
  'Limpa os dados antigos...
  Rows("36:400").Select
  Selection.Delete Shift:=xlUp
  
  'Posiciona no cabecalho Germes...
  Set qTeste = Worksheets(qPlan).Range("C14")
  
  'Preapara os limites...
  linInicio = qTeste.Row + 1
  linfim = linInicio + AuxLin
  
  '---------------------------------------------------------------------------------------- Copia os nomes...
  Application.CutCopyMode = False
  'Copia do Germes ate o ultimo germe...
  Sheets("Est11").Range("C" & Trim(Str(linInicio)) & ":C" & Trim(Str(linfim))).Copy
    
  'Vai na plan do gr|fffd|fico e cola Germes / Com...
  Range("D36").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
  'Vai na plan do gr|fffd|fico e cola Germes / Hos...
  Range("L36").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
  '---------------------- Copia os %...
  Application.CutCopyMode = False
  'Copia do % Com...
  Sheets("Est11").Range("H" & Trim(Str(linInicio)) & ":H" & Trim(Str(linfim))).Copy
    
  'Vai na plan do gr|fffd|fico e cola Com...
  Range("E36").Select
  ActiveSheet.Paste
    
  Application.CutCopyMode = False
  'Copia do % Hos...
  Sheets("Est11").Range("J" & Trim(Str(linInicio)) & ":J" & Trim(Str(linfim))).Copy
    
  'Vai na plan do gr|fffd|fico e cola Hos...
  Range("M36").Select
  ActiveSheet.Paste

  '----------------------------------------------------------------------------------------- Trata os dados...
  Application.CutCopyMode = False

  'Poe a soma dos outros Com...se for mais de 7 linhas...
  If AuxLin > (limite - 16) Then
    'Pega a celula do total ...
    Set qTotal = Range("E36").Offset(AuxLin, 0)
    qTotal.Value = Application.WorksheetFunction.Sum(Range("E" & (36 + limite - 16 + 1) & ":E" & Trim(Str(36 + AuxLin))))
    'Poe o Total na linha 43...
    Range("B" & (limite - 16 + 27)).Value = "Outros"
    Range("C" & (limite - 16 + 27)).Value = qTotal.Value
  End If

  'Poe a soma dos outros Com...se for mais de 7 linhas...
  If AuxLin > (limite - 16) Then
    'Pega a celula do total ...
    Set qTotal = Range("M36").Offset(AuxLin, 0)
    qTotal.Value = Application.WorksheetFunction.Sum(Range("M" & (36 + limite - 16 + 1) & ":M" & Trim(Str(36 + AuxLin))))
    'Poe o Total na linha 43...
    Range("J" & (limite - 16 + 27)).Value = "Outros"
    Range("K" & (limite - 16 + 27)).Value = qTotal.Value
  End If
  
    
  '-------------------------------------------------------------------------------------- Copia os dados...
  Range("D37:E" & (limite - 16 + 36)).Select
  Selection.Copy
  Range("B27").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

  Range("L37:M" & (limite - 16 + 36)).Select
  Selection.Copy
  Range("J27").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
  Application.CutCopyMode = False
   
  '|fffd|rea dos gr|fffd|ficos
  ActiveSheet.ChartObjects("Gr|fffd|fico 1").Activate
  ActiveChart.ChartArea.Select
  If AuxLin > (limite - 16) Then
    ActiveChart.SetSourceData Source:=Sheets("Grafico11").Range("B27:C" & 27 + limite - 16), PlotBy:=xlColumns
  Else
    ActiveChart.SetSourceData Source:=Sheets("Grafico11").Range("B27:C" & 27 - 1 + limite - 16), PlotBy:=xlColumns
  End If
  With ActiveChart
     .HasTitle = True
     .ChartTitle.Characters.Text = "% Com"
  End With
  If AuxLin > (limite - 16) Then
    Range("B27:C" & 27 + limite - 16).Select
  Else
    Range("B27:C" & 27 - 1 + limite - 16).Select
  End If
  'coloca bordas
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
  'Fim coloca bordas
  
  
  
  
  
  ActiveWindow.Visible = False
  Windows("Janus.xls").Activate
  ActiveSheet.ChartObjects("Gr|fffd|fico 2").Activate
  ActiveChart.ChartArea.Select
  If AuxLin > (limite - 16) Then
    ActiveChart.SetSourceData Source:=Sheets("Grafico11").Range("J27:K" & 27 + limite - 16), PlotBy:=xlColumns
  Else
    ActiveChart.SetSourceData Source:=Sheets("Grafico11").Range("J27:K" & 27 - 1 + limite - 16), PlotBy:=xlColumns
  End If
  With ActiveChart
      .HasTitle = True
      .ChartTitle.Characters.Text = "% Hos"
  End With
  If AuxLin > (limite - 16) Then
    Range("J27:K" & 27 + limite - 16).Select
  Else
    Range("J27:K" & 27 - 1 + limite - 16).Select
  End If
    'Coloca Bordas
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
  'Fim coloca Bordas

  'Limpa os dados antigos...
  Range("D33:E65000").Select
  Selection.Delete Shift:=xlUp
  Range("L33:M65000").Select
  Selection.Delete Shift:=xlUp
  Range("C4").Select

  'Atualiza ...
  Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "PlanG12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim AtualizandoGrafico As Boolean


Private Sub Worksheet_Activate()
  Dim qPlan As String
  Dim qCel As String
  Dim qGerme As String
  Dim qTeste As Range
  Dim limite As String 'Limite - Ponto de Corte
  Dim regiao As String
  
  If AtualizandoGrafico Then
     Exit Sub
  End If
  
  On Error Resume Next
  
  'Atualiza ...
  Application.ScreenUpdating = False
  
  'Pega a planilha e a celula...
  qPlan = ActiveWorkbook.UltimaPlan
  qCel = ActiveWorkbook.ultimaCelula
  
  '-------------------------------------------------------------------------------------------------------
  'Testa a planilha..
  If qPlan <> PlanE12.Name Then
    Exit Sub
  End If

  'Pega a celula ...
  Set qTeste = Worksheets(qPlan).Range(qCel)
  
  'pega o limite, c|fffd|lula celecionada
  limite = qTeste.Row

  'O select |fffd| para tratar as varia|fffd||fffd|es no tamanho da string, isso acontece pelo tamanho da linha
  Worksheets(qPlan).Range("C" & limite).Select

  regiao = Worksheets(qPlan).Range("C" & limite).CurrentRegion.Address(RowAbsolute:=False)
  'seleciona a c|fffd|lula com o nome do germe
  AtualizandoGrafico = True
  Select Case (Len(regiao))
    Case 9, 10:
      Worksheets(qPlan).Range(Mid(regiao, 2, 1) & Mid(regiao, 3, 2) - 4).Select
      qGerme = Worksheets(qPlan).Range(Mid(regiao, 2, 1) & Mid(regiao, 3, 2) - 4).Value
      qCel = (Mid(regiao, 2, 1) & Mid(regiao, 3, 2) - 4)
    Case 11, 12:
      Worksheets(qPlan).Range(Mid(regiao, 2, 1) & Mid(regiao, 3, 3) - 4).Select
      qGerme = Worksheets(qPlan).Range(Mid(regiao, 2, 1) & Mid(regiao, 3, 3) - 4).Value
      qCel = (Mid(regiao, 2, 1) & Mid(regiao, 3, 3) - 4)
    Case 13, 14:
      Worksheets(qPlan).Range(Mid(regiao, 2, 1) & Mid(regiao, 3, 4) - 4).Select
      qGerme = Worksheets(qPlan).Range(Mid(regiao, 2, 1) & Mid(regiao, 3, 4) - 4).Value
      qCel = (Mid(regiao, 2, 1) & Mid(regiao, 3, 4) - 4)
    Case Else
      Exit Sub
  End Select
  
  AtualizandoGrafico = False

  'Pega a celula ...
  Set qTeste = Worksheets(qPlan).Range(qCel)
  
  'Testa se he o flag -celula do lado direito- 'Tipo da infeccao'...
  If qTeste.Offset(0, 1).Text <> "Tipo da Infec|fffd||fffd|o" Then
    Exit Sub
  End If

  '-------------------------------------- vai dar o tratamento....

  'Posiciona no 1. antibiotico...
  Set qTeste = qTeste.Offset(4, 0)

  'Prepara o contador e iterage...
  AuxLin = 0

  Do While (qTeste.Text <> "")
    'incrementa o nro de linhas...
    AuxLin = AuxLin + 1
    'pega a proxima linha...
    Set qTeste = qTeste.Offset(1, 0)
  Loop

  'Testa se nao h|fffd| dados...
  If AuxLin = 0 Then
    Exit Sub
  End If

  '---------------------------------------Aplica os dados...
  'Limpa os dados antigos...
  Rows("37:400").Select
  Selection.Delete Shift:=xlUp
  
  'Posiciona no 1. antibiotico...
  Set qTeste = Worksheets(qPlan).Range(qCel).Offset(4, 0)
  
  'Preapara os limites...
  linInicio = qTeste.Row
'  LinFim = linInicio + AuxLin - 1
  linfim = limite   ' Novo limite, para ponto de corte
  AuxLin = 1 - linInicio + linfim
  If linInicio >= linfim Then
     Exit Sub
  End If
  
  'Copia o range de antibioticos...
  Sheets("Est12").Range("C" & Trim(Str(linInicio)) & ":C" & Trim(Str(linfim))).Copy
  Range("A36").Select
  ActiveSheet.Paste
  Application.CutCopyMode = False
    
    
  'Copia o range %Com...
  Sheets("Est12").Range("I" & linInicio & ":I" & linfim).Copy
  Range("B36").Select
  ActiveSheet.Paste
  Application.CutCopyMode = False
    
    
  'Copia o range %Hosp...
  Sheets("Est12").Range("L" & linInicio & ":L" & linfim).Copy
  Range("C36").Select
  ActiveSheet.Paste
  Application.CutCopyMode = False
    
  'Copia o range Exibe...
  Range("D36").Copy
  Range("D37:D" & (AuxLin + 35)).Select
  ActiveSheet.Paste
  Application.CutCopyMode = False
  
  'Ordena ...
  Range("A35").Select
  Selection.Sort Key1:=Range("C36"), Order1:=xlAscending, Header:=xlGuess, _
      OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
  'Aplica a area de dados...
  ActiveSheet.ChartObjects(1).Activate
  ActiveChart.PlotArea.Select
  ActiveChart.SetSourceData Source:=Sheets("Grafico12").Range("A35:C" & (35 + AuxLin)), PlotBy:=xlColumns
  ActiveWindow.Visible = False
  Windows("Janus.xls").Activate
  
  'Scrola e poe o germe e seleciona titulo..
  ActiveWindow.LargeScroll Down:=-2
  Range("H5").Value = qGerme
  Range("B2").Select
  
  'Atualiza ...
  Application.ScreenUpdating = True
     
     
End Sub


Attribute VB_Name = "PlanG8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
  Dim qPlan As String
  Dim qCel As String
  Dim qTexto As String
  Dim qRange As Range
  Dim qtdPot As Integer 'Armazena quantos potencias de contamina|fffd||fffd|o foram escolhidos, para setar a |fffd|rea do gr|fffd|fico
  
  On Error Resume Next
  
  'Atualiza ...
  Application.ScreenUpdating = False
  
  'Pega a planilha e a celula...
  qPlan = ActiveWorkbook.UltimaPlan
  qCel = ActiveWorkbook.ultimaCelula
  
  '-------------------------------------------------------------------------------------------------------
  'Testa a planilha..
  If qPlan <> "Est8" Then
    Exit Sub
  End If
     
  'Pega a celula ...
  Set qRange = Worksheets(qPlan).Range(qCel)
  qTexto = qRange.Value
  
  'Testa se he o flag 'Potencial'...
'  If qTexto <> "Potencial" Then
'     Exit Sub
'  Else
    qtdPot = 4
    If Trim(PlanE8.Cells(9, 3)) = "" Then
        qtdPot = qtdPot - 1
    End If
    If Trim(PlanE8.Cells(10, 3)) = "" Then
        qtdPot = qtdPot - 1
    End If
    If Trim(PlanE8.Cells(11, 3)) = "" Then
        qtdPot = qtdPot - 1
    End If
    If Trim(PlanE8.Cells(12, 3)) = "" Then
        qtdPot = qtdPot - 1
    End If


    PlanG8.Cells(27, 2) = PlanE8.Cells(9, 3)
    PlanG8.Cells(28, 2) = PlanE8.Cells(10, 3)
    PlanG8.Cells(29, 2) = PlanE8.Cells(11, 3)
    PlanG8.Cells(30, 2) = PlanE8.Cells(12, 3)

    PlanG8.Cells(27, 3) = PlanE8.Cells(9, 8)
    PlanG8.Cells(28, 3) = PlanE8.Cells(10, 8)
    PlanG8.Cells(29, 3) = PlanE8.Cells(11, 8)
    PlanG8.Cells(30, 3) = PlanE8.Cells(12, 8)
    
    'Ordena os resultados
    Range("B26:C30").Sort Key1:=Range("C26"), Order1:=xlDescending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Range("A1").Select
    

    Exit Sub
'  End If

     
  '------------------------------------------------------------------------------- vai dar o tratamento....
  
  'Posiciona no 1. Potencial...
  Set qRange = qRange.Offset(2, 0)
  
  'Prepara o contador e iterage...
  AuxLin = 0
  
  Do While (qRange.Text <> "")
    'incrementa o nro de linhas...
    AuxLin = AuxLin + 1
    'pega a proxima linha...
    Set qRange = qRange.Offset(1, 0)
  Loop
  
  'Testa se nao h|fffd| dados...
  If AuxLin = 0 Then
    Exit Sub
  End If
  
  'Limpa os dados antigos...
  Range("C27:C30").Clear
  'Selection.Delete Shift:=xlUp
  
  'Posiciona no cabecalho Potencial...
  Set qRange = Worksheets(qPlan).Range(qCel)
  
  'Preapara os limites...pulando o ..
  linInicio = qRange.Row + 2
  linfim = linInicio + AuxLin - 1
  '---------------------------------------------------------------------------------------- Copia os nomes...
  Application.CutCopyMode = False
  'Copia do 1. ate o ultimo potencial...
  Sheets("Est8").Range("C" & Trim(Str(linInicio - 1)) & ":C" & Trim(Str(linfim))).Copy
    
  'Vai na plan do gr|fffd|fico e cola ...
  Range("B27").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
  '---------------------- Copia os %...
  Application.CutCopyMode = False
  'Copia do % Com...
  Sheets("Est8").Range("H" & Trim(Str(linInicio - 1)) & ":H" & Trim(Str(linfim))).Copy
    
  'Vai na plan do gr|fffd|fico e cola...
  Range("C27").Select
  ActiveSheet.Paste
  
  Application.CutCopyMode = False
  
  'Atualiza ...
  Application.ScreenUpdating = True

     
End Sub



Attribute VB_Name = "PlanInd1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanInd2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanInd3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanInd4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanR7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlanResultadoLab"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PlandD2G8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub ordenaPorQuantidade()
   Range("B6:P65000").Sort Key1:=Range("O6"), Order1:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
End Sub


' InQuest injected base64 decoded content
' bzWK
' ZN*h
' ZN*h

INQUEST-PP=macro
