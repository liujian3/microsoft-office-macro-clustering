Attribute VB_Name = "Module1"
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|1"
' (c) 2006 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Option Explicit

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Const GalLibName As String = "GalRepBuilder"
Public Const GalLib As String = GalLibName & ".xla!"

' |fffd||fffd||fffd||fffd||fffd| XLS-|fffd||fffd|
Dim DBWB As Workbook

Dim numDelStr, KolDelCellGTD, KolDelCellTNVED As Long
Dim CurrValNumGTD As String


' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| XLS-|fffd||fffd|
' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'   sDBVar - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Function GetDBVar(sDBVar As String) As Variant
GetDBVar = ""
If Not (DBWB Is Nothing) Then
    GetDBVar = Application.Run(GalLib & "GetDBVar", DBWB, sDBVar)
End If
End Function

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    sRepWS - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Sub PrintToSheet(sRepWS As String)
    If Not (DBWB Is Nothing) Then
        Call Application.Run(GalLib & "PrintAllToSWS", DBWB, ThisWorkbook, sRepWS)
    End If
End Sub

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| XLS-|fffd||fffd|
'   sDBWB - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (XLS-|fffd||fffd|)
Sub LoadRepFromDB(sDBWB As String)
    Set DBWB = Application.Workbooks(sDBWB)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd|"
' GalDBVar_|fffd||fffd||fffd|  -  |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|:
' 0  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd|
' 1  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd|
' 2  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.04.2004) |fffd||fffd|
' 3  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 05.02.2007) |fffd||fffd|
' 4  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 05.02.2007) |fffd||fffd| (|fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|.)
' 5  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.10.2007) |fffd||fffd|
' 6  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.10.2007) |fffd||fffd| (|fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|.)
' 7  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 18% (|fffd| 01.01.2010) |fffd||fffd|
' 8  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2010) |fffd||fffd|
' 9  - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2011) |fffd||fffd|
' 10 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2011) |fffd||fffd| (|fffd| |fffd||fffd||fffd|.|fffd||fffd||fffd|.)
' 11 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 (|fffd||fffd|)
' 12 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 |fffd| 25% (|fffd||fffd|)
' 13 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2016 (|fffd||fffd|)
' 14 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2019 (|fffd||fffd|)

' 18 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

' 29 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd|    |fffd||fffd|
' 30 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|  |fffd||fffd|
' 31 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2004)  |fffd||fffd|
' 32 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd|  (|fffd| 01.08.2005) |fffd||fffd|
' 33 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 11.05.2006) |fffd||fffd|
' 34 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2012) |fffd||fffd|
' 35 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 14.08.2014) |fffd||fffd|
' 36 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.10.2017) |fffd||fffd|

' 37 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' 38 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd| 01.01.2004) |fffd||fffd|
' 39 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.08.2005) |fffd||fffd|
' 40 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 11.05.2006) |fffd||fffd|
' 41 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2012) |fffd||fffd|
' 42 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 14.08.2014) |fffd||fffd|
' 44 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.10.2017) |fffd||fffd|
' 45 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2019) |fffd||fffd|

' 51 - |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
' 52 - |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.01.2012) |fffd||fffd|
' 53 - |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 14.08.2014) |fffd||fffd|
' 54 - |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.10.2017) |fffd||fffd|
' 55 - |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| 01.10.2019) |fffd||fffd|

Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 2010 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2004").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2007 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2007 (|fffd||fffd|)(2)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2010 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)(2)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)(3)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 |fffd| 25% (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2016 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2019 (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2005").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2006").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2012").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2017").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2005").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2012").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2017").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2019").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2012").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2014").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2017").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2012").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2014").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2017").Visible = False
Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2019").Visible = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False

    If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
      Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd|")
        Case 0 To 1, 18:
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 2
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2004").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2004")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 3, 4
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2007 (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2007 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 5, 6
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2007 (|fffd||fffd|)(2)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2007 (|fffd||fffd|)(2)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 7
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2010 (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2010 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 8
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)(2)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)(2)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 9, 10
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)").Visible = True
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)(3)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)(3)")
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2011 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 11
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 12
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 |fffd| 25% (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2015 |fffd| 25% (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 13
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2016 (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2016 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 14
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2019 (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2019 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 37, 29, 30
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
        Case 38 To 39, 31, 32
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2005").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2005")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
      Case 40, 33
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2006").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2006")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
      Case 34, 41
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2012").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2012")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
      Case 35, 42
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0 Then
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
            Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
            EditFilterRep
          End If
          
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
      Case 36, 44
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0 Then
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
            Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
            EditFilterRep
          End If
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2017").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2017")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
      Case 45
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0 Then
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
            Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
            EditFilterRep
          End If
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2019").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2019")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
          
      Case 51
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
      Case 52
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2012").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2012")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
      Case 53
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2014").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2014")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
      Case 54
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2017").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2017")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
      End Select
    Else
       Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd|")
        Case 0 To 1, 3, 18:
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 7
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 2010 (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 2010 (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
            Columns(3).Delete
          Else
            Cells(3, 9).Value = Cells(2, 9).Value
            Columns(2).Delete
          End If
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Edit
        Case 37, 29, 30
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
        Case 38, 39, 31, 32
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2005").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2005")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
        Case 34, 41
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2012").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2012")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
        Case 35, 42
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0 Then
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
            Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
            EditFilterRep
          End If
          
          Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
        Case 36, 44
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0 Then
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
            Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
            EditFilterRep
          End If
            Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2017").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2017")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
        Case 45
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0 Then
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
            Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
            EditFilterRep
          End If
            Sheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2019").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2019")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
                    
        Case 51
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd|")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
        Case 52
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2012").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2012")
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF
        Case 53
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2014").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2014")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
        Case 54
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2017").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2017")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
        Case 55
          Sheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2019").Visible = True
          Call PrintToSheet("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2019")
          ActiveWindow.Zoom = 120
          If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then EditRF_2014
        End Select
    End If

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|.
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Then
      If GetDBVar("GalDBVar_IsUseBarCode") = 0 Then
        Columns(22).ColumnWidth = 0
        Columns(23).ColumnWidth = 0
      Else
        Columns(22).ColumnWidth = 15
        Columns(23).ColumnWidth = 15
      End If
    End If


' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
'     Call Application.Run(GalLib & "BuildReport", DBWB, ThisWorkbook)
End Sub

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| XLS-|fffd||fffd|
Sub LoadReport()
    LoadRepFromDB (ThisWorkbook.Name)
     ThisWorkbook.Worksheets("Gal_VarSheet").Visible = False
     ThisWorkbook.Worksheets("Gal_TblSheet").Visible = False
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' ThisWorkbook.Worksheets("Gal_Options").Visible = False
End Sub
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sub Edit()
Dim i, k, m, l, lPosMergeItog2015 As Long

lPosMergeItog2015 = 0         ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1. |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|:

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 9 Then Cells(12, 12).Value = ""

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 0 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 18 Then
      Columns(2).ColumnWidth = Columns(2).ColumnWidth + 2
      Columns(3).ColumnWidth = 0
      Columns(4).ColumnWidth = Columns(4).ColumnWidth + 3
      Columns(6).ColumnWidth = Columns(6).ColumnWidth + 3
End If

m = 18
l = 8
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then m = 7
i = 15
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 1 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < m Then i = 19
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 3 Then Cells(12, 12).Value = ""
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 5 Then Cells(12, 14).Value = ""
k = 14
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 7 Then
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "1 |fffd||fffd| ____"
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
    Cells(9, 15).Value = ""
    Cells(9, 16).Value = ""
  End If
  
  k = 16
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 9 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 10 Then k = 12

If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11) Then
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "1 |fffd||fffd| ____"
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
    Cells(44, 13).Value = ""
    Cells(44, 14).Value = ""
    Cells(44, 14).Borders(xlEdgeBottom).LineStyle = xlNone
  End If
  
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| |fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|.) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "(|fffd||fffd||fffd|.|fffd||fffd||fffd|.)"
  If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0) Then
    Cells(45, 14).Value = ""
  End If
  
  i = 49
  k = 14
  l = 11
End If

If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12) Then
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "1 |fffd||fffd| ____"
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
    Cells(44, 14).Value = ""
    Cells(44, 15).Value = ""
    Cells(44, 15).Borders(xlEdgeBottom).LineStyle = xlNone
  End If
  
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| |fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|.) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "(|fffd||fffd||fffd|.|fffd||fffd||fffd|.)"
  If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0) Then
    Cells(45, 15).Value = ""
  End If
  
  i = 49
  k = 15
  l = 11
End If

If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13) Then
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "1 |fffd||fffd| ____"
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
    Cells(44, 15).Value = ""
    Cells(44, 16).Value = ""
    Cells(44, 16).Borders(xlEdgeBottom).LineStyle = xlNone
  End If
  
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| |fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|.) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "(|fffd||fffd||fffd|.|fffd||fffd||fffd|.)"
  If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0) Then
    Cells(45, 16).Value = ""
  End If
  
  i = 49
  k = 16
  l = 13
End If

If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) Then
  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "1 |fffd||fffd| ____"
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
    Cells(44, 15).Value = ""
    Cells(44, 16).Value = ""
    Cells(44, 16).Borders(xlEdgeBottom).LineStyle = xlNone
  End If
  
  i = 49
  k = 16
  l = 13
End If

While (Cells(i, 1).Value <> "     ")
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 2 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 1 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 18 Then
      Range(Cells(i, l), Cells(i, k)).Select

      If Cells(i, l + 1).Value <> "" Then
      Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
      Case 1: Selection.NumberFormat = "#,##0.0"
      Case 3: Selection.NumberFormat = "#,##0.000"
      Case 4: Selection.NumberFormat = "#,##0.0000"
      Case 5: Selection.NumberFormat = "#,##0.00000"
      End Select
      End If
  End If

  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 2015, 15.02.2019
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) And ((Cells(i, 2).Value = "1. |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|:") Or (Cells(i, 2).Value = "2. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|:")) Then
    lPosMergeItog2015 = i
  End If

  If (i >= lPosMergeItog2015) And (i <= lPosMergeItog2015 + GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")) And (lPosMergeItog2015 <> 0) Then
    Range(Cells(i, 2), Cells(i, 11)).Select
    Selection.Merge
    Selection.HorizontalAlignment = xlLeft
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 14 Then
      Selection.Font.Bold = True
    End If
    Rows(i).AutoFit
  End If

  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 2015
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) And (Cells(i, 2).Value = "|fffd||fffd||fffd||fffd||fffd|:") Then
    Range(Cells(i, 2), Cells(i, 11)).Select
    Selection.Merge
    Selection.HorizontalAlignment = xlLeft
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 14 Then
      Selection.Font.Bold = True
    End If
    Rows(i).AutoFit
  End If

  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 18 Then
    If Cells(i, 10).Value = "" Then
      Range(Cells(i, 2), Cells(i, 14)).Select
      Selection.Merge
      Selection.HorizontalAlignment = xlLeft
      Selection.Font.Bold = True
    End If
  End If

  If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 11 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 12 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 13 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 14) Then
    If Len(Cells(i, 2).Value) > 20 And Rows(i).RowHeight < 13 Then Rows(i).RowHeight = Rows(i).RowHeight + 13
    If Len(Cells(i, 2).Value) > 40 And Rows(i).RowHeight < 26 Then Rows(i).RowHeight = Rows(i).RowHeight + 14
    If Len(Cells(i, 3).Value) > 20 And Rows(i).RowHeight < 13 Then Rows(i).RowHeight = Rows(i).RowHeight + 13
    If Len(Cells(i, 3).Value) > 40 And Rows(i).RowHeight < 26 Then Rows(i).RowHeight = Rows(i).RowHeight + 14
    If Len(Cells(i, 4).Value) > 27 And Rows(i).RowHeight < 13 Then Rows(i).RowHeight = Rows(i).RowHeight + 13
    If Len(Cells(i, 4).Value) > 50 And Rows(i).RowHeight < 26 Then Rows(i).RowHeight = Rows(i).RowHeight + 14
  End If

i = i + 1
Wend

' |fffd||fffd||fffd|/|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 18 Then
    InsRows (i)
  Else
    Rows(8).Clear
    InsRowsSvod (i)
  End If
End If

ActiveWindow.Zoom = 120
Application.CutCopyMode = False
Cells(2, 2).Select
End Sub
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| EndTable - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub InsRows(EndTable As Long)
Dim i, j, n, r, x, k, m, RowPrevHeight, PageBreakRow, FirstPageBreak As Long
Dim b As Boolean
'n - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'j - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'r - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'x - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'FirstPageBreak - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'b
b = False
m = 18
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then m = 7
x = 15
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 1 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < m Then x = 19
j = 1
Excel.ActiveWindow.View = xlPageBreakPreview
n = ActiveSheet.HPageBreaks.Count
k = 14
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 7 Then k = 16
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 9 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 10 Then k = 12

FirstPageBreak = 44

If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) Then
  ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(FirstPageBreak, k)
End If

Do While j <= n

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ActiveSheet.HPageBreaks.Count |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ActiveSheet.HPageBreaks(j).Location.Row |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Page_Curr |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  On Error GoTo Error1
    PageBreakRow = ActiveSheet.HPageBreaks(j).Location.Row
  GoTo Ends:
Error1:
  Exit Do
Ends:

  If EndTable > PageBreakRow Then
    r = PageBreakRow

    If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 11 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 12 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 13 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 14) Then           ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 2015
      Rows(r - 1).Insert Shift:=xlDown               ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Rows(r - 1).RowHeight = 12

      Cells(r - 1, 2).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| " + Str(j)
      Range(Cells(r - 1, 2), Cells(r - 1, 7)).Select
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.WrapText = False

      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        For i = 8 To k Step 1
        Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        Next i
      Else
        If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 2 Then
          For i = 8 To 13 Step 1
            Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
          Next i
          Range(Cells(r - 1, 13), Cells(r - 1, 14)).Select
          Selection.Merge
          Selection.HorizontalAlignment = xlRight
        Else
          If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 1 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 9 Then
            Cells(r - 1, 8).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            Cells(r - 1, 10).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            Cells(r - 1, 12).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            Cells(r - 1, 14).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 7 Then Cells(r - 1, 16).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
          Else
            Cells(r - 1, 10).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            Cells(r - 1, 8).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 8 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 11 Then Cells(r - 1, 12).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
          End If
        End If
      End If
    End If

    If Not ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) And r < 45) Then
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|2
      '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| WrapText |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...
      RowPrevHeight = Rows(r - 1).RowHeight

      Rows(r).Insert Shift:=xlDown                  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2-|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Rows(r + 1).Insert Shift:=xlDown

      Range(Cells(r, 2), Cells(r + 1, k)).Select

      Selection.WrapText = False
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlEdgeLeft).LineStyle = xlNone
      Selection.Font.Size = 7
      
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If RowPrevHeight < Rows(r - 1).RowHeight Then
        Rows(r - 1).RowHeight = RowPrevHeight
      End If

      Cells(r, 2).Value = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1")
    End If

    If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 11 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 12 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 13 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 14) Then
      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
        Cells(r, 2).Characters(Start:=27, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=42, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=58, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle
      Else
        Cells(r, 2).Characters(Start:=38, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=53, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=69, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle
      End If
    End If

    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 3 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 4 Then
      Cells(r, 11).Value = "|fffd||fffd||fffd||fffd|   " + Str(j + 1) + "   |fffd||fffd|"
      Cells(r, 11).Characters(Start:=7, Length:=4).Font.Underline = xlUnderlineStyleSingle
      Cells(r, 12).Borders(xlEdgeBottom).LineStyle = xlContinuous
    Else
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 7 Then
        Cells(r, 15).Value = "|fffd||fffd||fffd||fffd|   " + Str(j + 1) + "   |fffd||fffd|"
        Cells(r, 15).Characters(Start:=7, Length:=4).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 16).Borders(xlEdgeBottom).LineStyle = xlContinuous
      Else
        If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 9 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 10 Then
          Cells(r, 11).Value = "|fffd||fffd||fffd||fffd|   " + Str(j + 1) + "   |fffd||fffd|"
          Cells(r, 11).Characters(Start:=7, Length:=4).Font.Underline = xlUnderlineStyleSingle
          Cells(r, 12).Borders(xlEdgeBottom).LineStyle = xlContinuous
        Else
          If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) Then
            If r > 45 Then
              Cells(r, 13).Value = "|fffd||fffd||fffd||fffd|   " + Str(j) + "   |fffd||fffd|"
              Cells(r, 13).Characters(Start:=7, Length:=4).Font.Underline = xlUnderlineStyleSingle
              Cells(r, 14).Borders(xlEdgeBottom).LineStyle = xlContinuous
            End If
          Else
            Cells(r, 13).Value = "|fffd||fffd||fffd||fffd|   " + Str(j + 1) + "   |fffd||fffd|"
            Cells(r, 13).Characters(Start:=7, Length:=4).Font.Underline = xlUnderlineStyleSingle
            Cells(r, 14).Borders(xlEdgeBottom).LineStyle = xlContinuous
          End If
        End If
      End If
    End If

    Rows(r).Font.Bold = False

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 2 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 17 Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 7 And GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1) Then
      Range(Rows(14), Rows(14)).Copy
    Else
      If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) Then
        If r > 45 Then
          Range(Rows(48), Rows(48)).Copy
        End If
      Else
        Range(Rows(18), Rows(18)).Copy
      End If
    End If

    If Not ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) And r < 45) Then
    
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|2
      '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| WrapText |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...
      RowPrevHeight = Rows(r + 1).RowHeight
    
      Rows(r + 2).Insert Shift:=xlDown
      
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If RowPrevHeight < Rows(r + 1).RowHeight Then
        Rows(r + 1).RowHeight = RowPrevHeight
      End If

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(r, k)
      Excel.ActiveWindow.View = xlPageBreakPreview
      n = ActiveSheet.HPageBreaks.Count

      '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      x = r + 2

      Range(Cells(r - 1, 2), Cells(r - 1, k)).Borders(xlEdgeBottom).LineStyle = xlContinuous

      If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) Then
        EndTable = EndTable + 3 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 3 |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
      Else
        EndTable = EndTable + 4 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 4 |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
      End If
    End If
  Else
    b = True
  End If
  j = j + 1
Loop

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 11 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 12 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 13 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 14) Then            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 2015
  Exit Sub
End If

r = EndTable - 1
If (r - 1 - x) > 1 Then
  Rows(r - 1).Insert Shift:=xlDown               ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Rows(r - 1).RowHeight = 12

  If b Then j = j - 1
  Cells(r - 1, 2).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| " + Str(j)
  Range(Cells(r - 1, 2), Cells(r - 1, 7)).Select
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.WrapText = False

  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 8 To k Step 1
     Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
    Next i
  Else
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 2 Then
      For i = 8 To 13 Step 1
        Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
      Next i
      Range(Cells(r - 1, 13), Cells(r - 1, 14)).Select
      Selection.Merge
      Selection.HorizontalAlignment = xlRight
    Else
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 1 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 9 Then
        Cells(r - 1, 8).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        Cells(r - 1, 10).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        Cells(r - 1, 12).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        Cells(r - 1, 14).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 7 Then Cells(r - 1, 16).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
      Else
        Cells(r - 1, 10).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        Cells(r - 1, 8).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
        If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 9 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 10 Then Cells(r - 1, 12).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
      End If
    End If
  End If
End If
Range(Cells(r, 2), Cells(r, k)).Select
Selection.Borders(xlInsideVertical).LineStyle = xlNone
End Sub
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||fffd|)
Sub InsRowsSvod(EndTable As Long)
Dim i, j, n, r As Long
i = 15
j = 1
Excel.ActiveWindow.View = xlPageBreakPreview
n = ActiveSheet.HPageBreaks.Count

While j <= n
If EndTable > ActiveSheet.HPageBreaks(j).Location.Row Then
  r = ActiveSheet.HPageBreaks(j).Location.Row
  Rows(r - 1).Insert Shift:=xlDown
  Rows(r).Insert Shift:=xlDown
  Rows(r + 1).Insert Shift:=xlDown

  Range(Cells(r - 1, 2), Cells(r + 1, 14)).Select
  Selection.WrapText = False
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
  Selection.Borders(xlEdgeRight).LineStyle = xlNone
  Selection.Borders(xlEdgeLeft).LineStyle = xlNone
  Selection.Font.Size = 7

  Range(Cells(r, 2), Cells(r, 10)).Select
  Selection.Merge
  Selection.WrapText = True

  Cells(r, 2).Value = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1")
  If Len(Cells(r, 2)) > 100 Then Rows(r).RowHeight = Rows(r).RowHeight + 10
  Cells(r, 2).Characters(Start:=49, Length:=10).Font.Underline = xlUnderlineStyleSingle
  Cells(r, 2).Characters(Start:=64, Length:=10).Font.Underline = xlUnderlineStyleSingle
  Cells(r, 2).Characters(Start:=80, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle

  Cells(r, 13).Value = "|fffd||fffd||fffd||fffd|   " + Str(j + 1) + "   |fffd||fffd|"
  Cells(r, 13).Characters(Start:=7, Length:=4).Font.Underline = xlUnderlineStyleSingle
  Cells(r, 14).Borders(xlEdgeBottom).LineStyle = xlContinuous
  Rows(r).Font.Bold = False
  Range(Rows(14), Rows(14)).Copy
  Rows(r + 2).Insert Shift:=xlDown
  n = ActiveSheet.HPageBreaks.Count
  Excel.ActiveWindow.View = xlPageBreakPreview

  If ActiveSheet.HPageBreaks(j).Location.Row > r Then
  While ActiveSheet.HPageBreaks(j).Location.Row > r
     Rows(r).Insert Shift:=xlDown
     r = r + 1
     n = ActiveSheet.HPageBreaks.Count
     Excel.ActiveWindow.View = xlPageBreakPreview
     EndTable = EndTable + 1
  Wend
  End If
  EndTable = EndTable + 4
  End If
  j = j + 1
Wend
End Sub
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sub EditRF()
 Dim i, j, k, l, m, g  As Long
 Dim bNew, b As Boolean

'l - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'm - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'g - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|

If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
  bNew = GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 40 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 51 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52
Else
  bNew = GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 33) Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34
End If

If bNew And GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
  k = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") - 1
Else
  k = 0
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 37 Then
      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
          Columns(3).ColumnWidth = 0
          Columns(7).ColumnWidth = Columns(7).ColumnWidth + 5
          Columns(2).ColumnWidth = Columns(2).ColumnWidth + 3
      Else
        Columns(3).ColumnWidth = 0
        If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
          Columns(4).ColumnWidth = Columns(4).ColumnWidth + 4
          Columns(6).ColumnWidth = Columns(6).ColumnWidth + 4
        Else
          Columns(2).ColumnWidth = Columns(2).ColumnWidth + 4
          Columns(7).ColumnWidth = Columns(7).ColumnWidth + 4
        End If
      End If
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 29 Then
   Columns(3).ColumnWidth = 0
   For j = 9 To 14 Step 1
    Columns(j).ColumnWidth = Columns(j).ColumnWidth + 1
  Next j
End If

'If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 39 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Then
'  l = 15
'Else
'  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
'  Else
'    l = 17
'  End If
'End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
  l = 20
  m = 21
  g = 12
Else
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 39 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Then
    l = 15
  Else
    l = 17
  End If

  m = 18
  g = 9
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
  Application.ScreenUpdating = False

  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
    If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
      AutoFitMergedCellRowHeight ([D11:N11])
    Else
      AutoFitMergedCellRowHeight ([C9:P9])
    End If
  Else
    AutoFitMergedCellRowHeight ([J10:S10])
  End If
End If

If bNew Then
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Rows(15).Insert Shift:=xlDown
  Rows(15 + k).RowHeight = 18
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Cells(15 + k, l) = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd|")
  Cells(15 + k, m) = "__________"
  Range(Cells(15 + k, l), Cells(15 + k, m)).Select
  Selection.HorizontalAlignment = xlRight
  Selection.VerticalAlignment = xlCenter
  Selection.Font.Name = "Arial Narrow"
  Selection.Font.Size = 7
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 39 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Then
  Columns(16).ColumnWidth = 0
  Columns(17).ColumnWidth = 0
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then Columns(7).ColumnWidth = Columns(7).ColumnWidth + 4
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then Columns(3).ColumnWidth = Columns(3).ColumnWidth + 3
  Cells(k + 15, 15).Value = Cells(k + 15, 17).Value
  For j = 10 To 15 Step 1
    Columns(j).ColumnWidth = Columns(j).ColumnWidth + 2
  Next j

  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
    Cells(k + 20, 18).Value = "(8)"
  Else
    Cells(k + 20, 18).Value = "(11)"
  End If
End If

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
i = 15
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 35 Then i = k + 21

While (Cells(i, 1).Value <> "     ")
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 39 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Then
    Cells(i, 16).Value = ""
    Cells(i, 17).Value = ""
  End If
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 36 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 45 Then
    If Cells(i, g).Value = "" And Cells(i, g + 1).Value = "" And Cells(i, g + 2).Value = "" Then
      Range(Cells(i, 2), Cells(i, 16)).Select
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 35) Then
        Range(Cells(i, 2), Cells(i, m)).Select
      End If
      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 29 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 30) Then
        Range(Cells(i, 2), Cells(i, 14)).Select
      End If
      Selection.WrapText = False
      Selection.Merge
      Selection.HorizontalAlignment = xlLeft
      Selection.Font.Bold = True
    End If
  End If

  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
    If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
      b = Cells(i, 7).Value = "" And Cells(i, 9).Value = "" And Cells(i, 10).Value = "" And Cells(i, 12).Value = ""
    Else
      b = Cells(i, 9).Value = "" And Cells(i, 10).Value = "" And Cells(i, 11).Value = "" And Cells(i, 12).Value = ""
    End If
  Else
    b = Cells(i, 4).Value = "" And Cells(i, 6).Value = "" And Cells(i, 7).Value = "" And Cells(i, 9).Value = ""
  End If

  If b And Cells(i, g + 1).Value <> "" Then
    Range(Cells(i, 2), Cells(i, g)).Select
    Selection.WrapText = False
    Selection.Merge
    Selection.HorizontalAlignment = xlLeft
    Rows(i).Font.Bold = True
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 0
    For j = g + 2 To m Step 1
      If (Cells(i, j).Value = 0 And j <> 13) Then Cells(i, j).Value = "-"
    Next j
  End If

 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 34 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 41 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 52 Then
    If Len(Cells(i, 4).Value) > 25 And Rows(i).RowHeight < 12 Then Rows(i).RowHeight = Rows(i).RowHeight + 12
    If Len(Cells(i, 4).Value) > 50 And Rows(i).RowHeight < 24 Then Rows(i).RowHeight = Rows(i).RowHeight + 12
  End If

  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 31 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33 Then
    If Cells(i, 4).Value <> "" Or Cells(i, 6).Value <> "" Or Cells(i, 7).Value <> "" Or Cells(i, 8).Value <> "" Then
      For j = 11 To 18 Step 1
        If (Cells(i, j).Value = 0 And j <> 13) Then Cells(i, j).Value = "-"
      Next j
    End If
  End If

  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
    If Cells(i, 7).Value <> "" Or Cells(i, 8).Value <> "" Or Cells(i, 9).Value <> "" Or Cells(i, 10).Value <> "" Then
      For j = 14 To 21 Step 1
        If (Cells(i, j).Value = 0) Then Cells(i, j).Value = "-"
      Next j
    End If
  End If
i = i + 1
Wend

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 39 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Then
  Cells(i + 11, 2).Value = ""
  Cells(i + 12, 2).Value = ""
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 36 Then
  InsRowsRF (i)
Else
  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 51 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 52 Then
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Then
      Rows(14).Clear
    Else
      Rows(8).Clear
    End If
'  InsRowsSvodRF (i)
  End If
  InsRowsSvodRF (i)
End If

Application.CutCopyMode = False
ActiveWindow.Zoom = 120

End Sub

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 2014|fffd|.
' Str - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, LastRow - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, ListNum - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Sub InsHeaderOfList_2014(Str As Long, LastRow As Long, List As Long)
  Cells(Str, LastRow) = "|fffd||fffd||fffd||fffd| " + CStr(List)

  Rows(Str).HorizontalAlignment = xlRight
  Rows(Str).VerticalAlignment = xlCenter
  Rows(Str).Font.Size = 7

  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd|", |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
  Range(Cells(Str, 2), Cells(Str, LastRow)).Select
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
End Sub



' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2014 |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' FirstStr - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, LastStr - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| numDelStr
Function MergeCellsForGTD(FirstStr, LastStr, EndStrTable As Long) As Long
Dim i, NumColGTD, k As Long
Dim PageHeight, RowMaxHeight, BufHeight As Long
Dim s, BufValue As String  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim boExistGTDonCurPage As Boolean

  If (FirstStr < 1) Then
    MergeCellsForGTD = LastStr + 1
    Exit Function
  End If
  
  RowMaxHeight = 408 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Excel
  NumColGTD = 14     ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  s = ", "           ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  boExistGTDonCurPage = False

  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  For i = FirstStr To LastStr Step 1
    PageHeight = PageHeight + Cells(i, 1).Height

    If (Cells(i, 1).Value <> "") And (Cells(i, 1).Value = Cells(i + 1, 1).Value) Then
      boExistGTDonCurPage = True
    End If
  Next i

  If Not boExistGTDonCurPage Then
    MergeCellsForGTD = i ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Exit Function
  End If

  numDelStr = 0 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

  For i = FirstStr To EndStrTable - 1 Step 1

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (Cells(i - numDelStr, 1).Height > PageHeight) Then
      MergeCellsForGTD = i - numDelStr
      Exit Function
    End If

    If (Cells(i - numDelStr, 1).Height = PageHeight) Then
      MergeCellsForGTD = i - numDelStr + 1
      Exit Function
    End If

    If (Cells(i - numDelStr, 1).Value <> "") And (Cells(i - numDelStr, 1).Value = Cells(i - numDelStr + 1, 1).Value) Then

      BufValue = Cells(i - numDelStr, NumColGTD).Value
      BufHeight = Rows(i - numDelStr).RowHeight

      Cells(i - numDelStr, NumColGTD).Value = Cells(i - numDelStr, NumColGTD).Value & s & Cells(i - numDelStr + 1, NumColGTD).Value ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(i - numDelStr, NumColGTD).Rows.AutoFit ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If (Cells(i - numDelStr, NumColGTD).Height > RowMaxHeight) Or (Cells(i - numDelStr, NumColGTD).Height > PageHeight) Then
        Cells(i - numDelStr, NumColGTD).Value = BufValue ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Rows(i - numDelStr).RowHeight = BufHeight
        MergeCellsForGTD = i - numDelStr + 1
        Exit Function
      End If

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      BufHeight = Rows(i - numDelStr).RowHeight
      Rows(i - numDelStr + 1 & ":" & i - numDelStr + 1).Delete Shift:=xlUp
      Rows(i - numDelStr).RowHeight = BufHeight
      numDelStr = numDelStr + 1
    Else
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      PageHeight = PageHeight - Cells(i - numDelStr, 1).Height
    End If
  Next i

  MergeCellsForGTD = i - numDelStr ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Function

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
' FirstStr - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, LastStr - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Function EraseLineForGTDAndTNVED(FirstStr, LastStr As Long) As Long
Dim i As Long
Dim PageHeight As Long
  
  If (FirstStr < 1) Then
    EraseLineForGTDAndTNVED = LastStr + 1
    Exit Function
  End If
  
  For i = FirstStr To LastStr Step 1
    PageHeight = PageHeight + Cells(i, 1).Height
    
    If (Cells(i, 1).Value <> "") And (Cells(i, 1).Value = Cells(i + 1, 1).Value) Then
      If (Cells(i, 1).Height > PageHeight) Then
        EraseLineForGTDAndTNVED = i
        Exit Function
      End If
      
      If (Cells(i, 1).Height = PageHeight) Then
        EraseLineForGTDAndTNVED = i + 1
        Exit Function
      End If
      
      Range(Cells(i, 2), Cells(i, 25)).Select
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    End If
  Next i
  
  EraseLineForGTDAndTNVED = i ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Function


' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub CountFiltRows(FirstFiltRow, LastFiltRow, FiltCol As Long)
Dim CurrStr, i As Long

  i = FirstFiltRow
  CurrStr = FirstFiltRow
  While (i <= LastFiltRow)
    If Cells(CurrStr, FiltCol).Value = "" Then
      Rows(CurrStr).Delete
      CurrStr = CurrStr - 1
    End If

    i = i + 1
    CurrStr = CurrStr + 1
  Wend
  
  ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  If CurrStr = FirstFiltRow Then
    Rows(CurrStr - 1).Delete
  End If
  
End Sub

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| 2014|fffd|.
Sub EditRF_2014()
Dim BegStrTable, EndStrTable, RowBeg, RowItogBeg, RowEndS, RowEndT, ColTest, RowHeader, i, j, FiltRows As Long
Dim EmptyStrBeforeItogo, FirstListStr, PageCount, Page_Curr, FirstPageStr, FirstStrPreviousPage, ListNum, RowPrevHeight As Long
Dim bContinue, bBegItogo As Boolean
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ColTest - |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
    Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd|")
      Case 35, 42  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014,
        CountFiltRows (17), (23), (7)
        BegStrTable = 23 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        RowBeg = 16                                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        RowItogBeg = 17                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        RowEndS = 17                                           ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|
        ColTest = 4                                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        FirstListStr = 17 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|") ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd| ___ |fffd||fffd| ___
        RowHeader = 23 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      Case 36, 44  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) 2014, 2017
        CountFiltRows (17), (23), (7)
        BegStrTable = 22 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        RowBeg = 16                                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        RowItogBeg = 17                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        RowEndS = 17                                           ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|
        ColTest = 4                                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        FirstListStr = 17 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|") ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd| ___ |fffd||fffd| ___
        RowHeader = 22 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      Case 53, 54 ' |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2014, 2017
        BegStrTable = 20
        RowBeg = 16
        RowItogBeg = 17
        RowEndS = 17
        ColTest = 4
        FirstListStr = 14
        RowHeader = 19
    End Select
  Else
    Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd|")
      Case 35, 36, 42, 44, 45 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) c 2014, 2019
        CountFiltRows (17), (23), (8)
        BegStrTable = 23 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
        RowBeg = 14
        RowItogBeg = 16
        RowEndS = 21
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 36) Then
          RowBeg = RowBeg + 2
          RowItogBeg = RowItogBeg + 2
          RowEndS = RowEndS + 2
        End If
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 42) Then
          RowItogBeg = 14
        End If
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 44) Then
            RowEndS = RowEndS + 2
        End If
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 45) Then
          RowBeg = RowBeg + 2
          RowItogBeg = RowItogBeg + 2
          RowEndS = RowEndS + 4
        End If
        ColTest = 4
        FirstListStr = 17 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
        RowHeader = 23 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 36 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 45) Then
          RowHeader = 22 + GetDBVar("GalDBVar_|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
        End If
        
      Case 53, 54 ' |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2014
        BegStrTable = 19
        RowBeg = 14
        RowItogBeg = 16
        RowEndS = 21
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 54) Then
          RowBeg = RowBeg + 2
          RowItogBeg = RowItogBeg + 2
          RowEndS = RowEndS + 2
        End If
        ColTest = 4
        FirstListStr = 13
        RowHeader = 18
        
      Case 55 ' |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 2019
        BegStrTable = 19
        RowBeg = 14
        RowItogBeg = 16
        RowEndS = 23
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 55) Then
          RowBeg = RowBeg + 2
          RowItogBeg = RowItogBeg + 2
          RowEndS = RowEndS + 2
        End If
        ColTest = 4
        FirstListStr = 13
        RowHeader = 18
    End Select
  End If

  EmptyStrBeforeItogo = 0 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  EndStrTable = 0         ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  i = BegStrTable
  bContinue = (UCase(Trim(Cells(i, ColTest).Value)) <> "|fffd||fffd||fffd||fffd||fffd|")
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd|" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
  ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.

  While bContinue
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 42) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 44)) Then
   
     Dim bNeedMerge As Boolean

      bNeedMerge = False

      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
        If Cells(i, 14).Value = "" And Cells(i, 17).Value = "" Then
          Range(Cells(i, 2), Cells(i, 17)).Select
          bNeedMerge = True
        End If

        If Cells(i, 14).Value = "" And Cells(i, 16).Value = "" And Cells(i, 17).Value <> "" Then
          Range(Cells(i, 2), Cells(i, 16)).Select
          bNeedMerge = True
        End If
      Else
       
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 44) Then
            If Cells(i, 20).Value = "" And Cells(i, 21).Value = "" Then
              Range(Cells(i, 2), Cells(i, 23)).Select
              bNeedMerge = True
            End If
            
            If Cells(i, 16).Value = "" And Cells(i, 17).Value = "" And Cells(i, 20).Value <> "" And Cells(i, 21).Value <> "" Then
              Range(Cells(i, 2), Cells(i, 15)).Select
              bNeedMerge = True
            End If
       
        Else
            If Cells(i, 18).Value = "" And Cells(i, 19).Value = "" Then
              Range(Cells(i, 2), Cells(i, 21)).Select
              bNeedMerge = True
            End If

            If Cells(i, 14).Value = "" And Cells(i, 15).Value = "" And Cells(i, 18).Value <> "" And Cells(i, 19).Value <> "" Then
              Range(Cells(i, 2), Cells(i, 15)).Select
              bNeedMerge = True
            End If
       End If
      End If
  
      If bNeedMerge Then
        Selection.WrapText = False
        Selection.Merge
        Selection.HorizontalAlignment = xlLeft
        Selection.Font.Bold = True
      End If
    End If

    bBegItogo = InStr(UCase(Trim(Cells(i, ColTest).Value)), "|fffd||fffd||fffd||fffd||fffd|")
    
    If bBegItogo Then
      
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      Range(Cells(i, 2), Cells(i, RowItogBeg - 1)).Select
      Selection.WrapText = False
      Selection.Merge
      Selection.HorizontalAlignment = xlLeft
      Selection.Font.Bold = True

      ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
      For j = RowBeg To RowEndS Step 1
        If (Cells(i, j).Value = 0) Then Cells(i, j).Value = "-"
      Next j
    End If

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (Cells(i, ColTest).Value <> "") And (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1) Then
      For j = 2 To RowBeg - 1 Step 1
        If (Cells(i, j).Value = "") Then Cells(i, j).Value = "-"
      Next j
    End If
    
    If Cells(i, ColTest).Value <> "" Or bNeedMerge Then
      For j = RowBeg To RowEndS Step 1
        If (Cells(i, j).Value = 0) Then Cells(i, j).Value = "-"
      Next j
    End If

    i = i + 1

    bContinue = (UCase(Trim(Cells(i, ColTest).Value)) <> "|fffd||fffd||fffd||fffd||fffd|")

    If Not bContinue Then
      EmptyStrBeforeItogo = i - 1

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      Range(Cells(i, 2), Cells(i, RowItogBeg - 1)).Select
      Selection.WrapText = False
      Selection.Merge
      Selection.HorizontalAlignment = xlLeft
      Selection.Font.Bold = True

      ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
      For j = RowBeg To RowEndS Step 1
        If (Cells(i, j).Value = 0) Then Cells(i, j).Value = "-"
      Next j
    End If
  Wend

  ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  RowEndT = RowEndS  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|

  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|.
  If GetDBVar("GalDBVar_IsUseBarCode") = 0 Then
    Columns(RowEndS + 1).ColumnWidth = 0
    Columns(RowEndS + 2).ColumnWidth = 0
  Else
    Columns(RowEndS + 1).ColumnWidth = 15
    Columns(RowEndS + 2).ColumnWidth = 15
    RowEndT = RowEndS + 2  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  End If

  If EmptyStrBeforeItogo > BegStrTable Then
    ' |fffd||fffd| 2-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range(Cells(EmptyStrBeforeItogo, 2), Cells(EmptyStrBeforeItogo, RowEndT)).Select
    Selection.Merge

    EndStrTable = EmptyStrBeforeItogo + 1 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  End If

  ' |fffd||fffd||fffd|/|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| InsRowsRF |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|(!) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,
    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    ListNum = GetDBVar("GalDBVar_1|fffd||fffd||fffd||fffd|") ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    InsHeaderOfList_2014 (FirstListStr), (RowEndS), (ListNum)

    Excel.ActiveWindow.View = xlPageBreakPreview  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Excel
    PageCount = ActiveSheet.HPageBreaks.Count     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 0
    Page_Curr = 1
    FirstStrPreviousPage = FirstListStr + 1       ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Do While Page_Curr <= PageCount

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ActiveSheet.HPageBreaks.Count |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1
      ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ActiveSheet.HPageBreaks(Page_Curr).Location.Row |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Page_Curr |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      On Error GoTo Error1
        FirstPageStr = ActiveSheet.HPageBreaks(Page_Curr).Location.Row
      GoTo Ends:
Error1:
  Exit Do
Ends:

      numDelStr = 0                               ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

      If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0) And ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 35) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 42) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 44) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 53) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 36) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 45) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 54)) Then ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2014
        FirstPageStr = MergeCellsForGTD(FirstStrPreviousPage - 0, FirstPageStr - 1, EndStrTable - 0) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        EndStrTable = EndStrTable - numDelStr
      End If
      
      If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0) And ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 36) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 45) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 54) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 55) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 44)) Then ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2017
        FirstPageStr = EraseLineForGTDAndTNVED(FirstStrPreviousPage - 0, FirstPageStr - 1)
      End If

      ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If FirstPageStr >= EndStrTable Then
        Exit Do
      End If

      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...
      RowPrevHeight = Rows(FirstPageStr - 1).RowHeight

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Range(Rows(RowHeader), Rows(RowHeader)).Copy  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Rows(FirstPageStr).Insert Shift:=xlDown       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      EndStrTable = EndStrTable + 1

      Rows(FirstPageStr).Insert Shift:=xlDown   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Rows(FirstPageStr).AutoFit
      EndStrTable = EndStrTable + 1             ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

      ListNum = ListNum + 1
      InsHeaderOfList_2014 (FirstPageStr), (RowEndS), (ListNum)

      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If RowPrevHeight < Rows(FirstPageStr - 1).RowHeight Then
        Rows(FirstPageStr - 1).RowHeight = RowPrevHeight
      End If

      ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Font.Size = 7 |fffd| InsHeaderOfList_2014 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(FirstPageStr, 1)
      Excel.ActiveWindow.View = xlPageBreakPreview
      PageCount = ActiveSheet.HPageBreaks.Count
      Page_Curr = Page_Curr + 1
      FirstStrPreviousPage = FirstPageStr
    Loop

    If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0) And ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 35) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 42) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 44) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 53) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 36) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 45) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 54)) Then  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2014
      FirstPageStr = MergeCellsForGTD(FirstStrPreviousPage - 0, EndStrTable - 0, EndStrTable - 0) - 1 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
      
    If (GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") <> 0) And ((GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 36) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 45) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 54) Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 55)) Then ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2017
      FirstPageStr = EraseLineForGTDAndTNVED(FirstStrPreviousPage - 0, EndStrTable - 0) - 1 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    End If

    Worksheets("Gal_VarSheet").Range("C100").Value = ListNum  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  
  End If
  
  ActiveWindow.Zoom = 120

  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Cells(BegStrTable, 2).Select
End Sub

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| EndTable - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub InsRowsRF(EndTable As Long)
Dim i, i1, i2, j, n, r, x, List, k, k1, r1, x1 As Long
Dim bNew As Boolean
'n - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'j - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'r - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'x - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'list - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'k  - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'r1 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

List = GetDBVar("GalDBVar_1|fffd||fffd||fffd||fffd|")
x = 15
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
  bNew = GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 40 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 51 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52
Else
  bNew = GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 35)
End If
If bNew And GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
  k = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") - 1
  k1 = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Else
  k = 0
  k1 = 1
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
  i1 = 13
  i2 = 21
Else
  i1 = 10
  i2 = 18
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 35 Then x = k + 21
j = 1
Excel.ActiveWindow.View = xlPageBreakPreview
n = ActiveSheet.HPageBreaks.Count

r1 = 0
If bNew And k > 0 And n > 0 Then
  r1 = ActiveSheet.HPageBreaks(j).Location.Row
  If (k + 15) >= r1 Then
    j = j + 1
    k = k - (r1 - 15)
  Else
   If x > r1 Then
     ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(k + 15, 14)
     Excel.ActiveWindow.View = xlPageBreakPreview
     n = ActiveSheet.HPageBreaks.Count
     j = j + 1
   End If
   k = 0
  End If
End If

While j <= n
 If EndTable >= ActiveSheet.HPageBreaks(j).Location.Row Then
  r = ActiveSheet.HPageBreaks(j).Location.Row
  If k > 0 And (k + r1) >= r Then
    k = k - (r - r1)
    r1 = r
  Else
    If k > 0 And (k + 6) > (r - r1) Then
      ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(r1 + k, 14)
      Excel.ActiveWindow.View = xlPageBreakPreview
      n = ActiveSheet.HPageBreaks.Count
    Else
      '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd|)
      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 Then
        If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34) Then
          x1 = (r - 1)
        Else
          x1 = (r - 2) '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        End If
        MergeCellsGTD (x), (x1)
      End If

      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 33 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 32 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 34 Then
        Rows(r - 1).Insert Shift:=xlDown                 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(r - 1, 2).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| " + Str(List)
        Rows(r - 1).RowHeight = 12

        If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
          If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 32 Then
            Range(Cells(r - 1, 2), Cells(r - 1, 9)).Select
          Else
            Range(Cells(r - 1, 2), Cells(r - 1, 8)).Select
          End If
        Else
          If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 31 Then
            Range(Cells(r - 1, 2), Cells(r - 1, 8)).Select
          Else
            Range(Cells(r - 1, 2), Cells(r - 1, 10)).Select
          End If
        End If

        Selection.Borders(xlInsideVertical).LineStyle = xlNone
        Selection.WrapText = False

        If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 31 Then
            For i = 9 To 15 Step 1
              Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            Next i
          Else
            For i = i1 To i2 Step 1
              Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
              If Cells(r - 1, i).Value = 0 And i <> 13 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 31 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33) Then
                Cells(r - 1, i).Value = "-"
              End If
            Next i
          End If
        Else
          If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 31 Then
            For i = 9 To 14 Step 1
              Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
            Next i
          Else
            For i = i1 To i2 Step 1
              Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
              If Cells(r - 1, i).Value = 0 And i <> 13 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 31 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33) Then
                Cells(r - 1, i).Value = "-"
              End If
            Next i
          End If
        End If
      End If

      Rows(r).Insert Shift:=xlDown       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2-|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Rows(r + 1).Insert Shift:=xlDown

      Range(Cells(r, 2), Cells(r + 1, i2 + 1)).Select
      Selection.WrapText = False
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlEdgeLeft).LineStyle = xlNone
      Selection.Font.Size = 7

      Cells(r, 2).Value = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1")

      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
        Cells(r, 2).Characters(Start:=27, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=42, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=58, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle
      Else
        Cells(r, 2).Characters(Start:=38, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=53, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=69, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle
      End If

      List = List + 1
      Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd|")
       Case 29, 30
         If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
           Cells(r, 14).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
           Cells(r, 15).Borders(xlEdgeBottom).LineStyle = xlContinuous
         Else
           Cells(r, 13).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
           Cells(r, 14).Borders(xlEdgeBottom).LineStyle = xlContinuous
         End If
       Case 31, 33
         Cells(r, 17).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 17).HorizontalAlignment = xlRight
         Cells(r, 18).Borders(xlEdgeBottom).LineStyle = xlContinuous
       Case 32
         Cells(r, 15).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 18).Borders(xlEdgeBottom).LineStyle = xlContinuous
       Case 34
         Cells(r, 20).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 21).Borders(xlEdgeBottom).LineStyle = xlContinuous
       End Select
      Rows(r).Font.Bold = False

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 35 Then
        Range(Rows(k1 + 19), Rows(k1 + 19)).Copy
      Else
        Range(Rows(14), Rows(14)).Copy
      End If
      Rows(r + 2).Insert Shift:=xlDown

      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(r, 14)
      Excel.ActiveWindow.View = xlPageBreakPreview
      n = ActiveSheet.HPageBreaks.Count
      x = r + 3      '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

      Range(Cells(r - 1, 2), Cells(r - 1, i2)).Select
      Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 33 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 32 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 34 Then
        EndTable = EndTable + 4  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 4 |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
      Else
        EndTable = EndTable + 3  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 3 |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
      End If
    End If
    k = 0
  End If
 End If
 j = j + 1
Wend

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
r = EndTable - 1
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd|)
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
  If (GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 And (r - 1 - x) <= 0) Then
    x1 = (r - 1)
  Else
    x1 = (r - 2) '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  End If
  MergeCellsGTD (x), (x1)
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 33 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 32 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 34 And (r - 1 - x) > 0 Then
  Rows(r - 1).Insert Shift:=xlDown                 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Cells(r - 1, 2).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| " + Str(List)
   Rows(r - 1).RowHeight = 12

  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 32 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 34 Then
      Range(Cells(r - 1, 2), Cells(r - 1, 9)).Select
    Else
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Then
        Range(Cells(r - 1, 2), Cells(r - 1, 12)).Select
      Else
        Range(Cells(r - 1, 2), Cells(r - 1, 8)).Select
      End If
    End If
  Else
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 31 Then
      Range(Cells(r - 1, 2), Cells(r - 1, 8)).Select
    Else
      Range(Cells(r - 1, 2), Cells(r - 1, i1)).Select
    End If
  End If

  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.WrapText = False

  If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 31 Then
      For i = 9 To 15 Step 1
       Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
      Next i
    Else
      For i = i1 To i2 Step 1
       Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
       If Cells(r - 1, i).Value = 0 And i <> 13 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 31 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33) Then
         Cells(r - 1, i).Value = "-"
       End If
      Next i
    End If
  Else
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 31 Then
      For i = 9 To 14 Step 1
       Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
      Next i
    Else
      For i = i1 To i2 Step 1
       Cells(r - 1, i).FormulaR1C1 = "=SUM(R[" + Str(-(r - 1 - x)) + "]C:R[-1]C)"
       If Cells(r - 1, i).Value = 0 And i <> 13 And (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 31 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 32 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33) Then
         Cells(r - 1, i).Value = "-"
       End If
      Next i
    End If
  End If
End If
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 33 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 32 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 34 And (r - 1 - x) > 0 Then
 Range(Cells(r, 2), Cells(r, 18)).Select
 Selection.Borders(xlInsideVertical).LineStyle = xlNone
 Selection.ClearContents
Else
 Range(Cells(r - 1, 2), Cells(r - 1, i2)).Select
 Selection.Borders(xlInsideVertical).LineStyle = xlNone
 Selection.ClearContents
End If

If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
  Worksheets("Gal_VarSheet").Range("C100").Value = List
End If
End Sub
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| EndTable - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub InsRowsSvodRF(EndTable As Long)
Dim i, i1, i2, j, n, r, List, k, k1, r1, x1, x2  As Long
Dim bNew As Boolean

i = 15
List = GetDBVar("GalDBVar_1|fffd||fffd||fffd||fffd|")
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
  bNew = GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 33 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 40 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 51 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52
Else
  bNew = GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Or (GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 30 And GetDBVar("GalDBVar_|fffd||fffd||fffd|") < 35)
End If
If bNew And GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
  k = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") - 1
  k1 = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Else
  k = 0
  k1 = 1
End If
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Then i = k + 21
j = 1
Excel.ActiveWindow.View = xlPageBreakPreview
n = ActiveSheet.HPageBreaks.Count

r1 = 0
If bNew And k > 0 And n > 0 Then
  r1 = ActiveSheet.HPageBreaks(j).Location.Row
  If (k + 15) >= r1 Then
    j = j + 1
    k = k - (r1 - 15)
  Else
   If (k + 21) > r1 Then
     ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(k + 15, 14)
     Excel.ActiveWindow.View = xlPageBreakPreview
     n = ActiveSheet.HPageBreaks.Count
     j = j + 1
   End If
   k = 0
  End If
End If
x1 = i + 1

While j <= n
If EndTable >= ActiveSheet.HPageBreaks(j).Location.Row Then
  r = ActiveSheet.HPageBreaks(j).Location.Row
  If k > 0 And (k + r1) >= r Then
    k = k - (r - r1)
    r1 = r
  Else
    If k > 0 And (k + 6) > (r - r1) Then
      ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=Cells(r1 + k, 14)
      Excel.ActiveWindow.View = xlPageBreakPreview
      n = ActiveSheet.HPageBreaks.Count
    Else
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd|)
      If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
        If r <= EndTable Then
          x2 = r - 2 '|fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd| (r - 1) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|), |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| (r - 2)
        Else
          x2 = EndTable
        End If
        MergeCellsGTD (x1), (x2)
      End If

      Rows(r - 1).Insert Shift:=xlDown  '- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Rows(r).Insert Shift:=xlDown
      Rows(r + 1).Insert Shift:=xlDown

      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
        Range(Cells(r - 1, 1), Cells(r + 1, 22)).Select
      Else
        Range(Cells(r - 1, 1), Cells(r + 1, 19)).Select
      End If
      Selection.WrapText = False
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
      Selection.Font.Size = 7

      Range(Cells(r, 2), Cells(r, 12)).Select
      Selection.Merge
      Selection.WrapText = True

      Cells(r, 2).Value = GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1")
      If Len(Cells(r, 2)) > 100 Then Rows(r).RowHeight = Rows(r).RowHeight + 12
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") <> 51 Then
        Cells(r, 2).Characters(Start:=49, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=64, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=80, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle
      Else
        Cells(r, 2).Characters(Start:=50, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=65, Length:=10).Font.Underline = xlUnderlineStyleSingle
        Cells(r, 2).Characters(Start:=81, Length:=Len(GetDBVar("GalDBVar_|fffd||fffd||fffd|"))).Font.Underline = xlUnderlineStyleSingle
      End If

      List = List + 1
      Select Case GetDBVar("GalDBVar_|fffd||fffd||fffd|")
       Case 37
         If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 1 Then
           Cells(r, 14).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
           Cells(r, 15).Borders(xlEdgeBottom).LineStyle = xlContinuous
         Else
           Cells(r, 13).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
           Cells(r, 14).Borders(xlEdgeBottom).LineStyle = xlContinuous
         End If
       Case 38, 40
         Cells(r, 17).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 17).HorizontalAlignment = xlRight
         Cells(r, 18).Borders(xlEdgeBottom).LineStyle = xlContinuous
       Case 39
         Cells(r, 15).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 18).Borders(xlEdgeBottom).LineStyle = xlContinuous
       Case 41
         Cells(r, 20).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 21).Borders(xlEdgeBottom).LineStyle = xlContinuous
       Case 52
         Cells(r, 20).Value = "|fffd||fffd||fffd||fffd|   " + Str(List) + "   |fffd||fffd|"
         Cells(r, 20).HorizontalAlignment = xlRight
         Cells(r, 21).Borders(xlEdgeBottom).LineStyle = xlContinuous
      End Select

      Rows(r).Font.Bold = False
      Range(Rows(14), Rows(14)).Copy
      If GetDBVar("GalDBVar_|fffd||fffd||fffd|") > 37 Then Range(Rows(k1 + 19), Rows(k1 + 19)).Copy
      Rows(r + 2).Insert Shift:=xlDown
      Excel.ActiveWindow.View = xlPageBreakPreview
      n = ActiveSheet.HPageBreaks.Count

      If ActiveSheet.HPageBreaks(j).Location.Row > r Then
        While ActiveSheet.HPageBreaks(j).Location.Row > r
          Rows(r).Insert Shift:=xlDown
          r = r + 1
          Excel.ActiveWindow.View = xlPageBreakPreview
          n = ActiveSheet.HPageBreaks.Count
          EndTable = EndTable + 1
        Wend
      End If
      x1 = r + 3      '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      EndTable = EndTable + 4
    End If
    k = 0
  End If
End If
j = j + 1
Wend

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd|) |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 And r > 0 Then
  x1 = r + 3
  x2 = EndTable - 2
  MergeCellsGTD (x1), (x2)
End If

' |fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
  Worksheets("Gal_VarSheet").Range("C100").Value = List
End If

End Sub

Sub MergeCellsGTD(begRowInPage As Long, endRowInPage As Long)
Dim g, g1, g2, kol_g, i, s1, s2, n As Long
Dim b As Boolean

'g1 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'g2 - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'n - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
's1, s2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

  g = begRowInPage
  g1 = 0
  kol_g = 0

  If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
    n = 12
    s1 = 13
    s2 = 21
  Else
    n = 9
    s1 = 10
    s2 = 18
  End If

  While (g <= endRowInPage)
    If GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 34 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 41 Or GetDBVar("GalDBVar_|fffd||fffd||fffd|") = 52 Then
      b = Cells(g, 7).Value = "" And Cells(g, 9).Value = "" And Cells(g, 10).Value = ""
    Else
      b = Cells(g, 4).Value = "" And Cells(g, 6).Value = "" And Cells(g, 7).Value = ""
    End If

    If b And Cells(g, n).Value <> "" And Cells(g, n + 1).Value = "" Then
      kol_g = kol_g + 1
      If (kol_g = 1) Then
        g1 = g
      End If
      If (g = endRowInPage And g1 > 0) Then
        g2 = g1 + kol_g - 1
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
        For i = 2 To (n - 1) Step 1
          Range(Cells(g1, i), Cells(g2, i)).Select
          Selection.WrapText = False
          Selection.Merge
        Next i

        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
        For i = s1 To s2 Step 1
           Range(Cells(g1, i), Cells(g2, i)).Select
           Selection.WrapText = False
           Selection.Merge
        Next i

        '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
        If g1 > begRowInPage Then
          For i = 2 To s2 Step 1
            Cells(g1 - 1, i).Borders(xlEdgeBottom).LineStyle = xlNone
          Next i
        End If
        For i = g1 To (g2 - 1) Step 1
          Cells(i, n).Borders(xlEdgeBottom).LineStyle = xlNone
        Next i
        g1 = 0
        kol_g = 0
      End If
    Else
      If (g1 > 0) Then
        g2 = g1 + kol_g - 1
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
        For i = 2 To (n - 1) Step 1
          Range(Cells(g1, i), Cells(g2, i)).Select
          Selection.WrapText = False
          Selection.Merge
        Next i

        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
        For i = s1 To s2 Step 1
          Range(Cells(g1, i), Cells(g2, i)).Select
          Selection.WrapText = False
          Selection.Merge
        Next i

        '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
        If g1 > begRowInPage Then
          For i = 2 To (n - 1) Step 1
            Cells(g1 - 1, i).Borders(xlEdgeBottom).LineStyle = xlNone
          Next i
        End If
        For i = g1 To (g2 - 1) Step 1
          Cells(i, n).Borders(xlEdgeBottom).LineStyle = xlNone
        Next i
        g1 = 0
        kol_g = 0
     End If
   End If
   g = g + 1
 Wend

End Sub

Sub AutoFitMergedCellRowHeight(ByRef ra As Range)
    Dim CurrCell As Range, cell As Range, ma As Range
    Dim col As Range, ro As Range
    Dim maxRH, rh, cw, newCW As Double

    For Each ro In ra.Rows
        maxRH = 0
        For Each cell In ro.Cells
            If cell.MergeCells And cell.Address = cell.MergeArea.Cells(1).Address Then
                Debug.Print cell.Address
                Set ma = cell.MergeArea: newCW = 0
                With ma
                    cw = .Columns(1).ColumnWidth: .UnMerge
                    For Each col In .EntireColumn: newCW = newCW + col.ColumnWidth: Next
                    .Columns(1).ColumnWidth = newCW: .EntireRow.AutoFit
                    rh = .EntireRow.RowHeight: If rh > maxRH Then maxRH = rh
                    .Merge: .Columns(1).ColumnWidth = cw
                End With
            End If
        Next cell
        If maxRH > 0 Then ro.EntireRow.RowHeight = maxRH
    Next ro
End Sub

Sub EditFilterRep()
Dim BegStrTable, EndStrTable, i As Long

  BegStrTable = 6
  EndStrTable = BegStrTable + GetDBVar("GalDBVar_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") - 1

  For i = BegStrTable To EndStrTable - 1 Step 1
    If Cells(i + 1, 1).Value = "" Then
      Range(Cells(i, 1), Cells(i + 1, 1)).Select
      Selection.WrapText = False
      Selection.Merge
      Selection.HorizontalAlignment = xlLeft
    End If
  Next i

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' )^J)

INQUEST-PP=macro
