Attribute VB_Name = "DateForm"
Attribute VB_Base = "0{ABF58261-2DE9-47BE-90F7-E0CD7FAE794F}{312BA896-50C5-4484-80C6-C29C824A182B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Sub Calendar0_DblClick()
  Cells(1, 2).Value = Calendar0.Value
  StartDate.Value = Format(Cells(1, 2).Value, "dd/mm/yyyy")
  Calendar0.Visible = False
End Sub

Sub Calendar1_DblClick()
  FirstPayDay.Value = Format(Calendar1.Value, "dd/mm/yyyy")
  Calendar1.Visible = False
End Sub

Private Sub Calendar0Btn_Click()
  Calendar0.Visible = True
  Calendar0.SetFocus
End Sub

Private Sub Calendar1Btn_Click()
  Calendar1.Visible = True
  Calendar1.SetFocus
End Sub

Sub Calendar0_KeyPress(KeyAscii As Integer)
  If (KeyAscii = 27) Then
    Calendar0.Visible = False
  End If
End Sub

Sub Calendar1_KeyPress(KeyAscii As Integer)
  If (KeyAscii = 27) Then
    Calendar1.Visible = False
  End If
End Sub

Private Sub StartDate_AfterUpdate()
  Calendar0.Value = Format(StartDate.Value, "dd/mm/yyyy")
  Cells(1, 2).Value = Calendar0.Value
End Sub

Private Sub FirstPayDay_AfterUpdate()
  Calendar1.Value = Format(FirstPayDay.Value, "dd/mm/yyyy")
End Sub

Private Sub LoanSum_AfterUpdate()
  LoanSum.Value = Format(LoanSum.Value, "##,##0.00")
  Cells(3, 2).Value = LoanSum.Value
End Sub

Private Sub LoanRate_AfterUpdate()
  LoanRate.Value = Format(LoanRate.Value, "0.00%")
  Cells(4, 2).Value = LoanRate.Value
End Sub

Private Sub DoitBtn_Click()
Dim nPeriod As Integer
Dim dStart As Date
Dim nCreditSum As Double
Dim nRate As Double
Dim nDisbFee As Double
  
  DateForm.Hide
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Cells(7, 7).Value = 0
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Cells(7, 11).Value = 0
  '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Cells(7, 8).Value = 0
  ActiveSheet.Cells(7, 10).Value = 0
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'B1 (  1,  2) - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  dStart = ActiveSheet.Cells(1, 2).Value
  'B2 (  2,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(2, 2).Value
  'B3 (  3,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(3, 2).Value
  'B4 (  4,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  nRate = ActiveSheet.Cells(4, 2).Value
  'B5 (  5,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nDisbFee = ActiveSheet.Cells(5, 2).Value
  
  Call doDateFill(nPeriod, dStart, Calendar1.Value, nCreditSum, nRate, nDisbFee, 10)

End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Module1"
'-----------------------------------------------------------------------------------------
'|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ->
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'-----------------------------------------------------------------------------------------
'|   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|   | |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |
'|---------------------+---------------------|
'|   If                |    |fffd||fffd||fffd||fffd|             |
'|   Sign              |    |fffd||fffd||fffd||fffd|             |
'|   Mod               |    |fffd||fffd||fffd||fffd||fffd|            |
'|   Year              |    |fffd||fffd||fffd|              |
'|   EOMONTH           |    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|        |
'|   XIRR              |    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|        |
'|---------------------+---------------------|
'

Public Function checkSysReq() As Boolean
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|c|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim bReturn As Boolean
Dim nResponse As Integer

  bReturn = True
  'If AddIns("Analysis ToolPak").Installed = False Then
  '  nResponse = MsgBox("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (add-ins):" + Chr(10) + "Analysis ToolPak" + Chr(10) + Chr(10) + _
   '                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbExclamation + vbMsgBoxHelpButton, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
    '                   "xlmain11.chm::/html/xldecUseAddinComponentsOfMicrosoftExcel1.htm#", 0)
    'bReturn = False
  'End If
  'If AddIns("Analysis ToolPak - VBA").Installed = False Then
   ' nResponse = MsgBox("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (add-ins):" + Chr(10) + "Analysis ToolPak - VBA" + Chr(10) + Chr(10) + _
    '                 "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbExclamation + vbMsgBoxHelpButton, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
     '                "xlmain11.chm::/html/xldecUseAddinComponentsOfMicrosoftExcel1.htm#", 0)
    'bReturn = False
  'End If
  checkSysReq = bReturn
End Function


Public Sub doDateFill(nPeriod As Integer, dStart As Date, dFirst As Date, nCreditSum As Double, nRate As Double, nDisbFee As Double, nShift As Integer)
Attribute doDateFill.VB_Description = "Macro recorded 18/04/2007 by Koprov Alexander"
Attribute doDateFill.VB_ProcData.VB_Invoke_Func = " \n14"
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| B, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| nShift)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
' nPeriod    - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' dStart     - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' dFirst     - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
' nCreditSum - |fffd||fffd||fffd||fffd||fffd|
' nRate      - |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'
Dim k As Integer
Dim n As Integer
Dim dCur As Date
Dim nMod As Integer

'begin
  
  If (checkSysReq() = True) Then
  
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'ActiveSheet.Range("A" + Trim(Str(nShift)) + ":K512").Select
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Range("A" + Trim(Str(nShift)) + ":M512").Select
    Selection.ClearContents
    With Selection.Borders
      .LineStyle = xlNone
    End With
    
    Cells(10, 1).Value = 0
    Cells(10, 2).Value = Cells(1, 2).Value
    Cells(10, 3).Value = 0
    
    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells(7, 8).Value = 0
    
    nMod = 0
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 14).Value = True) Then
      nMod = nMod + 1
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 15).Value = True) Then
      nMod = nMod + 2
    End If
    
    For k = 0 To nPeriod
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(nShift + k, 1).Value = k
      
      If (k = 0) Then
        Cells(nShift + k, 2).Value = dStart
        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=SUM(RC[-2]:RC[-2])"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        'ActiveSheet.Cells(nShift + k, 12).Value = Round(nDisbFee * nCreditSum, 2)
        'ActiveSheet.Cells(nShift + k, 12).Value = "=ROUND(R[-7]C[-10]*R[-5]C[-10], 2)"
        
      Else
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        'dCur = DateSerial(Year(Cells(nShift + k - 1, 2).Value), Month(Cells(nShift + k - 1, 2).Value) + 1, Day(Cells(nShift + k - 1, 2).Value))
        dCur = DateSerial(Year(dFirst), Month(dFirst) + k - 1, Day(dFirst))
        
        If (k = nPeriod) Then
          If (ActiveSheet.Cells(1, 16).Value = True) Then
            n = 0
            dCur = DateSerial(Year(dStart), Month(dStart) + k, Day(dStart))
            While (dCur <= DateSerial(Year(dFirst), Month(dFirst) + k - 2, Day(dFirst)))
              n = n + 1
              dCur = DateSerial(Year(dStart), Month(dStart) + k + n, Day(dStart))
            Wend
            
          End If
        End If
        
        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        dCur = GetWrkDate(dCur, nMod)
        'If (Weekday(dCur) = vbSunday) Then
        '  dCur = dCur + 1
        'ElseIf (Weekday(dCur) = vbSaturday) Then
        '  dCur = dCur + 2
        'End If
        Cells(nShift + k, 2).Value = dCur
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 3).Select
        ActiveCell.FormulaR1C1 = "=RC[-1]-R[-1]C[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 4).Select
        ActiveCell.FormulaR1C1 = _
          "=IF(SIGN(MOD(YEAR(RC[-2]),4))=SIGN(MOD(YEAR(R[-1]C[-2]),4)),IF(SIGN(MOD(YEAR(RC[-2]),4))=0,0,RC[-1]),IF(SIGN(MOD(YEAR(RC[-2]),4))=1,RC[-2]-EOMONTH(RC[-2],-1), RC[-1] - (RC[-2]-EOMONTH(RC[-2],-1))))"
        Cells(nShift + k, 5).Select
        ActiveCell.FormulaR1C1 = "=RC[-2]-RC[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 6).Select
        ActiveCell.FormulaR1C1 = "=RC[-2]*R[" + Trim(Str(4 - k - nShift)) + "]C[-4]/365 + RC[-1]*R[" + Trim(Str(4 - k - nShift)) + "]C[-4]/366"
          
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
        'Cells(nShift + k, 8).Select
        'ActiveCell.FormulaR1C1 = "=R[" + Trim(Str(7 - k - nShift)) + "]C-RC[-1]"
          
        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=SUM(R[-" + Trim(Str(k)) + "]C[-2]:RC[-2])"
        ActiveSheet.Cells(nShift + k, 11).FormulaR1C1 = "=RC[-5]*R[-1]C[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If IsEmpty(ActiveSheet.Cells(nShift + k, 12).Value) Then
          ActiveSheet.Cells(nShift + k, 12).Value = 0
        End If
      End If
      '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(nShift + k, 10).FormulaR1C1 = "=R[" + Trim(Str(3 - k - nShift)) + "]C[" + Trim(Str(2 - nShift)) + "]-RC[-1]"
      
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(nShift + k, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
      
    Next k
    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(4, 12).FormulaR1C1 = "=SUM(R[" + Trim(Str(nShift - 4)) + "]C:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C)"
    
    ActiveSheet.Range("A" + Trim(Str(nShift - 1)) + ":M" + Trim(Str(nShift + nPeriod + 1))).Select
    With Selection.Borders
      .LineStyle = xlContinuous
      .Weight = xlHairline
    End With
  End If
  ActiveSheet.Cells(7, 8).Select
End Sub


Public Sub doDateFillNew(nPeriod As Integer, dStart As Date, dFirst As Date, nCreditSum As Double, nRate As Double, nDisbFee As Double, nShift As Integer)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| B, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| nShift)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
' nPeriod    - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' dStart     - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' dFirst     - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
' nCreditSum - |fffd||fffd||fffd||fffd||fffd|
' nRate      - |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'
Dim k As Integer
Dim n As Integer
Dim dCur As Date
Dim nMod As Integer

'begin
  
  If (checkSysReq() = True) Then
  
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveSheet.Range("C1").Activate
    ActiveCell.CurrentRegion.Borders.LineStyle = False
    ActiveCell.CurrentRegion.Activate
    
    'ActiveSheet.Range("A" + Trim(Str(3)) + ":F512").Select
    Selection.ClearContents
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
   
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'ActiveSheet.Range("A" + Trim(Str(nShift)) + ":K512").Select
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Range("A" + Trim(Str(nShift)) + ":O512").Select
    Selection.ClearContents
    With Selection.Borders
      .LineStyle = xlNone
    End With
    
    Cells(10, 1).Value = 0
    
    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 2).Value = "" Then
    
        Cells(10, 2).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(4, 2).Value
    
    Else
        
        Cells(10, 2).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 2).Value
    
    End If
    
    Cells(10, 3).Value = 0
    
    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells(7, 8).Value = 0
    
    nMod = 0
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 14).Value = True) Then
      nMod = nMod + 1
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 15).Value = True) Then
      nMod = nMod + 2
    End If
    
    For k = 0 To nPeriod
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(nShift + k, 1).Value = k
      
      If (k = 0) Then
        Cells(nShift + k, 2).Value = dStart
        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=SUM(RC[-2]:RC[-2])"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        'ActiveSheet.Cells(nShift + k, 12).Value = Round(nDisbFee * nCreditSum, 2)
        'ActiveSheet.Cells(nShift + k, 12).Value = "=ROUND(R[-7]C[-10]*R[-5]C[-10], 2)"
        
      Else
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        'dCur = DateSerial(Year(Cells(nShift + k - 1, 2).Value), Month(Cells(nShift + k - 1, 2).Value) + 1, Day(Cells(nShift + k - 1, 2).Value))
        dCur = DateSerial(Year(dFirst), Month(dFirst) + k - 1, Day(dFirst))
        
        If (k = nPeriod) Then
          If (ActiveSheet.Cells(1, 16).Value = True) Then
            n = 0
            dCur = DateSerial(Year(dStart), Month(dStart) + k, Day(dStart))
            While (dCur <= DateSerial(Year(dFirst), Month(dFirst) + k - 2, Day(dFirst)))
              n = n + 1
              dCur = DateSerial(Year(dStart), Month(dStart) + k + n, Day(dStart))
            Wend
            
          End If
        End If
        
        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        dCur = GetWrkDate(dCur, nMod)
        'If (Weekday(dCur) = vbSunday) Then
        '  dCur = dCur + 1
        'ElseIf (Weekday(dCur) = vbSaturday) Then
        '  dCur = dCur + 2
        'End If
        
        Cells(nShift + k, 2).NumberFormat = "dd.mm.yyyy"
        Cells(nShift + k, 2).Value = dCur
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 3).Select
        ActiveCell.FormulaR1C1 = "=RC[-1]-R[-1]C[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 4).Select
        ActiveCell.FormulaR1C1 = _
          "=IF(SIGN(MOD(YEAR(RC[-2]),4))=SIGN(MOD(YEAR(R[-1]C[-2]),4)),IF(SIGN(MOD(YEAR(RC[-2]),4))=0,0,RC[-1]),IF(SIGN(MOD(YEAR(RC[-2]),4))=1,RC[-2]-EOMONTH(RC[-2],-1), RC[-1] - (RC[-2]-EOMONTH(RC[-2],-1))))"
        Cells(nShift + k, 5).Select
        ActiveCell.FormulaR1C1 = "=RC[-2]-RC[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 6).Select
        'ActiveCell.FormulaR1C1 = "=RC[-2]*R[" + Trim(Str(4 - k - nShift)) + "]C[-4]/365 + RC[-1]*R[" + Trim(Str(4 - k - nShift)) + "]C[-4]/366"
        ActiveCell.FormulaR1C1 = "=RC[-2]*" + Trim(Str(nRate)) + "/365 + RC[-1]*" + Trim(Str(nRate)) + "/366"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
        'Cells(nShift + k, 8).Select
        'ActiveCell.FormulaR1C1 = "=R[" + Trim(Str(7 - k - nShift)) + "]C-RC[-1]"
          
        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        'ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=SUM(R[-" + Trim(Str(k)) + "]C[-2]:RC[-2])"
        ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=R[-1]C[0]+RC[-2]"
        ActiveSheet.Cells(nShift + k, 11).FormulaR1C1 = "=RC[-5]*R[-1]C[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If IsEmpty(ActiveSheet.Cells(nShift + k, 12).Value) Then
          ActiveSheet.Cells(nShift + k, 12).Value = 0
        End If
      End If
      
      
      '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      'ActiveSheet.Cells(nShift + k, 10).FormulaR1C1 = "=R[" + Trim(Str(2 - k - nShift)) + "]C[" + Trim(Str(2 - nShift)) + "]-RC[-1]"
      ActiveSheet.Cells(nShift + k, 10).FormulaR1C1 = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + "-RC[-1]"
      
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(nShift + k, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
      
      '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| + 1)
      ActiveSheet.Cells(nShift + k, 14).FormulaR1C1 = "=R[0]C[-8]+1"
      
    Next k
    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    ActiveSheet.Range("A" + Trim(Str(nShift - 1)) + ":M" + Trim(Str(nShift + nPeriod + 1))).Select
    With Selection.Borders
      .LineStyle = xlContinuous
      .Weight = xlHairline
    End With
  End If
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
End Sub



Public Sub doDateFillNext(checkList As Boolean, nPeriod As Integer, dStart As Date, dFirst As Date, nCreditSum As Double, nRate As Double, nDisbFee As Double, nShift As Integer)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| B, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| nShift)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
' nPeriod    - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' dStart     - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' dFirst     - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
' nCreditSum - |fffd||fffd||fffd||fffd||fffd|
' nRate      - |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'
Dim k As Integer
Dim n As Integer
Dim dCur As Date
Dim nMod As Integer

'begin
  
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
  
    nMod = 0
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 14).Value = True) Then
      nMod = nMod + 1
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 15).Value = True) Then
      nMod = nMod + 2
    End If
    
    For k = 1 To nPeriod
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(nShift + k, 1).Value = Cells(nShift + k - 1, 1).Value + 1
      
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        'dCur = DateSerial(Year(Cells(nShift + k - 1, 2).Value), Month(Cells(nShift + k - 1, 2).Value) + 1, Day(Cells(nShift + k - 1, 2).Value))
        dCur = DateSerial(Year(dFirst), Month(dFirst) + k, Day(dFirst))
        
        If (k = nPeriod) Then
          If (ActiveSheet.Cells(1, 16).Value = True) Then
            n = 0
            dCur = DateSerial(Year(dStart), Month(dStart) + k, Day(dStart))
            While (dCur <= DateSerial(Year(dFirst), Month(dFirst) + k - 2, Day(dFirst)))
              n = n + 1
              dCur = DateSerial(Year(dStart), Month(dStart) + k + n, Day(dStart))
            Wend
            
          End If
        End If
        
        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        dCur = GetWrkDate(dCur, nMod)
        'If (Weekday(dCur) = vbSunday) Then
        '  dCur = dCur + 1
        'ElseIf (Weekday(dCur) = vbSaturday) Then
        '  dCur = dCur + 2
        'End If
        
        Cells(nShift + k, 2).NumberFormat = "dd.mm.yyyy"
        Cells(nShift + k, 2).Value = dCur
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 3).Select
        ActiveCell.FormulaR1C1 = "=RC[-1]-R[-1]C[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 4).Select
        ActiveCell.FormulaR1C1 = _
          "=IF(SIGN(MOD(YEAR(RC[-2]),4))=SIGN(MOD(YEAR(R[-1]C[-2]),4)),IF(SIGN(MOD(YEAR(RC[-2]),4))=0,0,RC[-1]),IF(SIGN(MOD(YEAR(RC[-2]),4))=1,RC[-2]-EOMONTH(RC[-2],-1), RC[-1] - (RC[-2]-EOMONTH(RC[-2],-1))))"
        Cells(nShift + k, 5).Select
        ActiveCell.FormulaR1C1 = "=RC[-2]-RC[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(nShift + k, 6).Select
        'ActiveCell.FormulaR1C1 = "=RC[-2]*R[" + Trim(Str(4 - k - nShift)) + "]C[-4]/365 + RC[-1]*R[" + Trim(Str(4 - k - nShift)) + "]C[-4]/366"
        ActiveCell.FormulaR1C1 = "=RC[-2]*" + Trim(Str(nRate)) + "/365 + RC[-1]*" + Trim(Str(nRate)) + "/366"
          
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
        'Cells(nShift + k, 8).Select
        'ActiveCell.FormulaR1C1 = "=R[" + Trim(Str(7 - k - nShift)) + "]C-RC[-1]"
          
        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        'ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=R[-" + Trim(Str(k)) + "]C[-2]+RC[-2])"
        ActiveSheet.Cells(nShift + k, 9).FormulaR1C1 = "=R[-1]C[0]+RC[-2]"
        ActiveSheet.Cells(nShift + k, 11).FormulaR1C1 = "=RC[-5]*R[-1]C[-1]"
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If IsEmpty(ActiveSheet.Cells(nShift + k, 12).Value) Then
          ActiveSheet.Cells(nShift + k, 12).Value = 0
        End If

      '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      'ActiveSheet.Cells(nShift + k, 10).FormulaR1C1 = "=R[" + Trim(Str(3 - k - nShift)) + "]C[" + Trim(Str(2 - nShift)) + "]-RC[-1]"
      ActiveSheet.Cells(nShift + k, 10).FormulaR1C1 = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + "-RC[-1]"
      
      '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(nShift + k, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
      
     '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| + 1)
      ActiveSheet.Cells(nShift + k, 14).FormulaR1C1 = "=R[0]C[-8]+1"

      
    Next k
        
    ActiveSheet.Range("A" + Trim(Str(nShift - 1)) + ":M" + Trim(Str(nShift + nPeriod + 1))).Select
    With Selection.Borders
      .LineStyle = xlContinuous
      .Weight = xlHairline
    End With
  
    ActiveSheet.Range("A1").Select
        
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
   
End Sub


Public Sub reCalcPaymnt(nPeriod As Integer, nCreditSum As Double, nRate As Double, bIncFee As Boolean, nShift As Integer)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| A = Qi + Pi, S = SUM(Qi), Pi = Ki * SKi = Ki * (S - SUM(Qi))
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim nA  As Double    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim nSK As Double    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| nSK = S - SUM(Qi)
Dim nPrc As Double   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (Pi)
Dim nPay As Double   '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| nPay = SUM(Qi)
Dim nDelta As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim i As Integer, j As Integer

  i = 0
  j = 0
  
  If (nPeriod > 1) Then
    nA = nCreditSum / (nPeriod - 1)
    'nA = (-1) * Pmt(nRate / nPeriod, nPeriod, nCreditSum)
    nDelta = 0.6 * nA ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| nA
    nSK = nCreditSum
    
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (nA |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    While (nA < ActiveSheet.Cells(nShift + 1, 6).Value * nCreditSum)
      nA = 1.1 * nA
    Wend
    
    While (Round(nSK, 2) <> 0)
      nSK = nCreditSum
      nPay = 0
      For i = 1 To nPeriod
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        nPrc = nSK * ActiveSheet.Cells(i + nShift, 6).Value
        ActiveSheet.Cells(i + nShift, 8).Value = Round(nPrc, 2)
        If (bIncFee) Then
          ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
          ActiveSheet.Cells(i + nShift, 7).Value = Round(nA - nPrc, 2) - ActiveSheet.Cells(i + nShift, 12).Value
          ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
          nSK = nSK - nA + nPrc + ActiveSheet.Cells(i + nShift, 12).Value
          ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
          nPay = nPay + Round(nA - nPrc, 2) - ActiveSheet.Cells(i + nShift, 12).Value
        Else
          ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
          ActiveSheet.Cells(i + nShift, 7).Value = Round(nA - nPrc, 2)
          ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
          nSK = nSK - nA + nPrc
          ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
          nPay = nPay + Round(nA - nPrc, 2)
        End If
      Next i
      nA = nA + Sgn(Round(nSK, 2)) * nDelta
      nDelta = nDelta / 2
      j = j + 1
      
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(nShift - 3, 8).Value = Round(nA, 2)
      ' |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(nShift - 3, 7).Value = j
    Wend
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (ActiveSheet.Cells(1, 20).Value = False) Then
      nA = Round(nA, 2)
    Else
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      nA = Round(nA, 0) + (Sgn(Sgn(nA - Round(nA, 0)) - 0.5) + 1) * 0.5
    End If
    
    ActiveSheet.Cells(nShift - 3, 8).Value = nA
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    nPay = 0
    For i = 1 To nPeriod
      nPrc = Round(ActiveSheet.Cells(i + nShift, 6).Value * ActiveSheet.Cells(i - 1 + nShift, 10).Value, 2)
      ActiveSheet.Cells(i + nShift, 8).Value = nPrc
      If (bIncFee) Then
        ActiveSheet.Cells(i + nShift, 7).Value = nA - nPrc - ActiveSheet.Cells(i + nShift, 12).Value
        nPay = nPay + nA - nPrc - ActiveSheet.Cells(i + nShift, 12).Value
      Else
        ActiveSheet.Cells(i + nShift, 7).Value = nA - nPrc
        nPay = nPay + nA - nPrc
      End If
    Next i
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    If (nPay <> nCreditSum) Then
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'      ActiveSheet.Cells(nPeriod + nShift, 7).Value = _
'        ActiveSheet.Cells(nPeriod + nShift, 7).Value + nCreditSum - nPay
'    End If

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (nPay < nCreditSum) Then
     ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| -> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      nA = nA + 0.01
      ActiveSheet.Cells(nShift - 3, 8).Value = nA
      nPay = 0
      For i = 1 To nPeriod
        nPrc = Round(ActiveSheet.Cells(i + nShift, 6).Value * ActiveSheet.Cells(i - 1 + nShift, 10).Value, 2)
        ActiveSheet.Cells(i + nShift, 8).Value = nPrc
        If (bIncFee) Then
          ActiveSheet.Cells(i + nShift, 7).Value = nA - nPrc - ActiveSheet.Cells(i + nShift, 12).Value
          nPay = nPay + nA - nPrc - ActiveSheet.Cells(i + nShift, 12).Value
        Else
          ActiveSheet.Cells(i + nShift, 7).Value = nA - nPrc
          nPay = nPay + nA - nPrc
        End If
      Next i
    End If
    ActiveSheet.Cells(nPeriod + nShift, 7).Value = _
      ActiveSheet.Cells(nPeriod + nShift, 7).Value + nCreditSum - nPay
      
  End If
  
  ActiveSheet.Cells(4, 7).FormulaR1C1 = "=SUM(R[" + Trim(Str(nShift - 4)) + "]C:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C)"
  ActiveSheet.Cells(4, 8).FormulaR1C1 = "=SUM(R[" + Trim(Str(nShift - 4)) + "]C:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C)"
  ActiveSheet.Cells(7, 8).Select
End Sub

Public Sub reCalcEqPaymnt(nPeriod As Integer, nCreditSum As Double, nRate As Double, nShift As Integer)
Dim nPay As Double
Dim nCap As Double
Dim nPrc As Double
Dim nSK As Double
Dim i As Integer

  nSK = nCreditSum
  If (nPeriod > 0) Then
    'nPay = Round(nSK / nPeriod, 2)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    nPay = nSK / nPeriod
    nPay = Round(nPay, 2) + (Sgn(Sgn(nPay - Round(nPay, 2)) - 0.5) + 1) * 0.005

    For i = 1 To (nPeriod - 1)
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
      ActiveSheet.Cells(i + nShift, 7).Value = nPay
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      nPrc = ActiveSheet.Cells(i + nShift, 6).Value * ActiveSheet.Cells(i + nShift - 1, 10).Value
      ActiveSheet.Cells(i + nShift, 8).Value = nPrc
      ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
      nSK = nSK - nPay
    Next i
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(nPeriod + nShift, 7).Value = Round(nSK, 2)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    nPrc = ActiveSheet.Cells(nPeriod + nShift, 7).Value * ActiveSheet.Cells(nPeriod + nShift, 6).Value
    ActiveSheet.Cells(nPeriod + nShift, 8).Value = nPrc
  End If
End Sub

Public Sub reCalcEffRate(nPeriod As Integer, nCreditSum As Double, nRate As Double, nShift As Integer)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim nXirr  As Double '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim nS     As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim nSi    As Double '|fffd||fffd||fffd||fffd||fffd| i-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim nDelta As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Dim nSigma As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Dim nPer   As Integer '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim i As Integer, j As Integer

  i = 0
  j = 0
  k = 0
  
  nXirr = nRate
  nDelta = nRate / 2
  nS = 1
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  While (Round(nS, 2) <> 0 And nDelta > 0.0000005) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'While (Round(nS, 2) <> 0 And Abs(1 - nSigma) > 0.0000005) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    nS = (-1) * nCreditSum + ActiveSheet.Cells(nShift, 12).Value
    For i = 1 To nPeriod
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| i-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      nPer = 0
      For j = 1 To i
        nPer = nPer + ActiveSheet.Cells(j + nShift, 3).Value
      Next j
      
      nSi = ActiveSheet.Cells(i + nShift, 7).Value + ActiveSheet.Cells(i + nShift, 8).Value + ActiveSheet.Cells(i + nShift, 12).Value
      nSi = nSi / ((1 + nXirr) ^ (nPer / 365))
      nS = nS + nSi
    Next i
    
    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    nXirr = nXirr + Sgn(Round(nS, 2)) * nDelta
    nDelta = nDelta / 2
    
    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'nSigma = nS / nCreditSum + 1
    'ActiveSheet.Cells(7, 12).Value = Round(nSigma, 6)
    'nXirr = nXirr * nSigma
    
    k = k + 1
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(7, 11).Value = Round(nXirr, 6)
    '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(7, 10).Value = k
  Wend
  ActiveSheet.Cells(7, 11).Select
End Sub

Public Function RemoveMonday(inDate As Date) As Date
Dim dRes As Date
  If (Weekday(inDate) = vbMonday) Then
    dRes = DateSerial(Year(inDate), Month(inDate), Day(inDate) + 1)
  Else
    dRes = inDate
  End If
  RemoveMonday = dRes
End Function

Public Function GetWrkDate(inDate As Date, inMod As Integer) As Date
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|,
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|.112 |fffd||fffd| |fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim nDay, nMonth, nYear As Integer
Dim nHDays As Integer ' |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim dRes As Date
Dim n As Integer
  
  '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  If (Weekday(inDate) = vbSunday) Then
    dRes = DateSerial(Year(inDate), Month(inDate), Day(inDate) + 1)
  ElseIf (Weekday(inDate) = vbSaturday) Then
    dRes = DateSerial(Year(inDate), Month(inDate), Day(inDate) + 2)
  Else
    dRes = inDate
  End If
  
  If (inMod Mod 2 = 1) Then
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  '28 -> 01, 29 -> 02, 30 -> 03, 31 -> 04
    If (Day(dRes) = 28) Then
      dRes = DateSerial(Year(dRes), Month(dRes) + 1, 1)
    ElseIf (Day(dRes) = 29) Then
      dRes = DateSerial(Year(dRes), Month(dRes) + 1, 2)
    ElseIf (Day(dRes) = 30) Then
      dRes = DateSerial(Year(dRes), Month(dRes) + 1, 3)
    ElseIf (Day(dRes) = 31) Then
      dRes = DateSerial(Year(dRes), Month(dRes) + 1, 4)
    End If
  End If
    
  If ((inMod \ 2) Mod 2 = 1) Then
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    dRes = RemoveMonday(dRes)
  End If
    
  nDay = Day(dRes)
  nMonth = Month(dRes)
  nYear = Year(dRes)
  nHDays = 0
  nShift = 0
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '01/01 02/01 03/01 04/01 05/01 07/01 23/02 08/03 01/05 09/05 12/06 04/11
  If (nMonth = 1 And nDay >= 1 And nDay <= 10) Then
    For n = 1 To 7
      If (n <> 6) Then
        If (Weekday(DateSerial(nYear, nMonth, n)) = vbSunday Or _
            Weekday(DateSerial(nYear, nMonth, n)) = vbSaturday) Then
          nHDays = nHDays + 1
        End If
      End If
    Next n
    'MsgBox nHDays
    
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 5 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 5 + n)) <> vbSaturday And _
          (5 + n) <> 7) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    'MsgBox n
    
    If n < (nDay - 5) Then
      n = nDay - 5
    End If
    dRes = DateSerial(nYear, nMonth, 5 + n)
    
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '23/02
  ElseIf (nMonth = 2 And nDay >= 23 And nDay <= 24) Then
    If (Weekday(DateSerial(nYear, nMonth, 23)) = vbSunday Or _
        Weekday(DateSerial(nYear, nMonth, 23)) = vbSaturday) Then
          nHDays = nHDays + 1
    End If
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 23 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 23 + n)) <> vbSaturday) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    dRes = DateSerial(nYear, nMonth, 23 + n)
    
    If (Weekday(dRes) = vbSunday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 1)
    ElseIf (Weekday(dRes) = vbSaturday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 2)
    End If
    
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '08/03
  ElseIf (nMonth = 3 And nDay >= 8 And nDay <= 9) Then
    If (Weekday(DateSerial(nYear, nMonth, 8)) = vbSunday Or _
        Weekday(DateSerial(nYear, nMonth, 8)) = vbSaturday) Then
          nHDays = nHDays + 1
    End If
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 8 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 8 + n)) <> vbSaturday) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    dRes = DateSerial(nYear, nMonth, 8 + n)
    
    If (Weekday(dRes) = vbSunday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 1)
    ElseIf (Weekday(dRes) = vbSaturday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 2)
    End If
    
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '01/05
  ElseIf (nMonth = 5 And nDay >= 1 And nDay <= 2) Then
    If (Weekday(DateSerial(nYear, nMonth, 1)) = vbSunday Or _
        Weekday(DateSerial(nYear, nMonth, 1)) = vbSaturday) Then
          nHDays = nHDays + 1
    End If
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 1 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 1 + n)) <> vbSaturday) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    dRes = DateSerial(nYear, nMonth, 1 + n)
    
    If (Weekday(dRes) = vbSunday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 1)
    ElseIf (Weekday(dRes) = vbSaturday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 2)
    End If
  
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '09/05
  ElseIf (nMonth = 5 And nDay >= 9 And nDay <= 10) Then
    If (Weekday(DateSerial(nYear, nMonth, 9)) = vbSunday Or _
        Weekday(DateSerial(nYear, nMonth, 9)) = vbSaturday) Then
          nHDays = nHDays + 1
    End If
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 9 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 9 + n)) <> vbSaturday) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    dRes = DateSerial(nYear, nMonth, 9 + n)
    
    If (Weekday(dRes) = vbSunday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 1)
    ElseIf (Weekday(dRes) = vbSaturday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 2)
    End If
  
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '12/06
  ElseIf (nMonth = 6 And nDay >= 12 And nDay <= 13) Then
    If (Weekday(DateSerial(nYear, nMonth, 12)) = vbSunday Or _
        Weekday(DateSerial(nYear, nMonth, 12)) = vbSaturday) Then
          nHDays = nHDays + 1
    End If
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 12 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 12 + n)) <> vbSaturday) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    dRes = DateSerial(nYear, nMonth, 12 + n)
    
    If (Weekday(dRes) = vbSunday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 1)
    ElseIf (Weekday(dRes) = vbSaturday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 2)
    End If
  
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
  '04/11
  ElseIf (nMonth = 11 And nDay >= 4 And nDay <= 5) Then
    If (Weekday(DateSerial(nYear, nMonth, 4)) = vbSunday Or _
        Weekday(DateSerial(nYear, nMonth, 4)) = vbSaturday) Then
          nHDays = nHDays + 1
    End If
    n = 1
    While (nHDays > 0)
      If (Weekday(DateSerial(nYear, nMonth, 4 + n)) <> vbSunday And _
          Weekday(DateSerial(nYear, nMonth, 4 + n)) <> vbSaturday) Then
        nHDays = nHDays - 1
      End If
      n = n + 1
    Wend
    dRes = DateSerial(nYear, nMonth, 4 + n)
    
    If (Weekday(dRes) = vbSunday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 1)
    ElseIf (Weekday(dRes) = vbSaturday) Then
      dRes = DateSerial(Year(dRes), Month(dRes), Day(dRes) + 2)
    End If
    
    If ((inMod \ 2) Mod 2 = 1) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      RemoveMonday (dRes)
    End If
  End If
  
  GetWrkDate = dRes
End Function


Attribute VB_Name = "PaymForm"
Attribute VB_Base = "0{E20F92F1-B383-46C1-B7CE-3F1A4283F3D1}{43B698EB-B725-4BBC-8CE3-06F47DD44941}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub DisbFeeSum_AfterUpdate()
  DisbFeeSum.Value = Format(DisbFeeSum.Value, "##,##0.00")
  Cells(5, 2).Value = DisbFeeSum.Value
End Sub

Private Sub DisbFeePrc_AfterUpdate()
  DisbFeePrc.Value = Format(DisbFeePrc.Value, "0.00%")
  ActiveSheet.Cells(1, 21).Value = DisbFeePrc.Value
  ActiveSheet.Cells(5, 2).Value = Round(ActiveSheet.Cells(1, 21).Value * ActiveSheet.Cells(3, 2).Value, 2)
End Sub

Private Sub DoitBtn_Click()
Dim nPeriod As Integer
Dim nCreditSum As Double
Dim nRate As Double

  PaymForm.Hide
  
  If (DisbFeeOpt0.Value) Then
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(5, 2).Value = DisbFeeSum.Value
  Else
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(5, 2).Value = Round(ActiveSheet.Cells(1, 21).Value * ActiveSheet.Cells(3, 2).Value, 2)
  End If
  If (DisbFeeOpt2.Value) Then
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(10, 12).FormulaR1C1 = "=R[-5]C[-10]"
    ActiveSheet.Cells(11, 12).FormulaR1C1 = "0"
  Else
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.Cells(10, 12).FormulaR1C1 = "0"
    ActiveSheet.Cells(11, 12).FormulaR1C1 = "=R[-6]C[-10]"
  End If
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Cells(7, 11).Value = 0
  '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Cells(7, 10).Value = 0

  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'B2 (  2,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(2, 2).Value
  'B3 (  3,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(3, 2).Value
  'B4 (  4,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  nRate = ActiveSheet.Cells(4, 2).Value
  
  Call reCalcPaymnt(nPeriod, nCreditSum, nRate, ActiveSheet.Cells(1, 19).Value, 10)

End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()
Dim nPeriod As Integer
Dim dStart As Date
Dim nCreditSum As Double
Dim nRate As Double
Dim nDisbFee As Double
Dim nShift As Integer

  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 7).Value = 0
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 11).Value = 0
  '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 8).Value = 0
  Sheet5.Cells(7, 10).Value = 0
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'B1 (  1,  2) - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  dStart = ActiveSheet.Cells(4, 2).Value
  'B2 (  3,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(14, 4).Value
  'B3 (  2,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(10, 2).Value
  'B4 (  4,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  nRate = ActiveSheet.Cells(12, 4).Value
  'B5 (  5,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'nDisbFee = ActiveSheet.Cells(16, 2).Value
  nDisbFee = 0
  
  
  nShift = 10
  
  Call doDateFillNew(nPeriod, dStart, dStart, nCreditSum, nRate, nDisbFee, nShift)
  
  
  For k = 1 To 6
  
        If ActiveSheet.Cells(12, k + 3).Value = "" Then
        
          Exit For
          
        Else
        
          nShift = nShift + nPeriod
                    
          nPeriod = ActiveSheet.Cells(14, k + 3).Value
          
          nRate = ActiveSheet.Cells(12, k + 3).Value
          
          dStart = Sheet5.Cells(nShift, 2).Value
          
          Call doDateFillNext(False, nPeriod, dStart, dStart, nCreditSum, nRate, nDisbFee, nShift)
        
        End If
        
  Next
  
  For k = 11 To nShift + nPeriod
  
       Sheet5.Cells(k, 15).FormulaR1C1 = "=PRODUCT(R[0]C[-1]:R[" + Trim(Str(nShift + nPeriod - k)) + "]C[-1])"
       Sheet5.Cells(k, 8).FormulaR1C1 = "=RC[3]"
       Sheet5.Cells(k, 7).FormulaR1C1 = "=R[" + Trim(Str(-7 - (k - 11))) + "]C[5]-RC[4]"
  
  Next
  
 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(4, 15).FormulaR1C1 = "=SUM(R[" + Trim(Str(7)) + "]C[-3]:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C[-3])"



End Sub

Private Sub CommandButton2_Click()


  Load PaymForm
  
  PaymForm.DisbFeeOpt0.Value = Cells(1, 17).Value
  PaymForm.DisbFeeOpt1.Value = Not (Cells(1, 17).Value)
  PaymForm.DisbFeeOpt2.Value = Cells(1, 18).Value
  PaymForm.DisbFeeOpt3.Value = Not (Cells(1, 18).Value)
  PaymForm.DisbFeePrc.Value = Format(ActiveSheet.Cells(1, 21).Value, "0.00%")
  
  PaymForm.Show
  
End Sub



Private Sub CommandButton3_Click()
Dim nPeriod As Integer
Dim nCreditSum As Double
Dim nRate As Double
  'B2 (  2,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(2, 2).Value
  'B3 (  3,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(3, 2).Value
  'K5 (  5, 11) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / (|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| / 24)
  nRate = 24 * ActiveSheet.Cells(5, 11).Value / ActiveSheet.Cells(2, 2).Value
  'nRate = ActiveSheet.Cells(5, 11).Value
  
  Call reCalcEffRate(nPeriod, nCreditSum, nRate, 10)
  
End Sub
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()
Dim nPeriod As Integer
Dim dStart As Date
Dim nCreditSum As Double
Dim nRate As Double
Dim nDisbFee As Double
Dim nShift As Integer

  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 7).Value = 0
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 11).Value = 0
  '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 8).Value = 0
  Sheet5.Cells(7, 10).Value = 0
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'B1 (  1,  2) - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  dStart = ActiveSheet.Cells(4, 2).Value
  'B2 (  3,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(14, 4).Value
  'B3 (  2,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(10, 2).Value
  'B4 (  4,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  nRate = ActiveSheet.Cells(12, 4).Value
  'B5 (  5,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'nDisbFee = ActiveSheet.Cells(16, 2).Value
  nDisbFee = 0
  
  
  nShift = 10
  
  Call doDateFillNew(nPeriod, dStart, dStart, nCreditSum, nRate, nDisbFee, nShift)
  
  
  For k = 1 To 6
  
        If ActiveSheet.Cells(12, k + 3).Value = "" Then
        
          Exit For
          
        Else
        
          nShift = nShift + nPeriod
                    
          nPeriod = ActiveSheet.Cells(14, k + 3).Value
          
          nRate = ActiveSheet.Cells(12, k + 3).Value
          
          dStart = Sheet5.Cells(nShift, 2).Value
          
          Call doDateFillNext(False, nPeriod, dStart, dStart, nCreditSum, nRate, nDisbFee, nShift)
        
        End If
        
  Next
  
  For k = 11 To nShift + nPeriod
  
       Sheet5.Cells(k, 15).FormulaR1C1 = "=PRODUCT(R[0]C[-1]:R[" + Trim(Str(nShift + nPeriod - k)) + "]C[-1])"
       Sheet5.Cells(k, 8).FormulaR1C1 = "=RC[3]"
       Sheet5.Cells(k, 7).FormulaR1C1 = "=R[" + Trim(Str(-7 - (k - 11))) + "]C[5]-RC[4]"
  
  Next
  
 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(4, 15).FormulaR1C1 = "=SUM(R[" + Trim(Str(7)) + "]C[-3]:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C[-3])"



End Sub

Private Sub CommandButton2_Click()


  Load PaymForm
  
  PaymForm.DisbFeeOpt0.Value = Cells(1, 17).Value
  PaymForm.DisbFeeOpt1.Value = Not (Cells(1, 17).Value)
  PaymForm.DisbFeeOpt2.Value = Cells(1, 18).Value
  PaymForm.DisbFeeOpt3.Value = Not (Cells(1, 18).Value)
  PaymForm.DisbFeePrc.Value = Format(ActiveSheet.Cells(1, 21).Value, "0.00%")
  
  PaymForm.Show
  
End Sub



Private Sub CommandButton3_Click()
Dim nPeriod As Integer
Dim nCreditSum As Double
Dim nRate As Double
  'B2 (  2,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(2, 2).Value
  'B3 (  3,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(3, 2).Value
  'K5 (  5, 11) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / (|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| / 24)
  nRate = 24 * ActiveSheet.Cells(5, 11).Value / ActiveSheet.Cells(2, 2).Value
  'nRate = ActiveSheet.Cells(5, 11).Value
  
  Call reCalcEffRate(nPeriod, nCreditSum, nRate, 10)
  
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "xIRRForm"
Attribute VB_Base = "0{1CD7687C-A731-411C-AF73-85D1D36607F7}{427C148B-6112-407C-A1BE-1912F4165A19}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub aSum1_AfterUpdate()
  aSum1.Value = Format(aSum1.Value, "##,##0.00")
End Sub
Private Sub aSum2_AfterUpdate()
  aSum2.Value = Format(aSum2.Value, "##,##0.00")
End Sub
Private Sub aSum3_AfterUpdate()
  aSum3.Value = Format(aSum3.Value, "##,##0.00")
End Sub
Private Sub aSum4_AfterUpdate()
  aSum4.Value = Format(aSum4.Value, "##,##0.00")
End Sub
Private Sub aSum5_AfterUpdate()
  aSum5.Value = Format(aSum5.Value, "##,##0.00")
End Sub
Private Sub aSum6_AfterUpdate()
  aSum6.Value = Format(aSum6.Value, "##,##0.00")
End Sub
Private Sub aSum7_AfterUpdate()
  aSum7.Value = Format(aSum7.Value, "##,##0.00")
End Sub
Private Sub aSum8_AfterUpdate()
  aSum8.Value = Format(aSum8.Value, "##,##0.00")
End Sub
Private Sub aSum9_AfterUpdate()
  aSum9.Value = Format(aSum9.Value, "##,##0.00")
End Sub
Private Sub aSum10_AfterUpdate()
  aSum10.Value = Format(aSum10.Value, "##,##0.00")
End Sub
Private Sub aSum11_AfterUpdate()
  aSum11.Value = Format(aSum11.Value, "##,##0.00")
End Sub
Private Sub aSum12_AfterUpdate()
  aSum12.Value = Format(aSum12.Value, "##,##0.00")
End Sub
Private Sub aSum13_AfterUpdate()
  aSum13.Value = Format(aSum13.Value, "##,##0.00")
End Sub
Private Sub aSum14_AfterUpdate()
  aSum14.Value = Format(aSum14.Value, "##,##0.00")
End Sub
Private Sub aSum15_AfterUpdate()
  aSum15.Value = Format(aSum15.Value, "##,##0.00")
End Sub
Private Sub aSum16_AfterUpdate()
  aSum16.Value = Format(aSum16.Value, "##,##0.00")
End Sub
Private Sub aSum17_AfterUpdate()
  aSum17.Value = Format(aSum17.Value, "##,##0.00")
End Sub
Private Sub aSum18_AfterUpdate()
  aSum18.Value = Format(aSum18.Value, "##,##0.00")
End Sub
Private Sub aSum19_AfterUpdate()
  aSum19.Value = Format(aSum19.Value, "##,##0.00")
End Sub
Private Sub aSum20_AfterUpdate()
  aSum20.Value = Format(aSum20.Value, "##,##0.00")
End Sub
Private Sub aSum21_AfterUpdate()
  aSum21.Value = Format(aSum21.Value, "##,##0.00")
End Sub
Private Sub aSum22_AfterUpdate()
  aSum22.Value = Format(aSum22.Value, "##,##0.00")
End Sub
Private Sub aSum23_AfterUpdate()
  aSum23.Value = Format(aSum23.Value, "##,##0.00")
End Sub
Private Sub aSum24_AfterUpdate()
  aSum24.Value = Format(aSum24.Value, "##,##0.00")
End Sub
Private Sub aSum25_AfterUpdate()
  aSum25.Value = Format(aSum25.Value, "##,##0.00")
End Sub
Private Sub aSum26_AfterUpdate()
  aSum26.Value = Format(aSum26.Value, "##,##0.00")
End Sub
Private Sub aSum27_AfterUpdate()
  aSum27.Value = Format(aSum27.Value, "##,##0.00")
End Sub
Private Sub aSum28_AfterUpdate()
  aSum28.Value = Format(aSum28.Value, "##,##0.00")
End Sub
Private Sub aSum29_AfterUpdate()
  aSum29.Value = Format(aSum29.Value, "##,##0.00")
End Sub
Private Sub aSum30_AfterUpdate()
  aSum30.Value = Format(aSum30.Value, "##,##0.00")
End Sub


Private Sub CommandButton1_Click()
Dim nPeriod As Integer
Dim nCreditSum As Double
Dim nRate As Double
Dim nAddPeriod As Integer
  
  xIRRForm.Hide
  
  'B2 (  2,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(2, 2).Value
  'B3 (  3,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(3, 2).Value
  'K5 (  5, 11) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / (|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| / 24)
  nRate = 24 * ActiveSheet.Cells(5, 11).Value / ActiveSheet.Cells(2, 2).Value
  'nRate = ActiveSheet.Cells(5, 11).Value
  
  nAddPeriod = 0
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Range("A" + Trim(Str(10 + nPeriod + 1)) + ":M512").Select
  Selection.ClearContents
  With Selection.Borders
    .LineStyle = xlNone
  End With

  'cycle
  If (aCheck1.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate1.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate1.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum1.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck2.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate2.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate2.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum2.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck3.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate3.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate3.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum3.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck4.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate4.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate4.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum4.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck5.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate5.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate5.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum5.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck6.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate6.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate6.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum6.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck7.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate7.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate7.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum7.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck8.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate8.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate8.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum8.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck9.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate9.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate9.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum9.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck10.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate10.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate10.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum10.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck11.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate11.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate11.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum11.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck12.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate12.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate12.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum12.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck13.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate13.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate13.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum13.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck14.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate14.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate14.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum14.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck15.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate15.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate15.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum15.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck16.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate16.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate16.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum16.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck17.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate17.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate17.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum17.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck18.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate18.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate18.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum18.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck19.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate19.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate19.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum19.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck20.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate20.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate20.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum20.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck21.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate21.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate21.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum21.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck22.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate22.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate22.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum22.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck23.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate23.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate23.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum23.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck24.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate24.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate24.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum24.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck25.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate25.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate25.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum25.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck26.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate26.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate26.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum26.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck27.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate27.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate27.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum27.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck28.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate28.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate28.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum28.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck29.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate29.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate29.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum29.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  If (aCheck30.Value = True) Then
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|!
    nAddPeriod = nAddPeriod + 1
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 1).Select
    Selection.EntireRow.Insert
    
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 2).Value = Format(aDate30.Value, "dd/mm/yyyy")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 3).Value = CInt(CDate(Format(aDate30.Value, "dd/mm/yyyy")) - CDate(ActiveSheet.Cells(10 + nPeriod + nAddPeriod - 1, 2).Value))
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 7).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 8).Value = 0
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 12).Value = Format(aSum30.Value, "##,##0.00")
    ActiveSheet.Cells(10 + nPeriod + nAddPeriod, 13).FormulaR1C1 = "=RC[-6]+RC[-5]+RC[-1]"
  End If
  
  'end of cycle
  
  ActiveSheet.Range("A" + Trim(Str(10 + nPeriod + 1)) + ":M" + Trim(Str(10 + nPeriod + nAddPeriod + 1))).Select
  With Selection.Borders
    .LineStyle = xlContinuous
    .Weight = xlHairline
  End With
  
  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  ActiveSheet.Cells(4, 12).FormulaR1C1 = "=SUM(R[6]C:R[" + Trim(Str(6 + nPeriod + nAddPeriod)) + "]C)"

  Call reCalcEffRate(nPeriod + nAddPeriod, nCreditSum, nRate, 10)

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 3, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Application.ScreenUpdating = False
Dim nPeriod As Integer
Dim dStart As Date
Dim dFirst As Date
Dim nCreditSum As Double
Dim nRate As Double
Dim nDisbFee As Double
Dim nShift As Integer


  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 7).Value = 0
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 11).Value = 0
  '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(7, 8).Value = 0
  Sheet5.Cells(7, 10).Value = 0
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'B1 (  1,  2) - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  dStart = ActiveSheet.Cells(2, 2).Value
  'B1 (  1,  2) - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  dFirst = ActiveSheet.Cells(4, 2).Value
  'B2 (  3,  2) - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  nPeriod = ActiveSheet.Cells(14, 4).Value
  'B3 (  2,  2) - |fffd||fffd||fffd||fffd||fffd|
  nCreditSum = ActiveSheet.Cells(10, 3).Value
  'B4 (  4,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  nRate = ActiveSheet.Cells(12, 4).Value
  'B5 (  5,  2) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'nDisbFee = ActiveSheet.Cells(16, 2).Value
  nDisbFee = 0
  
  
  nShift = 10
  
  Call doDateFillNew(nPeriod, dStart, dFirst, nCreditSum, nRate, nDisbFee, nShift)
  
  
  For k = 1 To 6
  
        If Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(12, k + 4).Value = "" Then
        
          Exit For
          
        Else
        
          nShift = nShift + nPeriod
                    
          nPeriod = ActiveSheet.Cells(14, k + 4).Value
          
          nRate = ActiveSheet.Cells(12, k + 4).Value
          
          dStart = DateSerial(Year(Sheet5.Cells(nShift, 2).Value), Month(Sheet5.Cells(nShift, 2).Value), Day(dFirst))
          
          Call doDateFillNext(False, nPeriod, dStart, dStart, nCreditSum, nRate, nDisbFee, nShift)
        
        End If
        
  Next
  
  For k = 11 To nShift + nPeriod
      
       Sheet5.Cells(k, 15).FormulaR1C1 = "=PRODUCT(R[0]C[-1]:R[" + Trim(Str(nShift + nPeriod - k)) + "]C[-1])"
       Sheet5.Cells(k, 8).FormulaR1C1 = "=ROUND(RC[3],2)"
       Sheet5.Cells(k, 7).FormulaR1C1 = "=ROUND(R[" + Trim(Str(-7 - (k - 11))) + "]C[5]-RC[4],2)"
  
  Next
  
 
  'Sheet5.Cells(k - 1, 7).Value = Sheet5.Cells(k - 2, 10).Value
  
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(4, 9).FormulaR1C1 = "=R[" + Trim(Str(7)) + "]C[+6]/(SUM(R[" + Trim(Str(8)) + "]C[+6]:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C[+6])+" + Trim(Str(1)) + ")"
 
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  Sheet5.Cells(4, 10).FormulaR1C1 = "=SUM(R[" + Trim(Str(7)) + "]C[-3]:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C[-3])"
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(4, 11).FormulaR1C1 = "=SUM(R[" + Trim(Str(7)) + "]C[0]:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C[0])"
  
 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Sheet5.Cells(4, 15).FormulaR1C1 = "=SUM(R[" + Trim(Str(7)) + "]C[-3]:R[" + Trim(Str(nShift - 4 + nPeriod)) + "]C[-3])"
  
  
  Sheet5.Cells(k - 1, 7).Value = Sheet5.Cells(k - 2, 10).Value
  
  
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 2).Value = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 3).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|.)"
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 4).Value = "|fffd| |fffd|.|fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|.)"
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 5).Value = "|fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|.)"
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 6).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|.)"
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 7).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|.)"

  For k = 11 To nShift + nPeriod
  
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 1).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 1).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 2).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 2).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 3).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 13).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 4).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 7).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 5).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 8).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 6).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 1, 10).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 8, 7).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 10).Value

  
  Next
  

  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
  
  

  'ActiveSheet.Range("A1").Select
ActiveCell.CurrentRegion.Borders.LineStyle = False
ActiveCell.CurrentRegion.Borders.LineStyle = xlContinuous
ActiveSheet.Range("B1").Activate
ActiveCell.CurrentRegion.Activate

Application.ScreenUpdating = True

End Sub

Private Sub CommandButton2_Click()
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Copy After:=Sheets(3)
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Copy After:=Sheets(3)

    Xit = True
    k = 11
    While Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k, 2).Value < Now() And Xit
        
        k = k + 1
        If k > 50 Then Xit = False
        
    Wend
  
   'MsgBox (Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 1, 2).Value)
   
   Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(4, 8).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(k - 1, 10).Value + Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(19, 3).Value
   
   Sheet5.Cells(4, 9).FormulaR1C1 = "=R[" + Trim(Str(k - 4)) + "]C[+6]/(SUM(R[" + Trim(Str(k + 1 - 4)) + "]C[+6]:R[" + Trim(Str(42)) + "]C[+6])+" + Trim(Str(1)) + ")"
   
   For j = 11 To k - 1
    
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 7).Value = 0
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 8).Value = 0
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 9).Value = 0
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 10).Value = 0
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 11).Value = 0
       
   Next
   
   Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(46, 7).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(45, 10).Value
   Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 1, 10).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(4, 8).Value
   Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(10, 10).Value = 0



  For j = 11 To 46
  
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 1).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 1).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 2).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 2).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 3).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 13).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 4).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 7).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 5).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 8).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 6).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 1, 10).Value
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j - 8, 7).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 10).Value

  
  Next
  
  
 Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select



End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
