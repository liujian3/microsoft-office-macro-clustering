Attribute VB_Name = "List"






Option Explicit
Global SHEET_NAME                As String
Global COPY_AREA1                As String
Global COPY_AREA2                As String
Global MOVE_AREA                 As String
Global BOOK_NAME                 As String
Global Clicked                   As Integer
Global ix                        As Integer
Global jx                        As Integer
Global kx                        As Integer
Global px                        As Integer
Global qx                        As Integer
Global ax                        As Integer
Global bx                        As Integer
Global cx                        As Integer
Global dx                        As Integer
Global ex                        As Integer
Global ux                        As Integer            ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
Global ARW_CNT                   As Integer
Global ARW_FLG                   As Boolean
Global GON_NUM                   As Integer
Global DAN_NUM                   As Integer
Global LIN_NUM                   As Integer
Global UNT_NUM                   As Integer
Global START_LOC                 As Integer
Global ERR_FLG                   As Integer
Global SYORI_FLG                 As String * 1
Global FILE_NAME
Global W_STO                     As String
Global W_COR                     As String
Global W_PAT                     As String
Global W_MDL                     As String

'
Sub RECALC_RTN()
Attribute RECALC_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets(SHEET_NAME).Select
    With Application
        .Calculation = xlManual
        .MaxChange = 0.001
    End With
    ActiveWorkbook.PrecisionAsDisplayed = False
    ActiveSheet.Calculate
End Sub
'
Sub LIST_CLEAR()
Attribute LIST_CLEAR.VB_ProcData.VB_Invoke_Func = " \n14"
    For GON_NUM = 1 To 20
        SHEET_NAME_RTN
        Sheets("COUNT").Select
        Range("A1").Select
        Selection.Copy
        Sheets(SHEET_NAME).Select
        Range("B10:BI81").Select
        ActiveSheet.Paste
        Range("B10").Select
        '
        'If Sheets("COUNT").Range("AF2") = 0 Then
           Sheets(SHEET_NAME).Select
           Range("B6:AW6").Select
           Selection.ClearContents
           Range("B8:AW8").Select
           Selection.ClearContents
        'End If
    Next GON_NUM
End Sub
'
Sub SHEET_NAME_RTN()
Attribute SHEET_NAME_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    Select Case GON_NUM
           Case 1
                SHEET_NAME = "LIST1"
           Case 2
                SHEET_NAME = "LIST2"
           Case 3
                SHEET_NAME = "LIST3"
           Case 4
                SHEET_NAME = "LIST4"
           Case 5
                SHEET_NAME = "LIST5"
           Case 6
                SHEET_NAME = "LIST6"
           Case 7
                SHEET_NAME = "LIST7"
           Case 8
                SHEET_NAME = "LIST8"
           Case 9
                SHEET_NAME = "LIST9"
           Case 10
                SHEET_NAME = "LIST10"
           Case 11
                SHEET_NAME = "LIST11"
           Case 12
                SHEET_NAME = "LIST12"
           Case 13
                SHEET_NAME = "LIST13"
           Case 14
                SHEET_NAME = "LIST14"
           Case 15
                SHEET_NAME = "LIST15"
           Case 16
                SHEET_NAME = "LIST16"
           Case 17
                SHEET_NAME = "LIST17"
           Case 18
                SHEET_NAME = "LIST18"
           Case 19
                SHEET_NAME = "LIST19"
           Case 20
                SHEET_NAME = "LIST20"
    End Select
End Sub

Sub WIDTH_SET()
Attribute WIDTH_SET.VB_ProcData.VB_Invoke_Func = " \n14"
'
'|fffd|A|fffd|C|fffd|e|fffd||fffd||fffd||fffd||fffd||182||303|Z|fffd||fffd||fffd||310||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
'
    Sheets("COUNT").Select
    Range("B11:U22").Select
    Selection.ClearContents
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("AA3:AH16384").Select
    Selection.ClearContents
    '
    SHEET_NAME = "COUNT"
    RECALC_RTN
    ix = Sheets("COUNT").Range("B8") + 2
    For ix = 3 To Sheets("COUNT").Range("B8") + 2
        GON_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1)
        DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2)
        LIN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 3)
        Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 26).Value = Sheets("TSIZE").Cells(GON_NUM * 20 + 70 + DAN_NUM, LIN_NUM + 1).Value
    Next ix
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("AA2:AF2").Select
    Selection.Copy                                   '|fffd|v|fffd|Z|fffd||fffd||fffd|R|fffd|s|fffd|[
    Range(Cells(3, 27), Cells(ix, 32)).Select
    ActiveSheet.Paste
    Range("AH2").Select
    Selection.Copy                                   '|fffd|v|fffd|Z|fffd||fffd||fffd|R|fffd|s|fffd|[
    Range(Cells(3, 34), Cells(ix, 34)).Select
    ActiveSheet.Paste
    SHEET_NAME = "|fffd|I|fffd||fffd||fffd||7b0||fffd|"
    RECALC_RTN
    '
    For ix = 3 To Sheets("COUNT").Range("B8") + 2
        GON_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1)
        If GON_NUM > 20 Then
           ERR_FLG = 1
           If SYORI_FLG = "S" Then
              Sheets("ERMSG").Select
              Sheets("ERMSG").Range("D9").Value = "|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|Q|fffd|O|fffd|{|fffd||fffd||847d||fffd||fffd||fffd||fffd||fffd||7c2||fffd|"
              Sheets("ERMSG").Range("D12").Value = "|fffd||fffd||fffd||fffd||fffd||11c42||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B"
              Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
              Range("A1").Select
           End If
           Exit Sub
        End If
        DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2)
        If DAN_NUM > 12 Then
           ERR_FLG = 1
           If SYORI_FLG = "S" Then
              Sheets("ERMSG").Select
              Sheets("ERMSG").Range("D9").Value = "|fffd|I|fffd|i|fffd||fffd||fffd|P|fffd|Q|fffd|i|fffd||fffd||847d||fffd||fffd||fffd||fffd||fffd||7c2||fffd|"
              Sheets("ERMSG").Range("D12").Value = "|fffd||fffd||fffd||fffd||fffd||11c42||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B"
              Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
              Range("A1").Select
           End If
           Exit Sub
        End If
        '
        '|fffd|I|fffd|i|fffd||fffd||fffd||182||30e||fffd||fffd||fffd||fffd||74c|v|fffd|l|fffd|@|fffd|v|fffd|Z
        '2014-11-04 Igarashi|fffd|C|fffd||fffd|
        '|fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
        If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 5).Value = 1 Then
            '|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||97||fffd|t|fffd||fffd||fffd|O|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|i|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||97||42a82||fffd||fffd||939e||fffd||342|P|fffd|j
            If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 17).Value = 1 Then
                '|fffd||fffd||fffd||fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 4).Value = 1 Then
                    Sheets("COUNT").Cells(DAN_NUM + 10, GON_NUM + 1) = Sheets("COUNT").Cells(DAN_NUM + 10, GON_NUM + 1) + Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 27)
                End If
            Else
                Sheets("COUNT").Cells(DAN_NUM + 10, GON_NUM + 1) = Sheets("COUNT").Cells(DAN_NUM + 10, GON_NUM + 1) + Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 27)
            End If
        End If
        '
    Next ix
    SHEET_NAME = "COUNT"
    RECALC_RTN
    '
    For ix = 3 To Sheets("COUNT").Range("B8") + 2
        GON_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1)
        DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2)
        '|fffd||fffd||fffd||fffd||fffd||fffd||309||fffd||fffd||fffd|(AB|fffd||fffd|)|fffd||fffd||fffd|v|fffd|Z
        If Sheets("COUNT").Cells(DAN_NUM + 30, GON_NUM + 1) = 0 Or Sheets("COUNT").Cells(DAN_NUM + 30, GON_NUM + 1) = "" Then
           Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 28) = 0
        Else
           If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix - 1, 1).Value And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix - 1, 2).Value And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 3).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix - 1, 3).Value Then
              Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 28).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix - 1, 28).Value
           Else
              Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 28) = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 27) / Sheets("COUNT").Cells(DAN_NUM + 30, GON_NUM + 1)
           End If
        End If
    Next ix
    SHEET_NAME = "|fffd|I|fffd||fffd||fffd||7b0||fffd|"
    RECALC_RTN
    '
    '|fffd|m|fffd||74c|v|fffd|Z|fffd||fffd||fffd|n|fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    For ix = 3 To Sheets("COUNT").Range("B8") + 2
        GON_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1)
        DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2)
        '|fffd||74c|v|fffd|Z|fffd||fffd|(AD|fffd||fffd|)|fffd|Z|fffd|o
        Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 30) = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 29) / Sheets("COUNT").Cells(9, GON_NUM + 1) * 60
    Next ix
    SHEET_NAME = "|fffd|I|fffd||fffd||fffd||7b0||fffd|"
    RECALC_RTN
    '
    '|fffd|[|fffd||fffd||fffd|T|fffd|C|fffd|Y|fffd||30f||fffd||fffd|i|fffd||202||1c2||fffd||fffd||202||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    '
    ix = Sheets("COUNT").Range("B8")
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("AG2").Select
    ActiveCell.FormulaR1C1 = "=COUNTIF(R[1]C[-1]:R[" & ix & "]C[-1],0)"          '|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd|O|fffd||303|A|fffd|C|fffd|e|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Range("AG2").Value > 0 Then
       ERR_FLG = 1
       If SYORI_FLG = "S" Then
          Sheets("ERMSG").Select
          Sheets("ERMSG").Range("D9").Value = "|fffd|A|fffd|C|fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||112|I|fffd||fffd||fffd|\|fffd||fffd|"
          Sheets("ERMSG").Range("D12").Value = "|fffd|\|fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd|A|fffd|C|fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
          Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
          Range("A1").Select
       End If
       Exit Sub
    End If
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("AA1").Select
End Sub
'
Sub RCSIZE_SET()
Attribute RCSIZE_SET.VB_ProcData.VB_Invoke_Func = " \n14"
'
'|fffd|s|fffd|E|fffd||fffd||303|T|fffd|C|fffd|Y|fffd||3cd|X
'
    Dim COL_WIDTH               As Integer
    Dim ROW_HEIGHT1             As Single
    Dim ROW_HEIGHT2             As Single
    Dim ROW_HEIGHT3             As Single
    '
    SHEET_NAME = "COUNT"
    RECALC_RTN
    '|fffd|@=============================|fffd|@|fffd|s|fffd|E|fffd||fffd|@|fffd||315||fffd||fffd|Z|fffd|b|fffd|g ===================================
    If Sheets("COUNT").Range("G8").Value = 2 Then          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       COL_WIDTH = 3
       ROW_HEIGHT1 = 24.75
       ROW_HEIGHT2 = 12.75
       ROW_HEIGHT3 = 12.75
    Else
      If Sheets("COUNT").Range("F8").Value = 2 Then        '|fffd|a|fffd|S|fffd|p|fffd||fffd||fffd|c|fffd||fffd||fffd|
         COL_WIDTH = 3
         ROW_HEIGHT1 = 50
         ROW_HEIGHT2 = 20
         ROW_HEIGHT3 = 40
      Else                                                 '|fffd|`|fffd|S|fffd|p|fffd||fffd||fffd|c|fffd||fffd||fffd|
         COL_WIDTH = 1
         ROW_HEIGHT1 = 24.75
         ROW_HEIGHT2 = 12.75
         ROW_HEIGHT3 = 12.75
      End If
    End If
    For GON_NUM = 1 To Sheets("COUNT").Range("B7").Value
        SHEET_NAME_RTN
        ix = Sheets("TSIZE").Cells(56, GON_NUM + 1).Value
        Sheets(SHEET_NAME).Select
        Columns("B:BI").Select
        Selection.ColumnWidth = COL_WIDTH
        Rows("2:2").Select
        Selection.RowHeight = ROW_HEIGHT1
        Rows("3:8").Select
        Selection.RowHeight = ROW_HEIGHT2
        Rows("9:" & ix).Select
        Selection.RowHeight = ROW_HEIGHT3
        '
        Range("A1").Select
    Next GON_NUM
    '
End Sub
'
Sub TANA_DATA_SAVE()
Attribute TANA_DATA_SAVE.VB_ProcData.VB_Invoke_Func = " \n14"
'
'|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||28f||fffd||fffd||6d1||fffd|
'
    Dim NEWBOOK_NAME               As String
    Dim FILE_DIR                   As String
    Dim SHEET_NUM                  As Integer
    '
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    On Error GoTo TXT_SAVE_ERR
    '
    BOOK_NAME = Sheets("COUNT").Range("B6").Value
    Windows(BOOK_NAME).Activate
    SHEET_NAME = "COUNT"
    RECALC_RTN
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Columns("Y:AZ").Select
    Selection.EntireColumn.Hidden = False
    '
    '|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||30f||a347||fffd||30f||fffd||fffd||fffd|
    '======================================================================================
    'FILE_DIR = Workbooks(BOOK_NAME).Sheets("COUNT").Range("D6")
    'ChDrive Left(FILE_DIR, 1)
    'ChDir FILE_DIR
     '======================================================================================
    FILE_NAME = Application.GetSaveAsFilename(initialfilename:="*****.xls", filefilter:="Excel|327||fffd||fffd| (*.xls),*.xls,|fffd||fffd||fffd||5c2||102||fffd||327||fffd||fffd| (*.*),*.*")
    If FILE_NAME = False Then
       MsgBox "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
       Windows(NEWBOOK_NAME).Activate
       ActiveWorkbook.Saved = True
       ActiveWorkbook.Close
       Windows(BOOK_NAME).Activate
       Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
       Range("A1").Select
       Exit Sub
    End If
    '
    SHEET_NUM = Application.SheetsInNewWorkbook           '|fffd|V|fffd|KBOOK|fffd|@OPEN
    Application.SheetsInNewWorkbook = 1                   'SHEET|fffd|P|fffd||fffd||fffd||302||742||242||fffd||fffd||fffd|
    Workbooks.Add
    NEWBOOK_NAME = ActiveWorkbook.Name
    Application.SheetsInNewWorkbook = SHEET_NUM
    '
    Windows(BOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Copy After:=Workbooks(NEWBOOK_NAME).Sheets(1)
    Windows(NEWBOOK_NAME).Activate
    Sheets("SHEET1").Select
    ActiveSheet.Delete
    '
    Windows(NEWBOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    ActiveSheet.DrawingObjects("BTN1").Select
    Selection.Delete
    ActiveSheet.DrawingObjects("BTN3").Select
    Selection.Delete
    ActiveSheet.DrawingObjects("BTN5").Select
    Selection.Delete
    Columns("Y:AZ").Select
    Selection.Delete
    '
    Workbooks(NEWBOOK_NAME).Activate
    ActiveWorkbook.SaveAs FileName:=FILE_NAME, FileFormat:=xlNormal _
              , Password:="", WriteResPassword:="", ReadOnlyRecommended:= _
               False, CreateBackup:=False
    ActiveWorkbook.Close
    '
    Windows(BOOK_NAME).Activate
    Sheets("DSHEET").Select
    Cells.Select
    Selection.ClearContents
    Range("A1").Select
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("A1").Select
    MsgBox "|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    '
    Application.ScreenUpdating = True
    Exit Sub
    '
TXT_SAVE_ERR:
    Windows(BOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    MsgBox "|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24d|s|fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub

Sub BTN_ADJUST()
Attribute BTN_ADJUST.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets("LIST2").Select
    
    For ix = 1 To 7
        
        Sheets("LIST2").Select
        ActiveSheet.DrawingObjects("BTN" & ix).Select
        Selection.Left = Sheets("BTN").Cells(ix + 1, 2).Value
        Selection.Width = Sheets("BTN").Cells(ix + 1, 3).Value
        Selection.Top = Sheets("BTN").Cells(ix + 1, 4).Value
        Selection.Height = Sheets("BTN").Cells(ix + 1, 5).Value
        
    Next ix

End Sub

Sub BTN_LOCATION()
Attribute BTN_LOCATION.VB_ProcData.VB_Invoke_Func = " \n14"
    
    For ix = 1 To 7
        
        Sheets("LIST3").Select
        ActiveSheet.DrawingObjects("BTN" & ix).Select
        Sheets("BTN").Cells(ix + 1, 2).Value = Selection.Left
        Sheets("BTN").Cells(ix + 1, 3).Value = Selection.Width
         Sheets("BTN").Cells(ix + 1, 4).Value = Selection.Top
       Sheets("BTN").Cells(ix + 1, 5).Value = Selection.Height
        
    Next ix

End Sub

'
'Sub SAGYO()
'    For ix = 1 To 60
'    Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
'
'    Range(Cells((ix - 1) * 6 + 1, 2), Cells((ix - 1) * 6 + 5, ix + 1)).Select
'
'    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
'    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
'    With Selection.Borders(xlEdgeLeft)
'        .LineStyle = xlContinuous
'        .Weight = xlThin
'        .ColorIndex = xlAutomatic
'    End With
'    Selection.Borders(xlEdgeTop).LineStyle = xlNone
'    With Selection.Borders(xlEdgeBottom)
'        .LineStyle = xlDot
'        .Weight = xlThin
'        .ColorIndex = xlAutomatic
'    End With
'    With Selection.Borders(xlEdgeRight)
'        .LineStyle = xlContinuous
'        .Weight = xlThin
'        .ColorIndex = xlAutomatic
'    End With
'    Selection.Borders(xlInsideVertical).LineStyle = xlNone
'
'
'
'    Next ix
'    Range("a1").Select
'End Sub
Attribute VB_Name = "Module1"
Option Explicit

Dim cnt                        As Integer
Dim i                          As Integer
Dim c
Dim TSC_PIC_FLG                As Integer
Dim FILE_DIR                   As String
Dim tsc As Object, pat As Object, GON As Object, SHL As Object, UNT As Object
Dim Now_Gcnt As Long, Now_Scnt As Long, Now_Ucnt As Long, Gcnt As Long, Scnt As Long, Ucnt As Long, Row_cnt As Long
Global Pat_cnt                    As Integer
'===============================  2000/03/24  ===============================
Global COR As Object, MDL As Object, LIN As Object
Global Now_Pcnt As Integer, Now_Mcnt As Integer, Now_Lcnt As Integer, Pcnt As Integer, Mcnt As Integer, Lcnt As Integer
Global ENV_FLG As Integer

'2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||97||fffd||389||fffd||fffd|p|fffd|j
Global gUpperDepthCnt As Integer
Dim dUpperDepthLineCnt As Integer '|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||fffd||fffd||97||42cc2||fffd||102||fffd||fffd||fffd|Line|fffd||fffd||fffd||fffd||fffd||83|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd|
Dim dMaxDepthCnt As Integer
Dim dMaxUpperCnt As Integer

Public Const PCUpperDepthMark = "|fffd||fffd|"
Public Const PCTextBoxStartLeft = 55
Public Const PCTextBoxStartTop = 240
Public Const PCUpperDepthTitleHeight = 20
Public Const PCMaxColLine = 3
Public Const PCMaxPageLine = 9
Public Const PCMaxGroupWidthSize = 450
Public Const PCMaxGroupHeightSize = 240
Public Const PCAvgTextWidthSize = 150
Public Const PCAvgTextHeightSize = 80
Public Const PCGroupIntervalWidth = 500
Public Const PCGroupIntervalHeight = 300
Public Const PCPrintPageRow = 75
Public Const PCNextPageInterval = 400
Public Const PCPageHeight = 999
Public Const PCSheetRowHeight = 13.5

'===============================  2000/03/24  ===============================
'
Sub AUTO_OPEN()
Attribute AUTO_OPEN.VB_ProcData.VB_Invoke_Func = " \n14"
Dim NewButton
    Application.ScreenUpdating = False
    ENV_FLG = 0
        
    Sheets("COUNT").Range("B6").Value = Application.ActiveWorkbook.Name
    Sheets("COUNT").Range("D6").Value = Application.ActiveWorkbook.Path
    '
    'For ix = 11 To 19                 '|fffd|I|fffd||fffd||fffd|\|fffd|\|fffd||fffd||fffd||fffd||fffd||681|@|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd|@"|fffd|n|fffd|m"
    '    Sheets("COUNT").Cells(ix, 27).Value = True
    'Next ix
    '
    Sheets("TSIZE").Select
    '==================== |fffd|e|fffd|X|fffd|g|fffd||fffd||fffd||302||743|R|fffd||fffd||fffd||fffd||fffd|g =============================
    'Range("CA2:CG2").Select
    'Selection.ClearContents
    '==================== |fffd|e|fffd|X|fffd|g|fffd||fffd||fffd||302||743|R|fffd||fffd||fffd||fffd||fffd|g =============================
    Range("A1").Select
    SHEET_NAME = "TSIZE"
    RECALC_RTN
    '
    Sheets("COUNT").Select
    '==================== |fffd|e|fffd|X|fffd|g|fffd||fffd||fffd||302||743|R|fffd||fffd||fffd||fffd||fffd|g =============================
    'Range("E6").Select
    'Selection.ClearContents
    '==================== |fffd|e|fffd|X|fffd|g|fffd||fffd||fffd||302||743|R|fffd||fffd||fffd||fffd||fffd|g =============================
    SHEET_NAME = "COUNT"
    RECALC_RTN
    Range("A1").Select
    '
    Sheets("PARAM").Select
    Range("E5:E13").Select
    Selection.ClearContents
    Range("E5").Select
    Application.ScreenUpdating = True
End Sub
'
Sub START_GAMEN()
Attribute START_GAMEN.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Worksheets("PARAM").Select
    Range("E5").Select
    Application.ScreenUpdating = True
End Sub
'
Sub PARAM2_GAMEN()
Attribute PARAM2_GAMEN.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Worksheets("PARAM2").Select
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub

Sub TSCFILE_OPEN()
Attribute TSCFILE_OPEN.VB_ProcData.VB_Invoke_Func = " \n14"
    
    Application.ScreenUpdating = False
    '
    '****************************    1999.11 |fffd||1c9||fffd|    *********************************
    'ENV_SET
    '****************************    1999.11 |fffd||1c9||fffd|    *********************************
    '
    'If Sheets("TSIZE").Range("AG2").Value = 0 Then     '|fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
    '   HYOSI_SAKUSEI
    '   Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    '   ActiveSheet.DrawingObjects("HYOSI_BTN").Visible = True
    'Else
    ''  Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    '   ActiveSheet.DrawingObjects("HYOSI_BTN").Visible = False
    'End If
    '
    ERR_FLG = 0
    SYORI_FLG = "S"
    '
    TSC_DATA_SET
    '
    PARAM_SET
    '
    If ERR_FLG = 0 Then
       Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
       TANADATA_GMN
    Else
       Sheets("ERMSG").Select
       ActiveWindow.ScrollRow = 1
       ActiveWindow.ScrollColumn = 1
       Range("A1").Select
    End If
    '
    Application.ScreenUpdating = True
End Sub

'===============================  2000/03/24  ===============================
Sub MDL_GET_RTN()                        '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|E|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||64fe|
Attribute MDL_GET_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    'On Error GoTo MDLGET_ERR
    '--- |fffd||fffd||170||fffd||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
    Set COR = tsc.Corner
    '--- |fffd||fffd||fffd||fffd||775||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
    Now_Pcnt = COR.CountPattern
    For Pcnt = 1 To Now_Pcnt
        '*** N|fffd||516||682||fffd||fffd||fffd||fffd||fffd||74f||fffd||fffd|i|fffd||fffd||fffd||fffd||77a||fffd||fffd||781|j|fffd||fffd||fffd||64fe||fffd|I ***
         Set pat = COR.NthPattern(Pcnt)
         If pat.code = Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CB2") Then
             '--- |fffd||fffd||fffd||675||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
             Now_Mcnt = pat.CountModel
             For Mcnt = 1 To Now_Mcnt
             'Mcnt = Now_Mcnt
                 '*** N|fffd||516||682||fffd||fffd||fffd||fffd||64f||fffd||fffd|i|fffd||fffd||fffd||67a||fffd||fffd||781|j|fffd||fffd||fffd||64fe||fffd|I ***
                  Set MDL = pat.NthModel(Mcnt)
                  'MsgBox MDL.code
                  If MDL.code = Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CD2") Then
                     Now_Gcnt = MDL.CountGondola
                     Sheets("COUNT").Range("B7") = MDL.CountGondola                 '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd|{|fffd||fffd|
                     ERR_FLG = 0
                     Exit Sub
                  End If
             Next Mcnt
         End If
    Next Pcnt
    '
    ERR_FLG = 1
    Exit Sub
    '
MDLGET_ERR:
    ERR_FLG = 1
    Exit Sub
End Sub

Sub TSC_DATA_SET()
Attribute TSC_DATA_SET.VB_ProcData.VB_Invoke_Func = " \n14"
'===============================  2000/03/24  ===============================
'
'
    On Error GoTo TSCFILE_ERR

    '2014-11-04 Igarashi|fffd||1c9||fffd|
    Dim UpperDepthFlg As Integer

    ERR_FLG = 0
    BOOK_NAME = Sheets("COUNT").Range("B6").Value
    FILE_NAME = Workbooks(BOOK_NAME).Sheets("COUNT").Range("E6")             'TSC|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd|

    '|fffd||642||338||631||fffd|
    CELL_CLEAR

    'KDY 07/09/13
    Set tsc = Nothing
    Set tsc = GetObject(FILE_NAME, "Tsc.Document")

    'Ogiwara 2010/09
    Dim posWkPath As String
    posWkPath = Sheets("TSIZE").Range("CH2").Value
    Dim cFso As New FileSystemObject
    If cFso.FileExists(posWkPath) = True Then
        Dim b As Boolean
        b = tsc.ReadPos(posWkPath)
    End If
    Set cFso = Nothing

    '===============================  2000/03/24  ===============================
    MDL_GET_RTN                         '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|E|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||64fe|
    If ERR_FLG = 1 Then
       GoTo TSCFILE_ERR
       Exit Sub
    End If
    '===============================  2000/03/24  ===============================
    '
    '|fffd||fffd||110||fffd||30a|J|fffd|n|fffd|s|fffd||fffd|
    Row_cnt = 3

    '=== |fffd|I|fffd||fffd||fffd||30e||64fe| |fffd||fffd| |fffd|I|fffd||fffd||fffd||7b0||fffd||fffd||fffd||102||582||fffd||fffd||7b0||fffd||fffd||fffd||fffd| ===

    For Gcnt = 1 To Now_Gcnt

        '*** N|fffd||516||682||33a||fffd||fffd||fffd||fffd||5cf||fffd||fffd|i|fffd|I|fffd|i|fffd||fffd||fffd|j|fffd||fffd||fffd||64fe||fffd|I ***
        Set GON = MDL.NthGondola(Gcnt)
        Sheets("COUNT").Cells(9, Gcnt + 1) = GON.Width              '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|
        Sheets("TSIZE").Cells(9, Gcnt + 1) = GON.Width              '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|
        Sheets("COUNT").Cells(10, Gcnt + 1) = GON.CountShelf        '|fffd|I|fffd|i|fffd||fffd|
        Sheets("TSIZE").Cells(5, Gcnt + 1) = GON.CountShelf         '|fffd|I|fffd|i|fffd||fffd|
        Now_Scnt = GON.CountShelf

        For Scnt = 1 To Now_Scnt
            '===============================  2000/03/24  ===============================
            '*** N|fffd||516||682||312|I|fffd|i|fffd||fffd||fffd|i|5f2||750||fffd||fffd|j|fffd||fffd||fffd||64fe||fffd|I ***
            Set SHL = GON.NthShelf(Scnt)
            Now_Lcnt = SHL.CountLine

            For Lcnt = 1 To Now_Lcnt

                '*** N|fffd||516||682||30f||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||64fe||fffd|I ***
                Set LIN = SHL.NthLine(Lcnt)
                Now_Ucnt = LIN.CountUnit
                Sheets("COUNT").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value = LIN.CountUnit

                '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||97||fffd||389||fffd||fffd|p|fffd|j
                If LIN.UpperDepthFlg = 1 And LIN.CountUnit > 1 Then
                    UpperDepthFlg = 1
                Else
                    UpperDepthFlg = 0
                End If

                For Ucnt = 1 To Now_Ucnt
                    Set UNT = LIN.NthUnit(Ucnt)
                    '===============================  2000/03/24  ===============================
                    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select

                    '|fffd||fffd||fffd||fffd||fffd||fffd|
                    Range(Cells(Row_cnt, 1), Cells(Row_cnt, 1)).Value = Gcnt
                    '|fffd|I|fffd|i|fffd|i1999.11 |fffd||3cd|X|fffd|j
                    'If DANCOUNT = 1 Then     '|fffd||30a9||fffd||fffd|1|fffd|i
                    '   Range(Cells(Row_cnt, 2), Cells(Row_cnt, 2)).Value = Now_Scnt - Scnt + 1
                    'Else                     '|fffd||fffd||fffd||fffd||fffd||fffd|1|fffd|i
                       Range(Cells(Row_cnt, 2), Cells(Row_cnt, 2)).Value = Scnt
                    'End If
                    '|fffd||292|u
                    Range(Cells(Row_cnt, 3), Cells(Row_cnt, 3)).Value = Lcnt                '|fffd||fffd||fffd||fffd||fffd||fffd|
                    If UpperDepthFlg = 1 Then
                        Range(Cells(Row_cnt, 4), Cells(Row_cnt, 4)).Value = UNT.UpperNo     '|fffd||fffd||fffd||fffd||fffd||fffd|
                        Range(Cells(Row_cnt, 5), Cells(Row_cnt, 5)).Value = UNT.DepthNo     '|fffd||fffd|O|fffd||fffd||fffd||fffd|
                    Else
                        Range(Cells(Row_cnt, 4), Cells(Row_cnt, 4)).Value = 1               '|fffd||fffd||fffd||fffd||fffd||fffd|
                        Range(Cells(Row_cnt, 5), Cells(Row_cnt, 5)).Value = Ucnt            '|fffd||fffd|O|fffd||fffd||fffd||fffd|
                    End If
                    '
                    '|fffd|e|fffd|I|fffd|i|fffd||151||fffd|UNIT|fffd||fffd|
                    '2014-11-04 Igarashi|fffd|C|fffd||fffd||fffd|i|fffd|J|fffd|n|fffd|j
                    If Sheets("TSIZE").Cells(Scnt + 10, Gcnt + 1).Value < Ucnt Then
                        If UpperDepthFlg = 1 Then
                            Sheets("TSIZE").Cells(Scnt + 10, Gcnt + 1).Value = 1
                        Else
                            Sheets("TSIZE").Cells(Scnt + 10, Gcnt + 1).Value = Ucnt
                        End If
                    End If
                    '2014-11-04 Igarashi|fffd|C|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd|j
                    '
                    'JAN|fffd||fffd||fffd||fffd|
                    Range(Cells(Row_cnt, 6), Cells(Row_cnt, 6)).Value = UNT.jancode
                    '|fffd||fffd||fffd|i|fffd||fffd|
                    If Sheets("COUNT").Range("D8").Value = 1 Then
                       '|fffd||fffd||fffd|[|fffd|J|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||202||fffd|
                       If Sheets("COUNT").Range("E8").Value = 1 Then
                          '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||115|\|fffd||fffd|
                          Range(Cells(Row_cnt, 7), Cells(Row_cnt, 7)).Value = StrHead(UNT.Name)
                          Range(Cells(Row_cnt, 8), Cells(Row_cnt, 8)).Value = StrTail(UNT.Name)
                       Else
                          '|fffd|K|fffd|i|fffd||fffd||fffd||702||7c2||115|\|fffd||fffd|
                          Range(Cells(Row_cnt, 7), Cells(Row_cnt, 7)).Value = UNT.Name
                          Range(Cells(Row_cnt, 8), Cells(Row_cnt, 8)).Value = ""
                       End If
                    Else
                       '|fffd||fffd||fffd|[|fffd|J|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
                       If Sheets("COUNT").Range("E8").Value = 1 Then
                          '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||115|\|fffd||fffd|
                          Range(Cells(Row_cnt, 7), Cells(Row_cnt, 7)).Value = UNT.MkName & " " & StrHead(UNT.Name)
                          Range(Cells(Row_cnt, 8), Cells(Row_cnt, 8)).Value = StrTail(UNT.Name)
                       Else
                          '|fffd|K|fffd|i|fffd||fffd||fffd||702||7c2||115|\|fffd||fffd|
                          Range(Cells(Row_cnt, 7), Cells(Row_cnt, 7)).Value = UNT.MkName & " " & UNT.Name
                          Range(Cells(Row_cnt, 8), Cells(Row_cnt, 8)).Value = ""
                       End If
                    End If
                    '|fffd||fffd||fffd||fffd|
                    'Range(Cells(Row_cnt, 7), Cells(Row_cnt, 7)).Value = UNT.cost
                    '|fffd||fffd||fffd||fffd|
                    Range(Cells(Row_cnt, 9), Cells(Row_cnt, 9)).Value = UNT.price
                    '|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|
                    Range(Cells(Row_cnt, 10), Cells(Row_cnt, 10)).Value = UNT.stocode
                    '|32a||fffd||fffd|
                    Range(Cells(Row_cnt, 11), Cells(Row_cnt, 11)).Value = UNT.face
                    '|fffd||fffd||fffd|s
                    Range(Cells(Row_cnt, 12), Cells(Row_cnt, 12)).Value = UNT.ndepth
                    '|fffd||3d2|i
                    Range(Cells(Row_cnt, 13), Cells(Row_cnt, 13)).Value = UNT.cap
                    '|fffd||fffd||fffd||8414|
                    Range(Cells(Row_cnt, 15), Cells(Row_cnt, 15)).Value = UNT.Case
                    '|fffd||fffd||fffd|i|fffd||fffd||fffd|i1999.11 |fffd||3cd|X|fffd|j
                    Select Case Sheets("COUNT").Range("C8").Value
                           Case 1
                                Range(Cells(Row_cnt, 25), Cells(Row_cnt, 25)).Value = UNT.Width
                                Range(Cells(Row_cnt, 26), Cells(Row_cnt, 26)).Value = UNT.Width
                                If Sheets("TSIZE").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value < UNT.Width Then
                                   Sheets("TSIZE").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value = UNT.Width         '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||151||53e4||fffd|i|fffd||fffd|
                                End If
                           Case 2
                                Range(Cells(Row_cnt, 25), Cells(Row_cnt, 25)).Value = UNT.face
                                Range(Cells(Row_cnt, 26), Cells(Row_cnt, 26)).Value = UNT.face
                                If Sheets("TSIZE").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value < UNT.face Then
                                   Sheets("TSIZE").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value = UNT.face          '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||151||fffd|t|fffd|F|fffd|C|fffd|X|fffd||fffd|
                                End If
                           Case 3
                                Range(Cells(Row_cnt, 25), Cells(Row_cnt, 25)).Value = 300
                                Range(Cells(Row_cnt, 26), Cells(Row_cnt, 26)).Value = 300
                                If Sheets("TSIZE").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value < 300 Then
                                   Sheets("TSIZE").Cells(Gcnt * 20 + 70 + Scnt, Lcnt + 1).Value = 300               '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||151||fffd|t|fffd|F|fffd|C|fffd|X|fffd||fffd|
                                End If
                    End Select
                    '
                    '2014-11-04 Igarashi|fffd||1c9||fffd|
                    '|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd|t|fffd||fffd||fffd|O
                    Range(Cells(Row_cnt, 17), Cells(Row_cnt, 17)).Value = UpperDepthFlg
                    '
                    Row_cnt = Row_cnt + 1
                    '
                Next Ucnt
                
            Next Lcnt
            
        Next Scnt
        
    Next Gcnt

    SET_NOTHING
    '
    '*******************************  1999.11  |fffd||3cd|X|fffd|@|fffd|@**************************************
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range(Cells(2, 1), Cells(Row_cnt, 52)).Select
    Selection.SortSpecial SortMethod:=xlSyllabary, Key1:=Range("A2"), _
        Order1:=xlAscending, Key2:=Range("B2"), Order2:=xlAscending, _
        Key3:=Range("C2"), Order3:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    '*******************************  1999.11  |fffd||3cd|X|fffd|@|fffd|@**************************************
    '
    Exit Sub
    '
TSCFILE_ERR:
    ERR_FLG = 1
    SET_NOTHING
    If SYORI_FLG = "S" Then
       Sheets("ERMSG").Select
       Sheets("ERMSG").Range("D9").Value = "|fffd|I|fffd|T|fffd|C|fffd|G|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||30f||fffd||fffd||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
       Sheets("ERMSG").Range("D12").Value = ""
       Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
       ActiveWindow.ScrollRow = 1
       ActiveWindow.ScrollColumn = 1
       Range("A1").Select
    End If
    Exit Sub
    
End Sub
'

Sub MakeUpperDepthSheet(hUpperDepthCnt As Integer)
'---------------------------------------------------------
'
'2014-11-04 Igarashi|fffd||1c9||fffd|
'
'|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||fffd||fffd||fffd||fffd||939e||fffd||fffd|p|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||c42c|
'
'hUpperDepthCnt     |fffd||fffd||fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||fffd||fffd||97||42cc2||fffd||102||fffd||fffd||fffd|Line|fffd||fffd||fffd|i|fffd|S|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|j
'
'---------------------------------------------------------
On Error GoTo MakeUpperDepthSheet_err

    Dim xlsTextBox As Object
    Dim iGon As Integer
    Dim iSlf As Integer
    Dim iLin As Integer
    Dim iUnt As Integer
    Dim oGonObj As Object
    Dim oSlfObj As Object
    Dim oLinObj As Object
    Dim oUntObj As Object
    Dim iLPos As Double
    Dim iTPos As Double
    Dim iWPos As Double
    Dim iHPos As Double
    Dim diffVal As Double
    Dim iUpperNo As Integer
    Dim iDepthNo As Integer
    Dim UpperDepthCnt As Integer
    Dim iAllTop As Long
    Dim iAllLeft As Long
    Dim pageArea As Long
    Dim pageAreaB As Long
    Dim pageCell As Object
    Dim pageSetup As Object
    Dim errLine As Integer

    UpperDepthCnt = 1
    iAllTop = 0
    iAllLeft = 0
    pageArea = PCPrintPageRow

    '|fffd|u|fffd|b|fffd|N|fffd||fffd|
    errLine = errLine + 1
    BOOK_NAME = Sheets("COUNT").Range("B6").Value
    'TSC|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd|
    FILE_NAME = Workbooks(BOOK_NAME).Sheets("COUNT").Range("E6")

    errLine = errLine + 1
    Set tsc = Nothing
On Error GoTo e
    Set tsc = GetObject(FILE_NAME, "Tsc.Document")
GoTo go:
e:
    Set tsc = GetObject(FILE_NAME, "Tsc.Document")
go:

    'MDL|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|i|fffd||fffd||fffd|f|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|j|fffd||fffd||fffd||64fe|
    Call MDL_GET_RTN

    errLine = errLine + 1
    Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select

    '|fffd|s|fffd||30d||fffd||fffd||fffd||fffd||fffd||752||fffd|
    errLine = errLine + 1
    Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Rows("1:" & Trim(CStr(pageArea))).RowHeight = PCSheetRowHeight

    DoEvents

    For iGon = 1 To MDL.CountGondola
        Set oGonObj = MDL.NthGondola(iGon)
        '
        '|fffd|y|fffd|[|fffd|W|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||752||fffd|
        If iGon = 1 Then Call SetPageTitle(iGon, 0)
        '
        For iSlf = 1 To oGonObj.CountShelf
            Set oSlfObj = oGonObj.NthShelf(iSlf)
            '
            If oSlfObj.CountLine <> 0 Then
                For iLin = 1 To oSlfObj.CountLine
                    '
                    iUpperNo = 0
                    iDepthNo = 0
                    '
                    Set oLinObj = oSlfObj.NthLine(iLin)
                    '
                    If oLinObj.UpperDepthFlg = 1 And oLinObj.CountUnit > 1 Then
                        '
                        If (UpperDepthCnt > PCMaxPageLine) And (UpperDepthCnt Mod PCMaxPageLine = 1) Then
                            '-----------------------------
                            '|fffd|P|fffd|y|fffd|[|fffd|W|fffd||fffd|Line|fffd||fffd||fffd||12d02||fffd||fffd||fffd||fffd||fffd|...
                            '-----------------------------
                            iAllTop = iAllTop + PCNextPageInterval
                            iAllLeft = 0
                            '
                            '|fffd|P|fffd|y|fffd|[|fffd|W|fffd||308||fffd||fffd||fffd||348||342||fffd||fffd|w|fffd||fffd|
                            Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").HPageBreaks.Add before:=Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Cells(pageArea, "A")
                            '
                            '|fffd|y|fffd|[|fffd|W|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||752||fffd|
                            Call SetPageTitle(iGon, pageArea - 1)
                            '
                            pageAreaB = pageArea
                            pageArea = pageArea + PCPrintPageRow - 1
                            Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Rows(Trim(CStr(pageAreaB)) & ":" & Trim(CStr(pageArea))).RowHeight = PCSheetRowHeight
                        End If
                        '
                        'Line|fffd||fffd||fffd||30d||151||fffd||fffd|i|fffd||fffd||fffd||18d||151||525c||fffd|s|fffd||fffd||fffd||fffd||fffd||64fe||fffd|idMaxUpperCnt|fffd|AdMaxDepthCnt|fffd||252|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd|j
                        Call MaxUpperDepthCnt(oLinObj)
                        '
                        iTPos = 0
                        iLPos = 0
                        iWPos = PCMaxGroupWidthSize / dMaxDepthCnt
                        iHPos = PCMaxGroupHeightSize / dMaxUpperCnt
                        diffVal = PCAvgTextHeightSize - iHPos
                        '
                        For iUnt = 1 To oLinObj.CountUnit
                            Set oUntObj = oLinObj.NthUnit(iUnt)
                            '
                            If iUpperNo = 0 And iDepthNo = 0 Then
                                iUpperNo = 1
                                iDepthNo = 1
                                iTPos = PCTextBoxStartTop + (diffVal) + iAllTop
                                iLPos = PCTextBoxStartLeft + iAllLeft
                            ElseIf iDepthNo < oUntObj.DepthNo Then
                                iUpperNo = 1
                                iDepthNo = iDepthNo + 1
                                iTPos = (iHPos * dMaxUpperCnt) + (diffVal) + iAllTop
                                iLPos = iLPos + iWPos
                            ElseIf iUpperNo < oUntObj.UpperNo Then
                                iUpperNo = iUpperNo + 1
                                If iDepthNo <> oUntObj.DepthNo Then
                                    iDepthNo = 1
                                    iLPos = iLPos + iWPos
                                Else
                                    iTPos = iTPos - iHPos
                                End If
                            End If
                            '
                            '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||315|`|fffd||fffd|
                            Set xlsTextBox = Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Shapes.AddTextbox(1, iLPos, iTPos, iWPos, iHPos)
                            With xlsTextBox
                                .TextFrame.Characters.Text = ConvUnitParam(oUntObj)     '|fffd||fffd||fffd|i|fffd||fffd||fffd|
                                .TextFrame.Characters.Font.Size = 8                     '|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y
                                .TextFrame.HorizontalAlignment = -4108                  'xlCenter |fffd||fffd||fffd|z|fffd|u
                                .TextFrame.VerticalAlignment = -4108                    'xlCenter |fffd|c|fffd|z|fffd|u
                                .Line.ForeColor.RGB = RGB(0, 0, 0)                      '|fffd||fffd||fffd||310|F
                                .Fill.ForeColor.RGB = RGB(255, 255, 255)                '|fffd|h|fffd||fffd||82||502||fffd||fffd||310|F
                            End With
                        Next iUnt
                        '
                        'Line|fffd||fffd||fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||752||fffd|
                        Call SetUpperDepthLineTitle(UpperDepthCnt, iAllTop, iAllLeft)
                        '
                        '|fffd||fffd||fffd||30f||fffd||fffd|i|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||a3ca||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                        If UpperDepthCnt Mod PCMaxPageLine <> 0 Then
                            If UpperDepthCnt Mod PCMaxColLine <> 0 Then
                                iAllLeft = iAllLeft + PCGroupIntervalWidth
                            Else
                                iAllTop = iAllTop + PCGroupIntervalHeight
                                iAllLeft = 0
                            End If
                        End If
                        '
                        UpperDepthCnt = UpperDepthCnt + 1
                        '
                    End If
                    '
                Next iLin
                '
            End If
            '
        Next iSlf
        '
    Next iGon

    DoEvents

    '|fffd|e|fffd|V|fffd|[|fffd|g|fffd||303|y|fffd|[|fffd|W|fffd||752||fffd|
    errLine = errLine + 1
    On Error Resume Next            '|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd|h|fffd||fffd||fffd|C|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||202||fffd||fffd||197||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||389||fffd|
    With Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").pageSetup
        .Zoom = False               '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||242|P|fffd|y|fffd|[|fffd|W|fffd||24e||fffd||fffd||7c2||fffd||60a4||fffd||fffd|
        .FitToPagesWide = 1         '|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||24d||fffd||fffd||d0b9||fffd||108||fffd||fffd||fffd|i|fffd||fffd||fffd|j
        .FitToPagesTall = False     '|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||24d||fffd||fffd||d0b9||fffd||108||fffd||fffd||fffd|i|fffd|c|fffd|j
        .CenterHorizontally = True  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd|
        .CenterVertically = False   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd|
        .LeftMargin = Application.InchesToPoints(0.393700787401575)
        .RightMargin = Application.InchesToPoints(0.393700787401575)
        .TopMargin = Application.InchesToPoints(0.590551181102362)
        .BottomMargin = Application.InchesToPoints(0.393700787401575)
        .HeaderMargin = Application.InchesToPoints(0.511811023622047)
        .FooterMargin = Application.InchesToPoints(0.511811023622047)
    End With

    '|fffd|S|fffd||302||308||fffd||fffd||fffd||348||342||fffd||752||fffd|
    errLine = errLine + 1
    Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select
    Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Activate
    ActiveSheet.pageSetup.PrintArea = "$A$1:$" & "AD" & "$" & pageArea

    Exit Sub
MakeUpperDepthSheet_err:
    MsgBox "|fffd|I|fffd||fffd||fffd|\(|fffd|T|fffd|u|fffd|||fffd||fffd||fffd|C|fffd||fffd|)" & Chr(13) & "|fffd|G|fffd||fffd||fffd|[LINE = " & CStr(errLine) & "TSC|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = " & FILE_NAME & Chr(13) & Err.Number & "|fffd|F" & Err.Description, vbExclamation, "MakeUpperDepthSheet"
    Err.Clear
End Sub

Sub SetPageTitle(hGon As Integer, hPageArea As Long)
'-----------------------------------------------------------------
'
'2014-11-04 Igarashi|fffd||1c9||fffd|
'
'|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||c42c|
'
'hGon               |fffd||fffd||fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||50d||fffd|
'hPageArea          |fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|\|fffd||fffd|t|fffd||fffd||fffd||fffd|TOP|fffd||308||292|u
'
'|fffd||fffd|2014-11-04|fffd||fffd||fffd||742||343|y|fffd|[|fffd|W|fffd||fffd||fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||34c||152||fffd||302||fffd||fffd||7c1|AhGon|fffd|AhPageArea|fffd||356||fffd||fffd|g|fffd|p
'
'
'-----------------------------------------------------------------
On Error GoTo SetPageTitle_err

    Dim r As String
    Dim Range As Object

    r = "B" & Trim(CStr(hPageArea + 2))
    'Set Range = Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Range(r)

    '|fffd|^|fffd|C|fffd|g|fffd||fffd|
    Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Range(r).Value = "|fffd||fffd||fffd||fffd||30f||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i"
    With Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Range(r).Font
        .Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
        .Size = 12
    End With

    Exit Sub
SetPageTitle_err:
    MsgBox "|fffd|I|fffd||fffd||fffd|\(|fffd|T|fffd|u|fffd|||fffd|^|fffd|C|fffd|g|fffd||fffd|)" & Chr(13) & Err.Number & "|fffd|F" & Err.Description, vbExclamation, "SetPageTitle"
    Err.Clear
End Sub

Sub MaxUpperDepthCnt(hOLinObj As Object)
'-----------------------------------------------------------------
'
'2014-11-04 Igarashi|fffd||1c9||fffd|
'
'Line|fffd||fffd||fffd||30d||151||fffd||fffd|i|fffd||fffd||fffd||18d||151||525c||fffd|s|fffd||fffd||fffd||fffd||fffd||64fe|
'
'hOLinObj       |fffd||fffd|Line|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
'
'-----------------------------------------------------------------
On Error GoTo MaxUpperDepthCnt_err

    Dim oUntObj As Object
    Dim iUnt As Integer
    Dim iUpperNo As Integer
    Dim iDepthNo As Integer
    Dim maxUpperNo As Integer
    Dim maxDepthNo As Integer

    iUpperNo = 0
    iDepthNo = 0
    maxUpperNo = 0
    maxDepthNo = 0

    For iUnt = 1 To hOLinObj.CountUnit
        Set oUntObj = hOLinObj.NthUnit(iUnt)
        '
        If iUpperNo = 0 And iDepthNo = 0 Then
            iUpperNo = 1
            iDepthNo = 1
        ElseIf iDepthNo < oUntObj.DepthNo Then
            iUpperNo = 1
            iDepthNo = iDepthNo + 1
        ElseIf iUpperNo < oUntObj.UpperNo Then
            iUpperNo = iUpperNo + 1
            If iDepthNo <> oUntObj.DepthNo Then
                iDepthNo = 1
            End If
        End If

        If maxUpperNo < iUpperNo Then maxUpperNo = iUpperNo
        If maxDepthNo < iDepthNo Then maxDepthNo = iDepthNo

    Next iUnt

    dMaxUpperCnt = maxUpperNo
    dMaxDepthCnt = maxDepthNo

    Exit Sub
MaxUpperDepthCnt_err:
    MsgBox "|fffd|I|fffd||fffd||fffd|\(|fffd|T|fffd|u|fffd|||fffd||151||fffd||fffd|i|fffd||fffd||fffd|E|fffd||fffd||fffd|s|fffd||fffd|)" & Chr(13) & Err.Number & "|fffd|F" & Err.Description, vbExclamation, "MaxUpperDepthCnt"
    Err.Clear
End Sub

Public Sub SetUpperDepthLineTitle(hUpperDepthCnt As Integer, hIAllTop As Long, hIAllLeft As Long)
'-----------------------------------------------------------------
'
'2014-11-04 Igarashi|fffd||1c9||fffd|
'
'|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||c42c|
'
'hUpperDepthCnt     |fffd||fffd||fffd||fffd||fffd||96||682||fffd|Line|fffd||fffd||fffd|H
'hIAllTop           |fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|\|fffd||fffd|t|fffd||fffd||fffd||fffd|TOP|fffd||308||292|u
'hIAllLeft          |fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|\|fffd||fffd|t|fffd||fffd||fffd||fffd|LEFT|fffd||308||292|u
'
'-----------------------------------------------------------------
On Error GoTo SetUpperDepthLineTitle_err

    Dim xlsTextBox As Object
    Dim iLPos As Integer
    Dim iTPos As Integer
    Dim iWPos As Integer
    Dim iHPos As Integer

    '|fffd||fffd|i|fffd||fffd|\|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
    iTPos = PCAvgTextHeightSize + hIAllTop
    iLPos = PCTextBoxStartLeft + PCMaxGroupWidthSize + hIAllLeft
    iWPos = PCUpperDepthTitleHeight
    iHPos = PCMaxGroupHeightSize
    Set xlsTextBox = Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Shapes.AddTextbox(1, iLPos, iTPos, iWPos, iHPos)
    With xlsTextBox
        .TextFrame.Characters.Text = "|fffd||fffd|" & vbCrLf & "|fffd||fffd|" & vbCrLf & "|fffd|i" & vbCrLf & "|fffd||fffd|"
        .TextFrame.Characters.Font.Size = 10                    '|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y
        .TextFrame.HorizontalAlignment = -4108                  'xlCenter |fffd||fffd||fffd|z|fffd|u
        .TextFrame.VerticalAlignment = -4108                    'xlCenter |fffd|c|fffd|z|fffd|u
        .Line.ForeColor.RGB = RGB(0, 0, 0)                      '|fffd||fffd||fffd||310|F
        .Fill.ForeColor.RGB = RGB(214, 209, 204)                '|fffd|h|fffd||fffd||82||502||fffd||fffd||310|F
    End With

    '|fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
    iTPos = PCAvgTextHeightSize + PCMaxGroupHeightSize + hIAllTop
    iLPos = PCTextBoxStartLeft + hIAllLeft
    iWPos = PCMaxGroupWidthSize
    iHPos = PCUpperDepthTitleHeight
    Set xlsTextBox = Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Shapes.AddTextbox(1, iLPos, iTPos, iWPos, iHPos)
    With xlsTextBox
        .TextFrame.Characters.Text = "|fffd||fffd| |fffd||fffd||fffd|s |fffd||fffd|"
        .TextFrame.Characters.Font.Size = 10                    '|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y
        .TextFrame.HorizontalAlignment = -4108                  'xlCenter |fffd||fffd||fffd|z|fffd|u
        .TextFrame.VerticalAlignment = -4108                    'xlCenter |fffd|c|fffd|z|fffd|u
        .Line.ForeColor.RGB = RGB(0, 0, 0)                      '|fffd||fffd||fffd||310|F
        .Fill.ForeColor.RGB = RGB(214, 209, 204)                '|fffd|h|fffd||fffd||82||502||fffd||fffd||310|F
    End With

    '|fffd||1c2||fffd|Line|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
    iTPos = PCAvgTextHeightSize - PCUpperDepthTitleHeight + hIAllTop
    iLPos = PCTextBoxStartLeft + hIAllLeft
    iWPos = PCMaxGroupWidthSize
    iHPos = PCUpperDepthTitleHeight
    Set xlsTextBox = Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Shapes.AddTextbox(1, iLPos, iTPos, iWPos, iHPos)
    With xlsTextBox
        .TextFrame.Characters.Text = PCUpperDepthMark & CStr(hUpperDepthCnt)
        .TextFrame.Characters.Font.Size = 12                    '|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y
        .TextFrame.HorizontalAlignment = -4108                  'xlCenter |fffd||fffd||fffd|z|fffd|u
        .TextFrame.VerticalAlignment = -4108                    'xlCenter |fffd|c|fffd|z|fffd|u
        .Line.ForeColor.RGB = RGB(0, 0, 0)                      '|fffd||fffd||fffd||310|F
        .Fill.ForeColor.RGB = RGB(222, 254, 254)                '|fffd|h|fffd||fffd||82||502||fffd||fffd||310|F
    End With

    Exit Sub
SetUpperDepthLineTitle_err:
    MsgBox "|fffd|I|fffd||fffd||fffd|\(|fffd|T|fffd|u|fffd|||fffd|V|fffd|[|fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd|)" & Chr(13) & Err.Number & "|fffd|F" & Err.Description, vbExclamation, "SetUpperDepthLineTitle"
    Err.Clear
End Sub

Function ConvUnitParam(hoUnitObj As Object) As String
'-----------------------------------------------------------------
'
'2014-11-04 Igarashi|fffd||1c9||fffd|
'
'|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||9340||fffd||68d||c42c|
'
'hoUnitObj     |fffd||fffd||fffd||fffd||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
'
'-----------------------------------------------------------------
On Error GoTo ConvUnitParam_err

    Dim i As Integer
    Dim r As String
    Dim setWkString As String
    Dim setLastString As String
    Dim chkFlg As Integer

    setLastString = ""

    '|fffd||fffd||fffd|i|fffd||fffd|
    setWkString = ""
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA12").Value = True Then
        If Workbooks(BOOK_NAME).Sheets("COUNT").Range("D8").Value = 1 Then
            '|fffd||fffd||fffd|[|fffd|J|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||202||fffd|
            If Workbooks(BOOK_NAME).Sheets("COUNT").Range("E8").Value = 1 Then
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||115|\|fffd||fffd|
                setWkString = StrHead(hoUnitObj.Name)
            Else
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||202||fffd||fffd||155|\|fffd||fffd|
                setWkString = hoUnitObj.Name
            End If
        Else
            '|fffd||fffd||fffd|[|fffd|J|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
            If Workbooks(BOOK_NAME).Sheets("COUNT").Range("E8").Value = 1 Then
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||115|\|fffd||fffd|
                setWkString = hoUnitObj.MkName & " " & StrHead(hoUnitObj.Name)
            Else
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||202||fffd||fffd||155|\|fffd||fffd|
                setWkString = hoUnitObj.MkName & " " & hoUnitObj.Name
            End If
        End If
        '
        setLastString = setWkString
    End If

    '|fffd|K|fffd|i
    setWkString = ""
    chkFlg = 0
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA13").Value = True Then
        If Workbooks(BOOK_NAME).Sheets("COUNT").Range("D8").Value = 1 Then
            '|fffd||fffd||fffd|[|fffd|J|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||202||fffd|
            If Workbooks(BOOK_NAME).Sheets("COUNT").Range("E8").Value = 1 Then
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||115|\|fffd||fffd|
                setWkString = StrTail(hoUnitObj.Name)
            Else
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||202||fffd||fffd||155|\|fffd||fffd|
                setWkString = ""
            End If
        Else
            '|fffd||fffd||fffd|[|fffd|J|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
            If Workbooks(BOOK_NAME).Sheets("COUNT").Range("E8").Value = 1 Then
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||115|\|fffd||fffd|
                setWkString = StrTail(hoUnitObj.Name)
            Else
                '|fffd|K|fffd|i|fffd||15a82||fffd||fffd||202||fffd||fffd||155|\|fffd||fffd|
                setWkString = ""
            End If
        End If
        '
        If Trim(setLastString) <> "" Then
            setLastString = setLastString & Chr(10) & setWkString
        Else
            setLastString = setWkString
        End If
        '
        chkFlg = 1
    End If

    '|fffd||fffd||fffd||fffd|
    setWkString = ""
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA14").Value = True Then
        setWkString = CStr(hoUnitObj.price)
        '
        If Trim(setLastString) <> "" Then
            If chkFlg = 1 Then
                setLastString = setLastString & "/" & setWkString
            Else
                setLastString = setLastString & Chr(10) & setWkString
            End If
        Else
            setLastString = setWkString
        End If
    End If

    '|fffd||fffd||fffd|i|fffd|R|fffd|[|fffd|h
    setWkString = ""
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA15").Value = True Then
        setWkString = hoUnitObj.stocode
        '
        If Trim(setLastString) <> "" Then
            setLastString = setLastString & Chr(10) & setWkString
        Else
            setLastString = setWkString
        End If
    End If

    'JAN|fffd|R|fffd|[|fffd|h
    setWkString = ""
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA11").Value = True Then
        setWkString = hoUnitObj.jancode
        '
        If Trim(setLastString) <> "" Then
            setLastString = setLastString & Chr(10) & setWkString
        Else
            setLastString = setWkString
        End If
    End If

    '|fffd|t|fffd|F|fffd|C|fffd|X
    setWkString = ""
    chkFlg = 0
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA16").Value = True Then
        setWkString = CStr(hoUnitObj.face)
        '
        If Trim(setLastString) <> "" Then
            setLastString = setLastString & Chr(10) & setWkString
        Else
            setLastString = setWkString
        End If
        '
        chkFlg = 1
    End If

    '|fffd||3d2|i
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA18").Value = True Then
        setWkString = CStr(hoUnitObj.cap)
        '
        If Trim(setLastString) <> "" Then
            If chkFlg = 1 Then
                setLastString = setLastString & "/" & setWkString
            Else
                setLastString = setLastString & Chr(10) & setWkString
            End If
        Else
            setLastString = setWkString
        End If
        '
        chkFlg = chkFlg + 1
    End If

    '|fffd||fffd||fffd|s
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA17").Value = True Then
        setWkString = CStr(hoUnitObj.ndepth)
        '
        If Trim(setLastString) <> "" Then
            If chkFlg >= 1 Then
                setLastString = setLastString & "/" & setWkString
            Else
                setLastString = setLastString & Chr(10) & setWkString
            End If
        Else
            setLastString = setWkString
        End If
    End If

    '|fffd||fffd||fffd||fffd|
    If Workbooks(BOOK_NAME).Sheets("COUNT").Range("AA19").Value = True Then
        setWkString = CStr(hoUnitObj.Case)
        '
        If Trim(setLastString) <> "" Then
            setLastString = setLastString & Chr(10) & setWkString
        Else
            setLastString = setWkString
        End If
    End If

    ConvUnitParam = setLastString

    Exit Function
ConvUnitParam_err:
    MsgBox "|fffd|I|fffd||fffd||fffd|\(|fffd|T|fffd|u|fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|)" & Chr(13) & Err.Number & "|fffd|F" & Err.Description, vbExclamation, "ConvUnitParam"
    Err.Clear
End Function

Sub TXTFILE_OPEN()
Attribute TXTFILE_OPEN.VB_ProcData.VB_Invoke_Func = " \n14"

Dim FNAME_LEN                    As Integer
Dim TXT_NAME                     As String
'
    'On Error GoTo TXTFILE_ERR
     
    ' |fffd||fffd||110||fffd||30a|J|fffd|n|fffd|s|fffd||fffd|
    CELL_CLEAR
           
    '--- |fffd|I|fffd||fffd||fffd||77d||fffd||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
    
    'FILE_DIR = Workbooks(BOOK_NAME).Sheets("COUNT").Range("D6")
    'ChDrive Left(FILE_DIR, 1)
    'ChDir FILE_DIR
    FILE_NAME = Application.GetOpenFilename("|fffd|I|fffd||fffd||fffd||7b0||fffd| |327||fffd||fffd| (*.txt),*.txt,|fffd||fffd||fffd||5c2||102||fffd||327||fffd||fffd| (*.*),*.*")
    If FILE_NAME = False Then
       MsgBox "|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||313||1c2||74d||fffd||fffd||74f||fffd||fffd||fffd||fffd||341|A|fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
       Worksheets("PARAM2").Select
       Range("A1").Select
       Exit Sub
    End If
    'MsgBox FILE_NAME
'
    Application.DisplayAlerts = False
    Windows(BOOK_NAME).Activate
    Workbooks.OpenText FileName:=FILE_NAME, StartRow:=1, _
        DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, _
        Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 2), Array(5, 2), Array(6, 2), Array(7, 1), _
         Array(8, 2), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), _
         Array(19, 1), Array(20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), Array(25, 1), Array(26, 1))
    '
    '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    FNAME_LEN = Len(FILE_NAME)
    For ix = FNAME_LEN To 1 Step -1
       If Mid(FILE_NAME, ix, 1) = "\" Then
          Exit For
       End If
    Next ix
    Workbooks(BOOK_NAME).Sheets("COUNT").Range("M6") = Mid(FILE_NAME, 1, ix - 1)         '|fffd||fffd||fffd||fffd|TXT|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|@|fffd|p|fffd|X
    TXT_NAME = Mid(FILE_NAME, ix + 1, FNAME_LEN - ix)
    Workbooks(BOOK_NAME).Sheets("COUNT").Range("O6") = TXT_NAME                          '|fffd||fffd||fffd||fffd|TXT|fffd|t|fffd|@|fffd|C|fffd||fffd|  |fffd||fffd||fffd||fffd|
   '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    '
    Windows(TXT_NAME).Activate
    Cells.Select
    Selection.Copy
    Windows(BOOK_NAME).Activate
    Sheets("DSHEET").Select
    Cells.Select
    ActiveSheet.Paste
    Range("A1").Select
    Windows(TXT_NAME).Activate
    Range("A1").Select
    ActiveWorkbook.Close
    '
    Windows(BOOK_NAME).Activate
    SHEET_NAME = "COUNT"
    RECALC_RTN
    If Sheets("COUNT").Range("J6") <= 0 Then
       MsgBox "|fffd|I|fffd||fffd||fffd||fffd||fffd||a0bd|txt|fffd|t|fffd|@|fffd|C|fffd||fffd|(" & FILE_NAME & ")|fffd||241|@|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
       Windows(BOOK_NAME).Activate
       Worksheets("PARAM2").Select
       Range("A1").Select
       Exit Sub
    End If
    '
    Worksheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Columns("A:Z").Select
    Selection.EntireColumn.Hidden = False
    ix = Sheets("COUNT").Range("J6")
    Sheets("DSHEET").Select                        '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|I|fffd|i|fffd||fffd||fffd|f|fffd|[|fffd|^
    Range("A1:T2").Select
    Selection.Copy
    Sheets("COUNT").Select
    Range("B9").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    'Sheets("DSHEET").Select                        'PARAM2|fffd||151|I|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd|
    'Range("AA1:AF1").Select
    'Selection.Copy
    'Sheets("COUNT").Select
    'Range("C8").Select
    'Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, _
    '    SkipBlanks:=False, Transpose:=False
    Sheets("DSHEET").Select                        '|fffd|A|fffd|C|fffd|e|fffd||fffd||fffd||fffd||fffd||182||30f||fffd||fffd|
    Range(Cells(3, 1), Cells(ix, 26)).Select
    Selection.Copy
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("A3").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Select Case Sheets("COUNT").Range("C8").Value
           Case 1
                Range(Cells(3, 25), Cells(ix, 25)).Select            '|fffd||fffd||fffd|i|fffd||fffd|
           Case 2
                Range(Cells(3, 9), Cells(ix, 9)).Select              '|fffd|t|fffd|F|fffd|C|fffd|X|fffd||fffd|
           Case 3
                Range("Z3").Select                                   '|fffd||fffd||fffd||fffd|l
    End Select
    Selection.Copy
    Range(Cells(3, 26), Cells(ix, 26)).Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    '
    Sheets("DSHEET").Select
    Cells.Select
    Selection.ClearContents
    Range("A1").Select
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Columns("L:L").Select
    Selection.EntireColumn.Hidden = True
    Columns("N:N").Select
    Selection.EntireColumn.Hidden = True
    Columns("Y:AZ").Select
    Selection.EntireColumn.Hidden = True
    Range("A1").Select
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollColumn = 1
    Range("A3").Select
    Application.ScreenUpdating = True
    Exit Sub

TXTFILE_ERR:
    MsgBox "txt|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & Chr$(13) & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B", 64, "|fffd|I|fffd||fffd||fffd|\|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|"
    Windows(BOOK_NAME).Activate
    Worksheets("PARAM2").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub OPT_PROTECT()
Attribute OPT_PROTECT.VB_ProcData.VB_Invoke_Func = " \n14"
    Worksheets("PARAM2").OptionButtons("OPT_M1").Value = xlOff
    Worksheets("PARAM2").OptionButtons("OPT_M2").Value = xlOff
    Worksheets("PARAM2").OptionButtons("OPT_S1").Value = xlOff
    Worksheets("PARAM2").OptionButtons("OPT_S2").Value = xlOff
    Worksheets("PARAM2").OptionButtons("OPT_M1").Enabled = False
    Worksheets("PARAM2").OptionButtons("OPT_M2").Enabled = False
    Worksheets("PARAM2").OptionButtons("OPT_S1").Enabled = False
    Worksheets("PARAM2").OptionButtons("OPT_S2").Enabled = False
    'Worksheets("PARAM2").OptionButtons("OPT_M1").Visible = False
    'Worksheets("PARAM2").OptionButtons("OPT_M2").Visible = False
    'Worksheets("PARAM2").OptionButtons("OPT_S1").Visible = False
    'Worksheets("PARAM2").OptionButtons("OPT_S2").Visible = False
End Sub
'
Sub OPT_UNPROTECT()
Attribute OPT_UNPROTECT.VB_ProcData.VB_Invoke_Func = " \n14"
    'Worksheets("PARAM2").OptionButtons("OPT_M1").Visible = True
    'Worksheets("PARAM2").OptionButtons("OPT_M2").Visible = True
    'Worksheets("PARAM2").OptionButtons("OPT_S1").Visible = True
    'Worksheets("PARAM2").OptionButtons("OPT_S2").Visible = True
    Worksheets("PARAM2").OptionButtons("OPT_M1").Enabled = True
    Worksheets("PARAM2").OptionButtons("OPT_M2").Enabled = True
    Worksheets("PARAM2").OptionButtons("OPT_S1").Enabled = True
    Worksheets("PARAM2").OptionButtons("OPT_S2").Enabled = True
End Sub
'
Sub CELL_CLEAR()
Attribute CELL_CLEAR.VB_ProcData.VB_Invoke_Func = " \n14"

    '-- |fffd||642||338||631||fffd| --
    BOOK_NAME = Application.ActiveWorkbook.Name
    Windows(BOOK_NAME).Activate
    Worksheets("COUNT").Select
    Range("B9:U9").Select
    Selection.ClearContents
    Range("B11:U22").Select
    Selection.ClearContents
    Range("A1").Select
    '
    Worksheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Columns("L:L").Select
    Selection.EntireColumn.Hidden = False
    Columns("N:N").Select
    Selection.EntireColumn.Hidden = False
    Columns("Y:AZ").Select
    Selection.EntireColumn.Hidden = False
    Range(Cells(3, 1), Cells(3500, 14)).Select
    Selection.ClearContents
    Range(Cells(3, 25), Cells(3500, 34)).Select
    Selection.ClearContents
    Range("A1").Select
    '
    Sheets("TSIZE").Select
    Range("B5:U5").Select
    Selection.ClearContents
    Range("B9:U9").Select
    Selection.ClearContents
    Range("B11:U22").Select
    Selection.ClearContents
    For ix = 91 To 471 Step 20
        Range("B" & ix & ":AE" & ix + 11).Select
        Selection.ClearContents
    Next ix
    Range("A1").Select
    SHEET_NAME = "TSIZE"
    RECALC_RTN
    '
    Sheets("COUNT").Select
    Range("B9:U22").Select
    Selection.ClearContents
    For ix = 91 To 471 Step 20
        Range("B" & ix & ":AE" & ix + 11).Select
        Selection.ClearContents
    Next ix
    SHEET_NAME = "COUNT"
    RECALC_RTN
    Range("A1").Select
End Sub
'
Sub TANADATA_GMN()
Attribute TANADATA_GMN.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    '
    Columns("N:N").Select   '2014-11-04 Igarashi|fffd|C|fffd||fffd|
    Selection.EntireColumn.Hidden = True
    Columns("P:P").Select   '2014-11-04 Igarashi|fffd|C|fffd||fffd|
    Selection.EntireColumn.Hidden = True
    Columns("Q:Q").Select   '2014-11-04 Igarashi|fffd||1c9||fffd|
    Selection.EntireColumn.Hidden = True
    '
    Columns("Y:AZ").Select
    Selection.EntireColumn.Hidden = True
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
End Sub
'
Sub SET_NOTHING()
Attribute SET_NOTHING.VB_ProcData.VB_Invoke_Func = " \n14"
    Set UNT = Nothing
    Set LIN = Nothing
    Set SHL = Nothing
    Set GON = Nothing
    Set MDL = Nothing
    Set pat = Nothing
    Set COR = Nothing
    'KDY 07/09/13
'    Set tsc = Nothing
End Sub
'
Function StrHead(s As String)
Attribute StrHead.VB_ProcData.VB_Invoke_Func = " \n14"
    cnt = 0
    For i = Len(s) To 1 Step -1
        c = Mid(s, i, 1)
        If c = " " Or c = "|fffd|@" Then
            cnt = i
            Exit For
        End If
    Next i
    If cnt > 1 Then
       StrHead = Left(s, cnt - 1)
    Else
       StrHead = Left(s, Len(s))
    End If
End Function
'
Function StrTail(s As String)
Attribute StrTail.VB_ProcData.VB_Invoke_Func = " \n14"
    cnt = 0
    For i = Len(s) To 1 Step -1
        c = Mid(s, i, 1)
        If c = " " Or c = "|fffd|@" Then
            cnt = i
            Exit For
        End If
    Next i
    If cnt > 1 Then
       StrTail = Mid(s, cnt + 1)
    Else
       StrTail = ""
    End If
End Function
'
Sub PARAM_SET()
Attribute PARAM_SET.VB_ProcData.VB_Invoke_Func = " \n14"
'
'|fffd|X|fffd||716||fffd||fffd|E|fffd||fffd||fffd||a5bc||fffd|E|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|E|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|E|fffd||fffd||fffd||501|@|fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||349||fffd||282||243|Z|fffd|b|fffd|g
'
    Sheets("PARAM").Range("E5").Value = ""                                                              '|fffd|X|fffd||716||fffd||fffd|Z|fffd|b|fffd|g
    Sheets("PARAM").Range("E7").Value = Trim(Sheets("TSIZE").Range("CA2").Value)                        '|fffd||fffd||fffd||a5bc||fffd|Z|fffd|b|fffd|g
    '
    Sheets("PARAM").Range("E9").Value = Trim(Sheets("TSIZE").Range("CC2").Value)                        '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    Sheets("PARAM").Range("E11").Value = Trim(Sheets("TSIZE").Range("CE2").Value)                       '|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    If Sheets("TSIZE").Range("CF2").Value = "" Or Sheets("TSIZE").Range("CF2").Value = "//" Then        '|fffd||fffd||fffd||503|Z|fffd|b|fffd|g
       If Sheets("TSIZE").Range("CG2").Value = "" Or Sheets("TSIZE").Range("CG2").Value = "//" Then
          Sheets("PARAM").Range("E13").Value = "   "
       Else
          Sheets("PARAM").Range("E13").Value = "|fffd|@|fffd|`|fffd|@" & Trim(Sheets("TSIZE").Range("CG2").Value)
       End If
    Else
       If Sheets("TSIZE").Range("CG2").Value = "" Or Sheets("TSIZE").Range("CG2").Value = "//" Then
          Sheets("PARAM").Range("E13").Value = Trim(Sheets("TSIZE").Range("CF2").Value) & "|fffd|@|fffd|`|fffd|@"
       Else
          Sheets("PARAM").Range("E13").Value = Trim(Sheets("TSIZE").Range("CF2").Value) & "|fffd|@|fffd|`|fffd|@" & Trim(Sheets("TSIZE").Range("CG2").Value)
       End If
    End If
End Sub
'
Sub VERSION_INFO()                      '|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute VERSION_INFO.VB_ProcData.VB_Invoke_Func = " \n14"
    
    MsgBox "|fffd|I|fffd|T|fffd|C|fffd|G|fffd||fffd||fffd|X|fffd|@|fffd|T|fffd|||fffd|[|fffd|g|fffd|p|fffd|b|fffd|N" & Chr$(13) & Chr(10) & "Version|fffd|@05.02.01", 64, "|fffd|I|fffd||fffd||fffd|\|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

End Sub
'
Sub END_RTN()             '|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd|
Attribute END_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
Dim LIST_NAME                  As String
    '
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    '
    LIST_NAME = Application.ActiveSheet.Name
    Clicked = MsgBox(PROMPT:="|fffd|I|fffd||fffd||fffd|\|fffd||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", _
                              Buttons:=vbOKCancel + _
                                     vbQuestion)
    If Clicked = 1 Then               '|fffd|n|fffd|j|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd|
       'AUTO_CLOSE
       Application.Quit
    Else                              '|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd|
       Sheets(LIST_NAME).Select
       Range("A1").Select
       ActiveWindow.ScrollRow = 1
       ActiveWindow.ScrollColumn = 1
       Range("A1").Select
       Application.ScreenUpdating = True
    End If
    
End Sub

'
'Sub AUTO_CLOSE()
'    Application.ScreenUpdating = False
'    Application.DisplayAlerts = False
'    BOOK_NAME = Application.ActiveWorkbook.Name
'    Workbooks(BOOK_NAME).Activate
'    Workbooks(BOOK_NAME).Saved = True
'    'Workbooks(BOOK_NAME).Close
'    Application.Quit
'End Sub
'

'
Sub OLE_DATA_SET()       '|fffd|e|fffd|X|fffd|g|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||7c2||241|@TSC|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|OLE|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Attribute OLE_DATA_SET.VB_ProcData.VB_Invoke_Func = " \n14"
Dim CUR_MDL        As Object
    BOOK_NAME = Sheets("COUNT").Range("B6").Value
    FILE_NAME = Workbooks(BOOK_NAME).Sheets("COUNT").Range("E6")             'TSC|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd|
    
    'KDY 07/09/13
    Set tsc = Nothing
    Set tsc = GetObject(FILE_NAME, "Tsc.Document")
    '
    'On Error GoTo MDLGET_ERR
    '--- |fffd||fffd||170||fffd||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
    Set COR = tsc.Corner
    '--- |fffd||fffd||fffd||fffd||775||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
    Now_Pcnt = COR.CountPattern
    For Pcnt = 1 To Now_Pcnt
        '*** N|fffd||516||682||fffd||fffd||fffd||fffd||fffd||74f||fffd||fffd|i|fffd||fffd||fffd||fffd||77a||fffd||fffd||781|j|fffd||fffd||fffd||64fe||fffd|I ***
         Set pat = COR.NthPattern(Pcnt)
         If pat.code = Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CB2") Then
             '--- |fffd||fffd||fffd||675||fffd||7bc||7aa||fffd||102||fffd||fffd||64fe||fffd|I ---
             Set MDL = pat.CurModel
             Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CD11") = MDL.code
             Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CE11") = MDL.Name
             '
             Set MDL = pat.RefModel
             Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CD12") = MDL.code
             Workbooks(BOOK_NAME).Sheets("TSIZE").Range("CE12") = MDL.Name
         End If
    Next Pcnt
End Sub
Attribute VB_Name = "Module2"






Option Explicit
'
Sub PRINT_RTN()
Attribute PRINT_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    On Error GoTo PRINT_RTN_ERR
    '
    ActiveSheet.PrintPreview
    'ActiveWindow.SelectedSheets.PrintOut Copies:=1
    Exit Sub
    Application.ScreenUpdating = True
    '
PRINT_RTN_ERR:
    MsgBox "|fffd|v|fffd||fffd||fffd|r|fffd||fffd||fffd|[|fffd||fffd||282||fffd|\|fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & Chr$(13) & Chr(10) & "|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B", 16, "|fffd|\|fffd||fffd||fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|["
    Exit Sub
End Sub
'
Sub GAMEN1_SEL()
Attribute GAMEN1_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST1").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN2_SEL()
Attribute GAMEN2_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST2").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN3_SEL()
Attribute GAMEN3_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST3").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN4_SEL()
Attribute GAMEN4_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST4").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN5_SEL()
Attribute GAMEN5_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST5").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN6_SEL()
Attribute GAMEN6_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST6").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN7_SEL()
Attribute GAMEN7_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST7").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN8_SEL()
Attribute GAMEN8_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST8").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN9_SEL()
Attribute GAMEN9_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST9").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN10_SEL()
Attribute GAMEN10_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST10").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN11_SEL()
Attribute GAMEN11_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST11").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN12_SEL()
Attribute GAMEN12_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST12").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN13_SEL()
Attribute GAMEN13_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST13").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN14_SEL()
Attribute GAMEN14_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST14").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN15_SEL()
Attribute GAMEN15_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST15").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN16_SEL()
Attribute GAMEN16_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST16").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN17_SEL()
Attribute GAMEN17_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST17").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN18_SEL()
Attribute GAMEN18_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST18").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN19_SEL()
Attribute GAMEN19_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST19").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN20_SEL()
Attribute GAMEN20_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    Sheets("LIST20").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN_BEFORE_SEL()
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    '
    Dim backNo As Integer
    Application.ScreenUpdating = False
    backNo = Sheets("COUNT").Range("B7").Value
    If backNo > 0 Then
        Sheets("LIST" & Trim(backNo)).Select
        Range("A1").Select
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1
        Range("A1").Select
    End If
    Application.ScreenUpdating = True
End Sub
'
Sub GAMEN_UPPERDEPTH_SEL()
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    '
    Dim backNo As Integer
    Application.ScreenUpdating = False
    Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
End Sub
'
Sub TANADAT_SEL()
Attribute TANADAT_SEL.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    TANADATA_GMN
    Application.ScreenUpdating = True
End Sub
'
Sub TANADAT_PRINT()              '|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||288||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute TANADAT_PRINT.VB_ProcData.VB_Invoke_Func = " \n14"

    Application.ScreenUpdating = False
    On Error GoTo TANADAT_PRINT_ERR
    '
    W_STO = Trim(Sheets("PARAM").Range("E5").Value)
    W_COR = Trim(Sheets("PARAM").Range("E7").Value)                    '|fffd||fffd||fffd||a5bc||fffd|Z|fffd|b|fffd|g
    W_PAT = Trim(Sheets("PARAM").Range("E9").Value)                     '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    W_MDL = Trim(Sheets("PARAM").Range("E11").Value)                    '|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    SHEET_NAME = "|fffd|I|fffd||fffd||fffd||7b0||fffd|"
    RECALC_RTN
    SHEET_NAME = "COUNT"
    RECALC_RTN
    ix = Sheets("COUNT").Range("B8").Value
    '
    If ix < 1 Then
       MsgBox "|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||fffd||702||fffd||fffd||fffd|B"
       Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
       Range("A1").Select
       Exit Sub
    End If
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    If Trim(Sheets("PARAM").Range("E5").Value) = "" Then        '|fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       With ActiveSheet.pageSetup
           .LeftHeader = "|fffd||fffd||fffd||fffd|F" & W_COR & "|fffd|@|fffd|@|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|F" & W_PAT & "|fffd|@|fffd|@|fffd||fffd||fffd|f|fffd||fffd||fffd|F" & W_MDL
       End With
    Else
       With ActiveSheet.pageSetup                          '|fffd|X|fffd||70f||fffd||fffd||fffd||fffd||fffd|
           .LeftHeader = "|fffd|X|fffd||701|F" & W_STO & "|fffd|@|fffd|@|fffd||fffd||fffd||fffd|F" & W_COR & "|fffd|@|fffd|@|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|F" & W_PAT & "|fffd|@|fffd|@|fffd||fffd||fffd|f|fffd||fffd||fffd|F" & W_MDL
       End With
    End If
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    With ActiveSheet.pageSetup
        .PrintTitleRows = "$2:$2"
        .PrintTitleColumns = ""
    End With
    ActiveSheet.pageSetup.PrintArea = "$A$3:$N$" & ix + 2
    '
    If Sheets("COUNT").Range("G8").Value = 1 Then          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|c
       If Sheets("COUNT").Range("F8").Value = 1 Then        '|fffd|`|fffd|S|fffd|c
          With ActiveSheet.pageSetup
              .CenterHorizontally = True
              .CenterVertically = False
              .Orientation = xlPortrait
              .Draft = False
              .PaperSize = xlPaperA4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       Else                                                 '|fffd|a|fffd|S|fffd|c
          With ActiveSheet.pageSetup
              .CenterHorizontally = True
              .CenterVertically = False
              .Orientation = xlPortrait
              .Draft = False
              .PaperSize = xlPaperB4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       End If
    Else
       If Sheets("COUNT").Range("F8").Value = 1 Then        '|fffd|`|fffd|S|fffd||fffd|
          With ActiveSheet.pageSetup
              .CenterHorizontally = False
              .CenterVertically = False
              .Orientation = xlLandscape
              .Draft = False
              .PaperSize = xlPaperA4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       Else                                                 '|fffd|a|fffd|S|fffd||fffd|
          With ActiveSheet.pageSetup
              .CenterHorizontally = False
              .CenterVertically = False
              .Orientation = xlLandscape
              .Draft = False
              .PaperSize = xlPaperB4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       End If
    End If
    '
    ActiveSheet.PrintPreview
    '
    TANADATA_GMN
    Application.ScreenUpdating = True
    Exit Sub
    '
TANADAT_PRINT_ERR:
    MsgBox "|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||282||308||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & Chr$(13) & Chr(10) & "|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B", 16, "|fffd|I|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||288||fffd||fffd||fffd|G|fffd||fffd||fffd|["
    Exit Sub
End Sub
'
Sub ALL_PRINT()
Attribute ALL_PRINT.VB_ProcData.VB_Invoke_Func = " \n14"
'
'|fffd|S|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
    Dim LIST_NAME As String
    '
    Application.ScreenUpdating = False
    On Error GoTo ALL_PRINT_ERR

    LIST_NAME = Application.ActiveSheet.Name
    '
    SHEET_NAME = "COUNT"
    RECALC_RTN
    If Sheets("COUNT").Range("B7").Value = 0 Then
       MsgBox "|fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd||c42c||fffd||fffd||fffd||90bd||fffd||7c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd|I|fffd||fffd||fffd|\|fffd||34d||c42c||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B" & Chr$(13) & Chr(10) & "|fffd|]|fffd||fffd||fffd||111|S|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B"
       Sheets(LIST_NAME).Select
       Range("A1").Select
       Exit Sub
    End If
    '
    Clicked = MsgBox(PROMPT:="|fffd||c42c||fffd||fffd||fffd||a0bd||fffd|S|fffd||102||303|S|fffd||fffd||fffd|h|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", Buttons:=vbOKCancel + vbQuestion)
    If Clicked = 1 Then
        '|fffd|n|fffd|j|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd|
        Sheets("MSG").Select
        Range("D19:L19").Select
        Selection.ClearContents
        Sheets("MSG").Range("C9").Value = "|fffd|S|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||312|I|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd|B"
        Sheets("MSG").Select
        Range("A1").Select
        Application.ScreenUpdating = True
        Application.ScreenUpdating = False
        '
        '|fffd||c42c||fffd||fffd||fffd||a0bd||fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        For ix = 1 To Sheets("COUNT").Range("B7").Value
            Sheets("LIST" & ix).Select
            ActiveWindow.SelectedSheets.PrintOut Copies:=1
        Next ix
        '
        '2014-11-04 Igarashi|fffd||1c9||fffd|
        '|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If gUpperDepthCnt <> 1 Then
            Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select
            ActiveWindow.SelectedSheets.PrintOut Copies:=1
        End If
    End If
    '
    Sheets(LIST_NAME).Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
    Exit Sub
    '
ALL_PRINT_ERR:
    MsgBox "|fffd|S|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & Chr$(13) & Chr(10) & "|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B", 16, "|fffd|S|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|["
    Exit Sub
End Sub
'
Sub TANALIST_SAVE()
Attribute TANALIST_SAVE.VB_ProcData.VB_Invoke_Func = " \n14"
'
'|fffd|I|fffd||fffd||fffd|\|fffd||6d1||fffd||fffd||fffd||fffd||fffd|
'
    Dim LIST_NAME                  As String
    Dim NEWBOOK_NAME               As String
    Dim FILE_DIR                   As String
    Dim SHEET_NUM                  As Integer
    Dim SAVE_FLG                   As Boolean
    '
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    BOOK_NAME = Sheets("COUNT").Range("B6").Value
    LIST_NAME = Application.ActiveSheet.Name
    SHEET_NAME = "COUNT"
    RECALC_RTN
    If Sheets("COUNT").Range("B7").Value = 0 Then
        MsgBox "|fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd||c42c||fffd||fffd||fffd||90bd||fffd||7c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||fffd||702||fffd||fffd||fffd|B"
        Sheets(LIST_NAME).Select
        Range("A1").Select
        Exit Sub
    End If
    '
    W_STO = Trim(Sheets("PARAM").Range("E5").Value)
    W_COR = Trim(Sheets("PARAM").Range("E7").Value)         '|fffd||fffd||fffd||a5bc||fffd|Z|fffd|b|fffd|g
    W_PAT = Trim(Sheets("PARAM").Range("E9").Value)         '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    W_MDL = Trim(Sheets("PARAM").Range("E11").Value)        '|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    SHEET_NAME = "|fffd|I|fffd||fffd||fffd||7b0||fffd|"
    RECALC_RTN
    SHEET_NAME = "COUNT"
    RECALC_RTN
    ix = Sheets("COUNT").Range("B8").Value
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    If Trim(Sheets("PARAM").Range("E5").Value) = "" Then
        '|fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        With ActiveSheet.pageSetup
            .LeftHeader = "|fffd||fffd||fffd||fffd|F" & W_COR & "|fffd|@|fffd|@|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|F" & W_PAT & "|fffd|@|fffd|@|fffd||fffd||fffd|f|fffd||fffd||fffd|F" & W_MDL
        End With
    Else
        '|fffd|X|fffd||70f||fffd||fffd||fffd||fffd||fffd|
        With ActiveSheet.pageSetup
            .LeftHeader = "|fffd|X|fffd||701|F" & W_STO & "|fffd|@|fffd|@|fffd||fffd||fffd||fffd|F" & W_COR & "|fffd|@|fffd|@|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd|F" & W_PAT & "|fffd|@|fffd|@|fffd||fffd||fffd|f|fffd||fffd||fffd|F" & W_MDL
        End With
    End If
    '
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    With ActiveSheet.pageSetup
        .PrintTitleRows = "$2:$2"
        .PrintTitleColumns = ""
    End With
    If ix > 0 Then
       ActiveSheet.pageSetup.PrintArea = "$A$3:$N$" & ix + 2
    End If
    '
    If Sheets("COUNT").Range("G8").Value = 1 Then          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|c
       If Sheets("COUNT").Range("F8").Value = 1 Then       '|fffd|`|fffd|S|fffd|c
          With ActiveSheet.pageSetup
              .CenterHorizontally = True
              .CenterVertically = False
              .Orientation = xlPortrait
              .Draft = False
              .PaperSize = xlPaperA4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       Else                                                '|fffd|a|fffd|S|fffd|c
          With ActiveSheet.pageSetup
              .CenterHorizontally = True
              .CenterVertically = False
              .Orientation = xlPortrait
              .Draft = False
              .PaperSize = xlPaperB4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       End If
    Else
       If Sheets("COUNT").Range("F8").Value = 1 Then       '|fffd|`|fffd|S|fffd||fffd|
          With ActiveSheet.pageSetup
              .CenterHorizontally = False
              .CenterVertically = False
              .Orientation = xlLandscape
              .Draft = False
              .PaperSize = xlPaperA4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       Else                                                '|fffd|a|fffd|S|fffd||fffd|
          With ActiveSheet.pageSetup
              .CenterHorizontally = False
              .CenterVertically = False
              .Orientation = xlLandscape
              .Draft = False
              .PaperSize = xlPaperB4
              .FirstPageNumber = xlAutomatic
              .Order = xlDownThenOver
              .BlackAndWhite = True
              .Zoom = 90
          End With
       End If
    End If
    '
    Windows(BOOK_NAME).Activate
    On Error GoTo SAVE_ERR
    '
    '|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||30f||a347||fffd||30f||fffd||fffd||fffd|
    '======================================================================================
    'FILE_DIR = Workbooks(BOOK_NAME).Sheets("COUNT").Range("D6")
    'ChDrive Left(FILE_DIR, 1)
    'ChDir FILE_DIR
     '======================================================================================
    '
    Sheets(LIST_NAME).Select
    Application.ScreenUpdating = True
    Application.ScreenUpdating = False
    FILE_NAME = Application.GetSaveAsFilename(initialfilename:="*****.xls", filefilter:="Excel|327||fffd||fffd| (*.xls),*.xls,|fffd||fffd||fffd||5c2||102||fffd||327||fffd||fffd| (*.*),*.*")
    If FILE_NAME = False Then
       MsgBox "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
       'Windows(NEWBOOK_NAME).Activate
       'ActiveWorkbook.Saved = True
       'ActiveWorkbook.Close
       Windows(BOOK_NAME).Activate
       Sheets(LIST_NAME).Select
       Range("A1").Select
       Exit Sub
    End If
    '
    SHEET_NUM = Application.SheetsInNewWorkbook           '|fffd|V|fffd|KBOOK|fffd|@OPEN
    Application.SheetsInNewWorkbook = 1                   'SHEET|fffd|P|fffd||fffd||fffd||302||742||242||fffd||fffd||fffd|
    Workbooks.Add
    NEWBOOK_NAME = ActiveWorkbook.Name
    Application.SheetsInNewWorkbook = SHEET_NUM
    '
    Windows(BOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Columns("Y:AZ").Select
    Selection.EntireColumn.Hidden = False
    Windows(BOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Copy After:=Workbooks(NEWBOOK_NAME).Sheets(1)
    Windows(NEWBOOK_NAME).Activate
    Sheets("SHEET1").Select
    ActiveSheet.Delete
    '
    Windows(NEWBOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    For ix = 1 To 5
       ActiveSheet.DrawingObjects("BTN" & ix).Select
       Selection.Delete
    Next ix
    Columns("Y:AZ").Select
    Selection.Delete
    '
    '|fffd||c42c||fffd||fffd||fffd||a0bd||fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||183|R|fffd|s|fffd|[
    For ix = 1 To Workbooks(BOOK_NAME).Sheets("COUNT").Range("B7").Value
        Windows(BOOK_NAME).Activate
        Sheets("LIST" & ix).Select
        Sheets("LIST" & ix).Copy After:=Workbooks(NEWBOOK_NAME).Sheets(ix)
    Next ix
    '|fffd||c42c||fffd||fffd||fffd||a0bd||fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||fffd||fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|R|fffd|s|fffd|[
    If gUpperDepthCnt <> 1 Then
        Windows(BOOK_NAME).Activate
        Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select
        Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Copy After:=Workbooks(NEWBOOK_NAME).Sheets(ix)
    End If
    '
    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||303|{|fffd|^|fffd||fffd||fffd||d3dc|
    For ix = 1 To Workbooks(BOOK_NAME).Sheets("COUNT").Range("B7").Value
        Windows(NEWBOOK_NAME).Activate
        Select Case ix
               Case 1       '|fffd||14f||fffd||fffd||303|y|fffd|[|fffd|W
                    For jx = 1 To 8
                       If jx <> 3 Then
                          Sheets("LIST" & ix).Select
                          ActiveSheet.DrawingObjects("BTN" & jx).Select
                          Selection.Delete
                       End If
                    Next jx
               Case 20      '|fffd||14c||fffd||303|y|fffd|[|fffd|W
                    For jx = 1 To 8
                       If jx <> 2 Then
                          Sheets("LIST" & ix).Select
                          ActiveSheet.DrawingObjects("BTN" & jx).Select
                          Selection.Delete
                       End If
                    Next jx
               Case Else    '|fffd||fffd||fffd||311||fffd||fffd||303|y|fffd|[|fffd|W
                    For jx = 1 To 8
                        Sheets("LIST" & ix).Select
                        ActiveSheet.DrawingObjects("BTN" & jx).Select
                        Selection.Delete
                    Next jx
        End Select
    Next ix
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    If gUpperDepthCnt <> 1 Then
        For jx = 1 To 6
            Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select
            ActiveSheet.DrawingObjects("BTN" & jx).Select
            Selection.Delete
        Next jx
    End If
    '
    Windows(NEWBOOK_NAME).Activate
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("A1").Select
    '
    Windows(NEWBOOK_NAME).Activate
    ActiveWorkbook.SaveAs FileName:=FILE_NAME, FileFormat:=xlNormal _
              , Password:="", WriteResPassword:="", ReadOnlyRecommended:= _
               False, CreateBackup:=False
    ActiveWorkbook.Close
    '
    Windows(BOOK_NAME).Activate
    Sheets(LIST_NAME).Select
    MsgBox "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    '
    Application.ScreenUpdating = True
    Exit Sub
    '
SAVE_ERR:
    Windows(BOOK_NAME).Activate
    Sheets(LIST_NAME).Select
    MsgBox "|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24d|s|fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Application.ScreenUpdating = True
    
End Sub

Attribute VB_Name = "Module3"






Option Explicit
'
Sub PRINT_AREA_SET()                '|fffd||fffd||fffd||fffd||348||350||752||fffd|
Attribute PRINT_AREA_SET.VB_ProcData.VB_Invoke_Func = " \n14"
Dim PAPER_SIZE              As String
Dim PRINT_ORIENT            As String
'
    On Error GoTo PRINT_AREA_SET_ERR
    '
    SHEET_NAME = "COUNT"
    RECALC_RTN
    '
    For GON_NUM = 1 To Sheets("COUNT").Range("B7").Value
        SHEET_NAME_RTN
        ix = Sheets("TSIZE").Cells(56, GON_NUM + 1).Value
        Sheets(SHEET_NAME).Select
        If Sheets("COUNT").Range("G8").Value = 1 Then          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|c
           If Sheets("COUNT").Range("F8").Value = 1 Then        '|fffd|`|fffd|S|fffd|c
              FORM_SET
           Else                                                 '|fffd|a|fffd|S|fffd|c
              Range("B2").Select
              With Selection.Font
                   .Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
                   .Size = 36
                   .Strikethrough = False
                   .Superscript = False
                   .Subscript = False
                   .OutlineFont = False
                   .Shadow = False
                   .Underline = xlNone
                   .ColorIndex = xlAutomatic
              End With
              Rows("3:8").Select
              With Selection.Font
                   .Size = 16
                   .Strikethrough = False
                   .Superscript = False
                   .Subscript = False
                   .OutlineFont = False
                   .Shadow = False
                   .Underline = xlNone
                   .ColorIndex = xlAutomatic
              End With
              Rows("9:" & ix).Select
              With Selection.Font
                   .Size = 14
                   .Strikethrough = False
                   .Superscript = False
                   .Subscript = False
                   .OutlineFont = False
                   .Shadow = False
                   .Underline = xlNone
                   .ColorIndex = xlAutomatic
              End With
              Range("A1").Select
           End If
        Else
           FORM_SET                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        End If
        
        '
        Sheets(SHEET_NAME).Select
        Range("B10:BI" & ix).Select
        ActiveSheet.pageSetup.PrintArea = Selection.Address
        With ActiveSheet.pageSetup
            .PrintTitleRows = "$2:$9"
            .PrintTitleColumns = ""
        End With
        ActiveSheet.pageSetup.PrintArea = "$B$10:$BI$" & ix
        '
        If Sheets("COUNT").Range("G8").Value = 1 Then          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|c
           If Sheets("COUNT").Range("F8").Value = 1 Then        '|fffd|`|fffd|S|fffd|c
              Rows("10:" & ix).Select
              Rows("10:" & ix).EntireRow.AutoFit
              Range("A1").Select
              With ActiveSheet.pageSetup
                   .Orientation = xlPortrait
                   .PaperSize = xlPaperA4
                   .Zoom = False
                   .FitToPagesWide = 1
                   .FitToPagesTall = 1
              End With
           Else                                                 '|fffd|a|fffd|S|fffd|c
              With ActiveSheet.pageSetup
                   .Orientation = xlPortrait
                   .PaperSize = xlPaperB4
                   .Zoom = False
                   .FitToPagesWide = 1
                   .FitToPagesTall = 1
              End With
           End If
        Else
           Rows("10:" & ix).Select
           Rows("10:" & ix).EntireRow.AutoFit
           Range("A1").Select
           If Sheets("COUNT").Range("F8").Value = 1 Then        '|fffd|`|fffd|S|fffd||fffd|
              With ActiveSheet.pageSetup
                   .Orientation = xlLandscape
                   .PaperSize = xlPaperA4
                   .Zoom = False
                   .FitToPagesWide = 1
                   .FitToPagesTall = 1
              End With
           Else                                                 '|fffd|a|fffd|S|fffd||fffd|
              With ActiveSheet.pageSetup
                   .Orientation = xlLandscape
                   .PaperSize = xlPaperB4
                   .Zoom = False
                   .FitToPagesWide = 1
                   .FitToPagesTall = 1
              End With
           End If
        End If
        Range("A1").Select
    Next GON_NUM
   Exit Sub
   '
PRINT_AREA_SET_ERR:
    ERR_FLG = 1
    Exit Sub
End Sub
'
Sub FORM_SET()
Attribute FORM_SET.VB_ProcData.VB_Invoke_Func = " \n14"
    Range("B2").Select
    With Selection.Font
         .Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
         .Size = 20
         .Strikethrough = False
         .Superscript = False
         .Subscript = False
         .OutlineFont = False
         .Shadow = False
         .Underline = xlNone
         .ColorIndex = xlAutomatic
    End With
    Rows("3:8").Select
    With Selection.Font
         .Size = 10
         .Strikethrough = False
         .Superscript = False
         .Subscript = False
         .OutlineFont = False
         .Shadow = False
         .Underline = xlNone
         .ColorIndex = xlAutomatic
    End With
    Range("A1").Select
End Sub
'
Sub TITLE_SET()
Attribute TITLE_SET.VB_ProcData.VB_Invoke_Func = " \n14"
Dim TOTAL_GON               As String
Dim NOW_GON                 As String
    '
    Sheets(SHEET_NAME).Range("E6").Value = Trim(Sheets("PARAM").Range("E5").Value)                    '|fffd|X|fffd||716||fffd||fffd|Z|fffd|b|fffd|g
    '
    Sheets(SHEET_NAME).Range("U6").Value = Trim(Sheets("PARAM").Range("E7").Value)                    '|fffd||fffd||fffd||a5bc||fffd|Z|fffd|b|fffd|g
    '
    Sheets(SHEET_NAME).Range("AK6").Value = Trim(Sheets("PARAM").Range("E9").Value)                     '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    Sheets(SHEET_NAME).Range("E8").Value = Trim(Sheets("PARAM").Range("E11").Value)                     '|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    '
    Sheets(SHEET_NAME).Range("U8").Value = Trim(Sheets("PARAM").Range("E13").Value)                     '|fffd||fffd||fffd||503|Z|fffd|b|fffd|g
    '
    TOTAL_GON = StrConv(Sheets("COUNT").Range("B7").Value, 4)          '|fffd|y|fffd|[|fffd|W|fffd|Z|fffd|b|fffd|g
    NOW_GON = StrConv(Str(GON_NUM), 4)
    Sheets(SHEET_NAME).Range("AQ8").Value = NOW_GON & " |fffd|^ " & TOTAL_GON
    '
   If Sheets("COUNT").Range("AA12").Value = True Then             '|fffd||fffd||fffd|i|fffd||fffd|
      Sheets(SHEET_NAME).Range("AZ3").Value = "|fffd|i|fffd||fffd|"
   Else
       Sheets(SHEET_NAME).Range("AZ3").Value = ""
   End If
   '
   If Sheets("COUNT").Range("AA13").Value = True Then                     '|fffd|K|fffd|i
      If Sheets("COUNT").Range("AA14").Value = True Then                  '|fffd||fffd||fffd||fffd|
         Sheets(SHEET_NAME).Range("AZ4").Value = "|fffd|K|fffd|i|fffd|^|fffd||fffd||fffd||fffd|"             '|fffd|K|fffd|i|fffd|^|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd|\|fffd||fffd|
      Else                            '|fffd|K|fffd|i|fffd||302||755|\|fffd||fffd|
         Sheets(SHEET_NAME).Range("AZ4").Value = "|fffd|K|fffd|i"
      End If
   Else                               '|fffd|K|fffd|i|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
      If Sheets("COUNT").Range("AA14").Value = True Then                  '|fffd||fffd||fffd||fffd||fffd||302||755|\|fffd||fffd|
         Sheets(SHEET_NAME).Range("AZ4").Value = "|fffd||fffd||fffd||fffd|"
      Else                                                                '|fffd|K|fffd|i|fffd|E|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
          Sheets(SHEET_NAME).Range("AZ4").Value = ""
      End If
   End If
   '
   If Sheets("COUNT").Range("AA15").Value = True Then                     '|fffd||fffd||fffd|i|fffd|R|fffd|[|fffd|h
      Sheets(SHEET_NAME).Range("AZ5").Value = "|fffd||fffd||fffd|i|fffd|R|fffd|[|fffd|h"
   Else
       Sheets(SHEET_NAME).Range("AZ5").Value = ""
   End If
   '
   If Sheets("COUNT").Range("AA11").Value = True Then                     'JAN|fffd|R|fffd|[|fffd|h
      Sheets(SHEET_NAME).Range("AZ6").Value = "JAN|fffd|R|fffd|[|fffd|h"
   Else
       Sheets(SHEET_NAME).Range("AZ6").Value = ""
   End If
   '
   If Sheets("COUNT").Range("AA16").Value = True Then                     '|fffd|t|fffd|F|fffd|C|fffd|X
      If Sheets("COUNT").Range("AA18").Value = True Then                     '|fffd||3c2||752|i
         If Sheets("COUNT").Range("AA17").Value = True Then                     '|fffd||fffd||fffd|s|fffd||fffd|
            Sheets(SHEET_NAME).Range("AZ7").Value = "|32a||fffd||fffd|/|fffd||3d2|i/|fffd||fffd||fffd|s"              '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|^|fffd||3c2||752|i|fffd|^|fffd||fffd||fffd|s|fffd||fffd||fffd|@|fffd|S|fffd||115|\|fffd||fffd|
         Else
            Sheets(SHEET_NAME).Range("AZ7").Value = "|32a||fffd||fffd|/|fffd||3d2|i"              '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|^|fffd||3c2||752|i |fffd|\|fffd||fffd|
         End If
      Else                                                             '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|\|fffd||fffd||fffd|@|fffd||3c2||752|i|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
         If Sheets("COUNT").Range("AA17").Value = True Then                     '|fffd||fffd||fffd|s|fffd||fffd|
            Sheets(SHEET_NAME).Range("AZ7").Value = "|32a||fffd||fffd|/|fffd||fffd||fffd|s"              '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|^|fffd||fffd||fffd|s|fffd||fffd||fffd|@|fffd|\|fffd||fffd|
         Else
            Sheets(SHEET_NAME).Range("AZ7").Value = "|32a||fffd||fffd|"              '|fffd|t|fffd|F|fffd|C|fffd|X|fffd||302||fffd| |fffd|\|fffd||fffd|
         End If
      End If
   Else
       If Sheets("COUNT").Range("AA18").Value = True Then                     '|fffd||3c2||752|i
         If Sheets("COUNT").Range("AA17").Value = True Then                   '|fffd||fffd||fffd|s|fffd||fffd|
            Sheets(SHEET_NAME).Range("AZ7").Value = "|fffd||3d2|i/|fffd||fffd||fffd|s"              '|fffd||3c2||752|i|fffd|^|fffd||fffd||fffd|s|fffd||fffd||fffd|@|fffd|\|fffd||fffd|
         Else
            Sheets(SHEET_NAME).Range("AZ7").Value = "|fffd||3d2|i"                   '|fffd||3c2||752|i|fffd||302||fffd| |fffd|\|fffd||fffd|
         End If
      Else                                                             '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|E|fffd||3c2||752|i|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
         If Sheets("COUNT").Range("AA17").Value = True Then                   '|fffd||fffd||fffd|s|fffd||fffd|
            Sheets(SHEET_NAME).Range("AZ7").Value = "|fffd||fffd||fffd|s"                     '|fffd||fffd||fffd|s|fffd||fffd||fffd||302||741|@|fffd|\|fffd||fffd|
         Else
            Sheets(SHEET_NAME).Range("AZ7").Value = ""                        '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|^|fffd||3c2||752|i|fffd|^|fffd||fffd||fffd|s|fffd||fffd||fffd|@|fffd|S|fffd||115|\|fffd||fffd||fffd||fffd||fffd||fffd|
         End If
      End If
   End If
   '
   If Sheets("COUNT").Range("AA19").Value = True Then                     '|fffd||fffd||fffd||fffd|
      Sheets(SHEET_NAME).Range("AZ8").Value = "|fffd||fffd||fffd||fffd|"
   Else
      Sheets(SHEET_NAME).Range("AZ8").Value = ""
   End If
   '
End Sub
'
Sub TANA_MOVE()
Attribute TANA_MOVE.VB_ProcData.VB_Invoke_Func = " \n14"
    If DAN_NUM = 0 Or DAN_NUM >= 12 Then
       Exit Sub
    End If
    SHEET_NAME_RTN
    Select Case DAN_NUM
           Case 1
                MOVE_AREA = "B76:BI81"
           Case 2
                MOVE_AREA = "B70:BI81"
           Case 3
                MOVE_AREA = "B64:BI81"
           Case 4
                MOVE_AREA = "B58:BI81"
           Case 5
                MOVE_AREA = "B52:BI81"
           Case 6
                MOVE_AREA = "B46:BI81"
           Case 7
                MOVE_AREA = "B40:BI81"
           Case 8
                MOVE_AREA = "B34:BI81"
           Case 9
                MOVE_AREA = "B28:BI81"
           Case 10
                MOVE_AREA = "B22:BI81"
           Case 11
                MOVE_AREA = "B16:BI81"
           Case Else
                Exit Sub
    End Select
    Sheets(SHEET_NAME).Select
    Range(MOVE_AREA).Select
    Selection.Cut
    Range("B10").Select
    ActiveSheet.Paste
    Range("A1").Select
    '
    Select Case DAN_NUM
           Case 1
                MOVE_AREA = "B16:BI81"
           Case 2
                MOVE_AREA = "B22:BI81"
           Case 3
                MOVE_AREA = "B28:BI81"
           Case 4
                MOVE_AREA = "B34:BI81"
           Case 5
                MOVE_AREA = "B40:BI81"
           Case 6
                MOVE_AREA = "B46:BI81"
           Case 7
                MOVE_AREA = "B52:BI81"
           Case 8
                MOVE_AREA = "B58:BI81"
           Case 9
                MOVE_AREA = "B64:BI81"
           Case 10
                MOVE_AREA = "B70:BI81"
           Case 11
                MOVE_AREA = "B76:BI81"
           Case Else
                Exit Sub
    End Select
    Sheets(SHEET_NAME).Select
    Range("A1").Select
    Selection.Copy
    Range(MOVE_AREA).Select
    ActiveSheet.Paste
    Range("A1").Select
End Sub

Attribute VB_Name = "Module4"





Option Explicit
'
Sub TANA_DATA_SET()
Attribute TANA_DATA_SET.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    gUpperDepthCnt = 1
    '
    SYORI_FLG = "S"
    '
    TANA_DATA_SET_RTN
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd|J|fffd|n|fffd|j
    If gUpperDepthCnt <> 1 Then Call MakeUpperDepthSheet(gUpperDepthCnt)
    Sheets("LIST1").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd|I|fffd||fffd||fffd|j
    '
    Application.ScreenUpdating = True
End Sub

Sub TANA_DATA_SET_RTN()
Attribute TANA_DATA_SET_RTN.VB_ProcData.VB_Invoke_Func = " \n14"

    Dim SHELF_TOP_LINE As Integer
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    Dim UpperDepthCnt As Integer
    Dim GondolaNo As Integer
    Dim ShelfNo As Integer
    Dim LineNo As Integer
    Dim chkGondolaNo As Integer
    Dim chkShelfNo As Integer
    Dim chkLineNo As Integer
    Dim chkUpperDepthFlg As Integer
    Dim setUpperDepthMarkStr As String
    Dim itemCellPasteFlg As Boolean

    UpperDepthCnt = 0
    GondolaNo = 0
    ShelfNo = 0
    LineNo = 0
    chkGondolaNo = -1
    chkShelfNo = -1
    chkLineNo = -1
    itemCellPasteFlg = True
    '
    'Application.ScreenUpdating = False
    '
    ERR_FLG = 0
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Columns("Y:AZ").Select
    Selection.EntireColumn.Hidden = False
    LIST_CLEAR
    SHEET_NAME = "COUNT"
    RECALC_RTN
    SHEET_NAME = "COUNT"
    RECALC_RTN
    If Sheets("COUNT").Range("B8") = 0 Then
       ERR_FLG = 1
       If SYORI_FLG = "S" Then
          Sheets("ERMSG").Select
          Sheets("ERMSG").Range("D9").Value = "|fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd||c42c||fffd||fffd||fffd||90bd||fffd||7c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
          Sheets("ERMSG").Range("D12").Value = ""
          Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
          Range("A1").Select
       End If
       Exit Sub
    End If
    '
    SHEET_NAME = "TSIZE"
    RECALC_RTN
    If Sheets("TSIZE").Range("B3") > 12 Then
       ERR_FLG = 1
       If SYORI_FLG = "S" Then
          Sheets("ERMSG").Select
          Sheets("ERMSG").Range("D9").Value = "|fffd|I|fffd|i|fffd||fffd||fffd||fffd||fffd|P|fffd|Q|fffd|i|fffd||fffd||847d||fffd||fffd||fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|"
          Sheets("ERMSG").Range("D12").Value = ""
          Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
          Range("A1").Select
       End If
       Exit Sub
    End If
    If Sheets("TSIZE").Range("A3") > 12 Then
       ERR_FLG = 1
       If SYORI_FLG = "S" Then
          Sheets("ERMSG").Select
          Sheets("ERMSG").Range("D9").Value = "|fffd||28f||fffd||312|I|fffd|i|fffd||fffd||fffd||195||fffd||fffd||fffd||315|\|fffd||fffd||fffd||fffd||312|I|fffd|i|fffd||fffd||fffd||fffd|"
          Sheets("ERMSG").Range("D12").Value = "|fffd||fffd||fffd|v|fffd||fffd||fffd|P|fffd|Q|fffd|i|fffd||fffd||847d||fffd||fffd||fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|"
          Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
          Range("A1").Select
       End If
       Exit Sub
    End If
    '
    If SYORI_FLG = "S" Then
       Sheets("MSG").Select
       Range("D19:L19").Select
       Selection.ClearContents
       Sheets("MSG").Range("C9").Value = "|fffd|I|fffd||fffd||fffd|\|fffd||c42c||fffd||fffd||fffd||142||fffd||fffd|B"
       ARW_CNT = 4
       Sheets("MSG").Cells(19, ARW_CNT).Value = "|fffd||fffd|"
       Sheets("MSG").Select
       Range("A1").Select
       Application.ScreenUpdating = True
       Application.ScreenUpdating = False
       ARW_FLG = False
    End If
    '
    ix = Sheets("COUNT").Range("B8")
    Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Select
    Range("A2:Z" & ix + 2).Select
    Selection.SortSpecial SortMethod:=xlSyllabary, Key1:=Range("A3"), _
        Order1:=xlAscending, Key2:=Range("B3"), Order2:=xlAscending, _
        Key3:=Range("C3"), Order3:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    '
    '|fffd|A|fffd|C|fffd|e|fffd||fffd||fffd||fffd||fffd||182||303|Z|fffd||fffd||fffd||310||fffd||fffd||fffd||fffd|Z|fffd|o
    WIDTH_SET
    '
    If ERR_FLG = 1 Then
       Exit Sub
    End If
    '
    '|fffd|s|fffd|E|fffd||fffd||303|T|fffd|C|fffd|Y|fffd||3cd|X
    RCSIZE_SET
    '
    GON_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Range("A3")
    DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Range("B3")
    jx = Sheets("TSIZE").Cells(DAN_NUM + 70, GON_NUM + 1).Value
    START_LOC = 2
    '
    '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||64fe||fffd|i|fffd||3d0||fffd||fffd|FSHEET_NAME|fffd||243|Z|fffd|b|fffd|g|fffd|j
    SHEET_NAME_RTN
    '
    For ix = 3 To Sheets("COUNT").Range("B8") + 2
        If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1) <> GON_NUM Then        '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||3c2||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||30f||fffd||fffd||fffd|
           If SYORI_FLG = "S" Then
              If ARW_FLG = True And ARW_CNT < 19 Then
                 ARW_CNT = ARW_CNT + 1
                 Sheets("MSG").Cells(19, ARW_CNT).Value = "|fffd||fffd|"
                 Sheets("MSG").Select
                 Range("A1").Select
                 Application.ScreenUpdating = True
                 Application.ScreenUpdating = False
                 ARW_FLG = False
              Else
                 ARW_FLG = True
              End If
           End If
           Sheets(SHEET_NAME).Select
            'If Sheets("TSIZE").Cells(DAN_NUM + 10, GON_NUM + 1).Value = 1 Then         '|fffd|e|fffd|I|fffd|i|fffd||151||fffd|UNIT|fffd||fffd|
            SHELF_TOP_LINE = jx - (Sheets("TSIZE").Cells(DAN_NUM + 30, GON_NUM + 1).Value - 6)
            Range(Cells(SHELF_TOP_LINE, 2), Cells(SHELF_TOP_LINE, 61)).Select
            With Selection.Borders(xlTop)
                .Weight = xlMedium
                .ColorIndex = xlAutomatic
            End With
            Selection.BorderAround LineStyle:=xlNone
            'End If
           Range(Cells(jx + 5, 2), Cells(jx + 5, 61)).Select
           With Selection.Borders(xlBottom)
               .Weight = xlMedium
               .ColorIndex = xlAutomatic
           End With
           Selection.BorderAround LineStyle:=xlNone
           jx = Sheets("TSIZE").Cells(56, GON_NUM + 1).Value            '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||30d||149||fffd||fffd|s
           Range("B10:BI" & jx).Select
           Application.CutCopyMode = False
           Selection.BorderAround Weight:=xlMedium, ColorIndex:=xlAutomatic
           '
           'TANA_MOVE
           TITLE_SET
           '
           GON_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1)
           If GON_NUM > 20 Then
              ERR_FLG = 1
              If SYORI_FLG = "S" Then
                 Sheets("ERMSG").Select
                 Sheets("ERMSG").Range("D9").Value = "|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|Q|fffd|O|fffd|{|fffd||fffd||847d||fffd||fffd||fffd||fffd||fffd||7c2||fffd|"
                 Sheets("ERMSG").Range("D12").Value = ""
                 Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
                 Range("A1").Select
              End If
              Exit Sub
           End If
           SHEET_NAME_RTN

           DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2)
           If DAN_NUM > 12 Then
              ERR_FLG = 1
              If SYORI_FLG = "S" Then
                 Sheets("ERMSG").Select
                 Sheets("ERMSG").Range("D9").Value = "|fffd|I|fffd|i|fffd||fffd||fffd|P|fffd|Q|fffd|i|fffd||fffd||847d||fffd||fffd||fffd||fffd||fffd||7c2||fffd|"
                 Sheets("ERMSG").Range("D12").Value = ""
                 Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
                 Range("A1").Select
              End If
              Exit Sub
           End If
           jx = Sheets("TSIZE").Cells(DAN_NUM + 70, GON_NUM + 1).Value            '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||64ea||fffd|s|fffd||fffd|
           START_LOC = 2
        Else
           If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2) <> DAN_NUM Then        '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||353||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|i|fffd||fffd||fffd||3c2||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||30f||fffd||fffd||fffd|
              Sheets(SHEET_NAME).Select
                'If Sheets("TSIZE").Cells(DAN_NUM + 10, GON_NUM + 1).Value = 1 Then         '|fffd|e|fffd|I|fffd|i|fffd||151||fffd|UNIT|fffd||fffd|
                SHELF_TOP_LINE = jx - (Sheets("TSIZE").Cells(DAN_NUM + 30, GON_NUM + 1).Value - 6)
                Range(Cells(SHELF_TOP_LINE, 2), Cells(SHELF_TOP_LINE, 61)).Select
                With Selection.Borders(xlTop)
                    .Weight = xlMedium
                    .ColorIndex = xlAutomatic
                End With
                Selection.BorderAround LineStyle:=xlNone
                'End If
                Range(Cells(jx + 5, 2), Cells(jx + 5, 61)).Select
                With Selection.Borders(xlBottom)
                    .Weight = xlMedium
                    .ColorIndex = xlAutomatic
                End With
                '
                DAN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2)
                If DAN_NUM > 12 Then
                    If SYORI_FLG = "S" Then
                        ERR_FLG = 1
                        Sheets("ERMSG").Select
                        Sheets("ERMSG").Range("D9").Value = "|fffd|I|fffd|i|fffd||fffd||fffd|P|fffd|Q|fffd|i|fffd||fffd||847d||fffd||fffd||fffd||fffd||fffd||7c2||fffd|"
                        Sheets("ERMSG").Range("D12").Value = ""
                        Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
                        Range("A1").Select
                    End If
                    Exit Sub
                End If
                jx = Sheets("TSIZE").Cells(DAN_NUM + 70, GON_NUM + 1).Value            '|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||64ea||fffd|s|fffd||fffd|
                START_LOC = 2
           End If
        End If
        '
        LIN_NUM = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 3)
        If LIN_NUM > 30 Then
           ERR_FLG = 1
           If SYORI_FLG = "S" Then
              Sheets("ERMSG").Select
              Sheets("ERMSG").Range("D9").Value = "|fffd|P|fffd|i|fffd||303|A|fffd|C|fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|O|fffd||fffd||847d||fffd||fffd||fffd||fffd||fffd||fffd|"
              Sheets("ERMSG").Range("D12").Value = ""
              Sheets("ERMSG").Range("D15").Value = "|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
              Range("A1").Select
           End If
           Exit Sub
        End If
        px = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 32)           '|fffd|Z|fffd||fffd||fffd||310||fffd|(32=AF|fffd||fffd|)
        qx = (px - 1) * 6 + 1                           '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|@SHEETS("|fffd|p|fffd|^|fffd|[|fffd||fffd|")|fffd|@|fffd||30d|s

        '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd|J|fffd|n|fffd|j
        '|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||97||fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe|
        chkUpperDepthFlg = Val(Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 17))
        If chkUpperDepthFlg = 1 Then
            GondolaNo = Val(Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 1))
            ShelfNo = Val(Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 2))
            LineNo = Val(Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 3))
            If GondolaNo <> chkGondolaNo Or ShelfNo <> chkShelfNo Or LineNo <> chkLineNo Then
                chkGondolaNo = GondolaNo
                chkShelfNo = ShelfNo
                chkLineNo = LineNo
                UpperDepthCnt = UpperDepthCnt + 1
                setUpperDepthMarkStr = PCUpperDepthMark & CStr(UpperDepthCnt)
                itemCellPasteFlg = True
            Else
                itemCellPasteFlg = False
            End If
        End If

        '|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd|
        If chkUpperDepthFlg = 1 Then
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx, 2).Value = setUpperDepthMarkStr
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx, 2).Font.Size = 11
        Else
            If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 7).Value = "" Or Sheets("COUNT").Range("AA12").Value = False Then
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx, 2).Value = "   "
            Else
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 7).Value
            End If
        End If

        '|fffd||fffd||fffd|K|fffd|i|fffd|E|fffd||fffd||fffd||fffd|
        If chkUpperDepthFlg = 1 Then
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = " "
        Else
            If Sheets("COUNT").Range("AA13").Value = False Then                 '|fffd|K|fffd|i
               If Sheets("COUNT").Range("AA14").Value = False Then              '|fffd||fffd||fffd||fffd|
                  Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = "   "             '|fffd|K|fffd|i|fffd|E|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
               Else
                  If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 9).Value = "" Then            '|fffd||fffd||fffd||fffd||fffd||302||755|\|fffd||fffd|
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = "   "
                  Else
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 9).Value
                  End If
               End If
            Else
               If Sheets("COUNT").Range("AA14").Value = False Then              '|fffd||fffd||fffd||fffd|
                  If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 8).Value = "" Then            '|fffd|K|fffd|i|fffd||302||755|\|fffd||fffd|
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = "   "
                  Else
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 8).Value
                  End If
               Else
                  If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 8).Value = "" And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 9).Value = "" Then           '|fffd|K|fffd|i|fffd|E|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd|\|fffd||fffd|
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = "   "
                  Else
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 1, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 8).Value & "/" & Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 9).Value
                  End If
               End If
            End If
        End If

        '|fffd||fffd||fffd||fffd||fffd|i|fffd|R|fffd|[|fffd|h
        If chkUpperDepthFlg = 1 Then
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 2, 2).Value = " "
        Else
            If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 10).Value = "" Or Sheets("COUNT").Range("AA15").Value = False Then
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 2, 2).Value = "   "
            Else
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 2, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 10).Value
            End If
        End If

        '|fffd||fffd|JAN|fffd|R|fffd|[|fffd|h
        If chkUpperDepthFlg = 1 Then
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 3, 2).Value = " "
        Else
            If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 6).Value = "" Or Sheets("COUNT").Range("AA11").Value = False Then
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 3, 2).Value = "   "
            Else
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 3, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 6).Value
            End If
        End If

        '|fffd||fffd||fffd|t|fffd|F|fffd|C|fffd|X|fffd|^|fffd||3d2|i|fffd|^|fffd||fffd||fffd|s
        If chkUpperDepthFlg = 1 Then
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = " "
        Else
            If Sheets("COUNT").Range("AA16").Value = False Then                 '|fffd|t|fffd|F|fffd|C|fffd|X
               If Sheets("COUNT").Range("AA18").Value = False Then              '|fffd||3d2|i
                  If Sheets("COUNT").Range("AA17").Value = False Then           '|fffd||fffd||fffd|s
                     Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                  Else
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd||fffd||fffd|s|fffd||302||755|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value
                     End If
                  End If
               Else
                  If Sheets("COUNT").Range("AA17").Value = False Then           '|fffd||fffd||fffd|s
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd||3d2|i|fffd||302||755|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value
                     End If
                  Else
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value = "" And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd||3d2|i|fffd|E|fffd||fffd||fffd|s|fffd|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value & "/" & Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value
                     End If
                  End If
               End If
            Else
               '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
               If Sheets("COUNT").Range("AA18").Value = False Then              '|fffd||3d2|i
                  If Sheets("COUNT").Range("AA17").Value = False Then           '|fffd||fffd||fffd|s
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd|t|fffd|F|fffd|C|fffd|X|fffd||302||755|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value
                     End If
                  Else
                     '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||3d2|i|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd|s|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value = "" And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|E|fffd||fffd||fffd|s|fffd|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value & "/" & Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value
                     End If
                  End If
               Else
                  '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||3d2|i|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
                  If Sheets("COUNT").Range("AA17").Value = False Then          '|fffd||fffd||fffd|s
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value = "" And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|E|fffd||3d2|i|fffd|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value & "/" & Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value
                     End If
                  Else
                     '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|E|fffd||3d2|i|fffd|E|fffd||fffd||fffd|s|fffd|S|fffd||115|\|fffd||fffd|
                     If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value = "" And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value = "" And Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value = "" Then
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = "   "
                     Else
                        '|fffd|t|fffd|F|fffd|C|fffd|X|fffd|E|fffd||3d2|i|fffd|E|fffd||fffd||fffd|s|fffd|S|fffd||115|\|fffd||fffd|
                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 4, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 11).Value & "/" & Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 13).Value & "/" & Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 12).Value
                     End If
                  End If
               End If
            End If
        End If

        '|fffd||fffd||fffd||fffd||fffd||fffd|
        If chkUpperDepthFlg = 1 Then
            Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 5, 2).Value = " "
        Else
            If Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 15).Value = "" Or Sheets("COUNT").Range("AA19").Value = False Then
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 5, 2).Value = "   "
            Else
               Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Cells(qx + 5, 2).Value = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 15).Value
            End If
        End If
        '
        If chkUpperDepthFlg = 1 Then
            '|fffd|e|fffd|I|fffd|i|fffd||30d||151||fffd|UNIT|fffd||fffd|
            kx = 1
            '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
            UNT_NUM = 1
        Else
            '|fffd|e|fffd|I|fffd|i|fffd||30d||151||fffd|UNIT|fffd||fffd|
            kx = Sheets("TSIZE").Cells(DAN_NUM + 10, GON_NUM + 1).Value
            '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
            UNT_NUM = Sheets("COUNT").Cells(GON_NUM * 20 + 70 + DAN_NUM, LIN_NUM + 1).Value
        End If
        '
        '|fffd||fffd||fffd|i|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|\|fffd||593|\|fffd||fffd|t|fffd||fffd|
        If itemCellPasteFlg Then Call INFORM_RTN
        '
        itemCellPasteFlg = True
        '
        '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd|I|fffd||fffd||fffd|j
    Next ix
    '
    '|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||fffd|Line|fffd||310||fffd||fffd|i|fffd||fffd||fffd||6c2||310||fffd||fffd||fffd||fffd|P|fffd||fffd||fffd||fffd||fffd|j
    gUpperDepthCnt = gUpperDepthCnt + UpperDepthCnt

    '
    If SYORI_FLG = "S" Then
       If ARW_CNT < 19 Then
          ARW_CNT = ARW_CNT + 1
          Sheets("MSG").Cells(19, ARW_CNT).Value = "|fffd||fffd|"
          Sheets("MSG").Select
          Range("A1").Select
          Application.ScreenUpdating = True
          Application.ScreenUpdating = False
       End If
    End If
    '
    Sheets(SHEET_NAME).Select
    'If Sheets("TSIZE").Cells(DAN_NUM + 10, GON_NUM + 1).Value = 1 Then         '|fffd|e|fffd|I|fffd|i|fffd||151||fffd|UNIT|fffd||fffd|
    SHELF_TOP_LINE = jx - (Sheets("TSIZE").Cells(DAN_NUM + 30, GON_NUM + 1).Value - 6)
       Range(Cells(SHELF_TOP_LINE, 2), Cells(SHELF_TOP_LINE, 61)).Select
       With Selection.Borders(xlTop)
           .Weight = xlMedium
           .ColorIndex = xlAutomatic
       End With
       Selection.BorderAround LineStyle:=xlNone
    'End If
    Range(Cells(jx + 5, 2), Cells(jx + 5, 61)).Select
    With Selection.Borders(xlBottom)
         .Weight = xlMedium
         .ColorIndex = xlAutomatic
    End With
    jx = Sheets("TSIZE").Cells(56, GON_NUM + 1).Value            '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||30d||149||fffd||fffd|s
    Range("B10:BI" & jx).Select
    Application.CutCopyMode = False
    Selection.BorderAround Weight:=xlMedium, ColorIndex:=xlAutomatic
    'TANA_MOVE                         '|fffd|S|fffd||fffd||fffd|h|fffd||fffd||fffd||312|I|fffd|i|fffd||fffd||fffd||249||fffd||fffd||fffd||fffd||10f||3554||fffd||248||693||fffd|
    TITLE_SET
    '
    PRINT_AREA_SET                    '|fffd||fffd||fffd||fffd||350||752||fffd|
    '
    Sheets("LIST1").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    '
End Sub
Attribute VB_Name = "Module5"

Option Explicit

Sub INFORM_RTN()
Attribute INFORM_RTN.VB_ProcData.VB_Invoke_Func = " \n14"

    '2014-11-04 Igarashi|fffd|C|fffd||fffd|
    ux = Sheets("|fffd|I|fffd||fffd||fffd||7b0||fffd|").Cells(ix, 5)                'UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u

    Select Case kx                                      '|fffd|e|fffd|I|fffd|i|fffd||151||fffd|UNIT|fffd||fffd|
           Case 1
                Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                Selection.Copy
                Sheets(SHEET_NAME).Select
                Cells(jx, START_LOC).Select
                ActiveSheet.Paste
                '
                START_LOC = START_LOC + px
           Case 2
                Select Case UNT_NUM                     '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|12|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                       Case 2
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 0
                                        ex = 0
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 3
                Select Case UNT_NUM                     '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|18|fffd|s|fffd|@|fffd||d448d|s12|fffd|s
                       Case 2
                            ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                            bx = 3
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@|fffd|R|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 9
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 0
                                        ex = 3
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 4
                Select Case UNT_NUM                     '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|24|fffd|s|fffd|@|fffd||d448d|s18|fffd|s
                       Case 2
                            ax = 12                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|12|fffd|s|fffd|@|fffd||d448d|s6|fffd|s
                            bx = 6
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@|fffd|U|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 12
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 0
                                        ex = 6
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                            bx = 2
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@|fffd|Q|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 8
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 5
                Select Case UNT_NUM                     '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|30|fffd|s|fffd|@|fffd||d448d|s24|fffd|s
                       Case 2
                            ax = 15                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|15|fffd|s|fffd|@|fffd||d448d|s9|fffd|s
                            bx = 9
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@|fffd|X|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 15
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 0
                                        ex = 9
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 10                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                            bx = 4
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@|fffd|S|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 10
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 10
                                        ex = 4
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 8          '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 2
                                        cx = 1
                                        BLANK_ROW_RTN   '|fffd|@|fffd||d448d|s|fffd|@|fffd|Q|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 8
                                        TANA_INF_RTN    '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3, 4
                                        ax = 7          '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 3
                                        cx = 3
                                        BLANK_ROW_RTN   '|fffd|@|fffd||d448d|s|fffd|@|fffd|Q|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select      '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 7 + 2), START_LOC).Select
                                        ActiveSheet.Paste                  '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        If ux <> 4 Then
                                           ax = 7
                                           ex = 3
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 5
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 4
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 5
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 6
                Select Case UNT_NUM                     '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|36|fffd|s|fffd|@|fffd||d448d|s30|fffd|s
                       Case 2
                            ax = 18                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|18|fffd|s|fffd|@|fffd||d448d|s12|fffd|s
                            bx = 12
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@12|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 18
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 0
                                        ex = 12
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 12                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|12|fffd|s|fffd|@|fffd||d448d|s6|fffd|s
                            bx = 6
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@6|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 12
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 12
                                        ex = 6
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                            bx = 3
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 9
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 9
                                        ex = 3
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4
                                        START_LOC = START_LOC + px
                            End Select
                       Case 5
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 8          '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 2
                                        cx = 1
                                        BLANK_ROW_RTN   '|fffd|@|fffd||d448d|s|fffd|@|fffd|Q|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 8
                                        TANA_INF_RTN    '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2 To 5
                                        ax = 7          '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 2
                                        cx = 2
                                        BLANK_ROW_RTN   '|fffd|@|fffd||d448d|s|fffd|@|fffd|P|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 7 + 1), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 5 Then
                                           ax = 7
                                           ex = 2
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 6
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 7
                Select Case UNT_NUM                     '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|42|fffd|s|fffd|@|fffd||d448d|s36|fffd|s
                       Case 2
                            ax = 21                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|21|fffd|s|fffd|@|fffd||d448d|s15|fffd|s
                            bx = 15
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@15|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 21
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 0
                                        ex = 15
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 14                     '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|14|fffd|s|fffd|@|fffd||d448d|s8|fffd|s
                            bx = 8
                            cx = 1
                            BLANK_ROW_RTN               '|fffd|@|fffd||d448d|s|fffd|@8|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 14
                            TANA_INF_RTN                '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 14
                                        ex = 8
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            Select Case ux              ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 11         '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|11|fffd|s|fffd|@|fffd||d448d|s5|fffd|s
                                        bx = 5
                                        cx = 1
                                        BLANK_ROW_RTN   '|fffd|@|fffd||d448d|s|fffd|@5|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 11
                                        TANA_INF_RTN    '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 11
                                        ex = 5
                                        DOUBLE_LINE_RTN '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3, 4
                                        ax = 10         '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                                        bx = 6
                                        cx = 3
                                        BLANK_ROW_RTN   '|fffd|@|fffd||d448d|s|fffd|@4|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select      '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 10 + 2), START_LOC).Select
                                        ActiveSheet.Paste                  '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        If ux <> 4 Then
                                           ax = 10
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 5
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                                        bx = 3
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 9
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 9
                                        ex = 3
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3 To 5
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 4
                                        cx = 3
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 8 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 5 Then
                                           ax = 8
                                           ex = 4
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 6
                            ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                            bx = 1
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 7
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 7
                                        ex = 1
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                       Case 7
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 6
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 7
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 8
                Select Case UNT_NUM                                   '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|48|fffd|s|fffd|@|fffd||d448d|s42|fffd|s
                       Case 2
                            ax = 24                        '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|24|fffd|s|fffd|@|fffd||d448d|s18|fffd|s
                            bx = 18
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@18|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 24
                            TANA_INF_RTN               '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 24
                                        ex = 18
                                        DOUBLE_LINE_RTN             '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 16                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|16|fffd|s|fffd|@|fffd||d448d|s10|fffd|s
                            bx = 10
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@10|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 16
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 16
                                        ex = 10
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            ax = 12                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|12|fffd|s|fffd|@|fffd||d448d|s6|fffd|s
                            bx = 6
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@6|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 12
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 12
                                        ex = 6
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4
                                        START_LOC = START_LOC + px
                            End Select
                       Case 5
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 10                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                                        bx = 4
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@4|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 10
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 10
                                        ex = 4
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4, 5
                                        ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                                        bx = 6
                                        cx = 4
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 9 + 3), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 5 Then
                                           ax = 9
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 6
                            ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                            bx = 2
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 8
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                       Case 7
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 6
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 1
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 7
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 7
                                        ex = 1
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 7                         '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                                        dx = 7
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        START_LOC = START_LOC + px
                            End Select
                       Case 8
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 7
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 8
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 9
                Select Case UNT_NUM                                   '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|54|fffd|s|fffd|@|fffd||d448d|s48|fffd|s
                       Case 2
                            ax = 27                        '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|27|fffd|s|fffd|@|fffd||d448d|s21|fffd|s
                            bx = 21
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@21|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 27
                            TANA_INF_RTN               '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 27
                                        ex = 21
                                        DOUBLE_LINE_RTN             '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 18                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|18|fffd|s|fffd|@|fffd||d448d|s12|fffd|s
                            bx = 12
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@12|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 18
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 18
                                        ex = 12
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 14                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|14|fffd|s|fffd|@|fffd||d448d|s8|fffd|s
                                        bx = 8
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@4|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 14
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 14
                                        ex = 8
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3, 4
                                        ax = 13                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|13|fffd|s|fffd|@|fffd||d448d|s7|fffd|s
                                        bx = 9
                                        cx = 3
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@7|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 13 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 4 Then
                                           ax = 13
                                           ex = 9
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 5
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 4
                                        ax = 11                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|11|fffd|s|fffd|@|fffd||d448d|s5|fffd|s
                                        bx = 5
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@5|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 11
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 11
                                        ex = 5
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 5
                                        ax = 10                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                                        bx = 8
                                        cx = 5
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 10 + 4), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        START_LOC = START_LOC + px
                            End Select
                       Case 6
                            ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                            bx = 3
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 9
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 9
                                        ex = 3
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                       Case 7
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 2
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 8
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6, 7
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 6
                                        cx = 6
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 7 + 5), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux = 6 Then
                                           ax = 7
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 8
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 6
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 1
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 7
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 7
                                        ex = 1
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 7, 8               '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 6 + 6), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux = 7 Then
                                           ax = 6
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 9
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 8
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 9
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 10
                Select Case UNT_NUM                                   '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|60|fffd|s|fffd|@|fffd||d448d|s54|fffd|s
                       Case 2
                            ax = 30                        '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|30|fffd|s|fffd|@|fffd||d448d|s24|fffd|s
                            bx = 24
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@24|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 30
                            TANA_INF_RTN               '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 30
                                        ex = 24
                                        DOUBLE_LINE_RTN             '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 20                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|20|fffd|s|fffd|@|fffd||d448d|s14|fffd|s
                            bx = 14
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@12|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 20
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 20
                                        ex = 14
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            ax = 15                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|15|fffd|s|fffd|@|fffd||d448d|s9|fffd|s
                            bx = 9
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@9|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 15
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 15
                                        ex = 9
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4
                                        START_LOC = START_LOC + px
                            End Select
                       Case 5
                            ax = 12                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|12|fffd|s|fffd|@|fffd||d448d|s6|fffd|s
                            bx = 6
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@6|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 12
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 4
                                        ax = 12
                                        ex = 6
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 5
                                        START_LOC = START_LOC + px
                            End Select
                       Case 6
                            ax = 10                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                            bx = 4
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@4|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 10
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 10
                                        ex = 4
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                       Case 7
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 4
                                        ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                                        bx = 3
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 9
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 9
                                        ex = 3
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 5 To 7
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 6
                                        cx = 5
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 8 + 4), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 7 Then
                                           ax = 8
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 8
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 4
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 2
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 8
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 5 To 8
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 5
                                        cx = 5
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 7 + 4), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 8 Then
                                           ax = 7
                                           ex = 5
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 9
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 6
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 1
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 7
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 7
                                        ex = 1
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 7 To 9           '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 6 + 6), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 9 Then
                                           ax = 6
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 10
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 9
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 10
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 11
                Select Case UNT_NUM                                   '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|66|fffd|s|fffd|@|fffd||d448d|s60|fffd|s
                       Case 2
                            ax = 33                        '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|33|fffd|s|fffd|@|fffd||d448d|s27|fffd|s
                            bx = 27
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@27|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 33
                            TANA_INF_RTN               '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 33
                                        ex = 27
                                        DOUBLE_LINE_RTN             '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 22                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|22|fffd|s|fffd|@|fffd||d448d|s16|fffd|s
                            bx = 16
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@16|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 22
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 22
                                        ex = 16
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 17                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|17|fffd|s|fffd|@|fffd||d448d|s11|fffd|s
                                        bx = 11
                                        cx = 1
                                        BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@11|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 17
                                        TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 17
                                        ex = 11
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3, 4
                                        ax = 16                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|16|fffd|s|fffd|@|fffd||d448d|s10|fffd|s
                                        bx = 12
                                        cx = 3
                                        BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@10|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 16 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 4 Then
                                           ax = 16
                                           ex = 12
                                           DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 5
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 14                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|14|fffd|s|fffd|@|fffd||d448d|s8|fffd|s
                                        bx = 8
                                        cx = 1
                                        BLANK_ROW_RTN                '|fffd|@|fffd||d448d|s|fffd|@8|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 14
                                        TANA_INF_RTN                 '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 14
                                        ex = 8
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2 To 5
                                        ax = 13                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|13|fffd|s|fffd|@|fffd||d448d|s7|fffd|s
                                        bx = 8
                                        cx = 2
                                        BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@7|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 13 + 1), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 5 Then
                                           ax = 13
                                           ex = 8
                                           DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 6
                            ax = 11                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|11|fffd|s|fffd|@|fffd||d448d|s5|fffd|s
                            bx = 5
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@5|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 11
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 11
                                        ex = 5
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                       Case 7
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 10                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                                        bx = 4
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@4|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 10
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 10
                                        ex = 4
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4 To 7
                                        ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                                        bx = 6
                                        cx = 4
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 9 + 3), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 7 Then
                                           ax = 9
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 8
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                                        bx = 3
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 9
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 9
                                        ex = 3
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3 To 8
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 4
                                        cx = 3
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 8 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 8 Then
                                           ax = 8
                                           ex = 4
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 9
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 2
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 8
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4 To 9
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 4
                                        cx = 4
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 7 + 3), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 9 Then
                                           ax = 7
                                           ex = 4
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 10
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 6
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 1
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 7
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 7
                                        ex = 1
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 7 To 10       '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 6 + 6), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 10 Then
                                           ax = 6
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 11
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 10
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 11
                                        START_LOC = START_LOC + px
                            End Select
                End Select
           Case 12
                Select Case UNT_NUM                                   '|fffd|e|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|UNIT|fffd||fffd|
                       Case 1
                            UNIT1_RTN                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|72|fffd|s|fffd|@|fffd||d448d|s66|fffd|s
                       Case 2
                            ax = 36                        '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|36|fffd|s|fffd|@|fffd||d448d|s30|fffd|s
                            bx = 30
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@30|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 36
                            TANA_INF_RTN               '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g'|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1
                                        ax = 36
                                        ex = 30
                                        DOUBLE_LINE_RTN             '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 2
                                        START_LOC = START_LOC + px
                            End Select
                       Case 3
                            ax = 24                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|24|fffd|s|fffd|@|fffd||d448d|s18|fffd|s
                            bx = 18
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@18|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 24
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 24
                                        ex = 18
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3
                                        START_LOC = START_LOC + px
                            End Select
                       Case 4
                                   ax = 18                 '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|18|fffd|s|fffd|@|fffd||d448d|s12|fffd|s
                                   bx = 12
                                   cx = 1
                                   BLANK_ROW_RTN           '|fffd|@|fffd||d448d|s|fffd|@12|fffd|s|fffd|Z|fffd|b|fffd|g
                                   '
                                   dx = 18
                                   TANA_INF_RTN             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                   '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 3
                                        ax = 18
                                        ex = 12
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 4
                                        START_LOC = START_LOC + px
                            End Select
                       Case 5
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 15                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|15|fffd|s|fffd|@|fffd||d448d|s9|fffd|s
                                        bx = 9
                                        cx = 1
                                        BLANK_ROW_RTN                '|fffd|@|fffd||d448d|s|fffd|@9|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 15
                                        TANA_INF_RTN                 '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 15
                                        ex = 9
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3 To 5
                                        ax = 14                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|14|fffd|s|fffd|@|fffd||d448d|s8|fffd|s
                                        bx = 10
                                        cx = 3
                                        BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@8|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 14 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 5 Then
                                           ax = 14
                                           ex = 10
                                           DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 6
                            ax = 12                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|12|fffd|s|fffd|@|fffd||d448d|s6|fffd|s
                            bx = 6
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@6|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 12
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 5
                                        ax = 12
                                        ex = 6
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 6
                                        START_LOC = START_LOC + px
                            End Select
                       Case 7
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 11                   '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|11|fffd|s|fffd|@|fffd||d448d|s5|fffd|s
                                        bx = 5
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@5|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 11
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 11
                                        ex = 5
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3 To 7
                                        ax = 10                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|10|fffd|s|fffd|@|fffd||d448d|s4|fffd|s
                                        bx = 6
                                        cx = 3
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@4|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 10 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 7 Then
                                           ax = 10
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 8
                            ax = 9                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|9|fffd|s|fffd|@|fffd||d448d|s3|fffd|s
                            bx = 3
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@3|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 9
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 7
                                        ax = 9
                                        ex = 3
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 8
                                        START_LOC = START_LOC + px
                            End Select
                       Case 9
                            ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                            bx = 2
                            cx = 1
                            BLANK_ROW_RTN                            '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                            '
                            dx = 8
                            TANA_INF_RTN                             '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 8
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN              '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 9
                                        START_LOC = START_LOC + px
                            End Select
                       Case 10
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1, 2
                                        ax = 8                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|8|fffd|s|fffd|@|fffd||d448d|s2|fffd|s
                                        bx = 2
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@2|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 8
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 8
                                        ex = 2
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 3 To 10
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 3
                                        cx = 3
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 7 + 2), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 10 Then
                                           ax = 7
                                           ex = 3
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 11
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 6
                                        ax = 7                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|7|fffd|s|fffd|@|fffd||d448d|s1|fffd|s
                                        bx = 1
                                        cx = 1
                                        BLANK_ROW_RTN             '|fffd|@|fffd||d448d|s|fffd|@1|fffd|s|fffd|Z|fffd|b|fffd|g
                                        '
                                        dx = 7
                                        TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        '
                                        ax = 7
                                        ex = 1
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 7 To 11          '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                                        '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                                        Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
                                        Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
                                        Selection.Copy
                                        Sheets(SHEET_NAME).Select
                                        Cells(jx - ((ux - 1) * 6 + 6), START_LOC).Select
                                        ActiveSheet.Paste
                                        '
                                        If ux <> 11 Then
                                           ax = 6
                                           ex = 6
                                           DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                        Else
                                           START_LOC = START_LOC + px
                                        End If
                            End Select
                       Case 12
                            dx = 6                      '|fffd|\|fffd||fffd||fffd|s|fffd||fffd|6|fffd|s|fffd|@|fffd||d448d|s|fffd||202||fffd|
                            TANA_INF_RTN              '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
                            '
                            Select Case ux             ' UNIT  |fffd||fffd|O|fffd||fffd||fffd||fffd||308||292|u
                                   Case 1 To 11
                                        ax = 6
                                        ex = 0
                                        DOUBLE_LINE_RTN           '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
                                   Case 12
                                        START_LOC = START_LOC + px
                            End Select
                End Select
    End Select
End Sub
'
Sub UNIT1_RTN()
Attribute UNIT1_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    '|fffd|@|fffd||d448d|s|fffd|@|fffd|@(|fffd||151||fffd|UNIT|fffd||fffd|-1)|fffd||fffd|6|fffd|@|fffd|s|fffd||fffd||fffd|Z|fffd|b|fffd|g
    Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
    Range(Cells(qx, 105), Cells(qx, px + 104)).Select
    Selection.Copy
    Sheets(SHEET_NAME).Select
    Range(Cells(jx - ((kx - 1) * 6), START_LOC), Cells(jx - 1, START_LOC)).Select
    ActiveSheet.Paste
    '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
    Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
    Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
    Selection.Copy
    Sheets(SHEET_NAME).Select
    Cells(jx, START_LOC).Select
    ActiveSheet.Paste
    '
    START_LOC = START_LOC + px
End Sub
'
Sub BLANK_ROW_RTN()
Attribute BLANK_ROW_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    '|fffd|@|fffd||d448d|s|fffd|@|fffd|R|fffd|s|fffd|Z|fffd|b|fffd|g
    Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
    Range(Cells(qx, 105), Cells(qx, px + 104)).Select
    Selection.Copy
    Sheets(SHEET_NAME).Select
    Range(Cells(jx - ((ux - 1) * ax + bx), START_LOC), Cells(jx - ((ux - 1) * ax + cx), START_LOC)).Select
    ActiveSheet.Paste
                            
End Sub
'
Sub TANA_INF_RTN()
Attribute TANA_INF_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    '|fffd|@|fffd|C|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|s|fffd|@|fffd|Z|fffd|b|fffd|g
    Sheets("|fffd|p|fffd|^|fffd|[|fffd||fffd|").Select
    Range(Cells(qx, 2), Cells(qx + 5, px + 1)).Select
    Selection.Copy
    Sheets(SHEET_NAME).Select
    Cells(jx - (ux - 1) * dx, START_LOC).Select
    ActiveSheet.Paste
End Sub
'
Sub DOUBLE_LINE_RTN()               '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||402||fffd|
Attribute DOUBLE_LINE_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets(SHEET_NAME).Select
    Range(Cells(jx - ((ux - 1) * ax + ex), START_LOC), Cells(jx - ((ux - 1) * ax + ex), START_LOC + px - 1)).Select
    'With Selection.Borders(xlEdgeTop)
    With Selection.Borders(xlTop)
        .LineStyle = xlDouble
        .ColorIndex = xlAutomatic
    End With
End Sub
'


Attribute VB_Name = "SSM"





Option Explicit
Global idx        As Integer

Sub ALL_TANA_RTN()
Attribute ALL_TANA_RTN.VB_ProcData.VB_Invoke_Func = " \n14"

    Application.ScreenUpdating = False
    On Error GoTo ALLTANA_ERR

    '===============================  2000/03/28  ===============================
    'If ENV_FLG = 0 Then
    '   ENV_SET
    'End If
   '===============================  2000/03/28  ===============================
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    gUpperDepthCnt = 1
    '
    ERR_FLG = 0
    SYORI_FLG = "A"
    '
    TSC_DATA_SET
    '
    If ERR_FLG = 1 Then
       Exit Sub
    End If
    '
    PARAM_SET
    '
    TANA_DATA_SET_RTN
    '
    If ERR_FLG = 1 Then
       Exit Sub
    End If
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd|J|fffd|n|fffd|j
    If gUpperDepthCnt <> 1 Then
        Call ClearUpperDepthSheetObject
        Call MakeUpperDepthSheet(gUpperDepthCnt)
    End If
    Sheets("LIST1").Select
    Range("A1").Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    '2014-11-04 Igarashi|fffd||1c9||fffd||fffd|i|fffd|I|fffd||fffd||fffd|j
    '
    ALL_PRINT_RTN               'ALL|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If ERR_FLG = 1 Then
       Exit Sub
    End If
    '
    '===============================  2000/03/28  ===============================
    '|fffd|f|fffd|[|fffd|^|fffd|Z|fffd|b|fffd|g|fffd|G|fffd||fffd||fffd|A|fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
    Sheets("TSIZE").Select
    Range("CA2:CG2").Select
    Selection.ClearContents
    Range("A1").Select
    'Sheets("COUNT").Select
    'Range("E6").Select
    'Selection.ClearContents
    'Range("A1").Select
    '===============================  2000/03/28  ===============================

    Exit Sub
    '
ALLTANA_ERR:
    ERR_FLG = 1
    Exit Sub
End Sub

'
Sub ALL_PRINT_RTN()
Attribute ALL_PRINT_RTN.VB_ProcData.VB_Invoke_Func = " \n14"
Dim LIST_NAME               As String
Dim Printer_NAME            As String       'KDY  07/09/13
    '
    Application.ScreenUpdating = False
    '
    On Error GoTo ALL_PRINT_RTN_ERR
    '
    LIST_NAME = Application.ActiveSheet.Name
    '
    SHEET_NAME = "COUNT"
    RECALC_RTN
    If Sheets("COUNT").Range("B8").Value = 0 Then
       ERR_FLG = 1
       Exit Sub
    End If
    '
    ' KDY 07/09/13
    Printer_NAME = Sheets("COUNT").Range("J8").Value

    For ix = 1 To Sheets("COUNT").Range("B7").Value                '|fffd||c42c||fffd||fffd||fffd||a0bd||fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Sheets("LIST" & ix).Select
        ActiveWindow.SelectedSheets.PrintOut Copies:=1, ActivePrinter:=Printer_NAME     'KDY 07/09/13
    Next ix
    '
    '2014-11-04 Igarashi|fffd||1c9||fffd|
    If gUpperDepthCnt <> 1 Then
        Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select
        ActiveWindow.SelectedSheets.PrintOut Copies:=1, ActivePrinter:=Printer_NAME     'KDY 07/09/13
    End If
    '
    Application.Wait (Now() + TimeValue("00:00:10"))
    '
    Sheets(LIST_NAME).Select
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 1
    Range("A1").Select
    Exit Sub
    '
ALL_PRINT_RTN_ERR:
    ERR_FLG = 1
    Exit Sub
End Sub

Sub ClearUpperDepthSheetObject()
'---------------------------------------------------------
'
'2014-11-04 Igarashi|fffd||1c9||fffd|
'
'|fffd||fffd|i|fffd|A|fffd||fffd||fffd|s|fffd||252||97||42cc2||fffd||102||fffd||fffd||93e4||fffd|i|fffd||fffd||fffd||fffd||fffd||939e||fffd||fffd|p|fffd|V|fffd|[|fffd|g|fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||d3dc|
'
'---------------------------------------------------------
On Error GoTo ClearUpperDepthSheetObject_err

    Dim delObjectCnt As Integer

    '|fffd|u|fffd|b|fffd|N|fffd||fffd|
    BOOK_NAME = Sheets("COUNT").Range("B6").Value
    Workbooks(BOOK_NAME).Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").Select

    delObjectCnt = Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").DrawingObjects.Count

    Do While delObjectCnt > 0
        Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").DrawingObjects(delObjectCnt).Cut
        delObjectCnt = Sheets("|fffd||fffd|i|fffd|E|fffd||fffd||fffd|s|fffd||fffd||fffd|i").DrawingObjects.Count
    Loop

    Exit Sub
ClearUpperDepthSheetObject_err:
    MsgBox "|fffd|I|fffd||fffd||fffd|\|fffd||fffd||fffd|" & Chr(13) & Err.Number & "|fffd|F" & Err.Description, vbExclamation, "ClearUpperDepthSheetObject"
    Err.Clear
End Sub

'
Sub ALL_TEST()
Attribute ALL_TEST.VB_ProcData.VB_Invoke_Func = " \n14"

    For idx = 11 To 13
               
        Sheets("TSIZE").Select
        Range("CA" & idx & ":CG" & idx).Select
        Selection.Copy
        Range("CA2").Select
        ActiveSheet.Paste
        '
        ALL_TANA_RTN
    Next idx
End Sub


Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' aN+exw

INQUEST-PP=macro
