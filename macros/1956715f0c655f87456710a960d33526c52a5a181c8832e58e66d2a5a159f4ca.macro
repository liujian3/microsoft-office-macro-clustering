Attribute VB_Name = "Module1"
Dim fs_rows_length As Long
Dim cntx As Long
Sub getMS()
    On Error Resume Next
    Application.ScreenUpdating = False
    clearParsed
    clearMain
    timezone = Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("T2").Value - 1
    dayzone = Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("V2").Value - 8
    sourcer = Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("X2").Value
    If sourcer = 1 Then
        sourcer = "soccerstand.com/ru/"
    ElseIf sourcer = 2 Then
        sourcer = "myscore.ru/"
    ElseIf sourcer = 3 Then
        sourcer = "scoreboard.com/ru/"
    ElseIf sourcer = 4 Then
        sourcer = "myscore.com.ua/"
    End If
    a = 2 'Get Matches
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", "http://d." & sourcer & "x/feed/f_1_" & dayzone & "_" & timezone & "_ru_1", False
    http.setRequestHeader "X-Fsign", "SW9D1eZo"
    http.Send
    fs_input = http.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    Call Show_PrBar_Or_No(fs_rows_length, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|...")
    For i = 0 To fs_rows_length - 4
        If bShowBar Then Call MyProgresBar
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            tour_name = ""
            home_name = ""
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
                If fs_row_parts(0) = "ZC" Then tour_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            home_name = "": Dim home_scored_first As Integer: Dim away_scored_first As Integer: Dim home_scored_second As Integer: Dim away_scored_second As Integer:
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "AD" Then
                    date_match = DateAdd("s", fs_row_parts(1), "01/01/1970")
                    date_match = DateAdd("h", timezone, date_match)
                    date_match = Format(date_match, "yyyy.mm.dd hh:mm")
                End If
                If fs_row_parts(0) = "AE" Then home_name = fs_row_parts(1)
                If fs_row_parts(0) = "AF" Then away_name = fs_row_parts(1)
                If fs_row_parts(0) = "AB" Then status_game = fs_row_parts(1)
                If fs_row_parts(0) = "AC" Then status_game_code = fs_row_parts(1)
                If fs_row_parts(0) = "BA" Then home_scored_first = fs_row_parts(1)
                If fs_row_parts(0) = "BB" Then away_scored_first = fs_row_parts(1)
                If fs_row_parts(0) = "BC" Then home_scored_second = fs_row_parts(1)
                If fs_row_parts(0) = "BD" Then away_scored_second = fs_row_parts(1)
                Set objRegExp = CreateObject("VBScript.RegExp")
                objRegExp.Pattern = "\s\(...\)"
                home_name = objRegExp.Replace(home_name, "")
                away_name = objRegExp.Replace(away_name, "")
            Next j
        End If
        If tour_name = "" Or home_name = "" Then
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("A" & a).Value = tour_name
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("B" & a).Value = date_match
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("C" & a).Value = home_name
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("D" & a).Value = away_name
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("E" & a).Value = match_id
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("F" & a).Value = country_id
            If status_game = 3 And (status_game_code = 3 Or status_game_code = 10 Or status_game_code = 11) Then
                Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("J" & a).NumberFormat = "@": Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("J" & a).Font.Bold = True
                Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("J" & a).Value = home_scored_first + home_scored_second & " : " & away_scored_first + away_scored_second
                Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("K" & a).NumberFormat = "@"
                Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("K" & a).Value = home_scored_first & " : " & away_scored_first
            End If
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Hyperlinks.Add Anchor:=Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("I" & a), Address:="", TextToDisplay:=" "
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("U" & a).Value = tour_id
            a = a + 1
        End If
    Next i
    If bShowBar Then Unload frmStatusBar
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("A:U").Sort Key1:=Sheets("|fffd||fffd||fffd||fffd||fffd|").Columns("B"), Header:=xlYes, Order1:=xlAscending

    'Get Odds
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", "http://d.soccer24.com/x/feed/fo_1_" & dayzone & "_" & timezone & "_en_1_0", False
    http.setRequestHeader "X-Fsign", "SW9D1eZo"
    http.Send
    fs_input = http.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    Call Show_PrBar_Or_No(fs_rows_length, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...")
    For i = 0 To fs_rows_length - 4
        If bShowBar Then Call MyProgresBar
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            tour_name = ""
            home_name = ""
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            home_name = "": start_home = 0: start_draw = 0: start_away = 0: current_home = 0: current_draw = 0: current_away = 0
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "AD" Then
                    date_match = DateAdd("s", fs_row_parts(1), "01/01/1970")
                    date_match = DateAdd("h", timezone, date_match)
                    date_match = Format(date_match, "yyyy.mm.dd hh:mm")
                End If
                If fs_row_parts(0) = "AE" Then home_name = fs_row_parts(1)
                If fs_row_parts(0) = "AF" Then away_name = fs_row_parts(1)
                If fs_row_parts(0) = "XA" Then start_home = fs_row_parts(1)
                If fs_row_parts(0) = "XB" Then start_draw = fs_row_parts(1)
                If fs_row_parts(0) = "XC" Then start_away = fs_row_parts(1)
                If fs_row_parts(0) = "YA" Then current_home = fs_row_parts(1)
                If fs_row_parts(0) = "YB" Then current_draw = fs_row_parts(1)
                If fs_row_parts(0) = "YC" Then current_away = fs_row_parts(1)
            Next j
        End If
        If match_id = "" Then
        Else
            If start_home > 0 Then
                Set rFndRng = Sheets("|fffd||fffd||fffd||fffd||fffd|").Columns("E").Find(match_id, , xlValues, xlWhole)
                rFndRng.Offset(, 7).Value = start_home
                rFndRng.Offset(, 8).Value = start_draw
                rFndRng.Offset(, 9).Value = start_away
                rFndRng.Offset(, 10).Value = current_home
                rFndRng.Offset(, 11).Value = current_draw
                rFndRng.Offset(, 12).Value = current_away
            End If
        End If
    Next i
    If bShowBar Then Unload frmStatusBar
    Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "Module2"
Sub clearParsed()
    
End Sub

Sub clearMain()
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Columns("A:Q").ClearContents
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Columns("U").ClearContents
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("A1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("B1").Value = "|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("C1").Value = "|fffd||fffd||fffd||fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("D1").Value = "|fffd||fffd||fffd||fffd||fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("E1").Value = "Match_ID"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("F1").Value = "Country_ID"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("G1").Value = "home_ID"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("H1").Value = "away_ID"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("I1").Value = "|fffd||fffd||fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("J1").Value = "|fffd||fffd||fffd|-|fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("K1").Value = "1|fffd||fffd||fffd||fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("L1").Value = "|fffd|1"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("M1").Value = "|fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("N1").Value = "|fffd|2"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("O1").Value = "|fffd|1"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("P1").Value = "|fffd|"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("Q1").Value = "|fffd|2"
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Select
End Sub

Sub clearAll()
    clearParsed
    clearMain
    refreshAll
End Sub

Sub DelDups_OneList()
Dim iListCount As Integer
Dim iCtr As Integer
Application.ScreenUpdating = False
iListCount = Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("E1:E1000").Rows.Count
Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("E1").Select
Do Until ActiveCell = ""
   For iCtr = 1 To iListCount
      If ActiveCell.Row <> Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(iCtr, 5).Row Then
         If ActiveCell.Value = Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(iCtr, 5).Value Then
            Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(iCtr, 5).EntireRow.ClearContents
            
            iCtr = iCtr + 1
         End If
      End If
   Next iCtr
   ActiveCell.Offset(1, 0).Select
Loop
Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("A:K").Sort Key1:=Sheets("|fffd||fffd||fffd||fffd||fffd|").Columns("B"), Header:=xlYes, Order1:=xlAscending
Application.ScreenUpdating = True
End Sub


Sub refreshAll()
    Dim sFolder As String, sFiles As String, li As Long
    sFolder = ActiveWorkbook.Path
    sFolder = sFolder & IIf(Right(sFolder, 1) = Application.PathSeparator, "", Application.PathSeparator)

    sFiles = Dir(sFolder & "*.xlsx")
    Do While sFiles <> ""
        li = li + 1
        sFiles = Dir
    Loop
    Call Show_PrBar_Or_No(li, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...")
    sFiles = Dir(sFolder & "*.xlsx")
    Do While sFiles <> ""
        If bShowBar Then Call MyProgresBar
        Workbooks.Open Filename:=sFolder & sFiles, UpdateLinks:=True
        ActiveWorkbook.Close False
        sFiles = Dir
    Loop
    If bShowBar Then Unload frmStatusBar
End Sub
Attribute VB_Name = "Module3"
Sub getOdds(id As String)
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", "http://d.soccer24.com/x/feed/d_od_" & id & "_en_2_eu", False
    http.setRequestHeader "X-Fsign", "SW9D1eZo"
    http.Send
    fs_input = http.ResponseText
    Set objRegExp = CreateObject("VBScript.RegExp")
    '1X2
    objRegExp.Pattern = "block-1x2-ft(.*?)bookmaker(.*?)bet365(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>"
    If objRegExp.test(fs_input) = True Then
        Set objMatches = objRegExp.Execute(fs_input)
        objRegExp.Pattern = "(.*)\[(.*)\](.*)"
        If objRegExp.test(objMatches.Item(0).submatches(4)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(4))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2").Value = "|fffd|1"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B2").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C2").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2").Value = "|fffd|1"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B2").Value = objMatches.Item(0).submatches(5)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C2").Value = objMatches.Item(0).submatches(5)
        End If
        If objRegExp.test(objMatches.Item(0).submatches(8)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(8))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A3").Value = "X"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B3").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C3").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A3").Value = "X"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B3").Value = objMatches.Item(0).submatches(9)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C3").Value = objMatches.Item(0).submatches(9)
        End If
        If objRegExp.test(objMatches.Item(0).submatches(12)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(12))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A4").Value = "|fffd|2"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B4").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C4").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A4").Value = "|fffd|2"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B4").Value = objMatches.Item(0).submatches(13)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C4").Value = objMatches.Item(0).submatches(13)
        End If
    End If
    'Total2.5
    objRegExp.Pattern = "odds_ou_2.5(.*?)bookmaker(.*?)bet365(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>"
    If objRegExp.test(fs_input) = True Then
        Set objMatches = objRegExp.Execute(fs_input)
        objRegExp.Pattern = "(.*)\[(.*)\](.*)"
        If objRegExp.test(objMatches.Item(0).submatches(4)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(4))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A5").Value = "|fffd||fffd|2.5"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B5").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C5").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A5").Value = "|fffd||fffd|2.5"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B5").Value = objMatches.Item(0).submatches(5)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C5").Value = objMatches.Item(0).submatches(5)
        End If
        If objRegExp.test(objMatches.Item(0).submatches(8)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(8))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A6").Value = "|fffd||fffd|2.5"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B6").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C6").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A6").Value = "|fffd||fffd|2.5"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B6").Value = objMatches.Item(0).submatches(9)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C6").Value = objMatches.Item(0).submatches(9)
        End If
    End If
    'BTS
    objRegExp.Pattern = "odds_both_teams_to_score(.*?)bookmaker(.*?)bet365(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>(.*?)odds-wrap(.*?)alt=" & Chr(34) & "(.*?):" & Chr(34) & ">(.*?)<\/span>"
    If objRegExp.test(fs_input) = True Then
        Set objMatches = objRegExp.Execute(fs_input)
        objRegExp.Pattern = "(.*)\[(.*)\](.*)"
        If objRegExp.test(objMatches.Item(0).submatches(4)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(4))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A7").Value = "|fffd||fffd|"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B7").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C7").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A7").Value = "|fffd||fffd|"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B7").Value = objMatches.Item(0).submatches(5)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C7").Value = objMatches.Item(0).submatches(5)
        End If
        If objRegExp.test(objMatches.Item(0).submatches(8)) = True Then
            Set objMatches2 = objRegExp.Execute(objMatches.Item(0).submatches(8))
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A8").Value = "|fffd||fffd||fffd|"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B8").Value = objMatches2.Item(0).submatches(0)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C8").Value = objMatches2.Item(0).submatches(2)
        Else
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A8").Value = "|fffd||fffd||fffd|"
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B8").Value = objMatches.Item(0).submatches(9)
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C8").Value = objMatches.Item(0).submatches(9)
        End If
    End If
End Sub
Attribute VB_Name = "Module4"
Sub getMatches()
Sheets("|fffd||fffd||fffd|").Range("A2:L3000").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2:E6").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A8:E12").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A14:E18").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A20:E24").ClearContents
Sheets("Magic").Range("A2:E6").ClearContents
Sheets("Magic").Range("A8:E12").ClearContents
Sheets("Magic").Range("A14:E18").ClearContents
Sheets("Magic").Range("A20:E24").ClearContents
    a1 = 2
    b1 = 1
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", "http://d.soccerstand.com/ru/x/feed/f_1_0_0_ru_1", False
    http.setRequestHeader "X-Fsign", "SW9D1eZo"
    http.Send
    fs_input = http.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    For i = 0 To fs_rows_length - 4
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "AD" Then
                    date_match = DateAdd("s", fs_row_parts(1), "01/01/1970")
                    date_match = DateAdd("h", timezone, date_match)
                    date_match = Format(date_match, "yyyy.mm.dd hh:mm")
                End If
                If fs_row_parts(0) = "AE" Then home_name = fs_row_parts(1)
                If fs_row_parts(0) = "AF" Then away_name = fs_row_parts(1)
            Next j
            Sheets("|fffd||fffd||fffd|").Range("A" & a1).Value = tour_name
            Sheets("|fffd||fffd||fffd|").Range("B" & a1).Value = date_match
            Sheets("|fffd||fffd||fffd|").Range("C" & a1).Value = home_name
            Sheets("|fffd||fffd||fffd|").Range("D" & a1).Value = away_name
            Sheets("|fffd||fffd||fffd|").Range("E" & a1).Value = match_id

            Set http = CreateObject("MSXML2.XMLHTTP")
            http.Open "GET", "http://d.soccerstand.com/ru/x/feed/d_hh_" & match_id & "_ru_1", False
            http.setRequestHeader "X-Fsign", "SW9D1eZo"
            http.Send
            fs_input = http.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input1 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input1 = objRegExp.Replace(fs_input1, "")
            objRegExp.Pattern = Chr(13)
            fs_input1 = objRegExp.Replace(fs_input1, "")

            b1 = 2
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_home" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input1) = True Then
                Set objMatches = objRegExp.Execute(fs_input1)
                fs_input1 = objMatches.Item(0).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input1) = True Then
                    Set objMatches = objRegExp.Execute(fs_input1)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 7 Then Exit For
                        End If
                    Next
                End If
            End If
            
            b1 = 8
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input2 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input2 = objRegExp.Replace(fs_input2, "")
            objRegExp.Pattern = Chr(13)
            fs_input2 = objRegExp.Replace(fs_input2, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_away" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input2) = True Then
                Set objMatches = objRegExp.Execute(fs_input2)
                fs_input2 = objMatches.Item(0).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input2) = True Then
                    Set objMatches = objRegExp.Execute(fs_input2)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 13 Then Exit For
                        End If
                    Next
                End If
            End If
            
            
            b1 = 14
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input3 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input3 = objRegExp.Replace(fs_input3, "")
            objRegExp.Pattern = Chr(13)
            fs_input3 = objRegExp.Replace(fs_input3, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_home" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input3) = True Then
                Set objMatches = objRegExp.Execute(fs_input3)
                fs_input3 = objMatches.Item(1).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input3) = True Then
                    Set objMatches = objRegExp.Execute(fs_input3)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 19 Then Exit For
                        End If
                    Next
                End If
            End If
            
            b1 = 20
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input4 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input4 = objRegExp.Replace(fs_input4, "")
            objRegExp.Pattern = Chr(13)
            fs_input4 = objRegExp.Replace(fs_input4, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_away" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input4) = True Then
                Set objMatches = objRegExp.Execute(fs_input4)
                fs_input4 = objMatches.Item(1).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input4) = True Then
                    Set objMatches = objRegExp.Execute(fs_input4)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 25 Then Exit For
                        End If
                    Next
                End If
            End If
            Sheets("|fffd||fffd||fffd|").Range("F" & a1).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("N23").Value
            Sheets("|fffd||fffd||fffd|").Range("G" & a1).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K15").Value
            Sheets("|fffd||fffd||fffd|").Range("H" & a1).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K19").Value
            Sheets("|fffd||fffd||fffd|").Range("I" & a1).Value = Sheets("Magic").Range("J20").Value
            Sheets("|fffd||fffd||fffd|").Range("J" & a1).Value = Sheets("Magic").Range("J21").Value
            Sheets("|fffd||fffd||fffd|").Range("K" & a1).Value = Sheets("Magic").Range("I8").Value
            Sheets("|fffd||fffd||fffd|").Range("L" & a1).Value = Sheets("Magic").Range("I9").Value
            
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2:E6").ClearContents
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A8:E12").ClearContents
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A14:E18").ClearContents
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A20:E24").ClearContents
            Sheets("Magic").Range("A2:E6").ClearContents
            Sheets("Magic").Range("A8:E12").ClearContents
            Sheets("Magic").Range("A14:E18").ClearContents
            Sheets("Magic").Range("A20:E24").ClearContents
            a1 = a1 + 1
        End If
    Next i
    Sheets("|fffd||fffd||fffd|").Range("A:L").Sort Key1:=Sheets("|fffd||fffd||fffd|").Columns("B"), Header:=xlYes, Order1:=xlAscending
    Sheets("|fffd||fffd||fffd|").Range("A:L").AutoFilter
End Sub

Attribute VB_Name = "Module5"

Sub getMatches()
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2:L3000").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2:E6").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A8:E12").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A14:E18").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A20:E24").ClearContents
Sheets("Magic").Range("A2:E6").ClearContents
Sheets("Magic").Range("A8:E12").ClearContents
Sheets("Magic").Range("A14:E18").ClearContents
Sheets("Magic").Range("A20:E24").ClearContents
    a1 = 2
    b1 = 1
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", "http://d.soccerstand.com/ru/x/feed/f_1_0_0_ru_1", False
    http.setRequestHeader "X-Fsign", "SW9D1eZo"
    http.Send
    fs_input = http.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    For i = 0 To fs_rows_length - 4
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "AD" Then
                    date_match = DateAdd("s", fs_row_parts(1), "01/01/1970")
                    date_match = DateAdd("h", timezone, date_match)
                    date_match = Format(date_match, "yyyy.mm.dd hh:mm")
                End If
                If fs_row_parts(0) = "AE" Then home_name = fs_row_parts(1)
                If fs_row_parts(0) = "AF" Then away_name = fs_row_parts(1)
            Next j
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & a1).Value = tour_name
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & a1).Value = date_match
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & a1).Value = home_name
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & a1).Value = away_name
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & a1).Value = match_id

            Set http = CreateObject("MSXML2.XMLHTTP")
            http.Open "GET", "http://d.soccerstand.com/ru/x/feed/d_hh_" & match_id & "_ru_1", False
            http.setRequestHeader "X-Fsign", "SW9D1eZo"
            http.Send
            fs_input = http.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input1 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input1 = objRegExp.Replace(fs_input1, "")
            objRegExp.Pattern = Chr(13)
            fs_input1 = objRegExp.Replace(fs_input1, "")

            b1 = 2
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_home" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input1) = True Then
                Set objMatches = objRegExp.Execute(fs_input1)
                fs_input1 = objMatches.Item(0).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input1) = True Then
                    Set objMatches = objRegExp.Execute(fs_input1)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 7 Then Exit For
                        End If
                    Next
                End If
            End If
            
            b1 = 8
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input2 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input2 = objRegExp.Replace(fs_input2, "")
            objRegExp.Pattern = Chr(13)
            fs_input2 = objRegExp.Replace(fs_input2, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_away" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input2) = True Then
                Set objMatches = objRegExp.Execute(fs_input2)
                fs_input2 = objMatches.Item(0).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input2) = True Then
                    Set objMatches = objRegExp.Execute(fs_input2)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 13 Then Exit For
                        End If
                    Next
                End If
            End If
            
            
            b1 = 14
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input3 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input3 = objRegExp.Replace(fs_input3, "")
            objRegExp.Pattern = Chr(13)
            fs_input3 = objRegExp.Replace(fs_input3, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_home" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input3) = True Then
                Set objMatches = objRegExp.Execute(fs_input3)
                fs_input3 = objMatches.Item(1).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input3) = True Then
                    Set objMatches = objRegExp.Execute(fs_input3)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 19 Then Exit For
                        End If
                    Next
                End If
            End If
            
            b1 = 20
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input4 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input4 = objRegExp.Replace(fs_input4, "")
            objRegExp.Pattern = Chr(13)
            fs_input4 = objRegExp.Replace(fs_input4, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_away" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input4) = True Then
                Set objMatches = objRegExp.Execute(fs_input4)
                fs_input4 = objMatches.Item(1).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input4) = True Then
                    Set objMatches = objRegExp.Execute(fs_input4)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("Magic").Range("A" & b1).Value = m.submatches(2)
                            Sheets("Magic").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("Magic").Range("C" & b1).Value = m_home
                            Sheets("Magic").Range("D" & b1).Value = m_away
                            Sheets("Magic").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 25 Then Exit For
                        End If
                    Next
                End If
            End If
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("F" & a1).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("N23").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("G" & a1).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K15").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("H" & a1).Value = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K19").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("I" & a1).Value = Sheets("Magic").Range("J20").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("J" & a1).Value = Sheets("Magic").Range("J21").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K" & a1).Value = Sheets("Magic").Range("I8").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("L" & a1).Value = Sheets("Magic").Range("I9").Value
            
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2:E6").ClearContents
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A8:E12").ClearContents
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A14:E18").ClearContents
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A20:E24").ClearContents
            Sheets("Magic").Range("A2:E6").ClearContents
            Sheets("Magic").Range("A8:E12").ClearContents
            Sheets("Magic").Range("A14:E18").ClearContents
            Sheets("Magic").Range("A20:E24").ClearContents
            a1 = a1 + 1
        End If
    Next i
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A:L").Sort Key1:=Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Columns("B"), Header:=xlYes, Order1:=xlAscending
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("A:L").AutoFilter
End Sub

Attribute VB_Name = "Module6"
Sub getMatches()
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A2:D15000").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F2:L15000").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("O2:W15000").ClearContents
Sheets("|fffd|").Range("A2:E6").ClearContents
Sheets("|fffd|").Range("A8:E12").ClearContents
Sheets("|fffd|").Range("A14:E18").ClearContents
Sheets("|fffd|").Range("A20:E24").ClearContents
Sheets("M").Range("A2:E6").ClearContents
Sheets("M").Range("A8:E12").ClearContents
Sheets("M").Range("A14:E18").ClearContents
Sheets("M").Range("A20:E24").ClearContents
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A:AB").AutoFilter
    a1 = 2
    b1 = 1
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", "http://d.soccerstand.com/ru/x/feed/f_1_0_0_ru_1", False
    http.setRequestHeader "X-Fsign", "SW9D1eZo"
    http.Send
    fs_input = http.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    For i = 0 To fs_rows_length - 4
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "AD" Then
                    date_match = DateAdd("s", fs_row_parts(1), "01/01/1970")
                    date_match = DateAdd("h", timezone, date_match)
                    date_match = Format(date_match, "yyyy.mm.dd hh:mm")
                End If
                If fs_row_parts(0) = "AE" Then home_name = fs_row_parts(1)
                If fs_row_parts(0) = "AF" Then away_name = fs_row_parts(1)
            Next j
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & a1).Value = tour_name
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B" & a1).Value = date_match
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C" & a1).Value = home_name
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D" & a1).Value = away_name
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("CC" & a1).Value = match_id

            Set http = CreateObject("MSXML2.XMLHTTP")
            http.Open "GET", "http://d.soccerstand.com/ru/x/feed/d_hh_" & match_id & "_ru_1", False
            http.setRequestHeader "X-Fsign", "SW9D1eZo"
            http.Send
            fs_input = http.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input1 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input1 = objRegExp.Replace(fs_input1, "")
            objRegExp.Pattern = Chr(13)
            fs_input1 = objRegExp.Replace(fs_input1, "")

            b1 = 2
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_home" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input1) = True Then
                Set objMatches = objRegExp.Execute(fs_input1)
                fs_input1 = objMatches.Item(0).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input1) = True Then
                    Set objMatches = objRegExp.Execute(fs_input1)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("M").Range("A" & b1).Value = m.submatches(2)
                            Sheets("M").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("M").Range("C" & b1).Value = m_home
                            Sheets("M").Range("D" & b1).Value = m_away
                            Sheets("M").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 7 Then Exit For
                        End If
                    Next
                End If
            End If
            
            b1 = 8
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input2 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input2 = objRegExp.Replace(fs_input2, "")
            objRegExp.Pattern = Chr(13)
            fs_input2 = objRegExp.Replace(fs_input2, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_away" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input2) = True Then
                Set objMatches = objRegExp.Execute(fs_input2)
                fs_input2 = objMatches.Item(0).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input2) = True Then
                    Set objMatches = objRegExp.Execute(fs_input2)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("M").Range("A" & b1).Value = m.submatches(2)
                            Sheets("M").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("M").Range("C" & b1).Value = m_home
                            Sheets("M").Range("D" & b1).Value = m_away
                            Sheets("M").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 13 Then Exit For
                        End If
                    Next
                End If
            End If
            
            
            b1 = 14
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input3 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input3 = objRegExp.Replace(fs_input3, "")
            objRegExp.Pattern = Chr(13)
            fs_input3 = objRegExp.Replace(fs_input3, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_home" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input3) = True Then
                Set objMatches = objRegExp.Execute(fs_input3)
                fs_input3 = objMatches.Item(1).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input3) = True Then
                    Set objMatches = objRegExp.Execute(fs_input3)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("M").Range("A" & b1).Value = m.submatches(2)
                            Sheets("M").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("M").Range("C" & b1).Value = m_home
                            Sheets("M").Range("D" & b1).Value = m_away
                            Sheets("M").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 19 Then Exit For
                        End If
                    Next
                End If
            End If
            
            b1 = 20
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = False
            objRegExp.Pattern = Chr(9)
            fs_input4 = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input4 = objRegExp.Replace(fs_input4, "")
            objRegExp.Pattern = Chr(13)
            fs_input4 = objRegExp.Replace(fs_input4, "")
            objRegExp.Pattern = "<table class=" & Chr(34) & "head_to_head h2h_away" & Chr(34) & ">(.*?)<\/table>"
            If objRegExp.test(fs_input4) = True Then
                Set objMatches = objRegExp.Execute(fs_input4)
                fs_input4 = objMatches.Item(1).submatches(0)
                objRegExp.Pattern = "<span class=" & Chr(34) & "date" & Chr(34) & ">(.*?)<\/span>(.*?)title=" & Chr(34) & "(.*?)" & Chr(34) & ">(.*?)name(.*?)<span>(.*?)<\/span>(.*?)name(.*?)<span>(.*?)<\/span>(.*?)score(.*?)<strong>(.*?) : (.*?)<\/strong>"
                If objRegExp.test(fs_input4) = True Then
                    Set objMatches = objRegExp.Execute(fs_input4)
                    For Each m In objMatches
                        objRegExp.Pattern = "<strong>"
                        m_home = objRegExp.Replace(m.submatches(5), "")
                        m_away = objRegExp.Replace(m.submatches(8), "")
                        objRegExp.Pattern = "<\/strong>"
                        m_home = objRegExp.Replace(m_home, "")
                        m_away = objRegExp.Replace(m_away, "")
                        m_date = DateAdd("s", m.submatches(0), "01/01/1970")
                        date_match = DateAdd("h", timezone, date_match)
                        m_date = Format(m_date, "yyyy.mm.dd")
                        If m_date = Format(Now, "yyyy.mm.dd") Or m_date = Format(Now - 1, "yyyy.mm.dd") Then
                        Else
                            Set objRegExp = CreateObject("VBScript.RegExp")
                            objRegExp.Pattern = "\s\(...\)"
                            m_home = objRegExp.Replace(m_home, "")
                            m_away = objRegExp.Replace(m_away, "")
                            Sheets("|fffd|").Range("A" & b1).Value = m.submatches(2)
                            Sheets("|fffd|").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("|fffd|").Range("C" & b1).Value = m_home
                            Sheets("|fffd|").Range("D" & b1).Value = m_away
                            Sheets("|fffd|").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            Sheets("M").Range("A" & b1).Value = m.submatches(2)
                            Sheets("M").Range("B" & b1).Value = Format(m_date, "yyyy.mm.dd hh:mm")
                            Sheets("M").Range("C" & b1).Value = m_home
                            Sheets("M").Range("D" & b1).Value = m_away
                            Sheets("M").Range("E" & b1).Value = m.submatches(11) & " : " & m.submatches(12)
                            b1 = b1 + 1
                            If b1 = 25 Then Exit For
                        End If
                    Next
                End If
            End If
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F" & a1).Value = Sheets("|fffd|").Range("N23").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("G" & a1).Value = Sheets("|fffd|").Range("K15").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("H" & a1).Value = Sheets("|fffd|").Range("K19").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("I" & a1).Value = Sheets("M").Range("J20").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("J" & a1).Value = Sheets("M").Range("J21").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("K" & a1).Value = Sheets("M").Range("I8").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("L" & a1).Value = Sheets("M").Range("I9").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("Q" & a1).Value = Sheets("|fffd|").Range("J130").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("R" & a1).Value = Sheets("|fffd|").Range("K130").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("S" & a1).Value = Sheets("|fffd|").Range("L130").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("T" & a1).Value = Sheets("|fffd|").Range("CC39").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("V" & a1).Value = Sheets("|fffd|").Range("J41").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("W" & a1).Value = Sheets("|fffd|").Range("S130").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("U" & a1).Value = Sheets("|fffd|").Range("T130").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("O" & a1).Value = Sheets("|fffd|").Range("AX53").Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("P" & a1).Value = Sheets("|fffd|").Range("P130").Value
            
            Sheets("|fffd|").Range("A2:E6").ClearContents
            Sheets("|fffd|").Range("A8:E12").ClearContents
            Sheets("|fffd|").Range("A14:E18").ClearContents
            Sheets("|fffd|").Range("A20:E24").ClearContents
            Sheets("M").Range("A2:E6").ClearContents
            Sheets("M").Range("A8:E12").ClearContents
            Sheets("M").Range("A14:E18").ClearContents
            Sheets("M").Range("A20:E24").ClearContents
            a1 = a1 + 1
        End If
    Next i
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A:W").Sort Key1:=Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Columns("B"), Header:=xlYes, Order1:=xlAscending
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A:W").AutoFilter
    
    End Sub

Attribute VB_Name = "Module7"
Sub Archivia_Risurtati_2()


                
   Application.ScreenUpdating = False
  
   
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    
     Range("A2:AB1500").SpecialCells(xlVisible).Copy
    
    '  Workbooks(Nda).Worksheets(1).Range("A2:BA1500").SpecialCells(xlVisible).Copy
    
    
    
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Select
    
    
    'posiziona prima cella libera
       
    With Worksheets("|fffd||fffd||fffd||fffd||fffd|")
    Dim lRiga As Long
    lRiga = .Range("A" & Rows.Count).End(xlUp).Row
    .Cells(lRiga + 1, 1).Select                 ' inizia a scrivere da Colonna A
    End With
    
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
        
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("A:AA").AutoFilter
    'Range("AE1").Select
    'Application.CutCopyMode = False
    'ActiveCell.FormulaR1C1 = ""
   ' Range("AE1").Select
    'Sheets("STAT").Select
    'Range("A1").Select
   
   MsgBox (" |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! ")
    
End Sub









Attribute VB_Name = "frmStatusBar"
Attribute VB_Base = "0{F1F217B6-7665-451A-BD35-85284D7A4FA7}{FEA9507B-5E48-434F-B479-D879E8AFC236}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'---------------------------------------------------------------------------------------
' Module    : frmStatusBar
' Author    : The_Prist (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
' Purpose   : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            (|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 300 |fffd||fffd||fffd||fffd||fffd|)
'---------------------------------------------------------------------------------------

Private Sub UserForm_Initialize()
10        FrameProgress.Width = 0.0001
End Sub
Attribute VB_Name = "mCustomProgressBarModule"
Option Explicit
Public bShowBar As Boolean
Public dblProgressWidth As Double, dblStep As Double, dblPercent As Double

Sub MyProgresBar()
    dblProgressWidth = dblProgressWidth + dblStep
    frmStatusBar.FrameProgress.Width = dblProgressWidth
    If dblProgressWidth > dblPercent Then
        frmStatusBar.lblPercentWhite.Caption = Format(dblPercent / frmStatusBar.FramePrgBar.Width, "0%")
        frmStatusBar.lblPercentBlack.Caption = frmStatusBar.lblPercentWhite.Caption
        dblPercent = dblPercent + dblStep
        frmStatusBar.Repaint
        DoEvents
    End If
End Sub

Function Show_PrBar_Or_No(lCnt As Long, Optional sUfCaption As String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...")
    bShowBar = (lCnt > 10)
    If bShowBar = False Then Exit Function
    
    frmStatusBar.Caption = sUfCaption
    dblStep = frmStatusBar.FramePrgBar.Width / lCnt
    frmStatusBar.lblPercentWhite.Left = 96
    frmStatusBar.lblPercentBlack.Left = frmStatusBar.lblPercentWhite.Left
    
    frmStatusBar.Show 0
    dblPercent = 0: dblProgressWidth = 0
End Function
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
    getGame ActiveCell.Offset(, -4).Value
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
