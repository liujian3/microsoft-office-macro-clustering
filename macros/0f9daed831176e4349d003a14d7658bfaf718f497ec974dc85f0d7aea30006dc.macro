Attribute VB_Name = "Module1"
Public Type tGroupBySex
    GrName As String
    Male As Integer
    Female As Integer
    Total As Integer
End Type
    
Public Type tStageBySex
    Stage As Integer
    Male As Integer
    Female As Integer
    Total As Integer
End Type

Public Type tStageByLanguage
    Stage As Integer
    Eng As Integer
    Ger As Integer
    Fr As Integer
    Total As Integer
End Type

Public Sub Numerate(lStartOffset As Long, BaseColumn As Long)

Dim lCntr As Long

lCntr = lStartOffset

While Len(Trim(Cells(lCntr, BaseColumn))) > 0
    Cells(lCntr, 1) = lCntr - lStartOffset + 1
    lCntr = lCntr + 1
Wend

End Sub
Attribute VB_Name = "Module2"
Sub Button222_Click()

    Dim DebugMsg As String
    Dim wsh As Worksheet
    Dim DestWorksheet As Worksheet
        
    Dim DYOffset As Integer
    Dim SYOffset As Integer
    
    Dim DstCounter As Integer
    Dim SrcCounter As Integer
            
    Dim DestColumns As Integer
    Dim DestColCounter As Integer
    
    Dim MappingRow As Integer
    
    Dim AutoCalcState As Variant
        
    MappingRow = 2
    DestColumns = 55
            
    DYOffset = 10
    SYOffset = 10
    
    DstCounter = 0
    
    Set DestWorksheet = ActiveWorkbook.ActiveSheet
    
    AutoCalcState = Application.Calculation
    Application.Calculation = xlCalculationManual
    ActiveSheet.Range("A" & DYOffset & ":CB" & 350 + DYOffset).ClearContents
    
    For Each wsh In ActiveWorkbook.Worksheets
        If (Val(Left(wsh.Name, 2)) > 0) And (Asc(Right(wsh.Name, 1)) >= 192) Then
            SrcCounter = 0
            While Len(Trim(wsh.Cells(SYOffset + SrcCounter, 7))) > 0
                For DestColCounter = 1 To DestColumns
                    If DestWorksheet.Cells(MappingRow, DestColCounter).Value > 0 Then
                        DestWorksheet.Cells(DYOffset + DstCounter, DestColCounter) = _
                            wsh.Cells(SYOffset + SrcCounter, DestWorksheet.Cells(MappingRow, DestColCounter).Value)
                    End If
                Next DestColCounter
                DstCounter = DstCounter + 1
                SrcCounter = SrcCounter + 1

            Wend
        End If
    Next wsh
    
    DestWorksheet.Range(Cells(DYOffset, 5), Cells(DYOffset + DstCounter - 1, 5)).NumberFormat = "yyyy/dd/mm"
    DestWorksheet.Range(Cells(DYOffset, 14), Cells(DYOffset + DstCounter - 1, 15)).NumberFormat = "yyyy/dd/mm"
    DestWorksheet.Range(Cells(DYOffset, 20), Cells(DYOffset + DstCounter - 1, 20)).NumberFormat = "yyyy/dd/mm"
    DestWorksheet.Range(Cells(DYOffset, 24), Cells(DYOffset + DstCounter - 1, 24)).NumberFormat = "yyyy/dd/mm"
    DestWorksheet.Range(Cells(DYOffset, 41), Cells(DYOffset + DstCounter - 1, 41)).NumberFormat = "yyyy/dd/mm"
    DestWorksheet.Range(Cells(DYOffset, 71), Cells(DYOffset + DstCounter - 1, 74)).NumberFormat = "yyyy/dd/mm"
    DestWorksheet.Range(Cells(DYOffset, 76), Cells(DYOffset + DstCounter - 1, 79)).NumberFormat = "yyyy/dd/mm"

    With DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + DstCounter - 1, 55)).Borders
        .LineStyle = xlContinuous
        .Weight = xlHairline
        .Color = 0
    End With

    DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + DstCounter - 1, 55)).Select
    Selection.Sort Key1:=Range("C10"), Order1:=xlAscending, _
        Header:=xlGuess, OrderCustom:=1, MatchCase:= _
        False, Orientation:=xlTopToBottom
        
    Dim srcRange As Range
    Dim dstRange As Range
        
    DestWorksheet.Cells(DYOffset, 1) = 1
    DestWorksheet.Cells(DYOffset + 1, 1) = 2
    Set srcRange = DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + 1, 1))
    Set dstRange = DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + DstCounter - 1, 1))
    srcRange.AutoFill Destination:=dstRange

    With DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + DstCounter - 1, 55)).Font
        .Name = "Times New Roman CYR"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    
    Application.Calculation = AutoCalcState
    

End Sub


Public Function getAge(date1 As Date, date2 As Date) As Integer

    getAge = DateDiff("yyyy", date1, date2)
    If (DateAdd("yyyy", getAge, date1) > date2) Then
        getAge = getAge - 1
    End If

End Function
Attribute VB_Name = "Module3"
Option Explicit

Sub Button1_Click()

Dim DCheck As Date
Dim RowCount As Integer
Dim ListCount As Integer

DCheck = ActiveSheet.Cells(5, 3)

RowCount = 10

ListCount = 9

ActiveSheet.Range("B" & ListCount & ":D" & 350 + ListCount).ClearContents

While Not Trim(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(RowCount, 5)) = ""

    If (DatePart("m", ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(RowCount, 5)) = DatePart("m", DCheck)) _
        And (DatePart("d", ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(RowCount, 5)) = DatePart("d", DCheck)) Then
        
        ActiveSheet.Cells(ListCount, 2) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(RowCount, 2)
        ActiveSheet.Cells(ListCount, 3) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(RowCount, 3)
        ActiveSheet.Cells(ListCount, 4) = getAge(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(RowCount, 5), DCheck)
        ListCount = ListCount + 1
        
    End If
    RowCount = RowCount + 1

Wend

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub ComboBox1_Change()

End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sheet63"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet64"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CommandButton1_Click()

    Dim FIO As String
    Dim X As Integer
    Dim XX As Integer
    Dim DblCount As Integer
    Dim FIOcolnumber As Integer
    Dim RowCount As Long
    Dim RowOffset As Long
    
    DblCount = 0
    RowCount = 0
    
    FIOcolnumber = 3
   
    RowOffset = 10
    
    While Trim(Cells((RowOffset + RowCount), FIOcolnumber)) <> ""
        RowCount = RowCount + 1
    Wend
    
    ActiveSheet.Range( _
        ActiveSheet.Cells(RowOffset, FIOcolnumber), _
        ActiveSheet.Cells(RowOffset + RowCount, FIOcolnumber)).Interior.ColorIndex = xlColorIndexAutomatic
    ActiveSheet.Range( _
        ActiveSheet.Cells(RowOffset, 66), _
        ActiveSheet.Cells(RowOffset + RowCount, 67)).Interior.ColorIndex = xlColorIndexAutomatic
    
    
    X = RowOffset
    While X < RowOffset + RowCount

        FIO = UCase(Trim(Cells(X, FIOcolnumber)))
        For XX = 10 To X - 1
            If FIO = UCase(Trim(Cells(XX, FIOcolnumber))) Then
                Cells(XX, FIOcolnumber).Interior.ColorIndex = 3
                Cells(X, FIOcolnumber).Interior.ColorIndex = 3
                DblCount = DblCount + 1
            End If
        Next XX
        X = X + 1
    
    Wend
    
    X = RowOffset
    While X < RowOffset + RowCount

        DOC = UCase(Trim(Cells(X, 66)) & Trim(Cells(X, 67)))
        If Not (DOC = "") Then
            For XX = 10 To X - 1
                If DOC = UCase(Trim(Cells(XX, 66)) & Trim(Cells(XX, 67))) Then
                    Cells(XX, 66).Interior.ColorIndex = 3
                    Cells(XX, 67).Interior.ColorIndex = 3
                    Cells(X, 66).Interior.ColorIndex = 3
                    Cells(X, 67).Interior.ColorIndex = 3
                    Cells(XX, FIOcolnumber).Interior.ColorIndex = 3
                    Cells(X, FIOcolnumber).Interior.ColorIndex = 3
                    DblCount = DblCount + 1
                End If
            Next XX
        End If
        X = X + 1
    
    Wend
    
    
    
    If DblCount > 0 Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbExclamation

End Sub

Private Sub CommandButton2_Click()

Application.Calculation = xlCalculationManual
Numerate 10, 5
Application.Calculation = xlCalculationAutomatic

End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

    Dim DebugMsg As String
    Dim wsh As Worksheet
    Dim DestWorksheet As Worksheet
        
    Dim DYOffset As Integer
    Dim SYOffset As Integer
    
    Dim DstCounter As Integer
    Dim SrcCounter As Integer
            
    Dim DestColumns As Integer
    Dim DestColCounter As Integer
    
    Dim MappingRow As Integer
    
    Dim AutoCalcState As Variant
    
    Dim DStart As Date
    Dim DEnd As Date

    DStart = ActiveSheet.Cells(5, 3)
    DEnd = ActiveSheet.Cells(5, 5)
        
    MappingRow = 2
    DestColumns = 6
            
    DYOffset = 9
    SYOffset = 10
    
    DstCounter = 0
    
    Set wsh = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Set DestWorksheet = ActiveWorkbook.ActiveSheet
    
    AutoCalcState = Application.Calculation
    Application.Calculation = xlCalculationManual
    
    ActiveSheet.Range("A" & DYOffset & ":G" & 2000 + DYOffset).ClearContents

    
    SrcCounter = 0
    
    While Len(Trim(wsh.Cells(SYOffset + SrcCounter, 3))) > 0
            
        If wsh.Cells(SYOffset + SrcCounter, 24) >= DStart And _
                wsh.Cells(SYOffset + SrcCounter, 24) <= DEnd And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 18)) <> "|fffd||fffd|" And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 18)) <> "|fffd||fffd|" And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 19)) <> "|fffd||fffd|" And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 19)) <> "|fffd||fffd|" Then
            For DestColCounter = 1 To DestColumns
                If DestWorksheet.Cells(MappingRow, DestColCounter).Value > 0 Then
                    DestWorksheet.Cells(DYOffset + DstCounter, DestColCounter) = _
                            wsh.Cells(SYOffset + SrcCounter, DestWorksheet.Cells(MappingRow, DestColCounter).Value)
                End If
            Next DestColCounter
                
            DstCounter = DstCounter + 1
                
        End If
        
        SrcCounter = SrcCounter + 1
                
                
    Wend
    
    DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + DstCounter, DestColumns)).Select
    Selection.Sort _
            Key1:=Cells(DYOffset, 4), Order1:=xlAscending, _
            Header:=xlNo, OrderCustom:=1, MatchCase:= _
            False, Orientation:=xlTopToBottom
    DestWorksheet.Cells(DYOffset, 1).Select
    
    
    Application.Calculation = AutoCalcState
    
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
    
Private Sub CommandButton1_Click()
   
   
    Dim Base As Worksheet
    Dim Years(3, 30) As Integer
    Dim Ages(3, 30) As Integer
    Dim Groups(110) As tGroupBySex
    Dim Stages(12) As tStageBySex
    Dim Langs(7, 12) As Integer
    Dim Langs2(7, 12) As Integer
    Dim LangTypes(5) As String
    Dim LangTypes2(5) As String
    Dim I As Variant
    Dim YBase As Long
    Dim Birthdate As Date
    Dim Age As Integer
    Dim Y As Integer
    Dim LangName As String
    Dim Suc As Boolean
    Dim SYOffset As Integer
    Dim DYOffset As Integer
    Dim MaxRows As Integer
    Dim FIORow, Lang1Row, Lang2Row, SexRow, BirthDateRow As Integer
    
    
    DYOffset = 5
    
    SYOffset = 10
    
    MaxRows = 350
    
    FIORow = 3
    Lang1Row = 6
    Lang2Row = 7
    SexRow = 4
    BirthDateRow = 5
    
    Set Base = ActiveWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    
    Range("A" & DYOffset & ":AI17").ClearContents
    
    For R = SYOffset To SYOffset + MaxRows
    
        If Base.Cells(R, FIORow) = "" Then Exit For
        
        Suc = False
        For I = 0 To 4
            
            If Trim(Base.Cells(R, Lang1Row)) = "" Then
                Suc = True
                Exit For
            End If
            
            If LangTypes(I) = "" Then
                LangTypes(I) = LCase(Trim(Base.Cells(R, Lang1Row)))
                Suc = True
                Exit For
            End If
            If LangTypes(I) = LCase(Trim(Base.Cells(R, Lang1Row))) Then
                Suc = True
                Exit For
            End If
        
        Next I
        
        If Not Suc Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & R & ": |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 5!", vbExclamation
            Exit For
        End If
        
        For I = 1 To 12
            If Trim(Base.Cells(R, Lang1Row)) = "" Then Exit For
            
            If Langs(0, I) = 0 Then
                Langs(0, I) = Val(Base.Cells(R, 2))
                LangName = LCase(Trim(Base.Cells(R, Lang1Row)))
                For J = 0 To 4
                    If LangName = LangTypes(J) Then
                        Langs(J + 2, I) = Langs(J + 2, I) + 1
                        Langs(1, I) = Langs(1, I) + 1
                        Exit For
                    End If
                Next J
                Exit For
            End If
            
            If Langs(0, I) = Val(Base.Cells(R, 2)) Then
                LangName = LCase(Trim(Base.Cells(R, Lang1Row)))
                For J = 0 To 4
                    If LangName = LangTypes(J) Then
                        Langs(J + 2, I) = Langs(J + 2, I) + 1
                        Langs(1, I) = Langs(1, I) + 1
                        Exit For
                    End If
                Next J
                Exit For
            End If
        Next I
        
        Suc = False
        For I = 0 To 4
            
            If Trim(Base.Cells(R, Lang2Row)) = "" Then
                Suc = True
                Exit For
            End If
            
            If LangTypes2(I) = "" Then
                LangTypes2(I) = LCase(Trim(Base.Cells(R, Lang2Row)))
                Suc = True
                Exit For
            End If
            If LangTypes2(I) = LCase(Trim(Base.Cells(R, Lang2Row))) Then
                Suc = True
                Exit For
            End If
        
        Next I
        If Not Suc Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & R & ": |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 5!", vbExclamation
            Exit For
        End If
        
        
        For I = 1 To 12
            If Trim(Base.Cells(R, Lang2Row)) = "" Then Exit For
            
            If Langs2(0, I) = 0 Then
                Langs2(0, I) = Val(Base.Cells(R, 2))
                LangName = LCase(Trim(Base.Cells(R, Lang2Row)))
                For J = 0 To 4
                    If LangName = LangTypes2(J) Then
                        Langs2(J + 2, I) = Langs2(J + 2, I) + 1
                        Langs2(1, I) = Langs2(1, I) + 1
                        Exit For
                    End If
                Next J
                Exit For
            End If
            
            If Langs2(0, I) = Val(Base.Cells(R, 2)) Then
                LangName = LCase(Trim(Base.Cells(R, Lang2Row)))
                For J = 0 To 4
                    If LangName = LangTypes2(J) Then
                        Langs2(J + 2, I) = Langs2(J + 2, I) + 1
                        Langs2(1, I) = Langs2(1, I) + 1
                        Exit For
                    End If
                Next J
                Exit For
            End If
        Next I
        
        
        For I = 1 To 110
            If Trim(Base.Cells(R, 2)) = "" Then Exit For
            
            If Trim(Groups(I).GrName) = "" Then
                Groups(I).GrName = Trim(Base.Cells(R, 2))
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Groups(I).Male = Groups(I).Male + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Groups(I).Female = Groups(I).Female + 1
                Groups(I).Total = Groups(I).Total + 1
                Exit For
            End If
            If Groups(I).GrName = Trim(Base.Cells(R, 2)) Then
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Groups(I).Male = Groups(I).Male + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Groups(I).Female = Groups(I).Female + 1
                Groups(I).Total = Groups(I).Total + 1
                Exit For
            End If
        Next I
        
        
        For I = 1 To 12
            If Val(Base.Cells(R, 2)) = 0 Then Exit For
            
            If Stages(I).Stage = 0 Then
                Stages(I).Stage = Val(Base.Cells(R, 2))
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Stages(I).Male = Stages(I).Male + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Stages(I).Female = Stages(I).Female + 1
                Stages(I).Total = Stages(I).Total + 1
                Exit For
            End If
            If Stages(I).Stage = Val(Base.Cells(R, 2)) Then
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Stages(I).Male = Stages(I).Male + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Stages(I).Female = Stages(I).Female + 1
                Stages(I).Total = Stages(I).Total + 1
                Exit For
            End If
        Next I
       
        For I = 1 To 30
        
            If Val(Base.Cells(R, BirthDateRow)) = 0 Then Exit For
            
            'Birthdate = DateSerial(Val(Base.Cells(R, 16)), Val(Base.Cells(R, 15)), Val(Base.Cells(R, 14)))
            Birthdate = Base.Cells(R, BirthDateRow)
            Age = getAge(Birthdate, DateSerial(Year(Now()), 9, 1))
            
            If Ages(1, I) = 0 Then
                Ages(1, I) = Age
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Ages(2, I) = Ages(2, I) + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Ages(3, I) = Ages(3, I) + 1
                Exit For
            End If
            If Ages(1, I) = Age Then
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Ages(2, I) = Ages(2, I) + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Ages(3, I) = Ages(3, I) + 1
                Exit For
            End If
        Next I
        
        For I = 1 To 30
        
            Y = DatePart("yyyy", Base.Cells(R, BirthDateRow))
            If Y = 0 Then Exit For
            
            If Years(1, I) = 0 Then
                Years(1, I) = Y
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Years(2, I) = Years(2, I) + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Years(3, I) = Years(3, I) + 1
                Exit For
            End If
            If Years(1, I) = Y Then
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Years(2, I) = Years(2, I) + 1
                If UCase(Base.Cells(R, SexRow)) = "|fffd|" Then Years(3, I) = Years(3, I) + 1
                Exit For
            End If
        Next I
        
    Next R
    
    For R = 1 To 30
        If Years(1, R) = 0 Then
            ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 1) = ""
            ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 2) = ""
            ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 3) = ""
            ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 4) = ""
            Exit For
        End If
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 1) = Years(1, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 2) = Years(2, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 3) = Years(3, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 4) = Years(2, R) + Years(3, R)
    Next R
    Range("A" & DYOffset & ":D" & R + DYOffset - 1).Select
    Selection.Sort Key1:=Range("A" & DYOffset), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
    
    For R = 1 To 110
        If Groups(R).GrName = "" Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 6) = Groups(R).GrName
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 7) = Groups(R).Male
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 8) = Groups(R).Female
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 9) = Groups(R).Total
    Next R
    Range("F" & DYOffset & ":I" & R + DYOffset - 1).Select
    Selection.Sort Key1:=Range("F" & DYOffset), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
    
    For R = 1 To 12
        If Stages(R).Stage = 0 Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 11) = Stages(R).Stage
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 12) = Stages(R).Male
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 13) = Stages(R).Female
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 14) = Stages(R).Total
    Next R
    Range("K" & DYOffset & ":N" & R + DYOffset - 1).Select
    Selection.Sort Key1:=Range("K" & DYOffset), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
    
    Range(Cells(DYOffset - 2, 17), Cells(DYOffset - 2, 21)).ClearContents
    For R = 0 To 4
        If LangTypes(R) = "" Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(DYOffset - 2, 17 + R) = LangTypes(R) & ""
    Next R
    
    For R = 1 To 12
        If Langs(0, R) = 0 Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 16) = Langs(0, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 17) = Langs(2, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 18) = Langs(3, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 19) = Langs(4, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 20) = Langs(5, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 21) = Langs(6, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 22) = Langs(1, R)
    Next R
    Range("P" & DYOffset & ":V" & R + DYOffset - 1).Select
    Selection.Sort Key1:=Range("P" & DYOffset), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
        
    Range(Cells(DYOffset - 2, 25), Cells(DYOffset - 2, 29)).ClearContents
    For R = 0 To 4
        If LangTypes2(R) = "" Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(DYOffset - 2, 25 + R) = LangTypes2(R) & ""
    Next R
    
    For R = 1 To 12
        If Langs2(0, R) = 0 Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 24) = Langs2(0, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 25) = Langs2(2, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 26) = Langs2(3, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 27) = Langs2(4, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 28) = Langs2(5, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 29) = Langs2(6, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 30) = Langs2(1, R)
    Next R
    Range("X" & DYOffset & ":AD" & R + DYOffset - 1).Select
    Selection.Sort Key1:=Range("X" & DYOffset), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
    
    For R = 1 To 30
        If Ages(1, R) = 0 Then Exit For
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 32) = Ages(1, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 33) = Ages(2, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 34) = Ages(3, R)
        ActiveWorkbook.ActiveSheet.Cells(R + DYOffset - 1, 35) = Ages(2, R) + Ages(3, R)
    Next R
    Range("AF" & DYOffset & ":AI" & R + DYOffset - 1).Select
    Selection.Sort Key1:=Range("AF" & DYOffset), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    
    Range("A1").Select

    
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|56"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|57"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|58"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|59"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()


    Dim DebugMsg As String
    Dim wsh As Worksheet
    Dim DestWorksheet As Worksheet
        
    Dim DYOffset As Integer
    Dim SYOffset As Integer
    
    Dim DstCounter As Integer
    Dim SrcCounter As Integer
            
    Dim DestColumns As Integer
    Dim DestColCounter As Integer
    
    Dim MappingRow As Integer
    
    Dim AutoCalcState As Variant
    
    Dim DStart As Date
    Dim DEnd As Date

    DStart = ActiveSheet.Cells(5, 5)
    DEnd = ActiveSheet.Cells(5, 7)
        
    MappingRow = 2
    DestColumns = 7
            
    DYOffset = 9
    SYOffset = 10
    
    DstCounter = 0
    
    Set wsh = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Set DestWorksheet = ActiveWorkbook.ActiveSheet
    
    AutoCalcState = Application.Calculation
    Application.Calculation = xlCalculationManual
    
    ActiveSheet.Range("A" & DYOffset & ":G" & 2000 + DYOffset).ClearContents

    
    SrcCounter = 0
    
    While Len(Trim(wsh.Cells(SYOffset + SrcCounter, 3))) > 0
            
        If wsh.Cells(SYOffset + SrcCounter, 20) >= DStart And _
                wsh.Cells(SYOffset + SrcCounter, 20) <= DEnd And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 18)) <> "|fffd||fffd|" And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 18)) <> "|fffd||fffd|" And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 19)) <> "|fffd||fffd|" And _
                Trim(wsh.Cells(SYOffset + SrcCounter, 19)) <> "|fffd||fffd|" Then
            For DestColCounter = 1 To DestColumns
                If DestWorksheet.Cells(MappingRow, DestColCounter).Value > 0 Then
                    DestWorksheet.Cells(DYOffset + DstCounter, DestColCounter) = _
                            wsh.Cells(SYOffset + SrcCounter, DestWorksheet.Cells(MappingRow, DestColCounter).Value)
                End If
            Next DestColCounter
                
            DstCounter = DstCounter + 1
                
        End If
        
        SrcCounter = SrcCounter + 1
                
                
    Wend
    
    DestWorksheet.Range(Cells(DYOffset, 1), Cells(DYOffset + DstCounter, DestColumns)).Select
    Selection.Sort _
            Key1:=Cells(DYOffset, 4), Order1:=xlAscending, _
            Header:=xlNo, OrderCustom:=1, MatchCase:= _
            False, Orientation:=xlTopToBottom
    DestWorksheet.Cells(DYOffset, 1).Select
    
    
    Application.Calculation = AutoCalcState


End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()

End Sub


INQUEST-PP=macro
