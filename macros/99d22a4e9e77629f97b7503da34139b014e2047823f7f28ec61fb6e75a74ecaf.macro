Attribute VB_Name = "Module1"
Sub msinOOO()
Attribute msinOOO.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| matsin
    Sheets("matsin").Select
    Range("K2:DF10").Select
    Selection.ClearContents
    Range("E11:DF507").Select
    Range("DE11").Activate
    Selection.ClearContents
    Range("B11:B507").Select
    Range("B501").Activate
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollColumn = 4
    Range("B1").Select
    Worksheets("matsin").Cells(1, 3) = 0
    
    For K% = 1 To 50
    Worksheets("matsin").Cells(10 * K% + 1, 1) = K%
    Worksheets("matsin").Cells(1, 2 * K% + 9) = K%
    Next K%
    
End Sub
Sub msintest()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| matsin

For K% = 1 To 50
If Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) = 0 And Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) = 0 Then GoTo netK
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) < 1 Or Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) > 12 Then
   Worksheets("matsin").Cells(10 * K% + 2, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) < 1 Or Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) > 31 Then
   Worksheets("matsin").Cells(10 * K% + 1, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! ")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) = 2 And Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) > 29 Then
   Worksheets("matsin").Cells(10 * K% + 1, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! ")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) = 4 And Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) > 30 Then
   Worksheets("matsin").Cells(10 * K% + 1, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! ")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) = 6 And Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) > 30 Then
   Worksheets("matsin").Cells(10 * K% + 1, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! ")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) = 9 And Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) > 30 Then
   Worksheets("matsin").Cells(10 * K% + 1, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! ")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 2, 5)) = 11 And Int(Worksheets("matsin").Cells(10 * K% + 1, 5)) > 30 Then
   Worksheets("matsin").Cells(10 * K% + 1, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! ")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 3, 5)) < 1900 Or Int(Worksheets("matsin").Cells(10 * K% + 3, 5)) > 2070 Then
   Worksheets("matsin").Cells(10 * K% + 3, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 4, 5)) < 0 Or Int(Worksheets("matsin").Cells(10 * K% + 4, 5)) > 23 Then
   Worksheets("matsin").Cells(10 * K% + 4, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 5, 5)) < 0 Or Int(Worksheets("matsin").Cells(10 * K% + 5, 5)) > 59 Then
   Worksheets("matsin").Cells(10 * K% + 5, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("matsin").Cells(10 * K% + 6, 5)) < 0 Or Int(Worksheets("matsin").Cells(10 * K% + 6, 5)) > 59 Then
   Worksheets("matsin").Cells(10 * K% + 6, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("matsin").Cells(10 * K% + 7, 5)) = "|fffd|" Or Trim(Worksheets("matsin").Cells(10 * K% + 7, 5)) = "|fffd|" Or Trim(Worksheets("matsin").Cells(10 * K% + 7, 5)) = "|fffd|" Or Trim(Worksheets("matsin").Cells(10 * K% + 7, 5)) = "|fffd|" Then
   Else
   Worksheets("matsin").Cells(10 * K% + 7, 5).Select
   MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("matsin").Cells(10 * K% + 1, 2)) = "" Then
   Worksheets("matsin").Cells(10 * K% + 1, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Trim(Worksheets("matsin").Cells(10 * K% + 7, 5)) = "|fffd|" Then Worksheets("matsin").Cells(10 * K% + 7, 5) = "|fffd|"
If Trim(Worksheets("matsin").Cells(10 * K% + 7, 5)) = "|fffd|" Then Worksheets("matsin").Cells(10 * K% + 7, 5) = "|fffd|"

netK: Next K%

End Sub
Sub msin1()

    Sheets("matsin").Select
    Range("K2:DF507").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollRow = 11
    Range("B10").Select
    Worksheets("matsin").Cells(1, 3) = 0

Call msintest
Worksheets("matsin").Cells(2, 11) = Worksheets("matsin").Cells(11, 2)
Worksheets("matsin").Cells(10, 11) = Worksheets("matsin").Cells(17, 5)
'===========
Dim SUM As Integer
Dim ORB As Double
Dim ASP As Double

'======================
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With
Worksheets("natal").Cells(2, 2) = Worksheets("matsin").Cells(11, 5)
Worksheets("natal").Cells(2, 3) = Worksheets("matsin").Cells(12, 5)
Worksheets("natal").Cells(2, 4) = Worksheets("matsin").Cells(13, 5)
Worksheets("natal").Cells(2, 5) = Worksheets("matsin").Cells(14, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("matsin").Cells(15, 5)
Worksheets("natal").Cells(2, 7) = Worksheets("matsin").Cells(16, 5)
Call radiks
For K% = 11 To 20
Worksheets("natal").Cells(K%, 100) = Worksheets("natal").Cells(K%, 2)
Next K%

For PK% = 2 To 50

If Int(Worksheets("matsin").Cells(10 * PK% + 1, 5)) = 0 And Int(Worksheets("matsin").Cells(10 * PK% + 2, 5)) = 0 Then GoTo netPK
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With
Worksheets("natal").Cells(2, 2) = Worksheets("matsin").Cells(10 * PK% + 1, 5)
Worksheets("natal").Cells(2, 3) = Worksheets("matsin").Cells(10 * PK% + 2, 5)
Worksheets("natal").Cells(2, 4) = Worksheets("matsin").Cells(10 * PK% + 3, 5)
Worksheets("natal").Cells(2, 5) = Worksheets("matsin").Cells(10 * PK% + 4, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("matsin").Cells(10 * PK% + 5, 5)
Worksheets("natal").Cells(2, 7) = Worksheets("matsin").Cells(10 * PK% + 6, 5)
Call radiks

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For n% = 15 To 20
If n% = 18 Or n% = 19 Then GoTo netN
For K% = 15 To 20
If K% = 18 Or K% = 19 Then GoTo netK
    ASP = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 100))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(1, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If n% = 16 And K% = 16 And A% = 0 Then ORB = 0 '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
netK: Next K%
netN: Next n%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 1, 11) = SUM

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(2, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(17, 2), Worksheets("natal").Cells(K%, 100))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 2, 12) = Worksheets("matsin").Cells(1, 112)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(17, 100), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 2, 11) = Worksheets("matsin").Cells(1, 111)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(3, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(16, 2), Worksheets("natal").Cells(K%, 100))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 3, 12) = Worksheets("matsin").Cells(1, 112)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(16, 100), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 3, 11) = Worksheets("matsin").Cells(1, 111)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(7, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(11, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(12, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(14, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(12, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(14, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
Next A%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 4, 11) = SUM

If Trim(Worksheets("matsin").Cells(17, 5)) = "|fffd|" And Trim(Worksheets("matsin").Cells(10 * PK% + 7, 5)) = "|fffd|" Then
' |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 5, 11) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11)
    SUM = 0
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 6, 11) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 7, 11) = SUM
Else
End If

If Trim(Worksheets("matsin").Cells(17, 5)) = "|fffd|" And Trim(Worksheets("matsin").Cells(10 * PK% + 7, 5)) = "|fffd|" Then
' |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 5, 11) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11)
    SUM = 0
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 6, 11) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 7, 11) = SUM
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

netPK: Sheets("matsin").Select
Worksheets("matsin").Cells(1, 3) = 2 * PK%

Next PK%

Worksheets("matsin").Cells(1, 3) = 100

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Sheets("matsin").Select

End Sub
Sub msinall()

    Sheets("matsin").Select
    Range("K2:DF507").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollRow = 11
    Range("B10").Select
    Worksheets("matsin").Cells(1, 3) = 0

Call msintest
'===========
Dim SUM As Integer
Dim ORB As Double
Dim ASP As Double

'======================

For NK% = 1 To 50
If Int(Worksheets("matsin").Cells(10 * NK% + 1, 5)) = 0 And Int(Worksheets("matsin").Cells(10 * NK% + 2, 5)) = 0 Then GoTo netNK

Worksheets("matsin").Cells(2, 9 + 2 * NK%) = Worksheets("matsin").Cells(10 * NK% + 1, 2)
Worksheets("matsin").Cells(10, 9 + 2 * NK%) = Worksheets("matsin").Cells(10 * NK% + 7, 5)

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Worksheets("natal").Cells(2, 2) = Worksheets("matsin").Cells(10 * NK% + 1, 5)
Worksheets("natal").Cells(2, 3) = Worksheets("matsin").Cells(10 * NK% + 2, 5)
Worksheets("natal").Cells(2, 4) = Worksheets("matsin").Cells(10 * NK% + 3, 5)
Worksheets("natal").Cells(2, 5) = Worksheets("matsin").Cells(10 * NK% + 4, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("matsin").Cells(10 * NK% + 5, 5)
Worksheets("natal").Cells(2, 7) = Worksheets("matsin").Cells(10 * NK% + 6, 5)
Call radiks
For K% = 11 To 20
Worksheets("natal").Cells(K%, 100) = Worksheets("natal").Cells(K%, 2)
Next K%

For PK% = 1 To 50
If PK% = NK% Then GoTo netPK
If Int(Worksheets("matsin").Cells(10 * PK% + 1, 5)) = 0 And Int(Worksheets("matsin").Cells(10 * PK% + 2, 5)) = 0 Then GoTo netPK

Worksheets("natal").Cells(2, 2) = Worksheets("matsin").Cells(10 * PK% + 1, 5)
Worksheets("natal").Cells(2, 3) = Worksheets("matsin").Cells(10 * PK% + 2, 5)
Worksheets("natal").Cells(2, 4) = Worksheets("matsin").Cells(10 * PK% + 3, 5)
Worksheets("natal").Cells(2, 5) = Worksheets("matsin").Cells(10 * PK% + 4, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("matsin").Cells(10 * PK% + 5, 5)
Worksheets("natal").Cells(2, 7) = Worksheets("matsin").Cells(10 * PK% + 6, 5)
Call radiks

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For n% = 15 To 20
If n% = 18 Or n% = 19 Then GoTo netN
For K% = 15 To 20
If K% = 18 Or K% = 19 Then GoTo netK
    ASP = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 100))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(1, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If n% = 16 And K% = 16 And A% = 0 Then ORB = 0 '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
netK: Next K%
netN: Next n%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 1, 9 + 2 * NK%) = SUM

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(2, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(17, 2), Worksheets("natal").Cells(K%, 100))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 2, 10 + 2 * NK%) = Worksheets("matsin").Cells(1, 112)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(17, 100), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 2, 9 + 2 * NK%) = Worksheets("matsin").Cells(1, 111)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(3, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(16, 2), Worksheets("natal").Cells(K%, 100))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 3, 10 + 2 * NK%) = Worksheets("matsin").Cells(1, 112)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(16, 100), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 3, 9 + 2 * NK%) = Worksheets("matsin").Cells(1, 111)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(7, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(11, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(12, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(14, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(12, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(14, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
Next A%
If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 4, 9 + 2 * NK%) = SUM

If Trim(Worksheets("matsin").Cells(10 * NK% + 7, 5)) = Trim(Worksheets("matsin").Cells(10 * PK% + 7, 5)) = "|fffd|" Then GoTo netPK

If Trim(Worksheets("matsin").Cells(10 * NK% + 7, 5)) = "|fffd|" And Trim(Worksheets("matsin").Cells(10 * PK% + 7, 5)) = "|fffd|" Then
' |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 5, 9 + 2 * NK%) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11)
    SUM = 0
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 6, 9 + 2 * NK%) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 7, 9 + 2 * NK%) = SUM
Else
End If

If Trim(Worksheets("matsin").Cells(10 * NK% + 7, 5)) = "|fffd|" And Trim(Worksheets("matsin").Cells(10 * PK% + 7, 5)) = "|fffd|" Then
' |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 5, 9 + 2 * NK%) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11)
    SUM = 0
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 100)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 6, 9 + 2 * NK%) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 100), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    If SUM > 0 Then Worksheets("matsin").Cells(10 * PK% + 7, 9 + 2 * NK%) = SUM
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

netPK:
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Sheets("matsin").Select
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Next PK%

netNK:
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Sheets("matsin").Select
Worksheets("matsin").Cells(1, 3) = 2 * NK%
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Next NK%

Worksheets("matsin").Cells(1, 3) = 100

With Application
.ScreenUpdating = True
End With
Sheets("matsin").Select

End Sub

Sub ranend()
iDrive$ = "C" '"C:", "C:\"
With CreateObject("Scripting.FileSystemObject").GetDrive(iDrive$)
     iSN& = .SerialNumber
     'MsgBox "Na?eeiue iiia? : " & iSerialNumber&, , ""
End With
Worksheets("natal").Cells(75, 1) = Int(Abs(iSN&))

If Int(Worksheets("natal").Cells(44, 1)) <> Int(Worksheets("natal").Cells(75, 1) / 13 + 1313) Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & Worksheets("natal").Cells(75, 1), , ""
Sheets("natal").Select
End

Else
End If

End Sub



Attribute VB_Name = "Module10"

Sub save()
Attribute save.VB_Description = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Attribute save.VB_ProcData.VB_Invoke_Func = "s\n14"
'
' save |fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: Ctrl+s
'
    Application.ScreenUpdating = False: Application.DisplayAlerts = False
    Dim ShName As String, FName As String
    ShName = ActiveSheet.NAME
    Workbooks.Add xlWBATWorksheet
    ThisWorkbook.Sheets(ShName).Cells.Copy ActiveWorkbook.Sheets(1).[a1]
    FName = Application.GetSaveAsFilename(InitialFileName:=ShName, _
    FileFilter:="Excel Files (*.xls), *.xls", Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    ActiveWorkbook.Close saveChanges:=True, Filename:=FName
    
End Sub
Sub swefem()

Dim NDAY As Long
Dim JULDAY As Double
Dim NSTROK As Long
Dim LILIT As Double

For NDAY = 2396758 To 2488434

JULDAY = NDAY
NSTROK = NDAY - 2396557
Worksheets("natal").Cells(NSTROK, 40) = JULDAY
Worksheets("natal").Cells(NSTROK, 41) = JDToDay(JULDAY + 1, 1)
Worksheets("natal").Cells(NSTROK, 42) = JDToDay(JULDAY + 1, 2)
Worksheets("natal").Cells(NSTROK, 43) = JDToDay(JULDAY + 1, 3)

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 21) = Plc(JULDAY + 1 / 2, 0, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 22) = Plc(JULDAY + 1 / 2, 1, STrop, 0) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 23) = Plc(JULDAY + 1 / 2, 2, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 24) = Plc(JULDAY + 1 / 2, 3, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 25) = Plc(JULDAY + 1 / 2, 4, STrop, 0) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 26) = Plc(JULDAY + 1 / 2, 5, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 27) = Plc(JULDAY + 1 / 2, 6, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 28) = Plc(JULDAY + 1 / 2, 7, STrop, 0) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 29) = Plc(JULDAY + 1 / 2, 8, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 30) = Plc(JULDAY + 1 / 2, 9, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 32) = Plc(JULDAY + 1 / 2, 11, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd||fffd||fffd||fffd|
LILIT = 153.9830555556 + 0.11138614 * (JULDAY - 2415020)
m1: If LILIT < 0 Then
    LILIT = LILIT + 360
    GoTo m1
    Else
    End If
m2: If LILIT >= 360 Then
    LILIT = LILIT - 360
    GoTo m2
    Else
    End If
Worksheets("natal").Cells(NSTROK, 31) = LILIT

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 51) = Plc(JULDAY + 1, 0, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 52) = Plc(JULDAY + 1, 1, STrop, 0) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 53) = Plc(JULDAY + 1, 2, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 54) = Plc(JULDAY + 1, 3, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 55) = Plc(JULDAY + 1, 4, STrop, 0) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 56) = Plc(JULDAY + 1, 5, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 57) = Plc(JULDAY + 1, 6, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 58) = Plc(JULDAY + 1, 7, STrop, 0) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 59) = Plc(JULDAY + 1, 8, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 60) = Plc(JULDAY + 1, 9, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NSTROK, 62) = Plc(JULDAY + 1, 11, STrop, 0) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd||fffd||fffd||fffd|
LILIT = 153.9830555556 + 0.11138614 * (JULDAY - 2415020 + 1 / 2)
m3: If LILIT < 0 Then
    LILIT = LILIT + 360
    GoTo m3
    Else
    End If
m4: If LILIT >= 360 Then
    LILIT = LILIT - 360
    GoTo m4
    Else
    End If
Worksheets("natal").Cells(NSTROK, 61) = LILIT

Next NDAY

End Sub

Sub firdar000()
' |fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| firdar

Sheets("firdar").Select
    Range("D2:F2").Select
    Selection.ClearContents
    Range("D11:F549").Select
    Selection.ClearContents
    
    Range("M11:O549").Select
    Selection.ClearContents
    
    Range("V11:X549").Select
    Selection.ClearContents
    
    ActiveWindow.ScrollRow = 11
    
    Worksheets("firdar").Cells(1, 1).Select
    
    
End Sub

Sub firdar()

Dim DEN As Long
Dim MES As Long
Dim GOD As Long
Dim K As Long
Dim JDN0 As Long  'JD |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDN As Long  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| JD
Dim NST As Long  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim A As Long
Dim B As Long
Dim C As Long
Dim D As Long
Dim E As Long
Dim M As Long

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 5)) < 1 Or Int(Worksheets("firdar").Cells(2, 5)) > 12 Then
   Worksheets("firdar").Cells(2, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 4)) < 1 Or Int(Worksheets("firdar").Cells(2, 4)) > 31 Then
   Worksheets("firdar").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 5)) = 2 And Int(Worksheets("firdar").Cells(2, 4)) > 29 Then
   Worksheets("firdar").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 5)) = 4 And Int(Worksheets("firdar").Cells(2, 4)) > 30 Then
   Worksheets("firdar").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 5)) = 6 And Int(Worksheets("firdar").Cells(2, 4)) > 30 Then
   Worksheets("firdar").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 5)) = 9 And Int(Worksheets("firdar").Cells(2, 4)) > 30 Then
   Worksheets("firdar").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 5)) = 11 And Int(Worksheets("firdar").Cells(2, 4)) > 30 Then
   Worksheets("firdar").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("firdar").Cells(2, 6)) < 1850 Or Int(Worksheets("firdar").Cells(2, 6)) > 2100 Then
   Worksheets("firdar").Cells(2, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If

DEN = Int(Worksheets("firdar").Cells(2, 4))
MES = Int(Worksheets("firdar").Cells(2, 5))
GOD = Int(Worksheets("firdar").Cells(2, 6))

For K = 201 To 91877
If DEN = Int(Worksheets("natal").Cells(K, 41)) And MES = Int(Worksheets("natal").Cells(K, 42)) And GOD = Int(Worksheets("natal").Cells(K, 43)) Then
JDN0 = Worksheets("natal").Cells(K, 40) + 1
Worksheets("firdar").Cells(11, 2) = JDN0
Exit For
Else
End If
Next K


For K = 11 To 549
For NST = 2 To 20 Step 9
Worksheets("firdar").Cells(K, NST) = Worksheets("firdar").Cells(K, NST + 1) + JDN0
JDN = Worksheets("firdar").Cells(K, NST)
A = JDN + 32044
B = Int((4 * A + 3) / 146097)
C = A - Int((146097 * B) / 4)
D = Int((4 * C + 3) / 1461)
E = C - Int((1461 * D) / 4)
M = Int((5 * E + 2) / 153)
DEN = E - Int((153 * M + 2) / 5) + 1
MES = M + 3 - 12 * Int(M / 10)
GOD = 100 * B + D - 4800 + Int(M / 10)
Worksheets("firdar").Cells(K, NST + 2) = DEN
Worksheets("firdar").Cells(K, NST + 3) = MES
Worksheets("firdar").Cells(K, NST + 4) = GOD
Next NST
Next K

ActiveWindow.ScrollRow = 11
ActiveWindow.ScrollColumn = 4


End Sub
Attribute VB_Name = "Module12"
Public Function Koh(RAMCgrad As Double, NDOM As Integer, Lat As Double, JD As Double) As Double
Dim E As Double
Dim pi As Double
Dim MC As Double
Dim X As Double
Dim C As Double
Dim Eg As Double
Dim ZNAM As Double
Dim LatRad As Double
pi = 3.14159265358979        '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("natal").Cells(1, 12) = "|fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd| Copyright |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Eg = (23.45163 - (0.02092 / 54787) * (JD - 2415021))
Worksheets("natal").Cells(38, 2) = Int(Eg)
Worksheets("natal").Cells(38, 3) = Int((Eg - Int(Eg)) * 60)
Worksheets("natal").Cells(38, 4) = ((Eg - Int(Eg)) * 60 - Worksheets("natal").Cells(38, 3)) * 60
E = Eg * pi / 180
'E = (23.452222222 - (0.019444445 / 54787) * (JD - 2415021)) * pi / 180 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim D(12) As Double '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim PV As Double '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
LatRad = Lat * pi / 180 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
RAMC = RAMCgrad * pi / 180 '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
D(10) = Atn(Tan(RAMC) / Cos(E))
D(10) = D(10) * 180 / pi ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If D(10) < 0 Then D(10) = D(10) + 180
If Abs(RAMCgrad - D(10)) > 10 Then D(10) = D(10) + 180
If D(10) > 360 Then D(10) = D(10) - 360
MC = D(10)
D(4) = D(10) + 180
If D(4) > 360 Then D(4) = D(4) - 360

'ZNAM = (Sin(RAMC) * Cos(E) + Sin(E) * Tan(LatRad))
'If ZNAM = 0 Then ZNAM = 1 / 1000000000

D(1) = Atn(-Cos(RAMC) / (Sin(RAMC) * Cos(E) + Sin(E) * Tan(LatRad)))
D(1) = D(1) * 180 / pi '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If D(1) < 0 Then D(1) = D(1) + 180
If D(10) >= 180 Then
    If D(1) < D(10) And D(1) > D(4) Then D(1) = D(1) + 180
Else
    If D(1) < D(10) Or D(1) > D(4) Then D(1) = D(1) + 180
End If
    If D(1) > 360 Then D(1) = D(1) - 360


'Asc = arcctg (|fffd| ((tg L * sin e) + (sin RAMC * cos e)) / cos RAMC)
'Arcsin(X) = Atn(X / Sqr(-X * X + 1))
'Arccos(X) = Atn(-X / Sqr(-X * X + 1)) + 2 * Atn(1)

X = -Tan(E) * Sin(RAMC) * Tan(LatRad)
C = Atn(-X / Sqr(-X * X + 1)) + 2 * Atn(1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

D(2) = Atn(-Cos(RAMC + C / 3) / (Sin(RAMC + C / 3) * Cos(E) + Sin(E) * Tan(LatRad)))
D(2) = D(2) * 180 / pi '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If D(2) < 0 Then D(2) = D(2) + 180
If D(10) >= 180 Then
    If D(2) < D(10) And D(2) > D(4) Then D(2) = D(2) + 180
Else
    If D(2) < D(10) Or D(2) > D(4) Then D(2) = D(2) + 180
End If
    If D(2) > 360 Then D(2) = D(2) - 360
    
D(3) = Atn(-Cos(RAMC + C * 2 / 3) / (Sin(RAMC + C * 2 / 3) * Cos(E) + Sin(E) * Tan(LatRad)))
D(3) = D(3) * 180 / pi '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If D(3) < 0 Then D(3) = D(3) + 180
If D(10) >= 180 Then
    If D(3) < D(10) And D(3) > D(4) Then D(3) = D(3) + 180
Else
    If D(3) < D(10) Or D(3) > D(4) Then D(3) = D(3) + 180
End If
    If D(3) > 360 Then D(3) = D(3) - 360
    
D(11) = Atn(-Cos(RAMC - C * 2 / 3) / (Sin(RAMC - C * 2 / 3) * Cos(E) + Sin(E) * Tan(LatRad)))
D(11) = D(11) * 180 / pi '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If D(11) < 0 Then D(11) = D(11) + 180
If D(10) >= 180 Then
    If D(11) < D(10) And D(11) > D(4) Then D(11) = D(11) + 180
Else
    If D(11) < D(10) Or D(11) > D(4) Then D(11) = D(11) + 180
End If
    If D(11) > 360 Then D(11) = D(11) - 360
    
D(12) = Atn(-Cos(RAMC - C / 3) / (Sin(RAMC - C / 3) * Cos(E) + Sin(E) * Tan(LatRad)))
D(12) = D(12) * 180 / pi '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If D(12) < 0 Then D(12) = D(12) + 180
If D(10) >= 180 Then
    If D(12) < D(10) And D(12) > D(4) Then D(12) = D(12) + 180
Else
    If D(12) < D(10) Or D(12) > D(4) Then D(12) = D(12) + 180
End If
    If D(12) > 360 Then D(12) = D(12) - 360
    
For K% = 1 To 3 '|fffd||fffd||fffd||fffd| 7, 8 |fffd| 9
D(K% + 6) = D(K%) + 180
If D(K% + 6) > 360 Then D(K% + 6) = D(K% + 6) - 360
Next K%

For K% = 11 To 12 '|fffd||fffd||fffd||fffd| 5 |fffd| 6
D(K% - 6) = D(K%) + 180
If D(K% - 6) > 360 Then D(K% - 6) = D(K% - 6) - 360
Next K%

Koh = D(NDOM)
End Function
Attribute VB_Name = "Module2"
Public Function ASPECT(X, Y)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| x |fffd| y
' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 0 |fffd||fffd| 180 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim XY As Double
XY = Abs(X - Y)
If XY <= 180 Then ASPECT = XY
If XY > 180 Then ASPECT = 360 - XY
End Function
Attribute VB_Name = "Module23"
Sub firmaOOO()

    Sheets("firma").Select  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Rows("14:50000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 14
    Range("A4").Select
    
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With
    
Worksheets("firma").Cells(2, 2) = 1
Worksheets("firma").Cells(2, 3) = 1
Worksheets("firma").Cells(2, 4) = 1900
Worksheets("firma").Cells(3, 2) = 10
Worksheets("firma").Cells(3, 3) = 1
Worksheets("firma").Cells(3, 4) = 1900
Worksheets("firma").Cells(8, 2) = 0

For KF% = 11 To 87 Step 4

Worksheets("firma").Cells(5, KF%) = 0
Worksheets("firma").Cells(6, KF%) = 0
Worksheets("firma").Cells(7, KF%) = 0
Worksheets("firma").Cells(4, KF%) = 0
Worksheets("firma").Cells(10, KF%) = 1
Worksheets("firma").Cells(11, KF%) = "&"
Worksheets("firma").Cells(12, KF%) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("firma").Cells(5, KF% + 1) = ""
Worksheets("firma").Cells(5, KF% + 2) = 0
Worksheets("firma").Cells(6, KF% + 2) = 0
Worksheets("firma").Cells(7, KF% + 2) = 0
Worksheets("firma").Cells(8, KF% + 2) = ""

Next KF%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub

Sub mestoOOO()

Worksheets("mesto").Select
Rows("16:65536").Select
Selection.ClearContents
Range("A10").Select

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Worksheets("mesto").Cells(3, 2) = 0
Worksheets("mesto").Cells(3, 3) = 0
Worksheets("mesto").Cells(3, 4) = "|fffd|"
Worksheets("mesto").Cells(3, 5) = 0
Worksheets("mesto").Cells(3, 6) = 0
Worksheets("mesto").Cells(3, 7) = "|fffd|"
Worksheets("mesto").Cells(4, 2) = 0
Worksheets("mesto").Cells(4, 3) = 0
Worksheets("mesto").Cells(4, 4) = "|fffd|"
Worksheets("mesto").Cells(4, 5) = 0
Worksheets("mesto").Cells(4, 6) = 0
Worksheets("mesto").Cells(4, 7) = "|fffd|"
Worksheets("mesto").Cells(5, 2) = 0
Worksheets("mesto").Cells(5, 3) = 0
Worksheets("mesto").Cells(5, 5) = 0
Worksheets("mesto").Cells(5, 6) = 0
Worksheets("mesto").Cells(8, 2) = 0

For KF% = 16 To 216 Step 4

Worksheets("mesto").Cells(5, KF%) = 0
Worksheets("mesto").Cells(6, KF%) = 0
Worksheets("mesto").Cells(7, KF%) = 0
Worksheets("mesto").Cells(10, KF%) = 0
Worksheets("mesto").Cells(11, KF%) = 0
Worksheets("mesto").Cells(12, KF%) = 1
Worksheets("mesto").Cells(13, KF%) = "&"
Worksheets("mesto").Cells(14, KF%) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("mesto").Cells(5, KF% + 1) = ""
Worksheets("mesto").Cells(5, KF% + 2) = 0
Worksheets("mesto").Cells(6, KF% + 2) = 0
Worksheets("mesto").Cells(7, KF% + 2) = 0
Worksheets("mesto").Cells(8, KF% + 2) = ""

Next KF%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub

Sub prognozOOO()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Worksheets("prognoz").Select
Rows("15:6000").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 15
Range("A13").Select

Worksheets("prognoz").Cells(2, 2) = 1
Worksheets("prognoz").Cells(2, 3) = 1
Worksheets("prognoz").Cells(2, 4) = 1900
Worksheets("prognoz").Cells(3, 2) = 10
Worksheets("prognoz").Cells(3, 3) = 1
Worksheets("prognoz").Cells(3, 4) = 1900
Worksheets("prognoz").Cells(6, 3) = 0

For KF% = 5 To 324 Step 11

Worksheets("prognoz").Cells(2, KF% + 9) = 0
Worksheets("prognoz").Cells(4, KF%) = ""
Worksheets("prognoz").Cells(5, KF%) = 0
Worksheets("prognoz").Cells(6, KF%) = 0
Worksheets("prognoz").Cells(7, KF%) = 0
Worksheets("prognoz").Cells(8, KF%) = ""
Worksheets("prognoz").Cells(10, KF%) = 1
Worksheets("prognoz").Cells(11, KF%) = 1
Worksheets("prognoz").Cells(12, KF%) = "&"

Worksheets("prognoz").Cells(5, KF% + 2) = ""
Worksheets("prognoz").Cells(6, KF% + 2) = ""
Worksheets("prognoz").Cells(7, KF% + 2) = ""

Worksheets("prognoz").Cells(11, KF% + 3) = 1
Worksheets("prognoz").Cells(12, KF% + 3) = "&"

Worksheets("prognoz").Cells(5, KF% + 4) = 0
Worksheets("prognoz").Cells(6, KF% + 4) = 0
Worksheets("prognoz").Cells(7, KF% + 4) = 0
Worksheets("prognoz").Cells(8, KF% + 4) = ""

Worksheets("prognoz").Cells(11, KF% + 7) = 1
Worksheets("prognoz").Cells(12, KF% + 7) = "&"

Next KF%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub
Sub MCprOOO()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| MCpr

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Worksheets("MCpr").Select
Rows("18:10000").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 18
Range("A18").Select

Worksheets("MCpr").Cells(2, 2) = 1
Worksheets("MCpr").Cells(2, 3) = 1
Worksheets("MCpr").Cells(2, 4) = 1900
Worksheets("MCpr").Cells(2, 5) = 0
Worksheets("MCpr").Cells(2, 6) = 10
Worksheets("MCpr").Cells(3, 2) = 1
Worksheets("MCpr").Cells(3, 3) = 1
Worksheets("MCpr").Cells(3, 4) = 1900
Worksheets("MCpr").Cells(3, 5) = 0
Worksheets("MCpr").Cells(3, 6) = 20
Worksheets("MCpr").Cells(4, 2) = 60
Worksheets("MCpr").Cells(7, 4) = 0

For KF% = 9 To 142 Step 7

Worksheets("MCpr").Cells(3, KF%) = 0
Worksheets("MCpr").Cells(7, KF%) = 0
Worksheets("MCpr").Cells(8, KF%) = ""
Worksheets("MCpr").Cells(3, KF%) = 0
Worksheets("MCpr").Cells(14, KF%) = 1

Worksheets("MCpr").Cells(3, KF% + 1) = 0
Worksheets("MCpr").Cells(7, KF% + 1) = 0

Worksheets("MCpr").Cells(3, KF% + 2) = "|fffd|"
Worksheets("MCpr").Cells(7, KF% + 2) = 0
Worksheets("MCpr").Cells(10, KF% + 2) = 0
Worksheets("MCpr").Cells(11, KF% + 2) = 0
Worksheets("MCpr").Cells(12, KF% + 2) = 0
Worksheets("MCpr").Cells(13, KF% + 2) = ""

Worksheets("MCpr").Cells(3, KF% + 3) = 0
Worksheets("MCpr").Cells(3, KF% + 4) = 0
Worksheets("MCpr").Cells(3, KF% + 5) = "|fffd|"
Worksheets("MCpr").Cells(17, KF% + 6) = 1

Next KF%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

End Sub

Sub poiskooo()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

    Sheets("poisk").Select  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Rows("14:50000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 14
    Range("A4").Select

Worksheets("poisk").Cells(2, 2) = 1
Worksheets("poisk").Cells(2, 3) = 1
Worksheets("poisk").Cells(2, 4) = 1900
Worksheets("poisk").Cells(2, 5) = 0
Worksheets("poisk").Cells(2, 6) = 10
Worksheets("poisk").Cells(3, 2) = 1
Worksheets("poisk").Cells(3, 3) = 1
Worksheets("poisk").Cells(3, 4) = 1900
Worksheets("poisk").Cells(3, 5) = 0
Worksheets("poisk").Cells(3, 6) = 20
Worksheets("poisk").Cells(4, 2) = 20
Worksheets("poisk").Cells(8, 2) = 0

For KF% = 10 To 154 Step 4

Worksheets("poisk").Cells(4, KF%) = 0
Worksheets("poisk").Cells(5, KF%) = 0
Worksheets("poisk").Cells(6, KF%) = 0
Worksheets("poisk").Cells(7, KF%) = 0
Worksheets("poisk").Cells(9, KF%) = 0
Worksheets("poisk").Cells(10, KF%) = 0
Worksheets("poisk").Cells(11, KF%) = "&"
Worksheets("poisk").Cells(12, KF%) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Worksheets("poisk").Cells(5, KF% + 1) = ""

Worksheets("poisk").Cells(5, KF% + 2) = 0
Worksheets("poisk").Cells(6, KF% + 2) = 0
Worksheets("poisk").Cells(7, KF% + 2) = 0
Worksheets("poisk").Cells(8, KF% + 2) = ""

Next KF%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub
Sub rekshablon()

Dim NSH As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 17 To 467 Step 9
NSH = Int(Worksheets("chek-f").Cells(2, K%))
If NSH = 0 Then GoTo netK

For M% = 12 To 903 Step 9
If NSH = Int(Worksheets("rek-shablon").Cells(2, M%)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("chek-f").Cells(8, K% - 7) = Worksheets("rek-shablon").Cells(5, M% - 7)
Worksheets("chek-f").Cells(10, K% - 7) = Worksheets("rek-shablon").Cells(6, M% - 7)
Worksheets("chek-f").Cells(11, K% - 7) = Worksheets("rek-shablon").Cells(7, M% - 7)
Worksheets("chek-f").Cells(10, K% - 4) = Worksheets("rek-shablon").Cells(6, M% - 4)
Worksheets("chek-f").Cells(11, K% - 4) = Worksheets("rek-shablon").Cells(7, M% - 4)
Worksheets("chek-f").Cells(10, K% - 1) = Worksheets("rek-shablon").Cells(6, M% - 1)
Worksheets("chek-f").Cells(11, K% - 1) = Worksheets("rek-shablon").Cells(7, M% - 1)

Worksheets("chek-f").Cells(15, K% - 7) = Worksheets("rek-shablon").Cells(9, M% - 7)
Worksheets("chek-f").Cells(16, K% - 7) = Worksheets("rek-shablon").Cells(10, M% - 7)
Worksheets("chek-f").Cells(17, K% - 7) = Worksheets("rek-shablon").Cells(11, M% - 7)
Worksheets("chek-f").Cells(18, K% - 7) = Worksheets("rek-shablon").Cells(12, M% - 7)
Worksheets("chek-f").Cells(15, K% - 5) = Worksheets("rek-shablon").Cells(9, M% - 5)
Worksheets("chek-f").Cells(16, K% - 5) = Worksheets("rek-shablon").Cells(10, M% - 5)
Worksheets("chek-f").Cells(17, K% - 5) = Worksheets("rek-shablon").Cells(11, M% - 5)
Worksheets("chek-f").Cells(15, K% - 3) = Worksheets("rek-shablon").Cells(9, M% - 3)
Worksheets("chek-f").Cells(16, K% - 3) = Worksheets("rek-shablon").Cells(10, M% - 3)
Worksheets("chek-f").Cells(17, K% - 3) = Worksheets("rek-shablon").Cells(11, M% - 3)
Worksheets("chek-f").Cells(18, K% - 3) = Worksheets("rek-shablon").Cells(12, M% - 3)

Worksheets("chek-f").Cells(20, K% - 7) = Worksheets("rek-shablon").Cells(14, M% - 7)
Worksheets("chek-f").Cells(21, K% - 7) = Worksheets("rek-shablon").Cells(15, M% - 7)
Worksheets("chek-f").Cells(22, K% - 7) = Worksheets("rek-shablon").Cells(16, M% - 7)
Worksheets("chek-f").Cells(23, K% - 7) = Worksheets("rek-shablon").Cells(17, M% - 7)
Worksheets("chek-f").Cells(20, K% - 5) = Worksheets("rek-shablon").Cells(14, M% - 5)
Worksheets("chek-f").Cells(21, K% - 5) = Worksheets("rek-shablon").Cells(15, M% - 5)
Worksheets("chek-f").Cells(22, K% - 5) = Worksheets("rek-shablon").Cells(16, M% - 5)
Worksheets("chek-f").Cells(20, K% - 3) = Worksheets("rek-shablon").Cells(14, M% - 3)
Worksheets("chek-f").Cells(21, K% - 3) = Worksheets("rek-shablon").Cells(15, M% - 3)
Worksheets("chek-f").Cells(22, K% - 3) = Worksheets("rek-shablon").Cells(16, M% - 3)
Worksheets("chek-f").Cells(23, K% - 3) = Worksheets("rek-shablon").Cells(17, M% - 3)

Worksheets("chek-f").Cells(25, K% - 7) = Worksheets("rek-shablon").Cells(19, M% - 7)
Worksheets("chek-f").Cells(26, K% - 7) = Worksheets("rek-shablon").Cells(20, M% - 7)
Worksheets("chek-f").Cells(27, K% - 7) = Worksheets("rek-shablon").Cells(21, M% - 7)
Worksheets("chek-f").Cells(28, K% - 7) = Worksheets("rek-shablon").Cells(22, M% - 7)
Worksheets("chek-f").Cells(25, K% - 5) = Worksheets("rek-shablon").Cells(19, M% - 5)
Worksheets("chek-f").Cells(26, K% - 5) = Worksheets("rek-shablon").Cells(20, M% - 5)
Worksheets("chek-f").Cells(27, K% - 5) = Worksheets("rek-shablon").Cells(21, M% - 5)
Worksheets("chek-f").Cells(25, K% - 3) = Worksheets("rek-shablon").Cells(19, M% - 3)
Worksheets("chek-f").Cells(26, K% - 3) = Worksheets("rek-shablon").Cells(20, M% - 3)
Worksheets("chek-f").Cells(27, K% - 3) = Worksheets("rek-shablon").Cells(21, M% - 3)
Worksheets("chek-f").Cells(28, K% - 3) = Worksheets("rek-shablon").Cells(22, M% - 3)

Else
End If
Next M%

netK: Next K%

End Sub

Sub chekfooo()
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| chek-f

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Worksheets("chek-f").Select
Rows("30:16038").Select
Selection.ClearContents
Rows("14:14").Select
Selection.ClearContents
Rows("19:19").Select
Selection.ClearContents
Rows("24:24").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 14
Range("A13").Select

Worksheets("chek-f").Cells(2, 2) = 1
Worksheets("chek-f").Cells(2, 3) = 1
Worksheets("chek-f").Cells(2, 4) = 1900
Worksheets("chek-f").Cells(2, 5) = 0
Worksheets("chek-f").Cells(2, 6) = 10
Worksheets("chek-f").Cells(3, 2) = 1
Worksheets("chek-f").Cells(3, 3) = 1
Worksheets("chek-f").Cells(3, 4) = 1900
Worksheets("chek-f").Cells(3, 5) = 0
Worksheets("chek-f").Cells(3, 6) = 20
Worksheets("chek-f").Cells(4, 2) = 20
Worksheets("chek-f").Cells(5, 6) = 0
Worksheets("chek-f").Cells(6, 4) = 0

For KF% = 10 To 460 Step 9

Worksheets("chek-f").Cells(2, KF% + 7) = 0
Worksheets("chek-f").Cells(7, KF%) = 0
Worksheets("chek-f").Cells(7, KF% + 1) = 0
Worksheets("chek-f").Cells(7, KF% + 2) = "|fffd|"
Worksheets("chek-f").Cells(7, KF% + 3) = 0
Worksheets("chek-f").Cells(7, KF% + 4) = 0
Worksheets("chek-f").Cells(7, KF% + 5) = "|fffd|"
Worksheets("chek-f").Cells(7, KF% + 6) = 0
Worksheets("chek-f").Cells(7, KF% + 7) = 0
Worksheets("chek-f").Cells(7, KF% + 8) = 0
Worksheets("chek-f").Cells(8, KF%) = ""
Worksheets("chek-f").Cells(9, KF%) = 1
Worksheets("chek-f").Cells(10, KF%) = 1
Worksheets("chek-f").Cells(10, KF% + 3) = 1
Worksheets("chek-f").Cells(10, KF% + 6) = 1
Worksheets("chek-f").Cells(11, KF%) = "&"
Worksheets("chek-f").Cells(11, KF% + 3) = "&"
Worksheets("chek-f").Cells(11, KF% + 6) = "&"

For M% = 15 To 25 Step 5
Worksheets("chek-f").Cells(M%, KF%) = 0
Worksheets("chek-f").Cells(M% + 1, KF%) = 0
Worksheets("chek-f").Cells(M% + 2, KF%) = 0
Worksheets("chek-f").Cells(M% + 3, KF%) = ""
Worksheets("chek-f").Cells(M%, KF% + 4) = 0
Worksheets("chek-f").Cells(M% + 1, KF% + 4) = 0
Worksheets("chek-f").Cells(M% + 2, KF% + 4) = 0
Worksheets("chek-f").Cells(M% + 3, KF% + 4) = ""
Worksheets("chek-f").Cells(M%, KF% + 2) = ""
Worksheets("chek-f").Cells(M% + 1, KF% + 2) = ""
Worksheets("chek-f").Cells(M% + 2, KF% + 2) = ""
Next M%

Next KF%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub

Sub izshablona()

Dim VOPR As String
Dim NS As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Nvar = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", 292, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
If Nvar = 7 Then ' |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    For KF% = 5 To 324 Step 11
    NS = Int(Worksheets("prognoz").Cells(2, KF% + 9))
    If NS < 1 Or NS > 210 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|.
Worksheets("prognoz").Cells(4, KF%) = ""
Worksheets("prognoz").Cells(5, KF%) = 0
Worksheets("prognoz").Cells(6, KF%) = 0
Worksheets("prognoz").Cells(7, KF%) = 0
Worksheets("prognoz").Cells(8, KF%) = ""
Worksheets("prognoz").Cells(5, KF% + 2) = ""
Worksheets("prognoz").Cells(6, KF% + 2) = ""
Worksheets("prognoz").Cells(7, KF% + 2) = ""
Worksheets("prognoz").Cells(5, KF% + 4) = 0
Worksheets("prognoz").Cells(6, KF% + 4) = 0
Worksheets("prognoz").Cells(7, KF% + 4) = 0
Worksheets("prognoz").Cells(8, KF% + 4) = ""
    Else
    End If
    If NS < 1 Or NS > 210 Then GoTo netNS
    
        For n% = 10 To 70 Step 10 '|fffd||fffd||fffd||fffd||fffd||fffd|
        For K% = 5 To 324 Step 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NS = Int(Worksheets("shablon").Cells(n% + 2, K% + 9)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
Worksheets("prognoz").Cells(4, KF%) = Worksheets("shablon").Cells(n%, K%)
Worksheets("prognoz").Cells(5, KF%) = Worksheets("shablon").Cells(n% + 1, K%)
Worksheets("prognoz").Cells(6, KF%) = Worksheets("shablon").Cells(n% + 2, K%)
Worksheets("prognoz").Cells(7, KF%) = Worksheets("shablon").Cells(n% + 3, K%)
Worksheets("prognoz").Cells(8, KF%) = Worksheets("shablon").Cells(n% + 4, K%)
Worksheets("prognoz").Cells(10, KF%) = Worksheets("shablon").Cells(n% + 6, K%)
Worksheets("prognoz").Cells(11, KF%) = Worksheets("shablon").Cells(n% + 7, K%)
Worksheets("prognoz").Cells(12, KF%) = Worksheets("shablon").Cells(n% + 8, K%)

Worksheets("prognoz").Cells(5, KF% + 2) = Worksheets("shablon").Cells(n% + 1, K% + 2)
Worksheets("prognoz").Cells(6, KF% + 2) = Worksheets("shablon").Cells(n% + 2, K% + 2)
Worksheets("prognoz").Cells(7, KF% + 2) = Worksheets("shablon").Cells(n% + 3, K% + 2)

Worksheets("prognoz").Cells(11, KF% + 3) = Worksheets("shablon").Cells(n% + 7, K% + 3)
Worksheets("prognoz").Cells(12, KF% + 3) = Worksheets("shablon").Cells(n% + 8, K% + 3)

Worksheets("prognoz").Cells(5, KF% + 4) = Worksheets("shablon").Cells(n% + 1, K% + 4)
Worksheets("prognoz").Cells(6, KF% + 4) = Worksheets("shablon").Cells(n% + 2, K% + 4)
Worksheets("prognoz").Cells(7, KF% + 4) = Worksheets("shablon").Cells(n% + 3, K% + 4)
Worksheets("prognoz").Cells(8, KF% + 4) = Worksheets("shablon").Cells(n% + 4, K% + 4)

Worksheets("prognoz").Cells(11, KF% + 7) = Worksheets("shablon").Cells(n% + 7, K% + 7)
Worksheets("prognoz").Cells(12, KF% + 7) = Worksheets("shablon").Cells(n% + 8, K% + 7)
        
        Else
        End If
        
        Next K%
        Next n%

netNS:     Next KF%

End
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'========================== |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 10 To 70 Step 10

VOPR = Worksheets("shablon").Cells(n%, 1) + "?"
Nvar = MsgBox(VOPR, 292, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|")
If Nvar = 7 Then GoTo netN ' |fffd||fffd||fffd|

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

For KF% = 5 To 324 Step 11

Worksheets("prognoz").Cells(4, KF%) = Worksheets("shablon").Cells(n%, KF%)
Worksheets("prognoz").Cells(5, KF%) = Worksheets("shablon").Cells(n% + 1, KF%)
Worksheets("prognoz").Cells(6, KF%) = Worksheets("shablon").Cells(n% + 2, KF%)
Worksheets("prognoz").Cells(7, KF%) = Worksheets("shablon").Cells(n% + 3, KF%)
Worksheets("prognoz").Cells(8, KF%) = Worksheets("shablon").Cells(n% + 4, KF%)
Worksheets("prognoz").Cells(10, KF%) = Worksheets("shablon").Cells(n% + 6, KF%)
Worksheets("prognoz").Cells(11, KF%) = Worksheets("shablon").Cells(n% + 7, KF%)
Worksheets("prognoz").Cells(12, KF%) = Worksheets("shablon").Cells(n% + 8, KF%)

Worksheets("prognoz").Cells(5, KF% + 2) = Worksheets("shablon").Cells(n% + 1, KF% + 2)
Worksheets("prognoz").Cells(6, KF% + 2) = Worksheets("shablon").Cells(n% + 2, KF% + 2)
Worksheets("prognoz").Cells(7, KF% + 2) = Worksheets("shablon").Cells(n% + 3, KF% + 2)

Worksheets("prognoz").Cells(11, KF% + 3) = Worksheets("shablon").Cells(n% + 7, KF% + 3)
Worksheets("prognoz").Cells(12, KF% + 3) = Worksheets("shablon").Cells(n% + 8, KF% + 3)

Worksheets("prognoz").Cells(5, KF% + 4) = Worksheets("shablon").Cells(n% + 1, KF% + 4)
Worksheets("prognoz").Cells(6, KF% + 4) = Worksheets("shablon").Cells(n% + 2, KF% + 4)
Worksheets("prognoz").Cells(7, KF% + 4) = Worksheets("shablon").Cells(n% + 3, KF% + 4)
Worksheets("prognoz").Cells(8, KF% + 4) = Worksheets("shablon").Cells(n% + 4, KF% + 4)

Worksheets("prognoz").Cells(11, KF% + 7) = Worksheets("shablon").Cells(n% + 7, KF% + 7)
Worksheets("prognoz").Cells(12, KF% + 7) = Worksheets("shablon").Cells(n% + 8, KF% + 7)

Next KF%

Exit For
netN: Next n%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub
Sub profkarm()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

For K% = 11 To 200
Worksheets("PROFI").Cells(K%, 101) = Worksheets("PROFI").Cells(K%, 1)
Worksheets("PROFI").Cells(K%, 103) = Worksheets("PROFI").Cells(K%, 3)
Next K%

Call karma

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Call profi

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

For K% = 11 To 200
Worksheets("PROFI").Cells(K%, 105) = Worksheets("PROFI").Cells(K%, 1)
Next K%

Call radiks

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

For K% = 11 To 200
Worksheets("PROFI").Cells(K%, 1) = Worksheets("PROFI").Cells(K%, 101)
Worksheets("PROFI").Cells(K%, 3) = Worksheets("PROFI").Cells(K%, 103)
Worksheets("PROFI").Cells(K%, 5) = Worksheets("PROFI").Cells(K%, 105)
Next K%

Sheets("PROFI").Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 11 To 200
If Trim(Worksheets("PROFI").Cells(K%, 5)) = "" Then GoTo netK

For n% = 11 To 200

If Trim(Worksheets("PROFI").Cells(K%, 5)) = Trim(Worksheets("PROFI").Cells(n%, 1)) Then
Worksheets("PROFI").Cells(K%, 5).Select
Selection.Font.Bold = True
Worksheets("PROFI").Cells(n%, 1).Select
Selection.Font.Bold = True
Else
End If

If Trim(Worksheets("PROFI").Cells(K%, 5)) = Trim(Worksheets("PROFI").Cells(n%, 3)) Then
Worksheets("PROFI").Cells(K%, 5).Select
Selection.Font.Bold = True
Worksheets("PROFI").Cells(n%, 3).Select
Selection.Font.Bold = True
Else
End If

Next n%

netK: Next K%

    Sheets("PROFI").Select
    ActiveWindow.ScrollRow = 11
    Range("A10").Select
    
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

End Sub
Sub diag()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Worksheets("med").Select
Rows("31:606").Select
Selection.Font.Bold = True
    Selection.Font.Bold = False
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
Selection.ClearContents
Range("A7").Select

Dim STROK As Integer
Dim FLAGDI As Integer
Dim ND As Integer
Dim NF As Integer


'======== |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| =======================
STROK = 31

For NF% = 31 To 600 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("diagnoz").Cells(NF%, 1)) = "" Then GoTo netNF '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
FLAGDI = 1

For i% = 0 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("diagnoz").Cells(NF%, 1) = 0 Then GoTo netI '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 2 And Worksheets("med").Cells(10 + i%, 9) >= 3 Then FLAGDI = 0
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 2 And Worksheets("med").Cells(10 + i%, 9) = 0 Then FLAGDI = 0
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 3 And Worksheets("med").Cells(10 + i%, 9) < 3 Then FLAGDI = 0
netI: Next i% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If FLAGDI = 1 Then
Worksheets("med").Cells(STROK, 2) = Worksheets("diagnoz").Cells(NF%, 1)
STROK = STROK + 1
Else
End If

netNF: Next NF% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'======== |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| =======================
STROK = 31

For NF% = 31 To 600 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("diagnoz").Cells(NF%, 1)) = "" Then GoTo netNF2 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
FLAGDI = 1

For i% = 0 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 0 Then GoTo netII '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 2 And Worksheets("med").Cells(10 + i%, 19) >= 3 Then FLAGDI = 0
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 2 And Worksheets("med").Cells(10 + i%, 19) = 0 Then FLAGDI = 0
If Worksheets("diagnoz").Cells(NF%, 1 + i%) = 3 And Worksheets("med").Cells(10 + i%, 19) < 3 Then FLAGDI = 0
netII: Next i% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If FLAGDI = 1 Then
Worksheets("med").Cells(STROK, 12) = Worksheets("diagnoz").Cells(NF%, 1)
STROK = STROK + 1
Else
End If

netNF2: Next NF% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Sheets("med").Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 31 To 606
If Trim(Worksheets("med").Cells(K%, 2)) = "" Then GoTo netK

For n% = 31 To 606
If Trim(Worksheets("med").Cells(n%, 12)) = "" Then GoTo netN

If Trim(Worksheets("med").Cells(K%, 2)) = Trim(Worksheets("med").Cells(n%, 12)) Then
Worksheets("med").Cells(K%, 2).Select
Selection.Font.Bold = True
 With Selection.Font
        .Color = -16777024
        .TintAndShade = 0
 End With
Worksheets("med").Cells(n%, 12).Select
Selection.Font.Bold = True
 With Selection.Font
        .Color = -16777024
        .TintAndShade = 0
 End With
Else
End If

netN: Next n%

netK: Next K%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

End Sub
Sub profi()
Attribute profi.VB_ProcData.VB_Invoke_Func = " \n14"
'
'
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

    Sheets("PROFI").Select   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("A11:E200").Select
    Selection.Font.Bold = False
    Selection.ClearContents
    Range("A7").Select
    
'Call proftest
    
Dim STROK As Integer
Dim FLAGPRO As Integer
Dim FLAGDOM As Integer
Dim NP1 As Integer
Dim NP2 As Integer
Dim SUM As Integer
Dim DFLAG(12, 12) As Integer
Dim NDOM1 As Integer
Dim NDOM2 As Integer
Dim ASP As Integer

For K% = 10 To 30 Step 20 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
STROK = 11

For NF% = 11 To 5011 Step 8 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + 6, 255) = 0 Then GoTo netNF '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
FLAGPRO = 1

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
FLAGDOM = 1
For i% = 0 To 6
If Worksheets("prof-baza").Cells(NF% + i%, 2) = 0 Then GoTo netI
If Worksheets("dom").Cells(K% + 13, 10 + 4 * Int(Worksheets("prof-baza").Cells(NF% + i%, 2))) < Worksheets("prof-baza").Cells(1, 2) Then
FLAGDOM = 0
Exit For
Else
End If
netI: Next i%

If FLAGDOM = 0 Then GoTo netNF '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For KF% = 4 To 252 Step 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + 6, KF% + 1) = 0 Then GoTo netKF '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd|
SUM = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
DFLAG(i%, M%) = 0
Next M%
Next i%

For i% = 0 To 2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + i%, KF%) = 0 Then GoTo netII '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Int(Worksheets("prof-baza").Cells(NF% + i%, KF%))
For M% = 0 To 2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + M%, KF% + 2) = 0 Then GoTo netMM '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Int(Worksheets("prof-baza").Cells(NF% + M%, KF% + 2))
If DFLAG(NDOM1, NDOM2) = 1 Then GoTo netMM
If DFLAG(NDOM2, NDOM1) = 1 Then GoTo netMM

If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
SUM = SUM + Worksheets("dom").Cells(K% + NDOM1, 10 + 4 * NDOM2)
DFLAG(NDOM1, NDOM2) = 1
DFLAG(NDOM2, NDOM1) = 1
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" Then
SUM = SUM + Worksheets("dom").Cells(K% + NDOM1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(K% + NDOM1, 9 + 4 * NDOM2)
DFLAG(NDOM1, NDOM2) = 1
DFLAG(NDOM2, NDOM1) = 1
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" Then
SUM = SUM + Worksheets("dom").Cells(K% + NDOM1, 7 + 4 * NDOM2)
DFLAG(NDOM1, NDOM2) = 1
DFLAG(NDOM2, NDOM1) = 1
Else
End If

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" Then
SUM = SUM + Worksheets("dom").Cells(K% + NDOM1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(K% + NDOM1, 9 + 4 * NDOM2)
DFLAG(NDOM1, NDOM2) = 1
DFLAG(NDOM2, NDOM1) = 1
Else
End If

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" Then
SUM = SUM + Worksheets("dom").Cells(K% + NDOM1, 8 + 4 * NDOM2)
DFLAG(NDOM1, NDOM2) = 1
DFLAG(NDOM2, NDOM1) = 1
Else
End If

netMM: Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For M% = 3 To 5
If Worksheets("prof-baza").Cells(NF% + M%, KF% + 3) = 0 Then GoTo netMMM '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NP2 = Worksheets("prof-baza").Cells(NF% + M%, KF% + 3)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP2, 10 + 4 * NDOM1)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP2, 7 + 4 * NDOM1) + Worksheets("dom").Cells(K% + 190 + NP2, 9 + 4 * NDOM1)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP2, 7 + 4 * NDOM1)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP2, 8 + 4 * NDOM1) + Worksheets("dom").Cells(K% + 190 + NP2, 9 + 4 * NDOM1)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP2, 8 + 4 * NDOM1)
netMMM: Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

netII: Next i% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 0 To 2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + M%, KF% + 2) = 0 Then GoTo netMMMM '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Int(Worksheets("prof-baza").Cells(NF% + M%, KF% + 2))
For i% = 3 To 5 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + i%, KF% + 1) = 0 Then GoTo netIII '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NP1 = Worksheets("prof-baza").Cells(NF% + i%, KF% + 1)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP1, 10 + 4 * NDOM2)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(K% + 190 + NP1, 9 + 4 * NDOM2)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP1, 7 + 4 * NDOM2)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(K% + 190 + NP1, 9 + 4 * NDOM2)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" Then SUM = SUM + Worksheets("dom").Cells(K% + 190 + NP1, 8 + 4 * NDOM2)
netIII: Next i% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
netMMMM: Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 3 To 5 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + i%, KF% + 1) = 0 Then GoTo netIIII '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NP1 = Worksheets("prof-baza").Cells(NF% + i%, KF% + 1)
For j% = 3 To 5 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(NF% + j%, KF% + 3) = 0 Then GoTo netJ '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NP2 = Worksheets("prof-baza").Cells(NF% + j%, KF% + 3)
ASP = 0
If NP1 < NP2 Then
NP1 = Worksheets("prof-baza").Cells(NF% + j%, KF% + 3)
NP2 = Worksheets("prof-baza").Cells(NF% + i%, KF% + 1)
Else
End If
ASP = Int(Worksheets("orb").Cells(10 + NP1, 30 + NP2))
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "" And ASP > 0 Then SUM = SUM + 1
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" And (ASP = 1 Or ASP = 60 Or ASP = 120) Then SUM = SUM + 1
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "&" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" And (ASP = 60 Or ASP = 120) Then SUM = SUM + 1
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "#" And (ASP = 1 Or ASP = 90 Or ASP = 180) Then SUM = SUM + 1
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prof-baza").Cells(NF%, KF% + 1)) = "#" And Trim(Worksheets("prof-baza").Cells(NF% + 1, KF% + 1)) = "&" And (ASP = 90 Or ASP = 180) Then SUM = SUM + 1
netJ: Next j%
netIIII: Next i%

If SUM < Worksheets("prof-baza").Cells(NF% + 6, KF% + 1) Then
FLAGPRO = 0
Exit For '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If

netKF: Next KF% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If FLAGPRO = 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("PROFI").Cells(STROK, Int(K% / 10)) = Worksheets("prof-baza").Cells(NF%, 1)
STROK = STROK + 1
Else
End If

netNF: Next NF% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next K% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    Sheets("PROFI").Select
    ActiveWindow.ScrollRow = 11
    
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

End Sub
Attribute VB_Name = "Module24"

Sub FIO()
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("name").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Range("A16:H440").Select
Selection.ClearContents
Range("A5").Select

Dim pol As Integer
pol = 0

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("name").Cells(4, 3) = Trim(Worksheets("name").Cells(4, 3))
If Worksheets("name").Cells(4, 3) = "|fffd|" Then Worksheets("name").Cells(4, 3) = "|fffd|"
If Worksheets("name").Cells(4, 3) = "|fffd|" Then Worksheets("name").Cells(4, 3) = "|fffd|"
If Worksheets("name").Cells(4, 3) = "|fffd|" Then pol = 1
If Worksheets("name").Cells(4, 3) = "|fffd|" Then pol = 2

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("name").Cells(3, 3)) < 1 Or Int(Worksheets("name").Cells(2, 3)) > 10 Then
   Worksheets("name").Cells(3, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If pol = 0 Then
   Worksheets("name").Cells(4, 3).Select
   MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd|/|fffd| ?")
   End
   Else
   End If

Dim FA As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim OT As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim IM As String '|fffd||fffd||fffd|
Dim FIO As String
Dim S As Integer
Dim STROK As Integer
STROK = 16
Worksheets("name").Cells(STROK, 2) = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|."

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 11 To 4000 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| c |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("name").Cells(M%, 13) = 0 Then GoTo netIM
If Worksheets("name").Cells(M%, 10) = Worksheets("name").Cells(4, 3) And Int(Worksheets("name").Cells(M%, 13)) = Int(Worksheets("name").Cells(3, 3)) Then
FIO = Worksheets("name").Cells(M%, 9) + " " + Worksheets("name").Cells(10, 2) + " " + Worksheets("name").Cells(9, 2)
S = numer(FIO)
Worksheets("name").Cells(STROK, 3) = S
Worksheets("name").Cells(STROK, 4) = "=>"
S = numsum(S)
Worksheets("name").Cells(STROK, 5) = S
Worksheets("name").Cells(STROK, 6) = "=>"
S = numsum(S)
Worksheets("name").Cells(STROK, 7) = S
    'If S = Worksheets("name").Cells(2, 3) Then
    Worksheets("name").Cells(STROK, 1) = Int(Worksheets("name").Cells(M%, 13))
    Worksheets("name").Cells(STROK, 2) = FIO
    Worksheets("name").Cells(STROK, 8) = PLANETA(S)
    STROK = STROK + 1
    'Else
    'End If
Else
End If
netIM: Next M%

End Sub

Sub names()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

Dim IM As String '|fffd||fffd||fffd|
Dim S As Integer

For M% = 11 To 4000 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
IM = Worksheets("name").Cells(M%, 9)
IM = Trim(IM)
Worksheets("name").Cells(M%, 11) = numer(IM)
For K% = 12 To 13 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
S = Int(Worksheets("name").Cells(M%, (K% - 1)))
Worksheets("name").Cells(M%, K%) = numsum(S)
Next K%
S = Worksheets("name").Cells(M%, 13)
Worksheets("name").Cells(M%, 14) = PLANETA(S)
If Worksheets("name").Cells(M%, 11) = 0 Then Worksheets("name").Cells(M%, 14) = ""
Next M%

End Sub

Sub numer_name()
Attribute numer_name.VB_Description = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Attribute numer_name.VB_ProcData.VB_Invoke_Func = " \n14"
'
' numer_name |fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    Sheets("name").Select   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Range("C9:C12").Select
    Selection.ClearContents
    Range("E9:E12").Select
    Selection.ClearContents
    Range("G9:H12").Select
    Selection.ClearContents
    Range("A5").Select
    
Dim FA As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim OT As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim IM As String '|fffd||fffd||fffd|
Dim S As Integer

FA = Worksheets("name").Cells(9, 2)
FA = Trim(FA)
OT = Worksheets("name").Cells(10, 2)
OT = Trim(OT)
IM = Worksheets("name").Cells(11, 2)
IM = Trim(IM)

Worksheets("name").Cells(9, 3) = numer(FA)
Worksheets("name").Cells(10, 3) = numer(OT)
Worksheets("name").Cells(11, 3) = numer(IM)
Worksheets("name").Cells(12, 3) = Worksheets("name").Cells(9, 3) + Worksheets("name").Cells(10, 3) + Worksheets("name").Cells(11, 3)

For M% = 9 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 5 To 7 Step 2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
S = Int(Worksheets("name").Cells(M%, (K% - 2)))
Worksheets("name").Cells(M%, K%) = numsum(S)
Next K%
S = Worksheets("name").Cells(M%, 7)
Worksheets("name").Cells(M%, 8) = PLANETA(S)
Next M%
    
End Sub

Function numer(STR As String) As Integer
Dim SUM As Integer
Dim LSTR As Long

LSTR = Len(STR)
If LSTR = 0 Then GoTo netSTR

For K% = 1 To LSTR
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 5
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 6
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 4
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 7
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 9
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 2
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 1
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 8
If Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Or Mid(STR, K%, 1) = "|fffd|" Then SUM = SUM + 3
Next K%

netSTR: numer = SUM

End Function
Function numsum(X As Integer) As Integer
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim SUM As Integer

txt = CStr(X)
For K% = 1 To Len(txt)
SUM = SUM + Val(Mid$(txt, K%, 1))
Next K%

If X < 11 Then
numsum = X
Else
numsum = SUM
End If

End Function
Function PLANETA(n As Integer) As String

If n = 0 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd|)"
If n = 1 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd|)"
If n = 2 Then PLANETA = "|fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
If n = 3 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
If n = 4 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
If n = 5 Then PLANETA = "|fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
If n = 6 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd|)"
If n = 7 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd|)"
If n = 8 Then PLANETA = "|fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|)"
If n = 9 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|)"
If n = 10 Then PLANETA = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
If n > 10 Then PLANETA = ""

End Function

Attribute VB_Name = "Module25"
Sub PRO_PDNatLoc(NDOM As Integer, ZNAK As String, PLANET As String, NF As Integer)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|

Dim NPL As Integer
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21
If Trim(Worksheets("natal").Cells(n%, 1)) = PLANET Then NPL = n%
Next n%

If NDOM = Int(Worksheets("MP").Cells(NPL, 28)) Then
    If Int(Worksheets("MP").Cells(NPL, 28)) = 6 Or Int(Worksheets("MP").Cells(NPL, 28)) = 12 Or Int(Worksheets("MP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("BP").Cells(NPL, 28)) Then
    If Int(Worksheets("BP").Cells(NPL, 28)) = 6 Or Int(Worksheets("BP").Cells(NPL, 28)) = 12 Or Int(Worksheets("BP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("prognoz").Cells(11, (NF + 3)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("chek-f").Cells(11, (NF + 3)) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("TR").Cells(NPL, 28)) Then
    If Int(Worksheets("TR").Cells(NPL, 28)) = 6 Or Int(Worksheets("TR").Cells(NPL, 28)) = 12 Or Int(Worksheets("TR").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("prognoz").Cells(11, (NF + 6)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("chek-f").Cells(11, (NF + 6)) + 1
    End If
Else
End If
'---------------------------

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 6)
If Worksheets("natal").Cells(KP%, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netMM
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
            If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
         Else
         End If
    Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
         If PLANET = "|fffd||fffd||fffd||fffd|" Then
            If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
             Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
             End If
         Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
         End If
    End If '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        End If
End If '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Next NA%
netMM: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 6)
    If Worksheets("natal").Cells(NPL, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 45 To 54 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netm

For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If PLANET = "|fffd||fffd||fffd||fffd|" Then
                If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                    If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                    Else
                    End If
                Else
                    If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                    Else
                    End If
                End If
            Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
            End If
        End If
    Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        End If
    End If
Else
End If
Next NA%
netm: Next M%
Next KP%
'========================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 8)
If Worksheets("natal").Cells(KP%, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
         Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("prognoz").Cells(11, (NF + 3)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 4)) = Worksheets("prognoz").Cells(11, (NF + 4)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 5)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 5)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 5)) = Abs(ASP1 - NA%)
Else
End If
Next NA%

netMMBP: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 8)
If Worksheets("natal").Cells(NPL, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 45 To 54 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

         Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("prognoz").Cells(11, (NF + 3)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 4)) = Worksheets("prognoz").Cells(11, (NF + 4)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 5)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 5)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 5)) = Abs(ASP1 - NA%)
Else
End If
Next NA%
netMBP: Next M%
Next KP%
'=================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 10)
If Worksheets("natal").Cells(KP%, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMMTR
    
 For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

         Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("prognoz").Cells(11, (NF + 6)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 7)) = Worksheets("prognoz").Cells(11, (NF + 7)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 8)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 8)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 8)) = Abs(ASP1 - NA%)

Else
End If
netNA: Next NA%
netMMTR: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 10)
If Worksheets("natal").Cells(NPL, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
    
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 45 To 54 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMTR
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netuNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

         Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("prognoz").Cells(11, (NF + 6)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 7)) = Worksheets("prognoz").Cells(11, (NF + 7)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 8)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 8)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 8)) = Abs(ASP1 - NA%)
Else
End If
netuNA: Next NA%
netMTR: Next M%
Next KP%

End Sub
Sub PRO_PDLoc(NDOM As Integer, ZNAK As String, PLANET As String, NF As Integer)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|

Dim NPL As Integer
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21
If Trim(Worksheets("natal").Cells(n%, 1)) = PLANET Then NPL = n%
Next n%

If NDOM = Int(Worksheets("MP").Cells(NPL, 28)) Then
    If Int(Worksheets("MP").Cells(NPL, 28)) = 6 Or Int(Worksheets("MP").Cells(NPL, 28)) = 12 Or Int(Worksheets("MP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("BP").Cells(NPL, 28)) Then
    If Int(Worksheets("BP").Cells(NPL, 28)) = 6 Or Int(Worksheets("BP").Cells(NPL, 28)) = 12 Or Int(Worksheets("BP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("prognoz").Cells(11, (NF + 3)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("chek-f").Cells(11, (NF + 3)) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("TR").Cells(NPL, 28)) Then
    If Int(Worksheets("TR").Cells(NPL, 28)) = 6 Or Int(Worksheets("TR").Cells(NPL, 28)) = 12 Or Int(Worksheets("TR").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("prognoz").Cells(11, (NF + 6)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("chek-f").Cells(11, (NF + 6)) + 1
    End If
Else
End If
'---------------------------

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 6)
If Worksheets("natal").Cells(KP%, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netMM
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
            If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
         Else
         End If
    Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
         If PLANET = "|fffd||fffd||fffd||fffd|" Then
            If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
             Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
             End If
         Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
         End If
    End If '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        End If
End If '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Next NA%
netMM: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 6)
    If Worksheets("natal").Cells(NPL, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 38 To 44 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netm

For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If PLANET = "|fffd||fffd||fffd||fffd|" Then
                If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                    If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                    Else
                    End If
                Else
                    If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                    Else
                    End If
                End If
            Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
                Else
                End If
            End If
        End If
    Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("prognoz").Cells(11, NF) = Worksheets("prognoz").Cells(11, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 1)) = Worksheets("prognoz").Cells(11, (NF + 1)) + 1
                If Worksheets("prognoz").Cells(11, (NF + 2)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 2)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 2)) = Abs(ASP1 - NA%)
            Else
            End If
        End If
    End If
Else
End If
Next NA%
netm: Next M%
Next KP%
'========================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 8)
If Worksheets("natal").Cells(KP%, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
         Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("prognoz").Cells(11, (NF + 3)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 4)) = Worksheets("prognoz").Cells(11, (NF + 4)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 5)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 5)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 5)) = Abs(ASP1 - NA%)
Else
End If
Next NA%

netMMBP: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 8)
If Worksheets("natal").Cells(NPL, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 38 To 44 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

         Worksheets("prognoz").Cells(11, (NF + 3)) = Worksheets("prognoz").Cells(11, (NF + 3)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 4)) = Worksheets("prognoz").Cells(11, (NF + 4)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 5)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 5)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 5)) = Abs(ASP1 - NA%)
Else
End If
Next NA%
netMBP: Next M%
Next KP%
'=================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 10)
If Worksheets("natal").Cells(KP%, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMMTR
    
 For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

         Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("prognoz").Cells(11, (NF + 6)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 7)) = Worksheets("prognoz").Cells(11, (NF + 7)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 8)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 8)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 8)) = Abs(ASP1 - NA%)

Else
End If
netNA: Next NA%
netMMTR: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 10)
If Worksheets("natal").Cells(NPL, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
    
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 38 To 44 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMTR
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netuNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

         Worksheets("prognoz").Cells(11, (NF + 6)) = Worksheets("prognoz").Cells(11, (NF + 6)) + 1
         If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 7)) = Worksheets("prognoz").Cells(11, (NF + 7)) + 1
         If Worksheets("prognoz").Cells(11, (NF + 8)) = 0 Or Worksheets("prognoz").Cells(11, (NF + 8)) > Abs(ASP1 - NA%) Then Worksheets("prognoz").Cells(11, (NF + 8)) = Abs(ASP1 - NA%)

Else
End If
netuNA: Next NA%
netMTR: Next M%
Next KP%

End Sub
Sub razprognoz()

Rows("15:6000").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 15
Range("A13").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prognoz").Cells(2, 2) < 0 Or Worksheets("prognoz").Cells(2, 2) > 31 Then
    Worksheets("prognoz").Cells(2, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(2, 3) < 0 Or Worksheets("prognoz").Cells(2, 3) > 12 Then
    Worksheets("prognoz").Cells(2, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(2, 4) < 0 Then
    Worksheets("prognoz").Cells(2, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(3, 2) < 0 Or Worksheets("prognoz").Cells(3, 2) > 31 Then
    Worksheets("prognoz").Cells(3, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(3, 3) < 0 Or Worksheets("prognoz").Cells(3, 3) > 12 Then
    Worksheets("prognoz").Cells(3, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(3, 4) < 0 Then
    Worksheets("prognoz").Cells(3, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

Dim ERRP As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 5 To 324 Step 11

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd|
If Int(Worksheets("prognoz").Cells(8, K% + 10)) < 0 Or Int(Worksheets("prognoz").Cells(8, K% + 10)) > 359 Then
   Worksheets("prognoz").Cells(8, K% + 10).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("prognoz").Cells(5, K% + 10))) > 66 Then
   Worksheets("prognoz").Cells(5, K% + 10).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Abs(Int(Worksheets("prognoz").Cells(9, K% + 10))) > 59 Then
   Worksheets("prognoz").Cells(9, K% + 10).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("prognoz").Cells(6, K% + 10))) > 59 Then
   Worksheets("prognoz").Cells(6, K% + 10).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd|
If Trim(Worksheets("prognoz").Cells(10, K% + 10)) = "|fffd|" Or Trim(Worksheets("prognoz").Cells(10, K% + 10)) = "|fffd|" Then
   Else
   Worksheets("prognoz").Cells(10, K% + 10).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   End If
If Trim(Worksheets("prognoz").Cells(7, K% + 10)) = "|fffd|" Or Trim(Worksheets("prognoz").Cells(7, K% + 10)) = "|fffd|" Then
   Else
   Worksheets("prognoz").Cells(7, K% + 10).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| - |fffd||fffd||fffd||fffd||fffd|!")
   End
   End If

'===============
For M% = 5 To 7
If Worksheets("prognoz").Cells(M%, (K% + 2)) <> "" And Worksheets("prognoz").Cells(M%, (K% + 2)) <> "#" And Worksheets("prognoz").Cells(M%, (K% + 2)) <> "&" Then
    Worksheets("prognoz").Cells(M%, (K% + 2)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next M%

If Worksheets("prognoz").Cells(12, K%) <> "#" And Worksheets("prognoz").Cells(12, K%) <> "&" Then
    Worksheets("prognoz").Cells(12, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("prognoz").Cells(12, K% + 3) <> "#" And Worksheets("prognoz").Cells(12, K% + 3) <> "&" Then
    Worksheets("prognoz").Cells(12, K% + 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("prognoz").Cells(12, K% + 7) <> "#" And Worksheets("prognoz").Cells(12, K% + 7) <> "&" Then
    Worksheets("prognoz").Cells(12, K% + 7).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("prognoz").Cells(10, K%) <> 0 Then Worksheets("prognoz").Cells(10, K%) = 1

For M% = 5 To 7
Worksheets("prognoz").Cells(M%, K%) = Int(Worksheets("prognoz").Cells(M%, K%))
Worksheets("prognoz").Cells(M%, K% + 4) = Int(Worksheets("prognoz").Cells(M%, K% + 4))
If Worksheets("prognoz").Cells(M%, K%) < 1 Or Worksheets("prognoz").Cells(M%, K%) > 12 Then Worksheets("prognoz").Cells(M%, K%) = 0
If Worksheets("prognoz").Cells(M%, K% + 4) < 1 Or Worksheets("prognoz").Cells(M%, K% + 4) > 12 Then Worksheets("prognoz").Cells(M%, K% + 4) = 0
Next M%

If Worksheets("prognoz").Cells(8, K%) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("prognoz").Cells(8, K%)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("prognoz").Cells(8, K% + 2) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("prognoz").Cells(8, K% + 2) = 0
End If
If ERRP = 1 Then
    Worksheets("prognoz").Cells(8, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

ERRP = 0

If Worksheets("prognoz").Cells(8, K% + 4) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("prognoz").Cells(8, K% + 4)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("prognoz").Cells(8, K% + 6) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("prognoz").Cells(8, K% + 6) = 0
End If
If ERRP = 1 Then
    Worksheets("prognoz").Cells(8, K% + 4).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

Worksheets("prognoz").Cells(6, 3) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Dim MPpoA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpo As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPne As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPso As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpo As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRne As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRso As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPORB As Double
Dim TRORB As Double
Dim BPORBpo As Double
Dim TRORBpo As Double
Dim BPORBne As Double
Dim TRORBne As Double
Dim BPORBso As Double
Dim TRORBso As Double

Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDAY As Long '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim SHAG As Integer '|fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
Dim STROK As Integer
Dim MPflag As Integer
Dim MPflagS As Integer
Dim MPflagA As Integer
Dim BPflag As Integer
Dim BPflagS As Integer
Dim BPflagA As Integer
Dim TRflag As Integer
Dim TRflagS As Integer
Dim TRflagT As Integer
Dim UMP As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UBP As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UTR As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP As Integer
Dim SD As Integer

STROK = 15
SHAG = Int(Worksheets("prognoz").Cells(4, 2))
Worksheets("MP").Cells(34, 2) = 0 '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(4, 12) = 0
Worksheets("natal").Cells(4, 16) = 1
Worksheets("natal").Cells(5, 16) = 1
Worksheets("natal").Cells(6, 16) = 1

Call DATAvJD(Int(Worksheets("prognoz").Cells(2, 2)), Int(Worksheets("prognoz").Cells(2, 3)), Int(Worksheets("prognoz").Cells(2, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("prognoz").Cells(3, 2)), Int(Worksheets("prognoz").Cells(3, 3)), Int(Worksheets("prognoz").Cells(3, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDAY = Int((JD2 - JD1) / SHAG) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
JDTR = Int(JD1)

For KT% = 1 To NDAY '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

JDTR = JDTR + SHAG
Call JDvDATA(JDTR)
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("prognoz").Cells(STROK, 2) = Worksheets("natal").Cells(3, 2)
Worksheets("prognoz").Cells(STROK, 3) = Worksheets("natal").Cells(3, 3)
Worksheets("prognoz").Cells(STROK, 4) = Worksheets("natal").Cells(3, 4)

For KF% = 5 To 324 Step 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SD = 0
For M% = 5 To 7
SD = SD + Worksheets("prognoz").Cells(M%, KF%) + Worksheets("prognoz").Cells(M%, KF% + 4)
Next M%

If SD = 0 And Trim(Worksheets("prognoz").Cells(8, KF%)) = "" And Trim(Worksheets("prognoz").Cells(8, KF% + 4)) = "" Then GoTo netf

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(8, 2) = Worksheets("prognoz").Cells(8, KF% + 10)
Worksheets("natal").Cells(8, 3) = Worksheets("prognoz").Cells(9, KF% + 10)
Worksheets("natal").Cells(8, 4) = Worksheets("prognoz").Cells(10, KF% + 10)
Worksheets("natal").Cells(8, 5) = Worksheets("prognoz").Cells(5, KF% + 10)
Worksheets("natal").Cells(8, 6) = Worksheets("prognoz").Cells(6, KF% + 10)
Worksheets("natal").Cells(8, 7) = Worksheets("prognoz").Cells(7, KF% + 10)

Call goroskop
Worksheets("prognoz").Select

BPflag = 0
BPflagS = 0
BPflagT = 0
TRflag = 0
TRflagS = 0
TRflagT = 0
MPflag = 0
MPflagS = 0
MPflagT = 0

MPneA = 0
MPneS = 0
MPneT = 0
MPpoA = 0
MPpoS = 0
MPpoT = 0
MPsoA = 0
MPsoS = 0
MPsoT = 0

BPne = 0
BPneS = 0
BPneT = 0
BPpo = 0
BPpoS = 0
BPpoT = 0
BPso = 0
BPsoS = 0
BPsoT = 0

TRne = 0
TRneS = 0
TRneT = 0
TRpo = 0
TRpoS = 0
TRpoT = 0
TRso = 0
TRsoS = 0
TRsoT = 0

BPORB = 100
TRORB = 100
BPORBpo = 100
TRORBpo = 100
BPORBne = 100
TRORBne = 100
BPORBso = 100
TRORBso = 100

UMP = Worksheets("prognoz").Cells(11, KF%)
UBP = Worksheets("prognoz").Cells(11, KF% + 3)
UTR = Worksheets("prognoz").Cells(11, KF% + 7)

'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If UMP = 0 Then GoTo BP '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("MP").Cells(60, 34) = Worksheets("prognoz").Cells(10, KF%)

For M% = 0 To 2
Worksheets("MP").Cells(55 + M%, 31) = Int(Worksheets("prognoz").Cells(5 + M%, KF%))
Worksheets("MP").Cells(55 + M%, 33) = Int(Worksheets("prognoz").Cells(5 + M%, KF% + 4))
Worksheets("MP").Cells(58, 30) = Trim(Worksheets("prognoz").Cells(5 + 3, KF%))
Worksheets("MP").Cells(58, 33) = Trim(Worksheets("prognoz").Cells(5 + 3, KF% + 4))
Next M%

Call MPpoisk

For K% = 71 To 399 Step 4
If Worksheets("MP").Cells(K%, 32) = 0 Then GoTo netKMP1
    ASP = Int(Worksheets("MP").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPpoS = MPpoS + 1
    If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPpoA = MPpoA + 1
    If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPpoT = MPpoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPneS = MPneS + 1
    If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPneA = MPneA + 1
    If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPneT = MPneT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPsoS = MPsoS + 1
    If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPsoA = MPsoA + 1
    If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPsoT = MPsoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKMP1: Next K%
 
Call MPsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "" Then
MPflag = MPflag + MPpoA + MPneA + MPsoA
MPflagS = MPflagS + MPpoS + MPneS + MPsoS
MPflagT = MPflagT + MPpoT + MPneT + MPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "&" Then
MPflag = MPflag + MPpoA + MPsoA
MPflagS = MPflagS + MPpoS + MPsoS
MPflagT = MPflagT + MPpoT + MPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "#" Then
MPflag = MPflag + MPpoA
MPflagS = MPflagS + MPpoS
MPflagT = MPflagT + MPpoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "&" Then
MPflag = MPflag + MPneA
MPflagS = MPflagS + MPneS
MPflagT = MPflagT + MPneT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "#" Then
MPflag = MPflag + MPneA + MPsoA
MPflagS = MPflagS + MPneS + MPsoS
MPflagT = MPflagT + MPneT + MPsoT
Else
End If

'=============== |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BP: If UBP = 0 Then GoTo TR '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("BP").Cells(60, 34) = Worksheets("prognoz").Cells(10, KF%)

For M% = 0 To 2
Worksheets("BP").Cells(55 + M%, 31) = Int(Worksheets("prognoz").Cells(5 + M%, KF%))
Worksheets("BP").Cells(55 + M%, 33) = Int(Worksheets("prognoz").Cells(5 + M%, KF% + 4))
Worksheets("BP").Cells(58, 30) = Trim(Worksheets("prognoz").Cells(5 + 3, KF%))
Worksheets("BP").Cells(58, 33) = Trim(Worksheets("prognoz").Cells(5 + 3, KF% + 4))
Next M%

Call BPpoisk

For K% = 71 To 399 Step 4
If Worksheets("BP").Cells(K%, 32) = 0 Then GoTo netKBP1
    ASP = Int(Worksheets("BP").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    BPpo = BPpo + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPpoS = BPpoS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPpoT = BPpoT + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And BPORBpo > Worksheets("BP").Cells(K% + 1, 3) Then BPORBpo = Worksheets("BP").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    BPne = BPne + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPneS = BPneS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPneT = BPneT + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And BPORBne > Worksheets("BP").Cells(K% + 1, 3) Then BPORBne = Worksheets("BP").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    BPso = BPso + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPsoS = BPsoS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPsoT = BPsoT + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And BPORBso > Worksheets("BP").Cells(K% + 1, 3) Then BPORBso = Worksheets("BP").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKBP1: Next K%
 
Call BPsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "" Then
BPflag = BPflag + BPpo + BPne + BPso
BPflagS = BPflagS + BPpoS + BPneS + BPsoS
BPflagT = BPflagT + BPpoT + BPneT + BPsoT
If BPflagT > 0 And BPORB > BPORBpo Then BPORB = BPORBpo
If BPflagT > 0 And BPORB > BPORBne Then BPORB = BPORBne
If BPflagT > 0 And BPORB > BPORBso Then BPORB = BPORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "&" Then
BPflag = BPflag + BPpo + BPso
BPflagS = BPflagS + BPpoS + BPsoS
BPflagT = BPflagT + BPpoT + BPsoT
If BPflagT > 0 And BPORB > BPORBpo Then BPORB = BPORBpo
If BPflagT > 0 And BPORB > BPORBso Then BPORB = BPORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "#" Then
BPflag = BPflag + BPpo
BPflagS = BPflagS + BPpoS
BPflagT = BPflagT + BPpoT
If BPflagT > 0 And BPORB > BPORBpo Then BPORB = BPORBpo
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "&" Then
BPflag = BPflag + BPne
BPflagS = BPflagS + BPneS
BPflagT = BPflagT + BPneT
If BPflagT > 0 And BPORB > BPORBne Then BPORB = BPORBne
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "#" Then
BPflag = BPflag + BPne + BPso
BPflagS = BPflagS + BPneS + BPsoS
BPflagT = BPflagT + BPneT + BPsoT
If BPflagT > 0 And BPORB > BPORBne Then BPORB = BPORBne
If BPflagT > 0 And BPORB > BPORBso Then BPORB = BPORBso
Else
End If

'=============== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
TR: If UTR = 0 Then GoTo REZ '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("TR").Cells(60, 34) = Worksheets("prognoz").Cells(10, KF%)

For M% = 0 To 2
Worksheets("TR").Cells(55 + M%, 31) = Int(Worksheets("prognoz").Cells(5 + M%, KF%))
Worksheets("TR").Cells(55 + M%, 33) = Int(Worksheets("prognoz").Cells(5 + M%, KF% + 4))
Worksheets("TR").Cells(58, 30) = Trim(Worksheets("prognoz").Cells(5 + 3, KF%))
Worksheets("TR").Cells(58, 33) = Trim(Worksheets("prognoz").Cells(5 + 3, KF% + 4))
Next M%

Call TRpoisk

For K% = 71 To 399 Step 4
If Worksheets("TR").Cells(K%, 32) = 0 Then GoTo netKTR1
    ASP = Int(Worksheets("TR").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    TRpo = TRpo + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRpoS = TRpoS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRpoT = TRpoT + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And TRORBpo > Worksheets("TR").Cells(K% + 1, 3) Then TRORBpo = Worksheets("TR").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    TRne = TRne + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRneS = TRneS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRneT = TRneT + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And TRORBne > Worksheets("TR").Cells(K% + 1, 3) Then TRORBne = Worksheets("TR").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    TRso = TRso + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRsoS = TRsoS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRsoT = TRsoT + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And TRORBso > Worksheets("TR").Cells(K% + 1, 3) Then TRORBso = Worksheets("TR").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKTR1: Next K%
 
Call TRsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "" Then
TRflag = TRflag + TRpo + TRne + TRso
TRflagS = TRflagS + TRpoS + TRneS + TRsoS
TRflagT = TRflagT + TRpoT + TRneT + TRsoT
If TRflagT > 0 And TRORB > TRORBpo Then TRORB = TRORBpo
If TRflagT > 0 And TRORB > TRORBne Then TRORB = TRORBne
If TRflagT > 0 And TRORB > TRORBso Then TRORB = TRORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "&" Then
TRflag = TRflag + TRpo + TRso
TRflagS = TRflagS + TRpoS + TRsoS
TRflagT = TRflagT + TRpoT + TRsoT
If TRflagT > 0 And TRORB > TRORBpo Then TRORB = TRORBpo
If TRflagT > 0 And TRORB > TRORBso Then TRORB = TRORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "#" Then
TRflag = TRflag + TRpo
TRflagS = TRflagS + TRpoS
TRflagT = TRflagT + TRpoT
If TRflagT > 0 And TRORB > TRORBpo Then TRORB = TRORBpo
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "&" Then
TRflag = TRflag + TRne
TRflagS = TRflagS + TRneS
TRflagT = TRflagT + TRneT
If TRflagT > 0 And TRORB > TRORBne Then TRORB = TRORBne
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "#" Then
TRflag = TRflag + TRne + TRso
TRflagS = TRflagS + TRneS + TRsoS
TRflagT = TRflagT + TRneT + TRsoT
If TRflagT > 0 And TRORB > TRORBne Then TRORB = TRORBne
If TRflagT > 0 And TRORB > TRORBso Then TRORB = TRORBso
Else
End If

REZ: '======================================================================

If MPflag >= UMP And UMP > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("prognoz").Cells(STROK, KF%) = MPflag
If MPflagS > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 1)) = MPflagS
If MPflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 2)) = MPflagT
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| MP

    If BPflag >= UBP And UBP > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| BP
    Worksheets("prognoz").Cells(STROK, (KF% + 3)) = BPflag
    If BPflagS > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 4)) = BPflagS
    If BPflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 5)) = BPflagT
    If BPflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 6)) = BPORB
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

        If TRflag >= UTR And UTR > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("prognoz").Cells(STROK, (KF% + 7)) = TRflag
        If TRflagS > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 8)) = TRflagS
        If TRflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 9)) = TRflagT
        If TRflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 10)) = TRORB
        Else
        End If
        
netf:
Next KF% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STROK = STROK + 1

        With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .ScreenUpdating = True
        End With
Worksheets("prognoz").Cells(6, 3) = (KT% / NDAY) * 100
Worksheets("prognoz").Select

Next KT% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("MP").Cells(34, 2) = 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("prognoz").Select
ActiveWorkbook.save

End Sub
Sub prognoz()

Worksheets("prognoz").Select
Rows("15:6000").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 15
Range("A13").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prognoz").Cells(2, 2) < 0 Or Worksheets("prognoz").Cells(2, 2) > 31 Then
    Worksheets("prognoz").Cells(2, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(2, 3) < 0 Or Worksheets("prognoz").Cells(2, 3) > 12 Then
    Worksheets("prognoz").Cells(2, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(2, 4) < 0 Then
    Worksheets("prognoz").Cells(2, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(3, 2) < 0 Or Worksheets("prognoz").Cells(3, 2) > 31 Then
    Worksheets("prognoz").Cells(3, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(3, 3) < 0 Or Worksheets("prognoz").Cells(3, 3) > 12 Then
    Worksheets("prognoz").Cells(3, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prognoz").Cells(3, 4) < 0 Then
    Worksheets("prognoz").Cells(3, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

Dim ERRP As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 5 To 324 Step 11
For M% = 5 To 7
If Worksheets("prognoz").Cells(M%, (K% + 2)) <> "" And Worksheets("prognoz").Cells(M%, (K% + 2)) <> "#" And Worksheets("prognoz").Cells(M%, (K% + 2)) <> "&" Then
    Worksheets("prognoz").Cells(M%, (K% + 2)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next M%

If Worksheets("prognoz").Cells(12, K%) <> "#" And Worksheets("prognoz").Cells(12, K%) <> "&" Then
    Worksheets("prognoz").Cells(12, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("prognoz").Cells(12, K% + 3) <> "#" And Worksheets("prognoz").Cells(12, K% + 3) <> "&" Then
    Worksheets("prognoz").Cells(12, K% + 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("prognoz").Cells(12, K% + 7) <> "#" And Worksheets("prognoz").Cells(12, K% + 7) <> "&" Then
    Worksheets("prognoz").Cells(12, K% + 7).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("prognoz").Cells(10, K%) <> 0 Then Worksheets("prognoz").Cells(10, K%) = 1

For M% = 5 To 7
Worksheets("prognoz").Cells(M%, K%) = Int(Worksheets("prognoz").Cells(M%, K%))
Worksheets("prognoz").Cells(M%, K% + 4) = Int(Worksheets("prognoz").Cells(M%, K% + 4))
If Worksheets("prognoz").Cells(M%, K%) < 1 Or Worksheets("prognoz").Cells(M%, K%) > 12 Then Worksheets("prognoz").Cells(M%, K%) = 0
If Worksheets("prognoz").Cells(M%, K% + 4) < 1 Or Worksheets("prognoz").Cells(M%, K% + 4) > 12 Then Worksheets("prognoz").Cells(M%, K% + 4) = 0
Next M%

If Worksheets("prognoz").Cells(8, K%) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("prognoz").Cells(8, K%)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("prognoz").Cells(8, K% + 2) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("prognoz").Cells(8, K% + 2) = 0
End If
If ERRP = 1 Then
    Worksheets("prognoz").Cells(8, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

ERRP = 0

If Worksheets("prognoz").Cells(8, K% + 4) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("prognoz").Cells(8, K% + 4)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("prognoz").Cells(8, K% + 6) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("prognoz").Cells(8, K% + 6) = 0
End If
If ERRP = 1 Then
    Worksheets("prognoz").Cells(8, K% + 4).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

Worksheets("prognoz").Cells(6, 3) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|
For KF% = 15 To 334 Step 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("prognoz").Cells(5, KF%) = Worksheets("natal").Cells(8, 5)
Worksheets("prognoz").Cells(6, KF%) = Worksheets("natal").Cells(8, 6)
Worksheets("prognoz").Cells(7, KF%) = Worksheets("natal").Cells(8, 7)
Worksheets("prognoz").Cells(8, KF%) = Worksheets("natal").Cells(8, 2)
Worksheets("prognoz").Cells(9, KF%) = Worksheets("natal").Cells(8, 3)
Worksheets("prognoz").Cells(10, KF%) = Worksheets("natal").Cells(8, 4)
Next KF%

Dim MPpoA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpo As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPne As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPso As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpo As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRne As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRso As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPORB As Double
Dim TRORB As Double
Dim BPORBpo As Double
Dim TRORBpo As Double
Dim BPORBne As Double
Dim TRORBne As Double
Dim BPORBso As Double
Dim TRORBso As Double

Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDAY As Long '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim SHAG As Integer '|fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
Dim STROK As Integer
Dim MPflag As Integer
Dim MPflagS As Integer
Dim MPflagT As Integer
Dim BPflag As Integer
Dim BPflagS As Integer
Dim BPflagT As Integer
Dim TRflag As Integer
Dim TRflagS As Integer
Dim TRflagT As Integer
Dim UMP As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UBP As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UTR As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP As Integer
Dim SD As Integer

STROK = 15
SHAG = Int(Worksheets("prognoz").Cells(4, 2))
Worksheets("MP").Cells(34, 2) = 0 '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(4, 12) = 0
Worksheets("natal").Cells(4, 16) = 1
Worksheets("natal").Cells(5, 16) = 1
Worksheets("natal").Cells(6, 16) = 1

Call DATAvJD(Int(Worksheets("prognoz").Cells(2, 2)), Int(Worksheets("prognoz").Cells(2, 3)), Int(Worksheets("prognoz").Cells(2, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("prognoz").Cells(3, 2)), Int(Worksheets("prognoz").Cells(3, 3)), Int(Worksheets("prognoz").Cells(3, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDAY = Int((JD2 - JD1) / SHAG) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
JDTR = Int(JD1)

For KT% = 1 To NDAY '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

JDTR = JDTR + SHAG
Call JDvDATA(JDTR)
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("prognoz").Cells(STROK, 2) = Worksheets("natal").Cells(3, 2)
Worksheets("prognoz").Cells(STROK, 3) = Worksheets("natal").Cells(3, 3)
Worksheets("prognoz").Cells(STROK, 4) = Worksheets("natal").Cells(3, 4)

Call goroskop
Worksheets("prognoz").Select

For KF% = 5 To 324 Step 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SD = 0
For M% = 5 To 7
SD = SD + Worksheets("prognoz").Cells(M%, KF%) + Worksheets("prognoz").Cells(M%, KF% + 4)
Next M%

If SD = 0 And Trim(Worksheets("prognoz").Cells(8, KF%)) = "" And Trim(Worksheets("prognoz").Cells(8, KF% + 4)) = "" Then GoTo netf

BPflag = 0
BPflagS = 0
BPflagT = 0
TRflag = 0
TRflagS = 0
TRflagT = 0
MPflag = 0
MPflagS = 0
MPflagT = 0

MPneA = 0
MPneS = 0
MPneT = 0
MPpoA = 0
MPpoS = 0
MPpoT = 0
MPsoA = 0
MPsoS = 0
MPsoT = 0

BPne = 0
BPneS = 0
BPneT = 0
BPpo = 0
BPpoS = 0
BPpoT = 0
BPso = 0
BPsoS = 0
BPsoT = 0

TRne = 0
TRneS = 0
TRneT = 0
TRpo = 0
TRpoS = 0
TRpoT = 0
TRso = 0
TRsoS = 0
TRsoT = 0

BPORB = 100
TRORB = 100
BPORBpo = 100
TRORBpo = 100
BPORBne = 100
TRORBne = 100
BPORBso = 100
TRORBso = 100

UMP = Worksheets("prognoz").Cells(11, KF%)
UBP = Worksheets("prognoz").Cells(11, KF% + 3)
UTR = Worksheets("prognoz").Cells(11, KF% + 7)

'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If UMP = 0 Then GoTo BP '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("MP").Cells(60, 34) = Worksheets("prognoz").Cells(10, KF%)

For M% = 0 To 2
Worksheets("MP").Cells(55 + M%, 31) = Int(Worksheets("prognoz").Cells(5 + M%, KF%))
Worksheets("MP").Cells(55 + M%, 33) = Int(Worksheets("prognoz").Cells(5 + M%, KF% + 4))
Worksheets("MP").Cells(58, 30) = Trim(Worksheets("prognoz").Cells(5 + 3, KF%))
Worksheets("MP").Cells(58, 33) = Trim(Worksheets("prognoz").Cells(5 + 3, KF% + 4))
Next M%

Call MPpoisk

For K% = 71 To 399 Step 4
If Worksheets("MP").Cells(K%, 32) = 0 Then GoTo netKMP1
    ASP = Int(Worksheets("MP").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPpoS = MPpoS + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPpoA = MPpoA + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPpoT = MPpoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPneS = MPneS + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPneA = MPneA + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPneT = MPneT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
        If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPsoS = MPsoS + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPsoA = MPsoA + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPsoT = MPsoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKMP1: Next K%
 
Call MPsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "" Then
MPflag = MPpoA + MPneA + MPsoA
MPflagS = MPpoS + MPneS + MPsoS
MPflagT = MPpoT + MPneT + MPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "&" Then
MPflag = MPpoA + MPsoA
MPflagS = MPpoS + MPsoS
MPflagT = MPpoT + MPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "#" Then
MPflag = MPpoA
MPflagS = MPpoS
MPflagT = MPpoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "&" Then
MPflag = MPneA
MPflagS = MPneS
MPflagT = MPneT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(5, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF%)) = "#" Then
MPflag = MPneA + MPsoA
MPflagS = MPneS + MPsoS
MPflagT = MPneT + MPsoT
Else
End If

'=============== |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BP: If UBP = 0 Then GoTo TR '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("BP").Cells(60, 34) = Worksheets("prognoz").Cells(10, KF%)

For M% = 0 To 2
Worksheets("BP").Cells(55 + M%, 31) = Int(Worksheets("prognoz").Cells(5 + M%, KF%))
Worksheets("BP").Cells(55 + M%, 33) = Int(Worksheets("prognoz").Cells(5 + M%, KF% + 4))
Worksheets("BP").Cells(58, 30) = Trim(Worksheets("prognoz").Cells(5 + 3, KF%))
Worksheets("BP").Cells(58, 33) = Trim(Worksheets("prognoz").Cells(5 + 3, KF% + 4))
Next M%

Call BPpoisk

For K% = 71 To 399 Step 4
If Worksheets("BP").Cells(K%, 32) = 0 Then GoTo netKBP1
    ASP = Int(Worksheets("BP").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    BPpo = BPpo + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPpoS = BPpoS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPpoT = BPpoT + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And BPORBpo > Worksheets("BP").Cells(K% + 1, 3) Then BPORBpo = Worksheets("BP").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    BPne = BPne + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPneS = BPneS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPneT = BPneT + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And BPORBne > Worksheets("BP").Cells(K% + 1, 3) Then BPORBne = Worksheets("BP").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    BPso = BPso + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPsoS = BPsoS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPsoT = BPsoT + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And BPORBso > Worksheets("BP").Cells(K% + 1, 3) Then BPORBso = Worksheets("BP").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKBP1: Next K%
 
Call BPsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "" Then
BPflag = BPpo + BPne + BPso
BPflagS = BPpoS + BPneS + BPsoS
BPflagT = BPpoT + BPneT + BPsoT
If BPflagT > 0 And BPORB > BPORBpo Then BPORB = BPORBpo
If BPflagT > 0 And BPORB > BPORBne Then BPORB = BPORBne
If BPflagT > 0 And BPORB > BPORBso Then BPORB = BPORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "&" Then
BPflag = BPpo + BPso
BPflagS = BPpoS + BPsoS
BPflagT = BPpoT + BPsoT
If BPflagT > 0 And BPORB > BPORBpo Then BPORB = BPORBpo
If BPflagT > 0 And BPORB > BPORBso Then BPORB = BPORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "#" Then
BPflag = BPpo
BPflagS = BPpoS
BPflagT = BPflagT + BPpoT
If BPflagT > 0 And BPORB > BPORBpo Then BPORB = BPORBpo
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "&" Then
BPflag = BPne
BPflagS = BPneS
BPflagT = BPneT
If BPflagT > 0 And BPORB > BPORBne Then BPORB = BPORBne
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(6, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 3)) = "#" Then
BPflag = BPne + BPso
BPflagS = BPneS + BPsoS
BPflagT = BPneT + BPsoT
If BPflagT > 0 And BPORB > BPORBne Then BPORB = BPORBne
If BPflagT > 0 And BPORB > BPORBso Then BPORB = BPORBso
Else
End If

'=============== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
TR: If UTR = 0 Then GoTo REZ '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("TR").Cells(60, 34) = Worksheets("prognoz").Cells(10, KF%)

For M% = 0 To 2
Worksheets("TR").Cells(55 + M%, 31) = Int(Worksheets("prognoz").Cells(5 + M%, KF%))
Worksheets("TR").Cells(55 + M%, 33) = Int(Worksheets("prognoz").Cells(5 + M%, KF% + 4))
Worksheets("TR").Cells(58, 30) = Trim(Worksheets("prognoz").Cells(5 + 3, KF%))
Worksheets("TR").Cells(58, 33) = Trim(Worksheets("prognoz").Cells(5 + 3, KF% + 4))
Next M%

Call TRpoisk

For K% = 71 To 399 Step 4
If Worksheets("TR").Cells(K%, 32) = 0 Then GoTo netKTR1
    ASP = Int(Worksheets("TR").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    TRpo = TRpo + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRpoS = TRpoS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRpoT = TRpoT + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And TRORBpo > Worksheets("TR").Cells(K% + 1, 3) Then TRORBpo = Worksheets("TR").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    TRne = TRne + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRneS = TRneS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRneT = TRneT + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And TRORBne > Worksheets("TR").Cells(K% + 1, 3) Then TRORBne = Worksheets("TR").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    TRso = TRso + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRsoS = TRsoS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRsoT = TRsoT + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" And TRORBso > Worksheets("TR").Cells(K% + 1, 3) Then TRORBso = Worksheets("TR").Cells(K% + 1, 3)
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKTR1: Next K%
 
Call TRsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "" Then
TRflag = TRpo + TRne + TRso
TRflagS = TRpoS + TRneS + TRsoS
TRflagT = TRpoT + TRneT + TRsoT
If TRflagT > 0 And TRORB > TRORBpo Then TRORB = TRORBpo
If TRflagT > 0 And TRORB > TRORBne Then TRORB = TRORBne
If TRflagT > 0 And TRORB > TRORBso Then TRORB = TRORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "&" Then
TRflag = TRpo + TRso
TRflagS = TRpoS + TRsoS
TRflagT = TRpoT + TRsoT
If TRflagT > 0 And TRORB > TRORBpo Then TRORB = TRORBpo
If TRflagT > 0 And TRORB > TRORBso Then TRORB = TRORBso
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "&" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "#" Then
TRflag = TRpo
TRflagS = TRpoS
TRflagT = TRpoT
If TRflagT > 0 And TRORB > TRORBpo Then TRORB = TRORBpo
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "&" Then
TRflag = TRne
TRflagS = TRneS
TRflagT = TRneT
If TRflagT > 0 And TRORB > TRORBne Then TRORB = TRORBne
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("prognoz").Cells(7, KF% + 2)) = "#" And Trim(Worksheets("prognoz").Cells(12, KF% + 7)) = "#" Then
TRflag = TRne + TRso
TRflagS = TRneS + TRsoS
TRflagT = TRneT + TRsoT
If TRflagT > 0 And TRORB > TRORBne Then TRORB = TRORBne
If TRflagT > 0 And TRORB > TRORBso Then TRORB = TRORBso
Else
End If

REZ: '======================================================================

If MPflag >= UMP And UMP > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("prognoz").Cells(STROK, KF%) = MPflag
If MPflagS > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 1)) = MPflagS
If MPflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 2)) = MPflagT
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| MP

    If BPflag >= UBP And UBP > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| BP
    Worksheets("prognoz").Cells(STROK, (KF% + 3)) = BPflag
    If BPflagS > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 4)) = BPflagS
    If BPflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 5)) = BPflagT
    If BPflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 6)) = BPORB
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

        If TRflag >= UTR And UTR > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("prognoz").Cells(STROK, (KF% + 7)) = TRflag
        If TRflagS > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 8)) = TRflagS
        If TRflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 9)) = TRflagT
        If TRflagT > 0 Then Worksheets("prognoz").Cells(STROK, (KF% + 10)) = TRORB
        Else
        End If
        
netf:
Next KF% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STROK = STROK + 1

        With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .ScreenUpdating = True
        End With
Worksheets("prognoz").Cells(6, 3) = (KT% / NDAY) * 100
Worksheets("prognoz").Select

Next KT% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

With Application
.ScreenUpdating = True
.Calculation = xlCalculationAutomatic
End With
Worksheets("MP").Cells(34, 2) = 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("prognoz").Select
ActiveWorkbook.save

End Sub
Sub planet_prognoz()

Dim N1 As Integer
Dim N2 As Integer
Dim KF As Integer
Dim MPflag As Integer
Dim MPflagS As Integer
Dim MPflagA As Integer
Dim BPflag As Integer
Dim BPflagS As Integer
Dim BPflagA As Integer
Dim TRflag As Integer
Dim TRflagS As Integer
Dim TRflagT As Integer
Dim BPORBIS As Double
Dim TRORBIS As Double
Dim ASPEKT As Integer

KF = Worksheets("prognoz").Cells(4, 2)

N1 = 19
N2 = 28
If Worksheets("prognoz").Cells(10, KF) = 0 Then
N1 = 12
N2 = 18
Else
End If

MPflag = Worksheets("prognoz").Cells(9, KF)
MPflagS = Worksheets("prognoz").Cells(9, KF + 1)
MPflagA = Worksheets("prognoz").Cells(9, KF + 2)
BPflag = Worksheets("prognoz").Cells(9, KF + 3)
BPflagS = Worksheets("prognoz").Cells(9, KF + 4)
BPflagA = Worksheets("prognoz").Cells(9, KF + 5)
BPORBIS = Worksheets("prognoz").Cells(9, KF + 6)
TRflag = Worksheets("prognoz").Cells(9, KF + 7)
TRflagS = Worksheets("prognoz").Cells(9, KF + 8)
TRflagT = Worksheets("prognoz").Cells(9, KF + 9)
TRORBIS = Worksheets("prognoz").Cells(9, KF + 10)

    For NS% = 71 To 399 Step 4
    
'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASPEKT = Int(Worksheets("MP").Cells(NS% + 1, 2))
    
        If (Trim(Worksheets("MP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) And Trim(Worksheets("MP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4))) Or (Trim(Worksheets("MP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) And Trim(Worksheets("MP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF))) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(5, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
        Else
        End If  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               
        If Trim(Worksheets("MP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) Then '|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF + 4) = 0 Then GoTo netL01
        For M% = N1 To N2
        If Worksheets("MP").Cells(NS% + 2, M%) = 0 Then GoTo netm01
            
        If Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("MP").Cells(NS% + 2, M%) Or Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("MP").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(5, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm01:  Next M%
netL01:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("MP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) Then '|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF + 4) = 0 Then GoTo netL02
        For M% = N1 To N2
        If Worksheets("MP").Cells(NS%, M%) = 0 Then GoTo netm02
            
        If Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("MP").Cells(NS%, M%) Or Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("MP").Cells(NS% + 2, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(5, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm02:  Next M%
netL02:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("MP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Then '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF) = 0 Then GoTo netL03
        For M% = N1 To N2
        If Worksheets("MP").Cells(NS% + 2, M%) = 0 Then GoTo netm03
            
        If Worksheets("prognoz").Cells(L%, KF) = Worksheets("MP").Cells(NS% + 2, M%) Or Worksheets("prognoz").Cells(L%, KF) = Worksheets("MP").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(5, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm03:  Next M%
netL03:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("MP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Or Trim(Worksheets("MP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Then '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF) = 0 Then GoTo netL04
        For M% = N1 To N2
        If Worksheets("MP").Cells(NS%, M%) = 0 Then GoTo netm04
            
        If Worksheets("prognoz").Cells(L%, KF) = Worksheets("MP").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(5, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    If Worksheets("prognoz").Cells(5, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                MPflag = MPflag + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPflagS = MPflagS + 1
                If Trim(Worksheets("MP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPflagA = MPflagA + 1
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm04:  Next M%
netL04:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASPEKT = Int(Worksheets("BP").Cells(NS% + 1, 2))
    
        If (Trim(Worksheets("BP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) And Trim(Worksheets("BP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4))) Or (Trim(Worksheets("BP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) And Trim(Worksheets("BP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF))) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(6, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
        Else
        End If  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               
        If Trim(Worksheets("BP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) Then '|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF + 4) = 0 Then GoTo netL05
        For M% = N1 To N2
        If Worksheets("BP").Cells(NS% + 2, M%) = 0 Then GoTo netm05
            
        If Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("BP").Cells(NS% + 2, M%) Or Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("BP").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(6, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm05:  Next M%
netL05:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("BP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) Then '|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF + 4) = 0 Then GoTo netL06
        For M% = N1 To N2
        If Worksheets("BP").Cells(NS%, M%) = 0 Then GoTo netm06
            
        If Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("BP").Cells(NS%, M%) Or Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("BP").Cells(NS% + 2, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(6, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm06:  Next M%
netL06:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("BP").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Then '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF) = 0 Then GoTo netL07
        For M% = N1 To N2
        If Worksheets("BP").Cells(NS% + 2, M%) = 0 Then GoTo netm07
            
        If Worksheets("prognoz").Cells(L%, KF) = Worksheets("BP").Cells(NS% + 2, M%) Or Worksheets("prognoz").Cells(L%, KF) = Worksheets("BP").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(6, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm07:  Next M%
netL07:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("BP").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Then '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF) = 0 Then GoTo netL08
        For M% = N1 To N2
        If Worksheets("BP").Cells(NS%, M%) = 0 Then GoTo netm08
            
        If Worksheets("prognoz").Cells(L%, KF) = Worksheets("BP").Cells(NS%, M%) Or Worksheets("prognoz").Cells(L%, KF) = Worksheets("BP").Cells(NS% + 2, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(6, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(6, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 3) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                BPflag = BPflag + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPflagS = BPflagS + 1
                If Trim(Worksheets("BP").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                BPflagA = BPflagA + 1
                If BPORBIS > Worksheets("BP").Cells(NS% + 1, 3) Then BPORBIS = Worksheets("BP").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm08:  Next M%
netL08:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASPEKT = Int(Worksheets("TR").Cells(NS% + 1, 2))
    
        If (Trim(Worksheets("TR").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) And Trim(Worksheets("TR").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4))) Or (Trim(Worksheets("TR").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) And Trim(Worksheets("TR").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF))) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(7, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 30 Or ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 90 Or ASPEKT = 150 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
        Else
        End If  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               
        If Trim(Worksheets("TR").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) Then '|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF + 4) = 0 Then GoTo netL09
        For M% = N1 To N2
        If Worksheets("TR").Cells(NS% + 2, M%) = 0 Then GoTo netm09
            
        If Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("TR").Cells(NS% + 2, M%) Or Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("TR").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(7, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 90 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 90 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm09:  Next M%
netL09:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("TR").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF)) Then '|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF + 4) = 0 Then GoTo netL10
        For M% = N1 To N2
        If Worksheets("TR").Cells(NS%, M%) = 0 Then GoTo netm10
            
        If Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("TR").Cells(NS%, M%) Or Worksheets("prognoz").Cells(L%, KF + 4) = Worksheets("TR").Cells(NS% + 2, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(7, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 90 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 90 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm10:  Next M%
netL10:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("TR").Cells(NS%, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Then '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF) = 0 Then GoTo netL11
        For M% = N1 To N2
        If Worksheets("TR").Cells(NS% + 2, M%) = 0 Then GoTo netm11
            
        If Worksheets("prognoz").Cells(L%, KF) = Worksheets("TR").Cells(NS% + 2, M%) Or Worksheets("prognoz").Cells(L%, KF) = Worksheets("TR").Cells(NS%, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(7, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 90 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 90 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm11:  Next M%
netL11:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
       If Trim(Worksheets("TR").Cells(NS% + 2, 1)) = Trim(Worksheets("prognoz").Cells(8, KF + 4)) Then '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
        For L% = 5 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Worksheets("prognoz").Cells(L%, KF) = 0 Then GoTo netL12
        For M% = N1 To N2
        If Worksheets("TR").Cells(NS%, M%) = 0 Then GoTo netm12
            
        If Worksheets("prognoz").Cells(L%, KF) = Worksheets("TR").Cells(NS%, M%) Or Worksheets("prognoz").Cells(L%, KF) = Worksheets("TR").Cells(NS% + 2, M%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
                    If Worksheets("prognoz").Cells(7, KF + 2) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 60 Or ASPEKT = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "&" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 60 Or ASPEKT = 120 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "#" And (ASPEKT = 90 Or ASPEKT = 180 Or ASPEKT = 0) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    If Worksheets("prognoz").Cells(7, KF + 2) = "#" And Worksheets("prognoz").Cells(12, KF + 7) = "&" And (ASPEKT = 90 Or ASPEKT = 180) Then '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                TRflag = TRflag + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRflagS = TRflagS + 1
                If Trim(Worksheets("TR").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                TRflagT = TRflagT + 1
                If TRORBIS > Worksheets("TR").Cells(NS% + 1, 3) Then TRORBIS = Worksheets("TR").Cells(NS% + 1, 3)
                Else
                End If
                    Else
                    End If
                    
                Else
                End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            
netm12:  Next M%
netL12:  Next L%
                    
       Else
       End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         
Next NS%

Worksheets("prognoz").Cells(9, KF) = MPflag
Worksheets("prognoz").Cells(9, KF + 1) = MPflagS
Worksheets("prognoz").Cells(9, KF + 2) = MPflagA
Worksheets("prognoz").Cells(9, KF + 3) = BPflag
Worksheets("prognoz").Cells(9, KF + 4) = BPflagS
Worksheets("prognoz").Cells(9, KF + 5) = BPflagA
Worksheets("prognoz").Cells(9, KF + 6) = BPORBIS
Worksheets("prognoz").Cells(9, KF + 7) = TRflag
Worksheets("prognoz").Cells(9, KF + 8) = TRflagS
Worksheets("prognoz").Cells(9, KF + 9) = TRflagT
Worksheets("prognoz").Cells(9, KF + 10) = TRORBIS

End Sub
Sub provtrk()

Dim ERRP As Integer
Dim D00 As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TK").Cells(9, 8) = Abs(Worksheets("TK").Cells(9, 8))

If Trim(Worksheets("TK").Cells(6, 8)) = "" Then
    Worksheets("TK").Cells(6, 8).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Trim(Worksheets("TK").Cells(6, 8)) = "1" Then Worksheets("TK").Cells(6, 8) = "Asc"
If Trim(Worksheets("TK").Cells(6, 8)) = "2" Then Worksheets("TK").Cells(6, 8) = "II"
If Trim(Worksheets("TK").Cells(6, 8)) = "3" Then Worksheets("TK").Cells(6, 8) = "III"
If Trim(Worksheets("TK").Cells(6, 8)) = "4" Then Worksheets("TK").Cells(6, 8) = "IC"
If Trim(Worksheets("TK").Cells(6, 8)) = "5" Then Worksheets("TK").Cells(6, 8) = "V"
If Trim(Worksheets("TK").Cells(6, 8)) = "6" Then Worksheets("TK").Cells(6, 8) = "VI"
If Trim(Worksheets("TK").Cells(6, 8)) = "7" Then Worksheets("TK").Cells(6, 8) = "Dsc"
If Trim(Worksheets("TK").Cells(6, 8)) = "8" Then Worksheets("TK").Cells(6, 8) = "VIII"
If Trim(Worksheets("TK").Cells(6, 8)) = "9" Then Worksheets("TK").Cells(6, 8) = "IX"
If Trim(Worksheets("TK").Cells(6, 8)) = "10" Then Worksheets("TK").Cells(6, 8) = "MC"
If Trim(Worksheets("TK").Cells(6, 8)) = "11" Then Worksheets("TK").Cells(6, 8) = "XI"
If Trim(Worksheets("TK").Cells(6, 8)) = "12" Then Worksheets("TK").Cells(6, 8) = "XII"


If Trim(Worksheets("TK").Cells(6, 8)) = "|fffd||fffd|" Then Worksheets("TK").Cells(6, 8) = "MC"


If Worksheets("TK").Cells(9, 8) > 15 Then Worksheets("TK").Cells(9, 8) = 15

If Abs(Worksheets("TK").Cells(6, 2)) > 12 Then
    Worksheets("TK").Cells(6, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| GMT!")
    End
Else
End If
If Worksheets("TK").Cells(2, 2) < 0 Or Worksheets("TK").Cells(2, 2) > 31 Then
    Worksheets("TK").Cells(2, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("TK").Cells(2, 3) < 0 Or Worksheets("TK").Cells(2, 3) > 12 Then
    Worksheets("TK").Cells(2, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("TK").Cells(2, 4) < 1900 Or Worksheets("TK").Cells(2, 4) > 2070 Then
    Worksheets("TK").Cells(2, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

K% = 8

If Trim(Worksheets("TK").Cells(6, K% + 1)) = "&" Or Trim(Worksheets("TK").Cells(6, K% + 1)) = "#" Or Trim(Worksheets("TK").Cells(6, K% + 1)) = "" Then
Else
    Worksheets("TK").Cells(6, K% + 1).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
End If

If Trim(Worksheets("TK").Cells(11, K%)) = "&" Or Trim(Worksheets("TK").Cells(11, K%)) = "#" Then
Else
    Worksheets("TK").Cells(11, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
End If

If Worksheets("TK").Cells(6, K% + 2) < 0 Or Worksheets("TK").Cells(6, K% + 2) > 12 Then
    Worksheets("TK").Cells(6, K% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("TK").Cells(7, K% + 2) < 0 Or Worksheets("TK").Cells(7, K% + 2) > 12 Then
    Worksheets("TK").Cells(7, K% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("TK").Cells(8, K% + 2) < 0 Or Worksheets("TK").Cells(8, K% + 2) > 12 Then
    Worksheets("TK").Cells(8, K% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("TK").Cells(10, K%) <> 1 And Worksheets("TK").Cells(10, K%) <> 0 Then Worksheets("TK").Cells(10, K%) = 1

If Trim(Worksheets("TK").Cells(9, K% + 2)) = "" Then GoTo netp

ERRP = 1
For NP% = 11 To 21
If Trim(Worksheets("TK").Cells(9, K% + 2)) = Trim(Worksheets("natal").Cells(NP%, 1)) Then
ERRP = 0
Else
End If
Next NP%
If ERRP > 0 Then
    Worksheets("TK").Cells(9, K% + 2).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

netp: If Trim(Worksheets("TK").Cells(6, K%)) = "" Then GoTo netK

ERRP = 1
For NP% = 22 To 33
If Trim(Worksheets("TK").Cells(6, K%)) = Trim(Worksheets("natal").Cells(NP%, 1)) Then
ERRP = 0
Else
End If
Next NP%
If ERRP > 0 Then
    Worksheets("TK").Cells(6, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

netK:

End Sub
Sub trk000()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TK").Select
Rows("15:1000").Select
Selection.ClearContents
Range("B8").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 1
Range("A4").Select

Worksheets("TK").Cells(2, 2) = 1
Worksheets("TK").Cells(2, 3) = 1
Worksheets("TK").Cells(2, 4) = 1900

K% = 8
Worksheets("TK").Cells(6, K%) = ""
Worksheets("TK").Cells(10, K%) = 1
Worksheets("TK").Cells(11, K%) = "&"
Worksheets("TK").Cells(6, K% + 1) = ""
Worksheets("TK").Cells(6, K% + 2) = 0
Worksheets("TK").Cells(7, K% + 2) = 0
Worksheets("TK").Cells(8, K% + 2) = 0
Worksheets("TK").Cells(9, K% + 2) = ""

End Sub
Sub deti()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("Deti").Select
Rows("11:1000").Select
Selection.ClearContents
Selection.EntireRow.Hidden = False
Worksheets("Deti").Cells(1, 1).Select

Dim L As Double
Dim LL As Double
Dim NZON As Integer  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim LUN As Double   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim t As Double
Dim STROK As Integer
Dim NJD1 As Long
Dim NJD2 As Long
Dim NJDTR As Long
Dim ND As Long
Dim JD1 As Double
Dim JD2 As Double
Dim JDTR As Double
Dim N1 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim N2 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NS As Integer

If Abs(Worksheets("Deti").Cells(5, 2)) > 12 Then
    Worksheets("Deti").Cells(5, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| GMT!")
    End
Else
End If

If Worksheets("Deti").Cells(2, 2) < 0 Or Worksheets("Deti").Cells(2, 2) > 31 Then
    Worksheets("Deti").Cells(2, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("Deti").Cells(2, 3) < 0 Or Worksheets("Deti").Cells(2, 3) > 12 Then
    Worksheets("Deti").Cells(2, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("Deti").Cells(2, 4) < 1850 Or Worksheets("Deti").Cells(2, 4) > 2100 Then
    Worksheets("Deti").Cells(2, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Call radiks

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Worksheets("Deti").Select

LUN = Worksheets("natal").Cells(12, 2)

For K% = 1 To 4
t = Worksheets("natal").Cells(11, 2) + 90 * (K% - 1)
If t > 360 Then t = t - 360
Worksheets("Deti").Cells((10 + K%), 22) = t
Worksheets("Deti").Cells((10 + K%), 21) = K%
NZON = Int(t / 30) + 1
If NZON = 1 Or NZON = 3 Or NZON = 5 Or NZON = 7 Or NZON = 9 Or NZON = 11 Then
Worksheets("Deti").Cells((10 + K%), 24) = 1
Else
Worksheets("Deti").Cells((10 + K%), 24) = 0
End If
Next K%

NZON = 0

For K% = 1 To 3
L = Abs(Worksheets("Deti").Cells((10 + K%), 22) - Worksheets("Deti").Cells((11 + K%), 22))
If L < 120 Then
    If LUN > Worksheets("Deti").Cells((10 + K%), 22) And LUN < Worksheets("Deti").Cells((11 + K%), 22) Then NZON = K%
Else
    If LUN > Worksheets("Deti").Cells((10 + K%), 22) Or LUN < Worksheets("Deti").Cells((11 + K%), 22) Then NZON = K%
End If
Next K%
L = Abs(Worksheets("Deti").Cells(14, 22) - Worksheets("Deti").Cells(11, 22))
If L < 120 Then
    If LUN > Worksheets("Deti").Cells(14, 22) And LUN < Worksheets("Deti").Cells(11, 22) Then NZON = 4
Else
    If LUN > Worksheets("Deti").Cells(14, 22) Or LUN < Worksheets("Deti").Cells(11, 22) Then NZON = 4
End If

If NZON = 1 Or NZON = 3 Then
Worksheets("Deti").Cells(11, 23) = 1
Worksheets("Deti").Cells(13, 23) = 1
Worksheets("Deti").Cells(12, 23) = 0
Worksheets("Deti").Cells(14, 23) = 0
Else
Worksheets("Deti").Cells(11, 23) = 0
Worksheets("Deti").Cells(13, 23) = 0
Worksheets("Deti").Cells(12, 23) = 1
Worksheets("Deti").Cells(14, 23) = 1
End If

NZON = 0
STROK = 15

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
For NZ% = 0 To 300 Step 60
For K% = 1 To 3
L = Abs(Worksheets("Deti").Cells((10 + K%), 22) - Worksheets("Deti").Cells((11 + K%), 22))
If L < 120 Then
    If NZ% > Worksheets("Deti").Cells((10 + K%), 22) And NZ% < Worksheets("Deti").Cells((11 + K%), 22) Then NZON = K%
Else
    If NZ% > Worksheets("Deti").Cells((10 + K%), 22) Or NZ% < Worksheets("Deti").Cells((11 + K%), 22) Then NZON = K%
End If
Next K%
L = Abs(Worksheets("Deti").Cells(14, 22) - Worksheets("Deti").Cells(11, 22))
If L < 120 Then
    If NZ% > Worksheets("Deti").Cells(14, 22) And NZ% < Worksheets("Deti").Cells(11, 22) Then NZON = 4
Else
    If NZ% > Worksheets("Deti").Cells(14, 22) Or NZ% < Worksheets("Deti").Cells(11, 22) Then NZON = 4
End If
Worksheets("Deti").Cells(STROK, 22) = NZ%
Worksheets("Deti").Cells(STROK, 23) = Int(Worksheets("Deti").Cells(10 + NZON, 23))
Worksheets("Deti").Cells(STROK, 24) = 1
STROK = STROK + 1
Next NZ%

For NZ% = 30 To 330 Step 60
For K% = 1 To 3
L = Abs(Worksheets("Deti").Cells((10 + K%), 22) - Worksheets("Deti").Cells((11 + K%), 22))
If L < 120 Then
    If NZ% > Worksheets("Deti").Cells((10 + K%), 22) And NZ% < Worksheets("Deti").Cells((11 + K%), 22) Then NZON = K%
Else
    If NZ% > Worksheets("Deti").Cells((10 + K%), 22) Or NZ% < Worksheets("Deti").Cells((11 + K%), 22) Then NZON = K%
End If
Next K%
L = Abs(Worksheets("Deti").Cells(14, 22) - Worksheets("Deti").Cells(11, 22))
If L < 120 Then
    If NZ% > Worksheets("Deti").Cells(14, 22) And NZ% < Worksheets("Deti").Cells(11, 22) Then NZON = 4
Else
    If NZ% > Worksheets("Deti").Cells(14, 22) Or NZ% < Worksheets("Deti").Cells(11, 22) Then NZON = 4
End If
Worksheets("Deti").Cells(STROK, 22) = NZ%
Worksheets("Deti").Cells(STROK, 23) = Int(Worksheets("Deti").Cells(10 + NZON, 23))
Worksheets("Deti").Cells(STROK, 24) = 0
STROK = STROK + 1
Next NZ%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To 25
For n% = (K% + 1) To 26
If Worksheets("Deti").Cells(K%, 22) > Worksheets("Deti").Cells(n%, 22) Then
Worksheets("Deti").Cells(30, 22) = Worksheets("Deti").Cells(n%, 22)
Worksheets("Deti").Cells(30, 23) = Worksheets("Deti").Cells(n%, 23)
Worksheets("Deti").Cells(30, 24) = Worksheets("Deti").Cells(n%, 24)
Worksheets("Deti").Cells(n%, 22) = Worksheets("Deti").Cells(K%, 22)
Worksheets("Deti").Cells(n%, 23) = Worksheets("Deti").Cells(K%, 23)
Worksheets("Deti").Cells(n%, 24) = Worksheets("Deti").Cells(K%, 24)
Worksheets("Deti").Cells(K%, 22) = Worksheets("Deti").Cells(30, 22)
Worksheets("Deti").Cells(K%, 23) = Worksheets("Deti").Cells(30, 23)
Worksheets("Deti").Cells(K%, 24) = Worksheets("Deti").Cells(30, 24)
Else
End If
Next n%
Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("Deti").Cells(2, 2)), Int(Worksheets("Deti").Cells(2, 3)), Int(Worksheets("Deti").Cells(2, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NJD1 = Worksheets("natal").Cells(81, 8) - 1
JD1 = JD1 - (Worksheets("Deti").Cells(5, 2) / 24)

JDTR = JD1 + 30
Call JDvDATA(JDTR)
Worksheets("Deti").Cells(3, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("Deti").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("Deti").Cells(3, 4) = Worksheets("natal").Cells(71, 4)

Call DATAvJD(Int(Worksheets("Deti").Cells(3, 2)), Int(Worksheets("Deti").Cells(3, 3)), Int(Worksheets("Deti").Cells(3, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NJD2 = Worksheets("natal").Cells(81, 8)
JD2 = JD2 - (Worksheets("Deti").Cells(5, 2) / 24)

STROK = 11

For ND = NJD1 To NJD2
Worksheets("Deti").Cells(STROK, 25) = Worksheets("natal").Cells(ND, 40)
Worksheets("Deti").Cells(STROK, 26) = Worksheets("natal").Cells(ND, 22)
STROK = STROK + 1
Worksheets("Deti").Cells(STROK, 25) = Worksheets("natal").Cells(ND, 40) + 1 / 2
Worksheets("Deti").Cells(STROK, 26) = Worksheets("natal").Cells(ND, 52)
STROK = STROK + 1
Next ND

NS = STROK - 1
STROK = 11

For K% = 11 To (NS - 1)
For M% = 11 To 26
L = Abs(Worksheets("Deti").Cells(K%, 26) - Worksheets("Deti").Cells((1 + K%), 26))
If L < 120 Then
    If Worksheets("Deti").Cells(M%, 22) > Worksheets("Deti").Cells(K%, 26) And Worksheets("Deti").Cells(M%, 22) < Worksheets("Deti").Cells((1 + K%), 26) Then
    Worksheets("Deti").Cells(STROK, 27) = Worksheets("Deti").Cells(K%, 25)
    Worksheets("Deti").Cells(STROK, 28) = Worksheets("Deti").Cells(K%, 26)
    Worksheets("Deti").Cells(STROK, 29) = Worksheets("Deti").Cells(M%, 22)
    Worksheets("Deti").Cells(STROK, 30) = Worksheets("Deti").Cells(M%, 23)
    Worksheets("Deti").Cells(STROK, 31) = Worksheets("Deti").Cells(M%, 24)
    Worksheets("Deti").Cells(STROK, 32) = Worksheets("Deti").Cells((1 + K%), 26)
    STROK = STROK + 1
    Else
    End If
Else
    If Worksheets("Deti").Cells(M%, 22) > Worksheets("Deti").Cells(K%, 26) Or Worksheets("Deti").Cells(M%, 22) < Worksheets("Deti").Cells((1 + K%), 26) Then
    Worksheets("Deti").Cells(STROK, 27) = Worksheets("Deti").Cells(K%, 25)
    Worksheets("Deti").Cells(STROK, 28) = Worksheets("Deti").Cells(K%, 26)
    Worksheets("Deti").Cells(STROK, 29) = Worksheets("Deti").Cells(M%, 22)
    Worksheets("Deti").Cells(STROK, 30) = Worksheets("Deti").Cells(M%, 23)
    Worksheets("Deti").Cells(STROK, 31) = Worksheets("Deti").Cells(M%, 24)
    Worksheets("Deti").Cells(STROK, 32) = Worksheets("Deti").Cells((1 + K%), 26)
    STROK = STROK + 1
    Else
    End If
End If
Next M%
Next K%

Worksheets("Deti").Cells(3, 22) = STROK
NS = STROK - 1

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To NS - 1
If Worksheets("Deti").Cells(K%, 29) > 0 Then GoTo netNS
If Worksheets("Deti").Cells(K% + 1, 29) > 30 Then
    For M% = 27 To 32
    Worksheets("Deti").Cells(1, M%) = Worksheets("Deti").Cells(K%, M%)
    Worksheets("Deti").Cells(K%, M%) = Worksheets("Deti").Cells(K% + 1, M%)
    Worksheets("Deti").Cells(K% + 1, M%) = Worksheets("Deti").Cells(1, M%)
    Next M%
Else
End If
netNS: Next K%

STROK = 11

For K% = 11 To NS
JDTR = Worksheets("Deti").Cells(K%, 27) + (ASPECT(Worksheets("Deti").Cells(K%, 29), Worksheets("Deti").Cells(K%, 28)) / (2 * ASPECT(Worksheets("Deti").Cells(K%, 32), Worksheets("Deti").Cells(K%, 28))))
JDTR = JDTR + (Worksheets("Deti").Cells(5, 2) / 24)
Call JDvDATA(JDTR)
Worksheets("Deti").Cells(STROK, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("Deti").Cells(STROK, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("Deti").Cells(STROK, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("Deti").Cells(STROK, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("Deti").Cells(STROK, 6) = Worksheets("natal").Cells(71, 6)
If STROK > 11 Then
Worksheets("Deti").Cells(STROK - 1, 7) = Worksheets("Deti").Cells(STROK, 2) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("Deti").Cells(STROK - 1, 8) = Worksheets("Deti").Cells(STROK, 3)
Worksheets("Deti").Cells(STROK - 1, 9) = Worksheets("Deti").Cells(STROK, 4)
Worksheets("Deti").Cells(STROK - 1, 10) = Worksheets("Deti").Cells(STROK, 5)
Worksheets("Deti").Cells(STROK - 1, 11) = Worksheets("Deti").Cells(STROK, 6)
Else
End If
    If Worksheets("Deti").Cells(K%, 30) > 0 Then
        Worksheets("Deti").Cells(STROK, 12) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        If Worksheets("Deti").Cells(K%, 31) > 0 Then Worksheets("Deti").Cells(STROK, 13) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        If Worksheets("Deti").Cells(K%, 31) = 0 Then Worksheets("Deti").Cells(STROK, 13) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
        Worksheets("Deti").Cells(STROK, 12) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
STROK = STROK + 1
Next K%

Worksheets("Deti").Select

NS = STROK - 1
For K% = 11 To NS
If Trim(Worksheets("Deti").Cells(K%, 12)) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
Else
End If
Next K%

Worksheets("Deti").Select
Worksheets("Deti").Cells(1, 1).Select

End Sub
Sub natal()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Sheets("med").Select
    Range("B11:I23").Select
    Selection.ClearContents
    Range("L11:S23").Select
    Selection.ClearContents
    Range("A1").Select
    
    Worksheets("med").Select
Rows("31:606").Select
Selection.Font.Bold = True
    Selection.Font.Bold = False
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
Selection.ClearContents

Call radiks

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

End Sub
Sub trk()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TK").Select
Rows("15:1000").Select
Selection.ClearContents
Range("B8").Select
Selection.ClearContents
Columns("T:AX").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 1
Range("A4").Select

Call provtrk '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Call radiks

Dim NDTR As Integer  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim STROK As Integer
Dim N1 As Integer
Dim N2 As Integer
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim t As Double   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim DEL As Double
Dim NSTK As Integer  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TK

If Int(Worksheets("TK").Cells(10, 8)) = 0 Then
N1 = 12
N2 = 18
Else
N1 = 19
N2 = 32
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For K% = 22 To 33
If Trim(Worksheets("TK").Cells(6, 8)) = Trim(Worksheets("natal").Cells(K%, 1)) Then NDTR = K% - 21
Next K%

STROK = 11

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To 21
If Trim(Worksheets("TK").Cells(9, 10)) = Trim(Worksheets("natal").Cells(K%, 1)) Then
Worksheets("TK").Cells(STROK, 20) = Trim(Worksheets("natal").Cells(K%, 1))
Worksheets("TK").Cells(STROK, 21) = Worksheets("natal").Cells(K%, 2)
STROK = STROK + 1
Else
End If
Next K%

For K% = 6 To 8 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("TK").Cells(K%, 10)) = 0 Then GoTo netdoma
Worksheets("TK").Cells(STROK, 20) = Trim(Worksheets("natal").Cells(Int(Worksheets("TK").Cells(K%, 10)) + 21, 1))
Worksheets("TK").Cells(STROK, 21) = Worksheets("natal").Cells(Int(Worksheets("TK").Cells(K%, 10)) + 21, 2)
STROK = STROK + 1

For NP% = 11 To 21
For KP% = N1 To N2
If Int(Worksheets("formula").Cells(NP%, KP%)) = Int(Worksheets("TK").Cells(K%, 10)) Then
Worksheets("TK").Cells(STROK, 20) = Trim(Worksheets("formula").Cells(NP%, 1))
Worksheets("TK").Cells(STROK, 21) = Worksheets("natal").Cells(NP%, 2)
Worksheets("TK").Cells(STROK, 22) = Int(Worksheets("TK").Cells(K%, 10))
STROK = STROK + 1
Else
End If
Next KP%
Next NP%

netdoma: Next K%

If STROK = 11 Then
MsgBox ("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To 49
If Trim(Worksheets("TK").Cells(K%, 20)) = "" Then GoTo netK
For n% = K% + 1 To 50
If Trim(Worksheets("TK").Cells(K%, 20)) = Trim(Worksheets("TK").Cells(n%, 20)) Then
Worksheets("TK").Cells(n%, 20) = ""
Worksheets("TK").Cells(n%, 21) = 0
Worksheets("TK").Cells(n%, 22) = 0
Else
End If
Next n%
netK: Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
STROK = 11

For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netA
If Trim(Worksheets("TK").Cells(6, 9)) = "#" And A% = 60 Then GoTo netA
If Trim(Worksheets("TK").Cells(6, 9)) = "#" And A% = 120 Then GoTo netA
If Trim(Worksheets("TK").Cells(6, 9)) = "&" And A% = 90 Then GoTo netA
If Trim(Worksheets("TK").Cells(6, 9)) = "&" And A% = 180 Then GoTo netA
If Trim(Worksheets("TK").Cells(6, 9)) = "&" And Trim(Worksheets("TK").Cells(11, 8)) = "#" And A% = 0 Then GoTo netA
If Trim(Worksheets("TK").Cells(6, 9)) = "#" And Trim(Worksheets("TK").Cells(11, 8)) = "&" And A% = 0 Then GoTo netA
For NP% = 11 To 50
If Trim(Worksheets("TK").Cells(NP%, 20)) = "" Then GoTo netNP
    If A% = 180 Or A% = 0 Then
t = Worksheets("TK").Cells(NP%, 21) + A% '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If t > 360 Then t = t - 360
Worksheets("TK").Cells(STROK, 31) = t
Worksheets("TK").Cells(STROK, 30) = Trim(Worksheets("TK").Cells(NP%, 20))
Worksheets("TK").Cells(STROK, 32) = Worksheets("TK").Cells(NP%, 22)
Worksheets("TK").Cells(STROK, 33) = A%
STROK = STROK + 1
    Else
t = Worksheets("TK").Cells(NP%, 21) + A% '|fffd||fffd||fffd||fffd||fffd||fffd|
If t > 360 Then t = t - 360
Worksheets("TK").Cells(STROK, 31) = t
Worksheets("TK").Cells(STROK, 30) = Trim(Worksheets("TK").Cells(NP%, 20))
Worksheets("TK").Cells(STROK, 32) = Worksheets("TK").Cells(NP%, 22)
Worksheets("TK").Cells(STROK, 33) = A%
STROK = STROK + 1
t = Worksheets("TK").Cells(NP%, 21) - A% '|fffd||fffd||fffd||fffd||fffd|
If t < 0 Then t = t + 360
Worksheets("TK").Cells(STROK, 31) = t
Worksheets("TK").Cells(STROK, 30) = Trim(Worksheets("TK").Cells(NP%, 20))
Worksheets("TK").Cells(STROK, 32) = Worksheets("TK").Cells(NP%, 22)
Worksheets("TK").Cells(STROK, 33) = A%
STROK = STROK + 1
    End If
netNP: Next NP%
netA: Next A%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double
Dim LonGrad As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVDEL As Double  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TS As Double '|fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTRS As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Call DATAvJD(Int(Worksheets("TK").Cells(2, 2)), Int(Worksheets("TK").Cells(2, 3)), Int(Worksheets("TK").Cells(2, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
JD1 = JD1 - (Worksheets("TK").Cells(6, 2) / 24)
Worksheets("TK").Cells(2, 18) = JD1
JD2 = JD1 + 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TK").Cells(3, 18) = JD2
LatGrad = Worksheets("natal").Cells(36, 6)
Worksheets("TK").Cells(1, 20) = "LatGrad"
Worksheets("TK").Cells(1, 21) = LatGrad
LonGrad = Worksheets("natal").Cells(36, 5)
Worksheets("TK").Cells(2, 20) = "LonGrad"
Worksheets("TK").Cells(2, 21) = LonGrad
ZV0 = ZV00(Int(JD1) + 1 / 2)
Worksheets("TK").Cells(3, 20) = "ZV0"
Worksheets("TK").Cells(3, 21) = ZV0
GMT = (JD1 - Int(JD1)) * 24
Worksheets("TK").Cells(4, 20) = "GMT"
Worksheets("TK").Cells(4, 21) = GMT
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'ZV = ZV0 * 15 + LonGrad
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
Worksheets("TK").Cells(5, 20) = "ZV"
Worksheets("TK").Cells(5, 21) = ZV
Worksheets("TK").Cells(6, 20) = "NDTR"
Worksheets("TK").Cells(6, 21) = NDTR

Worksheets("TK").Cells(STROK, 30) = "TK"
Worksheets("TK").Cells(STROK, 31) = Koh(ZV, NDTR, LatGrad, JD1)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 1 To 499
If Worksheets("TK").Cells(K%, 31) = 0 Then GoTo netuK
For n% = K% + 1 To 500
If Worksheets("TK").Cells(n%, 31) = 0 Then GoTo netuN
If Worksheets("TK").Cells(K%, 31) > Worksheets("TK").Cells(n%, 31) Then

Worksheets("TK").Cells(501, 30) = Worksheets("TK").Cells(K%, 30)
Worksheets("TK").Cells(501, 31) = Worksheets("TK").Cells(K%, 31)
Worksheets("TK").Cells(501, 32) = Worksheets("TK").Cells(K%, 32)
Worksheets("TK").Cells(501, 33) = Worksheets("TK").Cells(K%, 33)

Worksheets("TK").Cells(K%, 30) = Worksheets("TK").Cells(n%, 30)
Worksheets("TK").Cells(K%, 31) = Worksheets("TK").Cells(n%, 31)
Worksheets("TK").Cells(K%, 32) = Worksheets("TK").Cells(n%, 32)
Worksheets("TK").Cells(K%, 33) = Worksheets("TK").Cells(n%, 33)

Worksheets("TK").Cells(n%, 30) = Worksheets("TK").Cells(501, 30)
Worksheets("TK").Cells(n%, 31) = Worksheets("TK").Cells(501, 31)
Worksheets("TK").Cells(n%, 32) = Worksheets("TK").Cells(501, 32)
Worksheets("TK").Cells(n%, 33) = Worksheets("TK").Cells(501, 33)

Else
End If
netuN: Next n%
netuK: Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd|
    If Trim(Worksheets("TK").Cells(11, 30)) = "TK" Then 'TK |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 11 To 500
Worksheets("TK").Cells(K%, 40) = Worksheets("TK").Cells(K%, 30)
Worksheets("TK").Cells(K%, 41) = Worksheets("TK").Cells(K%, 31)
Worksheets("TK").Cells(K%, 42) = Worksheets("TK").Cells(K%, 32)
Worksheets("TK").Cells(K%, 43) = Worksheets("TK").Cells(K%, 33)
Next K%

    Else 'TK |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
For K% = 11 To 500
If Trim(Worksheets("TK").Cells(K%, 30)) = "TK" Then NSTK = K%
Next K%

Worksheets("TK").Cells(11, 40) = Worksheets("TK").Cells(NSTK, 30)
Worksheets("TK").Cells(11, 41) = Worksheets("TK").Cells(NSTK, 31)
Worksheets("TK").Cells(11, 42) = Worksheets("TK").Cells(NSTK, 32)
Worksheets("TK").Cells(11, 43) = Worksheets("TK").Cells(NSTK, 33)
STROK = 12

For K% = (NSTK + 1) To 500
If Trim(Worksheets("TK").Cells(K%, 30)) = "" Then GoTo netKK
Worksheets("TK").Cells(STROK, 40) = Worksheets("TK").Cells(K%, 30)
Worksheets("TK").Cells(STROK, 41) = Worksheets("TK").Cells(K%, 31)
Worksheets("TK").Cells(STROK, 42) = Worksheets("TK").Cells(K%, 32)
Worksheets("TK").Cells(STROK, 43) = Worksheets("TK").Cells(K%, 33)
STROK = STROK + 1
netKK: Next K%

For K% = 11 To (NSTK - 1)
Worksheets("TK").Cells(STROK, 40) = Worksheets("TK").Cells(K%, 30)
Worksheets("TK").Cells(STROK, 41) = Worksheets("TK").Cells(K%, 31)
Worksheets("TK").Cells(STROK, 42) = Worksheets("TK").Cells(K%, 32)
Worksheets("TK").Cells(STROK, 43) = Worksheets("TK").Cells(K%, 33)
STROK = STROK + 1
Next K%
    
    End If

JDTR = JD1
STROK = 15

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Worksheets("TK").Select

For K% = 12 To 500
If Trim(Worksheets("TK").Cells(K%, 40)) = "" Then GoTo netKKK
JDTR = JD1
DEL = ASPECT(Worksheets("TK").Cells(11, 41), Worksheets("TK").Cells(K%, 41))
m1: JDTR = JDTR + DEL / 2000
Worksheets("TK").Cells(4, 18) = JDTR
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
ZV0 = ZV00(Int(JDTR) + 1 / 2)
GMT = (JDTR - Int(JDTR)) * 24
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
t = Koh(ZV, NDTR, LatGrad, JDTR)
DEL = ASPECT(t, Worksheets("TK").Cells(K%, 41))
If DEL > (1 / 240) Then GoTo m1
Worksheets("TK").Cells(STROK, 18) = JDTR
Worksheets("TK").Cells(STROK, 14) = Worksheets("TK").Cells(K%, 40)
Worksheets("TK").Cells(STROK, 15) = Worksheets("TK").Cells(K%, 42)
Worksheets("TK").Cells(STROK, 16) = Worksheets("TK").Cells(K%, 43)
    JDTRS = JD1
    TS = Worksheets("TK").Cells(K%, 41) - Int(Worksheets("TK").Cells(9, 8))
    If TS < 0 Then TS = TS + 360
    DEL = ASPECT(Worksheets("TK").Cells(11, 41), TS)
m3: JDTRS = JDTRS + DEL / 2000
    Worksheets("TK").Cells(STROK, 17) = JDTRS
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ZV0 = ZV00(Int(JDTRS) + 1 / 2)
    GMT = (JDTRS - Int(JDTRS)) * 24
    ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If ZV > 360 Then ZV = ZV - 360
    If ZV > 360 Then ZV = ZV - 360
    If ZV > 360 Then ZV = ZV - 360
    t = Koh(ZV, NDTR, LatGrad, JDTRS)
    DEL = ASPECT(t, TS)
    If DEL > (1 / 240) Then GoTo m3
    Worksheets("TK").Cells(STROK, 17) = JDTRS
STROK = STROK + 1
netKKK: Next K%

For K% = 15 To 1000
If Worksheets("TK").Cells(K%, 17) = 0 And Worksheets("TK").Cells(K%, 18) = 0 Then GoTo netuKKK
t = Worksheets("TK").Cells(K%, 17) + Worksheets("TK").Cells(6, 2) / 24
Call JDvDATA(t)
Worksheets("TK").Cells(K%, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TK").Cells(K%, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("TK").Cells(K%, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("TK").Cells(K%, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("TK").Cells(K%, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("TK").Cells(K%, 7) = Worksheets("natal").Cells(71, 7)
t = Worksheets("TK").Cells(K%, 18) + Worksheets("TK").Cells(6, 2) / 24
Call JDvDATA(t)
Worksheets("TK").Cells(K%, 8) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TK").Cells(K%, 9) = Worksheets("natal").Cells(71, 3)
Worksheets("TK").Cells(K%, 10) = Worksheets("natal").Cells(71, 4)
Worksheets("TK").Cells(K%, 11) = Worksheets("natal").Cells(71, 5)
Worksheets("TK").Cells(K%, 12) = Worksheets("natal").Cells(71, 6)
Worksheets("TK").Cells(K%, 13) = Worksheets("natal").Cells(71, 7)
netuKKK: Next K%

End Sub
Sub MCPR()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("MCpr").Select
Rows("18:10000").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 18
Range("A18").Select

Worksheets("natal").Cells(62, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("natal").Cells(62, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("natal").Cells(62, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("natal").Cells(62, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("natal").Cells(62, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("natal").Cells(62, 7) = Worksheets("natal").Cells(2, 7)

Worksheets("natal").Cells(58, 2) = Worksheets("natal").Cells(8, 2)
Worksheets("natal").Cells(58, 3) = Worksheets("natal").Cells(8, 3)
Worksheets("natal").Cells(58, 4) = Worksheets("natal").Cells(8, 4)
Worksheets("natal").Cells(58, 5) = Worksheets("natal").Cells(8, 5)
Worksheets("natal").Cells(58, 6) = Worksheets("natal").Cells(8, 6)
Worksheets("natal").Cells(58, 7) = Worksheets("natal").Cells(8, 7)

Dim ERRP As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("MCpr").Cells(2, 2) < 0 Or Worksheets("MCpr").Cells(2, 2) > 31 Then
    Worksheets("MCpr").Cells(2, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(2, 3) < 0 Or Worksheets("MCpr").Cells(2, 3) > 12 Then
    Worksheets("MCpr").Cells(2, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(2, 4) < 0 Then
    Worksheets("MCpr").Cells(2, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(2, 5) < 0 Or Worksheets("MCpr").Cells(2, 5) > 23 Then
    Worksheets("MCpr").Cells(2, 5).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(2, 6) < 0 Or Worksheets("MCpr").Cells(2, 6) > 59 Then
    Worksheets("MCpr").Cells(2, 6).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(3, 2) < 0 Or Worksheets("MCpr").Cells(3, 2) > 31 Then
    Worksheets("MCpr").Cells(3, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(3, 3) < 0 Or Worksheets("MCpr").Cells(3, 3) > 12 Then
    Worksheets("MCpr").Cells(3, 3).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(3, 4) < 0 Then
    Worksheets("MCpr").Cells(3, 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(3, 5) < 0 Or Worksheets("MCpr").Cells(3, 5) > 23 Then
    Worksheets("MCpr").Cells(3, 5).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(3, 6) < 0 Or Worksheets("MCpr").Cells(3, 6) > 59 Then
    Worksheets("MCpr").Cells(3, 6).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 9 To 142 Step 7
If Abs(Worksheets("MCpr").Cells(3, K%)) > 67 Then
    Worksheets("MCpr").Cells(3, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Abs(Worksheets("MCpr").Cells(3, (K% + 1))) > 59 Then
    Worksheets("MCpr").Cells(3, (K% + 1)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("MCpr").Cells(3, (K% + 3)) > 360 Or Worksheets("MCpr").Cells(3, (K% + 3)) < 0 Then
    Worksheets("MCpr").Cells(3, (K% + 3)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Abs(Worksheets("MCpr").Cells(3, (K% + 4))) > 59 Then
    Worksheets("MCpr").Cells(3, (K% + 4)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
'--------|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("MCpr").Cells(7, K%) < 1 And Worksheets("MCpr").Cells(7, K%) > 31 Then
    Worksheets("MCpr").Cells(7, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(7, (K% + 1)) < 1 And Worksheets("MCpr").Cells(7, (K% + 1)) > 12 Then
    Worksheets("MCpr").Cells(7, (K% + 1)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("MCpr").Cells(7, (K% + 2)) < 0 Then
    Worksheets("MCpr").Cells(7, (K% + 2)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
'============================
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd|
If Trim(Worksheets("MCpr").Cells(3, (K% + 5))) = "|fffd|" Or Trim(Worksheets("MCpr").Cells(3, (K% + 5))) = "|fffd|" Then
   Worksheets("MCpr").Cells(3, (K% + 3)) = 360 - (Worksheets("MCpr").Cells(3, (K% + 3)) + Worksheets("MCpr").Cells(3, (K% + 4)) / 60)
   Worksheets("MCpr").Cells(3, (K% + 4)) = Int((Worksheets("MCpr").Cells(3, (K% + 3)) - Int(Worksheets("MCpr").Cells(3, (K% + 3)))) * 60 + 0.5)
   Worksheets("MCpr").Cells(3, (K% + 3)) = Int(Worksheets("MCpr").Cells(3, (K% + 3)))
   Worksheets("MCpr").Cells(3, (K% + 5)) = "|fffd|"
   Else
   Worksheets("MCpr").Cells(3, (K% + 5)) = "|fffd|"
   End If
If Trim(Worksheets("MCpr").Cells(3, (K% + 2))) = "|fffd|" Or Trim(Worksheets("MCpr").Cells(3, (K% + 2))) = "|fffd|" Then
   Worksheets("MCpr").Cells(3, K%) = 0 - Abs(Worksheets("MCpr").Cells(3, K%))
   Worksheets("MCpr").Cells(3, (K% + 1)) = 0 - Abs(Worksheets("MCpr").Cells(3, (K% + 1)))
   Worksheets("MCpr").Cells(3, (K% + 2)) = "|fffd|"
   Else
   Worksheets("MCpr").Cells(3, (K% + 2)) = "|fffd|"
   End If
   
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("MCpr").Cells(13, (K% + 2)) <> "" Then
ERRP = 1
For M% = 11 To 21
If Trim(Worksheets("MCpr").Cells(13, (K% + 2))) = Trim(Worksheets("natal").Cells(M%, 1)) Then ERRP = 0
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("MCpr").Cells(13, (K% + 2)).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 0 To 2
If Int(Worksheets("MCpr").Cells((10 + M%), (K% + 2))) < 1 And Int(Worksheets("MCpr").Cells((10 + M%), (K% + 2))) > 12 Then
    Worksheets("MCpr").Cells((10 + M%), (K% + 2)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next M%

Next K%

Worksheets("MCpr").Cells(6, 4) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("MCpr").Cells(7, 4) = 0
Worksheets("MCpr").Select

Dim DOM As Integer
Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Nmin As Long
Dim STROK As Integer
Dim BPflag As Integer
Dim BPflagS As Integer
Dim ORBBP As Double
Dim TRflagORB As Integer
Dim SOVPAD As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim NF As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPL As Integer
Dim Y1 As Double
Dim Y2 As Double
Dim MCBP As Double
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim N1 As Integer
Dim N2 As Integer
Dim SUMNE As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Call DATAvJD(Int(Worksheets("MCpr").Cells(2, 2)), Int(Worksheets("MCpr").Cells(2, 3)), Int(Worksheets("MCpr").Cells(2, 4)), Int(Worksheets("MCpr").Cells(2, 5)), Int(Worksheets("MCpr").Cells(2, 6)), 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("MCpr").Cells(3, 2)), Int(Worksheets("MCpr").Cells(3, 3)), Int(Worksheets("MCpr").Cells(3, 4)), Int(Worksheets("MCpr").Cells(3, 5)), Int(Worksheets("MCpr").Cells(3, 6)), 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Nmin = Int((JD2 - JD1) * (86400 / Worksheets("MCpr").Cells(4, 2))) + 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(2, 7) = 0
STROK = 18

For KT% = 1 To Nmin '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
JDTR = JD1 + (Worksheets("MCpr").Cells(4, 2) / 86400) * KT%
Call JDvDATA(JDTR)
Worksheets("MCpr").Cells(STROK, 2) = Int(Worksheets("natal").Cells(71, 2))
Worksheets("MCpr").Cells(STROK, 3) = Int(Worksheets("natal").Cells(71, 3))
Worksheets("MCpr").Cells(STROK, 4) = Int(Worksheets("natal").Cells(71, 4))
Worksheets("MCpr").Cells(STROK, 5) = Int(Worksheets("natal").Cells(71, 5))
Worksheets("MCpr").Cells(STROK, 6) = Int(Worksheets("natal").Cells(71, 6))
Worksheets("MCpr").Cells(STROK, 7) = Int(Worksheets("natal").Cells(71, 7))
If Worksheets("MCpr").Cells(STROK, 7) > 59 Then Worksheets("MCpr").Cells(STROK, 7) = 59

STROK = STROK + 1
Next KT%

For KF% = 9 To 142 Step 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("MCpr").Cells(7, KF%)) = 0 And Int(Worksheets("MCpr").Cells(7, (KF% + 1))) = 0 And Int(Worksheets("MCpr").Cells(7, (KF% + 2))) = 0 Then GoTo netf

For KT% = 1 To 5000 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("MCpr").Cells(KT% + 17, 2)) = 0 And Int(Worksheets("MCpr").Cells(KT% + 17, 3)) = 0 Then
STROK = KT% + 16
Exit For
Else
End If

        With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        .ScreenUpdating = False
        End With
        
Worksheets("natal").Cells(2, 2) = Worksheets("MCpr").Cells(17 + KT%, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(2, 3) = Worksheets("MCpr").Cells(17 + KT%, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("MCpr").Cells(17 + KT%, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("MCpr").Cells(17 + KT%, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("MCpr").Cells(17 + KT%, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("MCpr").Cells(17 + KT%, 7)

Call radiks
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ============
For K% = 1 To 10
For n% = K% To 11
Worksheets("orb").Cells(10 + K%, 30 + n%) = Worksheets("orb").Cells(10 + n%, 30 + K%)
Next n%
Next K%

Worksheets("natal").Cells(8, 2) = Worksheets("MCpr").Cells(3, (KF% + 3)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(8, 3) = Worksheets("MCpr").Cells(3, (KF% + 4))
Worksheets("natal").Cells(8, 4) = Worksheets("MCpr").Cells(3, (KF% + 5))
Worksheets("natal").Cells(8, 5) = Worksheets("MCpr").Cells(3, KF%)
Worksheets("natal").Cells(8, 6) = Worksheets("MCpr").Cells(3, (KF% + 1))
Worksheets("natal").Cells(8, 7) = Worksheets("MCpr").Cells(3, (KF% + 2))
Worksheets("natal").Cells(3, 2) = Worksheets("MCpr").Cells(7, KF%) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("MCpr").Cells(7, (KF% + 1))
Worksheets("natal").Cells(3, 4) = Worksheets("MCpr").Cells(7, (KF% + 2))

If Int(Worksheets("MCpr").Cells(14, KF%)) = 0 Then
N1 = 12
N2 = 18
Else
N1 = 19
N2 = 29
End If

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
MCBP = Worksheets("natal").Cells(31, 4) + (Worksheets("natal").Cells(3, 9) - Worksheets("natal").Cells(2, 9)) * 30 / 365
BP: If MCBP > 360 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
MCBP = MCBP - 360
GoTo BP
Else
End If
Worksheets("natal").Cells(31, 8) = MCBP

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Worksheets("MCpr").Select
    ORB = 1
    L1 = Worksheets("natal").Cells(31, 8)
    L2 = L1 + 1 / 1000
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For j% = 10 To 12 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("MCpr").Cells(j%, KF% + 2)) = 0 Then GoTo netJ
DOM = Int(Worksheets("MCpr").Cells(j%, KF% + 2))
    L = Worksheets("natal").Cells((21 + DOM), 4)
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MCpr").Cells(17 + KT%, KF%) = 1
        Worksheets("MCpr").Cells(17 + KT%, KF% + 5) = Worksheets("natal").Cells(21 + DOM, 1) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        Worksheets("MCpr").Cells(17 + KT%, KF% + 2) = Abs(ASP1 - NA%) '|fffd||fffd||fffd|
        If Abs(ASP2 - NA%) < Abs(ASP1 - NA%) Then Worksheets("MCpr").Cells(17 + KT%, KF% + 1) = 1 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If

Next NA%
netJ: Next j%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For KP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + KP%), 4)
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    If Trim(Worksheets("MCpr").Cells(13, KF% + 2)) = Trim(Worksheets("natal").Cells((10 + KP%), 1)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                If Int(Worksheets("MCpr").Cells(17 + KT%, KF%)) <> 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MCpr").Cells(17 + KT%, KF%) = 1
        Worksheets("MCpr").Cells(17 + KT%, KF% + 5) = Worksheets("natal").Cells((10 + KP%), 1) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MCpr").Cells(17 + KT%, KF% + 2) = Abs(ASP1 - NA%) '|fffd||fffd||fffd|
        If Abs(ASP2 - NA%) < Abs(ASP1 - NA%) Then Worksheets("MCpr").Cells(17 + KT%, KF% + 1) = 1 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUMNE = 0
If Int(Worksheets("orb").Cells(10 + KP%, 39)) = 1 Or Int(Worksheets("orb").Cells(10 + KP%, 39)) = 90 Or Int(Worksheets("orb").Cells(10 + KP%, 39)) = 180 Then SUMNE = SUMNE + 1
SUMNE = SUMNE + Worksheets("dom").Cells(220 + KP%, 56) + Worksheets("dom").Cells(220 + KP%, 57)
    Worksheets("MCpr").Cells(17 + KT%, KF% + 6).Select
    Selection.ClearContents
If Int(Worksheets("MCpr").Cells(17, KF% + 6)) <= SUMNE Then Worksheets("MCpr").Cells(17 + KT%, KF% + 6) = SUMNE
'                Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                End If
    Else
    End If

For M% = N1 To N2
    If Int(Worksheets("formula").Cells((10 + KP%), M%)) = 0 Then GoTo netum
    If Int(Worksheets("formula").Cells((10 + KP%), M%)) = Int(Worksheets("MCpr").Cells(10, KF% + 2)) Or Int(Worksheets("formula").Cells((10 + KP%), M%)) = Int(Worksheets("MCpr").Cells(11, KF% + 2)) Or Int(Worksheets("formula").Cells((10 + KP%), M%)) = Int(Worksheets("MCpr").Cells(12, KF% + 2)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'                If Int(Worksheets("MCpr").Cells(17 + KT%, KF%)) <> 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MCpr").Cells(17 + KT%, KF%) = 1
        Worksheets("MCpr").Cells(17 + KT%, KF% + 2) = Abs(ASP1 - NA%)
        Worksheets("MCpr").Cells(17 + KT%, KF% + 5) = Worksheets("natal").Cells((10 + KP%), 1) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP2 - NA%) < Abs(ASP1 - NA%) Then Worksheets("MCpr").Cells(17 + KT%, KF% + 1) = 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUMNE = 0
If Int(Worksheets("orb").Cells(10 + KP%, 39)) = 1 Or Int(Worksheets("orb").Cells(10 + KP%, 39)) = 90 Or Int(Worksheets("orb").Cells(10 + KP%, 39)) = 180 Then SUMNE = SUMNE + 1
SUMNE = SUMNE + Worksheets("dom").Cells(220 + KP%, 56) + Worksheets("dom").Cells(220 + KP%, 57)
    Worksheets("MCpr").Cells(17 + KT%, KF% + 6).Select
    Selection.ClearContents
If Int(Worksheets("MCpr").Cells(17, KF% + 6)) <= SUMNE Then Worksheets("MCpr").Cells(17 + KT%, KF% + 6) = SUMNE
'                Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                End If
    Else
    End If
netum: Next M%

Else
End If
Next NA%
Next KP%

If Worksheets("MCpr").Cells(17 + KT%, KF%) > 0 Then Worksheets("MCpr").Cells(17 + KT%, 8) = Worksheets("MCpr").Cells(17 + KT%, 8) + 1

Next KT% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

netf:
Worksheets("MCpr").Select
Worksheets("MCpr").Cells(7, 4) = (KF% / 142) * 100
Next KF% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For KF% = 9 To 142 Step 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("MCpr").Cells(7, KF%)) = 0 And Int(Worksheets("MCpr").Cells(7, (KF% + 1))) = 0 And Int(Worksheets("MCpr").Cells(7, (KF% + 2))) = 0 Then GoTo nokf
For KT% = 18 To (STROK - 1)
If Worksheets("MCpr").Cells(KT%, KF% + 1) > 0 And Int(Worksheets("MCpr").Cells(KT% + 1, KF% + 1)) = 0 And Trim(Worksheets("MCpr").Cells(KT%, KF% + 5)) = Trim(Worksheets("MCpr").Cells(KT% + 1, KF% + 5)) Then
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Y1 = 4 * (Worksheets("MCpr").Cells(KT%, KF% + 2)) * (Worksheets("MCpr").Cells(4, 2))
    Worksheets("MCpr").Cells(KT%, KF% + 4) = "|fffd||fffd||fffd|."
    If Y1 >= 60 Then
    Worksheets("MCpr").Cells(KT%, KF% + 3) = 59 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Else
    Worksheets("MCpr").Cells(KT%, KF% + 3) = Int(Y1) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    End If
Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End If
Next KT% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
nokf: Next KF%

Worksheets("natal").Cells(8, 2) = Worksheets("natal").Cells(58, 2)
Worksheets("natal").Cells(8, 3) = Worksheets("natal").Cells(58, 3)
Worksheets("natal").Cells(8, 4) = Worksheets("natal").Cells(58, 4)
Worksheets("natal").Cells(8, 5) = Worksheets("natal").Cells(58, 5)
Worksheets("natal").Cells(8, 6) = Worksheets("natal").Cells(58, 6)
Worksheets("natal").Cells(8, 7) = Worksheets("natal").Cells(58, 7)

Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(62, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(62, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(62, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(62, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(62, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(62, 7)

Call radiks

With Application
.ScreenUpdating = True
.Calculation = xlCalculationAutomatic
End With

Worksheets("MCpr").Select
ActiveWorkbook.save

End Sub
Sub rektisek()

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("chek-f").Select
Range("H30:XV17000").Select
Selection.ClearContents
Rows("14:14").Select
Selection.ClearContents
Rows("19:19").Select
Selection.ClearContents
Rows("24:24").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 30
Range("A4").Select

Worksheets("natal").Cells(62, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("natal").Cells(62, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("natal").Cells(62, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("natal").Cells(62, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("natal").Cells(62, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("natal").Cells(62, 7) = Worksheets("natal").Cells(2, 7)

Worksheets("natal").Cells(58, 2) = Worksheets("natal").Cells(8, 2)
Worksheets("natal").Cells(58, 3) = Worksheets("natal").Cells(8, 3)
Worksheets("natal").Cells(58, 4) = Worksheets("natal").Cells(8, 4)
Worksheets("natal").Cells(58, 5) = Worksheets("natal").Cells(8, 5)
Worksheets("natal").Cells(58, 6) = Worksheets("natal").Cells(8, 6)
Worksheets("natal").Cells(58, 7) = Worksheets("natal").Cells(8, 7)

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
Call provrek

Worksheets("chek-f").Cells(6, 4) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
Dim Nmin As Long
Dim STROK As Integer

Dim MPpoA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoA As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim MPsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpo As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPne As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPso As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim BPsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpo As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRpoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRne As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRneS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRneT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRso As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRsoS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim TRsoT As Integer  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Dim SDL As Integer  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim SDP As Integer  '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim PL As String '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim PP As String '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Dim MPflag As Integer
Dim MPflagS As Integer
Dim MPflagT As Integer
Dim BPflag As Integer
Dim BPflagS As Integer
Dim BPflagT As Integer
Dim TRflag As Integer
Dim TRflagS As Integer
Dim TRflagT As Integer
Dim UMP As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UBP As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UTR As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SOVPAD As Integer
Dim NTAB As Integer
Dim NDOM1 As Integer
Dim NDOM2 As Integer
Dim NDOM(0 To 12, 0 To 12) As Integer
Dim DOM(0 To 12) As Integer
Dim NPL1 As Integer
Dim NPL2 As Integer
Dim NS As Integer
Dim ASP As Integer
Dim L1 As Double
Dim L2 As Double

STROK = 30
SOVPAD = 0

Nmin = 29

For n% = 30 To 3000
If Worksheets("chek-f").Cells(n%, 2) > 0 And Worksheets("chek-f").Cells(n%, 3) > 0 And Worksheets("chek-f").Cells(n%, 4) > 0 Then
Nmin = n%
Else
Exit For
End If
Next n%
If Nmin = 29 Then
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!")
    End
Else
End If

For n% = 30 To Nmin
If Worksheets("chek-f").Cells(n%, 7) < 0 Or Worksheets("chek-f").Cells(n%, 7) > 59 Then
    Worksheets("chek-f").Cells(n%, 7) = 0
Else
End If
Next n%

Worksheets("natal").Cells(4, 12) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(34, 2) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

For KT% = 30 To Nmin '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("natal").Cells(2, 2) = Int(Worksheets("chek-f").Cells(KT%, 2)) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(2, 3) = Int(Worksheets("chek-f").Cells(KT%, 3))
Worksheets("natal").Cells(2, 4) = Int(Worksheets("chek-f").Cells(KT%, 4))
Worksheets("natal").Cells(2, 5) = Int(Worksheets("chek-f").Cells(KT%, 5))
Worksheets("natal").Cells(2, 6) = Int(Worksheets("chek-f").Cells(KT%, 6))
Worksheets("natal").Cells(2, 7) = Int(Worksheets("chek-f").Cells(KT%, 7))

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

For KF% = 10 To 460 Step 9 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, KF% + 6)) = 0 And Int(Worksheets("chek-f").Cells(7, KF% + 7)) = 0 And Int(Worksheets("chek-f").Cells(7, KF% + 8)) = 0 Then GoTo netf

Worksheets("MP").Cells(60, 34) = Worksheets("chek-f").Cells(9, KF%)
Worksheets("BP").Cells(60, 34) = Worksheets("chek-f").Cells(9, KF%)
Worksheets("TR").Cells(60, 34) = Worksheets("chek-f").Cells(9, KF%)

BPflag = 0
BPflagS = 0
BPflagT = 0
TRflag = 0
TRflagS = 0
TRflagT = 0
MPflag = 0
MPflagS = 0
MPflagT = 0

Worksheets("natal").Cells(8, 2) = Worksheets("chek-f").Cells(7, (KF% + 3)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(8, 3) = Worksheets("chek-f").Cells(7, (KF% + 4))
Worksheets("natal").Cells(8, 4) = Worksheets("chek-f").Cells(7, (KF% + 5))
Worksheets("natal").Cells(8, 5) = Worksheets("chek-f").Cells(7, KF%)
Worksheets("natal").Cells(8, 6) = Worksheets("chek-f").Cells(7, (KF% + 1))
Worksheets("natal").Cells(8, 7) = Worksheets("chek-f").Cells(7, (KF% + 2))
Worksheets("natal").Cells(3, 2) = Worksheets("chek-f").Cells(7, (KF% + 6)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("chek-f").Cells(7, (KF% + 7))
Worksheets("natal").Cells(3, 4) = Worksheets("chek-f").Cells(7, (KF% + 8))

UMP = Int(Worksheets("chek-f").Cells(10, KF%))
UBP = Int(Worksheets("chek-f").Cells(10, KF% + 3))
UTR = Int(Worksheets("chek-f").Cells(10, KF% + 6))
Worksheets("natal").Cells(4, 16) = UMP
Worksheets("natal").Cells(5, 16) = UBP
Worksheets("natal").Cells(6, 16) = UTR

Call goroskop

For NF% = 15 To 25 Step 5

MPneA = 0
MPneS = 0
MPneT = 0
MPpoA = 0
MPpoS = 0
MPpoT = 0
MPsoA = 0
MPsoS = 0
MPsoT = 0

BPne = 0
BPneS = 0
BPneT = 0
BPpo = 0
BPpoS = 0
BPpoT = 0
BPso = 0
BPsoS = 0
BPsoT = 0

TRne = 0
TRneS = 0
TRneT = 0
TRpo = 0
TRpoS = 0
TRpoT = 0
TRso = 0
TRsoS = 0
TRsoT = 0

SDL = 0
SDP = 0

For M% = 0 To 2
SDL = SDL + Int(Worksheets("chek-f").Cells(NF% + M%, KF%))
SDP = SDP + Int(Worksheets("chek-f").Cells(NF% + M%, KF% + 4))
PL = Trim(Worksheets("chek-f").Cells(NF% + 3, KF%))
PP = Trim(Worksheets("chek-f").Cells(NF% + 3, KF% + 4))
Next M%

If SDL = 0 And SDP = 0 And PL = "" And PP = "" Then GoTo netuNF '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If UMP = 0 Then GoTo BP '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 0 To 2
Worksheets("MP").Cells(55 + M%, 31) = Int(Worksheets("chek-f").Cells(NF% + M%, KF%))
Worksheets("MP").Cells(55 + M%, 33) = Int(Worksheets("chek-f").Cells(NF% + M%, KF% + 4))
Worksheets("MP").Cells(58, 30) = Trim(Worksheets("chek-f").Cells(NF% + 3, KF%))
Worksheets("MP").Cells(58, 33) = Trim(Worksheets("chek-f").Cells(NF% + 3, KF% + 4))
Next M%

Call MPpoisk

For K% = 71 To 399 Step 4
If Worksheets("MP").Cells(K%, 32) = 0 Then GoTo netKMP1
    ASP = Int(Worksheets("MP").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) And (Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    MPpoA = MPpoA + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPpoS = MPpoS + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPpoT = MPpoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) And (Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    MPneA = MPneA + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPneS = MPneS + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPneT = MPneT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 And (Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then '|fffd||fffd||fffd||fffd|
    MPsoA = MPsoA + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then MPsoS = MPsoS + 1
        If Trim(Worksheets("MP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then MPsoT = MPsoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKMP1: Next K%
 
Call MPsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF%, KF% + 2)) = "" Then
MPflag = MPflag + MPpoA + MPneA + MPsoA
MPflagS = MPflagS + MPpoS + MPneS + MPsoS
MPflagT = MPflagT + MPpoT + MPneT + MPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF%, KF% + 2)) = "&" And Trim(Worksheets("chek-f").Cells(11, KF%)) = "&" Then
MPflag = MPflag + MPpoA + MPsoA
MPflagS = MPflagS + MPpoS + MPsoS
MPflagT = MPflagT + MPpoT + MPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF%, KF% + 2)) = "&" And Trim(Worksheets("chek-f").Cells(11, KF%)) = "#" Then
MPflag = MPflag + MPpoA
MPflagS = MPflagS + MPpoS
MPflagT = MPflagT + MPpoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF%, KF% + 2)) = "#" And Trim(Worksheets("chek-f").Cells(11, KF%)) = "&" Then
MPflag = MPflag + MPneA
MPflagS = MPflagS + MPneS
MPflagT = MPflagT + MPneT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF%, KF% + 2)) = "#" And Trim(Worksheets("chek-f").Cells(11, KF%)) = "#" Then
MPflag = MPflag + MPneA + MPsoA
MPflagS = MPflagS + MPneS + MPsoS
MPflagT = MPflagT + MPneT + MPsoT
Else
End If

'=============== |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BP: If UBP = 0 Then GoTo TR '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 0 To 2
Worksheets("BP").Cells(55 + M%, 31) = Int(Worksheets("chek-f").Cells(NF% + M%, KF%))
Worksheets("BP").Cells(55 + M%, 33) = Int(Worksheets("chek-f").Cells(NF% + M%, KF% + 4))
Worksheets("BP").Cells(58, 30) = Trim(Worksheets("chek-f").Cells(NF% + 3, KF%))
Worksheets("BP").Cells(58, 33) = Trim(Worksheets("chek-f").Cells(NF% + 3, KF% + 4))
Next M%

Call BPpoisk

For K% = 71 To 399 Step 4
If Worksheets("BP").Cells(K%, 32) = 0 Then GoTo netKBP
    ASP = Int(Worksheets("BP").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    BPpo = BPpo + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPpoS = BPpoS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPpoT = BPpoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    BPne = BPne + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPneS = BPneS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPneT = BPneT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    BPso = BPso + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then BPsoS = BPsoS + 1
    If Trim(Worksheets("BP").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then BPsoT = BPsoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKBP: Next K%
 
Call BPsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 1, KF% + 2)) = "" Then
BPflag = BPflag + BPpo + BPne + BPso
BPflagS = BPflagS + BPpoS + BPneS + BPsoS
BPflagT = BPflagT + BPpoT + BPneT + BPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 1, KF% + 2)) = "&" And Trim(Worksheets("chek-f").Cells(11, KF% + 3)) = "&" Then
BPflag = BPflag + BPpo + BPso
BPflagS = BPflagS + BPpoS + BPsoS
BPflagT = BPflagT + BPpoT + BPsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 1, KF% + 2)) = "&" And Trim(Worksheets("chek-f").Cells(11, KF% + 3)) = "#" Then
BPflag = BPflag + BPpo
BPflagS = BPflagS + BPpoS
BPflagT = BPflagT + BPpoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 1, KF% + 2)) = "#" And Trim(Worksheets("chek-f").Cells(11, KF% + 3)) = "&" Then
BPflag = BPflag + BPne
BPflagS = BPflagS + BPneS
BPflagT = BPflagT + BPneT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 1, KF% + 2)) = "#" And Trim(Worksheets("chek-f").Cells(11, KF% + 3)) = "#" Then
BPflag = BPflag + BPne + BPso
BPflagS = BPflagS + BPneS + BPsoS
BPflagT = BPflagT + BPneT + BPsoT
Else
End If
       
'=============== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
TR: If UTR = 0 Then GoTo REZ '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 0 To 2
Worksheets("TR").Cells(55 + M%, 31) = Int(Worksheets("chek-f").Cells(NF% + M%, KF%))
Worksheets("TR").Cells(55 + M%, 33) = Int(Worksheets("chek-f").Cells(NF% + M%, KF% + 4))
Worksheets("TR").Cells(58, 30) = Trim(Worksheets("chek-f").Cells(NF% + 3, KF%))
Worksheets("TR").Cells(58, 33) = Trim(Worksheets("chek-f").Cells(NF% + 3, KF% + 4))
Next M%

Call TRpoisk

For K% = 71 To 399 Step 4
If Worksheets("TR").Cells(K%, 32) = 0 Then GoTo netKTR
    ASP = Int(Worksheets("TR").Cells(K% + 1, 2))
    
    If (ASP = 30 Or ASP = 60 Or ASP = 120) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    TRpo = TRpo + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRpoS = TRpoS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRpoT = TRpoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If (ASP = 90 Or ASP = 150 Or ASP = 180) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    TRne = TRne + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRneS = TRneS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRneT = TRneT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    If ASP = 0 Then '|fffd||fffd||fffd||fffd|
    TRso = TRso + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then TRsoS = TRsoS + 1
    If Trim(Worksheets("TR").Cells(K% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then TRsoT = TRsoT + 1
    Else
    End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
netKTR: Next K%
 
Call TRsbros

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 2, KF% + 2)) = "" Then
TRflag = TRflag + TRpo + TRne + TRso
TRflagS = TRflagS + TRpoS + TRneS + TRsoS
TRflagT = TRflagT + TRpoT + TRneT + TRsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 2, KF% + 2)) = "&" And Trim(Worksheets("chek-f").Cells(11, KF% + 6)) = "&" Then
TRflag = TRflag + TRpo + TRso
TRflagS = TRflagS + TRpoS + TRsoS
TRflagT = TRflagT + TRpoT + TRsoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 2, KF% + 2)) = "&" And Trim(Worksheets("chek-f").Cells(11, KF% + 6)) = "#" Then
TRflag = TRflag + TRpo
TRflagS = TRflagS + TRpoS
TRflagT = TRflagT + TRpoT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 2, KF% + 2)) = "#" And Trim(Worksheets("chek-f").Cells(11, KF% + 6)) = "&" Then
TRflag = TRflag + TRne
TRflagS = TRflagS + TRneS
TRflagT = TRflagT + TRneT
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("chek-f").Cells(NF% + 2, KF% + 2)) = "#" And Trim(Worksheets("chek-f").Cells(11, KF% + 6)) = "#" Then
TRflag = TRflag + TRne + TRso
TRflagS = TRflagS + TRneS + TRsoS
TRflagT = TRflagT + TRneT + TRsoT
Else
End If

REZ:

netuNF: Next NF%

If MPflag >= UMP And UMP > 0 Then Worksheets("chek-f").Cells(STROK, KF%) = MPflag
If MPflag >= UMP And UMP > 0 And MPflagS > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 1) = MPflagS
If MPflag >= UMP And UMP > 0 And MPflagT > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 2) = MPflagT

If BPflag >= UBP And UBP > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 3) = BPflag
If BPflag >= UBP And UBP > 0 And BPflagS > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 4) = BPflagS
If BPflag >= UBP And UBP > 0 And BPflagT > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 5) = BPflagT

If TRflag >= UTR And UTR > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 6) = TRflag
If TRflag >= UTR And UTR > 0 And TRflagS > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 7) = TRflagS
If TRflag >= UTR And UTR > 0 And TRflagT > 0 Then Worksheets("chek-f").Cells(STROK, KF% + 8) = TRflagT

If UTR > 0 And UBP > 0 And UMP > 0 Then 'MP - BP - TR
    If (Worksheets("chek-f").Cells(STROK, KF% + 2) > 0 And Worksheets("chek-f").Cells(STROK, KF% + 4) > 0 And Worksheets("chek-f").Cells(STROK, KF% + 7) > 0) And (Worksheets("chek-f").Cells(STROK, KF% + 5) > 0 Or Worksheets("chek-f").Cells(STROK, KF% + 8) > 0) Then SOVPAD = SOVPAD + 1
Else
End If

If UTR > 0 And Int(UBP) = 0 And Int(UMP) = 0 And Worksheets("chek-f").Cells(STROK, KF% + 8) > 0 Then SOVPAD = SOVPAD + 1 '|fffd||fffd||fffd||fffd||fffd||fffd| TR
If Int(UTR) = 0 And UBP > 0 And Int(UMP) = 0 And Worksheets("chek-f").Cells(STROK, KF% + 5) > 0 Then SOVPAD = SOVPAD + 1 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
If Int(UTR) = 0 And Int(UBP) = 0 And UMP > 0 And Worksheets("chek-f").Cells(STROK, KF% + 2) > 0 Then SOVPAD = SOVPAD + 1 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

If Int(UTR) = 0 And UBP > 0 And UMP > 0 Then ' MP - BP
    If Worksheets("chek-f").Cells(STROK, KF% + 2) > 0 And Worksheets("chek-f").Cells(STROK, KF% + 5) > 0 Then SOVPAD = SOVPAD + 1
Else
End If

If UTR > 0 And Int(UBP) = 0 And UMP > 0 Then ' MP - TR
    If Worksheets("chek-f").Cells(STROK, KF% + 2) > 0 And Worksheets("chek-f").Cells(STROK, KF% + 8) > 0 Then SOVPAD = SOVPAD + 1
Else
End If

If UTR > 0 And UBP > 0 And Int(UMP) = 0 Then ' BP - TR
    If Worksheets("chek-f").Cells(STROK, KF% + 5) > 0 Or Worksheets("chek-f").Cells(STROK, KF% + 8) > 0 Then SOVPAD = SOVPAD + 1
Else
End If

netf: Next KF% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If SOVPAD > 0 Then Worksheets("chek-f").Cells(STROK, 8) = SOVPAD '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 12 To 460 Step 9 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
Worksheets("chek-f").Cells(STROK, 9) = Worksheets("chek-f").Cells(STROK, 9) + Worksheets("chek-f").Cells(STROK, M%)
Next M%

STROK = STROK + 1
SOVPAD = 0

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Worksheets("chek-f").Select

Worksheets("chek-f").Cells(6, 4) = ((KT% - 18) / (Nmin - 18)) * 100
Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " + CStr(Int(Worksheets("chek-f").Cells(6, 4))) + " %"

If Int(Worksheets("chek-f").Cells(12, 2)) = 1 Then ActiveWorkbook.save

Next KT% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("natal").Cells(4, 16) = 1
Worksheets("natal").Cells(5, 16) = 1
Worksheets("natal").Cells(6, 16) = 1
Worksheets("MP").Cells(34, 2) = 1
Worksheets("natal").Cells(4, 12) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(62, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(62, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(62, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(62, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(62, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(62, 7)

Worksheets("natal").Cells(8, 2) = Worksheets("natal").Cells(58, 2)
Worksheets("natal").Cells(8, 3) = Worksheets("natal").Cells(58, 3)
Worksheets("natal").Cells(8, 4) = Worksheets("natal").Cells(58, 4)
Worksheets("natal").Cells(8, 5) = Worksheets("natal").Cells(58, 5)
Worksheets("natal").Cells(8, 6) = Worksheets("natal").Cells(58, 6)
Worksheets("natal").Cells(8, 7) = Worksheets("natal").Cells(58, 7)

Worksheets("chek-f").Select
ActiveWorkbook.save

End Sub

Sub provrek()

Dim ERRP As Integer
Dim D00 As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 3)) < 1 Or Int(Worksheets("chek-f").Cells(2, 3)) > 12 Then
   Worksheets("chek-f").Cells(2, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 2)) < 1 Or Int(Worksheets("chek-f").Cells(2, 2)) > 31 Then
   Worksheets("chek-f").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 3)) = 2 And Int(Worksheets("chek-f").Cells(2, 2)) > 29 Then
   Worksheets("chek-f").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 3)) = 4 And Int(Worksheets("chek-f").Cells(2, 2)) > 30 Then
   Worksheets("chek-f").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 3)) = 6 And Int(Worksheets("chek-f").Cells(2, 2)) > 30 Then
   Worksheets("chek-f").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 3)) = 9 And Int(Worksheets("chek-f").Cells(2, 2)) > 30 Then
   Worksheets("chek-f").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 3)) = 11 And Int(Worksheets("chek-f").Cells(2, 2)) > 30 Then
   Worksheets("chek-f").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 4)) < 1850 Or Int(Worksheets("chek-f").Cells(2, 4)) > 2100 Then
   Worksheets("chek-f").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 5)) < 0 Or Int(Worksheets("chek-f").Cells(2, 5)) > 23 Then
   Worksheets("chek-f").Cells(2, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(2, 6)) < 0 Or Int(Worksheets("chek-f").Cells(2, 6)) > 59 Then
   Worksheets("chek-f").Cells(2, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 3)) < 1 Or Int(Worksheets("chek-f").Cells(3, 3)) > 12 Then
   Worksheets("chek-f").Cells(3, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 2)) < 1 Or Int(Worksheets("chek-f").Cells(3, 2)) > 31 Then
   Worksheets("chek-f").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 3)) = 2 And Int(Worksheets("chek-f").Cells(3, 2)) > 29 Then
   Worksheets("chek-f").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 3)) = 4 And Int(Worksheets("chek-f").Cells(3, 2)) > 30 Then
   Worksheets("chek-f").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 3)) = 6 And Int(Worksheets("chek-f").Cells(3, 2)) > 30 Then
   Worksheets("chek-f").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 3)) = 9 And Int(Worksheets("chek-f").Cells(3, 2)) > 30 Then
   Worksheets("chek-f").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 3)) = 11 And Int(Worksheets("chek-f").Cells(3, 2)) > 30 Then
   Worksheets("chek-f").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 4)) < 1850 Or Int(Worksheets("chek-f").Cells(3, 4)) > 2100 Then
   Worksheets("chek-f").Cells(3, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 5)) < 0 Or Int(Worksheets("chek-f").Cells(3, 5)) > 23 Then
   Worksheets("chek-f").Cells(3, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(3, 6)) < 0 Or Int(Worksheets("chek-f").Cells(3, 6)) > 59 Then
   Worksheets("chek-f").Cells(3, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 10 To 460 Step 9
Worksheets("chek-f").Cells(5, 6) = (K% / 460) * 100
'=================================================== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 7)) < 0 Or Int(Worksheets("chek-f").Cells(7, K% + 7)) > 12 Then
   Worksheets("chek-f").Cells(7, K% + 7).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 6)) < 0 Or Int(Worksheets("chek-f").Cells(7, K% + 6)) > 31 Then
   Worksheets("chek-f").Cells(7, K% + 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 7)) = 2 And Int(Worksheets("chek-f").Cells(7, K% + 6)) > 29 Then
   Worksheets("chek-f").Cells(7, K% + 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 7)) = 4 And Int(Worksheets("chek-f").Cells(7, K% + 6)) > 30 Then
   Worksheets("chek-f").Cells(7, K% + 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 7)) = 6 And Int(Worksheets("chek-f").Cells(7, K% + 6)) > 30 Then
   Worksheets("chek-f").Cells(7, K% + 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 7)) = 9 And Int(Worksheets("chek-f").Cells(7, K% + 6)) > 30 Then
   Worksheets("chek-f").Cells(7, K% + 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 7)) = 11 And Int(Worksheets("chek-f").Cells(7, K% + 6)) > 30 Then
   Worksheets("chek-f").Cells(7, K% + 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("chek-f").Cells(7, K% + 8)) <> 0 And (Int(Worksheets("chek-f").Cells(7, K% + 8)) < 1850 Or Int(Worksheets("chek-f").Cells(7, K% + 8)) > 2100) Then
   Worksheets("chek-f").Cells(7, K% + 8).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'=================================
Worksheets("chek-f").Cells(7, K%) = Int(Worksheets("chek-f").Cells(7, K%))
Worksheets("chek-f").Cells(7, (K% + 1)) = Int(Worksheets("chek-f").Cells(7, (K% + 1)))
Worksheets("chek-f").Cells(7, (K% + 3)) = Int(Worksheets("chek-f").Cells(7, (K% + 3)))
Worksheets("chek-f").Cells(7, (K% + 4)) = Int(Worksheets("chek-f").Cells(7, (K% + 4))) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("chek-f").Cells(9, K%) = Int(Worksheets("chek-f").Cells(9, K%))
Worksheets("chek-f").Cells(18, K%) = Trim(Worksheets("chek-f").Cells(18, K%))
Worksheets("chek-f").Cells(18, K% + 4) = Trim(Worksheets("chek-f").Cells(18, K% + 4))
Worksheets("chek-f").Cells(23, K%) = Trim(Worksheets("chek-f").Cells(23, K%))
Worksheets("chek-f").Cells(23, K% + 4) = Trim(Worksheets("chek-f").Cells(23, K% + 4))
Worksheets("chek-f").Cells(28, K%) = Trim(Worksheets("chek-f").Cells(28, K%))
Worksheets("chek-f").Cells(28, K% + 4) = Trim(Worksheets("chek-f").Cells(28, K% + 4))

Worksheets("chek-f").Cells(10, K%) = Int(Worksheets("chek-f").Cells(10, K%))
Worksheets("chek-f").Cells(10, (K% + 3)) = Int(Worksheets("chek-f").Cells(10, (K% + 3)))
Worksheets("chek-f").Cells(10, (K% + 6)) = Int(Worksheets("chek-f").Cells(10, (K% + 6)))
Worksheets("chek-f").Cells(11, K%) = Trim(Worksheets("chek-f").Cells(11, K%))
Worksheets("chek-f").Cells(11, K% + 3) = Trim(Worksheets("chek-f").Cells(11, K% + 3))
Worksheets("chek-f").Cells(11, K% + 6) = Trim(Worksheets("chek-f").Cells(11, K% + 6))
If Worksheets("chek-f").Cells(11, K%) <> "&" And Worksheets("chek-f").Cells(11, K%) <> "#" Then Worksheets("chek-f").Cells(11, K%) = "&"
If Worksheets("chek-f").Cells(11, K% + 3) <> "&" And Worksheets("chek-f").Cells(11, K% + 3) <> "#" Then Worksheets("chek-f").Cells(11, K% + 3) = "&"
If Worksheets("chek-f").Cells(11, K% + 6) <> "&" And Worksheets("chek-f").Cells(11, K% + 6) <> "#" Then Worksheets("chek-f").Cells(11, K% + 6) = "&"

If Worksheets("chek-f").Cells(9, K%) <> 0 And Worksheets("chek-f").Cells(9, K%) <> 1 Then Worksheets("chek-f").Cells(9, K%) = 1

If Abs(Worksheets("chek-f").Cells(7, K%)) > 67 Then '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("chek-f").Cells(7, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Abs(Worksheets("chek-f").Cells(7, (K% + 1))) > 59 Then '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("chek-f").Cells(7, (K% + 1)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("chek-f").Cells(7, (K% + 3)) >= 360 Or Worksheets("chek-f").Cells(7, (K% + 3)) < 0 Then '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("chek-f").Cells(7, (K% + 3)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("chek-f").Cells(7, (K% + 4)) > 59 Or Worksheets("chek-f").Cells(7, (K% + 4)) < 0 Then '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("chek-f").Cells(7, (K% + 4)).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd|
If Trim(Worksheets("chek-f").Cells(7, (K% + 5))) = "|fffd|" Or Trim(Worksheets("chek-f").Cells(7, (K% + 5))) = "|fffd|" Then
   Worksheets("chek-f").Cells(7, (K% + 3)) = 360 - (Worksheets("chek-f").Cells(7, (K% + 3)) + Worksheets("chek-f").Cells(7, (K% + 4)) / 60)
   Worksheets("chek-f").Cells(7, (K% + 4)) = Int((Worksheets("chek-f").Cells(7, (K% + 3)) - Int(Worksheets("chek-f").Cells(7, (K% + 3)))) * 60 + 0.5)
   Worksheets("chek-f").Cells(7, (K% + 3)) = Int(Worksheets("chek-f").Cells(7, (K% + 3)))
   Worksheets("chek-f").Cells(7, (K% + 5)) = "|fffd|"
   Else
   Worksheets("chek-f").Cells(7, (K% + 5)) = "|fffd|"
   End If
If Trim(Worksheets("chek-f").Cells(7, (K% + 2))) = "|fffd|" Or Trim(Worksheets("chek-f").Cells(7, (K% + 2))) = "|fffd|" Then
   Worksheets("chek-f").Cells(7, K%) = 0 - Abs(Worksheets("chek-f").Cells(7, K%))
   Worksheets("chek-f").Cells(7, (K% + 1)) = 0 - Abs(Worksheets("chek-f").Cells(7, (K% + 1)))
   Worksheets("chek-f").Cells(7, (K% + 2)) = "|fffd|"
   Else
   Worksheets("chek-f").Cells(7, (K% + 2)) = "|fffd|"
   End If
   
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("chek-f").Cells(18, K%) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("chek-f").Cells(18, K%) = Worksheets("natal").Cells(M%, 1) Then
    ERRP = 0
    Worksheets("chek-f").Cells(18, K% + 2) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("chek-f").Cells(18, K% + 2) = 0
End If
If ERRP = 1 Then
    Worksheets("chek-f").Cells(18, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

ERRP = 0
If Worksheets("chek-f").Cells(18, K% + 4) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("chek-f").Cells(18, K% + 4) = Worksheets("natal").Cells(M%, 1) Then
    ERRP = 0
    Worksheets("chek-f").Cells(18, K% + 6) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("chek-f").Cells(18, K% + 6) = 0
End If
If ERRP = 1 Then
    Worksheets("chek-f").Cells(18, K% + 4).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("chek-f").Cells(23, K%) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("chek-f").Cells(23, K%) = Worksheets("natal").Cells(M%, 1) Then
    ERRP = 0
    Worksheets("chek-f").Cells(23, K% + 2) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("chek-f").Cells(23, K% + 2) = 0
End If
If ERRP = 1 Then
    Worksheets("chek-f").Cells(23, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

ERRP = 0
If Worksheets("chek-f").Cells(23, K% + 4) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("chek-f").Cells(23, K% + 4) = Worksheets("natal").Cells(M%, 1) Then
    ERRP = 0
    Worksheets("chek-f").Cells(23, K% + 6) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("chek-f").Cells(23, K% + 6) = 0
End If
If ERRP = 1 Then
    Worksheets("chek-f").Cells(23, K% + 4).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Worksheets("chek-f").Cells(28, K%) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("chek-f").Cells(28, K%) = Worksheets("natal").Cells(M%, 1) Then
    ERRP = 0
    Worksheets("chek-f").Cells(28, K% + 2) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("chek-f").Cells(28, K% + 2) = 0
End If
If ERRP = 1 Then
    Worksheets("chek-f").Cells(28, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

ERRP = 0
If Worksheets("chek-f").Cells(28, K% + 4) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("chek-f").Cells(28, K% + 4) = Worksheets("natal").Cells(M%, 1) Then
    ERRP = 0
    Worksheets("chek-f").Cells(28, K% + 6) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
Worksheets("chek-f").Cells(28, K% + 6) = 0
End If
If ERRP = 1 Then
    Worksheets("chek-f").Cells(28, K% + 4).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

For j% = 15 To 25 Step 5
For M% = 0 To 2

Worksheets("chek-f").Cells(M% + j%, K%) = Int(Worksheets("chek-f").Cells(M% + j%, K%))
Worksheets("chek-f").Cells(M% + j%, K% + 4) = Int(Worksheets("chek-f").Cells(M% + j%, K% + 4))
If Worksheets("chek-f").Cells(M% + j%, K%) < 0 Or Worksheets("chek-f").Cells(M% + j%, K%) > 12 Then
    Worksheets("chek-f").Cells(M% + j%, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("chek-f").Cells(M% + j%, K% + 4) < 0 Or Worksheets("chek-f").Cells(M% + j%, K% + 4) > 12 Then
    Worksheets("chek-f").Cells(M% + j%, K% + 4).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

Worksheets("chek-f").Cells(M% + j%, K% + 2) = Trim(Worksheets("chek-f").Cells(M% + j%, K% + 2))
If Worksheets("chek-f").Cells(M% + j%, K% + 2) <> "" And Worksheets("chek-f").Cells(M% + j%, K% + 2) <> "&" And Worksheets("chek-f").Cells(M% + j%, K% + 2) <> "#" Then
    Worksheets("chek-f").Cells(M% + j%, K% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

Next M%
Next j%

For M% = 15 To 16
For j% = (M% + 1) To 17
If Worksheets("chek-f").Cells(M%, K%) > Worksheets("chek-f").Cells(j%, K%) And Worksheets("chek-f").Cells(j%, K%) > 0 Then
D00 = Worksheets("chek-f").Cells(M%, K%)
Worksheets("chek-f").Cells(M%, K%) = Worksheets("chek-f").Cells(j%, K%)
Worksheets("chek-f").Cells(j%, K%) = D00
Else
End If
If Worksheets("chek-f").Cells(M%, K% + 4) > Worksheets("chek-f").Cells(j%, K% + 4) And Worksheets("chek-f").Cells(j%, K% + 4) > 0 Then
D00 = Worksheets("chek-f").Cells(M%, K% + 4)
Worksheets("chek-f").Cells(M%, K% + 4) = Worksheets("chek-f").Cells(j%, K% + 4)
Worksheets("chek-f").Cells(j%, K% + 4) = D00
Else
End If
Next j%
Next M%

For M% = 20 To 21
For j% = (M% + 1) To 22
If Worksheets("chek-f").Cells(M%, K%) > Worksheets("chek-f").Cells(j%, K%) And Worksheets("chek-f").Cells(j%, K%) > 0 Then
D00 = Worksheets("chek-f").Cells(M%, K%)
Worksheets("chek-f").Cells(M%, K%) = Worksheets("chek-f").Cells(j%, K%)
Worksheets("chek-f").Cells(j%, K%) = D00
Else
End If
If Worksheets("chek-f").Cells(M%, K% + 4) > Worksheets("chek-f").Cells(j%, K% + 4) And Worksheets("chek-f").Cells(j%, K% + 4) > 0 Then
D00 = Worksheets("chek-f").Cells(M%, K% + 4)
Worksheets("chek-f").Cells(M%, K% + 4) = Worksheets("chek-f").Cells(j%, K% + 4)
Worksheets("chek-f").Cells(j%, K% + 4) = D00
Else
End If
Next j%
Next M%

For M% = 25 To 26
For j% = (M% + 1) To 27
If Worksheets("chek-f").Cells(M%, K%) > Worksheets("chek-f").Cells(j%, K%) And Worksheets("chek-f").Cells(j%, K%) > 0 Then
D00 = Worksheets("chek-f").Cells(M%, K%)
Worksheets("chek-f").Cells(M%, K%) = Worksheets("chek-f").Cells(j%, K%)
Worksheets("chek-f").Cells(j%, K%) = D00
Else
End If
If Worksheets("chek-f").Cells(M%, K% + 4) > Worksheets("chek-f").Cells(j%, K% + 4) And Worksheets("chek-f").Cells(j%, K% + 4) > 0 Then
D00 = Worksheets("chek-f").Cells(M%, K% + 4)
Worksheets("chek-f").Cells(M%, K% + 4) = Worksheets("chek-f").Cells(j%, K% + 4)
Worksheets("chek-f").Cells(j%, K% + 4) = D00
Else
End If
Next j%
Next M%

Next K%

End Sub
Sub rektif()
'
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("chek-f").Select
Rows("30:16000").Select
Selection.ClearContents
Rows("14:14").Select
Selection.ClearContents
Rows("19:19").Select
Selection.ClearContents
Rows("24:24").Select
Selection.ClearContents
ActiveWindow.ScrollRow = 30
Range("A13").Select

Worksheets("natal").Cells(62, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("natal").Cells(62, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("natal").Cells(62, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("natal").Cells(62, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("natal").Cells(62, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("natal").Cells(62, 7) = Worksheets("natal").Cells(2, 7)

Worksheets("natal").Cells(58, 2) = Worksheets("natal").Cells(8, 2)
Worksheets("natal").Cells(58, 3) = Worksheets("natal").Cells(8, 3)
Worksheets("natal").Cells(58, 4) = Worksheets("natal").Cells(8, 4)
Worksheets("natal").Cells(58, 5) = Worksheets("natal").Cells(8, 5)
Worksheets("natal").Cells(58, 6) = Worksheets("natal").Cells(8, 6)
Worksheets("natal").Cells(58, 7) = Worksheets("natal").Cells(8, 7)

Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROK As Integer

STROK = 30

Call DATAvJD(Int(Worksheets("chek-f").Cells(2, 2)), Int(Worksheets("chek-f").Cells(2, 3)), Int(Worksheets("chek-f").Cells(2, 4)), Int(Worksheets("chek-f").Cells(2, 5)), Int(Worksheets("chek-f").Cells(2, 6)), 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("chek-f").Cells(3, 2)), Int(Worksheets("chek-f").Cells(3, 3)), Int(Worksheets("chek-f").Cells(3, 4)), Int(Worksheets("chek-f").Cells(3, 5)), Int(Worksheets("chek-f").Cells(3, 6)), 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
TSTEP = Worksheets("chek-f").Cells(4, 2) / 86400
JDTR = JD1

For KT% = 1 To 30000 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
JDTR = JD1 + TSTEP * KT%
If JDTR > JD2 Then Exit For
Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " + CStr(Int((JDTR - JD1) / (JD2 - JD1) * 100)) + " %"
Call JDvDATA(JDTR)
Worksheets("chek-f").Cells(STROK, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("chek-f").Cells(STROK, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("chek-f").Cells(STROK, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("chek-f").Cells(STROK, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("chek-f").Cells(STROK, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("chek-f").Cells(STROK, 7) = Worksheets("natal").Cells(71, 7)
STROK = STROK + 1
Next KT%

Worksheets("MP").Cells(34, 2) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

Call rektisek

Worksheets("MP").Cells(34, 2) = 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

End Sub



Sub poisk()
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Sheets("poisk").Select  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Rows("14:50000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 14
    Range("A4").Select

Worksheets("natal").Cells(62, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("natal").Cells(62, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("natal").Cells(62, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("natal").Cells(62, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("natal").Cells(62, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("natal").Cells(62, 7) = Worksheets("natal").Cells(2, 7)
    
Dim D00 As Integer

For K% = 10 To 154 Step 4
If Worksheets("poisk").Cells(5, (K% + 1)) <> "" And Worksheets("poisk").Cells(5, (K% + 1)) <> "#" And Worksheets("poisk").Cells(5, (K% + 1)) <> "&" Then Worksheets("poisk").Cells(5, (K% + 1)) = ""
If Int(Worksheets("poisk").Cells(9, K%)) <> 0 Then Worksheets("poisk").Cells(9, K%) = 1
If Worksheets("poisk").Cells(11, K%) <> "#" And Worksheets("poisk").Cells(11, K%) <> "&" Then Worksheets("poisk").Cells(11, K%) = "&"

For M% = 5 To 7
Worksheets("poisk").Cells(M%, K%) = Int(Worksheets("poisk").Cells(M%, K%))
Worksheets("poisk").Cells(M%, K% + 2) = Int(Worksheets("poisk").Cells(M%, K% + 2))
If Worksheets("poisk").Cells(M%, K%) < 1 Or Worksheets("poisk").Cells(M%, K%) > 12 Then Worksheets("poisk").Cells(M%, K%) = 0
If Worksheets("poisk").Cells(M%, K% + 2) < 1 Or Worksheets("poisk").Cells(M%, K%) > 12 Then Worksheets("poisk").Cells(M%, K% + 2) = 0
Next M%

For M% = 5 To 6
For L% = (M% + 1) To 7
If Worksheets("poisk").Cells(M%, K%) > Worksheets("poisk").Cells(L%, K%) And Worksheets("poisk").Cells(L%, K%) > 0 Then
D00 = Worksheets("poisk").Cells(M%, K%)
Worksheets("poisk").Cells(M%, K%) = Worksheets("poisk").Cells(L%, K%)
Worksheets("poisk").Cells(L%, K%) = D00
Else
End If
If Worksheets("poisk").Cells(M%, K% + 2) > Worksheets("poisk").Cells(L%, K% + 2) And Worksheets("poisk").Cells(L%, K% + 2) > 0 Then
D00 = Worksheets("poisk").Cells(M%, K% + 2)
Worksheets("poisk").Cells(M%, K% + 2) = Worksheets("poisk").Cells(L%, K% + 2)
Worksheets("poisk").Cells(L%, K% + 2) = D00
Else
End If
Next L%
Next M%

Worksheets("poisk").Cells(9, (K% + 2)) = 0
If Trim(Worksheets("poisk").Cells(8, (K% + 2))) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("poisk").Cells(8, (K% + 2))) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("poisk").Cells(9, (K% + 2)) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("poisk").Cells(8, (K% + 2)).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

Worksheets("poisk").Cells(8, 2) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With
    
Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Nmin As Long
Dim STROK As Integer
Dim SOVPAD As Integer
Dim NESOVPAD As Integer
Dim BPL As Integer
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim FLAG As Integer ' |fffd||fffd||fffd||fffd||fffd||fffd|
Dim S0 As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SNE As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SPLUS As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SUM As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim N1 As Integer
Dim N2 As Integer
Dim PLANET As String
Dim D1 As Integer
Dim D2 As Integer
Dim NP As Integer
Dim D(0 To 12, 0 To 12) As Integer

STROK = 14
SOVPAD = 0
NESOVPAD = 0

Call DATAvJD(Int(Worksheets("poisk").Cells(2, 2)), Int(Worksheets("poisk").Cells(2, 3)), Int(Worksheets("poisk").Cells(2, 4)), Int(Worksheets("poisk").Cells(2, 5)), Int(Worksheets("poisk").Cells(2, 6)), 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
JD1 = JD1 - (Worksheets("poisk").Cells(6, 2) / 24) '|fffd| GMT
Call DATAvJD(Int(Worksheets("poisk").Cells(3, 2)), Int(Worksheets("poisk").Cells(3, 3)), Int(Worksheets("poisk").Cells(3, 4)), Int(Worksheets("poisk").Cells(3, 5)), Int(Worksheets("poisk").Cells(3, 6)), 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
JD2 = JD2 - (Worksheets("poisk").Cells(6, 2) / 24) '|fffd| GMT
Nmin = Int((JD2 - JD1) * 86400 / Int(Worksheets("poisk").Cells(5, 2))) + 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
JDTR = JD1
'Worksheets("poisk").Cells(7, 2) = Nmin

For KT% = 1 To Nmin '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        .ScreenUpdating = False
        End With

JDTR = JDTR + (Int(Worksheets("poisk").Cells(5, 2)) / 86400)
Call JDvDATA(JDTR)
Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(71, 7)
Call JDvDATA(JDTR + (Worksheets("poisk").Cells(6, 2) / 24)) '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("poisk").Cells(STROK, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("poisk").Cells(STROK, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("poisk").Cells(STROK, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("poisk").Cells(STROK, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("poisk").Cells(STROK, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("poisk").Cells(STROK, 7) = Worksheets("natal").Cells(71, 7)
If Worksheets("poisk").Cells(STROK - 1, 5) = Worksheets("poisk").Cells(STROK, 5) And Worksheets("poisk").Cells(STROK - 1, 6) = Worksheets("poisk").Cells(STROK, 6) And Worksheets("poisk").Cells(STROK - 1, 7) = Worksheets("poisk").Cells(STROK, 7) Then GoTo netKT

Call radiks

For KF% = 10 To 154 Step 4
'====================================================================
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("poisk").Cells(10, KF%)) = 0 Then GoTo netf
If Int(Worksheets("poisk").Cells(5, KF%)) = 0 And Int(Worksheets("poisk").Cells(6, KF%)) = 0 And Int(Worksheets("poisk").Cells(7, KF%)) = 0 Then GoTo netf

If Int(Worksheets("poisk").Cells(9, KF%)) = 1 Then
NTAB = 30
Else
End If
If Int(Worksheets("poisk").Cells(9, KF%)) = 0 Then
NTAB = 10
Else
End If

S0 = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SNE = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SPLUS = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
For K% = 1 To 12
D(M%, K%) = 0
Next K%
Next M%

NP = Int(Worksheets("poisk").Cells(9, KF% + 2))
If NP = 0 Then GoTo netplanet

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NL% = 5 To 7
If Int(Worksheets("poisk").Cells(NL%, KF%)) = 0 Then GoTo netuNL0
D1 = Int(Worksheets("poisk").Cells(NL%, KF%))
S0 = S0 + Worksheets("dom").Cells(190 + NTAB + NP, 9 + 4 * D1)
SNE = SNE + Worksheets("dom").Cells(190 + NTAB + NP, 8 + 4 * D1)
SPLUS = SPLUS + Worksheets("dom").Cells(190 + NTAB + NP, 7 + 4 * D1)
netuNL0: Next NL%

netplanet:
    For NL% = 5 To 7
    If Int(Worksheets("poisk").Cells(NL%, KF%)) = 0 Then GoTo netNL
    D1 = Int(Worksheets("poisk").Cells(NL%, KF%))
    For NR% = 5 To 7
    If Int(Worksheets("poisk").Cells(NR%, (KF% + 2))) = 0 Then GoTo netNR
    D2 = Int(Worksheets("poisk").Cells(NR%, (KF% + 2)))
        If D(D1, D2) = 0 And D(D2, D1) = 0 Then ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    S0 = S0 + Int(Worksheets("dom").Cells((NTAB + D1), (9 + 4 * D2)))
    SNE = SNE + Int(Worksheets("dom").Cells((NTAB + D1), (8 + 4 * D2)))
    SPLUS = SPLUS + Int(Worksheets("dom").Cells((NTAB + D1), (7 + 4 * D2)))
    D(D1, D2) = 1
        Else
        End If
netNR:     Next NR%
netNL:     Next NL%

If Worksheets("poisk").Cells(5, (KF% + 1)) = "" Then SUM = SPLUS + SNE + S0
If Worksheets("poisk").Cells(5, (KF% + 1)) = "#" And Worksheets("poisk").Cells(11, KF%) = "#" Then SUM = SNE + S0
If Worksheets("poisk").Cells(5, (KF% + 1)) = "&" And Worksheets("poisk").Cells(11, KF%) = "&" Then SUM = SPLUS + S0
If Worksheets("poisk").Cells(5, (KF% + 1)) = "#" And Worksheets("poisk").Cells(11, KF%) = "&" Then SUM = SNE
If Worksheets("poisk").Cells(5, (KF% + 1)) = "&" And Worksheets("poisk").Cells(11, KF%) = "#" Then SUM = SPLUS
If Int(Worksheets("poisk").Cells(10, KF%)) <= SUM Then
Worksheets("poisk").Cells(STROK, KF%) = SUM
Worksheets("poisk").Cells(STROK, KF% + 1) = SPLUS
Worksheets("poisk").Cells(STROK, KF% + 2) = SNE
Worksheets("poisk").Cells(STROK, KF% + 3) = S0
Else
End If

If Worksheets("poisk").Cells(STROK, KF%) > 0 And Int(Worksheets("poisk").Cells(4, KF%)) = 0 Then SOVPAD = SOVPAD + 1
If Worksheets("poisk").Cells(STROK, KF%) > 0 And Int(Worksheets("poisk").Cells(4, KF%)) > 0 Then NESOVPAD = NESOVPAD + 1

netf: Next KF%
'===================================================================
If SOVPAD >= 1 Then Worksheets("poisk").Cells(STROK, 8) = SOVPAD
If NESOVPAD >= 1 Then Worksheets("poisk").Cells(STROK, 9) = NESOVPAD

STROK = STROK + 1
SOVPAD = 0
NESOVPAD = 0
        With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .ScreenUpdating = True
        End With
Worksheets("poisk").Select
Worksheets("poisk").Cells(8, 2) = (KT% / (Nmin + 1)) * 100

netKT: Next KT% ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("poisk").Cells(8, 2) = 100

Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(62, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(62, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(62, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(62, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(62, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(62, 7)

Call radiks

With Application
.ScreenUpdating = True
.Calculation = xlCalculationAutomatic
End With

Worksheets("poisk").Select
ActiveWorkbook.save

End Sub
Sub PDNatLoc(NDOM As Integer, ZNAK As String, PLANET As String, NF As Integer)

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NPL As Integer
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21
If Trim(Worksheets("natal").Cells(n%, 1)) = PLANET Then NPL = n%
Next n%

If NDOM = Int(Worksheets("MP").Cells(NPL, 28)) Then
    If Int(Worksheets("MP").Cells(NPL, 28)) = 6 Or Int(Worksheets("MP").Cells(NPL, 28)) = 12 Or Int(Worksheets("MP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("BP").Cells(NPL, 28)) Then
    If Int(Worksheets("BP").Cells(NPL, 28)) = 6 Or Int(Worksheets("BP").Cells(NPL, 28)) = 12 Or Int(Worksheets("BP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("TR").Cells(NPL, 28)) Then
    If Int(Worksheets("TR").Cells(NPL, 28)) = 6 Or Int(Worksheets("TR").Cells(NPL, 28)) = 12 Or Int(Worksheets("TR").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
    End If
Else
End If
'---------------------------

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 6)
If Worksheets("natal").Cells(KP%, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netMM
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If PLANET = "|fffd||fffd||fffd||fffd|" Then
                If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                    If ZNAK = "#" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                Else
                    If ZNAK = "&" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                End If
            Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                Else
                End If
            End If
        End If
    Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        End If
    End If
Else
End If
Next NA%
netMM: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 6)
    If Worksheets("natal").Cells(NPL, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 45 To 54 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netm

For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If PLANET = "|fffd||fffd||fffd||fffd|" Then
                If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                    If ZNAK = "#" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                Else
                    If ZNAK = "&" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                End If
            Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                Else
                End If
            End If
        End If
    Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        End If
    End If
Else
End If
Next NA%
netm: Next M%
Next KP%
'========================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 8)
If Worksheets("natal").Cells(KP%, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
            Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 3)) = Worksheets("chek-f").Cells(13, (NF + 3)) + 1
Else
End If
Next NA%

netMMBP: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 8)
If Worksheets("natal").Cells(NPL, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 45 To 54 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 3)) = Worksheets("chek-f").Cells(13, (NF + 3)) + 1
Else
End If
Next NA%
netMBP: Next M%
Next KP%
'=================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 10)
If Worksheets("natal").Cells(KP%, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMMTR
    
 For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 5)) = Worksheets("chek-f").Cells(13, (NF + 5)) + 1
            If Worksheets("chek-f").Cells(13, (NF + 6)) = 0 Or Abs(Worksheets("chek-f").Cells(13, (NF + 6))) > Abs(ASP1 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 6)) = Abs(ASP1 - NA%)

Else
End If
netNA: Next NA%
netMMTR: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 10)
If Worksheets("natal").Cells(NPL, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
    
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 45 To 54 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMTR
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netuNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 5)) = Worksheets("chek-f").Cells(13, (NF + 5)) + 1
            If Worksheets("chek-f").Cells(13, (NF + 6)) = 0 Or Abs(Worksheets("chek-f").Cells(13, (NF + 6))) > Abs(ASP1 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 6)) = Abs(ASP1 - NA%)

Else
End If
netuNA: Next NA%
netMTR: Next M%
Next KP%

End Sub
Sub PDLoc(NDOM As Integer, ZNAK As String, PLANET As String, NF As Integer)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|

Dim NPL As Integer
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21
If Trim(Worksheets("natal").Cells(n%, 1)) = PLANET Then NPL = n%
Next n%

If NDOM = Int(Worksheets("MP").Cells(NPL, 28)) Then
    If Int(Worksheets("MP").Cells(NPL, 28)) = 6 Or Int(Worksheets("MP").Cells(NPL, 28)) = 12 Or Int(Worksheets("MP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("BP").Cells(NPL, 28)) Then
    If Int(Worksheets("BP").Cells(NPL, 28)) = 6 Or Int(Worksheets("BP").Cells(NPL, 28)) = 12 Or Int(Worksheets("BP").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
    End If
Else
End If

If NDOM = Int(Worksheets("TR").Cells(NPL, 28)) Then
    If Int(Worksheets("TR").Cells(NPL, 28)) = 6 Or Int(Worksheets("TR").Cells(NPL, 28)) = 12 Or Int(Worksheets("TR").Cells(NPL, 28)) = 8 Then
        If ZNAK = "#" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
    Else
        If ZNAK = "&" Or ZNAK = "" Then Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
    End If
Else
End If
'---------------------------

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 6)
If Worksheets("natal").Cells(KP%, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netMM
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If PLANET = "|fffd||fffd||fffd||fffd|" Then
                If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                    If ZNAK = "#" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                Else
                    If ZNAK = "&" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                End If
            Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                Else
                End If
            End If
        End If
    Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        End If
    End If
Else
End If
Next NA%
netMM: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 6)
    If Worksheets("natal").Cells(NPL, 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 38 To 44 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("MP").Cells(KP%, M%)) Then GoTo netm

For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If NA% = 0 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NDOM = 6 Or NDOM = 8 Or NDOM = 12 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If PLANET = "|fffd||fffd||fffd||fffd|" Then
                If NDOM = 1 Or NDOM = 7 Or NDOM = 10 Then
                    If ZNAK = "#" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                Else
                    If ZNAK = "&" Or ZNAK = "" Then
                    Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                    Else
                    End If
                End If
            Else
                If ZNAK = "&" Or ZNAK = "" Then
                Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
                If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
                Else
                End If
            End If
        End If
    Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If NA% = 90 Or NA% = 150 Or NA% = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "#" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
            If ZNAK = "&" Or ZNAK = "" Then
            Worksheets("chek-f").Cells(13, NF) = Worksheets("chek-f").Cells(13, NF) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 1)) = Worksheets("chek-f").Cells(13, (NF + 1)) + 1
            Else
            End If
        End If
    End If
Else
End If
Next NA%
netm: Next M%
Next KP%
'========================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 8)
If Worksheets("natal").Cells(KP%, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
            Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 3)) = Worksheets("chek-f").Cells(13, (NF + 3)) + 1
Else
End If
Next NA%

netMMBP: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 8)
If Worksheets("natal").Cells(NPL, 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For KP% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 38 To 44 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("BP").Cells(KP%, M%)) Then GoTo netMBP
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Worksheets("chek-f").Cells(13, (NF + 2)) = Worksheets("chek-f").Cells(13, (NF + 2)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 3)) = Worksheets("chek-f").Cells(13, (NF + 3)) + 1
Else
End If
Next NA%
netMBP: Next M%
Next KP%
'=================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L = Worksheets("natal").Cells(NPL, 4)
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L1 = Worksheets("natal").Cells(KP%, 10)
If Worksheets("natal").Cells(KP%, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360

    For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMMTR
    
 For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 5)) = Worksheets("chek-f").Cells(13, (NF + 5)) + 1
            If Worksheets("chek-f").Cells(13, (NF + 6)) = 0 Or Abs(Worksheets("chek-f").Cells(13, (NF + 6))) > Abs(ASP1 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 6)) = Abs(ASP1 - NA%)

Else
End If
netNA: Next NA%
netMMTR: Next M%
Next KP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    L1 = Worksheets("natal").Cells(NPL, 10)
If Worksheets("natal").Cells(NPL, 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
    
For KP% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("TR").Cells(KP%, 2)
    L = Worksheets("natal").Cells(KP%, 4)

    For M% = 38 To 44 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If NDOM <> Int(Worksheets("TR").Cells(KP%, M%)) Then GoTo netMTR
    
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netuNA
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Worksheets("chek-f").Cells(13, (NF + 4)) = Worksheets("chek-f").Cells(13, (NF + 4)) + 1
            If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 5)) = Worksheets("chek-f").Cells(13, (NF + 5)) + 1
            If Worksheets("chek-f").Cells(13, (NF + 6)) = 0 Or Abs(Worksheets("chek-f").Cells(13, (NF + 6))) > Abs(ASP1 - NA%) Then Worksheets("chek-f").Cells(13, (NF + 6)) = Abs(ASP1 - NA%)

Else
End If
netuNA: Next NA%
netMTR: Next M%
Next KP%

End Sub

Function Nmin() As Long
Dim DEL As Double

DEL = (Worksheets("chek-f").Cells(3, 4) - Worksheets("chek-f").Cells(2, 4)) * 60 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Nmin = Int(DEL + 1 / 2)

End Function
Attribute VB_Name = "Module3"
Sub gerih()

Dim SUN As Double
Dim LUN As Double
Dim SAT As Double
Dim A(8) As Double
Dim B(16) As Double
Dim NSTROK As Integer
Dim X As Double
Dim NZ As Integer

SUN = Worksheets("natal").Cells(11, 2)
LUN = Worksheets("natal").Cells(12, 2)
SAT = Worksheets("natal").Cells(17, 2)

Worksheets("gerih").Cells(11, 2) = (SUN + LUN) / 2
If Worksheets("gerih").Cells(11, 2) > 180 Then Worksheets("gerih").Cells(11, 3) = Worksheets("gerih").Cells(11, 2) - 180
If Worksheets("gerih").Cells(11, 2) <= 180 Then Worksheets("gerih").Cells(11, 3) = Worksheets("gerih").Cells(11, 2) + 180

Worksheets("gerih").Cells(12, 2) = (SUN + SAT) / 2
If Worksheets("gerih").Cells(12, 2) > 180 Then Worksheets("gerih").Cells(12, 3) = Worksheets("gerih").Cells(12, 2) - 180
If Worksheets("gerih").Cells(12, 2) <= 180 Then Worksheets("gerih").Cells(12, 3) = Worksheets("gerih").Cells(12, 2) + 180

Worksheets("gerih").Cells(13, 2) = (LUN + SAT) / 2
If Worksheets("gerih").Cells(13, 2) > 180 Then Worksheets("gerih").Cells(13, 3) = Worksheets("gerih").Cells(13, 2) - 180
If Worksheets("gerih").Cells(13, 2) <= 180 Then Worksheets("gerih").Cells(13, 3) = Worksheets("gerih").Cells(13, 2) + 180

A(1) = (Worksheets("gerih").Cells(11, 2) + Worksheets("gerih").Cells(12, 2)) / 2
If A(1) > 180 Then A(2) = A(1) - 180
If A(1) <= 180 Then A(2) = A(1) + 180

A(3) = (Worksheets("gerih").Cells(11, 2) + Worksheets("gerih").Cells(12, 3)) / 2
If A(3) > 180 Then A(4) = A(3) - 180
If A(3) <= 180 Then A(4) = A(3) + 180

A(5) = (Worksheets("gerih").Cells(11, 3) + Worksheets("gerih").Cells(12, 2)) / 2
If A(5) > 180 Then A(6) = A(5) - 180
If A(5) <= 180 Then A(6) = A(5) + 180

A(7) = (Worksheets("gerih").Cells(11, 3) + Worksheets("gerih").Cells(12, 3)) / 2
If A(7) > 180 Then A(8) = A(7) - 180
If A(7) <= 180 Then A(8) = A(7) + 180

For K% = 1 To 8
Worksheets("gerih").Cells(14, K% + 1) = A(K%)
Next K%

For K% = 1 To 7
For n% = (K% + 1) To 8
If A(K%) > A(n%) Then
X = A(n%)
A(n%) = A(K%)
A(K%) = X
Else
End If
Next n%
Next K%

For K% = 1 To 4
Worksheets("gerih").Cells(16, K% + 1) = A(2 * K%)
Next K%

B(1) = (Worksheets("gerih").Cells(13, 2) + Worksheets("gerih").Cells(16, 2)) / 2
If B(1) > 180 Then B(2) = B(1) - 180
If B(1) <= 180 Then B(2) = B(1) + 180

B(3) = (Worksheets("gerih").Cells(13, 2) + Worksheets("gerih").Cells(16, 3)) / 2
If B(3) > 180 Then B(4) = B(3) - 180
If B(3) <= 180 Then B(4) = B(3) + 180

B(5) = (Worksheets("gerih").Cells(13, 3) + Worksheets("gerih").Cells(16, 2)) / 2
If B(5) > 180 Then B(6) = B(5) - 180
If B(5) <= 180 Then B(6) = B(5) + 180

B(7) = (Worksheets("gerih").Cells(13, 3) + Worksheets("gerih").Cells(16, 3)) / 2
If B(7) > 180 Then B(8) = B(7) - 180
If B(7) <= 180 Then B(8) = B(7) + 180

B(9) = (Worksheets("gerih").Cells(13, 2) + Worksheets("gerih").Cells(16, 4)) / 2
If B(9) > 180 Then B(10) = B(9) - 180
If B(9) <= 180 Then B(10) = B(9) + 180

B(11) = (Worksheets("gerih").Cells(13, 2) + Worksheets("gerih").Cells(16, 5)) / 2
If B(11) > 180 Then B(12) = B(11) - 180
If B(11) <= 180 Then B(12) = B(11) + 180

B(13) = (Worksheets("gerih").Cells(13, 3) + Worksheets("gerih").Cells(16, 4)) / 2
If B(13) > 180 Then B(14) = B(13) - 180
If B(13) <= 180 Then B(14) = B(13) + 180

B(15) = (Worksheets("gerih").Cells(13, 3) + Worksheets("gerih").Cells(16, 5)) / 2
If B(15) > 180 Then B(16) = B(15) - 180
If B(15) <= 180 Then B(16) = B(15) + 180

For K% = 1 To 16
Worksheets("gerih").Cells(15, K% + 1) = B(K%)
Next K%

For K% = 1 To 15
For n% = (K% + 1) To 16
If B(K%) > B(n%) Then
X = B(n%)
B(n%) = B(K%)
B(K%) = X
Else
End If
Next n%
Next K%

For K% = 1 To 8
Worksheets("gerih").Cells(17, K% + 1) = B(2 * K%)
Next K%

For K% = 2 To 9
Worksheets("gerih").Cells(18, K%) = Worksheets("gerih").Cells(17, K%)
Next K%

For K% = 2 To 5
Worksheets("gerih").Cells(18, K% + 8) = Worksheets("gerih").Cells(16, K%)
Next K%

For K% = 2 To 12
For n% = (K% + 1) To 13
If Worksheets("gerih").Cells(18, K%) > Worksheets("gerih").Cells(18, n%) Then
X = Worksheets("gerih").Cells(18, n%)
Worksheets("gerih").Cells(18, n%) = Worksheets("gerih").Cells(18, K%)
Worksheets("gerih").Cells(18, K%) = X
Else
End If
Next n%
Next K%

For K% = 2 To 13
NZ = Int(Worksheets("gerih").Cells(18, K%) / 30)
Worksheets("gerih").Cells(19, K%) = Worksheets("gerih").Cells(18, K%) - (NZ * 30)
Worksheets("gerih").Cells(20, K%) = Worksheets("gerih").Cells(19 + K%, 2)
Next K%

End Sub

Sub opisanie()

Worksheets("opis").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Range("A4:M500").Select
Selection.ClearContents
Rows("4:500").Select
Selection.RowHeight = 13
Range("A3").Select

Call ftest

Dim STROK As Integer
Dim NDOM1 As Integer
Dim NDOM2 As Integer
Dim PL1 As Integer
Dim PL2 As Integer
Dim SUM As Integer
Dim A As String
Dim K(50) As Integer
Dim DFLAG(12, 12) As Integer
K(10) = 1
K(30) = 4


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'=======================================
For n% = 10 To 30 Step 20 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|

STROK = 4

For KS% = 2 To 254 Step 3 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("f-baza").Cells(5, KS%)) = 0 And Int(Worksheets("f-baza").Cells(5, KS% + 2)) = 0 Then GoTo netKS01
For KF% = 4 To 28 Step 6    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
DFLAG(i%, M%) = 0
Next M%
Next i%

If Int(Worksheets("f-baza").Cells(KF% + 6, KS%)) = 0 And Int(Worksheets("f-baza").Cells(KF% + 6, KS% + 2)) = 0 Then GoTo netplanet
If Int(Worksheets("f-baza").Cells(KF% + 6, KS%)) = 0 Then GoTo p2

    PL1 = Int(Worksheets("f-baza").Cells(KF% + 6, KS%)) '|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For M% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    NDOM2 = Int(Worksheets("f-baza").Cells(KF% + M%, KS% + 2))
    If NDOM2 < 1 Then GoTo nom
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 10 + 4 * NDOM2)
    Else
    End If

    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(n% + 190 + PL1, 9 + 4 * NDOM2)
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 8 + 4 * NDOM2)
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(n% + 190 + PL1, 9 + 4 * NDOM2)
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 7 + 4 * NDOM2)
    Else
    End If
    
nom: Next M%

p2: If Int(Worksheets("f-baza").Cells(KF% + 6, KS% + 2)) = 0 Then GoTo netplanet

    PL1 = Int(Worksheets("f-baza").Cells(KF% + 6, KS% + 2)) '|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For M% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    NDOM2 = Int(Worksheets("f-baza").Cells(KF% + M%, KS%))
    If NDOM2 < 1 Then GoTo nom2
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 10 + 4 * NDOM2)
    Else
    End If

    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(n% + 190 + PL1, 9 + 4 * NDOM2)
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 8 + 4 * NDOM2)
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(n% + 190 + PL1, 9 + 4 * NDOM2)
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + 190 + PL1, 7 + 4 * NDOM2)
    Else
    End If
    
nom2: Next M%
    
netplanet:
For j% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Int(Worksheets("f-baza").Cells(KF% + j%, KS%))
If NDOM1 < 1 Then GoTo netj01
For M% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Int(Worksheets("f-baza").Cells(KF% + M%, KS% + 2))
If NDOM2 < 1 Then GoTo netm01
If DFLAG(NDOM1, NDOM2) = 1 Then GoTo netm01 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If DFLAG(NDOM2, NDOM1) = 1 Then GoTo netm01 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 10 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 6, KS% + 1) = Worksheets("f-baza").Cells(KF% + 6, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
netm01: Next M%
netj01: Next j%

Next KF%

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = Worksheets("f-baza").Cells(10, KS% + 1) + Worksheets("f-baza").Cells(16, KS% + 1) + Worksheets("f-baza").Cells(22, KS% + 1) + Worksheets("f-baza").Cells(28, KS% + 1) + Worksheets("f-baza").Cells(34, KS% + 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("f-baza").Cells(10, KS% + 1) >= Worksheets("f-baza").Cells(9, KS% + 1) And Worksheets("f-baza").Cells(16, KS% + 1) >= Worksheets("f-baza").Cells(15, KS% + 1) And Worksheets("f-baza").Cells(22, KS% + 1) >= Worksheets("f-baza").Cells(21, KS% + 1) And Worksheets("f-baza").Cells(28, KS% + 1) >= Worksheets("f-baza").Cells(27, KS% + 1) And Worksheets("f-baza").Cells(34, KS% + 1) >= Worksheets("f-baza").Cells(33, KS% + 1) And SUM >= Worksheets("f-baza").Cells(35, KS% + 1) Then
Worksheets("opis").Cells(STROK, K(n%)) = Worksheets("f-baza").Cells(4, KS%)
Worksheets("opis").Cells(STROK, K(n%) + 1) = SUM
STROK = STROK + 1
Else
End If

netKS01: Next KS%

STROK = STROK + 1
Worksheets("opis").Cells(STROK, K(n%)) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|:"
STROK = STROK + 1
Worksheets("opis").Cells(STROK, K(n%)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"

For KS% = 2 To 254 Step 3 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("f-baza").Cells(51, KS%)) = 0 And Int(Worksheets("f-baza").Cells(51, KS% + 2)) = 0 Then GoTo netKS02
Worksheets("f-baza").Cells(55, KS% + 1) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
DFLAG(i%, M%) = 0
Next M%
Next i%

For j% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Int(Worksheets("f-baza").Cells(50 + j%, KS%))
If NDOM1 < 1 Then GoTo netj02
For M% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Int(Worksheets("f-baza").Cells(50 + M%, KS% + 2))
If NDOM2 < 1 Then GoTo netm02
If DFLAG(NDOM1, NDOM2) = 1 Then GoTo netm02 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If DFLAG(NDOM2, NDOM1) = 1 Then GoTo netm02 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    If Trim(Worksheets("f-baza").Cells(51, KS% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(55, KS% + 1) = Worksheets("f-baza").Cells(55, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 10 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(51, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(52, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(55, KS% + 1) = Worksheets("f-baza").Cells(55, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(51, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(52, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(55, KS% + 1) = Worksheets("f-baza").Cells(55, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(51, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(52, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(55, KS% + 1) = Worksheets("f-baza").Cells(55, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(51, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(52, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(55, KS% + 1) = Worksheets("f-baza").Cells(55, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
netm02: Next M%
netj02: Next j%

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("f-baza").Cells(55, KS% + 1) >= Worksheets("f-baza").Cells(54, KS% + 1) Then
Worksheets("opis").Cells(STROK, K(n%)) = Worksheets("f-baza").Cells(50, KS%)
Worksheets("opis").Cells(STROK, K(n%) + 1) = Worksheets("f-baza").Cells(55, KS% + 1)
STROK = STROK + 1
Else
End If

netKS02: Next KS%

STROK = STROK + 1
Worksheets("opis").Cells(STROK, K(n%)) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
STROK = STROK + 1
Worksheets("opis").Cells(STROK, K(n%)) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."

For KS% = 2 To 254 Step 3 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("f-baza").Cells(71, KS%)) = 0 And Int(Worksheets("f-baza").Cells(71, KS% + 2)) = 0 Then GoTo netKS03
Worksheets("f-baza").Cells(75, KS% + 1) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
DFLAG(i%, M%) = 0
Next M%
Next i%

For j% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Int(Worksheets("f-baza").Cells(70 + j%, KS%))
If NDOM1 < 1 Then GoTo netj03
For M% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Int(Worksheets("f-baza").Cells(70 + M%, KS% + 2))
If NDOM2 < 1 Then GoTo netm03
If DFLAG(NDOM1, NDOM2) = 1 Then GoTo netm03 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If DFLAG(NDOM2, NDOM1) = 1 Then GoTo netm03 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    If Trim(Worksheets("f-baza").Cells(71, KS% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(75, KS% + 1) = Worksheets("f-baza").Cells(75, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 10 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(71, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(72, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(75, KS% + 1) = Worksheets("f-baza").Cells(75, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(71, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(72, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(75, KS% + 1) = Worksheets("f-baza").Cells(75, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(71, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(72, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(75, KS% + 1) = Worksheets("f-baza").Cells(75, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(71, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(72, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(75, KS% + 1) = Worksheets("f-baza").Cells(75, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
netm03: Next M%
netj03: Next j%

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("f-baza").Cells(75, KS% + 1) >= Worksheets("f-baza").Cells(74, KS% + 1) Then
Worksheets("opis").Cells(STROK, K(n%)) = Worksheets("f-baza").Cells(70, KS%)
Worksheets("opis").Cells(STROK, K(n%) + 1) = Worksheets("f-baza").Cells(75, KS% + 1)
STROK = STROK + 1
Else
End If

netKS03: Next KS%

STROK = STROK + 1
Worksheets("opis").Cells(STROK, K(n%)) = "|fffd||fffd||fffd||fffd||fffd||fffd|:"
STROK = STROK + 1
Worksheets("opis").Cells(STROK, K(n%)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|."

For KS% = 2 To 254 Step 3 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("f-baza").Cells(81, KS%)) = 0 And Int(Worksheets("f-baza").Cells(81, KS% + 2)) = 0 Then GoTo netKS04
For KF% = 80 To 105 Step 5    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("f-baza").Cells(KF% + 5, KS% + 1) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
DFLAG(i%, M%) = 0
Next M%
Next i%

For j% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Int(Worksheets("f-baza").Cells(KF% + j%, KS%))
If NDOM1 < 1 Then GoTo netj04
For M% = 1 To 3  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Int(Worksheets("f-baza").Cells(KF% + M%, KS% + 2))
If NDOM2 < 1 Then GoTo netm04
If DFLAG(NDOM1, NDOM2) = 1 Then GoTo netm04 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If DFLAG(NDOM2, NDOM1) = 1 Then GoTo netm04 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "" Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 5, KS% + 1) = Worksheets("f-baza").Cells(KF% + 5, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 10 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 5, KS% + 1) = Worksheets("f-baza").Cells(KF% + 5, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "&" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 5, KS% + 1) = Worksheets("f-baza").Cells(KF% + 5, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 7 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "#" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 5, KS% + 1) = Worksheets("f-baza").Cells(KF% + 5, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2) + Worksheets("dom").Cells(n% + NDOM1, 9 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
    If Trim(Worksheets("f-baza").Cells(KF% + 1, KS% + 1)) = "#" And Trim(Worksheets("f-baza").Cells(KF% + 2, KS% + 1)) = "&" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("f-baza").Cells(KF% + 5, KS% + 1) = Worksheets("f-baza").Cells(KF% + 5, KS% + 1) + Worksheets("dom").Cells(n% + NDOM1, 8 + 4 * NDOM2)
    DFLAG(NDOM1, NDOM2) = 1
    DFLAG(NDOM2, NDOM1) = 1
    Else
    End If
    
netm04: Next M%
netj04: Next j%

Next KF%

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = Worksheets("f-baza").Cells(85, KS% + 1) + Worksheets("f-baza").Cells(90, KS% + 1) + Worksheets("f-baza").Cells(95, KS% + 1) + Worksheets("f-baza").Cells(100, KS% + 1) + Worksheets("f-baza").Cells(105, KS% + 1) + Worksheets("f-baza").Cells(110, KS% + 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("f-baza").Cells(85, KS% + 1) >= Worksheets("f-baza").Cells(84, KS% + 1) And Worksheets("f-baza").Cells(90, KS% + 1) >= Worksheets("f-baza").Cells(89, KS% + 1) And Worksheets("f-baza").Cells(95, KS% + 1) >= Worksheets("f-baza").Cells(94, KS% + 1) And Worksheets("f-baza").Cells(100, KS% + 1) >= Worksheets("f-baza").Cells(99, KS% + 1) And Worksheets("f-baza").Cells(105, KS% + 1) >= Worksheets("f-baza").Cells(104, KS% + 1) And Worksheets("f-baza").Cells(110, KS% + 1) >= Worksheets("f-baza").Cells(109, KS% + 1) And SUM >= Worksheets("f-baza").Cells(111, KS% + 1) Then
Worksheets("opis").Cells(STROK, K(n%)) = Worksheets("f-baza").Cells(80, KS%)
Worksheets("opis").Cells(STROK, K(n%) + 1) = SUM
STROK = STROK + 1
Else
End If

netKS04: Next KS%

Next n%
End Sub
Sub phorar()
'|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Sheets("horar").Select
Range("L11:R21").Select
    Selection.ClearContents
    Range("AC31:AZ54").Select
    Selection.ClearContents
    Range("S11").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("horar").Cells(29, 2)) < 2 Or Int(Worksheets("horar").Cells(29, 2)) > 12 Then
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   Worksheets("horar").Cells(29, 2) = Int(Worksheets("horar").Cells(29, 2))
   End If
   
Dim NDOMPR As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STRLIST As Integer
Dim NDOM As Integer
Dim NDOM1 As Integer
Dim NDOM2 As Integer
Dim NDOMP1 As Integer
Dim NDOMP2 As Integer

STRLIST = 61
NDOMPR = Int(Worksheets("horar").Cells(29, 2))

For n% = 61 To 389 Step 4
If Int(Worksheets("horar").Cells(n%, 5)) = 0 Then GoTo netn1 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        For K% = 0 To 6
        NDOM = Int(Worksheets("horar").Cells(n%, K% + 5))
        If NDOM = 0 Then GoTo netk1
        Worksheets("horar").Cells(n%, K% + 12) = Worksheets("horar").Cells(NDOM, NDOMPR + 100)
netk1:  Next K%
        For K% = 0 To 6
        NDOM = Int(Worksheets("horar").Cells(n% + 2, K% + 5))
        If NDOM = 0 Then GoTo netk2
        Worksheets("horar").Cells(n% + 2, K% + 12) = Worksheets("horar").Cells(NDOM, NDOMPR + 100)
netk2: Next K%
netn1: Next n%

For n% = 11 To 21
        For K% = 0 To 6
        NDOM = Int(Worksheets("horar").Cells(n%, K% + 5))
        If NDOM = 0 Then GoTo netk3
        Worksheets("horar").Cells(n%, K% + 12) = Worksheets("horar").Cells(NDOM, NDOMPR + 100)
netk3:  Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 12 To 17 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("horar").Cells(n%, K%)
If NDOM1 = 0 Then GoTo netNDom1

For M% = (K% + 1) To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| k-|fffd|
NDOM2 = Worksheets("horar").Cells(n%, M%)

If NDOM2 = 0 Then GoTo netNDom2

If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((30 + 2 * NDOM2), (28 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (28 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((30 + 2 * NDOM1), (28 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (28 + NDOM2)) + 1
        End If
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((29 + 2 * NDOM2), (28 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (28 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((29 + 2 * NDOM1), (28 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (28 + NDOM2)) + 1
        End If
End If

netNDom2: Next M%
netNDom1: Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NTAB = Worksheets("natal").Cells(4, 2)

For n% = 11 To 20 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|

For K% = (n% + 1) To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 2))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netA
If Abs(Lasp - A%) >= Worksheets("orb").Cells((NTAB * 10 + (K% - 10)), n%) Then GoTo netA
Lasp2 = ASPECT(Worksheets("natal").Cells(n%, 10), Worksheets("natal").Cells(K%, 10))

If A% = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        For M% = 12 To 18
        NDOM1 = Worksheets("horar").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netm
        For i% = 12 To 18
        NDOM2 = Worksheets("horar").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netI
        
 If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((30 + 2 * NDOM2), (28 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (28 + NDOM1)) + 1
    If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM2), (40 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (40 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((30 + 2 * NDOM1), (28 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (28 + NDOM2)) + 1
    If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM1), (40 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (40 + NDOM2)) + 1
        End If
Else '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((29 + 2 * NDOM2), (28 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (28 + NDOM1)) + 1
    If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM2), (40 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (40 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((29 + 2 * NDOM1), (28 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (28 + NDOM2)) + 1
    If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM1), (40 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (40 + NDOM2)) + 1
        End If
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

netI:   Next i%
netm:   Next M%

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
        For M% = 12 To 18
        NDOM1 = Worksheets("horar").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMM
        For i% = 12 To 18
        NDOM2 = Worksheets("horar").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netII
        
            If NDOM1 <= NDOM2 Then
       Worksheets("horar").Cells((29 + 2 * NDOM2), (28 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (28 + NDOM1)) + 1
       If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM2), (40 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (40 + NDOM1)) + 1
            Else
       Worksheets("horar").Cells((29 + 2 * NDOM1), (28 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (28 + NDOM2)) + 1
       If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM1), (40 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (40 + NDOM2)) + 1
            End If
netII:   Next i%
netMM:   Next M%

    Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
        For M% = 12 To 18
        NDOM1 = Worksheets("horar").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMMM
        For i% = 12 To 18
        NDOM2 = Worksheets("horar").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netIII
        
            If NDOM1 <= NDOM2 Then
        Worksheets("horar").Cells((30 + 2 * NDOM2), (28 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (28 + NDOM1)) + 1
        If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM2), (40 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (40 + NDOM1)) + 1
            Else
        Worksheets("horar").Cells((30 + 2 * NDOM1), (28 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (28 + NDOM2)) + 1
        If Abs(Lasp - A%) > Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM1), (40 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (40 + NDOM2)) + 1
            End If
netIII:   Next i%
netMMM:   Next M%
    End If
End If

netA: Next A%
Next K%
Next n%

End Sub
Sub tabkon()

Sheets("tabkonf").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Rows("11:7500").Select
    Selection.ClearContents
    Range("A6").Select

Worksheets("tabkonf").Cells(7, 7) = 0
 
Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROK As Long
Dim SUM As Integer
Dim TSTEP As Double
Dim NSTEP As Long
Dim KT As Long
Dim ORB As Double
Dim B As Double
Dim ASP As Double
Dim JDNN As Long
Dim PLUTON As Double
Dim SATURN As Double
Dim UPITER As Double
Dim MARS As Double
Dim LUNA As Double
Dim LUNA12 As Double
Dim LILIT As Double
    
Call DATAvJD(Int(Worksheets("tabkonf").Cells(8, 2)), Int(Worksheets("tabkonf").Cells(8, 3)), Int(Worksheets("tabkonf").Cells(8, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("tabkonf").Cells(9, 2)), Int(Worksheets("tabkonf").Cells(9, 3)), Int(Worksheets("tabkonf").Cells(9, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If JD1 = 0 Then
    Worksheets("tabkonf").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD2 = 0 Then
    Worksheets("tabkonf").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD1 >= JD2 Then
    Worksheets("tabkonf").Select
    MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

For K% = 2 To 3
    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
If Int(Worksheets("tabkonf").Cells(K%, 2)) < 0 Or Int(Worksheets("tabkonf").Cells(K%, 2)) > 31 Then
   Worksheets("tabkonf").Cells(K%, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("tabkonf").Cells(K%, 3)) < 0 Or Int(Worksheets("tabkonf").Cells(K%, 3)) > 12 Then
   Worksheets("tabkonf").Cells(K%, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If (Int(Worksheets("tabkonf").Cells(K%, 4)) < 1850 Or Int(Worksheets("tabkonf").Cells(K%, 4)) > 2070) And Int(Worksheets("tabkonf").Cells(K%, 4)) <> 0 Then
   Worksheets("tabkonf").Cells(K%, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("tabkonf").Cells(K%, 5)) < 0 Or Int(Worksheets("tabkonf").Cells(K%, 5)) > 23 Then
   Worksheets("tabkonf").Cells(K%, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("tabkonf").Cells(K%, 6)) < 0 Or Int(Worksheets("tabkonf").Cells(K%, 6)) > 59 Then
   Worksheets("tabkonf").Cells(K%, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("tabkonf").Cells(K%, 7)) < 0 Or Int(Worksheets("tabkonf").Cells(K%, 7)) > 59 Then
   Worksheets("tabkonf").Cells(K%, 7).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
Next K%

ORB = Worksheets("sina").Cells(1, 11)

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

'============ |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 2
Worksheets("tabkonf").Cells(10, K% + 4) = Int(Worksheets("tabkonf").Cells(K% + 1, 8))
Worksheets("tabkonf").Cells(10, K% + 7) = Int(Worksheets("tabkonf").Cells(K% + 1, 8))

Call DATAvJD(Int(Worksheets("tabkonf").Cells(K% + 1, 2)), Int(Worksheets("tabkonf").Cells(K% + 1, 3)), Int(Worksheets("tabkonf").Cells(K% + 1, 4)), Int(Worksheets("tabkonf").Cells(K% + 1, 5)), Int(Worksheets("tabkonf").Cells(K% + 1, 6)), Int(Worksheets("tabkonf").Cells(K% + 1, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
B = Worksheets("natal").Cells(81, 1) - Int(Worksheets("natal").Cells(81, 1))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(JDNN, B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("tabkonf").Cells(1, K% + 100) = Worksheets("natal").Cells(15, 10) '|fffd||fffd||fffd||fffd|
Worksheets("tabkonf").Cells(2, K% + 100) = Worksheets("natal").Cells(16, 10) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("tabkonf").Cells(3, K% + 100) = Worksheets("natal").Cells(17, 10) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("tabkonf").Cells(4, K% + 100) = Worksheets("natal").Cells(20, 10) '|fffd||fffd||fffd||fffd||fffd||fffd|

Next K%

'====================== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STROK = 11
NSTEP = Int(JD2 - JD1)

For KT = 1 To NSTEP
JDTR = JD1 + KT
Call JDvDATA(JDTR)
'Worksheets("natal").Cells(71, 8) - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(71, 8)), 0, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("tabkonf").Cells(1, 103) = Worksheets("natal").Cells(20, 10)
Worksheets("tabkonf").Cells(2, 103) = Worksheets("natal").Cells(17, 10)
Worksheets("tabkonf").Cells(3, 103) = Worksheets("natal").Cells(16, 10)
Worksheets("tabkonf").Cells(4, 103) = Worksheets("natal").Cells(15, 10)
Worksheets("tabkonf").Cells(5, 103) = Worksheets("natal").Cells(12, 10)
Worksheets("tabkonf").Cells(6, 103) = Worksheets("natal").Cells(21, 10)

Worksheets("tabkonf").Cells(STROK, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("tabkonf").Cells(STROK, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("tabkonf").Cells(STROK, 4) = Worksheets("natal").Cells(71, 4)

PLUTON = Worksheets("natal").Cells(20, 10)
SATURN = Worksheets("natal").Cells(17, 10)
UPITER = Worksheets("natal").Cells(16, 10)
MARS = Worksheets("natal").Cells(15, 10)
LUNA = Worksheets("natal").Cells(12, 10)
LUNA12 = LUNA + 7
If LUNA12 >= 360 Then LUNA12 = LUNA12 - 360
LILIT = Worksheets("natal").Cells(21, 10)

For n% = 1 To 2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), PLUTON)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 9 + K% + (n% - 1) * 16) = 1
Next A%
Next K%

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), SATURN)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 13 + K% + (n% - 1) * 16) = 1
Next A%
Next K%

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), UPITER)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 17 + K% + (n% - 1) * 16) = 1
Next A%
Next K%

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), MARS)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 21 + K% + (n% - 1) * 16) = 1
Next A%
Next K%

ORB = 8

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), LUNA)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 41 + K% + (n% - 1) * 4) = 1
Next A%
Next K%

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), LUNA12)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 41 + K% + (n% - 1) * 4) = 1
Next A%
Next K%

ORB = 4.5

For K% = 1 To 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("tabkonf").Cells(K%, n% + 100), LILIT)
For A% = 0 To 180 Step 90
    If Abs(A% - ASP) < ORB Then Worksheets("tabkonf").Cells(STROK, 49 + K% + (n% - 1) * 4) = 1
Next A%
Next K%

ORB = Worksheets("sina").Cells(1, 11)

Next n%

'-------------
SUM = 0
For K% = 10 To 22 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 8) = Worksheets("tabkonf").Cells(STROK, 8) + 1

SUM = 0
For K% = 11 To 23 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 8) = Worksheets("tabkonf").Cells(STROK, 8) + 1

SUM = 0
For K% = 12 To 24 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 8) = Worksheets("tabkonf").Cells(STROK, 8) + 1

SUM = 0
For K% = 13 To 25 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 8) = Worksheets("tabkonf").Cells(STROK, 8) + 1
'---------------------
SUM = 0
For K% = 26 To 38 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 9) = Worksheets("tabkonf").Cells(STROK, 9) + 1

SUM = 0
For K% = 27 To 39 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 9) = Worksheets("tabkonf").Cells(STROK, 9) + 1

SUM = 0
For K% = 28 To 40 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 9) = Worksheets("tabkonf").Cells(STROK, 9) + 1

SUM = 0
For K% = 29 To 41 Step 4
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 9) = Worksheets("tabkonf").Cells(STROK, 9) + 1
'---------------------

SUM = 0
For K% = 10 To 13
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 5) = Worksheets("tabkonf").Cells(STROK, 5) + 1

SUM = 0
For K% = 14 To 17
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 5) = Worksheets("tabkonf").Cells(STROK, 5) + 1

SUM = 0
For K% = 18 To 21
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 5) = Worksheets("tabkonf").Cells(STROK, 5) + 1

SUM = 0
For K% = 22 To 25
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 5) = Worksheets("tabkonf").Cells(STROK, 5) + 1

SUM = 0
For K% = 26 To 29
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 6) = Worksheets("tabkonf").Cells(STROK, 6) + 1

SUM = 0
For K% = 30 To 33
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 6) = Worksheets("tabkonf").Cells(STROK, 6) + 1

SUM = 0
For K% = 34 To 37
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 6) = Worksheets("tabkonf").Cells(STROK, 6) + 1

SUM = 0
For K% = 38 To 41
SUM = SUM + Worksheets("tabkonf").Cells(STROK, K%)
Next K%
If SUM > 0 Then Worksheets("tabkonf").Cells(STROK, 6) = Worksheets("tabkonf").Cells(STROK, 6) + 1

STROK = STROK + 1

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

Worksheets("tabkonf").Cells(7, 7) = (KT / NSTEP) * 100

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Next KT

    Sheets("natal").Select
    Range("J11:K21").Select
    Selection.ClearContents
    Range("A6").Select
    Sheets("tabkonf").Select
    
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

ActiveWorkbook.save

End Sub
Sub tabsin()

Sheets("tabsin").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Rows("11:60000").Select
Selection.ClearContents
Range("A4").Select

Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROK As Integer
Dim TSTEP As Double
Dim NSTEP As Long
Dim KT As Long
Dim B As Double
'===== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ========
Dim SUM As Integer
Dim ORB As Double
Dim NTAB As Integer
Dim ASP As Double

Call DATAvJD(Int(Worksheets("tabsin").Cells(6, 2)), Int(Worksheets("tabsin").Cells(6, 3)), Int(Worksheets("tabsin").Cells(6, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("tabsin").Cells(7, 2)), Int(Worksheets("tabsin").Cells(7, 3)), Int(Worksheets("tabsin").Cells(7, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("tabsin").Cells(2, 8)) = "|fffd|" Then Worksheets("tabsin").Cells(2, 8) = "|fffd|"
If Trim(Worksheets("tabsin").Cells(2, 8)) = "|fffd|" Then Worksheets("tabsin").Cells(2, 8) = "|fffd|"

If Trim(Worksheets("tabsin").Cells(2, 8)) <> "|fffd|" And Trim(Worksheets("tabsin").Cells(2, 8)) <> "|fffd|" Then
    Worksheets("tabsin").Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD1 = 0 Then
    Worksheets("tabsin").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD2 = 0 Then
    Worksheets("tabsin").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("tabsin").Cells(8, 2) <= 0 Or Worksheets("tabsin").Cells(8, 2) > 24 Then
    Worksheets("tabsin").Select
    MsgBox ("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 0 |fffd||fffd| 24 |fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD1 >= JD2 Then
    Worksheets("tabsin").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Worksheets("natal").Cells(62, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("natal").Cells(62, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("natal").Cells(62, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("natal").Cells(62, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("natal").Cells(62, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("natal").Cells(62, 7) = Worksheets("natal").Cells(2, 7)

Worksheets("natal").Cells(2, 2) = Worksheets("tabsin").Cells(2, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("tabsin").Cells(2, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("tabsin").Cells(2, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("tabsin").Cells(2, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("tabsin").Cells(2, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("tabsin").Cells(2, 7)

Call radiks

'===============================
TSTEP = Worksheets("tabsin").Cells(8, 2) / 24
JDTR = JD1
NSTEP = Int((JD2 - JD1) / TSTEP)
NTAB = Worksheets("sina").Cells(4, 2)

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Worksheets("tabsin").Select
STROK = 11
Worksheets("tabsin").Cells(3, 2) = 0

For KT = 1 To 60000
Worksheets("tabsin").Cells(3, 2) = ((JDTR - JD1) / (JD2 - JD1)) * 100 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If JDTR > JD2 Then Exit For
Worksheets("tabsin").Cells(4, 1) = STROK
Call JDvDATA(JDTR)
'Worksheets("natal").Cells(71, 8) - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(3, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(3, 6) = 0
Worksheets("natal").Cells(3, 7) = 0
Worksheets("tabsin").Cells(STROK, 2) = Worksheets("natal").Cells(3, 2)
Worksheets("tabsin").Cells(STROK, 3) = Worksheets("natal").Cells(3, 3)
Worksheets("tabsin").Cells(STROK, 4) = Worksheets("natal").Cells(3, 4)
Worksheets("tabsin").Cells(STROK, 5) = Worksheets("natal").Cells(3, 5)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
B = JDTR - Int(JDTR)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(71, 8)), B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For n% = 15 To 20
If n% = 18 Or n% = 19 Then GoTo netN
For K% = 15 To 20
If K% = 18 Or K% = 19 Then GoTo netK
    ASP = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 10))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(1, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If n% = 16 And K% = 16 And A% = 0 Then ORB = 0 '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
netK: Next K%
netN: Next n%
Worksheets("tabsin").Cells(STROK, 10) = SUM

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(2, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(17, 2), Worksheets("natal").Cells(K%, 10))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
Worksheets("tabsin").Cells(STROK, 7) = SUM
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(17, 10), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
Worksheets("tabsin").Cells(STROK, 6) = SUM

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(3, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(16, 2), Worksheets("natal").Cells(K%, 10))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
Worksheets("tabsin").Cells(STROK, 9) = SUM
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For K% = 11 To 12
    ASP = ASPECT(Worksheets("natal").Cells(16, 10), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
Next K%
Worksheets("tabsin").Cells(STROK, 8) = SUM

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("sina").Cells(7, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0
For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(11, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(12, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(14, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(12, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(14, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
Next A%
Worksheets("tabsin").Cells(STROK, 11) = SUM

If Trim(Worksheets("tabsin").Cells(2, 8)) = "|fffd|" Then ' |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    Worksheets("tabsin").Cells(STROK, 12) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11)
    SUM = 0
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
    Worksheets("tabsin").Cells(STROK, 13) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 10), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 10), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 10), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 10), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    Worksheets("tabsin").Cells(STROK, 14) = SUM

Else '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 10), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 10), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 10), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 10), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    Worksheets("tabsin").Cells(STROK, 12) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11)
    SUM = 0
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 10), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 10), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 10), Worksheets("natal").Cells(11, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 10), Worksheets("natal").Cells(15, 2)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    Next A%
    Worksheets("tabsin").Cells(STROK, 13) = SUM
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11)
    SUM = 0
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(15, 10)) '|fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(11, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB Then SUM = SUM + 1
    ASP = ASPECT(Worksheets("natal").Cells(14, 2), Worksheets("natal").Cells(15, 10)) '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
    If Abs(ASP - A%) < ORB And A% <> 0 Then SUM = SUM + 1
    Next A%
    Worksheets("tabsin").Cells(STROK, 14) = SUM

End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

JDTR = JDTR + TSTEP
STROK = STROK + 1

Next KT

'===============================

Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(62, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(62, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(62, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(62, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(62, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(62, 7)

Call radiks

End Sub
Sub kupki()

Sheets("pokupki").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Rows("11:60000").Select
Selection.ClearContents
Range("A4").Select

Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROK As Integer
Dim TSTEP As Double
Dim NSTEP As Long
Dim KT As Long
Dim B As Double
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

NTAB = Int(Worksheets("natal").Cells(4, 2))

Call DATAvJD(Int(Worksheets("pokupki").Cells(6, 2)), Int(Worksheets("pokupki").Cells(6, 3)), Int(Worksheets("pokupki").Cells(6, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("pokupki").Cells(7, 2)), Int(Worksheets("pokupki").Cells(7, 3)), Int(Worksheets("pokupki").Cells(7, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

If JD1 = 0 Then
    Worksheets("pokupki").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD2 = 0 Then
    Worksheets("pokupki").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("pokupki").Cells(8, 2) <= 0 Or Worksheets("pokupki").Cells(8, 2) > 24 Then
    Worksheets("pokupki").Select
    MsgBox ("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 0 |fffd||fffd| 24 |fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If JD1 >= JD2 Then
    Worksheets("pokupki").Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

radiks

TSTEP = Worksheets("pokupki").Cells(8, 2) / 24
JDTR = JD1
NSTEP = Int((JD2 - JD1) / TSTEP)
STROK = 11
Worksheets("pokupki").Cells(3, 2) = 0

For KT = 1 To 60000

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

Sheets("pokupki").Select
Worksheets("pokupki").Cells(3, 2) = Int(((JDTR - JD1) / (JD2 - JD1)) * 100) - 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("pokupki").Cells(3, 2) > 100 Then Worksheets("pokupki").Cells(3, 2) = 100

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

If JDTR > JD2 Then Exit For
Call JDvDATA(JDTR)
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(3, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(3, 6) = 0
Worksheets("natal").Cells(3, 7) = 0
JDTR = JDTR + (Worksheets("pokupki").Cells(9, 2) / 24)
Call JDvDATA(JDTR)
Worksheets("pokupki").Cells(STROK, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("pokupki").Cells(STROK, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("pokupki").Cells(STROK, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("pokupki").Cells(STROK, 5) = Worksheets("natal").Cells(71, 5)
JDTR = JDTR - (Worksheets("pokupki").Cells(9, 2) / 24)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
B = JDTR - Int(JDTR)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(71, 8)), B, 11, 8) ' 8 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call JDvDATA(JDTR + 1 / 48) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
B = (JDTR + 1 / 48) - Int(JDTR + 1 / 48)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(71, 8)), B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
L = Worksheets("natal").Cells((10 + NP%), 4)
Worksheets("pokupki").Cells(STROK, 2 * NP% + 4) = "+"

For KP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("orb").Cells(NTAB * 10 + NP%, 10 + KP%)


L1 = Worksheets("natal").Cells((10 + KP%), 8)
L2 = Worksheets("natal").Cells((10 + KP%), 10)

For NA% = 0 To 180 Step 90 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 90, 180
    If NA% = 0 And Int(Worksheets("orb").Cells(22, 10 + NP%)) = 0 And Int(Worksheets("orb").Cells(22, 10 + KP%)) = 0 Then GoTo netNA '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP2 - NA%) < Abs(ASP1 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("pokupki").Cells(STROK, 2 * NP% + 4) = "-"
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        If Worksheets("pokupki").Cells(STROK, 2 * NP% + 4) <> "-" Then Worksheets("pokupki").Cells(STROK, 2 * NP% + 4) = "o"
        End If
Else
End If
netNA: Next NA%
netKP: Next KP%

Worksheets("pokupki").Cells(STROK, 2 * NP% + 4) = Worksheets("pokupki").Cells(STROK, 2 * NP% + 4) + " " + Worksheets("natal").Cells((10 + NP%), 5)
Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|============================

For NP% = 1 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
L = Worksheets("natal").Cells((10 + NP%), 8)
Worksheets("pokupki").Cells(STROK, 2 * NP% + 5) = "+"

For KP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If KP% = NP% Then GoTo netKP2
ASP1 = ASPECT(Worksheets("natal").Cells(10 + NP%, 8), Worksheets("natal").Cells(10 + KP%, 8))
ASP2 = ASPECT(Worksheets("natal").Cells(10 + NP%, 10), Worksheets("natal").Cells(10 + KP%, 10))
ORB = Worksheets("orb").Cells(NTAB * 10 + NP%, 10 + KP%)

For NA% = 0 To 180 Step 90 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 90, 180
If NA% = 0 And Int(Worksheets("orb").Cells(22, 10 + NP%)) = 0 And Int(Worksheets("orb").Cells(22, 10 + KP%)) = 0 Then GoTo netNA2 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        If Abs(ASP2 - NA%) < Abs(ASP1 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("pokupki").Cells(STROK, 2 * NP% + 5) = "-"
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        If Worksheets("pokupki").Cells(STROK, 2 * NP% + 5) <> "-" Then Worksheets("pokupki").Cells(STROK, 2 * NP% + 5) = "o"
        End If
Else
End If
netNA2: Next NA%
netKP2: Next KP%

Worksheets("pokupki").Cells(STROK, 2 * NP% + 5) = Worksheets("pokupki").Cells(STROK, 2 * NP% + 5) + " " + Worksheets("natal").Cells((10 + NP%), 9)
Next NP%

JDTR = JDTR + TSTEP
STROK = STROK + 1

Next KT

Sheets("natal").Select
Range("H11:K21").Select
Selection.ClearContents
Range("A4").Select
Sheets("pokupki").Select

End Sub

Sub sinastri()

Sheets("sina").Select
    Range("B11:E34").Select
    Selection.ClearContents
    Range("J9:AZ10").Select
    Selection.ClearContents
    Range("K11:K17").Select
    Selection.ClearContents
    Range("O11:O17").Select
    Selection.ClearContents
    Range("S11:S27").Select
    Selection.ClearContents
    Range("W11:W15").Select
    Selection.ClearContents
    Range("AA11:AA15").Select
    Selection.ClearContents
    Range("AE11:AE15").Select
    Selection.ClearContents
    Range("V9:AB10").Select
    Selection.ClearContents
    Range("AI11:AI15").Select
    Selection.ClearContents
    Range("AM11:AM15").Select
    Selection.ClearContents
    Range("AS11:AS14").Select
    Selection.ClearContents
    Range("B41:H71").Select
    Selection.ClearContents
    Range("AX11:AX12").Select
    Selection.ClearContents
    Range("AZ9:BB40").Select
    Selection.ClearContents
    Range("BD11:BF40").Select
    Selection.ClearContents
    Range("AS19:AS22").Select
    Selection.ClearContents
    Range("AS25:AS30").Select
    Selection.ClearContents
    Range("A4").Select

Call proverkasin

Dim NTAB As Integer
Dim Nvar As Integer
Dim JDAY1 As Double
Dim JDAY2 As Double
Dim JDAY As Double

NTAB = Int(Worksheets("sina").Cells(4, 2))

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Nvar = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|?", 292, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
If Nvar = 7 Then MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|.")

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 2 To 7
Worksheets("natal").Cells(2, K%) = Worksheets("sina").Cells(2, K%)
Worksheets("natal").Cells(7, K%) = Worksheets("sina").Cells(7, K%)
Next K%
Call radiks
For K% = 11 To 33
Worksheets("sina").Cells(K%, 2) = Worksheets("natal").Cells(K%, 2)
Worksheets("sina").Cells(K%, 3) = Worksheets("natal").Cells(K%, 3)
Next K%
JDAY1 = Worksheets("natal").Cells(2, 9)
For K% = 1 To 11
For n% = 1 To 7
Worksheets("sina").Cells(40 + K%, n% + 1) = Worksheets("formula").Cells(10 + K%, n% + 4)
Next n%
Next K%
If Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Then
Worksheets("sina").Cells(42, 7) = 7
Worksheets("sina").Cells(42, 8) = 5
Worksheets("sina").Cells(44, 7) = 7
Worksheets("sina").Cells(44, 8) = 5
Else
End If
If Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Then
Worksheets("sina").Cells(41, 7) = 7
Worksheets("sina").Cells(41, 8) = 5
Worksheets("sina").Cells(45, 7) = 7
Worksheets("sina").Cells(45, 8) = 5
Else
End If
If Nvar = 7 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(34, 2) = Worksheets("natal").Cells(91, 2)
Worksheets("sina").Cells(34, 1) = Worksheets("natal").Cells(91, 1)
Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(34, 2) = Worksheets("natal").Cells(92, 2)
Worksheets("sina").Cells(34, 1) = Worksheets("natal").Cells(92, 1)
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 2 To 7
Worksheets("natal").Cells(2, K%) = Worksheets("sina").Cells(3, K%)
Worksheets("natal").Cells(7, K%) = Worksheets("sina").Cells(8, K%)
Next K%
Call radiks
For K% = 11 To 33
Worksheets("sina").Cells(K%, 4) = Worksheets("natal").Cells(K%, 2)
Worksheets("sina").Cells(K%, 5) = Worksheets("natal").Cells(K%, 3)
Next K%
JDAY2 = Worksheets("natal").Cells(2, 9)
For K% = 1 To 11
For n% = 1 To 7
Worksheets("sina").Cells(60 + K%, n% + 1) = Worksheets("formula").Cells(10 + K%, n% + 4)
Next n%
Next K%
If Trim(Worksheets("sina").Cells(3, 8)) = "|fffd|" Then
Worksheets("sina").Cells(62, 7) = 7
Worksheets("sina").Cells(62, 8) = 5
Worksheets("sina").Cells(64, 7) = 7
Worksheets("sina").Cells(64, 8) = 5
Else
End If
If Trim(Worksheets("sina").Cells(3, 8)) = "|fffd|" Then
Worksheets("sina").Cells(61, 7) = 7
Worksheets("sina").Cells(61, 8) = 5
Worksheets("sina").Cells(65, 7) = 7
Worksheets("sina").Cells(65, 8) = 5
Else
End If
If Nvar = 7 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(34, 4) = Worksheets("natal").Cells(91, 2)
Worksheets("sina").Cells(34, 1) = Worksheets("natal").Cells(91, 1)
Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(34, 4) = Worksheets("natal").Cells(92, 2)
Worksheets("sina").Cells(34, 1) = Worksheets("natal").Cells(92, 1)
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
If JDAY1 > JDAY2 Then
JDAY = JDAY2 + (JDAY1 - JDAY2) / 2
Else
JDAY = JDAY1 + (JDAY2 - JDAY1) / 2
End If
Worksheets("sina").Cells(4, 60) = JDAY
Call JDvDATA(JDAY)
Worksheets("sina").Cells(3, 59) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(3, 60) = Worksheets("natal").Cells(71, 3)
Worksheets("sina").Cells(3, 61) = Worksheets("natal").Cells(71, 4)
Worksheets("sina").Cells(3, 62) = Worksheets("natal").Cells(71, 5)
Worksheets("sina").Cells(3, 63) = Worksheets("natal").Cells(71, 6)
Worksheets("sina").Cells(3, 64) = Worksheets("natal").Cells(71, 7)

'===== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ========
Dim SUM As Integer
Dim SUM1 As Integer
Dim SUM2 As Integer
Dim STROK As Integer
Dim ORB As Double
Dim ASP As Double

Worksheets("sina").Cells(9, 10) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 18) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 19) = "+"
Worksheets("sina").Cells(9, 14) = Trim(Worksheets("sina").Cells(3, 1))
Worksheets("sina").Cells(9, 20) = Trim(Worksheets("sina").Cells(3, 1))

Worksheets("sina").Cells(9, 22) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 23) = "+"
Worksheets("sina").Cells(9, 24) = Trim(Worksheets("sina").Cells(3, 1))

Worksheets("sina").Cells(9, 26) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 27) = "+"
Worksheets("sina").Cells(9, 28) = Trim(Worksheets("sina").Cells(3, 1))

Worksheets("sina").Cells(9, 38) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 39) = "+"
Worksheets("sina").Cells(9, 40) = Trim(Worksheets("sina").Cells(3, 1))

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 2 To 4 Step 2
Worksheets("sina").Cells(11, K% + 4) = Worksheets("sina").Cells(15, K%)
Worksheets("sina").Cells(12, K% + 4) = Worksheets("sina").Cells(16, K%)
Worksheets("sina").Cells(13, K% + 4) = Worksheets("sina").Cells(17, K%)
Worksheets("sina").Cells(14, K% + 4) = Worksheets("sina").Cells(20, K%)
Next K%

STROK = 10
NTAB = Worksheets("sina").Cells(4, 2)
SUM = 0

For n% = 1 To 3
For K% = (n% + 1) To 4
ORB = Worksheets("sina").Cells(1, 11)
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(10 + n%, 6), Worksheets("sina").Cells(10 + K%, 6))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 11) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
Next n%
Worksheets("sina").Cells(17, 11) = SUM
Worksheets("sina").Cells(10, 10) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
If SUM = 0 Then Worksheets("sina").Cells(10, 12) = "|fffd||fffd||fffd|"
If SUM = 1 Then Worksheets("sina").Cells(10, 12) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM = 2 Then Worksheets("sina").Cells(10, 12) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM >= 3 Then Worksheets("sina").Cells(10, 12) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

STROK = 10
SUM = 0

For n% = 1 To 3
For K% = (n% + 1) To 4
ORB = Worksheets("sina").Cells(1, 11)
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(10 + n%, 8), Worksheets("sina").Cells(10 + K%, 8))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 15) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
Next n%
Worksheets("sina").Cells(17, 15) = SUM
Worksheets("sina").Cells(10, 14) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
If SUM = 0 Then Worksheets("sina").Cells(10, 16) = "|fffd||fffd||fffd|"
If SUM = 1 Then Worksheets("sina").Cells(10, 16) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM = 2 Then Worksheets("sina").Cells(10, 16) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM >= 3 Then Worksheets("sina").Cells(10, 16) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

STROK = 10
SUM = 0
For n% = 1 To 4
For K% = 1 To 4
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(10 + n%, 6), Worksheets("sina").Cells(10 + K%, 8))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(1, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If n% = 2 And K% = 2 And A% = 0 Then ORB = 0 '|fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 19) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
Next n%
Worksheets("sina").Cells(27, 19) = SUM
Worksheets("sina").Cells(10, 18) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
If SUM = 0 Then Worksheets("sina").Cells(10, 20) = "|fffd||fffd||fffd|"
If SUM = 1 Then Worksheets("sina").Cells(10, 20) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM = 2 Then Worksheets("sina").Cells(10, 20) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM >= 3 Then Worksheets("sina").Cells(10, 20) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
STROK = 10
SUM = 0
ORB = Worksheets("sina").Cells(2, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To 12
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(17, 2), Worksheets("sina").Cells(K%, 4))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 23) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
For K% = 11 To 12
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(17, 4), Worksheets("sina").Cells(K%, 2))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 23) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
If SUM > 0 Then Worksheets("sina").Cells(15, 23) = SUM
Worksheets("sina").Cells(10, 22) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
If SUM = 0 Then Worksheets("sina").Cells(10, 24) = "|fffd||fffd||fffd|"
If SUM > 0 Then Worksheets("sina").Cells(10, 24) = "|fffd||fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
STROK = 10
SUM = 0
ORB = Worksheets("sina").Cells(3, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To 12
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(16, 2), Worksheets("sina").Cells(K%, 4))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 27) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
For K% = 11 To 12
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(16, 4), Worksheets("sina").Cells(K%, 2))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 27) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
If SUM > 0 Then Worksheets("sina").Cells(15, 27) = SUM
Worksheets("sina").Cells(10, 26) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
If SUM = 0 Then Worksheets("sina").Cells(10, 28) = "|fffd||fffd||fffd|"
If SUM > 0 Then Worksheets("sina").Cells(10, 28) = "|fffd||fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
STROK = 11
SUM = 0
ORB = Worksheets("sina").Cells(7, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ASP = ASPECT(Worksheets("sina").Cells(11, 2), Worksheets("sina").Cells(11, 4))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 39) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
For n% = 12 To 14 Step 2
For K% = 12 To 14 Step 2
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(n%, 2), Worksheets("sina").Cells(K%, 4))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 39) = A% + 1 / 100
        SUM = SUM + 1
        Else
        End If
    Next A%
Next K%
Next n%
If SUM > 0 Then Worksheets("sina").Cells(10, 39) = "|fffd||fffd||fffd||fffd|"
If SUM = 0 Then Worksheets("sina").Cells(10, 39) = "|fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(9, 47) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 48) = "|fffd|"
Worksheets("sina").Cells(9, 49) = Trim(Worksheets("sina").Cells(3, 1))
Worksheets("sina").Cells(9, 50) = "Sum"

Dim Lasp As Double
STROK = 41

For n% = 1 To 11
For K% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("sina").Cells(10 + n%, 2), Worksheets("sina").Cells(10 + K%, 4))
For A% = 0 To 180 Step 90
ORB = Worksheets("ORB").Cells(NTAB * 10 + n%, 10 + K%)
If Abs(Lasp - A%) < ORB Then
    For NN% = 1 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For KK% = 1 To 7
    
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 1 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 8 Then
    Worksheets("sina").Cells(11, 50) = Worksheets("sina").Cells(11, 50) + 1
    Worksheets("sina").Cells(STROK, 47) = Worksheets("sina").Cells(40 + n%, 1)
    Worksheets("sina").Cells(STROK, 48) = A%
    Worksheets("sina").Cells(STROK, 49) = Worksheets("sina").Cells(60 + K%, 1)
    STROK = STROK + 1
    Else
    End If
    
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 10 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 8 Then
    Worksheets("sina").Cells(11, 50) = Worksheets("sina").Cells(11, 50) + 1
    Worksheets("sina").Cells(STROK, 47) = Worksheets("sina").Cells(40 + n%, 1)
    Worksheets("sina").Cells(STROK, 48) = A%
    Worksheets("sina").Cells(STROK, 49) = Worksheets("sina").Cells(60 + K%, 1)
    STROK = STROK + 1
    Else
    End If
    
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 8 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 1 Then
    Worksheets("sina").Cells(12, 50) = Worksheets("sina").Cells(12, 50) + 1
    Worksheets("sina").Cells(STROK, 47) = Worksheets("sina").Cells(40 + n%, 1)
    Worksheets("sina").Cells(STROK, 48) = A%
    Worksheets("sina").Cells(STROK, 49) = Worksheets("sina").Cells(60 + K%, 1)
    STROK = STROK + 1
    Else
    End If
    
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 8 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 10 Then
    Worksheets("sina").Cells(12, 50) = Worksheets("sina").Cells(12, 50) + 1
    Worksheets("sina").Cells(STROK, 47) = Worksheets("sina").Cells(40 + n%, 1)
    Worksheets("sina").Cells(STROK, 48) = A%
    Worksheets("sina").Cells(STROK, 49) = Worksheets("sina").Cells(60 + K%, 1)
    STROK = STROK + 1
    Else
    End If
    
    Next KK%
    Next NN%
Else
End If

Next A%
Next K%
Next n%

'=========================== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(9, 52) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 53) = "|fffd|"
Worksheets("sina").Cells(9, 54) = Trim(Worksheets("sina").Cells(3, 1))
STROK = 10

For K% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("sina").Cells(21, 2), Worksheets("sina").Cells(10 + K%, 4))
ORB = Worksheets("ORB").Cells(NTAB * 10 + 11, 10 + K%)
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netuA
    If Abs(Lasp - A%) < ORB Then '|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    STROK = STROK + 1
    Worksheets("sina").Cells(STROK, 52) = "|fffd||fffd||fffd||fffd||fffd|"
    Worksheets("sina").Cells(STROK, 53) = A%
    Worksheets("sina").Cells(STROK, 54) = Worksheets("sina").Cells(10 + K%, 1)
    Else
    End If
netuA: Next A%
Next K%

For K% = 1 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("sina").Cells(21, 4), Worksheets("sina").Cells(10 + K%, 2))
ORB = Worksheets("ORB").Cells(NTAB * 10 + 11, 10 + K%)
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netuuA
    If Abs(Lasp - A%) < ORB Then '|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    STROK = STROK + 1
    Worksheets("sina").Cells(STROK, 54) = "|fffd||fffd||fffd||fffd||fffd|"
    Worksheets("sina").Cells(STROK, 53) = A%
    Worksheets("sina").Cells(STROK, 52) = Worksheets("sina").Cells(10 + K%, 1)
    Else
    End If
netuuA: Next A%
Next K%

'=================== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(9, 56) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 57) = "|fffd|"
Worksheets("sina").Cells(9, 58) = Trim(Worksheets("sina").Cells(3, 1))
STROK = 10

For K% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("sina").Cells(34, 2), Worksheets("sina").Cells(10 + K%, 4))
ORB = Worksheets("ORB").Cells(NTAB * 10 + 11, 10 + K%)
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo notuA
    If Abs(Lasp - A%) < ORB Then '|fffd|.|fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    STROK = STROK + 1
    Worksheets("sina").Cells(STROK, 56) = "|fffd|.|fffd||fffd||fffd||fffd|"
    Worksheets("sina").Cells(STROK, 57) = A%
    Worksheets("sina").Cells(STROK, 58) = Worksheets("sina").Cells(10 + K%, 1)
    Else
    End If
notuA: Next A%
Next K%

For K% = 1 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("sina").Cells(34, 4), Worksheets("sina").Cells(10 + K%, 2))
ORB = Worksheets("ORB").Cells(NTAB * 10 + 11, 10 + K%)
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo notuuA
    If Abs(Lasp - A%) < ORB Then '|fffd|.|fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    STROK = STROK + 1
    Worksheets("sina").Cells(STROK, 58) = "|fffd|.|fffd||fffd||fffd||fffd|"
    Worksheets("sina").Cells(STROK, 57) = A%
    Worksheets("sina").Cells(STROK, 56) = Worksheets("sina").Cells(10 + K%, 1)
    Else
    End If
notuuA: Next A%
Next K%

Worksheets("sina").Cells(17, 42) = Worksheets("sina").Cells(2, 1)
Worksheets("sina").Cells(17, 44) = Worksheets("sina").Cells(3, 1)
Worksheets("sina").Cells(23, 42) = Worksheets("sina").Cells(2, 1)
Worksheets("sina").Cells(23, 44) = Worksheets("sina").Cells(3, 1)

If Trim(Worksheets("sina").Cells(2, 8)) = Trim(Worksheets("sina").Cells(3, 8)) Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Sheets("sina").Select
ActiveWindow.ScrollColumn = 10
End
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'=========================================================================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(9, 30) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 31) = "+"
Worksheets("sina").Cells(9, 32) = Trim(Worksheets("sina").Cells(3, 1))
'|fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
STROK = 10
SUM1 = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM2 = 0 '|fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 12 To 14 Step 2
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(11, 4), Worksheets("sina").Cells(K%, 2))
    For A% = 90 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 31) = A% + 1 / 100
        SUM1 = SUM1 + 1
        Else
        End If
    Next A%
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 31) = A% + 1 / 100
        SUM2 = SUM2 + 1
        Else
        End If
    Next A%
Next K%
For K% = 12 To 14 Step 2
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(15, 4), Worksheets("sina").Cells(K%, 2))
    For A% = 0 To 180 Step 90 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(4, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 31) = A% + 1 / 100
        SUM1 = SUM1 + 1
        Else
        End If
    Next A%
    For A% = 60 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(5, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 31) = A% + 1 / 100
        SUM2 = SUM2 + 1
        Else
        End If
    Next A%
Next K%
If SUM1 = 0 And SUM2 = 0 Then Worksheets("sina").Cells(10, 31) = "|fffd||fffd||fffd|"
If SUM1 > 0 And SUM2 = 0 Then Worksheets("sina").Cells(10, 30) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM2 > 0 And SUM1 = 0 Then Worksheets("sina").Cells(10, 30) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If SUM2 > 0 And SUM1 > 0 Then
Worksheets("sina").Cells(10, 30) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("sina").Cells(10, 31) = "|fffd|"
Worksheets("sina").Cells(10, 32) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(9, 34) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 35) = "+"
Worksheets("sina").Cells(9, 36) = Trim(Worksheets("sina").Cells(3, 1))
'|fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
STROK = 10
SUM1 = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM2 = 0 '|fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 12 To 14 Step 2
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(11, 2), Worksheets("sina").Cells(K%, 4))
    For A% = 0 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 35) = A% + 1 / 100
        SUM2 = SUM2 + 1
        Else
        End If
    Next A%
Next K%
For K% = 12 To 14 Step 2
STROK = STROK + 1
ASP = ASPECT(Worksheets("sina").Cells(15, 2), Worksheets("sina").Cells(K%, 4))
    For A% = 60 To 120 Step 60 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("sina").Cells(6, 11) '|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Abs(ASP - A%) < ORB Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("sina").Cells(STROK, 35) = A% + 1 / 100
        SUM2 = SUM2 + 1
        Else
        End If
    Next A%
Next K%
If SUM2 > 0 Then Worksheets("sina").Cells(10, 35) = "|fffd||fffd||fffd||fffd|"
If SUM2 = 0 Then Worksheets("sina").Cells(10, 35) = "|fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("sina").Cells(9, 42) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(9, 43) = "|fffd|"
Worksheets("sina").Cells(9, 44) = Trim(Worksheets("sina").Cells(3, 1))
Worksheets("sina").Cells(9, 45) = "Sum"

For n% = 1 To 11
For K% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("sina").Cells(10 + n%, 2), Worksheets("sina").Cells(10 + K%, 4))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netA

        If A% = 0 Or A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("ORB").Cells(NTAB * 10 + n%, 10 + K%)
If Abs(Lasp - A%) < ORB Then
    For NN% = 1 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For KK% = 1 To 7
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 5 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 7 Then Worksheets("sina").Cells(11, 45) = Worksheets("sina").Cells(11, 45) + 1
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 7 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 5 Then Worksheets("sina").Cells(13, 45) = Worksheets("sina").Cells(13, 45) + 1
    Next KK%
    Next NN%
Else
End If

        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("ORB").Cells(NTAB * 10 + n%, 10 + K%)
If Abs(Lasp - A%) < ORB Then
    For NN% = 1 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For KK% = 1 To 7
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 5 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 7 Then Worksheets("sina").Cells(12, 45) = Worksheets("sina").Cells(12, 45) + 1
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 7 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 5 Then Worksheets("sina").Cells(14, 45) = Worksheets("sina").Cells(14, 45) + 1
    Next KK%
    Next NN%
Else
End If

        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        
'======== |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ========================

        If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("ORB").Cells(NTAB * 10 + n%, 10 + K%)
If Abs(Lasp - A%) < ORB Then
    For NN% = 1 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For KK% = 1 To 7
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 5 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 8 Then Worksheets("sina").Cells(19, 45) = Worksheets("sina").Cells(19, 45) + 1
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 8 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 5 Then Worksheets("sina").Cells(20, 45) = Worksheets("sina").Cells(20, 45) + 1
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 7 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 8 Then Worksheets("sina").Cells(25, 45) = Worksheets("sina").Cells(25, 45) + 1
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 8 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 7 Then Worksheets("sina").Cells(26, 45) = Worksheets("sina").Cells(26, 45) + 1
    Next KK%
    Next NN%
Else
End If
        
'======== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ========================

        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ORB = Worksheets("ORB").Cells(NTAB * 10 + n%, 10 + K%)
If Abs(Lasp - A%) < ORB Then
    For NN% = 1 To 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For KK% = 1 To 7
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 7 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 8 Then Worksheets("sina").Cells(27, 45) = Worksheets("sina").Cells(27, 45) + 1
    If Int(Worksheets("sina").Cells(40 + n%, 1 + NN%)) = 8 And Int(Worksheets("sina").Cells(60 + K%, 1 + KK%)) = 7 Then Worksheets("sina").Cells(28, 45) = Worksheets("sina").Cells(28, 45) + 1
    Next KK%
    Next NN%
Else
End If

        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        
netA: Next A%
Next K%
Next n%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With
Sheets("sina").Select
ActiveWindow.ScrollColumn = 10

End Sub
Sub horar()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Sheets("horar").Select
    Range("E11:AB21").Select
    Selection.ClearContents
    Range("E31:BB54").Select
    Selection.ClearContents
    Rows("61:391").Select
    Selection.ClearContents
    Range("E501:ER513").Select
    Selection.ClearContents
    
    Sheets("natal").Select
    Range("B1:G2").Select
    Selection.Copy
    Sheets("horar").Select
    Range("B1:G2").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Sheets("natal").Select
    Range("B5:G7").Select
    Selection.Copy
    Sheets("horar").Select
    Range("B5:G7").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

    Range("A2").Select
    
        Sheets("MP").Select
    Range("E11:BZ33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 26
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER512").Select
    Selection.ClearContents
    Range("E521:ER532").Select
    Selection.ClearContents
    Range("E541:ER552").Select
    Selection.ClearContents
    Range("E561:ER572").Select
    Selection.ClearContents
    Range("A9").Select
    
    Sheets("BP").Select
    Range("E11:BZ33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 31
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER512").Select
    Selection.ClearContents
    Range("E521:ER532").Select
    Selection.ClearContents
    Range("E541:ER552").Select
    Selection.ClearContents
    Range("E561:ER572").Select
    Selection.ClearContents
    Range("A9").Select
        
    Sheets("TR").Select
    Range("E11:BZ21").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 9
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER512").Select
    Selection.ClearContents
    Range("E521:ER532").Select
    Selection.ClearContents
    Range("E541:ER552").Select
    Selection.ClearContents
    Range("E561:ER572").Select
    Selection.ClearContents
    Range("A9").Select
    
    Sheets("natal").Select
    Range("B11:II33").Select
    Selection.ClearContents
    With Selection.Font
        .ColorIndex = xlAutomatic
    End With
    ActiveWindow.ScrollColumn = 217
    ActiveWindow.ScrollColumn = 12
    Range("A9").Select

    Sheets("opis").Select
    Rows("4:125").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 4
    Range("A4").Select
    
    Sheets("PROFI").Select
    Rows("11:200").Select
    Selection.ClearContents
    Range("A11").Select
    
    Sheets("List").Select
    Rows("11:4000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("MP").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("BP").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("TR").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("dom").Select
    Range("K11:BF23").Select
    Selection.ClearContents
    Range("K31:BF43").Select
    Selection.ClearContents
    Range("K51:BF63").Select
    Selection.ClearContents
    Range("K71:DZ81").Select
    Selection.ClearContents
    Range("K91:DZ101").Select
    Selection.ClearContents
    Range("K111:DZ121").Select
    Selection.ClearContents
    Range("A2").Select
Worksheets("formula").Select
Range("E11:AD21").Select
Selection.ClearContents
Range("E11:AF21").Select
Selection.ClearContents
Range("A2").Select

Sheets("orb").Select
Range("AE11:AO21").Select
Selection.ClearContents
Range("AC10").Select

 
Sheets("dom").Select
    Range("K201:BF213").Select
    Selection.ClearContents
    Range("K221:BF233").Select
    Selection.ClearContents
    Range("K241:BF253").Select
    Selection.ClearContents
    Range("A4").Select
    Sheets("natal").Select
    Range("A4").Select

Worksheets("natal").Cells(10, 10) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
Worksheets("natal").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Range("B11:K33").Select
Selection.ClearContents
Range("A10").Select

Dim B As Double
Dim JDNN As Long
Dim KK As Long
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Call radiks
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|

JDTR = Worksheets("natal").Cells(2, 9)
JDTR = JDTR + 1 / 48 '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Call JDvDATA(JDTR)
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(3, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(3, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(3, 7) = Worksheets("natal").Cells(71, 7)
Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
B = Worksheets("natal").Cells(3, 9) - Int(Worksheets("natal").Cells(3, 9))
Call planets(JDNN, B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 2) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call uprav(2, 3, 6) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 3 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Call elementsort(5, 11) '5-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 11-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Dim NDOM1 As Integer
Dim NDOM2 As Integer
Dim STRLIST As Integer

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 5 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("formula").Cells(n%, K%)
If NDOM1 = 0 Then GoTo netNDom1

For M% = (K% + 1) To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| k-|fffd|
NDOM2 = Worksheets("formula").Cells(n%, M%)

If NDOM2 = 0 Then GoTo netNDom2

If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
        End If
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
        End If
End If

netNDom2: Next M%
netNDom1: Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
STRLIST = 61
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NTAB = Worksheets("natal").Cells(4, 2)

For n% = 11 To 21
For M% = 5 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("horar").Cells(n%, M%) = Worksheets("formula").Cells(n%, M%)
Next M%
Next n%

For n% = 11 To 20 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|

For K% = (n% + 1) To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 2))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netA
If Abs(Lasp - A%) >= Worksheets("orb").Cells((NTAB * 10 + (K% - 10)), n%) Then GoTo netA
Lasp2 = ASPECT(Worksheets("natal").Cells(n%, 10), Worksheets("natal").Cells(K%, 10))

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("horar").Cells(STRLIST, 1) = Worksheets("natal").Cells(n%, 1)
Worksheets("horar").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells(K%, 1)
Worksheets("horar").Cells((STRLIST + 1), 2) = (A% + 1 / 100)
Worksheets("horar").Cells((STRLIST + 1), 3) = Abs(Lasp - A%)
For M% = 5 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("horar").Cells(STRLIST, M%) = Worksheets("horar").Cells(n%, M%)
Worksheets("horar").Cells((STRLIST + 2), M%) = Worksheets("horar").Cells(K%, M%)
Next M%
If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then
Worksheets("horar").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Else
Worksheets("horar").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
End If
STRLIST = STRLIST + 4

If A% = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netm
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netI
        
 If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
    If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
    If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
        End If
Else '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("horar").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
    If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
        Else
    Worksheets("horar").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
    If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
        End If
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

netI:   Next i%
netm:   Next M%

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMM
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netII
        
            If NDOM1 <= NDOM2 Then
       Worksheets("horar").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
       If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("horar").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
            Else
       Worksheets("horar").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
       If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("horar").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
            End If
netII:   Next i%
netMM:   Next M%

    Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMMM
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netIII
        
            If NDOM1 <= NDOM2 Then
        Worksheets("horar").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
        If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("horar").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
            Else
        Worksheets("horar").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
        If Abs(Lasp - A%) >= Abs(Lasp2 - A%) Then Worksheets("horar").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("horar").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
            End If
netIII:   Next i%
netMMM:   Next M%
    End If
End If

netA: Next A%
Next K%
Next n%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

Sheets("horar").Select
    Range("A4").Select

End Sub
Sub karma()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Call radiks

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    Sheets("MP").Select
    Range("E11:BZ33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 26
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER513").Select
    Selection.ClearContents
    Range("E521:ER533").Select
    Selection.ClearContents
    Range("E541:ER553").Select
    Selection.ClearContents
    Range("E561:ER573").Select
    Selection.ClearContents
    Range("E581:ER593").Select
    Selection.ClearContents
    Range("E601:ER613").Select
    Selection.ClearContents
    Range("E621:ER633").Select
    Range("E641:ER653").Select
    Selection.ClearContents
    Range("E701:GN713").Select
    Selection.ClearContents
    Range("E721:GN733").Select
    Selection.ClearContents
    Range("E741:GN753").Select
    Selection.ClearContents
    Range("E761:GN773").Select
    Selection.ClearContents
    Range("A9").Select
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Select
Range("E31:AN54").Select
Selection.ClearContents
Range("C30").Select
    
    Sheets("BP").Select
    Range("E11:BZ33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 31
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER513").Select
    Selection.ClearContents
    Range("E521:ER533").Select
    Selection.ClearContents
    Range("E541:ER553").Select
    Selection.ClearContents
    Range("E561:ER573").Select
    Selection.ClearContents
    Range("E701:GN713").Select
    Selection.ClearContents
    Range("E721:GN733").Select
    Selection.ClearContents
    Range("E741:GN753").Select
    Selection.ClearContents
    Range("E761:GN773").Select
    Selection.ClearContents
    Range("A9").Select
        
    Sheets("TR").Select
    Range("E11:BZ21").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 9
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER513").Select
    Selection.ClearContents
    Range("E521:ER533").Select
    Selection.ClearContents
    Range("E541:ER553").Select
    Selection.ClearContents
    Range("E561:ER573").Select
    Selection.ClearContents
    Range("E701:GN713").Select
    Selection.ClearContents
    Range("E721:GN733").Select
    Selection.ClearContents
    Range("E741:GN753").Select
    Selection.ClearContents
    Range("E761:GN773").Select
    Selection.ClearContents
    Range("A9").Select
    
    Sheets("opis").Select
    Rows("4:125").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 4
    Range("A4").Select
    
    Sheets("PROFI").Select   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("A11:E200").Select
    Selection.ClearContents
    Range("A10").Select
 
    Sheets("List").Select
    Rows("11:4000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("MP").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("BP").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("TR").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("dom").Select
    Range("K11:BF23").Select
    Selection.ClearContents
    Range("K31:BF43").Select
    Selection.ClearContents
    Range("K51:BF63").Select
    Selection.ClearContents
    Range("K71:DZ81").Select
    Selection.ClearContents
    Range("K91:DZ101").Select
    Selection.ClearContents
    Range("K111:DZ121").Select
    Selection.ClearContents
    Range("A2").Select
    
Worksheets("formula").Select
Range("E11:AD21").Select
Selection.ClearContents
Range("E11:AF21").Select
Selection.ClearContents
Range("E31:AN54").Select
Selection.ClearContents
Range("A2").Select
    
Sheets("dom").Select
    Range("K201:BF213").Select
    Selection.ClearContents
    Range("K221:BF233").Select
    Selection.ClearContents
    Range("K241:BF253").Select
    Selection.ClearContents
    Range("A4").Select
    Sheets("natal").Select
    Range("A4").Select

Worksheets("natal").Cells(10, 2) = "|fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd|"
Worksheets("natal").Cells(10, 4) = "|fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd|"
Worksheets("natal").Cells(10, 6) = ""
Worksheets("natal").Cells(10, 8) = ""
Worksheets("natal").Cells(10, 10) = ""
Worksheets("formula").Cells(10, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(10, 12) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(29, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(29, 17) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("List").Cells(8, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("List").Cells(8, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(9, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(29, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(199, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(219, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("opis").Cells(2, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("opis").Cells(2, 4) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("PROFI").Cells(10, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("PROFI").Cells(10, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    
Dim B As Double
Dim JDNN As Long
Dim KK As Long
Dim LatGrad As Double
Dim LG As Double
Dim X As Double
Dim PP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim UZEL As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd||fffd||fffd||fffd|
Dim Nvar As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|

Call DATAvJD(Int(Worksheets("natal").Cells(2, 2)), Int(Worksheets("natal").Cells(2, 3)), Int(Worksheets("natal").Cells(2, 4)), Int(Worksheets("natal").Cells(2, 5)), Int(Worksheets("natal").Cells(2, 6)), Int(Worksheets("natal").Cells(2, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(2, 11) = JDNN
Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
B = Worksheets("natal").Cells(2, 9) - Int(Worksheets("natal").Cells(2, 9))

Nvar = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|?", 292, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")

Worksheets("natal").Cells(22, 7) = "|fffd|.|fffd||fffd||fffd||fffd|"

If Nvar = 7 Then ' |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|.")
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim T1 As Double
Dim T2 As Double
T1 = Worksheets("natal").Cells(JDNN, 32)
T2 = Worksheets("natal").Cells(JDNN + 1, 32)
    If Abs(T2 - T1) < 20 Then Worksheets("natal").Cells(22, 6) = T1 + (T2 - T1) * B '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    If Abs(T2 - T1) > 180 And T2 < T1 Then  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        Worksheets("natal").Cells(22, 6) = T1 + B * ASPECT(T2, T1)
        If Worksheets("natal").Cells(22, 6) >= 360 Then Worksheets("natal").Cells(22, 6) = Worksheets("natal").Cells(22, 6) - 360
    Else
    End If
    If Abs(T2 - T1) > 180 And T2 > T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(22, 6) = T1 - B * ASPECT(T2, T1)
    If Worksheets("natal").Cells(22, 6) < 0 Then Worksheets("natal").Cells(22, 6) = Worksheets("natal").Cells(22, 6) + 360
    Else
    End If
UZEL = Worksheets("natal").Cells(22, 6)

Else ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|.

MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|.")
UZEL = 259.18305555 - (360 * (Worksheets("natal").Cells(2, 9) - 2415020)) / (365.25 * 18.6129265)
If UZEL < 0 Then UZEL = UZEL + 360 * (Int(Abs(UZEL) / 360))
If UZEL < 0 Then UZEL = UZEL + 360
If UZEL < 0 Then UZEL = UZEL + 360
Worksheets("natal").Cells(22, 6) = UZEL

End If

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = Worksheets("natal").Cells(35, 6)
ZV = Worksheets("natal").Cells(31, 2)

mnatal: '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.
ZV = ZV + ASPECT(UZEL, Worksheets("natal").Cells(22, 2)) / 6
If ZV > 360 Then ZV = ZV - 360
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 2) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(2, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%
If ASPECT(UZEL, Worksheets("natal").Cells(22, 2)) >= (1 / 50000) Then GoTo mnatal

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = Worksheets("natal").Cells(36, 6)
ZV = Worksheets("natal").Cells(31, 4)

mlocal: '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.
ZV = ZV + ASPECT(UZEL, Worksheets("natal").Cells(22, 4)) / 6
If ZV > 360 Then ZV = ZV - 360
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 4) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(2, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%
If ASPECT(UZEL, Worksheets("natal").Cells(22, 4)) >= (1 / 50000) Then GoTo mlocal

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 2) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call uprav(2, 3, 6) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 3 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call uprav(4, 5, 13) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 5 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|


'=======|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ================

Sheets("natal").Select
Range("A1:G8").Select
Selection.Copy
Sheets("formula").Select
Range("A1:G8").Select
ActiveSheet.Paste
Range("A30").Select
    Sheets("natal").Select
    Range("B2:D2").Select
    Selection.Copy
    Sheets("List").Select
    Range("B2:D2").Select
    ActiveSheet.Paste
    Range("A11:U1000").Select
    Selection.ClearContents
    Range("A8:D8").Select

Dim STROKN As Long
Dim STROKL As Long
Dim STROKNL As Long
STROKN = 11
STROKL = 11
STROKNL = 11

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 5 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("formula").Cells(n%, K%)
If NDOM1 = 0 Then GoTo netNDom1
Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|

For M% = (K% + 1) To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| k-|fffd|
NDOM2 = Worksheets("formula").Cells(n%, M%)
If NDOM2 = 0 Then GoTo netNDom2
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If

If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
    Call polozenie(STROKN, n%, K%, M%, 1, "#")
    STROKN = STROKN + 1
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
    Call polozenie(STROKN, n%, K%, M%, 1, "#")
    STROKN = STROKN + 1
        End If
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
    Call polozenie(STROKN, n%, K%, M%, 1, "&")
    STROKN = STROKN + 1
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
    Call polozenie(STROKN, n%, K%, M%, 1, "&")
    STROKN = STROKN + 1
        End If
End If

netNDom2: Next M%
netNDom1: Next K%

For K% = 12 To 17 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("formula").Cells(n%, K%)
If NDOM1 = 0 Then GoTo netNDom11
Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|

For M% = (K% + 1) To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| k-|fffd|
NDOM2 = Worksheets("formula").Cells(n%, M%)
If NDOM2 = 0 Then GoTo netNDom22
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If

If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
    Call polozenie(STROKL, n%, K%, M%, 8, "#")
    STROKL = STROKL + 1
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
    Call polozenie(STROKL, n%, K%, M%, 8, "#")
    STROKL = STROKL + 1
        End If
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
    Call polozenie(STROKL, n%, K%, M%, 8, "&")
    STROKL = STROKL + 1
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
    Call polozenie(STROKL, n%, K%, M%, 8, "&")
    STROKL = STROKL + 1
        End If
End If

netNDom22: Next M%
netNDom11: Next K%

Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NTAB = Worksheets("natal").Cells(4, 2)

For n% = 11 To 20 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 5 To 11
Worksheets("dom").Cells((n% + 60), (M% + 6)) = Worksheets("formula").Cells(n%, M%)
Worksheets("dom").Cells(81, (M% + 6)) = Worksheets("formula").Cells(21, M%)
Next M%

For K% = (n% + 1) To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 2))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netA
If Abs(Lasp - A%) >= Worksheets("orb").Cells((NTAB * 10 + (K% - 10)), n%) Then GoTo netA

If A% = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("orb").Cells(K%, (n% + 20)) = 1

For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((n% + 60), 10 * (K% - 10) + (M% + 6)) = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((K% + 60), 10 * (n% - 10) + (M% + 6)) = Worksheets("formula").Cells(n%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((190 + K%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + K%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
Next M%
        
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netm
        
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netI
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If
        
 If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
    Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "#")
    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
    STROKN = STROKN + 1
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
    Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "#")
    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
    STROKN = STROKN + 1
        End If
Else '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
    Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "&")
    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
    STROKN = STROKN + 1
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
    Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "&")
    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
    STROKN = STROKN + 1
        End If
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

netI:   Next i%
netm:   Next M%

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("orb").Cells(K%, (n% + 20)) = A%
    
    If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 5 To 11
Worksheets("dom").Cells((n% + 60), 10 * (K% - 10) + (M% + 6)) = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((K% + 60), 10 * (n% - 10) + (M% + 6)) = Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((190 + K%), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + K%), (7 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((190 + n%), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((190 + n%), (7 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%
        
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMM
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netII
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (7 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) + 1
    End If
    
            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
            Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "&")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
            Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "&")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
netII:   Next i%
netMM:   Next M%

    Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 5 To 11
    Worksheets("dom").Cells((n% + 60), 10 * (K% - 10) + (M% + 6)) = 0 - Worksheets("formula").Cells(K%, M%)
    Worksheets("dom").Cells((K% + 60), 10 * (n% - 10) + (M% + 6)) = 0 - Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((190 + K%), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + K%), (8 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((190 + n%), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((190 + n%), (8 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%
    
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMMM
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netIII
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (8 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) + 1
    End If

            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
            Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "#")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
            Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "#")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
netIII:   Next i%
netMMM:   Next M%
    End If
End If

netA: Next A%
Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 12 To 18
Worksheets("dom").Cells((n% + 80), (M% - 1)) = Worksheets("formula").Cells(n%, M%)
Worksheets("dom").Cells(101, (M% - 1)) = Worksheets("formula").Cells(21, M%)
Next M%

For K% = (n% + 1) To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 2))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo net_A
If Abs(Lasp - A%) >= Worksheets("orb").Cells((NTAB * 10 + (K% - 10)), n%) Then GoTo net_A
If A% = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 12 To 18
Worksheets("dom").Cells((n% + 80), 10 * (K% - 10) + (M% - 1)) = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((K% + 80), 10 * (n% - 10) + (M% - 1)) = Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((210 + K%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + K%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
Next M%
        
        For M% = 12 To 18
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo net_M
        For i% = 12 To 18
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo net_I
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If
        
 If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
    Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "#")
    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
    STROKL = STROKL + 1
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
    Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "#")
    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
    STROKL = STROKL + 1
        End If
Else '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
    Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "&")
    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
    STROKL = STROKL + 1
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
    Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "&")
    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
    STROKL = STROKL + 1
        End If
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
net_I:   Next i%
net_M:   Next M%

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 12 To 18
    Worksheets("dom").Cells((n% + 80), 10 * (K% - 10) + (M% - 1)) = Worksheets("formula").Cells(K%, M%)
    Worksheets("dom").Cells((K% + 80), 10 * (n% - 10) + (M% - 1)) = Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((210 + K%), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + K%), (7 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((210 + n%), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((210 + n%), (7 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%
        
        For M% = 12 To 18
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo net_MM
        For i% = 12 To 18
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo net_II
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (7 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) + 1
    End If

            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
            Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "&")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
            Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "&")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
net_II:   Next i%
net_MM:   Next M%
    Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 12 To 18
    Worksheets("dom").Cells((n% + 80), 10 * (K% - 10) + (M% - 1)) = 0 - Worksheets("formula").Cells(K%, M%)
    Worksheets("dom").Cells((K% + 80), 10 * (n% - 10) + (M% - 1)) = 0 - Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((210 + K%), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + K%), (8 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((210 + n%), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((210 + n%), (8 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%

        For M% = 12 To 18
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo net_MMM
        For i% = 12 To 18
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo net_III

    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (8 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) + 1
    End If

            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
            Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "#")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
            Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "#")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
net_III:   Next i%
net_MMM:   Next M%
    End If
End If

net_A: Next A%
Next K%
Next n%

Call sumdom

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

Sheets("formula").Select
ActiveWindow.ScrollColumn = 5
Range("B30").Select
Worksheets("natal").Select
Range("A2").Select

End Sub
Sub proftest()

Dim ERRP As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

For KS% = 11 To 5011 Step 8 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("prof-baza").Cells(KS% + 6, 255) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For K% = 5 To 253 Step 4
Worksheets("prof-baza").Cells(KS% + 6, K%) = Int(Worksheets("prof-baza").Cells(KS% + 6, K%))
If Worksheets("prof-baza").Cells(KS% + 6, K%) < 0 Then
    Worksheets("prof-baza").Cells(KS% + 6, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Worksheets("prof-baza").Cells(KS% + 6, 255) = Worksheets("prof-baza").Cells(KS% + 6, 255) + Worksheets("prof-baza").Cells(KS% + 6, K%)
 '  Worksheets("prof-baza").Cells(1, 4) = KS%
 '  Worksheets("prof-baza").Cells(1, 6) = K%
Next K%
Next KS%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For KS% = 11 To 5011 Step 8 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(KS% + 6, 255) = 0 Then GoTo netKS '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 5 To 253 Step 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("prof-baza").Cells(KS%, K%) = Trim(Worksheets("prof-baza").Cells(KS%, K%))
    Worksheets("prof-baza").Cells(KS% + 1, K%) = Trim(Worksheets("prof-baza").Cells(KS% + 1, K%))
    Worksheets("prof-baza").Cells(KS% + 3, K% - 1) = Trim(Worksheets("prof-baza").Cells(KS% + 3, K% - 1))
    Worksheets("prof-baza").Cells(KS% + 4, K% - 1) = Trim(Worksheets("prof-baza").Cells(KS% + 4, K% - 1))
    Worksheets("prof-baza").Cells(KS% + 5, K% - 1) = Trim(Worksheets("prof-baza").Cells(KS% + 5, K% - 1))
    Worksheets("prof-baza").Cells(KS% + 3, K% + 1) = Trim(Worksheets("prof-baza").Cells(KS% + 3, K% + 1))
    Worksheets("prof-baza").Cells(KS% + 4, K% + 1) = Trim(Worksheets("prof-baza").Cells(KS% + 4, K% + 1))
    Worksheets("prof-baza").Cells(KS% + 5, K% + 1) = Trim(Worksheets("prof-baza").Cells(KS% + 5, K% + 1))
    Worksheets("prof-baza").Cells(KS% + 3, K% - 2) = 0
    Worksheets("prof-baza").Cells(KS% + 4, K% - 2) = 0
    Worksheets("prof-baza").Cells(KS% + 5, K% - 2) = 0
    Worksheets("prof-baza").Cells(KS% + 3, K%) = 0
    Worksheets("prof-baza").Cells(KS% + 4, K%) = 0
    Worksheets("prof-baza").Cells(KS% + 5, K%) = 0
    Worksheets("prof-baza").Cells(KS%, K% - 1) = Int(Worksheets("prof-baza").Cells(KS%, K% - 1))
    Worksheets("prof-baza").Cells(KS% + 1, K% - 1) = Int(Worksheets("prof-baza").Cells(KS% + 1, K% - 1))
    Worksheets("prof-baza").Cells(KS% + 2, K% - 1) = Int(Worksheets("prof-baza").Cells(KS% + 2, K% - 1))
    Worksheets("prof-baza").Cells(KS%, K% + 1) = Int(Worksheets("prof-baza").Cells(KS%, K% + 1))
    Worksheets("prof-baza").Cells(KS% + 1, K% + 1) = Int(Worksheets("prof-baza").Cells(KS% + 1, K% + 1))
    Worksheets("prof-baza").Cells(KS% + 2, K% + 1) = Int(Worksheets("prof-baza").Cells(KS% + 2, K% + 1))
    Next K%
    
    For K% = 4 To 252 Step 4 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If Worksheets("prof-baza").Cells(KS% + 6, K% + 1) = 0 Then GoTo netK
    'Worksheets("prof-baza").Cells(1, 4) = KS%
    'Worksheets("prof-baza").Cells(1, 6) = K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("prof-baza").Cells(KS%, K% + 1) <> "" And Worksheets("prof-baza").Cells(KS%, K% + 1) <> "&" And Worksheets("prof-baza").Cells(KS%, K% + 1) <> "#" Then
    Worksheets("prof-baza").Cells(KS%, K% + 1).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prof-baza").Cells(KS% + 1, K% + 1) <> "" And Worksheets("prof-baza").Cells(KS% + 1, K% + 1) <> "&" And Worksheets("prof-baza").Cells(KS% + 1, K% + 1) <> "#" Then
    Worksheets("prof-baza").Cells(KS% + 1, K% + 1).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Worksheets("prof-baza").Cells(KS% + 1, K% + 1) = "" Then Worksheets("prof-baza").Cells(KS% + 1, K% + 1) = "&"
    
    For i% = 3 To 5 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
ERRP = 0
If Worksheets("prof-baza").Cells(KS% + i%, K%) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("prof-baza").Cells(KS% + i%, K%) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("prof-baza").Cells(KS% + i%, K% + 1) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("prof-baza").Cells(KS% + i%, K%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
ERRP = 0
If Worksheets("prof-baza").Cells(KS% + i%, K% + 2) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Worksheets("prof-baza").Cells(KS% + i%, K% + 2) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("prof-baza").Cells(KS% + i%, K% + 3) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("prof-baza").Cells(KS% + i%, K% + 2).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
    Next i%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i% = 0 To 2
Worksheets("prof-baza").Cells(KS% + i%, K%) = Int(Worksheets("prof-baza").Cells(KS% + i%, K%))
If Worksheets("prof-baza").Cells(KS% + i%, K%) < 0 Or Worksheets("prof-baza").Cells(KS% + i%, K%) > 12 Then
    Worksheets("prof-baza").Cells(KS% + i%, K%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Worksheets("prof-baza").Cells(KS% + i%, K% + 2) = Int(Worksheets("prof-baza").Cells(KS% + i%, K% + 2))
If Worksheets("prof-baza").Cells(KS% + i%, K% + 2) < 0 Or Worksheets("prof-baza").Cells(KS% + i%, K% + 2) > 12 Then
    Worksheets("prof-baza").Cells(KS% + i%, K% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next i%

netK: Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For i% = 0 To 6
Worksheets("prof-baza").Cells(KS% + i%, 2) = Int(Worksheets("prof-baza").Cells(KS% + i%, 2))
If Worksheets("prof-baza").Cells(KS% + i%, 2) < 0 Or Worksheets("prof-baza").Cells(KS% + i%, 2) > 12 Then
    Worksheets("prof-baza").Cells(KS% + i%, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next i%

netKS: Next KS%





End Sub
Sub ftest()

Dim ERRP As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For KF% = 2 To 254 Step 3
For K% = 8 To 32 Step 6

Worksheets("f-baza").Cells(K% + 2, KF%) = 0
Worksheets("f-baza").Cells(K% + 2, KF% + 2) = 0
ERRP = 0

If Trim(Worksheets("f-baza").Cells(K%, KF%)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("f-baza").Cells(K%, KF%)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("f-baza").Cells(K% + 2, KF%) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("f-baza").Cells(K%, KF%).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

ERRP = 0

If Trim(Worksheets("f-baza").Cells(K%, KF% + 2)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("f-baza").Cells(K%, KF% + 2)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("f-baza").Cells(K% + 2, KF% + 2) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("f-baza").Cells(K%, KF% + 2).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

Next K%
Next KF%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NS(14) As Integer
NS(1) = 5: NS(2) = 11: NS(3) = 17: NS(4) = 23: NS(5) = 29: NS(6) = 51: NS(7) = 51: NS(8) = 71: NS(9) = 81: NS(10) = 86: NS(11) = 91: NS(12) = 96: NS(13) = 101: NS(14) = 106

For KF% = 2 To 254 Step 3
For K% = 1 To 14

If Trim(Worksheets("f-baza").Cells(NS(K%), KF% + 1)) <> "" And Trim(Worksheets("f-baza").Cells(NS(K%), KF% + 1)) <> "#" And Trim(Worksheets("f-baza").Cells(NS(K%), KF% + 1)) <> "&" Then
    Worksheets("f-baza").Cells(NS(K%), KF% + 1).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Trim(Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 1)) <> "" And Trim(Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 1)) <> "#" And Trim(Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 1)) <> "&" Then
    Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 1).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Trim(Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 1)) = "" Then Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 1) = Worksheets("f-baza").Cells(NS(K%), KF% + 1)

If Int(Worksheets("f-baza").Cells(NS(K%), KF%)) < 0 Or Int(Worksheets("f-baza").Cells(NS(K%), KF%)) > 12 Then
    Worksheets("f-baza").Cells(NS(K%), KF%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Int(Worksheets("f-baza").Cells(NS(K%) + 1, KF%)) < 0 Or Int(Worksheets("f-baza").Cells(NS(K%) + 1, KF%)) > 12 Then
    Worksheets("f-baza").Cells(NS(K%) + 1, KF%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Int(Worksheets("f-baza").Cells(NS(K%) + 2, KF%)) < 0 Or Int(Worksheets("f-baza").Cells(NS(K%) + 2, KF%)) > 12 Then
    Worksheets("f-baza").Cells(NS(K%) + 2, KF%).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

If Int(Worksheets("f-baza").Cells(NS(K%), KF% + 2)) < 0 Or Int(Worksheets("f-baza").Cells(NS(K%), KF% + 2)) > 12 Then
    Worksheets("f-baza").Cells(NS(K%), KF% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Int(Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 2)) < 0 Or Int(Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 2)) > 12 Then
    Worksheets("f-baza").Cells(NS(K%) + 1, KF% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
If Int(Worksheets("f-baza").Cells(NS(K%) + 2, KF% + 2)) < 0 Or Int(Worksheets("f-baza").Cells(NS(K%) + 2, KF% + 2)) > 12 Then
    Worksheets("f-baza").Cells(NS(K%) + 2, KF% + 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

Next K%

For K% = 1 To 5
If Int(Worksheets("f-baza").Cells(NS(K%) + 4, KF% + 1)) < 0 Then
    Worksheets("f-baza").Cells(NS(K%) + 4, KF% + 1).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

For K% = 6 To 14
If Int(Worksheets("f-baza").Cells(NS(K%) + 3, KF% + 1)) < 0 Then
    Worksheets("f-baza").Cells(NS(K%) + 3, KF% + 1).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

Next KF%

End Sub

Sub efem()

Sheets("natal").Select
Range("F10:G33").Select
Selection.ClearContents

Worksheets("natal").Cells(10, 6) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Dim NZ As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NG As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDV As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NP As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDE As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NN As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LZ As Double   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|


For KP% = 11 To 20  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

NZ = Int(Worksheets("natal").Cells(KP%, 2) / 30) + 1
LZ = Worksheets("natal").Cells(KP%, 2) - (NZ - 1) * 30
NG = Int(LZ) + 1
NDV = Int(LZ / 2.5) + 1
NP = Int(LZ / 5) + 1
NDE = Int(LZ / 10) + 1
Worksheets("af").Cells(KP%, 213) = LZ
Worksheets("af").Cells(KP%, 214) = NZ
Worksheets("af").Cells(KP%, 215) = NG
Worksheets("af").Cells(KP%, 216) = NDV
Worksheets("af").Cells(KP%, 217) = NP
Worksheets("af").Cells(KP%, 218) = NDE

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NN = Worksheets("af").Cells(10 + NZ, NG)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 100) * Worksheets("af").Cells(10, 30)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NN = Worksheets("af").Cells(30 + NZ, NDV)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 100) * Worksheets("af").Cells(30, 30)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NN = Worksheets("af").Cells(50 + NZ, NP)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 100) * Worksheets("af").Cells(50, 30)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NN = Worksheets("af").Cells(70 + NZ, NDE)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 100) * Worksheets("af").Cells(70, 30)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NN = NZ
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 100) * Worksheets("af").Cells(90, 30)

If Trim(Worksheets("natal").Cells(KP%, 3)) = "" Then GoTo netR '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd| R
NN = Worksheets("af").Cells(10 + NZ, NG)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 200) * Worksheets("af").Cells(10, 30)
'|fffd||fffd||fffd||fffd| R
NN = Worksheets("af").Cells(30 + NZ, NDV)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 200) * Worksheets("af").Cells(30, 30)
'|fffd||fffd||fffd||fffd||fffd||fffd| R
NN = Worksheets("af").Cells(50 + NZ, NP)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 200) * Worksheets("af").Cells(50, 30)
'|fffd||fffd||fffd||fffd||fffd| R
NN = Worksheets("af").Cells(70 + NZ, NDE)
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 200) * Worksheets("af").Cells(70, 30)
'|fffd||fffd||fffd||fffd| R
NN = NZ
Worksheets("natal").Cells(KP%, 6) = Worksheets("natal").Cells(KP%, 6) + Worksheets("af").Cells(KP%, NN + 200) * Worksheets("af").Cells(90, 30)

netR: Next KP%

Worksheets("natal").Cells(1, 2).Select

End Sub

Sub radiks()

Call proverka

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|

 Worksheets("med").Select
Rows("31:606").Select
Selection.Font.Bold = True
    Selection.Font.Bold = False
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
Selection.ClearContents
Range("A9").Select

    Sheets("MP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select
    Range("E11:BZ33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 26
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER513").Select
    Selection.ClearContents
    Range("E521:ER533").Select
    Selection.ClearContents
    Range("E541:ER553").Select
    Selection.ClearContents
    Range("E561:ER573").Select
    Selection.ClearContents
    Range("E581:ER593").Select
    Selection.ClearContents
    Range("E601:ER613").Select
    Selection.ClearContents
    Range("E621:ER633").Select
    Range("E641:ER653").Select
    Selection.ClearContents
    Range("E701:GN713").Select
    Selection.ClearContents
    Range("E721:GN733").Select
    Selection.ClearContents
    Range("E741:GN753").Select
    Selection.ClearContents
    Range("E761:GN773").Select
    Selection.ClearContents
    Range("AF71:AG401").Select
    Selection.ClearContents
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Select
Range("E31:AN54").Select
Selection.ClearContents
Range("C30").Select

    Range("A9").Select
    
    Sheets("BP").Select
     Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select
    Range("E11:BZ33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 31
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER513").Select
    Selection.ClearContents
    Range("E521:ER533").Select
    Selection.ClearContents
    Range("E541:ER553").Select
    Selection.ClearContents
    Range("E561:ER573").Select
    Selection.ClearContents
    Range("E701:GN713").Select
    Selection.ClearContents
    Range("E721:GN733").Select
    Selection.ClearContents
    Range("E741:GN753").Select
    Selection.ClearContents
    Range("E761:GN773").Select
    Selection.ClearContents
    Range("A9").Select
    Range("AF71:AG401").Select
    Selection.ClearContents
        
    Sheets("TR").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select
    Range("E11:BZ21").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 9
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER513").Select
    Selection.ClearContents
    Range("E521:ER533").Select
    Selection.ClearContents
    Range("E541:ER553").Select
    Selection.ClearContents
    Range("E561:ER573").Select
    Selection.ClearContents
    Range("E701:GN713").Select
    Selection.ClearContents
    Range("E721:GN733").Select
    Selection.ClearContents
    Range("E741:GN753").Select
    Selection.ClearContents
    Range("E761:GN773").Select
    Selection.ClearContents
    Range("A9").Select
    Range("AF71:AG401").Select
    Selection.ClearContents
    
    Sheets("natal").Select
    Range("B11:BP33").Select
    Selection.ClearContents
    Range("L9:BP9").Select
    Selection.ClearContents
    With Selection.Font
        .ColorIndex = xlAutomatic
    End With
    ActiveWindow.ScrollColumn = 217
    ActiveWindow.ScrollColumn = 12
    Range("A9").Select

    Sheets("opis").Select
    Rows("4:125").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 4
    Range("A4").Select
    
    Sheets("PROFI").Select   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("A11:E200").Select
    Selection.Font.Bold = False
    Selection.ClearContents
    Range("A10").Select
    
    Sheets("List").Select
    Rows("11:4000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("MP").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("BP").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("TR").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    Range("A4").Select
    
    Sheets("dom").Select
    Range("K11:BF23").Select
    Selection.ClearContents
    Range("K31:BF43").Select
    Selection.ClearContents
    Range("K51:BF63").Select
    Selection.ClearContents
    Range("K71:DZ81").Select
    Selection.ClearContents
    Range("K91:DZ101").Select
    Selection.ClearContents
    Range("K111:DZ121").Select
    Selection.ClearContents
    Range("A2").Select
    
Worksheets("formula").Select
Range("E11:AD21").Select
Selection.ClearContents
Range("E11:AF21").Select
Selection.ClearContents
Range("A2").Select

Sheets("orb").Select
Range("AE11:AO21").Select
Selection.ClearContents
Range("AC10").Select

    Sheets("natal").Select
    Range("A10").Select
    
    
Sheets("dom").Select
    Range("K201:BF213").Select
    Selection.ClearContents
    Range("K221:BF233").Select
    Selection.ClearContents
    Range("K241:BF253").Select
    Selection.ClearContents
    Range("A4").Select
    Sheets("natal").Select
    Range("A4").Select

Worksheets("natal").Cells(10, 2) = "|fffd||fffd||fffd||fffd||fffd|"
Worksheets("natal").Cells(10, 4) = "|fffd||fffd||fffd||fffd||fffd|"
Worksheets("natal").Cells(10, 6) = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("natal").Cells(10, 8) = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("natal").Cells(10, 10) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(10, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(10, 12) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(10, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(29, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("formula").Cells(29, 17) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("List").Cells(8, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("List").Cells(8, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(9, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(29, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(199, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("dom").Cells(219, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("opis").Cells(2, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("opis").Cells(2, 4) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("PROFI").Cells(10, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Worksheets("PROFI").Cells(10, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 11 To 33
Worksheets("MP").Cells(K%, 1) = Worksheets("natal").Cells(K%, 1)
Worksheets("BP").Cells(K%, 1) = Worksheets("natal").Cells(K%, 1)
Next K%
For K% = 11 To 21
Worksheets("formula").Cells(K%, 1) = Worksheets("natal").Cells(K%, 1)
Worksheets("TR").Cells(K%, 1) = Worksheets("natal").Cells(K%, 1)
Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
For M% = 1 To (13 - K%)
If Int(Abs(Worksheets("natal").Cells((39 + K% + M%), (10 + K%)))) > 0 Then Worksheets("natal").Cells((39 + K% + M%), (10 + K%)) = 1
Worksheets("natal").Cells((40 + K%), (9 + M% + K%)) = Worksheets("natal").Cells((39 + K% + M%), (10 + K%))
Next M%
Next K%
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NTABORB As Integer
NTABORB = Int(Worksheets("natal").Cells(4, 2))
For K% = 1 To 11
For M% = K% To 10
Worksheets("orb").Cells((10 * NTABORB + K%), (11 + M%)) = Abs(Worksheets("orb").Cells((10 * NTABORB + 1 + M%), (10 + K%)))
Next M%
Next K%
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Worksheets("natal").Select '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Range("B11:K33").Select
Selection.ClearContents
Range("A10").Select
 
Dim B As Double
Dim JDNN As Long
Dim KK As Long
Dim JDMP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDBP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
pi = 3.14159265358979        '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|

Call DATAvJD(Int(Worksheets("natal").Cells(2, 2)), Int(Worksheets("natal").Cells(2, 3)), Int(Worksheets("natal").Cells(2, 4)), Int(Worksheets("natal").Cells(2, 5)), Int(Worksheets("natal").Cells(2, 6)), Int(Worksheets("natal").Cells(2, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(2, 11) = JDNN
Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
B = Worksheets("natal").Cells(2, 9) - Int(Worksheets("natal").Cells(2, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(JDNN, B, 11, 2) ' 2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 0 To 10
Worksheets("natal").Cells((K% + 11), 4) = Worksheets("natal").Cells((K% + 11), 2)
Worksheets("natal").Cells((K% + 11), 5) = Worksheets("natal").Cells((K% + 11), 3)
Next K%

Dim LatGrad As Double
Dim LG As Double
Dim X As Double
Dim PP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim DMAX As Integer
Dim DMIN As Integer
Dim DSI As Integer
Dim DSL As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
LonGrad = Worksheets("natal").Cells(7, 2) + Worksheets("natal").Cells(7, 3) / 60
Worksheets("natal").Cells(35, 5) = LonGrad
ZV0 = ZV00((Int(Worksheets("natal").Cells(2, 9)) + 1 / 2))
GMT = Worksheets("natal").Cells(2, 5) + Worksheets("natal").Cells(2, 6) / 60 + Worksheets("natal").Cells(2, 7) / 3600
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
ZVchas = ZV / 15
Worksheets("natal").Cells(35, 2) = Int(ZVchas)
ZVh = Int(ZVchas)
ZVm = (ZVchas - ZVh) * 60
Worksheets("natal").Cells(35, 3) = Int(ZVm)
ZVs = Int((ZVm - Int(ZVm)) * 60 + 1 / 2)
Worksheets("natal").Cells(35, 4) = ZVs
LatGrad = Abs(Worksheets("natal").Cells(7, 5)) + Abs(Worksheets("natal").Cells(7, 6) / 60)
If LatGrad = 0 Then LatGrad = 1 / 60
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If LatGrad > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = LatGrad - (692.74 / 3600) * Sin(LatGrad * pi / 90) + (1.16 / 3600) * Sin(LatGrad * pi / 45)
Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End If
If Worksheets("natal").Cells(7, 5) < 0 Then
Worksheets("natal").Cells(35, 6) = -LatGrad
Else
Worksheets("natal").Cells(35, 6) = LatGrad
End If
LatGrad = Worksheets("natal").Cells(35, 6)

For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 2) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(2, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
LonGrad = Worksheets("natal").Cells(8, 2) + Worksheets("natal").Cells(8, 3) / 60
Worksheets("natal").Cells(36, 5) = LonGrad
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
ZVchas = ZV / 15
Worksheets("natal").Cells(36, 2) = Int(ZVchas)
ZVh = Int(ZVchas)
ZVm = (ZVchas - ZVh) * 60
Worksheets("natal").Cells(36, 3) = Int(ZVm)
ZVs = Int((ZVm - Int(ZVm)) * 60 + 1 / 2)
Worksheets("natal").Cells(36, 4) = ZVs
LatGrad = Abs(Worksheets("natal").Cells(8, 5)) + Abs(Worksheets("natal").Cells(8, 6) / 60)
If LatGrad = 0 Then LatGrad = 1 / 60
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If LatGrad > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = LatGrad - (692.74 / 3600) * Sin(LatGrad * pi / 90) + (1.16 / 3600) * Sin(LatGrad * pi / 45)
Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End If
If Worksheets("natal").Cells(8, 5) < 0 Then
Worksheets("natal").Cells(36, 6) = -LatGrad
Else
Worksheets("natal").Cells(36, 6) = LatGrad
End If
LatGrad = Worksheets("natal").Cells(36, 6)

For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 4) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(2, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

Dim STRPL1 As Integer ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STRPL2 As Integer ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 2) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call uprav(2, 3, 6) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 3 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("formula").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call uprav(4, 5, 13) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 5 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
Dim D(0 To 12) As Integer
Dim STB As Integer
Dim DD As Integer

For M% = 11 To 21

For n% = 0 To 12
D(n%) = 0
Next n%

If Worksheets("formula").Cells(M%, 5) <> Worksheets("formula").Cells(M%, 12) Then
Worksheets("formula").Cells(M%, 19) = Worksheets("formula").Cells(M%, 5)
Worksheets("formula").Cells(M%, 20) = Worksheets("formula").Cells(M%, 12)
STB = 21
Else
Worksheets("formula").Cells(M%, 19) = Worksheets("formula").Cells(M%, 5)
STB = 20
End If
    
    For n% = 6 To 11
    DD = Int(Worksheets("formula").Cells(M%, n%))
    D(DD) = D(DD) + 1
    Next n%
    
    For n% = 13 To 18
    DD = Int(Worksheets("formula").Cells(M%, n%))
    D(DD) = D(DD) + 1
    Next n%
    
    For n% = 1 To 12
    If D(n%) > 0 Then
    Worksheets("formula").Cells(M%, STB) = n%
    STB = STB + 1
    Else
    End If
    Next n%
    
Next M%

'=======|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ================

Sheets("natal").Select
Range("A1:G8").Select
Selection.Copy
Sheets("formula").Select
Range("A1:G8").Select
ActiveSheet.Paste
Range("A30").Select
    Sheets("natal").Select
    Range("B2:D2").Select
    Selection.Copy
    Sheets("List").Select
    Range("B2:D2").Select
    ActiveSheet.Paste
    Range("A11:U1000").Select
    Selection.ClearContents
    Range("A8:D8").Select
Dim STROKN As Long
Dim STROKL As Long
Dim STROKNL As Long
Dim FList As Integer
STROKN = 11
STROKL = 11
STROKNL = 11
FList = Int(Worksheets("natal").Cells(40, 2)) '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 5 To 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("formula").Cells(n%, K%)
If NDOM1 = 0 Then GoTo netNDom1
Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|

For M% = (K% + 1) To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| k-|fffd|
NDOM2 = Worksheets("formula").Cells(n%, M%)
If NDOM2 = 0 Then GoTo netNDom2
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If

If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKN, n%, K%, M%, 1, "#")
            STROKN = STROKN + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKN, n%, K%, M%, 1, "#")
            STROKN = STROKN + 1
            Else
            End If
        End If
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKN, n%, K%, M%, 1, "&")
            STROKN = STROKN + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKN, n%, K%, M%, 1, "&")
            STROKN = STROKN + 1
            Else
            End If
        End If
End If

netNDom2: Next M%
netNDom1: Next K%

For K% = 12 To 17 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("formula").Cells(n%, K%)
If NDOM1 = 0 Then GoTo netNDom11
Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|

For M% = (K% + 1) To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| k-|fffd|
NDOM2 = Worksheets("formula").Cells(n%, M%)
If NDOM2 = 0 Then GoTo netNDom22
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If

If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKL, n%, K%, M%, 8, "#")
            STROKL = STROKL + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKL, n%, K%, M%, 8, "#")
            STROKL = STROKL + 1
            Else
            End If
        End If
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKL, n%, K%, M%, 8, "&")
            STROKL = STROKL + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
            If FList > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| List
            Call polozenie(STROKL, n%, K%, M%, 8, "&")
            STROKL = STROKL + 1
            Else
            End If
        End If
End If

netNDom22: Next M%
netNDom11: Next K%

Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NTAB = Worksheets("natal").Cells(4, 2)

For n% = 11 To 20 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 5 To 11
Worksheets("dom").Cells((n% + 60), (M% + 6)) = Worksheets("formula").Cells(n%, M%)
Worksheets("dom").Cells(81, (M% + 6)) = Worksheets("formula").Cells(21, M%)
Next M%

For K% = (n% + 1) To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 2))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo netA
If Abs(Lasp - A%) >= Worksheets("orb").Cells((NTAB * 10 + (K% - 10)), n%) Then GoTo netA

If A% = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("orb").Cells(K%, (n% + 20)) = 1

For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((n% + 60), 10 * (K% - 10) + (M% + 6)) = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((K% + 60), 10 * (n% - 10) + (M% + 6)) = Worksheets("formula").Cells(n%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((190 + K%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + K%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((190 + n%), (9 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
Next M%
        
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netm
        
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netI
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If
        
 If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
            If FList > 0 Then
            Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "#")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
            If FList > 0 Then
            Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "#")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
        End If
Else '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
            If FList > 0 Then
            Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "&")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
            If FList > 0 Then
            Call strochka(STROKN, n%, K%, M%, i%, 1, Lasp, "&")
            Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
            STROKN = STROKN + 1
            Else
            End If
        End If
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

netI:   Next i%
netm:   Next M%

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("orb").Cells(K%, (n% + 20)) = A%
    
    If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 5 To 11
Worksheets("dom").Cells((n% + 60), 10 * (K% - 10) + (M% + 6)) = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((K% + 60), 10 * (n% - 10) + (M% + 6)) = Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((190 + K%), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + K%), (7 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((190 + n%), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((190 + n%), (7 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%
        
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMM
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netII
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (7 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (7 + 4 * NDOM1)) + 1
    End If
    
            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (4 + NDOM1)) + 1
                    If FList > 0 Then
                    Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "&")
                    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
                    STROKN = STROKN + 1
                    Else
                    End If
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (4 + NDOM2)) + 1
                    If FList > 0 Then
                    Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "&")
                    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
                    STROKN = STROKN + 1
                    Else
                    End If
            Else
            End If
netII:   Next i%
netMM:   Next M%

    Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 5 To 11
    Worksheets("dom").Cells((n% + 60), 10 * (K% - 10) + (M% + 6)) = 0 - Worksheets("formula").Cells(K%, M%)
    Worksheets("dom").Cells((K% + 60), 10 * (n% - 10) + (M% + 6)) = 0 - Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((190 + K%), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((190 + K%), (8 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((190 + n%), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((190 + n%), (8 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%
    
        For M% = 5 To 11
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo netMMM
        For i% = 5 To 11
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo netIII
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((10 + NDOM1), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((10 + NDOM1), (8 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((10 + NDOM2), (8 + 4 * NDOM1)) + 1
    End If

            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (4 + NDOM1)) + 1
                    If FList > 0 Then
                    Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "#")
                    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
                    STROKN = STROKN + 1
                    Else
                    End If
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (4 + NDOM2)) + 1
                    If FList > 0 Then
                    Call strochka(STROKN, n%, K%, M%, i%, 1, Abs(Lasp - A%), "#")
                    Worksheets("List").Cells(STROKN, 7) = CStr(Int(A%))
                    STROKN = STROKN + 1
                    Else
                    End If
            Else
            End If
netIII:   Next i%
netMMM:   Next M%
    End If
End If

netA: Next A%
Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 12 To 18
Worksheets("dom").Cells((n% + 80), (M% - 1)) = Worksheets("formula").Cells(n%, M%)
Worksheets("dom").Cells(101, (M% - 1)) = Worksheets("formula").Cells(21, M%)
Next M%

For K% = (n% + 1) To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Lasp = ASPECT(Worksheets("natal").Cells(n%, 2), Worksheets("natal").Cells(K%, 2))
For A% = 0 To 180 Step 30
If A% = 30 Or A% = 150 Then GoTo net_A
If Abs(Lasp - A%) >= Worksheets("orb").Cells((NTAB * 10 + (K% - 10)), n%) Then GoTo net_A
If A% = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 12 To 18
Worksheets("dom").Cells((n% + 80), 10 * (K% - 10) + (M% - 1)) = Worksheets("formula").Cells(K%, M%)
Worksheets("dom").Cells((K% + 80), 10 * (n% - 10) + (M% - 1)) = Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((210 + K%), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + K%), (9 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((210 + n%), (9 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
Next M%
        
        For M% = 12 To 18
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo net_M
        For i% = 12 To 18
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo net_I
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (9 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (9 + 4 * NDOM1)) + 1
    End If
        
 If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
            If FList > 0 Then
            Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "#")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
            If FList > 0 Then
            Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "#")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
        End If
Else '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
        If NDOM1 <= NDOM2 Then
    Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
            If FList > 0 Then
            Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "&")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
        Else
    Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
            If FList > 0 Then
            Call strochka(STROKL, n%, K%, M%, i%, 8, Lasp, "&")
            Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
            STROKL = STROKL + 1
            Else
            End If
        End If
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
net_I:   Next i%
net_M:   Next M%

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If A% = 60 Or A% = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 12 To 18
    Worksheets("dom").Cells((n% + 80), 10 * (K% - 10) + (M% - 1)) = Worksheets("formula").Cells(K%, M%)
    Worksheets("dom").Cells((K% + 80), 10 * (n% - 10) + (M% - 1)) = Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((210 + K%), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + K%), (7 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((210 + n%), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((210 + n%), (7 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%
        
        For M% = 12 To 18
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo net_MM
        For i% = 12 To 18
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo net_II
        
    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (7 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (7 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (7 + 4 * NDOM1)) + 1
    End If

            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((29 + 2 * NDOM2), (16 + NDOM1)) + 1
                    If FList > 0 Then
                    Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "&")
                    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
                    STROKL = STROKL + 1
                    Else
                    End If
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((29 + 2 * NDOM1), (16 + NDOM2)) + 1
                    If FList > 0 Then
                    Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "&")
                    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
                    STROKL = STROKL + 1
                    Else
                    End If
            Else
            End If
net_II:   Next i%
net_MM:   Next M%
    Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    For M% = 12 To 18
    Worksheets("dom").Cells((n% + 80), 10 * (K% - 10) + (M% - 1)) = 0 - Worksheets("formula").Cells(K%, M%)
    Worksheets("dom").Cells((K% + 80), 10 * (n% - 10) + (M% - 1)) = 0 - Worksheets("formula").Cells(n%, M%)
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        NDOM2 = Worksheets("formula").Cells(K%, M%)
If NDOM1 > 0 Then Worksheets("dom").Cells((210 + K%), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((210 + K%), (8 + 4 * NDOM1)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
If NDOM2 > 0 Then Worksheets("dom").Cells((210 + n%), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((210 + n%), (8 + 4 * NDOM2)) + 1 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
    Next M%

        For M% = 12 To 18
        NDOM1 = Worksheets("formula").Cells(n%, M%)
        If NDOM1 = 0 Then GoTo net_MMM
        For i% = 12 To 18
        NDOM2 = Worksheets("formula").Cells(K%, i%)
        If NDOM2 = 0 Then GoTo net_III

    If NDOM1 = NDOM2 Then
    Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) + 1
    Else
    Worksheets("dom").Cells((30 + NDOM1), (8 + 4 * NDOM2)) = Worksheets("dom").Cells((30 + NDOM1), (8 + 4 * NDOM2)) + 1
    Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) = Worksheets("dom").Cells((30 + NDOM2), (8 + 4 * NDOM1)) + 1
    End If

            If NDOM1 <= NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("formula").Cells((30 + 2 * NDOM2), (16 + NDOM1)) + 1
                    If FList > 0 Then
                    Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "#")
                    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
                    STROKL = STROKL + 1
                    Else
                    End If
            Else
            End If
            If NDOM1 > NDOM2 Then
            Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("formula").Cells((30 + 2 * NDOM1), (16 + NDOM2)) + 1
                    If FList > 0 Then
                    Call strochka(STROKL, n%, K%, M%, i%, 8, Abs(Lasp - A%), "#")
                    Worksheets("List").Cells(STROKL, 14) = CStr(Int(A%))
                    STROKL = STROKL + 1
                    Else
                    End If
            Else
            End If
net_III:   Next i%
net_MMM:   Next M%
    End If
End If

net_A: Next A%
Next K%
Next n%

Call sumdom

Sheets("orb").Select
ActiveWindow.ScrollColumn = 11
Sheets("formula").Select
ActiveWindow.ScrollColumn = 5
Range("B30").Select
Worksheets("natal").Select
Range("A2").Select

End Sub
Sub sumdom()

Dim SUMD As Integer
Dim DMIN As Integer
Dim DMAX As Integer
Dim DSL As Integer
Dim DSI As Integer

For n% = 10 To 30 Step 20
For K% = 11 To 55 Step 4
For M% = 1 To 12
Worksheets("dom").Cells((n% + M%), (K% + 3)) = Worksheets("dom").Cells((n% + M%), K%) + Worksheets("dom").Cells((n% + M%), (K% + 1)) + Worksheets("dom").Cells((n% + M%), (K% + 2))
Worksheets("dom").Cells((n% + 13), K%) = Worksheets("dom").Cells((n% + 13), K%) + Worksheets("dom").Cells((n% + M%), K%)
Worksheets("dom").Cells((n% + 13), (K% + 1)) = Worksheets("dom").Cells((n% + 13), (K% + 1)) + Worksheets("dom").Cells((n% + M%), (K% + 1))
Worksheets("dom").Cells((n% + 13), (K% + 2)) = Worksheets("dom").Cells((n% + 13), (K% + 2)) + Worksheets("dom").Cells((n% + M%), (K% + 2))

Worksheets("dom").Cells((n% + M% + 190), (K% + 3)) = Worksheets("dom").Cells((n% + M% + 190), K%) + Worksheets("dom").Cells((n% + M% + 190), (K% + 1)) + Worksheets("dom").Cells((n% + M% + 190), (K% + 2))
Worksheets("dom").Cells((n% + 203), K%) = Worksheets("dom").Cells((n% + 203), K%) + Worksheets("dom").Cells((n% + M% + 190), K%)
Worksheets("dom").Cells((n% + 203), (K% + 1)) = Worksheets("dom").Cells((n% + 203), (K% + 1)) + Worksheets("dom").Cells((n% + M% + 190), (K% + 1))
Worksheets("dom").Cells((n% + 203), (K% + 2)) = Worksheets("dom").Cells((n% + 203), (K% + 2)) + Worksheets("dom").Cells((n% + M% + 190), (K% + 2))
Next M%
Worksheets("dom").Cells((n% + 13), (K% + 3)) = Worksheets("dom").Cells((n% + 13), K%) + Worksheets("dom").Cells((n% + 13), (K% + 1)) + Worksheets("dom").Cells((n% + 13), (K% + 2))
Worksheets("dom").Cells((n% + 203), (K% + 3)) = Worksheets("dom").Cells((n% + 203), K%) + Worksheets("dom").Cells((n% + 203), (K% + 1)) + Worksheets("dom").Cells((n% + 203), (K% + 2))
Next K%
Next n%

DMIN = Int(Worksheets("dom").Cells(23, 14))
DMAX = Int(Worksheets("dom").Cells(23, 14))
For K% = 18 To 58 Step 4
If DMIN > Worksheets("dom").Cells(23, K%) Then DMIN = Int(Worksheets("dom").Cells(23, K%))
If DMAX < Worksheets("dom").Cells(23, K%) Then DMAX = Int(Worksheets("dom").Cells(23, K%))
Next K%
DSI = Int(DMIN + 2 * (DMAX - DMIN) / 3)
DSL = Int(DMIN + (DMAX - DMIN) / 3)
Worksheets("dom").Cells(23, 60) = DSL
Worksheets("dom").Cells(23, 61) = DSI
For K% = 14 To 58 Step 4
If Worksheets("dom").Cells(23, K%) < DSL Then Worksheets("dom").Cells(8, K% - 3) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If Worksheets("dom").Cells(23, K%) > DSI Then Worksheets("dom").Cells(8, K% - 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If Worksheets("dom").Cells(23, K%) >= DSL And Worksheets("dom").Cells(23, K%) <= DSI Then Worksheets("dom").Cells(8, K% - 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Next K%

DMIN = Int(Worksheets("dom").Cells(43, 14))
DMAX = Int(Worksheets("dom").Cells(43, 14))
For K% = 18 To 58 Step 4
If DMIN > Worksheets("dom").Cells(43, K%) Then DMIN = Int(Worksheets("dom").Cells(43, K%))
If DMAX < Worksheets("dom").Cells(43, K%) Then DMAX = Int(Worksheets("dom").Cells(43, K%))
Next K%
DSI = Int(DMIN + 2 * (DMAX - DMIN) / 3)
DSL = Int(DMIN + (DMAX - DMIN) / 3)
Worksheets("dom").Cells(43, 60) = DSL
Worksheets("dom").Cells(43, 61) = DSI
For K% = 14 To 58 Step 4
If Worksheets("dom").Cells(43, K%) < DSL Then Worksheets("dom").Cells(28, K% - 3) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If Worksheets("dom").Cells(43, K%) > DSI Then Worksheets("dom").Cells(28, K% - 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If Worksheets("dom").Cells(43, K%) >= DSL And Worksheets("dom").Cells(43, K%) <= DSI Then Worksheets("dom").Cells(28, K% - 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Next K%

End Sub

Sub firma()

Worksheets("natal").Cells(62, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("natal").Cells(62, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("natal").Cells(62, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("natal").Cells(62, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("natal").Cells(62, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("natal").Cells(62, 7) = Worksheets("natal").Cells(2, 7)

Worksheets("natal").Cells(58, 2) = Worksheets("natal").Cells(8, 2)
Worksheets("natal").Cells(58, 3) = Worksheets("natal").Cells(8, 3)
Worksheets("natal").Cells(58, 4) = Worksheets("natal").Cells(8, 4)
Worksheets("natal").Cells(58, 5) = Worksheets("natal").Cells(8, 5)
Worksheets("natal").Cells(58, 6) = Worksheets("natal").Cells(8, 6)
Worksheets("natal").Cells(58, 7) = Worksheets("natal").Cells(8, 7)

    Sheets("firma").Select  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Rows("14:50000").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 14
    Range("A4").Select
    
Dim D00 As Integer

For K% = 11 To 87 Step 4
If Worksheets("firma").Cells(5, (K% + 1)) <> "" And Worksheets("firma").Cells(5, (K% + 1)) <> "#" And Worksheets("firma").Cells(5, (K% + 1)) <> "&" Then Worksheets("firma").Cells(5, (K% + 1)) = ""
If Int(Worksheets("firma").Cells(9, K%)) <> 0 Then Worksheets("firma").Cells(9, K%) = 1
If Worksheets("firma").Cells(11, K%) <> "#" And Worksheets("firma").Cells(11, K%) <> "&" Then Worksheets("firma").Cells(11, K%) = "&"

For M% = 5 To 7
Worksheets("firma").Cells(M%, K%) = Int(Worksheets("firma").Cells(M%, K%))
Worksheets("firma").Cells(M%, K% + 2) = Int(Worksheets("firma").Cells(M%, K% + 2))
If Worksheets("firma").Cells(M%, K%) < 1 Or Worksheets("firma").Cells(M%, K%) > 12 Then Worksheets("firma").Cells(M%, K%) = 0
If Worksheets("firma").Cells(M%, K% + 2) < 1 Or Worksheets("firma").Cells(M%, K%) > 12 Then Worksheets("firma").Cells(M%, K% + 2) = 0
Next M%

For M% = 5 To 6
For L% = (M% + 1) To 7
If Worksheets("firma").Cells(M%, K%) > Worksheets("firma").Cells(L%, K%) And Worksheets("firma").Cells(L%, K%) > 0 Then
D00 = Worksheets("firma").Cells(M%, K%)
Worksheets("firma").Cells(M%, K%) = Worksheets("firma").Cells(L%, K%)
Worksheets("firma").Cells(L%, K%) = D00
Else
End If
If Worksheets("firma").Cells(M%, K% + 2) > Worksheets("firma").Cells(L%, K% + 2) And Worksheets("firma").Cells(L%, K% + 2) > 0 Then
D00 = Worksheets("firma").Cells(M%, K% + 2)
Worksheets("firma").Cells(M%, K% + 2) = Worksheets("firma").Cells(L%, K% + 2)
Worksheets("firma").Cells(L%, K% + 2) = D00
Else
End If
Next L%
Next M%

Worksheets("firma").Cells(9, (K% + 2)) = 0
If Trim(Worksheets("firma").Cells(8, (K% + 2))) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("firma").Cells(8, (K% + 2))) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Worksheets("firma").Cells(9, (K% + 2)) = M% - 10
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("firma").Cells(8, (K% + 2)).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

Worksheets("firma").Cells(8, 2) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Dim SUN As Double
Dim D10 As Double
Dim B As Double
Dim MOON1 As Double
Dim MOON2 As Double
Dim L1 As Double
Dim L2 As Double
Dim LonGrad As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim GMTh As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim GMTm As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim GMTs As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim FLAG As Integer
Dim NDAY As Integer
Dim STROK As Integer
Dim SUMLE As Integer
Dim JDNN As Long
Dim JD1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JDTR As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim JD2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Nmin As Long
Dim SOVPAD As Integer
Dim NESOVPAD As Integer
Dim BPL As Integer
Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim S0 As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SNE As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SPLUS As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SUM As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim N1 As Integer
Dim N2 As Integer
Dim PLANET As String
Dim D1 As Integer
Dim D2 As Integer
Dim NP As Integer

STROK = 14
SOVPAD = 0
NESOVPAD = 0

Call DATAvJD(Int(Worksheets("firma").Cells(2, 2)), Int(Worksheets("firma").Cells(2, 3)), Int(Worksheets("firma").Cells(2, 4)), 0, 0, 0)
JD1 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("firma").Cells(3, 2)), Int(Worksheets("firma").Cells(3, 3)), Int(Worksheets("firma").Cells(3, 4)), 0, 0, 0)
JD2 = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

NDAY = Int(JD2 - JD1) + 1
JDTR = JD1 - 1
Call radiks
LonGrad = Worksheets("natal").Cells(35, 5)
Sheets("firma").Select

For n% = 1 To NDAY
JDTR = JDTR + 1

Sheets("firma").Select
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Call JDvDATA(JDTR)
Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(71, 7)
If Worksheets("natal").Cells(2, 6) > 59 Then Worksheets("natal").Cells(2, 6) = 59
If Worksheets("natal").Cells(2, 7) > 59 Then Worksheets("natal").Cells(2, 7) = 59

Call radiks
Sheets("firma").Select

D10 = Worksheets("natal").Cells(11, 2)
ZV0 = ZV00(Int(Worksheets("natal").Cells(2, 9)) + 1 / 2)
ZV = ZVMC(D10) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
GMT = ((ZV - LonGrad) / 15 - ZV0) * (1 / (1 + 1 / 360))
If GMT < 0 Then GMT = GMT + 24
If GMT >= 24 Then GMT = GMT - 24
Call JDvDATA(Int(Worksheets("natal").Cells(2, 9)) + GMT / 24)
Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(71, 7)
If Worksheets("natal").Cells(2, 6) > 59 Then Worksheets("natal").Cells(2, 6) = 59
If Worksheets("natal").Cells(2, 7) > 59 Then Worksheets("natal").Cells(2, 7) = 59
Worksheets("firma").Cells(STROK, 2) = Worksheets("natal").Cells(2, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("firma").Cells(STROK, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("firma").Cells(STROK, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("firma").Cells(STROK, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("firma").Cells(STROK, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("firma").Cells(STROK, 7) = Worksheets("natal").Cells(2, 7)

Call radiks
Sheets("firma").Select

SUN = Worksheets("natal").Cells(11, 2) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
D10 = Worksheets("natal").Cells(31, 2)
If Abs(SUN - D10) < 3 And D10 > SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) - (Abs(SUN - D10) / 350)
If Abs(SUN - D10) < 3 And D10 < SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) + (Abs(SUN - D10) / 370)
If Abs(SUN - D10) > 300 And D10 > SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) + (ASPECT(SUN, D10) / 370)
If Abs(SUN - D10) > 300 And D10 < SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) - (ASPECT(SUN, D10) / 350)
Call JDvDATA(Worksheets("natal").Cells(2, 9))
Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(71, 7)
If Worksheets("natal").Cells(2, 6) > 59 Then Worksheets("natal").Cells(2, 6) = 59
If Worksheets("natal").Cells(2, 7) > 59 Then Worksheets("natal").Cells(2, 7) = 59
Worksheets("firma").Cells(STROK, 2) = Worksheets("natal").Cells(2, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("firma").Cells(STROK, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("firma").Cells(STROK, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("firma").Cells(STROK, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("firma").Cells(STROK, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("firma").Cells(STROK, 7) = Worksheets("natal").Cells(2, 7)

Call radiks
Sheets("firma").Select

SUN = Worksheets("natal").Cells(11, 2) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
D10 = Worksheets("natal").Cells(31, 2)
If Abs(SUN - D10) < 3 And D10 > SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) - (Abs(SUN - D10) / 350)
If Abs(SUN - D10) < 3 And D10 < SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) + (Abs(SUN - D10) / 370)
If Abs(SUN - D10) > 300 And D10 > SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) + (ASPECT(SUN, D10) / 370)
If Abs(SUN - D10) > 300 And D10 < SUN Then Worksheets("natal").Cells(2, 9) = Worksheets("natal").Cells(2, 9) - (ASPECT(SUN, D10) / 350)
Call JDvDATA(Worksheets("natal").Cells(2, 9))
Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(71, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(71, 7)
If Worksheets("natal").Cells(2, 6) > 59 Then Worksheets("natal").Cells(2, 6) = 59
If Worksheets("natal").Cells(2, 7) > 59 Then Worksheets("natal").Cells(2, 7) = 59
Worksheets("firma").Cells(STROK, 2) = Worksheets("natal").Cells(2, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("firma").Cells(STROK, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("firma").Cells(STROK, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("firma").Cells(STROK, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("firma").Cells(STROK, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("firma").Cells(STROK, 7) = Worksheets("natal").Cells(2, 7)

Call radiks
Sheets("firma").Select

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
MOON1 = Worksheets("natal").Cells(12, 2)
MOON2 = Worksheets("natal").Cells(12, 2) + 1 / 10
If MOON2 > 360 Then MOON2 = MOON2 - 360
L1 = ASPECT(SUN, MOON1)
L2 = ASPECT(SUN, MOON2)
If L2 > L1 And L1 <= 90 Then Worksheets("firma").Cells(STROK, 8) = 1
If L2 > L1 And L1 > 90 Then Worksheets("firma").Cells(STROK, 8) = 2
If L2 < L1 And L1 > 90 Then Worksheets("firma").Cells(STROK, 8) = 3
If L2 < L1 And L1 <= 90 Then Worksheets("firma").Cells(STROK, 8) = 4

For KF% = 11 To 87 Step 4
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("firma").Cells(10, KF%)) = 0 Then GoTo netf
If Int(Worksheets("firma").Cells(5, KF%)) = 0 And Int(Worksheets("firma").Cells(6, KF%)) = 0 And Int(Worksheets("firma").Cells(7, KF%)) = 0 Then GoTo netf

NTAB = 10

S0 = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SNE = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SPLUS = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

NP = Int(Worksheets("firma").Cells(9, KF% + 2))
If NP = 0 Then GoTo netplanet

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NL% = 5 To 7
If Int(Worksheets("firma").Cells(NL%, KF%)) = 0 Then GoTo netuNL0
N1 = Int(Worksheets("firma").Cells(NL%, KF%))
S0 = S0 + Worksheets("dom").Cells(NP + 200, 9 + 4 * N1)
SNE = SNE + Worksheets("dom").Cells(NP + 200, 8 + 4 * N1)
SPLUS = SPLUS + Worksheets("dom").Cells(NP + 200, 7 + 4 * N1)
netuNL0: Next NL%

netplanet:
    For NL% = 5 To 7
    If Int(Worksheets("firma").Cells(NL%, KF%)) = 0 Then GoTo netNL
    D1 = Int(Worksheets("firma").Cells(NL%, KF%))
    For NR% = 5 To 7
    If Int(Worksheets("firma").Cells(NR%, (KF% + 2))) = 0 Then GoTo netNR
    D2 = Int(Worksheets("firma").Cells(NR%, (KF% + 2)))
    S0 = S0 + Int(Worksheets("dom").Cells((NTAB + D1), (9 + 4 * D2)))
    SNE = SNE + Int(Worksheets("dom").Cells((NTAB + D1), (8 + 4 * D2)))
    SPLUS = SPLUS + Int(Worksheets("dom").Cells((NTAB + D1), (7 + 4 * D2)))
netNR:     Next NR%
netNL:     Next NL%

If Worksheets("firma").Cells(5, (KF% + 1)) = "" Then SUM = SPLUS + SNE + S0
If Worksheets("firma").Cells(5, (KF% + 1)) = "#" And Worksheets("firma").Cells(11, KF%) = "#" Then SUM = SNE + S0
If Worksheets("firma").Cells(5, (KF% + 1)) = "&" And Worksheets("firma").Cells(11, KF%) = "&" Then SUM = SPLUS + S0
If Worksheets("firma").Cells(5, (KF% + 1)) = "#" And Worksheets("firma").Cells(11, KF%) = "&" Then SUM = SNE
If Worksheets("firma").Cells(5, (KF% + 1)) = "&" And Worksheets("firma").Cells(11, KF%) = "#" Then SUM = SPLUS
If Int(Worksheets("firma").Cells(10, KF%)) <= SUM Then
Worksheets("firma").Cells(STROK, KF%) = SUM
Worksheets("firma").Cells(STROK, KF% + 1) = SPLUS
Worksheets("firma").Cells(STROK, KF% + 2) = SNE
Worksheets("firma").Cells(STROK, KF% + 3) = S0
Else
End If

If Worksheets("firma").Cells(STROK, KF%) > 0 And Int(Worksheets("firma").Cells(4, KF%)) = 0 Then SOVPAD = SOVPAD + 1
If Worksheets("firma").Cells(STROK, KF%) > 0 And Int(Worksheets("firma").Cells(4, KF%)) > 0 Then NESOVPAD = NESOVPAD + 1

netf: Next KF%

If SOVPAD >= 1 Then Worksheets("firma").Cells(STROK, 9) = SOVPAD
SOVPAD = 0
If NESOVPAD >= 1 Then Worksheets("firma").Cells(STROK, 10) = NESOVPAD
NESOVPAD = 0

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .ScreenUpdating = True
        End With
Sheets("firma").Select
STROK = STROK + 1
Worksheets("firma").Cells(8, 2) = Int((n% / NDAY) * 100 + 1 / 2)
Next n%

Worksheets("natal").Cells(8, 2) = Worksheets("natal").Cells(58, 2)
Worksheets("natal").Cells(8, 3) = Worksheets("natal").Cells(58, 3)
Worksheets("natal").Cells(8, 4) = Worksheets("natal").Cells(58, 4)
Worksheets("natal").Cells(8, 5) = Worksheets("natal").Cells(58, 5)
Worksheets("natal").Cells(8, 6) = Worksheets("natal").Cells(58, 6)
Worksheets("natal").Cells(8, 7) = Worksheets("natal").Cells(58, 7)

Worksheets("natal").Cells(2, 2) = Worksheets("natal").Cells(62, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("natal").Cells(62, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("natal").Cells(62, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("natal").Cells(62, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("natal").Cells(62, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("natal").Cells(62, 7)

Call radiks
Sheets("firma").Select
ActiveWorkbook.save

End Sub

Sub sutkiMP()
Dim LatGrad As Double
Dim MCMP As Double
Dim MMC As Double
Dim ZV As Double
Dim V As Double
Dim T1 As Double
Dim T2 As Double
LatGrad = Worksheets("natal").Cells(36, 6)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
MCMP = Worksheets("natal").Cells(31, 6) + 1 '|fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd||fffd||fffd||fffd||fffd|
If MCMP > 360 Then MCMP = MCMP - 360
ZV = ZVMC(MCMP) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
Worksheets("natal").Cells((M% + 111), 2) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(4, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

For K% = 12 To 23
T2 = Worksheets("natal").Cells(100 + K%, 2)
T1 = Worksheets("natal").Cells(10 + K%, 6)
If T1 < 30 And T2 > 330 Then V = T2 - T1 - 360
If T2 < 30 And T1 > 330 Then V = 360 - (T2 - T1)
If Abs(T2 - T1) < 30 Then V = T2 - T1
Worksheets("natal").Cells(100 + K%, 3) = V / 365
Next K%

For K% = 101 To 111
Worksheets("natal").Cells(K%, 3) = Worksheets("natal").Cells(K%, 3) / 365
Next K%

End Sub
Sub sutkiBP()
Dim LatGrad As Double
Dim MCBP As Double
Dim MMC As Double
Dim ZV As Double
Dim V As Double
Dim T1 As Double
Dim T2 As Double
LatGrad = Worksheets("natal").Cells(36, 6)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
MCBP = Worksheets("natal").Cells(31, 8) + 30 / 365
If MCBP > 360 Then MCBP = MCBP - 360
ZV = ZVMC(MCBP) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
Worksheets("natal").Cells((M% + 111), 4) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(5, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

For K% = 12 To 23
T1 = Worksheets("natal").Cells(10 + K%, 8)
T2 = Worksheets("natal").Cells(100 + K%, 4)
If T1 < 30 And T2 > 330 Then V = T2 - T1 - 360
If T2 < 30 And T1 > 330 Then V = 360 - (T2 - T1)
If Abs(T2 - T1) < 30 Then V = T2 - T1
Worksheets("natal").Cells(100 + K%, 5) = V
Next K%

For K% = 101 To 111
Worksheets("natal").Cells(K%, 5) = Worksheets("natal").Cells(K%, 5) / 12
Next K%

End Sub
Sub DATAvJD(DEN As Integer, MES As Integer, GOD As Integer, CHAS As Integer, MIN As Integer, SEK As Integer)

Dim K As Long

Worksheets("natal").Cells(81, 1) = 0

Worksheets("natal").Cells(81, 2) = DEN
Worksheets("natal").Cells(81, 3) = MES
Worksheets("natal").Cells(81, 4) = GOD
Worksheets("natal").Cells(81, 5) = CHAS
Worksheets("natal").Cells(81, 6) = MIN
Worksheets("natal").Cells(81, 7) = SEK

For K = 201 To 91877
If DEN = Int(Worksheets("natal").Cells(K, 41)) And MES = Int(Worksheets("natal").Cells(K, 42)) And GOD = Int(Worksheets("natal").Cells(K, 43)) Then
Worksheets("natal").Cells(81, 1) = Worksheets("natal").Cells(K, 40) + CHAS / 24 + MIN / 1440 + SEK / 86400
Worksheets("natal").Cells(81, 8) = K
Exit For
Else
End If
Next K

End Sub
Sub JDvDATAMC(JD As Double)
Dim K As Long
Dim B As Double
B = JD - Int(JD)

'If JD > 2479818 Then JD = 2479818

For K = 201 To 91877
If Int(JD) = Int(Worksheets("natal").Cells(K, 40)) Then
Worksheets("natal").Cells(71, 1) = JD
Worksheets("natal").Cells(71, 2) = Int(Worksheets("natal").Cells(K, 41))
Worksheets("natal").Cells(71, 3) = Int(Worksheets("natal").Cells(K, 42))
Worksheets("natal").Cells(71, 4) = Int(Worksheets("natal").Cells(K, 43))
Worksheets("natal").Cells(71, 5) = Int(B * 24)
Worksheets("natal").Cells(71, 6) = Int(((B * 24) - Int(B * 24)) * 60 + 1 / 2)
Worksheets("natal").Cells(71, 7) = Int((((B * 24) - Int(B * 24)) * 60 - Int(((B * 24) - Int(B * 24)) * 60)) * 60)
Worksheets("natal").Cells(71, 8) = K
Exit For
Else
End If
Next K

End Sub

Sub JDvDATA(JD As Double)

Dim K As Long
Dim B As Double
B = JD - Int(JD)

If JD > 2488434 Then JD = 2488434

For K = 201 To 91877
If Int(JD) = Int(Worksheets("natal").Cells(K, 40)) Then
Worksheets("natal").Cells(71, 1) = JD
Worksheets("natal").Cells(71, 2) = Int(Worksheets("natal").Cells(K, 41))
Worksheets("natal").Cells(71, 3) = Int(Worksheets("natal").Cells(K, 42))
Worksheets("natal").Cells(71, 4) = Int(Worksheets("natal").Cells(K, 43))
Worksheets("natal").Cells(71, 5) = Int(B * 24) '|fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(71, 6) = Int(((B * 24) - Int(B * 24)) * 60) '|fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(71, 7) = Int((((B * 24) - Int(B * 24)) * 60 - Int(((B * 24) - Int(B * 24)) * 60)) * 60)
Worksheets("natal").Cells(71, 8) = K
Exit For
Else
End If
Next K

End Sub

Sub goroskop()
Attribute goroskop.VB_Description = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| man |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| fem"
Attribute goroskop.VB_ProcData.VB_Invoke_Func = "m\n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
'
'======= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ============
With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Call proverka

Call radiks

Sheets("natal").Select
    Range("A1:G8").Select
    Selection.Copy
    
    Sheets("MP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    Range("A1:G8").Select
    ActiveSheet.Paste
    Range("E11:AB33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 26
    Range("E41:AB64").Select
    Selection.ClearContents
    
    Sheets("natal").Select
    Selection.Copy
    
    Sheets("BP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    Range("A1:G8").Select
    ActiveSheet.Paste
    Range("E11:AB33").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 31
    Range("E41:AB64").Select
    Selection.ClearContents
    
    Sheets("TR").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    Range("E11:AB21").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 9
    Range("E41:AB64").Select
    Selection.ClearContents
    
    Sheets("natal").Select
    Range("L11:BP33").Select
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
    Range("A10").Select
    
If Worksheets("natal").Cells(4, 16) > 0 Then Call progress

If Worksheets("natal").Cells(5, 16) > 0 Then Call bprogress

If Worksheets("natal").Cells(6, 16) > 0 Then Call tranzit

    Sheets("MP").Select
    ActiveWindow.ScrollColumn = 5
    Sheets("BP").Select
    ActiveWindow.ScrollColumn = 5
    Sheets("TR").Select
    ActiveWindow.ScrollColumn = 5

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

Worksheets("natal").Select
ActiveWindow.ScrollColumn = 12
Range("A10").Select

End Sub
Sub proverkasin()
'======= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ============
Dim t As Long
Dim NAME As String

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(2, 2)) < 1 Or Int(Worksheets("sina").Cells(2, 2)) > 31 Then
   Worksheets("sina").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(2, 3)) < 1 Or Int(Worksheets("sina").Cells(2, 3)) > 12 Then
   Worksheets("sina").Cells(2, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(2, 4)) < 1850 Or Int(Worksheets("sina").Cells(2, 4)) > 2070 Then
   Worksheets("sina").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(2, 5)) < 0 Or Int(Worksheets("sina").Cells(2, 5)) > 23 Then
   Worksheets("sina").Cells(2, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(2, 6)) < 0 Or Int(Worksheets("sina").Cells(2, 6)) > 59 Then
   Worksheets("sina").Cells(2, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(2, 7)) < 0 Or Int(Worksheets("sina").Cells(2, 7)) > 59 Then
   Worksheets("sina").Cells(2, 7).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(3, 2)) < 1 Or Int(Worksheets("sina").Cells(3, 2)) > 31 Then
   Worksheets("sina").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(3, 3)) < 1 Or Int(Worksheets("sina").Cells(3, 3)) > 12 Then
   Worksheets("sina").Cells(3, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(3, 4)) < 1850 Or Int(Worksheets("sina").Cells(3, 4)) > 2070 Then
   Worksheets("sina").Cells(3, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(3, 5)) < 0 Or Int(Worksheets("sina").Cells(3, 5)) > 23 Then
   Worksheets("sina").Cells(3, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(3, 6)) < 0 Or Int(Worksheets("sina").Cells(3, 6)) > 59 Then
   Worksheets("sina").Cells(3, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("sina").Cells(3, 7)) < 0 Or Int(Worksheets("sina").Cells(3, 7)) > 59 Then
   Worksheets("sina").Cells(3, 7).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
   
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd|
If Int(Worksheets("sina").Cells(7, 2)) < 0 Or Int(Worksheets("sina").Cells(7, 2)) > 359 Then
   Worksheets("sina").Cells(7, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Int(Worksheets("sina").Cells(8, 2)) < 0 Or Int(Worksheets("sina").Cells(8, 2)) > 359 Then
   Worksheets("sina").Cells(8, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("sina").Cells(7, 5))) > 66 Then
   Worksheets("sina").Cells(7, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("sina").Cells(8, 5))) > 66 Then
   Worksheets("sina").Cells(8, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Abs(Int(Worksheets("sina").Cells(7, 3))) > 59 Then
   Worksheets("sina").Cells(7, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("sina").Cells(7, 6))) > 59 Then
   Worksheets("sina").Cells(7, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("sina").Cells(8, 3))) > 59 Then
   Worksheets("sina").Cells(8, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("sina").Cells(8, 6))) > 59 Then
   Worksheets("sina").Cells(8, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd|
If Trim(Worksheets("sina").Cells(7, 4)) = "|fffd|" Or Trim(Worksheets("sina").Cells(7, 4)) = "|fffd|" Then
   Worksheets("sina").Cells(7, 2) = 360 - (Worksheets("sina").Cells(7, 2) + Worksheets("sina").Cells(7, 3) / 60)
   Worksheets("sina").Cells(7, 3) = Int((Worksheets("sina").Cells(7, 2) - Int(Worksheets("sina").Cells(7, 2))) * 60 + 0.5)
   Worksheets("sina").Cells(7, 2) = Int(Worksheets("sina").Cells(7, 2))
   Worksheets("sina").Cells(7, 4) = "|fffd|"
   Else
   Worksheets("sina").Cells(7, 4) = "|fffd|"
   End If
If Trim(Worksheets("sina").Cells(8, 4)) = "|fffd|" Or Trim(Worksheets("sina").Cells(8, 4)) = "|fffd|" Then
   Worksheets("sina").Cells(8, 2) = 360 - (Worksheets("sina").Cells(8, 2) + Worksheets("sina").Cells(8, 3) / 60)
   Worksheets("sina").Cells(8, 3) = Int((Worksheets("sina").Cells(8, 2) - Int(Worksheets("sina").Cells(8, 2))) * 60 + 0.5)
   Worksheets("sina").Cells(8, 2) = Int(Worksheets("sina").Cells(8, 2))
   Worksheets("sina").Cells(8, 4) = "|fffd|"
   Else
   Worksheets("sina").Cells(8, 4) = "|fffd|"
   End If
If Trim(Worksheets("sina").Cells(7, 7)) = "|fffd|" Or Trim(Worksheets("sina").Cells(7, 7)) = "|fffd|" Then
   Worksheets("sina").Cells(7, 5) = 0 - Abs(Worksheets("sina").Cells(7, 5))
   Worksheets("sina").Cells(7, 6) = 0 - Abs(Worksheets("sina").Cells(7, 6))
   Worksheets("sina").Cells(7, 7) = "|fffd|"
   Else
   Worksheets("sina").Cells(7, 7) = "|fffd|"
   End If
If Trim(Worksheets("sina").Cells(8, 7)) = "|fffd|" Or Trim(Worksheets("sina").Cells(8, 7)) = "|fffd|" Then
   Worksheets("sina").Cells(8, 5) = 0 - Abs(Worksheets("sina").Cells(8, 5))
   Worksheets("sina").Cells(8, 6) = 0 - Abs(Worksheets("sina").Cells(8, 6))
   Worksheets("sina").Cells(8, 7) = "|fffd|"
   Else
   Worksheets("sina").Cells(8, 7) = "|fffd|"
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Then
   Else
   Worksheets("sina").Cells(2, 8).Select
   MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   End If
If Trim(Worksheets("sina").Cells(3, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(3, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(3, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(3, 8)) = "|fffd|" Then
   Else
   Worksheets("sina").Cells(3, 8).Select
   MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("sina").Cells(2, 1)) = "" Then
   Worksheets("sina").Cells(2, 1).Select
   MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Trim(Worksheets("sina").Cells(3, 1)) = "" Then
   Worksheets("sina").Cells(3, 1).Select
   MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Or Trim(Worksheets("sina").Cells(2, 8)) = "|fffd|" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 2
   For K% = 1 To 8
   Worksheets("sina").Cells(100, K%) = Worksheets("sina").Cells(2, K%)
   Worksheets("sina").Cells(2, K%) = Worksheets("sina").Cells(3, K%)
   Worksheets("sina").Cells(3, K%) = Worksheets("sina").Cells(100, K%)
   Next K%
   For K% = 1 To 7
   Worksheets("sina").Cells(101, K%) = Worksheets("sina").Cells(7, K%)
   Worksheets("sina").Cells(7, K%) = Worksheets("sina").Cells(8, K%)
   Worksheets("sina").Cells(8, K%) = Worksheets("sina").Cells(101, K%)
   Next K%
   Else
   End If
For K% = 2 To 3
If Trim(Worksheets("sina").Cells(K%, 8)) = "|fffd|" Then Worksheets("sina").Cells(K%, 8) = "|fffd|"
If Trim(Worksheets("sina").Cells(K%, 8)) = "|fffd|" Then Worksheets("sina").Cells(K%, 8) = "|fffd|"
Next K%
Worksheets("sina").Cells(7, 1) = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(8, 1) = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Trim(Worksheets("sina").Cells(3, 1))
Worksheets("sina").Cells(10, 2) = Trim(Worksheets("sina").Cells(2, 1))
Worksheets("sina").Cells(10, 4) = Trim(Worksheets("sina").Cells(3, 1))
   
End Sub

Sub medic()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

Worksheets("med").Select
Rows("31:606").Select
Selection.Font.Bold = True
    Selection.Font.Bold = False
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
Selection.ClearContents

Worksheets("natal").Cells(40, 2) = 1

natal
medlokal
For K% = 1 To 12
For NL% = 1 To 8
Worksheets("med").Cells(K% + 10, NL% + 21) = Worksheets("med").Cells(K% + 10, NL% + 11)
Next NL%
Next K%

karma
medkarma
For K% = 1 To 12
For NL% = 1 To 8
Worksheets("med").Cells(K% + 10, NL% + 11) = Worksheets("med").Cells(K% + 10, NL% + 21)
Next NL%
Next K%

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
End With

radiks

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
Worksheets("med").Cells(K% + 10, 8) = Worksheets("med").Cells(K% + 10, 2) + Worksheets("med").Cells(K% + 10, 4) + Worksheets("med").Cells(K% + 10, 6)
Worksheets("med").Cells(K% + 10, 18) = Worksheets("med").Cells(K% + 10, 12) + Worksheets("med").Cells(K% + 10, 14) + Worksheets("med").Cells(K% + 10, 16)
Worksheets("med").Cells(K% + 10, 3) = Worksheets("med").Cells(K% + 10, 2) / 2
Worksheets("med").Cells(K% + 10, 5) = Worksheets("med").Cells(K% + 10, 4) / 2
Worksheets("med").Cells(K% + 10, 7) = Worksheets("med").Cells(K% + 10, 6) / 2
Worksheets("med").Cells(K% + 10, 9) = Worksheets("med").Cells(K% + 10, 8) / 2
Worksheets("med").Cells(K% + 10, 13) = Worksheets("med").Cells(K% + 10, 12) / 2
Worksheets("med").Cells(K% + 10, 15) = Worksheets("med").Cells(K% + 10, 14) / 2
Worksheets("med").Cells(K% + 10, 17) = Worksheets("med").Cells(K% + 10, 16) / 2
Worksheets("med").Cells(K% + 10, 19) = Worksheets("med").Cells(K% + 10, 18) / 2
Worksheets("med").Cells(23, 3) = Worksheets("med").Cells(23, 3) + Worksheets("med").Cells(K% + 10, 3)
Worksheets("med").Cells(23, 5) = Worksheets("med").Cells(23, 5) + Worksheets("med").Cells(K% + 10, 5)
Worksheets("med").Cells(23, 7) = Worksheets("med").Cells(23, 7) + Worksheets("med").Cells(K% + 10, 7)
Worksheets("med").Cells(23, 9) = Worksheets("med").Cells(23, 9) + Worksheets("med").Cells(K% + 10, 9)
Worksheets("med").Cells(23, 13) = Worksheets("med").Cells(23, 13) + Worksheets("med").Cells(K% + 10, 13)
Worksheets("med").Cells(23, 15) = Worksheets("med").Cells(23, 15) + Worksheets("med").Cells(K% + 10, 15)
Worksheets("med").Cells(23, 17) = Worksheets("med").Cells(23, 17) + Worksheets("med").Cells(K% + 10, 17)
Worksheets("med").Cells(23, 19) = Worksheets("med").Cells(23, 19) + Worksheets("med").Cells(K% + 10, 19)
Next K%

Worksheets("med").Select
ActiveWindow.ScrollRow = 8
ActiveWindow.ScrollColumn = 2

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

End Sub

Sub medkarma()

Dim SUM As Integer

'6, 8, 12 |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
Worksheets("med").Cells(K% + 10, 2) = Worksheets("dom").Cells(K% + 10, 32) + Worksheets("dom").Cells(K% + 10, 33)
Worksheets("med").Cells(K% + 10, 4) = Worksheets("dom").Cells(K% + 10, 40) + Worksheets("dom").Cells(K% + 10, 41)
Worksheets("med").Cells(K% + 10, 6) = Worksheets("dom").Cells(K% + 10, 56) + Worksheets("dom").Cells(K% + 10, 57)
Next K%

'6, 8, 12 |fffd||fffd||fffd|, 1 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(11, 2) = Worksheets("med").Cells(11, 2) + Worksheets("dom").Cells(210, 32) + Worksheets("dom").Cells(210, 33)
Worksheets("med").Cells(11, 4) = Worksheets("med").Cells(11, 4) + Worksheets("dom").Cells(210, 40) + Worksheets("dom").Cells(210, 41)
Worksheets("med").Cells(11, 6) = Worksheets("med").Cells(11, 6) + Worksheets("dom").Cells(210, 56) + Worksheets("dom").Cells(210, 57)
If Trim(Worksheets("natal").Cells(15, 3)) = "R" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(11, 2) = Worksheets("med").Cells(11, 2) + Worksheets("dom").Cells(205, 32) + Worksheets("dom").Cells(205, 33)
Worksheets("med").Cells(11, 4) = Worksheets("med").Cells(11, 4) + Worksheets("dom").Cells(205, 40) + Worksheets("dom").Cells(205, 41)
Worksheets("med").Cells(11, 6) = Worksheets("med").Cells(11, 6) + Worksheets("dom").Cells(205, 56) + Worksheets("dom").Cells(205, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 2 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(12, 2) = Worksheets("med").Cells(12, 2) + Worksheets("dom").Cells(204, 32) + Worksheets("dom").Cells(204, 33)
Worksheets("med").Cells(12, 4) = Worksheets("med").Cells(12, 4) + Worksheets("dom").Cells(204, 40) + Worksheets("dom").Cells(204, 41)
Worksheets("med").Cells(12, 6) = Worksheets("med").Cells(12, 6) + Worksheets("dom").Cells(204, 56) + Worksheets("dom").Cells(204, 57)
'6, 8, 12 |fffd||fffd||fffd|, 3 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(13, 2) = Worksheets("med").Cells(13, 2) + Worksheets("dom").Cells(203, 32) + Worksheets("dom").Cells(203, 33)
Worksheets("med").Cells(13, 4) = Worksheets("med").Cells(13, 4) + Worksheets("dom").Cells(203, 40) + Worksheets("dom").Cells(203, 41)
Worksheets("med").Cells(13, 6) = Worksheets("med").Cells(13, 6) + Worksheets("dom").Cells(203, 56) + Worksheets("dom").Cells(203, 57)
'6, 8, 12 |fffd||fffd||fffd|, 4 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(14, 2) = Worksheets("med").Cells(14, 2) + Worksheets("dom").Cells(202, 32) + Worksheets("dom").Cells(202, 33)
Worksheets("med").Cells(14, 4) = Worksheets("med").Cells(14, 4) + Worksheets("dom").Cells(202, 40) + Worksheets("dom").Cells(202, 41)
Worksheets("med").Cells(14, 6) = Worksheets("med").Cells(14, 6) + Worksheets("dom").Cells(202, 56) + Worksheets("dom").Cells(202, 57)
'6, 8, 12 |fffd||fffd||fffd|, 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(15, 2) = Worksheets("med").Cells(15, 2) + Worksheets("dom").Cells(201, 32) + Worksheets("dom").Cells(201, 33)
Worksheets("med").Cells(15, 4) = Worksheets("med").Cells(15, 4) + Worksheets("dom").Cells(201, 40) + Worksheets("dom").Cells(201, 41)
Worksheets("med").Cells(15, 6) = Worksheets("med").Cells(15, 6) + Worksheets("dom").Cells(201, 56) + Worksheets("dom").Cells(201, 57)
'6, 8, 12 |fffd||fffd||fffd|, 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(16, 2) = Worksheets("med").Cells(16, 2) + Worksheets("dom").Cells(203, 32) + Worksheets("dom").Cells(203, 33)
Worksheets("med").Cells(16, 4) = Worksheets("med").Cells(16, 4) + Worksheets("dom").Cells(203, 40) + Worksheets("dom").Cells(203, 41)
Worksheets("med").Cells(16, 6) = Worksheets("med").Cells(16, 6) + Worksheets("dom").Cells(203, 56) + Worksheets("dom").Cells(203, 57)
'6, 8, 12 |fffd||fffd||fffd|, 7 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(17, 2) = Worksheets("med").Cells(17, 2) + Worksheets("dom").Cells(204, 32) + Worksheets("dom").Cells(204, 33)
Worksheets("med").Cells(17, 4) = Worksheets("med").Cells(17, 4) + Worksheets("dom").Cells(204, 40) + Worksheets("dom").Cells(204, 41)
Worksheets("med").Cells(17, 6) = Worksheets("med").Cells(17, 6) + Worksheets("dom").Cells(204, 56) + Worksheets("dom").Cells(204, 57)
'6, 8, 12 |fffd||fffd||fffd|, 8 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(18, 2) = Worksheets("med").Cells(18, 2) + Worksheets("dom").Cells(205, 32) + Worksheets("dom").Cells(205, 33)
Worksheets("med").Cells(18, 4) = Worksheets("med").Cells(18, 4) + Worksheets("dom").Cells(205, 40) + Worksheets("dom").Cells(205, 41)
Worksheets("med").Cells(18, 6) = Worksheets("med").Cells(18, 6) + Worksheets("dom").Cells(205, 56) + Worksheets("dom").Cells(205, 57)
If Trim(Worksheets("natal").Cells(20, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(18, 2) = Worksheets("med").Cells(18, 2) + Worksheets("dom").Cells(210, 32) + Worksheets("dom").Cells(210, 33)
Worksheets("med").Cells(18, 4) = Worksheets("med").Cells(18, 4) + Worksheets("dom").Cells(210, 40) + Worksheets("dom").Cells(210, 41)
Worksheets("med").Cells(18, 6) = Worksheets("med").Cells(18, 6) + Worksheets("dom").Cells(210, 56) + Worksheets("dom").Cells(210, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 9 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(19, 2) = Worksheets("med").Cells(19, 2) + Worksheets("dom").Cells(206, 32) + Worksheets("dom").Cells(206, 33)
Worksheets("med").Cells(19, 4) = Worksheets("med").Cells(19, 4) + Worksheets("dom").Cells(206, 40) + Worksheets("dom").Cells(206, 41)
Worksheets("med").Cells(19, 6) = Worksheets("med").Cells(19, 6) + Worksheets("dom").Cells(206, 56) + Worksheets("dom").Cells(206, 57)
If Trim(Worksheets("natal").Cells(19, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(19, 2) = Worksheets("med").Cells(19, 2) + Worksheets("dom").Cells(209, 32) + Worksheets("dom").Cells(209, 33)
Worksheets("med").Cells(19, 4) = Worksheets("med").Cells(19, 4) + Worksheets("dom").Cells(209, 40) + Worksheets("dom").Cells(209, 41)
Worksheets("med").Cells(19, 6) = Worksheets("med").Cells(19, 6) + Worksheets("dom").Cells(209, 56) + Worksheets("dom").Cells(209, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 10 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(20, 2) = Worksheets("med").Cells(20, 2) + Worksheets("dom").Cells(207, 32) + Worksheets("dom").Cells(207, 33)
Worksheets("med").Cells(20, 4) = Worksheets("med").Cells(20, 4) + Worksheets("dom").Cells(207, 40) + Worksheets("dom").Cells(207, 41)
Worksheets("med").Cells(20, 6) = Worksheets("med").Cells(20, 6) + Worksheets("dom").Cells(207, 56) + Worksheets("dom").Cells(207, 57)
If Trim(Worksheets("natal").Cells(18, 3)) = "R" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(20, 2) = Worksheets("med").Cells(20, 2) + Worksheets("dom").Cells(208, 32) + Worksheets("dom").Cells(208, 33)
Worksheets("med").Cells(20, 4) = Worksheets("med").Cells(20, 4) + Worksheets("dom").Cells(208, 40) + Worksheets("dom").Cells(208, 41)
Worksheets("med").Cells(20, 6) = Worksheets("med").Cells(20, 6) + Worksheets("dom").Cells(208, 56) + Worksheets("dom").Cells(208, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 11 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(21, 2) = Worksheets("med").Cells(21, 2) + Worksheets("dom").Cells(208, 32) + Worksheets("dom").Cells(208, 33)
Worksheets("med").Cells(21, 4) = Worksheets("med").Cells(21, 4) + Worksheets("dom").Cells(208, 40) + Worksheets("dom").Cells(208, 41)
Worksheets("med").Cells(21, 6) = Worksheets("med").Cells(21, 6) + Worksheets("dom").Cells(208, 56) + Worksheets("dom").Cells(208, 57)
If Trim(Worksheets("natal").Cells(17, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(21, 2) = Worksheets("med").Cells(21, 2) + Worksheets("dom").Cells(207, 32) + Worksheets("dom").Cells(207, 33)
Worksheets("med").Cells(21, 4) = Worksheets("med").Cells(21, 4) + Worksheets("dom").Cells(207, 40) + Worksheets("dom").Cells(207, 41)
Worksheets("med").Cells(21, 6) = Worksheets("med").Cells(21, 6) + Worksheets("dom").Cells(207, 56) + Worksheets("dom").Cells(207, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(22, 2) = Worksheets("med").Cells(22, 2) + Worksheets("dom").Cells(209, 32) + Worksheets("dom").Cells(209, 33)
Worksheets("med").Cells(22, 4) = Worksheets("med").Cells(22, 4) + Worksheets("dom").Cells(209, 40) + Worksheets("dom").Cells(209, 41)
Worksheets("med").Cells(22, 6) = Worksheets("med").Cells(22, 6) + Worksheets("dom").Cells(209, 56) + Worksheets("dom").Cells(209, 57)
If Trim(Worksheets("natal").Cells(16, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(22, 2) = Worksheets("med").Cells(22, 2) + Worksheets("dom").Cells(206, 32) + Worksheets("dom").Cells(206, 33)
Worksheets("med").Cells(22, 4) = Worksheets("med").Cells(22, 4) + Worksheets("dom").Cells(206, 40) + Worksheets("dom").Cells(206, 41)
Worksheets("med").Cells(22, 6) = Worksheets("med").Cells(22, 6) + Worksheets("dom").Cells(206, 56) + Worksheets("dom").Cells(206, 57)
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 6-6, 8-8, 12-12
For K% = 11 To 1000
If Int(Worksheets("List").Cells(K%, 2)) = 6 And Int(Worksheets("List").Cells(K%, 4)) = 6 And Trim(Worksheets("List").Cells(K%, 3)) = "#" Then Worksheets("med").Cells(16, 2) = Worksheets("med").Cells(16, 2) + 1
If Int(Worksheets("List").Cells(K%, 2)) = 8 And Int(Worksheets("List").Cells(K%, 4)) = 8 And Trim(Worksheets("List").Cells(K%, 3)) = "#" Then Worksheets("med").Cells(18, 4) = Worksheets("med").Cells(18, 4) + 1
If Int(Worksheets("List").Cells(K%, 2)) = 12 And Int(Worksheets("List").Cells(K%, 4)) = 12 And Trim(Worksheets("List").Cells(K%, 3)) = "#" Then Worksheets("med").Cells(22, 6) = Worksheets("med").Cells(22, 6) + 1
Next K%

End Sub

Sub medlokal()
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Dim SUM As Integer

For K% = 1 To 12
Worksheets("med").Cells(K% + 10, 12) = Worksheets("dom").Cells(K% + 30, 32) + Worksheets("dom").Cells(K% + 30, 33)
Worksheets("med").Cells(K% + 10, 14) = Worksheets("dom").Cells(K% + 30, 40) + Worksheets("dom").Cells(K% + 30, 41)
Worksheets("med").Cells(K% + 10, 16) = Worksheets("dom").Cells(K% + 30, 56) + Worksheets("dom").Cells(K% + 30, 57)
Next K%

'6, 8, 12 |fffd||fffd||fffd|, 1 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(11, 12) = Worksheets("med").Cells(11, 12) + Worksheets("dom").Cells(230, 32) + Worksheets("dom").Cells(230, 33)
Worksheets("med").Cells(11, 14) = Worksheets("med").Cells(11, 14) + Worksheets("dom").Cells(230, 40) + Worksheets("dom").Cells(230, 41)
Worksheets("med").Cells(11, 16) = Worksheets("med").Cells(11, 16) + Worksheets("dom").Cells(230, 56) + Worksheets("dom").Cells(230, 57)
If Trim(Worksheets("natal").Cells(15, 3)) = "R" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(11, 12) = Worksheets("med").Cells(11, 12) + Worksheets("dom").Cells(225, 32) + Worksheets("dom").Cells(225, 33)
Worksheets("med").Cells(11, 14) = Worksheets("med").Cells(11, 14) + Worksheets("dom").Cells(225, 40) + Worksheets("dom").Cells(225, 41)
Worksheets("med").Cells(11, 16) = Worksheets("med").Cells(11, 16) + Worksheets("dom").Cells(225, 56) + Worksheets("dom").Cells(225, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 2 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(12, 12) = Worksheets("med").Cells(12, 12) + Worksheets("dom").Cells(224, 32) + Worksheets("dom").Cells(224, 33)
Worksheets("med").Cells(12, 14) = Worksheets("med").Cells(12, 14) + Worksheets("dom").Cells(224, 40) + Worksheets("dom").Cells(224, 41)
Worksheets("med").Cells(12, 16) = Worksheets("med").Cells(12, 16) + Worksheets("dom").Cells(224, 56) + Worksheets("dom").Cells(224, 57)
'6, 8, 12 |fffd||fffd||fffd|, 3 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(13, 12) = Worksheets("med").Cells(13, 12) + Worksheets("dom").Cells(223, 32) + Worksheets("dom").Cells(223, 33)
Worksheets("med").Cells(13, 14) = Worksheets("med").Cells(13, 14) + Worksheets("dom").Cells(223, 40) + Worksheets("dom").Cells(223, 41)
Worksheets("med").Cells(13, 16) = Worksheets("med").Cells(13, 16) + Worksheets("dom").Cells(223, 56) + Worksheets("dom").Cells(223, 57)
'6, 8, 12 |fffd||fffd||fffd|, 4 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(14, 12) = Worksheets("med").Cells(14, 12) + Worksheets("dom").Cells(222, 32) + Worksheets("dom").Cells(222, 33)
Worksheets("med").Cells(14, 14) = Worksheets("med").Cells(14, 14) + Worksheets("dom").Cells(222, 40) + Worksheets("dom").Cells(222, 41)
Worksheets("med").Cells(14, 16) = Worksheets("med").Cells(14, 16) + Worksheets("dom").Cells(222, 56) + Worksheets("dom").Cells(222, 57)
'6, 8, 12 |fffd||fffd||fffd|, 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(15, 12) = Worksheets("med").Cells(15, 12) + Worksheets("dom").Cells(221, 32) + Worksheets("dom").Cells(221, 33)
Worksheets("med").Cells(15, 14) = Worksheets("med").Cells(15, 14) + Worksheets("dom").Cells(221, 40) + Worksheets("dom").Cells(221, 41)
Worksheets("med").Cells(15, 16) = Worksheets("med").Cells(15, 16) + Worksheets("dom").Cells(221, 56) + Worksheets("dom").Cells(221, 57)
'6, 8, 12 |fffd||fffd||fffd|, 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(16, 12) = Worksheets("med").Cells(16, 12) + Worksheets("dom").Cells(223, 32) + Worksheets("dom").Cells(223, 33)
Worksheets("med").Cells(16, 14) = Worksheets("med").Cells(16, 14) + Worksheets("dom").Cells(223, 40) + Worksheets("dom").Cells(223, 41)
Worksheets("med").Cells(16, 16) = Worksheets("med").Cells(16, 16) + Worksheets("dom").Cells(223, 56) + Worksheets("dom").Cells(223, 57)
'6, 8, 12 |fffd||fffd||fffd|, 7 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(17, 12) = Worksheets("med").Cells(17, 12) + Worksheets("dom").Cells(224, 32) + Worksheets("dom").Cells(224, 33)
Worksheets("med").Cells(17, 14) = Worksheets("med").Cells(17, 14) + Worksheets("dom").Cells(224, 40) + Worksheets("dom").Cells(224, 41)
Worksheets("med").Cells(17, 16) = Worksheets("med").Cells(17, 16) + Worksheets("dom").Cells(224, 56) + Worksheets("dom").Cells(224, 57)
'6, 8, 12 |fffd||fffd||fffd|, 8 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(18, 12) = Worksheets("med").Cells(18, 12) + Worksheets("dom").Cells(225, 32) + Worksheets("dom").Cells(225, 33)
Worksheets("med").Cells(18, 14) = Worksheets("med").Cells(18, 14) + Worksheets("dom").Cells(225, 40) + Worksheets("dom").Cells(225, 41)
Worksheets("med").Cells(18, 16) = Worksheets("med").Cells(18, 16) + Worksheets("dom").Cells(225, 56) + Worksheets("dom").Cells(225, 57)
If Trim(Worksheets("natal").Cells(20, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(18, 12) = Worksheets("med").Cells(18, 12) + Worksheets("dom").Cells(230, 32) + Worksheets("dom").Cells(230, 33)
Worksheets("med").Cells(18, 14) = Worksheets("med").Cells(18, 14) + Worksheets("dom").Cells(230, 40) + Worksheets("dom").Cells(230, 41)
Worksheets("med").Cells(18, 16) = Worksheets("med").Cells(18, 16) + Worksheets("dom").Cells(230, 56) + Worksheets("dom").Cells(230, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 9 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(19, 12) = Worksheets("med").Cells(19, 12) + Worksheets("dom").Cells(226, 32) + Worksheets("dom").Cells(226, 33)
Worksheets("med").Cells(19, 14) = Worksheets("med").Cells(19, 14) + Worksheets("dom").Cells(226, 40) + Worksheets("dom").Cells(226, 41)
Worksheets("med").Cells(19, 16) = Worksheets("med").Cells(19, 16) + Worksheets("dom").Cells(226, 56) + Worksheets("dom").Cells(226, 57)
If Trim(Worksheets("natal").Cells(19, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(19, 12) = Worksheets("med").Cells(19, 12) + Worksheets("dom").Cells(229, 32) + Worksheets("dom").Cells(229, 33)
Worksheets("med").Cells(19, 14) = Worksheets("med").Cells(19, 14) + Worksheets("dom").Cells(229, 40) + Worksheets("dom").Cells(229, 41)
Worksheets("med").Cells(19, 16) = Worksheets("med").Cells(19, 16) + Worksheets("dom").Cells(229, 56) + Worksheets("dom").Cells(229, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 10 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(20, 12) = Worksheets("med").Cells(20, 12) + Worksheets("dom").Cells(227, 32) + Worksheets("dom").Cells(227, 33)
Worksheets("med").Cells(20, 14) = Worksheets("med").Cells(20, 14) + Worksheets("dom").Cells(227, 40) + Worksheets("dom").Cells(227, 41)
Worksheets("med").Cells(20, 16) = Worksheets("med").Cells(20, 16) + Worksheets("dom").Cells(227, 56) + Worksheets("dom").Cells(227, 57)
If Trim(Worksheets("natal").Cells(18, 3)) = "R" Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(20, 12) = Worksheets("med").Cells(20, 12) + Worksheets("dom").Cells(228, 32) + Worksheets("dom").Cells(228, 33)
Worksheets("med").Cells(20, 14) = Worksheets("med").Cells(20, 14) + Worksheets("dom").Cells(228, 40) + Worksheets("dom").Cells(228, 41)
Worksheets("med").Cells(20, 16) = Worksheets("med").Cells(20, 16) + Worksheets("dom").Cells(228, 56) + Worksheets("dom").Cells(228, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 11 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(21, 12) = Worksheets("med").Cells(21, 12) + Worksheets("dom").Cells(228, 32) + Worksheets("dom").Cells(228, 33)
Worksheets("med").Cells(21, 14) = Worksheets("med").Cells(21, 14) + Worksheets("dom").Cells(228, 40) + Worksheets("dom").Cells(228, 41)
Worksheets("med").Cells(21, 16) = Worksheets("med").Cells(21, 16) + Worksheets("dom").Cells(228, 56) + Worksheets("dom").Cells(228, 57)
If Trim(Worksheets("natal").Cells(17, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(21, 12) = Worksheets("med").Cells(21, 12) + Worksheets("dom").Cells(227, 32) + Worksheets("dom").Cells(227, 33)
Worksheets("med").Cells(21, 14) = Worksheets("med").Cells(21, 14) + Worksheets("dom").Cells(227, 40) + Worksheets("dom").Cells(227, 41)
Worksheets("med").Cells(21, 16) = Worksheets("med").Cells(21, 16) + Worksheets("dom").Cells(227, 56) + Worksheets("dom").Cells(227, 57)
Else
End If
'6, 8, 12 |fffd||fffd||fffd|, 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(22, 12) = Worksheets("med").Cells(22, 12) + Worksheets("dom").Cells(229, 32) + Worksheets("dom").Cells(229, 33)
Worksheets("med").Cells(22, 14) = Worksheets("med").Cells(22, 14) + Worksheets("dom").Cells(229, 40) + Worksheets("dom").Cells(229, 41)
Worksheets("med").Cells(22, 16) = Worksheets("med").Cells(22, 16) + Worksheets("dom").Cells(229, 56) + Worksheets("dom").Cells(229, 57)
If Trim(Worksheets("natal").Cells(16, 3)) = "R" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("med").Cells(22, 12) = Worksheets("med").Cells(22, 12) + Worksheets("dom").Cells(226, 32) + Worksheets("dom").Cells(226, 33)
Worksheets("med").Cells(22, 14) = Worksheets("med").Cells(22, 14) + Worksheets("dom").Cells(226, 40) + Worksheets("dom").Cells(226, 41)
Worksheets("med").Cells(22, 16) = Worksheets("med").Cells(22, 16) + Worksheets("dom").Cells(226, 56) + Worksheets("dom").Cells(226, 57)
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 6-6, 8-8, 12-12
For K% = 11 To 1000
If Int(Worksheets("List").Cells(K%, 9)) = 6 And Int(Worksheets("List").Cells(K%, 11)) = 6 And Trim(Worksheets("List").Cells(K%, 10)) = "#" Then Worksheets("med").Cells(16, 12) = Worksheets("med").Cells(16, 12) + 1
If Int(Worksheets("List").Cells(K%, 9)) = 8 And Int(Worksheets("List").Cells(K%, 11)) = 8 And Trim(Worksheets("List").Cells(K%, 10)) = "#" Then Worksheets("med").Cells(18, 14) = Worksheets("med").Cells(18, 14) + 1
If Int(Worksheets("List").Cells(K%, 9)) = 12 And Int(Worksheets("List").Cells(K%, 11)) = 12 And Trim(Worksheets("List").Cells(K%, 10)) = "#" Then Worksheets("med").Cells(22, 16) = Worksheets("med").Cells(22, 16) + 1
Next K%

End Sub

Sub vkbaza()

Dim NS As Integer
Dim flagNS As Integer '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim FLAG(19) As Integer
Dim SUM As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 7 To 1000

If Int(Worksheets("k-baza").Cells(K%, 2)) = Int(Worksheets("natal").Cells(2, 2)) Then FLAG(2) = 1
If Int(Worksheets("k-baza").Cells(K%, 3)) = Int(Worksheets("natal").Cells(2, 3)) Then FLAG(3) = 1
If Int(Worksheets("k-baza").Cells(K%, 4)) = Int(Worksheets("natal").Cells(2, 4)) Then FLAG(4) = 1
If Int(Worksheets("k-baza").Cells(K%, 5)) = Int(Worksheets("natal").Cells(2, 5)) Then FLAG(5) = 1
If Int(Worksheets("k-baza").Cells(K%, 6)) = Int(Worksheets("natal").Cells(2, 6)) Then FLAG(6) = 1
If Int(Worksheets("k-baza").Cells(K%, 7)) = Int(Worksheets("natal").Cells(2, 7)) Then FLAG(7) = 1
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("k-baza").Cells(K%, 8)) = Int(Worksheets("natal").Cells(7, 2)) Then FLAG(8) = 1
If Int(Worksheets("k-baza").Cells(K%, 9)) = Int(Worksheets("natal").Cells(7, 3)) Then FLAG(9) = 1
If Trim(Worksheets("k-baza").Cells(K%, 10)) = Trim(Worksheets("natal").Cells(7, 4)) Then FLAG(10) = 1
If Int(Worksheets("k-baza").Cells(K%, 11)) = Int(Worksheets("natal").Cells(7, 5)) Then FLAG(11) = 1
If Int(Worksheets("k-baza").Cells(K%, 12)) = Int(Worksheets("natal").Cells(7, 6)) Then FLAG(12) = 1
If Trim(Worksheets("k-baza").Cells(K%, 13)) = Trim(Worksheets("natal").Cells(7, 7)) Then FLAG(13) = 1
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("k-baza").Cells(K%, 14)) = Int(Worksheets("natal").Cells(8, 2)) Then FLAG(14) = 1
If Int(Worksheets("k-baza").Cells(K%, 15)) = Int(Worksheets("natal").Cells(8, 3)) Then FLAG(15) = 1
If Trim(Worksheets("k-baza").Cells(K%, 16)) = Trim(Worksheets("natal").Cells(8, 4)) Then FLAG(16) = 1
If Int(Worksheets("k-baza").Cells(K%, 17)) = Int(Worksheets("natal").Cells(8, 5)) Then FLAG(17) = 1
If Int(Worksheets("k-baza").Cells(K%, 18)) = Int(Worksheets("natal").Cells(8, 6)) Then FLAG(18) = 1
If Trim(Worksheets("k-baza").Cells(K%, 19)) = Trim(Worksheets("natal").Cells(8, 7)) Then FLAG(19) = 1

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For M% = 2 To 19
SUM = SUM + FLAG(M%)
Next M%

If SUM = 18 Then
NS = K%
Worksheets("k-baza").Select
ActiveWindow.ScrollRow = NS
Worksheets("k-baza").Cells(NS, 1).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
End
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
SUM = 0
For M% = 1 To 19
FLAG(M%) = 0
Next M%

Next K%


'===================================
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
flagNS = 1
For K% = 7 To 1000
    For M% = 2 To 4
    If Int(Worksheets("k-baza").Cells(K%, M%)) = 0 Then flagNS = 0
    Next M%
If flagNS = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
NS = K%
Exit For
Else
End If
Next K%

If NS% > 6 Then

'|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("k-baza").Cells(NS, 2) = Worksheets("natal").Cells(2, 2)
Worksheets("k-baza").Cells(NS, 3) = Worksheets("natal").Cells(2, 3)
Worksheets("k-baza").Cells(NS, 4) = Worksheets("natal").Cells(2, 4)
Worksheets("k-baza").Cells(NS, 5) = Worksheets("natal").Cells(2, 5)
Worksheets("k-baza").Cells(NS, 6) = Worksheets("natal").Cells(2, 6)
Worksheets("k-baza").Cells(NS, 7) = Worksheets("natal").Cells(2, 7)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("k-baza").Cells(NS, 8) = Worksheets("natal").Cells(7, 2)
Worksheets("k-baza").Cells(NS, 9) = Worksheets("natal").Cells(7, 3)
Worksheets("k-baza").Cells(NS, 10) = Worksheets("natal").Cells(7, 4)
Worksheets("k-baza").Cells(NS, 11) = Worksheets("natal").Cells(7, 5)
Worksheets("k-baza").Cells(NS, 12) = Worksheets("natal").Cells(7, 6)
Worksheets("k-baza").Cells(NS, 13) = Worksheets("natal").Cells(7, 7)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("k-baza").Cells(NS, 14) = Worksheets("natal").Cells(8, 2)
Worksheets("k-baza").Cells(NS, 15) = Worksheets("natal").Cells(8, 3)
Worksheets("k-baza").Cells(NS, 16) = Worksheets("natal").Cells(8, 4)
Worksheets("k-baza").Cells(NS, 17) = Worksheets("natal").Cells(8, 5)
Worksheets("k-baza").Cells(NS, 18) = Worksheets("natal").Cells(8, 6)
Worksheets("k-baza").Cells(NS, 19) = Worksheets("natal").Cells(8, 7)

Worksheets("k-baza").Select
ActiveWindow.ScrollRow = NS
Worksheets("k-baza").Cells(NS, 1) = ""
Worksheets("k-baza").Cells(NS, 1).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.")

Else ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("k-baza").Select
Worksheets("k-baza").Cells(4, 1).Select
MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.")
End If


End Sub
Sub izkbaza()

Dim NS As Integer

NS = Int(Worksheets("k-baza").Cells(2, 4))

'|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(2, 2) = Worksheets("k-baza").Cells(NS, 2)
Worksheets("natal").Cells(2, 3) = Worksheets("k-baza").Cells(NS, 3)
Worksheets("natal").Cells(2, 4) = Worksheets("k-baza").Cells(NS, 4)
Worksheets("natal").Cells(2, 5) = Worksheets("k-baza").Cells(NS, 5)
Worksheets("natal").Cells(2, 6) = Worksheets("k-baza").Cells(NS, 6)
Worksheets("natal").Cells(2, 7) = Worksheets("k-baza").Cells(NS, 7)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(7, 2) = Worksheets("k-baza").Cells(NS, 8)
Worksheets("natal").Cells(7, 3) = Worksheets("k-baza").Cells(NS, 9)
Worksheets("natal").Cells(7, 4) = Worksheets("k-baza").Cells(NS, 10)
Worksheets("natal").Cells(7, 5) = Worksheets("k-baza").Cells(NS, 11)
Worksheets("natal").Cells(7, 6) = Worksheets("k-baza").Cells(NS, 12)
Worksheets("natal").Cells(7, 7) = Worksheets("k-baza").Cells(NS, 13)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(8, 2) = Worksheets("k-baza").Cells(NS, 14)
Worksheets("natal").Cells(8, 3) = Worksheets("k-baza").Cells(NS, 15)
Worksheets("natal").Cells(8, 4) = Worksheets("k-baza").Cells(NS, 16)
Worksheets("natal").Cells(8, 5) = Worksheets("k-baza").Cells(NS, 17)
Worksheets("natal").Cells(8, 6) = Worksheets("k-baza").Cells(NS, 18)
Worksheets("natal").Cells(8, 7) = Worksheets("k-baza").Cells(NS, 19)

Worksheets("natal").Select

End Sub
Sub proverka()
'======= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ============
Worksheets("natal").Select

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 3)) < 1 Or Int(Worksheets("natal").Cells(2, 3)) > 12 Then
   Worksheets("natal").Cells(2, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 2)) < 1 Or Int(Worksheets("natal").Cells(2, 2)) > 31 Then
   Worksheets("natal").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 3)) = 2 And Int(Worksheets("natal").Cells(2, 2)) > 29 Then
   Worksheets("natal").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 3)) = 4 And Int(Worksheets("natal").Cells(2, 2)) > 30 Then
   Worksheets("natal").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 3)) = 6 And Int(Worksheets("natal").Cells(2, 2)) > 30 Then
   Worksheets("natal").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 3)) = 9 And Int(Worksheets("natal").Cells(2, 2)) > 30 Then
   Worksheets("natal").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 3)) = 11 And Int(Worksheets("natal").Cells(2, 2)) > 30 Then
   Worksheets("natal").Cells(2, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 4)) < 1850 Or Int(Worksheets("natal").Cells(2, 4)) > 2039 Then
   'Worksheets("natal").Cells(2, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 5)) < 0 Or Int(Worksheets("natal").Cells(2, 5)) > 23 Then
   Worksheets("natal").Cells(2, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 6)) < 0 Or Int(Worksheets("natal").Cells(2, 6)) > 59 Then
   Worksheets("natal").Cells(2, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(2, 7)) < 0 Or Int(Worksheets("natal").Cells(2, 7)) > 59 Then
   Worksheets("natal").Cells(2, 7).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 3)) < 1 Or Int(Worksheets("natal").Cells(3, 3)) > 12 Then
   Worksheets("natal").Cells(3, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 2)) < 1 Or Int(Worksheets("natal").Cells(3, 2)) > 31 Then
   Worksheets("natal").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 3)) = 2 And Int(Worksheets("natal").Cells(3, 2)) > 29 Then
   Worksheets("natal").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 3)) = 4 And Int(Worksheets("natal").Cells(3, 2)) > 30 Then
   Worksheets("natal").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 3)) = 6 And Int(Worksheets("natal").Cells(3, 2)) > 30 Then
   Worksheets("natal").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 3)) = 9 And Int(Worksheets("natal").Cells(3, 2)) > 30 Then
   Worksheets("natal").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 3)) = 11 And Int(Worksheets("natal").Cells(3, 2)) > 30 Then
   Worksheets("natal").Cells(3, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 4)) < 1850 Or Int(Worksheets("natal").Cells(3, 4)) > 2039 Then
   Worksheets("natal").Cells(3, 4).Select
   MsgBox ("|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 5)) < 0 Or Int(Worksheets("natal").Cells(3, 5)) > 23 Then
   Worksheets("natal").Cells(3, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 6)) < 0 Or Int(Worksheets("natal").Cells(3, 6)) > 59 Then
   Worksheets("natal").Cells(3, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(3, 7)) < 0 Or Int(Worksheets("natal").Cells(3, 7)) > 59 Then
   Worksheets("natal").Cells(3, 7).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
   
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd|
If Int(Worksheets("natal").Cells(7, 2)) < 0 Or Int(Worksheets("natal").Cells(7, 2)) > 359 Then
   Worksheets("natal").Cells(7, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Int(Worksheets("natal").Cells(8, 2)) < 0 Or Int(Worksheets("natal").Cells(8, 2)) > 359 Then
   Worksheets("natal").Cells(8, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("natal").Cells(7, 5))) > 66 Then
   Worksheets("natal").Cells(7, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("natal").Cells(8, 5))) > 66 Then
   Worksheets("natal").Cells(8, 5).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Abs(Int(Worksheets("natal").Cells(7, 3))) > 59 Then
   Worksheets("natal").Cells(7, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("natal").Cells(7, 6))) > 59 Then
   Worksheets("natal").Cells(7, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("natal").Cells(8, 3))) > 59 Then
   Worksheets("natal").Cells(8, 3).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
If Abs(Int(Worksheets("natal").Cells(8, 6))) > 59 Then
   Worksheets("natal").Cells(8, 6).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   Else
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd|
If Trim(Worksheets("natal").Cells(7, 4)) = "|fffd|" Or Trim(Worksheets("natal").Cells(7, 4)) = "|fffd|" Then
   Worksheets("natal").Cells(7, 2) = 360 - (Worksheets("natal").Cells(7, 2) + Worksheets("natal").Cells(7, 3) / 60)
   Worksheets("natal").Cells(7, 3) = Int((Worksheets("natal").Cells(7, 2) - Int(Worksheets("natal").Cells(7, 2))) * 60 + 0.5)
   Worksheets("natal").Cells(7, 2) = Int(Worksheets("natal").Cells(7, 2))
   Worksheets("natal").Cells(7, 4) = "|fffd|"
   Else
   Worksheets("natal").Cells(7, 4) = "|fffd|"
   End If
If Trim(Worksheets("natal").Cells(8, 4)) = "|fffd|" Or Trim(Worksheets("natal").Cells(8, 4)) = "|fffd|" Then
   Worksheets("natal").Cells(8, 2) = 360 - (Worksheets("natal").Cells(8, 2) + Worksheets("natal").Cells(8, 3) / 60)
   Worksheets("natal").Cells(8, 3) = Int((Worksheets("natal").Cells(8, 2) - Int(Worksheets("natal").Cells(8, 2))) * 60 + 0.5)
   Worksheets("natal").Cells(8, 2) = Int(Worksheets("natal").Cells(8, 2))
   Worksheets("natal").Cells(8, 4) = "|fffd|"
   Else
   Worksheets("natal").Cells(8, 4) = "|fffd|"
   End If
If Trim(Worksheets("natal").Cells(7, 7)) = "|fffd|" Or Trim(Worksheets("natal").Cells(7, 7)) = "|fffd|" Then
   Worksheets("natal").Cells(7, 5) = 0 - Abs(Worksheets("natal").Cells(7, 5))
   Worksheets("natal").Cells(7, 6) = 0 - Abs(Worksheets("natal").Cells(7, 6))
   Worksheets("natal").Cells(7, 7) = "|fffd|"
   Else
   Worksheets("natal").Cells(7, 7) = "|fffd|"
   End If
If Trim(Worksheets("natal").Cells(8, 7)) = "|fffd|" Or Trim(Worksheets("natal").Cells(8, 7)) = "|fffd|" Then
   Worksheets("natal").Cells(8, 5) = 0 - Abs(Worksheets("natal").Cells(8, 5))
   Worksheets("natal").Cells(8, 6) = 0 - Abs(Worksheets("natal").Cells(8, 6))
   Worksheets("natal").Cells(8, 7) = "|fffd|"
   Else
   Worksheets("natal").Cells(8, 7) = "|fffd|"
   End If
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Int(Worksheets("natal").Cells(4, 2)) = 1 Or Int(Worksheets("natal").Cells(4, 2)) = 3 Or Int(Worksheets("natal").Cells(4, 2)) = 5 Or Int(Worksheets("natal").Cells(4, 2)) = 7 Then
   Else
   Worksheets("natal").Cells(4, 2).Select
   MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
   End
   End If

End Sub
Sub sortTR()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NS% = 72 To 392 Step 4
If Worksheets("TR").Cells(NS%, 3) = 0 Then GoTo netNS
For KS% = (NS% + 4) To 396 Step 4
If Worksheets("TR").Cells(KS%, 3) = 0 Then GoTo netNS
If Worksheets("TR").Cells(NS%, 4) = "|fffd||fffd||fffd||fffd|." And Worksheets("TR").Cells(KS%, 4) = "|fffd||fffd||fffd||fffd|." Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 1 To 32
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Worksheets("TR").Cells(400, K%) = Worksheets("TR").Cells(NS%, K%)
    Worksheets("TR").Cells(399, K%) = Worksheets("TR").Cells((NS% - 1), K%)
    Worksheets("TR").Cells(401, K%) = Worksheets("TR").Cells((NS% + 1), K%)
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells(NS%, K%) = Worksheets("TR").Cells(KS%, K%)
    Worksheets("TR").Cells((NS% - 1), K%) = Worksheets("TR").Cells((KS% - 1), K%)
    Worksheets("TR").Cells((NS% + 1), K%) = Worksheets("TR").Cells((KS% + 1), K%)
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells(KS%, K%) = Worksheets("TR").Cells(400, K%)
    Worksheets("TR").Cells((KS% - 1), K%) = Worksheets("TR").Cells(399, K%)
    Worksheets("TR").Cells((KS% + 1), K%) = Worksheets("TR").Cells(401, K%)
    Next K%
Else
End If
netKS: Next KS%
netNS: Next NS%


For NS% = 72 To 392 Step 4
If Worksheets("TR").Cells(NS%, 3) = 0 Then GoTo netuNS
For KS% = (NS% + 4) To 396 Step 4
If Worksheets("TR").Cells(KS%, 3) = 0 Then GoTo netuNS
If Worksheets("TR").Cells(NS%, 32) > Worksheets("TR").Cells(KS%, 32) And Worksheets("TR").Cells(NS%, 4) = Worksheets("TR").Cells(KS%, 4) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 1 To 32
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Worksheets("TR").Cells(400, K%) = Worksheets("TR").Cells(NS%, K%)
    Worksheets("TR").Cells(399, K%) = Worksheets("TR").Cells((NS% - 1), K%)
    Worksheets("TR").Cells(401, K%) = Worksheets("TR").Cells((NS% + 1), K%)
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells(NS%, K%) = Worksheets("TR").Cells(KS%, K%)
    Worksheets("TR").Cells((NS% - 1), K%) = Worksheets("TR").Cells((KS% - 1), K%)
    Worksheets("TR").Cells((NS% + 1), K%) = Worksheets("TR").Cells((KS% + 1), K%)
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells(KS%, K%) = Worksheets("TR").Cells(400, K%)
    Worksheets("TR").Cells((KS% - 1), K%) = Worksheets("TR").Cells(399, K%)
    Worksheets("TR").Cells((KS% + 1), K%) = Worksheets("TR").Cells(401, K%)
    Next K%
Else
End If

netuKS: Next KS%
netuNS: Next NS%

Worksheets("TR").Select
Range("A399:AE401").Select
Selection.ClearContents

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub
Sub sortBP()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NS% = 72 To 392 Step 4
If Worksheets("BP").Cells(NS%, 3) = 0 Then GoTo netNS
For KS% = (NS% + 4) To 396 Step 4
If Worksheets("BP").Cells(KS%, 3) = 0 Then GoTo netNS
If Worksheets("BP").Cells(NS%, 4) = "|fffd||fffd||fffd||fffd|." And Worksheets("BP").Cells(KS%, 4) = "|fffd||fffd||fffd||fffd|." Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 1 To 32
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Worksheets("BP").Cells(400, K%) = Worksheets("BP").Cells(NS%, K%)
    Worksheets("BP").Cells(399, K%) = Worksheets("BP").Cells((NS% - 1), K%)
    Worksheets("BP").Cells(401, K%) = Worksheets("BP").Cells((NS% + 1), K%)
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells(NS%, K%) = Worksheets("BP").Cells(KS%, K%)
    Worksheets("BP").Cells((NS% - 1), K%) = Worksheets("BP").Cells((KS% - 1), K%)
    Worksheets("BP").Cells((NS% + 1), K%) = Worksheets("BP").Cells((KS% + 1), K%)
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells(KS%, K%) = Worksheets("BP").Cells(400, K%)
    Worksheets("BP").Cells((KS% - 1), K%) = Worksheets("BP").Cells(399, K%)
    Worksheets("BP").Cells((KS% + 1), K%) = Worksheets("BP").Cells(401, K%)
    Next K%
Else
End If
netKS: Next KS%
netNS: Next NS%


For NS% = 72 To 392 Step 4
If Worksheets("BP").Cells(NS%, 3) = 0 Then GoTo netuNS
For KS% = (NS% + 4) To 396 Step 4
If Worksheets("BP").Cells(KS%, 3) = 0 Then GoTo netuNS
If Worksheets("BP").Cells(NS%, 32) > Worksheets("BP").Cells(KS%, 32) And Worksheets("BP").Cells(NS%, 4) = Worksheets("BP").Cells(KS%, 4) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 1 To 32
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Worksheets("BP").Cells(400, K%) = Worksheets("BP").Cells(NS%, K%)
    Worksheets("BP").Cells(399, K%) = Worksheets("BP").Cells((NS% - 1), K%)
    Worksheets("BP").Cells(401, K%) = Worksheets("BP").Cells((NS% + 1), K%)
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells(NS%, K%) = Worksheets("BP").Cells(KS%, K%)
    Worksheets("BP").Cells((NS% - 1), K%) = Worksheets("BP").Cells((KS% - 1), K%)
    Worksheets("BP").Cells((NS% + 1), K%) = Worksheets("BP").Cells((KS% + 1), K%)
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells(KS%, K%) = Worksheets("BP").Cells(400, K%)
    Worksheets("BP").Cells((KS% - 1), K%) = Worksheets("BP").Cells(399, K%)
    Worksheets("BP").Cells((KS% + 1), K%) = Worksheets("BP").Cells(401, K%)
    Next K%
Else
End If

netuKS: Next KS%
netuNS: Next NS%

Worksheets("BP").Select
Range("A399:AE401").Select
Selection.ClearContents

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With


End Sub
Sub sortMP()

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NS% = 72 To 392 Step 4
If Worksheets("MP").Cells(NS%, 3) = 0 Then GoTo netNS
For KS% = (NS% + 4) To 396 Step 4
If Worksheets("MP").Cells(KS%, 3) = 0 Then GoTo netNS
If Worksheets("MP").Cells(NS%, 4) = "|fffd||fffd||fffd||fffd|." And Worksheets("MP").Cells(KS%, 4) = "|fffd||fffd||fffd||fffd|." Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 1 To 40
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Worksheets("MP").Cells(400, K%) = Worksheets("MP").Cells(NS%, K%)
    Worksheets("MP").Cells(399, K%) = Worksheets("MP").Cells((NS% - 1), K%)
    Worksheets("MP").Cells(401, K%) = Worksheets("MP").Cells((NS% + 1), K%)
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells(NS%, K%) = Worksheets("MP").Cells(KS%, K%)
    Worksheets("MP").Cells((NS% - 1), K%) = Worksheets("MP").Cells((KS% - 1), K%)
    Worksheets("MP").Cells((NS% + 1), K%) = Worksheets("MP").Cells((KS% + 1), K%)
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells(KS%, K%) = Worksheets("MP").Cells(400, K%)
    Worksheets("MP").Cells((KS% - 1), K%) = Worksheets("MP").Cells(399, K%)
    Worksheets("MP").Cells((KS% + 1), K%) = Worksheets("MP").Cells(401, K%)
    Next K%
Else
End If
netKS: Next KS%
netNS: Next NS%

For NS% = 72 To 392 Step 4
If Worksheets("MP").Cells(NS%, 3) = 0 Then GoTo netuNS
For KS% = (NS% + 4) To 396 Step 4
If Worksheets("MP").Cells(KS%, 3) = 0 Then GoTo netuNS
If Worksheets("MP").Cells(NS%, 32) > Worksheets("MP").Cells(KS%, 32) And Worksheets("MP").Cells(NS%, 4) = Worksheets("MP").Cells(KS%, 4) Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For K% = 1 To 40
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Worksheets("MP").Cells(400, K%) = Worksheets("MP").Cells(NS%, K%)
    Worksheets("MP").Cells(399, K%) = Worksheets("MP").Cells((NS% - 1), K%)
    Worksheets("MP").Cells(401, K%) = Worksheets("MP").Cells((NS% + 1), K%)
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells(NS%, K%) = Worksheets("MP").Cells(KS%, K%)
    Worksheets("MP").Cells((NS% - 1), K%) = Worksheets("MP").Cells((KS% - 1), K%)
    Worksheets("MP").Cells((NS% + 1), K%) = Worksheets("MP").Cells((KS% + 1), K%)
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells(KS%, K%) = Worksheets("MP").Cells(400, K%)
    Worksheets("MP").Cells((KS% - 1), K%) = Worksheets("MP").Cells(399, K%)
    Worksheets("MP").Cells((KS% + 1), K%) = Worksheets("MP").Cells(401, K%)
    Next K%
Else
End If

netuKS: Next KS%
netuNS: Next NS%

Worksheets("MP").Select
Range("A399:AE401").Select
Selection.ClearContents

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With

End Sub
Sub TRsbros()

Worksheets("TR").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select

End Sub
Sub BPsbros()

Worksheets("BP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select

End Sub
Sub MPsbros()

Worksheets("MP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select

End Sub
Sub TRpoisk()

    Worksheets("TR").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 Dim ERRP As Integer
 Dim SN As Integer    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim NDOM1 As Integer
 Dim NDOM2 As Integer
 Dim LD As Integer
 Dim PD As Integer
 Dim LS As Integer   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim PS As Integer   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim STROK As Integer
 Dim DOM(0 To 12) As Integer
 Dim NDOM(0 To 12, 0 To 12) As Integer
 Dim SDOM As Integer
 Dim N1 As Integer
 Dim N2 As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

ERRP = 0

If Trim(Worksheets("TR").Cells(58, 30)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("TR").Cells(58, 30).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
   
ERRP = 0

If Trim(Worksheets("TR").Cells(58, 33)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("TR").Cells(58, 33).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

SDOM = 0

For K% = 55 To 57
Worksheets("TR").Cells(K%, 31) = Int(Worksheets("TR").Cells(K%, 31))
Worksheets("TR").Cells(K%, 33) = Int(Worksheets("TR").Cells(K%, 33))

SDOM = SDOM + Worksheets("TR").Cells(K%, 31) + Worksheets("TR").Cells(K%, 33)

If Worksheets("TR").Cells(K%, 31) < 0 Or Worksheets("TR").Cells(K%, 31) > 12 Then
Worksheets("TR").Cells(K%, 31).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

If Worksheets("TR").Cells(K%, 33) < 0 Or Worksheets("TR").Cells(K%, 33) > 12 Then
Worksheets("TR").Cells(K%, 33).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

Next K%

If SDOM = 0 And Trim(Worksheets("TR").Cells(58, 30)) = "" And Trim(Worksheets("TR").Cells(58, 33)) = "" Then
MsgBox ("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

If Worksheets("TR").Cells(60, 34) = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
N1 = 12
N2 = 18
Else
N1 = 19
N2 = 28
End If

For K% = 71 To 399 Step 4
Worksheets("TR").Cells(K%, 32) = 1
If Worksheets("TR").Cells(K%, 12) = 0 Then Worksheets("TR").Cells(K%, 32) = 0
Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
LD = 0
PD = 0
LD = Worksheets("TR").Cells(55, 31) + Worksheets("TR").Cells(56, 31) + Worksheets("TR").Cells(57, 31)
PD = Worksheets("TR").Cells(55, 33) + Worksheets("TR").Cells(56, 33) + Worksheets("TR").Cells(57, 33)

If LD > 0 And PD > 0 Then GoTo REZ

For K% = 71 To 399 Step 4
If Worksheets("TR").Cells(K% + 1, 3) = 0 Then GoTo netuK
SN = 0

If Trim(Worksheets("TR").Cells(58, 33)) <> "" And Trim(Worksheets("TR").Cells(58, 30)) = "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K%, 1)) Or Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("TR").Cells(58, 30)) <> "" And Trim(Worksheets("TR").Cells(58, 33)) = "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K%, 1)) Or Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("TR").Cells(58, 33)) <> "" And Trim(Worksheets("TR").Cells(58, 30)) <> "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K%, 1)) And Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
If Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K%, 1)) And Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("TR").Cells(58, 30)) <> "" And LD = 0 And PD > 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND2% = 55 To 57
    NDOM2 = Int(Worksheets("TR").Cells(ND2%, 33))
    If NDOM2 = 0 Then GoTo netuD2
    For M% = N1 To N2
    If NDOM2 = Int(Worksheets("TR").Cells(K%, M%)) And Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K%, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("TR").Cells(K% + 2, M%)) And Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K%, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("TR").Cells(K%, M%)) And Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("TR").Cells(K% + 2, M%)) And Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
    Next M%
netuD2: Next ND2%
Else
End If

If Trim(Worksheets("TR").Cells(58, 33)) <> "" And PD = 0 And LD > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND1% = 55 To 57
    NDOM1 = Int(Worksheets("TR").Cells(ND1%, 31))
    If NDOM1 = 0 Then GoTo netuD1
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("TR").Cells(K%, M%)) And Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K%, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("TR").Cells(K% + 2, M%)) And Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K%, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("TR").Cells(K%, M%)) And Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("TR").Cells(K% + 2, M%)) And Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
    Next M%
netuD1: Next ND1%
Else
End If

If Trim(Worksheets("TR").Cells(58, 30)) = "" And Trim(Worksheets("TR").Cells(58, 33)) = "" And LD = 0 And PD > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND2% = 55 To 57
    NDOM2 = Int(Worksheets("TR").Cells(ND2%, 33))
    If NDOM2 = 0 Then GoTo netuD22
    For M% = N1 To N2
    If NDOM2 = Int(Worksheets("TR").Cells(K%, M%)) Then SN = 1
    If NDOM2 = Int(Worksheets("TR").Cells(K% + 2, M%)) Then SN = 1
    Next M%
netuD22: Next ND2%
Else
End If

If Trim(Worksheets("TR").Cells(58, 30)) = "" And Trim(Worksheets("TR").Cells(58, 33)) = "" And LD > 0 And PD = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND1% = 55 To 57
    NDOM1 = Int(Worksheets("TR").Cells(ND1%, 31))
    If NDOM1 = 0 Then GoTo netuD11
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("TR").Cells(K%, M%)) Then SN = 1
    If NDOM1 = Int(Worksheets("TR").Cells(K% + 2, M%)) Then SN = 1
    Next M%
netuD11: Next ND1%
Else
End If

If SN = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 1).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 2).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 3).Select
    Selection.EntireRow.Hidden = True
    Worksheets("TR").Cells(K%, 32) = 0
Else
End If

netuK: Next K%

GoTo FIN

REZ:

For M% = 0 To 12
For n% = 0 To 12
NDOM(M%, n%) = 0
Next n%
Next M%
SDOM = 61
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Range("BH55:EN58").Select
Selection.ClearContents

For ND1% = 55 To 57
NDOM1 = Int(Worksheets("TR").Cells(ND1%, 31))
If NDOM1 = 0 Then GoTo netD1
For ND2% = 55 To 57
NDOM2 = Int(Worksheets("TR").Cells(ND2%, 33))
If NDOM2 = 0 Then GoTo netD2
    If NDOM(NDOM1, NDOM2) = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells(55, SDOM) = NDOM1
    Worksheets("TR").Cells(55, SDOM + 2) = NDOM2
    NDOM(NDOM1, NDOM2) = 1
    NDOM(NDOM2, NDOM1) = 1
    Worksheets("TR").Cells(58, SDOM - 1) = Worksheets("TR").Cells(58, 30)
    Worksheets("TR").Cells(58, SDOM + 2) = Worksheets("TR").Cells(58, 33)
    SDOM = SDOM + 10
    Else
    End If
netD2: Next ND2%
netD1: Next ND1%

For K% = 71 To 399 Step 4
If Worksheets("TR").Cells(K% + 1, 3) = 0 Then GoTo netK
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SN = 0
LS = 0
PS = 0
LD = 0
PD = 0
SDOM = 0

If Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K%, 1)) Then LS = 1
If Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then LS = 2
If Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K%, 1)) Then PS = 1
If Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then PS = 2

If LS > 0 And PS > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K%, 1)) And Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
If Trim(Worksheets("TR").Cells(58, 33)) = Trim(Worksheets("TR").Cells(K%, 1)) And Trim(Worksheets("TR").Cells(58, 30)) = Trim(Worksheets("TR").Cells(K% + 2, 1)) Then SN = 1
Else
End If


For NS% = 60 To 140 Step 10

LD = 0
PD = 0
For M% = 0 To 12
DOM(M%) = 0
Next M%

If Int(Worksheets("TR").Cells(55, NS% + 1)) < 1 Then GoTo netNS
If Int(Worksheets("TR").Cells(55, NS% + 3)) < 1 Then GoTo netNS

NDOM1 = Int(Worksheets("TR").Cells(55, NS% + 1))
NDOM2 = Int(Worksheets("TR").Cells(55, NS% + 3))
    If NDOM1 <> NDOM2 Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("TR").Cells(K%, M%)) Then LD = 1
    If NDOM1 = Int(Worksheets("TR").Cells(K% + 2, M%)) Then LD = 2
    If NDOM2 = Int(Worksheets("TR").Cells(K%, M%)) Then PD = 1
    If NDOM2 = Int(Worksheets("TR").Cells(K% + 2, M%)) Then PD = 2
    Next M%
    Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("TR").Cells(K%, M%)) Then DOM(NDOM1) = DOM(NDOM1) + 1
    If NDOM1 = Int(Worksheets("TR").Cells(K% + 2, M%)) Then DOM(NDOM1) = DOM(NDOM1) + 1
    Next M%
    End If
    
If LS = 0 And PS = 0 And PD > 0 And LD > 0 Then SN = 1
'-------------
If LS = 1 And PS = 0 And PD > 0 Then SN = 1
If LS = 0 And PS = 1 And LD > 0 Then SN = 1
'------------
If LS = 2 And PS = 0 And PD > 0 Then SN = 1
If LS = 0 And PS = 2 And LD > 0 Then SN = 1
'------------
If LS > 0 And PS > 0 And PD > 0 Then SN = 1
If LS > 0 And PS > 0 And LD > 0 Then SN = 1
'------------

For M% = 1 To 12
If DOM(M%) > 1 Then SN = 1
Next M%

netNS: Next NS%

If SN = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 1).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 2).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 3).Select
    Selection.EntireRow.Hidden = True
    Worksheets("TR").Cells(K%, 32) = 0
Else
End If

netK: Next K%

FIN:

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With
ActiveWindow.ScrollRow = 66

End Sub
Sub BPpoisk()

    Worksheets("BP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 Dim ERRP As Integer
 Dim SN As Integer    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim NDOM1 As Integer
 Dim NDOM2 As Integer
 Dim LD As Integer
 Dim PD As Integer
 Dim LS As Integer   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim PS As Integer   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim STROK As Integer
 Dim DOM(0 To 12) As Integer
 Dim NDOM(0 To 12, 0 To 12) As Integer
 Dim SDOM As Integer
 Dim N1 As Integer
 Dim N2 As Integer
      
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

ERRP = 0

If Trim(Worksheets("BP").Cells(58, 30)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("BP").Cells(58, 30).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
   
ERRP = 0

If Trim(Worksheets("BP").Cells(58, 33)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("BP").Cells(58, 33).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

SDOM = 0

For K% = 55 To 57
Worksheets("BP").Cells(K%, 31) = Int(Worksheets("BP").Cells(K%, 31))
Worksheets("BP").Cells(K%, 33) = Int(Worksheets("BP").Cells(K%, 33))

SDOM = SDOM + Worksheets("BP").Cells(K%, 31) + Worksheets("BP").Cells(K%, 33)

If Worksheets("BP").Cells(K%, 31) < 0 Or Worksheets("BP").Cells(K%, 31) > 12 Then
Worksheets("BP").Cells(K%, 31).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

If Worksheets("BP").Cells(K%, 33) < 0 Or Worksheets("BP").Cells(K%, 33) > 12 Then
Worksheets("BP").Cells(K%, 33).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

Next K%

If SDOM = 0 And Trim(Worksheets("BP").Cells(58, 30)) = "" And Trim(Worksheets("BP").Cells(58, 33)) = "" Then
MsgBox ("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

If Worksheets("BP").Cells(60, 34) = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
N1 = 12
N2 = 18
Else
N1 = 19
N2 = 28
End If

For K% = 71 To 399 Step 4
Worksheets("BP").Cells(K%, 32) = 1
If Worksheets("BP").Cells(K%, 12) = 0 Then Worksheets("BP").Cells(K%, 32) = 0
Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
LD = 0
PD = 0
LD = Worksheets("BP").Cells(55, 31) + Worksheets("BP").Cells(56, 31) + Worksheets("BP").Cells(57, 31)
PD = Worksheets("BP").Cells(55, 33) + Worksheets("BP").Cells(56, 33) + Worksheets("BP").Cells(57, 33)

If LD > 0 And PD > 0 Then GoTo REZ

For K% = 71 To 399 Step 4
If Worksheets("BP").Cells(K% + 1, 3) = 0 Then GoTo netuK
SN = 0

If Trim(Worksheets("BP").Cells(58, 33)) <> "" And Trim(Worksheets("BP").Cells(58, 30)) = "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K%, 1)) Or Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("BP").Cells(58, 30)) <> "" And Trim(Worksheets("BP").Cells(58, 33)) = "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K%, 1)) Or Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("BP").Cells(58, 33)) <> "" And Trim(Worksheets("BP").Cells(58, 30)) <> "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K%, 1)) And Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
If Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K%, 1)) And Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("BP").Cells(58, 30)) <> "" And LD = 0 And PD > 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND2% = 55 To 57
    NDOM2 = Int(Worksheets("BP").Cells(ND2%, 33))
    If NDOM2 = 0 Then GoTo netuD2
    For M% = N1 To N2
    If NDOM2 = Int(Worksheets("BP").Cells(K%, M%)) And Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K%, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("BP").Cells(K% + 2, M%)) And Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K%, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("BP").Cells(K%, M%)) And Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("BP").Cells(K% + 2, M%)) And Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
    Next M%
netuD2: Next ND2%
Else
End If

If Trim(Worksheets("BP").Cells(58, 33)) <> "" And PD = 0 And LD > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND1% = 55 To 57
    NDOM1 = Int(Worksheets("BP").Cells(ND1%, 31))
    If NDOM1 = 0 Then GoTo netuD1
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("BP").Cells(K%, M%)) And Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K%, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("BP").Cells(K% + 2, M%)) And Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K%, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("BP").Cells(K%, M%)) And Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("BP").Cells(K% + 2, M%)) And Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
    Next M%
netuD1: Next ND1%
Else
End If

If Trim(Worksheets("BP").Cells(58, 30)) = "" And Trim(Worksheets("BP").Cells(58, 33)) = "" And LD = 0 And PD > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND2% = 55 To 57
    NDOM2 = Int(Worksheets("BP").Cells(ND2%, 33))
    If NDOM2 = 0 Then GoTo netuD22
    For M% = N1 To N2
    If NDOM2 = Int(Worksheets("BP").Cells(K%, M%)) Then SN = 1
    If NDOM2 = Int(Worksheets("BP").Cells(K% + 2, M%)) Then SN = 1
    Next M%
netuD22: Next ND2%
Else
End If

If Trim(Worksheets("BP").Cells(58, 30)) = "" And Trim(Worksheets("BP").Cells(58, 33)) = "" And LD > 0 And PD = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND1% = 55 To 57
    NDOM1 = Int(Worksheets("BP").Cells(ND1%, 31))
    If NDOM1 = 0 Then GoTo netuD11
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("BP").Cells(K%, M%)) Then SN = 1
    If NDOM1 = Int(Worksheets("BP").Cells(K% + 2, M%)) Then SN = 1
    Next M%
netuD11: Next ND1%
Else
End If

If SN = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 1).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 2).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 3).Select
    Selection.EntireRow.Hidden = True
    Worksheets("BP").Cells(K%, 32) = 0
Else
End If

netuK: Next K%

GoTo FIN

REZ:

For M% = 0 To 12
For n% = 0 To 12
NDOM(M%, n%) = 0
Next n%
Next M%
SDOM = 61
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Range("BH55:EN58").Select
Selection.ClearContents

For ND1% = 55 To 57
NDOM1 = Int(Worksheets("BP").Cells(ND1%, 31))
If NDOM1 = 0 Then GoTo netD1
For ND2% = 55 To 57
NDOM2 = Int(Worksheets("BP").Cells(ND2%, 33))
If NDOM2 = 0 Then GoTo netD2
    If NDOM(NDOM1, NDOM2) = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells(55, SDOM) = NDOM1
    Worksheets("BP").Cells(55, SDOM + 2) = NDOM2
    NDOM(NDOM1, NDOM2) = 1
    NDOM(NDOM2, NDOM1) = 1
    Worksheets("BP").Cells(58, SDOM - 1) = Worksheets("BP").Cells(58, 30)
    Worksheets("BP").Cells(58, SDOM + 2) = Worksheets("BP").Cells(58, 33)
    SDOM = SDOM + 10
    Else
    End If
netD2: Next ND2%
netD1: Next ND1%

For K% = 71 To 399 Step 4
If Worksheets("BP").Cells(K% + 1, 3) = 0 Then GoTo netK
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SN = 0
LS = 0
PS = 0
LD = 0
PD = 0
SDOM = 0

If Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K%, 1)) Then LS = 1
If Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then LS = 2
If Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K%, 1)) Then PS = 1
If Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then PS = 2

If LS > 0 And PS > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K%, 1)) And Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
If Trim(Worksheets("BP").Cells(58, 33)) = Trim(Worksheets("BP").Cells(K%, 1)) And Trim(Worksheets("BP").Cells(58, 30)) = Trim(Worksheets("BP").Cells(K% + 2, 1)) Then SN = 1
Else
End If


For NS% = 60 To 140 Step 10

LD = 0
PD = 0
For M% = 0 To 12
DOM(M%) = 0
Next M%

If Int(Worksheets("BP").Cells(55, NS% + 1)) < 1 Then GoTo netNS
If Int(Worksheets("BP").Cells(55, NS% + 3)) < 1 Then GoTo netNS

NDOM1 = Int(Worksheets("BP").Cells(55, NS% + 1))
NDOM2 = Int(Worksheets("BP").Cells(55, NS% + 3))
    If NDOM1 <> NDOM2 Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("BP").Cells(K%, M%)) Then LD = 1
    If NDOM1 = Int(Worksheets("BP").Cells(K% + 2, M%)) Then LD = 2
    If NDOM2 = Int(Worksheets("BP").Cells(K%, M%)) Then PD = 1
    If NDOM2 = Int(Worksheets("BP").Cells(K% + 2, M%)) Then PD = 2
    Next M%
    Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("BP").Cells(K%, M%)) Then DOM(NDOM1) = DOM(NDOM1) + 1
    If NDOM1 = Int(Worksheets("BP").Cells(K% + 2, M%)) Then DOM(NDOM1) = DOM(NDOM1) + 1
    Next M%
    End If
    
If LS = 0 And PS = 0 And PD > 0 And LD > 0 Then SN = 1
'-------------
If LS = 1 And PS = 0 And PD > 0 Then SN = 1
If LS = 0 And PS = 1 And LD > 0 Then SN = 1
'------------
If LS = 2 And PS = 0 And PD > 0 Then SN = 1
If LS = 0 And PS = 2 And LD > 0 Then SN = 1
'------------
If LS > 0 And PS > 0 And PD > 0 Then SN = 1
If LS > 0 And PS > 0 And LD > 0 Then SN = 1
'------------

For M% = 1 To 12
If DOM(M%) > 1 Then SN = 1
Next M%

netNS: Next NS%

If SN = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 1).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 2).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 3).Select
    Selection.EntireRow.Hidden = True
    Worksheets("BP").Cells(K%, 32) = 0
Else
End If

netK: Next K%

FIN:

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With
ActiveWindow.ScrollRow = 66

End Sub
Sub MPpoisk()

    Worksheets("MP").Select
    Rows("69:403").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.ScrollRow = 52
    Range("AE67").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 Dim ERRP As Integer
 Dim SN As Integer    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim NDOM1 As Integer
 Dim NDOM2 As Integer
 Dim LD As Integer
 Dim PD As Integer
 Dim LS As Integer   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim PS As Integer   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim STROK As Integer
 Dim DOM(0 To 12) As Integer
 Dim NDOM(0 To 12, 0 To 12) As Integer
 Dim SDOM As Integer
 Dim N1 As Integer
 Dim N2 As Integer
       
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

ERRP = 0

If Trim(Worksheets("MP").Cells(58, 30)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("MP").Cells(58, 30).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
   
ERRP = 0

If Trim(Worksheets("MP").Cells(58, 33)) <> "" Then
ERRP = 1
For M% = 11 To 21
    If Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("natal").Cells(M%, 1)) Then
    ERRP = 0
    Else
    End If
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("MP").Cells(58, 33).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

SDOM = 0

For K% = 55 To 57
Worksheets("MP").Cells(K%, 31) = Int(Worksheets("MP").Cells(K%, 31))
Worksheets("MP").Cells(K%, 33) = Int(Worksheets("MP").Cells(K%, 33))

SDOM = SDOM + Worksheets("MP").Cells(K%, 31) + Worksheets("MP").Cells(K%, 33)

If Worksheets("MP").Cells(K%, 31) < 0 Or Worksheets("MP").Cells(K%, 31) > 12 Then
Worksheets("MP").Cells(K%, 31).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

If Worksheets("MP").Cells(K%, 33) < 0 Or Worksheets("MP").Cells(K%, 33) > 12 Then
Worksheets("MP").Cells(K%, 33).Select
MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

Next K%

If SDOM = 0 And Trim(Worksheets("MP").Cells(58, 30)) = "" And Trim(Worksheets("MP").Cells(58, 33)) = "" Then
MsgBox ("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
End
Else
End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

If Worksheets("MP").Cells(60, 34) = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
N1 = 12
N2 = 18
Else
N1 = 19
N2 = 28
End If

For K% = 71 To 399 Step 4
Worksheets("MP").Cells(K%, 32) = 1
If Worksheets("MP").Cells(K%, 12) = 0 Then Worksheets("MP").Cells(K%, 32) = 0
Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
LD = 0
PD = 0
LD = Worksheets("MP").Cells(55, 31) + Worksheets("MP").Cells(56, 31) + Worksheets("MP").Cells(57, 31)
PD = Worksheets("MP").Cells(55, 33) + Worksheets("MP").Cells(56, 33) + Worksheets("MP").Cells(57, 33)

If LD > 0 And PD > 0 Then GoTo REZ

For K% = 71 To 399 Step 4
If Worksheets("MP").Cells(K%, 12) = 0 Then GoTo netuK
SN = 0

If Trim(Worksheets("MP").Cells(58, 33)) <> "" And Trim(Worksheets("MP").Cells(58, 30)) = "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K%, 1)) Or Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("MP").Cells(58, 30)) <> "" And Trim(Worksheets("MP").Cells(58, 33)) = "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K%, 1)) Or Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("MP").Cells(58, 33)) <> "" And Trim(Worksheets("MP").Cells(58, 30)) <> "" And PD = 0 And LD = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K%, 1)) And Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
If Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K%, 1)) And Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
Else
End If

If Trim(Worksheets("MP").Cells(58, 30)) <> "" And LD = 0 And PD > 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND2% = 55 To 57
    NDOM2 = Int(Worksheets("MP").Cells(ND2%, 33))
    If NDOM2 = 0 Then GoTo netuD2
    For M% = N1 To N2
    If NDOM2 = Int(Worksheets("MP").Cells(K%, M%)) And Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K%, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("MP").Cells(K% + 2, M%)) And Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K%, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("MP").Cells(K%, M%)) And Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
    If NDOM2 = Int(Worksheets("MP").Cells(K% + 2, M%)) And Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
    Next M%
netuD2: Next ND2%
Else
End If

If Trim(Worksheets("MP").Cells(58, 33)) <> "" And PD = 0 And LD > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND1% = 55 To 57
    NDOM1 = Int(Worksheets("MP").Cells(ND1%, 31))
    If NDOM1 = 0 Then GoTo netuD1
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("MP").Cells(K%, M%)) And Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K%, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("MP").Cells(K% + 2, M%)) And Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K%, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("MP").Cells(K%, M%)) And Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
    If NDOM1 = Int(Worksheets("MP").Cells(K% + 2, M%)) And Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
    Next M%
netuD1: Next ND1%
Else
End If

If Trim(Worksheets("MP").Cells(58, 30)) = "" And Trim(Worksheets("MP").Cells(58, 33)) = "" And LD = 0 And PD > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND2% = 55 To 57
    NDOM2 = Int(Worksheets("MP").Cells(ND2%, 33))
    If NDOM2 = 0 Then GoTo netuD22
    For M% = N1 To N2
    If NDOM2 = Int(Worksheets("MP").Cells(K%, M%)) Then SN = 1
    If NDOM2 = Int(Worksheets("MP").Cells(K% + 2, M%)) Then SN = 1
    Next M%
netuD22: Next ND2%
Else
End If

If Trim(Worksheets("MP").Cells(58, 30)) = "" And Trim(Worksheets("MP").Cells(58, 33)) = "" And LD > 0 And PD = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    For ND1% = 55 To 57
    NDOM1 = Int(Worksheets("MP").Cells(ND1%, 31))
    If NDOM1 = 0 Then GoTo netuD11
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("MP").Cells(K%, M%)) Then SN = 1
    If NDOM1 = Int(Worksheets("MP").Cells(K% + 2, M%)) Then SN = 1
    Next M%
netuD11: Next ND1%
Else
End If

If SN = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 1).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 2).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 3).Select
    Selection.EntireRow.Hidden = True
    Worksheets("MP").Cells(K%, 32) = 0
Else
End If

netuK: Next K%

GoTo FIN

REZ:

For M% = 0 To 12
For n% = 0 To 12
NDOM(M%, n%) = 0
Next n%
Next M%
SDOM = 61
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Range("BH55:EN58").Select
Selection.ClearContents

For ND1% = 55 To 57
NDOM1 = Int(Worksheets("MP").Cells(ND1%, 31))
If NDOM1 = 0 Then GoTo netD1
For ND2% = 55 To 57
NDOM2 = Int(Worksheets("MP").Cells(ND2%, 33))
If NDOM2 = 0 Then GoTo netD2
    If NDOM(NDOM1, NDOM2) = 0 Then '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells(55, SDOM) = NDOM1
    Worksheets("MP").Cells(55, SDOM + 2) = NDOM2
    NDOM(NDOM1, NDOM2) = 1
    NDOM(NDOM2, NDOM1) = 1
    Worksheets("MP").Cells(58, SDOM - 1) = Worksheets("MP").Cells(58, 30)
    Worksheets("MP").Cells(58, SDOM + 2) = Worksheets("MP").Cells(58, 33)
    SDOM = SDOM + 10
    Else
    End If
netD2: Next ND2%
netD1: Next ND1%

For K% = 71 To 399 Step 4
If Worksheets("MP").Cells(K% + 1, 3) = 0 Then GoTo netK
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SN = 0
LS = 0
PS = 0
LD = 0
PD = 0
SDOM = 0

If Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K%, 1)) Then LS = 1
If Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then LS = 2
If Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K%, 1)) Then PS = 1
If Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then PS = 2

If LS > 0 And PS > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K%, 1)) And Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
If Trim(Worksheets("MP").Cells(58, 33)) = Trim(Worksheets("MP").Cells(K%, 1)) And Trim(Worksheets("MP").Cells(58, 30)) = Trim(Worksheets("MP").Cells(K% + 2, 1)) Then SN = 1
Else
End If


For NS% = 60 To 140 Step 10

LD = 0
PD = 0
For M% = 0 To 12
DOM(M%) = 0
Next M%

If Int(Worksheets("MP").Cells(55, NS% + 1)) < 1 Then GoTo netNS
If Int(Worksheets("MP").Cells(55, NS% + 3)) < 1 Then GoTo netNS

NDOM1 = Int(Worksheets("MP").Cells(55, NS% + 1))
NDOM2 = Int(Worksheets("MP").Cells(55, NS% + 3))
    If NDOM1 <> NDOM2 Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("MP").Cells(K%, M%)) Then LD = 1
    If NDOM1 = Int(Worksheets("MP").Cells(K% + 2, M%)) Then LD = 2
    If NDOM2 = Int(Worksheets("MP").Cells(K%, M%)) Then PD = 1
    If NDOM2 = Int(Worksheets("MP").Cells(K% + 2, M%)) Then PD = 2
    Next M%
    Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = N1 To N2
    If NDOM1 = Int(Worksheets("MP").Cells(K%, M%)) Then DOM(NDOM1) = DOM(NDOM1) + 1
    If NDOM1 = Int(Worksheets("MP").Cells(K% + 2, M%)) Then DOM(NDOM1) = DOM(NDOM1) + 1
    Next M%
    End If
    
If LS = 0 And PS = 0 And PD > 0 And LD > 0 Then SN = 1
'-------------
If LS = 1 And PS = 0 And PD > 0 Then SN = 1
If LS = 0 And PS = 1 And LD > 0 Then SN = 1
'------------
If LS = 2 And PS = 0 And PD > 0 Then SN = 1
If LS = 0 And PS = 2 And LD > 0 Then SN = 1
'------------
If LS > 0 And PS > 0 And PD > 0 Then SN = 1
If LS > 0 And PS > 0 And LD > 0 Then SN = 1
'------------

For M% = 1 To 12
If DOM(M%) > 1 Then SN = 1
Next M%

netNS: Next NS%

If SN = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(K%).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 1).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 2).Select
    Selection.EntireRow.Hidden = True
    Rows(K% + 3).Select
    Selection.EntireRow.Hidden = True
    Worksheets("MP").Cells(K%, 32) = 0
Else
End If

netK: Next K%

FIN:

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
.Calculation = xlCalculationManual
End With
ActiveWindow.ScrollRow = 66
    
End Sub

Sub progress()

Dim STRLIST As Integer
Dim DD As Integer
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROKA As Long
Dim STROKAL As Long
Dim JD As Double
Dim MCMP As Double
Dim MMC As Double
Dim ZZV As Double
Dim JDMP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim DOM As Double
Dim B As Double
Dim ASP1 As Double
Dim ASP2 As Double
Dim ASP As Integer
Dim SDOM As Integer
Dim AAS As Integer ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("natal").Cells(3, 11) = Worksheets("natal").Cells(81, 8) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ==================

Worksheets("natal").Cells(4, 9) = Worksheets("natal").Cells(2, 9) + (Worksheets("natal").Cells(3, 9) - Worksheets("natal").Cells(2, 9)) / 365    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call JDvDATA(Worksheets("natal").Cells(4, 9))
Worksheets("natal").Cells(4, 11) = Worksheets("natal").Cells(71, 8) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd|

B = Worksheets("natal").Cells(4, 9) - Int(Worksheets("natal").Cells(4, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(4, 11)), B, 11, 6) ' 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = Worksheets("natal").Cells(36, 6)

MCMP = Worksheets("natal").Cells(31, 4) + (Worksheets("natal").Cells(3, 9) - Worksheets("natal").Cells(2, 9)) / 365
If MCMP > 360 Then MCMP = MCMP - 360
ZV = ZVMC(MCMP) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 6) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(4, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%
ZV = ZV + 1 / 10
If ZV > 360 Then ZV = ZV - 360
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 10) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(4, 9))
If (Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 6)) < 0 Then Worksheets("natal").Cells((M% + 21), 7) = "R"
If (Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 6)) < 0 And Abs(Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 6)) > 300 Then Worksheets("natal").Cells((M% + 21), 7) = ""
If (Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 6)) > 300 Then Worksheets("natal").Cells((M% + 21), 7) = "R"
Next M%
Call sutkiMP '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
'|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(9, (12 + (NP% - 1) * 3)) = INDOM(Worksheets("natal").Cells((10 + NP%), 6), 4)
Next NP%
'|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(9, (45 + (NP% - 1) * 2)) = INDOM(Worksheets("natal").Cells((21 + NP%), 6), 4)
Next NP%


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 2) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call upravMP(2, 7, 6) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 7 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call upravMP(4, 7, 13) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 5 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim D(0 To 12) As Integer
Dim STB As Integer
Dim DM As Integer

For M% = 11 To 21

For n% = 0 To 12
D(n%) = 0
Next n%

If Worksheets("MP").Cells(M%, 5) <> Worksheets("MP").Cells(M%, 12) Then
Worksheets("MP").Cells(M%, 19) = Worksheets("MP").Cells(M%, 5)
Worksheets("MP").Cells(M%, 20) = Worksheets("MP").Cells(M%, 12)
STB = 21
Else
Worksheets("MP").Cells(M%, 19) = Worksheets("MP").Cells(M%, 5)
STB = 20
End If
    
    For n% = 6 To 11
    DM = Int(Worksheets("MP").Cells(M%, n%))
    D(DM) = D(DM) + 1
    Next n%
    
    For n% = 13 To 18
    DM = Int(Worksheets("MP").Cells(M%, n%))
    D(DM) = D(DM) + 1
    Next n%
    
    For n% = 1 To 12
    If D(n%) > 0 Then
    Worksheets("MP").Cells(M%, STB) = n%
    STB = STB + 1
    Else
    End If
    Next n%
    
Next M%

For K% = 22 To 33
Worksheets("MP").Cells(K%, 19) = (K% - 21) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next K%

For K% = 11 To 33
Worksheets("MP").Cells(K%, 29) = INDOM(Worksheets("natal").Cells(K%, 6), 4) '|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next K%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
For n% = 11 To 21
For K% = 5 To 28
Worksheets("MP").Cells(n%, (K% + 26)) = Worksheets("formula").Cells(n%, K%)
Next K%
Next n%

For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("MP").Cells((K% + 21), 31) = K%
Worksheets("MP").Cells((K% + 21), 38) = K%
Worksheets("MP").Cells((K% + 21), 45) = K%
Next K%

'============ |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.

STROKAL = 11
STROKA = 11

For K% = 22 To 33
Worksheets("MP").Cells(K%, 12) = (K% - 21)
Next K%

For n% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("MP").Cells(n%, 5) <> Worksheets("MP").Cells(n%, 29) And Worksheets("MP").Cells(n%, 12) <> Worksheets("MP").Cells(n%, 29) Then Worksheets("MP").Cells(n%, 28) = Worksheets("MP").Cells(n%, 29)
Next n%

For K% = 22 To 33
Worksheets("MP").Cells(K%, 13) = Worksheets("MP").Cells(K%, 28)
Next K%

'============ |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = 71
AAS = Int(Worksheets("MP").Cells(67, 2))

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 23 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells((KP% + 10), 2)
    L1 = Worksheets("natal").Cells((10 + KP%), 6)
If Worksheets("natal").Cells((10 + KP%), 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
Worksheets("MP").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("MP").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("MP").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("MP").Cells((STRLIST + 2), 2) = "|fffd||fffd||fffd||fffd||fffd|."
Worksheets("MP").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("MP").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(STRLIST, M%) = Worksheets("MP").Cells((NP% + 10), (26 + M%))
Worksheets("MP").Cells((STRLIST + 2), M%) = Worksheets("MP").Cells((KP% + 10), M%)
Next M%

If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "p"
        Else
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "p"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                                
Worksheets("MP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("MP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int((ORB - Abs(ASP1 - NA%)) / Abs(Worksheets("natal").Cells(100 + KP%, 3)))
Worksheets("MP").Cells(STRLIST + 1, 32) = JD
Worksheets("MP").Cells(STRLIST + 2, 33) = Worksheets("natal").Cells(100 + KP%, 3)
Call JDvDATA(JD)
Worksheets("MP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("MP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
If Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3))) < AAS Then Worksheets("MP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "c"
        Else
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "c"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("MP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("MP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3)))
Worksheets("MP").Cells(STRLIST + 1, 32) = JD
Call JDvDATA(JD)
Worksheets("MP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("MP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Worksheets("MP").Cells(STRLIST + 2, 33) = Worksheets("natal").Cells(100 + KP%, 3)
    If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3))) < AAS Then Worksheets("MP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3))) < Int(Worksheets("natal").Cells(KP% + 10, 69)) Then Worksheets("MP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = STRLIST + 4

Else
End If

Next NA%
Next KP%
Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 12 To 23 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 23 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("MP").Cells((KP% + 10), 2)
    L1 = Worksheets("natal").Cells((10 + KP%), 6)
If Worksheets("natal").Cells((10 + KP%), 7) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
Worksheets("MP").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("MP").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("MP").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("MP").Cells((STRLIST + 2), 2) = "|fffd||fffd||fffd||fffd||fffd|."
Worksheets("MP").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("MP").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(STRLIST, M%) = Worksheets("MP").Cells((NP% + 10), (26 + M%))
Worksheets("MP").Cells((STRLIST + 2), M%) = Worksheets("MP").Cells((KP% + 10), M%)
Next M%

If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "p"
        Else
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "p"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("MP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("MP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int((ORB - Abs(ASP1 - NA%)) / Abs(Worksheets("natal").Cells(100 + KP%, 3)))
Worksheets("MP").Cells(STRLIST + 1, 32) = JD
Worksheets("MP").Cells(STRLIST + 2, 33) = Worksheets("natal").Cells(100 + KP%, 3)
Call JDvDATA(JD)
Worksheets("MP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("MP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
If Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3))) < AAS Then Worksheets("MP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (12 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "c"
        Else
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (45 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "c"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("MP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("MP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3)))
Worksheets("MP").Cells(STRLIST + 1, 32) = JD
Worksheets("MP").Cells(STRLIST + 2, 33) = Worksheets("natal").Cells(100 + KP%, 3)
    If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3))) < AAS Then Worksheets("MP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 3))) < Int(Worksheets("natal").Cells(KP% + 10, 69)) Then Worksheets("MP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Call JDvDATA(JD)
Worksheets("MP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("MP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("MP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = STRLIST + 4

Else
End If

Next NA%
Next KP%
Next NP%

If Int(Worksheets("MP").Cells(34, 2)) = 0 Then GoTo FIN '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

'======== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NS% = 71 To 399 Step 4    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("MP").Cells(NS%, 12) = 0 And Worksheets("MP").Cells(NS% + 2, 12) = 0 Then GoTo netNS
ASP = Int(Worksheets("MP").Cells(NS% + 1, 2))

'========= |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|

For ND1% = 1 To 12
For ND2% = ND1% To 12
NDOM1 = 0
NDOM2 = 0
SDOM = 0

If ND1% <> ND2% Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 19 To 28
    If ND1% = Int(Worksheets("MP").Cells(NS%, M%)) Then NDOM1 = 1
    If ND1% = Int(Worksheets("MP").Cells(NS% + 2, M%)) Then NDOM1 = 1
    If ND2% = Int(Worksheets("MP").Cells(NS%, M%)) Then NDOM2 = 1
    If ND2% = Int(Worksheets("MP").Cells(NS% + 2, M%)) Then NDOM2 = 1
    Next M%
Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 19 To 28
    If ND1% = Int(Worksheets("MP").Cells(NS%, M%)) Then SDOM = SDOM + 1
    If ND1% = Int(Worksheets("MP").Cells(NS% + 2, M%)) Then SDOM = SDOM + 1
    Next M%
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

If (NDOM1 = 1 And NDOM2 = 1) Or SDOM > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If ASP = 30 Or ASP = 60 Or ASP = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells((39 + 2 * ND2%), (4 + ND1%)) = Worksheets("MP").Cells((39 + 2 * ND2%), (4 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    If ASP = 90 Or ASP = 150 Or ASP = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells((40 + 2 * ND2%), (4 + ND1%)) = Worksheets("MP").Cells((40 + 2 * ND2%), (4 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

    If ASP = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Int(Worksheets("natal").Cells((40 + ND1%), (10 + ND2%))) > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MP").Cells((40 + 2 * ND2%), (4 + ND1%)) = Worksheets("MP").Cells((40 + 2 * ND2%), (4 + ND1%)) + 1
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MP").Cells((39 + 2 * ND2%), (4 + ND1%)) = Worksheets("MP").Cells((39 + 2 * ND2%), (4 + ND1%)) + 1
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End If

Next ND2%
Next ND1%

'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For ND1% = 1 To 12
For ND2% = ND1% To 12
NDOM1 = 0
NDOM2 = 0
SDOM = 0

If ND1% <> ND2% Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 12 To 18
    If ND1% = Int(Worksheets("MP").Cells(NS%, M%)) Then NDOM1 = 1
    If ND1% = Int(Worksheets("MP").Cells(NS% + 2, M%)) Then NDOM1 = 1
    If ND2% = Int(Worksheets("MP").Cells(NS%, M%)) Then NDOM2 = 1
    If ND2% = Int(Worksheets("MP").Cells(NS% + 2, M%)) Then NDOM2 = 1
    Next M%
Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 12 To 18
    If ND1% = Int(Worksheets("MP").Cells(NS%, M%)) Then SDOM = SDOM + 1
    If ND1% = Int(Worksheets("MP").Cells(NS% + 2, M%)) Then SDOM = SDOM + 1
    Next M%
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

If (NDOM1 = 1 And NDOM2 = 1) Or SDOM > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If ASP = 30 Or ASP = 60 Or ASP = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells((39 + 2 * ND2%), (16 + ND1%)) = Worksheets("MP").Cells((39 + 2 * ND2%), (16 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    If ASP = 90 Or ASP = 150 Or ASP = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("MP").Cells((40 + 2 * ND2%), (16 + ND1%)) = Worksheets("MP").Cells((40 + 2 * ND2%), (16 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

    If ASP = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Int(Worksheets("natal").Cells((40 + ND1%), (10 + ND2%))) > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MP").Cells((40 + 2 * ND2%), (16 + ND1%)) = Worksheets("MP").Cells((40 + 2 * ND2%), (16 + ND1%)) + 1
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("MP").Cells((39 + 2 * ND2%), (16 + ND1%)) = Worksheets("MP").Cells((39 + 2 * ND2%), (16 + ND1%)) + 1
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End If

Next ND2%
Next ND1%

netNS: Next NS%

FIN:

Sheets("natal").Select
Range("J22:J33").Select
Selection.ClearContents
Range("H6").Select
Sheets("MP").Select
Range("A9").Select

End Sub

Sub sumLUNAR()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
For n% = 1 To 12
Worksheets("lunar").Cells((520 + K%), (12 * n% - 7)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 7)) + Worksheets("lunar").Cells((520 + K%), (12 * n% - 6))
Worksheets("lunar").Cells((520 + K%), (12 * n% - 4)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 4)) + Worksheets("lunar").Cells((520 + K%), (12 * n% - 3))
Worksheets("lunar").Cells((520 + K%), (12 * n% - 1)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 1)) + Worksheets("lunar").Cells((520 + K%), (12 * n%))
Worksheets("lunar").Cells((520 + K%), (12 * n% + 2)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 7)) + Worksheets("lunar").Cells((520 + K%), (12 * n% - 4)) + Worksheets("lunar").Cells((520 + K%), (12 * n% - 1))
Worksheets("lunar").Cells((520 + K%), (12 * n% + 3)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 6)) + Worksheets("lunar").Cells((520 + K%), (12 * n% - 3)) + Worksheets("lunar").Cells((520 + K%), (12 * n%))

For M% = -5 To 1 Step 3
If Worksheets("lunar").Cells((520 + K%), (12 * n% + M%)) > 0 Then
If Worksheets("lunar").Cells((520 + K%), (12 * n% + 4)) = 0 Or Worksheets("lunar").Cells((520 + K%), (12 * n% + 4)) > Worksheets("lunar").Cells((520 + K%), (12 * n% + M%)) Then Worksheets("lunar").Cells((520 + K%), (12 * n% + 4)) = Worksheets("lunar").Cells((520 + K%), (12 * n% + M%))
Else
End If
Next M%

Next n%
Next K%
'--------------------------------------------------------
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
For n% = 1 To 12
Worksheets("lunar").Cells((500 + K%), (12 * n% - 7)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 7)) + Worksheets("lunar").Cells((500 + K%), (12 * n% - 6))
Worksheets("lunar").Cells((500 + K%), (12 * n% - 4)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 4)) + Worksheets("lunar").Cells((500 + K%), (12 * n% - 3))
Worksheets("lunar").Cells((500 + K%), (12 * n% - 1)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 1)) + Worksheets("lunar").Cells((500 + K%), (12 * n%))
Worksheets("lunar").Cells((500 + K%), (12 * n% + 2)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 7)) + Worksheets("lunar").Cells((500 + K%), (12 * n% - 4)) + Worksheets("lunar").Cells((500 + K%), (12 * n% - 1))
Worksheets("lunar").Cells((500 + K%), (12 * n% + 3)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 6)) + Worksheets("lunar").Cells((500 + K%), (12 * n% - 3)) + Worksheets("lunar").Cells((500 + K%), (12 * n%))

For M% = -5 To 1 Step 3
If Worksheets("lunar").Cells((500 + K%), (12 * n% + M%)) > 0 Then
If Worksheets("lunar").Cells((500 + K%), (12 * n% + 4)) = 0 Or Worksheets("lunar").Cells((500 + K%), (12 * n% + 4)) > Worksheets("lunar").Cells((500 + K%), (12 * n% + M%)) Then Worksheets("lunar").Cells((500 + K%), (12 * n% + 4)) = Worksheets("lunar").Cells((500 + K%), (12 * n% + M%))
Else
End If
Next M%

Next n%
Next K%

For n% = 5 To 146 Step 3
For K% = 1 To 12
Worksheets("lunar").Cells(513, n%) = Worksheets("lunar").Cells(513, n%) + Worksheets("lunar").Cells(500 + K%, n%)
Worksheets("lunar").Cells(513, n% + 1) = Worksheets("lunar").Cells(513, n% + 1) + Worksheets("lunar").Cells(500 + K%, n% + 1)
Worksheets("lunar").Cells(533, n%) = Worksheets("lunar").Cells(533, n%) + Worksheets("lunar").Cells(520 + K%, n%)
Worksheets("lunar").Cells(533, n% + 1) = Worksheets("lunar").Cells(533, n% + 1) + Worksheets("lunar").Cells(520 + K%, n% + 1)
Next K%
Next n%

End Sub
Sub sumSOLAR()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
For n% = 1 To 12
Worksheets("solar").Cells((520 + K%), (12 * n% - 7)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 7)) + Worksheets("solar").Cells((520 + K%), (12 * n% - 6))
Worksheets("solar").Cells((520 + K%), (12 * n% - 4)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 4)) + Worksheets("solar").Cells((520 + K%), (12 * n% - 3))
Worksheets("solar").Cells((520 + K%), (12 * n% - 1)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 1)) + Worksheets("solar").Cells((520 + K%), (12 * n%))
Worksheets("solar").Cells((520 + K%), (12 * n% + 2)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 7)) + Worksheets("solar").Cells((520 + K%), (12 * n% - 4)) + Worksheets("solar").Cells((520 + K%), (12 * n% - 1))
Worksheets("solar").Cells((520 + K%), (12 * n% + 3)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 6)) + Worksheets("solar").Cells((520 + K%), (12 * n% - 3)) + Worksheets("solar").Cells((520 + K%), (12 * n%))

For M% = -5 To 1 Step 3
If Worksheets("solar").Cells((520 + K%), (12 * n% + M%)) > 0 Then
If Worksheets("solar").Cells((520 + K%), (12 * n% + 4)) = 0 Or Worksheets("solar").Cells((520 + K%), (12 * n% + 4)) > Worksheets("solar").Cells((520 + K%), (12 * n% + M%)) Then Worksheets("solar").Cells((520 + K%), (12 * n% + 4)) = Worksheets("solar").Cells((520 + K%), (12 * n% + M%))
Else
End If
Next M%

Next n%
Next K%
'--------------------------------------------------------
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12
For n% = 1 To 12
Worksheets("solar").Cells((500 + K%), (12 * n% - 7)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 7)) + Worksheets("solar").Cells((500 + K%), (12 * n% - 6))
Worksheets("solar").Cells((500 + K%), (12 * n% - 4)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 4)) + Worksheets("solar").Cells((500 + K%), (12 * n% - 3))
Worksheets("solar").Cells((500 + K%), (12 * n% - 1)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 1)) + Worksheets("solar").Cells((500 + K%), (12 * n%))
Worksheets("solar").Cells((500 + K%), (12 * n% + 2)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 7)) + Worksheets("solar").Cells((500 + K%), (12 * n% - 4)) + Worksheets("solar").Cells((500 + K%), (12 * n% - 1))
Worksheets("solar").Cells((500 + K%), (12 * n% + 3)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 6)) + Worksheets("solar").Cells((500 + K%), (12 * n% - 3)) + Worksheets("solar").Cells((500 + K%), (12 * n%))

For M% = -5 To 1 Step 3
If Worksheets("solar").Cells((500 + K%), (12 * n% + M%)) > 0 Then
If Worksheets("solar").Cells((500 + K%), (12 * n% + 4)) = 0 Or Worksheets("solar").Cells((500 + K%), (12 * n% + 4)) > Worksheets("solar").Cells((500 + K%), (12 * n% + M%)) Then Worksheets("solar").Cells((500 + K%), (12 * n% + 4)) = Worksheets("solar").Cells((500 + K%), (12 * n% + M%))
Else
End If
Next M%

Next n%
Next K%

For n% = 5 To 146 Step 3
For K% = 1 To 12
Worksheets("solar").Cells(513, n%) = Worksheets("solar").Cells(513, n%) + Worksheets("solar").Cells(500 + K%, n%)
Worksheets("solar").Cells(513, n% + 1) = Worksheets("solar").Cells(513, n% + 1) + Worksheets("solar").Cells(500 + K%, n% + 1)
Worksheets("solar").Cells(533, n%) = Worksheets("solar").Cells(533, n%) + Worksheets("solar").Cells(520 + K%, n%)
Worksheets("solar").Cells(533, n% + 1) = Worksheets("solar").Cells(533, n% + 1) + Worksheets("solar").Cells(520 + K%, n% + 1)
Next K%
Next n%

End Sub

Sub bprogress()

Dim STRLIST As Integer
Dim DD As Integer
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROKA As Long
Dim STROKAL As Long
Dim JD As Double
Dim MCBP As Double
Dim MMC As Double
Dim ZZV As Double
Dim JDMP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim DOM As Double
Dim B As Double
Dim ASP1 As Double
Dim ASP2 As Double
Dim DEL As Double '|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP As Integer
Dim SDOM As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("natal").Cells(3, 11) = Worksheets("natal").Cells(81, 8) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ==================
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Worksheets("natal").Cells(5, 9) = Worksheets("natal").Cells(2, 9) + (Worksheets("natal").Cells(3, 9) - Worksheets("natal").Cells(2, 9)) / 12    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call JDvDATA(Worksheets("natal").Cells(5, 9))
Worksheets("natal").Cells(5, 11) = Worksheets("natal").Cells(71, 8) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd|

B = Worksheets("natal").Cells(5, 9) - Int(Worksheets("natal").Cells(5, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(5, 11)), B, 11, 8) ' 8 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = Worksheets("natal").Cells(36, 6)
MCBP = Worksheets("natal").Cells(31, 4) + (Worksheets("natal").Cells(3, 9) - Worksheets("natal").Cells(2, 9)) * 30 / 365
BP: If MCBP > 360 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
MCBP = MCBP - 360
GoTo BP
Else
End If
ZV = ZVMC(MCBP) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 8) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(5, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%
ZV = ZV + 1 / 10
If ZV > 360 Then ZV = ZV - 360

For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 10) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(5, 9))
If (Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 8)) < 0 Then Worksheets("natal").Cells((M% + 21), 9) = "R"
If (Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 8)) < 0 And Abs(Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 8)) > 300 Then Worksheets("natal").Cells((M% + 21), 9) = ""
If (Worksheets("natal").Cells((M% + 21), 10) - Worksheets("natal").Cells((M% + 21), 8)) > 300 Then Worksheets("natal").Cells((M% + 21), 9) = "R"
Next M%

Call sutkiBP '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
'|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(9, (13 + (NP% - 1) * 3)) = INDOM(Worksheets("natal").Cells((10 + NP%), 8), 4)
Next NP%
'|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(9, (46 + (NP% - 1) * 2)) = INDOM(Worksheets("natal").Cells((21 + NP%), 8), 4)
Next NP%


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.

    Sheets("natal").Select
    Range("A10").Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("BP").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 2) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call upravBP(2, 9, 6) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 9 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("BP").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call upravBP(4, 9, 13) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 9 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim D(0 To 12) As Integer
Dim STB As Integer
Dim DM As Integer

For M% = 11 To 21

For n% = 0 To 12
D(n%) = 0
Next n%

If Worksheets("BP").Cells(M%, 5) <> Worksheets("BP").Cells(M%, 12) Then
Worksheets("BP").Cells(M%, 19) = Worksheets("BP").Cells(M%, 5)
Worksheets("BP").Cells(M%, 20) = Worksheets("BP").Cells(M%, 12)
STB = 21
Else
Worksheets("BP").Cells(M%, 19) = Worksheets("BP").Cells(M%, 5)
STB = 20
End If
    
    For n% = 6 To 11
    DM = Int(Worksheets("BP").Cells(M%, n%))
    D(DM) = D(DM) + 1
    Next n%
    
    For n% = 13 To 18
    DM = Int(Worksheets("BP").Cells(M%, n%))
    D(DM) = D(DM) + 1
    Next n%
    
    For n% = 1 To 12
    If D(n%) > 0 Then
    Worksheets("BP").Cells(M%, STB) = n%
    STB = STB + 1
    Else
    End If
    Next n%
    
Next M%

For K% = 22 To 33
Worksheets("BP").Cells(K%, 19) = (K% - 21) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| B|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next K%

For K% = 11 To 33
Worksheets("BP").Cells(K%, 29) = INDOM(Worksheets("natal").Cells(K%, 8), 4) '|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next K%

For n% = 11 To 21
For K% = 5 To 28
Worksheets("BP").Cells(n%, (K% + 26)) = Worksheets("formula").Cells(n%, K%)
Next K%
Next n%

For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| B|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("BP").Cells((K% + 21), 31) = K%
Worksheets("BP").Cells((K% + 21), 38) = K%
Worksheets("BP").Cells((K% + 21), 45) = K%
Next K%

'============ |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.

STROKAL = 11
STROKA = 11

For K% = 22 To 33
Worksheets("BP").Cells(K%, 12) = (K% - 21)
Next K%

For n% = 11 To 33 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("BP").Cells(n%, 5) <> Worksheets("BP").Cells(n%, 29) And Worksheets("BP").Cells(n%, 12) <> Worksheets("BP").Cells(n%, 29) Then Worksheets("BP").Cells(n%, 28) = Worksheets("BP").Cells(n%, 29)
Next n%

For K% = 22 To 33
Worksheets("BP").Cells(K%, 13) = Worksheets("BP").Cells(K%, 28)
Next K%

'============ |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = 71

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 23 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells((KP% + 10), 2)
    L1 = Worksheets("natal").Cells((10 + KP%), 8)
If Worksheets("natal").Cells((10 + KP%), 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
Worksheets("BP").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("BP").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("BP").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("BP").Cells((STRLIST + 2), 2) = "|fffd||fffd||fffd||fffd||fffd|."
Worksheets("BP").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("BP").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(STRLIST, M%) = Worksheets("BP").Cells((NP% + 10), (26 + M%))
Worksheets("BP").Cells((STRLIST + 2), M%) = Worksheets("BP").Cells((KP% + 10), M%)
Next M%

If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "p"
        Else
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "p"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("BP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("BP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int((ORB - Abs(ASP1 - NA%)) / Abs(Worksheets("natal").Cells(100 + KP%, 5)))
Worksheets("BP").Cells(STRLIST + 1, 32) = JD
'DEL = Int(Worksheets("BP").Cells(67, 2)) * (1 / 24)
'If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 5))) < DEL Then Worksheets("BP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Call JDvDATA(JD)
Worksheets("BP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("BP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "c"
        Else
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "c"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("BP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("BP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 5)))
Worksheets("BP").Cells(STRLIST + 1, 32) = JD
DEL = Int(Worksheets("BP").Cells(67, 2)) * (1 / 24)
If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 5))) < DEL Then Worksheets("BP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Call JDvDATA(JD)
Worksheets("BP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("BP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = STRLIST + 4

Else
End If

Next NA%
Next KP%
Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
For NP% = 12 To 23 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 23 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| XII |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("BP").Cells((KP% + 10), 2)
    L1 = Worksheets("natal").Cells((10 + KP%), 8)
If Worksheets("natal").Cells((10 + KP%), 9) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|


'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
Worksheets("BP").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("BP").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("BP").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("BP").Cells((STRLIST + 2), 2) = "|fffd||fffd||fffd||fffd||fffd|."
Worksheets("BP").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("BP").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(STRLIST, M%) = Worksheets("BP").Cells((NP% + 10), (26 + M%))
Worksheets("BP").Cells((STRLIST + 2), M%) = Worksheets("BP").Cells((KP% + 10), M%)
Next M%

If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "p"
        Else
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "p"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("BP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("BP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int((1 - Abs(ASP1 - NA%)) / Abs(Worksheets("natal").Cells(100 + KP%, 5)))
Worksheets("BP").Cells(STRLIST + 1, 32) = JD
'DEL = Int(Worksheets("BP").Cells(67, 2)) * (1 / 24)
'If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 5))) < DEL Then Worksheets("BP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Call JDvDATA(JD)
Worksheets("BP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("BP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If KP% < 12 Then
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (13 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "c"
        Else
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)).Select
    With Selection.Font
    .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End With
    Worksheets("natal").Cells((NP% + 10), (46 + (KP% - 12) * 2)) = CStr(Int(NA%)) + "c"
        End If
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("BP").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("BP").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 5)))
Worksheets("BP").Cells(STRLIST + 1, 32) = JD
DEL = Int(Worksheets("BP").Cells(67, 2)) * (1 / 24)
If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 5))) < DEL Then Worksheets("BP").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Call JDvDATA(JD)
Worksheets("BP").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("BP").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("BP").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = STRLIST + 4

Else
End If

Next NA%
Next KP%
Next NP%

'================================

If Int(Worksheets("MP").Cells(34, 2)) = 0 Then GoTo FIN '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

'======== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NS% = 71 To 399 Step 4    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("BP").Cells(NS%, 12) = 0 And Worksheets("BP").Cells(NS% + 2, 12) = 0 Then GoTo netNS
ASP = Int(Worksheets("BP").Cells(NS% + 1, 2))

'========= |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|

For ND1% = 1 To 12
For ND2% = ND1% To 12
NDOM1 = 0
NDOM2 = 0
SDOM = 0

If ND1% <> ND2% Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 19 To 28
    If ND1% = Int(Worksheets("BP").Cells(NS%, M%)) Then NDOM1 = 1
    If ND1% = Int(Worksheets("BP").Cells(NS% + 2, M%)) Then NDOM1 = 1
    If ND2% = Int(Worksheets("BP").Cells(NS%, M%)) Then NDOM2 = 1
    If ND2% = Int(Worksheets("BP").Cells(NS% + 2, M%)) Then NDOM2 = 1
    Next M%
Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 19 To 28
    If ND1% = Int(Worksheets("BP").Cells(NS%, M%)) Then SDOM = SDOM + 1
    If ND1% = Int(Worksheets("BP").Cells(NS% + 2, M%)) Then SDOM = SDOM + 1
    Next M%
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

If (NDOM1 = 1 And NDOM2 = 1) Or SDOM > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If ASP = 30 Or ASP = 60 Or ASP = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells((39 + 2 * ND2%), (4 + ND1%)) = Worksheets("BP").Cells((39 + 2 * ND2%), (4 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    If ASP = 90 Or ASP = 150 Or ASP = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells((40 + 2 * ND2%), (4 + ND1%)) = Worksheets("BP").Cells((40 + 2 * ND2%), (4 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

    If ASP = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Int(Worksheets("natal").Cells((40 + ND1%), (10 + ND2%))) > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("BP").Cells((40 + 2 * ND2%), (4 + ND1%)) = Worksheets("BP").Cells((40 + 2 * ND2%), (4 + ND1%)) + 1
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("BP").Cells((39 + 2 * ND2%), (4 + ND1%)) = Worksheets("BP").Cells((39 + 2 * ND2%), (4 + ND1%)) + 1
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End If

Next ND2%
Next ND1%

'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For ND1% = 1 To 12
For ND2% = ND1% To 12
NDOM1 = 0
NDOM2 = 0
SDOM = 0

If ND1% <> ND2% Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 12 To 18
    If ND1% = Int(Worksheets("BP").Cells(NS%, M%)) Then NDOM1 = 1
    If ND1% = Int(Worksheets("BP").Cells(NS% + 2, M%)) Then NDOM1 = 1
    If ND2% = Int(Worksheets("BP").Cells(NS%, M%)) Then NDOM2 = 1
    If ND2% = Int(Worksheets("BP").Cells(NS% + 2, M%)) Then NDOM2 = 1
    Next M%
Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 12 To 18
    If ND1% = Int(Worksheets("BP").Cells(NS%, M%)) Then SDOM = SDOM + 1
    If ND1% = Int(Worksheets("BP").Cells(NS% + 2, M%)) Then SDOM = SDOM + 1
    Next M%
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

If (NDOM1 = 1 And NDOM2 = 1) Or SDOM > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If ASP = 30 Or ASP = 60 Or ASP = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells((39 + 2 * ND2%), (16 + ND1%)) = Worksheets("BP").Cells((39 + 2 * ND2%), (16 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    If ASP = 90 Or ASP = 150 Or ASP = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("BP").Cells((40 + 2 * ND2%), (16 + ND1%)) = Worksheets("BP").Cells((40 + 2 * ND2%), (16 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

    If ASP = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Int(Worksheets("natal").Cells((40 + ND1%), (10 + ND2%))) > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("BP").Cells((40 + 2 * ND2%), (16 + ND1%)) = Worksheets("BP").Cells((40 + 2 * ND2%), (16 + ND1%)) + 1
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("BP").Cells((39 + 2 * ND2%), (16 + ND1%)) = Worksheets("BP").Cells((39 + 2 * ND2%), (16 + ND1%)) + 1
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End If

Next ND2%
Next ND1%

netNS: Next NS%

FIN:

Worksheets("BP").Select
Range("A9").Select

End Sub
Sub lunar()

Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NTAB = Int(Worksheets("lunar").Cells(4, 2))

    Sheets("lunar").Select
    Range("E11:BZ21").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 9
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER512").Select
    Selection.ClearContents
    Range("E521:ER532").Select
    Selection.ClearContents
    Range("E541:ER552").Select
    Selection.ClearContents
    Range("E561:ER572").Select
    Selection.ClearContents
    Range("A9").Select
    
    Sheets("lunar").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    
    Sheets("natal").Select
    Range("B2:D3").Select
    Selection.Copy
    Sheets("LList").Select
    Range("B2:D3").Select
    ActiveSheet.Paste
    Range("A11:Z3000").Select
    Selection.ClearContents
    Range("A10").Select
    Sheets("natal").Select
    Range("A10").Select
    
    Call proverka
    Call radiks
    
    Worksheets("natal").Cells(10, 10) = "|fffd||fffd||fffd||fffd||fffd|"
    
Dim JDNN As Long
Dim DEL As Double
Dim B As Double
Dim JDTR As Double
Dim DDNL(500, 12, 12) As Integer '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
Dim DDL(500, 12, 12) As Integer '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(3, 11) = JDNN
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
JDTR = Worksheets("natal").Cells(3, 9)
B = Worksheets("natal").Cells(3, 9) - Int(Worksheets("natal").Cells(3, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(JDNN, B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

DEL = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(12, 10))
If DEL < 2 / 10000 Then DEL = 180

m1: JDTR = JDTR + (DEL / 32)
Call JDvDATA(JDTR)
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(3, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(3, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(3, 7) = Worksheets("natal").Cells(71, 7)
Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(3, 11) = JDNN
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
B = Worksheets("natal").Cells(3, 9) - Int(Worksheets("natal").Cells(3, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(JDNN, B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
DEL = ASPECT(Worksheets("natal").Cells(12, 2), Worksheets("natal").Cells(12, 10))
If DEL > 1 / 10000 Then GoTo m1

Sheets("natal").Select
    Range("B2:G8").Select
    Selection.Copy
    Sheets("lunar").Select
    Range("B2:G8").Select
    ActiveSheet.Paste
    Range("A9").Select
    Sheets("natal").Select
    Range("B2:D3").Select
    Selection.Copy
    Sheets("LList").Select
    Range("B2:D3").Select
    ActiveSheet.Paste
Sheets("natal").Select
Range("A9").Select

If NTAB <> 1 Or NTAB <> 3 Or NTAB <> 5 Or NTAB <> 7 Then NTAB = 1
Worksheets("lunar").Cells(4, 2) = NTAB

'--------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ZV0 = ZV00((Int(Worksheets("natal").Cells(3, 9)) + 1 / 2))
GMT = Worksheets("natal").Cells(3, 5) + Worksheets("natal").Cells(3, 6) / 60 + Worksheets("natal").Cells(3, 7) / 3600

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
LonGrad = Worksheets("natal").Cells(35, 5)
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
ZVchas = ZV / 15
Worksheets("natal").Cells(35, 2) = Int(ZVchas)
ZVh = Int(ZVchas)
ZVm = (ZVchas - ZVh) * 60
Worksheets("natal").Cells(35, 3) = Int(ZVm)
ZVs = Int((ZVm - Int(ZVm)) * 60 + 1 / 2)
Worksheets("natal").Cells(35, 4) = ZVs
LatGrad = Worksheets("natal").Cells(35, 6)
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 10) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(3, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
LonGrad = Worksheets("natal").Cells(36, 5)
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
ZVchas = ZV / 15
Worksheets("natal").Cells(36, 2) = Int(ZVchas)
ZVh = Int(ZVchas)
ZVm = (ZVchas - ZVh) * 60
Worksheets("natal").Cells(36, 3) = Int(ZVm)
ZVs = Int((ZVm - Int(ZVm)) * 60 + 1 / 2)
Worksheets("natal").Cells(36, 4) = ZVs
LatGrad = Worksheets("natal").Cells(36, 6)
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 11) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(3, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("lunar").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 10), 10) '10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("lunar").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|

Call upravLUNARnat(10, 11, 6) '10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 11 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Call LUNARsort(5, 11) '5-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 11-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("lunar").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 10), 11) '11 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("lunar").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|

Call upravLUNARloc(10, 11, 13) '10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, 11 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Call LUNARsort(12, 18) '12-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 18-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim EEE(11, 3, 12) As Integer
Dim E3(11, 24) As Integer
Dim NDOM As Integer
Dim DD As Integer
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROKA As Long
Dim STROKAL As Long
STROKAL = 11
STROKA = 11

For n% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For M% = 5 To 11 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| N-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 - 12
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| k% |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("lunar").Cells((10 + n%), M%) = K% Then EEE(n%, 1, K%) = EEE(n%, 1, K%) + 1
If Worksheets("lunar").Cells((10 + n%), (7 + M%)) = K% Then EEE(n%, 2, K%) = EEE(n%, 2, K%) + 1
Next K%
Next M%
Next n%

For n% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 - 12
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| k% |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 0 Then EEE(n%, 3, K%) = 0 '|fffd||fffd||fffd| k% |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 1 Then EEE(n%, 3, K%) = 1 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd|
If EEE(n%, 1, K%) = 1 And EEE(n%, 2, K%) = 1 Then EEE(n%, 3, K%) = 1 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd|
If EEE(n%, 1, K%) = 0 And EEE(n%, 2, K%) = 2 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
If EEE(n%, 1, K%) = 2 And EEE(n%, 2, K%) = 0 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 3 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 4 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
For n% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 - 12
If EEE(n%, 3, K%) = 1 Then E3(n%, (2 * K% - 1)) = K%
If EEE(n%, 3, K%) = 2 Then
E3(n%, (2 * K% - 1)) = K%
E3(n%, (2 * K%)) = K%
Else
End If
Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 11 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 1 To 23
For M% = (n% + 1) To 20
If E3(K%, n%) > E3(K%, M%) Then
NDOM = E3(K%, n%)
E3(K%, n%) = E3(K%, M%)
E3(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 1 To 11
NDOM = 19
For n% = 1 To 24
If E3(K%, n%) = 0 Then GoTo netuuu
Worksheets("lunar").Cells((10 + K%), NDOM) = E3(K%, n%)
NDOM = NDOM + 1
netuuu: Next n%
Next K%

For K% = 11 To 21
Worksheets("lunar").Cells(K%, 29) = INDOM(Worksheets("natal").Cells(K%, 10), 4) '|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next K%

For n% = 11 To 21
For K% = 5 To 28
Worksheets("lunar").Cells(n%, (K% + 26)) = Worksheets("formula").Cells(n%, K%)
Next K%
Next n%

For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Worksheets("lunar").Cells(n%, K%) = Worksheets("lunar").Cells(n%, 29) Then DD = 1
Next K%
If DD = 0 Then Worksheets("lunar").Cells(n%, 28) = Worksheets("lunar").Cells(n%, 29)
Worksheets("lunar").Cells(n%, 18) = Worksheets("lunar").Cells(n%, 28)
 
NDOM1 = Worksheets("lunar").Cells(n%, 29)
    
For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Worksheets("lunar").Cells(n%, M%)
If NDOM2 = 0 Or NDOM2 = NDOM1 Then GoTo netNDom2TR

Worksheets("lunar").Cells((500 + NDOM1), (12 * NDOM2 - 1)) = Worksheets("lunar").Cells((500 + NDOM1), (12 * NDOM2 - 1)) + 1
If NDOM2 <> NDOM1 Then Worksheets("lunar").Cells((500 + NDOM2), (12 * NDOM1 - 1)) = Worksheets("lunar").Cells((500 + NDOM2), (12 * NDOM1 - 1)) + 1
    
If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("LList").Cells(STROKA, 1) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKA, 2) = NDOM2
    Worksheets("LList").Cells(STROKA, 3) = "#"
    Worksheets("LList").Cells(STROKA, 4) = NDOM1
    Worksheets("LList").Cells(STROKA, 5) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKA, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKA = STROKA + 1
    If NDOM1 <= NDOM2 Then Worksheets("lunar").Cells((40 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("lunar").Cells((40 + 2 * NDOM2), (4 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("lunar").Cells((40 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("lunar").Cells((40 + 2 * NDOM1), (4 + NDOM2)) + 1
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("LList").Cells(STROKA, 1) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKA, 2) = NDOM2
    Worksheets("LList").Cells(STROKA, 3) = "&"
    Worksheets("LList").Cells(STROKA, 4) = NDOM1
    Worksheets("LList").Cells(STROKA, 5) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKA, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKA = STROKA + 1
    If NDOM1 <= NDOM2 Then Worksheets("lunar").Cells((39 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("lunar").Cells((39 + 2 * NDOM2), (4 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("lunar").Cells((39 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("lunar").Cells((39 + 2 * NDOM1), (4 + NDOM2)) + 1
End If

netNDom2TR: Next M%

DD = 0
Next n%

'-------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("lunar").Cells(n%, 29)

For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Worksheets("lunar").Cells(n%, M%)
If NDOM2 = 0 Or NDOM2 = NDOM1 Then GoTo netNDom22TR

Worksheets("lunar").Cells((520 + NDOM1), (12 * NDOM2 - 1)) = Worksheets("lunar").Cells((520 + NDOM1), (12 * NDOM2 - 1)) + 1
If NDOM2 <> NDOM1 Then Worksheets("lunar").Cells((520 + NDOM2), (12 * NDOM1 - 1)) = Worksheets("lunar").Cells((520 + NDOM2), (12 * NDOM1 - 1)) + 1
    
If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("LList").Cells(STROKAL, 9) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKAL, 10) = NDOM2
    Worksheets("LList").Cells(STROKAL, 11) = "#"
    Worksheets("LList").Cells(STROKAL, 12) = NDOM1
    Worksheets("LList").Cells(STROKAL, 13) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKAL, 15) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKAL = STROKAL + 1
    If NDOM1 <= NDOM2 Then Worksheets("lunar").Cells((40 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("lunar").Cells((40 + 2 * NDOM2), (16 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("lunar").Cells((40 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("lunar").Cells((40 + 2 * NDOM1), (16 + NDOM2)) + 1
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("LList").Cells(STROKAL, 9) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKAL, 10) = NDOM2
    Worksheets("LList").Cells(STROKAL, 11) = "&"
    Worksheets("LList").Cells(STROKAL, 12) = NDOM1
    Worksheets("LList").Cells(STROKAL, 13) = Worksheets("natal").Cells(n%, 1)
    Worksheets("LList").Cells(STROKAL, 15) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKAL = STROKAL + 1
    If NDOM1 <= NDOM2 Then Worksheets("lunar").Cells((39 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("lunar").Cells((39 + 2 * NDOM2), (16 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("lunar").Cells((39 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("lunar").Cells((39 + 2 * NDOM1), (16 + NDOM2)) + 1
End If

netNDom22TR: Next M%

Next n%
'=======================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STRLIST As Integer

STRLIST = 71

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("orb").Cells(NTAB * 10 + NP%, 10 + KP%)
    L1 = Worksheets("natal").Cells((10 + KP%), 10)
If Worksheets("natal").Cells((10 + KP%), 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 60, 90, 120, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA01
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("lunar").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("lunar").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("lunar").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("lunar").Cells((STRLIST + 2), 2) = "|fffd||fffd||fffd||fffd||fffd|"
Worksheets("lunar").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("lunar").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("lunar").Cells(STRLIST, M%) = Worksheets("lunar").Cells((NP% + 10), (26 + M%))
Worksheets("lunar").Cells((STRLIST + 2), M%) = Worksheets("lunar").Cells((KP% + 10), M%)
Next M%

    If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then Worksheets("lunar").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("lunar").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
    STRLIST = STRLIST + 4
    
Else
End If

netNA01: Next NA%
Next KP%
Next NP%

Dim flagN1 As Integer
Dim flagN2 As Integer
Dim flagK1 As Integer
Dim flagK2 As Integer

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For n% = 1 To 11              '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For K% = n% To 12             '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For NS% = 71 To 399 Step 4    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("lunar").Cells(NS% + 1, 2) = 0 And Worksheets("lunar").Cells(NS% + 1, 3) = 0 Then GoTo netNS
'|fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
        For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If n% <> K% Then
        If Worksheets("lunar").Cells(NS%, M%) = n% Then DDNL(NS%, n%, 0) = 1
        If Worksheets("lunar").Cells(NS% + 2, M%) = n% Then DDNL(NS%, n%, 0) = 1
        If Worksheets("lunar").Cells(NS%, M%) = K% Then DDNL(NS%, 0, K%) = 1
        If Worksheets("lunar").Cells(NS% + 2, M%) = K% Then DDNL(NS%, 0, K%) = 1
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If Worksheets("lunar").Cells(NS%, M%) = n% Then flagN1 = 1
            If Worksheets("lunar").Cells(NS% + 2, M%) = K% Then flagK2 = 1
            If Worksheets("lunar").Cells(NS% + 2, M%) = n% Then flagN2 = 1
            If Worksheets("lunar").Cells(NS%, M%) = K% Then flagK1 = 1
            If flagN1 = 1 And flagK2 = 1 Then
            DDNL(NS%, n%, 0) = 1
            DDNL(NS%, 0, K%) = 1
            Else
            End If
            If flagN2 = 1 And flagK1 = 1 Then
            DDNL(NS%, n%, 0) = 1
            DDNL(NS%, 0, K%) = 1
            Else
            End If
        End If
        Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
flagN1 = 0
flagN2 = 0
flagK1 = 0
flagK2 = 0
If DDNL(NS%, n%, 0) = 1 And DDNL(NS%, 0, K%) = 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("LList").Cells(STROKA, 1) = Worksheets("lunar").Cells(NS%, 1)
    Worksheets("LList").Cells(STROKA, 2) = n%
    Worksheets("LList").Cells(STROKA, 4) = K%
    Worksheets("LList").Cells(STROKA, 5) = Worksheets("lunar").Cells(NS% + 2, 1)
    Worksheets("LList").Cells(STROKA, 6) = Worksheets("lunar").Cells(NS% + 1, 3)
    Worksheets("LList").Cells(STROKA, 7) = Worksheets("lunar").Cells(NS% + 1, 4)
    Worksheets("LList").Cells(STROKA, 8) = Int(Worksheets("lunar").Cells(NS% + 1, 2))
    
        If Worksheets("lunar").Cells(NS% + 1, 2) < 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               If Worksheets("natal").Cells((40 + n%), (10 + K%)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
               
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K%)) = Worksheets("lunar").Cells((500 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n%)) = Worksheets("lunar").Cells((500 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((500 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((500 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((500 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((500 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((540 + n%), (12 * K%)) = Worksheets("lunar").Cells((540 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((540 + K%), (12 * n%)) = Worksheets("lunar").Cells((540 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((540 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((540 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((540 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((540 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K% - 1)) = Worksheets("lunar").Cells((500 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 1)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 1)) + 1
                     End If
               
               Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K%)) = Worksheets("lunar").Cells((500 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n%)) = Worksheets("lunar").Cells((500 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((500 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((500 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((500 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((500 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((540 + n%), (12 * K%)) = Worksheets("lunar").Cells((540 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((540 + K%), (12 * n%)) = Worksheets("lunar").Cells((540 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((540 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((540 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((540 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((540 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K% - 1)) = Worksheets("lunar").Cells((500 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 1)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 1)) + 1
                     End If
               
               End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 90 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 150 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 180 Then
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K% - 3)) = Worksheets("lunar").Cells((500 + n%), (12 * K% - 3)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 3)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 3)) + 1
                        If Worksheets("lunar").Cells((500 + n%), (12 * K% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + n%), (12 * K% - 2)) = 0 Then Worksheets("lunar").Cells((500 + n%), (12 * K% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((500 + K%), (12 * n% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + K%), (12 * n% - 2)) = 0 Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((540 + n%), (12 * K% - 3)) = Worksheets("lunar").Cells((540 + n%), (12 * K% - 3)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((540 + K%), (12 * n% - 3)) = Worksheets("lunar").Cells((540 + K%), (12 * n% - 3)) + 1
                        If Worksheets("lunar").Cells((540 + n%), (12 * K% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + n%), (12 * K% - 2)) = 0 Then Worksheets("lunar").Cells((540 + n%), (12 * K% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((540 + K%), (12 * n% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + K%), (12 * n% - 2)) = 0 Then Worksheets("lunar").Cells((540 + K%), (12 * n% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K% - 4)) = Worksheets("lunar").Cells((500 + n%), (12 * K% - 4)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 4)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 4)) + 1
                     End If
Else
End If
'|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 30 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 60 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 120 Then
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K% - 6)) = Worksheets("lunar").Cells((500 + n%), (12 * K% - 6)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 6)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 6)) + 1
                        If Worksheets("lunar").Cells((500 + n%), (12 * K% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + n%), (12 * K% - 5)) = 0 Then Worksheets("lunar").Cells((500 + n%), (12 * K% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((500 + K%), (12 * n% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((500 + K%), (12 * n% - 5)) = 0 Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((540 + n%), (12 * K% - 6)) = Worksheets("lunar").Cells((540 + n%), (12 * K% - 6)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((540 + K%), (12 * n% - 6)) = Worksheets("lunar").Cells((540 + K%), (12 * n% - 6)) + 1
                        If Worksheets("lunar").Cells((540 + n%), (12 * K% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + n%), (12 * K% - 5)) = 0 Then Worksheets("lunar").Cells((540 + n%), (12 * K% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((540 + K%), (12 * n% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((540 + K%), (12 * n% - 5)) = 0 Then Worksheets("lunar").Cells((540 + K%), (12 * n% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("LList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("lunar").Cells((500 + n%), (12 * K% - 7)) = Worksheets("lunar").Cells((500 + n%), (12 * K% - 7)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((500 + K%), (12 * n% - 7)) = Worksheets("lunar").Cells((500 + K%), (12 * n% - 7)) + 1
                     End If
Else
End If
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd|====================

        For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If n% <> K% Then
        If Worksheets("lunar").Cells(NS%, M%) = n% Then DDL(NS%, n%, 0) = 1
        If Worksheets("lunar").Cells(NS% + 2, M%) = n% Then DDL(NS%, n%, 0) = 1
        If Worksheets("lunar").Cells(NS%, M%) = K% Then DDL(NS%, 0, K%) = 1
        If Worksheets("lunar").Cells(NS% + 2, M%) = K% Then DDL(NS%, 0, K%) = 1
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If Worksheets("lunar").Cells(NS%, M%) = n% Then flagN1 = 1
            If Worksheets("lunar").Cells(NS% + 2, M%) = K% Then flagK2 = 1
            If Worksheets("lunar").Cells(NS% + 2, M%) = n% Then flagN2 = 1
            If Worksheets("lunar").Cells(NS%, M%) = K% Then flagK1 = 1
            If flagN1 = 1 And flagK2 = 1 Then
            DDL(NS%, n%, 0) = 1
            DDL(NS%, 0, K%) = 1
            Else
            End If
            If flagN2 = 1 And flagK1 = 1 Then
            DDL(NS%, n%, 0) = 1
            DDL(NS%, 0, K%) = 1
            Else
            End If
        End If
        Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
flagN1 = 0
flagN2 = 0
flagK1 = 0
flagK2 = 0
If DDL(NS%, n%, 0) = 1 And DDL(NS%, 0, K%) = 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("LList").Cells(STROKAL, 9) = Worksheets("lunar").Cells(NS%, 1)
    Worksheets("LList").Cells(STROKAL, 10) = n%
    Worksheets("LList").Cells(STROKAL, 12) = K%
    Worksheets("LList").Cells(STROKAL, 13) = Worksheets("lunar").Cells(NS% + 2, 1)
    Worksheets("LList").Cells(STROKAL, 14) = Worksheets("lunar").Cells(NS% + 1, 3)
    Worksheets("LList").Cells(STROKAL, 15) = Worksheets("lunar").Cells(NS% + 1, 4)
    Worksheets("LList").Cells(STROKAL, 16) = Int(Worksheets("lunar").Cells(NS% + 1, 2))
    
        If Worksheets("lunar").Cells(NS% + 1, 2) < 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               If Worksheets("natal").Cells((40 + n%), (10 + K%)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
               
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K%)) = Worksheets("lunar").Cells((520 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n%)) = Worksheets("lunar").Cells((520 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((520 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((520 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((520 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((520 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((560 + n%), (12 * K%)) = Worksheets("lunar").Cells((560 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((560 + K%), (12 * n%)) = Worksheets("lunar").Cells((560 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((560 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((560 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((560 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((560 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K% - 1)) = Worksheets("lunar").Cells((520 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 1)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 1)) + 1
                     End If
               
               Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K%)) = Worksheets("lunar").Cells((520 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n%)) = Worksheets("lunar").Cells((520 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((520 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((520 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((520 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((520 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((560 + n%), (12 * K%)) = Worksheets("lunar").Cells((560 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((560 + K%), (12 * n%)) = Worksheets("lunar").Cells((560 + K%), (12 * n%)) + 1
                        If Worksheets("lunar").Cells((560 + n%), (12 * K% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + n%), (12 * K% + 1)) = 0 Then Worksheets("lunar").Cells((560 + n%), (12 * K% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((560 + K%), (12 * n% + 1)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + K%), (12 * n% + 1)) = 0 Then Worksheets("lunar").Cells((560 + K%), (12 * n% + 1)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K% - 1)) = Worksheets("lunar").Cells((520 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 1)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 1)) + 1
                     End If
               
               End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 90 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 150 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 180 Then
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K% - 3)) = Worksheets("lunar").Cells((520 + n%), (12 * K% - 3)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 3)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 3)) + 1
                        If Worksheets("lunar").Cells((520 + n%), (12 * K% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + n%), (12 * K% - 2)) = 0 Then Worksheets("lunar").Cells((520 + n%), (12 * K% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((520 + K%), (12 * n% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + K%), (12 * n% - 2)) = 0 Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((560 + n%), (12 * K% - 3)) = Worksheets("lunar").Cells((560 + n%), (12 * K% - 3)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((560 + K%), (12 * n% - 3)) = Worksheets("lunar").Cells((560 + K%), (12 * n% - 3)) + 1
                        If Worksheets("lunar").Cells((560 + n%), (12 * K% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + n%), (12 * K% - 2)) = 0 Then Worksheets("lunar").Cells((560 + n%), (12 * K% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((560 + K%), (12 * n% - 2)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + K%), (12 * n% - 2)) = 0 Then Worksheets("lunar").Cells((560 + K%), (12 * n% - 2)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K% - 4)) = Worksheets("lunar").Cells((520 + n%), (12 * K% - 4)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 4)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 4)) + 1
                     End If
Else
End If
'|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 30 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 60 Or Int(Worksheets("lunar").Cells(NS% + 1, 2)) = 120 Then
                    If Trim(Worksheets("lunar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K% - 6)) = Worksheets("lunar").Cells((520 + n%), (12 * K% - 6)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 6)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 6)) + 1
                        If Worksheets("lunar").Cells((520 + n%), (12 * K% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + n%), (12 * K% - 5)) = 0 Then Worksheets("lunar").Cells((520 + n%), (12 * K% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((520 + K%), (12 * n% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((520 + K%), (12 * n% - 5)) = 0 Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("lunar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("lunar").Cells((560 + n%), (12 * K% - 6)) = Worksheets("lunar").Cells((560 + n%), (12 * K% - 6)) + 1
                            If n% <> K% Then Worksheets("lunar").Cells((560 + K%), (12 * n% - 6)) = Worksheets("lunar").Cells((560 + K%), (12 * n% - 6)) + 1
                        If Worksheets("lunar").Cells((560 + n%), (12 * K% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + n%), (12 * K% - 5)) = 0 Then Worksheets("lunar").Cells((560 + n%), (12 * K% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                        If Worksheets("lunar").Cells((560 + K%), (12 * n% - 5)) > Worksheets("lunar").Cells(NS% + 1, 3) Or Worksheets("lunar").Cells((560 + K%), (12 * n% - 5)) = 0 Then Worksheets("lunar").Cells((560 + K%), (12 * n% - 5)) = Worksheets("lunar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("lunar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("LList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("lunar").Cells((520 + n%), (12 * K% - 7)) = Worksheets("lunar").Cells((520 + n%), (12 * K% - 7)) + 1
                        If n% <> K% Then Worksheets("lunar").Cells((520 + K%), (12 * n% - 7)) = Worksheets("lunar").Cells((520 + K%), (12 * n% - 7)) + 1
                     End If
Else
End If
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|


netNS: Next NS%
Next K%
Next n%

Call sumLUNAR

Worksheets("LList").Select
Range("A8").Select
Worksheets("lunar").Select
Range("A9").Select

End Sub
Sub solar()

Dim NTAB As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NTAB = Int(Worksheets("solar").Cells(4, 2))

Sheets("solar").Select
    Range("E11:BZ21").Select
    Application.CutCopyMode = False
    Selection.ClearContents
    ActiveWindow.ScrollRow = 9
    Range("E41:AB64").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
    End With
    Range("E501:ER512").Select
    Selection.ClearContents
    Range("E521:ER532").Select
    Selection.ClearContents
    Range("E541:ER552").Select
    Selection.ClearContents
    Range("E561:ER572").Select
    Selection.ClearContents
    Range("A9").Select
    
    Sheets("solar").Select
    Rows("71:401").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 11
    
    Sheets("natal").Select
    Range("B2:D3").Select
    Selection.Copy
    Sheets("SList").Select
    Range("B2:D3").Select
    ActiveSheet.Paste
    Range("A11:Z3000").Select
    Selection.ClearContents
    Range("A10").Select
    Sheets("natal").Select
    Range("A10").Select
    
    With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With
    
    Call proverka
    Call radiks
    
    Worksheets("natal").Cells(10, 10) = "|fffd||fffd||fffd||fffd||fffd|"

Dim JDNN As Long
Dim DEL As Double
Dim B As Double
Dim JDTR As Double
Dim DDNL(500, 12, 12) As Integer '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
Dim DDL(500, 12, 12) As Integer '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Worksheets("natal").Cells(3, 2) = 1 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = 1
Worksheets("natal").Cells(3, 5) = 0
Worksheets("natal").Cells(3, 6) = 0
Worksheets("natal").Cells(3, 7) = 0

Call DATAvJD(1, 1, Int(Worksheets("natal").Cells(3, 4)), 0, 0, 0)
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(3, 11) = JDNN
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(JDNN, 0, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
DEL = ASPECT(Worksheets("natal").Cells(11, 2), Worksheets("natal").Cells(11, 10))
JDTR = Worksheets("natal").Cells(81, 1)

m1: JDTR = JDTR + (DEL * 7 / 10)
'Worksheets("natal").Cells(6, 1) = JDTR
Call JDvDATA(JDTR)
Worksheets("natal").Cells(3, 2) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(3, 3) = Worksheets("natal").Cells(71, 3)
Worksheets("natal").Cells(3, 4) = Worksheets("natal").Cells(71, 4)
Worksheets("natal").Cells(3, 5) = Worksheets("natal").Cells(71, 5)
Worksheets("natal").Cells(3, 6) = Worksheets("natal").Cells(71, 6)
Worksheets("natal").Cells(3, 7) = Worksheets("natal").Cells(71, 7)

Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
JDNN = Worksheets("natal").Cells(81, 8)
Worksheets("natal").Cells(3, 11) = JDNN
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
B = Worksheets("natal").Cells(3, 9) - Int(Worksheets("natal").Cells(3, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(JDNN, B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
DEL = ASPECT(Worksheets("natal").Cells(11, 2), Worksheets("natal").Cells(11, 10))

If DEL > 1 / 5000 Then GoTo m1

Sheets("natal").Select
    Range("B2:G8").Select
    Selection.Copy
    Sheets("solar").Select
    Range("B2:G8").Select
    ActiveSheet.Paste
    Range("A9").Select
    Sheets("natal").Select
    Range("B2:D3").Select
    Selection.Copy
    Sheets("SList").Select
    Range("B2:D3").Select
    ActiveSheet.Paste
Sheets("natal").Select
Range("A9").Select

If NTAB <> 1 Or NTAB <> 3 Or NTAB <> 5 Or NTAB <> 7 Then NTAB = 1
Worksheets("solar").Cells(4, 2) = NTAB

'--------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ZV0 = ZV00((Int(Worksheets("natal").Cells(3, 9)) + 1 / 2))
GMT = Worksheets("natal").Cells(3, 5) + Worksheets("natal").Cells(3, 6) / 60 + Worksheets("natal").Cells(3, 7) / 3600

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
LonGrad = Worksheets("natal").Cells(35, 5)
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
ZVchas = ZV / 15
Worksheets("natal").Cells(35, 2) = Int(ZVchas)
ZVh = Int(ZVchas)
ZVm = (ZVchas - ZVh) * 60
Worksheets("natal").Cells(35, 3) = Int(ZVm)
ZVs = Int((ZVm - Int(ZVm)) * 60 + 1 / 2)
Worksheets("natal").Cells(35, 4) = ZVs
LatGrad = Worksheets("natal").Cells(35, 6)
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 10) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(3, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
LonGrad = Worksheets("natal").Cells(36, 5)
ZV = (ZV0 + GMT + GMT / 365.25) * 15 + LonGrad '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
If ZV > 360 Then ZV = ZV - 360
ZVchas = ZV / 15
Worksheets("natal").Cells(36, 2) = Int(ZVchas)
ZVh = Int(ZVchas)
ZVm = (ZVchas - ZVh) * 60
Worksheets("natal").Cells(36, 3) = Int(ZVm)
ZVs = Int((ZVm - Int(ZVm)) * 60 + 1 / 2)
Worksheets("natal").Cells(36, 4) = ZVs
LatGrad = Worksheets("natal").Cells(36, 6)
For M% = 1 To 12
Worksheets("natal").Cells((M% + 21), 11) = Koh(ZV, M%, LatGrad, Worksheets("natal").Cells(3, 9)) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("solar").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 10), 10) '10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("solar").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|

Call upravSOLARnat(10, 11, 6) '10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 11 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Call SOLARsort(5, 11) '5-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 11-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("solar").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 10), 11) '11 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("solar").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|

Call upravSOLARloc(10, 11, 13) '10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, 11 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Call SOLARsort(12, 18) '12-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 18-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim EEE(11, 3, 12) As Integer
Dim E3(11, 24) As Integer
Dim NDOM As Integer
Dim DD As Integer
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROKA As Long
Dim STROKAL As Long
STROKAL = 11
STROKA = 11

For n% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For M% = 5 To 11 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| N-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 - 12
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| k% |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("solar").Cells((10 + n%), M%) = K% Then EEE(n%, 1, K%) = EEE(n%, 1, K%) + 1
If Worksheets("solar").Cells((10 + n%), (7 + M%)) = K% Then EEE(n%, 2, K%) = EEE(n%, 2, K%) + 1
Next K%
Next M%
Next n%

For n% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 - 12
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| k% |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 0 Then EEE(n%, 3, K%) = 0 '|fffd||fffd||fffd| k% |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 1 Then EEE(n%, 3, K%) = 1 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd|
If EEE(n%, 1, K%) = 1 And EEE(n%, 2, K%) = 1 Then EEE(n%, 3, K%) = 1 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd|
If EEE(n%, 1, K%) = 0 And EEE(n%, 2, K%) = 2 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
If EEE(n%, 1, K%) = 2 And EEE(n%, 2, K%) = 0 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 3 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
If (EEE(n%, 1, K%) + EEE(n%, 2, K%)) = 4 Then EEE(n%, 3, K%) = 2 '|fffd||fffd||fffd| k% |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd|
Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
For n% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 12 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 - 12
If EEE(n%, 3, K%) = 1 Then E3(n%, (2 * K% - 1)) = K%
If EEE(n%, 3, K%) = 2 Then
E3(n%, (2 * K% - 1)) = K%
E3(n%, (2 * K%)) = K%
Else
End If
Next K%
Next n%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
For K% = 1 To 11 '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 1 To 23
For M% = (n% + 1) To 20
If E3(K%, n%) > E3(K%, M%) Then
NDOM = E3(K%, n%)
E3(K%, n%) = E3(K%, M%)
E3(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 1 To 11
NDOM = 19
For n% = 1 To 24
If E3(K%, n%) = 0 Then GoTo netuuu
Worksheets("solar").Cells((10 + K%), NDOM) = E3(K%, n%)
NDOM = NDOM + 1
netuuu: Next n%
Next K%

For K% = 11 To 21
Worksheets("solar").Cells(K%, 29) = INDOM(Worksheets("natal").Cells(K%, 10), 4) '|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next K%

For n% = 11 To 21
For K% = 5 To 28
Worksheets("solar").Cells(n%, (K% + 26)) = Worksheets("formula").Cells(n%, K%)
Next K%
Next n%

For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Worksheets("solar").Cells(n%, K%) = Worksheets("solar").Cells(n%, 29) Then DD = 1
Next K%
If DD = 0 Then Worksheets("solar").Cells(n%, 28) = Worksheets("solar").Cells(n%, 29)
Worksheets("solar").Cells(n%, 18) = Worksheets("solar").Cells(n%, 28)
 
NDOM1 = Worksheets("solar").Cells(n%, 29)
    
For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Worksheets("solar").Cells(n%, M%)
If NDOM2 = 0 Or NDOM2 = NDOM1 Then GoTo netNDom2TR

Worksheets("solar").Cells((500 + NDOM1), (12 * NDOM2 - 1)) = Worksheets("solar").Cells((500 + NDOM1), (12 * NDOM2 - 1)) + 1
If NDOM2 <> NDOM1 Then Worksheets("solar").Cells((500 + NDOM2), (12 * NDOM1 - 1)) = Worksheets("solar").Cells((500 + NDOM2), (12 * NDOM1 - 1)) + 1
    
If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("SList").Cells(STROKA, 1) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKA, 2) = NDOM2
    Worksheets("SList").Cells(STROKA, 3) = "#"
    Worksheets("SList").Cells(STROKA, 4) = NDOM1
    Worksheets("SList").Cells(STROKA, 5) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKA, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKA = STROKA + 1
    If NDOM1 <= NDOM2 Then Worksheets("solar").Cells((40 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("solar").Cells((40 + 2 * NDOM2), (4 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("solar").Cells((40 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("solar").Cells((40 + 2 * NDOM1), (4 + NDOM2)) + 1
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("SList").Cells(STROKA, 1) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKA, 2) = NDOM2
    Worksheets("SList").Cells(STROKA, 3) = "&"
    Worksheets("SList").Cells(STROKA, 4) = NDOM1
    Worksheets("SList").Cells(STROKA, 5) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKA, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKA = STROKA + 1
    If NDOM1 <= NDOM2 Then Worksheets("solar").Cells((39 + 2 * NDOM2), (4 + NDOM1)) = Worksheets("solar").Cells((39 + 2 * NDOM2), (4 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("solar").Cells((39 + 2 * NDOM1), (4 + NDOM2)) = Worksheets("solar").Cells((39 + 2 * NDOM1), (4 + NDOM2)) + 1
End If

netNDom2TR: Next M%

DD = 0
Next n%

'-------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM1 = Worksheets("solar").Cells(n%, 29)

For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NDOM2 = Worksheets("solar").Cells(n%, M%)
If NDOM2 = 0 Or NDOM2 = NDOM1 Then GoTo netNDom22TR

Worksheets("solar").Cells((520 + NDOM1), (12 * NDOM2 - 1)) = Worksheets("solar").Cells((520 + NDOM1), (12 * NDOM2 - 1)) + 1
If NDOM2 <> NDOM1 Then Worksheets("solar").Cells((520 + NDOM2), (12 * NDOM1 - 1)) = Worksheets("solar").Cells((520 + NDOM2), (12 * NDOM1 - 1)) + 1
    
If Worksheets("natal").Cells((40 + NDOM1), (10 + NDOM2)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("SList").Cells(STROKAL, 9) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKAL, 10) = NDOM2
    Worksheets("SList").Cells(STROKAL, 11) = "#"
    Worksheets("SList").Cells(STROKAL, 12) = NDOM1
    Worksheets("SList").Cells(STROKAL, 13) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKAL, 15) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKAL = STROKAL + 1
    If NDOM1 <= NDOM2 Then Worksheets("solar").Cells((40 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("solar").Cells((40 + 2 * NDOM2), (16 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("solar").Cells((40 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("solar").Cells((40 + 2 * NDOM1), (16 + NDOM2)) + 1
Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Worksheets("SList").Cells(STROKAL, 9) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKAL, 10) = NDOM2
    Worksheets("SList").Cells(STROKAL, 11) = "&"
    Worksheets("SList").Cells(STROKAL, 12) = NDOM1
    Worksheets("SList").Cells(STROKAL, 13) = Worksheets("natal").Cells(n%, 1)
    Worksheets("SList").Cells(STROKAL, 15) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    STROKAL = STROKAL + 1
    If NDOM1 <= NDOM2 Then Worksheets("solar").Cells((39 + 2 * NDOM2), (16 + NDOM1)) = Worksheets("solar").Cells((39 + 2 * NDOM2), (16 + NDOM1)) + 1
    If NDOM1 > NDOM2 Then Worksheets("solar").Cells((39 + 2 * NDOM1), (16 + NDOM2)) = Worksheets("solar").Cells((39 + 2 * NDOM1), (16 + NDOM2)) + 1
End If

netNDom22TR: Next M%

Next n%
'=======================

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ASP2 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STRLIST As Integer

STRLIST = 71

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("orb").Cells(NTAB * 10 + NP%, 10 + KP%)
    L1 = Worksheets("natal").Cells((10 + KP%), 10)
If Worksheets("natal").Cells((10 + KP%), 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 60, 90, 120, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA01
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("solar").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("solar").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("solar").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("solar").Cells((STRLIST + 2), 2) = "|fffd||fffd||fffd||fffd||fffd|"
Worksheets("solar").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("solar").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("solar").Cells(STRLIST, M%) = Worksheets("solar").Cells((NP% + 10), (26 + M%))
Worksheets("solar").Cells((STRLIST + 2), M%) = Worksheets("solar").Cells((KP% + 10), M%)
Next M%

    If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then Worksheets("solar").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
    If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then Worksheets("solar").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
    STRLIST = STRLIST + 4
    
Else
End If

netNA01: Next NA%
Next KP%
Next NP%

Dim flagN1 As Integer
Dim flagN2 As Integer
Dim flagK1 As Integer
Dim flagK2 As Integer

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For n% = 1 To 11              '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For K% = n% To 12             '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For NS% = 71 To 399 Step 4    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("solar").Cells(NS% + 1, 2) = 0 And Worksheets("solar").Cells(NS% + 1, 3) = 0 Then GoTo netNS
'|fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|
        For M% = 19 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If n% <> K% Then
        If Worksheets("solar").Cells(NS%, M%) = n% Then DDNL(NS%, n%, 0) = 1
        If Worksheets("solar").Cells(NS% + 2, M%) = n% Then DDNL(NS%, n%, 0) = 1
        If Worksheets("solar").Cells(NS%, M%) = K% Then DDNL(NS%, 0, K%) = 1
        If Worksheets("solar").Cells(NS% + 2, M%) = K% Then DDNL(NS%, 0, K%) = 1
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If Worksheets("solar").Cells(NS%, M%) = n% Then flagN1 = 1
            If Worksheets("solar").Cells(NS% + 2, M%) = K% Then flagK2 = 1
            If Worksheets("solar").Cells(NS% + 2, M%) = n% Then flagN2 = 1
            If Worksheets("solar").Cells(NS%, M%) = K% Then flagK1 = 1
            If flagN1 = 1 And flagK2 = 1 Then
            DDNL(NS%, n%, 0) = 1
            DDNL(NS%, 0, K%) = 1
            Else
            End If
            If flagN2 = 1 And flagK1 = 1 Then
            DDNL(NS%, n%, 0) = 1
            DDNL(NS%, 0, K%) = 1
            Else
            End If
        End If
        Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
flagN1 = 0
flagN2 = 0
flagK1 = 0
flagK2 = 0
If DDNL(NS%, n%, 0) = 1 And DDNL(NS%, 0, K%) = 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("SList").Cells(STROKA, 1) = Worksheets("solar").Cells(NS%, 1)
    Worksheets("SList").Cells(STROKA, 2) = n%
    Worksheets("SList").Cells(STROKA, 4) = K%
    Worksheets("SList").Cells(STROKA, 5) = Worksheets("solar").Cells(NS% + 2, 1)
    Worksheets("SList").Cells(STROKA, 6) = Worksheets("solar").Cells(NS% + 1, 3)
    Worksheets("SList").Cells(STROKA, 7) = Worksheets("solar").Cells(NS% + 1, 4)
    Worksheets("SList").Cells(STROKA, 8) = Int(Worksheets("solar").Cells(NS% + 1, 2))
    
        If Worksheets("solar").Cells(NS% + 1, 2) < 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               If Worksheets("natal").Cells((40 + n%), (10 + K%)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
               
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K%)) = Worksheets("solar").Cells((500 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n%)) = Worksheets("solar").Cells((500 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((500 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((500 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((500 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((500 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((540 + n%), (12 * K%)) = Worksheets("solar").Cells((540 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((540 + K%), (12 * n%)) = Worksheets("solar").Cells((540 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((540 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((540 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((540 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((540 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K% - 1)) = Worksheets("solar").Cells((500 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n% - 1)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 1)) + 1
                     End If
               
               Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K%)) = Worksheets("solar").Cells((500 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n%)) = Worksheets("solar").Cells((500 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((500 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((500 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((500 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((500 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((540 + n%), (12 * K%)) = Worksheets("solar").Cells((540 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((540 + K%), (12 * n%)) = Worksheets("solar").Cells((540 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((540 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((540 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((540 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((540 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K% - 1)) = Worksheets("solar").Cells((500 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n% - 1)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 1)) + 1
                     End If
               
               End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("solar").Cells(NS% + 1, 2)) = 90 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 150 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 180 Then
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K% - 3)) = Worksheets("solar").Cells((500 + n%), (12 * K% - 3)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n% - 3)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 3)) + 1
                        If Worksheets("solar").Cells((500 + n%), (12 * K% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + n%), (12 * K% - 2)) = 0 Then Worksheets("solar").Cells((500 + n%), (12 * K% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((500 + K%), (12 * n% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + K%), (12 * n% - 2)) = 0 Then Worksheets("solar").Cells((500 + K%), (12 * n% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((540 + n%), (12 * K% - 3)) = Worksheets("solar").Cells((540 + n%), (12 * K% - 3)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((540 + K%), (12 * n% - 3)) = Worksheets("solar").Cells((540 + K%), (12 * n% - 3)) + 1
                        If Worksheets("solar").Cells((540 + n%), (12 * K% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + n%), (12 * K% - 2)) = 0 Then Worksheets("solar").Cells((540 + n%), (12 * K% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((540 + K%), (12 * n% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + K%), (12 * n% - 2)) = 0 Then Worksheets("solar").Cells((540 + K%), (12 * n% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "#"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K% - 4)) = Worksheets("solar").Cells((500 + n%), (12 * K% - 4)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n% - 4)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 4)) + 1
                     End If
Else
End If
'|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("solar").Cells(NS% + 1, 2)) = 30 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 60 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 120 Then
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K% - 6)) = Worksheets("solar").Cells((500 + n%), (12 * K% - 6)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n% - 6)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 6)) + 1
                        If Worksheets("solar").Cells((500 + n%), (12 * K% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + n%), (12 * K% - 5)) = 0 Then Worksheets("solar").Cells((500 + n%), (12 * K% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((500 + K%), (12 * n% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((500 + K%), (12 * n% - 5)) = 0 Then Worksheets("solar").Cells((500 + K%), (12 * n% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((540 + n%), (12 * K% - 6)) = Worksheets("solar").Cells((540 + n%), (12 * K% - 6)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((540 + K%), (12 * n% - 6)) = Worksheets("solar").Cells((540 + K%), (12 * n% - 6)) + 1
                        If Worksheets("solar").Cells((540 + n%), (12 * K% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + n%), (12 * K% - 5)) = 0 Then Worksheets("solar").Cells((540 + n%), (12 * K% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((540 + K%), (12 * n% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((540 + K%), (12 * n% - 5)) = 0 Then Worksheets("solar").Cells((540 + K%), (12 * n% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (4 + n%)) + 1
                        Worksheets("SList").Cells(STROKA, 3) = "&"
                        STROKA = STROKA + 1
                        Worksheets("solar").Cells((500 + n%), (12 * K% - 7)) = Worksheets("solar").Cells((500 + n%), (12 * K% - 7)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((500 + K%), (12 * n% - 7)) = Worksheets("solar").Cells((500 + K%), (12 * n% - 7)) + 1
                     End If
Else
End If
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd|====================

        For M% = 12 To 18 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If n% <> K% Then
        If Worksheets("solar").Cells(NS%, M%) = n% Then DDL(NS%, n%, 0) = 1
        If Worksheets("solar").Cells(NS% + 2, M%) = n% Then DDL(NS%, n%, 0) = 1
        If Worksheets("solar").Cells(NS%, M%) = K% Then DDL(NS%, 0, K%) = 1
        If Worksheets("solar").Cells(NS% + 2, M%) = K% Then DDL(NS%, 0, K%) = 1
        Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If Worksheets("solar").Cells(NS%, M%) = n% Then flagN1 = 1
            If Worksheets("solar").Cells(NS% + 2, M%) = K% Then flagK2 = 1
            If Worksheets("solar").Cells(NS% + 2, M%) = n% Then flagN2 = 1
            If Worksheets("solar").Cells(NS%, M%) = K% Then flagK1 = 1
            If flagN1 = 1 And flagK2 = 1 Then
            DDL(NS%, n%, 0) = 1
            DDL(NS%, 0, K%) = 1
            Else
            End If
            If flagN2 = 1 And flagK1 = 1 Then
            DDL(NS%, n%, 0) = 1
            DDL(NS%, 0, K%) = 1
            Else
            End If
        End If
        Next M% '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
flagN1 = 0
flagN2 = 0
flagK1 = 0
flagK2 = 0
If DDL(NS%, n%, 0) = 1 And DDL(NS%, 0, K%) = 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("SList").Cells(STROKAL, 9) = Worksheets("solar").Cells(NS%, 1)
    Worksheets("SList").Cells(STROKAL, 10) = n%
    Worksheets("SList").Cells(STROKAL, 12) = K%
    Worksheets("SList").Cells(STROKAL, 13) = Worksheets("solar").Cells(NS% + 2, 1)
    Worksheets("SList").Cells(STROKAL, 14) = Worksheets("solar").Cells(NS% + 1, 3)
    Worksheets("SList").Cells(STROKAL, 15) = Worksheets("solar").Cells(NS% + 1, 4)
    Worksheets("SList").Cells(STROKAL, 16) = Int(Worksheets("solar").Cells(NS% + 1, 2))
    
        If Worksheets("solar").Cells(NS% + 1, 2) < 1 Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               If Worksheets("natal").Cells((40 + n%), (10 + K%)) = 1 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
               
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K%)) = Worksheets("solar").Cells((520 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n%)) = Worksheets("solar").Cells((520 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((520 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((520 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((520 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((520 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((560 + n%), (12 * K%)) = Worksheets("solar").Cells((560 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((560 + K%), (12 * n%)) = Worksheets("solar").Cells((560 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((560 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((560 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((560 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((560 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K% - 1)) = Worksheets("solar").Cells((520 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n% - 1)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 1)) + 1
                     End If
               
               Else '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K%)) = Worksheets("solar").Cells((520 + n%), (12 * K%)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n%)) = Worksheets("solar").Cells((520 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((520 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((520 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((520 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((520 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((560 + n%), (12 * K%)) = Worksheets("solar").Cells((560 + n%), (12 * K%)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((560 + K%), (12 * n%)) = Worksheets("solar").Cells((560 + K%), (12 * n%)) + 1
                        If Worksheets("solar").Cells((560 + n%), (12 * K% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + n%), (12 * K% + 1)) = 0 Then Worksheets("solar").Cells((560 + n%), (12 * K% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((560 + K%), (12 * n% + 1)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + K%), (12 * n% + 1)) = 0 Then Worksheets("solar").Cells((560 + K%), (12 * n% + 1)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K% - 1)) = Worksheets("solar").Cells((520 + n%), (12 * K% - 1)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n% - 1)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 1)) + 1
                     End If
               
               End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
        Else '|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("solar").Cells(NS% + 1, 2)) = 90 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 150 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 180 Then
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K% - 3)) = Worksheets("solar").Cells((520 + n%), (12 * K% - 3)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n% - 3)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 3)) + 1
                        If Worksheets("solar").Cells((520 + n%), (12 * K% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + n%), (12 * K% - 2)) = 0 Then Worksheets("solar").Cells((520 + n%), (12 * K% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((520 + K%), (12 * n% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + K%), (12 * n% - 2)) = 0 Then Worksheets("solar").Cells((520 + K%), (12 * n% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((560 + n%), (12 * K% - 3)) = Worksheets("solar").Cells((560 + n%), (12 * K% - 3)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((560 + K%), (12 * n% - 3)) = Worksheets("solar").Cells((560 + K%), (12 * n% - 3)) + 1
                        If Worksheets("solar").Cells((560 + n%), (12 * K% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + n%), (12 * K% - 2)) = 0 Then Worksheets("solar").Cells((560 + n%), (12 * K% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((560 + K%), (12 * n% - 2)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + K%), (12 * n% - 2)) = 0 Then Worksheets("solar").Cells((560 + K%), (12 * n% - 2)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((40 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "#"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K% - 4)) = Worksheets("solar").Cells((520 + n%), (12 * K% - 4)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n% - 4)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 4)) + 1
                     End If
Else
End If
'|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("solar").Cells(NS% + 1, 2)) = 30 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 60 Or Int(Worksheets("solar").Cells(NS% + 1, 2)) = 120 Then
                    If Trim(Worksheets("solar").Cells(NS% + 1, 4)) = "|fffd||fffd||fffd||fffd|." Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K% - 6)) = Worksheets("solar").Cells((520 + n%), (12 * K% - 6)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n% - 6)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 6)) + 1
                        If Worksheets("solar").Cells((520 + n%), (12 * K% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + n%), (12 * K% - 5)) = 0 Then Worksheets("solar").Cells((520 + n%), (12 * K% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((520 + K%), (12 * n% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((520 + K%), (12 * n% - 5)) = 0 Then Worksheets("solar").Cells((520 + K%), (12 * n% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                            If Trim(Worksheets("solar").Cells(NS% + 1, 1)) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                            Worksheets("solar").Cells((560 + n%), (12 * K% - 6)) = Worksheets("solar").Cells((560 + n%), (12 * K% - 6)) + 1
                            If n% <> K% Then Worksheets("solar").Cells((560 + K%), (12 * n% - 6)) = Worksheets("solar").Cells((560 + K%), (12 * n% - 6)) + 1
                        If Worksheets("solar").Cells((560 + n%), (12 * K% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + n%), (12 * K% - 5)) = 0 Then Worksheets("solar").Cells((560 + n%), (12 * K% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                        If Worksheets("solar").Cells((560 + K%), (12 * n% - 5)) > Worksheets("solar").Cells(NS% + 1, 3) Or Worksheets("solar").Cells((560 + K%), (12 * n% - 5)) = 0 Then Worksheets("solar").Cells((560 + K%), (12 * n% - 5)) = Worksheets("solar").Cells(NS% + 1, 3)
                            Else
                            End If
                     Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) = Worksheets("solar").Cells((39 + 2 * K%), (16 + n%)) + 1
                        Worksheets("SList").Cells(STROKAL, 11) = "&"
                        STROKAL = STROKAL + 1
                        Worksheets("solar").Cells((520 + n%), (12 * K% - 7)) = Worksheets("solar").Cells((520 + n%), (12 * K% - 7)) + 1
                        If n% <> K% Then Worksheets("solar").Cells((520 + K%), (12 * n% - 7)) = Worksheets("solar").Cells((520 + K%), (12 * n% - 7)) + 1
                     End If
Else
End If
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Else
End If ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|


netNS: Next NS%
Next K%
Next n%

Call sumSOLAR

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = True
End With

Worksheets("SList").Select
Range("A8").Select
Worksheets("solar").Select
Range("A9").Select

End Sub
Sub tranzit()

Dim STRLIST As Integer
Dim DD As Integer
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STROKA As Long
Dim STROKAL As Long
Dim JD As Double
Dim MMC As Double
Dim ZZV As Double
Dim JDMP As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double
Dim LatMin As Double
Dim LonGrad As Double
Dim LonMin As Double
Dim ZV0 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZV As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim ZVchas As Double
Dim ZVh As Double
Dim ZVm As Double
Dim ZVs As Double
Dim GMT As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim DOM As Double
Dim B As Double
Dim ASP1 As Double
Dim ASP2 As Double
Dim ASP As Integer
Dim SDOM As Integer
Dim NTAB As Integer

Worksheets("natal").Cells(10, 10) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Call DATAvJD(Int(Worksheets("natal").Cells(3, 2)), Int(Worksheets("natal").Cells(3, 3)), Int(Worksheets("natal").Cells(3, 4)), Int(Worksheets("natal").Cells(3, 5)), Int(Worksheets("natal").Cells(3, 6)), Int(Worksheets("natal").Cells(3, 7)))
Worksheets("natal").Cells(3, 9) = Worksheets("natal").Cells(81, 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
Worksheets("natal").Cells(3, 11) = Worksheets("natal").Cells(81, 8) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ==================
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Worksheets("natal").Cells(5, 9) = Worksheets("natal").Cells(3, 9)    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call JDvDATA(Worksheets("natal").Cells(5, 9))
Worksheets("natal").Cells(5, 11) = Worksheets("natal").Cells(71, 8) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ==================
B = Worksheets("natal").Cells(3, 9) - Int(Worksheets("natal").Cells(3, 9))
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Call planets(Int(Worksheets("natal").Cells(3, 11)), B, 11, 10) ' 10 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(9, (14 + (NP% - 1) * 3)) = INDOM(Worksheets("natal").Cells((10 + NP%), 10), 4)
Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.

For K% = 2 To 3
For n% = 2 To 7
Worksheets("TR").Cells(K%, n%) = Worksheets("natal").Cells(K%, n%)
Worksheets("TR").Cells(K% + 5, n%) = Worksheets("natal").Cells(K% + 5, n%)
Next n%
Next K%

NTAB = Int(Worksheets("TR").Cells(4, 2))
If NTAB <> 1 And NTAB <> 3 And NTAB <> 5 And NTAB <> 7 Then
NTAB = Int(Worksheets("natal").Cells(4, 2))
Worksheets("TR").Cells(4, 2) = NTAB
Else
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("TR").Cells((NP% + 10), 5) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 2) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TR").Cells(21, 6) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call upravTR(2, 11, 6) '2 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 9 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 6 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("TR").Cells((NP% + 10), 12) = INDOM(Worksheets("natal").Cells((10 + NP%), 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next NP%
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TR").Cells(21, 13) = 8 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. 8-|fffd| |fffd||fffd||fffd||fffd||fffd|
Call upravTR(4, 11, 13) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, 9 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 13 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim D(0 To 12) As Integer
Dim STB As Integer
Dim DM As Integer

For M% = 11 To 21

For n% = 0 To 12
D(n%) = 0
Next n%

If Worksheets("TR").Cells(M%, 5) <> Worksheets("TR").Cells(M%, 12) Then
Worksheets("TR").Cells(M%, 19) = Worksheets("TR").Cells(M%, 5)
Worksheets("TR").Cells(M%, 20) = Worksheets("TR").Cells(M%, 12)
STB = 21
Else
Worksheets("TR").Cells(M%, 19) = Worksheets("TR").Cells(M%, 5)
STB = 20
End If
    
    For n% = 6 To 11
    DM = Int(Worksheets("TR").Cells(M%, n%))
    D(DM) = D(DM) + 1
    Next n%
    
    For n% = 13 To 18
    DM = Int(Worksheets("TR").Cells(M%, n%))
    D(DM) = D(DM) + 1
    Next n%
    
    For n% = 1 To 12
    If D(n%) > 0 Then
    Worksheets("TR").Cells(M%, STB) = n%
    STB = STB + 1
    Else
    End If
    Next n%
    
Next M%

For K% = 11 To 21
Worksheets("TR").Cells(K%, 29) = INDOM(Worksheets("natal").Cells(K%, 10), 4) '|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next K%

For n% = 11 To 21
For K% = 5 To 28
Worksheets("TR").Cells(n%, (K% + 26)) = Worksheets("formula").Cells(n%, K%)
Next K%
Next n%

'============ |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

STROKAL = 11
STROKA = 11

For n% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("TR").Cells(n%, 5) <> Worksheets("TR").Cells(n%, 29) And Worksheets("TR").Cells(n%, 12) <> Worksheets("TR").Cells(n%, 29) Then Worksheets("TR").Cells(n%, 28) = Worksheets("TR").Cells(n%, 29)
Next n%

'-----------------------------------------------------------------------------

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L1 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim L2 As Double ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB1 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB2 As Double '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim ORB As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = 71
'Worksheets("TR").Cells(4, 3) = NTAB
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    L = Worksheets("natal").Cells((10 + NP%), 4)
For KP% = 1 To 11 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ORB = Worksheets("orb").Cells(NTAB * 10 + NP%, 10 + KP%)
    If KP% = 2 Then ORB = 13
    L1 = Worksheets("natal").Cells((10 + KP%), 10)
If Worksheets("natal").Cells((10 + KP%), 11) = "R" Then
    L2 = L1 - 1 / 100
Else
    L2 = L1 + 1 / 100
End If
    If L2 < 0 Then L2 = L2 + 360
    If L2 > 360 Then L2 = L2 - 360
For NA% = 0 To 180 Step 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0, 30, 60, 90, 120, 150, 180
If NA% = 30 Or NA% = 150 Then GoTo netNA01
    ASP1 = ASPECT(L, L1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASP2 = ASPECT(L, L2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Abs(ASP1 - NA%) < ORB Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'====== |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("TR").Cells(STRLIST, 1) = Worksheets("natal").Cells((10 + NP%), 1)
Worksheets("TR").Cells(STRLIST, 2) = "|fffd||fffd||fffd|."
Worksheets("TR").Cells((STRLIST + 2), 1) = Worksheets("natal").Cells((10 + KP%), 1)
Worksheets("TR").Cells((STRLIST + 2), 2) = "|fffd||fffd|."
Worksheets("TR").Cells((STRLIST + 1), 2) = (NA% + 1 / 100)
Worksheets("TR").Cells((STRLIST + 1), 3) = Abs(ASP1 - NA%)
For M% = 5 To 28 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("TR").Cells(STRLIST, M%) = Worksheets("TR").Cells((NP% + 10), (26 + M%))
Worksheets("TR").Cells((STRLIST + 2), M%) = Worksheets("TR").Cells((KP% + 10), M%)
Next M%

If Abs(ASP1 - NA%) <= Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells((NP% + 10), (14 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "p"
    'Worksheets("natal").Cells((NP% + 10), (14 + (KP% - 1) * 3)).Select
    'With Selection.Font
    '.Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'End With
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("TR").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("TR").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int((ORB - Abs(ASP1 - NA%)) / Abs(Worksheets("natal").Cells(100 + KP%, 7)))
Worksheets("TR").Cells(STRLIST + 1, 32) = JD
Call JDvDATA(JD)
Worksheets("TR").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("TR").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("TR").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

If Abs(ASP1 - NA%) > Abs(ASP2 - NA%) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                           If Int(Worksheets("natal").Cells(4, 12)) <> 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   ' Worksheets("natal").Cells((NP% + 10), (14 + (KP% - 1) * 3)).Select
   ' With Selection.Font
   ' .Color = Ncol(NA%) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   ' End With
    Worksheets("natal").Cells((NP% + 10), (14 + (KP% - 1) * 3)) = CStr(Int(NA%)) + "c"
                            Else
                            End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
Worksheets("TR").Cells((STRLIST + 1), 4) = "|fffd||fffd||fffd||fffd|."
Worksheets("TR").Cells(STRLIST + 1, 19) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: "
JD = Worksheets("natal").Cells(3, 9) + Int(Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 7)))
Worksheets("TR").Cells(STRLIST + 1, 32) = JD
    If (Abs(ASP1 - NA%) / Abs(Worksheets("natal").Cells(100 + KP%, 7))) < (Int(Worksheets("TR").Cells(67, 2) * (1 / 24))) Then
    Worksheets("TR").Cells(STRLIST + 1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
    End If
Call JDvDATA(JD)
Worksheets("TR").Cells(STRLIST + 1, 29) = Worksheets("natal").Cells(71, 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("TR").Cells(STRLIST + 1, 30) = Worksheets("natal").Cells(71, 3)
Worksheets("TR").Cells(STRLIST + 1, 31) = Worksheets("natal").Cells(71, 4)
Else
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

STRLIST = STRLIST + 4

Else
End If

netNA01: Next NA%
Next KP%
Next NP%

If Int(Worksheets("MP").Cells(34, 2)) = 0 Then GoTo FIN '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

'======== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For NS% = 71 To 399 Step 4    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Worksheets("TR").Cells(NS%, 12) = 0 And Worksheets("TR").Cells(NS% + 2, 12) = 0 Then GoTo netNS
ASP = Int(Worksheets("TR").Cells(NS% + 1, 2))

'========= |fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd|

For ND1% = 1 To 12
For ND2% = ND1% To 12
NDOM1 = 0
NDOM2 = 0
SDOM = 0

If ND1% <> ND2% Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 19 To 28
    If ND1% = Int(Worksheets("TR").Cells(NS%, M%)) Then NDOM1 = 1
    If ND1% = Int(Worksheets("TR").Cells(NS% + 2, M%)) Then NDOM1 = 1
    If ND2% = Int(Worksheets("TR").Cells(NS%, M%)) Then NDOM2 = 1
    If ND2% = Int(Worksheets("TR").Cells(NS% + 2, M%)) Then NDOM2 = 1
    Next M%
Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 19 To 28
    If ND1% = Int(Worksheets("TR").Cells(NS%, M%)) Then SDOM = SDOM + 1
    If ND1% = Int(Worksheets("TR").Cells(NS% + 2, M%)) Then SDOM = SDOM + 1
    Next M%
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

If (NDOM1 = 1 And NDOM2 = 1) Or SDOM > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If ASP = 30 Or ASP = 60 Or ASP = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells((39 + 2 * ND2%), (4 + ND1%)) = Worksheets("TR").Cells((39 + 2 * ND2%), (4 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    If ASP = 90 Or ASP = 150 Or ASP = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells((40 + 2 * ND2%), (4 + ND1%)) = Worksheets("TR").Cells((40 + 2 * ND2%), (4 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

    If ASP = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Int(Worksheets("natal").Cells((40 + ND1%), (10 + ND2%))) > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("TR").Cells((40 + 2 * ND2%), (4 + ND1%)) = Worksheets("TR").Cells((40 + 2 * ND2%), (4 + ND1%)) + 1
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("TR").Cells((39 + 2 * ND2%), (4 + ND1%)) = Worksheets("TR").Cells((39 + 2 * ND2%), (4 + ND1%)) + 1
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End If

Next ND2%
Next ND1%

'========= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For ND1% = 1 To 12
For ND2% = ND1% To 12
NDOM1 = 0
NDOM2 = 0
SDOM = 0

If ND1% <> ND2% Then '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 12 To 18
    If ND1% = Int(Worksheets("TR").Cells(NS%, M%)) Then NDOM1 = 1
    If ND1% = Int(Worksheets("TR").Cells(NS% + 2, M%)) Then NDOM1 = 1
    If ND2% = Int(Worksheets("TR").Cells(NS%, M%)) Then NDOM2 = 1
    If ND2% = Int(Worksheets("TR").Cells(NS% + 2, M%)) Then NDOM2 = 1
    Next M%
Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For M% = 12 To 18
    If ND1% = Int(Worksheets("TR").Cells(NS%, M%)) Then SDOM = SDOM + 1
    If ND1% = Int(Worksheets("TR").Cells(NS% + 2, M%)) Then SDOM = SDOM + 1
    Next M%
End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

If (NDOM1 = 1 And NDOM2 = 1) Or SDOM > 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If ASP = 30 Or ASP = 60 Or ASP = 120 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells((39 + 2 * ND2%), (16 + ND1%)) = Worksheets("TR").Cells((39 + 2 * ND2%), (16 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    If ASP = 90 Or ASP = 150 Or ASP = 180 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("TR").Cells((40 + 2 * ND2%), (16 + ND1%)) = Worksheets("TR").Cells((40 + 2 * ND2%), (16 + ND1%)) + 1
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

    If ASP = 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Int(Worksheets("natal").Cells((40 + ND1%), (10 + ND2%))) > 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("TR").Cells((40 + 2 * ND2%), (16 + ND1%)) = Worksheets("TR").Cells((40 + 2 * ND2%), (16 + ND1%)) + 1
        Else '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets("TR").Cells((39 + 2 * ND2%), (16 + ND1%)) = Worksheets("TR").Cells((39 + 2 * ND2%), (16 + ND1%)) + 1
        End If '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If

Else '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End If

Next ND2%
Next ND1%

netNS: Next NS%

FIN:

Worksheets("TR").Select
Range("A9").Select

End Sub

Function Ncol(NASP As Integer) As Long
If NASP = 0 Then Ncol = -65536
If NASP = 30 Then Ncol = -65536
If NASP = 60 Then Ncol = -65536
If NASP = 120 Then Ncol = -65536
If NASP = 90 Then Ncol = -16776961
If NASP = 150 Then Ncol = -16776961
If NASP = 180 Then Ncol = -16776961
End Function

Function INDOM(t As Double, NST As Integer) As Integer
Dim L As Double

For K% = 1 To 11
L = Abs(Worksheets("natal").Cells((21 + K%), NST) - Worksheets("natal").Cells((22 + K%), NST))
If L < 120 Then
    If t > Worksheets("natal").Cells((21 + K%), NST) And t < Worksheets("natal").Cells((22 + K%), NST) Then INDOM = K%
Else
    If t > Worksheets("natal").Cells((21 + K%), NST) Or t < Worksheets("natal").Cells((22 + K%), NST) Then INDOM = K%
End If
Next K%

L = Abs(Worksheets("natal").Cells(33, NST) - Worksheets("natal").Cells(22, NST))
If L < 120 Then
    If t > Worksheets("natal").Cells(33, NST) And t < Worksheets("natal").Cells(22, NST) Then INDOM = 12
Else
    If t > Worksheets("natal").Cells(33, NST) Or t < Worksheets("natal").Cells(22, NST) Then INDOM = 12
End If

End Function
Sub LUNA(JDNN As Long, B As Double, NST As Integer, Ncol As Integer)

Dim T1 As Double
Dim T2 As Double
Dim T3 As Double

    If B <= 0.5 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    
T1 = Worksheets("natal").Cells(JDNN, 22)
T2 = Worksheets("natal").Cells(JDNN, 52)
T3 = Worksheets("natal").Cells(JDNN + 1, 22)
If T2 < T1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| T1 |fffd| T2
T2 = T2 + 360
T3 = T3 + 360
Else
End If
If T3 < T2 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|2 |fffd| |fffd|3
T3 = T3 + 360
Else
End If
Worksheets("natal").Cells(NST, Ncol) = (2 * T3 - 4 * T2 + 2 * T1) * B * B + (4 * T2 - 3 * T1 - T3) * B + T1
If Worksheets("natal").Cells(NST, Ncol) > 360 Then Worksheets("natal").Cells(NST, Ncol) = Worksheets("natal").Cells(NST, Ncol) - 360

    Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    
T1 = Worksheets("natal").Cells(JDNN, 52)
T2 = Worksheets("natal").Cells(JDNN + 1, 22)
T3 = Worksheets("natal").Cells(JDNN + 1, 52)
If T2 < T1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| T1 |fffd| T2
T2 = T2 + 360
T3 = T3 + 360
Else
End If
If T3 < T2 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|2 |fffd| |fffd|3
T3 = T3 + 360
Else
End If
Worksheets("natal").Cells(NST, Ncol) = (2 * T3 - 4 * T2 + 2 * T1) * (B - 1 / 2) * (B - 1 / 2) + (4 * T2 - 3 * T1 - T3) * (B - 1 / 2) + T1
If Worksheets("natal").Cells(NST, Ncol) > 360 Then Worksheets("natal").Cells(NST, Ncol) = Worksheets("natal").Cells(NST, Ncol) - 360
    
    End If

End Sub
Sub planets(JDNN As Long, B As Double, NST As Integer, Ncol As Integer)
Dim T1 As Double
Dim T2 As Double
Dim T3 As Double
Dim UZEL As Double

    If B <= 0.5 Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    
For K% = 1 To 11
T1 = Worksheets("natal").Cells(JDNN, 20 + K%)
T2 = Worksheets("natal").Cells(JDNN, 50 + K%)
If Abs(T2 - T1) < 20 And T2 >= T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + (T2 - T1) * 2 * B
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 2 * (T2 - T1)
    Else
    End If
Else
End If
If Abs(T2 - T1) < 20 And T2 < T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + (T2 - T1) * 2 * B
Worksheets("natal").Cells(NST - 1 + K%, Ncol + 1) = "R"
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 2 * (T2 - T1)
    Else
    End If
Else
End If
If Abs(T2 - T1) > 180 And T2 < T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + 2 * B * ASPECT(T2, T1)
If (T1 + 2 * B * ASPECT(T2, T1)) > 360 Then Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + 2 * B * ASPECT(T2, T1) - 360
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 2 * ASPECT(T2, T1)
    Else
    End If
Else
End If
If Abs(T2 - T1) > 180 And T2 > T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 - 2 * B * ASPECT(T2, T1)
If (T1 - 2 * B * ASPECT(T2, T1)) < 0 Then Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 - 2 * B * ASPECT(T2, T1) + 360
Worksheets("natal").Cells(NST - 1 + K%, Ncol + 1) = "R"
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 0 - 2 * ASPECT(T2, T1)
    Else
    End If
Else
End If
Next K%

'------------- |fffd||fffd||fffd||fffd|
T1 = Worksheets("natal").Cells(JDNN, 22)
T2 = Worksheets("natal").Cells(JDNN, 52)
T3 = Worksheets("natal").Cells(JDNN + 1, 22)
If T2 < T1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| T1 |fffd| T2
T2 = T2 + 360
T3 = T3 + 360
Else
End If
If T3 < T2 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|2 |fffd| |fffd|3
T3 = T3 + 360
Else
End If
Worksheets("natal").Cells(NST + 1, Ncol) = (2 * T3 - 4 * T2 + 2 * T1) * B * B + (4 * T2 - 3 * T1 - T3) * B + T1
If Worksheets("natal").Cells(NST + 1, Ncol) > 360 Then Worksheets("natal").Cells(NST + 1, Ncol) = Worksheets("natal").Cells(NST + 1, Ncol) - 360

    Else '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    
For K% = 1 To 11
T1 = Worksheets("natal").Cells(JDNN, 50 + K%)
T2 = Worksheets("natal").Cells(JDNN + 1, 20 + K%)
If Abs(T2 - T1) < 20 And T2 >= T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + 2 * (T2 - T1) * (B - 0.5)
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 2 * (T2 - T1)
    Else
    End If
Else
End If
If Abs(T2 - T1) < 20 And T2 < T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + 2 * (T2 - T1) * (B - 0.5)
Worksheets("natal").Cells(NST - 1 + K%, Ncol + 1) = "R"
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 2 * (T2 - T1)
    Else
    End If
Else
End If
If Abs(T2 - T1) > 180 And T2 < T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + 2 * (B - 0.5) * ASPECT(T2, T1)
If (T1 + 2 * (B - 0.5) * ASPECT(T2, T1)) > 360 Then Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 + 2 * (B - 0.5) * ASPECT(T2, T1) - 360
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 2 * ASPECT(T2, T1)
    Else
    End If
Else
End If
If Abs(T2 - T1) > 180 And T2 > T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 - 2 * (B - 0.5) * ASPECT(T2, T1)
If (T1 - 2 * (B - 0.5) * ASPECT(T2, T1)) < 0 Then Worksheets("natal").Cells(NST - 1 + K%, Ncol) = T1 - 2 * (B - 0.5) * ASPECT(T2, T1) + 360
Worksheets("natal").Cells(NST - 1 + K%, Ncol + 1) = "R"
    If Ncol >= 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("natal").Cells(100 + K%, Ncol - 3) = 0 - 2 * ASPECT(T2, T1)
    Else
    End If
Else
End If
Next K%

'------------- |fffd||fffd||fffd||fffd|
T1 = Worksheets("natal").Cells(JDNN, 52)
T2 = Worksheets("natal").Cells(JDNN + 1, 22)
T3 = Worksheets("natal").Cells(JDNN + 1, 52)
If T2 < T1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| T1 |fffd| T2
T2 = T2 + 360
T3 = T3 + 360
Else
End If
If T3 < T2 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|2 |fffd| |fffd|3
T3 = T3 + 360
Else
End If
Worksheets("natal").Cells(NST + 1, Ncol) = (2 * T3 - 4 * T2 + 2 * T1) * (B - 1 / 2) * (B - 1 / 2) + (4 * T2 - 3 * T1 - T3) * (B - 1 / 2) + T1
If Worksheets("natal").Cells(NST + 1, Ncol) > 360 Then Worksheets("natal").Cells(NST + 1, Ncol) = Worksheets("natal").Cells(NST + 1, Ncol) - 360
    
    End If
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
UZEL = 259.18305555 - (360 * (Worksheets("natal").Cells(2, 9) - 2415020)) / (365.25 * 18.6129265)
If UZEL < 0 Then UZEL = UZEL + 360 * (Int(Abs(UZEL) / 360))
If UZEL < 0 Then UZEL = UZEL + 360
If UZEL < 0 Then UZEL = UZEL + 360
Worksheets("natal").Cells(NST + 81, Ncol) = UZEL

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
T1 = Worksheets("natal").Cells(JDNN, 32)
T2 = Worksheets("natal").Cells(JDNN, 62)
If Abs(T2 - T1) < 20 And T2 >= T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST + 80, Ncol) = T1 + (T2 - T1) * 2 * B
Else
End If
If Abs(T2 - T1) < 20 And T2 < T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST + 80, Ncol) = T1 + (T2 - T1) * 2 * B
Worksheets("natal").Cells(NST + 80, Ncol + 1) = "R"
Else
End If
If Abs(T2 - T1) > 180 And T2 < T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST + 80, Ncol) = T1 + 2 * B * ASPECT(T2, T1)
If (T1 + 2 * B * ASPECT(T2, T1)) > 360 Then Worksheets("natal").Cells(NST + 80, Ncol) = T1 + 2 * B * ASPECT(T2, T1) - 360
Else
End If
If Abs(T2 - T1) > 180 And T2 > T1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Worksheets("natal").Cells(NST + 80, Ncol) = T1 - 2 * B * ASPECT(T2, T1)
If (T1 - 2 * B * ASPECT(T2, T1)) < 0 Then Worksheets("natal").Cells(NST + 80, Ncol) = T1 - 2 * B * ASPECT(T2, T1) + 360
Worksheets("natal").Cells(NST + 80, Ncol + 1) = "R"
Else
End If

End Sub
Sub elementsort(NST As Integer, NSTEP As Integer)

Dim NDOM As Integer

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("formula").Cells(K%, n%) < Worksheets("formula").Cells(K%, M%) Then
NDOM = Worksheets("formula").Cells(K%, n%)
Worksheets("formula").Cells(K%, n%) = Worksheets("formula").Cells(K%, M%)
Worksheets("formula").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
For n% = NST To NSTEP - 2
If Worksheets("formula").Cells(K%, n%) = Worksheets("formula").Cells(K%, (n% + 1)) And Worksheets("formula").Cells(K%, n%) = Worksheets("formula").Cells(K%, (n% + 2)) Then Worksheets("formula").Cells(K%, n%) = 0
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("formula").Cells(K%, n%) < Worksheets("formula").Cells(K%, M%) Then
NDOM = Worksheets("formula").Cells(K%, n%)
Worksheets("formula").Cells(K%, n%) = Worksheets("formula").Cells(K%, M%)
Worksheets("formula").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

End Sub
Sub MPsort(NST As Integer, NSTEP As Integer)

Dim NDOM As Integer

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("MP").Cells(K%, n%) < Worksheets("MP").Cells(K%, M%) Then
NDOM = Worksheets("MP").Cells(K%, n%)
Worksheets("MP").Cells(K%, n%) = Worksheets("MP").Cells(K%, M%)
Worksheets("MP").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
For n% = NST To NSTEP - 2
If Worksheets("MP").Cells(K%, n%) = Worksheets("MP").Cells(K%, (n% + 1)) And Worksheets("MP").Cells(K%, n%) = Worksheets("MP").Cells(K%, (n% + 2)) Then Worksheets("MP").Cells(K%, n%) = 0
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("MP").Cells(K%, n%) < Worksheets("MP").Cells(K%, M%) Then
NDOM = Worksheets("MP").Cells(K%, n%)
Worksheets("MP").Cells(K%, n%) = Worksheets("MP").Cells(K%, M%)
Worksheets("MP").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

End Sub

Sub BPsort(NST As Integer, NSTEP As Integer)

Dim NDOM As Integer

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("BP").Cells(K%, n%) < Worksheets("BP").Cells(K%, M%) Then
NDOM = Worksheets("BP").Cells(K%, n%)
Worksheets("BP").Cells(K%, n%) = Worksheets("BP").Cells(K%, M%)
Worksheets("BP").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
For n% = NST To NSTEP - 2
If Worksheets("BP").Cells(K%, n%) = Worksheets("BP").Cells(K%, (n% + 1)) And Worksheets("BP").Cells(K%, n%) = Worksheets("BP").Cells(K%, (n% + 2)) Then Worksheets("BP").Cells(K%, n%) = 0
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("BP").Cells(K%, n%) < Worksheets("BP").Cells(K%, M%) Then
NDOM = Worksheets("BP").Cells(K%, n%)
Worksheets("BP").Cells(K%, n%) = Worksheets("BP").Cells(K%, M%)
Worksheets("BP").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

End Sub
Sub LUNARsort(NST As Integer, NSTEP As Integer)

Dim NDOM As Integer

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("lunar").Cells(K%, n%) < Worksheets("lunar").Cells(K%, M%) Then
NDOM = Worksheets("lunar").Cells(K%, n%)
Worksheets("lunar").Cells(K%, n%) = Worksheets("lunar").Cells(K%, M%)
Worksheets("lunar").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
For n% = NST To NSTEP - 2
If Worksheets("lunar").Cells(K%, n%) = Worksheets("lunar").Cells(K%, (n% + 1)) And Worksheets("lunar").Cells(K%, n%) = Worksheets("lunar").Cells(K%, (n% + 2)) Then Worksheets("lunar").Cells(K%, n%) = 0
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("lunar").Cells(K%, n%) < Worksheets("lunar").Cells(K%, M%) Then
NDOM = Worksheets("lunar").Cells(K%, n%)
Worksheets("lunar").Cells(K%, n%) = Worksheets("lunar").Cells(K%, M%)
Worksheets("lunar").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

End Sub

Sub SOLARsort(NST As Integer, NSTEP As Integer)

Dim NDOM As Integer

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("solar").Cells(K%, n%) < Worksheets("solar").Cells(K%, M%) Then
NDOM = Worksheets("solar").Cells(K%, n%)
Worksheets("solar").Cells(K%, n%) = Worksheets("solar").Cells(K%, M%)
Worksheets("solar").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
For n% = NST To NSTEP - 2
If Worksheets("solar").Cells(K%, n%) = Worksheets("solar").Cells(K%, (n% + 1)) And Worksheets("solar").Cells(K%, n%) = Worksheets("solar").Cells(K%, (n% + 2)) Then Worksheets("solar").Cells(K%, n%) = 0
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("solar").Cells(K%, n%) < Worksheets("solar").Cells(K%, M%) Then
NDOM = Worksheets("solar").Cells(K%, n%)
Worksheets("solar").Cells(K%, n%) = Worksheets("solar").Cells(K%, M%)
Worksheets("solar").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

End Sub

Sub TRsort(NST As Integer, NSTEP As Integer)

Dim NDOM As Integer

'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("TR").Cells(K%, n%) < Worksheets("TR").Cells(K%, M%) Then
NDOM = Worksheets("TR").Cells(K%, n%)
Worksheets("TR").Cells(K%, n%) = Worksheets("TR").Cells(K%, M%)
Worksheets("TR").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
For n% = NST To NSTEP - 2
If Worksheets("TR").Cells(K%, n%) = Worksheets("TR").Cells(K%, (n% + 1)) And Worksheets("TR").Cells(K%, n%) = Worksheets("TR").Cells(K%, (n% + 2)) Then Worksheets("TR").Cells(K%, n%) = 0
Next n%
Next K%

For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = NST To (NSTEP - 1)
For M% = (n% + 1) To NSTEP
If Worksheets("TR").Cells(K%, n%) < Worksheets("TR").Cells(K%, M%) Then
NDOM = Worksheets("TR").Cells(K%, n%)
Worksheets("TR").Cells(K%, n%) = Worksheets("TR").Cells(K%, M%)
Worksheets("TR").Cells(K%, M%) = NDOM
Else
End If
Next M%
Next n%
Next K%

End Sub

Sub uprav(NstP As Integer, NstR As Integer, NstD As Integer)

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("formula").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("formula").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("formula").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("formula").Cells(n%, K%) = Worksheets("formula").Cells(n%, M%) Then Worksheets("formula").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub

Sub upravMP(NstP As Integer, NstR As Integer, NstD As Integer)

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("MP").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, 3) = "" And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, 3) = "" And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, 3) = "" And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, 3) = "" And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, 3) = "" And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, 3) = "" And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("MP").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("MP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("MP").Cells(n%, K%) = Worksheets("MP").Cells(n%, M%) Then Worksheets("MP").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub

Sub polozenie(STROKA As Long, NN As Integer, KK As Integer, MM As Integer, NS As Integer, ZNAK As String)

Worksheets("List").Cells(STROKA, NS) = Worksheets("formula").Cells(NN, 1)
Worksheets("List").Cells(STROKA, (NS + 1)) = Worksheets("formula").Cells(NN, KK)
Worksheets("List").Cells(STROKA, (NS + 2)) = ZNAK
Worksheets("List").Cells(STROKA, (NS + 3)) = Worksheets("formula").Cells(NN, MM)
Worksheets("List").Cells(STROKA, (NS + 4)) = Worksheets("formula").Cells(NN, 1)
Worksheets("List").Cells(STROKA, (NS + 6)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

End Sub

Sub strochka(STROKA As Long, NN As Integer, KK As Integer, MM As Integer, II As Integer, NS As Integer, UGOL As Double, ZNAK As String)

Worksheets("List").Cells(STROKA, NS) = Worksheets("formula").Cells(NN, 1)
Worksheets("List").Cells(STROKA, (NS + 1)) = Worksheets("formula").Cells(NN, MM)
Worksheets("List").Cells(STROKA, (NS + 2)) = ZNAK
Worksheets("List").Cells(STROKA, (NS + 3)) = Worksheets("formula").Cells(KK, II)
Worksheets("List").Cells(STROKA, (NS + 4)) = Worksheets("formula").Cells(KK, 1)
Worksheets("List").Cells(STROKA, (NS + 5)) = UGOL

End Sub

Sub upravBP(NstP As Integer, NstR As Integer, NstD As Integer)

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("BP").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, 3) = "" And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, 3) = "" And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, 3) = "" And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, 3) = "" And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, 3) = "" And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, 3) = "" And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("BP").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("BP").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("BP").Cells(n%, K%) = Worksheets("BP").Cells(n%, M%) Then Worksheets("BP").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub
Sub upravLUNARloc(NstP As Integer, NstR As Integer, NstD As Integer) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP + 1)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("lunar").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP + 1)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("lunar").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP + 1)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("lunar").Cells(n%, K%) = Worksheets("lunar").Cells(n%, M%) Then Worksheets("lunar").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub
Sub upravSOLARloc(NstP As Integer, NstR As Integer, NstD As Integer) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP + 1)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("solar").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP + 1)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("solar").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP + 1)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("solar").Cells(n%, K%) = Worksheets("solar").Cells(n%, M%) Then Worksheets("solar").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub
Sub upravLUNARnat(NstP As Integer, NstR As Integer, NstD As Integer) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("lunar").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("lunar").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("lunar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("lunar").Cells(n%, K%) = Worksheets("lunar").Cells(n%, M%) Then Worksheets("lunar").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub

Sub upravSOLARnat(NstP As Integer, NstR As Integer, NstD As Integer) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("solar").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("solar").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("solar").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("solar").Cells(n%, K%) = Worksheets("solar").Cells(n%, M%) Then Worksheets("solar").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub

Sub upravTR(NstP As Integer, NstR As Integer, NstD As Integer)

Dim ZNAK0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM1 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM2 As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim NDOM As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim NDst As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim DNat(15) As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim LDom As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For K% = 1 To 12
DNat(K%) = Worksheets("natal").Cells((21 + K%), NstP)
Next K%
DNat(13) = DNat(1)
DNat(14) = DNat(2)
DNat(15) = DNat(3)

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NP% = 1 To 10
NDst = NstD
NDOM = 0
ZNAK0 = Worksheets("TR").Cells((NP% + 10), 3)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If NP% = 1 Or NP% = 2 Then GoTo netR
If NP% = 5 And Worksheets("natal").Cells(15, 3) = "" And Worksheets("natal").Cells(15, NstR) = "" Then GoTo netR
If NP% = 6 And Worksheets("natal").Cells(16, 3) = "" And Worksheets("natal").Cells(16, NstR) = "" Then GoTo netR
If NP% = 7 And Worksheets("natal").Cells(17, 3) = "" And Worksheets("natal").Cells(17, NstR) = "" Then GoTo netR
If NP% = 8 And Worksheets("natal").Cells(18, 3) = "" And Worksheets("natal").Cells(18, NstR) = "" Then GoTo netR
If NP% = 9 And Worksheets("natal").Cells(19, 3) = "" And Worksheets("natal").Cells(19, NstR) = "" Then GoTo netR
If NP% = 10 And Worksheets("natal").Cells(20, 3) = "" And Worksheets("natal").Cells(20, NstR) = "" Then GoTo netR
NDOM = 0
ZNAK0 = Worksheets("TR").Cells((NP% + 10), 4)
NDOM1 = INDOM(ZNAK0, NstP)
LDom = ASPECT(DNat(NDOM1), DNat(NDOM1 + 1))
If LDom < 30 Then
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > ASPECT(ZNAK0, DNat(NDOM1)) Or ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
Else
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) > 13.183 Then
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM1
    NDst = NDst + 1
    Else
    End If
End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 1)) < 30 Then
    NDOM = NDOM1 + 1
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 2)) < 30 Then
    NDOM = NDOM1 + 2
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
    If ASPECT(ZNAK0, DNat(NDOM1 + 3)) < 30 Then
    NDOM = NDOM1 + 3
    If NDOM > 12 Then NDOM = NDOM - 12
    Worksheets("TR").Cells((NP% + 10), NDst) = NDOM
    NDst = NDst + 1
    Else
    End If
netR: Next NP%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For n% = 11 To 20
For K% = NstD To (NstD + 4)
For M% = (K% + 1) To (NstD + 5)
If Worksheets("TR").Cells(n%, K%) = Worksheets("TR").Cells(n%, M%) Then Worksheets("TR").Cells(n%, M%) = 0
Next M%
Next K%
Next n%

End Sub
Public Function ZV00(JD As Double)
Dim ZV0 As Double
Dim t As Double
t = (JD - 2451545) / 36525
Worksheets("natal").Cells(1, 9) = t
ZV0 = 6.697374558 + 2400.051336907 * t + 0.00002586 * t * t + 0.0000000017 * t * t * t
privod:
If ZV0 < 24 And ZV0 >= 0 Then GoTo OK
If ZV0 >= 24 Then ZV0 = ZV0 - 24
If ZV0 < 0 Then ZV0 = ZV0 + 24
GoTo privod
OK:
Worksheets("natal").Cells(37, 2) = Int(ZV0)
Worksheets("natal").Cells(37, 3) = Int((ZV0 - Int(ZV0)) * 60)
Worksheets("natal").Cells(37, 4) = Int((((ZV0 - Int(ZV0)) * 60) - Int((ZV0 - Int(ZV0)) * 60)) * 60 + 1 / 2)
ZV00 = ZV0
End Function
Public Function ZVMC(MCgrad As Double) As Double
Dim E As Double
Dim pi As Double
Dim RAMC As Double
Dim MC As Double
Dim Eg As Double
pi = 3.14159265358979        '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

Eg = 23.45163 - (0.02092 / 54787) * (Worksheets("natal").Cells(5, 9) - 2415021)
E = Eg * pi / 180
'E = (23.452222222 - (0.019444445 / 54787) * (JD - 2415021)) * pi / 180 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

MC = MCgrad * pi / 180 'MC |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

RAMC = Atn(Tan(MC) * Cos(E))
RAMC = RAMC * 180 / pi '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If RAMC < 0 Then RAMC = RAMC + 180
If Abs(RAMC - MCgrad) > 10 Then RAMC = RAMC + 180
If RAMC > 360 Then RAMC = RAMC - 360
ZVMC = RAMC

End Function
Attribute VB_Name = "Module31"
Sub mesto()
Attribute mesto.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
Worksheets("mesto").Select
Rows("16:65536").Select
Selection.ClearContents
Range("A10").Select

Worksheets("natal").Cells(58, 2) = Worksheets("natal").Cells(8, 2)
Worksheets("natal").Cells(58, 3) = Worksheets("natal").Cells(8, 3)
Worksheets("natal").Cells(58, 4) = Worksheets("natal").Cells(8, 4)
Worksheets("natal").Cells(58, 5) = Worksheets("natal").Cells(8, 5)
Worksheets("natal").Cells(58, 6) = Worksheets("natal").Cells(8, 6)
Worksheets("natal").Cells(58, 7) = Worksheets("natal").Cells(8, 7)

Dim D00 As Integer
Dim NREG As Integer '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For K% = 16 To 216 Step 4
If Worksheets("mesto").Cells(5, (K% + 1)) <> "" And Worksheets("mesto").Cells(5, (K% + 1)) <> "#" And Worksheets("mesto").Cells(5, (K% + 1)) <> "&" Then Worksheets("mesto").Cells(5, (K% + 1)) = ""
If Int(Worksheets("mesto").Cells(11, K%)) <> 0 Then Worksheets("mesto").Cells(11, K%) = 1
If Worksheets("mesto").Cells(13, K%) <> "#" And Worksheets("mesto").Cells(13, K%) <> "&" Then Worksheets("mesto").Cells(13, K%) = "&"

For M% = 5 To 7
Worksheets("mesto").Cells(M%, K%) = Int(Worksheets("mesto").Cells(M%, K%))
Worksheets("mesto").Cells(M%, K% + 2) = Int(Worksheets("mesto").Cells(M%, K% + 2))
If Worksheets("mesto").Cells(M%, K%) < 1 Or Worksheets("mesto").Cells(M%, K%) > 12 Then Worksheets("mesto").Cells(M%, K%) = 0
If Worksheets("mesto").Cells(M%, K% + 2) < 1 Or Worksheets("mesto").Cells(M%, K%) > 12 Then Worksheets("mesto").Cells(M%, K% + 2) = 0
Next M%

For M% = 5 To 6
For L% = (M% + 1) To 7
If Worksheets("mesto").Cells(M%, K%) > Worksheets("mesto").Cells(L%, K%) And Worksheets("mesto").Cells(L%, K%) > 0 Then
D00 = Worksheets("mesto").Cells(M%, K%)
Worksheets("mesto").Cells(M%, K%) = Worksheets("mesto").Cells(L%, K%)
Worksheets("mesto").Cells(L%, K%) = D00
Else
End If
If Worksheets("mesto").Cells(M%, K% + 2) > Worksheets("mesto").Cells(L%, K% + 2) And Worksheets("mesto").Cells(L%, K% + 2) > 0 Then
D00 = Worksheets("mesto").Cells(M%, K% + 2)
Worksheets("mesto").Cells(M%, K% + 2) = Worksheets("mesto").Cells(L%, K% + 2)
Worksheets("mesto").Cells(L%, K% + 2) = D00
Else
End If
Next L%
Next M%

If Worksheets("mesto").Cells(8, (K% + 2)) <> "" Then
ERRP = 1
For M% = 11 To 21
If Worksheets("mesto").Cells(8, (K% + 2)) = Worksheets("natal").Cells(M%, 1) Then ERRP = 0
Next M%
Else
ERRP = 0
End If
If ERRP = 1 Then
    Worksheets("mesto").Cells(8, (K% + 2)).Select
    MsgBox ("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If
Next K%

Worksheets("mesto").Cells(6, 2) = Int(Worksheets("mesto").Cells(6, 2))
If Worksheets("mesto").Cells(6, 2) < 0 Or Worksheets("mesto").Cells(6, 2) > 9 Then
    Worksheets("mesto").Cells(6, 2).Select
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    End
Else
End If

NREG = Worksheets("mesto").Cells(6, 2)
Worksheets("mesto").Cells(8, 2) = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd|
If Trim(Worksheets("mesto").Cells(3, 4)) = "|fffd|" Or Trim(Worksheets("mesto").Cells(3, 4)) = "|fffd|" Then
   Worksheets("mesto").Cells(3, 2) = 360 - (Worksheets("mesto").Cells(3, 2) + Worksheets("mesto").Cells(3, 3) / 60)
   Worksheets("mesto").Cells(3, 3) = Int((Worksheets("mesto").Cells(3, 2) - Int(Worksheets("mesto").Cells(3, 2))) * 60 + 0.5)
   Worksheets("mesto").Cells(3, 2) = Int(Worksheets("mesto").Cells(3, 2))
   Worksheets("mesto").Cells(3, 4) = "|fffd|"
   Else
   Worksheets("mesto").Cells(3, 4) = "|fffd|"
   End If
If Trim(Worksheets("mesto").Cells(4, 4)) = "|fffd|" Or Trim(Worksheets("mesto").Cells(4, 4)) = "|fffd|" Then
   Worksheets("mesto").Cells(4, 2) = 360 - (Worksheets("mesto").Cells(4, 2) + Worksheets("mesto").Cells(4, 3) / 60)
   Worksheets("mesto").Cells(4, 3) = Int((Worksheets("mesto").Cells(4, 2) - Int(Worksheets("mesto").Cells(4, 2))) * 60 + 0.5)
   Worksheets("mesto").Cells(4, 2) = Int(Worksheets("mesto").Cells(4, 2))
   Worksheets("mesto").Cells(4, 4) = "|fffd|"
   Else
   Worksheets("mesto").Cells(4, 4) = "|fffd|"
   End If
If Trim(Worksheets("mesto").Cells(3, 7)) = "|fffd|" Or Trim(Worksheets("mesto").Cells(3, 7)) = "|fffd|" Then
   Worksheets("mesto").Cells(3, 5) = 0 - Abs(Worksheets("mesto").Cells(3, 5))
   Worksheets("mesto").Cells(3, 6) = 0 - Abs(Worksheets("mesto").Cells(3, 6))
   Worksheets("mesto").Cells(3, 7) = "|fffd|"
   Else
   Worksheets("mesto").Cells(3, 7) = "|fffd|"
   End If
If Trim(Worksheets("mesto").Cells(4, 7)) = "|fffd|" Or Trim(Worksheets("mesto").Cells(4, 7)) = "|fffd|" Then
   Worksheets("mesto").Cells(4, 5) = 0 - Abs(Worksheets("mesto").Cells(4, 5))
   Worksheets("mesto").Cells(4, 6) = 0 - Abs(Worksheets("mesto").Cells(4, 6))
   Worksheets("mesto").Cells(4, 7) = "|fffd|"
   Else
   Worksheets("mesto").Cells(4, 7) = "|fffd|"
   End If

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Dim LonGrad0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad0 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim LonGrad1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad1 As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim LonGrad As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim LatGrad As Double '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim STEPLon As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim STEPLat As Integer '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim DLon As Double
Dim DLat As Double
Dim STROK As Long
Dim FLAG As Integer ' |fffd||fffd||fffd||fffd||fffd||fffd|
Dim S0 As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SNE As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SPLUS As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SUM As Integer ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim N1 As Integer
Dim N2 As Integer
Dim PLANET As String
Dim NTAB As Integer
Dim D1 As Integer
Dim D2 As Integer
Dim ZNAKS As String
Dim SOVPAD As Integer
Dim NP As Integer

STROK = 16

If NREG > 0 Then GoTo REGION

LonGrad0 = Worksheets("mesto").Cells(3, 2) + Worksheets("mesto").Cells(3, 3) / 60
LonGrad1 = Worksheets("mesto").Cells(4, 2) + Worksheets("mesto").Cells(4, 3) / 60
DLon = Worksheets("mesto").Cells(5, 2) + Worksheets("mesto").Cells(5, 3) / 60
STEPLon = Int((LonGrad1 - LonGrad0) / DLon)

LatGrad0 = Worksheets("mesto").Cells(3, 5) + Worksheets("mesto").Cells(3, 6) / 60
LatGrad1 = Worksheets("mesto").Cells(4, 5) + Worksheets("mesto").Cells(4, 6) / 60
DLat = Worksheets("mesto").Cells(5, 5) + Worksheets("mesto").Cells(5, 6) / 60
STEPLat = Int((LatGrad1 - LatGrad0) / DLat)

LonGrad = LonGrad0
LatGrad = LatGrad0
Worksheets("mesto").Cells(8, 2) = 0
NORB = Int(Worksheets("natal").Cells(4, 2))

For NN% = 1 To (Abs(STEPLon) + 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("mesto").Cells(STROK, 2) = Int(LonGrad)
Worksheets("mesto").Cells(STROK, 3) = Int((LonGrad - Int(LonGrad)) * 60)
Worksheets("natal").Cells(8, 2) = Worksheets("mesto").Cells(STROK, 2)
Worksheets("natal").Cells(8, 3) = Worksheets("mesto").Cells(STROK, 3)
Worksheets("natal").Cells(8, 4) = "|fffd|"

For KK% = 1 To (Abs(STEPLat) + 1) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("mesto").Cells(STROK, 5) = Int(LatGrad)
Worksheets("mesto").Cells(STROK, 6) = Int((LatGrad - Int(LatGrad)) * 60)
Worksheets("mesto").Cells(STROK, 2) = Int(LonGrad)
Worksheets("mesto").Cells(STROK, 3) = Int((LonGrad - Int(LonGrad)) * 60)
Worksheets("natal").Cells(8, 5) = Worksheets("mesto").Cells(STROK, 5)
Worksheets("natal").Cells(8, 6) = Worksheets("mesto").Cells(STROK, 6)
Worksheets("natal").Cells(8, 7) = "|fffd|"

Call radiks '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Worksheets("mesto").Cells(STROK, 4) = Worksheets("natal").Cells(8, 4)
Worksheets("mesto").Cells(STROK, 7) = Worksheets("natal").Cells(8, 7)
SOVPAD = 0
NESOVPAD = 0

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = UPITER()
If FLAG > 0 Then
Worksheets("mesto").Cells(STROK, 12) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = SUN()
If FLAG > 0 Then
Worksheets("mesto").Cells(STROK, 10) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = venus()
If FLAG > 0 Then
Worksheets("mesto").Cells(STROK, 11) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
FLAG = MARS()
If FLAG > 0 Then
Worksheets("mesto").Cells(STROK, 14) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = SATURN()
If FLAG > 0 Then
Worksheets("mesto").Cells(STROK, 15) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If

For KF% = 16 To 216 Step 4

If Int(Worksheets("mesto").Cells(12, KF%)) = 0 Then GoTo netf
If Int(Worksheets("mesto").Cells(5, KF%)) = 0 And Int(Worksheets("mesto").Cells(6, KF%)) = 0 And Int(Worksheets("mesto").Cells(7, KF%)) = 0 Then GoTo netf

If Int(Worksheets("mesto").Cells(11, KF%)) = 1 Then
N1 = 19
N2 = 29
NTAB = 50
Else
N1 = 12
N2 = 18
NTAB = 30
End If
S0 = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SNE = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SPLUS = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

PLANET = Trim(Worksheets("mesto").Cells(8, KF% + 2))
If PLANET = "" Then GoTo netplanet
ZNAKS = Worksheets("mesto").Cells(5, (KF% + 1))
For M% = 1 To 11
If PLANET = Worksheets("natal").Cells((10 + M%), 1) Then NP = M%
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NL% = 5 To 7
If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netuNL0
For M% = N1 To N2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("mesto").Cells(NL%, KF%)) = Int(Worksheets("formula").Cells(NP + 10, M%)) Then S0 = S0 + 1
Next M%
netuNL0: Next NL%

For KP% = (NP + 1) To 11
If Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 0 Then GoTo netASP1
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netuNL1
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
        For M% = N1 To N2
        If Int(Worksheets("formula").Cells(10 + KP%, M%)) = 0 Then GoTo netum1
        D2 = Int(Worksheets("formula").Cells(10 + KP%, M%))
        If Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 1 And D1 = D2 Then S0 = S0 + 1
        If (Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 60 Or Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 120) And D1 = D2 Then SPLUS = SPLUS + 1
        If (Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 90 Or Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 180) And D1 = D2 Then SNE = SNE + 1
netum1:  Next M%
netuNL1: Next NL%
netASP1: Next KP%

For KP% = 1 To NP
If Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 0 Then GoTo netASP2
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netuNL2
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
        For M% = N1 To N2
        If Int(Worksheets("formula").Cells(10 + KP%, M%)) = 0 Then GoTo netum2
        D2 = Int(Worksheets("formula").Cells(10 + KP%, M%))
        If Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 1 And D1 = D2 Then S0 = S0 + 1
        If (Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 60 Or Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 120) And D1 = D2 Then SPLUS = SPLUS + 1
        If (Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 90 Or Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 180) And D1 = D2 Then SNE = SNE + 1
netum2:  Next M%
netuNL2: Next NL%
netASP2: Next KP%

netplanet:
If Worksheets("mesto").Cells(5, KF%) = Worksheets("mesto").Cells(5, KF% + 2) And Worksheets("mesto").Cells(6, KF%) = Worksheets("mesto").Cells(6, KF% + 2) And Worksheets("mesto").Cells(7, KF%) = Worksheets("mesto").Cells(7, KF% + 2) Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netNL0
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
    For NR% = NL% To 7
    If Int(Worksheets("mesto").Cells(NR%, (KF% + 2))) = 0 Then GoTo netNR0
    D2 = Int(Worksheets("mesto").Cells(NR%, (KF% + 2)))
    S0 = S0 + Int(Worksheets("dom").Cells((NTAB + D1), (9 + 4 * D2)))
    SNE = SNE + Int(Worksheets("dom").Cells((NTAB + D1), (8 + 4 * D2)))
    SPLUS = SPLUS + Int(Worksheets("dom").Cells((NTAB + D1), (7 + 4 * D2)))
netNR0:     Next NR%
netNL0:     Next NL%
Else
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netNL
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
    For NR% = 5 To 7
    If Int(Worksheets("mesto").Cells(NR%, (KF% + 2))) = 0 Then GoTo netNR
    D2 = Int(Worksheets("mesto").Cells(NR%, (KF% + 2)))
    S0 = S0 + Int(Worksheets("dom").Cells((NTAB + D1), (9 + 4 * D2)))
    SNE = SNE + Int(Worksheets("dom").Cells((NTAB + D1), (8 + 4 * D2)))
    SPLUS = SPLUS + Int(Worksheets("dom").Cells((NTAB + D1), (7 + 4 * D2)))
netNR:     Next NR%
netNL:     Next NL%
End If

If Worksheets("mesto").Cells(5, (KF% + 1)) = "" Then SUM = SPLUS + SNE + S0
If Worksheets("mesto").Cells(5, (KF% + 1)) = "#" And Worksheets("mesto").Cells(13, KF%) = "#" Then SUM = SNE + S0
If Worksheets("mesto").Cells(5, (KF% + 1)) = "&" And Worksheets("mesto").Cells(13, KF%) = "&" Then SUM = SPLUS + S0
If Worksheets("mesto").Cells(5, (KF% + 1)) = "#" And Worksheets("mesto").Cells(13, KF%) = "&" Then SUM = SNE
If Worksheets("mesto").Cells(5, (KF% + 1)) = "&" And Worksheets("mesto").Cells(13, KF%) = "#" Then SUM = SPLUS
If Int(Worksheets("mesto").Cells(12, KF%)) <= SUM Then
Worksheets("mesto").Cells(STROK, KF%) = SUM
Worksheets("mesto").Cells(STROK, KF% + 1) = SPLUS
Worksheets("mesto").Cells(STROK, KF% + 2) = SNE
Worksheets("mesto").Cells(STROK, KF% + 3) = S0
Else
End If

If Worksheets("mesto").Cells(STROK, KF%) > 0 And Worksheets("mesto").Cells(10, KF%) = 0 Then SOVPAD = SOVPAD + 1
If Worksheets("mesto").Cells(STROK, KF%) > 0 And Worksheets("mesto").Cells(10, KF%) > 0 Then NESOVPAD = NESOVPAD + 1

netf: Next KF%
'============================ |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
LatGrad = LatGrad + DLat
Worksheets("mesto").Cells(STROK, 8) = SOVPAD
Worksheets("mesto").Cells(STROK, 9) = NESOVPAD

STROK = STROK + 1

Next KK%
LonGrad = LonGrad + DLon
LatGrad = LatGrad0

With Application
.ScreenUpdating = True
.Calculation = xlCalculationAutomatic
End With

Worksheets("mesto").Select
Worksheets("mesto").Cells(8, 2) = (NN% / (Abs(STEPLon) + 1)) * 100

With Application  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
.ScreenUpdating = False
.Calculation = xlCalculationManual
End With

Next NN%

With Application
.ScreenUpdating = True
.Calculation = xlCalculationAutomatic
End With

GoTo FINISH

REGION: '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For NS% = 16 To 1015 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If (Worksheets("reg").Cells(NS%, 10 * NREG + 1) + Worksheets("reg").Cells(NS%, 10 * NREG + 4)) = 0 Then GoTo netNS '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

For M% = 1 To 6 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("mesto").Cells(NS%, M% + 1) = Worksheets("reg").Cells(NS%, 10 * NREG + M%)
Worksheets("mesto").Cells(NS%, 1) = Worksheets("reg").Cells(NS%, 10 * NREG)
Worksheets("natal").Cells(8, M% + 1) = Worksheets("reg").Cells(NS%, 10 * NREG + M%)
Next M%

Call natal '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
SOVPAD = 0
NESOVPAD = 0
Worksheets("mesto").Select

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = UPITER()
If FLAG > 0 Then
Worksheets("mesto").Cells(NS%, 12) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = SUN()
If FLAG > 0 Then
Worksheets("mesto").Cells(NS%, 10) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = venus()
If FLAG > 0 Then
Worksheets("mesto").Cells(NS%, 11) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
FLAG = MARS()
If FLAG > 0 Then
Worksheets("mesto").Cells(NS%, 14) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
FLAG = SATURN()
If FLAG > 0 Then
Worksheets("mesto").Cells(NS%, 15) = CStr(FLAG) + " |fffd||fffd||fffd|"
FLAG = 0
Else
End If

For KF% = 16 To 216 Step 4

If Int(Worksheets("mesto").Cells(12, KF%)) = 0 Then GoTo netf2
If Int(Worksheets("mesto").Cells(5, KF%)) = 0 And Int(Worksheets("mesto").Cells(6, KF%)) = 0 And Int(Worksheets("mesto").Cells(7, KF%)) = 0 Then GoTo netf2

If Int(Worksheets("mesto").Cells(11, KF%)) = 1 Then
N1 = 19
N2 = 29
NTAB = 50
Else
N1 = 12
N2 = 18
NTAB = 30
End If
S0 = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SNE = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SPLUS = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
SUM = 0 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
NP = 0

PLANET = Trim(Worksheets("mesto").Cells(8, KF% + 2))
If PLANET = "" Then GoTo netplanet2
ZNAKS = Worksheets("mesto").Cells(5, (KF% + 1))
For M% = 1 To 11
If PLANET = Worksheets("natal").Cells((10 + M%), 1) Then NP = M%
Next M%

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For NL% = 5 To 7
If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netuNL02
For M% = N1 To N2 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Int(Worksheets("mesto").Cells(NL%, KF%)) = Int(Worksheets("formula").Cells(NP + 10, M%)) Then S0 = S0 + 1
Next M%
netuNL02: Next NL%

For KP% = (NP + 1) To 11
If Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 0 Then GoTo netASP12
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netuNL12
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
        For M% = N1 To N2
        If Int(Worksheets("formula").Cells(10 + KP%, M%)) = 0 Then GoTo netum12
        D2 = Int(Worksheets("formula").Cells(10 + KP%, M%))
        If Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 1 And D1 = D2 Then S0 = S0 + 1
        If (Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 60 Or Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 120) And D1 = D2 Then SPLUS = SPLUS + 1
        If (Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 90 Or Int(Worksheets("orb").Cells(10 + KP%, 30 + NP)) = 180) And D1 = D2 Then SNE = SNE + 1
netum12:  Next M%
netuNL12: Next NL%
netASP12: Next KP%

For KP% = 1 To NP
If Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 0 Then GoTo netASP22
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netuNL22
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
        For M% = N1 To N2
        If Int(Worksheets("formula").Cells(10 + KP%, M%)) = 0 Then GoTo netum22
        D2 = Int(Worksheets("formula").Cells(10 + KP%, M%))
        If Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 1 And D1 = D2 Then S0 = S0 + 1
        If (Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 60 Or Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 120) And D1 = D2 Then SPLUS = SPLUS + 1
        If (Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 90 Or Int(Worksheets("orb").Cells(10 + NP, 30 + KP%)) = 180) And D1 = D2 Then SNE = SNE + 1
netum22:  Next M%
netuNL22: Next NL%
netASP22: Next KP%

netplanet2:
If Worksheets("mesto").Cells(5, KF%) = Worksheets("mesto").Cells(5, KF% + 2) And Worksheets("mesto").Cells(6, KF%) = Worksheets("mesto").Cells(6, KF% + 2) And Worksheets("mesto").Cells(7, KF%) = Worksheets("mesto").Cells(7, KF% + 2) Then '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netNL02
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
    For NR% = NL% To 7
    If Int(Worksheets("mesto").Cells(NR%, (KF% + 2))) = 0 Then GoTo netNR02
    D2 = Int(Worksheets("mesto").Cells(NR%, (KF% + 2)))
    S0 = S0 + Int(Worksheets("dom").Cells((NTAB + D1), (9 + 4 * D2)))
    SNE = SNE + Int(Worksheets("dom").Cells((NTAB + D1), (8 + 4 * D2)))
    SPLUS = SPLUS + Int(Worksheets("dom").Cells((NTAB + D1), (7 + 4 * D2)))
netNR02:     Next NR%
netNL02:     Next NL%
Else
    For NL% = 5 To 7
    If Int(Worksheets("mesto").Cells(NL%, KF%)) = 0 Then GoTo netNL2
    D1 = Int(Worksheets("mesto").Cells(NL%, KF%))
    For NR% = 5 To 7
    If Int(Worksheets("mesto").Cells(NR%, (KF% + 2))) = 0 Then GoTo netNR2
    D2 = Int(Worksheets("mesto").Cells(NR%, (KF% + 2)))
    S0 = S0 + Int(Worksheets("dom").Cells((NTAB + D1), (9 + 4 * D2)))
    SNE = SNE + Int(Worksheets("dom").Cells((NTAB + D1), (8 + 4 * D2)))
    SPLUS = SPLUS + Int(Worksheets("dom").Cells((NTAB + D1), (7 + 4 * D2)))
netNR2:     Next NR%
netNL2:     Next NL%
End If

If Worksheets("mesto").Cells(5, (KF% + 1)) = "" Then SUM = SPLUS + SNE + S0
If Worksheets("mesto").Cells(5, (KF% + 1)) = "#" And Worksheets("mesto").Cells(13, KF%) = "#" Then SUM = SNE + S0
If Worksheets("mesto").Cells(5, (KF% + 1)) = "&" And Worksheets("mesto").Cells(13, KF%) = "&" Then SUM = SPLUS + S0
If Worksheets("mesto").Cells(5, (KF% + 1)) = "#" And Worksheets("mesto").Cells(13, KF%) = "&" Then SUM = SNE
If Worksheets("mesto").Cells(5, (KF% + 1)) = "&" And Worksheets("mesto").Cells(13, KF%) = "#" Then SUM = SPLUS
If Int(Worksheets("mesto").Cells(12, KF%)) <= SUM Then
Worksheets("mesto").Cells(NS%, KF%) = SUM
Worksheets("mesto").Cells(NS%, KF% + 1) = SPLUS
Worksheets("mesto").Cells(NS%, KF% + 2) = SNE
Worksheets("mesto").Cells(NS%, KF% + 3) = S0
Else
End If

If Worksheets("mesto").Cells(NS%, KF%) > 0 And Worksheets("mesto").Cells(10, KF%) = 0 Then SOVPAD = SOVPAD + 1
If Worksheets("mesto").Cells(NS%, KF%) > 0 And Worksheets("mesto").Cells(10, KF%) > 0 Then NESOVPAD = NESOVPAD + 1

netf2: Next KF%
'============================ |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If SOVPAD > 0 Then Worksheets("mesto").Cells(NS%, 8) = SOVPAD
If NESOVPAD > 0 Then Worksheets("mesto").Cells(NS%, 9) = NESOVPAD

netNS: Next NS%

FINISH:

Worksheets("natal").Cells(8, 2) = Worksheets("natal").Cells(58, 2)
Worksheets("natal").Cells(8, 3) = Worksheets("natal").Cells(58, 3)
Worksheets("natal").Cells(8, 4) = Worksheets("natal").Cells(58, 4)
Worksheets("natal").Cells(8, 5) = Worksheets("natal").Cells(58, 5)
Worksheets("natal").Cells(8, 6) = Worksheets("natal").Cells(58, 6)
Worksheets("natal").Cells(8, 7) = Worksheets("natal").Cells(58, 7)

Call natal

Worksheets("mesto").Select
ActiveWorkbook.save
    
End Sub

Function mer3ne8(NST As Integer, KARTA As Integer) As Integer
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'KARTA = 0 |fffd||fffd||fffd| 1 0-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim SUM As Integer '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim Lasp As Double '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

SUM = Worksheets("formula").Cells(46, (NST + 2))

If KARTA = 0 Then   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For K% = 12 To 18
    If Int(Worksheets("formula").Cells(13, K%)) = 8 Then SUM = SUM + 1
    Next K%
    For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If K% = 13 Then GoTo netKK
    Lasp = ASPECT(Worksheets("natal").Cells(13, 2), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 180 Step 30
    If A% = 30 Or A% = 60 Or A% = 120 Or A% = 150 Then GoTo netAA
    If Abs(Lasp - A%) >= Worksheets("orb").Cells((Ntabl * 10 + (K% - 10)), 13) Then GoTo netAA
    For M% = 12 To 18
    If Int(Worksheets("formula").Cells(K%, M%)) = 8 Then SUM = SUM + 1
    Next M%
netAA: Next A%
netKK: Next K%
Else
End If '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - end

If KARTA = 1 Then   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    For K% = 19 To 28
    If Int(Worksheets("formula").Cells(13, K%)) = 8 Then SUM = SUM + 1
    Next K%
    For K% = 11 To 21 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If K% = 13 Then GoTo netKKK
    Lasp = ASPECT(Worksheets("natal").Cells(13, 2), Worksheets("natal").Cells(K%, 2))
    For A% = 0 To 180 Step 30
    If A% = 30 Or A% = 60 Or A% = 120 Or A% = 150 Then GoTo netAAA
    If Abs(Lasp - A%) >= Worksheets("orb").Cells((Ntabl * 10 + (K% - 10)), 13) Then GoTo netAAA
    For M% = 19 To 28
    If Int(Worksheets("formula").Cells(K%, M%)) = 8 Then SUM = SUM + 1
    Next M%
netAAA: Next A%
netKKK: Next K%
Else
End If '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - end

If SUM >= 3 Then
mer3ne8 = SUM
Else
mer3ne8 = 0
End If
End Function

Function SATURN() As Integer
Dim NDOM As Integer
NDOM = INDOM(Worksheets("natal").Cells(17, 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If NDOM = 1 Or NDOM = 4 Or NDOM = 7 Or NDOM = 10 Then
SATURN = NDOM
Else
SATURN = 0
End If
End Function
Function MARS() As Integer
Dim NDOM As Integer
NDOM = INDOM(Worksheets("natal").Cells(15, 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If NDOM = 1 Or NDOM = 4 Or NDOM = 7 Or NDOM = 10 Then
MARS = NDOM
Else
MARS = 0
End If
End Function
Function venus() As Integer
Dim NDOM As Integer
NDOM = INDOM(Worksheets("natal").Cells(14, 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If NDOM = 1 Or NDOM = 4 Or NDOM = 7 Or NDOM = 10 Then
venus = NDOM
Else
venus = 0
End If
End Function
Function SUN() As Integer
Dim NDOM As Integer
NDOM = INDOM(Worksheets("natal").Cells(11, 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If NDOM = 1 Or NDOM = 4 Or NDOM = 7 Or NDOM = 10 Then
SUN = NDOM
Else
SUN = 0
End If
End Function
Function UPITER() As Integer
Dim NDOM As Integer
NDOM = INDOM(Worksheets("natal").Cells(16, 2), 4) '4 - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If NDOM = 1 Or NDOM = 4 Or NDOM = 7 Or NDOM = 10 Then
UPITER = NDOM
Else
UPITER = 0
End If
End Function

Attribute VB_Name = "Module5"
Sub razmetka()
Attribute razmetka.VB_ProcData.VB_Invoke_Func = " \n14"
'
'

For KF% = 3 To 255 Step 3
For n% = 82 To 107 Step 5

    Worksheets("f-baza").Cells(n%, KF%).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.NumberFormat = "@"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .NAME = "Arial Cyr"
        .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    
Next n%
Next KF%
    
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{414AE0DF-A9AA-4DC9-9128-723752B3D8D5}{01D87194-5460-4227-88DC-9983587552E0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{3731D7E6-D352-4A2E-B05D-A0DE00223916}{9B5CF328-7761-4619-9929-4BB32D64A843}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{16796E1B-FF0F-477F-B928-86234FE967B1}{B83811D5-5D95-4A52-AECD-B9000C9E49D8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
