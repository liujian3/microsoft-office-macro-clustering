Attribute VB_Name = "Module"

Sub application_OnTime()
    Application.OnTime Now + TimeValue("00:07:00"), "|fffd||17c||fffd|"
                                '1 |fffd||2b8||fffd||fffd||fffd| |fffd||fffd||169||fffd||fffd| |fffd||fffd||fffd||fffd|
End Sub



Sub |fffd||17c||fffd|()

    Dim WinHttp As New WinHttp.WinHttpRequest 'WinHttp|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim strHtml As String                                      '|fffd||fffd||fc| HTML |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim lngNo As Long                                           '"|fffd||fffd||177||fffd||fffd||fffd||33a||fffd|" |fffd||fffd||121| |e3||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varTemp() As String                                  '|fffd||fffd||fffd||fffd| |fffd||57f||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim vartemp1() As String
    Dim varVar() As String                                      '|fffd||4fd||fffd| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varR() As String                                    '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim i As Long
    Dim rowsCnt As Long
    Dim ii As Long
    Dim iii As Long
    Dim r As Long
    Dim myTime As Single
    
    
  
              
              
     Application.ScreenUpdating = False
   On Error Resume Next
      ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
       ActiveSheet.UsedRange.Clear


    rowsCnt = Sheets("|fffd||17c||fffd|").Columns(1).SpecialCells(2).Count
    
    For i = 2 To rowsCnt

    WinHttp.Open "GET", "http://hyper.moneta.co.kr/fcgi-bin/DelayedCurrPrice10.fcgi?code=" & Sheets("|fffd||17c||fffd|").Cells(i, 24) & "&isReal=true"
        
    
                                                                              '|fffd||fffd||fffd||339||fffd| |fffd||fffd||fffd||1fc||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
         
    WinHttp.Send                                                    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    WinHttp.WaitForResponse                               '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||678||fffd|
    
    
    
    strHtml = StrConv(WinHttp.ResponseBody, vbUnicode) 'Body|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    lngNo = InStr(1, strHtml, "parent"">", vbBinaryCompare)
                                                                                '"|fffd||fffd||177| |fffd||fffd||fffd||33a||fffd|" |fffd||fffd||121| |e3||fffd||fffd|
    strHtml = Mid(strHtml, lngNo, Len(strHtml) - lngNo) '"|fffd||fffd||177| |fffd||fffd||fffd||33a||fffd|" |fffd||6b7||3b8||fffd| |fffd||fffd||fffd||fffd|

    varTemp = Split(strHtml, "<strong class=""")                    'titlex|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd|

        Cells(i, 1) = Split(varTemp(1), "</strong>")                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd|
     
     
     For ii = 1 To 100
     If Cells(i, 1) = "" Then
    WinHttp.Open "GET", "http://hyper.moneta.co.kr/fcgi-bin/DelayedCurrPrice10.fcgi?code=" & Sheets("|fffd||17c||fffd|").Cells(i, 24) & "&isReal=true"

    WinHttp.Send                                                    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    WinHttp.WaitForResponse                               '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||678||fffd|
    
    
    strHtml = StrConv(WinHttp.ResponseBody, vbUnicode) 'Body|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    lngNo = InStr(1, strHtml, "parent"">", vbBinaryCompare)
                                                                                '"|fffd||fffd||177| |fffd||fffd||fffd||33a||fffd|" |fffd||fffd||121| |e3||fffd||fffd|
    strHtml = Mid(strHtml, lngNo, Len(strHtml) - lngNo) '"|fffd||fffd||177| |fffd||fffd||fffd||33a||fffd|" |fffd||6b7||3b8||fffd| |fffd||fffd||fffd||fffd|

    varTemp = Split(strHtml, "<strong class=""")                    'titlex|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd|

        Cells(i, 1) = Split(varTemp(1), "</strong>")
        
        Else
        Exit For
            
        
        End If
        
       Next ii
       
    
    Next i
    
    
            Columns(1).Replace What:="down"">", Replacement:="", lookat:=xlPart
        Columns(1).Replace What:="up"">", Replacement:="", lookat:=xlPart
        Columns(1).Replace What:=""">", Replacement:="", lookat:=xlPart
    
    Sheets("|fffd||17c||fffd|").Activate
    
    Range("r2:r1000") = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("a2:a1000").Value
    
    For i = 2 To rowsCnt
     If Cells(i, 18) >= Cells(i, 17) Then
    Cells(i, 17) = Cells(i, 18)
    End If
    Next i

  
    
    Cells(1, Columns.Count).End(1) = "|fffd||fffd||fffd||fffd| " & Split(Cells(1, Columns.Count).End(1)(1, 0), " ")(1) + 1
    
    
    For i = 2 To rowsCnt
    
    Cells(i, 20) = Cells(i, 18) / Cells(i, 17) - 1
    Cells(i, 22) = Cells(i, 20) / Cells(i, 21)
    
    Next i
    
    
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[t1], order1:=xlAscending
    
    For i = 2 To rowsCnt
    Cells(i, 25) = i - 1
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[v1], order1:=xlDescending
    
    For i = 2 To rowsCnt
    Cells(i, 26) = i - 1
    Next i


    For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = Cells(i, 25) + Cells(i, 26)
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlAscending
    
        For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = i - 1
    Next i

    
       Cells(1, Columns.Count).End(1)(1, 2) = "|fffd||17c||fffd|"
       
    If Cells(1, Columns.Count).End(1).Column > 30 Then
    For i = 2 To rowsCnt
    Cells(i, Columns.Count).End(1)(1, 2) = Cells(i, Columns.Count).End(1)(1, -2) - Cells(i, Columns.Count).End(1)
    
    Next i
    
    End If
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1)(1, 0), order1:=xlAscending
        
    ActiveSheet.Range("a2:xa6").Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlDescending
    If Cells(2, Columns.Count).End(1) > 3 Then
    Cells(2, Columns.Count).End(1)(1, 0).Interior.ColorIndex = 6
    End If
    
      

        
           Cells(1, Columns.Count).End(1)(1, -5).Activate
            Application.GoTo Reference:=ActiveCell, Scroll:=True
            Application.DisplayAlerts = False

               
                   myTime = Time
        Cells(rowsCnt + 1, Cells(1, Columns.Count).End(1).Column - 1) = myTime
                              Columns("aa:zz").AutoFit
                              
                              
    Range(Cells(2, 27), Cells(Rows.Count, 1).End(3).Offset(, 200)).NumberFormatLocal = "0_);[|fffd||fffd||fffd||fffd|](0)"
                                                           
                              
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Delete
Worksheets.Add after:=Worksheets(Sheets.Count)
ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Application.DisplayAlerts = True
   Application.ScreenUpdating = True
   
   Sheets("|fffd||17c||fffd|").Activate
'Call |fffd||17c||fffd||fffd||fffd|

        End Sub


Sub |fffd||17c||fffd||fffd||fffd|()

    Dim WinHttp As New WinHttp.WinHttpRequest 'WinHttp|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim strHtml As String                                      '|fffd||fffd||fc| HTML |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim lngNo As Long                                           '"|fffd||fffd||177||fffd||fffd||fffd||33a||fffd|" |fffd||fffd||121| |e3||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varTemp() As String                                  '|fffd||fffd||fffd||fffd| |fffd||57f||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim vartemp1() As String
    Dim varVar() As String                                      '|fffd||4fd||fffd| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varR() As String                                        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim i As Long
    Dim rowsCnt As Long
    Dim ii As Long
    Dim iii As Long
    Dim r As Long
    Dim rngall As Range
    Dim rngData As Range
    Dim rngC As Range
    Dim C As Range
    
    
    
  
              
              
   Application.ScreenUpdating = False
   On Error Resume Next
         ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
   
   Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Activate
       rowsCnt = Columns(1).SpecialCells(2).Count

Set rngall = Sheets("|fffd||17c||fffd|").Columns(24).SpecialCells(2)
Set rngData = Columns(24).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
Cells(rngC.Row, 1).Resize(, 20) = Sheets("|fffd||17c||fffd|").Cells(C.Row, 1).Resize(, 20).Value

End If

Next rngC


Set C = rngall.Find(rngC, lookat:=xlPart)
   


  
    
    Cells(1, Columns.Count).End(1) = "|fffd||fffd||fffd||fffd| " & Split(Cells(1, Columns.Count).End(1)(1, 0), " ")(1) + 1
    
    
    For i = 2 To rowsCnt
    
    Cells(i, 20) = Cells(i, 18) / Cells(i, 17) - 1
    Cells(i, 22) = Cells(i, 20) / Cells(i, 21)
    
    Next i
    
    
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[t1], order1:=xlAscending
    
    For i = 2 To rowsCnt
    Cells(i, 25) = i - 1
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[v1], order1:=xlDescending
    
    For i = 2 To rowsCnt
    Cells(i, 26) = i - 1
    Next i


    For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = Cells(i, 25) + Cells(i, 26)
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlAscending
    
        For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = i - 1
    Next i

    
       Cells(1, Columns.Count).End(1)(1, 2) = "|fffd||17c||fffd|"
       
    If Cells(1, Columns.Count).End(1).Column > 30 Then
    For i = 2 To rowsCnt
    Cells(i, Columns.Count).End(1)(1, 2) = Cells(i, Columns.Count).End(1)(1, -2) - Cells(i, Columns.Count).End(1)
    
    Next i
    
    End If
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1)(1, 0), order1:=xlAscending
        
    ActiveSheet.Range("a2:xa6").Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlDescending

    If Cells(2, Columns.Count).End(1) > 3 Then
    Cells(2, Columns.Count).End(1)(1, 0).Interior.ColorIndex = 6
    End If


    myTime = Time
        Cells(rowsCnt + 1, Cells(1, Columns.Count).End(1).Column - 1) = myTime
        
        
           Cells(1, Columns.Count).End(1)(1, -5).Activate
            Application.GoTo Reference:=ActiveCell, Scroll:=True

               Columns("aa:zz").AutoFit
                  Application.ScreenUpdating = True
    Call |fffd||17c||fffd||fffd||fffd||fffd||22d||fffd||fffd||fffd||fffd|

        End Sub


Sub |fffd||17c||fffd||fffd||fffd||fffd||22d||fffd||fffd||fffd||fffd|()

    Dim WinHttp As New WinHttp.WinHttpRequest 'WinHttp|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim strHtml As String                                      '|fffd||fffd||fc| HTML |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim lngNo As Long                                           '"|fffd||fffd||177||fffd||fffd||fffd||33a||fffd|" |fffd||fffd||121| |e3||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varTemp() As String                                  '|fffd||fffd||fffd||fffd| |fffd||57f||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim vartemp1() As String
    Dim varVar() As String                                      '|fffd||4fd||fffd| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varR() As String                                        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim i As Long
    Dim rowsCnt As Long
    Dim ii As Long
    Dim iii As Long
    Dim r As Long
    Dim rngall As Range
    Dim rngData As Range
    Dim rngC As Range
    Dim C As Range
    
    
    
  
              
              
   Application.ScreenUpdating = False
   On Error Resume Next
         ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
   
   Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Activate
       rowsCnt = Columns(1).SpecialCells(2).Count
   

Set rngall = Sheets("|fffd||17c||fffd|").Columns(23).SpecialCells(2)
Set rngData = Columns(23).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
Cells(rngC.Row, 1).Resize(, 20) = Sheets("|fffd||17c||fffd|").Cells(C.Row, 1).Resize(, 20).Value

End If

Next rngC


Set C = rngall.Find(rngC, lookat:=xlPart)
   

    
    
    Cells(1, Columns.Count).End(1) = "|fffd||fffd||fffd||fffd| " & Split(Cells(1, Columns.Count).End(1)(1, 0), " ")(1) + 1
    
    
    For i = 2 To rowsCnt
    
    Cells(i, 20) = Cells(i, 18) / Cells(i, 17) - 1
    Cells(i, 22) = Cells(i, 20) / Cells(i, 21)
    
    Next i
    
    
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[t1], order1:=xlAscending
    
    For i = 2 To rowsCnt
    Cells(i, 25) = i - 1
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[v1], order1:=xlDescending
    
    For i = 2 To rowsCnt
    Cells(i, 26) = i - 1
    Next i


    For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = Cells(i, 25) + Cells(i, 26)
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlAscending
    
        For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = i - 1
    Next i

    
       Cells(1, Columns.Count).End(1)(1, 2) = "|fffd||17c||fffd|"
       
    If Cells(1, Columns.Count).End(1).Column > 33 Then
    For i = 2 To rowsCnt
    Cells(i, Columns.Count).End(1)(1, 2) = Cells(i, Columns.Count).End(1)(1, -2) - Cells(i, Columns.Count).End(1)
    
    Next i
    
    End If
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1)(1, 0), order1:=xlAscending
        
    ActiveSheet.Range("a2:xa6").Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlDescending

    If Cells(2, Columns.Count).End(1) > 3 Then
    Cells(2, Columns.Count).End(1)(1, 0).Interior.ColorIndex = 6
    End If


 
    myTime = Time
        Cells(rowsCnt + 1, Cells(1, Columns.Count).End(1).Column - 1) = myTime
        
        
           Cells(1, Columns.Count).End(1)(1, -5).Activate
            Application.GoTo Reference:=ActiveCell, Scroll:=True

               Columns("aa:zz").AutoFit
                  Application.ScreenUpdating = True
               
Call |fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8fed|

        End Sub
        
Sub |fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8fed|()

    Dim WinHttp As New WinHttp.WinHttpRequest 'WinHttp|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim strHtml As String                                      '|fffd||fffd||fc| HTML |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim lngNo As Long                                           '"|fffd||fffd||177||fffd||fffd||fffd||33a||fffd|" |fffd||fffd||121| |e3||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varTemp() As String                                  '|fffd||fffd||fffd||fffd| |fffd||57f||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim vartemp1() As String
    Dim varVar() As String                                      '|fffd||4fd||fffd| |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim varR() As String                                        '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
    Dim i As Long
    Dim rowsCnt As Long
    Dim ii As Long
    Dim iii As Long
    Dim r As Long
    Dim rngall As Range
    Dim rngData As Range
    Dim rngC As Range
    Dim C As Range
    
    
    
  
              
              
   Application.ScreenUpdating = False
   On Error Resume Next

   
   Sheets("|fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8fed|").Activate
   

     
If Cells(2, 1) = "" Then
Set rngall = Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Range("w2:w1000").SpecialCells(2)
Set rngData = Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Range("w2:w1000").SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
Cells(Rows.Count, 1).End(3)(2).Resize(, 24) = Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Cells(rngC.Row, 1).Resize(, 24).Value
Cells(Rows.Count, 27).End(3)(2).Resize(, 3) = Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Cells(C.Row, 27).Resize(, 3).Value

End If

Set C = rngall.Find(rngC, lookat:=xlPart)
Next rngC
End If


   
       rowsCnt = Columns(1).SpecialCells(2).Count
       
       
       
       Set rngall = Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Columns(23).SpecialCells(2)
Set rngData = Columns(23).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
Cells(rngC.Row, 1).Resize(, 20) = Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Cells(C.Row, 1).Resize(, 20).Value

End If

Next rngC
       

       
    Cells(1, Columns.Count).End(1) = "|fffd||fffd||fffd||fffd| " & Split(Cells(1, Columns.Count).End(1)(1, 0), " ")(1) + 1
    
    
    For i = 2 To rowsCnt
    
    Cells(i, 20) = Cells(i, 18) / Cells(i, 17) - 1
    Cells(i, 22) = Cells(i, 20) / Cells(i, 21)
    
    Next i
    
    
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[t1], order1:=xlAscending
    
    For i = 2 To rowsCnt
    Cells(i, 25) = i - 1
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=[v1], order1:=xlDescending
    
    For i = 2 To rowsCnt
    Cells(i, 26) = i - 1
    Next i


    For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = Cells(i, 25) + Cells(i, 26)
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlAscending
    
        For i = 2 To rowsCnt
    Cells(i, Cells(1, Columns.Count).End(1).Column) = i - 1
    Next i

    
       Cells(1, Columns.Count).End(1)(1, 2) = "|fffd||17c||fffd|"
       
    If Cells(1, Columns.Count).End(1).Column > 33 Then
    For i = 2 To rowsCnt
    Cells(i, Columns.Count).End(1)(1, 2) = Cells(i, Columns.Count).End(1)(1, -2) - Cells(i, Columns.Count).End(1)
    
    Next i
    
    End If
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, Columns.Count).End(1)(1, 0), order1:=xlAscending
        
    ActiveSheet.Range("a2:xa6").Sort key1:=Cells(1, Columns.Count).End(1), order1:=xlDescending

    If Cells(2, Columns.Count).End(1) > 3 Then
    Cells(2, Columns.Count).End(1)(1, 0).Interior.ColorIndex = 6
    End If


 
    myTime = Time
        Cells(rowsCnt + 1, Cells(1, Columns.Count).End(1).Column - 1) = myTime
        
        
           Cells(1, Columns.Count).End(1)(1, -5).Activate
            Application.GoTo Reference:=ActiveCell, Scroll:=True

               Columns("aa:zz").AutoFit
 'application_OnTime         'application_OnTime |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                     

        End Sub
        
        



Sub stop_OnTime()
    On Error Resume Next
        ' "Stop Macro |fffd||fffd||1b0||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||7fb||fffd| |fffd||fffd| |fffd||338||fffd| |f3||fffd||fffd||fffd||3f1||fffd| |fffd||fffd||fffd||fffd|
    Application.OnTime Now + TimeValue("00:06:00"), "|fffd||17c||fffd|", Schedule:=False
                                                 'application_Ontime |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f4||fffd|
    On Error GoTo 0                   '|fffd||fffd||fffd||fffd| |fffd||2b1||fffd||22d|
End Sub





Sub |fffd||fffd||fffd||fffd||331||fffd||fffd||fffd||fc|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|

      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


   ThisWorkbook.Sheets("|fffd||17c||fffd|").Activate

   
   
    For i = 2 To Sheets.Count
   Sheets(i).Activate
   Set C = Rows(1).SpecialCells(2).Find("|fffd||fffd||fffd||fffd| 1", lookat:=xlWhole)
   If Not C Is Nothing Then
   Range(Cells(1, C.Column + 1), "zz10000").Delete
   Cells(Rows.Count, 1).End(3)(2).Resize(, 100).Clear
   End If
   Next i
   


Sheets("|fffd||17c||fffd|").Activate

         Sheets("|fffd||17c||fffd|").UsedRange.Offset(1).Clear
   
   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
   strName = ActiveSheet.Name
   Set rngData = Range("a1:z10000")
   
   
   
   Set wkBk = Workbooks.Add
   ActiveSheet.Range("a1:z10000") = rngData.Value
   
   Columns.AutoFit
   
   
   
   r = 0
   rowsCnt = ActiveSheet.UsedRange.Rows.Count

   '---- |fffd||8fed||fffd||fffd| data |fffd||5b1||fffd|----'
   ReDim varTemp(1 To rowsCnt)
   For i = 2 To rowsCnt
   r = r + 1
   varTemp(r) = Cells(i, 1).Resize(, 30)
   Next i
   
   r = 1
   ActiveSheet.UsedRange.Offset(1).Clear '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd| data |fffd||fffd||fffd||fffd||fffd|
   
      
   '---- sheets|fffd||fffd| |fffd||8fed| data |fffd||5b1||fffd|----'
   For i = rowsCnt - 1 To 1 Step -1
   r = r + 1
  
   Cells(r, 1).Resize(, 30) = varTemp(i)
   
      
   Next i
   
       
   Range("b2").Select
   ActiveWindow.FreezePanes = True
    
   Set rngData = Nothing
   Erase varTemp
   
   
   
   r = 0
Sheets("sheet1").Activate

Columns("17:30").Clear



Cells(1, 17).Resize(, 6) = Array("8|fffd||fffd||fffd||fffd||fffd||fffd|", "8|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||8fed|", "|fffd||135||fffd|", "|fffd||135||fffd|MAX", "|fffd||135||fffd||fffd||17c||fffd|")





rowsCnt = ActiveSheet.UsedRange.Rows.Count

ReDim varTemp(1 To rowsCnt)
ReDim vartemp1(1 To rowsCnt)
ReDim vartemp2(1 To rowsCnt)


For i = 2 To rowsCnt
r = r + 1
varTemp(r) = Application.Max(Cells(i, 4).Offset(-6).Resize(13))
vartemp1(r) = Application.Min(Cells(i, 5).Offset(-6).Resize(13))
vartemp2(r) = Cells(i, 1) & Cells(i, 2)
Next i

Cells(2, 17).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)
Cells(2, 18).Resize(UBound(vartemp1, 1)) = Application.Transpose(vartemp1)
Cells(2, 26).Resize(UBound(vartemp2, 1)) = Application.Transpose(vartemp2)

r = 0


 
For i = 2 To rowsCnt
r = r + 1
If Cells(i, 17) <> Cells(i, 4) Then
varTemp(r) = ""
Else
varTemp(r) = Cells(i, 4)
End If

If Cells(i, 18) <> Cells(i, 5) Then
vartemp1(r) = ""
Else
vartemp1(r) = Cells(i, 5)
End If

If Cells(i, 10) > Cells(i, 11) And Cells(i, 11) > Cells(i, 12) And Cells(i, 4) >= Cells(i, 10) Then
vartemp2(r) = "|fffd||fffd||fffd||8fed|"
Else
vartemp2(r) = ""
End If

Next i

Cells(2, 17).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)
Cells(2, 18).Resize(UBound(vartemp1, 1)) = Application.Transpose(vartemp1)
Cells(2, 19).Resize(UBound(vartemp2, 1)) = Application.Transpose(vartemp2)

    
Erase varTemp
Erase vartemp1
Erase vartemp2
r = 0



    
    Sheets("sheet1").Activate
    Cells.Select
    Cells.EntireColumn.AutoFit
    Range("C2").Select
    ActiveWindow.FreezePanes = True
        Columns("B:B").Select
    Selection.NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
 

   
     For i = 1 To 3

   Sheets.Add after:=Sheets(Sheets.Count)
   Sheets(Sheets.Count).Name = Sheets(Sheets.Count)
   Next i
              
  
Sheets("sheet1").Activate
r = 0
 
rowsCnt = ActiveSheet.UsedRange.Rows.Count

    With Sheets("sheet2")
    .Cells.Clear
    .Cells(1, 1).Resize(, 30) = Cells(1, 1).Resize(, 30).Value
    
    
   
   For i = 2 To rowsCnt

   
   If Cells(i, 17) <> "" Or Cells(i, 18) <> "" Then
   
      r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 30)
   End If
   
   Next i
   

   
   For r = 1 To UBound(varTemp, 1)                 'varTemp|fffd||fffd| 1|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||470||fffd| |fffd||fffd||16d| |fffd||77a||fffd|
   .Cells(r + 1, 1).Resize(, 30) = varTemp(r)      '|fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd| area|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||478||fffd|
        Next r
        
        
    End With
    
    Erase varTemp

        r = 0
        
   Sheets("sheet2").Activate
   rowsCnt = ActiveSheet.UsedRange.Rows.Count
   
   For i = 2 To rowsCnt
   If Cells(i, 17) <> "" And Cells(i + 1, 17) <> "" Then
   
   If Cells(i, 17) >= Cells(i + 1, 17) Then
   Cells(i + 1, 17) = Cells(i, 17)
   
   Else
   Cells(i, 17) = Cells(i + 1, 17)
   
   End If
   
   End If
   
   Next i
   
   For i = rowsCnt To 3 Step -1
   If Cells(i, 18) <> "" And Cells(i - 1, 18) <> "" Then
   
   If Cells(i, 18) >= Cells(i - 1, 18) Then
   Cells(i, 18) = Cells(i - 1, 18)
   
   Else
   Cells(i - 1, 18) = Cells(i, 18)
   
   End If
   
   End If
     
      
   Next i
   
   
   For i = 2 To rowsCnt
   Cells(i, 20) = (Cells(i + 1, 18) - Cells(i, 17)) / Cells(i, 17)
   If Cells(i, 18) = "" Then
   Cells(i, 18) = Cells(i + 1, 18)
   End If
   

If Cells(i, 20) < 0 And Cells(i, 20) > -1 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 30)
End If

Next i



   



ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 30) = varTemp(i)
Next i

Erase varTemp
r = 0





With Sheets("sheet3").Clear
End With


With Sheets("sheet4").Clear
End With

     ActiveSheet.UsedRange.AutoFilter Field:=19, Criteria1:="<>"        '|fffd||fffd||fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4b0||fffd||fffd||333||fffd| |fffd||fffd||fffd||fffd||fffd||333||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
    ActiveSheet.UsedRange.SpecialCells(12).Copy Sheets("sheet3").Cells(1, 1)

           ActiveSheet.UsedRange.AutoFilter Field:=19, Criteria1:="="        '|fffd||fffd||fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4b0||fffd||fffd||333||fffd| |fffd||fffd||fffd||fffd||fffd||333||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
    ActiveSheet.UsedRange.SpecialCells(12).Copy Sheets("sheet4").Cells(1, 1)


          
  With Sheets("sheet2")
  If .AutoFilterMode Then
        .UsedRange.AutoFilter   '(|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||2b0||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    End With
    
   
   Sheets("sheet3").Activate
 rowsCnt = ActiveSheet.UsedRange.Rows.Count
 
 For i = 2 To rowsCnt
 Cells(i, 21) = Application.Min(Cells(i - 15, 20).Resize(15)) '|fffd||135||fffd||fffd||fffd| |fffd||fffd||238||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3b0||fffd| |fffd||fffd||fffd||fffd|(|fffd||17f||fffd||fffd||7ff||fffd|)
 
 If Cells(i, 20) < Cells(i, 21) Then
 Cells(i, 22) = "1"
 Cells(i, 23) = Cells(i, 20) - Cells(i, 21)

  End If
 
 Next i
 
 
    Sheets("sheet4").Activate
 rowsCnt = ActiveSheet.UsedRange.Rows.Count
 
 For i = 2 To rowsCnt
 Cells(i, 21) = Application.Min(Cells(i - 15, 20).Resize(15)) '|fffd||135||fffd||fffd||fffd| |fffd||fffd||238||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3b0||fffd| |fffd||fffd||fffd||fffd|(|fffd||17f||fffd||fffd||7ff||fffd|)
 
 If Cells(i, 20) < Cells(i, 21) Then
 Cells(i, 22) = "1"
 Cells(i, 23) = Cells(i, 20) - Cells(i, 21)

  End If
 
 Next i
 
 
 
    For i = 1 To Sheets.Count
    
    Sheets(i).Activate
    Cells.Select
    Cells.EntireColumn.AutoFit
    ActiveWindow.FreezePanes = True
    Columns("B:B").Select
    Selection.NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
    
    Columns("t:U").NumberFormatLocal = "0.0%"
    Columns("w").NumberFormatLocal = "0.0%"
 
    Next i
 

   
   
   Sheets("sheet1").Activate
    a = Cells(Rows.Count, 17).End(3).End(3).Row
    ccc = Cells(Rows.Count, 17).End(3).Row
    
    
    For o = a + 1 To ccc
    If Cells(o, 18) <> "" Then
    Exit For
    End If
    Next o
   
    
    If o > ccc Then
    
    If Cells(Rows.Count, 17).End(3) < Cells(Rows.Count, 17).End(3).End(3) Then
    Cells(Rows.Count, 17).End(3) = Cells(Rows.Count, 17).End(3).End(3).Value
    End If
    End If
    

   If Cells(Rows.Count, 17).End(3).Offset(, 2) <> "" Then
   With Sheets("sheet3")
   .Cells(Rows.Count, 1).End(3)(2).Resize(, 30) = Sheets("sheet1").Cells(Rows.Count, 17).End(3).Offset(, -16).Resize(, 30).Value
   
   If .Cells(Rows.Count, 1).End(3) = .Cells(Rows.Count, 1).End(3)(0, 1) _
   And .Cells(Rows.Count, 2).End(3) = .Cells(Rows.Count, 2).End(3)(0, 1) Then
   .Cells(Rows.Count, 21).End(3)(2) = .Cells(Rows.Count, 21).End(3)
   Else
   .Cells(Rows.Count, 21).End(3)(2) = Application.Min(.Cells(Rows.Count, 20).End(3).Resize(, 2))
   End If
   
       
    ThisWorkbook.Sheets("|fffd||17c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 30) = .Cells(Rows.Count, 1).End(3).Resize(, 30).Value
    ThisWorkbook.Sheets("|fffd||17c||fffd|").Cells(Rows.Count, 1).End(3).Offset(, 22) = fileName
           
   End With
   
   Else
   With Sheets("sheet4")
   .Cells(Rows.Count, 1).End(3)(2).Resize(, 30) = Sheets("sheet1").Cells(Rows.Count, 17).End(3).Offset(, -16).Resize(, 30).Value
   
   If .Cells(Rows.Count, 1).End(3) = .Cells(Rows.Count, 1).End(3)(0, 1) _
   And .Cells(Rows.Count, 2).End(3) = .Cells(Rows.Count, 2).End(3)(0, 1) Then
   .Cells(Rows.Count, 21).End(3)(2) = .Cells(Rows.Count, 21).End(3)
   Else
   .Cells(Rows.Count, 21).End(3)(2) = Application.Min(.Cells(Rows.Count, 20).End(3).Resize(, 2))
   End If
   
         ThisWorkbook.Sheets("|fffd||17c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 30) = .Cells(Rows.Count, 1).End(3).Resize(, 30).Value
           ThisWorkbook.Sheets("|fffd||17c||fffd|").Cells(Rows.Count, 1).End(3).Offset(, 22) = fileName
           
   End With
   End If
   

           
   
   wkBk.SaveAs ActiveWorkbook.Path & strName & ".xlsx"
   

   wkBk.Close True
   
   
   Workbooks(strPath & fileName).Activate
   
   fileName = Dir

 
ActiveWorkbook.Close True

 

Loop


r = 0
ThisWorkbook.Sheets("|fffd||17c||fffd|").Activate




    Columns("W:W").Select

    Selection.Replace What:="(30|fffd||fffd|).csv", Replacement:="", lookat:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
          


Set rngall = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).SpecialCells(2)
Set rngData = Columns(23).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
rngC.Next = C.Next
End If

Next rngC


Set C = rngall.Find(rngC, lookat:=xlPart)

        End Sub






Sub |fffd||fffd||fffd||fffd||331||fffd||fffd||fffd||fffd||8fed|()


Dim rngall As Range
Dim ccc As Range
Dim rngC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|

      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

 
    ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").UsedRange.Offset(1).Clear
   
   

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
   
   
   
   'sheet1 |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||8fed||fffd||338||fffd|.
   'sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
   
   'for|fffd||fffd||fffd||fffd| |fffd||1f2d| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||8fed| |fffd||fffd||12d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |f9| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||f6||fffd||fffd||fffd||fffd||fffd| count|fffd||3ff||fffd| max|fffd||fffd| |fffd||fffd||fffd||474||fffd|
   '|fffd||c33||fffd||fffd||fffd||fffd| 5|fffd||fffd||fffd||fffd| |fffd||47e||ec21||fffd||fffd| |fffd||fffd||ff87c||fffd| |fffd||fffd||fffd||fffd|
   '|fffd||fffd| max|fffd||fffd| sheet2|fffd||fffd| |fffd||135||fffd| max|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||474||fffd|
   '|fffd||fffd||fc| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| thisworkbook |fffd||fffd||fffd||8fed||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| |fffd||5b4||b4||fffd|.
   
   Sheets("sheet1").Activate
   If Cells(Rows.Count, 17).End(3)(1, 3) <> "" Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||8fed||fffd||338||fffd|
   
   Sheets("sheet2").Activate 'sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
   Cells(Rows.Count, 1).End(3)(2).Resize(, 30) = Sheets("sheet1").Cells(Rows.Count, 17).End(3).Offset(, -16).Resize(, 30).Value
   
   If Cells(Rows.Count, 1).End(3) = Cells(Rows.Count, 1).End(3)(0, 1) And Cells(Rows.Count, 2).End(3) = Cells(Rows.Count, 2).End(3)(0, 1) Then
   Cells(Rows.Count, 1).End(3).Resize(, 30).Clear
   End If
   
   For i = Columns(1).SpecialCells(2).Count To 3 Step -1
   If Cells(i, 19) <> "" Then
   r = r + 1
   If r > 4 Then
   Exit For
   End If
   End If
   
   If Cells(i, 19) = "" Then
   Cells(Rows.Count, 1).End(3)(1, 21) = Application.Min(Cells(i, 20).Resize(r))
   ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Cells(Rows.Count, 1).End(3)(2).Resize(, 30) = Cells(Rows.Count, 1).End(3).Resize(, 30).Value
   ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Cells(Rows.Count, 1).End(3).Offset(, 22) = fileName
   Exit For
   End If
    
   Next i
   
   End If
    
   r = 0
  
   
   fileName = Dir

 
ActiveWorkbook.Close False

 

Loop


   
   ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd||8fed|").Activate


    Columns("W:W").Select
    Selection.Replace What:="(30|fffd||fffd|).xlsx", Replacement:="", lookat:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False


Set rngall = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).SpecialCells(2)
Set rngData = Columns(23).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
rngC.Next = C.Next
End If

Next rngC



Set cccc = rngall.Find(rngC, lookat:=xlPart)

        End Sub

Sub |fffd||fffd||fffd||fffd||331||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|()

 
Dim rngall As Range
Dim ccc As Range
Dim rngC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range


 
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
       .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
           Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
        Else
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        End If

   End With
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If
On Error Resume Next

 
    ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear
       ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8fed|").UsedRange.Offset(1).Clear
 
  Do While fileName <> ""

    Workbooks.Open (strPath & fileName)
    
    Cells(1, 18).Resize(, 10) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|(|fffd||fffd|)", "|fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|(|fffd||fffd|)", _
    "|fffd||177||fffd||fffd||fffd||774||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||731||fffd||fffd||3b4||fffd||fffd||fffd|", "|fffd||fffd||fffd||3b4||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd|")


   For i = 2 To 15
   Cells(i, 18) = (Cells(i, 5) * Cells(i, 15)) / 1000000
   Cells(i, 19) = (Cells(i, 5) * Cells(i, 16)) / 1000000
   Cells(i, 20) = (Cells(i, 5) * Cells(i, 17)) / 1000000
   Next i
  
   For i = 2 To 15
   Cells(i, 21) = Application.Sum(Cells(i, 14).Resize(10))
   Cells(i, 22) = Application.Sum(Cells(i, 18).Resize(10))
   Cells(i, 23) = Application.Sum(Cells(i, 19).Resize(10))
   Cells(i, 24) = Application.Sum(Cells(i, 20).Resize(10))
   
   Cells(i, 25) = Cells(i, 22) / Cells(i, 21)
   Cells(i, 26) = Cells(i, 23) / Cells(i, 21)
   Cells(i, 27) = Cells(i, 24) / Cells(i, 21)

   Next i

   
   If Cells(2, 25) > 0.05 Then
   ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 23).End(3)(2) = ActiveSheet.Name
   ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 27).End(3)(2).Resize(, 3) = Cells(2, 25).Resize(, 3).Value

   End If
   

   fileName = Dir
 

ActiveWorkbook.Close True
 
Loop

 ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Activate
 
 

    Columns("W:W").Select
    Selection.Replace What:="(|fffd||fffd|)", Replacement:="", lookat:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
 
         
Set rngall = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).SpecialCells(2)
Set rngData = Columns(23).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
rngC.Next = C.Next
End If

Next rngC

 
Call |fffd||17c||fffd||fffd||fffd||fffd|

 

        End Sub

 

 

 

Sub |fffd||17c||fffd||fffd||fffd||fffd|()

 

Dim rngall As Range

Dim rngData As Range

Dim rngC As Range

Dim C As Range

 

 

 

Application.ScreenUpdating = False

On Error Resume Next

 

 

ThisWorkbook.Sheets("|fffd||17c||fffd||fffd||fffd||fffd|").Activate

rowsCnt = Columns(23).SpecialCells(2).Count

 

Set rngall = Sheets("|fffd||17c||fffd|").Columns(23).SpecialCells(2)

Set rngData = Columns(23).SpecialCells(2)

 

For Each rngC In rngData

Set C = rngall.Find(rngC, lookat:=xlWhole)

If Not C Is Nothing Then

Cells(rngC.Row, 1).Resize(, 26) = Sheets("|fffd||17c||fffd|").Cells(C.Row, 1).Resize(, 26).Value

 

End If

 

Next rngC


 

End Sub


Sub |fffd||fffd||fffd||fffd|()


   For i = 2 To Sheets.Count
   Sheets(i).Activate
   Sheets(i).Columns("ab:zz").Delete
   Cells(Rows.Count, 27).End(3).Clear
   Next i
      
Sheets("|fffd||17c||fffd|").Activate

End Sub
 

 

 

 

 

 


 




Attribute VB_Name = "Module1"

Sub |fffd||fffd||fffd||fffd||331||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fc|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|

      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next



   
   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
   strName = ActiveSheet.Name
   Set rngData = Range("a1:o2001")
   
   
   
   Set wkBk = Workbooks.Add
   ActiveSheet.Range("a1:o2001") = rngData.Value
   
   Columns.AutoFit
   
   
   Cells(1, 16).Resize(, 7) = Array("100|fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd|", "|fffd||170||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd|1", "|fffd||fffd||fffd||377||fffd|")
   
   For i = 1 To Rows(1).SpecialCells(2).Count
   
   If Cells(1, i) = "100|fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd| = i
   End If
      
      
   If Cells(1, i) = "|fffd||170||fffd||fffd||fffd|" Then
   |fffd||170||fffd||fffd||fffd| = i
   End If
      
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| = i
   End If
   
      
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      
   If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
   |fffd||fffd||fffd||377||fffd| = i
   End If
   
      
   If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      
   If Cells(1, i) = "|fffd||17c||fffd|1" Then
   |fffd||17c||fffd|1 = i
   End If
   
     
   
   
   Next i
   
   
   
   
        
   With Range("A1").CurrentRegion
        .Sort key1:=.Cells(1, 1), key2:=.Cells(1, 2), key3:=.Cells(1, 3), order1:=xlAscending, Header:=xlYes
   End With
   
     ' Cells(1, 16).Resize(, ) = Array("100|fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd|", "|fffd||170||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd|", "|fffd||fffd||fffd||377||fffd|")
   For i = 2 To Columns(1).SpecialCells(2).Count
   Cells(i, |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd|) = Application.Max(Cells(i - 100, 15).Resize(100))
   Cells(i, |fffd||170||fffd||fffd||fffd|) = Application.Max(Cells(i - 100, 6).Resize(100))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|) = Cells(i, 6) / Cells(i - 1, 6) - 1
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 6) / Cells(i, 3) - 1
   Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 15) / Cells(i, |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd|)
     
   If Cells(i, 15) > Cells(i, |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||177||fffd||fffd||fffd|) And Cells(i, 6) > Cells(i, |fffd||170||fffd||fffd||fffd|) Then
   Cells(i, |fffd||17c||fffd|1) = 1
   End If
      
   Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i + 1, 6) / Cells(i, 6) - 1
   
   
   Next i
           
   
   wkBk.SaveAs ActiveWorkbook.Path & strName & ".xlsx"
   

  wkBk.Close True
   
   
   Workbooks(strPath & fileName).Activate
   
   fileName = Dir

 
ActiveWorkbook.Close True

 

Loop



        End Sub
        
        
        
        Sub |fffd||fffd||2ba||fffd||fffd||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|

      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xls*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next



   r = 6
   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)


   

   
   r = r + 1
      ThisWorkbook.Sheets(r).Cells.Clear
   ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets(r).Cells(1, 1)
   

   fileName = Dir

 
ActiveWorkbook.Close False

 

Loop


Sheets("sheet7").Activate
Cells(1, 10).Resize(, 2) = Array("5|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c21|", "|fffd||fffd||fffd||fffd||fffd||fffd|")

Set rngall = Sheets("sheet8").Columns(1).SpecialCells(2)
Set rngData = Columns(1).SpecialCells(2)

For Each rngC In rngData
Set C = rngall.Find(rngC, lookat:=xlWhole)
If Not C Is Nothing Then
rngC.Offset(, 9) = C.Offset(, 2).Value
End If

Next rngC

For i = 2 To Columns(1).SpecialCells(2).Count
Cells(i, 11) = Cells(i, 10) / Cells(i, 3) - 1
Next i

ActiveSheet.UsedRange.Offset(1).Sort Cells(1, 11), 2
   Columns.AutoFit
        End Sub


Sub |fffd||170||fffd||fffd||fffd||fffd||fffd||fffd||fffd|4|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|()


Dim rngall As Range
Dim ccc As Range
Dim rngC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
   On Error Resume Next

   
   

      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If


     ThisWorkbook.Sheets("|fffd||170||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear
  

   Do While fileName <> ""


    

   Workbooks.Open (strPath & fileName)
   
   
   '|fffd||170||fffd||fffd||fffd||fffd||57f||fffd| |fffd||170||fffd||fffd||fffd||fffd||fffd| 15|fffd||fffd||fffd||33b||fffd||fffd||fffd||fffd||330||fffd| |fffd||fffd||fffd||fffd||fffd||474||fffd|
   '|fffd||fffd||fffd||fa||fffd||fffd||fffd| |fffd||170||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3ff||fffd| 4|fffd||fffd||fffd||333||fffd||fffd||fffd||fffd||fffd| |fffd||474||fffd|
   
   
   rowsCnt = Columns(1).SpecialCells(2).Count
   For i = rowsCnt To rowsCnt - 4 Step -1
   
   If Cells(i, 32) = "|fffd||170||fffd||fffd||fffd|" Then
   
   For ii = i - 1 To i - 9 Step -1
   If Cells(ii, 32) = "|fffd||170||fffd||fffd||fffd|" Then
   Exit For
   End If
   Next ii
   
   If i - ii = 10 Then
   ThisWorkbook.Sheets("|fffd||170||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2) = Cells(1, 1).Value
   ThisWorkbook.Sheets("|fffd||170||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3).Offset(, 1) = rowsCnt - i
   End If
   
   End If
   
   Next i
   
   
   
   
   
   
   
   fileName = Dir

 
ActiveWorkbook.Close False

 

Loop



        End Sub
Attribute VB_Name = "Module2"

      
      
        Sub |fffd||fffd||229||fffd||ff||fffd||fffd||fffd||fffd||fffd||fffd||f9||77b||fffd||fffd||33f||fffd||fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||7b5||fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range








    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  
  
  '|fffd||3f0||fffd||fffd||fffd||fffd||3f4||b9||fffd|
  
  '|fffd||fffd||fffd||fffd|10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||63c||fffd||fffd||5f3||fffd||fffd||fffd||fffd||fffd|
  '|fffd||5b4||fffd|71|fffd||fffd||fffd||23f||fffd||fffd||fffd| 2.5%|fffd||fffd||fffd||373||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||f3||fffd||fffd||fffd||3f0||fffd|
  '|fffd||5b4||fffd|71|fffd||fffd||fffd||23f||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||47a||fffd||fffd||f0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||7f8||fffd||fffd||3ff||fffd|
  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||175||fffd|
  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||23f||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||175||fffd|
  
  '=== |fffd||fffd||fffd||fffd||fffd||fffd||fffd|==
  'for|fffd||fffd||fffd||fffd| / |fffd||8fed||fffd||fffd| |fffd||fffd||fffd||ff||fffd| |fffd||fffd||fffd|
  '
  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           Header:=xlYes
    End With
  

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 15) = Array("|fffd||5b0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||2c23|", "|fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||370||fffd|", "|fffd||7f8||170||fffd|", "|fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||7f8||fffd||fffd||fffd|", _
"|fffd||7f8||fffd||23d||fffd||fffd|", "|fffd||175||fffd||fffd||f0||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||fffd||57c||fffd||fffd||377||fffd|")


For i = 1 To Rows(1).SpecialCells(2).Count

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2c23|" Then
|fffd||fffd||fffd||fffd||fffd||2c23| = i
End If


If Cells(1, i) = "|fffd||135||fffd|" Then
|fffd||135||fffd| = i
End If


If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||370||fffd|" Then
|fffd||fffd||fffd||370||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||170||fffd|" Then
|fffd||7f8||170||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||570||fffd|" Then
|fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||23d||fffd||fffd|" Then
|fffd||7f8||fffd||23d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||f0||fffd|" Then
|fffd||175||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If


Next i


rowsCnt = Columns(1).SpecialCells(2).Count

For i = 2 To rowsCnt

If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 100 Then
If Cells(i, 6) / Cells(i, 3) - 1 < -0.055 Then
If Cells(i, 8) < 0 Then

Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 6) / Cells(i, 3) - 1 '|fffd||fffd||fffd||fffd||fffd||fffd|
Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 1, 3) '|fffd||17c||fffd||fffd||fffd|
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 1.045 '|fffd||fffd||fffd||370||fffd|
Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 0.92 '|fffd||7f8||170||fffd|

b = 0
For r = 1 To 1500

If Cells(i + r, 4) > Cells(i, |fffd||fffd||fffd||370||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.0415
Exit For
End If


If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
If Cells(i + r, 5) < Cells(i, |fffd||7f8||170||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f8||170||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(i, |fffd||fffd||570||fffd|) = (Cells(i, |fffd||17c||fffd||fffd||fffd|) + Cells(i, |fffd||7f8||170||fffd|)) / 2 '|fffd||fffd||570||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||7f8||fffd||fffd||fffd|) = r
Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1
'Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 0.88
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 1.045
End If
End If

'If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
'If Cells(i + r, 5) < Cells(i, |fffd||7f8||170||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f8||170||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
'Cells(i, |fffd||fffd||570||fffd|) = (Cells(i, |fffd||fffd||570||fffd|) * 2 + Cells(i, |fffd||7f8||170||fffd|)) / 3 '|fffd||fffd||570||fffd| |1e5||fffd||fffd|
'Cells(i, |fffd||7f8||fffd||fffd||fffd|) = r
'Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 2
'Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 1.045
'End If
'End If




If Cells(i + r, 1) <> Cells(i + r - 1, 1) Then
b = b + 1
If b = 20 Then
Cells(i, |fffd||175||fffd||fffd||f0||fffd|) = b
Exit For
End If

End If


Next r

b = 0

If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = Cells(i + r, 3) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
End If


If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.0415 * 2
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
End If


'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 2 Then
'Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.0415 * 3
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
'End If


If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = (Cells(i + r, 3) / Cells(i, |fffd||fffd||570||fffd|) - 1.0033) * 2
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
End If

'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 2 Then
'Cells(i, |fffd||175||fffd||fffd||fffd|) = (Cells(i + r, 3) / Cells(i, |fffd||fffd||570||fffd|) - 1.0033) * 3
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
'End If



ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 7).End(3) = Cells(1, 1).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

End If
End If
End If

Next i


   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
 Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"

  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           key3:=.Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), order3:=1, _
           Header:=xlYes
    End With
  


        End Sub
        
      
                Sub dfaddds()
        
        

        
        For i = 1 To Rows(1).SpecialCells(2).Count


If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||370||fffd|" Then
|fffd||fffd||fffd||370||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||170||fffd|" Then
|fffd||7f8||170||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||570||fffd|" Then
|fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||23d||fffd||fffd|" Then
|fffd||7f8||fffd||23d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If


If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If


If Cells(1, i) = "|fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If


If Cells(1, i) = "50" Then
|fffd||fffd| = i
End If


Next i

Cells(2, |fffd||fffd||fffd||377||fffd|).Resize(1000, 3).Clear
r = 0

        
For i = 2 To Columns(1).SpecialCells(2).Count

'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = 0.035
'End If

'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = 0.05
'End If

'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 2 Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = 0.1
'End If

        
'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i, |fffd||175||fffd||fffd||fffd|) - 0.0033
'End If
               
'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = (Cells(i, |fffd||175||fffd||fffd||fffd|) - 0.0033) * 2
'End If
                               
'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 2 Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = (Cells(i, |fffd||175||fffd||fffd||fffd|) - 0.0033) * 3
'End If
                               
'If Cells(i, |fffd||175||fffd||fffd||fffd|) = -0.0466 Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i, |fffd||175||fffd||fffd||fffd|)
'End If
                                          
'If Cells(i, |fffd||175||fffd||fffd||fffd|) <> -0.0466 And Cells(i, |fffd||175||fffd||fffd||fffd|) <> "" Then
'Cells(i, |fffd||fffd||fffd||377||fffd|) = (Cells(i, |fffd||175||fffd||fffd||fffd|) - 0.0033) * 2
'End If
                                                     
 Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i, |fffd||175||fffd||fffd||fffd|)
                               
Next i

For i = 2 To Columns(1).SpecialCells(2).Count
r = r + 1
If Cells(i, 1) <> Cells(i + 1, 1) Then
Cells(i, |fffd||fffd||57c||fffd||fffd||377||fffd|) = Application.Average(Cells(i - r + 1, |fffd||fffd||fffd||377||fffd|).Resize(r))
r = 0
End If

Next i
        
        
For i = 2 To Columns(1).SpecialCells(2).Count
Cells(i, |fffd||fffd|) = Cells(i - 1, |fffd||fffd|) * (1 + Cells(i, |fffd||fffd||57c||fffd||fffd||377||fffd|))
Next i

        
        End Sub
        
        
        
        Sub fdaf()
        
                Sheets("sheet2").UsedRange.Offset(1).Clear
        
        rowsCnt = Columns(1).SpecialCells(2).Count

        For i = 2 To rowsCnt
        If Cells(i, 2) <> Cells(i + 1, 2) Then
        Sheets("sheet2").Cells(Rows.Count, 1).End(3)(2).Resize(, 50) = Cells(i + 1, 1).Resize(, 50).Value
        End If
        
        Next i
        
                Sheets("sheet2").Activate
        
        
        End Sub
        
        
        
          Sub |fffd||fffd||229||fffd||ff||fffd||fffd||fffd||fffd||fffd||fffd||f9||77b||fffd||fffd||33f||fffd||fffd||7b5||fffd|a|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||7b5||fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  
  

ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2) = Cells(1, Columns.Count).End(1).Column
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3).Next = Cells(1, 1).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop



        End Sub
        
Attribute VB_Name = "Module3"
Declare Function URLDownloadToFile Lib "urlmon" Alias _
    "URLDownloadToFileA" (ByVal pCaller As Long, _
    ByVal szURL As String, _
    ByVal szFileName As String, _
    ByVal dwReserved As Long, _
    ByVal lpfnCB As Long) As Long

Function DownloadFile(URL As String, LocalFileName As String) As Boolean
    Dim lngRetVal      As Long
    lngRetVal = URLDownloadToFile(0, URL, LocalFileName, 0, 0)
    If lngRetVal = 0 Then DownloadFile = True
End Function

Sub DownloadFiles()
    Dim sURL            As String
    Dim LocalFileName   As String
    Dim fileName        As String
    Dim newName   As String
    Dim rng             As Range
    Dim sh              As Worksheet
    Dim UNC             As String
    
    Set sh = Worksheets("|fffd||67f||fffd||3b5||fffd|")
    UNC = sh.Range("b1")
    
    For Each rng In sh.Range(sh.Range("A3"), sh.Range("A65000").End(xlUp))
        newName = rng.Offset(0, 1)
        fileName = rng.Offset(0, 2)
        sURL = rng & newName & fileName
        LocalFileName = UNC & fileName
    
        rng.Offset(0, 3) = DownloadFile(sURL, LocalFileName)
    Next
    
 Call |fffd||431||fffd||fffd||fffd||fffd|update
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||37e||fffd||fffd||b3||fffd||fffd||fffd||7f8||fffd||fffd||fffd|()

Dim varTemp()
Dim vartemp1()

Application.ScreenUpdating = False

On Error Resume Next


Sheets("url").Activate

ActiveSheet.UsedRange.Offset(1).Clear

'head |fffd||fffd||fffd||fffd||3f1||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If

Next i


Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i - 1, 1) <> Cells(i, 1) Then

For ii = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, ii) = "2016|fffd||fffd|1|fffd||431||fffd|" Then
Exit For
End If


If InStr(Cells(i, ii), "|fffd||431||fffd|") Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
varTemp(r) = Cells(i, ii)
vartemp1(r) = Cells(i, 1)
End If

Next ii

With Sheets("url")

For ii = 1 To UBound(varTemp, 1)
.Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3)(2) = vartemp1(ii)
.Cells(Rows.Count, |fffd||431||fffd||fffd||fffd||121|).End(3)(2) = varTemp(ii)
Next ii

r = 0

Erase varTemp
Erase vartemp1

End With

End If

Next i



End Sub


Sub |fffd||7fa||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Application.ScreenUpdating = False
On Error Resume Next

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 1), key2:=Cells(2, 2), key2:=Cells(2, 3), order1:=xlAscending, order2:=xlAscending, order3:=xlAscending

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i - 1, 1) = Cells(i, 1) Then
If Cells(i - 1, 2) = Cells(i, 2) Then
If Cells(i - 1, 3) = Cells(i, 3) Then

Rows(i).Clear

End If
End If
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 1), key2:=Cells(2, 2), key2:=Cells(2, 3), order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


End Sub
Sub |fffd||fffd||fffd||fffd||fffd||6b5||5fe1||fffd||f0||fffd||fffd||47e||5fe||fffd||fffd||fffd||fffd||fffd||1ae|()

Dim C As Range

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||4fd||fffd|").Activate

With Application.FileDialog(msoFileDialogFolderPicker)
strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\|fffd||fffd||fffd||7b8||178||fffd|\|fffd||fffd||1ae||fffd||43c||fffd|\"
End With

fileName = "|fffd||6bd||fffd||fffd||fffd|.csv"
fileName1 = "|fffd||6bd||fffd||fffd||fffd|.csv"

Sheets("|fffd||4fd||fffd|").Cells.Delete
Workbooks.Open (strPath & fileName)
ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1)
Workbooks(fileName).Close False

Workbooks.Open (strPath & fileName1)
ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2)
Workbooks(fileName1).Close False

Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
rowsCnt = Cells(Rows.Count, 1).End(3).Row

Cells(2, 4).Resize(rowsCnt).Clear

With Sheets("|fffd||4fd||fffd|")
For i = 2 To rowsCnt

Set C = .Columns(3).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then
Cells(i, 4) = C.Offset(, 7).Value / 100
End If

Next i
End With

Set C = Nothing

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4)

Columns(4).NumberFormatLocal = "#,###"


End Sub
Sub |fffd||4fd||f7||3b9||fffd||fffd||7c21||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Application.ScreenUpdating = False
On Error Resume Next


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim strPath1 As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim fileName1 As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|







'With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

'.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

'If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

 '           Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

  '    Else


   '         strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    '    End If


    'End With

   'fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    
    
   'If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    '    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

     '   Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   'End If


'|fffd||4fd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd||fffd||3f0||fffd| |fffd||fffd||fc| |fffd||fffd||fffd||fffd||fffd| head |fffd||5b1||fffd|
Sheets("url").Activate
ActiveSheet.UsedRange.Offset(1).Clear

Sheets("|fffd||7e6b||fffd||5bc||fffd|").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 2) = Array("|fffd||5bc||fffd|", "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|")


'|fffd||fffd||fffd||7c21| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||4fd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

'Do While fileName <> ""

'Workbooks.Open (strPath & fileName)
Sheets("|fffd||4fd||fffd|").Activate
Cells(1, 1).Resize(Cells(Rows.Count, 1).End(3).Row).Copy ThisWorkbook.Sheets("|fffd||7e6b||fffd||5bc||fffd|").Cells(Rows.Count, 1).End(3)(2)


'Workbooks(fileName).Close False

    
'fileName = Dir
'Loop



'|fffd||4fd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd|
Sheets("|fffd||7e6b||fffd||5bc||fffd|").Activate


'|fffd||5bc||4b0||fffd| |fffd||1b4||3f8||fffd|(|fffd||fffd||fffd||6bc||fffd||fffd||fffd| 50|fffd||fffd| |fffd||fffd||fffd||fffd|) |fffd||5bc||fffd||e2| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

r = 0

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) <> "" And Len(Cells(i, 1)) <= 6 And Len(Cells(i + 1, 1)) > 70 And Cells(i + 1, 2) = "" Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(2)
End If

Next i


If r > 0 Then
ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(Rows.Count, 1).End(3)(2).Resize(2) = varTemp(i)
Next i

Erase varTemp
r = 0

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Len(Cells(i, 1)) > 70 And Cells(i, 2) = "" Then
Cells(i, 2) = Cells(i - 1, 1).Value
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 10)
End If

Next i


ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(Rows.Count, 1).End(3)(2).Resize(, 10) = varTemp(i)
Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, 1) = Cells(i - 1, 1) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlDescending

Erase varTemp
r = 0

For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, 2) = Cells(i - 1, 2) Then
If Mid(Cells(i, 1), 55, 2) = Mid(Cells(i - 1, 1), 55, 2) Then

Cells(i, 3) = 1
End If
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlDescending

End If



'main|fffd||fffd| excel|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fc|
Cells.Replace What:="main", Replacement:="excel", lookat:=xlPart

'url |fffd||fffd||1ae||fffd||fffd| |fffd||5bc||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||fffd||fffd||fffd|
Cells(2, 1).Resize(Cells(Rows.Count, 1).End(3).Row, 2).Copy Sheets("url").Cells(Rows.Count, 1).End(3)(2)


'url |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("url").Activate



'head |fffd||fffd||fffd||fffd||3f1||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||5bc||fffd|" Then
|fffd||5bc||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7cef||a5|" Then
|fffd||fffd||fffd||7cef||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "|fffd||5bd||13c||fffd|" Then
|fffd||5bd||13c||fffd| = i
End If

If Cells(1, i) = "|fffd||6ba||fffd||fffd||470||fffd|" Then
|fffd||6ba||fffd||fffd||470||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "BPS" Then
bps = i
End If


Next i


'|fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||fffd||fffd||7cef||a5||fffd||fffd| |fffd||63d||fffd||1ae||fffd||fffd| |fffd||3bd||fffd|
Columns(|fffd||fffd||fffd||fffd||fffd||6b5||fffd|).NumberFormatLocal = "@"
Columns(|fffd||fffd||fffd||7cef||a5|).NumberFormatLocal = "@"
Columns(|fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "@"


'|fffd||fffd||fffd||7cef||a5| update, |fffd||fffd||fffd||fffd||fffd||6b5||fffd| update
For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||fffd||fffd||7cef||a5|) = Mid(Cells(i, |fffd||5bc||fffd|), 52, 8)

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 2 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "0000" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 3 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "000" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 4 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "00" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 5 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "0" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

Next i


'|fffd||fffd||fffd||fffd||fffd| |e3||fffd||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Columns(1).Find(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then
Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Cells(C.Row, 2).Value

Else

Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)

End If

Next i

Set C = Nothing


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5bc||fffd|)


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1

If Cells(i, |fffd||5bc||fffd|) = Cells(i - 1, |fffd||5bc||fffd|) Then

Rows(i).Clear

End If

Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5bc||fffd|)
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)


'|fffd||67f||fffd||3b5||fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("|fffd||67f||fffd||3b5||fffd|").Activate
ActiveSheet.UsedRange.Offset(2).Clear 'head |fffd||fffd||fffd||733||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'url |fffd||fffd||1ae||fffd||fffd||fffd||fffd| |fffd||2bf||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| copy|fffd||3f1||fffd|

With Sheets("url")
Cells(3, 1).Resize(.Cells(Rows.Count, 1).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row) = .Cells(.Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)(2).Row, |fffd||5bc||fffd|).Resize(.Cells(Rows.Count, |fffd||5bc||fffd|).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row).Value
Cells(3, 2).Resize(.Cells(Rows.Count, 1).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row) = "&lang=ko&"
Cells(3, 3).Resize(.Cells(Rows.Count, 1).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row) = .Cells(.Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)(2).Row, |fffd||fffd||fffd||fffd||fffd|).Resize(.Cells(Rows.Count, |fffd||5bc||fffd|).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row).Value
Cells(3, 5).Resize(.Cells(Rows.Count, 1).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row) = .Cells(.Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)(2).Row, |fffd||fffd||fffd||7cef||a5|).Resize(.Cells(Rows.Count, |fffd||5bc||fffd|).End(3).Row - .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row).Value

End With



'|fffd||fffd||fffd||3f8||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For i = 3 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 3) <> "" Then
Cells(i, 3) = Cells(i, 3) & "_" & Cells(i, 5) & ".xls"
End If

Next i



'|fffd||4fd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||7e6b||fffd||fffd||1e5| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b4||fffd| |fffd||fffd||fffd||3f8||fffd||fffd||fffd| |fffd||67f||fffd||3b5||5fed||fffd||fffd| |fffd||338||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

  strPath = ThisWorkbook.Sheets("|fffd||67f||fffd||3b5||fffd|").Cells(1, 2)
  
  
    fileName = Dir(strPath & "*.xls*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

      
  
Do While fileName <> ""

Cells(Rows.Count, 1).End(3)(2) = Split(fileName, ".")(0)


fileName = Dir
Loop

Cells(2, 1).Resize(Cells(Rows.Count, 1).End(3).Row).Copy Sheets("|fffd||67f||fffd||3b5||fffd|").Cells(Rows.Count, 3).End(3)(2)



Sheets("|fffd||67f||fffd||3b5||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(1, 3)


Columns(3).Replace ".xls", "", xlPart

For i = Cells(Rows.Count, 3).End(3).Row To 3 Step -1
If Cells(i - 1, 3) = Cells(i, 3) Then
Rows(i - 1).Clear
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(1, 3)


For i = 3 To Cells(Rows.Count, 3).End(3).Row
Cells(i, 3) = Cells(i, 3) & ".xls"

If Cells(i, 1) = "" Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(1, 3)

Call DownloadFiles

End Sub

       


Sub |fffd||431||fffd||fffd||fffd||fffd|update()
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
On Error Resume Next
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
  
  strPath = ThisWorkbook.Sheets("|fffd||67f||fffd||3b5||fffd|").Cells(1, 2)
 
    End With
 
'|fffd||fffd||fffd||fffd| head |fffd||5b1||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
'head |22e||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "2017|fffd||fffd|2|fffd||431||fffd|" Then
|fffd||33a||431||fffd| = i
End If
 
Next i
 
 
'url |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("url").Activate
ActiveSheet.UsedRange.Offset(1).Clear



'head |22e||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7cef||a5|" Then
|fffd||fffd||fffd||7cef||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "|fffd||5bd||13c||fffd|" Then
|fffd||5bd||13c||fffd| = i
End If
 
If Cells(1, i) = "|fffd||6ba||fffd||fffd||470||fffd|" Then
|fffd||6ba||fffd||fffd||470||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "BPS" Then
bps = i
End If
 
 
Next i
 


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||7e6b||fffd||fffd||1e5||fffd||67f||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||338||fffd| |1e5||fffd||fffd||fffd||3f0||fffd| |fffd||5f0||fffd| url |fffd||fffd||1ae| |fffd||63f||fffd| |fffd||67f||fffd| |fffd||5b1||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

 
fileName = Dir(strPath & "*.xls*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
     
  
Do While fileName <> ""

Cells(Rows.Count, 1).End(3)(2) = fileName


fileName = Dir
Loop

Cells(2, 1).Resize(Cells(Rows.Count, 1).End(3).Row).Copy Sheets("url").Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3)(2)

Sheets("url").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd||fffd|)

For i = 2 To Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3).Row
Cells(i, |fffd||fffd||fffd||7cef||a5|) = Split(Split(Cells(i, |fffd||fffd||fffd||fffd||fffd|), "_")(1), ".")(0)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = Left(Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "/" & Mid(Cells(i, |fffd||fffd||fffd||7cef||a5|), 5, 2) & "/" & Right(Cells(i, |fffd||fffd||fffd||7cef||a5|), 2)
Next i

Columns(|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"

 
With ThisWorkbook.Sheets("url")
 
For i = 2 To Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3).Row
 
fileName = Cells(i, |fffd||fffd||fffd||fffd||fffd|)

Workbooks.Open (strPath & fileName)
      
 
.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Split(Cells.Find("|fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlPart), ": ")(1)
 
 
If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||431||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "|fffd||fffd|" & Left(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), 3)
End If
 
If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||771||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "|fffd||fffd|2|fffd||431||fffd|"
End If
 
If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||fffd||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) - 1 & "|fffd||fffd|4|fffd||431||fffd|"
End If
 
 
'url |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
 
'Columns(bps + 1).NumberFormatLocal = "@"
'Columns(bps + 2).NumberFormatLocal = "@"
 
'For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
'Cells(i, bps + 1) = Left(Cells(i, |fffd||fffd||fffd||7cef||a5|), 6)
'Cells(i, bps + 2) = Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) & Cells(i, bps + 1)
 
'Cells(i, |fffd||5bd||13c||fffd|) = Sheets("|fffd||5bd||13c||fffd|").Columns(5).Find(Cells(i, bps + 2), lookat:=xlWhole).Offset(, -2).Value
'Cells(i, |fffd||5bd||13c||fffd|) = Cells(i, |fffd||5bd||13c||fffd|) / 100000000
 
'Next i
 
'Columns(bps + 1).Clear
'Columns(bps + 2).Clear
 
 
 
 
 
 
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| data |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
      
For a = 2 To 100 '|fffd||fffd||1ae||fffd||fffd||fffd||fffd|
 
 
If InStr(Sheets(a).Name, "|fffd||7e6b|") Or InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then '|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||7e6b||fffd||fffd||fffd| |fffd||73e||ec21| |fffd||fffd||ec21||fffd||fffd|
 
'|fffd||6ba||fffd||fffd||470||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Sheets(a).Activate
 
If Not Range("a1:z500").Find("|fffd||9e38||fffd||fffd|", lookat:=xlPart) Is Nothing Then
.Cells(i, bps + 1) = "1"
End If
 
If Not Range("a1:z500").Find("|f5||fffd||fffd|", lookat:=xlPart) Is Nothing Then
.Cells(i, bps + 1) = "2"
End If

If Not Range("a1:z500").Find("USD", lookat:=xlPart) Is Nothing Then
.Cells(i, bps + 1) = "3"
End If
 

For b = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(b, 1) = Replace(Cells(b, 1), "(1)", "")
Cells(b, 1) = Replace(Cells(b, 1), "1)", "")
Cells(b, 1) = Split(Cells(b, 1), "(")(0)
Cells(b, 1) = Split(Cells(b, 1), ".")(1)
Cells(b, 1) = Replace(Cells(b, 1), "|fffd||fffd|", "")
Cells(b, 1) = Replace(Cells(b, 1), "V", "")
Cells(b, 1) = Replace(Cells(b, 1), "|fffd||fffd|", "")
Cells(b, 1) = Replace(Cells(b, 1), "|fffd||fffd|", "")
Cells(b, 1) = Replace(Cells(b, 1), " ", "")
Cells(b, 1) = Trim(Cells(b, 1))
Cells(b, 2) = Replace(Cells(b, 2), " ", "")
Cells(b, 2) = Trim(Cells(b, 2))
Next b
 
For b = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(b, 2) = "" Or Cells(b, 2) = 0 Or Cells(b, 2) = " " Then
Cells(b, 2).Resize(, 4) = Cells(b + 1, 2).Resize(, 4).Value
End If

Next b
  


 
'|fffd||6ba||fffd||fffd||470||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
If InStr(Sheets(a).Name, "|fffd||7e6b|") Then
pp = 1
uu = 2
End If
 
If InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then
pp = 3
uu = 6
End If
 
For dd = pp To uu
 
 
 
 
For Aa = 2 To ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Rows.Count, dd).End(3).Row
 
Set C = ActiveSheet.UsedRange.Find(ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Aa, dd), lookat:=xlWhole)
 
If Not C Is Nothing Then
If Cells(C.Row, 2) <> "" Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) / 100000000
 
If .Cells(i, bps + 1) = 1 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000000 / 100000000
End If
 
If .Cells(i, bps + 1) = 2 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000 / 100000000
End If

If .Cells(i, bps + 1) = 3 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000 / 100000000
End If
 
If dd = 6 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2).Value
End If
 
Exit For
 
End If
End If
 
Next Aa
 
 
 
 
Next dd



'If .Cells(i, |fffd||fffd||fffd||fffd||fffd|) = "" Or .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Or .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then

'For ppp = 1 To 3

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd|) = "" Then
'dd = 3
'End If

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'dd = 4
'End If

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'dd = 5
'End If

'For Aa = 2 To ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Rows.Count, dd).End(3).Row
 
'Set C = ActiveSheet.Columns(1).Find(ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Aa, dd), lookat:=xlPart)
 
'If Not C Is Nothing Then
 
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) / 100000000
 
'If .Cells(i, bps + 1) = 1 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000000 / 100000000
'End If
 
'If .Cells(i, bps + 1) = 2 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000 / 100000000
'End If
 
'If .Cells(i, bps + 1) = 3 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000 / 100000000
'End If
  
  
'Exit For
 
'End If
 
 
'Next Aa
 
'Next ppp

'End If



 
'With ThisWorkbook.Sheets("url")
'If InStr(Sheets(a).Name, "|fffd||7e6b|") Then
'If .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = "" Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = Columns(1).SpecialCells(2).Find("|fffd||6ba||fffd||fffd||470||fffd|", lookat:=xlWhole).Offset(, 1) / 100000000
 
'If .Cells(i, bps + 1) = 1 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) * 1000000
'End If
 
'If .Cells(i, bps + 1) = 2 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) * 1000
'End If
 
'End If
'End If
'End With
 
 
End If
            
If InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then
Exit For
End If
 
Next a
 
 
Workbooks(fileName).Close False
 
 
 
 
Next i
 
 
 
For ii = 2 To .Cells(Rows.Count, 1).End(3).Row
 
If .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
.Rows(ii).Clear
End If
 
Next ii

End With
 
 
ThisWorkbook.Sheets("url").Activate

Range(Cells(2, |fffd||fffd||fffd||fffd||fffd|), Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)).NumberFormatLocal = "#,###"

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd||fffd|)


For i = 2 To Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3).Row
Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Split(Cells(i, |fffd||fffd||fffd||fffd||fffd|), "_")(0)
Next i




Sheets("|fffd||fffd||fffd||fffd|").Activate
 
With Sheets("url")
 
For i = 2 To .Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3).Row
 
Set C = Columns(1).Find(.Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)
 
For ii = Cells(1, Columns.Count).End(1).Column To 2 Step -1
If .Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Cells(1, ii) Then

If Cells(C.Row, ii) = "2017|fffd||fffd|2|fffd||431||fffd|" Then
Cells(C.Row, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Value
End If

Cells(C.Row + 1, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd|).Value
Cells(C.Row + 2, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
Cells(C.Row + 3, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
Cells(C.Row + 4, ii) = (Cells(C.Row + 2, ii) / Cells(C.Row + 1, ii)) * 100
Cells(C.Row + 5, ii) = (Cells(C.Row + 3, ii) / Cells(C.Row + 1, ii)) * 100
Cells(C.Row + 10, ii) = .Cells(i, |fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|).Value
Cells(C.Row + 1, ii).Resize(11).NumberFormatLocal = "#,###"
Cells(C.Row + 4, ii).Resize(2).NumberFormatLocal = "#,###.00"

Exit For
End If
 
Next ii
 
 
Next i
 
End With
 
Set C = Nothing
 
 
 
End Sub
 
Sub |fffd||7e6b||fffd||338||fffd||fffd||fffd||fffd||b3||fffd||fffd||43c||fffd||fffd||3f1||fffd|()
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
On Error Resume Next
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
  
  strPath = ThisWorkbook.Sheets("|fffd||67f||fffd||3b5||fffd|").Cells(1, 2)
 
    End With
    
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear
 
 
Sheets("url").Activate
 
 
'head |22e||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7cef||a5|" Then
|fffd||fffd||fffd||7cef||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "|fffd||5bd||13c||fffd|" Then
|fffd||5bd||13c||fffd| = i
End If
 
If Cells(1, i) = "|fffd||6ba||fffd||fffd||470||fffd|" Then
|fffd||6ba||fffd||fffd||470||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "BPS" Then
bps = i
End If
 
 
Next i
 
 
Columns(|fffd||fffd||fffd||7cef||a5|).NumberFormatLocal = "@"
 
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |22e||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||6ba||fffd||fffd||470||fffd|)

With ThisWorkbook.Sheets("url")
 
For i = 2 To Cells(Rows.Count, 3).End(3).Row

If Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = "" Then
 
fileName = Cells(i, |fffd||fffd||fffd||fffd||fffd|)
    
Workbooks.Open (strPath & fileName)
      
      
For a = 2 To 100 '|fffd||fffd||1ae||fffd||fffd||fffd||fffd|
 
 
'If InStr(Sheets(a).Name, "|fffd||7e6b|") Or InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then '|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||7e6b||fffd||fffd||fffd| |fffd||73e||ec21| |fffd||fffd||ec21||fffd||fffd|
If InStr(Sheets(a).Name, "|fffd||7e6b|") Then '|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||7e6b||fffd||fffd||fffd| |fffd||73e||ec21| |fffd||fffd||ec21||fffd||fffd|



'|fffd||6ba||fffd||fffd||470||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Sheets(a).Activate
 
  
For b = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(b, 1) = Replace(Cells(b, 1), "(1)", "")
Cells(b, 1) = Split(Cells(b, 1), "(")(0)
Cells(b, 1) = Split(Cells(b, 1), ".")(1)
Cells(b, 1) = Replace(Cells(b, 1), "|fffd||fffd|", "")
Cells(b, 1) = Replace(Cells(b, 1), "V", "")
Cells(b, 1) = Replace(Cells(b, 1), "|fffd||fffd|", "")
Cells(b, 1) = Replace(Cells(b, 1), "|fffd||fffd|", "")
Cells(b, 1) = Replace(Cells(b, 1), " ", "")
Cells(b, 1) = Trim(Cells(b, 1))
Cells(b, 2) = Replace(Cells(b, 2), " ", "")
Cells(b, 2) = Trim(Cells(b, 2))
Next b
 
For b = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(b, 2) = "" Or Cells(b, 2) = 0 Or Cells(b, 2) = " " Then
Cells(b, 2).Resize(, 4) = Cells(b + 1, 2).Resize(, 4).Value
End If

Next b
  
If InStr(Sheets(a).Name, "|fffd||7e6b|") Then
pp = 1
uu = 2
End If
 
If InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then
pp = 3
uu = 6
End If


For dd = pp To uu

For Aa = 2 To ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Rows.Count, dd).End(3).Row
 
Set C = ActiveSheet.Columns(1).Find(ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Aa, dd), lookat:=xlWhole)
 
If Not C Is Nothing Then
 
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) / 100000000

If .Cells(i, bps + 1) = 1 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000000 / 100000000
End If
 
If .Cells(i, bps + 1) = 2 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000 / 100000000
End If
 
 
Exit For
 
End If
 
Next Aa

Next dd
 

'For ppp = 1 To 2
'If .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = "" Or .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then

'If .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = "" Then
'dd = 1
'End If

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'dd = 2
'End If

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'dd = 4
'End If

'For Aa = 2 To ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Rows.Count, dd).End(3).Row
 
'Set C = ActiveSheet.Columns(1).Find(ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Aa, dd), lookat:=xlPart)
 
'If Not C Is Nothing Then
 
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) / 100000000
 
'If .Cells(i, bps + 1) = 1 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000000 / 100000000
'End If
 
'If .Cells(i, bps + 1) = 2 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(C.Row, 2) * 1000 / 100000000
'End If
 
'Exit For
 
'End If
 
 
'Next Aa
 
 
'End If

'Next ppp
 
 
 
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(300, 100) = ActiveSheet.Cells(1, 1).Resize(300, 100).Value
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2) = fileName
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3).Interior.Color = 60544

If .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = "" Then
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3).Interior.Color = 255
End If

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3).Interior.Color = 255
'End If

'If .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
'ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3).Interior.Color = 255
'End If
 

 End If

 
If InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then
Exit For
End If
 
Next a
 
 
Workbooks(fileName).Close False
 
  
End If

Next i
 
 
 
End With
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||6ba||fffd||fffd||470||fffd|)
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
 
End Sub

Sub fjdlakfjklafjkalfjalfjalk()
 
 
Set C = Columns(2).Find("|fffd||fffd||fffd||fffd|", lookat:=xlPart)
 
If Not C Is Nothing Then
 
strAddr = C.Address
 
Do
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(C.Row + 1, C.Column - 1)
 
Set C = Columns(2).FindNext(C)
 
Loop While Not C Is Nothing And C.Address <> strAddr
 
End If
 
 
ActiveSheet.UsedRange.Clear
 
For i = 1 To UBound(varTemp, 1)
Cells(Rows.Count, 1).End(3)(2) = varTemp(i)
Next i
 
r = 0
Erase varTemp
 
 
ActiveSheet.UsedRange.Sort key1:=Cells(1, 1)
 
For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
 
If Cells(i, 1) = Cells(i - 1, 1) Then
Rows(i).Clear
End If
 
Next i
 
ActiveSheet.UsedRange.Sort key1:=Cells(1, 1)
 
End Sub
 
 Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Application.ScreenUpdating = False
On Error Resume Next

For i = 1 To Cells(1, Columns.Count).End(1).Column
Range(Cells(2, i), Cells(Rows.Count, i).End(3)).Sort key1:=Cells(1, i)

For ii = Cells(Rows.Count, i).End(3).Row To 2 Step -1
If Cells(ii, i) = Cells(ii - 1, i) Then
Cells(ii, i).Clear
End If
Next ii

Range(Cells(2, i), Cells(Rows.Count, i).End(3)).Sort key1:=Cells(1, i)

Next i



End Sub

Sub |fffd||fffd||fffd||6b0||fffd||fffd||6be||fffd||fffd||fffd|()

Application.ScreenUpdating = False
On Error Resume Next

For i = 50 To 3 Step -1

If Cells(i, 1) = Cells(i - 1, 1) Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)


End Sub

Sub |fffd||431||fffd||fffd||fffd||fffd|update_|fffd||f9||137||fffd||fffd||33c||fffd|()

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String


On Error Resume Next




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

  
  strPath = ThisWorkbook.Sheets("|fffd||67f||fffd||3b5||fffd|").Cells(1, 2)

    End With



'url |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("url").Activate

'head |22e||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7cef||a5|" Then
|fffd||fffd||fffd||7cef||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "|fffd||5bd||13c||fffd|" Then
|fffd||5bd||13c||fffd| = i
End If

If Cells(1, i) = "|fffd||6ba||fffd||fffd||470||fffd|" Then
|fffd||6ba||fffd||fffd||470||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "BPS" Then
bps = i
End If


Next i


Columns(|fffd||fffd||fffd||7cef||a5|).NumberFormatLocal = "@"

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |22e||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd||fffd|)


With ThisWorkbook.Sheets("url")

For i = Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3).Row To .Cells(Rows.Count, 1).End(3).Row

fileName = .Cells(i, |fffd||fffd||fffd||fffd||fffd|) & "_" & .Cells(i, |fffd||fffd||fffd||7cef||a5|) & ".xls"
    
Workbooks.Open (strPath & fileName)
      

.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Split(Cells.Find("|fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlPart), ": ")(1)


If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||431||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "|fffd||fffd|" & Left(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), 3)
End If

If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||771||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "|fffd||fffd|2|fffd||431||fffd|"
End If

If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||fffd||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) - 1 & "|fffd||fffd|4|fffd||431||fffd|"
End If


'url |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
 
'Columns(bps + 1).NumberFormatLocal = "@"
'Columns(bps + 2).NumberFormatLocal = "@"
 
'For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
'Cells(i, bps + 1) = Left(Cells(i, |fffd||fffd||fffd||7cef||a5|), 6)
'Cells(i, bps + 2) = Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) & Cells(i, bps + 1)
 
'Cells(i, |fffd||5bd||13c||fffd|) = Sheets("|fffd||5bd||13c||fffd|").Columns(5).Find(Cells(i, bps + 2), lookat:=xlWhole).Offset(, -2).Value
'Cells(i, |fffd||5bd||13c||fffd|) = Cells(i, |fffd||5bd||13c||fffd|) / 100000000

'Next i
 
'Columns(bps + 1).Clear
'Columns(bps + 2).Clear






'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| data |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

      
For a = 2 To 100 '|fffd||fffd||1ae||fffd||fffd||fffd||fffd|


If InStr(Sheets(a).Name, "|fffd||7e6b|") Or InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then '|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||7e6b||fffd||fffd||fffd| |fffd||73e||ec21| |fffd||fffd||ec21||fffd||fffd|

'|fffd||6ba||fffd||fffd||470||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Sheets(a).Activate

If Not Range("a1:z500").Find("|fffd||9e38||fffd||fffd|", lookat:=xlPart) Is Nothing Then
.Cells(i, bps + 1) = "1"
End If

If Not Range("a1:z500").Find("|f5||fffd||fffd|", lookat:=xlPart) Is Nothing Then
.Cells(i, bps + 1) = "2"
End If



For b = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(b, 1) = Replace(Cells(b, 1), "(1)", "")
Cells(b, 1) = Split(Cells(b, 1), ".")(1)
Cells(b, 1) = Split(Cells(b, 1), "(")(0)
Cells(b, 1) = Trim(Cells(b, 1))
Cells(b, 1) = Replace(Cells(b, 1), " ", "")
If Cells(b, 2) = " " Or Cells(b, 2) = "" Then
Rows(b).Clear
End If
Next b

'|fffd||6ba||fffd||fffd||470||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

If InStr(Sheets(a).Name, "|fffd||7e6b|") Then
pp = 1
uu = 1
End If

If InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then
pp = 2
uu = 5
End If

For dd = pp To uu



For Aa = 2 To ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Rows.Count, dd).End(3).Row

For Bb = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(Bb, 1) = ThisWorkbook.Sheets("|fffd||7e6b||fffd||338||fffd|").Cells(Aa, dd) Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(Bb, 2) / 100000000

If .Cells(i, bps + 1) = 1 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(Bb, 2) * 1000000 / 100000000
End If

If .Cells(i, bps + 1) = 2 Then
.Cells(i, |fffd||6ba||fffd||fffd||470||fffd| + dd - 1) = Cells(Bb, 2) * 1000 / 100000000
End If

Exit For

End If

Next Bb

Next Aa




Next dd

'With ThisWorkbook.Sheets("url")
'If InStr(Sheets(a).Name, "|fffd||7e6b|") Then
'If .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = "" Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = Columns(1).SpecialCells(2).Find("|fffd||6ba||fffd||fffd||470||fffd|", lookat:=xlWhole).Offset(, 1) / 100000000

'If .Cells(i, bps + 1) = 1 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) * 1000000
'End If

'If .Cells(i, bps + 1) = 2 Then
'.Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) = .Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) * 1000
'End If

'End If
'End If
'End With


End If
            
If InStr(Sheets(a).Name, "|fffd||fffd||fffd||fffd|") Then
Exit For
End If

Next a


Workbooks(fileName).Close False




Next i



For ii = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
.Rows(ii).Clear
End If

Next ii


.UsedRange.Offset(1).Sort key1:=.Cells(1, |fffd||fffd||fffd||fffd||fffd|), key2:=.Cells(1, |fffd||fffd||fffd||7cef||a5|)






End With


ThisWorkbook.Sheets("url").Activate

'Columns(bps + 1).Clear
Columns(|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"

'With Sheets("|fffd||fffd||fffd||fffd|")

For i = 2 To Cells(Rows.Count, 1).End(3).Row


'Cells(i, bps) = Cells(i, |fffd||6ba||fffd||fffd||470||fffd|) / Cells(i, |fffd||5bd||13c||fffd|)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = Left(Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "/" & Mid(Cells(i, |fffd||fffd||fffd||7cef||a5|), 5, 2) & "/" & Right(Cells(i, |fffd||fffd||fffd||7cef||a5|), 2)

'Set C = .Rows(1).Find(Cells(i, |fffd||431||fffd||fffd||fffd||121|), lookat:=xlWhole)
'Set CC = .Columns(1).Find(Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

'.Cells(CC.Row, C.Column) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Value
'.Cells(CC.Row + 1, C.Column) = Cells(i, |fffd||fffd||fffd||fffd||fffd|).Value
'.Cells(CC.Row + 2, C.Column) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
'.Cells(CC.Row + 3, C.Column) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
'.Cells(CC.Row + 10, C.Column) = Cells(i, |fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|) * 100000000
'.Cells(CC.Row + 11, C.Column) = Cells(i, bps).Value

Next i

Range(Cells(2, |fffd||fffd||fffd||fffd||fffd|), Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)).NumberFormatLocal = "#,###"


'End With



'For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1

'For ii = |fffd||fffd||fffd||fffd||fffd| To |fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|

'If Cells(i, ii) = "" Then
'r = r + 1
'End If

'Next ii

'If r = 0 Then
'Rows(i).Clear
'End If

'r = 0

'Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)


'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| 4|fffd||431||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate

With Sheets("url")

For i = 2 To .Cells(Rows.Count, 1).End(3).Row

Set C = Columns(1).Find(.Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

For ii = Cells(1, Columns.Count).End(1).Column To 2 Step -1
If .Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Cells(1, ii) Then
Cells(C.Row + 1, ii).Resize(3).NumberFormatLocal = "#,###"
Cells(C.Row, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Value
Cells(C.Row + 1, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd|).Value
Cells(C.Row + 2, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
Cells(C.Row + 3, ii) = .Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value

Exit For
End If

Next ii


Next i

End With

Set C = Nothing


Sheets("|fffd||fffd||fffd||fffd|").Activate

'Set C = Rows(1).Find("2015|fffd||fffd|4|fffd||431||fffd|", lookat:=xlWhole)

'For ii = C.Column To C.Column

'If InStr(Cells(1, ii), "4|fffd||431||fffd|") Then
'For i = 2 To Cells(Rows.Count, 1).End(3).Row
'If Cells(i, 3) = "|fffd||fffd||fffd||fffd||fffd|" Then
'If Cells(i, ii) <> "" Then
'If Cells(i, ii - 3) <> "" Then

'Cells(i, ii) = Cells(i, ii) - Application.Sum(Cells(i, ii - 3).Resize(, 3))
'Cells(i + 1, ii) = Cells(i + 1, ii) - Application.Sum(Cells(i + 1, ii - 3).Resize(, 3))
'Cells(i + 2, ii) = Cells(i + 2, ii) - Application.Sum(Cells(i + 2, ii - 3).Resize(, 3))

'End If
'End If
'End If
'Next i
'End If

'Next ii

Set C = Nothing


'For i = 1 To Cells(1, Columns.Count).End(1).Column

'If InStr(Cells(1, i), "4|fffd||431||fffd|") Then

'For ii = 2 To Cells(Rows.Count, Cells(1, i).Column).End(3).Row

'If Cells(ii, i - 3) <> "" Then
'Cells(ii, i) = Cells(ii, i) - Application.Sum(Cells(ii, i).Offset(, -3).Resize(, 3))
'End If

'Next ii

'End If

'Next i




End Sub

Sub |fffd||431||fffd||fffd||fffd||121|update|fffd||3f1||fffd|()

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String


On Error Resume Next




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

  
  strPath = ThisWorkbook.Sheets("|fffd||67f||fffd||3b5||fffd|").Cells(1, 2)

    End With



'url |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("url").Activate

'head |22e||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7cef||a5|" Then
|fffd||fffd||fffd||7cef||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "|fffd||5bd||13c||fffd|" Then
|fffd||5bd||13c||fffd| = i
End If

If Cells(1, i) = "|fffd||6ba||fffd||fffd||470||fffd|" Then
|fffd||6ba||fffd||fffd||470||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5b4||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "BPS" Then
bps = i
End If


Next i


Columns(|fffd||fffd||fffd||7cef||a5|).NumberFormatLocal = "@"

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |22e||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||431||fffd||fffd||fffd||121|)


With ThisWorkbook.Sheets("url")

For i = Cells(Rows.Count, |fffd||431||fffd||fffd||fffd||121|).End(3).Row To .Cells(Rows.Count, 1).End(3).Row

fileName = .Cells(i, |fffd||fffd||fffd||fffd||fffd|) & "_" & .Cells(i, |fffd||fffd||fffd||7cef||a5|) & ".xls"
    
Workbooks.Open (strPath & fileName)
      

.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Split(Cells.Find("|fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlPart), ": ")(1)


If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||431||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "|fffd||fffd|" & Left(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), 3)
End If

If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||771||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "|fffd||fffd|2|fffd||431||fffd|"
End If

If InStr(.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "|fffd||fffd||fffd|") Then
.Cells(i, |fffd||431||fffd||fffd||fffd||121|) = Left(.Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) - 1 & "|fffd||fffd|4|fffd||431||fffd|"
End If



Workbooks(fileName).Close False



Next i



.UsedRange.Offset(1).Sort key1:=.Cells(1, |fffd||fffd||fffd||fffd||fffd|), key2:=.Cells(1, |fffd||fffd||fffd||7cef||a5|)

End With


ThisWorkbook.Sheets("url").Activate

Columns(|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"


For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = Left(Cells(i, |fffd||fffd||fffd||7cef||a5|), 4) & "/" & Mid(Cells(i, |fffd||fffd||fffd||7cef||a5|), 5, 2) & "/" & Right(Cells(i, |fffd||fffd||fffd||7cef||a5|), 2)

Next i
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)



End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|update|fffd||3f1||fffd|()

Dim C As Range

Application.ScreenUpdating = False
On Error Resume Next


Sheets("url").Activate

'head |22e||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||121|" Then
|fffd||431||fffd||fffd||fffd||121| = i
End If


Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||431||fffd||fffd||fffd||121|)

With Sheets("|fffd||fffd||fffd||fffd|")
For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i - 1, |fffd||fffd||fffd||fffd||fffd|) <> Cells(i, |fffd||fffd||fffd||fffd||fffd|) Then

Set C = .Columns(1).Find(Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then

For ii = 0 To 10000

For iii = 13 To .Cells(1, Columns.Count).End(1).Column
If .Cells(C.Row, iii) = Cells(i + ii, |fffd||431||fffd||fffd||fffd||121|) And Cells(i + ii, |fffd||431||fffd||fffd||fffd||121|) <> "" Then
.Cells(C.Row, iii) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|)
Exit For
End If
Next iii

If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd||fffd|) Then
Exit For
End If

Next ii

End If

End If

Next i

End With




End Sub

Sub |fffd||3f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||339||7be||4b4||fffd||fffd||fffd||22e||fffd||fffd||fffd||3f1||fffd|()

Application.ScreenUpdating = False
On Error Resume Next


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|







      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

       ' .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|



            strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\|fffd||fffd||fffd||fffd|\"


       


    End With

    fileName = Dir(strPath & "*.xls*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||4fd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||67f||fffd| |fffd||7be||4b4||fffd||fffd||fffd| |22e||fffd||fffd||fffd||3f1||fffd|
Cells(1, 1) = "|fffd||fffd||fffd||fffd||fffd|"

   Do While fileName <> ""


Cells(Rows.Count, 1).End(3)(2) = fileName
    
    
fileName = Dir
Loop



'|fffd||67f||fffd||3b5||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("|fffd||67f||fffd||3b5||fffd|").Activate

'|fffd||67f||fffd||3b5||fffd| |fffd||7be||fffd||fffd||fffd||fffd||fffd| |fffd||634||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
For i = 3 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||4fd||fffd|").Columns(1).Find(Cells(i, 3), lookat:=xlWhole)

If Not C Is Nothing Then
Rows(i).Clear
End If

Next i

Set C = Nothing

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 3)
Call DownloadFiles

End Sub

        

Sub |fffd||431||fffd|head|fffd||fffd||fffd||fffd|()

a = 2010


For ii = 0 To 7
For i = 1 To 4

Cells(1, Columns.Count).End(1).Offset(, 1) = a + ii & "|fffd||fffd|" & i & "|fffd||431||fffd|"

Next i
Next ii


End Sub



Sub |fffd||5bd||13c||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Application.ScreenUpdating = False
On Error Resume Next


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|







      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If


'|fffd||4fd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd||fffd||3f0||fffd| |fffd||fffd||fc| |fffd||fffd||fffd||fffd||fffd| head |fffd||5b1||fffd|

Sheets("|fffd||5bd||13c||fffd|").Activate
'ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

Next i



'|fffd||5bd||13c||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

   Do While fileName <> ""

Workbooks.Open (strPath & fileName)

For i = Cells(1, Columns.Count).End(1).Column To 1 Step -1
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||5bd||13c||fffd|(|f5||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||5bd||13c||fffd| = i
Exit For
End If
Next i


ThisWorkbook.Sheets("|fffd||5bd||13c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(Cells(Rows.Count, 1).End(3).Row) = Cells(1, 1).Resize(Cells(Rows.Count, 1).End(3).Row).Value
ThisWorkbook.Sheets("|fffd||5bd||13c||fffd|").Cells(Rows.Count, 2).End(3)(2).Resize(Cells(Rows.Count, 1).End(3).Row) = Cells(1, 2).Resize(Cells(Rows.Count, 1).End(3).Row).Value
ThisWorkbook.Sheets("|fffd||5bd||13c||fffd|").Cells(Rows.Count, 3).End(3)(2).Resize(Cells(Rows.Count, 1).End(3).Row) = Cells(1, |fffd||fffd||fffd||fffd||fffd||5bd||13c||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row).Value
ThisWorkbook.Sheets("|fffd||5bd||13c||fffd|").Cells(Rows.Count, |fffd||fffd||fffd|).End(3)(2).Resize(Cells(Rows.Count, 1).End(3).Row) = ActiveWorkbook.Name

Workbooks(fileName).Close False

    
fileName = Dir
Loop

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

Columns(|fffd||fffd||fffd|).Replace What:=".xlsx", Replacement:="", lookat:=xlPart


Columns(|fffd||fffd||fffd||fffd||fffd||6b5||fffd|).NumberFormatLocal = "@"
Columns(|fffd||fffd||fffd| + 1).NumberFormatLocal = "@"

'|fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 2 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "0000" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 3 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "000" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 4 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "00" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

If Len(Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)) = 5 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) = "0" & Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|)
End If

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||fffd||fffd| + 1) = Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd|) & Cells(i, |fffd||fffd||fffd|)

Next i


End Sub

   Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||67d||f4||67f||fffd||7b1||fffd|_|fffd||43a||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

                  strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"



    End With

    
    
        fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


  Sheets("|fffd||4fd||fffd|").Activate
  Sheets("|fffd||4fd||fffd|").UsedRange.Clear
  

   Do While fileName <> ""

 
   Cells(Rows.Count, 1).End(3)(2) = Split(fileName, "(")(0)

   
  fileName = Dir
    
  

Loop

Application.DisplayAlerts = False

Worksheets.Add before:=Worksheets(1)
ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Application.DisplayAlerts = True

newName = "|fffd||4fd||fffd||fffd||fffd||fffd||fffd|.xls"
Workbooks.Open (strPath & newName)
ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1)
Workbooks(newName).Close False

Cells(2, 3).Resize(10000, 10).Clear

   
For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||4fd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending

Set C = Nothing



        End Sub


Sub |fffd||5bd||138||178||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|()



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim vartemp3()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


Application.ScreenUpdating = False
On Error Resume Next



      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

                                          '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

            strPath = "D:\|fffd||5bd||fffd|\5|fffd||43a||fffd||fffd||fffd||fffd||fffd|\"




    End With

fileName = Dir(strPath & "|fffd||5bd||138||178||fffd|.xlsm")

Workbooks.Open (strPath & fileName)

Sheets("|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Delete

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i


ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||2bc||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3fc||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

Workbooks(fileName).Activate
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000) = ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(1000).Value
Cells(2, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd|).Resize(1000) = ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(2, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||2bc||fffd|).Resize(1000).Value
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000) = ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3fc||fffd|).Resize(1000).Value
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000, 4) = ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000, 4).Value
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000, 2) = ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000, 2).Value
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000) = ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(1000).Value


With Sheets("|fffd||43a||fffd||fffd||fffd||fffd||fffd|")
For i = 2 To Cells(Rows.Count, 2).End(3).Row

Set C = .Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

Cells(i, 1) = .Cells(C.Row, 1).Value

End If

Next i

End With


Sheets("|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Delete

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
Exit For
End If

Next i


ThisWorkbook.Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| = i
Exit For
End If

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1).Interior.Color = 255 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)
ReDim Preserve vartemp3(1 To r)

varTemp(r) = Cells(i, 1).Resize(, 10)
vartemp1(r) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|)
vartemp2(r) = ">=-0.2"
vartemp3(r) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)

End If

Next i

ThisWorkbook.Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Activate


Workbooks(fileName).Activate
Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 10) = varTemp(i)
Cells(i + 1, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|) = vartemp1(i)
Cells(i + 1, |fffd||135||fffd||fffd||fffd||fffd||fffd|) = vartemp2(i)
Cells(i + 1, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = vartemp3(i)
Next i

Erase varTemp
Erase vartemp1
Erase vartemp2
Erase vartemp3

r = 0

Sheets("|fffd||17c||fffd|").Activate

Set C = Nothing



End Sub

Sub |fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Application.ScreenUpdating = False
On Error Resume Next


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|







      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With




Sheets("|fffd||4fd||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set wkBk = Workbooks.Add
fileName = ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(i, 2) & ".xlsx"
ActiveWorkbook.SaveAs strPath & fileName

Workbooks(fileName).Close True
    
Next i


End Sub


Sub |fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|2()


Application.ScreenUpdating = False
On Error Resume Next


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|






      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                    '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With


    fileName = Dir(strPath & "*.xlsx")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                     '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

r = 0

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Columns(1).Clear

Do While fileName <> ""
r = r + 1
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(r, 1) = fileName

fileName = Dir
     

Loop

r = 0

With ThisWorkbook.Sheets("|fffd||4fd||fffd|")

For i = 1 To .Cells(Rows.Count, 1).End(3).Row
   
fileName = .Cells(i, 1)

If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then
Workbooks.Open (strPath & fileName)

'ActiveSheet.UsedRange.Clear


For ii = 1 To .Cells(Rows.Count, 2).End(3).Row

If Len(Dir(strPath & .Cells(ii, 2) & "\", vbDirectory)) <> 0 Then

Workbooks.Open (strPath & .Cells(ii, 2) & "\" & Split(fileName, ".")(0) & ".csv")


Cells(2, 4).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = .Cells(ii, 2).Value


If Workbooks(fileName).Sheets("sheet1").Cells(1, 1) = "" Then
Cells(1, 1).Resize(1000, 100).Copy Workbooks(fileName).Sheets("sheet1").Cells(1, 1)
   
Else

Cells(2, 1).Resize(1000, 100).Copy Workbooks(fileName).Sheets("sheet1").Cells(Rows.Count, 1).End(3)(2)

End If


Workbooks(Split(.Cells(i, 1), ".")(0) & ".csv").Close False


End If

    
Next ii




Columns(4).NumberFormatLocal = "yyyy-mm-dd"

Cells(1, 4) = "|fffd||fffd||a5|"
    Workbooks(fileName).Close True
    
    End If
    
    
    Next i
    
    End With
    

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate

End Sub



Sub |fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|




Application.ScreenUpdating = False
On Error Resume Next



      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                    '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With


    fileName = Dir(strPath & "*.xlsx")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                     '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If



'|fffd||4fd||fd||fffd||1ae||fffd||fffd| 1|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
r = 0

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Columns(1).Clear

'|fffd||4fd||fd||fffd||1ae| 1|fffd||fffd||fffd||fffd| 5|fffd||43a||fffd| |fffd||fffd||fc| |fffd||fffd||fffd||fffd||fffd||338||fffd| |fffd||fffd||fffd||fffd|
Do While fileName <> ""
r = r + 1
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(r, 1) = fileName

fileName = Dir
     

Loop

r = 0
Cells(1, 2) = "5|fffd||43a||fffd|"
'1|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
With ThisWorkbook.Sheets("|fffd||4fd||fffd|")

For i = 1 To .Cells(Rows.Count, 1).End(3).Row
   
fileName = .Cells(i, 1)

If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then
Workbooks.Open (strPath & fileName)

'5|fffd||43a||fffd|(|fffd||3fa||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Len(Dir(strPath & .Cells(1, 2) & "\", vbDirectory)) <> 0 Then

Workbooks.Open (strPath & .Cells(1, 2) & "\" & Split(fileName, ".")(0) & ".csv")

Cells(2, 1).Resize(3000, 100).Copy Workbooks(fileName).Sheets("sheet1").Cells(Rows.Count, 1).End(3)(2)

Workbooks(Split(fileName, ".")(0) & ".csv").Close False


End If

Workbooks(fileName).Activate

Columns(2).NumberFormatLocal = "hh:mm:ss"
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

For p = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(p, 1) = Cells(p - 1, 1) And Cells(p, 2) = Cells(p - 1, 2) Then
Rows(p).Clear
End If
Next p

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)


Workbooks(fileName).Close True

End If

Next i

    
    End With
    

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate

End Sub


Sub |fffd||5bd||13c||fffd||fffd||fffd||121||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||5bf||cf31||fffd||fffd|()




Application.ScreenUpdating = False
On Error Resume Next


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim strAddr As String
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


Sheets("|fffd||5bd||13c||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 4)


Sheets("|fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 3)

For i = 2 To Cells(Rows.Count, 3).End(3).Row

With Sheets("|fffd||5bd||13c||fffd|")
Set C = .Columns(2).SpecialCells(2).Find(Cells(i, 3), lookat:=xlPart)

If Not C Is Nothing Then
If Cells(i, 1) <> .Cells(C.Row, 1) Then

strAddr = C.Address

Do

.Cells(C.Row, 6) = Cells(i, 3)

Set C = .FindNext(C)

Loop While Not C Is Nothing And C.Address <> strAddr

End If
End If

End With

Next i

Set C = Nothing

Sheets("|fffd||5bd||13c||fffd|").Activate

End Sub

Sub sort_With_Multiple_Keys()
    Dim i As Integer
    
    With ActiveSheet.Sort
        .SortFields.Clear
            
        For i = 15 To 1 Step -1
            .SortFields.Add Key:=Cells(1, i), Order:=xlDescending
        Next i
        
        .SetRange Range("A1:p30000")
        .Apply
    End With
End Sub


Sub |fffd||7fa||fffd||fffd||fffd||fffd||fffd|()


Application.ScreenUpdating = False
On Error Resume Next


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1

If Cells(i, 2) = Cells(i - 1, 2) Then
If Cells(i, 3) = Cells(i - 1, 3) Then
If Cells(i, 4) = Cells(i - 1, 4) Then
If Cells(i, 6) = Cells(i - 1, 6) Then
If Cells(i, 7) = Cells(i - 1, 7) Then
If Cells(i, 10) = Cells(i - 1, 10) Then
If Cells(i, 11) = Cells(i - 1, 11) Then
'If Cells(i, 13) = Cells(i - 1, 13) Then
If Cells(i, 14) = Cells(i - 1, 14) Then
If Cells(i, 15) = Cells(i - 1, 15) Then

Rows(i).Clear

'End If
End If
End If
End If
End If
End If
End If
End If
End If
End If

Next i

'ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)


End Sub
      

Sub csv|fffd||fffd||fffd||fffd|xlsx|fffd||fffd||fffd||3f7||3b0||fffd||121||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


'var = Split(strPath, "\")
'newName = var(UBound(var) - 1)
 

   Do While fileName <> ""


    'strName = Split(fileName, ".")(0) & "(" & newName & ")" & ".xlsx"
    
    strName = Split(fileName, ".")(0) & ".xlsx"
    
   Workbooks.Open (strPath & fileName)
      
   rowsCnt = Cells(Rows.Count, 1).End(3).Row
   colsCnt = Cells(1, Columns.Count).End(1).Column
   
   Set wkBk = Workbooks.Add
   
    ActiveWorkbook.Sheets(1).Cells(1, 1).Resize(rowsCnt, colsCnt) = Workbooks(fileName).Sheets(1).Cells(1, 1).Resize(rowsCnt, colsCnt).Value
       
    Cells.EntireColumn.AutoFit
    Columns("b").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
    Columns("a").NumberFormatLocal = "yyyy-mm-dd"

    wkBk.SaveAs strPath & strName
       
    Workbooks(strName).Close True

    Workbooks(fileName).Close False
    
    
    
  fileName = Dir
    
 

Loop



        End Sub
       
        
        Sub xlsx|fffd||fffd||fffd||fffd|xlsx|fffd||fffd||fffd||3f7||3b0||fffd||121||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

   Do While fileName <> ""


   strName = Split(fileName, "(")(0) & ".xlsx"
    
   Set wkBk = Workbooks.Add
   
    wkBk.SaveAs strPath & strName
       
    Workbooks(strName).Close True

       
    
    
  fileName = Dir
    
 

Loop



        End Sub
        
        
 Sub |fffd||fffd||a5|update|fffd||3f1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim strPath1 As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strName1 As String







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            strPath1 = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next



   Do While fileName <> ""

 
    strName = Split(fileName, ".")(0) & ".xlsx"
    
   Workbooks.Open (strPath & strName)
   
   If ActiveWorkbook.Name = strName Then
            
   
   Workbooks.Open (strPath & fileName)
   
      
   rowsCnt = Cells(Rows.Count, 1).End(3).Row
   colsCnt = Cells(1, Columns.Count).End(1).Column
   
    Workbooks(strName).Sheets(1).Cells(Rows.Count, 1).End(3)(2).Resize(rowsCnt, colsCnt) = Workbooks(fileName).Sheets(1).Cells(1, 1).Resize(rowsCnt, colsCnt).Value
    
    
    Workbooks(fileName).Close False
    
    Workbooks(strName).Activate
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
    
    For i = Columns(1).SpecialCells(2).Count To 2 Step -1
    
    If Cells(i, 1) = Cells(i - 1, 1) Then
    If Cells(i, 2) = Cells(i - 1, 2) Then
    
    Rows(i).Clear
    
    End If
    End If
    
    Next i
    
        ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
    If Cells(Rows.Count, 2).End(3) = "|fffd||f0||fffd|" Then
    Rows(Cells(Rows.Count, 2).End(3).Row).Clear
    End If
    
     
     
          ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
          
              Columns("A:A").EntireColumn.AutoFit
    Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
    
    
    Workbooks(strName).Close True
    End If
   
  fileName = Dir
    
 

Loop



        End Sub


 Sub |fffd||fffd||a5|update|fffd||3f1||fffd|_|223||fffd||fffd||e2|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim strPath1 As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strName1 As String







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                    '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

Cells(37, 8) = "=today()"
Cells(37, 9) = Cells(37, 8) - Cells(37, 7)

Sheets("test").Activate
Sheets("test").UsedRange.Clear
Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
Cells(2, 1) = Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Cells(37, 7).Value

For i = 3 To Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Cells(37, 9) + 2
Cells(i, 1) = Cells(i - 1, 1).Value + 1
Next i

For i = 2 To Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Cells(37, 9) + 2
Cells(i, 1) = Application.Text(Cells(i, 1).Value, "yyyymmdd")
Next i

Columns(1).NumberFormatLocal = "@"

Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Cells(37, 8).Resize(, 2).Clear

   Do While fileName <> ""

Workbooks.Open (strPath & fileName) 'xlsx |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

Cells(1, 1).Resize(, 23) = Array("|fffd||fffd||a5|", "|fffd||f0||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||77e||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||175||fffd||fc||fffd||fffd|", "|fffd||17c||fffd||fc||fffd||fffd|", _
"|fc||fffd||1c2d||fffd||fffd|", "|fffd||177||fffd||fffd||fffd|", "|fc||fffd||1dee|", "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|", "|fffd||175||fffd||fc||fffd||fffd||1fc||fffd|", "|fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|", "|fffd||fffd||fc||fffd||fffd||1fc||fffd|", "|fffd||f0||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|" _
, "|fffd||f0||fffd||fffd||fffd||fffd||175||fffd||fc||fffd||fffd||1fc||fffd|", "|fffd||f0||fffd||fffd||fffd||fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|", "|fffd||478||175||fffd||fffd||737||fffd|", "|fffd||478||17c||fffd||fffd||737||fffd|", "|fffd||f0||fffd||fffd||fffd||fc||fffd||fffd||1fc||fffd|")


For p = 2 To ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3).Row '|fffd||fffd||a5||fffd||fffd| csv |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

strPath1 = strPath & "\" & ThisWorkbook.Sheets("test").Cells(p, 1) & "\" 'test sheet 1|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    
    
    strName = Split(fileName, ".")(0) & ".csv" '
    
       
    
   Workbooks.Open (strPath1 & strName)
   
   If ActiveWorkbook.Name = strName Then
      
     
   rowsCnt = Cells(Rows.Count, 1).End(3).Row
   colsCnt = Cells(1, Columns.Count).End(1).Column
   
    Workbooks(fileName).Sheets(1).Cells(Rows.Count, 2).End(3)(2).Resize(rowsCnt - 1, colsCnt) = Workbooks(strName).Sheets(1).Cells(2, 1).Resize(rowsCnt - 1, colsCnt).Value
    
    
    Workbooks(strName).Close False
    
    Workbooks(fileName).Activate
    
    Cells(Rows.Count, 1).End(3)(2).Resize(rowsCnt - 1) = ThisWorkbook.Sheets("test").Cells(p, 1).Value
    
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
    
    For i = Columns(1).SpecialCells(2).Count To 2 Step -1
    
    If Cells(i, 1) = Cells(i - 1, 1) Then
    If Cells(i, 2) = Cells(i - 1, 2) Then
    
    Rows(i).Clear
    
    End If
    End If
    
    Next i
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
    
    Columns("A:A").EntireColumn.AutoFit
    Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
    
    End If
    
      Next p
      
      
    Workbooks(fileName).Close True


   
  fileName = Dir
    
 

Loop



        End Sub
  
Sub |fffd||175||fffd||fffd||3f1||fffd|_|223||fffd||fffd||e2|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("|fffd||fffd||fffd||377||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|"
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||175||fffd||fffd||fffd||fffd||377||fffd| = i
End If
Next i
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 1) = Left(Cells(i, 1), 4) & "/" & Mid(Cells(i, 1), 5, 2) & "/" & Right(Cells(i, 1), 2)
Next i
 
 
Columns(1).NumberFormatLocal = "yyyy-mm-dd"
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
fileName = Cells(i, 2).Value & "(5|fffd||fffd|).csv"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||377||fffd|" Then
   
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
   
   
   
   Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   For Aa = C.Row + 1 To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
   
   If Cells(Aa, 1) <> Cells(Aa - 1, 1) Then
   Exit For
   End If
   
   Next Aa
   
   
   If Cells(Aa, 6) / Cells(Aa - 1, 6) > 1.0833 Then
   ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||377||fffd|) = Cells(Aa, 6) / Cells(Aa - 1, 6) - 1.0033
   End If
   
   If Cells(Aa, 6) / Cells(Aa - 1, 6) <= 1.0833 Then
   If Cells(Aa + 1, 17) > Cells(Aa, 17) Then
   ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||377||fffd|) = Cells(Aa + 1, 6) / Cells(Aa - 1, 6) - 1.0033
   End If
   End If
   
   If Cells(Aa, 6) / Cells(Aa - 1, 6) <= 1.0833 Then
   If Cells(Aa + 1, 17) <= Cells(Aa, 17) Then
   If Application.Max(Cells(Aa + 2, 17).Resize(35)) > Cells(Aa + 1, 17) Then
   Set C = Cells(Aa + 2, 17).Resize(35).Find(Application.Max(Cells(Aa + 2, 17).Resize(35)), lookat:=xlWhole)
   ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||377||fffd|) = C.Offset(, -11) / Cells(Aa - 1, 6) - 1.0033
   
   Else
   ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||377||fffd|) = Cells(Aa + 35, 6) / Cells(Aa - 1, 6) - 1.0033
   
   End If
   End If
   End If
   
   Set C = Nothing
   
   End If
   
   Workbooks(fileName).Close False
    
 
   End If
   
   Next i
   
   End Sub

   
Sub |fffd||175||fffd||fffd||3f1||fffd|_|fffd||fffd||fffd||470||fffd||fffd||fffd||229||fffd||ff||fffd||fffd||43f||fffd||fffd||231||fffd|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("|fffd||fffd||fffd||377||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|"
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||175||fffd||fffd||fffd||fffd||377||fffd| = i
End If
Next i
 
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
fileName = Cells(i, 2).Value & "(5|fffd||fffd|).csv"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||377||fffd|" Then
   
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending
   
      
   Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   For Aa = C.Row + 1 To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
   
   If Cells(Aa, 1) <> Cells(Aa - 1, 1) Then
   Exit For
   End If
   
   Next Aa
   
   ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||377||fffd|) = Application.Max(Cells(Aa, 4).Resize(71)) / Cells(Aa, 3) - 1.0033
      ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd|").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||377||fffd| + 1) = Cells(Aa + 70, 6) / Cells(Aa, 3) - 1.0033
   
   
   Set C = Nothing
   
   End If
   
   Workbooks(fileName).Close False
    
 
   End If
   
   Next i
   
   End Sub

 Sub |fffd||fffd||fffd||fffd|update|fffd||3f1||fffd|_|223||fffd||fffd||e2|()

   

 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate
Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||fffd||fffd||fffd|"
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
Next i


fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
End If
 
    Do While fileName <> ""
   
   Set CC = ThisWorkbook.ActiveSheet.Columns(2).Find(Split(fileName, "(")(0), lookat:=xlWhole) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   If Not CC Is Nothing Then

    Workbooks.Open (strPath & fileName)
  
      ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   
   For ii = 1 To Cells(1, Columns.Count).End(1).Column
   If Cells(1, ii) = "<Envelope>|fffd||fffd||fffd||5fc||fffd|" Then
   |fffd||fffd||fffd||5fc||fffd| = ii
   End If
   Next ii
   
   For i = CC.Row To CC.Row + 1000
   If ThisWorkbook.Sheets("test").Cells(i, 2) = ThisWorkbook.Sheets("test").Cells(i + 1, 2) Then
   
      Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   If Cells(C.Row, |fffd||fffd||fffd||5fc||fffd|).Value < Cells(C.Row, 5) Then
   ThisWorkbook.Sheets("test").Cells(i, |fffd||fffd||fffd||fffd|) = 1
   End If

   Else
   
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   If Cells(C.Row, |fffd||fffd||fffd||5fc||fffd|).Value < Cells(C.Row, 5) Then
   ThisWorkbook.Sheets("test").Cells(i, |fffd||fffd||fffd||fffd|) = 1
   End If
    
   Exit For
   End If
   
   Next i
   

                              '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |f3||fffd||fffd| |fffd||fffd||121||fffd||fffd| |fffd||5bc||fffd| |fffd||1b4||4b6||fffd||fffd||fffd||fffd||fffd| |fffd||77a||fffd|


   
   Workbooks(fileName).Close False
    
        End If

    
  fileName = Dir
    
  
Loop
   

   
   End Sub
  Sub |fffd||fffd||fffd||fffd||fffd||63a||fffd||fffd||3f1||fffd|()

'|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd|-0.02|fffd||fffd||fffd||fffd|/|fffd||177||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||33b||fffd|/|fffd||fffd||fffd||fffd||fffd||2c23|4|fffd||33b||fffd|

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  
  
  '|fffd||3f0||fffd||fffd||fffd||fffd||3f4||b9||fffd|
  


  
  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           Header:=xlYes
    End With
  

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 18) = Array("|fffd||5b0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||2c23|", "|fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||fffd||fffd|", "|fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||370||fffd|", "|fffd||7f8||170||fffd|", "|fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||7f8||fffd||fffd||fffd|", _
"|fffd||7f8||fffd||23d||fffd||fffd|", "|fffd||175||fffd||fffd||f0||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||fffd||57c||fffd||fffd||377||fffd|")


For i = 1 To Rows(1).SpecialCells(2).Count

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2c23|" Then
|fffd||fffd||fffd||fffd||fffd||2c23| = i
End If

If Cells(1, i) = "|fffd||135||fffd|" Then
|fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||370||fffd|" Then
|fffd||fffd||fffd||370||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||170||fffd|" Then
|fffd||7f8||170||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||570||fffd|" Then
|fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||23d||fffd||fffd|" Then
|fffd||7f8||fffd||23d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||f0||fffd|" Then
|fffd||175||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If


Next i


rowsCnt = Columns(1).SpecialCells(2).Count

r = 0
b = 0

For i = 2 To rowsCnt
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Application.Max(Cells(i - 11, 6).Resize(12))
Next i

Cells(2, |fffd||5b0||fffd||fffd||fffd|).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)

For i = 2 To rowsCnt
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) <> Cells(i, 6) Then
Cells(i, |fffd||5b0||fffd||fffd||fffd|) = ""
End If

Next i

r = 0
'|fffd||fffd||fffd||fe1| |fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||33f||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
'|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| %|fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd| |fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 70|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| |1e5||fffd||fffd||fffd||474||fffd|.

Erase varTemp


For i = 2 To rowsCnt

If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 200 Then '|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd||33b||fffd|
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) = "" Then '|fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||4b6||fffd|
If Cells(i, 8) < 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (-)|fffd||3f6||fffd|
If Cells(i, 6) / Cells(i, 3) - 1 < -0.035 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| -0.055|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'If Cells(i, 6).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row > 5 Then '|fffd||fffd||fffd||fffd||fffd||2c23||fffd||fffd| 5|fffd||33b||fffd||fffd||3f6||fffd|

Cells(i, |fffd||fffd||fffd||fffd||fffd||2c23|) = Cells(i, 6).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 6) / Cells(i, 3) - 1
Cells(i, |fffd||135||fffd|) = Cells(i, 6) / Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3) - 1

Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 1, 3) '|fffd||17c||fffd||fffd||fffd|
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 1.0533  '|fffd||fffd||fffd||370||fffd|
Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 0.92 '|fffd||7f8||170||fffd|


For r = 1 To 600

If Cells(i + r, 4) > Cells(i, |fffd||fffd||fffd||370||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.05
Exit For
End If


'If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
'If Cells(i + r, 5) < Cells(i, |fffd||7f8||170||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f8||170||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
'Cells(i, |fffd||fffd||570||fffd|) = (Cells(i, |fffd||17c||fffd||fffd||fffd|) + Cells(i, |fffd||7f8||170||fffd|)) / 2 '|fffd||fffd||570||fffd| |1e5||fffd||fffd|
'Cells(i, |fffd||7f8||fffd||fffd||fffd|) = r
'Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1
'Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 1.0533
'End If
'End If


If Cells(i + r, 1) <> Cells(i + r + 1, 1) Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = Cells(i + r, 6) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033


'b = b + 1
'If b = 8 Then
'Cells(i, |fffd||175||fffd||fffd||f0||fffd|) = b
Exit For
'End If
End If



Next r


b = 0

'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
'Cells(i, |fffd||175||fffd||fffd||fffd|) = Cells(i + r, 3) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
'End If


'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
'Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.05 * 2
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
'End If


'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1 Then
'Cells(i, |fffd||175||fffd||fffd||fffd|) = (Cells(i + r, 3) / Cells(i, |fffd||fffd||570||fffd|) - 1.0033) * 2
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
'End If




ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 7).End(3) = Cells(1, 1).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

'End If
'End If
'End If
End If
End If

Next i

   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
 Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"

  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           key3:=.Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), order3:=1, _
           Header:=xlYes
    End With
  
For i = Columns(1).SpecialCells(2).Count To 2 Step -1
If InStr(Cells(i, 1), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Delete shift:=xlUp

End If
Next i


        End Sub
        
  Sub |fffd||fffd||fffd||fffd||fffd||63a||fffd||fffd||3f1||fffd|_5|fffd||43f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

'|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd|-0.02|fffd||fffd||fffd||fffd|/|fffd||177||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||33b||fffd|/|fffd||fffd||fffd||fffd||fffd||2c23|4|fffd||33b||fffd|

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  
  
  '|fffd||3f0||fffd||fffd||fffd||fffd||3f4||b9||fffd|
  


  
  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           Header:=xlYes
    End With
 Columns("a").NumberFormatLocal = "yyyy-mm-dd"
 Columns("B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
 
 
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 23) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||5b0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||2c23|", "|fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||5b0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||370||fffd|", "|fffd||7f8||170||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||7f8||fffd||fffd||fffd|", _
"|fffd||7f8||fffd||23d||fffd||fffd|", "|fffd||175||fffd||fffd||f0||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|")


For i = 1 To Rows(1).SpecialCells(2).Count

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If


If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2c23|" Then
|fffd||fffd||fffd||fffd||fffd||2c23| = i
End If

If Cells(1, i) = "|fffd||135||fffd|" Then
|fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||370||fffd|" Then
|fffd||fffd||fffd||370||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||170||fffd|" Then
|fffd||7f8||170||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||570||fffd|" Then
|fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||23d||fffd||fffd|" Then
|fffd||7f8||fffd||23d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||f0||fffd|" Then
|fffd||175||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| = i
End If


Next i


rowsCnt = Columns(1).SpecialCells(2).Count

r = 0

For i = 2 To rowsCnt
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Application.Max(Cells(i - 11, 4).Resize(12))
Next i

Cells(2, |fffd||5b0||fffd||fffd||fffd|).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)

For i = 2 To rowsCnt
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) <> Cells(i, 4) Then
Cells(i, |fffd||5b0||fffd||fffd||fffd|) = ""
End If

Next i


Erase varTemp
b = 0

For i = 2 To rowsCnt

If Cells(i, 2) >= ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, Columns.Count).End(1) Then
If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 200 Then '|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd||33b||fffd|
'If Cells(i - 1, 6) / Cells(i - 1, 3) - 1 < -0.02 Then  '|fffd||fffd||fffd||fffd||fffd||330||fffd| 0.02|fffd||fffd||fffd||fffd| |16c||fffd||fffd|
If Cells(i - 1, 6) / Cells(i - 1, 3) - 1 < 0 Then
If Cells(i, 6) / Cells(i - 1, 3) - 1 < -0.025 Then
'If Cells(i, 3) / Cells(i - 1, 6) - 1 > 0.01 Then '|fffd||f0||fffd||fffd||fffd||fffd||fffd| 0.01%|fffd||fffd||fffd||fffd| |16c||fffd||fffd|
'If Cells(i, 3) / Application.Max(Cells(i - 264, 4).Resize(264)) - 1 > 0.01 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0.01|fffd||fffd||fffd||fffd| |169||fffd||fffd| |fffd||677||fffd| |fffd||1b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||17e||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'If Cells(i, 8) < -0.1 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0|fffd||fffd||fffd||fffd| |169||fffd||fffd| 0.11%|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'If Cells(i - 1, 8) > -0.05 Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -0.05|fffd||fffd||fffd||fffd| |16c||fffd||fffd|
'If Cells(i, 6) < 50000 Then

'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, 8)
Cells(i, |fffd||fffd||fffd||fffd||fffd||2c23|) = Cells(i, 1).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row
Cells(i, |fffd||135||fffd|) = Cells(i, 6) / Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3) - 1
'Cells(i, |fffd||5b0||fffd||fffd||fffd|) = Application.Max(Cells(i - 264, 4).Resize(264))
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 3) / Application.Max(Cells(i - 264, 4).Resize(264)) - 1
'Cells(i, |fffd||f0||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 3) / Cells(i - 1, 6) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 6) / Cells(i - 1, 6) - 1

Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 1, 3) '|fffd||17c||fffd||fffd||fffd|
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 1.0833  '|fffd||fffd||fffd||370||fffd|
Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 0.92 '|fffd||fffd||fffd||fffd||fffd||fffd|



For r = 1 To 600
If Cells(i + r, 1) <> Cells(i + r + 1, 1) Then
b = b + 1
If b = 1 Then
Exit For
End If
End If

Next r

Cells(i, |fffd||5b0||fffd||fffd||fffd|) = Application.Max(Cells(i + 1, 4).Resize(r))
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Min(Cells(i + 1, 5).Resize(r))
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1
Cells(i, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|) = Cells(i, |fffd||5b0||fffd||fffd||fffd|) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1

b = 0


For r = 1 To 600
If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
If Cells(i + r, 4) > Cells(i, |fffd||fffd||fffd||370||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.08
Exit For
End If
End If

If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) <> "" Then
If Cells(i + r, 4) > Cells(i, |fffd||fffd||fffd||370||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.1
Exit For
End If
End If



'If Cells(i + r, 5) < Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
'Cells(i, |fffd||175||fffd||fffd||fffd|) = -0.0833
'Exit For
'End If


If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
If Cells(i + r, 5) < Cells(i, |fffd||7f8||170||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f8||170||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(i, |fffd||fffd||570||fffd|) = (Cells(i, |fffd||17c||fffd||fffd||fffd|) + Cells(i, |fffd||7f8||170||fffd|)) / 2 '|fffd||fffd||570||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||7f8||fffd||fffd||fffd|) = r
Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 1.0533
End If
End If



If Cells(i + r, 1) <> Cells(i + r + 1, 1) Then
b = b + 1
If b = 1 And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = Cells(i + r, 6) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033
Exit For
End If

If b = 1 And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) <> "" Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = (Cells(i + r, 6) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033) * 2
Exit For
End If
End If

Next r


b = 0
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 7).End(3) = Cells(1, 1).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

'End If
'End If
'End If
'End If
End If
End If
End If
End If


Next i

   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
 Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"

  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           key3:=.Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), order3:=1, _
           Header:=xlYes
    End With
  
For i = Columns(1).SpecialCells(2).Count To 2 Step -1
If InStr(Cells(i, 1), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Delete shift:=xlUp

End If
Next i

   Columns("G").Replace What:="[|fffd||3fd||fffd|]", Replacement:="", lookat:=xlPart

        End Sub
  Sub |fffd||fffd||fffd||fffd||fffd||63a||fffd||fffd||3f1||fffd|_|fffd||7f8||17e||fffd||fffd||fffd|()

'|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd|-0.02|fffd||fffd||fffd||fffd|/|fffd||177||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||33b||fffd|/|fffd||fffd||fffd||fffd||fffd||2c23|4|fffd||33b||fffd|

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||7f8||173||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  
  
  '|fffd||3f0||fffd||fffd||fffd||fffd||3f4||b9||fffd|
  


  
  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           Header:=xlYes
    End With
  

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 15) = Array("|fffd||5b0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||2c23|", "|fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||370||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||7f8||fffd||fffd||fffd|", _
"|fffd||7f8||fffd||23d||fffd||fffd|", "|fffd||175||fffd||fffd||f0||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||fffd||57c||fffd||fffd||377||fffd|")


For i = 1 To Rows(1).SpecialCells(2).Count

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2c23|" Then
|fffd||fffd||fffd||fffd||fffd||2c23| = i
End If

If Cells(1, i) = "|fffd||135||fffd|" Then
|fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||370||fffd|" Then
|fffd||fffd||fffd||370||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||570||fffd|" Then
|fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||23d||fffd||fffd|" Then
|fffd||7f8||fffd||23d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||f0||fffd|" Then
|fffd||175||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If


Next i


rowsCnt = Columns(1).SpecialCells(2).Count

r = 0
b = 0

For i = 2 To rowsCnt
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Application.Max(Cells(i - 11, 4).Resize(12))
Next i

Cells(2, |fffd||5b0||fffd||fffd||fffd|).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)

For i = 2 To rowsCnt
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) <> Cells(i, 4) Then
Cells(i, |fffd||5b0||fffd||fffd||fffd|) = ""
End If

Next i

r = 0
'|fffd||fffd||fffd||fe1| |fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||33f||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
'|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| %|fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd| |fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 70|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| |1e5||fffd||fffd||fffd||474||fffd|.

Erase varTemp


For i = 2 To rowsCnt

If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 200 Then '|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd||33b||fffd|
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) = "" Then '|fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||4b6||fffd|
If Cells(i, 8) < 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (-)|fffd||3f6||fffd|
If Cells(i, 6) / Cells(i, 3) - 1 < -0.02 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| -0.055|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Cells(i, 6).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row > 4 Then '|fffd||fffd||fffd||fffd||fffd||2c23||fffd||fffd| 5|fffd||33b||fffd||fffd||3f6||fffd|

Cells(i, |fffd||fffd||fffd||fffd||fffd||2c23|) = Cells(i, 6).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 6) / Cells(i, 3) - 1
Cells(i, |fffd||135||fffd|) = Cells(i, 6) / Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3) - 1

Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 1, 3) '|fffd||17c||fffd||fffd||fffd|
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 1.0533  '|fffd||fffd||fffd||370||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 0.9533 '|fffd||7f8||170||fffd|


For r = 1 To 600

If Cells(i + r, 4) > Cells(i, |fffd||fffd||fffd||370||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.05
Exit For
End If


If Cells(i + r, 5) <= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = -0.05
Exit For
End If



If Cells(i + r, 1) <> Cells(i + r - 1, 1) Then
b = b + 1
If b = 8 Then
Cells(i, |fffd||175||fffd||fffd||f0||fffd|) = b
Exit For
End If
End If



Next r


b = 0

If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = Cells(i + r, 3) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
End If


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||7f8||173||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||7f8||173||fffd|").Cells(Rows.Count, 7).End(3) = Cells(1, 1).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

End If
End If
End If
End If
End If

Next i

   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd||fffd||7f8||173||fffd|").Activate
 Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"

  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           key3:=.Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), order3:=1, _
           Header:=xlYes
    End With
  
For i = Columns(1).SpecialCells(2).Count To 2 Step -1
If InStr(Cells(i, 1), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Delete shift:=xlUp

End If
Next i


        End Sub

Sub |fffd||fffd||fffd||fffd||5f6||1f4||bc||fffd||fffd||371||fffd||fffd||fffd|()


Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet


Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||4fd||fffd|").Activate

For i = 1 To Cells(Rows.Count, 1).End(3).Row

If InStr(Cells(i, 1), "|fffd||fffd||fffd||fffd||5f6||1f4||fffd|") Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i + 1, 1)
End If

Next i

ActiveSheet.UsedRange.Clear

For i = 1 To UBound(varTemp, 1)
Cells(i, 1) = varTemp(i)
Next i

r = 0


End Sub

Sub |fffd||fffd||fffd||fffd||5f6||1f4||bc||fffd||fffd||371||fffd||fffd||fffd|2()


Dim rngall As Range
Dim |fffd||fffd||fffd||fffd| As Range
Dim |fffd||fffd||fffd||fffd| As Range
Dim Pro As Range
Dim NetPro As Range
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet


Application.ScreenUpdating = False
On Error Resume Next

'|fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate

'head |fffd||fffd| |fffd||5b0||fffd|
For i = Cells(1, Columns.Count).End(1).Column To 1 Step -1

If Cells(1, i) = "2016|fffd||fffd|4|fffd||431||fffd|" Then
|fffd||fffd||431||fffd| = i
Exit For
End If

If Cells(1, i) = "2017|fffd||fffd|1|fffd||431||fffd|" Then
|fffd||3fa||431||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If

Next i


'|fffd||fffd||fffd||fffd| |fffd||4fd||fffd|2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
Set |fffd||fffd||fffd||fffd| = ActiveSheet.UsedRange.Find(Sheets("|fffd||4fd||fffd|2").Cells(1, 1), lookat:=xlWhole)

Sheets("|fffd||4fd||fffd|2").Activate

Set |fffd||fffd||fffd||fffd| = ActiveSheet.UsedRange.Find("(|fffd||fffd||fffd||fffd|: |fffd||fffd|)", lookat:=xlPart)
w = 100000000
If |fffd||fffd||fffd||fffd| Is Nothing Then
w = 100000
End If

Set Pro = ActiveSheet.UsedRange.Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlPart)
Set NetPro = ActiveSheet.UsedRange.Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlPart)

Sheets("|fffd||fffd||fffd||fffd|").Activate

With Sheets("|fffd||4fd||fffd|2")
Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) = Application.Round(.Cells(Pro.Row, 3) / w, 0) - Application.Sum(Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||3fa||431||fffd|).Resize(, 3))
Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) = Application.Round(.Cells(NetPro.Row, 3) / w, 0) - Application.Sum(Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||3fa||431||fffd|).Resize(, 3))

If Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd|) <> "" Then

Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise) = ((Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd|)) / Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd|)) * 100

If (Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd|)) > 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise) < 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise)
End If

If (Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd|)) < 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise) > 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise)
End If



Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise) = ((Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd|)) / Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd|)) * 100

If (Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd|)) > 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise) < 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise)
End If

If (Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd|)) < 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise) > 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise)
End If


End If

Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise) = Application.Round(Cells(|fffd||fffd||fffd||fffd|.Row + 2, surprise), 2)
Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise) = Application.Round(Cells(|fffd||fffd||fffd||fffd|.Row + 3, surprise), 2)


Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) = Application.Round((Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||431||fffd|)) / Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||431||fffd|) * 100, 0)

If (Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||431||fffd|)) > 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) < 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|)
End If

If (Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||431||fffd|)) < 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|)
End If

Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) = Application.Round((Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||431||fffd|)) / Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||431||fffd|) * 100, 0)

If (Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||431||fffd|)) > 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) < 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|)
End If

If (Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||fffd||121|) - Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||431||fffd|)) < 0 And Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 0 Then
Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) = -1 * Cells(|fffd||fffd||fffd||fffd|.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|)
End If

End With

Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||121|).Select

End Sub





Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|()


Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| As Long
'Dim |fffd||73a||fffd||fffd||3f6||fffd| As Long





Application.Calculation = xlCalculationManual
Application.EnableEvents = False
Application.ScreenUpdating = False
On Error Resume Next



Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 14) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)", "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd|")



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

If Cells(2, Columns.Count).End(1) <> "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
Cells(2, Columns.Count).End(1).Offset(, 2).Resize(, 12) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)")


End If

For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||1fd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd| = i
Exit For
End If

Next i

Set rngall = Range("a2", Cells(Rows.Count, |fffd||fffd||fffd||fffd|).End(3))

For |fffd||fffd||fffd||fffd||fffd||fffd| = 0.02 To 0.05 Step 0.01
'For |fffd||fffd||fffd||fffd||fffd||fffd| = 1 To 2
For |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0 To 1 Step 0.1
For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.1
For |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
'For |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
For |fffd||3f6||fffd||fffd||f0||fffd| = 0.378 To 0.4 Step 0.003
For |fffd||177||fffd||fffd||fffd||fffd| = 100 To 500 Step 100
'For |fffd||177||fffd||fffd||fffd||77a||fffd| = 0.5 To 3 Step 0.5
'For |fffd||3f6||fffd||fffd||135||fffd| = -0.04 To -0.1 Step -0.01
'For |fffd||73a||fffd||fffd||3f6||fffd| = -0.01 To -0.08 Step -0.01



Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(, 11).Clear
Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 0) = "<=" & |fffd||fffd||fffd||fffd||fffd||fffd|
'Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 1) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd|
Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 2) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 3) = ">=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
'Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 4) = ">=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 5) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
'Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 6) = ">=" & |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 7) = ">=" & |fffd||3f6||fffd||fffd||f0||fffd|
Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 8) = ">=" & |fffd||177||fffd||fffd||fffd||fffd|
'Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 9) = ">=" & |fffd||177||fffd||fffd||fffd||77a||fffd|
'Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 10) = "<=" & |fffd||3f6||fffd||fffd||135||fffd|
'Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 11) = "<=" & |fffd||73a||fffd||fffd||3f6||fffd|


Set rngall = Range("a2", Cells(Rows.Count, |fffd||fffd||fffd||fffd|).End(3))

With Sheets("|fffd||4fd||fffd|")
.UsedRange.Clear
rngall.AdvancedFilter 2, Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(2, 12), .Cells(1, 1)

If Application.Average(.Columns(|fffd||fffd||fffd||fffd|)) > 0.005 Then
If Application.CountA(.Columns(|fffd||fffd||fffd||fffd|)) > 40 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)

varTemp(r) = Cells(3, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(, 12)
vartemp1(r) = Application.Average(.Columns(|fffd||fffd||fffd||fffd|))
vartemp2(r) = Application.CountA(.Columns(|fffd||fffd||fffd||fffd|))

End If
End If

End With

Set rngall = Nothing

Next |fffd||177||fffd||fffd||fffd||fffd|
Next |fffd||3f6||fffd||fffd||f0||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||177||fffd||fffd||fffd||77a||fffd|



'Next |fffd||fffd||fffd||fffd||fffd||fffd|


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 12) = varTemp(i)
Cells(i + 1, 13) = vartemp1(i)
Cells(i + 1, 14) = vartemp2(i)

Next i

r = 0
Erase varTemp
Erase vartemp1
Erase vartemp2


'Application.DisplayAlerts = False
'Sheets("|fffd||4fd||fffd|").Delete
'Worksheets.Add after:=Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
'ActiveSheet.Name = "|fffd||4fd||fffd|"
'Application.DisplayAlerts = True

'End If



Set rngall = Nothing


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 13), order1:=xlDescending

Application.Calculation = xlCalculationAutomatic
Application.EnableEvents = True

End Sub

Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_3|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| As Long
'Dim |fffd||73a||fffd||fffd||3f6||fffd| As Long





Application.Calculation = xlCalculationManual
Application.EnableEvents = False
Application.ScreenUpdating = False
On Error Resume Next





Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 18) = Array("|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|", "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd|")


For i = Cells(1, Columns.Count).End(1).Column To 1 Step -1

If Cells(1, i) = "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|" Then
|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If

Next i

Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| + 2).Resize(, 14) = Cells(1, 1).Resize(, 14).Value



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

If Cells(2, Columns.Count).End(1) <> "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|" Then
Cells(2, Columns.Count).End(1).Offset(, 2).Resize(, 15) = Array("|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|")
End If

For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1
If Cells(2, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||1fd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||634||fffd||fffd|" Then
|fffd||634||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6ff||fffd|" Then
|fffd||fffd||fffd||6ff||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
Exit For
End If


Next i


'|fffd||634||fffd||fffd| update
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||634||fffd||fffd|) = Month(Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|))
Next i

Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 300) = Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Resize(, 300).Value

rr = 0

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate



For p = Cells(1, |fffd||fffd||fffd||6ff||fffd|) + Cells(1, |fffd||fffd||fffd||fffd|) To 100


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

If p = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) + 1 Then
rr = 0
Exit For
End If


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||634||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||6ff||fffd|) + rr Then
ee = Cells(i, |fffd||634||fffd||fffd|).Row
Exit For
End If
Next i


For i = ee + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||634||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||6ff||fffd|) + Cells(1, |fffd||fffd||fffd||fffd|) + rr Then
dd = Cells(i - 1, |fffd||634||fffd||fffd|).Row
Exit For
End If
Next i

rr = rr + 1



'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| |fffd||331||fffd| |fffd||fffd||fffd||fffd|


Range(Cells(ee, 1), Cells(dd, |fffd||634||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)

Sheets("|fffd||4fd||fffd|2").Activate

Set rngall = Range("a1", Cells(Rows.Count, |fffd||634||fffd||fffd|).End(3))


'For |fffd||fffd||fffd||fffd||fffd||fffd| = 0.02 To 0.06 Step 0.01
'For |fffd||fffd||fffd||fffd||fffd||fffd| = 1 To 2
For |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.9 To 1.1 Step 0.1
'For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.1
For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.5 Step 0.1
For |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
'For |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
For |fffd||3f6||fffd||fffd||f0||fffd| = 0.378 To 0.4 Step 0.003
For |fffd||177||fffd||fffd||fffd||fffd| = 200 To 300 Step 100
'For |fffd||177||fffd||fffd||fffd||77a||fffd| = 0.5 To 3 Step 0.5
'For |fffd||3f6||fffd||fffd||135||fffd| = -0.04 To -0.1 Step -0.01
'For |fffd||73a||fffd||fffd||3f6||fffd| = -0.01 To -0.08 Step -0.01



Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(, 15).Clear
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 0) = ">=" & 1
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 1) = "<=" & |fffd||fffd||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 2) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 3) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 4) = ">=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 5) = "<=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 6) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 7) = ">=" & |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 8) = "<>" & 0
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 9) = ">=" & |fffd||3f6||fffd||fffd||f0||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 10) = ">=" & |fffd||177||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 11) = ">=" & |fffd||177||fffd||fffd||fffd||77a||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 12) = "<=" & |fffd||3f6||fffd||fffd||135||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 13) = "<=" & |fffd||73a||fffd||fffd||3f6||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 14) = Cells(Rows.Count, |fffd||634||fffd||fffd|).End(3)


Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||4fd||fffd|2").Activate

With Sheets("|fffd||4fd||fffd|")
rngall.AdvancedFilter 2, Cells(1, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(2, 14), .Cells(1, 1)

If Application.Average(.Columns(|fffd||fffd||fffd||fffd|)) > 0.01 Then
If Application.CountA(.Columns(|fffd||fffd||fffd||fffd|)) > 10 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)

varTemp(r) = Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(, 15)
vartemp1(r) = Application.Average(.Columns(|fffd||fffd||fffd||fffd|))
vartemp2(r) = Application.CountA(.Columns(|fffd||fffd||fffd||fffd|))


End If
End If

End With


Next |fffd||177||fffd||fffd||fffd||fffd|
Next |fffd||3f6||fffd||fffd||f0||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||177||fffd||fffd||fffd||77a||fffd|



Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

For iii = 1 To UBound(varTemp, 1)
Cells(iii + 1, 1).Resize(, 15) = varTemp(iii)
Cells(iii + 1, 16) = vartemp1(iii)
Cells(iii + 1, 17) = vartemp2(iii)

Next iii

Erase varTemp
Erase vartemp1
Erase vartemp2
r = 0

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 16), key2:=Cells(1, 17), key3:=Cells(1, 4), order1:=xlDescending, order2:=xlDescending, order3:=xlDescending

If Cells(Rows.Count, 1).End(3).Row > 10 Then
uu = 10
Else
uu = Cells(Rows.Count, 1).End(3).Row
End If


Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Clear
Set rngall = Nothing


'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||63c||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||3f1||fffd|



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||634||fffd||fffd|) = Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, |fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|) Then

For ii = i To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||634||fffd||fffd|) <> Cells(ii, |fffd||634||fffd||fffd|) Then
ee = Cells(ii, |fffd||634||fffd||fffd|).Row
Exit For
End If
Next ii

For ii = ee To Cells(Rows.Count, 1).End(3).Row
If Cells(ee, |fffd||634||fffd||fffd|) <> Cells(ii, |fffd||634||fffd||fffd|) Or Cells(ii + 2, |fffd||634||fffd||fffd|) = "" Then
dd = Cells(ii - 1, |fffd||634||fffd||fffd|).Row
Exit For
End If
Next ii

Exit For
End If
Next i


Range(Cells(ee, 1), Cells(dd, |fffd||634||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)

Sheets("|fffd||4fd||fffd|2").Activate

Set rngall = Range("a1", Cells(Rows.Count, |fffd||634||fffd||fffd|).End(3))


With Sheets("|fffd||fffd||fffd||7b8||178||fffd|")

For i = 2 To uu
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| + 2).Resize(, 14) = Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| + 2).Resize(2, 14), .Cells(Rows.Count, 1).End(3)(2)
Next i
End With



Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear


Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Clear
Set rngall = Nothing

Next p



Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
If Cells(1, 1) = "" Then
Rows(1).Delete
End If


For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd|)

For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd|)


Application.Calculation = xlCalculationAutomatic
Application.EnableEvents = True


End Sub


Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||67e||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|()


Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| As Long
'Dim |fffd||73a||fffd||fffd||3f6||fffd| As Long





Application.Calculation = xlCalculationManual
Application.EnableEvents = False
Application.ScreenUpdating = False
On Error Resume Next





Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Cells(1, 1).Resize(, 18) = Array("|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|", "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd|")


For i = Cells(1, Columns.Count).End(1).Column To 1 Step -1

If Cells(1, i) = "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|" Then
|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If

Next i

Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| + 2).Resize(, 14) = Cells(1, 1).Resize(, 14).Value



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

If Cells(2, Columns.Count).End(1) <> "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|" Then
Cells(2, Columns.Count).End(1).Offset(, 2).Resize(, 15) = Array("|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||1f1||fffd||fffd||63f||fffd|")
End If

For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1

If Cells(2, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||1fd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||634||fffd||fffd|" Then
|fffd||634||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6ff||fffd|" Then
|fffd||fffd||fffd||6ff||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
Exit For
End If


Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)

'|fffd||634||fffd||fffd| update
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||634||fffd||fffd|) = Month(Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|))
Next i

Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 300) = Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Resize(, 300).Value




Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For p = 3 To Cells(Rows.Count, 1).End(3).Row


If Cells(p, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(p, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> Cells(p - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) Then

ee = p

For pp = p + 1 To Cells(Rows.Count, 1).End(3).Row

If Cells(pp, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> Cells(pp - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) Then
rr = rr + 1
End If

If rr > 70 Then
dd = pp - 1
ff = pp
rr = 0
Exit For
End If


Next pp

If rr > 0 Then
Exit For
End If



'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| |fffd||331||fffd| |fffd||fffd||fffd||fffd|


Range(Cells(ee, 1), Cells(dd, |fffd||634||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)

Sheets("|fffd||4fd||fffd|2").Activate


Set rngall = Range("a1", Cells(Rows.Count, |fffd||634||fffd||fffd|).End(3))



'For |fffd||fffd||fffd||fffd||fffd||fffd| = 0.02 To 0.06 Step 0.01
'For |fffd||fffd||fffd||fffd||fffd||fffd| = 1 To 2
For |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.9 To 1.1 Step 0.1
'For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.1
For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.5 Step 0.1
For |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
'For |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
For |fffd||3f6||fffd||fffd||f0||fffd| = 0.378 To 0.4 Step 0.003
For |fffd||177||fffd||fffd||fffd||fffd| = 200 To 300 Step 100
'For |fffd||177||fffd||fffd||fffd||77a||fffd| = 0.5 To 3 Step 0.5
'For |fffd||3f6||fffd||fffd||135||fffd| = -0.04 To -0.1 Step -0.01
'For |fffd||73a||fffd||fffd||3f6||fffd| = -0.01 To -0.08 Step -0.01



Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(, 15).Clear
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 0) = ">=" & 1
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 1) = "<=" & |fffd||fffd||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 2) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 3) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 4) = ">=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 5) = "<=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 6) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 7) = ">=" & |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 8) = "<>" & 0
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 9) = ">=" & |fffd||3f6||fffd||fffd||f0||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 10) = ">=" & |fffd||177||fffd||fffd||fffd||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 11) = ">=" & |fffd||177||fffd||fffd||fffd||77a||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 12) = "<=" & |fffd||3f6||fffd||fffd||135||fffd|
'Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 13) = "<=" & |fffd||73a||fffd||fffd||3f6||fffd|
Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd| + 14) = Cells(Rows.Count, |fffd||634||fffd||fffd|).End(3)


Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||4fd||fffd|2").Activate

With Sheets("|fffd||4fd||fffd|")
rngall.AdvancedFilter 2, Cells(1, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(2, 14), .Cells(1, 1)

If Application.Average(.Columns(|fffd||fffd||fffd||fffd|)) > 0.01 Then
If Application.CountA(.Columns(|fffd||fffd||fffd||fffd|)) > 10 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)

varTemp(r) = Cells(2, |fffd||fffd||fffd||1fd||fffd||fffd||fffd|).Resize(, 15)
vartemp1(r) = Application.Average(.Columns(|fffd||fffd||fffd||fffd|))
vartemp2(r) = Application.CountA(.Columns(|fffd||fffd||fffd||fffd|))


End If
End If

End With


Next |fffd||177||fffd||fffd||fffd||fffd|
Next |fffd||3f6||fffd||fffd||f0||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||177||fffd||fffd||fffd||77a||fffd|






Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

For iii = 1 To UBound(varTemp, 1)
Cells(iii + 1, 1).Resize(, 15) = varTemp(iii)
Cells(iii + 1, 16) = vartemp1(iii)
Cells(iii + 1, 17) = vartemp2(iii)

Next iii

Erase varTemp
Erase vartemp1
Erase vartemp2
r = 0


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 16), key2:=Cells(1, 17), key3:=Cells(1, 4), order1:=xlDescending, order2:=xlDescending, order3:=xlDescending


If Cells(Rows.Count, 1).End(3).Row >= 10 Then
uu = 10
Else
uu = Cells(Rows.Count, 1).End(3).Row
End If
 

Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Clear
Set rngall = Nothing





'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||63c||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||3f1||fffd|



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = ff + 1 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) Then
dd = i - 1
Exit For
End If

Next i



Range(Cells(ff, 1), Cells(dd, |fffd||634||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)



Sheets("|fffd||4fd||fffd|2").Activate

Set rngall = Range("a1", Cells(Rows.Count, |fffd||634||fffd||fffd|).End(3))


With Sheets("|fffd||fffd||fffd||7b8||178||fffd|")


For i = 2 To uu
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| + 2).Resize(, 14) = Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||377||fffd| + 2).Resize(2, 14), .Cells(Rows.Count, 1).End(3)(2)
Next i
End With


Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Clear
Set rngall = Nothing


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

End If

Next p


Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

If Cells(1, 1) = "" Then
Rows(1).Delete
End If



For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

Next i



ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd|)


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd|)

Rows(Cells(Rows.Count, 1).End(3).Row).Clear

Application.Calculation = xlCalculationAutomatic
Application.EnableEvents = True

End Sub


Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_|1af||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|()


Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long


'|fffd||fffd||fffd||fffd|
'6|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd| |fffd||5f0||fffd| 10|fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||334||b4||fffd|

Application.Calculation = xlCalculationManual
Application.EnableEvents = False
Application.DisplayAlerts = False
Application.ScreenUpdating = False
On Error Resume Next


'|fffd||fffd||fffd||7b8||178||17d||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Clear



'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||6b7||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Clear

'|fffd||fffd||fffd||1f5||fffd| 1|fffd||fe1| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Cells(1, 1).Resize(, 16) = Array("|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)", "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)", "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd|")

'head |fffd||338||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

'|fffd||fffd||fffd||1f5||fffd||fffd||fffd| |fffd||fe1| |fffd||fffd||fffd||fffd| |fffd||4f8||fffd| |fffd||fffd||fffd||fffd|
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14) = Cells(1, 1).Resize(, 14).Value

'|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Cells(1, 1).Resize(, 16) = Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 16).Value


'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'head |fffd||338||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

'|fffd||3f6||fffd||fffd||fffd||fffd||fffd|, |fffd||3f6||fffd||fffd||f0||fffd||fffd||3f7||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

'|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd| 1|fffd||fffd| |fffd||fffd||fffd||3b4||fffd| |fffd||5b0||fffd|
For i = 3 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = 1
Next i



'6|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||3f1||fffd| |fffd||77a||fffd|

qq = 0

'For tt = 1 To 1000
For a = 1 To 3

'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae| head |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 300) = Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Resize(, 300).Value

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| +90|fffd||3f7||fffd| |fffd||fffd||fffd||fffd||3ff||fffd| |fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) + 90
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) + 270


'|fffd||3f6||fffd||fffd||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||173||fffd| |169||fffd||678||fffd|
For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
rngalls = i
Exit For
End If
Next i

'|fffd||3f6||fffd||fffd||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||173||fffd| |169||fffd||678||fffd|
For i = rngalls + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
rngalle = i - 1
Exit For
End If
Next i


'rngall |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd| |fffd||4fd||fffd|2|fffd||fffd| |fffd||fffd||fffd||fffd|
Range(Cells(rngalls, 1), Cells(rngalle, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)

'|fffd||4fd||fffd|2 |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate

'rngall |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||77a||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |22e||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|

With Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|")

For |fffd||fffd||fffd||fffd||fffd||fffd| = 0.02 To 0.06 Step 0.01
For |fffd||fffd||fffd||fffd||fffd||fffd| = 2 To 6
For |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.9 To 1.1 Step 0.1
'For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.5 Step 0.1
For |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0 To 0.5 Step 0.1
For |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0.15 To 0.35 Step 0.05
'For |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = 0 To 0.3 Step 0.05
For |fffd||3f6||fffd||fffd||f0||fffd| = 0.381944444444444 To 0.43 Step 0.0034
For |fffd||177||fffd||fffd||fffd||fffd| = 150 To 400 Step 50
'For |fffd||177||fffd||fffd||fffd||77a||fffd| = 0.5 To 3 Step 0.5
For |fffd||3f6||fffd||fffd||135||fffd| = -0.02 To -0.05 Step -0.01
For |fffd||73a||fffd||fffd||3f6||fffd| = -0.01 To -0.03 Step -0.01


.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14).Clear
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 2) = ">=" & 1
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 3) = "<=" & |fffd||fffd||fffd||fffd||fffd||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 4) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 5) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 6) = "<=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 7) = "<=" & |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 8) = ">=" & |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
'.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 9) = ">=" & |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
'.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 10) = "<>" & 0
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 11) = ">=" & |fffd||3f6||fffd||fffd||f0||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 12) = ">=" & |fffd||177||fffd||fffd||fffd||fffd|
'.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 13) = ">=" & |fffd||177||fffd||fffd||fffd||77a||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 14) = ">=" & |fffd||3f6||fffd||fffd||135||fffd|
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 15) = ">=" & |fffd||73a||fffd||fffd||3f6||fffd|


'|fffd||4fd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd| |fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| |e3||fffd||fffd|
rngall.AdvancedFilter 2, .Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(2, 14), Cells(1, 1)

If Application.Average(Columns(|fffd||fffd||fffd||fffd||fffd||fffd|)) > 0.01 Then
If Application.CountA(Columns(|fffd||fffd||fffd||fffd||fffd||fffd|)) > 5 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)

varTemp(r) = .Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14)
vartemp1(r) = Application.Average(Columns(|fffd||fffd||fffd||fffd||fffd||fffd|))
vartemp2(r) = Application.CountA(Columns(|fffd||fffd||fffd||fffd||fffd||fffd|))

End If
End If


Next |fffd||73a||fffd||fffd||3f6||fffd|
Next |fffd||3f6||fffd||fffd||135||fffd|
Next |fffd||177||fffd||fffd||fffd||fffd|
Next |fffd||3f6||fffd||fffd||f0||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd|
Next |fffd||fffd||fffd||fffd||fffd||fffd|
'Next |fffd||177||fffd||fffd||fffd||77a||fffd|

End With


'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||1fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

For iii = 1 To UBound(varTemp, 1)
Cells(iii + 1, 1).Resize(, 14) = varTemp(iii)
Cells(iii + 1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd|) = vartemp1(iii)
Cells(iii + 1, |fffd||fffd||fffd||fffd||fffd||fffd|) = vartemp2(iii)

Next iii

Erase varTemp
Erase vartemp1
Erase vartemp2
r = 0

'|fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending, order3:=xlDescending


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Delete

'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Delete
Set rngall = Nothing

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) Then
rngalls = i
Exit For
End If
Next i

For i = rngalls + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) Then
rngalle = i - 1
Exit For
End If
Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Range(Cells(rngalls, 1), Cells(rngalle, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)


'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate

'rngall |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||ff||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| |fffd||330||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||67d||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||4fd||fffd|").Activate

With Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|")
For i = 2 To .Cells(Rows.Count, 1).End(3).Row
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14) = .Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, .Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(2, 14), Cells(1, 1)

.Cells(i, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd|) = Application.Average(Columns(|fffd||fffd||fffd||fffd||fffd||fffd|))
.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Application.CountA(Columns(|fffd||fffd||fffd||fffd||fffd||fffd|))

ActiveSheet.UsedRange.Clear

Next i
End With

'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||1fd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending, order3:=xlDescending


'1.8% |fffd||33b||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = a
If Cells(i, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd|) < 0.018 Then
be = i - 1
Exit For
End If
Next i

Range(Cells(2, 1), Cells(be, |fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2)


'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 3|fffd||fffd||fffd||fffd| |fffd||137||fffd| |fffd||170||736||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) + 90

Set rngall = Nothing

Next a

End Sub

Sub fdjalkfjal()


'|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||1ff||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending


Range("a2", Cells(Cells(Rows.Count, 1).End(3).Row, Cells(1, Columns.Count).End(1).Column)).Copy Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1)


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Delete

'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Delete
Set rngall = Nothing

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) + 1
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) + 20

If Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
Exit For
End If


For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) Then
rngalls = i
Exit For
End If
Next i

For i = rngalls + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) Then
rngalle = i - 1
Exit For
End If
Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Range(Cells(rngalls, 1), Cells(rngalle, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)


'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate


'rngall |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))

'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||ff||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| |fffd||330||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||67d||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate


With Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|")
For i = 2 To .Cells(Rows.Count, 1).End(3).Row
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14) = .Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, .Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(2, 14), Cells(Rows.Count, 1).End(3)(2)
Next i
End With


'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear

Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 250
Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value


Next tt



Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

If Cells(1, 1) = "" Then
Rows(1).Delete
End If


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending



Range(Cells(Rows.Count, 1).End(3), Cells(Rows.Count, Columns.Count)).Delete

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(3, 1).Value
Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(3, 1).Value

Application.Calculation = xlCalculationAutomatic
Application.EnableEvents = True
Application.DisplayAlerts = True

End Sub

Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_|fffd||5b0||fffd||fffd||1fc||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long


'|fffd||fffd||fffd||fffd|
'6|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd| |fffd||5f0||fffd| 10|fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||334||b4||fffd|

Application.Calculation = xlCalculationManual
Application.EnableEvents = False
Application.DisplayAlerts = False
Application.ScreenUpdating = False
On Error Resume Next




'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||6b7||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

Range("a1", Cells(Cells(Rows.Count, 1).End(3).Row, Cells(1, Columns.Count).End(1).Column)).Copy Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1)


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
'head |fffd||338||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

'|fffd||fffd||fffd||1f5||fffd||fffd||fffd| |fffd||fe1| |fffd||fffd||fffd||fffd| |fffd||4f8||fffd| |fffd||fffd||fffd||fffd|
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14) = Cells(1, 1).Resize(, 14).Value



'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'head |fffd||338||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

'|fffd||3f6||fffd||fffd||fffd||fffd||fffd|, |fffd||3f6||fffd||fffd||f0||fffd||fffd||3f7||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending


'|fffd||fffd||fffd||7b8||178||17d||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Clear


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Delete

'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Delete
Set rngall = Nothing

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) + 1
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) + 60

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) Then
rngalls = i
Exit For
End If
Next i

For i = rngalls + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) Then
rngalle = i - 1
Exit For
End If
Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Range(Cells(rngalls, 1), Cells(rngalle, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)


'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||4fd||fffd|2").Activate

'rngall |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||ff||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| |fffd||330||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||67d||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||4fd||fffd|").Activate

With Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|")
For i = 2 To .Cells(Rows.Count, 1).End(3).Row
.Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(, 14) = .Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, .Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd| + 2).Resize(2, 14), Cells(Rows.Count, 1).End(3)(2)
Next i
End With


If Cells(1, 1) = "" Then
Rows(1).Delete
End If


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending



Range(Cells(Rows.Count, 1).End(3), Cells(Rows.Count, Columns.Count)).Delete

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(3, 1).Value
Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd||fffd||fffd|) = Cells(3, 1).Value

End Sub

Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||3bf||fffd||fffd||3f4||b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()



Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| As Long
'Dim |fffd||73a||fffd||fffd||3f6||fffd| As Long

Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate


For i = Cells(1, Columns.Count).End(1).Column To 1 Step -1

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If


Next i


'For i = 2 To Cells(Rows.Count, 1).End(3).Row
'If Cells(i, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|) <= 0.019 Then
'uu = i
'Exit For
'End If
'Next i

uu = Cells(Rows.Count, 1).End(3).Row
 

Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Delete
Cells(1, 1).Resize(, 300) = Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Resize(, 300).Value


Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Delete



'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||63c||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||3f1||fffd|



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
tt = i
Exit For
End If
Next i

For i = tt + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
mm = i - 1
Exit For
End If
Next i


Range(Cells(tt, 1), Cells(mm, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)

Sheets("|fffd||4fd||fffd|2").Activate

Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))


With Sheets("|fffd||fffd||fffd||7b8||178||fffd|")

For i = 2 To uu
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, |fffd||fffd||fffd||fffd| + 2).Resize(, 14) = Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, |fffd||fffd||fffd||fffd| + 2).Resize(2, 14), .Cells(1, 1)

r = r + 1
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)

vartemp1(r) = Application.Average(.Columns(|fffd||fffd||fffd||fffd|))
vartemp2(r) = Application.CountA(.Columns(|fffd||fffd||fffd||fffd|))

Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||4fd||fffd|2").Activate
Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))

Next i
End With


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

If r > 0 Then
For iii = 1 To UBound(vartemp1, 1)
Cells(iii + 1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|) = vartemp1(iii)
Cells(iii + 1, |fffd||fffd||fffd||fffd|) = vartemp2(iii)

Next iii
End If

Erase vartemp1
Erase vartemp2
r = 0


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd|)

End Sub

Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||3bf||fffd||fffd||3f4||b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()



Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd| As Long
'Dim |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| As Long
'Dim |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| As Long
'Dim |fffd||73a||fffd||fffd||3f6||fffd| As Long


Application.Calculation = xlCalculationManual
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.DisplayAlerts = False
On Error Resume Next


Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
 With ActiveSheet.UsedRange.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    

For i = Cells(1, Columns.Count).End(1).Column To 1 Step -1

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

Next i

'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|), order1:=xlDescending

'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd| 1.8% |fffd||33b||fffd||fffd||fffd| |fffd||fffd||fffd||1f8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||1ff||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|) <= 0.022 Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i - 1
Exit For
End If
Next i


Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Delete
Cells(1, 1).Resize(, 300) = Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Resize(, 300).Value


Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Delete



'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae| |fffd||fffd||fffd||fffd||fffd||63c||fffd| |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||6b7||1fe1| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = Cells(2, Columns.Count).End(1).Column To 1 Step -1

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||6ff||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If


Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

For i = 3 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = 1
Next i

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
tt = i
Exit For
End If
Next i

For i = tt To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) >= Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
mm = i - 1
Exit For
End If
Next i


Range(Cells(tt, 1), Cells(mm, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Copy Sheets("|fffd||4fd||fffd|2").Cells(2, 1)

Sheets("|fffd||4fd||fffd|2").Activate

Set rngall = Range("a1", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))


Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Delete

Sheets("|fffd||4fd||fffd|2").Activate


With Sheets("|fffd||fffd||fffd||7b8||178||fffd|")
For i = 2 To |fffd||17c||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, |fffd||fffd||fffd||fffd| + 2).Resize(, 14) = Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, 14).Value
rngall.AdvancedFilter 2, Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, |fffd||fffd||fffd||fffd| + 2).Resize(2, 14), .Cells(Rows.Count, 1).End(3)(2)

'If .Cells(Rows.Count, 1).End(3) <> "|fffd||fffd||a5|" Then
'Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, |fffd||fffd||fffd||fffd|).Interior.Color = 255
'End If

Next i

End With


Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

If Cells(1, 1) = "" Then
Rows(1).Delete
End If



ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(1, |fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


Range(Cells(Rows.Count, 1).End(3), Cells(Rows.Count, Columns.Count)).Delete

Application.Calculation = xlCalculationAutomatic
Application.EnableEvents = True
Application.DisplayAlerts = True


End Sub


Sub |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||e3||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||178||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Dim rngall As Range
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd| As Long

Application.ScreenUpdating = False
On Error Resume Next


'|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

    With ActiveSheet.UsedRange.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With

'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| head|fffd||fffd| |fffd||5b0||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
Exit For
End If

Next i

Cells(1, |fffd||fffd||fffd||fffd| + 1).Resize(2, 100).Clear
Cells(1, |fffd||fffd||fffd||fffd| + 2).Resize(, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(1, 1).Resize(, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value


'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|), order1:=xlDescending

'|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd| 1.8% |fffd||33b||fffd||fffd||fffd| |fffd||fffd||fffd||1f8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||1ff||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|) < 0.022 Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i - 1
Exit For
End If
Next i


'|fffd||fffd||fffd||7b8||178||17d||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ActiveSheet.UsedRange.Delete


'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| head|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| data |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd| head|fffd||fffd| |fffd||5b0||fffd|
For i = 1 To Cells(2, Columns.Count).End(1).Column

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

For i = 3 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = 1
Next i


'|fffd||fffd||a5|,|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3f0||fffd|
'ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlDescending

'For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
'If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
'Rows(i).Clear
'End If
'Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||a5|), key2:=Cells(2, |fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd| data|fffd||fffd| |fffd||fffd||fffd||63c||fffd|
Set rngall = Range("a2", Cells(Rows.Count, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))

    
With Sheets("|fffd||fffd||fffd||7b8||178||fffd|")
For i = 2 To |fffd||17c||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(2, |fffd||fffd||fffd||fffd| + 2).Resize(, 9) = Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, 9).Value
rngall.AdvancedFilter 2, Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(1, |fffd||fffd||fffd||fffd| + 2).Resize(2, 9), .Cells(Rows.Count, 1).End(3)(2)

If .Cells(Rows.Count, 1).End(3) <> "|fffd||fffd||a5|" Then
Sheets("|fffd||fffd||fc||fffd||2c23||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1).Resize(, |fffd||fffd||fffd||fffd|).Interior.Color = 255
End If

Next i

End With


Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

If Cells(1, 1) = "" Then
Rows(1).Delete
End If

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||a5|), key2:=Cells(1, |fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||fffd||a5|) <> "" And Cells(i, |fffd||fffd||a5|) = Cells(i - 1, |fffd||fffd||a5|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||a5|), key2:=Cells(1, |fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending


Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete

Application.Calculation = xlCalculationAutomatic
Application.EnableEvents = True

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With Cells(2, 1).Interior
.Pattern = xlNone
.TintAndShade = 0
.PatternTintAndShade = 0
End With


Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Activate

End Sub



Sub |fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||3f4||fffd||fffd||fffd||fffd||fffd||e3||fffd||1b3||fffd||fffd||fffd|_|223||fffd||fffd||e2|()


Dim rngall As Range
Dim rngC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

   

On Error Resume Next


Sheets("test").UsedRange.Clear
Sheets("test2").UsedRange.Clear

Sheets("test3").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||2ba||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd| = i
End If


Next i




Aa = 0
r = 0

Set rngall = Range("A1", Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3))

For a = 12000 To 100000 Step 1000
For b = 0 To 15 Step 1
For C = 0 To 0.02 Step 0.002
For D = 0 To 0.02 Step 0.002
For e = 0 To 0.2 Step 0.01

Sheets("test3").Activate

With Sheets("|fffd||fffd||fffd||fffd|").Cells(1, 8)
.Offset(1, 0) = ">" & a
.Offset(1, 1) = ">" & b
.Offset(1, 2) = ">" & C
.Offset(1, 3) = ">" & D
.Offset(1, 4) = ">" & e


End With


Sheets("test").Activate
ActiveSheet.UsedRange.Clear

rngall.AdvancedFilter 2, Sheets("|fffd||fffd||fffd||fffd|").Cells(1, 8).Resize(2, 6), Cells(1, 1)
                                                                          

If Application.Average(Columns(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)) > 0.14 Then
If Application.CountA(Columns(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)) > 10 Then
r = r + 1
ReDim Preserve varTemp(1 To r)
ReDim Preserve vartemp1(1 To r)
ReDim Preserve vartemp2(1 To r)

varTemp(r) = Sheets("|fffd||fffd||fffd||fffd|").Cells(2, 8).Resize(, 5)
vartemp1(r) = Application.Average(Columns(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|))
vartemp2(r) = Application.CountA(Columns(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|))

End If
End If


If r > 10 Then
Aa = Aa + 1
   Set wkBk = Workbooks.Add
      
Cells(1, 1).Resize(, 7) = Array("|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd|")


For i = 1 To UBound(varTemp, 1)
Cells(Rows.Count, 1).End(3)(2).Resize(, 5) = varTemp(i)
Cells(Rows.Count, 6).End(3)(2) = vartemp1(i)
Cells(Rows.Count, 7).End(3)(2) = vartemp2(i)

Next i


Erase varTemp
Erase vartemp1
Erase vartemp2

r = 0

wkBk.SaveAs strPath & Aa & ".xlsx"
   wkBk.Close True
   
    

End If



Next e
Next D
Next C
Next b
Next a

Set rngall = Nothing

End Sub



Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||63c||fffd||fffd||fffd||fffd||fffd||fffd||4b6||fffd||fffd||fffd||fffd||371||770||fffd||fffd||fffd||3f1||fffd|()


Application.ScreenUpdating = False
On Error Resume Next
 
'--- |fffd||fffd||fffd||fffd||fffd||3f1||fffd|---

Sheets("|fffd||fffd||fffd||371||770||fffd||fffd|").Activate

For i = 2 To Columns(1).SpecialCells(2).Count
If Cells(i, 7) <> "" Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), _
key3:=Cells(1, 7), order1:=xlAscending, order2:=xlAscending, order3:=xlDescending

Sheets("|fffd||fffd||fffd||377||fffd|").Activate

Cells(Rows.Count, 1).End(3).Resize(, 100).Clear

rowsCnt = Columns(1).SpecialCells(2).Count
colsCnt = Rows(1).SpecialCells(2).Count


Sheets("|fffd||fffd||fffd||371||770||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(rowsCnt, colsCnt) = Cells(2, 1).Resize(rowsCnt, colsCnt).Value



Sheets("|fffd||fffd||fffd||371||770||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), _
key3:=Cells(1, 7), order1:=xlAscending, order2:=xlAscending, order3:=xlDescending

'--- |fffd||f0||fffd||fffd||fffd||121||fffd||b0||fffd| |fffd||fffd||fffd||fffd| ---

rowsCnt = Columns(1).SpecialCells(2).Count


'--- head |fffd||fffd||fffd||fffd| ---
For i = 1 To Rows(1).SpecialCells(2).Count

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||77e||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||77e||fffd| = i
End If


If Cells(1, i) = "|fffd||6ba||fffd|" Then
|fffd||6ba||fffd| = i
End If
 

Next i

 

'--- |fffd||fffd||fffd||fffd||fffd||77e||fffd|,|fffd||6ba||fffd| 10000|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ---
Cells(2, |fffd||fffd||fffd||fffd||fffd||77e||fffd|).Resize(100000, 1000).Clear
Cells(2, |fffd||fffd||fffd||fffd||fffd||77e||fffd|).Resize(rowsCnt - 1, 2) = 10000 '|fffd||fffd||fffd||fffd||fffd||77e||fffd||fffd||fffd| 1|fffd||fffd|


'--- |fffd||77a||fffd||fffd||fffd||fffd||fffd| ---
For i = 3 To rowsCnt '3|fffd||fffd||fffd||fffd||fffd| |fffd||77a||fffd|

If Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) >= 0.8 Then
m = Cells(i - 1, |fffd||6ba||fffd|) / 12 '|fffd||fffd||fffd||6b1||77e||fffd||fffd||fffd||fffd||3f1||fffd|
End If

If Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) < 0.8 And Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) >= 0.6 Then
m = Cells(i - 1, |fffd||6ba||fffd|) / 14 '|fffd||77e||fffd||fffd||fffd||fffd||3f1||fffd|
End If

If Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) < 0.6 And Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) >= 0.4 Then
m = Cells(i - 1, |fffd||6ba||fffd|) / 16 '|fffd||fffd||fffd||6b1||77e||fffd||fffd||fffd||fffd||3f1||fffd|
End If

If Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) < 0.4 And Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) >= 0.2 Then
m = Cells(i - 1, |fffd||6ba||fffd|) / 18 '|fffd||fffd||fffd||6b1||77e||fffd||fffd||fffd||fffd||3f1||fffd|
End If

If Cells(i, |fffd||6ba||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) < 0.2 Then
m = Cells(i - 1, |fffd||6ba||fffd|) / 20 '|fffd||fffd||fffd||6b1||77e||fffd||fffd||fffd||fffd||3f1||fffd|
End If



If Cells(i - 1, |fffd||6ba||fffd|) > 0 Then '|fffd||fffd||fffd||fffd| |fffd||5b4||678||fffd|
If Cells(i, |fffd||175||fffd||fffd||fffd|) <> "" Then '|fffd||fffd||fffd||fe1| |fffd||175||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Cells(i, |fffd||7f8||fffd||fffd||fffd|) = "" Then '|fffd||7f8||170||fffd| |fffd||fffd||fffd||678||fffd|

Cells(i, Columns.Count).End(1).Offset(, 2) = -m '200|fffd||fffd||fffd||fffd||121| |fffd||17c||fffd||fffd||fffd| |fffd||1fe||fffd||fffd||fffd|

Add = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|)

For a = 1 To Add
If Cells(i + a, 7) <> "" Then
r = r + 1
End If
Next a

For a = 1 To r
If Cells(i + Add + a, 7) <> "" Then
rr = rr + 1
End If
Next a

Add = Add + r + rr
r = 0
rr = 0


Cells(i + Add, Columns.Count).End(1).Offset(, 4) = m * Cells(i, |fffd||175||fffd||fffd||fffd|)
Cells(i + Add, Columns.Count).End(1).Offset(, 1) = m

Else

Cells(i, Columns.Count).End(1).Offset(, 2) = -m '200|fffd||fffd||fffd||fffd||121| |fffd||17c||fffd||fffd||fffd| |fffd||1fe||fffd||fffd||fffd|

Add = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|)

For a = 1 To Add
If Cells(i + a, 7) <> "" Then
r = r + 1
End If
Next a

For a = 1 To r
If Cells(i + Add + a, 7) <> "" Then
rr = rr + 1
End If
Next a

Add = Add + r + rr
r = 0
rr = 0


Cells(i + Add, Columns.Count).End(1).Offset(, 4) = m * Cells(i, |fffd||175||fffd||fffd||fffd|)
Cells(i + Add, Columns.Count).End(1).Offset(, 1) = 2 * m

add2 = Cells(i, |fffd||7f8||fffd||fffd||fffd|)

For a = 1 To add2
If Cells(i + a, 7) <> "" Then
r = r + 1
End If
Next a

For a = 1 To r
If Cells(i + add2 + a, 7) <> "" Then
rr = rr + 1
End If
Next a

add2 = add2 + r + rr
r = 0
rr = 0

Cells(i + add2, Columns.Count).End(1).Offset(, 2) = -m '200|fffd||fffd||fffd||fffd||121| |fffd||17c||fffd||fffd||fffd| |fffd||1fe||fffd||fffd||fffd|


End If
End If
End If

Cells(i, |fffd||6ba||fffd|) = Cells(i - 1, |fffd||6ba||fffd|) + Application.Sum(Cells(i, |fffd||6ba||fffd| + 1).Resize(, 100))

For CC = |fffd||6ba||fffd| + 1 To |fffd||6ba||fffd| + 100
If Cells(i, CC) <> "" And Cells(i, CC + 1) <> "" Then
fff = fff + Cells(i, CC)
End If
Next CC

Cells(i, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||77e||fffd|) + fff
fff = 0
Next i

End Sub


   Sub |fffd||fffd||fffd||377||fffd||fffd||fffd||121||fffd||fffd|()

'|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd|-0.02|fffd||fffd||fffd||fffd|/|fffd||177||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||33b||fffd|/|fffd||fffd||fffd||fffd||fffd||2c23|4|fffd||33b||fffd|

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  ActiveSheet.UsedRange.Offset(1).Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2)
  
   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 8), key3:=Cells(1, 3), order1:=xlAscending, order2:=xlDescending, order3:=xlDescending

  


        End Sub



   Sub |fffd||fffd||fffd||377||fffd||fffd||fffd||121||fffd||fffd|_|223||fffd||fffd||e2|()

'|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd|-0.02|fffd||fffd||fffd||fffd|/|fffd||177||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||33b||fffd|/|fffd||fffd||fffd||fffd||fffd||2c23|4|fffd||33b||fffd|

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||1f5||fffd|").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 7) = Array("|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd|")

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||2ba||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

Next i


   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  ActiveSheet.UsedRange.Offset(1).Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||1f5||fffd|").Cells(Rows.Count, 1).End(3)(2)
  
   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||1f5||fffd|").Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||fffd||377||fffd|), order1:=xlDescending, order2:=xlDescending




        End Sub



Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|()

Dim varTemp()
Dim rngall As Range                                '|fffd||fffd||fc| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        '|fffd||fffd||fc| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    


Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
Sheets("|fffd||fffd||fffd||1f5||fffd|").UsedRange.Offset(1).Clear
Sheets("|fffd||4fd||fffd|").UsedRange.Clear


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 8), key3:=Cells(1, 3), order1:=xlAscending, order2:=xlDescending, order3:=xlDescending
r = 1
For i = 2 To Columns(1).SpecialCells(2).Count
If Cells(i, 1) = Cells(i + 1, 1) Then
Cells(i, 9) = r

Else
Cells(i, 9) = r
r = r + 1

End If
Next i

r = 0

For i = 1 To Cells(Rows.Count, 9).End(3).Value '|fffd||f0||fffd||fffd||beb0||fffd||fffd| |fffd||77a||fffd|

Sheets("|fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|").Activate
Set rngall = Range("a1", Cells(Rows.Count, "i").End(3)) '|fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||fffd| rngall|fffd||fffd| |fffd||fffd||fffd||fffd|

Cells(1, Columns.Count).End(1).Offset(1) = "=" & i '|fffd||f0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd|


rngall.AdvancedFilter 2, Cells(1, Columns.Count).End(1).Resize(2), Sheets("|fffd||4fd||fffd|").Cells(1, 1) '|fffd||f0||fffd||fffd||fffd||fffd||1ff||fffd| |fffd||fffd||fffd||fffd| |fffd||4fd||fffd|sheet|fffd||fffd| |fffd||fffd||fffd||fffd|


Sheets("|fffd||4fd||fffd|").Activate '|fffd||4fd||fffd| sheet |230||fffd||fffd||22d|

Aa = 0.052  '|f9| |fffd||fffd||fffd||377||fffd| aa|fffd||fffd| |fffd||fffd||fffd||fffd|
For a = 2 To Columns(1).SpecialCells(2).Count '|fffd||fffd||fffd||fffd||fffd||16d| |fffd||77a||fffd|
If Cells(a, 7) >= Aa Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| aa |fffd||fffd||fffd||fffd| |169||fffd||fffd|
r = r + 1     'r|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||f8||fffd||fffd||fffd|
ReDim Preserve varTemp(1 To r) '|fffd||fffd||fffd||fffd||fffd||8fed| |fffd||f8||fffd||fffd||fffd|
varTemp(r) = Cells(a, 1).Resize(, 10) '|fffd||8fed||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| aa |fffd||fffd||fffd||fffd| |16b| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Aa = Aa + 0.001 'aa|fffd||fffd| 0.001|fffd||fffd||16d| |fffd||fffd||fffd||377||fffd| |fffd||f8||fffd|
End If
Next a

Sheets("|fffd||4fd||fffd|").UsedRange.Clear '|fffd||4fd||fffd| sheet |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
r = 0

Sheets("|fffd||fffd||fffd||1f5||fffd|").Activate '|fffd||fffd||fffd||1f5||fffd| sheet |230||fffd||fffd||22d|

For u = 1 To UBound(varTemp, 1) '|fffd||8fed||fffd||fffd||16d| |fffd||77a||fffd|
Cells(Rows.Count, 1).End(3)(2).Resize(, 10) = varTemp(u) '|fffd||8fed||fffd||fffd| |fffd||6b7||fffd| |fffd||fffd||fffd||1f5||fffd|sheet|fffd||fffd| |fffd||fffd||fffd||fffd|
Next u

Erase varTemp '|fffd||8fed| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Next i


Set rngall = Nothing ' rngall |fffd||fffd| |fffd||fffd||fffd||fffd|



Sheets("|fffd||fffd||fffd||377||fffd|").UsedRange.Offset(1).Clear '|fffd||fffd||fffd||377||fffd|sheet |fffd||fffd||fffd||7ba70||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd| |230||fffd||fffd||22d|

                          
Set rngall = Range("A1", Cells(Rows.Count, "ad").End(3)) '|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fc| |fffd||fffd||fffd||fffd| rngall|fffd||fffd| |fffd||5b1||fffd|


With Sheets("|fffd||fffd||fffd||1f5||fffd|") '|fffd||fffd||fffd||1f5||fffd| sheet|fffd||fffd||fffd||fffd|

For i = 2 To .Columns(1).SpecialCells(2).Count '|fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||16d| |fffd||77a||fffd|
.Cells(2, 10).Resize(, 6) = .Cells(i, 1).Resize(, 6).Value '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1f8||fffd||fffd||fffd||fffd|
.Cells(2, 10) = .Cells(2, 10)


With Sheets("|fffd||fffd||fffd||377||fffd|") '|fffd||fffd||fffd||377||fffd| sheet|fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd| |230||fffd||fffd||22d|
Set rngall = Range("A1", Cells(Rows.Count, "ad").End(3)) '|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fc| |fffd||fffd||fffd||fffd| rngall|fffd||fffd| |fffd||5b1||fffd|
rngall.AdvancedFilter 2, Sheets("|fffd||fffd||fffd||1f5||fffd|").Cells(1, 10).Resize(2, 6), .Cells(Rows.Count, 1).End(3)(2) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                                                                          
End With

Next i

End With

Set rngall = Nothing


Sheets("|fffd||fffd||fffd||377||fffd|").Activate '|fffd||fffd||fffd||377||fffd| sheet|fffd||fffd||fffd||fffd|


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, 7) '|fffd||fffd||a5|,|fffd||f0||fffd|,|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

For i = Columns(1).SpecialCells(2).Count To 2 Step -1 '|fffd||7fa||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then
If Cells(i, 7) = Cells(i - 1, 7) Then

Rows(i).Clear

End If
End If
End If



Next i
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, 7) ''|fffd||fffd||a5|,|fffd||f0||fffd|,|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|



End Sub


Sub |fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|()


Dim |fffd||fffd||fffd||fffd| As Range
Dim CC As Range
Dim varTemp()
Dim rngall As Range                                '|fffd||fffd||fc| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        '|fffd||fffd||fc| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    


Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
Sheets("|fffd||17c||fffd||fffd||fffd||fffd||fffd|").UsedRange.Clear
Sheets("|fffd||17c||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100) = Cells(2, 1).Resize(, 100).Value


Set rngall = Range("a2", Cells(Cells(Rows.Count, 1).End(3).Row, Cells(2, Columns.Count).End(1).Column))

With Sheets("|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd|") '|fffd||fffd||fffd||1f5||fffd| sheet|fffd||fffd||fffd||fffd|

For i = 2 To .Cells(Rows.Count, 1).End(3).Row
.Cells(2, 11).Resize(, 7) = .Cells(i, 1).Resize(, 7).Value '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1f8||fffd||fffd||fffd||fffd|

rngall.AdvancedFilter 2, .Cells(1, 11).Resize(2, 7), Sheets("|fffd||17c||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                                                                          
Next i

End With

Set rngall = Nothing


Sheets("|fffd||17c||fffd||fffd||fffd||fffd||fffd|").Activate '|fffd||fffd||fffd||377||fffd| sheet|fffd||fffd||fffd||fffd|


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlDescending, order2:=xlDescending

For i = Columns(1).SpecialCells(2).Count To 2 Step -1 '|fffd||7fa||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then
Rows(i).Clear
End If
End If
Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending

Set C = Rows(1).Find("|fffd||fffd||fffd||377||fffd|", lookat:=xlWhole)

Cells(Rows.Count, C.Column).End(3)(2) = Application.Average(Columns(C.Column))




For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

Next i



With Sheets("|fffd||fffd||fffd||fffd|")

For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set |fffd||fffd||fffd||fffd| = .Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not |fffd||fffd||fffd||fffd| Is Nothing Then

For ii = 1 To 100
If Year(Cells(i, 1)) = .Cells(|fffd||fffd||fffd||fffd|.Row, ii) Then
Cells(i, |fffd||fffd||fffd||fffd||fffd|) = .Cells(|fffd||fffd||fffd||fffd|.Row + 1, ii - 1).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(|fffd||fffd||fffd||fffd|.Row + 9, ii - 1).Value
Cells(i, |fffd||fffd||fffd|) = .Cells(|fffd||fffd||fffd||fffd|.Row + 13, ii - 1).Value
Exit For
End If
Next ii

End If

Next i

End With




Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete


'Call |fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|_|1a2||fffd||b3||fffd|


End Sub

Sub dfjlaja()

Cells(Rows.Count, 1).End(3)(2) = Year(Cells(2, 1))



End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|_|223||fffd||fffd||e2|()

Dim varTemp()
Dim rngall As Range                                '|fffd||fffd||fc| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                        '|fffd||fffd||fc| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    


Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||1f5||fffd|").Activate
Sheets("test").UsedRange.Clear
Sheets("test2").UsedRange.Clear


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 7), key2:=Cells(1, 6), order1:=xlDescending, order2:=xlDescending

Aa = 0.14  '|f9| |fffd||fffd||fffd||377||fffd| aa|fffd||fffd| |fffd||fffd||fffd||fffd|
For a = 2 To Cells(Rows.Count, 1).End(3).Row '|fffd||fffd||fffd||fffd||fffd||16d| |fffd||77a||fffd|
If Cells(a, 6) >= Aa Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| aa |fffd||fffd||fffd||fffd| |169||fffd||fffd|
r = r + 1     'r|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||f8||fffd||fffd||fffd|
ReDim Preserve varTemp(1 To r) '|fffd||fffd||fffd||fffd||fffd||8fed| |fffd||f8||fffd||fffd||fffd|
varTemp(r) = Cells(a, 1).Resize(, 10) '|fffd||8fed||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| aa |fffd||fffd||fffd||fffd| |16b| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Aa = Aa + 0.002 'aa|fffd||fffd| 0.001|fffd||fffd||16d| |fffd||fffd||fffd||377||fffd| |fffd||f8||fffd|
End If
Next a

r = 0

Sheets("test").Activate '|fffd||fffd||fffd||1f5||fffd| sheet |230||fffd||fffd||22d|
ActiveSheet.UsedRange.Clear '|fffd||4fd||fffd| sheet |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Cells(1, 1).Resize(, 10) = Sheets("|fffd||fffd||fffd||1f5||fffd|").Cells(1, 1).Resize(, 10).Value


For u = 1 To UBound(varTemp, 1) '|fffd||8fed||fffd||fffd||16d| |fffd||77a||fffd|
Cells(Rows.Count, 1).End(3)(2).Resize(, 10) = varTemp(u) '|fffd||8fed||fffd||fffd| |fffd||6b7||fffd| |fffd||fffd||fffd||1f5||fffd|sheet|fffd||fffd| |fffd||fffd||fffd||fffd|
Next u

Erase varTemp '|fffd||8fed| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Columns("f:g").Delete
Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd|)"
Cells(2, Cells(1, Columns.Count).End(1).Column).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = "<29.7"


Sheets("|fffd||fffd||fffd||377||fffd|").UsedRange.Clear '|fffd||fffd||fffd||377||fffd|sheet |fffd||fffd||fffd||7ba70||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||377||fffd|").Cells(1, 1).Resize(, 100) = Sheets("test3").Cells(1, 1).Resize(, 100).Value


Sheets("test3").Activate '|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd| |230||fffd||fffd||22d|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 20) = Sheets("test").Cells(1, 1).Resize(, 20).Value

For i = 2 To Sheets("test").Cells(Rows.Count, 1).End(3).Row '|fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||16d| |fffd||77a||fffd|
Cells(2, 14).Resize(, 20) = Sheets("test").Cells(i, 1).Resize(, 20).Value

Set rngall = Range("A1", Cells(Rows.Count, "m").End(3)) '|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fc| |fffd||fffd||fffd||fffd| rngall|fffd||fffd| |fffd||5b1||fffd|


With Sheets("|fffd||fffd||fffd||377||fffd|") '|fffd||fffd||fffd||377||fffd| sheet|fffd||fffd||fffd||fffd|
rngall.AdvancedFilter 2, Cells(1, 14).Resize(2, 6), .Cells(Rows.Count, 1).End(3)(2) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                                                                          
End With

Next i

Set rngall = Nothing
Cells(1, 14).Resize(2, 100).Clear


Sheets("|fffd||fffd||fffd||377||fffd|").Activate '|fffd||fffd||fffd||377||fffd| sheet|fffd||fffd||fffd||fffd|

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 4), order1:=xlAscending, order2:=xlDescending


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1 '|fffd||7fa||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then

Rows(i).Clear

End If
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 4), order1:=xlAscending, order2:=xlDescending
ActiveSheet.UsedRange.AutoFit


End Sub
  Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear

   Do While fileName <> ""

 

   Workbooks.Open (strPath & fileName)
  
  
  
  '|fffd||3f0||fffd||fffd||fffd||fffd||3f4||b9||fffd|
  


  
  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           Header:=xlYes
    End With
  

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 15) = Array("|fffd||5b0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||2c23|", "|fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||370||fffd|", "|fffd||7f8||170||fffd|", "|fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||7f8||fffd||fffd||fffd|", _
"|fffd||7f8||fffd||23d||fffd||fffd|", "|fffd||175||fffd||fffd||f0||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||fffd||57c||fffd||fffd||377||fffd|")


For i = 1 To Rows(1).SpecialCells(2).Count

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2c23|" Then
|fffd||fffd||fffd||fffd||fffd||2c23| = i
End If

If Cells(1, i) = "|fffd||135||fffd|" Then
|fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||370||fffd|" Then
|fffd||fffd||fffd||370||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||170||fffd|" Then
|fffd||7f8||170||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||570||fffd|" Then
|fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||fffd||fffd|" Then
|fffd||7f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7f8||fffd||23d||fffd||fffd|" Then
|fffd||7f8||fffd||23d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||f0||fffd|" Then
|fffd||175||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||57c||fffd||fffd||377||fffd|" Then
|fffd||fffd||57c||fffd||fffd||377||fffd| = i
End If


Next i


rowsCnt = Columns(1).SpecialCells(2).Count

r = 0
b = 0

For i = 2 To rowsCnt
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Application.Max(Cells(i - 11, 4).Resize(12))
Next i

Cells(2, |fffd||5b0||fffd||fffd||fffd|).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)

For i = 2 To rowsCnt
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) <> Cells(i, 4) Then
Cells(i, |fffd||5b0||fffd||fffd||fffd|) = ""
End If

Next i

r = 0
'|fffd||fffd||fffd||fe1| |fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||33f||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
'|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| %|fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd| |fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 70|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||377||fffd||fffd||fffd| |1e5||fffd||fffd||fffd||474||fffd|.

Erase varTemp
rr = 1

For i = 2 To rowsCnt

If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 200 Then '|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd||33b||fffd|
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) = "" Then '|fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||4b6||fffd|
If Cells(i, 8) < 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (-)|fffd||3f6||fffd|
If Cells(i, 6) / Cells(i, 3) - 1 < -0.005 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| -0.055|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Cells(i, 6).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row > 5 Then '|fffd||fffd||fffd||fffd||fffd||2c23||fffd||fffd| 5|fffd||33b||fffd||fffd||3f6||fffd|

Cells(i, |fffd||fffd||fffd||fffd||fffd||2c23|) = Cells(i, 6).Row - Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3).Row
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 6) / Cells(i, 3) - 1
Cells(i, |fffd||135||fffd|) = Cells(i, 6) / Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3) - 1

Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 1, 3) '|fffd||17c||fffd||fffd||fffd|
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 1.0533  '|fffd||fffd||fffd||370||fffd|
Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||17c||fffd||fffd||fffd|) * 0.95 '|fffd||7f8||170||fffd|


For r = 1 To 72000
If Cells(i + r, 4) > Cells(i, |fffd||fffd||fffd||370||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.05
Exit For
End If


If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
If Cells(i + r, 5) < Cells(i, |fffd||7f8||170||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f8||170||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(i, |fffd||fffd||570||fffd|) = (Cells(i, |fffd||17c||fffd||fffd||fffd|) + Cells(i, |fffd||7f8||170||fffd|)) / 2 '|fffd||fffd||570||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||7f8||fffd||fffd||fffd|) = r
Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = 1
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 1.0533
Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 0.95
End If
End If



If Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) <> "" Then
If Cells(i + r, 5) < Cells(i, |fffd||7f8||170||fffd|) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7f8||170||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(i, |fffd||fffd||570||fffd|) = (Cells(i, |fffd||fffd||570||fffd|) * (rr + 1) + Cells(i, |fffd||7f8||170||fffd|)) / (rr + 2) '|fffd||fffd||570||fffd| |1e5||fffd||fffd|
Cells(i, |fffd||7f8||fffd||fffd||fffd|) = r
Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = rr + 1
Cells(i, |fffd||fffd||fffd||370||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 1.0533
Cells(i, |fffd||7f8||170||fffd|) = Cells(i, |fffd||fffd||570||fffd|) * 0.95
End If
End If



If Cells(i + r, 1) <> Cells(i + r - 1, 1) Then
b = b + 1
If b = 1000 Then
Cells(i, |fffd||175||fffd||fffd||f0||fffd|) = b
Exit For
End If
End If



Next r

rr = 1
b = 0

If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = "" Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = Cells(i + r, 3) / Cells(i, |fffd||17c||fffd||fffd||fffd|) - 1.0033
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
End If

For p = 1 To 10
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = p Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = 0.05 * (p + 1)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Exit For
End If


If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||7f8||fffd||23d||fffd||fffd|) = p Then
Cells(i, |fffd||175||fffd||fffd||fffd|) = (Cells(i + r, 3) / Cells(i, |fffd||fffd||570||fffd|) - 1.0033) * (p + 1)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = r '|fffd||fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|
Exit For
End If
Next p



ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 7).End(3) = Cells(1, 1).Value '9|fffd||fffd|5|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

End If
End If
End If
End If
End If

Next i

   
  fileName = Dir
    
 
'ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
 Columns("B:B").NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"

  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           key3:=.Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd|), order3:=1, _
           Header:=xlYes
    End With
  


        End Sub
        
       



Sub fdjalkfdafa()

Dim rngC As Range
Dim rngall As Range
Dim rngData As Range
Dim C As Range
Dim strAddr As String


Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
Range("ad2:af1000").Clear

Set rngall = Columns("g").SpecialCells(2)
Set rngData = Sheets("test").Columns("r").SpecialCells(2)

For Each rngC In rngall
Set C = rngData.Find(rngC, lookat:=xlWhole)

If Not C Is Nothing Then
      strAddr = C.Address
      
      Do

If C.Offset(, -17) < rngC.Offset(, -5) And C.Offset(, -17) >= rngC.Offset(, -5) - 3.47222222222215E-03 Then
rngC.Offset(, 23) = C.Value
rngC.Offset(, 24) = C.Offset(, -1).Value
End If


Set C = rngData.FindNext(C)
Loop While Not C Is Nothing And C.Address <> strAddr


End If

Next rngC

Set rngall = Nothing
Set rngData = Nothing







End Sub



 

 Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String

 

 

 

    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("test").UsedRange.Offset(1).Clear


   Do While fileName <> ""
   
    Set C = ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Range("g323:g479").Find(Split(fileName, ".")(0), lookat:=xlWhole)
   
   If Not C Is Nothing Then

   
   Workbooks.Open (strPath & fileName)
            
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   'strAddr = C.Address
   
   'Do
   
   For i = 2 To Columns(1).SpecialCells(2).Count
   If Cells(i, 1) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(C.Row, 2) Then
   ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(C.Row, 33) = i
   Exit For
   End If
   
   Next i
   
   'Set C = ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Range("g669:g825").FindNext(C)
'Loop While Not C Is Nothing And C.Address <> strAddr
   
    ActiveWorkbook.Close False
   End If
       
  fileName = Dir
  Set C = Nothing
   
Loop

 

 

 

        End Sub


Sub |223||fffd||fffd||e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||a5|_|fffd||fffd|column1|fffd||fffd||fffd||5b1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next
  
      
      
      
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
      
      
      

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

 
   Do While fileName <> ""
   
Workbooks.Open (strPath & fileName)
var = Split(strPath, "\")
strName = var(UBound(var) - 1)


Columns(1).Insert
Cells(1, 1) = "|fffd||fffd||a5|"
Cells(2, 1).Resize(Columns(2).SpecialCells(2).Count - 1) = Left(strName, 4) & "/" & Mid(strName, 5, 2) & "/" & Right(strName, 2)

 

ActiveWorkbook.Close True

       
  fileName = Dir

   
Loop

 

 

 

        End Sub


Sub xlsx|fffd||fffd||fffd||3f8||fffd||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
   
   
On Error Resume Next



      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With
    
    Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
    
    For i = 2 To Columns(1).SpecialCells(2).Count
    
    If Cells(i, 1) <> "" Then
    fileName = Cells(i, 1).Value & ".xlsx"                '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    Set wkBk = Workbooks.Add
   
    Cells(1, 1).Resize(, 11) = Array("|fffd||fffd||a5|", "|fffd||f0||fffd|", "|fc||fffd||1c21|", "|fffd||fffd||fffd|", "", "|fffd||175||fffd||223||fffd||fffd|", "|fffd||17c||fffd||223||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd||fc||fffd||fffd|", "|fffd||175||fffd||fc||fffd||1dee|", "|fffd||17c||fffd||fc||fffd||1dee|", "|fffd||177||fffd||fffd||fffd|")

    
    wkBk.SaveAs strPath & fileName
       
    Workbooks(fileName).Close True
    
    Else
    Exit For
    
    End If
    
    Next i
    


        End Sub
       
 
   
        Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '5|fffd||43a||fffd||fffd||fffd||fffd||fffd| activate
Sheets("test").UsedRange.Clear
Sheets("|fffd||4fd||fffd|").UsedRange.Clear
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("test").Cells(1, 1)
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("|fffd||4fd||fffd|").Cells(1, 1)
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If
Next i
     
Cells(2, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|).Resize(2000, 100).Clear '|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| column |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
For i = 2 To Columns(1).SpecialCells(2).Count
 
fileName = Cells(i, 7).Value & ".xlsx"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|" Then
   
   
   '--- 9|fffd||fffd| |fffd||fffd||fffd||fffd| 9:4|fffd||431||fffd||fffd||fffd| |223||fffd||fffd||e2| |22e||fffd||fffd| ---
   
   Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   'For aa = C.Row To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
  '
   'If Cells(aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 2) - 2.77777777777777E-03 Then
   'y = aa
   'Exit For
   'End If
   
  ' Next aa
   
   y = C.Row
      
      
   For Aa = C.Row To C.Row + 5000
   
   If Cells(Aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 2) Then
   yy = Aa - 1
   Exit For
   End If
   
   Next Aa
   

   Set C = Nothing



      
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 5) = Array("|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|")
  
  For b = 1 To Rows(1).SpecialCells(2).Count + 1
  
    If Cells(1, b) = "|fffd||175||fffd||fc||fffd||1dee|" Then
  |fffd||175||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||17c||fffd||fc||fffd||1dee|" Then
  |fffd||17c||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||177||fffd||fffd||fffd|" Then
  |fffd||177||fffd||fffd||fffd| = b
  End If
  
  
  If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd||fffd| = b
  End If
  
  Next b
  
    Range("L2").Select
    ActiveWindow.FreezePanes = True
    
  For Aa = y To yy

  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Cells(Aa, |fffd||17c||fffd||fc||fffd||1dee|) - Cells(Aa, |fffd||175||fffd||fc||fffd||1dee|)
  If Cells(Aa - 1, 1) = Cells(Aa, 1) Then
  Cells(Aa, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|) = Cells(Aa, |fffd||177||fffd||fffd||fffd|) - Cells(Aa - 1, |fffd||177||fffd||fffd||fffd|)
  End If
  
  Next Aa
  

  
  For Aa = yy To y Step -1
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) = Application.Average(Cells(y, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|).Resize(Aa - y + 1))
  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) / Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|)
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) * Cells(Aa, 3)
  Next Aa
 
             
   ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|) = yy - y + 1
   ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = Application.Sum(Cells(y, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(yy - y + 1))
   
   
   End If
   
  ' Workbooks(fileName).Close False
    

   End If
   
   Next i
   
 
   
  ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
  
  For i = 2 To Cells(Rows.Count, 1).End(3).Row
  If Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = "" Then
  Cells(i, 1).Resize(, 100).Clear
  End If
  Next i
  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|)
  
    
  r = 0
  For i = 2 To Cells(Rows.Count, 1).End(3).Row
  If Cells(i, 2) = Cells(i + 1, 2) Then
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(i, 1).Resize(, 100)
  
  Else
  
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(i, 1).Resize(, 100)
  
  Sheets("|fffd||4fd||fffd|").Activate
  
  For o = 1 To UBound(varTemp, 1)
  Cells(o + 1, 1).Resize(, 100) = varTemp(o)
  Next o
  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1), key2:=Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending
  
  'If Cells(2, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) >= 500 Then
  Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(2, 1).Resize(, 100).Value
  'End If
  
  ActiveSheet.UsedRange.Offset(1).Clear
  
  Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
  
  r = 0
  Erase varTemp
  
    
  End If
  Next i
  
    Sheets("test").Activate
 Columns(2).NumberFormatLocal = "h:mm:ss"
 
        End Sub
 
 

   
        Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|3()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '5|fffd||43a||fffd||fffd||fffd||fffd||fffd| activate
Sheets("test").UsedRange.Clear
Sheets("|fffd||4fd||fffd|").UsedRange.Clear
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("test").Cells(1, 1)
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("|fffd||4fd||fffd|").Cells(1, 1)
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If

Next i


Cells(2, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|).Resize(2000, 100).Clear '|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| column |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
For i = 2 To Columns(1).SpecialCells(2).Count
 
fileName = Cells(i, 7).Value & ".xlsx"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|" Then
   
   
   '--- 9|fffd||fffd| |fffd||fffd||fffd||fffd| 9:4|fffd||431||fffd||fffd||fffd| |223||fffd||fffd||e2| |22e||fffd||fffd| ---
   
   Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   For Aa = C.Row To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
  
   'If Cells(aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 2) - 2.77777777777777E-03 Then
   'y = aa
   'Exit For
   'End If
   
   If Cells(Aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 2) Then
   'If Cells(aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, Columns.Count).End(1) - 1.27777777777778E-02 Then
   y = Aa
   Exit For
   End If
   
   
   
   Next Aa
   
   'y = C.Row
      
      
   For Aa = C.Row To C.Row + 5000
   
   If Cells(Aa, 2) >= ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, Columns.Count).End(1).Value Then
   'If Cells(aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 2) Then
   yy = Aa - 1
   Exit For
   End If
   
   Next Aa
   

   Set C = Nothing



      
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 5) = Array("|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|")
  
  For b = 1 To Rows(1).SpecialCells(2).Count + 1
  
    If Cells(1, b) = "|fffd||175||fffd||fc||fffd||1dee|" Then
  |fffd||175||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||17c||fffd||fc||fffd||1dee|" Then
  |fffd||17c||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||177||fffd||fffd||fffd|" Then
  |fffd||177||fffd||fffd||fffd| = b
  End If
  
  
  If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd||fffd| = b
  End If
  
  Next b
  
    Range("L2").Select
    ActiveWindow.FreezePanes = True
    
  For Aa = y To yy

  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Cells(Aa, |fffd||17c||fffd||fc||fffd||1dee|) - Cells(Aa, |fffd||175||fffd||fc||fffd||1dee|)
  If Cells(Aa - 1, 1) = Cells(Aa, 1) Then
  Cells(Aa, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|) = Cells(Aa, |fffd||177||fffd||fffd||fffd|) - Cells(Aa - 1, |fffd||177||fffd||fffd||fffd|)
  End If
  
  Next Aa
  

  
  For Aa = yy To y Step -1
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) = Application.Average(Cells(y, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|).Resize(Aa - y + 1))
  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) / Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|)
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) * Cells(Aa, 3)
  Next Aa
 
             
  'For aa = y To yy
  'If Cells(aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) < -2 Then
  
   ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|) = yy - y + 1
   'ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = Cells(aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
   'ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 2) = Cells(aa, 3).Value
   ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = Application.Sum(Cells(y, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(yy - y + 1))
   
   'Exit For
   'End If
   
   'Next aa
   
   
   
   End If
   
   'Workbooks(fileName).Close False
    

   End If
   
   Next i
   
   End Sub
   
   Sub fjdlaf()
   
 
   
  ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
  
  For i = 2 To Cells(Rows.Count, 1).End(3).Row
  If Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = "" Then
  Cells(i, 1).Resize(, 100).Clear
  End If
  Next i
  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|)
  
    
  r = 0
  For i = 2 To Cells(Rows.Count, 1).End(3).Row
  If Cells(i, 2) = Cells(i + 1, 2) Then
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(i, 1).Resize(, 100)
  
  Else
  
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(i, 1).Resize(, 100)
  
  Sheets("|fffd||4fd||fffd|").Activate
  
  For o = 1 To UBound(varTemp, 1)
  Cells(o + 1, 1).Resize(, 100) = varTemp(o)
  Next o
  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1), key2:=Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending
  
  'If Cells(2, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) >= 500 Then
  Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(2, 1).Resize(, 100).Value
  'End If
  
  ActiveSheet.UsedRange.Offset(1).Clear
  
  Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
  
  r = 0
  Erase varTemp
  
    
  End If
  Next i
  
    Sheets("test").Activate
 Columns(2).NumberFormatLocal = "h:mm:ss"
 
        End Sub
 



   
        Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '5|fffd||43a||fffd||fffd||fffd||fffd||fffd| activate
Sheets("test").UsedRange.Clear
Sheets("|fffd||4fd||fffd|").UsedRange.Clear
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("test").Cells(1, 1)
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("|fffd||4fd||fffd|").Cells(1, 1)
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then '
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then '
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i
     
'Cells(2, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|).Resize(2000, 100).Clear '|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| column |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
For a = 2 To Columns(1).SpecialCells(2).Count
 
fileName = Cells(a, 7).Value & "(|fffd||fffd|)" & ".xlsx"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|" Then
   

   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   
   Cells(1, Columns.Count).End(1).Resize(, 2) = Array("20|fffd||fffd||fffd||fffd|", "|fffd||7b5||fffd||fffd||fffd|")
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, i) = "20" Then
   |fffd||33d||fffd||fffd||335||fffd| = i
   End If
   
   If Cells(1, i) = "20|fffd||fffd||fffd||fffd|" Then
   |fffd||33d||2bf||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||7b5||fffd||fffd||fffd|" Then
   |fffd||7b5||fffd||fffd||fffd| = i
   End If
   
   Next i
   
   

   
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||33d||2bf||fffd||fffd||fffd|) = Cells(i, |fffd||33d||fffd||fffd||335||fffd|) * 1.15
If Cells(i, |fffd||33d||2bf||fffd||fffd||fffd|) < Cells(i, 5) Then
Cells(i, |fffd||7b5||fffd||fffd||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
End If

Next i

Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(a, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|


For i = C.Row To C.Row - 20 Step -1
If Cells(i, |fffd||7b5||fffd||fffd||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(a, 1).Resize(, 200).Clear
Exit For
End If
Next i


   
   End If
   Set C = Nothing
   
   
Workbooks(fileName).Close False

End If

Next a

   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

   
   End Sub


   
        Sub |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
 
 
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


With Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|")
.UsedRange.Offset(1).Clear
.Activate
End With



   Do While fileName <> ""
 
   Workbooks.Open (strPath & fileName)
  


   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   Columns(1).NumberFormatLocal = "0_);[|fffd||fffd||fffd||fffd|](0)"
   
   Cells(1, Columns.Count).End(1).Resize(, 6) = Array("|fffd||fffd||fffd||fffd|", "|fffd||7b5||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, i) = "20" Then
   |fffd||33d||fffd||fffd||335||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   
   If Cells(1, i) = "|fffd||7b5||fffd||fffd||fffd|" Then
   |fffd||7b5||fffd||fffd||fffd| = i
   End If
    
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
    
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
    If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
    If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
    
   Next i
   
   

   
For i = 21 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||33d||fffd||fffd||335||fffd|) * 1.2

If Cells(i, |fffd||fffd||fffd||fffd|) < Cells(i, 5) Then
If Cells(i, |fffd||fffd||fffd||fffd||fffd|) < 0.29 Then
Cells(i, |fffd||7b5||fffd||fffd||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 5) / Cells(i, 2) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 5) / Cells(i, 4) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, 3) / Cells(i, 5) - 1.0033
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, 5) / Cells(i, 5) - 1.0033
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3).Offset(, Cells(1, Columns.Count).End(1).Column) = Split(ActiveWorkbook.Name, "(")(0)

End If
End If

Next i

 


   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop




  
ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
   Columns(1).NumberFormatLocal = "yyyy-mm-dd"
      Columns(2).NumberFormatLocal = "hh:mm:ss"
         Columns(3).NumberFormatLocal = "hh:mm:ss"
         
         
         
  
For i = Columns(1).SpecialCells(2).Count To 2 Step -1
Cells(i, 2) = "9:00"
Cells(i, 3) = "14:49"
Cells(i, 4) = "14:40"

If InStr(Cells(i, 1), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Delete shift:=xlUp
End If



Next i

   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

   
   End Sub
   
   

   
        Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||7b5||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd|40|fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||fffd||e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||473||fffd||17c||fffd|()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '5|fffd||43a||fffd||fffd||fffd||fffd||fffd| activate
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|223||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|223||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


Next i


Cells(2, |223||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(2000, 100).Clear '|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| column |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
fileName = Cells(i, |fffd||fffd||fffd||fffd|).Value & ".xlsx"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|" Then
   
   
   '--- 9|fffd||fffd| |fffd||fffd||fffd||fffd| 9:4|fffd||431||fffd||fffd||fffd| |223||fffd||fffd||e2| |22e||fffd||fffd| ---
   
   Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   For Aa = C.Row To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
    If Cells(Aa, 1) = ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1) Then
   If Cells(Aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 2) Then
   y = Aa
   Exit For
   End If
   End If
   
   
   
   Next Aa
   
        
      
   For Aa = C.Row To C.Row + 5000
   If Cells(Aa, 1) = ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1) Then
   If Cells(Aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 3) Then
   yy = Aa - 1
   Exit For
   End If
   End If
   
   Next Aa
   

   Set C = Nothing



      
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 5) = Array("|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|")
  
  For b = 1 To Rows(1).SpecialCells(2).Count + 1
  
    If Cells(1, b) = "|fffd||175||fffd||fc||fffd||1dee|" Then
  |fffd||175||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||17c||fffd||fc||fffd||1dee|" Then
  |fffd||17c||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||177||fffd||fffd||fffd|" Then
  |fffd||177||fffd||fffd||fffd| = b
  End If
  
  
  If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd||fffd| = b
  End If
  
  Next b
  
    Range("L2").Select
    ActiveWindow.FreezePanes = True
    
  For Aa = y To yy

  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Cells(Aa, |fffd||17c||fffd||fc||fffd||1dee|) - Cells(Aa, |fffd||175||fffd||fc||fffd||1dee|)
  If Cells(Aa - 1, 1) = Cells(Aa, 1) Then
  Cells(Aa, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|) = Cells(Aa, |fffd||177||fffd||fffd||fffd|) - Cells(Aa - 1, |fffd||177||fffd||fffd||fffd|)
  End If
  
  Next Aa
  

  
  For Aa = yy To y Step -1
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) = Application.Average(Cells(y, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|).Resize(Aa - y + 1))
  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) / Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|)
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) * Cells(Aa, 3)
  Next Aa
 
 
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|), order1:=xlDescending
  
  
   ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(2, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(5000))
  ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.CountA(Cells(2, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(5000))
  
  
  For Aa = 2 To 6
  If Cells(Aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 4) Then
  ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
  Exit For
  End If
  Next Aa
  
   
    
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending
  
  For Aa = 2 To 6
  If Cells(Aa, 2) > ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, 4) Then
  ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd| + 2) = Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
  Exit For
  End If
  Next Aa

   
   
   
   
   End If
   
   Workbooks(fileName).Close False
    

   End If
   
   Next i
   
   End Sub

Sub |fffd||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|223||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If



If Cells(1, i) = "|223||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd|2" Then
|fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd|2 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "100" Then
|fffd||fffd| = i
End If

Next i

With Sheets("test")
.UsedRange.Clear
.Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
End With


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd|) > 1200 Then
If Cells(i, |fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
End If
End If

'If Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd|) > 1200 Then
'If Cells(i, |223||fffd||fffd||fffd||fffd||fffd||fffd|) < -100 And Cells(i, |fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i, |fffd||fffd||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd|2) = "" Then
'Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
'End If
'End If



Next i

Sheets("test").Activate
Columns.AutoFit
Range("b2", Cells(Rows.Count, 4).End(3)).NumberFormatLocal = "hh:mm:ss"
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.08 Then
Cells(i, |fffd||fffd||fffd||377||fffd|) = 0.08

Else

Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
End If


If Cells(i, 1) = Cells(i + 1, 1) Then
r = r + 1

Else


Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||377||fffd|).Offset(-r).Resize(r + 1))

r = 0


End If

Next i




For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||fffd|) = Cells(i - 1, |fffd||fffd|) * (1 + Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|))
Next i


End Sub



Sub |223||fffd||fffd||e2|_|fffd||fffd||fc||fffd||fffd||fffd||5b4||fffd||fffd||fffd||22e||fffd||fffd||fffd||3f1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


  Sheets("test2").Activate
  Sheets("test2").UsedRange.Offset(1).Clear
  

   Do While fileName <> ""

   Workbooks.Open (strPath & fileName)
   
   With ThisWorkbook.Sheets("test2")
   .Cells(Rows.Count, 1).End(3)(2) = Split(ActiveWorkbook.Name, ".")(0)
   .Cells(Rows.Count, 2).End(3)(2) = Cells(Rows.Count, 1).End(3).Value
   .Cells(Rows.Count, 3).End(3)(2) = Cells(Rows.Count, 1).End(3).Row
   .Cells(Rows.Count, 4).End(3)(2) = Cells(Rows.Count, 2).End(3).Row
   .Cells(Rows.Count, 5).End(3)(2) = .Cells(Rows.Count, 3).End(3) - .Cells(Rows.Count, 4).End(3)
   End With
   
  fileName = Dir
    
  
ActiveWorkbook.Close False


Loop

Columns(2).NumberFormatLocal = "h:mm:ss"

        End Sub

Sub |fffd||fffd||fffd||7b8||178||17d||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Application.DisplayAlerts = False

Worksheets.Add before:=Worksheets(1)
ActiveSheet.Name = "|fffd||fffd||fffd||7b8||178||17d||fffd||fffd||fffd|"

Application.DisplayAlerts = True


        End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||67d||f4||67f||fffd||7b1||fffd|_|fffd||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

                  strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"



    End With

    
        fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


  Sheets("|fffd||4fd||fffd|").Activate
  Sheets("|fffd||4fd||fffd|").UsedRange.Clear
  

   Do While fileName <> ""

 
   Cells(Rows.Count, 1).End(3)(2) = Split(fileName, ".")(0)

   
  fileName = Dir
    
  

Loop

Application.DisplayAlerts = False

Worksheets.Add before:=Worksheets(2)
ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Application.DisplayAlerts = True

newName = "|fffd||4fd||fffd||fffd||fffd||fffd||fffd|.xls"
Workbooks.Open (strPath & newName)
ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1)
Workbooks(newName).Close False

Cells(2, 3).Resize(10000, 10).Clear

   
For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||4fd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending

Set C = Nothing



        End Sub
        
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||67d||f4||67f||fffd||7b1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

                  strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"



    End With

    fileName = Dir(strPath & "*(|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    '    fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


  Sheets("|fffd||4fd||fffd|").Activate
  Sheets("|fffd||4fd||fffd|").UsedRange.Clear
  

   Do While fileName <> ""

 
   Cells(Rows.Count, 1).End(3)(2) = Split(fileName, "(")(0)

   
  fileName = Dir
    
  

Loop

Application.DisplayAlerts = False

Worksheets.Add before:=Worksheets(1)
ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Application.DisplayAlerts = True

newName = "|fffd||4fd||fffd||fffd||fffd||fffd||fffd|.xlsx"
Workbooks.Open (strPath & newName)
ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1)
Workbooks(newName).Close False


Columns(1).Delete
Cells(2, 3).Resize(10000, 10).Clear

   
For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||4fd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending

Set C = Nothing



        End Sub
Sub fdjalf()

 Dim varTemp()
   
  ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
  r = 0
  For i = 2 To Cells(Rows.Count, 1).End(3).Row
  If Cells(i, 1) = Cells(i + 1, 1) Then
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(i, 1).Resize(, 100)
  
  Else
  
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(i, 1).Resize(, 100)
  
  Sheets("|fffd||4fd||fffd|").Activate
  
  For o = 1 To UBound(varTemp, 1)
  Cells(o + 1, 1).Resize(, 100) = varTemp(o)
  Next o

  Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(2, 1).Resize(, 100).Value
  
  ActiveSheet.UsedRange.Offset(1).Clear
  
  Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate
  
  r = 0
  Erase varTemp
  
    
  End If
  Next i
  
    Sheets("test").Activate
 Columns(2).NumberFormatLocal = "h:mm:ss"

        End Sub
        
       
   
        Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|3()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Activate '5|fffd||43a||fffd||fffd||fffd||fffd||fffd| activate
Sheets("test").UsedRange.Clear
Sheets("|fffd||4fd||fffd|").UsedRange.Clear
 
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("test").Cells(1, 1)
Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Copy Sheets("|fffd||4fd||fffd|").Cells(1, 1)
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If

Next i


Cells(2, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|).Resize(2000, 100).Clear '|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| column |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
For i = 2 To Columns(1).SpecialCells(2).Count
 
fileName = Cells(i, 7).Value & ".xlsx"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|" Then
   
   
   '--- 9|fffd||fffd| |fffd||fffd||fffd||fffd| 9:4|fffd||431||fffd||fffd||fffd| |223||fffd||fffd||e2| |22e||fffd||fffd| ---
  
      
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 5) = Array("|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|")
  
  For b = 1 To Rows(1).SpecialCells(2).Count + 1
  
    If Cells(1, b) = "|fffd||175||fffd||fc||fffd||1dee|" Then
  |fffd||175||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||17c||fffd||fc||fffd||1dee|" Then
  |fffd||17c||fffd||fc||fffd||1dee| = b
  End If
  
    If Cells(1, b) = "|fffd||177||fffd||fffd||fffd|" Then
  |fffd||177||fffd||fffd||fffd| = b
  End If
  
  
  If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = b
  End If
  
    If Cells(1, b) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
  |fffd||fffd||570||177||fffd||fffd||fffd||fffd| = b
  End If
  
  Next b
  
    Range("L2").Select
    ActiveWindow.FreezePanes = True
    
  For Aa = 2 To Cells(Rows.Count, 1).End(3).Row

  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Cells(Aa, |fffd||17c||fffd||fc||fffd||1dee|) - Cells(Aa, |fffd||175||fffd||fc||fffd||1dee|)
  If Cells(Aa - 1, 1) = Cells(Aa, 1) Then
  Cells(Aa, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|) = Cells(Aa, |fffd||177||fffd||fffd||fffd|) - Cells(Aa - 1, |fffd||177||fffd||fffd||fffd|)
  End If
  
  Next Aa
  

  
  For Aa = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) = Application.Average(Cells(Aa - 40, |fffd||fffd||fffd||fffd||fffd||177||fffd||fffd||fffd|).Resize(41))
  Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd|) / Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|)
  Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) = Cells(Aa, |fffd||fffd||570||177||fffd||fffd||fffd|) * Cells(Aa, 3)
  Next Aa
 
             
  'For aa = y To yy
  'If Cells(aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) < -2 Then
  
   'ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|) = yy - y + 1
   'ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = Cells(aa, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
   'ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 2) = Cells(aa, 3).Value
   'ThisWorkbook.Sheets("|fffd||fffd||fffd||43a||fffd||fffd||fffd||fffd||fffd|").Cells(i, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| + 1) = Application.Sum(Cells(y, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(yy - y + 1))
   
   'Exit For
   'End If
   
   'Next aa
   
   
   
   End If
   
   'Workbooks(fileName).Close False
    

   End If
   
   Next i
   
   End Sub
   
   
   
Sub |223||fffd||fffd||e2|_|fffd||67f||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

  With Sheets("test")
  .Activate
  .UsedRange.Clear
  .Cells(1, 1).Resize(, 3) = Array("|fffd||fffd||fffd||fffd|", "|fffd||c33||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|")
End With


   Do While fileName <> ""

   Workbooks.Open (strPath & fileName)
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending
   
   For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
   
   If Cells(i, 1) = Cells(i - 1, 1) Then
   Rows(i).Clear
   End If
   
   Next i
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending
    
    ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2) = Split(ActiveWorkbook.Name, ".")(0)
   ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3)(2) = Application.CountA(Columns(1))
      ThisWorkbook.Sheets("test").Cells(Rows.Count, 3).End(3)(2) = Application.CountA(Rows(1))

   
  fileName = Dir
    
  
ActiveWorkbook.Close True


Loop


        End Sub


   
Sub |223||fffd||fffd||e2|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2|  |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

Sheets("test").Activate
Sheets("test").UsedRange.Clear


   Do While fileName <> ""

   Workbooks.Open (strPath & fileName)
   
    
  If Cells(Rows.Count, 1).End(3).Row > 100 Then
  
  Sheets(2).UsedRange.Clear
  Sheets(3).UsedRange.Clear
  
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 15) = Array("|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|(30|fffd||fffd|)", "|fffd||fffd||fffd||fffd|", "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd|)", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd|", "|fffd||175||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||175||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|", "15:00:00")
       Cells(1, colums.Count).End(1).NumberFormatLocal = "hh:mm:ss"
   Sheets(2).Cells(1, 1).Resize(, 100) = ActiveSheet.Cells(1, 1).Resize(, 100).Value
      Sheets(3).Cells(1, 1).Resize(, 100) = ActiveSheet.Cells(1, 1).Resize(, 100).Value

   If ThisWorkbook.Sheets("test").Cells(1, Columns.Count).End(1).Column <> 14 Then
   ThisWorkbook.Sheets("test").Cells(1, 1).Resize(, 14) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|", "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd|)", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||17c||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||175||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|")
   End If
   
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
      If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||a5|" Then
   |fffd||fffd||a5| = i
   End If
    
      If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
      
            If Cells(1, i) = "|fffd||f0||fffd|" Then
   |fffd||f0||fffd| = i
   End If
      If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then
   |fffd||177||fffd||fffd||fffd| = i
   End If
   
       If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
        If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
       If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
   |fffd||fffd||2ba||fffd||fffd||fffd| = i
   End If
   
   
      If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd| = i
   End If
   
     If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
      If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|(30|fffd||fffd|)" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||1dee|" Then
   |fc||fffd||1dee| = i
   End If
   
     If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
   |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd|)" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
         If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd|" Then
   |fffd||fffd||fffd||17c||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||175||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||175||fffd|" Then
   |fffd||fffd||fffd||175||fffd| = i
   End If
      
         If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd| = i
   End If
   
            If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
      
            If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
   
  Next i
  
  r = 0
  

  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending
  
  

  For Aa = 2 To Cells(Rows.Count, 1).End(3).Row
  If Cells(Aa, 1) <> Cells(Aa + 1, 1) Then
  If Cells(Aa, |fffd||175||fffd||fc||fffd||fffd||1fc||fffd|) + Cells(Aa, |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|) > 10000 Then
  r = r + 1
  ReDim Preserve varTemp(1 To r)
  varTemp(r) = Cells(Aa, 1)
  End If
  End If
  
  Next Aa
  
  r = 0
  
  With Sheets(3)
  .Cells(Rows.Count, 1).End(3)(2).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)
  End With
  
  
  Set rngall = Sheets(3).Range("a2", Sheets(3).Cells(Rows.Count, 1).End(3))
  Set rngData = Range("a2", Cells(Rows.Count, 1).End(3))

  
  For Each rngC In rngall
  Set C = rngData.Find(rngC, lookat:=xlWhole)
  
  If Not C Is Nothing Then
  Sheets(2).Cells(2, 1).Resize(700, 100) = Cells(C.Row, 1).Resize(700, 100).Value

  
  Sheets(2).Activate
  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), order1:=xlDescending
  
  Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Max(Sheets(1).Cells(C.Row + 700, |fffd||fffd||fffd||fffd|).Resize(700)) / Cells(2, |fffd||fffd||fffd||fffd|) - 1.0033



  Cells(1, |fffd||fffd||fffd||fffd|) = Split(ActiveWorkbook.Name, ".")(0)
  Cells(1, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|) = Cells(3, |fffd||175||fffd||fc||fffd||fffd||1fc||fffd|) + Cells(3, |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|)
  Cells(1, |fffd||fffd||fffd||fffd||fffd|) = Cells(3, |fffd||fffd||fffd||fffd||fffd|)
  Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(2, |fffd||fffd||fffd||fffd||fffd|)
                
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
   Next i
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) - Cells(i + 1, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
   
   Next i
   
   Cells(1, |fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(3, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
   Cells(1, |fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(3, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) / Cells(3, |fffd||177||fffd||fffd||fffd|)
   Cells(1, |fffd||fffd||2ba||fffd||fffd||fffd|) = Application.Sum(Cells(3, |fffd||fffd||fffd||fffd||fffd|).Resize(20)) / Cells(3, |fffd||177||fffd||fffd||fffd|)
         
      
      
   For i = 3 To 22
   If Cells(i, |fffd||fffd||fffd||fffd||fffd|) / Cells(3, |fffd||177||fffd||fffd||fffd|) > 0 Then
   Cells(i, |fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd|) / Cells(3, |fffd||177||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||175||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd|) / Cells(3, |fffd||177||fffd||fffd||fffd|)
   
   End If
   
   Next i
   
   Cells(1, |fffd||fffd||fffd||17c||fffd|) = Application.Max(Cells(3, |fffd||fffd||fffd||17c||fffd|).Resize(20))
   Cells(1, |fffd||fffd||fffd||175||fffd|) = Application.Min(Cells(3, |fffd||fffd||fffd||175||fffd|).Resize(20))
   
   For i = 3 To 22
   If Cells(1, |fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd|) Then
   Cells(1, |fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 2)
   End If
   
   If Cells(1, |fffd||fffd||fffd||175||fffd|) = Cells(i, |fffd||fffd||fffd||175||fffd|) Then
   Cells(1, |fffd||175||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 2)
   End If
   Next i
    
   
   
ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2) = Cells(3, |fffd||fffd||a5|).Value
ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3)(2).Resize(, 12) = Cells(1, |fffd||fffd||fffd||fffd|).Resize(, 12).Value

ActiveSheet.UsedRange.Offset(1).Clear

Sheets(1).Activate

 End If
 
 
 
Erase varTemp
Set C = Nothing
Set rngC = Nothing

  
 Next rngC
 

 End If
 
   
   
  fileName = Dir
    
  
ActiveWorkbook.Close False



Loop

ThisWorkbook.Sheets("test").Activate
Columns("g").NumberFormatLocal = "hh:mm:ss"
Columns("i").NumberFormatLocal = "hh:mm:ss"

        End Sub

   
Sub |fffd||fffd||229||fffd||ff||fffd||fffd||43f||fffd||fffd||17c||fffd||fffd||3f1||fffd|_|fffd||fffd||fffd||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2|  |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

Sheets("test").Activate
Sheets("test").UsedRange.Clear


   Do While fileName <> ""

   Workbooks.Open (strPath & fileName)
   
    
  If Cells(Rows.Count, 1).End(3).Row > 100 Then
  
 
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 8) = Array("|fffd||177||fffd||fffd||fffd|(30|fffd||fffd|)", "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|(30|fffd||fffd|)", "|fc||fffd||1dee||fffd||fffd||fffd|", "|fc||fffd||1dee||fffd||fffd||574||fffd||fffd|", "|fc||fffd||fffd||1fc||fffd|", "|fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|(|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||377||fffd|", "9:05")
   Cells(1, Columns.Count).End(1).Offset(, 1).NumberFormatLocal = "hh:mm:ss"
   
   If ThisWorkbook.Sheets("test").Cells(1, Columns.Count).End(1).Column <> 31 Then
   ThisWorkbook.Sheets("test").Cells(1, 1) = Split(ActiveWorkbook.Name, ".")(0)
   ThisWorkbook.Sheets("test").Cells(1, 2).Resize(, 100) = ActiveSheet.Cells(1, 1).Resize(, 100).Value
   End If
    
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd| = i
   End If
   
   
   If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then
   |fffd||177||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|(30|fffd||fffd|)" Then
   |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|(30|fffd||fffd|)" Then
   |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd| = i
   End If

   If Cells(1, i) = "|fc||fffd||1dee|" Then
   |fc||fffd||1dee| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd|" Then
   |fc||fffd||1dee||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||574||fffd||fffd|" Then
   |fc||fffd||1dee||fffd||fffd||574||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||fffd||1fc||fffd|" Then
   |fc||fffd||fffd||1fc||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|(|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|)" Then
   |fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
   |fffd||fffd||fffd||377||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
  Next i
  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending


For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) = Cells(i - 1, 1) Then
Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) - Cells(i - 1, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
  
Else

Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)

End If


If Cells(i, 2) = Cells(1, Columns.Count).End(1) Then
Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|) = Application.Average(Cells(i - 8, |fc||fffd||1dee|).Resize(9))
Cells(i, |fc||fffd||fffd||1fc||fffd|) = Cells(i, |fffd||175||fffd||fc||fffd||fffd||1fc||fffd|) + Cells(i, |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|)
Cells(i, |fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) / Cells(i, |fffd||177||fffd||fffd||fffd|)

For ii = 0 To 8
Cells(i - ii, |fc||fffd||1dee||fffd||fffd||574||fffd||fffd|) = Cells(i - ii, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|)
Next ii

Cells(i, |fc||fffd||1dee||fffd||fffd||574||fffd||fffd|) = Application.Max(Cells(i - 8, |fc||fffd||1dee||fffd||fffd||574||fffd||fffd|).Resize(9))
Cells(i, |fffd||fffd||fffd||377||fffd|) = Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(691)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033

ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2) = Split(ActiveWorkbook.Name, ".")(0)
ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value

End If

Next i





 End If
 
 
 
   
   
  fileName = Dir
    
  
ActiveWorkbook.Close False



Loop

ThisWorkbook.Sheets("test").Activate
ThisWorkbook.Sheets("test2").UsedRange.Clear
Sheets("test2").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) <> Cells(i - 1, 1) Then
Sheets("test2").Cells(i, 1).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
End If
Next i




        End Sub
Sub fjdlajfa()

ThisWorkbook.Sheets("test").Activate
ThisWorkbook.Sheets("test2").UsedRange.Clear
Sheets("test2").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 2) <> Cells(i - 1, 2) Then
Sheets("test2").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
End If
Next i

Sheets("test2").Activate
End Sub

Sub |223||fffd||fffd||e2|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|csv()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2|  |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

Sheets("test").Activate
Sheets("test").UsedRange.Clear


   Do While fileName <> ""

   Workbooks.Open (strPath & fileName)
   
     
   Cells(1, Columns.Count).End(1).Resize(, 14) = Array("|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|(30|fffd||fffd|)", "|fffd||fffd||fffd||fffd|", "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||17c||fffd|", "|fffd||175||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||175||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|", "14:40:00")
   Cells(1, colums.Count).End(1).NumberFormatLocal = "hh:mm:ss"

   If ThisWorkbook.Sheets("test").Cells(1, Columns.Count).End(1).Column <> 12 Then
   ThisWorkbook.Sheets("test").Cells(1, 1).Resize(, 12) = Array("|fffd||fffd||fffd||fffd|", "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||17c||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||fffd||fffd||175||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|")
   End If
   
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
      If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd| = i
   End If
   
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
      
            If Cells(1, i) = "|fffd||f0||fffd|" Then
   |fffd||f0||fffd| = i
   End If
      If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then
   |fffd||177||fffd||fffd||fffd| = i
   End If
   
       If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
        If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
       If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
   |fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
   End If
   
   
      If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd| = i
   End If
   
     If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
      If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|(30|fffd||fffd|)" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||1dee|" Then
   |fc||fffd||1dee| = i
   End If
   
     If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
   |223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd|" Then
   |fffd||fffd||fffd||17c||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||175||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||175||fffd|" Then
   |fffd||fffd||fffd||175||fffd| = i
   End If
      
         If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd||fffd||fffd||fffd| = i
   End If
   
            If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
      
            If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||1fc||fffd|" Then
   |fffd||fffd||fc||fffd||fffd||1fc||fffd| = i
   End If
   
   
  Next i
  
  

  
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending
  Rows(2).Clear
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending
   
  Cells(1, |fffd||fffd||fffd||fffd|) = Split(ActiveWorkbook.Name, ".")(0)
  Cells(1, |223||fffd||fffd||e2||fffd||fffd||fffd||fffd|) = Cells(2, |fffd||175||fffd||fc||fffd||fffd||1fc||fffd|) + Cells(2, |fffd||17c||fffd||fc||fffd||fffd||1fc||fffd|)
  Cells(1, |fffd||fffd||fffd||fffd||fffd|) = Cells(2, |fffd||fffd||fffd||fffd||fffd|)
                
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
   Next i
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) - Cells(i + 1, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
   
   Next i
   
   Cells(1, |fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(2, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
   Cells(1, |fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(2, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) / Cells(2, |fffd||177||fffd||fffd||fffd|)
   Cells(1, |fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Application.Sum(Cells(1, |fffd||fffd||fffd||fffd||fffd|).Resize(22)) / Cells(2, |fffd||177||fffd||fffd||fffd|)
   
      
      
      
   For i = 2 To 21
   If Cells(i, |fffd||fffd||fffd||fffd||fffd|) / Cells(2, |fffd||177||fffd||fffd||fffd|) > 0 Then
   Cells(i, |fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd|) / Cells(2, |fffd||177||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||175||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd|) / Cells(2, |fffd||177||fffd||fffd||fffd|)
   
   End If
   
   Next i
   
   Cells(1, |fffd||fffd||fffd||17c||fffd|) = Application.Max(Cells(2, |fffd||fffd||fffd||17c||fffd|).Resize(21))
   Cells(1, |fffd||fffd||fffd||175||fffd|) = Application.Min(Cells(2, |fffd||fffd||fffd||175||fffd|).Resize(21))
   
   For i = 2 To 21
   If Cells(1, |fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd|) Then
   Cells(1, |fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 1)
   End If
   
   If Cells(1, |fffd||fffd||fffd||175||fffd|) = Cells(i, |fffd||fffd||fffd||175||fffd|) Then
   Cells(1, |fffd||175||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 1)
   End If
   Next i
   
        
  
   
   
ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 12) = Cells(1, |fffd||fffd||fffd||fffd|).Resize(, 12).Value

   
   fileName = Dir
    
  
   ActiveWorkbook.Close False


Loop

ThisWorkbook.Sheets("test").Activate
Columns("e").NumberFormatLocal = "hh:mm:ss"
Columns("g").NumberFormatLocal = "hh:mm:ss"

        End Sub
        
        
        
        Sub |fffd||7b5||fffd||fffd||fffd|5|fffd||43a||fffd||fffd||fffd||f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||f8||17c||fffd|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate
Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|"
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|" Then
|fffd||175||fffd||fffd||fffd||fffd||377||fffd| = i
End If
Next i
 
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
fileName = Cells(i, 2).Value & "(5|fffd||fffd|).csv"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "test" Then
   
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending
   
   
   '|fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 9|fffd||fffd| 5|fffd||fffd||fffd||fffd| |e3||fffd||fffd|
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(i, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   For Aa = C.Row + 1 To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
   
   If Cells(Aa, 1) <> Cells(Aa - 1, 1) Then
   Exit For
   End If
   
   Next Aa
   
   Set C = Nothing
   
   
   '|f9||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| + 5|fffd||3f1||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| sheets 2|fffd||fffd| |fffd||fffd||fffd||fffd|
   Set wksht = Worksheets.Add(after:=Sheets(Sheets.Count))
   
   Sheets(2).Activate
   Sheets(1).Cells(1, 1).Resize(Aa + 354, 100).Copy Cells(1, 1)
  
   
   Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|" '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   
   For p = 1 To Cells(1, Columns.Count).End(1).Column
   If Cells(1, p) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd| = p
   End If
   
   If Cells(1, p) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = p
   End If
   
   Next p
      
   
   For p = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(p, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(p, 6) / Cells(p, 3) - 1
   Next p

   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending
   
   
   For p = Aa To Aa + 1000
   If Cells(p, |fffd||fffd||fffd||fffd||fffd||fffd|) < -0.04 Then
   
   ThisWorkbook.Sheets("test").Cells(i, Columns.Count).End(1).Offset(, 1) = Application.Max(Cells(p + 1, 4).Resize(71)) / Cells(p, 6) - 1.0033
   ThisWorkbook.Sheets("test").Cells(i, Columns.Count).End(1).Offset(, 1) = Cells(p, 1).Value
   ThisWorkbook.Sheets("test").Cells(i, Columns.Count).End(1).Offset(, 1) = Cells(p, 2).Value
   
   Exit For
   End If

   Next p
   
   
   
   
   End If
   
   
   
  Workbooks(fileName).Close False
    
 
   End If
   
   Next i
   
   ThisWorkbook.Sheets("test").Activate
   
   ActiveSheet.UsedRange.AutoFit
   Columns("q").NumberFormatLocal = "hh:mm:ss"
      
   
   End Sub
 

   
   
Sub |fffd||f0||fffd||fffd||734||fffd||fffd||3f0||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range






    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next

  With Sheets("|fffd||f0||fffd||fffd||734||fffd||fffd||3f0||fffd|")
  .Activate
  If .Cells(1, 1) <> "|fffd||fffd||a5|" Then
  .UsedRange.Clear
  .Cells(1, 1).Resize(, 3) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|")
  End If
End With


   Do While fileName <> ""

   Workbooks.Open (strPath & fileName)

       ThisWorkbook.Sheets("|fffd||f0||fffd||fffd||734||fffd||fffd||3f0||fffd|").Cells(Rows.Count, 1).End(3)(2) = Date
   ThisWorkbook.Sheets("|fffd||f0||fffd||fffd||734||fffd||fffd||3f0||fffd|").Cells(Rows.Count, 2).End(3)(2) = ActiveSheet.Name
ThisWorkbook.Sheets("|fffd||f0||fffd||fffd||734||fffd||fffd||3f0||fffd|").Cells(Rows.Count, 3).End(3)(2) = Cells(1, 4).Value
   
  fileName = Dir
    
  
ActiveWorkbook.Close True


Loop

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then
Rows(i, 1).Clear
End If
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

        End Sub
        

Sub |fffd||fffd||fffd||5f8||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||570||fffd||fffd||5b0||fffd||fffd||3b3||fffd||fffd||fffd||fffd||fffd|_|fffd||3f7||7fe1||fffd||fffd||fffd||fffd||fffd||fffd|()

Dim varTemp()

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||fffd||fffd||fffd|").Activate

With Sheets("test")
.UsedRange.Clear
.Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
End With

With Sheets("test2")
.UsedRange.Clear
.Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
.Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|1", "|fffd||fffd||fffd||fffd|2", "|fffd||fffd||fffd||fffd|3", "|fffd||fffd||fffd||fffd|")
End With

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|223||fffd||fffd||e2||fffd||fffd||fffd||fffd|" Then
|223||fffd||fffd||e2||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||175||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||175||fffd||fffd||f0||fffd|" Then
|fffd||fffd||fffd||175||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||2ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) = Cells(i + 1, 1) Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)

Else

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)

Sheets("test").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Value
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|1", "|fffd||fffd||fffd||fffd|2", "|fffd||fffd||fffd||fffd|3", "|fffd||fffd||fffd||fffd|")

For a = 1 To UBound(varTemp, 1)
Cells(a + 1, 1).Resize(, 100) = varTemp(a)
Next a

Erase varTemp
r = 0

For a = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 29.5 Then
Rows(a).Clear
End If
Next a


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), order1:=xlDescending


For a = |fffd||fffd||fffd||fffd||fffd| To |fffd||17c||fffd||fffd||fffd||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, a), order1:=xlDescending

For Aa = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(Aa, Columns.Count).End(1).Offset(, 1) = Aa
Next Aa

Next a


For a = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(a, Columns.Count).End(1).Offset(, 1) = Application.Sum(Cells(a, Cells(a, Columns.Count).End(1).Column - 2).Resize(, 3))
Next a

For a = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, a) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = a
End If
Next a


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd|), order1:=xlAscending


Sheets("test2").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(2, 1).Resize(, 100).Value

Sheets("|fffd||fffd||fffd||fffd|").Activate

End If

Next i





End Sub

        
        Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||175||fffd||fffd||3f1||fffd|()
 
   
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
  
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||17c||fffd||fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||377||fffd|(5|fffd||fffd||fffd||333||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||333||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i
 
 
 
For i = 2 To Cells(Rows.Count, 2).End(3).Row
 
fileName = Cells(i, 2).Value & "(5|fffd||fffd|).csv"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "test" Then
   
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||a5|, |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   '|fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 9|fffd||fffd| 5|fffd||fffd||fffd||fffd| |e3||fffd||fffd|
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(i, |fffd||17c||fffd||fffd||fffd|), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
   For Aa = C.Row To C.Row + 5000 '2000|fffd||fffd| |fffd||77a||fffd|
   
   If Cells(Aa, 2) = ThisWorkbook.Sheets("test").Cells(i, |fffd||17c||fffd||fffd||f0||fffd|) Then
   Exit For
   End If
   
   Next Aa
   
   Set C = Nothing
   
   
   '|f9||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| + 5|fffd||3f1||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| sheets 2|fffd||fffd| |fffd||fffd||fffd||fffd|
   Set wksht = Worksheets.Add(after:=Sheets(Sheets.Count))
   
   Sheets(2).Activate
   Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 2) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")
   
   Sheets(1).Cells(Aa, 1).Resize(10, 100).Copy Cells(2, 1)
   
   If Cells(2, 8) < 0 Then
   For ii = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, ii) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd| = ii
   End If
   
   If Cells(1, ii) = "|fffd||fffd||fffd||377||fffd|" Then
   |fffd||fffd||fffd||377||fffd| = ii
   End If

   Next ii
 
    
   For ii = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(ii, 6) / Cells(ii, 3) - 1.0033
   Cells(ii, |fffd||fffd||fffd||377||fffd|) = Cells(ii, 6) / Cells(3, 3) - 1.0033
   
   
   If Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   ThisWorkbook.Sheets("test").Cells(i, |fffd||fffd||fffd||fffd||fffd||333||fffd|) = Cells(ii, |fffd||fffd||fffd||377||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(ii, |fffd||fffd||fffd||377||fffd|).Row - 3
   Exit For
   End If
   
   Next ii
   
   If ii > Cells(Rows.Count, 1).End(3).Row Then
   ThisWorkbook.Sheets("test").Cells(i, |fffd||fffd||fffd||fffd||fffd||333||fffd|) = Cells(ii - 1, |fffd||fffd||fffd||377||fffd|).Value
      ThisWorkbook.Sheets("test").Cells(i, |fffd||175||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(ii, |fffd||fffd||fffd||377||fffd|).Row - 3
   End If
   
   End If
   
   
   
 End If
 
'ActiveWorkbook.Close False

End If

 Next i
 
 
End Sub

 Sub |fffd||7b6||fffd||fffd||5bd||13b||fffd||670||fffd|10|fffd||fffd||fffd||fffd||fffd||175||fffd||fffd||3f1||fffd|()

'|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd|-0.02|fffd||fffd||fffd||fffd|/|fffd||177||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||33b||fffd|/|fffd||fffd||fffd||fffd||fffd||2c23|4|fffd||33b||fffd|

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("test").UsedRange.Clear


   Do While fileName <> ""

   

   Workbooks.Open (strPath & fileName)
  
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 3) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")
  
  With Range("A1").CurrentRegion
     .Sort key1:=.Cells(1, 1), order1:=1, _
           key2:=.Cells(1, 2), order2:=1, _
           Header:=xlYes
    End With
  
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If


Next i

rowsCnt = Cells(Rows.Count, 1).End(3).Row

For i = 2 To rowsCnt

If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 200 Then '|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd||33b||fffd|
If Cells(i, |fffd||fffd||fffd||fffd||fffd|) < 0 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (-)|fffd||3f6||fffd|
If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1 < -0.04 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| -0.055|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Cells(i, 2) > 0.395833333333333 Then

Cells(i, |fffd||fffd||fffd||fffd|) = Split(fileName, "(")(0)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1

For r = 1 To 10
If Cells(i + r, |fffd||fffd||fffd||fffd|) / Cells(i + r, |fffd||f0||fffd|) - 1 > 0 Then
Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i + r, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033
Exit For
End If

Next r

If r > 10 Then
Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i + r, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033
End If

ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value

End If
End If
End If
End If

Next i


   
  fileName = Dir
    
 
ActiveWorkbook.Close False

 

Loop

ThisWorkbook.Sheets("test").Activate
Columns(2).NumberFormatLocal = "hh:mm:ss"


        End Sub
Sub |fffd||7b5||fffd||fffd||fffd|12000|223||fffd||fffd|_|fffd||fffd||fffd||fffd|20|fffd||33b||fffd|_|fffd||177||fffd||fffd||fffd||fffd|30|fffd||fffd||fffd||33b||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||7ff||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||337||3b8||17c||fffd||fffd||3f1||fffd|()
 
'1.|fffd||fffd||fffd| |fffd||331||fffd|_|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|),|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd||fffd||fffd||fffd||fffd|),|fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5|fffd||fffd||fffd||fffd||fffd| |fffd||331||fffd|, |fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5% |fffd||33b||fffd||fffd||33e||fffd||fffd| |fffd||474||fffd|
'2.|f9||fffd||fffd||b0| |fffd||135||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|(10|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| or |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| 8% |fffd||33b||fffd| |fffd||fffd||fffd|)
'3.|fffd||fffd||fffd||fffd| or |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||13a||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |223||fffd||fffd||fffd||5e27| |fffd||fffd||fffd||fffd|
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
   On Error Resume Next
   
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
'for next |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||678||fffd| sheet|fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd| |fffd||171||fffd||fffd|
'3|fffd||fffd||fffd||fffd| |fffd||331||fffd|
'5|fffd||43a||fffd||fffd||fffd||fffd||ef2d| |f9| |fffd||135||fffd||fffd||fffd||fffd||3f1||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |223||fffd||fffd||fffd||5e27| |fffd||fffd||fffd||3f1||fffd|
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
Sheets("test").UsedRange.Clear
Sheets("test2").UsedRange.Clear
Sheets("test").Cells(1, 1).Resize(, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Value 'head |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("test2").Cells(1, 1).Resize(, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Value 'head |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
 
'--- head |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ---
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|(3|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd|(40|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fc||fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|1" Then
|fffd||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
Next i
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) = Cells(i + 1, 1) Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)
 
Else
 
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)
 
Sheets("test").Activate
 
For a = 1 To UBound(varTemp, 1)
Cells(a + 1, 1).Resize(, 100) = varTemp(a)
Next a
 
Erase varTemp
r = 0
 
For a = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| To |fffd||17c||fffd||fffd||fffd||fffd||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, a), order1:=xlDescending
 
For Aa = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(Aa, Columns.Count).End(1).Offset(, 1) = Aa
Next Aa
 
Next a
 
 
For a = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(a, |fffd||fffd||fffd||fffd|1).Resize(, 3))
Next a
 
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd|), order1:=xlAscending
 
 
Sheets("test2").Cells(Rows.Count, 1).End(3)(2).Resize(3, 100) = Cells(2, 1).Resize(3, 100).Value
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
End If
 
Next i
 
 
 
Sheets("test2").Activate
 
 
 
 
fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
End If
 
    Do While fileName <> ""
 
Set CC = Columns(2).Find(Split(fileName, "(")(0), lookat:=xlWhole) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
If CC <> "" Then
 
 
Workbooks.Open (strPath & fileName)
  
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||a5|, |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |e3||fffd||fffd|
Set C = Columns(1).Find(ThisWorkbook.Sheets("test2").Cells(CC.Row, 1), lookat:=xlWhole) '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||fffd| |e3||fffd||fffd|
   
Cells(C.Row - 700, 1).Resize(2000, 100).Copy Sheets(2).Cells(2, 1) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| -10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5|fffd||43a||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value
 
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|")
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
 
 
   Next i
 
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 9, 4).Resize(10)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 9, 5).Resize(10)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) = "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) = "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
      
   Next i
   
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
   ActiveSheet.UsedRange.AutoFit
   Columns(1).AutoFit
   Columns(2).NumberFormatLocal = "hhmmss"
   
   
    
'Workbooks(fileName).Close False
    
End If
 
    
  fileName = Dir
    
 
 
Loop
 
 
 
End Sub

Sub |fffd||fffd||a5||fffd||fffd||1e5||fffd||fffd||fffd||3f1||fffd|()

Sheets("|fffd||fffd||fffd||fffd|").Activate

 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 1) = Left(Cells(i, 1), 4) & "/" & Mid(Cells(i, 1), 5, 2) & "/" & Right(Cells(i, 1), 2)
Next i
 
 
Columns(1).NumberFormatLocal = "yyyy-mm-dd"

End Sub


Sub |fffd||7b5||fffd||fffd||fffd||f9||fffd||135||fffd||fffd||fffd|_|fffd||fffd||fffd||7b5||fffd||fffd||f6||fffd||fffd||17c||fffd|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 24) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|", "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|", "|fffd||135||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd||a5|1", "|fffd||17c||fffd||fffd||f0||fffd|1", "|fffd||17c||fffd||fffd||fffd|1", "|fffd||fffd||fffd||fffd||fffd||fffd|1", "|fffd||fffd||fffd||377||fffd|1", "|fffd||17c||fffd||fffd||fffd||a5|2", "|fffd||17c||fffd||fffd||f0||fffd|2", "|fffd||17c||fffd||fffd||fffd|2", "|fffd||fffd||fffd||fffd||fffd||fffd|2", _
"|fffd||fffd||fffd||377||fffd|2", "|fffd||17c||fffd||fffd||fffd||a5|3", "|fffd||17c||fffd||fffd||f0||fffd|3", "|fffd||17c||fffd||fffd||fffd|3", "|fffd||fffd||fffd||fffd||fffd||fffd|3", "|fffd||fffd||fffd||377||fffd|3", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b3||fffd||a5|", "|fffd||fffd||fffd||7bd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5| = i
End If
 
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|1" Then
|fffd||17c||fffd||fffd||fffd||a5|1 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|1" Then
|fffd||17c||fffd||fffd||f0||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|1" Then
|fffd||17c||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|1" Then
|fffd||fffd||fffd||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|1" Then
|fffd||fffd||fffd||377||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|2" Then
|fffd||17c||fffd||fffd||fffd||a5|2 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|2" Then
|fffd||17c||fffd||fffd||f0||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|2" Then
|fffd||fffd||fffd||fffd||fffd||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|2" Then
|fffd||17c||fffd||fffd||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|2" Then
|fffd||fffd||fffd||377||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|3" Then
|fffd||17c||fffd||fffd||fffd||a5|3 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|3" Then
|fffd||17c||fffd||fffd||fffd|3 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|3" Then
|fffd||17c||fffd||fffd||f0||fffd|3 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|3" Then
|fffd||fffd||fffd||fffd||fffd||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|3" Then
|fffd||fffd||fffd||377||fffd|3 = i
End If

 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b3||fffd||a5|" Then
|fffd||fffd||fffd||7b3||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7bd||f0||fffd|" Then
|fffd||fffd||fffd||7bd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If
 
 
Next i
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
Columns(|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|1).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|2).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|3).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||fffd||fffd||7b3||fffd||a5|).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|1).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||f0||fffd|2).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|3).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||fffd||fffd||7bd||f0||fffd|).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||fffd|1).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||fffd|2).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||fffd|3).NumberFormatLocal = "#,###"
  


For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(5|fffd||fffd|).xlsx"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    

Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   
Cells(C.Row - 800, 1).Resize(1600, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
 
    
 
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then '|fffd||fffd||fffd||fe1| |fffd||fffd||a5||fffd||fffd| test|fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Application.Min(Cells(2, |fffd||3f6||fffd||fffd||135||fffd|).Resize(i - 1))
   y = i
   Exit For
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| |16c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||270||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = y To y + 500
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|) = Cells(i - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|) = Cells(i - 1, 2).Value
   Exit For
   End If
   
   Next i
   
    
   
   
   '|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| |fffd||fffd||fffd||3f1||fffd|
   With ThisWorkbook.Sheets("test")
   .Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = .Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd|) * (1 + .Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Value)
   End With
   
   Set C = Nothing
   

   'sheet2 clear
   ActiveSheet.UsedRange.Offset(1).Clear '|fffd||fffd||fffd||7ba70||fffd| sheet2 |fffd||fffd||fffd||fffd||fffd|
   
   Sheets(1).Activate 'sheet1 activate
   
  
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|), lookat:=xlWhole) 'sheet2|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   Cells(C.Row, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1) '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| 3000|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
   
   Sheets(2).Activate 'sheet2 activate
   Columns(2).NumberFormatLocal = "hh:mm:ss"
   Cells(Rows.Count, 1).End(3)(2).Resize(, 2) = ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|).Resize(, 2).Value '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd| |22e||fffd||fffd|
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd|
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd| |22e||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 2) = Cells(i - 1, 2) Then
   Exit For
   End If
   Next i
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Cells(i + 1, 1).Resize(5000, 100).Copy Cells(2, 1)
   
   Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|a"
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column '|fffd||fffd||fffd||fffd||fffd||fffd|1 head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|a" Then
   |fffd||fffd||fffd||fffd||fffd||fffd|a = i
   End If
     
   Next i
   
   '|fffd||fffd||fffd||fffd||fc| |fffd||fffd||22f|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
     
   If Cells(i, 5) < ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|).Value Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||270||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   For ii = 0 To 500 '500|238| |fffd||fffd||22f|
   If Cells(i + ii, 6) / Cells(i + ii, 3) >= 1.01 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| |fffd||fffd||fffd||1f0||fffd||fffd||338||fffd|
   Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd|a) = Cells(i + ii, 6) / Cells(i + ii, 3)
   r = r + 1
   
   If r = 3 Then
   r = 0
   Exit For
   End If
   
   End If
   Next ii
   
   Exit For
   End If
   
   
   Next i
     
   rr = |fffd||17c||fffd||fffd||fffd||a5|1
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|a) >= 1.01 Then
   ThisWorkbook.Sheets("test").Cells(a, rr) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 1) = Cells(i, 2).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 2) = Cells(i, 6).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 3) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|a).Value - 1
   ThisWorkbook.Sheets("test").Cells(a, rr + 4) = Application.Max(Cells(i + 1, 4).Resize(500)) / Cells(i, 6)
   
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd| + 1) = "" Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd| + 1) = Cells(i + 500, 4) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|1) - 1
   End If
   
   rr = rr + 5
   
   If rr = |fffd||17c||fffd||fffd||fffd||a5| + 15 Then
   Exit For
   End If
   
   End If
   
   Next i

      
      'autofit |fffd||171||fffd||fffd| |e2||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
'   ActiveSheet.UsedRange.AutoFit
'   Columns(1).AutoFit
'   Columns(2).NumberFormatLocal = "hh:mm:ss"
   
'   Cells(2, 4).Select
'   ActiveWindow.FreezePanes = True
   
   '5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||771||fffd|
Workbooks(fileName).Close False
      
  
 
  '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
fileName = Cells(a, 2).Value & ".xlsx"                '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|'
 
Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
  
  '|fffd||fffd||a5||fffd||fffd| |fffd||fffd||121||fffd||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 1) = Left(Cells(i, 1), 4) & "/" & Mid(Cells(i, 1), 5, 2) & "/" & Right(Cells(i, 1), 2)
Next i
  
Columns(1).NumberFormatLocal = "yyyy-mm-dd"
    
 '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |e3||fffd||fffd|
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
 
 
'sheet2|fffd||fffd| |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5| -100 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet2|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Cells(2, 1).Resize(3000, 100) = Sheets(1).Cells(C.Row - 100, 1).Resize(3000, 100).Value '
 
'|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||f0||fffd| -100 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Set C = Columns(2).Find(ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|), lookat:=xlWhole)
   Cells(2, 1).Resize(3000, 100) = Cells(C.Row - 100, 1).Resize(3000, 100).Value
   
      Cells(2, 4).Select
   ActiveWindow.FreezePanes = True
   
 Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 3) = Array("|fc||fffd||1dee||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|")
 
 For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||f0||fffd|" Then
   |fffd||f0||fffd| = i
   End If
     
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "|fc||fffd||1dee|" Then
   |fc||fffd||1dee| = i
   End If
 
   If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd|" Then
   |fc||fffd||1dee||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
   End If
      
   If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|, |fc||fffd||1dee||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
   Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|) = Application.Average(Cells(i - 99, |fc||fffd||1dee|).Resize(100))
   Next i
   
   '
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) - Cells(i - 1, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
  Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|)
   
   If Cells(i, 1) <> Cells(i - 1, 1) Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
   Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|)
   End If
   
   Next i
   


   For i = 100 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 1) = ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||a5|1) Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|1) = Cells(i, 2) Then
   If Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10)) > 3 Then
    
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7b3||fffd||a5|) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7bd||f0||fffd|) = Cells(i, |fffd||f0||fffd|).Value
   Exit For
   
   End If
   End If
   End If
   
   If Cells(i, 1) = ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||a5|2) Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|2) = Cells(i, 2) Then
   If Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10)) > 3 Then
    
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7b3||fffd||a5|) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7bd||f0||fffd|) = Cells(i, |fffd||f0||fffd|).Value
   Exit For
   
   End If
   End If
   End If
   
   If Cells(i, 1) = ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||a5|3) Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|3) = Cells(i, 2) Then
   If Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10)) > 3 Then
      
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7b3||fffd||a5|) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7bd||f0||fffd|) = Cells(i, |fffd||f0||fffd|).Value
   Exit For
   
   End If
   End If
   End If
   
   
     
   Next i
   
      
   
   'Columns(2).NumberFormatLocal = "hh:mm:ss"
   
   End If
   Workbooks(fileName).Close False
   
  End If
    
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
 ActiveSheet.UsedRange.AutoFit
     
     
 For i = 2 To Cells(Rows.Count, 1).End(3).Row
 Set C = Rows(i).Find(Cells(i, |fffd||fffd||fffd||7bd||f0||fffd|), lookat:=xlPart)
 'If Not C Is Nothing Then
 Cells(i, |fffd||fffd||fffd||377||fffd|) = C.Offset(, 3) - 1
 Set C = Nothing
 'End If
 Next i
 
 
Columns(|fffd||17c||fffd||fffd||f0||fffd|1).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|2).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|3).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||fffd||fffd||7bd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
 
   End Sub
 
 
Sub |fffd||7fa||fffd||fffd||fffd||fffd||fffd|11()

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key1:=Cells(1, 2), key1:=Cells(1, 4)


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1

If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then
If Cells(i, 4) = Cells(i - 1, 4) Then
Rows(i).Clear
End If
End If
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key1:=Cells(1, 2), key1:=Cells(1, 4)

End Sub

Sub |fffd||7b5||fffd||fffd||fffd||f9||fffd||135||fffd||fffd||fffd|_|fffd||fffd||fffd||7b5||fffd||fffd||f6||fffd||fffd||17c||fffd|11()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 19) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|", "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|", "|fffd||135||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd||a5|1", "|fffd||17c||fffd||fffd||f0||fffd|1", "|fffd||17c||fffd||fffd||fffd|1", "|fffd||fffd||fffd||fffd||fffd||fffd|1", "|fffd||fffd||fffd||377||fffd|1", "|fffd||17c||fffd||fffd||fffd||a5|2", "|fffd||17c||fffd||fffd||f0||fffd|2", "|fffd||17c||fffd||fffd||fffd|2", "|fffd||fffd||fffd||fffd||fffd||fffd|2", _
"|fffd||fffd||fffd||377||fffd|2", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b3||fffd||a5|", "|fffd||fffd||fffd||7bd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5| = i
End If
 
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|1" Then
|fffd||17c||fffd||fffd||fffd||a5|1 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|1" Then
|fffd||17c||fffd||fffd||f0||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|1" Then
|fffd||17c||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|1" Then
|fffd||fffd||fffd||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|1" Then
|fffd||fffd||fffd||377||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|2" Then
|fffd||17c||fffd||fffd||fffd||a5|2 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|2" Then
|fffd||17c||fffd||fffd||f0||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|2" Then
|fffd||fffd||fffd||fffd||fffd||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|2" Then
|fffd||17c||fffd||fffd||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|2" Then
|fffd||fffd||fffd||377||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|3" Then
|fffd||17c||fffd||fffd||fffd||a5|3 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|3" Then
|fffd||17c||fffd||fffd||fffd|3 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|3" Then
|fffd||17c||fffd||fffd||f0||fffd|3 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|3" Then
|fffd||fffd||fffd||fffd||fffd||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|3" Then
|fffd||fffd||fffd||377||fffd|3 = i
End If

 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b3||fffd||a5|" Then
|fffd||fffd||fffd||7b3||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7bd||f0||fffd|" Then
|fffd||fffd||fffd||7bd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If
 
 
Next i
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
Columns(|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|1).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|2).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|3).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||fffd||fffd||7b3||fffd||a5|).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|1).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||f0||fffd|2).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|3).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||fffd||fffd||7bd||f0||fffd|).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||fffd|1).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||fffd|2).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||fffd|3).NumberFormatLocal = "#,###"
  


For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(5|fffd||fffd|).csv"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    

Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
         
   Set wksht = Worksheets.Add(after:=Sheets(Sheets.Count))
   Sheets(1).Activate
Cells(C.Row - 500, 1).Resize(1600, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|


Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   Sheets(2).Activate
   
   
   
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|).Value
   
   End If
   End If
     
   
   Next i
   
   
   
   
      For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i - 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).Value
   
   End If
   End If
   
   
  
   
   Next i
      
           
      
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
 
    
 
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then '|fffd||fffd||fffd||fe1| |fffd||fffd||a5||fffd||fffd| test|fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Application.Min(Cells(2, |fffd||3f6||fffd||fffd||135||fffd|).Resize(i - 1))
   y = i
   Exit For
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| |16c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||270||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = y To y + 500
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|) = Cells(i - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|) = Cells(i - 1, 2).Value
   Exit For
   End If
   
   Next i
       
   
   '|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| |fffd||fffd||fffd||3f1||fffd|
   With ThisWorkbook.Sheets("test")
   .Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = .Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd|) * (1 + .Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Value)
   End With
   
   Set C = Nothing
   

   'sheet2 clear
   ActiveSheet.UsedRange.Offset(1).Clear '|fffd||fffd||fffd||7ba70||fffd| sheet2 |fffd||fffd||fffd||fffd||fffd|
   
   Sheets(1).Activate 'sheet1 activate
   
  
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|), lookat:=xlWhole) 'sheet2|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   Cells(C.Row, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1) '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| 3000|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
   
   Sheets(2).Activate 'sheet2 activate
   Columns(2).NumberFormatLocal = "hh:mm:ss"
   Cells(Rows.Count, 1).End(3)(2).Resize(, 2) = ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|).Resize(, 2).Value '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd| |22e||fffd||fffd|
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd|
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd| |22e||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 2) = Cells(i - 1, 2) Then
   Exit For
   End If
   Next i
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Cells(i + 1, 1).Resize(5000, 100).Copy Cells(2, 1)
   
   Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|a"
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column '|fffd||fffd||fffd||fffd||fffd||fffd|1 head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|a" Then
   |fffd||fffd||fffd||fffd||fffd||fffd|a = i
   End If
     
   Next i
   
   r = 0
   
   '|fffd||fffd||fffd||fffd||fc| |fffd||fffd||22f|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
     
   If Cells(i, 5) < ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|).Value Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||270||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   For ii = 0 To 30 '500|238| |fffd||fffd||22f|
   If Cells(i + ii, 6) / Cells(i + ii, 3) < 0.99 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| |fffd||fffd||fffd||1f0||fffd||fffd||338||fffd|
   Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd|a) = Cells(i + ii, 6) / Cells(i + ii, 3)
   r = r + 1
   
   If r = 2 Then
   r = 0
   Exit For
   End If
   
   End If
   Next ii
   
   Exit For
   End If
   
   
   Next i
     
   rr = |fffd||17c||fffd||fffd||fffd||a5|1
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|a) <> "" Then
   ThisWorkbook.Sheets("test").Cells(a, rr) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 1) = Cells(i, 2).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 2) = Cells(i, 6).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 3) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|a).Value - 1

   rr = rr + 5
   
   If rr = |fffd||17c||fffd||fffd||fffd||a5| + 10 Then
   Exit For
   End If
   
   End If
   
   Next i

      
      'autofit |fffd||171||fffd||fffd| |e2||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
'   ActiveSheet.UsedRange.AutoFit
'   Columns(1).AutoFit
'   Columns(2).NumberFormatLocal = "hh:mm:ss"
   
'   Cells(2, 4).Select
'   ActiveWindow.FreezePanes = True
   
   '5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||771||fffd|
Workbooks(fileName).Close False



   
   'Columns(2).NumberFormatLocal = "hh:mm:ss"
   
   
  End If
    
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
 ActiveSheet.UsedRange.AutoFit
     
     
 For i = 2 To Cells(Rows.Count, 1).End(3).Row
 Set C = Rows(i).Find(Cells(i, |fffd||fffd||fffd||7bd||f0||fffd|), lookat:=xlPart)
 'If Not C Is Nothing Then
 Cells(i, |fffd||fffd||fffd||377||fffd|) = C.Offset(, 3) - 1
 Set C = Nothing
 'End If
 Next i
 
 
Columns(|fffd||17c||fffd||fffd||f0||fffd|1).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|2).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|3).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||fffd||fffd||7bd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
 
   End Sub
   
   
   
Sub |fffd||fffd||fffd||fffd||fffd||fffd|30|fffd||43c||fffd||fffd||7b5||fffd||fffd||f6||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 24) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|", "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|", "|fffd||135||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd||a5|1", "|fffd||17c||fffd||fffd||f0||fffd|1", "|fffd||17c||fffd||fffd||fffd|1", "|fffd||fffd||fffd||fffd||fffd||fffd|1", "|fffd||fffd||fffd||377||fffd|1", "|fffd||17c||fffd||fffd||fffd||a5|2", "|fffd||17c||fffd||fffd||f0||fffd|2", "|fffd||17c||fffd||fffd||fffd|2", "|fffd||fffd||fffd||fffd||fffd||fffd|2", _
"|fffd||fffd||fffd||377||fffd|2", "|fffd||17c||fffd||fffd||fffd||a5|3", "|fffd||17c||fffd||fffd||f0||fffd|3", "|fffd||17c||fffd||fffd||fffd|3", "|fffd||fffd||fffd||fffd||fffd||fffd|3", "|fffd||fffd||fffd||377||fffd|3", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b3||fffd||a5|", "|fffd||fffd||fffd||7bd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5| = i
End If
 
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|1" Then
|fffd||17c||fffd||fffd||fffd||a5|1 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|1" Then
|fffd||17c||fffd||fffd||f0||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|1" Then
|fffd||17c||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|1" Then
|fffd||fffd||fffd||fffd||fffd||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|1" Then
|fffd||fffd||fffd||377||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|2" Then
|fffd||17c||fffd||fffd||fffd||a5|2 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|2" Then
|fffd||17c||fffd||fffd||f0||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|2" Then
|fffd||fffd||fffd||fffd||fffd||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|2" Then
|fffd||17c||fffd||fffd||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|2" Then
|fffd||fffd||fffd||377||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||a5|3" Then
|fffd||17c||fffd||fffd||fffd||a5|3 = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|3" Then
|fffd||17c||fffd||fffd||fffd|3 = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|3" Then
|fffd||17c||fffd||fffd||f0||fffd|3 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|3" Then
|fffd||fffd||fffd||fffd||fffd||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|3" Then
|fffd||fffd||fffd||377||fffd|3 = i
End If

 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b3||fffd||a5|" Then
|fffd||fffd||fffd||7b3||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7bd||f0||fffd|" Then
|fffd||fffd||fffd||7bd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If
 
 
Next i
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
Columns(|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|1).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|2).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd||a5|3).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||fffd||fffd||7b3||fffd||a5|).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|1).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||f0||fffd|2).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|3).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||fffd||fffd||7bd||f0||fffd|).NumberFormatLocal = "#,###" '"hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||fffd|1).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||fffd|2).NumberFormatLocal = "#,###"
Columns(|fffd||17c||fffd||fffd||fffd|3).NumberFormatLocal = "#,###"
  


For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|

 
  '|223||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
fileName = Cells(a, 2).Value & ".xlsx"                '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|'
 
Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
  ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
  
  '|fffd||fffd||a5||fffd||fffd| |fffd||fffd||121||fffd||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 1) = Left(Cells(i, 1), 4) & "/" & Mid(Cells(i, 1), 5, 2) & "/" & Right(Cells(i, 1), 2)
Next i
  
Columns(1).NumberFormatLocal = "yyyy-mm-dd"
    
 '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5| |e3||fffd||fffd|
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
 
 
'sheet2|fffd||fffd| |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5| -100 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet2|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Cells(2, 1).Resize(3000, 100) = Sheets(1).Cells(C.Row, 1).Resize(3000, 100).Value '
 
'|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||f0||fffd| -100 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Set C = Columns(2).Find(ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||17c||fffd||fffd||f0||fffd|), lookat:=xlWhole)
   Cells(2, 1).Resize(3000, 100) = Cells(C.Row - 100, 1).Resize(3000, 100).Value
   
      Cells(2, 4).Select
   ActiveWindow.FreezePanes = True
   
 Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 3) = Array("|fc||fffd||1dee||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|")
 
 For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||f0||fffd|" Then
   |fffd||f0||fffd| = i
   End If
     
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
   |fffd||175||fffd||fc||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
   |fffd||17c||fffd||fc||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "|fc||fffd||1dee|" Then
   |fc||fffd||1dee| = i
   End If
 
   If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|" Then
   |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee| = i
   End If
   
   If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd|" Then
   |fc||fffd||1dee||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
   End If
      
   If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|, |fc||fffd||1dee||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
   Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|) = Application.Average(Cells(i - 99, |fc||fffd||1dee|).Resize(100))
   Next i
   
   '
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|) - Cells(i - 1, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
  Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|)
   
   If Cells(i, 1) <> Cells(i - 1, 1) Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||17c||fffd||fc||fffd||1dee|)
   Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee||fffd||fffd||fffd|)
   End If
   
   Next i
   


   For i = 100 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 1) = ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||a5|1) Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|1) = Cells(i, 2) Then
   If Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10)) > 3 Then
    
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7b3||fffd||a5|) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7bd||f0||fffd|) = Cells(i, |fffd||f0||fffd|).Value
   Exit For
   
   End If
   End If
   End If
   
   If Cells(i, 1) = ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||a5|2) Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|2) = Cells(i, 2) Then
   If Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10)) > 3 Then
    
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7b3||fffd||a5|) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7bd||f0||fffd|) = Cells(i, |fffd||f0||fffd|).Value
   Exit For
   
   End If
   End If
   End If
   
   If Cells(i, 1) = ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||a5|3) Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|3) = Cells(i, 2) Then
   If Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10)) > 3 Then
      
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i - 9, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(10))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7b3||fffd||a5|) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||7bd||f0||fffd|) = Cells(i, |fffd||f0||fffd|).Value
   Exit For
   
   End If
   End If
   End If
   
   
     
   Next i
   
      
   
   'Columns(2).NumberFormatLocal = "hh:mm:ss"
   
   End If
   Workbooks(fileName).Close False





 
fileName = Cells(a, 2).Value & "(5|fffd||fffd|).xlsx"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    

Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   
Cells(C.Row - 800, 1).Resize(1600, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
 
    
 
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then '|fffd||fffd||fffd||fe1| |fffd||fffd||a5||fffd||fffd| test|fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |169||fffd||678||fffd|
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Application.Min(Cells(2, |fffd||3f6||fffd||fffd||135||fffd|).Resize(i - 1))
   y = i
   Exit For
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| |16c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||270||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = y To y + 500
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|) = Cells(i - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||f0||fffd|) = Cells(i - 1, 2).Value
   Exit For
   End If
   
   Next i
   
    
   
   
   '|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| |fffd||fffd||fffd||3f1||fffd|
   With ThisWorkbook.Sheets("test")
   .Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = .Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd|) * (1 + .Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Value)
   End With
   
   Set C = Nothing
   

   'sheet2 clear
   ActiveSheet.UsedRange.Offset(1).Clear '|fffd||fffd||fffd||7ba70||fffd| sheet2 |fffd||fffd||fffd||fffd||fffd|
   
   Sheets(1).Activate 'sheet1 activate
   
  
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|), lookat:=xlWhole) 'sheet2|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   Cells(C.Row, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1) '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| 3000|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
   
   Sheets(2).Activate 'sheet2 activate
   Columns(2).NumberFormatLocal = "hh:mm:ss"
   Cells(Rows.Count, 1).End(3)(2).Resize(, 2) = ThisWorkbook.Sheets("test").Cells(a, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5|).Resize(, 2).Value '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd| |22e||fffd||fffd|
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd|
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd| |22e||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 2) = Cells(i - 1, 2) Then
   Exit For
   End If
   Next i
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Cells(i + 1, 1).Resize(5000, 100).Copy Cells(2, 1)
   
   Cells(1, Columns.Count).End(1).Offset(, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|a"
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column '|fffd||fffd||fffd||fffd||fffd||fffd|1 head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|a" Then
   |fffd||fffd||fffd||fffd||fffd||fffd|a = i
   End If
     
   Next i
   
   '|fffd||fffd||fffd||fffd||fc| |fffd||fffd||22f|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
     
   If Cells(i, 5) < ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|).Value Then '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||270||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   For ii = 0 To 500 '500|238| |fffd||fffd||22f|
   If Cells(i + ii, 6) / Cells(i + ii, 3) >= 1.01 Then '|fffd||fffd||fffd||fffd||fffd||330||fffd| |fffd||fffd||fffd||1f0||fffd||fffd||338||fffd|
   Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd|a) = Cells(i + ii, 6) / Cells(i + ii, 3)
   r = r + 1
   
   If r = 3 Then
   r = 0
   Exit For
   End If
   
   End If
   Next ii
   
   Exit For
   End If
   
   
   Next i
     
   rr = |fffd||17c||fffd||fffd||fffd||a5|1
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|a) >= 1.01 Then
   ThisWorkbook.Sheets("test").Cells(a, rr) = Cells(i, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 1) = Cells(i, 2).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 2) = Cells(i, 6).Value
   ThisWorkbook.Sheets("test").Cells(a, rr + 3) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|a).Value - 1
   ThisWorkbook.Sheets("test").Cells(a, rr + 4) = Application.Max(Cells(i + 1, 4).Resize(500)) / Cells(i, 6)
   
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd| + 1) = "" Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd| + 1) = Cells(i + 500, 4) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|1) - 1
   End If
   
   rr = rr + 5
   
   If rr = |fffd||17c||fffd||fffd||fffd||a5| + 15 Then
   Exit For
   End If
   
   End If
   
   Next i

      
      'autofit |fffd||171||fffd||fffd| |e2||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
'   ActiveSheet.UsedRange.AutoFit
'   Columns(1).AutoFit
'   Columns(2).NumberFormatLocal = "hh:mm:ss"
   
'   Cells(2, 4).Select
'   ActiveWindow.FreezePanes = True
   
   '5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||771||fffd|
Workbooks(fileName).Close False
      
  
   
  End If
    
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
 ActiveSheet.UsedRange.AutoFit
     
     
 For i = 2 To Cells(Rows.Count, 1).End(3).Row
 Set C = Rows(i).Find(Cells(i, |fffd||fffd||fffd||7bd||f0||fffd|), lookat:=xlPart)
 'If Not C Is Nothing Then
 Cells(i, |fffd||fffd||fffd||377||fffd|) = C.Offset(, 3) - 1
 Set C = Nothing
 'End If
 Next i
 
 
Columns(|fffd||17c||fffd||fffd||f0||fffd|1).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|2).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||17c||fffd||fffd||f0||fffd|3).NumberFormatLocal = "hh:mm:ss"
Columns(|fffd||fffd||fffd||7bd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
 
   End Sub
   
   
   Sub |fffd||7b5||fffd||fffd||fffd||f9||fffd||135||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||531||fffd|()
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 7) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||17c||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If
 
 
 
Next i
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
 
For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(5|fffd||fffd|).csv"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   
Cells(C.Row - 800, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "180" Then
   |fffd||fffd||fffd||23d||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
  Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(5000).Clear
  
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   Next i
   
   For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i - 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
   r = 0
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) <> "" Or Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
    
   Erase varTemp
   
    
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| 180|fffd||43a||fffd||fffd||fffd||fffd||fffd| 20% |fffd||33b||fffd| |fffd||fffd||fffd||333||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Application.Max(Cells(i - 20, |fffd||fffd||fffd||fffd||135||fffd|).Resize(20))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) = Application.Min(Cells(i - 20, |fffd||3f6||fffd||fffd||135||fffd|).Resize(20))

   For ii = 0 To 1000
   If Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) > Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|) = Cells(i + ii - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|) = Cells(i + ii - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd|) * (1 + ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd|) = (Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|).Resize(10)) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|)) - 1.0033
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|))
   Exit For
   End If
   End If
   Next ii
   
   
   Exit For
   End If

   Next i
   
   
 
   
End If
'Workbooks(fileName).Close False
 
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
Columns(|fffd||17c||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||fffd||fffd||377||fffd|) = "" Then
Rows(i).Clear
End If
Next i
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||fffd|) Then
If Cells(i, |fffd||17c||fffd||fffd||f0||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||f0||fffd|) Then
If Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i - 1, |fffd||fffd||fffd||377||fffd|) Then
Rows(i).Clear
End If
End If
End If
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
 
 
   End Sub
 
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||3fa||fffd||fffd||fffd||fffd||fffd||331||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 
Sheets("test").UsedRange.Clear
 
Sheets("test").Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
 
   Do While fileName <> ""
   
   Workbooks.Open (strPath & fileName)
      
 
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   
   Cells(1, Columns.Count).End(1).Resize(, 2) = Array("20|fffd||fffd||fffd||fffd|", "|fffd||7b5||fffd||fffd||fffd|")
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, i) = "20" Then
   |fffd||33d||fffd||fffd||335||fffd| = i
   End If
   
   If Cells(1, i) = "20|fffd||fffd||fffd||fffd|" Then
   |fffd||33d||2bf||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||7b5||fffd||fffd||fffd|" Then
   |fffd||7b5||fffd||fffd||fffd| = i
   End If
   
   Next i
   
   
 
   
For i = 21 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||33d||2bf||fffd||fffd||fffd|) = Cells(i, |fffd||33d||fffd||fffd||335||fffd|) * 1.2
If Cells(i, |fffd||33d||2bf||fffd||fffd||fffd|) < Cells(i, 5) Then

For ii = 1 To 10

If Cells(i - ii, |fffd||7b5||fffd||fffd||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
Exit For
End If

Next ii

If ii = 11 Then
ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2) = Cells(i, 1).Value
ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3)(2) = Split(fileName, "(")(0)
Cells(i, |fffd||7b5||fffd||fffd||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
End If
 
End If
 
Next i
 
   
Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
 
 
 
 
   End Sub
 
 Sub |fffd||7b5||fffd||fffd||138||fffd||fffd||333||fffd|18|fffd||fffd||fffd||3bf||fffd||fffd||fffd||fffd||17c||fffd|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 6) = Array("|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", _
"|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||17c||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If
 
 
 
Next i
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
 
For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(5|fffd||fffd|).xlsx"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   
Cells(C.Row - 800, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "180" Then
   |fffd||fffd||fffd||23d||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
  Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(5000).Clear
  
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   Next i
   
   For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i - 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
   r = 0
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) <> "" Or Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
    
   Erase varTemp
   
    
 
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| 180|fffd||43a||fffd||fffd||fffd||fffd||fffd| 20% |fffd||33b||fffd| |fffd||fffd||fffd||333||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
   
   
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then
   
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) = Application.Min(Cells(20, |fffd||3f6||fffd||fffd||135||fffd|).Resize(Cells(i - 1, |fffd||3f6||fffd||fffd||135||fffd|).Row - 19))
 
   
 
   For ii = 0 To 100
   If Cells(i + ii, |fffd||fffd||fffd||fffd||135||fffd|) = "" And Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   If Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) < -0.15 Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|).Resize(, 2) = Cells(i + ii, 1).Resize(, 2).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd||135||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd|) * 0.85
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd|) = (Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|).Resize(50)) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|)) - 1.0033
   Exit For
   End If
   Exit For
   End If
   
   If Cells(i + ii, |fffd||fffd||fffd||fffd||135||fffd|) <> "" And Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) = "" Then
   If Cells(i + ii + 1, |fffd||3f6||fffd||fffd||135||fffd|) < -0.15 Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|).Resize(, 2) = Cells(i + ii + 1, 1).Resize(, 2).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||135||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd|) * 0.85
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd|) = (Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|).Resize(50)) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|)) - 1.0033
   Exit For
   End If
   Exit For
   End If
   
   
   Next ii
   
   Exit For
   End If
   
   Next i
   
   
 
   
End If
 
Workbooks(fileName).Close False
 
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
Columns(|fffd||17c||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||fffd||fffd||377||fffd|) = "" Then
Rows(i).Clear
End If
Next i
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||fffd|) Then
If Cells(i, |fffd||17c||fffd||fffd||f0||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||f0||fffd|) Then
If Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i - 1, |fffd||fffd||fffd||377||fffd|) Then
Rows(i).Clear
End If
End If
End If
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
 
 
   End Sub
 Sub |fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
  
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 
ThisWorkbook.Sheets("test").UsedRange.Clear
 
ThisWorkbook.Sheets("test").Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
 
   Do While fileName <> ""
   
   Workbooks.Open (strPath & fileName)
      
 
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   
   Cells(1, Columns.Count).End(1).Resize(, 6) = Array("20|fffd||fffd||fffd||fffd|", "|fffd||7b5||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||127||fffd||fffd|", "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|")
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, i) = "20" Then
   |fffd||33d||fffd||fffd||335||fffd| = i
   End If
   
   If Cells(1, i) = "20|fffd||fffd||fffd||fffd|" Then
   |fffd||33d||2bf||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||7b5||fffd||fffd||fffd|" Then
   |fffd||7b5||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||127||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||127||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|" Then
   |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd| = i
   End If
   
   Next i
   
   
 
   
For i = 21 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||33d||2bf||fffd||fffd||fffd|) = Cells(i, |fffd||33d||fffd||fffd||335||fffd|) * 1.2
 
If Cells(i, |fffd||33d||2bf||fffd||fffd||fffd|) < Cells(i, 5) Then
If Application.CountA(Cells(i - 9, |fffd||7b5||fffd||fffd||fffd|).Resize(9)) = 0 Then
Cells(i, |fffd||7b5||fffd||fffd||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
 
'If Cells(i + 1, 5) / Cells(i + 1, 2) - 1 > -0.05 And Cells(i + 1, 5) / Cells(i + 1, 2) - 1 < 0.05 Then
'Cells(i + 1, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, 5) / Cells(i + 1, 2) - 1
 
'If Cells(i + 1, 4) < Cells(i, 5) Then
'Cells(i + 1, |fffd||fffd||fffd||fffd||127||fffd||fffd|) = "|127||fffd||fffd|"
 
'If Cells(i + 1, |fffd||fffd||fffd||fffd||fffd|) > -0.05 And Cells(i + 1, |fffd||fffd||fffd||fffd||fffd|) < 0.05 Then
'Cells(i + 1, |fffd||5b0||fffd||fffd||fffd||fffd||377||fffd|) = Cells(i + 1, 3) / Cells(i, 5) - 1
'Cells(i + 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|) = Cells(i + 1, 5) / Cells(i, 5) - 1
ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i + 1, 1).Resize(, 100).Value
ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3) = Split(fileName, "(")(0)
'End If
 
'End If
 
'End If
 
End If
End If
 
Next i
 
   
Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, 2) = Cells(i - 1, 2) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

 
 
   End Sub
 Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||5bd||170||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
  
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 
ThisWorkbook.Sheets("test").UsedRange.Clear
 
ThisWorkbook.Sheets("test").Cells(1, 1).Resize(, 8) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||63a||fffd|", "|f9||fffd||170||fffd||fffd||fffd||fffd||fffd||a5|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|", _
"|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|")
 
   Do While fileName <> ""
   
   Workbooks.Open (strPath & fileName)
      
 
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
   
   Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 2) = Array("52|fffd||5b0||fffd||fffd||fffd|", "|fffd||170||fffd||fffd||fffd|")
   
   For i = 1 To Cells(1, Columns.Count).End(1).Column
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd| = i
   End If
       
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd||fffd| = i
   End If
    
   If Cells(1, i) = "52|fffd||5b0||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||170||fffd||fffd||fffd|" Then
   |fffd||170||fffd||fffd||fffd| = i
   End If
   
   Next i
   
   
 
   
For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1).Row > 251 Then
If Cells(i, 5) > Application.Max(Cells(i - 250, 3).Resize(250)) Then
If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 5000 Then

ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3) = Split(fileName, "(")(0)

End If
End If
End If
 
Next i
 
   
Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)

 
 
   End Sub
 





Sub |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||5b4||be||fffd||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 
ThisWorkbook.Sheets("test").UsedRange.Clear
 
ThisWorkbook.Sheets("test").Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
 
   Do While fileName <> ""
   
   Workbooks.Open (strPath & fileName)
      
 
 
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "180" Then
   |fffd||fffd||fffd||23d||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||731||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
   |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
   |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd||fffd| = i
   End If
   
 
   Next i
   
   
   Set wksht = Worksheets.Add(after:=Sheets(Sheets.Count))
 
Sheets(1).UsedRange.Copy Sheets(2).Cells(1, 1)
  
 
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
   
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 5, 3).Resize(11)) = Cells(i, 3) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 3)
   End If
      
   If Application.Min(Cells(i - 5, 4).Resize(11)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   Next i
   
   For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i - 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
   r = 0
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) <> "" Or Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
    
   Erase varTemp
   
    
   Sheets(1).Activate
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, 5) / Cells(i, 2) - 1 > 0.05 Then
   If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd|) > 0.1 Then
   If Cells(i, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd|) > 0 Then
   If Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd|) < 0 Then
   If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 1000 Then
   
   ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
   ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3) = Split(fileName, "(")(0)
      
   'With Sheets(2)
   
  ' For ii = 2 To .Cells(Rows.Count, 1).End(3).Row
   'If .Cells(ii, 1) >= Cells(i, 1) Then
   'If Cells(i, 5) > .Cells(ii - 1, 3) Then
   
   'ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
   'Exit For
   
   'End If
   'End If
   'Next ii
   
   'End With
   
   End If
   End If
   End If
   End If
   End If
   
   Next i
   
 
 
   
Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
 
 
 
 
   End Sub
 



Sub |fffd||7b5||fffd||fffd||fffd||f9||fffd||135||fffd||fffd||fffd|_|fffd||fffd||fffd||7b5||fffd||fffd||f6||fffd||fffd||17c||fffd|aa()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 8) = Array("|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", _
"|fffd||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||3f6||fffd||fffd||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||17c||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||fffd| = i
End If
 
Next i
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
 
For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(5|fffd||fffd|).xlsx"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
       'Set wksht = Worksheets.Add(after:=Sheets(Sheets.Count))
'Sheets(1).Activate
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   
Cells(C.Row - 720, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "180" Then
   |fffd||fffd||fffd||23d||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
  Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(5000).Clear
  
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   Next i
   
   For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i - 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
   r = 0
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) <> "" Or Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
    
   Erase varTemp
   
    
 
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| 180|fffd||43a||fffd||fffd||fffd||fffd||fffd| 20% |fffd||33b||fffd| |fffd||fffd||fffd||333||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
   
   
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then
   
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) = Application.Min(Cells(i - 20, |fffd||3f6||fffd||fffd||135||fffd|).Resize(20))
 
   
 
   For ii = 0 To 100
   If Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) <> "" And Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) < ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|).Resize(, 2) = Cells(i + ii, 1).Resize(, 2).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Application.Max(Cells(i - 20, |fffd||fffd||fffd||fffd||135||fffd|).Resize(20))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd|).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd|) * (1 + (ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|)))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd|) = (Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|).Resize(10)) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|)) - 1.0033
   ThisWorkbook.Sheets("test").Cells(a, |fffd||3f6||fffd||fffd||fffd|) = (Application.Min(Cells(i + ii, |fffd||fffd||fffd||fffd|).Resize(10)) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|)) - 1.0033
   Exit For
   End If
   
      
   Next ii
   
   Exit For
   End If
   
   Next i
   
   
 
   
End If
 
Workbooks(fileName).Close False
 
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
Columns(|fffd||17c||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||fffd||fffd||377||fffd|) = "" Then
Rows(i).Clear
End If
Next i
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||fffd|) Then
If Cells(i, |fffd||17c||fffd||fffd||f0||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||f0||fffd|) Then
If Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i - 1, |fffd||fffd||fffd||377||fffd|) Then
Rows(i).Clear
End If
End If
End If
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
 
 
   End Sub




Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||5bd||170||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|()
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
 
For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(|fffd||fffd|).csv"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    
    
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|

If Cells(C.Row, 5) / Cells(C.Row - 1, 5) > 1.29 Then

r = 2

For i = C.Row + 2 To C.Row + 121
r = r + 1
ThisWorkbook.Sheets("test").Cells(a, r) = Cells(i, 5) / Cells(C.Row + 1, 5) - 1.0033
Next i

Else

r = 2

For i = C.Row + 1 To C.Row + 120
r = r + 1
ThisWorkbook.Sheets("test").Cells(a, r) = Cells(i, 5) / Cells(C.Row, 5) - 1.0033
Next i

End If


End If

 
 
Workbooks(fileName).Close False
 
 
    
Next a
 
 
 
   End Sub


Sub |fffd||fffd||fffd||377||fffd|()

Application.ScreenUpdating = False
On Error Resume Next

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, 2) <> Cells(i - 1, 2) Then
Rows(i).Insert
End If
Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) = "" Then
Rows(i).Clear
End If
Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

r = r + 1

If Cells(i, 1) = "" Then

For ii = 3 To 150
Cells(i, ii) = Application.Average(Cells(i - r + 1, ii).Resize(r - 1))
If Cells(i, ii) > 0.1 Then
Cells(i, 2) = Cells(i, ii)
Exit For
End If


Cells(i, ii) = Application.Average(Cells(i - r + 1, ii).Resize(r - 1))
If Cells(i, ii) < -0.1 Then
Cells(i, 2) = Cells(i, ii)
Exit For
End If


Next ii

r = 0

If Cells(i, 2) = "" Then
Cells(i, 2) = Cells(i, ii - 1)
End If

End If

Next i





End Sub



Sub |fffd||fffd||fffd||fffd||331||fffd|_|fffd||3fa||fffd||fffd||fffd||fffd||fffd|()

Dim varTemp()

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||fffd||fffd||fffd|2").Activate
Sheets("test").UsedRange.Clear
Sheets("test").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value


For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd|" Then
|fffd||431||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||b7||fffd|" Then
|fffd||fffd||fffd||fffd||b7||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||b7||fffd|1" Then
|fffd||431||fffd||fffd||b7||fffd|1 = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||b7||fffd|2" Then
|fffd||431||fffd||fffd||b7||fffd|2 = i
End If

Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 2) = "|fffd||fffd||fffd||fffd||fffd|" Or Cells(i, 2) = "EPS(|fffd||fffd|)" Then
Cells(i, |fffd||fffd||fffd||fffd||b7||fffd|) = Cells(i, |fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd| - 1)
Cells(i, |fffd||431||fffd||fffd||b7||fffd|1) = Cells(i, |fffd||431||fffd| - 1) / Cells(i, |fffd||431||fffd| - 5)
Cells(i, |fffd||431||fffd||fffd||b7||fffd|2) = Cells(i, |fffd||431||fffd|) / Cells(i, |fffd||431||fffd| - 4)

If Cells(i, |fffd||fffd||fffd||fffd||b7||fffd|) > 1.1 Then
If Cells(i, |fffd||431||fffd||fffd||b7||fffd|1) > 1.1 Then

Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
End If
End If


End If


Next i


Sheets("test").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) = Cells(i + 1, 1) Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(2, 100)
End If

Next i

ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(Rows.Count, 1).End(3)(2).Resize(2, 100) = varTemp(i)
Next i

r = 0
Erase varTemp


End Sub

Sub |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||5b4||be||fffd||fffd||fffd||331||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 
ThisWorkbook.Sheets("test").UsedRange.Clear
 
 
   Do While fileName <> ""
   
   Workbooks.Open (strPath & fileName)
      
 
 
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "180" Then
   |fffd||fffd||fffd||23d||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||731||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
   |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
   |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
   |fffd||177||fffd||fffd||fffd||fffd| = i
   End If
   
 
   Next i
   
   
  
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 50, 3).Resize(50)) < Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
 
   Next i
   
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   If Application.CountA(Cells(i - 10, |fffd||fffd||fffd||fffd|).Resize(10)) = 0 Then
   
   For ii = 0 To 40
   If Cells(i - ii, 7) > 0 Then
   r = r + 1
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) + Cells(i - ii, 7)
   End If
   Next ii
   
   If (Cells(i, |fffd||fffd||fffd||fffd|) / r) * 1.2 < (Cells(i, 5) / Cells(i, 2) - 1) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = (Cells(i, |fffd||fffd||fffd||fffd|) / r)
   Cells(i, |fffd||fffd||fffd||fffd| + 1) = (Cells(i, 5) / Cells(i, 2) - 1)
   ThisWorkbook.Sheets("test").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
   ThisWorkbook.Sheets("test").Cells(Rows.Count, 2).End(3) = Split(fileName, "(")(0)
   End If
   
   r = 0
   
   
   End If
   End If
   
   Next i
     
 
   
 
   
Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
 
 
 
 
   End Sub


  Sub |fffd||7b5||fffd||fffd||fffd||f9||fffd||135||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||531||fffd|()
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
Dim |fffd||fffd||fffd||377||fffd| As Long
 
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
Sheets("test").Activate 'test activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", lookat:=xlWhole) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| |e3||fffd||fffd|
If C = "" Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 7) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", "|fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||f0||fffd|", "|fffd||fffd||fffd||377||fffd|")
End If
 
 '-------- head no. |fffd||171||fffd||fffd| -------
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd||fffd||270||fffd|" Then
|fffd||17c||fffd||fffd||fffd||fffd||270||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||f0||fffd|" Then
|fffd||17c||fffd||fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then '
|fffd||fffd||fffd||377||fffd| = i
End If
 
 
Next i
 
 
Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|).Resize(5000, 100).Clear
 
 
For a = 2 To Cells(Rows.Count, 1).End(3).Row 'test |fffd||fffd||1ae||fffd||fffd||fffd||fffd| rows |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||63c||fffd| for next |fffd||fffd||fffd||fffd||fffd||fffd|
 
fileName = Cells(a, 2).Value & "(15|fffd||fffd|).xlsx"   '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    Workbooks.Open (strPath & fileName) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 If ActiveSheet.Name <> "test" Then
    
    ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(a, 1), lookat:=xlWhole) 'sheet|fffd||fffd||fffd||fffd| test sheet|fffd||fffd| |fffd||634||fffd| |fffd||fffd||a5| |e3||fffd||1bc||fffd|
   
Cells(C.Row - 800, 1).Resize(5000, 100).Copy Sheets(2).Cells(2, 1)  'sheet2|fffd||fffd| 10|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10|fffd||fffd||fffd||131||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   
   
   'sheet2|fffd||fffd||fffd||fffd| head |fffd||5b0||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f0||fffd|
Sheets(2).Activate
Cells(1, 1).Resize(, 100) = Sheets(1).Cells(1, 1).Resize(, 100).Value 'sheet1 head|fffd||fffd| sheet2|fffd||fffd| |fffd||fffd||fffd||fffd|
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
  
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "180" Then
   |fffd||fffd||fffd||23d||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
 
   Next i
 
  Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(5000).Clear
  
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 12, 4).Resize(25)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
      
   If Application.Min(Cells(i - 12, 5).Resize(25)) = Cells(i, 5) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 5)
   End If
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Or Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
   
  
   Erase varTemp
   
   '|fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i + 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i + 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
   Next i
   
   For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) >= Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i - 1, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   End If
   
         
   Next i
   
   
   
   '|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" Then
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
   End If
         
   Next i
   
   r = 0
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||634||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) <> "" Or Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   r = r + 1
   ReDim Preserve varTemp(1 To r)
   varTemp(r) = Cells(i, 1).Resize(, 100)
   End If
   
   Next i
   r = 0
   
   ActiveSheet.UsedRange.Offset(1).Clear
   
   For i = 1 To UBound(varTemp, 1)
   Cells(i + 1, 1).Resize(, 100) = varTemp(i)
   Next i
    
   Erase varTemp
   
    
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| 180|fffd||43a||fffd||fffd||fffd||fffd||fffd| 20% |fffd||33b||fffd| |fffd||fffd||fffd||333||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
   For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, 1) > ThisWorkbook.Sheets("test").Cells(a, 1) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) = Application.Max(Cells(i - 20, |fffd||fffd||fffd||fffd||135||fffd|).Resize(20))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) = Application.Min(Cells(i - 20, |fffd||3f6||fffd||fffd||135||fffd|).Resize(20))
 
   For ii = 0 To 1000
   If Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) <> "" Then
   If ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) > Cells(i + ii, |fffd||3f6||fffd||fffd||135||fffd|) Then
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd|) = Cells(i + ii - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||f0||fffd|) = Cells(i + ii - 1, 1).Value
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd|) * (1 + ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|))
   ThisWorkbook.Sheets("test").Cells(a, |fffd||fffd||fffd||377||fffd|) = (Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|).Resize(10)) / ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||270||fffd|)) - 1.0033
   ThisWorkbook.Sheets("test").Cells(a, |fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Max(Cells(i + ii + 1, |fffd||fffd||fffd||fffd|))
   Exit For
   End If
   End If
   Next ii
   
   
   Exit For
   End If
 
   Next i
   
   
 
   
End If
'Workbooks(fileName).Close False
 
 
 
    
Next a
 
ThisWorkbook.Sheets("test").Activate
Columns(|fffd||17c||fffd||fffd||f0||fffd|).NumberFormatLocal = "hh:mm:ss"
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||fffd||fffd||377||fffd|) = "" Then
Rows(i).Clear
End If
Next i
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||fffd|) Then
If Cells(i, |fffd||17c||fffd||fffd||f0||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||f0||fffd|) Then
If Cells(i, |fffd||fffd||fffd||377||fffd|) = Cells(i - 1, |fffd||fffd||fffd||377||fffd|) Then
Rows(i).Clear
End If
End If
End If
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||17c||fffd||fffd||f0||fffd|), key3:=Cells(1, |fffd||fffd||fffd||377||fffd|)
 
 
 
   End Sub


Sub |fffd||fffd||1ae||fffd||43c||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim var()
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long

 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
  .Show
 
   strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"

    strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").UsedRange.Clear
  
   Workbooks.Open (strPath & fileName)
   ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
   
   Workbooks(fileName).Close False
   
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 47) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|", _
"15|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "15|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "30|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "30|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "45|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "45|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "60|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "60|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "75|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "75|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "90|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "90|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", _
"|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "2016-01-04") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
   
Cells(1, Columns.Count).End(1).NumberFormatLocal = "yyyy-mm-dd"
 

 
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

   
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "[|fffd||731||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "[|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If


If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd| = i
End If

If Cells(1, i) = "15|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" Then
|fffd||2bf||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "15|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|" Then
|fffd||2bf||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "30|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "30|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "45|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||2bf||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "45|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|" Then
|fffd||fffd||2bf||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "60|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "60|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd| = i
End If


If Cells(1, i) = "75|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" Then
|125||fffd||2bf||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "75|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|" Then
|125||fffd||2bf||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "90|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "90|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd| = i
End If
   
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
   
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If


   Next i
   
   
   
   
   Do While fileName <> ""
   
  Workbooks.Open (strPath & fileName)
  
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 47) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|", _
"15|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "15|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "30|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "30|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "45|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "45|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "60|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "60|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "75|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "75|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "90|fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", "90|fffd||fffd||fffd||13c||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", _
"|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "2016-01-04") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
   

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
 
   '20106.01.04|fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
   Set C = Columns(1).Find(ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(1, Columns.Count).End(1), lookat:=xlWhole)
 
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = C.Row - 10 To Cells(Rows.Count, 1).End(3).Row
   'For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   End If
   
   
   If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   
   Else
   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
   
   End If
   
   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Offset(-20).Resize(21))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Offset(-3).Resize(4))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   
   
   Next i
   
   
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||13e||fffd|
   
  For i = C.Row To Cells(Rows.Count, 1).End(3).Row
   
   'For i = 2 To Cells(Rows.Count, 1).End(3).Row
   If Application.Min(Cells(i - 7, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(8)) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   End If
   
   
   If Application.Max(Cells(i - 7, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(8)) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
   End If
       
       
      
   Next i
   

         
   '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||43c||fffd|
  
   
  For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 '     For i = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
 
   
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||3f6||fffd||fffd||135||fffd|).Offset(-120).Resize(120))
   Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|)

   
       
   If Application.CountA(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
   .Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row - _
   Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row)) > 5 Then

   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd|) = Application.Max(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
   .Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row))

   Else
   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd|) = Application.Max(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
   .Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).End(3).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).End(3).End(3).Row))
   
   End If
   
     
   If Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(15)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 > 0.1533 Then
   Cells(i, |fffd||2bf||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|) = 0.15
   End If
   
   Cells(i, |fffd||2bf||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd|) = Cells(i + 15, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   
   If Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(30)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 > 0.1533 Then
   Cells(i, |fffd||fffd||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|) = 0.15
   End If

   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd|) = Cells(i + 30, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   
   If Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(45)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 > 0.1533 Then
   Cells(i, |fffd||fffd||2bf||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|) = 0.15
   End If
   
   Cells(i, |fffd||fffd||2bf||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd|) = Cells(i + 45, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1

   If Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(60)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 > 0.1533 Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|) = 0.15
   End If

   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd|) = Cells(i + 60, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   
   If Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(75)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 > 0.1533 Then
   Cells(i, |125||fffd||2bf||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|) = 0.15
   End If
   
   Cells(i, |125||fffd||2bf||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd|) = Cells(i + 75, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   
   If Application.Max(Cells(i + 1, |fffd||fffd||fffd||fffd|).Resize(90)) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 > 0.1533 Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||3f3||fffd||fffd||5b0||fffd||fffd||fffd||fffd|) = 0.15
   End If
   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||377||fffd|) = Cells(i + 90, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   
     
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||177||fffd||fffd||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|)
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|)
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|)
   
   'Cells(i, |fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||177||fffd||fffd||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1))
   'Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|)
   'Cells(i, |fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|)
   'Cells(i, |fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||130||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||130||177||fffd||fffd||fffd||fffd||570||fffd|)

   
   End If
   
   



   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
  ' |fffd||fffd||fffd||fffd||fffd||fffd| = 0
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0
   '|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0
   
   'For ii = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row To Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
  ' |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd| + 1
   
  ' If Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) > 0 Then
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1
  ' End If
   
   'If Cells(ii, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|) > 0 Then
  ' |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| + 1
   'End If
   
  ' Next ii
   
  ' Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   
   'End If
   
   
  ' If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|) <> "" And Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
   
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   'Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|)
   
   'End If
   
   
   
  ' |fffd||fffd||fffd||fffd||fffd||fffd| = 0
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0
  ' |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0
   
  ' For ii = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row To Cells(i, |fffd||fffd||fffd||fffd|).Row
   '|fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd| + 1
   
  ' If Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) > 0 Then
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1
   'End If
   
   'If Cells(ii, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|) > 0 Then
  ' |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| + 1
  ' End If
   
  ' Next ii
   
  
  ' Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   'Cells(i, |fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
    
    
  ' If Cells(i - 1, |fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
  ' Cells(i, |fffd||fffd||fffd||fffd|).Resize(, 100).Clear
   'End If
   
   

   
   
   Next i
   
    
   
   
   
   
   
   For i = C.Row To Cells(Rows.Count, 1).End(3).Row
  ' For i = 2 To Cells(Rows.Count, 1).End(3).Row
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.7 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0.1 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   'If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 300 Then
   If Cells(i, |fffd||135||fffd||fffd||fffd|) > 0.6 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   
   
   ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
   ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 2).End(3) = fileName
   ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Offset(, |fffd||fffd||fffd||fffd| - 1) = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Value
   
   
   End If
   'End If
   'End If
   'End If
   'End If
   'End If
   'End If
   'End If
   
      Next i
 
   
' End If
 
   
'Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
 ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
 
Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")

For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
Next i



Range(Cells(Rows.Count, 1).End(3)(2), Cells(Cells(Rows.Count, 1).Row, Cells(1, Columns.Count).Column)).Delete '|fffd||fffd||12d||fffd||fffd| delete|fffd||3f1||fffd| |fffd||fffd||fffd||fffd| |fffd||6f0||fffd||fffd||3f1||fffd|
 
 
 '|fffd||fffd||fffd||fffd| |fffd||338||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||3f1||fffd|
 For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
 Cells(i, 2) = Split(Cells(i, 2), "(")(0)
 
 Next i


'60%, 130%|fffd||3f6||fffd||fffd||fffd| |fffd||17c||fffd|
r = 0
rr = 0


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||a5|), key3:=Cells(1, |fffd||fffd||fffd||fffd|)



For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i - 1, |fffd||fffd||fffd||fffd|) <> Cells(i, |fffd||fffd||fffd||fffd|) Then

For ii = 0 To 100000

If Cells(i + ii, |fffd||135||fffd||fffd||fffd|) > 0.6 Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i + ii, 1).Resize(, 100)

Exit For

End If

If Cells(i + ii, |fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd|) Then
Exit For
End If

Next ii

For ii = 0 To 100000

If Cells(i + ii, |fffd||135||fffd||fffd||fffd|) > 1 Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i + ii, 1).Resize(, 100)

Exit For

End If

If Cells(i + ii, |fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd|) Then
Exit For
End If

Next ii



End If


Next i



ActiveSheet.UsedRange.Offset(1).Clear


For i = 1 To UBound(varTemp, 1)
Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = varTemp(i)
Next i


For i = 1 To UBound(var, 1)
Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = var(i)
Next i


r = 0
rr = 0

Erase varTemp
Erase var



ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||a5|), key2:=Cells(1, |fffd||fffd||fffd||fffd|)


For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then
If Cells(i, 3) = Cells(i - 1, 3) Then

Rows(i).Clear

End If
End If
End If

Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||a5|), key2:=Cells(1, |fffd||fffd||fffd||fffd|)


 
   End Sub
   


Sub |fffd||fffd||fffd||7b8||178||fffd|()



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

  .Show


 strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    End With

    fileName = Dir(strPath & "*csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|



    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


  End If

On Error Resume Next

ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").UsedRange.Clear

   Workbooks.Open (strPath & fileName)
ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(fileName).Close False

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")


For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|


If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
|fffd||175||fffd||fc||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
|fffd||17c||fffd||fc||fffd||fffd| = i
End If

If Cells(1, i) = "|fc||fffd||1dee|" Then
|fc||fffd||1dee| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||47c||fffd||fffd||17c||fffd|" Then
|fffd||47c||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|" Then
|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then
|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If


Next i



Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate


For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(1, i) = "|1a2||fffd||b3||fffd||fffd||fffd||fffd|" Then
|1a2||fffd||b3||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If



Next i


For a = 2 To Cells(Rows.Count, 1).End(3).Row

Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

If Cells(a, 1) = Cells(1, Columns.Count).End(1) Then
'If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|) > 0.05 Then
'If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) > 0.03 Then
'If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= 0.8 Then
If Cells(a, |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) >= 0.9 Then
'If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 0.1 Then
If Cells(a, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 0.1 Then
fileName = Cells(a, 2) & ".csv"



  Workbooks.Open (strPath & fileName)
  
 If ActiveSheet.Name <> "|fffd||fffd||1ae||fffd||43c||fffd|" Then
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 9) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|")


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending



For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)

Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd|).Resize(, 2)) * Cells(i, |fc||fffd||1dee|)
Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) - Cells(i + 1, |fffd||47c||fffd||fffd||17c||fffd|)
Cells(i, |fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee|)

If Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) >= 0 Then
Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|)
Else
Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) * -1
End If

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|).Resize(1000))
Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|)

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||fffd||fffd|) = fileName
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))
Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending

For i = 6 To 11
'If Cells(i, |fffd||fffd||fffd||fffd||fffd|) >= 1 Then
If Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 1 Then
If Cells(i + 1, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) < 1 And Cells(i + 1, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > -1 Then
If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 100000000 Then
'If Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 1 Then
'If Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) < 1.5 Then

Cells(i, 1).Resize(100, 100).Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(Rows.Count, 1).End(3)(2)
Exit For
End If
End If
End If
'End If
'End If

Next i

End If


Workbooks(fileName).Close False
End If
End If
End If
'End If
'End If
'End If

Next a

Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 3) <> Cells(i - 1, 3) Then

For ii = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i + ii, 3) <> Cells(i + ii - 1, 3) Or Cells(i + ii, 3) = "" Then
Cells(i + 1, |fffd||fffd||fffd||377||fffd|) = Cells(i + ii - 1, |fffd||fffd||fffd||fffd||fffd|) - Cells(i + 1, |fffd||fffd||fffd||fffd||fffd|) - 0.33
Exit For
End If

If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd|) > Cells(i + 1, |fffd||fffd||fffd||fffd||fffd|) + 2.33 Then
Cells(i + 1, |fffd||fffd||fffd||377||fffd|) = 2
Exit For
End If

If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd|) < Cells(i + 1, |fffd||fffd||fffd||fffd||fffd|) - 1.67 Then
Cells(i + 1, |fffd||fffd||fffd||377||fffd|) = -2
Exit For
End If

Next ii

End If

Next i

Cells(Rows.Count, 1).End(3)(2) = Application.Average(Columns(|fffd||fffd||fffd||377||fffd|))
Cells(Rows.Count, 1).End(3).Select


   End Sub



Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||339||7be||4b4||fffd||fffd||fffd||22e||fffd||fffd||fffd||3f1||fffd|()




Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long




    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

  .Show


 strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    End With

    fileName = Dir(strPath & "*csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|



    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


  End If

On Error Resume Next

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
ThisWorkbook.Sheets("|fffd||4fd||fffd|").UsedRange.Clear



   Do While fileName <> ""

  Workbooks.Open (strPath & fileName)

If Cells(Rows.Count, 1).End(3).Row < 78 Then
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2) = fileName
End If


Workbooks(fileName).Close False



fileName = Dir



Loop


   End Sub

Sub |fffd||fffd||fffd||7b8||178||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f7||3b5||fffd||fffd||fffd||fffd||fffd|()



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long



'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||f6||fffd| |fffd||fffd||fffd||fffd||333||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'10|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd| OR |fffd||5f8||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f6||fffd| |fffd||fffd||fffd|
'20|fffd||3f0||fffd| |fffd||3f7||fffd||fffd||3f7||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3ff||fffd| |fffd||175||fffd| |fffd||fffd||fffd||fffd| |fffd||13e||fffd||fffd||474||fffd|
'|fffd||1f4||fffd| |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3ff||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||175||fffd| |fffd||474||fffd|
'|fffd||fffd||fffd||fffd| |fffd||177||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3ff||fffd| |fffd||fffd||fffd|


'===|fffd||fffd||fffd||3b1||5f7||fffd| |a5||fffd||fffd| |fffd||fffd||fffd||fffd|===

'|fffd||4fd||fffd|2|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
'|fffd||fffd||fc||fffd||5b0||fffd||fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||1ff||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||7b8||178||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||330||fffd|
'5|fffd||43a||fffd| |fffd||fffd||fffd||3ff||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 9|fffd||fffd|~10|fffd||fffd| |fffd||fffd||fffd||33f||fffd| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||177||fffd||fffd||fffd||fffd||fffd| |fffd||330||fffd|
'5|fffd||43a||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd| |fffd||177||fffd||fffd||fffd||fffd||fffd| 1.5|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||f6||fffd| |fffd||17c||fffd|




'|fffd||fffd||fffd||7b8||178||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|


Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next
      
      
With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
.Show

strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

End With

    'fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||4fd||fffd|2|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|

ThisWorkbook.Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending

'|fffd||fffd||fffd||7b8||178||17d||fffd||1ae||fffd||fffd| head |fffd||5b0||fffd| head |fffd||338||fffd| |fffd||fffd||fffd||fffd| |fffd||5b1||fffd|

ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate
ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").UsedRange.Clear



'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||4fd||fd||fffd||1ae||fffd||fffd| head |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i


ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlAscending


With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")


For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & ".xlsx"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If

End If

Next a

End With



ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate


Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 11) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")


For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
|fffd||175||fffd||fc||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
|fffd||17c||fffd||fc||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fc||fffd||1dee|" Then
|fc||fffd||1dee| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||47c||fffd||fffd||17c||fffd|" Then
|fffd||47c||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|" Then
|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then
|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If


Next i




'|fffd||fffd||fffd||fffd||fffd||338||fffd||fffd||fffd| |fffd||678||fffd||fffd||678||fffd| |fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For a = 2 To ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3).Row

If ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(a - 1, 2) <> ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(a, 2) Then

fileName = ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(a, 2) & ".xlsx"

If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then


Workbooks.Open (strPath & fileName)
  

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 11) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlDescending

Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = fileName


For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd|)
Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd|).Resize(, 2)) * Cells(i, |fc||fffd||1dee|)

If Cells(i, 4) = Cells(i + 1, 4) Then
Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) - Cells(i + 1, |fffd||47c||fffd||fffd||17c||fffd|)
Else
Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|)
End If

Cells(i, |fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee|)

If Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) >= 0 Then
Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|)
Else
Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) * -1
End If

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

For Aa = 0 To 100
If Cells(i + Aa, 4) <> Cells(i + Aa + 1, 4) Then
Exit For
End If
Next Aa


Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|).Resize(Cells(i + Aa + 1, 4).Row - Cells(i, 4).Row))
Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|)

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

For Aa = 0 To 100
If Cells(i + Aa, 4) <> Cells(i + Aa + 1, 4) Then
Exit For
End If
Next Aa

If Aa > 7 Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))
Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))

Else

Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(Aa + 1))
Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(Aa + 1))

End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlAscending



'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

With ThisWorkbook.Sheets("|fffd||4fd||fffd|")
For u = 0 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a + u, 2) Then
Exit For
End If


Set C = Columns(|fffd||fffd||a5|).Find(.Cells(a + u, 1), lookat:=xlWhole)

If Not C Is Nothing Then

For i = 81 To 85
If Cells(C.Row + i, |fffd||177||fffd||fffd||fffd|) > Cells(C.Row + i - 77, |fffd||177||fffd||fffd||fffd|) * 1.5 Then
If Cells(C.Row + i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 1 Then
If Cells(C.Row + i + 1, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) < 1 And Cells(C.Row + i + 1, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > -1 Then
If Cells(C.Row + i, |fffd||177||fffd||fffd||fffd||fffd|) > 500000000 Then
'if Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 1 Then
'If Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) < 1.5 Then

Cells(C.Row + i, 1).Resize(77 - (i - 77), 100).Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(Rows.Count, 1).End(3)(2)
Exit For
End If
End If
End If
End If
'End If

Next i

'If Cells(C.Row + 152, |fffd||fffd||fffd||fffd||fffd|) >= 2 Then
'If Cells(C.Row + 152, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 0.3 Then
'If Cells(C.Row + 152, |fffd||177||fffd||fffd||fffd||fffd|) > 100000000 Then

'Cells(C.Row + 153, 1).Resize(77, 100).Copy ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Cells(Rows.Count, 1).End(3)(2)
'
'End If
'End If
'End If


End If

Set C = Nothing





Next u

End With




Workbooks(fileName).Close False

End If
End If


Next a



ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) < Cells(i - 1, 1) Then

For ii = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i + ii, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.02 Then
Cells(i + 1, |fffd||fffd||fffd||377||fffd|) = 0.02
Exit For
End If

If Cells(i + ii, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.02 Then
Cells(i + 1, |fffd||fffd||fffd||377||fffd|) = -0.02
Exit For
End If

If Cells(i + ii, 1) > Cells(i + ii + 1, 1) Or Cells(i + ii, 1) = "" Then
Cells(i + 1, |fffd||fffd||fffd||377||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||fffd||fffd||fffd|) - 1.0033
Exit For
End If


Next ii

End If

Next i

Cells(Rows.Count, 1).End(3)(2) = Application.Average(Columns(|fffd||fffd||fffd||377||fffd|))
Cells(Rows.Count, 1).End(3).Select


   End Sub

Sub |fffd||fffd||fffd||7b8||178||fffd|_|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||7f87c||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|()

 



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long

 

 

 

 

'|fffd||fffd||fffd||7b8||178||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

 

 

    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|

     ' With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

 

  '.Show

 

 

'strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'
strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\|223||fffd||fffd||e2|\"

'    End With

 

   

On Error Resume Next

 

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
ThisWorkbook.Sheets("|fffd||4fd||fffd|").UsedRange.Clear

 
 
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 2), key2:=Cells(2, 1)

 
With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")
 

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
newName = .Cells(a, 2) & ".xlsx"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If
End If

Next a

 

End With

 
 
 
 
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 11) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")



For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|


If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then

|fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||a5|" Then

|fffd||fffd||a5| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then

|fffd||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then

|fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd|" Then

|fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then

|fffd||175||fffd||fc||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then

|fffd||17c||fffd||fc||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then

|fffd||177||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fc||fffd||1dee|" Then

|fc||fffd||1dee| = i

End If

 

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd|" Then

|fffd||177||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||47c||fffd||fffd||17c||fffd|" Then

|fffd||47c||fffd||fffd||17c||fffd| = i

End If

 

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then

|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|" Then

|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd| = i

End If

 

If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then

|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|" Then

|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|" Then

|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then

|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then

|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then

|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i

End If

 

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then

|fffd||fffd||fffd||377||fffd| = i

End If

 

 

Next i

 

 

'|fffd||fffd||1ae||fffd||43c||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|,|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd| head |fffd||fffd||fffd||fffd| |fffd||5b1||fffd|

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

 

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 2), key2:=Cells(2, 1), order1:=xlAscending, order2:=xlAscending

For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If


 

Next i
 

Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "hh:mm:ss"

 

'|fffd||fffd||fffd||fffd||fffd||338||fffd||fffd||fffd| |fffd||678||fffd||fffd||678||fffd| |fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

 

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")
For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a - 1, 2) <> .Cells(a, 2) Then

fileName = .Cells(a, 2) & ".xlsx"

If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then


Workbooks.Open (strPath & fileName)

  

 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 11) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")

 

 

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlDescending

 

Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = fileName

 

 

For i = 2 To Cells(Rows.Count, 1).End(3).Row

 

Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)

Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd|)

Next i

 

 

 

For i = 2 To Cells(Rows.Count, 1).End(3).Row

 

Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd|).Resize(, 2)) * Cells(i, |fc||fffd||1dee|)

 

If Cells(i, 4) = Cells(i + 1, 4) Then

Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) - Cells(i + 1, |fffd||47c||fffd||fffd||17c||fffd|)

Else

Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|)

End If

 

Cells(i, |fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee|)

 

If Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) >= 0 Then

Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|)

Else

Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) * -1

End If

 

Next i

 

 

For i = 2 To Cells(Rows.Count, 1).End(3).Row

 

For Aa = 0 To 100

If Cells(i + Aa, 4) <> Cells(i + Aa + 1, 4) Then

Exit For

End If

Next Aa

 

 

Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|).Resize(Cells(i + Aa + 1, 4).Row - Cells(i, 4).Row))

Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|)

 

Next i

 

 

For i = 2 To Cells(Rows.Count, 1).End(3).Row

 

For Aa = 0 To 100

If Cells(i + Aa, 4) <> Cells(i + Aa + 1, 4) Then

Exit For

End If

Next Aa

 

If Aa > 7 Then

Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))

Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))

 

Else

 

Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(Aa + 1))

Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(Aa + 1))

 

End If

 

Next i

 

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlAscending

 

 

 

'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

 

 

For u = 0 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a + u, 2) Then
Exit For
End If

Set C = Columns(|fffd||fffd||a5|).Find(.Cells(a + u, 1), lookat:=xlWhole)

If Not C Is Nothing Then

For i = 1 To 1000

If Cells(C.Row + i, |fffd||fffd||a5|) > .Cells(a + u, 1) Then
If Cells(C.Row + i - 1, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 1 And Cells(C.Row + i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) < 1 Then
.Cells(a + u, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(C.Row + i, |fffd||fffd||a5|).Value
.Cells(a + u, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(C.Row + i, 1).Value
.Cells(a + u, |fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd|) = Cells(C.Row + i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
Exit For
End If
End If

Next i

End If


Next u


Set C = Nothing

 
 
' == 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ==

'For u = 0 To .Cells(Rows.Count, 1).End(3).Row

'If .Cells(a, 2) <> .Cells(a + u, 2) Then
'Exit For
'End If

 

'If .Cells(a + u, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" Then
'Set C = Columns(|fffd||fffd||a5|).Find(.Cells(a + u, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)
'If Not C Is Nothing Then

'For i = 0 To 1000

'If Cells(C.Row + i, 1) = .Cells(a + u, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then
'.Cells(a + u, |fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd|) = Cells(C.Row + i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
'Exit For
'End If

'Next i

'End If
'End If

'If .Cells(a + u, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" Then
'Set C = Columns(|fffd||fffd||a5|).Find(.Cells(a + u, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)
'If Not C Is Nothing Then

'For i = 0 To 1000

'If Cells(C.Row + i, 1) = .Cells(a + u, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then
'.Cells(a + u, |fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd|) = Cells(C.Row + i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Value
'Exit For
'End If

'Next i

'End If
'End If



'Next u
 
 
 
 
 
 
 
 
Workbooks(fileName).Close False

 

End If
End If


 

Next a

 

 

End With

 
'Call |fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||fffd||fffd||13a||43a||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||3f1||fffd|


 

 

   End Sub

Sub |fffd||fffd||fffd||7b8||178||fffd|_|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||7f87c||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|2()



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long




'|fffd||fffd||fffd||7b8||178||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|


    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

  .Show


 strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    End With

    'fileName = Dir(strPath & "*.xlsx*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||4fd||fd||fffd||1ae||fffd||fffd| head |fffd||5b0||fffd| head |fffd||338||fffd| |fffd||fffd||fffd||fffd| |fffd||5b1||fffd|

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
ThisWorkbook.Sheets("|fffd||4fd||fffd|").UsedRange.Clear



ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
fileName = .Cells(a, 2) & ".csv"


If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & fileName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(fileName).Close False


ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 11) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")


For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fc||fffd||fffd|" Then
|fffd||175||fffd||fc||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fc||fffd||fffd|" Then
|fffd||17c||fffd||fc||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fc||fffd||1dee|" Then
|fc||fffd||1dee| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||47c||fffd||fffd||17c||fffd|" Then
|fffd||47c||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|" Then
|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then
|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If


Next i




'|fffd||fffd||1ae||fffd||43c||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|,|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd| head |fffd||fffd||fffd||fffd| |fffd||5b1||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 2), key2:=Cells(2, 1), order1:=xlAscending, order2:=xlAscending


For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd| = i
End If

Next i



'|fffd||fffd||fffd||fffd||fffd||338||fffd||fffd||fffd| |fffd||678||fffd||fffd||678||fffd| |fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")
For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a - 1, 2) <> .Cells(a, 2) Then

fileName = .Cells(a, 2) & ".xlsx"

If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then


Workbooks.Open (strPath & fileName)
  

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 11) = Array("|fffd||177||fffd||fffd||fffd||fffd|", "|fffd||47c||fffd||fffd||17c||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|", "|fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|" _
, "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|", "|fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|")


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlDescending

Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = fileName


For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||17c||fffd||fc||fffd||fffd|) - Cells(i, |fffd||175||fffd||fc||fffd||fffd|)
Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd|)
Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd|).Resize(, 2)) * Cells(i, |fc||fffd||1dee|)

If Cells(i, 4) = Cells(i + 1, 4) Then
Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|) - Cells(i + 1, |fffd||47c||fffd||fffd||17c||fffd|)
Else
Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) = Cells(i, |fffd||47c||fffd||fffd||17c||fffd|)
End If

Cells(i, |fc||fffd||1dee||fffd||fffd||fffd||fffd||fffd||17c||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fc||fffd||1dee|)

If Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) >= 0 Then
Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|)
Else
Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) * -1
End If

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

For Aa = 0 To 100
If Cells(i + Aa, 4) <> Cells(i + Aa + 1, 4) Then
Exit For
End If
Next Aa


Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||bc2a|).Resize(Cells(i + Aa + 1, 4).Row - Cells(i, 4).Row))
Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||43c||fffd||fffd||17c||fffd|) / Cells(i, |fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd||fffd|)

Next i


For i = 2 To Cells(Rows.Count, 1).End(3).Row

For Aa = 0 To 100
If Cells(i + Aa, 4) <> Cells(i + Aa + 1, 4) Then
Exit For
End If
Next Aa

If Aa > 7 Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))
Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(7))

Else

Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(Aa + 1))
Cells(i, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|).Resize(Aa + 1))

End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 4), key2:=Cells(1, 1), order1:=xlAscending, order2:=xlAscending



'|fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


For u = 0 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a + u, 2) Then
Exit For
End If


Set C = Columns(|fffd||fffd||a5|).Find(.Cells(a + u, 1), lookat:=xlWhole)

If Not C Is Nothing Then

For i = 1 To 1000

If Cells(C.Row + i, |fffd||fffd||a5|) <> Cells(C.Row + i - 1, |fffd||fffd||a5|) Then

For ii = 2 To 3

If Cells(C.Row + i + ii, |fffd||67c||fffd||fffd||fffd||fffd||fffd||57c||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 1 Then
If Cells(C.Row + i + ii + 1, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) < 1 And Cells(C.Row + i + ii + 1, |fffd||fffd||574||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > -1 Then
.Cells(a + u, |fffd||634||fffd||f0||fffd|) = Cells(C.Row + i + ii + 1, 1).Value
.Cells(a + u, |fffd||177||fffd||fffd||fffd||fffd|) = Application.Average(Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||fffd|).Resize(, 2)) * Cells(C.Row + i + ii + 1, |fffd||177||fffd||fffd||fffd|)


For iii = 1 To 100

If Cells(C.Row + i + ii + 1 + iii, |fffd||fffd||fffd||fffd|) / Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.02 Then
Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||377||fffd|) = 0.02
.Cells(a + u, |fffd||fffd||fffd||37c||57d||1f7||fffd|) = Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||377||fffd|).Value
Exit For
End If

If Cells(C.Row + i + ii + 1 + iii, |fffd||fffd||fffd||fffd|) / Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.02 Then
Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||377||fffd|) = -0.02
.Cells(a + u, |fffd||fffd||fffd||37c||57d||1f7||fffd|) = Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||377||fffd|).Value
Exit For
End If

If Cells(C.Row + i + ii + 1 + iii, 1) < Cells(C.Row + i + ii + 1, 1) Or Cells(C.Row + i + ii, 1) = "" Then
Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||377||fffd|) = Cells(C.Row + i + ii + iii, |fffd||fffd||fffd||fffd|) / Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||fffd|) - 1.0033
.Cells(a + u, |fffd||fffd||fffd||37c||57d||1f7||fffd|) = Cells(C.Row + i + ii + 1, |fffd||fffd||fffd||377||fffd|).Value
Exit For
End If

Next iii

Exit For

End If
End If

Next ii

Exit For
End If

Next i

End If

Next u

Set C = Nothing




'Workbooks(fileName).Close False

End If
End If


Next a


End With



   End Sub

Sub |fffd||fffd||2bf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||f8||17c||fffd|()

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|



Application.ScreenUpdating = False
On Error Resume Next



 
 
    With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
 
 
strPath = .SelectedItems(1) & "\"       '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
    End With
 
'fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 '   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 '       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
   
   
   


Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate


 
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|30|fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||2bb||fffd| = i
End If

If Cells(1, i) = "|fffd||7b5||fffd||fffd||fffd|" Then
|fffd||7b5||fffd||fffd||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd| = i
End If
   
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "<|fffd||fffd||fffd||fffd||fffd||335||fffd||fffd||fffd||fffd|>5" Then
|fffd||fffd||fffd||3fc||fffd| = i
End If
  
If Cells(1, i) = "10" Then
|fffd||fffd||fffd||3fc||fffd| = i
End If
 
If Cells(1, i) = "20" Then
|fffd||33d||fffd||fffd||3fc||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||731||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If
 
Next i
 
 

'|fffd||7b6||fffd||fffd||fffd| |fffd||fffd||fffd||1ff||fffd| |fffd||b4||fffd| |fffd||fffd||fffd||fffd| |fffd||331||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd||fffd|) < 0 And Cells(i, |fffd||fffd||fffd||fffd||fffd|) > -0.27 Then
If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < -0.2 And Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|) < 11 Then
If Cells(i, |fffd||135||fffd||fffd||fffd|) > 1 And Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.1 Then
If Cells(i, |fffd||fffd||fffd||fffd|) > 1000 And Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|) > 1 Then
If Right(Cells(i, |fffd||fffd||fffd|), 1) <> "|fffd||fffd|" Then

r = r + 1

ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)

End If
End If
End If
End If
End If

Next i

r = 0
'|fffd||fffd||fffd||7b8||178||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

'|fffd||6b7||fffd| |fffd||fffd||fffd||fffd||fffd|
ActiveSheet.UsedRange.Delete

'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
Cells(1, 1).Resize(, 100) = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(1, 1).Resize(, 100).Value

'|fffd||fffd||fffd||fffd| |fffd||478||fffd||fffd||fffd|
For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 100) = varTemp(i)
Next i


'|fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|),|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlAscending



'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d|

With ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, |fffd||fffd||fffd|) <> .Cells(a - 1, |fffd||fffd||fffd|) Then
 
newName = .Cells(a, |fffd||fffd||fffd|) & "(|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)

'|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending



t = 0.25

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||7f87c||fffd| for next|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1f2d| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For Aa = 0 To 300
 
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3fa||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||43a||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||678||fffd| |fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||a5||fffd||fffd| |e3||fffd||fffd|
Set CC = Columns(1).Find(.Cells(a + Aa, |fffd||fffd||a5|), lookat:=xlWhole)

'|fffd||fffd||fffd||fffd| |fffd||5b4||678||fffd|
If Not CC Is Nothing Then

For i = 1 To 70
If Cells(CC.Row - i, |fffd||f0||fffd|) = Cells(CC.Row - i, |fffd||fffd||fffd||fffd|) Then
If Cells(CC.Row - i, |fffd||fffd||fffd||fffd|) = Cells(CC.Row - i, |fffd||fffd||fffd||fffd|) Then
If Cells(CC.Row - i, |fffd||fffd||fffd||fffd|) = Cells(CC.Row - i, |fffd||fffd||fffd||fffd|) Then
r = r + 1
End If
End If
End If
Next i

If r > 5 Then
.Cells(a + Aa, |fffd||fffd||fffd||377||fffd| - 1) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|"
End If

r = 0


'|fffd||43a||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||3fa||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |169||fffd||fffd| |fffd||1f4||fffd| |fffd||fffd||a5||fffd||fffd| |e3||fffd||fffd|
For i = CC.Row + 1 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||fffd||fffd|) / Cells(CC.Row, |fffd||fffd||fffd||fffd|) - 1.0033 <= -t Then
.Cells(a + Aa, |fffd||fffd||fffd||377||fffd|) = -t
.Cells(a + Aa, |fffd||175||fffd||fffd||fffd|) = i - CC.Row
Exit For
End If

If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||fffd||fffd|) / Cells(CC.Row, |fffd||fffd||fffd||fffd|) - 1.0033 > t Then
.Cells(a + Aa, |fffd||fffd||fffd||377||fffd|) = t
.Cells(a + Aa, |fffd||175||fffd||fffd||fffd|) = i - CC.Row
Exit For
End If

Next i

End If

Set CC = Nothing

If .Cells(a + Aa, |fffd||fffd||fffd|) <> .Cells(a + Aa + 1, |fffd||fffd||fffd|) Then
Exit For
End If

Next Aa


Workbooks(newName).Close False
 
End If
End If

Next a

End With


ThisWorkbook.Sheets("|fffd||fffd||fffd||7b8||178||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||fffd||fffd||377||fffd| - 1) = "|fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||a5|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

End Sub

Sub fjdalkjfal()


For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i - 1, |fffd||fffd||fffd|) <> Cells(i, |fffd||fffd||fffd|) And Cells(i - 1, |fffd||fffd||a5|) <> Cells(i, |fffd||fffd||a5|) Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)
End If
Next i

ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 100) = varTemp(i)
Next i




End Sub


Sub |fffd||fffd||1ae||fffd||43c||fffd||fffd||3f1||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next
 
 
 
 

With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
'.Show
 
strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"
 
'strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
End With
 
fileName = Dir(strPath & "*(|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

 
 
    'If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
   '     MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
    '    Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If


'===|fffd||3f7||fffd||fffd||fffd||fffd||3f4||b9||fffd|===

'1.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||67e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'2.|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||67e||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||177||fffd||fffd||fffd||fffd| 150|fffd||fffd| |fffd||33b||fffd|, |fffd||fffd||570||177||fffd||fffd||fffd||fffd| 150|fffd||fffd| |fffd||33b||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||7ff||fffd||fffd||fffd|
'3.|fffd||7b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||3f1||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||135||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) =>|fffd||fffd||fffd| |fffd||3f6||fffd| |fffd||135||fffd|
'4.|fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| -10%, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5|fffd||fffd||fffd||33b||fffd|
'5,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| |fffd||7f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||fffd||1ae| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd| |fffd||7f0||fffd| |fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").UsedRange.Clear
 
Workbooks.Open (strPath & fileName)
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
 
Workbooks(fileName).Close False
 
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 39) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|30|fffd||fffd|", "|fffd||7b5||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)", _
"|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||377||fffd|", "|fffd||175||fffd||fffd||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|30|fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||2bb||fffd| = i
End If

If Cells(1, i) = "|fffd||7b5||fffd||fffd||fffd|" Then
|fffd||7b5||fffd||fffd||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd| = i
End If
   
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "<|fffd||fffd||fffd||fffd||fffd||335||fffd||fffd||fffd||fffd|>5" Then
|fffd||fffd||fffd||3fc||fffd| = i
End If
  
If Cells(1, i) = "10" Then
|fffd||fffd||fffd||3fc||fffd| = i
End If
 
If Cells(1, i) = "20" Then
|fffd||33d||fffd||fffd||3fc||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||731||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
   Next i
 
 
 
 
   Do While fileName <> ""
 
  Workbooks.Open (strPath & fileName)
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 37) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|30|fffd||fffd|", "|fffd||7b5||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)", _
"|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
 
 
 
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
 
 
 
   '20106.01.04|fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
 
For i = 1 To 20
Set C = Columns(1).Find(Date - i - 700, lookat:=xlWhole)
 
If Not C Is Nothing Then
Exit For
End If
 
Next i
 
If C Is Nothing Then
Set C = Cells(12, 1)
End If
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||13e||fffd|
For i = C.Row To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
 
   Else
 
   Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
 
   End If
 
 
   If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
 
   Else
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
 
   End If
 
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Offset(-20).Resize(21))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Offset(-3).Resize(4))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
 
 
   Next i
 
 
'|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||13e||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||13e||fffd|
 
For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||33d||fffd||fffd||3fc||fffd|) * 1.25 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = 1
End If
 
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||33d||fffd||fffd||3fc||fffd|) * 1.3 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||2bb||fffd|) = 1
End If
  
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||33d||fffd||fffd||3fc||fffd|) Then
Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd|) = 1
End If

If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||fffd||fffd||3fc||fffd|) Then
Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd|) = 1
End If

If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||fffd||fffd||3fc||fffd|) Then
Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd|) = 1
End If
 
If Application.Min(Cells(i - 7, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(8)) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 1)
End If
 
 
If Application.Max(Cells(i - 7, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(8)) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
End If
 
 
Next i
 
Columns(|fffd||fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"
 
 
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||13e||fffd|
For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 
   If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
 
 
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Application.Max(Cells(i - 1, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Offset(-120).Resize(121)) - 1
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||3f6||fffd||fffd||135||fffd|).Offset(-120).Resize(120))
   Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|)
 
   If Application.CountA(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
.Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row - _
   Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row)) > 5 Then
 
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd|) = Application.Max(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
.Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row))
 
   Else
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd|) = Application.Max(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
.Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).End(3).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).End(3).End(3).Row))
 
   End If
 
 
 
End If
 
Next i
 
 
   
   For i = C.Row To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
   
   Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||177||fffd||fffd||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|)
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|)
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|)
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) + Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|)
 
 
   |fffd||fffd||fffd||fffd||fffd||fffd| = 0
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0
 
 
   For ii = Cells(i, |fffd||fffd||fffd||fffd|).Row To Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1 Step -1
   |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd| + 1
 
   If Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) > 0 Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1
   End If
 
   If Cells(ii, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|) > 0 Then
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| + 1
   End If
       
   If Cells(ii, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|) > 0 Then
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| + 1
   End If
 
   Next ii
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||fffd||fffd||fffd|
   
   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3)
  
   End If
 
Next i
 
 
    For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 
    Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd|) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) = (Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd|) * Cells(i, |fffd||fffd||fffd||fffd|)) / 100000000
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|)
   
   Next i
 
For i = C.Row To Cells(Rows.Count, 1).End(3).Row + 1
 
   'If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
   'If Cells(i, |fffd||135||fffd||fffd||fffd|) >= 0.2 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   'If Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||177||fffd||fffd||fffd||fffd|) > 10000 Then
   'If Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
   'If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < -0.2 Then
   If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 15000 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
   'If Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) > 100 Then
   If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = 1 Then
   'If Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd|) = 1 Then
   'If Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd|) = 1 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) <= 10 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0.05 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   
 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, |fffd||fffd||fffd|).End(3) = fileName
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Offset(, |fffd||fffd||fffd||fffd| - 1) = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Value
 
  'End If
  End If
  End If
      Next i
 
Set C = Nothing

 
Workbooks(fileName).Close False
 
 
 
fileName = Dir
 
 
 
Loop
 

 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending
 
Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
 
'|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| c|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Set C = ActiveSheet.UsedRange.Find("|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)


'|fffd||fffd||fffd||fffd||fffd||77a||fffd||fffd||3f8||9f2d| |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||636||fffd|
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) < Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(C.Row - 1, C.Column) Then
Rows(i).Clear
End If

Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending

 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
Cells(i, |fffd||fffd||fffd|) = Split(Cells(i, |fffd||fffd||fffd|), "(")(0)
 
Next i
 

 
Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete
 
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), order1:=xlAscending, order2:=xlAscending

 
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
   End Sub
   

Sub |fffd||fffd||1ae||fffd||43c||fffd||fffd||3f1||fffd|_|fffd||3fa||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||3f1||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next
 
 
 
 

With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show
 
'strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"
 
strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
End With
 
fileName = Dir(strPath & "*(|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

 
 
    'If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
   '     MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
    '    Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If


'===|fffd||3f7||fffd||fffd||fffd||fffd||3f4||b9||fffd|===

'1.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||67e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'2.|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||67e||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||177||fffd||fffd||fffd||fffd| 150|fffd||fffd| |fffd||33b||fffd|, |fffd||fffd||570||177||fffd||fffd||fffd||fffd| 150|fffd||fffd| |fffd||33b||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||7ff||fffd||fffd||fffd|
'3.|fffd||7b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||3f1||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||135||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) =>|fffd||fffd||fffd| |fffd||3f6||fffd| |fffd||135||fffd|
'4.|fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| -10%, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5|fffd||fffd||fffd||33b||fffd|
'5,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| |fffd||7f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||fffd||1ae| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd| |fffd||7f0||fffd| |fffd||3f1||fffd|
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").UsedRange.Clear
 
Workbooks.Open (strPath & fileName)
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
 
Workbooks(fileName).Close False
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 35) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)", _
"|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd| = i
End If
   
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "<|fffd||fffd||fffd||fffd||fffd||335||fffd||fffd||fffd||fffd|>5" Then
|fffd||fffd||fffd||3fc||fffd| = i
End If
  
If Cells(1, i) = "10" Then
|fffd||fffd||fffd||3fc||fffd| = i
End If
 
If Cells(1, i) = "20" Then
|fffd||33d||fffd||fffd||3fc||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||731||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "[|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||17c||fffd|]" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)" Then
|fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
   Next i
 
 
 
 
   Do While fileName <> ""
 
  Workbooks.Open (strPath & fileName)
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 35) = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(20)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(10)", "|fffd||fffd||fffd||7b8||178||174||fffd||fffd|(5)", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|)", _
"|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||731||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)", "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||731||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|(6|fffd||fffd||fffd||fffd|)", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|MAX|fffd||135||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
 
 
 
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
 
 
 
   '20106.01.04|fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
 
 
For i = 1 To 20
Set C = Columns(1).Find(Date - i - 700, lookat:=xlWhole)
 
If Not C Is Nothing Then
Exit For
End If
 
Next i
 
If C Is Nothing Then
Set C = Cells(12, 1)
End If
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||13e||fffd|
For i = C.Row To Cells(Rows.Count, 1).End(3).Row
  
   If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
 
   Else
 
   Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
 
   End If
 
 
   If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
 
   Else
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
 
   End If
 
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Offset(-20).Resize(21))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) = Application.Average(Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Offset(-3).Resize(4))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||731||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
 
 
   Next i
 
 
'|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||13e||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||13e||fffd|
 
For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||33d||fffd||fffd||3fc||fffd|) * 1.2 Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = 1
End If
 
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||33d||fffd||fffd||3fc||fffd|) Then
Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd|) = 1
End If
 
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||fffd||fffd||3fc||fffd|) Then
Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd|) = 1
End If

If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||fffd||fffd||3fc||fffd|) Then
Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd|) = 1
End If
 
If Application.Min(Cells(i - 7, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(8)) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 1)
End If
 
 
If Application.Max(Cells(i - 7, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(8)) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
End If
 
 
Next i
 
Columns(|fffd||fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"
 
 
 
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||13e||fffd|
For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 
   If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
 
 
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Application.Max(Cells(i - 1, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Offset(-120).Resize(121)) - 1
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||3f6||fffd||fffd||135||fffd|).Offset(-120).Resize(120))
   Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|)
 
   If Application.CountA(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
.Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row - _
   Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row)) > 5 Then
 
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd|) = Application.Max(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
.Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).Row))
 
   Else
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||135||fffd|) = Application.Max(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|) _
.Offset(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).End(3).End(3).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row).Resize(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row - Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||135||fffd||fffd||fffd|).End(3).End(3).End(3).End(3).Row))
 
   End If
 
 
 
End If
 
Next i
 
 
   
   For i = C.Row To Cells(Rows.Count, 1).End(3).Row
   If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
   
   Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||177||fffd||fffd||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) = Application.Sum(Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|)
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|)
   Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||570||fffd|) / Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|)
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) + Cells(i, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|)
 
 
   |fffd||fffd||fffd||fffd||fffd||fffd| = 0
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = 0
 
 
   For ii = Cells(i, |fffd||fffd||fffd||fffd|).Row To Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1 Step -1
   |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd| + 1
 
   If Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|) > 0 Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1
   End If
 
   If Cells(ii, |fffd||731||fffd||fffd||3bc||fffd||fffd||17c||fffd|) > 0 Then
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| + 1
   End If
       
   If Cells(ii, |fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd|) > 0 Then
   |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| + 1
   End If
 
   Next ii
 
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||3ba||fffd||fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = |fffd||fffd||fffd||fffd||fffd||fffd|
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3)

   
   End If
 
Next i
 
 
    For i = C.Row To Cells(Rows.Count, 1).End(3).Row
 
    Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd|) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd||570||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) = (Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd|) * Cells(i, |fffd||fffd||fffd||fffd|)) / 100000000
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|)
   
   Next i
 
For i = C.Row To Cells(Rows.Count, 1).End(3).Row + 1
 
   'If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
   'If Cells(i, |fffd||135||fffd||fffd||fffd|) >= 0.2 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   If Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||177||fffd||fffd||fffd||fffd|) > 15000 Then
   If Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||570||177||fffd||fffd||fffd||fffd|) > 100 Then
   If Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, |fffd||fffd||fffd||fffd||fffd||fffd|) = 1 Then
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < -0.3 Then
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|) < 15 Then
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd|) < -0.08 Then
   If Cells(i, |fffd||fffd||fffd||fffd||fffd|) < 0 Then
   
   'If Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||fffd||fffd|) = 1 Then
   'If Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd||fffd||33d||fffd||fffd||fffd|) = 1 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) <= 10 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0.05 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   
 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, |fffd||fffd||fffd|).End(3) = fileName
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Offset(, |fffd||fffd||fffd||fffd| - 1) = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Value
 
  End If
  End If
  End If
  End If
  End If
  End If
  End If
      Next i
 
Set C = Nothing

 
Workbooks(fileName).Close False
 
 
 
fileName = Dir
 
 
 
Loop
 


 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending
 
Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
 
'|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| c|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Set C = ActiveSheet.UsedRange.Find("|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)


'|fffd||fffd||fffd||fffd||fffd||77a||fffd||fffd||3f8||9f2d| |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||3fa||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||636||fffd|
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) < Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(C.Row - 1, C.Column) Then
Rows(i).Clear
End If

Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending

 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
Cells(i, |fffd||fffd||fffd|) = Split(Cells(i, |fffd||fffd||fffd|), "(")(0)
 
Next i
 

 
Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete
 
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, |fffd||3f6||fffd||fffd||135||fffd|), order1:=xlAscending, order2:=xlAscending

 
'Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
   End Sub
   Sub fjdlakfjalkdsfj()
   
 
 
With ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|")


newName = .Cells(2, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
Next i

Workbooks(newName).Close False

End If



For i = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(i, 2) <> .Cells(i - 1, 2) Then
 
newName = .Cells(i, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)
  
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

For ii = 0 To .Cells(Rows.Count, 1).End(3).Row
 
For iii = 2 To Cells(Rows.Count, 1).End(3).Row
 
If Cells(iii, 1) = .Cells(i + ii, 1) Then
 
For a = 1 To 9
.Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| + a) = Application.Sum(Cells(iii, |fffd||177||fffd||fffd||fffd||fffd|).Resize(3 + a))
Next a
 
Exit For
End If
 
Next iii

If .Cells(i + ii, 2) <> .Cells(i + ii + 1, 2) Then
Exit For
End If

Next ii
 
 
Workbooks(newName).Close False
 
End If
 
End If

Next i
 
End With
 
 
 
 
 
'Call |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|
 
 
   End Sub
 Sub |fffd||fffd||fffd||7b8||178||fffd||fffd||fffd||fffd||fffd||331||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|


      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show
 
   strPath = "C:\eBEST\eBestPro\Usr\Smart\ChartInfo\mintry\Local4000\Data\"
 
strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
    End With
 
   fileName = Dir(strPath & "|fffd||4fd||fffd||fffd||fffd||fffd||fffd|.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

 
 
    'If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
   '     MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
    '    Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
 
On Error Resume Next
 
 ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|").Activate
 
 
 
 
 
 fileName = "|fffd||4fd||fffd||fffd||fffd||fffd||fffd|.csv"                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"

 Workbooks.Open (strPath & fileName)
 
 
 
 
 
 
   Do While fileName <> ""
 
  Workbooks.Open (strPath & fileName)
 
 
 
 
 
 
For i = C.Row To Cells(Rows.Count, 1).End(3).Row + 1
 
   'If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
   'If Cells(i, |fffd||135||fffd||fffd||fffd|) >= 0.2 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   'If Cells(i, |fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   If Cells(i, |fffd||177||fffd||fffd||fffd||fffd|) > 1000 Then
   If Cells(i, |fffd||fffd||fffd||7b8||178||174||fffd||fffd|) = 1 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.5 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0.05 Then
   'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0 Then
   
 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 2).End(3) = fileName
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Offset(, |fffd||fffd||fffd||fffd| - 1) = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Value
 
   End If
   End If
 
      Next i
 
Set C = Nothing

 
Workbooks(fileName).Close False
 
 
 
fileName = Dir
 
 
 
Loop
 
 
ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
 
Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")
 
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
Cells(i, 2) = Split(Cells(i, 2), "(")(0)
 
Next i
 
  
For i = 1 To 10
Set C = Columns(1).Find(Date - i - 10, lookat:=xlWhole)
 
If Not C Is Nothing Then
Exit For
End If
 
Next i
 
Range("a2", Cells(C.Row, Columns.Count)).Delete shift = xlUp
 
Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete
 
 

 
 
With ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|")


newName = .Cells(2, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
Next i

Workbooks(newName).Close False

End If



For i = 2 To .Cells(Rows.Count, 1).End(3).Row
 
newName = .Cells(i, 2) & "(5|fffd||fffd|).csv"
 
If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
 
Workbooks.Open (strPath & newName)
  
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
 
For ii = 2 To Cells(Rows.Count, 1).End(3).Row
 
If Cells(ii, 1) = .Cells(i, 1) Then
 
For a = 1 To 9
.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||3bc||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| + a) = Application.Sum(Cells(ii, |fffd||177||fffd||fffd||fffd||fffd|).Resize(3 + a))
Next a
 
Exit For
End If
 
Next ii
 
 
 
Workbooks(newName).Close False
 
End If
 
Next i
 
End With
 
 
 
 
 
Call |fffd||470||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|
 
 
   End Sub
   
Sub |fffd||fffd||1ae||fffd||43c||fffd||fffd||fffd||fffd||43a||fffd||fffd||177||fffd||fffd||fffd||77e||fffd||fffd||fffd||fffd||fffd||1ae|()



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

  .Show


 strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    End With

    fileName = Dir(strPath & "*csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|



    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


  End If

On Error Resume Next

Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, 2) = Cells(i - 1, 2) Then
Rows(i).Clear
End If
Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

r = 0

For a = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= 0.9 Then
If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) >= 0.1 Then
If Cells(a, |fffd||177||fffd||fffd||fffd||fffd|) > 3000 Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(a, 1).Resize(, 100)

End If
End If
End If



Next a

ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 100) = varTemp(i)
Next i

Erase varTemp
r = 0



With ThisWorkbook.Sheets("|fffd||fffd||1ae||fffd||43c||fffd|")
For a = 2 To .Cells(Rows.Count, 1).End(3).Row

fileName = .Cells(a, 2) & ".csv"

If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then


Workbooks.Open (strPath & fileName)
  

For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 3) = Cells(i, 2) * Cells(i, 10)
Next i


For i = 0 To 6

.Cells(a, 65 + i) = Application.Sum(Cells(73 - i, 3).Resize(50))

Next i

End If

Set C = Nothing


Workbooks(fileName).Close False


Next a

End With

   End Sub
Sub |fffd||fffd||fffd||fffd||fffd||331||fffd|()
Dim varTemp()                     '|fffd||fffd||fffd||6b8||fffd| |fffd||438||fffd||fffd||3ff||fffd| |fffd||4fd||f7||fffd| |fffd||fffd||fffd||fffd| |fffd||8fed| |fffd||fffd||fffd||fffd|
Dim rowsCnt As Long, colsCnt As Long
Dim tmr As String

tmr = Timer
    
Application.ScreenUpdating = False
Application.DisplayAlerts = False
On Error Resume Next
 
 
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Delete
colsCnt = Cells(1, Columns.Count).End(1).Column
 
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear
 
 
 
With Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|")

'|fffd||fffd||fffd||fffd| |fffd||6b5||fffd| |fffd||77a||fffd||fffd||3f8||9f2d| |fffd||fffd||fffd||339||fffd||fffd||fffd| |fffd||67f||fffd| |fffd||7b1||fffd|
For i = 2 To .Cells(Rows.Count, 1).End(3).Row
If .Cells(i, 4) < 4000000 Then
With ActiveSheet.QueryTables.Add(Connection:= _
"URL;http://finance.naver.com/item/main.nhn?code=" & Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Cells(i, 1), Destination:=Cells(1, 3))
        .Name = "main.nhn?code=" & Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Cells(i, 1)
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        .WebTables = "4"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
       .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
End With
 
Cells(1, 1).Resize(20, 2) = .Cells(i, 1).Resize(, 2).Value '|fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|

Sheets("|fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(Cells(Rows.Count, 1).End(3).Row, colsCnt) = Cells(1, 1).Resize(Cells(Rows.Count, 1).End(3).Row, colsCnt).Value
Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Sheets("|fffd||fffd||fffd||7b8||178||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"

End If

Next i '|fffd||77a||fffd| |fffd||3f7||fffd|
 
End With

'|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
rowsCnt = Cells(Rows.Count, 1).End(3).Row
 
'|fffd||2bf||fffd||fffd||fffd| |fffd||fffd||fffd||be38| |fffd||8fed||fffd||fffd| |fffd||5be||ef2d| |fffd||fffd||fffd||fffd|
For i = 2 To rowsCnt
 
If Cells(i, 1) <> Cells(i - 1, 1) Then
 
For ii = 4 To 19
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i + ii, 1).Resize(, colsCnt)
Next ii
 
End If
 
Next i
 
ActiveSheet.UsedRange.Offset(1).Delete
 
For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, colsCnt) = varTemp(i)
Next i
 
Erase varTemp
r = 0
 
 
 
'|fffd||7e6b||fffd||fffd||1e5| |fffd||338||fffd| |fffd||5b1||fffd|
rowsCnt = Cells(Rows.Count, 1).End(3).Row
 
varTemp = Array("|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|", "|fffd||fffd||fffd||fffd||fffd||377||fffd|", "ROE", "|fffd||fffd||e4||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||ba||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "EPS", "PER", "BPS", "PBR", "|fffd||5b4||fffd||fffd||fffd||fffd|", "|fffd||f0||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||7f3a||fffd||fffd|", "")
 
Cells(2, 3).Resize(rowsCnt).Clear
 
 
Set C = Cells(1, 3)
 
Do
 
If C.Row > rowsCnt Then
Exit Do
End If
 
Cells(Rows.Count, 3).End(3)(2).Resize(UBound(varTemp, 1)) = Application.Transpose(varTemp)
 
Set C = C.End(4)
 
Loop
 
Cells(Rows.Count, 1).End(3)(2).Resize(UBound(varTemp, 1), colsCnt).Delete
 
 
Set C = Nothing
 
 
 
 
'|fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd||6b8||fffd||fffd||fffd| |fffd||fffd||fffd||7f1||fffd|
 
Columns(1).NumberFormatLocal = "@"
For i = 2 To rowsCnt
 
If Len(Cells(i, 1)) = 2 Then
Cells(i, 1) = "0000" & Cells(i, 1)
 
ElseIf Len(Cells(i, 1)) = 3 Then
Cells(i, 1) = "000" & Cells(i, 1)
 
ElseIf Len(Cells(i, 1)) = 4 Then
Cells(i, 1) = "00" & Cells(i, 1)
 
ElseIf Len(Cells(i, 1)) = 5 Then
Cells(i, 1) = "0" & Cells(i, 1)
 
End If
 
Next i
 
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||331||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||b3||fffd||fffd||67d||f5||fffd||fffd||fffd||fffd||fffd|()

Dim colsCnt As Long

Application.ScreenUpdating = False
Application.DisplayAlerts = False
On Error Resume Next

Sheets("|fffd||fffd||fffd||fffd|").Activate
colsCnt = Cells(1, Columns.Count).End(1).Column

'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
For i = 1 To colsCnt
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2019.06" Then
|fffd||5b1||67a||431||fffd||fffd||fffd||fffd| = i
End If
 
Next i
 

 
'|fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||67d||fffd| |fffd||67f||fffd|
 
Sheets("|fffd||4fd||fffd|").Activate
 
With Sheets("|fffd||fffd||fffd||fffd|")

For i = 2 To 300 '.Cells(Rows.Count, 1).End(3).Row
Sheets("|fffd||4fd||fffd|").Activate
If .Cells(i, |fffd||fffd||fffd||fffd|) <> .Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
If .Cells(i, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd|) = "" Then
.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(16, colsCnt).Clear

With ActiveSheet.QueryTables.Add(Connection:= _
"URL;http://finance.naver.com/item/main.nhn?code=" & Sheets("|fffd||fffd||fffd||fffd|").Cells(i, 1), Destination:=Cells(1, 3))
        .Name = "main.nhn?code=" & Sheets("|fffd||fffd||fffd||fffd|").Cells(i, 1)
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        .WebTables = "3"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
       .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
End With
 
Cells(1, 1).Resize(20, 2) = .Cells(i, 1).Resize(, 2).Value '|fffd||fffd||fffd||fffd||fffd||6b5||fffd|, |fffd||fffd||fffd||fffd||fffd| |1e5||fffd||fffd|

Sheets("|fffd||fffd||fffd||fffd|").Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(16, colsCnt) = Cells(5, 3).Resize(16, colsCnt).Value
Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Sheets("|fffd||fffd||fffd||7b8||178||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"

End If
End If

Next i '|fffd||77a||fffd| |fffd||3f7||fffd|
 
End With

'|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate


End Sub


Sub fdajlfkajf()




With ActiveSheet.QueryTables.Add(Connection:= _
"URL;http://finance.naver.com/item/main.nhn?code=227950", Destination:=Cells(1, 3))
        .Name = "main.nhn?code=227950"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        .WebTables = "3"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
       .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
End With
 









End Sub

Sub fjdsalkfja()

Set |fffd||5bf||fffd||fffd||fffd||1e5| = ActiveSheet.UsedRange.Find("|fffd||5bf||fffd||fffd||fffd||1e5|", lookat:=xlWhole)
Cells(|fffd||5bf||fffd||fffd||fffd||1e5|.Row, |fffd||5bf||fffd||fffd||fffd||1e5|.Column + 1) = Split(Cells(|fffd||5bf||fffd||fffd||fffd||1e5|.Row, |fffd||5bf||fffd||fffd||fffd||1e5|.Column + 1), "/")(0)

With Sheets("|fffd||fffd||fffd||fffd|")
.Cells(r + 17, 3).Resize(4) = Cells(|fffd||5bf||fffd||fffd||fffd||1e5|.Row + 1, |fffd||5bf||fffd||fffd||fffd||1e5|.Column).Resize(4).Value
.Cells(r + 21, 3) = "PSR"

For a = 1 To .Cells(1, Columns.Count).End(1).Column
If .Cells(1, a) = Cells(|fffd||5bf||fffd||fffd||fffd||1e5|.Row, |fffd||5bf||fffd||fffd||fffd||1e5|.Column + 1) Then
.Cells(r + 17, a).Resize(4, 2) = Cells(|fffd||5bf||fffd||fffd||fffd||1e5|.Row + 1, |fffd||5bf||fffd||fffd||fffd||1e5|.Column + 1).Resize(4, 2).Value
Exit For
End If
Next a

End With


ActiveSheet.UsedRange.Clear

End Sub

Sub fjalfjkal()


'|fffd||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://finance.naver.com/item/coinfo.nhn?code=000020", Destination:=Range("$A$1"))
        '.Name = Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Cells(2, 1)
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        .WebTables = "1"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    
End Sub

Sub fjlafj()

    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |e3||fffd||fffd|
Set |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = ActiveSheet.UsedRange.Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)
Set |fffd||fffd||fffd||fffd||fffd||fffd| = ActiveSheet.UsedRange.Find("|fffd||fffd||fffd||fffd||fffd||fffd|(%)", lookat:=xlWhole)
Set |fffd||fffd||1e5||fffd||fffd| = ActiveSheet.UsedRange.Find("|fffd||fffd||1e5||fffd||fffd|", lookat:=xlWhole)
Set |fffd||fffd||fffd||fffd| = Sheets("|fffd||fffd||fffd||fffd|").Rows(1).Find("2017", lookat:=xlWhole)

With Sheets("|fffd||fffd||fffd||fffd|")
.Cells(r + 22, 3) = "|fffd||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.Cells(r + 23, 3) = "|fffd||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

For a = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Row + 1 To Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column).End(3).Row
If Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|.Column) <> "" And Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|.Column) > 0 Or Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|.Column) <> "" And Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|.Column) < 0 Then
.Cells(r + 22, |fffd||fffd||fffd||fffd|.Column) = Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|.Column).Value
.Cells(r + 22, |fffd||fffd||fffd||fffd|.Column - 1) = Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column).End(3).Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Row
.Cells(r + 22, |fffd||fffd||fffd||fffd|.Column - 2) = Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column).Value
.Cells(r + 23, |fffd||fffd||fffd||fffd|.Column - 1) = Application.Average(Columns(|fffd||fffd||1e5||fffd||fffd|.Column))
Exit For
End If
Next a

End With

ActiveSheet.UsedRange.Clear

y = y + 1

If y = 10 Then
Application.DisplayAlerts = False
Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Worksheets("|fffd||fffd||fffd||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"
Application.DisplayAlerts = True
y = 0
End If


    Next i


'|fffd||4fd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Workbooks.Open (strPath & fileName)

Cells(1, 1).Resize(Cells(Rows.Count, 1).End(3).Row, 50).Copy ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1)

Workbooks(fileName).Close False

'|fffd||f0||fffd||fffd||47e||5f0||fffd| |fffd||fffd||fffd||7c21| update |fffd||3f1||fffd|
Set |fffd||f0||fffd||fffd||47e||fffd| = ActiveSheet.Rows(1).Find("|fffd||f0||fffd||fffd||47e||fffd|", lookat:=xlWhole)
Set |fffd||fffd||fffd||7c21| = ActiveSheet.Rows(1).Find("|fffd||fffd||fffd||7c21|", lookat:=xlWhole)

For a = 2 To Cells(Rows.Count, 1).End(3).Row

Cells(a, |fffd||f0||fffd||fffd||47e||fffd|.Column) = Split(Cells(a, |fffd||f0||fffd||fffd||47e||fffd|.Column), " |fffd||fffd||fffd|")(0)

Set |fffd||fffd||fffd||fffd| = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(a, 2), lookat:=xlWhole)
If Not |fffd||fffd||fffd||fffd| Is Nothing Then
Sheets("|fffd||fffd||fffd||fffd|").Cells(|fffd||fffd||fffd||fffd|.Row + 15, 11) = Cells(a, |fffd||fffd||fffd||7c21|.Column).Value
Sheets("|fffd||fffd||fffd||fffd|").Cells(|fffd||fffd||fffd||fffd|.Row + 16, 11) = Cells(a, |fffd||f0||fffd||fffd||47e||fffd|.Column).Value
End If

Next a

ActiveSheet.UsedRange.Clear

Sheets("|fffd||fffd||fffd||fffd|").Activate

Set |fffd||fffd||fffd||fffd| = Rows(1).Find("2017", lookat:=xlWhole)

For a = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(a, 3) = "PSR" Then
Cells(a, |fffd||fffd||fffd||fffd|.Column) = Cells(a - 5, |fffd||fffd||fffd||fffd|.Column) / Cells(a - 20, |fffd||fffd||fffd||fffd|.Column)
Cells(a, |fffd||fffd||fffd||fffd|.Column - 1) = Cells(a - 5, |fffd||fffd||fffd||fffd|.Column) / Cells(a - 20, |fffd||fffd||fffd||fffd|.Column - 1)
Cells(a + 2, |fffd||fffd||fffd||fffd|.Column) = Cells(a + 2, |fffd||fffd||fffd||fffd|.Column - 1) / Cells(a - 6, |fffd||fffd||fffd||fffd|.Column)
End If
Next a

Range(Cells(Rows.Count, 1).End(3)(2), Cells(Cells(Rows.Count, 1).Row, Cells(1, Columns.Count).Column)).Delete '|fffd||fffd||12d||fffd||fffd| delete|fffd||3f1||fffd| |fffd||fffd||fffd||fffd| |fffd||6f0||fffd||fffd||3f1||fffd|

End Sub

Sub |fffd||672||671||fffd|()

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||fffd||fffd||fffd|").Activate


ActiveSheet.UsedRange.Replace "|fffd||fffd| ", "", xlPart
ActiveSheet.UsedRange.Replace "(|fffd||fffd||fffd||fffd|)", "", xlPart
ActiveSheet.UsedRange.Replace "(|fffd||fffd||fffd||fffd|)", "", xlPart
ActiveSheet.UsedRange.Replace "|fffd||fffd| ", "", xlPart


End Sub

Sub |fffd||678||fffd||fffd||fffd||1fb||fffd||37f||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Dim C As Range
Dim |fffd||fffd||fffd||fffd| As Range

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||4fd||fffd|").Activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)
 
If C Is Nothing Then
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 12) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||121|", "PreSurprise", "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||121|", "Surprise", "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||431||fffd||fffd||fffd|")
End If
 
Set C = Nothing
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i
 


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) <> Cells(i - 1, 1) Then

Set |fffd||fffd||fffd||fffd| = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)

If Not |fffd||fffd||fffd||fffd| Is Nothing Then

Cells(i + 2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Resize(2, 12) = Sheets("|fffd||fffd||fffd||fffd|").Cells(|fffd||fffd||fffd||fffd|.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Resize(2, 12).Value

End If

End If

Next i

Set |fffd||fffd||fffd||fffd| = Nothing



End Sub



Sub |fffd||fffd||fffd||fffd|update|fffd||3f1||fffd|()
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
  

Set C = Cells(1, 1).Resize(, 100).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)
If C Is Nothing Then
 
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 5) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "1|fffd||431||fffd||fffd|", "2|fffd||431||fffd||fffd|", "3|fffd||431||fffd||fffd|")
 
End If
 
Set C = Nothing
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|4" Then
|fffd||fffd||fffd||431||fffd|4 = i
End If
  
If Cells(1, i) = "|fffd||337||fffd||fffd||431||fffd|" Then
|fffd||337||fffd||fffd||431||fffd| = i
End If
  
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If

If Cells(1, i) = "4|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
 
 
Next i
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row


If Cells(i, |fffd||67d||fffd|) = "|fffd||2d75|/|fffd||fffd|" Then


' 2017|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|/|fffd||fffd||fffd||fffd||fffd||377||fffd| |fffd||fffd||fffd||3f1||fffd|
If Cells(i + 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" Then
Cells(i + 4, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = (Cells(i + 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i + 2, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)) * 100
Cells(i + 5, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = (Cells(i + 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i + 3, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)) * 100
End If


' |fffd||fffd||fffd|&|fffd||fffd||fffd||fffd||fffd||fffd||fffd| update
For a = 1 To 19

If Cells(i + a, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) <> "" Then
Cells(i + a, |fffd||fffd||fffd||fffd|) = (Cells(i + a, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) - Cells(i + a, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|)) / Cells(i + a, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|)

If (Cells(i + a, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) - Cells(i + a, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|)) > 0 And Cells(i + a, |fffd||fffd||fffd||fffd|) < 0 Then
Cells(i + a, |fffd||fffd||fffd||fffd|) = Cells(i + a, |fffd||fffd||fffd||fffd|) * -1
End If

End If


If Cells(i + a, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" Then
If Cells(i + a, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
Cells(i + a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = (Cells(i + a, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) - Cells(i + a, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)) / Cells(i + a, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)

If (Cells(i + a, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) - Cells(i + a, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)) > 0 And Cells(i + a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
Cells(i + a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + a, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If


End If
End If


Next a

r = 0
'|fffd||431||fffd||fffd| update
For ii = 0 To 7 Step 2
For a = 1 To 11

Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii) = (Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r) - Cells(i + a, |fffd||6f3||fffd||431||fffd|1 + r)) / Cells(i + a, |fffd||6f3||fffd||431||fffd|1 + r)
Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii + 1) = (Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r) - Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r - 1)) / Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r - 1)

If (Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r) - Cells(i + a, |fffd||6f3||fffd||431||fffd|1 + r)) > 0 And Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii) < 0 Then
Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii) = Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii) * -1
End If

If (Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r) - Cells(i + a, |fffd||fffd||fffd||431||fffd|1 + r - 1)) > 0 And Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii + 1) < 0 Then
Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii + 1) = Cells(i + a, |fffd||3fa||431||fffd||fffd| + ii + 1) * -1
End If


Next a

r = r + 1

Next ii

End If

Next i

 
 
 
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim |fffd||fffd||fffd||fffd| As Long
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If
 
 
 
Next i
 
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Clear
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
 '2016e |fffd||fffd| |fffd||5b4||b3||fffd|
'If Cells(i, |fffd||fffd||fffd||fffd|) = "|fffd||775||fffd||fc||fffd||379||775||fffd||fc||fffd||fffd||fffd|" Then
If Cells(i, |fffd||67d||fffd|) = "|fffd||fffd||fffd||fffd||fffd|" Then
'If Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|1).Resize(, 4)) < Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) Then
'If Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) < Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) Then
'If Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) < Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|4).Resize(, 4)) Then
 
'If Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|1).Resize(, 4)) < Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) Then
'If Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) < Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) Then
'If Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) < Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|4).Resize(, 4)) Then
 
'If Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|1).Resize(, 4)) < Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) Then
'If Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) < Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) Then
'If Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) < Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|4).Resize(, 4)) Then
 
'If Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|1).Resize(, 4)) < Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) Then
'If Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) < Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) Then
'If Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) < Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|4).Resize(, 4)) Then
 
'If Application.Sum(Cells(i + 4, |fffd||6f3||fffd||431||fffd|1).Resize(, 4)) < Application.Sum(Cells(i + 4, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) Then
'If Application.Sum(Cells(i + 4, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) < Application.Sum(Cells(i + 4, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) Then
'If Application.Sum(Cells(i + 4, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) < Application.Sum(Cells(i + 4, |fffd||6f3||fffd||431||fffd|4).Resize(, 4)) Then
 
'If Application.Sum(Cells(i + 9, |fffd||6f3||fffd||431||fffd|2).Resize(, 4)) < Application.Sum(Cells(i + 9, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) Then
'If Application.Sum(Cells(i + 9, |fffd||6f3||fffd||431||fffd|3).Resize(, 4)) < Application.Sum(Cells(i + 9, |fffd||6f3||fffd||431||fffd|4).Resize(, 4)) Then
 
If Cells(i, |fffd||fffd||fffd||fffd|) > 1 Or Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1 Then
If Cells(i + 1, |fffd||fffd||fffd||fffd|) > 1.2 Or Cells(i + 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1.2 Then
'If Cells(i + 9, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd|) > 1.1 Then
If Cells(i + 16, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) < 10 Then
If Cells(i + 17, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) < 1 Then
If Cells(i + 20, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) < 0.5 Then
 
'If (Cells(i, |fffd||fffd||fffd||431||fffd|1) + Cells(i, |fffd||fffd||fffd||431||fffd|2)) / Cells(i, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) > 0.5 Then
'If (Cells(i + 1, |fffd||fffd||fffd||431||fffd|1) + Cells(i + 1, |fffd||fffd||fffd||431||fffd|2)) / Cells(i + 1, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) > 0.8 Then
If Cells(i + 3, |fffd||fffd||fffd||431||fffd|1) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|1) > 5 Or Cells(i + 3, |fffd||fffd||fffd||431||fffd|2) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|2) > 5 Then
If Cells(i + 3, |fffd||3fa||431||fffd||fffd|) <> "" And Cells(i + 3, |fffd||3fa||431||fffd||fffd|) > 1.3 Or Cells(i + 3, |fffd||33a||431||fffd||fffd|) <> "" And Cells(i + 3, |fffd||33a||431||fffd||fffd|) > 1.3 Then
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(23, 100) = Cells(i, 1).Resize(23, 100).Value
 
End If
End If
End If
End If
End If
End If
End If
End If
 
 
 
  
 
Next i
 
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
 
 Columns.AutoFit
 
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|_test()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim |fffd||fffd||fffd||fffd| As Long
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
 
 
Next i
 
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Clear
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
 '2017e |fffd||fffd| |fffd||5b4||b3||fffd|
'If Cells(i, |fffd||fffd||fffd||fffd|) = "|fffd||fffd||1f0|" Then
If Cells(i, |fffd||67d||fffd|) = "|fffd||fffd||fffd||fffd||fffd|" Then
'If Cells(i, |fffd||fffd||fffd||fffd|) > 1.2 Then
If Cells(i + 9, |fffd||fffd||fffd||fffd|) > 3 Then
If Cells(i + 1, |fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 50 Then
If Cells(i + 1, |fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|) > 50 Then
If Cells(i + 2, |fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 50 Then
If Cells(i + 2, |fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|) > 50 Then


'If Cells(i + 1, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) / Cells(i + 1, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) > 2 Then
'If Cells(i + 12, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) <> "-" And Cells(i + 12, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) > 2 Or Cells(i + 12, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) <> "-" And Cells(i + 12, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) > 2 Then
'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1.2 Then
'If Cells(i + 9, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1.2 Then
'If Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd|) > 1 Then
'If Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd|) > 1 Then
'If Cells(i + 9, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 2 Then

'If Cells(i + 16, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0.9 Then

'If Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd|) > 1 Then

'If Cells(i + 2, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd|) > 1 Then

 
'If Cells(i, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) < Cells(i, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) And Cells(i, |fffd||fffd||f5||fffd||2bb||fffd||fffd|) < Cells(i, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) Then
'If Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 9 Then
'If Cells(i + 17, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 17, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) < 1.5 Then

'If Cells(i+16, |fffd||fffd||fffd||fffd|) < 1.1 Then
'If Cells(i + 6, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) < 100 Then
'If Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 1.5 Then
'If Cells(i + 3, |fffd||fffd||fffd||fffd|) > 2 Then
'If Cells(i + 9, |fffd||fffd||fffd||fffd|) > 2 Then
 
'If Cells(i + 3, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) > 5 Then
'If Cells(i + 3, |fffd||3fa||431||fffd||fffd|) <> "" And Cells(i + 3, |fffd||3fa||431||fffd||fffd|) > 1.3 Or Cells(i + 3, |fffd||33a||431||fffd||fffd|) <> "" And Cells(i + 3, |fffd||33a||431||fffd||fffd|) > 1.3 Then
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(23, 100) = Cells(i, 1).Resize(23, 100).Value

 
End If
End If
End If
End If
End If
End If
'End If
'End If
 
 
   
 
Next i
 
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
 
 Columns.AutoFit
 
End Sub
Sub |fffd||fffd||f5||fffd||fffd||125||fffd||fffd||fffd||fffd||fffd||fffd|update|fffd||3f1||fffd|()

On Error Resume Next
Application.ScreenUpdating = False

Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
ActiveCell.Offset(, -2).Copy Sheets("test").Cells(1, 1)

Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

Next i

Sheets("test").Activate

For i = 1 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) = "2017(E)" Then
|fffd||fffd||fffd||fffd| = i
End If

Next i

Sheets("|fffd||fffd||fffd||fffd|").Activate


Set C = Columns(1).Find(Sheets("test").Cells(1, 1), lookat:=xlWhole)


Cells(C.Row + 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 2).Value
Cells(C.Row + 2, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 4).Value
Cells(C.Row + 3, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 5).Value
Cells(C.Row + 6, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 9).Value
Cells(C.Row + 10, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 6).Value
Cells(C.Row + 17, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 7).Value
Cells(C.Row + 18, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 8).Value
Cells(C.Row + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Sheets("test").Cells(|fffd||fffd||fffd||fffd|, 10).Value


Sheets("test").Activate
ActiveSheet.UsedRange.Delete
Cells(2, 1).Select

Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate


End Sub
Sub |fffd||431||fffd||fffd||fffd||fffd|update|fffd||3f1||fffd|()
 
 
Dim C As Range
Dim CC As Range
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Range
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Range
Dim |fffd||fffd||fffd||fffd||121| As Range
Dim |fffd||7e6b||fffd||fffd||fffd||fffd| As Range
 
 
 
On Error Resume Next
Application.ScreenUpdating = False
 
Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
ActiveCell.Offset(, -2).Copy Sheets("|fffd||4fd||fffd|").Cells(1, 1)
 
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.UnMerge
 
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)
 
If C Is Nothing Then
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 12) = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||121|", "PreSurprise", "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|", _
"|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||121|", "Surprise", "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||431||fffd||fffd||fffd|")
End If
 
Set C = Nothing
 
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i
 
 
Set C = Columns(1).Find(Sheets("|fffd||4fd||fffd|").Cells(1, 1), lookat:=xlWhole)
Set |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Sheets("|fffd||4fd||fffd|").Columns(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)
Set |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Sheets("|fffd||4fd||fffd|").Columns(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)
Set |fffd||fffd||fffd||fffd||121| = Sheets("|fffd||4fd||fffd|").Columns(1).Find("|fffd||fffd||fffd||fffd||121||fffd||fffd||1e5|", lookat:=xlPart)
Set |fffd||7e6b||fffd||fffd||fffd||fffd| = Sheets("|fffd||4fd||fffd|").Columns(1).Find("|fffd||7e6b||fffd||fffd||fffd||fffd|", lookat:=xlWhole)
 
Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Resize(2) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||fffd||fffd||fffd||121|.Row, |fffd||fffd||fffd||fffd||121|.Column + 2).Value
Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Resize(2) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||fffd||fffd||fffd||121|.Row, |fffd||fffd||fffd||fffd||121|.Column + 3).Value
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||7e6b||fffd||fffd||fffd||fffd|.Row, |fffd||7e6b||fffd||fffd||fffd||fffd|.Column + 2).Value
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||7e6b||fffd||fffd||fffd||fffd|.Row, |fffd||7e6b||fffd||fffd||fffd||fffd|.Column + 3).Value

For i = 0 To 4
Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd| + i) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Row + i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column + 2)
Cells(C.Row + 3, |fffd||fffd||fffd||fffd||fffd||fffd| + i) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Row + i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column + 2)
Cells(C.Row + 2, |fffd||fffd||fffd||fffd| + i) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Row + i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column + 3)
Cells(C.Row + 3, |fffd||fffd||fffd||fffd| + i) = Sheets("|fffd||4fd||fffd|").Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Row + i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Column + 3)
Next i
 
 
Application.DisplayAlerts = False
Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Worksheets("|fffd||fffd||fffd||7b8||178||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"
Application.DisplayAlerts = True
 
 
Sheets("|fffd||4fd||fffd|").Activate
Cells(2, 1).Select
 
Set C = Nothing
Set CC = Nothing
 
Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
 
 
End Sub
Sub |fffd||431||fffd||fffd||fffd||fffd|update|fffd||7f4||b5||fffd||fffd||239||7be||fffd||fffd||fffd||fffd||fffd||67d||f9||7b1||fffd|()

Dim varTemp()
Dim |fffd||fffd||fffd||fffd| As Range

Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||4fd||fffd|").UsedRange.Clear

Sheets("|fffd||fffd||fffd||fffd|").Activate


 
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i
 

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||67d||fffd|) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = "" Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 500)

End If
End If

Next i



Sheets("|fffd||4fd||fffd|").Activate

For i = 1 To UBound(varTemp, 1)
Cells(i, 1).Resize(, 500) = varTemp(i)
Next i

Erase varTemp
r = 0

ActiveSheet.UsedRange.Sort key1:=Cells(1, 1)

For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, 1) = Cells(i - 1, 1) Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Sort key1:=Cells(1, 1)

Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate

Range("e2", Cells(Rows.Count, 5).End(3)).Clear

For i = 1 To Cells(Rows.Count, 1).End(3).Row

Set |fffd||fffd||fffd||fffd| = Sheets("|fffd||4fd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not |fffd||fffd||fffd||fffd| Is Nothing Then

Cells(i, 5) = "o"

End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 5)
Sheets("|fffd||4fd||fffd|").UsedRange.Clear




End Sub





Sub |fffd||2c23||fffd||fffd||b7||fffd||fffd||331||fffd|()
 
   
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
 
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
 
On Error Resume Next
 
 
 
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, 1) <> Cells(i + 1, 1) Then
fileName = Cells(i, 1).Value & "(|fffd||fffd|).csv"
   
   If fileName <> "" Then
   Workbooks.Open (strPath & fileName)
   If ActiveSheet.Name <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   
   
   ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending
   
     
Cells(1, Columns.Count).End(1).Offset(, 1) = "2015/01/02"
 
Cells(1, Columns.Count).End(1).NumberFormatLocal = "yyyy-mm-dd"
 
   
   For a = 2 To Cells(Rows.Count, 1).End(3).Row
   
   If Cells(a, 1) = Cells(1, Columns.Count).End(1) Then
        
   Cells(a, 23) = Application.Max(Cells(a, 3).Resize(490))
   ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 21) = Application.Max(Cells(a, 3).Resize(490)) / Cells(a, 5)
   
   End If
      
    
  
   Next a
     
   
      
   

   End If
   
   Workbooks(fileName).Close False
    
 
   End If
   End If
   
   Next i
   
   End Sub

Sub |fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|_|1a2||fffd||b3||fffd|()
 
   

Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim strPath1 As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strName1 As String







    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|

        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|

        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|

            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|

        Else


            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

        End If


    End With

    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|

        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|


   End If

On Error Resume Next


ThisWorkbook.Sheets("|fffd||4fd||fffd|").UsedRange.Clear
   Do While fileName <> ""

    
   Workbooks.Open (strPath & fileName)
   
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending


   
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 3) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "2016/11/01") 'head |fffd||7f0||fffd||fffd||3f1||fffd|

Cells(1, Columns.Count).End(1).NumberFormatLocal = "yyyy-mm-dd"

For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
 
   If Cells(1, i) = "20" Then
   |fffd||33d||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||f0||fffd|" Then
   |fffd||f0||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   Next i
   
   

   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = 20 To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Min(Cells(i - 10, |fffd||fffd||fffd||fffd|).Resize(21)) = Cells(i, |fffd||fffd||fffd||fffd|) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
   End If
   
        
   Next i
   
   


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd|) < Cells(i, |fffd||33d||fffd||fffd||fffd||fffd||fffd|) * 1.2 Then
If Cells(i, |fffd||fffd||fffd||fffd|) > Cells(i, |fffd||f0||fffd|) Then
If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 < -0.08 Then

Cells(i, |fffd||fffd||fffd||fffd| + 1) = "1"

End If
End If
End If

If Cells(i, |fffd||fffd||fffd||fffd|) < Cells(i, |fffd||33d||fffd||fffd||fffd||fffd||fffd|) * 1.2 Then
If Cells(i, |fffd||fffd||fffd||fffd|) < Cells(i, |fffd||f0||fffd|) Then
If Cells(i, |fffd||f0||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1 < -0.08 Then

Cells(i, |fffd||fffd||fffd||fffd| + 1) = "1"

End If
End If
End If


Next i

Set C = Range("a1", Cells(Rows.Count, 1).End(3)).Find(Cells(1, Columns.Count).End(1), lookat:=xlWhole)

If Application.CountA(Cells(C.Row, |fffd||fffd||fffd||fffd| + 1).Resize(44)) > 2 Then

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3)(2) = Split(fileName, "(")(0)
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(Rows.Count, 1).End(3).Offset(, 1) = Application.CountA(Cells(C.Row, |fffd||fffd||fffd||fffd| + 1).Resize(44))

End If

Workbooks(fileName).Close False
   
   
  fileName = Dir
    
 

Loop



        End Sub
        
        
        
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f4||b3||fffd||fffd||331||fffd|()

   

Dim rngall As Range
Dim rngC As Range
Dim rngData As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim strPath1 As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim strName1 As String

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||fffd||fffd||fffd|").Activate

If Rows(1).Find("|fffd||431||2eaf||22d|", lookat:=xlWhole) = "" Then

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 6) = Array("2016pe", "2017pe", "|fffd||431||2eaf||22d|", "2016 |fffd||fffd||22d||fffd||fffd|", "2017 |fffd||fffd||22d||fffd||fffd|", "|fffd||431||2eaf||22d||fffd||fffd|")

End If


For i = 1 To Cells(1, Columns.Count).End(1).Column


If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If



If Cells(1, i) = "2016pe" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017pe" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d|" Then
|fffd||431||2eaf||22d| = i
End If

If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If

Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) <> Cells(i + 1, 1) Then

Set C = Sheets("test").Columns(1).Find(Cells(i + 1, 1), lookat:=xlWhole)

Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(24, 2) = Sheets("test").Cells(C.Row, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(24, 2).Value
Cells(i + 1, |fffd||431||2eaf||22d|).Resize(24) = Sheets("test").Cells(C.Row, |fffd||fffd||fffd||431||fffd|3).Resize(24).Value

End If

Set C = Nothing

Next i



 
For i = 2 To Cells(Rows.Count, 1).End(3).Row


If Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd|) = Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd|) = Cells(i, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||431||2eaf||22d||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||431||fffd|3) / Cells(i, |fffd||431||2eaf||22d|)
  
End If

Next i
 





End Sub
        
        

  Sub |fffd||fffd||fffd||fffd||7b6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|()
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
Dim |fffd||fffd||fffd||377||fffd| As Long
 
On Error Resume Next
Application.ScreenUpdating = False


Sheets("test2").UsedRange.Clear
Sheets("|fffd||6bd||fffd||fffd||fffd|").Activate



For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 2) = "|fffd||6bd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Then

Set C = Sheets("test").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)

Sheets("test").Activate

For ii = C.Row To C.Row + 1000

Sheets("test2").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(ii, 1).Resize(, 100).Value

If Cells(ii, 1) <> Cells(ii + 1, 1) Then
Exit For
End If

Next ii

Sheets("|fffd||6bd||fffd||fffd||fffd|").Activate

Set C = Nothing

End If

Next i

 
 
 
   End Sub
     
   
Sub |fffd||7b6||fffd||fffd||fffd||fffd||7ff||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|()


Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd| As Long
 
 



Application.ScreenUpdating = False
On Error Resume Next

'|fffd||fffd||1ae||fffd||43c||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

'head |fffd||fffd||fffd||3f0||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If


Next i

'|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| |fffd||135||fffd||fffd||71cf7||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd|), key2:=Cells(1, |fffd||135||fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlDescending


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||4fd||fffd|, |fffd||4fd||fffd|2 |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Clear
Sheets("|fffd||4fd||fffd|").UsedRange.Clear
Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100).Value


With Sheets("|fffd||4fd||fffd|")

For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

.Cells(Rows.Count, 1).End(3)(2).Resize(24, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row, 1).Resize(24, 100).Value

Set C = Nothing

Next i

End With


Sheets("|fffd||4fd||fffd|").Activate
 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
 
 
Next i
 
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Clear
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 

If Cells(i, |fffd||67d||fffd|) = "|fffd||2d75|/|fffd||fffd|" Then
If Cells(i + 9, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i + 9, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1.2 Then
If Cells(i + 1, |fffd||fffd||fffd||fffd||121|) > 0 And Cells(i + 2, |fffd||fffd||fffd||fffd||121|) > 0 Then
If Cells(i + 1, surprise) > 10 And Cells(i + 2, surprise) > 10 _
Or Cells(i + 1, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 50 And Cells(i + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 50 _
And Cells(i + 1, |fffd||fffd||fffd||431||fffd||fffd||fffd|) > 50 And Cells(i + 2, |fffd||fffd||fffd||431||fffd||fffd||fffd|) > 50 Then

'If Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 8 Then
'If Cells(i + 17, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 17, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 1.5 Then
'If Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 1.5 Then
'If Cells(i + 3, |fffd||fffd||fffd||431||fffd|1) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|1) > 5 And Cells(i + 3, |fffd||fffd||fffd||431||fffd|2) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|2) > 5 And Cells(i + 3, |fffd||fffd||fffd||431||fffd|3) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|3) > 5 Then
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(23, 100) = Cells(i, 1).Resize(23, 100).Value

 
End If
End If
End If
End If
'End If
'End If
'End If



If Cells(i, |fffd||67d||fffd|) = "|fffd||fffd||fffd||fffd||fffd|" Then
If Cells(i + 9, |fffd||fffd||fffd||fffd|) <> "" And Cells(i + 9, |fffd||fffd||fffd||fffd|) > 1.2 Then
If Cells(i + 1, |fffd||fffd||fffd||fffd||121|) > 0 And Cells(i + 2, |fffd||fffd||fffd||fffd||121|) > 0 Then
If Cells(i + 1, surprise) > 10 And Cells(i + 2, surprise) > 10 _
Or Cells(i + 1, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 50 And Cells(i + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|) > 50 _
And Cells(i + 1, |fffd||fffd||fffd||431||fffd||fffd||fffd|) > 50 And Cells(i + 2, |fffd||fffd||fffd||431||fffd||fffd||fffd|) > 50 Then

'If Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 8 Then
'If Cells(i + 17, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 17, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 1.5 Then
'If Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" And Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) < 1.5 Then
'If Cells(i + 3, |fffd||fffd||fffd||431||fffd|1) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|1) > 5 And Cells(i + 3, |fffd||fffd||fffd||431||fffd|2) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|2) > 5 And Cells(i + 3, |fffd||fffd||fffd||431||fffd|3) <> "" And Cells(i + 3, |fffd||fffd||fffd||431||fffd|3) > 5 Then
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(23, 100) = Cells(i, 1).Resize(23, 100).Value

 
End If
End If
End If
End If
'End If
'End If
'End If




Next i


Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
 
 Columns.AutoFit



End Sub


Sub |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3ff||fffd|update|fffd||3f1||fffd|()
 



Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim strAddr As String
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim |fffd||fffd||fffd||fffd| As Long
 
    
    On Error Resume Next
    Application.ScreenUpdating = False
    
    Sheets("|fffd||fffd||fffd||fffd|").Activate
    
    
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
 Next i
    
   For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||67d||fffd|) = "|fffd||fffd||fffd||fffd||fffd|" Then
If Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "" And Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 2, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 9, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i + 9, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 3, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) * 100
Cells(i + 4, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 2, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) * 100
Cells(i + 5, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i + 5, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 6, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i + 6, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 7, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i + 7, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 8, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i + 8, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 10, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i + 10, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i + 16, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 14, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i + 9, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i + 17, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 14, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i + 10, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i + 20, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 15, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)

End If
End If

Next i


   For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||67d||fffd|) = "PER" And Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 2, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i - 7, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
End If

If Cells(i, |fffd||67d||fffd|) = "PBR" And Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 3, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i - 7, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
End If

If Cells(i, |fffd||67d||fffd|) = "|fffd||fffd||fffd||fffd||fffd|" And Cells(i, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" Then
Cells(i + 20, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Cells(i + 15, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)
End If


Next i


End Sub




Sub |fffd||edb2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||33f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|fact|22e||fffd||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
 
 
 
 
 
    Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
        .Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
        If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
            strPath = .SelectedItems(1) & "\"        '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
    fileName = Dir(strPath & "*.csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    
    
    If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
        Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
   End If
 
On Error Resume Next
 

ThisWorkbook.Sheets("test").UsedRange.Clear
ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear


ThisWorkbook.Sheets("test").Activate

Cells(1, 1).Resize(, 4) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||630||fffd|", "|fffd||fffd||b7||fffd|", "2016-09-29") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
Cells(1, Columns.Count).End(1).NumberFormatLocal = "yyyy-mm-dd"

   
   Do While fileName <> ""
   
   Workbooks.Open (strPath & fileName)
      
 ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    
 
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||f0||fffd|" Then
   |fffd||f0||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
      
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
      
  
   Next i
   
   
  
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
 
   Set C = Columns(1).Find(ThisWorkbook.Sheets("test").Cells(1, Columns.Count).End(1), lookat:=xlWhole)
     
   With ThisWorkbook.Sheets("test")
   .Cells(Rows.Count, 1).End(3)(2) = Split(fileName, "(")(0)
   .Cells(Rows.Count, 1).End(3).Offset(, 1) = Cells(C.Row, |fffd||fffd||fffd||fffd|).Value
   .Cells(Rows.Count, 1).End(3).Offset(, 2) = Application.Min(Cells(C.Row + 1, |fffd||fffd||fffd||fffd|).Resize(1000)) / Cells(C.Row, |fffd||fffd||fffd||fffd|) - 1
   End With
   
   Set C = Nothing
        
 
   
Workbooks(fileName).Close False
 
 
       
    
  fileName = Dir
    
 
 
Loop
 
 Cells(1, Columns.Count).End(1).Clear
 
 
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||b7||fffd|" Then
   |fffd||fffd||b7||fffd| = i
   End If
     
   Next i
   
 
 
 ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||b7||fffd|), order1:=xlAscending
 
 For i = 2 To 300
 
 Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)
 Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(24, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row, 1).Resize(24, 100).Value
 Set C = Nothing
 
 Next i
 
 
 
 Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
 
 
   End Sub
   
   
   Sub |fffd||fffd||fffd||fffd||fffd||33f||fffd||fffd||fffd||fffd||b3||fffd||fffd||fffd||fffd||22e||fffd||fffd||fffd||3f1||fffd|()
    
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
On Error Resume Next
Application.ScreenUpdating = False

ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange.Offset(1).Clear
   
   Sheets("test").Activate
   
For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
   If Cells(1, i) = "|fffd||fffd||b7||fffd|" Then
   |fffd||fffd||b7||fffd| = i
   End If
     
   Next i
   
 
 
 ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||b7||fffd|), order1:=xlDescending
 
 For i = 2 To 200
 
 Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)
 Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(24, 100) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row, 1).Resize(24, 100).Value
 Set C = Nothing
 
 Next i
 
 
 
 Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
 
 
   End Sub


Sub |fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||43c||fffd||fffd||3f1||fffd|()

Dim C As Range


Application.ScreenUpdating = False
On Error Resume Next



Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) <> Cells(i + 1, 1) Then
Set C = Sheets("test").Columns(1).Find(Cells(i + 1, 1), lookat:=xlWhole)

Cells(i + 1, 8).Resize(24) = Sheets("test").Cells(C.Row, 8).Resize(24).Value

End If

Next i

Set C = Nothing

End Sub




Sub |fffd||135||fffd||fffd||fffd||fffd||3f1||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
  
   Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
  
 
On Error Resume Next
 
Sheets("test").Activate
Sheets("test2").UsedRange.Clear
   
Set C = Rows(1).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)

If C Is Nothing Then
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 13) = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||337||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||3fc||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||337||fffd||fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|", "|fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "2010-01-08") 'head |fffd||7f0||fffd||fffd||3f1||fffd|
End If

Set C = Nothing

Cells(1, Columns.Count).End(1).NumberFormatLocal = "yyyy-mm-dd"

Columns("o:q").NumberFormatLocal = "yyyy-mm-dd"


    
 Sheets("test2").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value
    
 ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending '1,2|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
    

For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   

    
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd| = i
   End If
 
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
      
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
         If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
      
      If Cells(1, i) = "|fffd||337||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||337||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||3f6||fffd||fffd||3fc||fffd|" Then
   |fffd||3f6||fffd||fffd||3fc||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||337||fffd||fffd||fffd||fffd||fffd|" Then
   |fffd||337||fffd||fffd||fffd||fffd||fffd| = i
   End If
   
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
   |fffd||fffd||fffd||fffd| = i
   End If
   
    
   If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||3f6||fffd||fffd||135||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd| = i
   End If
   
      If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
   |fffd||135||fffd||fffd||fffd| = i
   End If
   
   If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
   |fffd||fffd||fffd||fffd||135||fffd| = i
   End If

   Next i
   
   
  
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
 
   Set C = Columns(1).Find(Cells(1, Columns.Count).End(1), lookat:=xlWhole)
     
 
   '|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
   For i = C.Row To Cells(Rows.Count, 1).End(3).Row
   
   If Application.Max(Cells(i - 7, 3).Resize(15)) = Cells(i, 3) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 3)
   End If
   
   If Application.Min(Cells(i - 7, 4).Resize(15)) = Cells(i, 4) Then
   Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, 4)
   End If
   
        
   Next i
   
   
   For i = C.Row To Cells(Rows.Count, 1).End(3).Row
   
   
   If Cells(i, |fffd||fffd||fffd||fffd|) <> "" Then
   If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
   
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row, 1)
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, 1)
   Cells(i, |fffd||337||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(Cells(i, |fffd||fffd||fffd||fffd|).End(4).Row, 1)
   Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(4) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033
   Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1.0033
   Cells(i, |fffd||3f6||fffd||fffd||3fc||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
   Cells(i, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|) = Application.Min(Cells(i - 120, |fffd||3f6||fffd||fffd||135||fffd|).Resize(120))
   Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(3)
   Cells(i, |fffd||337||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(4)
   Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd|)
   
   If Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) < 0 Then
   Sheets("test2").Cells(Rows.Count, 1).End(3)(2).Resize(, 100) = Cells(i, 1).Resize(, 100).Value
   End If
   
   End If
   End If
   
   
   Next i
   
   Set C = Nothing
   
 
  Sheets("test2").Activate
  
 
 
 
 
   End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd||fffd||5b1||fffd||fffd||7e6b||fffd||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|()
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim |fffd||431||fffd||fffd||fffd||fffd| As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim uu As String
Dim qq As String
Dim ww As String
Dim ee As String
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next




'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate

 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "2016" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "2017|fffd||fffd|2|fffd||431||fffd|" Then
|fffd||33a||431||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
  
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i




For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) <> "" Then
Cells(i - 2, |fffd||33a||431||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|).Value
Cells(i, |fffd||33a||431||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||121|).Value
Cells(i + 1, |fffd||33a||431||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd||121|).Value
Cells(i + 2, |fffd||33a||431||fffd|) = (Cells(i, |fffd||33a||431||fffd|) / Cells(i - 1, |fffd||33a||431||fffd|)) * 100
Cells(i + 3, |fffd||33a||431||fffd|) = (Cells(i + 1, |fffd||33a||431||fffd|) / Cells(i - 1, |fffd||33a||431||fffd|)) * 100
Cells(i + 8, |fffd||33a||431||fffd|) = Cells(i + 13, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / (Cells(i + 14, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i + 1, |fffd||33a||431||fffd|))
Cells(i - 1, |fffd||33a||431||fffd|).Resize(11).NumberFormatLocal = "#,###"
Cells(i + 2, |fffd||33a||431||fffd|).Resize(2).NumberFormatLocal = "#,###.0"

End If
End If


Next i



End Sub
Sub |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim |fffd||431||fffd||fffd||fffd||fffd| As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim uu As String
Dim qq As String
Dim ww As String
Dim ee As String
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Clear



For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "|fffd||337||fffd|EPS|fffd||fffd||22d|" Then
|fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If

Next i


For i = 1 To Cells(2, Columns.Count).End(1).Column

'|fffd||fffd||a5| update
If Cells(2, i) = "|fffd||fffd||a5|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||a5|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||a5|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If

'|fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If


'|fffd||fffd||fffd||7c21| update
If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||7c21|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If


'|fffd||fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 90|fffd||3fc||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)

For ii = 0 To 32

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd| + ii).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column + ii).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

Next ii

End If

Next i


'For i = 1 To 10
'Set C = Columns(|fffd||fffd||a5|).Find(Date - i - 2, lookat:=xlWhole)

'If Not C Is Nothing Then
'Exit For
'End If

'Next i


'Range(Cells(C.Row, 1), Cells(Rows.Count, Columns.Count)).Delete


ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("EPS|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae| |22e||fffd||fffd|
uu = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
qq = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|"
ww = "EPS|fffd||fffd||fffd||fffd|"
ee = "|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|"
dd = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|"

b = 0

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd||fffd||fffd|
For a = 1 To Sheets.Count

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||634||fffd||276||fffd|
If InStr(Sheets(a).Name, uu) Or InStr(Sheets(a).Name, qq) Or InStr(Sheets(a).Name, ww) Or InStr(Sheets(a).Name, ee) Or InStr(Sheets(a).Name, dd) Then


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|

For i = 3 To Cells(Rows.Count, 1).End(3).Row

With Sheets(a)
Set C = .Columns(2).Find(Cells(i, |fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then

r = 0
For ii = C.Row To C.Row + 10000

If .Cells(ii, 1) >= (Cells(i, 1) - 14) And .Cells(ii, 1) <= Cells(i, 1) Then
r = r + 1
End If

If .Cells(ii, 2) <> .Cells(ii + 1, 2) Then
Exit For
End If

Next ii

End If

End With


Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + b) = r

r = 0

Set C = Nothing

Next i

b = b + 1

End If

Next a

Cells(2, 1).Interior.Color = 255
Call |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|_|fffd||7e6b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae|
End Sub


Sub |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|_|fffd||7e6b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae|()

Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate




For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "|fffd||337||fffd|EPS|fffd||fffd||22d|" Then
|fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate

 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "2016" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "2017|fffd||fffd|1|fffd||431||fffd|" Then
|fffd||3fa||431||fffd| = i
End If

If Cells(1, i) = "2017|fffd||fffd|2|fffd||431||fffd|" Then
|fffd||33a||431||fffd| = i
End If

If Cells(1, i) = "2017|fffd||fffd|3|fffd||431||fffd|" Then
|fffd||fffd||431||fffd| = i
End If

If Cells(1, i) = "2017|fffd||fffd|4|fffd||431||fffd|" Then
|fffd||fffd||431||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||3fd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i


'|fffd||7e6b||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With Sheets("|fffd||fffd||fffd||fffd|")

For i = 3 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||fffd||fffd||fffd|) Then


Set C = .Columns(1).Find(Cells(i, |fffd||fffd||fffd||fffd|), lookat:=xlWhole)

For ii = 0 To 100000

If .Cells(C.Row + 10, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) <> "" Then
Cells(i + ii, |fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d|) = .Cells(C.Row + 10, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / .Cells(C.Row + 10, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd| - 1)
End If

Cells(i + ii, |fffd||fffd||e4||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 7, |fffd||fffd||431||fffd|).Value
Cells(i + ii, |fffd||fffd||fffd||ba||fffd||fffd||fffd|) = .Cells(C.Row + 8, |fffd||fffd||431||fffd|).Value
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 9, |fffd||fffd||431||fffd|).Value
Cells(i + ii, |fffd||fffd||fffd|) = .Cells(C.Row + 13, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|).Value

'|fffd||fffd||fffd||fffd| |fffd||5b1||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| |fffd||1fe||fffd||fffd||678||fffd|

If .Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||3fd||fffd||fffd||fffd|) <> "" Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = .Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||3fd||fffd||fffd||fffd|).Value

.Cells(C.Row + 2, |fffd||fffd||431||fffd|).Resize(2) = .Cells(C.Row + 2, |fffd||fffd||fffd||fffd||121|).Resize(2).Value
.Cells(C.Row + 4, |fffd||fffd||431||fffd|) = (.Cells(C.Row + 2, |fffd||fffd||431||fffd|) / .Cells(C.Row + 1, |fffd||fffd||431||fffd|)) * 100
.Cells(C.Row + 5, |fffd||fffd||431||fffd|) = (.Cells(C.Row + 3, |fffd||fffd||431||fffd|) / .Cells(C.Row + 1, |fffd||fffd||431||fffd|)) * 100
.Cells(C.Row + 10, |fffd||fffd||431||fffd|) = .Cells(C.Row + 10, |fffd||fffd||431||fffd|) * (.Cells(C.Row + 3, |fffd||fffd||431||fffd|) / .Cells(C.Row + 3, |fffd||fffd||431||fffd|))


Cells(i + ii, |fffd||431||fffd|per) = Cells(i + ii, |fffd||fffd||fffd||7c21|) / (.Cells(C.Row + 10, |fffd||fffd||431||fffd|) * 4)

If .Cells(C.Row + 10, |fffd||fffd||431||fffd| - 3) <> "" Then
Cells(i + ii, per) = Cells(i + ii, |fffd||fffd||fffd||7c21|) / Application.Sum(.Cells(C.Row + 10, |fffd||fffd||431||fffd| - 3).Resize(, 4))
End If

Cells(i + ii, pbr) = Cells(i + ii, |fffd||fffd||fffd||7c21|) / .Cells(C.Row + 11, |fffd||fffd||431||fffd|).Value
Cells(i + ii, psr) = (((Cells(i + ii, |fffd||fffd||fffd||7c21|) / .Cells(C.Row + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)) * .Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|))) / Application.Sum(.Cells(C.Row + 1, |fffd||fffd||431||fffd| - 3).Resize(, 4))
Cells(i + ii, surprise|fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 2, surprise).Value
Cells(i + ii, surprise|fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 3, surprise).Value


If .Cells(C.Row + 2, |fffd||fffd||431||fffd| - 4) <> "" Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ((.Cells(C.Row + 2, |fffd||fffd||431||fffd|) - .Cells(C.Row + 2, |fffd||fffd||431||fffd| - 4)) / .Cells(C.Row + 2, |fffd||fffd||431||fffd| - 4)) * 100

If .Cells(C.Row + 2, |fffd||fffd||431||fffd|) - .Cells(C.Row + 2, |fffd||fffd||431||fffd| - 4) >= 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

If .Cells(C.Row + 2, |fffd||fffd||431||fffd|) - .Cells(C.Row + 2, |fffd||fffd||431||fffd| - 4) < 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

End If


If .Cells(C.Row + 3, |fffd||fffd||431||fffd| - 4) <> "" Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ((.Cells(C.Row + 3, |fffd||fffd||431||fffd|) - .Cells(C.Row + 3, |fffd||fffd||431||fffd| - 4)) / .Cells(C.Row + 3, |fffd||fffd||431||fffd| - 4)) * 100

If .Cells(C.Row + 3, |fffd||fffd||431||fffd|) - .Cells(C.Row + 3, |fffd||fffd||431||fffd| - 4) >= 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

If .Cells(C.Row + 3, |fffd||fffd||431||fffd|) - .Cells(C.Row + 3, |fffd||fffd||431||fffd| - 4) < 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

End If


'|fffd||fffd||fffd||fffd||5f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
If .Cells(C.Row + 1, |fffd||fffd||431||fffd|) <> "" And .Cells(C.Row + 1, |fffd||fffd||431||fffd| - 4) <> "" Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd|) = Application.Sum(.Cells(C.Row + 1, |fffd||fffd||431||fffd| - 3).Resize(, 4))
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ((.Cells(C.Row + 1, |fffd||fffd||431||fffd|) - .Cells(C.Row + 1, |fffd||fffd||431||fffd| - 4)) / .Cells(C.Row + 1, |fffd||fffd||431||fffd| - 4)) * 100
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
If .Cells(C.Row + 4, |fffd||fffd||431||fffd| - 4) <> "" Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ((.Cells(C.Row + 4, |fffd||fffd||431||fffd|) - .Cells(C.Row + 4, |fffd||fffd||431||fffd| - 4)) / .Cells(C.Row + 4, |fffd||fffd||431||fffd| - 4)) * 100

If .Cells(C.Row + 4, |fffd||fffd||431||fffd|) - .Cells(C.Row + 4, |fffd||fffd||431||fffd| - 4) >= 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

If .Cells(C.Row + 4, |fffd||fffd||431||fffd|) - .Cells(C.Row + 4, |fffd||fffd||431||fffd| - 4) < 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
If .Cells(C.Row + 5, |fffd||fffd||431||fffd| - 4) <> "" Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ((.Cells(C.Row + 5, |fffd||fffd||431||fffd|) - .Cells(C.Row + 5, |fffd||fffd||431||fffd| - 4)) / .Cells(C.Row + 5, |fffd||fffd||431||fffd| - 4)) * 100

If .Cells(C.Row + 5, |fffd||fffd||431||fffd|) - .Cells(C.Row + 5, |fffd||fffd||431||fffd| - 4) >= 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

If .Cells(C.Row + 5, |fffd||fffd||431||fffd|) - .Cells(C.Row + 5, |fffd||fffd||431||fffd| - 4) < 0 Then
If Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

End If


Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 4, |fffd||fffd||431||fffd|).Value
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 5, |fffd||fffd||431||fffd|).Value


End If


If Cells(i + ii, |fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd|) Then
Exit For
End If

Next ii

End If


Next i

End With

Set C = Nothing

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'Call |fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|


End Sub
Sub |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|_|fffd||470||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()


 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim |fffd||431||fffd||fffd||fffd||fffd| As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim uu As String
Dim qq As String
Dim ww As String
Dim ee As String
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate



For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "|fffd||337||fffd|EPS|fffd||fffd||22d|" Then
|fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If



Next i




ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlAscending, order2:=xlAscending '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("EPS|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae| |22e||fffd||fffd|
uu = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
qq = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|"
ww = "EPS|fffd||fffd||fffd||fffd|"
ee = "|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|"
dd = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|"

b = 0

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd||fffd||fffd|
For a = 1 To Sheets.Count

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||634||fffd||276||fffd|
If InStr(Sheets(a).Name, uu) Or InStr(Sheets(a).Name, qq) Or InStr(Sheets(a).Name, ww) Or InStr(Sheets(a).Name, ee) Or InStr(Sheets(a).Name, dd) Then


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|

For i = 3 To Cells(Rows.Count, 1).End(3).Row

With Sheets(a)
Set C = .Columns(2).Find(Cells(i, |fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then

r = 0
For ii = C.Row To C.Row + 10000

If .Cells(ii, 1) >= (Cells(i, 1) - 7) And .Cells(ii, 1) <= Cells(i, 1) Then
r = r + 1
End If

If .Cells(ii, 2) <> .Cells(ii + 1, 2) Then
Exit For
End If

Next ii

End If

End With


Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + b) = r

r = 0

Set C = Nothing

Next i

b = b + 1

End If

Next a

End Sub


Sub |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|_|fffd||f9||137||fffd||fffd||33c||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim |fffd||431||fffd||fffd||fffd||fffd| As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim uu As String
Dim qq As String
Dim ww As String
Dim ee As String
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Clear


For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "|fffd||337||fffd|EPS|fffd||fffd||22d|" Then
|fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If



Next i



For i = 1 To Cells(2, Columns.Count).End(1).Column

'|fffd||fffd||a5|, |fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||a5|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||a5|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||a5|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2).Value

End If

'|fffd||fffd||fffd||7c21| update
If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||7c21|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If


'|fffd||fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 90|fffd||3fc||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)

For ii = 0 To 24

Cells(Rows.Count, |fffd||fffd||fffd||fffd| + ii).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column + ii).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

Next ii

End If

Next i



ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("EPS|fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)
Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4)


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae| |22e||fffd||fffd|
uu = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
qq = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|"
ww = "EPS|fffd||fffd||fffd||fffd|"
ee = "|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|"
dd = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|"

b = 0

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd||fffd||fffd|
For a = 1 To Sheets.Count

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||634||fffd||276||fffd|
If InStr(Sheets(a).Name, uu) Or InStr(Sheets(a).Name, qq) Or InStr(Sheets(a).Name, ww) Or InStr(Sheets(a).Name, ee) Or InStr(Sheets(a).Name, dd) Then


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|

For i = 3 To Cells(Rows.Count, 1).End(3).Row

With Sheets(a)
Set C = .Columns(2).Find(Cells(i, |fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then

r = 0
For ii = C.Row To C.Row + 10000

If .Cells(ii, 1) >= (Cells(i, 1) - 20) And .Cells(ii, 1) <= Cells(i, 1) Then
r = r + 1
End If

If .Cells(ii, 2) <> .Cells(ii + 1, 2) Then
Exit For
End If

Next ii

End If

End With


Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + b) = r

r = 0

Set C = Nothing

Next i

b = b + 1

End If

Next a


'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate

 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "2016" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||3fd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i


End Sub

Sub fjdsklafjala()


Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "|fffd||337||fffd|EPS|fffd||fffd||22d|" Then
|fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If



Next i



'|fffd||7e6b||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update
Sheets("|fffd||fffd||fffd||fffd|").Activate

 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "2016" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||3fd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i




With Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i - 1, 1) <> Cells(i, 1) Then

Set C = .Columns(|fffd||fffd||fffd||fffd|).Find(Cells(i, 1), lookat:=xlWhole)

If Not C Is Nothing Then

For ii = C.Row To C.Row + 100000

For iii = 13 To Cells(1, Columns.Count).End(1).Column

If Cells(i, iii - 3) <> "" And Cells(i, iii - 2) <> "" And Cells(i, iii - 1) <> "" And Cells(i, iii) <> "" And Cells(i, iii + 1) <> "" Then
If Cells(i, iii) < .Cells(ii, |fffd||fffd||a5|) And Cells(i, iii + 1) >= .Cells(ii, |fffd||fffd||a5|) Then

.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) = Cells(i, iii).Value
.Cells(ii, |fffd||431||fffd|per) = (.Cells(ii, |fffd||fffd||fffd||7c21|) / Cells(i + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)) * Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / (Cells(i + 3, iii) * 4)
.Cells(ii, per) = (.Cells(ii, |fffd||fffd||fffd||7c21|) / Cells(i + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)) * Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Application.Sum(Cells(i + 3, iii - 3).Resize(, 4))
.Cells(ii, psr) = (.Cells(ii, |fffd||fffd||fffd||7c21|) / Cells(i + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)) * Cells(i + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Application.Sum(Cells(i + 1, iii - 3).Resize(, 4))
.Cells(ii, |fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(i + 1, iii - 3).Resize(, 4))
.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = (Cells(i + 1, iii) - Cells(i + 1, iii - 4)) / Cells(i + 1, iii - 4)

.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = (Cells(i + 2, iii) - Cells(i + 2, iii - 4)) / Cells(i + 2, iii - 4)
If Cells(i + 2, iii) - Cells(i + 2, iii - 4) >= 0 Then
If .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
Else
If .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = (Cells(i + 3, iii) - Cells(i + 3, iii - 4)) / Cells(i + 3, iii - 4)
If Cells(i + 3, iii) - Cells(i + 3, iii - 4) >= 0 Then
If .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 0 Then
.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
Else
If .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0 Then
.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) * -1
End If
End If

.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 2, iii) / Cells(i + 1, iii)
.Cells(ii, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 3, iii) / Cells(i + 1, iii)

Exit For

End If
End If

Next iii

If .Cells(ii, |fffd||fffd||fffd||fffd|) <> .Cells(ii + 1, |fffd||fffd||fffd||fffd|) Then
Exit For
End If


Next ii

End If

End If

Next i


End With



End Sub

Sub fjdklafjalf()








ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||a5|), key2:=Cells(2, |fffd||fffd||fffd||fffd|) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


'Call |fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|


End Sub

Sub |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|()
 
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim |fffd||431||fffd||fffd||fffd||fffd| As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim uu As String
Dim qq As String
Dim ww As String
Dim ee As String
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Clear


For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|

If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "|fffd||337||fffd|EPS|fffd||fffd||22d|" Then
|fffd||337||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If



Next i



For i = 1 To Cells(2, Columns.Count).End(1).Column

'|fffd||fffd||a5|, |fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||a5|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||a5|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||a5|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2).Value

End If

'|fffd||fffd||fffd||7c21| update
If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||7c21|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If


'|fffd||fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row).Value

End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 90|fffd||3fc||fffd||fffd||377||fffd| |fffd||fffd||fffd||fffd| update
If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Rows(1).Find("|fffd||fffd||fffd||fffd|", lookat:=xlWhole)

Cells(Rows.Count, |fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 23) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, C.Column).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 23).Value

End If



Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|




'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update |fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||fffd|").Activate

 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2016" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||3fd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If
 
If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
Next i


'|fffd||7e6b||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| update
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = 3 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, |fffd||fffd||fffd||fffd|), lookat:=xlWhole)

For ii = 0 To 100000

For iii = |fffd||fffd||f5||fffd||2bb||fffd||fffd| To |fffd||fffd||f5||fffd||2bb||fffd||fffd| + 3

If Split(Cells(i, |fffd||fffd||a5|), "-")(0) = Split(Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row, iii), ".")(0) Then

Cells(i + ii, |fffd||fffd||e4||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 7, iii).Value
Cells(i + ii, |fffd||fffd||fffd||ba||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 8, iii).Value
Cells(i + ii, |fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 9, iii).Value
Cells(i + ii, |fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 13, iii).Value

Exit For

End If

Next iii

If Cells(i + ii, |fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd|) Then
Exit For
End If

Next ii

End If


Next i

Set C = Nothing

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||a5|), key2:=Cells(2, |fffd||fffd||fffd||fffd|) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|


Call |fffd||17c||fffd||fffd||fffd||fffd||fffd||331||fffd|


End Sub



Sub |fffd||f9||fffd|_|fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Clear



For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|


If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "PER|fffd||fffd||22d|" Then
per|fffd||fffd||22d| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If


If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If

Next i




Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Cells(Rows.Count, 1).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, 1).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2).Value

Cells(Rows.Count, |fffd||fffd||fffd||7c21|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 5).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, 5).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 5).End(3).Row).Value

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 5) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row, 5).Value



For i = 3 To Cells(Rows.Count, 1).End(3).Row

'-- REPORT|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (3|fffd||fffd||fffd||fffd||fffd||fffd|)

Set C = Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= (Cells(i, 1) - 66) Then
            If Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            Set C = Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ii

ii = 0

Set C = Nothing


'-- |fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|


Set C = Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
            If Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            Set C = Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, |fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|) = ii

ii = 0

Set C = Nothing



'--|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|

Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
            If Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            
            Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, |fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|) = ii

ii = 0

Set C = Nothing


'--eps|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|

Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            
            Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, eps|fffd||fffd||fffd||2c33||fffd||fffd|) = ii

ii = 0

Set C = Nothing




Next i




Sheets("|fffd||fffd||fffd||fffd|").Activate


For i = 1 To Cells(1, Columns.Count).End(1).Column


If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|4" Then
|fffd||fffd||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If

If Cells(1, i) = "4|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
  
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If


If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If

Next i



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 3 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

If Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) < Cells(i, 1) Then
If Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) > Cells(i, 1) Then

Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||121|).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||fffd||fffd||fffd||121|).Value
Cells(i, surprise|fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, presurprise).Value
Cells(i, surprise|fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, presurprise).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|).Value
Cells(i, per) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Application.Sum(Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||6f3||fffd||431||fffd|3).Resize(, 4))
Cells(i, |fffd||431||fffd|per) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / (Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||fffd||fffd||fffd||121|) * 4)


End If
End If

If Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) <> "" Then
If Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|) < Cells(i, 1) Then

Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||fffd||121|).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||fffd||121|).Value
Cells(i, surprise|fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, surprise).Value
Cells(i, surprise|fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, surprise).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||431||fffd||fffd||fffd|).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||431||fffd||fffd||fffd|).Value
Cells(i, per) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||431||fffd|per) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / (Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||fffd||121|) * 4)

End If
End If

End If






Next i

Set C = Nothing


Columns(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"


End Sub



Sub |fffd||f9||fffd|_|fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||377||fffd|_test()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
 
  
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Clear


For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|


If Cells(1, i) = "2016|fffd||fffd| 1|fffd||431||fffd|" Then
|fffd||3fa||431||fffd| = i
End If


Next i



For i = 1 To Cells(2, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|


If Cells(2, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21| = i
End If
     
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd|" Then
|fffd||fffd||fffd||377||fffd| = i
End If

If Cells(2, i) = "|fffd||431||fffd|PER" Then
|fffd||431||fffd|per = i
End If

If Cells(2, i) = "PER" Then
per = i
End If

If Cells(2, i) = "PBR" Then
pbr = i
End If

If Cells(2, i) = "PSR" Then
psr = i
End If

If Cells(2, i) = "PER|fffd||fffd||22d|" Then
per|fffd||fffd||22d| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If


If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "SURPRISE(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
surprise|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If


If Cells(2, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d||fffd||fffd|" Then
eps|fffd||fffd||22d||fffd||fffd| = i
End If

If Cells(2, i) = "EPS|fffd||fffd||22d|" Then
eps|fffd||fffd||22d| = i
End If

Next i


Sheets("|fffd||fffd||fffd||fffd|").Activate


For i = 1 To Cells(1, Columns.Count).End(1).Column


If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|4" Then
|fffd||fffd||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If

If Cells(1, i) = "4|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
  
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If


If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If

Next i


Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column 'head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
   
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

Cells(Rows.Count, 1).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, 1).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 2).Value

Cells(Rows.Count, |fffd||fffd||fffd||7c21|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 5).End(3).Row) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, 5).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 5).End(3).Row).Value

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3)(2).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, 1).End(3).Row, 15) = _
Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).End(3).Row, 15).Value




For i = 3 To Cells(Rows.Count, 1).End(3).Row

'-- REPORT|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (3|fffd||fffd||fffd||fffd||fffd||fffd|)

Set C = Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= (Cells(i, 1) - 66) Then
            If Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            Set C = Sheets("REPORT(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = ii

ii = 0

Set C = Nothing


'-- |fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|


Set C = Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
            If Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            Set C = Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, |fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|) = ii

ii = 0

Set C = Nothing



'--|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|

Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
            If Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            
            Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, |fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|) = ii

ii = 0

Set C = Nothing


'--eps|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|

Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

ii = 0

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) >= Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) <= Cells(i, 1) Then
            
            ii = ii + 1
                        
            End If
            End If
            
            
            Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
            If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Cells(i, eps|fffd||fffd||fffd||2c33||fffd||fffd|) = ii

ii = 0

Set C = Nothing




Next i






For i = 3 To Cells(Rows.Count, 1).End(3).Row
r = 0
For ii = 0 To 4

If Cells(i, 1) > Cells(2, |fffd||3fa||431||fffd| + ii) And Cells(i, 1) < Cells(2, |fffd||3fa||431||fffd| + ii + 1) Then

Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 1, |fffd||fffd||fffd||431||fffd|1 + ii).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||fffd||fffd||431||fffd|1 + ii).Value
Cells(i, |fffd||fffd||fffd||377||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 4, |fffd||fffd||fffd||431||fffd|1 + ii).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||431||fffd|1 + ii).Value
Cells(i, |fffd||fffd||fffd||377||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 5, |fffd||fffd||fffd||431||fffd|1 + ii).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 1, |fffd||3fa||431||fffd||fffd| + r).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 1, |fffd||3fa||431||fffd||fffd| + r + 1).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||3fa||431||fffd||fffd| + r).Value
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||3fa||431||fffd||fffd| + r).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 2, |fffd||3fa||431||fffd||fffd| + r + 1).Value
Cells(i, |fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||3fa||431||fffd||fffd| + r + 1).Value
Cells(i, per) = (Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) * (Cells(i, |fffd||fffd||fffd||7c21|) / Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|))) / Application.Sum(Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||431||fffd|1 + ii - 3).Resize(, 4))
Cells(i, |fffd||431||fffd|per) = (Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) * (Cells(i, |fffd||fffd||fffd||7c21|) / Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|))) / (Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 3, |fffd||fffd||fffd||431||fffd|1 + ii) * 4)
Cells(i, pbr) = Cells(i, |fffd||fffd||fffd||7c21|) / Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 11, |fffd||fffd||fffd||431||fffd|1 + ii)
Cells(i, psr) = (Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) * (Cells(i, |fffd||fffd||fffd||7c21|) / Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 15, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|))) / Application.Sum(Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 1, |fffd||fffd||fffd||431||fffd|1 + ii - 3).Resize(, 4))
Cells(i, eps|fffd||fffd||22d|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 10, |fffd||3fa||431||fffd||fffd| + r).Value
End If


End If
r = r + 2

Next ii


Next i

Set C = Nothing


Columns(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "yyyy-mm-dd"


End Sub
Sub jlkjfkldajlkfjalkf()



 
 
 For i = 3 To Cells(Rows.Count, 1).End(3).Row
 Cells(i, 1) = Split(Cells(i, 1), "(")(0)
 Next i
 
 For i = 3 To Cells(Rows.Count, 1).End(3).Row
 Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Range("b1", Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Cells(Rows.Count, 2).End(3)).Find(Cells(i, 1), lookat:=xlWhole)
 
 If Not C Is Nothing Then
 Cells(i, 2) = Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Cells(C.Row, 3).Value
 End If
 
 Next i
 
 
 For i = 3 To Cells(Rows.Count, 1).End(3).Row
 
 Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)
 
 If Not C Is Nothing Then
 
 Cells(i, per) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 17, 8).Value
 Cells(i, pbr) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 18, 8).Value
 Cells(i, psr) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 21, 8).Value
 Cells(i, per|fffd||fffd||22d|) = 1 - Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 17, 17).Value
 Cells(i, eps|fffd||fffd||22d|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 10, 17).Value - 1
 End If
 
 Next i
 
 Set C = Nothing
 
 
  For i = 3 To Cells(Rows.Count, 1).End(3).Row
 
 Set C = Sheets("test2").Columns(2).Find(Cells(i, 1), lookat:=xlWhole)
 
 If Not C Is Nothing Then
 
 Cells(i, |fffd||fffd||fffd||fffd|).Resize(, 3) = Sheets("test2").Cells(C.Row, 24).Resize(, 3).Value
 Cells(i, |fffd||135||fffd||fffd||fffd|) = Sheets("test2").Cells(C.Row, 28).Value
 Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("test2").Cells(C.Row, 1).Value
 
 End If
 
 Next i
 
 Set C = Nothing
 
 
 
   End Sub

Sub |fffd||470||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|()


Dim C As Range
Dim Aa As Long
Dim Bb As Long
Dim CC As Long
Dim |fffd||5bc||fffd|1 As String
Dim |fffd||5bc||fffd|2 As String
Dim varTemp()


Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|").Activate

Set C = ActiveSheet.UsedRange.Find("|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", lookat:=xlWhole)

If Not C Is Nothing Then
Cells(C.Row, C.Column + 1).Resize(Cells(Rows.Count, 1).End(3).Row, 2000).Clear
End If


'|fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||9f2d| |fffd||5bc||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
For s = Sheets.Count To 1 Step -1

If Sheets(s).Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5bc||fffd|1 = "URL;http://hkconsensus.hankyung.com/apps.analysis/analysis.list?skinType=business&pagenum="
|fffd||5bc||fffd|2 = "analysis.list?skinType=business&pagenum="
End If

If Sheets(s).Name = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5bc||fffd|1 = "URL;http://hkconsensus.hankyung.com/apps.analysis/analysis.list?skinType=stock_good&up_down_type=1&pagenum="
|fffd||5bc||fffd|2 = "analysis.list?skinType=stock_good&up_down_type=1&pagenum="
End If


If Sheets(s).Name = "|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|" Then
|fffd||5bc||fffd|1 = "URL;http://hkconsensus.hankyung.com/apps.analysis/analysis.list?skinType=stock_good&up_down_type=2&pagenum="
|fffd||5bc||fffd|2 = "analysis.list?skinType=stock_good&up_down_type=2&pagenum="
End If

If Sheets(s).Name = "EPS|fffd||fffd||fffd||fffd|" Then
|fffd||5bc||fffd|1 = "URL;http://hkconsensus.hankyung.com/apps.analysis/analysis.list?skinType=stock_good&up_down_type=4&pagenum="
|fffd||5bc||fffd|2 = "analysis.list?skinType=stock_good&up_down_type=4&pagenum="
End If

If Sheets(s).Name = "|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||5bc||fffd|1 = "URL;http://hkconsensus.hankyung.com/apps.analysis/analysis.list?skinType=stock_bad&pagenum="
|fffd||5bc||fffd|2 = "analysis.list?skinType=stock_bad&pagenum="
End If

Sheets("|fffd||4fd||fffd|2").Activate
ActiveSheet.UsedRange.Delete

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Delete


Aa = 1 '|fffd||77a||fffd||23d||fffd||fffd|
Bb = 10 '|fffd||fffd||fffd||fffd||23d||fffd||fffd|
CC = 20 'page |fffd||fffd|


'|fffd||5bc||4bf||fffd| |fffd||fffd||fffd||fffd||fffd||3ff||fffd| data |fffd||7b1||fffd|
For i = Aa To Bb

With ActiveSheet.QueryTables.Add(Connection:=|fffd||5bc||fffd|1 & CC & "&order_type=&now_page=" & i, Destination:=Cells(Rows.Count, 1).End(3)(2))
        .Name = |fffd||5bc||fffd|2 & CC & "&order_type=&now_page=" & i
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
End With
       
Next i

'|fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||338||fffd| 6|fffd||fffd||fffd||fffd| |fffd||5b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 4|fffd||fffd||fffd||fffd| |fffd||171||fffd||fffd|
If Sheets(s).Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
Columns("F:F").Cut
Columns("D:D").Insert shift:=xlToRight
End If

    
'4|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
ActiveSheet.Cells.Sort key1:=Cells(1, 4), order1:=xlAscending

Range("a1", Cells(Rows.Count, 4).End(3).Offset(, 2)).Copy Sheets(s).Cells(Rows.Count, 1).End(3)(2)

'|fffd||470||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||1ae| |230||fffd||fffd||22d| |fffd||3f1||fffd|
Sheets(s).Activate

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlDescending '|fffd||6fc||fffd||fffd||3f7||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|

'head|fffd||33f||fffd| |fffd||6fc||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For i = 2 To 10
If Cells(i, 1) = "|fffd||6fc||fffd||fffd||fffd| " Then
Rows(i).Clear
End If
Next i

'|fffd||fffd||fffd||fffd|,|fffd||6fc||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||f3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 2) = Split(Cells(i, 2), "(")(0)
Next i

'|fffd||fffd||fffd||fffd|,|fffd||6fc||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||f3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 2), key2:=Cells(1, 1), key3:=Cells(1, 4), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


'|fffd||7fa||fffd| data |fffd||fffd||fffd||fffd|
For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1

If Cells(i, 1) = Cells(i - 1, 1) Then
If Cells(i, 2) = Cells(i - 1, 2) Then
If Cells(i, 4) = Cells(i - 1, 4) Then

Rows(i).Clear

End If
End If
End If

Next i


'|fffd||6fc||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||f3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, 4), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending

Range(Cells(Rows.Count, 1).End(3), Cells(Rows.Count, Columns.Count)).Delete '|fffd||fffd||12d||fffd||fffd| delete|fffd||3f1||fffd| |fffd||fffd||fffd||fffd| |fffd||6f0||fffd||fffd||3f1||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| exit |fffd||3f1||fffd|
If Sheets(s).Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
Exit For
End If

Next s

'|fffd||4fd||fffd| |fffd||fffd||1ae| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
Application.DisplayAlerts = False
Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Worksheets("|fffd||fffd||fffd||7b8||178||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"
Application.DisplayAlerts = True

Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|

Call |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|

End Sub


    

Sub sheet|fffd||fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False

On Error Resume Next

Application.DisplayAlerts = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Delete
Application.DisplayAlerts = True



    
End Sub

    

Sub |fffd||fffd||fffd||7b8||178||fffd||fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False

On Error Resume Next

Application.DisplayAlerts = False
Sheets("|fffd||fffd||fffd||7b8||178||17d||fffd||fffd||fffd|").Delete
Application.DisplayAlerts = True


    
End Sub


Sub |fffd||7f8||fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False
On Error Resume Next




ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, 6)

For a = Cells(Rows.Count, 1).End(3).Row To 2 Step -1

If Cells(a, 1) = Cells(a - 1, 1) Then
If Cells(a, 2) = Cells(a - 1, 2) Then
If Cells(a, 6) = Cells(a - 1, 6) Then

Rows(a).Clear

End If
End If
End If


Next a

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2), key3:=Cells(1, 6)


End Sub


Sub fjdlafjla()

Dim C As Range
Dim rngC As Range
Dim rngall As Range
Dim strAddr As String

Application.ScreenUpdating = False
On Error Resume Next




Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row


Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) = Cells(i, 1) Then
            If Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 4) = Cells(i, 4) Then
            Cells(i, 7).Resize(, 6) = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1).Resize(, 6).Value
            Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Rows(C.Row).Clear
            Exit Do
            
            End If
            End If
            
            
                Set C = Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
                If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Next i


Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)



Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row


Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) = Cells(i, 1) Then
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 4) = Cells(i, 4) Then
            Cells(i, 13).Resize(, 6) = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1).Resize(, 6).Value
            Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Rows(C.Row).Clear
            Exit Do
            
            End If
            End If
            
            
                Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
                If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Next i

Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)





Sheets("|fffd||fffd||fffd||fffd||fffd||1f0||7fb||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row


Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

strAddr = C.Address


            Do
            
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1) = Cells(i, 1) Then
            If Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 4) = Cells(i, 4) Then
            Cells(i, 7).Resize(, 6) = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Cells(C.Row, 1).Resize(, 6).Value
            Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Rows(C.Row).Clear
            Exit Do
            
            End If
            End If
            
            
                Set C = Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Columns(2).FindNext(C)     '|fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||378||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b0||fffd|
                If strAddr = C.Address Then Exit Do  '|fffd||5bc||4b0||fffd| |f3||fffd||fffd| |e3||fffd||fffd| |fffd||5bc||4bf||fffd| |fffd||fffd||121| |fffd||fffd| Do|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                
            Loop While Not C Is Nothing    '|fffd||fffd||121||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||77a||fffd|

End If


Next i


Sheets("EPS|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)


Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

Set C = Nothing




End Sub


Sub |fffd||fffd||fffd||fffd||5f4||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

On Error Resume Next

Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 3) = "|fffd||f0||fffd||fffd||47e||fffd|" Then
Cells(i, 8) = Cells(i - 13, 7) / Cells(i, 7)
Cells(i, 8).NumberFormatLocal = "0.##"
End If

Next i

End Sub



Sub |fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Dim C As Range

On Error Resume Next
Application.ScreenUpdating = False


Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 1) <> Cells(i - 1, 1) Then

Set C = Sheets("test").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)

If Not C Is Nothing Then
Cells(i + 2, 27).Resize(2, 100) = Sheets("test").Cells(C.Row + 2, 27).Resize(2, 100).Value
End If

End If

Next i

Set C = Nothing



End Sub



Sub fjdaklfjkajfkajfkajfklaj()

Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 2) = "" Then
If Cells(i, 7) <> "" Then

Cells(i, 2) = Cells(i, 8)

End If
End If


If Cells(i, 2) = "" Then
If Cells(i, 13) <> "" Then

Cells(i, 2) = Cells(i, 14)

End If
End If

Next i


End Sub

Sub |fffd||fffd||fffd||2c33||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Sheets("|fffd||fffd||1e5||fffd||5b0||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|)").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|" Then
|fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd| = i
End If

If Cells(1, i) = "EPS|fffd||fffd||fffd||2c33||fffd||fffd|" Then
eps|fffd||fffd||fffd||2c33||fffd||fffd| = i
End If

Next i



For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, 3) <> "" Then
Cells(i, |fffd||fffd||1e5||fffd||fffd||fffd||2c33||fffd||fffd|) = 1
End If


If Cells(i, 9) <> "" Then
Cells(i, |fffd||fffd||fffd||6bb||fffd||fffd||2c33||fffd||fffd|) = 1
End If

If Cells(i, 15) <> "" Then
Cells(i, eps|fffd||fffd||fffd||2c33||fffd||fffd|) = 1
End If

Next i


End Sub

Sub |fffd||fffd||fffd||7c21||fffd||fffd||fffd||fffd||fffd||fffd||1ae|()


Dim C As Range
Dim strAddr As String

On Error Resume Next
Application.ScreenUpdating = False


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 3 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Columns(2).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

strAddr = C.Address

Do

If Cells(i, 1) = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(C.Row, 1) Then
Cells(i, 3) = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Cells(C.Row, 5).Value

Exit Do

End If

Set C = Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Columns(2).FindNext(C)
If strAddr = C.Address Then Exit Do

Loop While Not C Is Nothing


End If

Next i

Set C = Nothing


End Sub


Sub |1e5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||ec78||fffd||3f1||fffd|()

Dim C As Range


On Error Resume Next
Application.ScreenUpdating = False


Sheets("|fffd||fffd||fffd||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i - 1, 1) <> Cells(i, 1) Then
If Cells(i, 3) = "|fffd||2d75|/|fffd||fffd|" Then

Cells(i, 9) = Application.StDev(Cells(i + 4, 11).Resize(, 4))


'Cells(i + 15, 8) = Application.StDev(Cells(i + 4, 4).Resize(, 4))
'Cells(i + 16, 8) = Application.StDev(Cells(i + 5, 4).Resize(, 4))

End If
End If

Next i


End Sub


Sub jljflkdjafkldja()



Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = 1 To Cells(2, Columns.Count).End(1).Column

If Cells(2, i) = "|fffd||fffd||fffd||377||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||377||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||377||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||377||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

For i = 3 To Cells(Rows.Count, 1).End(3).Row

Set C = Sheets("|fffd||fffd||fffd||fffd|").Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then

Cells(i, |fffd||fffd||fffd||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 15, 8).Value
Cells(i, |fffd||fffd||fffd||fffd||1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Sheets("|fffd||fffd||fffd||fffd|").Cells(C.Row + 16, 8).Value

End If

Next i

Set C = Nothing

End Sub

Sub |fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||121||e3||fffd||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim |fffd||fffd||fffd||fffd| As Long
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|4" Then
|fffd||fffd||fffd||431||fffd|4 = i
End If

If Cells(1, i) = "|fffd||337||fffd||fffd||431||fffd|" Then
|fffd||337||fffd||fffd||431||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If

If Cells(1, i) = "4|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
 
 
Next i
 
 

For i = 2 To Cells(Rows.Count, 1).End(3).Row




'---|fffd||fffd||fffd||7c21| 2016|fffd||fffd| |22e||fffd||fffd||fffd||233||fffd||fffd| |fffd||fffd||fffd||6b8||fffd||fffd||fffd| |fffd||171||fffd||fffd|

If Cells(i, |fffd||67d||fffd|) = "|fffd||2d75|/|fffd||fffd|" Then
If Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "2017.12(E)" Or Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "2017.03(E)" _
Or Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "2017.06(E)" Or Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "2017.09(E)" _
Or Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "2017.11(E)" Or Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = "2017.08(E)" Then

Cells(i, |fffd||fffd||f5||fffd||2bb||fffd||fffd|).Resize(22, 4).Copy Cells(i, |fffd||fffd||f5||fffd||2bb||fffd||fffd|)
Cells(i, |fffd||fffd||f5||fffd||2bb||fffd||fffd|).Resize(22).Clear

End If
End If


'---|fffd||431||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd||fffd||fffd| |fffd||171||fffd||fffd|

If Cells(i, |fffd||67d||fffd|) = "|fffd||2d75|/|fffd||fffd|" Then
If Cells(i, |fffd||fffd||fffd||431||fffd|3) = "2017.03(E)" Or Cells(i, |fffd||fffd||fffd||431||fffd|3) = "2017.06(E)" Then

Cells(i, |fffd||6f3||fffd||431||fffd|1).Resize(24, 8).Copy Cells(i, |fffd||6f3||fffd||431||fffd|3)
Cells(i, |fffd||6f3||fffd||431||fffd|1).Resize(24, 2).Clear

End If
End If


If Cells(i, |fffd||67d||fffd|) = "|fffd||2d75|/|fffd||fffd|" Then
If Cells(i, |fffd||fffd||fffd||431||fffd|3) = "2016.12(E)" Then

Cells(i, |fffd||6f3||fffd||431||fffd|1).Resize(24, 8).Copy Cells(i, |fffd||6f3||fffd||431||fffd|2)
Cells(i, |fffd||6f3||fffd||431||fffd|1).Resize(24).Clear

End If
End If



Next i

 
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

Dim C As Range

On Error Resume Next
Application.ScreenUpdating = False

Sheets("|fffd||fffd||fffd||fffd|").Activate


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i - 1, 1) <> Cells(i, 1) Then

Set C = Sheets("test").Columns(1).Find(Cells(i, 1), lookat:=xlWhole)

If Not C Is Nothing Then
If Sheets("test").Cells(C.Row, 10) = "2015.09" Then

Cells(i, 11).Resize(24) = Sheets("test").Cells(C.Row, 10).Resize(24).Value

End If
End If

End If

Next i

Set C = Nothing




End Sub


Sub |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|1|fffd||431||fffd||fffd||fffd||fffd|update|fffd||3f1||fffd|()


Dim C As Range

On Error Resume Next
Application.ScreenUpdating = False

Sheets("|fffd||fffd||fffd||fffd|").Activate


For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2013" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If


If Cells(1, i) = "2014" Then
|fffd||fffd||f5||fffd||2bb||fffd||fffd| = i
End If

If Cells(1, i) = "2015" Then
|fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016e" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2017e" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|1" Then
|fffd||6f3||fffd||431||fffd|1 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|2" Then
|fffd||6f3||fffd||431||fffd|2 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|3" Then
|fffd||6f3||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||6f3||fffd||431||fffd|4" Then
|fffd||6f3||fffd||431||fffd|4 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|1" Then
|fffd||fffd||fffd||431||fffd|1 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|2" Then
|fffd||fffd||fffd||431||fffd|2 = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|3" Then
|fffd||fffd||fffd||431||fffd|3 = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd|4" Then
|fffd||fffd||fffd||431||fffd|4 = i
End If

If Cells(1, i) = "|fffd||337||fffd||fffd||431||fffd|" Then
|fffd||337||fffd||fffd||431||fffd| = i
End If
  
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "1|fffd||431||fffd||fffd|" Then
|fffd||3fa||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||431||fffd||fffd|" Then
|fffd||33a||431||fffd||fffd| = i
End If
  
If Cells(1, i) = "3|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If

If Cells(1, i) = "4|fffd||431||fffd||fffd|" Then
|fffd||fffd||431||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "2017 |fffd||fffd||22d||fffd||fffd|" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||2eaf||22d||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||431||2eaf||22d||fffd||fffd|" Then
|fffd||431||2eaf||22d||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "PreSurprise" Then
presurprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||121|" Then
|fffd||fffd||fffd||fffd||121| = i
End If

If Cells(1, i) = "Surprise" Then
surprise = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||2d7f||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||431||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||431||fffd||fffd||fffd| = i
End If
 
 
 
Next i
 


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||67d||fffd|) = "|fffd||2d75|/|fffd||fffd|" Then
If Cells(i, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) = "2015.12" Then
If Cells(i, |fffd||6f3||fffd||431||fffd|2) = "2015.06" Then

Cells(i, |fffd||6f3||fffd||431||fffd|1) = "2015.03"
Cells(i + 1, |fffd||6f3||fffd||431||fffd|1) = Cells(i + 1, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) - Application.Sum(Cells(i + 1, |fffd||6f3||fffd||431||fffd|2).Resize(, 3))
Cells(i + 2, |fffd||6f3||fffd||431||fffd|1) = Cells(i + 2, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) - Application.Sum(Cells(i + 2, |fffd||6f3||fffd||431||fffd|2).Resize(, 3))
Cells(i + 3, |fffd||6f3||fffd||431||fffd|1) = Cells(i + 3, |fffd||fffd||f5||fffd||2bf||fffd||fffd||fffd|) - Application.Sum(Cells(i + 3, |fffd||6f3||fffd||431||fffd|2).Resize(, 3))
Cells(i + 4, |fffd||6f3||fffd||431||fffd|1) = (Cells(i + 2, |fffd||6f3||fffd||431||fffd|1) / Cells(i + 1, |fffd||6f3||fffd||431||fffd|1)) * 100
Cells(i + 4, |fffd||6f3||fffd||431||fffd|1).NumberFormatLocal = "#.00"
Cells(i + 5, |fffd||6f3||fffd||431||fffd|1) = (Cells(i + 3, |fffd||6f3||fffd||431||fffd|1) / Cells(i + 1, |fffd||6f3||fffd||431||fffd|1)) * 100
Cells(i + 5, |fffd||6f3||fffd||431||fffd|1).NumberFormatLocal = "#.00"
Cells(i + 10, |fffd||6f3||fffd||431||fffd|1) = Cells(i + 3, |fffd||6f3||fffd||431||fffd|1) / (Cells(i + 3, |fffd||6f3||fffd||431||fffd|2) / Cells(i + 10, |fffd||6f3||fffd||431||fffd|2))
Cells(i + 10, |fffd||6f3||fffd||431||fffd|1).NumberFormatLocal = "#,###"

End If
End If
End If

Next i


End Sub


Sub |fffd||5b4||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3b9||fffd||fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Dim varTemp()
Dim var()

On Error Resume Next
Application.ScreenUpdating = False


Sheets("|fffd||fffd||1ae||fffd||43c||fffd|").Activate

r = 0
rr = 0

Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||a5|", "|fffd||fffd||fffd||fffd|")

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If

Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||a5|), key3:=Cells(1, |fffd||fffd||fffd||fffd|)

D = 0.4

For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i - 1, |fffd||fffd||fffd||fffd|) <> Cells(i, |fffd||fffd||fffd||fffd|) Then

For ii = 0 To 100000

If Cells(i + ii, |fffd||135||fffd||fffd||fffd|).Value > D Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i + ii, 1).Resize(, 100)

D = Cells(i + ii, |fffd||135||fffd||fffd||fffd|).Value + 0.2

If D > 1.6 Then
D = 0.4
Exit For
End If

If Cells(i + ii, |fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd|) Then
D = 0.4
Exit For
End If

End If

If Cells(i + ii, |fffd||fffd||fffd||fffd|) <> Cells(i + ii + 1, |fffd||fffd||fffd||fffd|) Then
D = 0.4
Exit For
End If

Next ii

End If

Next i

ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 100) = varTemp(i)
Next i

r = 0
Erase varTemp


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||a5|)


Range(Cells(Rows.Count, 1).End(3)(2), Cells(Cells(Rows.Count, 1).Row, Cells(1, Columns.Count).Column)).Delete


End Sub


Sub |fffd||fffd||fffd||fffd||fffd||6b5||fffd|update()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next
 

   
'|fffd||fffd||fffd||fffd||fffd||6b5||5fe1||fffd||fffd| |fffd||7fa||fffd| & |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||ec23| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate

For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 3) = "http://finance.naver.com/item/coinfo.nhn?code=" & Cells(i, 1)

If Right(Cells(i, 2), 1) = "|fffd||fffd|" Or Right(Cells(i, 2), 2) = "|fffd||fffd|B" Then
Rows(i).Clear
End If

If InStr(Cells(i, 2), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete '|fffd||fffd||12d||fffd||fffd| delete|fffd||3f1||fffd| |fffd||fffd||fffd||fffd| |fffd||6f0||fffd||fffd||3f1||fffd|


'|fffd||33a||437||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|


For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "http" Then
http = i
End If


Next i

ThisWorkbook.Save


End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7e6b||fffd||fffd||121||fffd||fffd||121||22d|()

Application.ScreenUpdating = False
On Error Resume Next

'head
For i = 1 To Cells(1, Columns.Count).End(1).Column
If Cells(1, i) = "|fffd||67d||fffd|" Then
|fffd||67d||fffd| = i
End If

If Cells(1, i) = "2016" Then
|fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2017" Then
|fffd||fffd||f5||fffd||fffd||125||fffd||fffd| = i
End If

Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||121| |fffd||fffd||fffd|
For i = 2 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||67d||fffd|) = "PER" Then
Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 2, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i - 7, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Cells(i - 2, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i - 7, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)
Cells(i + 1, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 2, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i - 6, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i + 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Cells(i - 2, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i - 6, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)
Cells(i + 4, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i - 16, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i + 4, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) = Cells(i - 1, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|) / Cells(i - 16, |fffd||fffd||f5||fffd||fffd||125||fffd||fffd|)

Cells(i, |fffd||fffd||f5||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(2, 5).NumberFormatLocal = "0.00"

End If
Next i



End Sub

Sub data|fffd||fffd|delete|fffd||fffd||fffd||fffd||fffd||fffd||fffd|()


Application.ScreenUpdating = False
On Error Resume Next


For a = 1 To Sheets.Count

If InStr(Sheets(a).Name, "|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|") Or InStr(Sheets(a).Name, "|fffd||fffd||1ae||fffd||43c||fffd|") Or InStr(Sheets(a).Name, "|fffd||17c||fffd||fffd||fffd||fffd||fffd|") Then

Sheets(a).Activate

If ActiveSheet.AutoFilterMode Then
ActiveSheet.UsedRange.AutoFilter
End If


Range("a3", Cells(Rows.Count, Columns.Count)).Delete shift:=xlUp

End If

Next a



End Sub

Sub |fffd||4fd||fd||fffd||1ae||fffd||fffd||fffd||335||fffd||fffd||3f1||fffd|()



Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear


ActiveSheet.PasteSpecial Format:="|fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||63d||fffd||1ae|", Link:=False, DisplayAsIcon:=False

Cells(1, 1) = Cells.Find("[|fffd||fffd| ", lookat:=xlPart)

Cells(2, 1) = Split(Split(Cells(1, 1), "]")(0), "/")(1)
Cells(3, 1) = Split(Split(Cells(1, 1), "|fffd||fffd| ")(1), "|fffd||fffd|")(0)

Cells(2, 1).Select


End Sub


Sub |fffd||4fd||fd||fffd||1ae||fffd||fffd||fffd||335||fffd||fffd||3f1||fffd|2()



Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear


ActiveSheet.PasteSpecial Format:="|fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||63d||fffd||1ae|", Link:=False, DisplayAsIcon:=False

Cells(1, 1) = Cells.Find("[|fffd||fffd| ", lookat:=xlPart)

Cells(2, 1) = Split(Split(Cells(1, 1), "]")(0), "/")(1)
Cells(3, 1) = Split(Split(Cells(1, 1), "|fffd||fffd| ")(1), "|fffd||fffd|")(0)
Cells(4, 1) = Application.RoundDown(Split(Split(Cells(1, 1), "/")(0), "[")(1), -1)
Cells(5, 1) = Split(Split(Cells(1, 1), "/")(0), "[")(1) - Cells(4, 1)
Cells(2, 1) = Cells(2, 1) - Cells(4, 1) - Cells(5, 1)
Cells(3, 1) = Cells(3, 1) - (Cells(4, 1) + Cells(5, 1)) * 15
Cells(5, 1) = Cells(5, 1) - 1
Cells(2, 1).Select


End Sub

Sub |fffd||7e6b||fffd||5bc||fffd|update()

Application.ScreenUpdating = False
On Error Resume Next

Sheets("|fffd||4fd||fffd|").Activate
Cells(1, 1).Resize(Cells(Rows.Count, 1).End(3).Row).Copy Sheets("|fffd||7e6b||fffd||5bc||fffd|").Cells(Rows.Count, 1).End(3)(2)

Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Activate

End Sub

Sub |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||57a||fffd||fffd||fffd|()


Dim varTemp()


Application.ScreenUpdating = False
On Error Resume Next


Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)



For i = 3 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> Cells(i + 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) <> Cells(i + 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) _
And Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) <> Cells(i + 1, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) Then
If Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) > 1000 Then 'And Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) > Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) * 1.8 Then
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.7 And Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd||fffd||fffd|) > 0.05 Then
'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) < 10 Then
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 0.05 Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 200)

End If
End If
End If
End If


Next i

ActiveSheet.UsedRange.Offset(2).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 2, 1).Resize(, 100) = varTemp(i)
Next i

Erase varTemp
r = 0

Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "hh:mm:ss"




End Sub


Sub |fffd||fffd||fffd||fffd||fffd||47c||fffd||fffd||fffd||fffd||13a||43a||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||3f1||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 
 
 
 
      'With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
'.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
'If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 '
  '          Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
   '     Else
 
 
'strPath = .SelectedItems(1) & "\"       '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\5|fffd||fffd||fffd||fffd|(171123)\"
    '    End If
 
 
'    End With
 
'fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 '   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 '       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
   
   
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate



For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then

Rows(i).Clear

End If
End If

Next i



ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)



Cells(3, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row, 100).Clear



'|fffd||4fd||ff||fffd| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If

End If

Next a

End With


ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
  
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
Next i



ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
Set C = Columns(1).Find(.Cells(a, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then

If C.Row > 300 Then
pp = C.Row - 300

Else

pp = 12

End If


For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
 
Else
 
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
 
End If
 
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)

Next i
 
 
 
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Application.Max(Cells(i - 24, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(25)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Min(Cells(i - 24, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(25)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
End If
 
Next i
 
 
Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = Split(newName, "(")(0)
 
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
End If

Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(4).End(4) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 1
 
 
Next i
 
End If

Set C = Nothing

 

 yy = 9
 .Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy).NumberFormatLocal = "h:mm:ss"

For Aa = 0 To 1000

Set C = Columns(1).Find(.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then


If C.Row > 300 Then
pp = C.Row
Else
pp = 12
End If

For i = C.Row + 1 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 2) = .Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then
ccc = Cells(i, 2).Row
Exit For
End If
Next i


For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(i - 350, |fffd||3f6||fffd||fffd||135||fffd|).Resize(350))
Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) - 1
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i - 100, |fffd||3f6||fffd||fffd||135||fffd|).Resize(100))
End If

Next i
 
 


For i = ccc To ccc + 3000

If Cells(i, |fffd||135||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||135||fffd||fffd||fffd|) > 0 Then
If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) < 1 Then

.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, 1).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(i, 2).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|).Value
.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||135||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| + yy) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1

p = 0

For t = 0.01 To 0.05 Step 0.005

For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 500

If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
Exit For
End If

If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
Exit For
End If

Next ii

p = p + 1

Next t

Exit For
End If
End If




If Cells(i, 2) < Cells(i - 1, 2) Then
rr = rr + 1
End If

If rr = 3 Then
rr = 0
Exit For
End If

Next i

rr = 0


If .Cells(a + Aa, 2) <> .Cells(a + Aa + 1, 2) Then
Exit For
End If

End If


Next Aa

Workbooks(newName).Close False
 
End If
End If

Next a

End With

Set C = Nothing

ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then

Rows(i).Clear

End If
End If

Next i



ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|)


 
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 

End Sub



Sub |fffd||43a||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||3f1||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim D As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 
 
 
 
    With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
'If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 '
  '          Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
   '     Else
 
 
strPath = .SelectedItems(1) & "\"       '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'  strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\5|fffd||fffd||fffd||fffd|(171123)\"
    '    End If
 
 
    End With
 
'fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 '   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 '       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
   
   
   
   
   
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate



For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77a||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77a||71cfb||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||3fb||fffd| = i
End If

Next i


'|fffd||fffd||fffd||fffd|,|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|)

Range(Cells(Rows.Count, 1).End(3)(2).Row, Cells(Rows.Count, Columns.Count)).Delete



'|fffd||4fd||ff||fffd| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear


'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If

End If

Next a

End With

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")

'|fffd||4fd||ff||fffd| head |fffd||5b1||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
Next i

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d|
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

'If .Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)

'|fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

'head |fffd||7f0||fffd||fffd||3f0||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
'For i = 2 To Cells(Rows.Count, 1).End(3).Row
'If Cells(i, 1) = .Cells(a, |fffd||fffd||a5|) Then
'If C.Row > 300 Then
'pp = C.Row - 300
'Else
pp = 12
'End If
'Exit For
'End If
'Next i

'|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
Else
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
Else
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
End If
 
Next i
 
 
'|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Application.Max(Cells(i - 24, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(25)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Min(Cells(i - 24, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(25)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
End If
 
Next i


 
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||3f6||fffd||fffd| |fffd||3f8||fffd| |fffd||3f6||fffd||fffd||135||fffd|,|fffd||fffd||fffd||fffd||135||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||43a||fffd||fffd||fffd| |fffd||fffd||fffd||474||fffd|
Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = Split(newName, "(")(0)
 
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
End If

Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(4).End(4) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 1
  
Next i
 
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|,|fffd||135||fffd||fffd||fffd|,|1e5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||474||fffd|
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(i - 350, |fffd||3f6||fffd||fffd||135||fffd|).Resize(350))
Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) - 1
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i - 100, |fffd||3f6||fffd||fffd||135||fffd|).Resize(100))
End If

Next i


.Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "h:mm:ss"

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||7f87c||fffd| for next|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1f2d| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For Aa = 0 To 300
 yy = 0
 rr = 0
 
 
 
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3fa||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||43a||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||678||fffd| |fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||a5||fffd||fffd| |e3||fffd||fffd|
Set CC = Columns(1).Find(.Cells(a + Aa, |fffd||fffd||a5|), lookat:=xlWhole)

'|fffd||fffd||fffd||fffd| |fffd||5b4||678||fffd|
If Not CC Is Nothing Then

'|fffd||43a||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||3fa||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |169||fffd||fffd| |fffd||1f4||fffd| |fffd||fffd||a5||fffd||fffd| |e3||fffd||fffd|
For i = CC.Row To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) > .Cells(a + Aa, |fffd||fffd||a5|) Then
ccc = Cells(i, 1).Row
Exit For
End If
Next i


'|fffd||5f3||fffd||fffd||fffd||fffd||fffd| 3000|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d|
For i = ccc To ccc + 3000

'|fffd||135||fffd||fffd||71cf0||fffd| |fffd||fffd||fffd||fffd| |fffd||5b0||fffd| -0.2|fffd||fffd||fffd||fffd| |16b||fffd||fffd| |fffd||7ff||fffd||fffd||fffd| |fffd||136||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Cells(i, |fffd||135||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||135||fffd||fffd||fffd|) > -0.2 Then
If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) < 1 Then

'|fffd||3f6||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||f0||fffd| |fffd||177||fffd||fffd||fffd||775||fffd||fffd||fffd| update |fffd||474||fffd|
.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, 1).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(i, 2).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Application.Average(Cells(i - 10, |fffd||177||fffd||fffd||fffd||fffd|).Resize(10))
.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|).Value
.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||135||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| + yy) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||77a||fffd||fffd||fffd| + yy) = .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) / .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy)

'.Cells(a + Aa, |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033


p = 0
t = 0.025
tt = 0.025

'|fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||77a||fffd||fffd||63c||fffd| +-2.5% |fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||fffd||fffd||63c||fffd| |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd| update |fffd||474||fffd|

'For t = 0.01 To 0.02 Step 0.005
For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 3500
oo = oo + 1

If Cells(ii, |fffd||fffd||fffd||fffd|) <> "" And Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -t Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -t
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -t
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = oo
oo = 0
Exit For
End If

If Cells(ii, |fffd||fffd||fffd||fffd|) <> "" And Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > tt Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = tt
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = tt
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = oo
oo = 0
Exit For
End If


Next ii
oo = 0
'p = p + 1

'Next t

'For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 500

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
'Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
'Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
'Exit For
'End If

'Next ii



'p = 0
'yy = 12


'For u = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 100

'If Cells(u, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||f0||fffd|) > 1 Then

'.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u, 1).Value
'.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(u, 2).Value
'.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Application.Average(Cells(u - 10, |fffd||177||fffd||fffd||fffd||fffd|).Resize(10))
'.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(u, |fffd||3f6||fffd||fffd||135||fffd|).Value
'.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u, |fffd||135||fffd||fffd||fffd|).Value
'.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u, |fffd||177||fffd||fffd||fffd||fffd|).Value
'.Cells(a + Aa, |fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| + yy) = Cells(u, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||f0||fffd|) - 1
'.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||77a||fffd||fffd||fffd| + yy) = .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) / .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy)
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u + 1, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033

'For t = 0.01 To 0.02 Step 0.005

'For ii = Cells(u, 1).Row + 1 To Cells(u, 1).Row + 500

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
'.Cells(a + Aa, |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
'.Cells(a + Aa, |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
'Exit For
'End If

'Next ii

'p = p + 1

'Next t
'p = 0


'For ii = Cells(u, 1).Row + 1 To Cells(u, 1).Row + 500

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
'Exit For
'End If


'Next ii



'Exit For
'End If
'Next u



Exit For
End If
End If


If Cells(i, 2) <> "" And Cells(i, 2) < Cells(i - 1, 2) Then
rr = rr + 1
End If

If rr = 3 Then
rr = 0
Exit For
End If

Next i



rr = 0

End If

Set CC = Nothing



If .Cells(a + Aa, 2) <> .Cells(a + Aa + 1, 2) Then
Exit For
End If


Next Aa

Workbooks(newName).Close False
 
End If
End If

Next a

End With

Set C = Nothing

ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)

'For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

'If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
'If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then

'Rows(i).Clear

'End If
'End If

'Next i



'ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|)

Columns(|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "#,###"
Columns(|fffd||177||fffd||fffd||fffd||77b||fffd||fffd||fffd||fffd|).NumberFormatLocal = "#,###"
Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "hh:mm:ss"

ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 

End Sub



Sub |fffd||5b5||fffd||fffd||5b3||ee32||fffd||fffd|_|fffd||43a||fffd||fffd||135||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim D As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 

  
 '|fffd||fffd||fffd||7b8||178||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||3fa||fffd| |fffd||5b5||fffd||fffd||5b8||fffd| |fffd||330||fffd|
 '5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| |fffd||73a||fffd||fffd||135||fffd| |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||330||fffd|
 '|fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||57d||1f7||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||474||fffd|
 
 
 
 
 
    With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
'If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 '
  '          Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
   '     Else
 
 
strPath = .SelectedItems(1) & "\"       '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'  strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\5|fffd||fffd||fffd||fffd|(171123)\"
    '    End If
 
 
    End With
 
'fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 '   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 '       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
   
   
   
   
   
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate



For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77a||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73b||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||73b||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||135||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||77a||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77a||71cfb||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||3fb||fffd| = i
End If

Next i


'|fffd||fffd||fffd||fffd|,|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f1||fffd|
ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|)

Range(Cells(3, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), Cells(Rows.Count, Columns.Count)).Clear
Range(Cells(Rows.Count, 1).End(3)(2).Row, Cells(Rows.Count, Columns.Count)).Delete




'|fffd||4fd||ff||fffd| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear


'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).xlsx"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If

End If

Next a

End With

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 14) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||73b||fffd||fffd||135||fffd|", "|fffd||73a||fffd||fffd||135||fffd|", "|fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||73a||fffd||fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")

'|fffd||4fd||ff||fffd| head |fffd||5b1||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||73b||fffd||fffd||135||fffd|" Then
|fffd||73b||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||73a||fffd||fffd||135||fffd|" Then
|fffd||73a||fffd||fffd||135||fffd| = i
End If

If Cells(1, i) = "|fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If

If Cells(1, i) = "|fffd||73a||fffd||fffd||135||fffd||fffd||fffd|" Then
|fffd||73a||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
Next i

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d|
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

'If .Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).xlsx"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)

'|fffd||fffd||a5||fffd||fffd| |fffd||f0||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd|
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

'head |fffd||7f0||fffd||fffd||3f0||fffd|
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 14) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||73b||fffd||fffd||135||fffd|", "|fffd||73a||fffd||fffd||135||fffd|", "|fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||73a||fffd||fffd||135||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
Set C = Columns(1).Find(.Cells(a, 1), lookat:=xlWhole)
 
If Not C Is Nothing Then
pp = C.Row - 350
Else
pp = 12
End If
  
 
 
 
'For i = 2 To Cells(Rows.Count, 1).End(3).Row
'If Cells(i, 1) = .Cells(a, |fffd||fffd||a5|) Then
'If C.Row > 300 Then
'pp = C.Row - 300
'Else
'pp = 12
'End If
'Exit For
'End If
'Next i

'|fffd||fffd||fffd||3f0||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
Else
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
Else
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
End If
 
Next i
 
 
'|fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f0||fffd|
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Application.Max(Cells(i - 34, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(35)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Min(Cells(i - 34, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(35)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
End If
 
Next i


 
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||3f6||fffd||fffd| |fffd||3f8||fffd| |fffd||3f6||fffd||fffd||135||fffd|,|fffd||fffd||fffd||fffd||135||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||43a||fffd||fffd||fffd| |fffd||fffd||fffd||474||fffd|
Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = Split(newName, "(")(0)
 
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) >= 4 Then
Cells(i, |fffd||73a||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1
End If
End If

Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(4).End(4) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 1
  
Next i
 
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||678||fffd| |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|,|fffd||135||fffd||fffd||fffd|,|1e5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||474||fffd|
For i = pp To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(i - 350, |fffd||3f6||fffd||fffd||135||fffd|).Resize(350))
Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) - 1
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(i - 100, |fffd||3f6||fffd||fffd||135||fffd|).Resize(100))
Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(i - 350, |fffd||73a||fffd||fffd||135||fffd|).Resize(350))
If Cells(i, |fffd||73a||fffd||fffd||135||fffd|) <> "" Then
Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||73a||fffd||fffd||135||fffd|) / Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|) - 1
End If
End If

Next i




.Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "h:mm:ss"

'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||7f87c||fffd| for next|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1f2d| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For Aa = 0 To 300
 yy = 0
 rr = 0
 k = 0
 
 
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||3fa||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||43a||fffd||fffd||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||678||fffd| |fffd||43a||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||a5||fffd||fffd| |e3||fffd||fffd|
Set CC = Columns(1).Find(.Cells(a + Aa, |fffd||fffd||a5|), lookat:=xlWhole)

'|fffd||fffd||fffd||fffd| |fffd||5b4||678||fffd|
If Not CC Is Nothing Then

'|fffd||43a||fffd| |fffd||fffd||a5||fffd||fffd| |fffd||3fa||fffd| |fffd||fffd||a5||fffd||fffd||fffd||fffd| |169||fffd||fffd| |fffd||1f4||fffd| |fffd||fffd||a5||fffd||fffd| |e3||fffd||fffd|
For i = CC.Row To Cells(Rows.Count, 1).End(3).Row
If Cells(i, 1) > .Cells(a + Aa, |fffd||fffd||a5|) Then
ccc = Cells(i, 1).Row
Exit For
End If
Next i


'|fffd||5f3||fffd||fffd||fffd||fffd||fffd| 3000|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||9f2d|
For i = ccc To ccc + 3000

'|fffd||135||fffd||fffd||71cf0||fffd| |fffd||fffd||fffd||fffd| |fffd||5b0||fffd| -0.2|fffd||fffd||fffd||fffd| |16b||fffd||fffd| |fffd||7ff||fffd||fffd||fffd| |fffd||136||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
If Cells(i, |fffd||135||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||135||fffd||fffd||fffd|) > -0.3 Then
If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) < 1 Then
If Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||fffd|) > -0.05 Then

For w = Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row + 1 To Cells(i, |fffd||fffd||fffd||fffd|).Row - 1
If Application.Max(Cells(w + 1, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - w)) / Cells(w, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 1 > 0.04 Then
Cells(i, |fffd||73b||fffd||fffd||135||fffd|) = Application.Max(Cells(w + 1, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(Cells(i, |fffd||fffd||fffd||fffd|).Row - w)) / Cells(w, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 1
Exit For
End If
Next w

'If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) <= 15 Then
If Cells(i, |fffd||73b||fffd||fffd||135||fffd|) = "" Then

'|fffd||3f6||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||a5| |fffd||f0||fffd| |fffd||177||fffd||fffd||fffd||775||fffd||fffd||fffd| update |fffd||474||fffd|
.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, 1).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(i, 2).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Application.Average(Cells(i - 10, |fffd||177||fffd||fffd||fffd||fffd|).Resize(10))
.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|).Value
.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||135||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||73a||fffd||fffd||135||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd||fffd||fffd| + yy) = Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||5b4||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||73a||fffd||fffd||135||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||77a||fffd||fffd||fffd| + yy) = .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) / .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy)
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||73b||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||73b||fffd||fffd||135||fffd|).Value

'.Cells(a + Aa, |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 1, |fffd||fffd||fffd||fffd|) / Cells(i + 1, |fffd||f0||fffd|) - 1.0033


p = 0
t = 0.05
tt = 0.05

'|fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||77a||fffd||fffd||63c||fffd| +-2.5% |fffd||fffd||fffd||377||fffd||fffd||fffd| |fffd||fffd||fffd||63c||fffd| |fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||fffd| update |fffd||474||fffd|

'For t = 0.01 To 0.02 Step 0.005
For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 3500
oo = oo + 1

If Cells(ii, |fffd||fffd||fffd||fffd|) <> "" And Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -t Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -t
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -t
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = oo
oo = 0
Exit For
End If

If Cells(ii, |fffd||fffd||fffd||fffd|) <> "" And Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > tt Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = tt
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = tt
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = oo
oo = 0
Exit For
End If


Next ii
oo = 0
'p = p + 1

'Next t

'For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 500

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
'Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
'Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
'Exit For
'End If

'Next ii



'p = 0
'yy = 12


'For u = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 100

'If Cells(u, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||f0||fffd|) > 1 Then

'.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u, 1).Value
'.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(u, 2).Value
'.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Application.Average(Cells(u - 10, |fffd||177||fffd||fffd||fffd||fffd|).Resize(10))
'.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(u, |fffd||3f6||fffd||fffd||135||fffd|).Value
'.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u, |fffd||135||fffd||fffd||fffd|).Value
'.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u, |fffd||177||fffd||fffd||fffd||fffd|).Value
'.Cells(a + Aa, |fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| + yy) = Cells(u, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||f0||fffd|) - 1
'.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||77a||fffd||fffd||fffd| + yy) = .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) / .Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy)
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(u + 1, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033

'For t = 0.01 To 0.02 Step 0.005

'For ii = Cells(u, 1).Row + 1 To Cells(u, 1).Row + 500

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
'.Cells(a + Aa, |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
'.Cells(a + Aa, |fffd||fffd||fffd||370||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
'Exit For
'End If

'Next ii

'p = p + 1

'Next t
'p = 0


'For ii = Cells(u, 1).Row + 1 To Cells(u, 1).Row + 500

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.01 - t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.01 - t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = -0.01 - t
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(u, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.01 + t Then
'Cells(u, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.01 + t
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy + p) = 0.01 + t
'Exit For
'End If


'Next ii



'Exit For
'End If
'Next u



Exit For
'End If
End If
End If
End If
End If

k = 0


If Cells(i, 2) <> "" And Cells(i, 2) < Cells(i - 1, 2) Then
rr = rr + 1
End If

If rr = 5 Then
rr = 0
Exit For
End If

Next i



rr = 0

End If

Set CC = Nothing



If .Cells(a + Aa, 2) <> .Cells(a + Aa + 1, 2) Then
Exit For
End If


Next Aa

Workbooks(newName).Close False
 
End If
End If

Next a

End With

Set C = Nothing

ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key3:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)

'For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

'If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
'If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then

'Rows(i).Clear

'End If
'End If

'Next i



'ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|)

Columns(|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).NumberFormatLocal = "#,###"
Columns(|fffd||177||fffd||fffd||fffd||77b||fffd||fffd||fffd||fffd|).NumberFormatLocal = "#,###"
Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "hh:mm:ss"

ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 

End Sub
Sub |fffd||43a||fffd||fffd||135||fffd||fffd||fffd||fffd||5b4||b3||fffd||9e38||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()
 
 

 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
Application.ScreenUpdating = False
On Error Resume Next

 
 
'Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate



For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(2, |fffd||fffd||fffd||fffd|), _
order1:=xlDescending, order2:=xlDescending, order3:=xlDescending


For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = "" Then

Rows(i).Clear

End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(2, |fffd||fffd||fffd||fffd|), _
order1:=xlDescending, order2:=xlDescending, order3:=xlDescending

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) Then
If Cells(i, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) = Cells(i - 1, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then


Rows(i).Clear

End If
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|), key3:=Cells(2, |fffd||fffd||fffd||fffd|), _
order1:=xlAscending, order2:=xlAscending, order3:=xlAscending


 
'ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 

End Sub

Sub |fffd||43a||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||b3||fffd||9e38||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()
 
  
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
Application.ScreenUpdating = False
On Error Resume Next

 
 
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

Cells(2, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1).Resize(, 100).Clear


For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

If Cells(2, i) = "|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||a5|), key2:=Cells(2, |fffd||fffd||fffd||fffd|), order1:=xlDescending, order2:=xlDescending

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||fffd||a5|) < Cells(1, |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
Exit For
End If
Next i

Range(Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||a5|), Cells(Rows.Count, Columns.Count)).Delete

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" Then
Rows(i).Clear
End If
Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||a5|), order1:=xlDescending, order2:=xlDescending

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
Rows(i).Clear
End If

Next i

For i = Cells(Rows.Count, 1).End(3).Row To 3 Step -1

If Cells(i, |fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
Rows(i).Clear
End If

Next i



ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||a5|), key2:=Cells(2, |fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending


 

End Sub





Sub |fffd||2bf||fffd||fffd||43a||fffd||fffd||135||fffd||fffd||fffd||fffd||3b8||17c||fffd||fffd||3f1||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 
 
 
 
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
strPath = .SelectedItems(1) & "\"       '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
'fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 '   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 '       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
   
   
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 2), key2:=Cells(2, 1)

For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

Next i


Range(Cells(3, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), Cells(Cells(Rows.Count, 1).End(3).Row, 300)).Clear




'|fffd||4fd||ff||fffd| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If

End If

Next a

End With


ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
Next i



ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||f0||fffd|) >= Cells(i, |fffd||fffd||fffd||fffd|) Then
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||f0||fffd|)
 
Else
 
Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
 
End If
 
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)

Next i
 
 
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|) = Application.Max(Cells(i - 24, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|).Resize(25)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||3f0||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Min(Cells(i - 24, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|).Resize(25)) Then
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
End If
 
Next i
 
 
Cells(2, |fffd||fffd||fffd|).Resize(Cells(Rows.Count, 1).End(3).Row - 1) = Split(newName, "(")(0)
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|).End(3) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).Row - Cells(i, |fffd||fffd||fffd||fffd|).End(3).Row
End If
 

Cells(i, |fffd||fffd||fffd||fffd||135||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|).End(4).End(4) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) - 1
 
 
Next i
 
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)

 
 

yy = 0




For Aa = 0 To 1000

Set CC = Columns(1).Find(.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

For i = CC.Row To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||fffd||fffd||fffd|) = "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) = Application.Min(Cells(CC.Row, |fffd||3f6||fffd||fffd||135||fffd|).Resize(i - CC.Row))
Cells(i, |fffd||135||fffd||fffd||fffd|) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|) / Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|) - 1
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.StDev(Cells(CC.Row, |fffd||3f6||fffd||fffd||135||fffd|).Resize(i - CC.Row))
End If

Next i



Set C = Columns(1).Find(.Cells(a + Aa, 1), lookat:=xlWhole)

For i = C.Row To C.Row + 3000
If Cells(i, 1) > .Cells(a + Aa, 1) Then
If Cells(i, |fffd||135||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||135||fffd||fffd||fffd|) > 0 Then

.Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy).NumberFormatLocal = "h:mm:ss"


If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) < 1 Then
If yy = 0 Then

.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, 1).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(i, 2).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|).Value
.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||135||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| + yy) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1

For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 500

If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.02 Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.02
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy) = 0.02
Exit For
End If

If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.02 Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.02
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy) = -0.02
Exit For
End If

Next ii

yy = yy + 8

Else

If Cells(i, |fffd||135||fffd||fffd||fffd|) > 0 And .Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy - 7) <> "" Then
.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, 1).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| + yy) = Cells(i, 2).Value
.Cells(a + Aa, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| + yy) = Cells(i, |fffd||3f6||fffd||fffd||135||fffd|).Value
.Cells(a + Aa, |fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||135||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| + yy) = Cells(i, |fffd||177||fffd||fffd||fffd||fffd|).Value
.Cells(a + Aa, |fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| + yy) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1

For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 500

If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.02 Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = 0.02
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy) = 0.02
Exit For
End If

If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.02 Then
Cells(i, |1e5||fffd||fffd||fffd||fffd||fffd||fffd| + 1) = -0.02
.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd| + yy) = -0.02
Exit For
End If

Next ii

yy = 0

Exit For
End If

End If
End If

End If
End If


If Cells(i, 2) < Cells(i - 1, 2) Then
rr = rr + 1
End If

If rr = 3 Then
rr = 0
Exit For
End If

Next i

rr = 0
yy = 0



If .Cells(a + Aa, 2) <> .Cells(a + Aa + 1, 2) Then
Exit For
End If

Next Aa

Workbooks(newName).Close False
 
End If
End If

Next a

End With

Set C = Nothing

 
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||fffd||fffd||fffd||fffd|)


r = 0

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)

End If

Next i

ActiveSheet.UsedRange.Offset(2).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 2, 1).Resize(, 100) = varTemp(i)
Next i

Erase varTemp
r = 0




For i = 3 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd|) Or Cells(i, |fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)
End If

Next i

ActiveSheet.UsedRange.Offset(2).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 2, 1).Resize(, 100) = varTemp(i)
Next i

Erase varTemp
r = 0


Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "h:mm:ss"
Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "h:mm:ss"
 
ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||fffd||fffd||fffd|)

 
 
'Call |fffd||fffd||fffd||7b8||178||fffd|_|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||7f87c||fffd||fffd||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ae||fffd||3f1||fffd|

End Sub

Sub |fffd||4fd||fd||fffd||1ae||fffd||fffd||fffd||fffd||fffd||5fd||fffd||fffd||3f1||fffd|()

 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|)


r = 0

For i = 3 To Cells(Rows.Count, 1).End(3).Row
If Cells(i, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|) <> "" Then

r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)

End If

Next i

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear
Cells(1, 1).Resize(, 100) = Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 1).Resize(, 100).Value

For i = 1 To UBound(varTemp, 1)
Cells(i + 2, 1).Resize(, 100) = varTemp(i)
Next i

Erase varTemp
r = 0


For i = 2 To Cells(Rows.Count, 1).End(3).Row

If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||fffd||fffd||fffd||fffd||fffd|) Or Cells(i, |fffd||fffd||fffd||fffd|) <> Cells(i - 1, |fffd||fffd||fffd||fffd|) Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 100)
End If

Next i

ActiveSheet.UsedRange.Offset(1).Clear

For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 100) = varTemp(i)
Next i

Erase varTemp
r = 0

Columns(|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|).NumberFormatLocal = "h:mm:ss"
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(2, |fffd||fffd||fffd||fffd|), key2:=Cells(2, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|)

 


End Sub

Sub |fffd||43a||fffd||fffd||177||fffd||fffd||fffd||77a||fffd||fffd||13c||fffd||fffd||377||fffd||fffd||fffd||fffd||3f1||fffd|()
 
 
Application.ScreenUpdating = False
On Error Resume Next
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim CC As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 
 
 
 
      With Application.FileDialog(msoFileDialogFolderPicker)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |e2||fffd||fffd||fffd||fffd|
 
.Show                                                  '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||e2| |fffd||fffd||fffd||fffd|
 
If .SelectedItems.Count = 0 Then              '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|
 
            Exit Sub                                            '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
        Else
 
 
strPath = .SelectedItems(1) & "\"       '|fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
        End If
 
 
    End With
 
'fileName = Dir(strPath & "*(5|fffd||fffd|).csv*")                 '(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
 
 '   If fileName = "" Then                                   '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."           '|fffd||7bd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 '       Exit Sub                                               '|fffd||fffd||169||fffd||fffd| |fffd||7f4||fffd|
 
 
  ' End If
   
   
'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

ActiveSheet.UsedRange.Offset(2).Sort key1:=Cells(2, 2), key2:=Cells(2, 1)

For i = 1 To Cells(2, Columns.Count).End(1).Column
 
If Cells(2, i) = "|fffd||fffd||a5|" Then
|fffd||fffd||a5| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If


If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||3f6||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||f0||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||177||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||177||fffd||fffd||fffd||77b||fffd| = i
End If

If Cells(2, i) = "|fffd||3f6||fffd||fffd||135||fffd|(|fffd||fffd|)" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||135||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||135||fffd||fffd||fffd||fffd||33b||fffd| = i
End If


If Cells(2, i) = "|fffd||73a||fffd||fffd||3f6||fffd|(|fffd||fffd|)" Then
|fffd||73a||fffd||fffd||3f6||fffd||fffd||fffd| = i
End If
 
If Cells(2, i) = "|fffd||fffd||fffd||7b0||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||7b0||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(2, i) = "|fffd||fffd||fffd||fffd|(|fffd||fffd|)" Then
|fffd||fffd||fffd||37b||fffd| = i
End If

Next i






'|fffd||4fd||ff||fffd| 5|fffd||43a||fffd| |fffd||fffd||fffd||fffd| head |fffd||fffd||fffd||fffd||3f1||fffd|

Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Clear

Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then
 
Workbooks.Open (strPath & newName)

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1).Resize(, 100) = Cells(1, 1).Resize(, 100).Value

Workbooks(newName).Close False

Exit For

End If

End If

Next a

End With


ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 10) = Array("|fffd||fffd||fffd||3f0||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd|", "|fffd||fffd||fffd||fffd||135||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|", "|fffd||135||fffd||fffd||fffd|", "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|")
 
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If

If Cells(1, i) = "[|fffd||177||fffd||fffd||fffd||fffd|]" Then
|fffd||177||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||fffd||fffd||3f0||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||3f0||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd|" Then
|fffd||fffd||fffd||fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||bd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd||fffd||fffd|" Then
|fffd||135||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|1e5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|1e5||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
Next i



ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

With ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|")

For a = 2 To .Cells(Rows.Count, 1).End(3).Row

If .Cells(a, 2) <> .Cells(a - 1, 2) Then
 
newName = .Cells(a, 2) & "(5|fffd||fffd|).csv"

If Len(Dir(strPath & newName, vbDirectory)) <> 0 Then

Workbooks.Open (strPath & newName)

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), key2:=Cells(1, 2)



For Aa = 0 To 1000

Set C = Columns(1).Find(.Cells(a + Aa, |fffd||3f6||fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then

For i = 1 To 500

If Cells(C.Row - i, 1) <> Cells(C.Row - i - 1, 1) Then

For ii = 0 To 500

If Cells(C.Row - i + ii, 2) = .Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then
.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(C.Row - i, |fffd||177||fffd||fffd||fffd||fffd|).Resize(ii + 1))
Exit For
End If

Next ii

Exit For
End If

Next i




For i = C.Row To C.Row + 500

If Cells(i, 2) = .Cells(a + Aa, |fffd||3f6||fffd||fffd||f0||fffd||fffd||fffd|) Then

.Cells(a + Aa, |fffd||177||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Sum(Cells(C.Row, |fffd||177||fffd||fffd||fffd||fffd|).Resize(i - C.Row + 1))


'For ii = Cells(i, 1).Row + 1 To Cells(i, 1).Row + 1000

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 > 0.02 Then
'Cells(i, |fffd||177||fffd||fffd||fffd||fffd| + 1) = 0.02
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd|) = 0.02
'Exit For
'End If

'If Cells(ii, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd|) - 1.0033 <= -0.02 Then
'Cells(i, |fffd||177||fffd||fffd||fffd||fffd| + 1) = -0.02
'.Cells(a + Aa, |fffd||fffd||fffd||fffd||fffd||fffd|) = -0.02
'Exit For
'End If

'Next ii


Exit For
End If


Next i


End If



If .Cells(a + Aa, 2) <> .Cells(a + Aa + 1, 2) Then
Exit For
End If


Next Aa

Workbooks(newName).Close False
 
End If
End If

Next a

End With

Set C = Nothing

 
ThisWorkbook.Sheets("|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 

End Sub


Sub |fffd||fffd||1ae||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd||fffd||fffd||3f1||fffd|()


Application.ScreenUpdating = False
On Error Resume Next


For i = Sheets.Count To 2 Step -1

If Sheets(i).Name = "|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd|" Then
Exit For
End If

Sheets(i).Activate
ActiveSheet.UsedRange.Offset(1).Delete

Next i

Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Activate

ThisWorkbook.Save





End Sub




Attribute VB_Name = "Module4"
'====================================================
'|fffd||3fa||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||331||fffd|
'====================================================

Sub |fffd||3fa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||331||fffd|()
 
Dim fileName As String
Dim strPath As String
Dim varTemp()


Application.DisplayAlerts = False
Application.ScreenUpdating = False
On Error Resume Next
 
 
 
'|fffd||6b7||fffd| |fffd||67f||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
With Application.FileDialog(msoFileDialogFolderPicker)
.Show
strPath = .SelectedItems(1) & "\"
'strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\|fffd||fffd||fffd||7b8||178||fffd|\|fffd||fffd||1ae||fffd||43c||fffd|\"
End With
 
 
'|fffd||4fd||fffd|3|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||338||fffd| |fffd||67f||fffd| |fffd||7b1||fffd|
ThisWorkbook.Sheets("|fffd||4fd||fffd|3").Activate
Cells.Delete
Cells(1, 1) = "|fffd||fffd||fffd||fffd||fffd|"
 
fileName = Dir(strPath & "*.xls*")
 
Do While fileName <> ""
 
Cells(Rows.Count, 1).End(3)(2) = fileName
 
fileName = Dir
Loop
 
 
 
 
 
fileName = Dir(strPath & "*.xls*")
 
'|fffd||4fd||fffd|, |fffd||4fd||fffd|2 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

ThisWorkbook.Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Sheets("|fffd||fffd||fffd||7b8||178||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"

ThisWorkbook.Sheets("|fffd||7b5||fffd||fffd||fffd|").Cells.Delete
 
 
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||fffd||fffd| |fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
 
With ThisWorkbook.Sheets("|fffd||4fd||fffd|")
Do While fileName <> ""
 
 
Workbooks.Open (strPath & fileName)
Rows(1).Copy .Cells(1, 1)
Workbooks(fileName).Close False
Exit Do
fileName = Dir
Loop
End With
 
 
  
 
'|fffd||4fd||fd||fffd||1ae||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|
 
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Cells(1, Columns.Count).End(1).Offset(, 1).Resize(, 100) = Array("|fffd||177||fffd||fffd||fffd||fffd||fffd||22d|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||5b0||fffd||fffd||fffd|", "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|", _
"|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd|", "6|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd|", "|fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||bd||f5||fffd||23d||fffd||fffd|", "|fffd||177||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||7b5||fffd|", "|fffd||fffd||570||177||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||5b4||fffd||fffd||fffd||377||fffd|", "|fffd||5b4||fffd||57d||1f7||fffd|", "|fffd||fffd||fffd||37f||fffd||fffd||fffd|", "|fffd||17c||fffd||fffd||fffd|", "|fffd||175||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||135||fffd|", "|fffd||17c||fffd||fffd||fffd|", "2|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "2|fffd||fffd||fffd||17c||fffd||fffd||fffd|", "|fffd||175||fffd||fffd||fffd|")
colsCnt = Cells(1, Columns.Count).End(1).Column
 
For i = 1 To colsCnt
If Cells(1, i) = "#N/A" Then
Cells(1, i).Resize(, colsCnt).Delete
Exit For
End If
Next i
 
colsCnt = Cells(1, Columns.Count).End(1).Column
Rows(1).Replace "[", "", lookat:=xlPart
Rows(1).Replace "]", "", lookat:=xlPart
Rows(1).Replace "_", "", lookat:=xlPart
 
'|fffd||fffd||fffd| |fffd||fffd||fffd|
For i = 1 To colsCnt
 
If Cells(1, i) = "|fffd||f0||fffd|" Then
|fffd||f0||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||177||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||17c||fffd| = i
End If
 
If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||fffd||22d|" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd||22d| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||5b0||fffd||fffd||fffd|" Then
|fffd||5b0||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd|" Then
|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "6|fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||bd||f5||fffd||23d||fffd||fffd|" Then
|fffd||fffd||bd||f5||fffd||23d||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||7b5||fffd|" Then
|fffd||7b5||fffd| = i
End If
 
 
If Cells(1, i) = "|fffd||177||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||177||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||570||177||fffd||fffd||fffd|" Then
|fffd||fffd||570||177||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||5b4||fffd||fffd||fffd||377||fffd|" Then
|fffd||5b4||fffd||fffd||fffd||377||fffd| = i
End If
 
If Cells(1, i) = "|fffd||5b4||fffd||57d||1f7||fffd|" Then
|fffd||5b4||fffd||57d||1f7||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||37f||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||37f||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||135||fffd|" Then
|fffd||135||fffd| = i
End If
 
If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2|fffd||fffd||fffd||17c||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||fffd| = i
End If
Next i
 
 
Sheets("|fffd||7b5||fffd||fffd||fffd|").Cells(1, 1).Resize(, colsCnt) = Cells(1, 1).Resize(, colsCnt).Value
 
 
With ThisWorkbook.Sheets("|fffd||4fd||fffd|3")
For t = 2 To .Cells(Rows.Count, 1).End(3).Row
 
fileName = .Cells(t, 1).Value
 
If Len(Dir(strPath & fileName, vbDirectory)) <> 0 Then
 
 
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
 
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Clear
 
'|fffd||fffd||fffd||3ff||fffd||fffd||ef2d| |fffd||4fd||ff||fffd| |fffd||fffd||fffd||fffd|
Workbooks.Open (strPath & fileName)
ActiveSheet.UsedRange.Offset(1).Copy ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(2, 1)
Workbooks(fileName).Close False
 
 
 
'--------------------
 
'|fffd||4fd||fd||fffd||1ae||fffd||fffd||fffd||fffd| |fffd||6fe||fffd||fffd||3f1||fffd|
 
'--------------------
ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
Columns(1).Replace "/", "/", lookat:=xlPart
 
 
 
'|fffd||fffd||a5||fffd||fffd| |fffd||fffd||fffd||fffd|
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1), order1:=xlAscending
rowsCnt = Cells(Rows.Count, 1).End(3).Row
 
Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(rowsCnt - 1) = Split(fileName, ".")(0)
 
 
 
'|fffd||5b0||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
For i = 15 To rowsCnt
Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd||22d|) = Cells(i, |fffd||177||fffd||fffd||fffd|) / Cells(i - 1, |fffd||177||fffd||fffd||fffd|) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1
Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||f0||fffd|) - 1
 
If Cells(i, |fffd||fffd||fffd||fffd||fffd|) > 0.15 Then
If Cells(i, |fffd||177||fffd||fffd||fffd|) > Cells(i - 1, |fffd||177||fffd||fffd||fffd|) * 20 Then
Cells(i, |fffd||fffd||fffd||fffd|) = "o"
End If
End If

If Cells(i, |fffd||fffd||fffd||fffd|) / Cells(i - 1, |fffd||fffd||fffd||fffd|) - 1 > 0.2 Then
Cells(i, |fffd||7b5||fffd|) = "o"
End If
  
If Cells(i, |fffd||177||fffd||fffd||fffd|) > Cells(i - 1, |fffd||177||fffd||fffd||fffd|) * 20 Then
Cells(i, |fffd||177||fffd||fffd||fffd||fffd||fffd|) = "o"
End If
 
 
If Cells(i, |fffd||fffd||fffd||fffd||fffd|) > 0 Then
Cells(i, |fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd|)
Else
Cells(i, |fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||fffd||fffd||fffd|) = Application.Max(Cells(i - 7, |fffd||fffd||fffd||fffd|).Resize(15)) Then
Cells(i, |fffd||5b0||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
End If
 
If Cells(i, |fffd||fffd||fffd||fffd|) = Application.Min(Cells(i - 7, |fffd||fffd||fffd||fffd|).Resize(15)) Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|)
End If
 
 
Next i
 
 
 
'|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
For i = 2 To rowsCnt
 
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) = "" Then
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) / Cells(i, |fffd||5b0||fffd||fffd||fffd|).End(3) - 1
Cells(i, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd|) = Application.Min(Cells(i - 200, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|).Resize(201))
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||5b4||fffd|) = Cells(i, |fffd||fffd||fffd||fffd|) / Application.Max(Cells(i - 120, |fffd||5b0||fffd||fffd||fffd|).Resize(121)) - 1
Cells(i, |fffd||fffd||570||177||fffd||fffd||fffd|) = Application.Average(Cells(i - 20, |fffd||177||fffd||fffd||fffd|).Resize(21))
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i - 60, |fffd||fffd||fffd|).Resize(61))
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = Application.Average(Cells(i - 60, |fffd||fffd||fffd||fffd|).Resize(61))
End If
End If

 
If Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|) = "" Then
If Cells(i, |fffd||5b0||fffd||fffd||fffd|) <> "" Then
Cells(i, |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|) = Cells(i, |fffd||5b0||fffd||fffd||fffd|) / Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) - 1
Cells(i, |fffd||fffd||bd||f5||fffd||23d||fffd||fffd|) = Application.CountA(Cells(i - 200, |fffd||fffd||fffd||fffd|).Resize(201))
End If
End If
 
Next i
 
 
 
'|fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||338||fffd| |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Set C = Cells(1, |fffd||5b0||fffd||fffd||fffd|)
 
Do
 
 
Set C = C.End(4)
 
If C.Row > rowsCnt Then
Exit Do
End If
 
 
If Not C Is Nothing Then
 
Cells(C.Row, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|).Resize(, 2) = Cells(C.Row, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|).End(3).Resize(, 2).Value
 
 
End If
 
Loop
 
 
 
'|fffd||fffd||fffd||377||fffd| |e3||fffd||fffd|
Set C = Cells(1, |fffd||fffd||fffd||fffd|)
r = 0
 
 
Do
 
 
Set C = C.End(4)
 
If C.Row > rowsCnt Then
Exit Do
End If
 
 
If Not C Is Nothing Then

r = 0
rr = 0
rrr = 1

For i = C.Row To C.Row + 1000
 

If Cells(i, |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|) <> "" Then

r = r + 1
 
If r >= 4 Then
If Cells(i, 1).Row > 250 Then
If Application.CountA(Cells(i - 240, |fffd||177||fffd||fffd||fffd||fffd||fffd|).Resize(241)) >= 2 Then
If Application.CountA(Cells(i - 240, |fffd||7b5||fffd|).Resize(241)) >= 5 Then
If Cells(i, |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|) < 0.15 Then
If Cells(i + 7, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||5b0||fffd||fffd||fffd|) - 1 > -0.1 Then
Cells(C.Row, |fffd||7b5||fffd|) = Application.CountA(Cells(i - 240, |fffd||7b5||fffd|).Resize(241))
Cells(C.Row, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 7, 1)
Cells(C.Row, |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|) = Application.Max(Cells(C.Row, |fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|).Resize(i - C.Row + 1))
Cells(C.Row, |fffd||3f6||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|) = Cells(i + 7, |fffd||fffd||fffd||fffd|) / Cells(i, |fffd||5b0||fffd||fffd||fffd|) - 1
Cells(C.Row, |fffd||135||fffd|) = r
 
 
For a = i + 8 To i + 1000
 
rr = rr + 1
 
If Cells(a, |fffd||fffd||fffd||fffd|) / Cells(i + 7, |fffd||fffd||fffd||fffd|) - 1 < -0.15 Then
If Cells(a, |fffd||fffd||fffd||fffd|) / Cells(a - 1, |fffd||fffd||fffd||fffd|) - 1 < -0.05 Then
If rrr = 1 Then
rrr = rrr + 1
Cells(C.Row, |fffd||17c||fffd||fffd||fffd|) = Cells(i + 7, |fffd||fffd||fffd||fffd|).Value
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Cells(a, |fffd||fffd||fffd||fffd|).Value
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||17c||fffd||fffd||fffd|) = Cells(a, 1).Value
Cells(i + 7, |fffd||fffd||fffd||fffd|) = (Cells(a, |fffd||fffd||fffd||fffd|) + Cells(i + 7, |fffd||fffd||fffd||fffd|)) / 2
End If
End If
End If

 
If Cells(a, |fffd||fffd||fffd||fffd|) / Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) - 1 > 0.3 Then
Cells(C.Row, |fffd||fffd||fffd||37f||fffd||fffd||fffd|) = ((Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) * 1.3) / Cells(i + 7, |fffd||fffd||fffd||fffd|) - 1) * rrr
Cells(C.Row, |fffd||175||fffd||fffd||fffd|) = Cells(a, 1)
Cells(C.Row, |fffd||175||fffd||fffd||fffd|) = Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) * 1.3
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(a, 1) - Cells(i + 7, 1)
Exit For
End If


If rr > 60 Then
If Cells(a, |fffd||fffd||fffd||fffd|) / Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) - 1 > 0.2 Then
Cells(C.Row, |fffd||fffd||fffd||37f||fffd||fffd||fffd|) = ((Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) * 1.2) / Cells(i + 7, |fffd||fffd||fffd||fffd|) - 1) * rrr
Cells(C.Row, |fffd||175||fffd||fffd||fffd|) = Cells(a, 1)
Cells(C.Row, |fffd||175||fffd||fffd||fffd|) = Cells(a, |fffd||fffd||fffd||fffd||fffd||fffd|).End(3) * 1.2
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(a, 1) - Cells(i + 7, 1)
Exit For
End If
End If
 
If rr > 80 Then
Cells(C.Row, |fffd||fffd||fffd||37f||fffd||fffd||fffd|) = (Cells(a, |fffd||fffd||fffd||fffd|) / Cells(i + 7, |fffd||fffd||fffd||fffd|) - 1) * rrr
Cells(C.Row, |fffd||175||fffd||fffd||fffd|) = Cells(a, 1)
Cells(C.Row, |fffd||175||fffd||fffd||fffd|) = Cells(a, |fffd||fffd||fffd||fffd|)
Cells(C.Row, |fffd||fffd||fffd||fffd||fffd||fffd|) = Cells(a, 1) - Cells(i + 7, 1)
Exit For
End If

 
Next a
 
r = 0
rr = 0
rrr = 1
Sheets("|fffd||7b5||fffd||fffd||fffd|").Cells(Rows.Count, 1).End(3)(2).Resize(, colsCnt) = Cells(C.Row, 1).Resize(, colsCnt).Value
 
Exit For
End If
End If
End If
End If
End If
End If
 
If r = 6 Then
r = 0
rr = 0
rrr = 1
Exit For
End If
 
 

End If
 
Next i
 
End If
 
 
 
Loop
 
End If
 
Next t
 
End With
 
 
Set C = Nothing
 
 
Sheets("|fffd||7b5||fffd||fffd||fffd|").Activate
Columns(1).Replace "/", "/", lookat:=xlPart
 
Columns.AutoFit
Columns(1).NumberFormatLocal = "yyyy-mm-dd"
Columns(|fffd||17c||fffd||fffd||fffd|).Resize(, 2).NumberFormatLocal = "yyyy-mm-dd"
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||175||fffd||fffd||fffd|)
 
For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
If Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||17c||fffd||fffd||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||fffd|) Then
Rows(i).Clear
End If
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), key3:=Cells(1, |fffd||175||fffd||fffd||fffd|)
 
End Sub



Sub |fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|()

Dim C As Range
Dim CC As Range


Application.ScreenUpdating = False
Application.DisplayAlerts = False
On Error Resume Next

'|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd||fffd||fffd| |e3||fffd||fffd|
Set C = Sheets("|fffd||fffd||169||fffd||3bd||fffd||fffd||fffd|").Cells.Find("|fffd||17c||fffd||fffd||fffd|", lookat:=xlWhole)

'|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|
Sheets("|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
ActiveSheet.UsedRange.Offset(1).Delete

'|fffd||fffd||fffd||fffd||fffd||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||3f1||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||3f1||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||371||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||7c21|" Then
|fffd||fffd||fffd||7c21||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd||fffd||47e||5f0||fffd||ac21|" Then
|fffd||f0||fffd||fffd||47e||5f0||fffd||ac21||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||f0||fffd||fffd||47e||fffd|" Then
|fffd||f0||fffd||fffd||47e||5f1||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||fffd||fc||fffd||57d||fffd|" Then
|fffd||431||fffd||fffd||fffd||fc||fffd||57d||1f1||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||fffd||5b4||fffd||57d||fffd|" Then
|fffd||431||fffd||fffd||5b4||fffd||57d||1f1||fffd| = i
End If

If Cells(1, i) = "|fffd||431||fffd||57d||fffd||23d||fffd||fffd|" Then
|fffd||431||fffd||57d||fffd||23d||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "PER" Then
|fffd||6f1||fffd| = i
End If

If Cells(1, i) = "PBR" Then
|fffd||1fa||fffd||2f1||fffd| = i
End If

If Cells(1, i) = "PSR" Then
|fffd||1ff||fffd||fffd||fffd||fffd||2f1||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||e4||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||e4||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||ba||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||ba||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||fffd||1e5|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||1e5||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||5f8||fffd|" Then
|fffd||5f8||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||6b4||fffd||fffd|" Then
|fffd||fffd||fffd||6b4||fffd||fffd||fffd| = i
End If

Next i

'|fffd||7b5||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd||fffd||fffd| |fffd||17c||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|
Sheets("|fffd||7b5||fffd||fffd||fffd|").Activate

For i = 1 To Cells(1, Columns.Count).End(1).Column

If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||fffd||7b5||fffd| = i
End If

If Cells(1, i) = "|fffd||fffd||fffd||37f||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||37f||fffd||fffd||3b1||7b5||fffd| = i
End If

If Cells(1, i) = "|fffd||17c||fffd||fffd||fffd|" Then
|fffd||17c||fffd||fffd||3f1||7b5||fffd| = i
End If

If Cells(1, i) = "|fffd||175||fffd||fffd||fffd|" Then
|fffd||175||fffd||fffd||3f1||7b5||fffd| = i
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||3f1||7b5||fffd|), order1:=xlAscending

Set CC = Columns(|fffd||17c||fffd||fffd||3f1||7b5||fffd|).Find(C.Offset(1), lookat:=xlWhole)

rowsCnt = Cells(Rows.Count, 1).End(3).Row - CC.Row + 1

'|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||6bd||fffd||1ae||fffd||fffd| |fffd||7b5||fffd||fffd||5bd||fffd||1ae||fffd||fffd| |fffd||2bf||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||73f||fffd||fffd||fffd|
With Sheets("|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
If Not CC Is Nothing Then
.Cells(2, |fffd||17c||fffd||fffd||3f1||fffd|).Resize(rowsCnt) = Cells(CC.Row, |fffd||17c||fffd||fffd||3f1||7b5||fffd|).Resize(rowsCnt).Value
.Cells(2, |fffd||175||fffd||fffd||3f1||fffd|).Resize(rowsCnt) = Cells(CC.Row, |fffd||175||fffd||fffd||3f1||7b5||fffd|).Resize(rowsCnt).Value
.Cells(2, |fffd||fffd||fffd||fffd||fffd|).Resize(rowsCnt) = Cells(CC.Row, |fffd||fffd||fffd||fffd||fffd||fffd||7b5||fffd|).Resize(rowsCnt).Value
.Cells(2, |fffd||fffd||fffd||371||fffd|).Resize(rowsCnt) = Cells(CC.Row, |fffd||fffd||fffd||37f||fffd||fffd||3b1||7b5||fffd|).Resize(rowsCnt).Value
End If
End With

Set C = Nothing
Set CC = Nothing

'|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||1ae||fffd||fffd| |fffd||335||fffd|
Sheets("|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd||3bc||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
colsCnt = ActiveSheet.UsedRange.Columns.Count
rowsCnt = ActiveSheet.UsedRange.Rows.Count

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||3f1||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

'|fffd||cf31||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
For i = rowsCnt To 2 Step -1
If Right(Cells(i, |fffd||fffd||fffd||fffd||fffd|), 1) = "|fffd||fffd|" Then
Rows(i).Clear
End If

If InStr(Cells(i, |fffd||fffd||fffd||fffd||fffd|), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||3f1||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending


'|fffd||7fa||fffd||fffd||fffd||fffd||fffd|
With Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|")

For i = rowsCnt To 2 Step -1

If Cells(i, |fffd||fffd||fffd||fffd||fffd|) = Cells(i - 1, |fffd||fffd||fffd||fffd||fffd|) And Cells(i, |fffd||17c||fffd||fffd||3f1||fffd|) = Cells(i - 1, |fffd||17c||fffd||fffd||3f1||fffd|) Then
Rows(i).Clear
End If

Next i

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||3f1||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending


'|fffd||fffd||fffd||fffd||fffd||6b5||5fe1||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||6b5||fffd| |fffd||fffd||fffd||fffd|
For i = 2 To rowsCnt

Set C = .Columns(2).Find(Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then
Cells(i, |fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd|) = C.Offset(, -1)
End If

Next i

Set C = Nothing

End With



'|fffd||6bd||fffd||fffd||fffd|,|fffd||6bd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||ef2d| |fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
With Application.FileDialog(msoFileDialogFolderPicker)
strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\|fffd||fffd||fffd||7b8||178||fffd|\|fffd||fffd||1ae||fffd||43c||fffd|\"
End With

fileName = "|fffd||6bd||fffd||fffd||fffd|.csv"
fileName1 = "|fffd||6bd||fffd||fffd||fffd|.csv"


ThisWorkbook.Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Delete

With Sheets("|fffd||4fd||fffd|")
Workbooks.Open (strPath & fileName)
ActiveSheet.UsedRange.Copy .Cells(1, 1)
Workbooks(fileName).Close False

Workbooks.Open (strPath & fileName1)
ActiveSheet.UsedRange.Copy .Cells(Rows.Count, 1).End(3)(2)
Workbooks(fileName1).Close False
End With


'|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||6bf||fffd| |fffd||f0||fffd||fffd||47e||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|
Sheets("|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate


With Sheets("|fffd||4fd||fffd|")
For i = 2 To rowsCnt
Set C = .Columns(3).Find(Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then
Cells(i, |fffd||f0||fffd||fffd||47e||5f0||fffd||ac21||fffd||fffd|) = C.Offset(, 1)
Cells(i, |fffd||f0||fffd||fffd||47e||5f1||fffd|) = Round(C.Offset(, 7) / 100, 0)
End If

Next i
End With

Set C = Nothing

Cells(Rows.Count, |fffd||fffd||fffd||fffd||fffd|).End(3)(2).Resize(rowsCnt, colsCnt).Delete


'|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||6bf||fffd| |fffd||7e6b||fffd||fffd||1e5| |fffd||fffd||fffd||fffd||fffd||fffd||1ae|


Sheets("|fffd||fffd||fffd||fffd|").Activate

'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3f1||fffd|
For i = 1 To Cells(1, Columns.Count).End(1).Column
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd||fffd||6b5||fffd|" Then
|fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd| = i
End If
 
If Cells(1, i) = "|fffd||fffd||fffd||fffd|" Then
|fffd||fffd||fffd||fffd||fffd| = i
End If
 
If Cells(1, i) = "2016" Then
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2018" Then
|fffd||6f3||fffd||fffd||fffd||fffd| = i
End If

If Cells(1, i) = "2018.06" Then
|fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6fd||fffd| = i
End If
 
If Cells(1, i) = "2019.06" Then
|fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd| = i
End If
 
Next i
 


Sheets("|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate

r = 0
With Sheets("|fffd||fffd||fffd||fffd|")

For i = 2 To rowsCnt
Set C = .Columns(|fffd||fffd||fffd||fffd||fffd|).Find(Cells(i, |fffd||fffd||fffd||fffd||fffd|), lookat:=xlWhole)

If Not C Is Nothing Then
If .Cells(C.Row, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" Then
Cells(i, |fffd||6f1||fffd|) = .Cells(C.Row + 10, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||1fa||fffd||2f1||fffd|) = .Cells(C.Row + 12, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||e4||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 6, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||ba||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 7, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) = .Cells(C.Row + 8, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|)
Cells(i, |fffd||fffd||fffd||fffd|) = .Cells(C.Row + 14, |fffd||6f3||fffd||fffd||fffd||fffd|)

Cells(i, |fffd||431||fffd||fffd||fffd||fc||fffd||57d||1f1||fffd|) = Application.Sum(.Cells(C.Row + 2, |fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6fd||fffd|).Resize(, 5)) / Application.Sum(.Cells(C.Row, |fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6fd||fffd|).Resize(, 5))

For a = |fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6fd||fffd| To |fffd||5b1||67a||431||fffd||fffd||fffd||fffd||fffd||fffd|
.Cells(C.Row + 13, a) = .Cells(C.Row + 2, a) / .Cells(C.Row, a)

If .Cells(C.Row + 13, a) < 0 Then
r = r + 1
End If
Next a

Cells(i, |fffd||431||fffd||57d||fffd||23d||fffd||fffd||fffd||fffd|) = r
Cells(i, |fffd||431||fffd||fffd||5b4||fffd||57d||1f1||fffd|) = Application.Min(.Cells(C.Row + 13, |fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6fd||fffd|).Resize(, 5))
.Cells(C.Row + 13, |fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6fd||fffd|).Resize(, 5).Clear
r = 0

End If
End If

Next i

End With

Set C = Nothing


'|fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||331||fffd|
For i = rowsCnt To 2 Step -1

If Cells(i, |fffd||fffd||e4||fffd||fffd||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||fffd||e4||fffd||fffd||fffd||fffd||fffd||fffd|) > 150 Then
Rows(i).Clear
End If

If Cells(i, |fffd||431||fffd||57d||fffd||23d||fffd||fffd||fffd||fffd|) <> "" And Cells(i, |fffd||431||fffd||57d||fffd||23d||fffd||fffd||fffd||fffd|) > 2 Then
Rows(i).Clear
End If

If Cells(i, |fffd||431||fffd||fffd||5b4||fffd||57d||1f1||fffd|) <> "" And Cells(i, |fffd||431||fffd||fffd||5b4||fffd||57d||1f1||fffd|) < -0.3 And Cells(i, |fffd||431||fffd||57d||fffd||23d||fffd||fffd||fffd||fffd|) > 2 Then
Rows(i).Clear
End If

If Cells(i, |fffd||431||fffd||fffd||fffd||fc||fffd||57d||1f1||fffd|) <> "" And Cells(i, |fffd||431||fffd||fffd||fffd||fc||fffd||57d||1f1||fffd|) < -0.1 Then
Rows(i).Clear
End If

Next i


ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, |fffd||17c||fffd||fffd||3f1||fffd|), key2:=Cells(1, |fffd||fffd||fffd||fffd||fffd|), order1:=xlAscending, order2:=xlAscending

Columns(|fffd||f0||fffd||fffd||47e||5f0||fffd||ac21||fffd||fffd|).Resize(, 2).NumberFormatLocal = "#,###"
Cells.Font.Size = 9
Columns.AutoFit
Rows.AutoFit

End Sub


Sub |fffd||fffd||1ae||fffd||43c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||674||67f||fffd||7be||4b4||fffd||fffd||fffd||22e||fffd||fffd|()

Application.ScreenUpdating = False
On Error Resume Next


'|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||9f2d| |fffd||fffd||1ae||fffd||338||fffd||fffd||fffd| |fffd||4fd||f0||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||378||fffd||fffd| |fffd||fffd||fffd||5b0||fffd| |fffd||6b7||fffd| |fffd||fffd||fffd||fffd||fffd|
For i = Sheets.Count To 2 Step -1

If InStr(Sheets(i).Name, "|fffd||4fd||fffd|") Then

Sheets(i).Activate

If ActiveSheet.AutoFilterMode Then
ActiveSheet.UsedRange.AutoFilter
End If

Cells.Delete

End If

Next i

'|fffd||fffd||1ae||fffd||43c||fffd| |fffd||fffd||fffd||5e26| |fffd||fffd||fffd||ef2d| |fffd||fffd||fffd||fffd||fffd||fffd||fc||fffd||fffd| |fffd||5b4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||4fd||fd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd|
With Application.FileDialog(msoFileDialogFolderPicker)
strPath = "C:\Users\|fffd||fffd||fffd||3bf||fffd|\Documents\|fffd||5bd||fffd|\|fffd||fffd||fffd||7b8||178||fffd|\|fffd||fffd||1ae||fffd||43c||fffd|\"
End With

fileName = "|fffd||fffd||fffd||fffd||fffd||fffd||fc|.xlsx"

Workbooks.Open (strPath & fileName)
ActiveSheet.UsedRange.Copy ThisWorkbook.Sheets("|fffd||4fd||fffd|").Cells(1, 1)
Workbooks(fileName).Close False

Cells(1, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

'|fffd||4fd||fffd|2|fffd||fffd||1ae||fffd||fffd| |fffd||fffd||1ae||fffd||43c||fffd||fffd||fffd| |fffd||5b4||fffd| xls |fffd||fffd||fffd||fffd| |fffd||338||fffd| |fffd||fffd||fffd||fffd| |fffd||67f||fffd|
Sheets("|fffd||4fd||fffd|2").Activate
Cells(1, 1) = "|fffd||fffd||fffd||fffd||fffd|"

fileName = Dir(strPath & "*.xls")

Do While fileName <> ""

Cells(Rows.Count, 1).End(3)(2) = Split(fileName, ".")(0)

fileName = Dir

Loop



'|fffd||4fd||fffd| |fffd||fffd||1ae|(|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5be||fffd||fffd| |fffd||3f4||fffd| |fffd||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||b3||fffd||fffd| |e3||fffd||fffd|
Sheets("|fffd||4fd||fffd|").Activate

With Sheets("|fffd||4fd||fffd|2")
For i = 2 To Cells(Rows.Count, 1).End(3).Row

Set C = .Columns(1).Find(Cells(i, 2), lookat:=xlWhole)

If Not C Is Nothing Then
Rows(i).Clear
End If

Next i

End With

ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)



End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||67d||f9||7b1||fffd|()
 
Dim varTemp()
 
Application.ScreenUpdating = False
On Error Resume Next
 
Sheets("|fffd||fffd||fffd||fffd|").Activate
 
 
rowsCnt = ActiveSheet.UsedRange.Rows.Count
colsCnt = ActiveSheet.UsedRange.Columns.Count
 
For i = 2 To colsCnt
 
If Cells(1, i) = "2019.06" Then
|fffd||5b1||67a||431||fffd||fffd||fffd||fffd| = i
End If
 
Next i
 
 
For i = 2 To rowsCnt
 
If Cells(i, 1) <> Cells(i - 1, 1) Then
If Cells(i, |fffd||5b1||67a||431||fffd||fffd||fffd||fffd|) = "" Then
r = r + 1
ReDim Preserve varTemp(1 To r)
varTemp(r) = Cells(i, 1).Resize(, 2)
End If
End If
 
Next i
 
Sheets("|fffd||4fd||fffd|").Activate
ActiveSheet.UsedRange.Delete
 
Cells(1, 1).Resize(, 2) = Array("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|", "|fffd||fffd||fffd||fffd|")
 
For i = 1 To UBound(varTemp, 1)
Cells(i + 1, 1).Resize(, 2) = varTemp(i)
Next i
 
 
For i = Cells(Rows.Count, 1).End(3).Row To 2 Step -1
 
If Cells(i, 1) = Cells(i - 1, 1) Then
Rows(i).Clear
End If
 
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
 
 
Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
 
With Sheets("|fffd||4fd||fffd|")
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Set C = .Columns(2).Find(Cells(i, 2), lookat:=xlWhole)
 
If Not C Is Nothing Then
Cells(i, 5) = "o"
End If
 
Next i
 
End With
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 5)
 
Set C = Nothing
 
 
End Sub
 
 
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||67d||f9||7b1||fffd|_2()
 
 
Dim varTemp()
 
Application.DisplayAlerts = False
Application.ScreenUpdating = False
On Error Resume Next
 
 
 
Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
 
With Sheets("|fffd||fffd||fffd||fffd|")
Set C = .Columns(2).Find(ActiveCell.Offset(, -1), lookat:=xlWhole)
 
If Not C Is Nothing Then
 
Set CC = Sheets("|fffd||4fd||fffd|").UsedRange.Find("2016.12", lookat:=xlWhole)
 
If Not CC Is Nothing Then
Sheets("|fffd||4fd||fffd|").Cells(CC.Row + 2, 2).Resize(16, 10).Copy .Cells(C.Row, 4)
End If
 
End If
 
End With
 
Set C = Nothing
Set CC = Nothing
 
Sheets("|fffd||4fd||fffd|").Delete
Worksheets.Add after:=Sheets("|fffd||fffd||fffd||7b8||178||fffd|")
ActiveSheet.Name = "|fffd||4fd||fffd|"
 
End Sub
 
 
 
 
Sub |fffd||fffd||fffd||fffd||fffd||6b5||fffd|update()
 
 
Dim rngall As Range
Dim rngC As Range
Dim C As Range
Dim colsCnt As Long
Dim rowsCnt As Long
Dim varTemp()
Dim vartemp1()
Dim vartemp2()
Dim wksht As Worksheet
Dim rngalleach As Range
Dim newName As String
Dim strName As String
Dim strPath As String                '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||3b8||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Dim wkBk As Workbook
Dim rngData As Range
Dim |fffd||fffd||fffd||377||fffd| As Long
Dim fileName As String              '|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||338||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 
 
Application.ScreenUpdating = False             '|22d||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||1ae| (|fffd||3fd||fffd|) |fffd||fffd||fffd||fffd|
On Error Resume Next
 
 
   
'|fffd||fffd||fffd||fffd||fffd||6b5||5fe1||fffd||fffd| |fffd||7fa||fffd| & |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||ec23| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Sheets("|fffd||fffd||fffd||fffd||fffd||6b5||fffd|").Activate
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 3) = "https://finance.naver.com/item/main.nhn?code=" & Cells(i, 1)
 
If Right(Cells(i, 2), 1) = "|fffd||fffd|" Or Right(Cells(i, 2), 2) = "|fffd||fffd|B" Then
Rows(i).Clear
End If
 
If InStr(Cells(i, 2), "|fffd||fffd||fffd||fffd|") Then
Rows(i).Clear
End If
 
Next i
 
ActiveSheet.UsedRange.Offset(1).Sort key1:=Cells(1, 1)
Range(Cells(Rows.Count, 1).End(3)(2), Cells(Rows.Count, Columns.Count)).Delete '|fffd||fffd||12d||fffd||fffd| delete|fffd||3f1||fffd| |fffd||fffd||fffd||fffd| |fffd||6f0||fffd||fffd||3f1||fffd|
 
 
 
 
ThisWorkbook.Save
 
 
End Sub
 
 
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
 
Application.ScreenUpdating = False
On Error Resume Next
 
Sheets("|fffd||4fd||fffd|").Activate
Cells(2, 2).Resize(5000, 5).Clear
 
Cells(1, 1).Resize(, 5) = Array("|fffd||fffd||a5|", "|fffd||17c||fffd|", "|fffd||175||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||77e||fffd|")
 
Sheets("|fffd||7b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
 
With Sheets("|fffd||4fd||fffd|")
For i = 2 To Cells(Rows.Count, 1).End(3).Row
 
Set C = .Columns(1).Find(Cells(i, 1), lookat:=xlWhole)
 
If Not C Is Nothing Then
C.Offset(, 1) = C.Offset(, 1) + 120
End If
 
Set CC = .Columns(1).Find(Cells(i, 2), lookat:=xlWhole)
 
If Not CC Is Nothing Then
CC.Offset(, 2) = CC.Offset(, 2) + 120
CC.Offset(, 3) = CC.Offset(, 3) + (120 * Cells(i, 5))
End If
 
Next i
 
End With
 
 
 
 
 
Sheets("|fffd||4fd||fffd|").Activate
 
For i = 2 To Cells(Rows.Count, 1).End(3).Row
Cells(i, 5) = 3000 - Application.Sum(Cells(2, 2).Resize(i - 1)) + Application.Sum(Cells(2, 3).Resize(i - 1)) + Application.Sum(Cells(2, 4).Resize(i - 1))
Next i
 
 
End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet115"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet116"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet117"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet257"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{B503BB74-54DB-42BC-B914-63E449310BA7}{A8FA1AFD-8D78-4811-8C3E-ED8D4F899FFD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{CEEC648B-88B0-46E9-AD8A-00D5ECBC5683}{60C3E1DE-1F8D-4317-8FB3-E95DC80F429F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit



INQUEST-PP=macro
