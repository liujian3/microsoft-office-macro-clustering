Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
'Function f|fffd|r Excel 64-Bit-Versionen
#If VBA7 And Win64 Then
    Private Declare PtrSafe Function URLDownloadToFile Lib "urlmon" _
      Alias "URLDownloadToFileA" ( _
        ByVal pCaller As LongPtr, _
        ByVal szURL As String, _
        ByVal szFileName As String, _
        ByVal dwReserved As LongPtr, _
        ByVal lpfnCB As LongPtr _
      ) As Long
'Function f|fffd|r Excel 32-Bit-Versionen
#Else
    Private Declare Function URLDownloadToFile Lib "urlmon" _
      Alias "URLDownloadToFileA" ( _
        ByVal pCaller As Long, _
        ByVal szURL As String, _
        ByVal szFileName As String, _
        ByVal dwReserved As Long, _
        ByVal lpfnCB As Long _
      ) As Long
#End If

Public Function GetLinkStatus(ByVal strUrl As String) As Boolean
    Dim objXMLHTTP As Object
    If Not Left$(strUrl, 7) = "http://" Then strUrl = "http://" & strUrl
    Set objXMLHTTP = CreateObject("Msxml2.XMLHTTP")
    On Error Resume Next
    objXMLHTTP.Open "GET", strUrl, False
    objXMLHTTP.Send
    GetLinkStatus = objXMLHTTP.Status = 200
    Set objXMLHTTP = Nothing
    On Error GoTo 0
End Function
Public Function URLVorhanden(ByVal sURL As String) As Boolean
    Dim oHTTP As Object
    Dim lStatus As Long
   
    Set oHTTP = CreateObject("Microsoft.XMLHTTP")
    On Error Resume Next
    With oHTTP
        .Open "GET", sURL, False
        .Send
        lStatus = .Status
    End With
    Set oHTTP = Nothing
    URLVorhanden = lStatus = 200
End Function

Private Sub Workbook_open()
'**************************
Dim strUrl As String
Dim strDatei As String
Dim version As Integer
Dim ThisUpDatei As String
Dim update As String
'**************************


If Not ActiveWorkbook.ActiveSheet.Name = "Eingang" Then
    ActiveSheet.Visible = xlVeryHidden
    Worksheets("Eingang").Activate
End If

Application.ScreenUpdating = False
Application.Wait Now + TimeSerial(0, 0, 0)

'Hinweis zu vorhandenem Update l|fffd|schen
Worksheets("Eingang").Unprotect "bufovo30"
Worksheets("Eingang").Range("D24") = ""
Worksheets("Eingang").Protect "bufovo30"

update = Dir(ThisWorkbook.Path & "\update-dvII*.xl*")
update = ThisWorkbook.Path & "\" & update

' Test, ob die gestartete Datei eine Update-Datei ist
If Worksheets("Grunddaten").Range("C30") = "update" Then
    Worksheets("Eingang").CheckBox1.Value = False
    Exit Sub
End If

'wenn Haken f|fffd|r AutoUpdateSuche nicht gesetzt, beenden
If Not Worksheets("Eingang").CheckBox1 Then
    Exit Sub
End If

version = Worksheets("Eingang").Range("G24")

'bei nicht vorhandener Internetverbindung beenden
If URLVorhanden("https://www.pv-steuer.com/pages/willkommen.php") = False Then
    Exit Sub
End If

'Name der Update-Datei aus der vorliegenden Version
ThisUpDatei = "http://www.pv-steuer.de/updates/update-dvII-" & version & ".xls"

Application.ScreenUpdating = True

'Wenn Update-Datei der vorliegenden alten Version vorhanden, beende die Routine, sonst gehe zu Update_vorhanden
If GetLinkStatus(ThisUpDatei) Then
    Exit Sub
Else
    Call Update_vorhanden
End If
   
End Sub

Public Sub Update_vorhanden()
'****************************
Dim Dateiname As String
Dim ausgabe As String
Dim pfad As String
Dim strUrl As String
Dim strDatei As String
Dim update As String
Dim lResult As Long
Dim sURL$, sLocalFile$
Dim NeuVersion As Integer
'****************************

Application.ScreenUpdating = False

pfad = ThisWorkbook.Path
Dateiname = Dir(ThisWorkbook.Path & "\update-dvII*.xl*")

If Dateiname <> "" Then
    Worksheets("Eingang").Unprotect "bufovo30"
    Worksheets("Eingang").Range("D24") = "Die Version " & Chr(34) & Dateiname & Chr(34) & " liegt im Verzeichnis dieser Datei."
    Worksheets("Eingang").Protect "bufovo30"
    Exit Sub
End If

NeuVersion = Worksheets("Eingang").Range("G24")
Worksheets("Eingang").Unprotect "bufovo30"
Worksheets("Eingang").Range("D24") = ""
Worksheets("Eingang").Protect "bufovo30"

'Entscheidung, ob Update geladen werden soll
If MsgBox("Ein neues Update liegt auf der Webseite." & vbCrLf & vbCrLf & "Wollen Sie dieses Update jetzt herunterladen?", vbYesNo Or vbQuestion) = vbYes Then
    
    Do
        NeuVersion = NeuVersion + 1
        'Definition der Downloaddateien im Internet und der Zieldatei auf der HD
        update = "update-dvII-" & NeuVersion & ".xls"
        sURL = "http://www.pv-steuer.de/updates/update-dvII-" & NeuVersion & ".xls"
        sLocalFile = ThisWorkbook.Path & "\" & update
        'Ergebnispr|fffd|fung
        lResult = URLDownloadToFile(0, sURL, sLocalFile, 0, 0)
        'Falls Download erfolglos, dann Versionsnummer bis zu 10 mal hochz|fffd|hlen und testen
    Loop While lResult <> 0 And NeuVersion < Worksheets("Eingang").Range("G24") + 10
    
    
    'Kontrolle auf Erfolg des Kopierens
    If lResult = 0 Then
        MsgBox "Download erfolgreich ausgef|fffd|hrt!" & vbCrLf & vbCrLf & "Die Datei " & Chr(34) & update & Chr(34) & " liegt im gleichen Verzeichnis wie diese Datei."
        Worksheets("Eingang").Unprotect "bufovo30"
        Worksheets("Eingang").Range("D24") = "Die Version " & Chr(34) & update & Chr(34) & " liegt im Verzeichnis dieser Datei."
        Worksheets("Eingang").Protect "bufovo30"
    Else
        If MsgBox("Der Download ist leider fehlgeschlagen. " & vbCrLf & vbCrLf & "Wollen Sie selbst nach dem Update suchen?", vbYesNo Or vbQuestion) = vbYes Then
            ThisWorkbook.FollowHyperlink "http://www.pv-steuer.de/pages/direktverbrauch-ii.php"
        End If
    End If
End If

Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("Changelog").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate

End Sub
Attribute VB_Name = "Tabelle10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 138, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 43, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 131, 3, MSForms, CommandButton"
Attribute VB_Control = "ToggleButton1, 137, 4, MSForms, ToggleButton"
Private Sub CommandButton1_Click()
With Worksheets("Grunddaten")
    BJ = .Range("C27").Value
    IJ = Year(.Range("E15").Value)
    
    If .Range("G42").Value = 0 And .Range("G44") = "" Then
        If BJ = IJ And Worksheets("Ausg.-Sammler").Range("M117") < .Range("E18") * 0.19 - 0.01 Then
            MsgBox "Bitte beachten Sie:" & vbCrLf & vbCrLf & "Die Summe des Ausgabenkontos " & Chr(34) & "bezahlte Vorsteuer" & Chr(34) & "ist geringer als die Mehrwertsteuer der PV-Anlage!" & _
            vbCrLf & vbCrLf & "Haben Sie den Eintrag der Vorsteuer vielleicht vergessen? " & vbCrLf & vbCrLf & _
            "Weitere Hinweise erhalten Sie im Hilfstext " & Chr(34) & "Ausgaben" & Chr(34) & ".", vbExclamation
            If MsgBox("Soll der Hinweis zur Vorsteuer weiterhin angezeigt werden?", vbYesNo) = vbNo Then
                .Range("G44").Value = 0
            End If
        End If
    End If
    
End With
Worksheets("Ausg.-Sammler").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Worksheets("Ausg.-Sammler").Unprotect "bufovo30"
Range("A68:N116").Interior.Color = vbWhite
Range("B68:N116").Sort Key1:=Range("B68:B116")
For i = 68 To 116 Step 2
For j = 1 To 14
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i

If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("Ausg.-Sammler").Protect "bufovo30"
Else
    Worksheets("Ausg.-Sammler").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton3_Click()
Worksheets("Ausg.-Sammler").Unprotect "bufovo30"
Range("A9:N59").Interior.Color = vbWhite
Range("B9:N59").Sort Key1:=Range("B9:B59")
For i = 9 To 59 Step 2
For j = 1 To 14
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i
Range("A68:N116").Interior.Color = vbWhite
Range("B68:N116").Sort Key1:=Range("B68:B116")
For i = 68 To 116 Step 2
For j = 1 To 14
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i
    
If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("Ausg.-Sammler").Protect "bufovo30"
Else
    Worksheets("Ausg.-Sammler").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton4_Click()
'Ausgaben nach 10-T-R
With Sheets("A10TagesRegel")
    .Visible = True
    .Activate
    .Cells(.Cells(15, 2).End(xlUp).Row + 1, 2).Select
End With

End Sub

Private Sub CommandButton5_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Ausgaben-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Ausgaben.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub ToggleButton1_Click()
Worksheets("Ausg.-Sammler").Unprotect "bufovo30"
If ToggleButton1.Value = True Then
    ToggleButton1.Caption = "Blatt 2 ausblenden"
    Rows("60:116").Hidden = False
Else
    ToggleButton1.Caption = "Blatt 2 einblenden"
Rows("60:116").Hidden = True
End If

If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("Ausg.-Sammler").Protect "bufovo30"
Else
    Worksheets("Ausg.-Sammler").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub


Attribute VB_Name = "Tabelle11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 10, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 7, 2, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("Fahrtkosten").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Fahrtkosten-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Fahrtkosten.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton3_Click()
Worksheets("Fahrtkosten").Unprotect "bufovo30"
Range("A14:O42").Interior.Color = vbWhite
Range("B14:O42").Sort Key1:=Range("B14:B42")
For i = 14 To 42 Step 2
For j = 1 To 15
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i

If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("Fahrtkosten").Protect "bufovo30"
Else
    Worksheets("Fahrtkosten").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "Tabelle12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ListBox1, 4, 0, MSForms, ListBox"
Attribute VB_Control = "OptionButton6, 37, 1, MSForms, OptionButton"
Attribute VB_Control = "OptionButton1, 8, 2, MSForms, OptionButton"
Attribute VB_Control = "CommandButton1, 7, 3, MSForms, CommandButton"
Attribute VB_Control = "OptionButton5, 34, 4, MSForms, OptionButton"
Attribute VB_Control = "OptionButton4, 33, 5, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 31, 6, MSForms, OptionButton"
Attribute VB_Control = "OptionButton3, 13, 7, MSForms, OptionButton"
Attribute VB_Control = "OptionButton7, 38, 8, MSForms, OptionButton"
Attribute VB_Control = "CommandButton4, 54, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 51, 10, MSForms, CommandButton"
Attribute VB_Control = "OptionButton8, 57, 11, MSForms, OptionButton"
Attribute VB_Control = "OptionButton9, 58, 12, MSForms, OptionButton"
' Arbeitsblatt Grunddaten
'------------------------

Private Sub CommandButton1_Click()
If Worksheets("Grunddaten").Range("G29").Value = "" Then
    If Worksheets("Grunddaten").Range("G18") = "" Or Worksheets("Grunddaten").Range("G18").Value <= 0 And Worksheets("Einn.-Sammler").Range("E60").Value > 0 Then
        MsgBox "Sie haben noch keinen oder einen ung|fffd|ltigen Wert f|fffd|r die unentgeltliche Wertabgabe eingetragen." & vbCrLf & vbCrLf & "Die Berechnungen zu den Einnahmen und zur Umsatzsteuer sind deshalb nicht richtig!"
    End If
End If
If Worksheets("Grunddaten").Range("G21") = "" Or Worksheets("Grunddaten").Range("G21") = 0 Then
    MsgBox "Sie haben noch keinen Wert f|fffd|r die Entnahme des Direktverbrauchs eingetragen." & vbCrLf & vbCrLf & "Die Berechnung in der Einnahmen|fffd|berschuss-Rechnung ist deshalb nicht richtig!"
End If
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" And Worksheets("Grunddaten").Range("G18").Value > 0 Then
    MsgBox "Sie haben einen Wert f|fffd|r die unentgeltliche Wertabgabe eingetragen." & vbCrLf & "Im Kleinunternehmer-Modus muss diese Zahl jedoch 0 sein!" & vbCrLf & vbCrLf & "Der Wert wird deshalb jetzt angepasst."
    Worksheets("Grunddaten").Range("G18").Value = 0
End If
ThisWorkbook.Worksheets("Grunddaten").Visible = xlVeryHidden
ThisWorkbook.Worksheets("Eingang").Visible = True
ThisWorkbook.Worksheets("Eingang").Activate
End Sub


Private Sub CommandButton3_Click()
Application.ScreenUpdating = False
'Umschalten zum Blatt Unentgeltliche Wertabgabe
Worksheets("ueWA").Visible = True
Worksheets("ueWA").Activate
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
'Auswahl der richtigen Hilfedatei
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Grunddaten-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Grunddaten.pdf"
End If

ThisWorkbook.FollowHyperlink dokument
End Sub

Sub ListBox1_Click()
'Auswahl der Abschreibungsart
Application.ScreenUpdating = True
ThisWorkbook.Worksheets("Grunddaten").ListBox1.Visible = False
ThisWorkbook.Worksheets("Grunddaten").ListBox1.Visible = True
Application.ScreenUpdating = False
Dim AfA1 As String
AfA1 = ListBox1.Value

    ThisWorkbook.Worksheets("AfA1_lin_mZ").Unprotect "bufovo30"
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Unprotect "bufovo30"
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Unprotect "bufovo30"
    ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"


'Application.ScreenUpdating = False


If AfA1 = "linear ohne Sonderabschreibung" Then

   ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("41").EntireRow.Hidden = True
   ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("66").EntireRow.Hidden = True

   'Worksheets("AfA1_deg_mZ").Visible = xlVeryHidden
   ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("G15:G19") = ""

   ThisWorkbook.Worksheets("Grunddaten").Range("E27") = ""
   ThisWorkbook.Worksheets("Grunddaten").Range("E39") = "1"
  
ElseIf AfA1 = "linear mit Sonderabschreibung" Then
   ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("G15:G19") = ""
   ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("41").EntireRow.Hidden = False
   ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("66").EntireRow.Hidden = False

   ThisWorkbook.Worksheets("Grunddaten").Range("E27") = ""
   ThisWorkbook.Worksheets("Grunddaten").Range("E39") = "2"
    
ElseIf AfA1 = "degressiv ohne Sonderabschreibung" Then
    'Worksheets("AfA1_lin_mZ").Visible = xlVeryHidden
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("G15:G19") = ""
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Visible = True
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Columns("G").Hidden = True
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("G15:G19") = ""
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Visible = False
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("41").EntireRow.Hidden = True
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("66").EntireRow.Hidden = True

    ThisWorkbook.Worksheets("Grunddaten").Range("E27") = ""
    ThisWorkbook.Worksheets("Grunddaten").Range("E39") = "3"
Else
    'Worksheets("AfA1_lin_mZ").Visible = xlVeryHidden
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("G15:G19") = ""
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Visible = True
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Columns("G").Hidden = False
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Visible = False
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("41").EntireRow.Hidden = False
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Rows("66").EntireRow.Hidden = False
    
    ThisWorkbook.Worksheets("Grunddaten").Range("E27") = ""
    ThisWorkbook.Worksheets("Grunddaten").Range("E39") = "4"
   
 End If
    
ThisWorkbook.Worksheets("Grunddaten").Range("E27") = AfA1

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Protect "bufovo30"
    ThisWorkbook.Worksheets("E-Ue-rechnung").Protect "bufovo30"
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Protect "bufovo30"
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"

Else
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    ThisWorkbook.Worksheets("E-Ue-rechnung").Protect "bufovo30", AllowFormattingColumns:=True
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If


End Sub

Private Sub OptionButton1_Click()
' monatliche Umsatzsteuer-Voranmeldung
Application.ScreenUpdating = False
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"

ThisWorkbook.Worksheets("Grunddaten").Range("G39") = "1"
ThisWorkbook.Worksheets("Grunddaten").Range("G40") = "monatlich"
ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"

ThisWorkbook.Worksheets("USt-Voranm.").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Jahres-USt").Unprotect "bufovo30"

ThisWorkbook.Worksheets("USt-Voranm.").Rows("6:24").EntireRow.Hidden = False
ThisWorkbook.Worksheets("USt-Voranm.").Rows("25:39").EntireRow.Hidden = True

ThisWorkbook.Worksheets("Jahres-USt").Rows("16:20").EntireRow.Hidden = False
ThisWorkbook.Worksheets("Jahres-USt").Rows("31:32").EntireRow.Hidden = False

ThisWorkbook.Worksheets("Jahres-USt").Rows("21:30").EntireRow.Hidden = True
ThisWorkbook.Worksheets("Jahres-USt").Rows("34:41").EntireRow.Hidden = False

Application.ScreenUpdating = True

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("USt-Voranm.").Protect "bufovo30"
    ThisWorkbook.Worksheets("Jahres-USt").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("USt-Voranm.").Protect "bufovo30", AllowFormattingColumns:=True
    ThisWorkbook.Worksheets("Jahres-USt").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub OptionButton2_Click()
' quartalweise Umsatzsteuer-Voranmeldung
Application.ScreenUpdating = False
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"

ThisWorkbook.Worksheets("Grunddaten").Range("G39") = "3"
ThisWorkbook.Worksheets("Grunddaten").Range("G40") = "quartalsweise"
ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"

ThisWorkbook.Worksheets("USt-Voranm.").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Jahres-USt").Unprotect "bufovo30"

ThisWorkbook.Worksheets("USt-Voranm.").Rows("6").EntireRow.Hidden = False
ThisWorkbook.Worksheets("USt-Voranm.").Rows("7:25").EntireRow.Hidden = True
ThisWorkbook.Worksheets("USt-Voranm.").Rows("37:39").EntireRow.Hidden = True
ThisWorkbook.Worksheets("USt-Voranm.").Rows("26:36").EntireRow.Hidden = False

ThisWorkbook.Worksheets("Jahres-USt").Rows("16").EntireRow.Hidden = False
ThisWorkbook.Worksheets("Jahres-USt").Rows("17:21").EntireRow.Hidden = True
ThisWorkbook.Worksheets("Jahres-USt").Rows("22:25").EntireRow.Hidden = False
ThisWorkbook.Worksheets("Jahres-USt").Rows("26:30").EntireRow.Hidden = True
ThisWorkbook.Worksheets("Jahres-USt").Rows("34:41").EntireRow.Hidden = False

Application.ScreenUpdating = True


If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("USt-Voranm.").Protect "bufovo30"
    ThisWorkbook.Worksheets("Jahres-USt").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("USt-Voranm.").Protect "bufovo30", AllowFormattingColumns:=True
    ThisWorkbook.Worksheets("Jahres-USt").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub OptionButton3_Click()
' j|fffd|hrliche Umsatzsteuerzahlung
Application.ScreenUpdating = False
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"

ThisWorkbook.Worksheets("Grunddaten").Range("G39") = "12"
ThisWorkbook.Worksheets("Grunddaten").Range("G40") = "j|fffd|hrlich"
ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"

ThisWorkbook.Worksheets("USt-Voranm.").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Jahres-USt").Unprotect "bufovo30"

ThisWorkbook.Worksheets("USt-Voranm.").Rows("6:37").EntireRow.Hidden = True
ThisWorkbook.Worksheets("USt-Voranm.").Rows("37:39").EntireRow.Hidden = False

If ThisWorkbook.Worksheets("Jahres-USt").Range("B39").Value > 0 Then
    ThisWorkbook.Worksheets("Jahres-USt").Range("B39").Value = ""
End If

ThisWorkbook.Worksheets("Jahres-USt").Rows("17:26").EntireRow.Hidden = True
ThisWorkbook.Worksheets("Jahres-USt").Rows("27:31").EntireRow.Hidden = False
ThisWorkbook.Worksheets("Jahres-USt").Rows("34:41").EntireRow.Hidden = True

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("USt-Voranm.").Protect "bufovo30"
    ThisWorkbook.Worksheets("Jahres-USt").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("USt-Voranm.").Protect "bufovo30", AllowFormattingColumns:=True
    ThisWorkbook.Worksheets("Jahres-USt").Protect "bufovo30", AllowFormattingColumns:=True
End If

Application.ScreenUpdating = True

End Sub

Private Sub OptionButton4_Click()
'Wahl: mit SoAb
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"
'ThisWorkbook.Worksheets("Grunddaten").Rows("32:35").EntireRow.Hidden = False
ThisWorkbook.Worksheets("Grunddaten").ListBox1.ListFillRange = "J31:J32"
ThisWorkbook.Worksheets("Grunddaten").Range("E27") = "Bitte Abschreibungsart w|fffd|hlen!"
ThisWorkbook.Worksheets("Grunddaten").Range("E39") = 0

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub OptionButton5_Click()
'Wahl: ohne SoAb
ThisWorkbook.Worksheets("Grunddaten").ListBox1.ListFillRange = "J28:J29"
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Grunddaten").Rows("32:35").EntireRow.Hidden = True
ThisWorkbook.Worksheets("Grunddaten").Range("E27") = "Bitte Abschreibungsart w|fffd|hlen!"
ThisWorkbook.Worksheets("Grunddaten").Range("E39") = 0

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub OptionButton6_Click()
'Einblenden der Notizspalte
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Grunddaten").Columns("L").Hidden = False

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub OptionButton7_Click()
'Ausblenden der Notizspalte
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Grunddaten").Columns("L").Hidden = True

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub OptionButton8_Click()
'Kleinunternehmer = nein
'***********************


With ThisWorkbook.Worksheets("Grunddaten")
'Voranmeldungs-Buttons einblenden
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Range("G42").Value = 0
    .Range("G17").Interior.Pattern = xlPatternNone
    .Range("G17").Interior.ColorIndex = 35
    .Range("G18").Interior.Pattern = xlPatternNone
    .Range("G18").Interior.ColorIndex = 19
    .OptionButton1.Visible = True
    .OptionButton2.Visible = True
    .OptionButton3.Visible = True
    .CommandButton3.Visible = True
    .Range("G29").Value = ""
    .Range("E5") = "Buchf|fffd|hrungs- und Steuertool f|fffd|r Photovoltaikanlagen ab 01.04.2012"
    .Range("E17") = "Herstellungskosten netto"
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Einn.-Sammler")
'Netto- und USt-Spalten einblenden
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Range("D9").Value = "Netzbetr. brutto"
    .Columns("F:I").EntireColumn.Hidden = False
    .Rows("62").EntireRow.Hidden = False
    .Range("J3").Value = ""
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("E10TagesRegel")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("G:I").EntireColumn.Hidden = False
    .Rows("19:28").EntireRow.Hidden = False
    .CommandButton3.Visible = True
    .Range("J4").Value = ""
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Ausg.-Sammler")
'Vorsteuerspalte einblenden
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("M").EntireColumn.Hidden = False
    .Rows("119").EntireRow.Hidden = False
    .Range("D6").Value = "Bitte hier die Rechnungsbetr|fffd|ge ohne Vorsteuer eintragen!"
    .Range("F2").Value = ""
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("A10TagesRegel")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("H").EntireColumn.Hidden = False
    .Rows("18:27").EntireRow.Hidden = False
     .CommandButton3.Visible = True
    .Range("F3").Value = ""
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Fahrtkosten")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("M").EntireColumn.Hidden = False
    .Range("J3").Value = ""
    .Protect "bufovo30"
End With


With ThisWorkbook.Worksheets("Zusammenstellung")
'Formeln der Netto- und USt-Spalten kopieren
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    For j = 11 To 22
        .Cells(j, 4).FormulaLocal = .Cells(j, 13).FormulaLocal
        .Cells(j, 5).FormulaLocal = .Cells(j, 14).FormulaLocal
        .Cells(j, 6).FormulaLocal = .Cells(j, 15).FormulaLocal
    Next j
    .Cells(23, 4).FormulaLocal = .Cells(23, 13).FormulaLocal
    .Cells(23, 5).FormulaLocal = .Cells(23, 14).FormulaLocal
    .Cells(23, 6).FormulaLocal = .Cells(23, 15).FormulaLocal
    .Cells(25, 4).FormulaLocal = .Cells(25, 13).FormulaLocal
    .Cells(25, 5).FormulaLocal = .Cells(25, 14).FormulaLocal
    .Cells(25, 6).FormulaLocal = .Cells(25, 15).FormulaLocal
    
    
    .Range("I3").Value = ""
    .Columns("K").EntireColumn.Hidden = False
    .Rows("26").EntireRow.Hidden = False
    .Rows("48").EntireRow.Hidden = False

    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Jahres-USt")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    If Worksheets("Grunddaten").Range("G39") = 1 Then
    .Rows("7:20").EntireRow.Hidden = False
    .Rows("21:30").EntireRow.Hidden = True
    .Rows("31:41").EntireRow.Hidden = False
    ElseIf Worksheets("Grunddaten").Range("G39") = 3 Then
    .Rows("7:16").EntireRow.Hidden = False
    .Rows("17:21").EntireRow.Hidden = True
    .Rows("22:25").EntireRow.Hidden = False
    .Rows("26:30").EntireRow.Hidden = True
    .Rows("31:41").EntireRow.Hidden = False
    ElseIf Worksheets("Grunddaten").Range("G39") = 12 Then
    .Rows("7:16").EntireRow.Hidden = False
    .Rows("17:26").EntireRow.Hidden = True
    .Rows("27:33").EntireRow.Hidden = False
    .Rows("34:41").EntireRow.Hidden = True
    End If
    .CommandButton2.Visible = True
    .CommandButton2.Top = 408
    .OptionButton3.Visible = True
    .OptionButton3.Top = 354
    .OptionButton4.Visible = True
    .OptionButton4.Top = 354
    .Rows("43:46").EntireRow.Hidden = True
    .Protect "bufovo30"
End With
    
With ThisWorkbook.Worksheets("E-Ue-Rechnung")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Rows("9:10").EntireRow.Hidden = False
    .Rows("24").EntireRow.Hidden = False
    .Range("A8") = "Umsatzsteuerpflichtige Betriebseinnahmen (ohne Direktverbrauch)"
    .Range("C3") = ""
    .Protect "bufovo30"
End With

Application.ScreenUpdating = True
    
End Sub

Private Sub OptionButton9_Click()
'Kleinunternehmer = ja
'*********************

   
If MsgBox("Die Kleinunternehmerregelung (KUR) gem|fffd||fffd| |fffd| 19 UStG ist eine Vereinfachungsregelung im Umsatzsteuerrecht, die Unternehmern mit niedrigen Ums|fffd|tzen ein Wahlrecht gew|fffd|hrt, weitgehend wie Nichtunternehmer behandelt zu werden." & vbCrLf & vbCrLf & "- Diese Regelung muss mit dem Finanzamt vereinbart worden sein." & vbCrLf & vbCrLf & "- Der Netzbetreiber muss Kenntnis von dieser Regelung haben, da er die Verg|fffd|tungen dann ohne Umsatzsteuer auszahlen muss." & vbCrLf & vbCrLf & "- Eine Umstellung zur KUR kann nur zu Beginn eines Steuerjahres erfolgen." & vbCrLf & vbCrLf & "Wollen Sie jetzt wirklich zur Kleinunternehmerregelung wechseln?", vbYesNo Or vbQuestion, "Bitte w|fffd|hlen Sie!") = vbNo Then
    OptionButton8.Value = True
    Exit Sub
End If


If Worksheets("Ausg.-Sammler").Range("M117").Value > 0 Then
    Worksheets("Grunddaten").OptionButton8.Value = True
    MsgBox "Sie m|fffd|ssen den Eintrag / die Eintr|fffd|ge im Blatt Ausgaben," & vbCrLf & "Konto Vorsteuer, entfernen!", vbCritical
    Exit Sub
End If

If Worksheets("A10TagesRegel").Range("H16").Value > 0 Then
    Worksheets("Grunddaten").OptionButton8.Value = True
    MsgBox "Sie m|fffd|ssen den Eintrag / die Eintr|fffd|ge im Tabellenblatt" & vbCrLf & " Ausgaben nach der 10-Tage-Regel, Konto Vorsteuer, entfernen!", vbCritical
    Exit Sub
End If

If Worksheets("A10TagesRegel").Range("H27").Value > 0 Then
    Worksheets("Grunddaten").OptionButton8.Value = True
    MsgBox "Sie m|fffd|ssen den Eintrag / die Eintr|fffd|ge im Tabellenblatt" & vbCrLf & " Ausgaben nach der 10-Tage-Regel, Konto Vorsteuer, entfernen!", vbCritical
    Exit Sub
End If

If Worksheets("Fahrtkosten").Range("M43").Value > 0 Then
    Worksheets("Grunddaten").OptionButton8.Value = True
    MsgBox "Sie m|fffd|ssen den Eintrag / die Eintr|fffd|ge im Blatt Fahrtkosten, " & vbCrLf & "Konto Umsatzsteuer, entfernen!", vbCritical
    Exit Sub
End If

If Worksheets("Einn.-Sammler").Range("I60").Value > 0 Then
    Worksheets("Grunddaten").OptionButton8.Value = True
    MsgBox "Sie m|fffd|ssen den Eintrag / die Eintr|fffd|ge im Blatt Einnahmen, " & vbCrLf & "Konto " & Chr(34) & "ust.freie ... Einnahmen" & Chr(34) & " entfernen!", vbCritical
    Exit Sub
End If


With ThisWorkbook.Worksheets("Grunddaten")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Range("G42").Value = 1
    .Range("G18").Value = 0
    .Range("G17").Interior.Pattern = xlPatternGray75
    .Range("G18").Interior.Pattern = xlPatternGray75
    .OptionButton1.Visible = False
    .OptionButton2.Visible = False
    .OptionButton3.Visible = False
    .CommandButton3.Visible = False
    .Range("G29").Value = "Kleinunternehmer-Modus"
    .Range("E5") = "Buchf|fffd|hrungs- und Steuertool f|fffd|r Photovoltaikanlagen"
    .Range("E17") = "Herstellungskosten"

    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Einn.-Sammler")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Range("D9").Value = "Netzbetreibers"
    .Columns("F:I").EntireColumn.Hidden = True
    .Rows("62").EntireRow.Hidden = True
    .Range("J3").Value = "Kleinunter- nehmer-Modus"
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("E10TagesRegel")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("G:I").EntireColumn.Hidden = True
    .Rows("19:28").EntireRow.Hidden = True
    .CommandButton3.Visible = False
    .Range("J4").Value = "Kleinunternehmer-Modus"
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Ausg.-Sammler")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("M").EntireColumn.Hidden = True
    .Rows("119").EntireRow.Hidden = True
    .Range("D6").Value = "Bitte hier die Rechnungsbetr|fffd|ge inkl. Mehrwertsteuer eintragen!"
    .Range("F2").Value = "Kleinunternehmer-Modus"
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("A10TagesRegel")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("H").EntireColumn.Hidden = True
    .Rows("18:27").EntireRow.Hidden = True
     .CommandButton3.Visible = False
    .Range("F3").Value = "Kleinunternehmer-Modus"
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Fahrtkosten")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Columns("M").EntireColumn.Hidden = True
    .Range("J3").Value = "Kleinunternehmer-Modus"
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Zusammenstellung")
'Formeln der Netto- und USt-Spalten kopiere
    Application.ScreenUpdating = Falsen
    .Unprotect "bufovo30"
    For j = 11 To 22
        .Cells(j, 4).FormulaLocal = ""
        .Cells(j, 5).FormulaLocal = ""
        .Cells(j, 6).FormulaLocal = ""
    Next j
    .Range("D23").Value = 0
    .Range("E23").Value = 0
    .Range("F23").Value = 0
    .Range("D25").Value = 0
    .Range("E25").Value = 0
    .Range("F25").Value = 0
    
    .Range("I3").Value = "Kleinunternehmer-Modus"
    .Columns("K").EntireColumn.Hidden = True
    .Rows("26").EntireRow.Hidden = True
    .Rows("48").EntireRow.Hidden = True
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("Jahres-USt")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Rows("7:41").EntireRow.Hidden = True
    .Rows("43:46").EntireRow.Hidden = False
    .CommandButton2.Visible = False
    .OptionButton3.Visible = False
    .OptionButton4.Visible = False
    .Protect "bufovo30"
End With

With ThisWorkbook.Worksheets("E-Ue-Rechnung")
    Application.ScreenUpdating = False
    .Unprotect "bufovo30"
    .Rows("9:10").EntireRow.Hidden = True
    .Rows("24").EntireRow.Hidden = True
    .Range("A8") = "Betriebseinnahmen (ohne Direktverbrauch)"
    .Range("C3") = "Kleinunternehmer-Modus"
    .Protect "bufovo30"
End With

Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Tabelle13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton14, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 4, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 5, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 7, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 8, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 10, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton7, 11, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton8, 12, 8, MSForms, CommandButton"
Attribute VB_Control = "CommandButton9, 13, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton10, 14, 10, MSForms, CommandButton"
Attribute VB_Control = "CommandButton11, 16, 11, MSForms, CommandButton"
Attribute VB_Control = "CommandButton12, 17, 12, MSForms, CommandButton"
Attribute VB_Control = "CommandButton13, 18, 13, MSForms, CommandButton"
Attribute VB_Control = "CommandButton15, 19, 14, MSForms, CommandButton"
Attribute VB_Control = "CommandButton16, 21, 15, MSForms, CommandButton"
Attribute VB_Control = "CommandButton17, 22, 16, MSForms, CommandButton"
Attribute VB_Control = "CommandButton18, 24, 17, MSForms, CommandButton"
Attribute VB_Control = "CommandButton19, 26, 18, MSForms, CommandButton"
Attribute VB_Control = "CommandButton20, 28, 19, MSForms, CommandButton"
Attribute VB_Control = "CommandButton21, 29, 20, MSForms, CommandButton"
'Schaltfl|fffd|che im Hilfsmen|fffd|
'--------------------------
Private Sub CommandButton14_Click()
Worksheets("Hilfsmenue").Visible = XlVerxHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton1_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Vorbemerkung.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub
Private Sub CommandButton2_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Menuefunktion.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub CommandButton21_Click()
Dim dokument As String
dokument = "http://www.pv-steuer.de/pages/direktverbrauch-ii.php"
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton3_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Grunddaten-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Grunddaten.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub
Private Sub CommandButton4_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Sammelposten-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Sammelposten.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton5_Click()
Dim dokument As String
dokument = "https://www.pv-steuer.com/pages/faq.php"
ThisWorkbook.FollowHyperlink dokument

End Sub
Private Sub CommandButton6_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Einnahmen-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Einnahmen.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton7_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Ausgaben-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Ausgaben.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton8_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Fahrtkosten-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Fahrtkosten.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton9_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Zusammenstellung-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Zusammenstellung.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton10_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Abschreibungsarten.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub
Private Sub CommandButton11_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Abschreibungstabellen.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub
Private Sub CommandButton12_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Abschreibung-WG-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Abschreibung-WG.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton13_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Investitionsabzugsbetrag.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub
Private Sub CommandButton19_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\E-Ue-Rechnung-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\E-Ue-Rechnung.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub CommandButton15_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    MsgBox "Im Kleinunternehmer-Modus ist keine Umsatzsteuer-Voranmeldung abzugeben!"
    Exit Sub
End If
dokument = ThisWorkbook.Path & "\Hilfe\UST-Voranmeldung.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub CommandButton16_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\UST-Jahresmeldung-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\UST-Jahresmeldung.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub
Private Sub CommandButton17_Click()
Dim dokument As String
dokument = "https://www.pv-steuer.com/pages/news.php"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub CommandButton18_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Dateifunktionen.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub CommandButton20_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Abrechnung.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub



Attribute VB_Name = "Tabelle14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 32, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 33, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 41, 3, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("A10TagesRegel").Visible = xlVeryHidden
Worksheets("Ausg.-Sammler").Visible = True
Worksheets("Ausg.-Sammler").Activate

End Sub

Private Sub CommandButton2_Click()
Worksheets("A10TagesRegel").Unprotect "bufovo30"
Range("A10:H15").Interior.Color = vbWhite
Range("B10:H15").Sort Key1:=Range("B10:B15")
For i = 10 To 15 Step 2
For j = 1 To 8
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("A10TagesRegel").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("A10TagesRegel").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton3_Click()
Worksheets("A10TagesRegel").Unprotect "bufovo30"
Range("A21:H26").Interior.Color = vbWhite
Range("B21:H26").Sort Key1:=Range("B21:B26")
For i = 21 To 26 Step 2
For j = 1 To 8
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i

If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("A10TagesRegel").Protect "bufovo30"
Else
    ThisWorkbook.Worksheets("A10TagesRegel").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton4_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Ausgaben-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Ausgaben.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

'Private Sub Worksheet_Change(ByVal Target As Range)

'Application.ScreenUpdating = True

'End Sub

Attribute VB_Name = "Tabelle15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 28, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 15, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()

If Worksheets("Abrechnung").Range("c9").Value = "" And Worksheets("Abrechnung").Range("c11") <> "" Then
    MsgBox "Sie m|fffd|ssen ein Abrechnungsdatum angeben!", vbCritical, "Fehler!"
    GoTo aus
End If
    
If Worksheets("Abrechnung").Range("c9").Value = "" And (Worksheets("Abrechnung").Range("b18").Value <> 0 Or Worksheets("Abrechnung").Range("c18").Value <> 0) Then
    MsgBox "Sie m|fffd|ssen ein Abrechnungsdatum angeben!", vbCritical, "Fehler!"
    GoTo aus
End If

If Worksheets("Abrechnung").Range("c9").Value <> "" And Year(Worksheets("Abrechnung").Range("c9")) <> Worksheets("Grunddaten").Range("C27") Then
    MsgBox "Das Datum der Abrechnungszahlung muss im Buchungsjahr " & Worksheets("Grunddaten").Range("C27") & " liegen!"
    Exit Sub
End If


Worksheets("Abrechnung").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
aus:

End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Abrechnung.pdf"
ThisWorkbook.FollowHyperlink dokument
End Sub
Attribute VB_Name = "Tabelle16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OptionButton1, 1, 0, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 2, 1, MSForms, OptionButton"
Attribute VB_Control = "CommandButton1, 7, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 8, 4, MSForms, CommandButton"
Private Sub CommandButton1_Click()
'Zur|fffd|ck zu den Grunddaten
Application.ScreenUpdating = False
Worksheets("ueWA").Visible = xlVeryHidden
Worksheets("Grunddaten").Visible = True
Worksheets("Grunddaten").Activate
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()
'Zur Umsatzsteuererkl|fffd|rung
Application.ScreenUpdating = False
Worksheets("ueWA").Visible = xlVeryHidden
Worksheets("Jahres-UST").Visible = True
Worksheets("Jahres-UST").Activate
If Worksheets("Grunddaten").Range("G39").Value < 12 Then
    ThisWorkbook.Worksheets("Jahres-USt").Range("B39").Select
Else
    ThisWorkbook.Worksheets("Jahres-USt").Range("B5").Select
End If
Application.ScreenUpdating = True
End Sub

Private Sub OptionButton1_Click()
' Umschalten auf 1 Energieversorger
Application.ScreenUpdating = False
If Range("D28") > 0 Or (Cells(10, 2).Value + Cells(23, 2).Value) > 12 Then
    MsgBox "Bitte l|fffd|schen Sie zuerst die Daten beim 2. EVU!", vbCritical
    OptionButton2.Value = True
    Application.ScreenUpdating = True
    Exit Sub
End If
' Zeilen des 2. EVU ausblenden
With ThisWorkbook.Worksheets("ueWA")
    .Unprotect ""
    .Rows("18:28").EntireRow.Hidden = True
    .Protect
End With
Application.ScreenUpdating = True


End Sub

Private Sub OptionButton2_Click()
' Zeilen des 2. EVU einblenden
Application.ScreenUpdating = False
With ThisWorkbook.Worksheets("ueWA")
    .Unprotect
    .Rows("18:28").EntireRow.Hidden = False
    .Protect
End With
Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "Tabelle17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "OptionButton1, 2, 1, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 3, 2, MSForms, OptionButton"
Attribute VB_Control = "CommandButton2, 20, 3, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("E-Ue-Rechnung").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\E-Ue-Rechnung-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\E-Ue-Rechnung.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub OptionButton1_Click()
ActiveSheet.PageSetup.PrintArea = "A1:B69"
End Sub

Private Sub OptionButton2_Click()
ActiveSheet.PageSetup.PrintArea = "A1:C69"
End Sub
Attribute VB_Name = "Tabelle18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton7, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton8, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton10, 25, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton11, 10, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton13, 11, 10, MSForms, CommandButton"
Attribute VB_Control = "CommandButton18, 48, 11, MSForms, CommandButton"
Attribute VB_Control = "CommandButton14, 13, 12, MSForms, CommandButton"
Attribute VB_Control = "CommandButton17, 14, 13, MSForms, CommandButton"
Attribute VB_Control = "CommandButton12, 15, 14, MSForms, CommandButton"
Attribute VB_Control = "CommandButton16, 16, 15, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 17, 16, MSForms, CommandButton"
Attribute VB_Control = "CheckBox1, 46, 17, MSForms, CheckBox"
Attribute VB_Control = "CommandButton15, 45, 18, MSForms, CommandButton"
Attribute VB_Control = "CommandButton9, 26, 19, MSForms, CommandButton"

Private Sub CommandButton1_Click()
'Grunddaten eintragen
If Worksheets("Grunddaten").Range("C30") = "update" Then
   MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
   Exit Sub
End If
    
    'Worksheets("AfA1_lin_mZ").Visible = xlVeryHidden
    'Worksheets("AfA1_deg_mZ").Visible = xlVeryHidden
    Worksheets("E-Ue-Rechnung").Visible = xlVeryHidden
Worksheets("Grunddaten").Visible = True
Worksheets("Grunddaten").Activate

' Verkleinerung der Schriftgr|fffd||fffd|e bei langen Namenseintr|fffd|gen
N_Eintrag = Worksheets("Grunddaten").Range("C15")

If Len(N_Eintrag) > 29 Then
    Worksheets("Grunddaten").Unprotect "bufovo30"
    Worksheets("Grunddaten").Range("C15").Font.Size = 9
    Worksheets("Grunddaten").Protect "bufovo30"
End If

'Worksheets("Grunddaten").ListBox1.Visible = True
End Sub
Private Sub CommandButton10_Click()
'EUe-Rechnung
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
AfA1 = Worksheets("Grunddaten").Range("E39")
HK = Worksheets("Grunddaten").Range("E18")
HD = Worksheets("Grunddaten").Range("E15")

If AfA1 = 0 Or HK = "" Or HD = "" Then
    If MsgBox("Wollen Sie zun|fffd|chst die fehlenden Anlagendaten eintragen?", vbYesNo Or Question, "Daten eintragen") = vbYes Then
    Worksheets("Grunddaten").Visible = True
    Worksheets("Grunddaten").Activate
    GoTo ohne
    End If
End If

Worksheets("E-Ue-Rechnung").Visible = True
Worksheets("E-Ue-Rechnung").Activate

ohne:

End Sub

Private Sub CommandButton11_Click()
'PV-Steuer-Dateien ausgeben
Dim Dateiname As String
Dim ausgabe As String
Dim pfad As String

Application.ScreenUpdating = False
pfad = ThisWorkbook.Path
Dateiname = Dir(ThisWorkbook.Path & "\*.xl*")
ausgabe = "Vorhandene Excel-Dateien im Verzeichnis " & vpCrLf & pfad & ":" & vbCrLf & vbCrLf
Do While Dateiname <> ""
    ausgabe = ausgabe & Dateiname & vbCrLf
    Dateiname = Dir
Loop
MsgBox ausgabe
Application.ScreenUpdating = True

End Sub
Private Sub CommandButton12_Click()
'Daten|fffd|bernahme
Dim Erfolg As Boolean
Dim Datei As String
Dim Dateiname As String
Dim i As Integer
Dim j As Integer
Dim k As Integer

On Error GoTo fehler

Application.ScreenUpdating = False

If Not Worksheets("Grunddaten").Range("C30") = "update" Then
    MsgBox "Diese Funktion kann nur aus einer Update-Datei gestartet werden!" & vbCrLf & vbCrLf & "Das Update-File k|fffd|nnen Sie herunterladen, wenn Sie auf dieser Seite auf die Schaltfl|fffd|che " & Chr(34) & "Update verf|fffd|gbar?" & Chr(34) & "klicken.", vbCritical
    Exit Sub
End If

Worksheets("Grunddaten").Unprotect "bufovo30"

MsgBox "Mit dieser Funktion |fffd|bernehmen Sie die Daten 1 zu 1 aus einer |fffd|lteren Programmversion in die vorliegende neuere Version." & vbCrLf & vbCrLf & "Auch das Buchungsjahr bleibt identisch!", vbExclamation

If MsgBox("Sie m|fffd|ssen nun die Datei ausw|fffd|hlen, aus der die Daten importiert werden sollen. Diese Datei bleibt beim Import v|fffd|llig unver|fffd|ndert." & vbCrLf & vbCrLf & "Wollen Sie den Datenimport jetzt durchf|fffd|hren?", vbYesNo Or vbQuestion, "Bitte w|fffd|hlen Sie!") = vbNo Then
    GoTo unsichtbar
End If
Erfolg = Application.Dialogs(xlDialogOpen).Show(arg1:=ThisWorkbook.Path & "\*.xl*")
If Not Erfolg Then
    MsgBox "Sie haben keine Datei zum Datenimport ausgew|fffd|hlt!"
    GoTo unsichtbar
End If

'Test, ob Vorlage kompatibel

If Worksheets("Eingang").Range("G24").Value < 435 Then
   MsgBox "Update und Datendatei sind nicht miteinander kompatibel." & vbCrLf & vbCrLf & "F|fffd|r die verwendete Datendatei ben|fffd|tigen Sie das Update der Version 4.35!" & vbCrLf & vbCrLf & "Die Daten|fffd|bernahme wird nun abgebrochen!", vbCritical, "Dateien nicht kompatibel!"
   DisplayAlerts = False
   ActiveWorkbook.Close savechanges:=False
   DisplayAlerts = True
   GoTo unsichtbar
End If


If Worksheets("Grunddaten").Range("C30") = "update" Then
   MsgBox "Sie haben eine Updatedatei als Datenquelle ausgew|fffd|hlt." & vbCrLf & "Dies w|fffd|rde nur eine sinnlose Datei ohne Daten erzeugen." & vbCrLf & vbCrLf & "Beachten Sie die richtige Reihenfolge des Update-Vorgangs:" & vbCrLf & "- Starten Sie zuerst die Update-Datei!" & vbCrLf & "- Klicken Sie in ihr auf Daten|fffd|bernahme!" & vbCrLf & "- W|fffd|hlen Sie dann Ihre aktuellen Datendatei" & vbCrLf & vbCrLf & "Die Daten|fffd|bernahme wird nun abgebrochen!", vbCritical, "Falsche Datendatei!"
   DisplayAlerts = False
   ActiveWorkbook.Close savechanges:=False
   DisplayAlerts = True
   GoTo unsichtbar
End If


If Worksheets("Eingang").Range("A1") <> "PV - Steuer - Direktverbrauch II" And Worksheets("Eingang").Range("A1") <> "PV - Steuer - Direktverbrauch" Then
   MsgBox "Mit dieser Datei k|fffd|nnen Sie nur Daten aus PV-Steuer-Direktverbrauch oder Direktverbrauch II |fffd|bernehmen! " & vbCrLf & vbCrLf & "Dies ist eine Version von " & Worksheets("Eingang").Range("A1").Value & "!" & vbCrLf & vbCrLf & "Der Daten|fffd|bertrag wird nun abgebrochen!", vbCritical
   DisplayAlerts = False
   ActiveWorkbook.Close savechanges:=False
   DisplayAlerts = True
   GoTo unsichtbar
End If
   
If Worksheets("Eingang").Range("A1") <> "PV - Steuer - Direktverbrauch II" And Worksheets("Grunddaten").Range("G18") > 0 Then
   MsgBox "Dieses Programm verwaltet nur Anlagen, bei denen der Direktverbrauch nicht mehr verg|fffd|tet wird! " & vbCrLf & vbCrLf & "In der Quelldatei ist jedoch eine Verg|fffd|tung des DV in H|fffd|he von  " & vbCrLf & Worksheets("Grunddaten").Range("G18").Value & " ct/kWh eingetragen!" & vbCrLf & vbCrLf & "Ihre PV-Anlage kann nicht mit diesem Programm verwaltet werden. Die Daten|fffd|bernahme wird nun abgebrochen!", vbCritical
   DisplayAlerts = False
   ActiveWorkbook.Close savechanges:=False
   DisplayAlerts = True
   GoTo unsichtbar
End If



For Each seite In ActiveWorkbook.Sheets ' Namen aller Tabellen pr|fffd|fen
        If seite.Name = "ueWA" Then
            seitevorhanden = True
            GoTo endseite
            End If
   Next seite
seitevorhanden = False
endseite:

Worksheets("Grunddaten").Unprotect "bufovo30"

'Eintrag m|fffd|glicher Sonderabschreibungen und Pachten
        
Anlage1:
'|fffd|nderung der Abschreibung
ab1 = Worksheets("Grunddaten").Range("E39")

If ab1 = 1 Then
    ThisWorkbook.Worksheets("Grunddaten").OptionButton4.Value = False
    ThisWorkbook.Worksheets("Grunddaten").OptionButton5.Value = True
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.ListFillRange = "J28:J29"
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.Value = "linear ohne Sonderabschreibung"

ElseIf ab1 = 2 Then
    ThisWorkbook.Worksheets("Grunddaten").OptionButton5.Value = False
    ThisWorkbook.Worksheets("Grunddaten").OptionButton4.Value = True
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.ListFillRange = "J31:J32"
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.Value = "linear mit Sonderabschreibung"

ElseIf ab1 = 3 Then
    ThisWorkbook.Worksheets("Grunddaten").OptionButton4.Value = False
    ThisWorkbook.Worksheets("Grunddaten").OptionButton5.Value = True
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.ListFillRange = "J28:J29"
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.Value = "degressiv ohne Sonderabschreibung"
    
ElseIf ab1 = 4 Then
    ThisWorkbook.Worksheets("Grunddaten").OptionButton5.Value = False
    ThisWorkbook.Worksheets("Grunddaten").OptionButton4.Value = True
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.ListFillRange = "J31:J32"
    ThisWorkbook.Worksheets("Grunddaten").ListBox1.Value = "degressiv mit Sonderabschreibung"
        
End If

'|fffd|nderung der Vorauszahlungsart
vor1 = Worksheets("Grunddaten").Range("G39")
vor2 = ThisWorkbook.Worksheets("Grunddaten").Range("G39")

If vor1 <> vor2 Then
    If Worksheets("Grunddaten").Range("G39") = 1 Then
        ThisWorkbook.Worksheets("Grunddaten").OptionButton1.Value = True
        ThisWorkbook.Worksheets("Grunddaten").OptionButton2.Value = False
        ThisWorkbook.Worksheets("Grunddaten").OptionButton3.Value = False
    ElseIf Worksheets("Grunddaten").Range("G39") = 3 Then
        ThisWorkbook.Worksheets("Grunddaten").OptionButton1.Value = False
        ThisWorkbook.Worksheets("Grunddaten").OptionButton2.Value = True
        ThisWorkbook.Worksheets("Grunddaten").OptionButton3.Value = False
    ElseIf Worksheets("Grunddaten").Range("G39") = 12 Then
        ThisWorkbook.Worksheets("Grunddaten").OptionButton1.Value = False
        ThisWorkbook.Worksheets("Grunddaten").OptionButton2.Value = False
        ThisWorkbook.Worksheets("Grunddaten").OptionButton3.Value = True
    End If
End If


'Abschreibungstabellen kopieren
    
If ThisWorkbook.Sheets("Grunddaten").Range("E39") = 1 Then
'linear ohne Sonderabschreibung
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("D44:F44").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("D44:F44").Value
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("E15:E35").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("E15:E35").Value
    
    'Kopieren Ausgeschieden-Datum und IAB
    If ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J10").Value = "ausgeschieden" Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J12").Value
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value
        
    ElseIf ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K10").Value = "ausgeschieden" Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value
        
    Else
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J12").Value
    End If

ElseIf ThisWorkbook.Sheets("Grunddaten").Range("E39") = 2 Then
'linear mit Sonderabschreibung
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Unprotect "bufovo30"
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("G15:G19").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("G15:G19").Value
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("D44:F44").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("D44:F44").Value
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("E15:E35").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("E15:E35").Value
    
    'Kopieren "datev-kompatibel"
    If ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("H12") = "" Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("H12").Value = "nein"
    Else
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("H12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("H12").Value
    End If

    'Kopieren Ausgeschieden-Datum und IAB
    If ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J10").Value = "ausgeschieden" Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J12").Value
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value
        
    ElseIf ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K10").Value = "ausgeschieden" Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K12").Value
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value
        
    Else
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("L12").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J12").Value
    End If
    
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Protect "bufovo30"

ElseIf ThisWorkbook.Sheets("Grunddaten").Range("E39") = 3 Then
'degressiv ohne Sonderabschreibung
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("D44:F44").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("D44:F44").Value
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("E15:E35").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("E15:E35").Value
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("J12").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("J12").Value
    If ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("J9") <> "" Then
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Unprotect "bufovo30"
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("J9").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("J9").Value
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Protect "bufovo30"
    End If
    
ElseIf ThisWorkbook.Sheets("Grunddaten").Range("E39") = 4 Then
'degressiv mit Sonderabschreibung
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Unprotect "bufovo30"
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("G15:G19").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("G15:G19").Value
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("D44:F44").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("D44:F44").Value
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("E15:E35").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("E15:E35").Value
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("J12").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("J12").Value
    If ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("J9") <> "" Then
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Unprotect "bufovo30"
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("J9").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("J9").Value
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Protect "bufovo30"
    End If
    
    If Application.version = "9.0" Or Application.version = "10.0" Then
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Protect "bufovo30"
    Else
        ThisWorkbook.Worksheets("AfA1_deg_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    End If

End If

'Eintrag der Werte in das Blatt Grunddaten
ThisWorkbook.Worksheets("Grunddaten").Unprotect "bufovo30"
ThisWorkbook.Worksheets("Grunddaten").ListBox1.Visible = False

If ActiveWorkbook.Worksheets("Eingang").Range("F21").Value = "Testversion m. beschr|fffd|nkter Laufzeit" Then
    GoTo testversion
End If


Application.SendKeys ("{NumLock}")
ThisWorkbook.Worksheets("Grunddaten").Range("C15").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("C15").Value
ThisWorkbook.Worksheets("Grunddaten").Range("C18").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("C18").Value
ThisWorkbook.Worksheets("Grunddaten").Range("C21").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("C21").Value
ThisWorkbook.Worksheets("Grunddaten").Range("C30").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("C30").Value
If ActiveWorkbook.Worksheets("Grunddaten").Range("L11") = "Notizen" Then
    ThisWorkbook.Worksheets("Grunddaten").Range("L13:L30").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("L13:L30").Value
End If

testversion:
'von Testversionen wird nur Steuernummer und Buchungsjahr bei den Grundddaten kopiert
ThisWorkbook.Worksheets("Grunddaten").Range("C24").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("C24").Value
ThisWorkbook.Worksheets("Grunddaten").Range("C27").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("C27").Value
ThisWorkbook.Worksheets("Grunddaten").Range("E15").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("E15").Value
ThisWorkbook.Worksheets("Grunddaten").Range("E18").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("E18").Value
ThisWorkbook.Worksheets("Grunddaten").Range("G15").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("G15").Value
ThisWorkbook.Worksheets("Grunddaten").Range("G21").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("G21").Value

If ActiveWorkbook.Worksheets("Eingang").Range("A1") = "PV - Steuer - Direktverbrauch" Then
    ThisWorkbook.Worksheets("Grunddaten").Range("G18").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("G15").Value
Else
    ThisWorkbook.Worksheets("Grunddaten").Range("G18").Value = ActiveWorkbook.Worksheets("Grunddaten").Range("G18").Value
End If


keinEintrag:

'ueWA ab V. 4.33
If seitevorhanden And ActiveWorkbook.Worksheets("ueWA").Range("A4") = "Berechnung f|fffd|r das Steuerjahr" Then

    ThisWorkbook.Worksheets("ueWA").Range("B7:B10").Value = ActiveWorkbook.Worksheets("ueWA").Range("B7:B10").Value
    ThisWorkbook.Worksheets("ueWA").Range("B13:B14").Value = ActiveWorkbook.Worksheets("ueWA").Range("B13:B14").Value
    ThisWorkbook.Worksheets("ueWA").Range("B33").Value = ActiveWorkbook.Worksheets("ueWA").Range("B33").Value
    
    If ActiveWorkbook.Worksheets("ueWA").OptionButton2.Value = True Then
        ThisWorkbook.Worksheets("ueWA").OptionButton1.Value = False
        ThisWorkbook.Worksheets("ueWA").OptionButton2.Value = True
        ThisWorkbook.Worksheets("ueWA").Range("B20:B23").Value = ActiveWorkbook.Worksheets("ueWA").Range("B20:B23").Value
        ThisWorkbook.Worksheets("ueWA").Range("B26:B27").Value = ActiveWorkbook.Worksheets("ueWA").Range("B26:B27").Value
    End If
    
End If


'bis V.4.32
If seitevorhanden And ActiveWorkbook.Worksheets("ueWA").Range("A4") <> "Berechnung f|fffd|r das Steuerjahr" Then

    ThisWorkbook.Worksheets("ueWA").Range("B7:B9").Value = ActiveWorkbook.Worksheets("ueWA").Range("B6:B8").Value
    ThisWorkbook.Worksheets("ueWA").Range("B10").Value = 12
    If ActiveWorkbook.Worksheets("ueWA").Range("A11") = "Einmalrabatt" Then
        ThisWorkbook.Worksheets("ueWA").Range("B13:B14").Value = ActiveWorkbook.Worksheets("ueWA").Range("B11:B12").Value
        ThisWorkbook.Worksheets("ueWA").Range("B33").Value = ActiveWorkbook.Worksheets("ueWA").Range("B16").Value
    End If
    
End If



If Application.version = "9.0" Or Application.version = "10.0" Then
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30"
    Worksheets("Grunddaten").Protect "bufovo30"
 Else
    ThisWorkbook.Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
    Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If

'L|fffd|schen der 10-TageRegel-Tabellen
ThisWorkbook.Worksheets("E10TagesRegel").Range("A10:E16").ClearContents
ThisWorkbook.Worksheets("E10TagesRegel").Range("I10:J16").ClearContents
ThisWorkbook.Worksheets("E10TagesRegel").Range("A21:E27").ClearContents
ThisWorkbook.Worksheets("A10TagesRegel").Range("A10:H15").ClearContents
ThisWorkbook.Worksheets("A10TagesRegel").Range("A21:H26").ClearContents

'Eintrag von Einnahmen aus V.2 und V.3
ThisWorkbook.Worksheets("Einn.-Sammler").Range("B10:B58").Value = ActiveWorkbook.Worksheets("Einn.-Sammler").Range("B10:B58").Value
ThisWorkbook.Worksheets("Einn.-Sammler").Range("D10:D58").Value = ActiveWorkbook.Worksheets("Einn.-Sammler").Range("D10:D58").Value

For i = 10 To 58
    ActiveWorkbook.Worksheets("Einn.-Sammler").Cells(i, 3).Copy Destination:=ThisWorkbook.Worksheets("Einn.-Sammler").Cells(i, 3)
Next i

ThisWorkbook.Worksheets("Einn.-Sammler").Range("I10:J58").Value = ActiveWorkbook.Worksheets("Einn.-Sammler").Range("I10:J58").Value
ThisWorkbook.Worksheets("E10TagesRegel").Range("A10:D16").Value = ActiveWorkbook.Worksheets("E10TagesRegel").Range("A10:D16").Value
ThisWorkbook.Worksheets("E10TagesRegel").Range("A21:D27").Value = ActiveWorkbook.Worksheets("E10TagesRegel").Range("A21:D27").Value
ThisWorkbook.Worksheets("E10TagesRegel").Range("I10:J16").Value = ActiveWorkbook.Worksheets("E10TagesRegel").Range("I10:J16").Value

'Eintrag von Einnahmen aus V 2.x
If ActiveWorkbook.Worksheets("Einn.-Sammler").Range("E8") = "Einbehalt f|fffd|r" Then
    For i = 10 To 58
        ThisWorkbook.Worksheets("Einn.-Sammler").Cells(i, 5) = ActiveWorkbook.Worksheets("Einn.-Sammler").Cells(i, 6).Value
    Next i
    For i = 10 To 16
        ThisWorkbook.Worksheets("E10TagesRegel").Cells(i, 5) = ActiveWorkbook.Worksheets("E10TagesRegel").Cells(i, 6).Value
    Next i
    For i = 21 To 27
        ThisWorkbook.Worksheets("E10TagesRegel").Cells(i, 5) = ActiveWorkbook.Worksheets("E10TagesRegel").Cells(i, 6).Value
    Next i
    
GoTo neueversion
End If

'Eintrag von Einnahmen aus V. 3.x
ThisWorkbook.Worksheets("Einn.-Sammler").Range("E10:E58").Value = ActiveWorkbook.Worksheets("Einn.-Sammler").Range("E10:E58").Value
'Kopieren der Einnahmen-10-TR-E|fffd|R-Tabelle
ThisWorkbook.Worksheets("E10TagesRegel").Range("E10:E16").Value = ActiveWorkbook.Worksheets("E10TagesRegel").Range("E10:E16").Value
'Kopieren der Einnahmen-10TR-UST-Tabelle
ThisWorkbook.Worksheets("E10TagesRegel").Range("E21:E27").Value = ActiveWorkbook.Worksheets("E10TagesRegel").Range("E21:E27").Value

neueversion:

'Eintrag Abrechnung
'ThisWorkbook.Worksheets("Abrechnung").Range("C9").Value = ActiveWorkbook.Worksheets("Abrechnung").Range("C9").Value
'ThisWorkbook.Worksheets("Abrechnung").Range("C11").Value = ActiveWorkbook.Worksheets("Abrechnung").Range("C11").Value

ActiveWorkbook.Worksheets("Abrechnung").Cells(9, 3).Copy Destination:=ThisWorkbook.Worksheets("Abrechnung").Cells(9, 3)
ActiveWorkbook.Worksheets("Abrechnung").Cells(11, 3).Copy Destination:=ThisWorkbook.Worksheets("Abrechnung").Cells(11, 3)


'Eintrag von Ausgaben, Fahrtkosten, E|fffd|R-Feldern, Sammelposten
ThisWorkbook.Worksheets("Ausg.-Sammler").Range("B9:B59").Value = ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("B9:B59").Value
ThisWorkbook.Worksheets("Ausg.-Sammler").Range("D9:M59").Value = ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("D9:M59").Value

If ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("N7") = "Arbeitsmittel" Then
    ThisWorkbook.Worksheets("Ausg.-Sammler").Range("N9:N59").Value = ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("N9:N59").Value
    ThisWorkbook.Worksheets("Ausg.-Sammler").Range("N68:N116").Value = ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("N68:N116").Value
End If


For j = 9 To 59
    ActiveWorkbook.Worksheets("Ausg.-Sammler").Cells(j, 3).Copy Destination:=ThisWorkbook.Worksheets("Ausg.-Sammler").Cells(j, 3)
Next j


ThisWorkbook.Worksheets("Ausg.-Sammler").Range("B68:B116").Value = ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("B68:B116").Value
ThisWorkbook.Worksheets("Ausg.-Sammler").Range("D68:M116").Value = ActiveWorkbook.Worksheets("Ausg.-Sammler").Range("D68:M116").Value

For k = 68 To 116
    ActiveWorkbook.Worksheets("Ausg.-Sammler").Cells(k, 3).Copy Destination:=ThisWorkbook.Worksheets("Ausg.-Sammler").Cells(k, 3)
Next k

'Kopieren der Ausgaben-10-TR-Tabelle
ThisWorkbook.Worksheets("A10TagesRegel").Range("A10:H15").Value = ActiveWorkbook.Worksheets("A10TagesRegel").Range("A10:H15").Value
ThisWorkbook.Worksheets("A10TagesRegel").Range("A21:H26").Value = ActiveWorkbook.Worksheets("A10TagesRegel").Range("A21:H26").Value
ThisWorkbook.Worksheets("Fahrtkosten").Range("B14:D42").Value = ActiveWorkbook.Worksheets("Fahrtkosten").Range("B14:D42").Value

'Kopieren der Fahrtkosten
ThisWorkbook.Worksheets("Fahrtkosten").Range("G14:J42").Value = ActiveWorkbook.Worksheets("Fahrtkosten").Range("G14:J42").Value
ThisWorkbook.Worksheets("Fahrtkosten").Range("L14:L42").Value = ActiveWorkbook.Worksheets("Fahrtkosten").Range("L14:L42").Value
If ActiveWorkbook.Worksheets("Fahrtkosten").Range("M12") = "Umsatz-" Then
   ThisWorkbook.Worksheets("Fahrtkosten").Range("M14:M42").Value = ActiveWorkbook.Worksheets("Fahrtkosten").Range("M14:M42").Value
End If
 
'Kopieren der E|fffd|R-Variablen
If ActiveWorkbook.Worksheets("E-Ue-Rechnung").Range("A18").Value = "Restbuchwert der ausgeschiedenen Anlageg|fffd|ter" Then
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Range("B32").Value = ActiveWorkbook.Worksheets("E-Ue-Rechnung").Range("B32").Value
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Range("B71").Value = ActiveWorkbook.Worksheets("E-Ue-Rechnung").Range("B71").Value
Else
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Range("B32").Value = ActiveWorkbook.Worksheets("E-Ue-Rechnung").Range("B31").Value
    ThisWorkbook.Worksheets("E-Ue-Rechnung").Range("B71").Value = ActiveWorkbook.Worksheets("E-Ue-Rechnung").Range("B68").Value
End If

ThisWorkbook.Worksheets("AfA-WG").Range("A7") = ActiveWorkbook.Worksheets("AfA-WG").Range("A7").Value
ThisWorkbook.Worksheets("AfA-WG").Range("E7") = ActiveWorkbook.Worksheets("AfA-WG").Range("E7").Value
ThisWorkbook.Worksheets("AfA-WG").Range("A33") = ActiveWorkbook.Worksheets("AfA-WG").Range("A33").Value
ThisWorkbook.Worksheets("AfA-WG").Range("E33") = ActiveWorkbook.Worksheets("AfA-WG").Range("E33").Value
ThisWorkbook.Worksheets("AfA-WG").Range("C8") = ActiveWorkbook.Worksheets("AfA-WG").Range("C8").Value
ThisWorkbook.Worksheets("AfA-WG").Range("G8") = ActiveWorkbook.Worksheets("AfA-WG").Range("G8").Value
ThisWorkbook.Worksheets("AfA-WG").Range("C34") = ActiveWorkbook.Worksheets("AfA-WG").Range("C34").Value
ThisWorkbook.Worksheets("AfA-WG").Range("G34") = ActiveWorkbook.Worksheets("AfA-WG").Range("G34").Value

ThisWorkbook.Worksheets("AfA-WG").Range("A11:C11").Value = ActiveWorkbook.Worksheets("AfA-WG").Range("A11:C11").Value
ThisWorkbook.Worksheets("AfA-WG").Range("E11:G11").Value = ActiveWorkbook.Worksheets("AfA-WG").Range("E11:G11").Value
ThisWorkbook.Worksheets("AfA-WG").Range("A37:C37").Value = ActiveWorkbook.Worksheets("AfA-WG").Range("A37:C37").Value
ThisWorkbook.Worksheets("AfA-WG").Range("E37:G37").Value = ActiveWorkbook.Worksheets("AfA-WG").Range("E37:G37").Value

'Kopieren der Sammelposten
ThisWorkbook.Worksheets("Sammelposten").Range("B9:D25").Value = ActiveWorkbook.Worksheets("Sammelposten").Range("B9:D25").Value
ThisWorkbook.Worksheets("Sammelposten").Range("C39:C42").Value = ActiveWorkbook.Worksheets("Sammelposten").Range("C39:C42").Value

'Kopieren der ueWA-Jahreskorrektur
ThisWorkbook.Worksheets("Jahres-USt").Range("B39").Value = ActiveWorkbook.Worksheets("Jahres-USt").Range("B39").Value

'Umschalten auf manuelles Vorauszahlungssoll
vzs1 = ActiveWorkbook.Worksheets("Jahres-USt").Range("G20").Value
If vzs1 = 1 Then
    ThisWorkbook.Worksheets("Jahres-USt").OptionButton3.Value = True
    ThisWorkbook.Worksheets("Jahres-USt").OptionButton4.Value = False
    ThisWorkbook.Worksheets("Jahres-USt").Range("C19").Value = ActiveWorkbook.Worksheets("Jahres-USt").Range("C19").Value
    ThisWorkbook.Worksheets("Jahres-USt").Range("C24").Value = ActiveWorkbook.Worksheets("Jahres-USt").Range("C24").Value
    ThisWorkbook.Worksheets("Jahres-USt").Range("C29").Value = ActiveWorkbook.Worksheets("Jahres-USt").Range("C29").Value
 End If
    
'Umschalten auf manuelle lineare Abschreibungswerte

If ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J10").Value = "ausgeschieden" Or ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K10").Value = "ausgeschieden" Then
    afaman_lin = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("M13").Value
    
    'Kopieren einer m|fffd|glichen Laufzeitverk|fffd|rzung
    Laufzeitkurz = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K8").Value
    If Laufzeitkurz > 0 Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("K8").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("K8").Value
    End If
Else
    afaman_lin = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("L13").Value
    Laufzeitkurz = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J8").Value
    If Laufzeitkurz > 0 Then
        ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("J8").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J8").Value
    End If
End If

If afaman_lin = 1 Then
    ThisWorkbook.Worksheets("AfA1_lin_mZ").OptionButton1.Value = True
    ThisWorkbook.Worksheets("AfA1_lin_mZ").OptionButton2.Value = False
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("F15:F35").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("F15:F35").Value
Else
    ThisWorkbook.Worksheets("AfA1_lin_mZ").OptionButton1.Value = False
    ThisWorkbook.Worksheets("AfA1_lin_mZ").OptionButton2.Value = True

 End If
 

 
'Kopieren von Teilabschreibungen in linearer Tabelle
If ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J14") = "Teil-Abg|fffd|nge" Then
    ThisWorkbook.Worksheets("AfA1_lin_mZ").Range("J15:J35").Value = ActiveWorkbook.Worksheets("AfA1_lin_mZ").Range("J15:J35").Value
End If

 
 'Umschalten auf manuelle degressive Abschreibungswerte
afaman_deg = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("M13").Value
If afaman_deg = 1 Then
    ThisWorkbook.Worksheets("AfA1_deg_mZ").OptionButton1.Value = True
    ThisWorkbook.Worksheets("AfA1_deg_mZ").OptionButton2.Value = False
    ThisWorkbook.Worksheets("AfA1_deg_mZ").Range("F15:F35").Value = ActiveWorkbook.Worksheets("AfA1_deg_mZ").Range("F15:F35").Value
Else
    ThisWorkbook.Worksheets("AfA1_deg_mZ").OptionButton1.Value = False
    ThisWorkbook.Worksheets("AfA1_deg_mZ").OptionButton2.Value = True

 End If
 

'Kleinunternehmerregelung
Kur1 = Worksheets("Grunddaten").Range("G42")

If Kur1 = "" Or Kur1 = 0 Then
    'ThisWorkbook.Worksheets("Grunddaten").OptionButton9.Value = False
    ThisWorkbook.Worksheets("Grunddaten").OptionButton8.Value = True
    'ThisWorkbook.Worksheets("Grunddaten").Range("G42").Value = 0
Else
    'ThisWorkbook.Worksheets("Grunddaten").OptionButton8.Value = False
    ThisWorkbook.Worksheets("Grunddaten").OptionButton9.Value = True
    'ThisWorkbook.Worksheets("Grunddaten").Range("G42").Value = 1
End If



'Umschalten auf Men|fffd|
ActiveWorkbook.Worksheets("Eingang").Activate

On Error Resume Next
ThisWorkbook.Worksheets("Eingang").CheckBox1.Value = ActiveWorkbook.Worksheets("Eingang").CheckBox1.Value
On Error GoTo 0

'Schlie|fffd|en der Vorlagen-Datei
Application.DisplayAlerts = False
ActiveWorkbook.Close
Application.DisplayAlerts = True
Application.ScreenUpdating = True

Worksheets("Grunddaten").ListBox1.Visible = True
Worksheets("Grunddaten").Activate
Worksheets("Eingang").Activate

Worksheets("Einn.-Sammler").Unprotect "bufovo30"
Worksheets("Ausg.-Sammler").Unprotect "bufovo30"
Worksheets("Abrechnung").Unprotect "bufovo30"
Worksheets("Einn.-Sammler").Protect "bufovo30", AllowInsertingHyperlinks:=True
Worksheets("Ausg.-Sammler").Protect "bufovo30", AllowInsertingHyperlinks:=True
Worksheets("Abrechnung").Protect "bufovo30", AllowInsertingHyperlinks:=True
    
'Sicherungsdialog
MsgBox "Die Daten aus der Vorg|fffd|ngerversion wurden erfolgreich eingelesen." & vbCrLf & vbCrLf & "Um die Vorlagendatei unver|fffd|ndert zu erhalten, sollten Sie nun die neue Version mit den importierten Daten unter einem neuen Namen speichern."

Datei = "PV-Steuer-" & Worksheets("Grunddaten").Range("C27") & "-neu"
Erfolg = Application.Dialogs(xlDialogSaveAs).Show(arg1:=Datei)

If Erfolg Then
    Dateiname = Dir(ThisWorkbook.Path & "\update-dvII*.xl*")
    If Dateiname <> "" Then
        Kill Dateiname
        Worksheets("Eingang").Unprotect "bufovo30"
        Worksheets("Eingang").Range("D24") = ""
        Worksheets("Eingang").Protect "bufovo30"
        MsgBox "Die Updatedatei " & Chr(34) & Dateiname & Chr(34) & vbCrLf & "wurde aus dem Verzeichnis gel|fffd|scht.", vbInformation
    End If
End If

If Not Erfolg Then
MsgBox "Sie haben auf eine Speicherung verzichtet. Beachten Sie bitte aber, dass die Vorlagendatei der neuen Version nun die Daten der Vorg|fffd|ngerversion enth|fffd|lt!"
End If



Exit Sub

'Sprungmarke f|fffd|r Abbruch der Daten|fffd|bernahme
unsichtbar:

'Sperren der Grunddaten
If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("Grunddaten").Protect "bufovo30"
Else
    Worksheets("Grunddaten").Protect "bufovo30", AllowFormattingColumns:=True
End If

Application.ScreenUpdating = True

Exit Sub

fehler:
MsgBox Err.Description, vbInformation, "Info"

End Sub

Private Sub CommandButton13_Click()
'Jahreswechsel Neue Datei anlegen
Dim Jahr As Integer
Dim Datei As String
Dim Endung As String

If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
Application.ScreenUpdating = False
Jahr = Worksheets("Grunddaten").Range("C27")
'Name der Datei des neuen Jahres
If Right$(ThisWorkbook.Name, 4) = ".xls" Then
    Endung = ".xls"
Else
    Endung = ".xlsm"
End If

Datei = ThisWorkbook.Path & "\PV-Steuer-" & Jahr + 1 & Endung

If Dir(Datei) = "" Then
    GoTo weiter
Else
If MsgBox("Achtung!" & vbCrLf & "Soll die vorhandene Datei f|fffd|r das Jahr " & Jahr + 1 & " |fffd|berschrieben werden?", vbYesNo Or vbCritical, "Dateikonflikt!") = vbNo Then
    MsgBox "Funktion " & Chr(34) & "Neue Jahresdatei erstellen" & Chr(34) & " wird beendet!"
    Exit Sub
End If
weiter:
'Sichern der aktuellen Datei
If MsgBox("Sicherung der aktuellen Datei unter " _
& vbCrLf & ThisWorkbook.Name & vbCrLf & vbCrLf & "Sicherung der Datei f|fffd|r " & Jahr + 1 & " unter" & vbCrLf & "PV-Steuer-" & Jahr + 1 & Endung _
& vbCrLf & vbCrLf & "Einverstanden?", vbYesNo Or vbQuestion, "Info") = vbNo Then
Application.ScreenUpdating = False
    MsgBox "Funktion " & Chr(34) & "Neue Jahresdatei erstellen" & Chr(34) & " wird beendet!"
    Exit Sub
End If

ThisWorkbook.Save

'Datei fuer naechsten Jahr anlegen
Jahr = Jahr + 1
'Eintrag der neuen Werte / Werte loeschen

Worksheets("Grunddaten").Range("C27") = Jahr

If Worksheets("Grunddaten").Range("G42") = 1 Then
    Worksheets("Jahres-USt").Range("C44") = Worksheets("Jahres-USt").Range("C45")
End If


Worksheets("Einn.-Sammler").Range("B10:E58").ClearContents
Worksheets("Einn.-Sammler").Range("I10:J58").ClearContents


'---------------- Einnahmen 10-Tages-Regel -----------------------

'Zwischenkopie 10TR-Tabelle untere H|fffd|lfte
Worksheets("E10TagesRegel").Range("A31:E37").Value = Worksheets("E10TagesRegel").Range("A21:E27").Value

'L|fffd|schen von 10TR-Tabelle untere H|fffd|lfte
Worksheets("E10TagesRegel").Range("A21:E27").ClearContents

'Kopieren von 10-Tages-Regel-Einnahmen aus der E|fffd|R-Tabelle in die UST-Tabelle
zz = 21
For z = 10 To 16
    If Worksheets("E10TagesRegel").Cells(z, 2) > DateSerial(Jahr - 1, 12, 31) And Worksheets("E10TagesRegel").Cells(z, 8) <> "" Then
        For y = 2 To 5
            Worksheets("E10TagesRegel").Cells(zz, y) = Worksheets("E10TagesRegel").Cells(z, y)
        Next y
        zz = zz + 1
    End If
Next z
'L|fffd|schen der oberen Tabelle E10TagesRegel
Worksheets("E10TagesRegel").Range("A10:E16").ClearContents
Worksheets("E10TagesRegel").Range("I10:J16").ClearContents

'Kopieren von der ZwischenTabelle in die E|fffd|R H|fffd|lfte
zz = 10
For z = 31 To 37
     If Worksheets("E10TagesRegel").Cells(z, 2) > DateSerial(Jahr - 1, 12, 21) And Worksheets("E10TagesRegel").Cells(z, 8) <> "" Then
        For y = 2 To 5
            Worksheets("E10TagesRegel").Cells(zz, y) = Worksheets("E10TagesRegel").Cells(z, y)
        Next y
        zz = zz + 1
    End If
Next z

'L|fffd|schen der Zwischenkopie
Worksheets("E10TagesRegel").Range("A31:E37").ClearContents

Worksheets("Ausg.-Sammler").Range("B9:N59").ClearContents
Worksheets("Ausg.-Sammler").Range("B68:N116").ClearContents

'---------------- Ausgaben 10-Tages-Regel -----------------------

'Zwischenkopie 10TR-Tabelle untere H|fffd|lfte
Worksheets("A10TagesRegel").Range("A31:H36").Value = Worksheets("A10TagesRegel").Range("A21:H26").Value
'L|fffd|schen von 10TR-Tabelle untere H|fffd|lfte
Worksheets("A10TagesRegel").Range("A21:H26").ClearContents

'Kopieren von 10-Tages-Regel-Ausgaben aus der E|fffd|R-Tabelle in die UST-Tabelle
zz = 21
For z = 10 To 15
    If Worksheets("A10TagesRegel").Cells(z, 2) > DateSerial(Jahr - 1, 12, 31) And Worksheets("A10TagesRegel").Cells(z, 8) <> "" Then
        For y = 2 To 8
            Worksheets("A10TagesRegel").Cells(zz, y) = Worksheets("A10TagesRegel").Cells(z, y)
        Next y
        zz = zz + 1
    End If
Next z
'L|fffd|schen der oberen Tabelle A10TagesRegel
Worksheets("A10TagesRegel").Range("A10:H15").ClearContents

'Kopieren von der ZwischenTabelle in die E|fffd|R H|fffd|lfte
zz = 10
For z = 31 To 36
     If Worksheets("A10TagesRegel").Cells(z, 2) > DateSerial(Jahr - 1, 12, 21) And Worksheets("A10TagesRegel").Cells(z, 8) <> "" Then
        For y = 2 To 8
            Worksheets("A10TagesRegel").Cells(zz, y) = Worksheets("A10TagesRegel").Cells(z, y)
        Next y
        zz = zz + 1
    End If
Next z

'L|fffd|schen der Zwischenkopie
Worksheets("A10TagesRegel").Range("A31:H36").ClearContents

Worksheets("Fahrtkosten").Range("B14:D42, G14:J42, L14:M42").ClearContents

Worksheets("Sammelposten").Range("C41").Copy Destination:=Worksheets("Sammelposten").Range("C42")
Worksheets("Sammelposten").Range("C40").Copy Destination:=Worksheets("Sammelposten").Range("C41")
Worksheets("Sammelposten").Range("C39").Copy Destination:=Worksheets("Sammelposten").Range("C40")
Worksheets("Sammelposten").Range("D26").Copy
Worksheets("Sammelposten").Range("C39").PasteSpecial xlPasteValues
Worksheets("Sammelposten").Range("B9:D25").ClearContents
Worksheets("Sammelposten").Range("B9").Copy

Worksheets("Jahres-Ust").Range("B39").ClearContents

With Worksheets("ueWA")
    .Range("B7:B9").ClearContents
    .Range("B13:B14").ClearContents
    .Range("B20:B22").ClearContents
    .Range("B26:B27").ClearContents
    .Range("B33").ClearContents
End With


Worksheets("E-Ue-Rechnung").Range("B32").ClearContents
Worksheets("E-Ue-Rechnung").Range("B71").ClearContents


Worksheets("Abrechnung").Range("C9").ClearContents
Worksheets("Abrechnung").Range("C11").ClearContents


'Sichern der Datei des naechsten Jahres
Application.DisplayAlerts = False
ThisWorkbook.SaveAs Datei
MsgBox "Dateien wurden gesichert." & vbCrLf & vbCrLf & "Achtung: Sie arbeiten jetzt mit der Datei PV-Steuer-" & Jahr & Endung, vbExclamation, "Info"
Application.DisplayAlerts = True
Application.ScreenUpdating = True

End If
End Sub

Private Sub CommandButton14_Click()
'Hilfsmen|fffd|

If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If

Worksheets("Hilfsmenue").Visible = True
Worksheets("Hilfsmenue").Activate

End Sub

Private Sub CommandButton15_Click()
'Abrechnung
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
Worksheets("Abrechnung").Visible = True
Worksheets("Abrechnung").Activate
End Sub

Private Sub CommandButton16_Click()
'Abschreibung Wirtschaftsg|fffd|ter
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
Worksheets("AfA-WG").Visible = True
Worksheets("AfA-WG").Activate
End Sub

Private Sub CommandButton17_Click()
'Sammelposten
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
With Sheets("Sammelposten")
    .Visible = True
    .Activate
    .Cells(.Cells(25, 2).End(xlUp).Row + 1, 2).Select
End With
End Sub


Private Sub CommandButton18_Click()
Dim dokument As String
dokument = "https://www.pv-steuer.com/pages/direktverbrauch-ii.php"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub CommandButton2_Click()
'Einnahmen

If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
    
With Sheets("Einn.-Sammler")
    .Visible = True
    .Activate
    .Cells(.Cells(58, 2).End(xlUp).Row + 1, 2).Select
End With

'Worksheets("Einn.-Sammler").Range("B9").Select
End Sub

Private Sub CommandButton3_Click()
'Ausgaben
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If

With Sheets("Ausg.-Sammler")
    .Visible = True
    .Activate
    .Cells(.Cells(59, 2).End(xlUp).Row + 1, 2).Select
End With
End Sub

Private Sub CommandButton4_Click()
'Fahrtkosten
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
With Sheets("Fahrtkosten")
    .Visible = True
    .Activate
    .Cells(.Cells(42, 2).End(xlUp).Row + 1, 2).Select
End With

End Sub

Private Sub CommandButton5_Click()
'Zusammenstellung
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
Worksheets("Zusammenstellung").Visible = True
Worksheets("Zusammenstellung").Activate
End Sub

Private Sub CommandButton6_Click()
'Umsatzsteuer-Voranmeldungen
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
If Worksheets("Grunddaten").Range("G42") = "1" Then
  MsgBox "Kleinunternehmer brauchen keine Umsatzsteuer-Voranmeldungen abzugeben!" & vbCrLf & vbCrLf & "Die Funktion wird deshalb nicht ausgef|fffd|hrt.", vbCritical, "Fehler!"
    Exit Sub
End If


Worksheets("USt-Voranm.").Visible = True
Worksheets("USt-Voranm.").Activate
End Sub

Private Sub CommandButton7_Click()
'Jahresumsatzsteuer
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If

Worksheets("Jahres-USt").Visible = True
Worksheets("Jahres-USt").Activate
If Worksheets("Grunddaten").Range("G39").Value < 12 Then
    ThisWorkbook.Worksheets("Jahres-USt").Range("B39").Select
Else
    ThisWorkbook.Worksheets("Jahres-USt").Range("D3").Select
End If

End Sub

Private Sub CommandButton8_Click()
'AfA-Tabelle Anlage 1
If Worksheets("Grunddaten").Range("C30") = "update" Then
  MsgBox "Diese Datei ist nur f|fffd|r das Update verwendbar!" & vbCrLf & vbCrLf & "Bitte f|fffd|hren Sie die Daten|fffd|bernahme durch!", vbCritical, "Fehler!"
    Exit Sub
End If
AfA1 = Worksheets("Grunddaten").Range("E39")
InstJahr1 = Worksheets("Grunddaten").Range("J17")
InstMonate1 = Worksheets("Grunddaten").Range("J19")
Instsumme1 = Worksheets("Grunddaten").Range("E18")
Select Case InstJahr1
    Case Is = 2008, Is > 2010
        If AfA1 = 3 Or AfA1 = 4 Then MsgBox "Degressive Abschreibung ist f|fffd|r Installationsjahr " & InstJahr1 & " nicht m|fffd|glich!" & vbCrLf & vbCrLf & "Bitte berichtigen Sie Ihre Angaben im Blatt Grunddaten!", vbCritical, "Achtung!"
        If AfA1 = 3 Or AfA1 = 4 Then Exit Sub
        'If AfA1 = 4 Then Exit Sub
End Select
If InstJahr1 = "1900" Then
    MsgBox "Bitte unter " & Chr(34) & "Grunddaten" & Chr(34) & " das Datum der Inbetriebnahme eintragen!", vbCritical, "Achtung!"
ElseIf Instsumme1 = "" Then
    MsgBox "Bitte unter " & Chr(34) & "Grunddaten" & Chr(34) & " die Anschaffungskosten eintragen!", vbCritical, "Achtung!"
ElseIf InstMonate1 = "" Then
    MsgBox "Bitte zuerst unter " & Chr(34) & "Grunddaten" & Chr(34) & " das Datum der Inbetriebnahme eintragen!", vbCritical, "Achtung!"
ElseIf AfA1 = 0 Then
    MsgBox "Bitte zuerst unter " & Chr(34) & "Grunddaten" & Chr(34) & " die Abschreibungsart w|fffd|hlen!", vbCritical, "Achtung!"
ElseIf AfA1 = 1 Then

    Worksheets("AfA1_lin_mZ").Visible = True
    Worksheets("AfA1_lin_mZ").Activate
    Worksheets("AfA1_lin_mZ").Unprotect "bufovo30"
    Worksheets("AfA1_lin_mZ").Columns("G").Hidden = True
    Worksheets("AfA1_lin_mZ").Range("G15:G19") = ""
    If Application.version = "9.0" Or Application.version = "10.0" Then
        Worksheets("AfA1_lin_mZ").Protect "bufovo30"
    Else
        Worksheets("AfA1_lin_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    End If

    
ElseIf AfA1 = 2 Then
        If Worksheets("Afa1_lin_mZ").Range("G36") <> Worksheets("Afa1_lin_mZ").Range("G12") Then
        MsgBox " Bitte die Sonderabschreibung pr|fffd|fen!", vbInformation, "Info"
    End If

    Worksheets("AfA1_lin_mZ").Visible = True
    Worksheets("AfA1_lin_mZ").Activate
    Worksheets("AfA1_lin_mZ").Unprotect "bufovo30"
    Worksheets("AfA1_lin_mZ").Columns("G").Hidden = False
    If Application.version = "9.0" Or Application.version = "10.0" Then
        Worksheets("AfA1_lin_mZ").Protect "bufovo30"
     Else
       Worksheets("AfA1_lin_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    End If

    
    
ElseIf AfA1 = 3 Then

    Worksheets("AfA1_deg_mZ").Visible = True
    Worksheets("AfA1_deg_mZ").Activate
    Worksheets("AfA1_deg_mZ").Unprotect "bufovo30"
    Worksheets("AfA1_deg_mZ").Columns("G").Hidden = True
    Worksheets("AfA1_deg_mZ").Range("G15:G19") = ""
    If Application.version = "9.0" Or Application.version = "10.0" Then
        Worksheets("AfA1_deg_mZ").Protect "bufovo30"
    Else
        Worksheets("AfA1_deg_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    End If
    
    
Else
    If Worksheets("AfA1_deg_mZ").Range("G36") <> Worksheets("AfA1_deg_mZ").Range("G12") Then
        MsgBox " Bitte die Sonderabschreibung pr|fffd|fen!", vbInformation, "Info"
    End If

    Worksheets("AfA1_deg_mZ").Visible = True
    Worksheets("AfA1_deg_mZ").Activate
    Worksheets("AfA1_deg_mZ").Unprotect "bufovo30"
    Worksheets("AfA1_deg_mZ").Columns("G").Hidden = False
    If Application.version = "9.0" Or Application.version = "10.0" Then
        Worksheets("AfA1_deg_mZ").Protect "bufovo30"
    Else
        Worksheets("AfA1_deg_mZ").Protect "bufovo30", AllowFormattingColumns:=True
    End If
    

End If

End Sub

Private Sub CommandButton9_Click()
Worksheets("Changelog").Visible = True

Worksheets("Changelog").Activate

End Sub

Attribute VB_Name = "Tabelle19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "OptionButton1, 13, 1, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 14, 2, MSForms, OptionButton"
Attribute VB_Control = "CommandButton2, 15, 3, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("AfA1_deg_mZ").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Abschreibungstabellen.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub OptionButton1_Click()
' Eintrag der AfA manuell

With ThisWorkbook.Worksheets("AfA1_deg_mZ")
    .Unprotect "bufovo30"
    For i = 15 To 35
        .Cells(i, 6).Locked = False
        '.Cells(i, 6).FormulaLocal = ""
    Next i
    .Range("M13").Value = 1
    .Range("D37") = "Abschreibungsbetr|fffd|ge k|fffd|nnen nun manuell korrigiert werden."
    .Protect "bufovo30"
End With


End Sub


Private Sub OptionButton2_Click()
'Berechnung der AfA vom Programm

With ThisWorkbook.Worksheets("AfA1_deg_mZ")
    .Unprotect "bufovo30"
    For i = 15 To 35
        .Cells(i, 6).FormulaLocal = Cells(i, 13).FormulaLocal
        .Cells(i, 6).Locked = True
    Next i
    .Range("M13").Value = 0
    .Range("D37") = ""
    .Protect "bufovo30"
End With


End Sub
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 16, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 29, 3, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("Einn.-Sammler").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate

End Sub

Private Sub CommandButton2_Click()
Worksheets("Einn.-Sammler").Unprotect "bufovo30"
Range("A10:J58").Interior.Color = vbWhite
Range("B10:J58").Sort Key1:=Range("B10:B58")
For i = 10 To 58 Step 2
For j = 1 To 10
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i
If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("Einn.-Sammler").Protect "bufovo30"
Else
    Worksheets("Einn.-Sammler").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton3_Click()
'Einnahmen nach 10-T-R
With Sheets("E10TagesRegel")
    .Visible = True
    .Activate
    .Cells(.Cells(15, 2).End(xlUp).Row + 1, 2).Select
End With
End Sub


Private Sub CommandButton4_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Einnahmen-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Einnahmen.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 15, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 16, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 1490, 3, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("E10TagesRegel").Visible = xlVeryHidden
Worksheets("Einn.-Sammler").Visible = True
Worksheets("Einn.-Sammler").Activate

End Sub

Private Sub CommandButton2_Click()
Worksheets("E10TagesRegel").Unprotect "bufovo30"
Range("A10:J16").Interior.Color = vbWhite
Range("B10:J16").Sort Key1:=Range("B10:B16")
For i = 10 To 16 Step 2
For j = 1 To 10
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i
If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("E10TagesRegel").Protect "bufovo30"
Else
    Worksheets("E10TagesRegel").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton3_Click()
Worksheets("E10TagesRegel").Unprotect "bufovo30"
Range("A21:J27").Interior.Color = vbWhite
Range("B21:J27").Sort Key1:=Range("B21:B27")
For i = 21 To 27 Step 2
For j = 1 To 8
Cells(i, j).Interior.ColorIndex = 19
Next j
Next i
If Application.version = "9.0" Or Application.version = "10.0" Then
    Worksheets("E10TagesRegel").Protect "bufovo30"
Else
    Worksheets("E10TagesRegel").Protect "bufovo30", AllowFormattingColumns:=True
End If

End Sub

Private Sub CommandButton4_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Einnahmen-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Einnahmen.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 55, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("AfA-WG").Visible = xlVeryHidden
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Abschreibung-WG-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Abschreibung-WG.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub
Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "OptionButton1, 4, 1, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 5, 2, MSForms, OptionButton"
Attribute VB_Control = "CommandButton2, 17, 3, MSForms, CommandButton"
Attribute VB_Control = "OptionButton3, 18, 4, MSForms, OptionButton"
Attribute VB_Control = "OptionButton4, 19, 5, MSForms, OptionButton"
Attribute VB_Control = "CommandButton3, 20, 6, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("Jahres-USt").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Worksheets("Jahres-USt").Visible = xlVeryHidden
Worksheets("ueWA").Visible = True
Worksheets("ueWA").Activate

End Sub

Private Sub CommandButton3_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\UST-Jahresmeldung-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\UST-Jahresmeldung.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

Private Sub OptionButton1_Click()
ActiveSheet.PageSetup.PrintArea = "A1:D41"

End Sub

Private Sub OptionButton2_Click()
ActiveSheet.PageSetup.PrintArea = "A1:C41"

End Sub

Private Sub OptionButton3_Click()
'VZS manuell eintragen
    
With ThisWorkbook.Worksheets("Jahres-USt")
    .Unprotect "bufovo30"
    .Range("G20").Value = 1
    .Range("C19").Locked = False
    .Range("C19").Interior.ColorIndex = 35
    .Range("C19") = ""
    .Range("C24").Locked = False
    .Range("C24").Interior.ColorIndex = 35

    .Range("C24") = ""
    .Range("C29").Locked = False
    .Range("C29").Interior.ColorIndex = 35

    .Range("C29") = ""
    If Application.version = "9.0" Or Application.version = "10.0" Then
        .Protect "bufovo30"
    Else
        .Protect "bufovo30", AllowFormattingColumns:=True
    End If
End With

End Sub

Private Sub OptionButton4_Click()
'VZS programmtechnisch ermittelt
    
With ThisWorkbook.Worksheets("Jahres-USt")
    .Unprotect "bufovo30"
    .Range("G20").Value = 0
    .Range("C19").Interior.ColorIndex = 19
    .Range("C19").FormulaLocal = "= SUMME('USt-Voranm.'!E8:E19)"
    .Range("C19").Locked = True
    .Range("C24").Interior.ColorIndex = 19
    .Range("C24").FormulaLocal = "= SUMME('USt-Voranm.'!E27:E30)"
    .Range("C24").Locked = True
    .Range("C29").Interior.ColorIndex = 19
    .Range("C29").Value = 0
    .Range("C29").Locked = True
    If Application.version = "9.0" Or Application.version = "10.0" Then
        .Protect "bufovo30"
    Else
        .Protect "bufovo30", AllowFormattingColumns:=True
    End If
End With

End Sub

Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 19, 2, MSForms, CommandButton"
Attribute VB_Control = "OptionButton1, 15, 3, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 16, 4, MSForms, OptionButton"
Private Sub CommandButton1_Click()
Worksheets("AfA1_lin_mZ").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
dokument = ThisWorkbook.Path & "\Hilfe\Abschreibungstabellen.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub

Private Sub OptionButton1_Click()
' Eintrag der AfA manuell

With ThisWorkbook.Worksheets("AfA1_lin_mZ")
    .Unprotect "bufovo30"
    For i = 15 To 35
        .Cells(i, 6).Locked = False
        '.Cells(i, 6).FormulaLocal = ""
    Next i
    .Range("M13").Value = 1
    .Range("D37") = "Abschreibungsbetr|fffd|ge k|fffd|nnen manuell korrigiert werden."
    .Protect "bufovo30"
End With


End Sub

Private Sub OptionButton2_Click()
'Berechnung der AfA vom Programm

With ThisWorkbook.Worksheets("AfA1_lin_mZ")
    .Unprotect "bufovo30"
    For i = 15 To 35
        .Cells(i, 6).FormulaLocal = Cells(i, 13).FormulaLocal
        .Cells(i, 6).Locked = True
    Next i
    .Range("M13").Value = 0
    .Range("D37") = ""
    .Protect "bufovo30"
End With

End Sub
Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 34, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("USt-Voranm.").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    MsgBox "Im Kleinunternehmer-Modus ist keine Umsatzsteuer-Voranmeldung abzugeben!"
    Exit Sub
End If
dokument = ThisWorkbook.Path & "\Hilfe\UST-Voranmeldung.pdf"
ThisWorkbook.FollowHyperlink dokument

End Sub

Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 12, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("Zusammenstellung").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate
End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Zusammenstellung-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Zusammenstellung.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub
Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 4, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Worksheets("Sammelposten").Visible = xlVeryHidden
Worksheets("Eingang").Visible = True
Worksheets("Eingang").Activate

End Sub

Private Sub CommandButton2_Click()
Dim dokument As String
If Worksheets("Grunddaten").Range("G29").Value = "Kleinunternehmer-Modus" Then
    dokument = ThisWorkbook.Path & "\Hilfe\Sammelposten-KUR.pdf"
Else
    dokument = ThisWorkbook.Path & "\Hilfe\Sammelposten.pdf"
End If
ThisWorkbook.FollowHyperlink dokument
End Sub

' InQuest injected base64 decoded content
' zKoz

INQUEST-PP=macro
