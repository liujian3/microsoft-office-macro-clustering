Attribute VB_Name = "Feuil11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Sub Macro1()
'
' Macro1 Macro
'
'
    Dim ws As Worksheet
    Sheets("TCD").Select
    semaine = Range("A1")
    plagefin = Range("A4").End(xlDown).Row - 1
    pdt = 0
    volume = 0
    Sheets("Vierge").Copy After:=Sheets(ThisWorkbook.Sheets.Count)
    Set ws = ActiveSheet
    ws.Name = "S" & semaine
    For i = 4 To plagefin
    Sheets("TCD").Select
   If pdt <> Range("A" & i).Value Then
        If pdt <> 0 Then
            ws.Activate
            Range("A4").End(xlDown).Offset(1, 0).Value = "-"
            Range("K1000").End(xlUp).Offset(1, 0).Select
            Selection.Formula = "=sum(K" & ligne + 1 & ":K" & Selection.Row - 1 & ")"
            Selection.Borders.Weight = xlMedium
            Selection.Interior.ColorIndex = 40
            Selection.Font.Bold = True
            volume = 0
            Sheets("TCD").Activate
        End If
        condi1 = ""
        pdt = Range("A" & i)
        ws.Select
        Range("A4").End(xlDown).Offset(1, 0).Select
        Selection = pdt
        Range(Selection, Range("K" & Selection.Row)).Select
        Application.CutCopyMode = False
        ligne = Selection.Row
        With Selection
            .HorizontalAlignment = xlLeft
            .VerticalAlignment = xlBottom
            .WrapText = False
            .Orientation = 0
            .AddIndent = False
            .IndentLevel = 0
            .ShrinkToFit = False
            .ReadingOrder = xlContext
            .MergeCells = True
            .Borders.Weight = xlMedium
            .Font.Bold = True
        End With
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent3
            .TintAndShade = 0.399975585192419
            .PatternTintAndShade = 0
        End With
    End If
    Sheets("TCD").Activate
    condi = Range("B" & i)
    volume1 = Range("O" & i)
    If volume1 = "(vide)" Then
    volume1 = 0
    End If
    Range("E" & i & ":S" & i).Copy
    ws.Select
    NBLig = Range("A4").End(xlDown).Row
    If condi = condi1 Or condi1 = "" Then
        Range("A4").End(xlDown).Offset(1, 0).PasteSpecial
        Range(Range("A4").End(xlDown), Range("A4").End(xlDown).Offset(0, 18)).Select
        Selection.Borders.Color = black
    End If
    If (condi <> condi1 And condi1 <> "") Then
        Range("A4").End(xlDown).Offset(1, 0).Value = "-"
        Range("K1000").End(xlUp).Offset(1, 0).Select
        Selection.Formula = "=sum(K" & ligne + 1 & ":K" & Selection.Row - 1 & ")"
        ligne = Selection.Row
        Range("A4").End(xlDown).Offset(1, 0).PasteSpecial
        Range("K" & ligne).Borders.Weight = xlMedium
        Range("K" & ligne).Font.Bold = True
        Range("K" & ligne).Interior.ColorIndex = 40
        Range(Range("A4").End(xlDown), Range("A4").End(xlDown).Offset(1, 18)).Select
        Selection.Borders.Color = black
    End If
    volume = volume + volume1
    condi1 = condi
        If i = plagefin Then
        Range("A4").End(xlDown).Offset(1, 0).Select
        Selection = "-"
        Range("K" & Selection.Row).Select
        Selection.Formula = "=sum(K" & ligne + 1 & ":K" & Selection.Row - 1 & ")"
        ligne = Selection.Row
        'Selection.Value = volume
        Selection.Borders.Weight = xlMedium
        Selection.Font.Bold = True
        Selection.Interior.ColorIndex = 40
        volume = 0
        End If
    Next
    Range("K:K").Style = "Comma"
    Range("B:B").NumberFormat = "m/d/yyyy"
    Calculate
End Sub


Attribute VB_Name = "Module2"
Sub compil()
Dim wb As Workbook, wb1 As Workbook
Set wb = ActiveWorkbook
Application.ScreenUpdating = False
wb.Sheets("COMPIL").Activate
Range(Range("A4"), Range("V4").End(xlDown)).Clear
Workbooks.Open "S:\Port sur Saone SIEGE\ESM-COMMUN\Commercial\Sodiaal\Mandat Lait.xlsm", True
Set wb1 = ActiveWorkbook
Application.Run ("'" & wb1.Name & "'!Compil_Suivi")
wb1.Sheets("Compilation1").Activate
Range(Range("A3"), Range("V3").End(xlDown)).Copy
wb.Sheets("COMPIL").Activate
Range("A3").PasteSpecial xlPasteValues
Workbooks(wb1.Name).Close False
Calculate
Sheets("TCD").Activate
ActiveSheet.PivotTables("Tableau crois|fffd| dynamique1").PivotCache.Refresh
Set Pt = ActiveSheet.PivotTables("Tableau crois|fffd| dynamique1")
Set Pf = ActiveSheet.PivotTables("Tableau crois|fffd| dynamique1").PivotFields("NOMART EN")
Pf.ClearAllFilters
Pf.PivotItems("(blank)").Visible = False
Pf.PivotItems("#N/A").Visible = False
Macro1
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module3"
Sub remontee_infos()
Dim wb As Workbook, wb1 As Workbook
Dim ws As Worksheet, ws1 As Worksheet
Set wb = ActiveWorkbook
Set ws = ActiveSheet
Application.ScreenUpdating = False


nlig = Range("A5").End(xlDown).Row
Application.DisplayAlerts = False
Workbooks.Open "S:\Port sur Saone SIEGE\ESM-COMMUN\Commercial\Sodiaal\Mandat Lait.xlsm", True
Application.DisplayAlerts = True
Set wb1 = ActiveWorkbook
Set ws1 = wb1.Sheets("Mandat")
ws.Activate
For i = 6 To nlig
If IsNumeric(Range("A" & i)) Then
Nman = Range("A" & i)
Tag = Range("L" & i)
If Left(Tag, 7) = "ON HOLD" Then Tag = "ON HOLD" & "-" & Range("S" & i).Value & "T"
If Left(Tag, 4) = "SOLD" Then Tag = "SOLD" & "-" & Range("S" & i).Value & "T"
If Tag = "CANCELED" Then Tag = "Annul|fffd|"
If Tag <> "FOR SALE" Then
    ws1.Activate
    nlig1 = Range("A1").End(xlDown).Row
    For n = 2 To nlig1
    Nman2 = Range("A" & n)
    If Nman = Nman2 Then Range("K" & n) = Tag
Next
End If
End If
ws.Activate
Next
Application.DisplayAlerts = False
wb1.Close True
Application.DisplayAlerts = True
Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Module4"
Sub dupliquer()
Dim ws As Worksheet
Set ws = ActiveSheet
nlig = Range("A4").End(xlDown).Row
i = 6
bool = Range("T1").Value
lignefin = 0


Do
If bool = 1 Then
For m = i + 1 To nlig + 1
        If Range("A" & m).Value = "SOLD and On Hold" Then
            lignefin = Range("A" & m).Row
        End If
Next
End If
If lignefin = 0 Then lignefin = nlig

If IsNumeric(Range("A" & i)) And (Left(Range("L" & i), 4) = "SOLD" Or Left(Range("L" & i), 7) = "ON HOLD") Then
    If Range("S" & i) <= (Range("k" & i) + 0.5) And Range("S" & i) > 0 Then
    bool = Range("T1")
    man = Range("A" & i)
    vendu = Range("S" & i)
    reste = Range("K" & i)
    If bool = 0 Then
        Range("A4").End(xlDown).Offset(1, 0).Select
        Selection = "SOLD and On Hold"
        Range(Selection, Selection.Offset(0, 11)).Select
        With Selection
            .HorizontalAlignment = xlLeft
            .VerticalAlignment = xlBottom
            .WrapText = False
            .Orientation = 0
            .AddIndent = False
            .IndentLevel = 0
            .ShrinkToFit = False
            .ReadingOrder = xlContext
            .MergeCells = True
        End With
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent3
            .TintAndShade = 0.399975585192419
            .PatternTintAndShade = 0
        End With
        Range("T1") = 1
    End If
    bool2 = 0
    For n = i + 1 To nlig + 1
        man2 = Range("A" & n)
        If man = man2 And n > lignefin Then
            Range("S" & n).Value = Range("S" & n) + vendu
            Range("K" & n).Value = Range("S" & n).Value
            bool2 = 1
        End If
        
    Next
        If bool2 = 0 And i < lignefin Then
            Range("A" & i & ":S" & i).Copy
            Range("A4").End(xlDown).Offset(1, 0).PasteSpecial
            Range("K" & Selection.Row).Value = vendu
        End If
        Range("K" & i).Value = reste - vendu
        Range("S" & i) = ""
        Range("L" & i).Value = "FOR SALE"
        If reste - vendu <= 0.1 Then
            Rows(i).EntireRow.Delete
            nlig = nlig - 1
            i = i - 1
        End If
End If
End If
i = i + 1
Loop While i < lignefin

End Sub



Attribute VB_Name = "Module5"
Sub Macro2()
Attribute Macro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
'

'
    Range("A9:M9").Select
    Selection.Copy
    Range("A25").Select
    ActiveSheet.Paste
    Range("A6:K6").Select
    Selection.End(xlDown).Select
    Range("A24").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Sold"
    Range("A25").Select
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
