Attribute VB_Name = "HelpForm"
Attribute VB_Base = "0{D076A2B3-6C39-49EB-96E6-91CD6052CC22}{B6C922FE-D22F-4119-A348-F9557D86B427}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
 HelpForm.Hide
End Sub
Attribute VB_Name = "Module1"
Sub Show_MyMenu()
'#########################################################
'##### Ford Masters - created 17.12.2008 by jbartos1 #####
'#########################################################
Set myMenuBar = CommandBars.ActiveMenuBar
Set newMenu = myMenuBar.Controls.Add(Type:=msoControlPopup, _
    Temporary:=True)
newMenu.Caption = "Ford |fffd|kolen|fffd|"

'Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
'ctrl1.Caption = "Pl|fffd|n |fffd|kolen|fffd| - vsichni"
'ctrl1.TooltipText = "Spust|fffd| macro, kter|fffd| vygeneruje pl|fffd|n |fffd|kolen|fffd|"
'ctrl1.Style = msoButtonCaption
'ctrl1.OnAction = "MakePlan"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Pl|fffd|n |fffd|kolen|fffd| - Technik"
ctrl1.TooltipText = "Spust|fffd| macro, kter|fffd| vygeneruje pl|fffd|n |fffd|kolen|fffd|"
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "MakePlanT"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Pl|fffd|n |fffd|kolen|fffd| - Starsi technik"
ctrl1.TooltipText = "Spust|fffd| macro, kter|fffd| vygeneruje pl|fffd|n |fffd|kolen|fffd|"
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "MakePlanST"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Pl|fffd|n |fffd|kolen|fffd| - Hlavni technik"
ctrl1.TooltipText = "Spust|fffd| macro, kter|fffd| vygeneruje pl|fffd|n |fffd|kolen|fffd|"
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "MakePlanHT"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Nov|fffd| technik"
ctrl1.TooltipText = "Spust|fffd| form pro zad|fffd|n|fffd| nov|fffd|ho technika."
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "UserForm1Show"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Velk|fffd| seznam"
ctrl1.TooltipText = "Vytvo|fffd||fffd| velk|fffd| seznam na do|fffd|kolen|fffd| a alternativn|fffd| do|fffd|kolen|fffd|"
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "MakeSeznam"

Set ctrl1 = newMenu.Controls.Add(Type:=msoControlButton, ID:=1)
ctrl1.Caption = "Help"
ctrl1.TooltipText = "Spust|fffd| Help."
ctrl1.Style = msoButtonCaption
ctrl1.OnAction = "HelpFormShow"

Worksheets("TECHNICI").Select

End Sub

Attribute VB_Name = "Module2"
Public SKARR()

Function DoesSheetExist(SName)

'Test to see if a Worksheet exists.

Dim wSheet As Worksheet
    On Error Resume Next
    Set wSheet = Sheets(SName)
        If wSheet Is Nothing Then 'Doesn't exist
            'MsgBox "Worksheet does not exist", vbCritical
            DoesSheetExist = False
            Set wSheet = Nothing
            On Error GoTo 0
        Else 'Does exist
            'MsgBox "Sheet  does exist", vbInformation
            DoesSheetExist = True
            Set wSheet = Nothing
            On Error GoTo 0
        End If
End Function

Function UzBylSkolen(DName, SKName)
'DName = "Calta,Zden|fffd|k"
'SKName = "TC2061000C"
    Sheets("Prehled Skoleni").Select
    Range("a1").Select
    Selection.CurrentRegion.Select
    row_count = Selection.Rows.Count - 1

    Selection.AutoFilter
    Selection.AutoFilter Field:=8, Criteria1:="=" & DName
    Selection.AutoFilter Field:=4, Criteria1:="=" & SKName
    Selection.CurrentRegion.Select
    matched_criteria = 0
    check_row = 0
    While Not IsEmpty(ActiveCell)
        ActiveCell.Offset(1, 0).Select
        If ActiveCell.RowHeight = 0 Then
            check_row = check_row + 1
        Else
            matched_criteria = matched_criteria + 1
        End If
    Wend
    Selection.AutoFilter Field:=4
    Selection.AutoFilter Field:=8

    If matched_criteria - 1 <= 0 Then
     'MsgBox "No"
     UzBylSkolen = False
     Else
     'MsgBox "yes"
     UzBylSkolen = True
    End If

    'If row_count = check_row Then
    '    MsgBox "no matching data"
    '    'UzBylSkolen = False
    'Else
    '    MsgBox matched_criteria - 1
    '    'UzBylSkolen = True
    'End If


End Function
Function UzBylSkolenARR(DName, SKName)
 
 For i = LBound(SKARR, 1) To UBound(SKARR, 1) - 1
    'X = ""
    'X = X & ";" & i
    'X = X & ";" & SKName
    'X = X & ";" & SKARR(i, 0)
    'X = X & ";" & DName
    'X = X & ";" & SKARR(i, 1)
    'WriteLog (X & vbCrLf)
    
    If Trim(SKARR(i, 0)) = Trim(SKName) And Trim(SKARR(i, 1)) = Trim(DName) Then
        'MsgBox ("yes " & i)
        'UzBylSkolenARR = True
        UzBylSkolenARR = SKARR(i, 2)
        Exit For
     Else
        'UzBylSkolenARR = False
        UzBylSkolenARR = "XXX"
    End If
 Next

End Function
Function WriteLog(xLine)
   Dim fso, f
   Set fso = CreateObject("Scripting.FileSystemObject")
   Set f = fso.OpenTextFile("c:\users\jbartos1\Documents\_Development\FordMasters\log.txt", 8, True)
   f.Write xLine
   f.Close
End Function


Function Skol2ARR()
'-pocet radku
Sheets("Prehled Skoleni").Select
R = 1
Do While Cells(R, 1).Value <> ""
 R = R + 1
Loop
'MsgBox "R=" & R
xRows = R - 2 '-- i bez headeru
ReDim SKARR(xRows, 3)
'-do pole
R = 0
Do While Cells(R + 1, 2).Value <> ""
 SKARR(R, 0) = Cells(R + 2, 4).Value '-kod skoleni
 SKARR(R, 1) = Cells(R + 2, 8).Value '-jmeno studenta
 SKARR(R, 2) = Cells(R + 2, 10).Value '-result
 R = R + 1
Loop

'-test
'MsgBox SKARR(LBound(SKARR, 1), 0)
'MsgBox LBound(SKARR, 1) & "/" & UBound(SKARR, 1)
 For i = LBound(SKARR, 1) To UBound(SKARR, 1)
    Worksheets("TMP").Cells(i + 1, 3).Value = i
    Worksheets("TMP").Cells(i + 1, 4).Value = SKARR(i, 0)
    Worksheets("TMP").Cells(i + 1, 5).Value = SKARR(i, 1)
    Worksheets("TMP").Cells(i + 1, 6).Value = SKARR(i, 2)
 Next
 
End Function

Sub UserForm1Show()
 UserForm1.Show
End Sub
Sub HelpFormShow()
 HelpForm.Show
End Sub

Sub MakePlanT()

'--- skoleni do pole
Call Skol2ARR
'---vsude stejna jmena
'----seznam jmen techniku ze sheetu 'Prehled skoleni', bez duplicit
Worksheets("Prehled Skoleni").Select
i = 2
Do While Range("H" & i) <> ""
 'MsgBox I & Range("H" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 2
'MsgBox POCETTECHNIKU

'----srovnani podle jmena
Worksheets("Prehled Skoleni").Select
Range("A2:I" & POCETTECHNIKU + 1).Select
    Selection.Sort Key1:=Range("H3"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
'----duplicity pryc
SEZNAMTECHNIKU = Range("H3").Value
L = 3
Worksheets("TMP").Cells.ClearContents
Worksheets("TMP").Cells(L - 2, 1).Value = "Seznam techniku"
Worksheets("TMP").Cells(L - 1, 1).Value = Range("H3").Value
For J = 4 To POCETTECHNIKU + 1
 KDO = Range("H" & J).Value
 DUPL = "NO"
 For K = J - 1 To 3 Step -1
  If Range("H" & K).Value = KDO Then
    DUPL = "YES"
    Exit For
  End If
 Next
 If DUPL <> "YES" Then
  SEZNAMTECHNIKU = SEZNAMTECHNIKU & vbCrLf & KDO
  Worksheets("TMP").Cells(L, 1).Value = KDO
  L = L + 1
 End If

Next

'MsgBox SEZNAMTECHNIKU
'---named range
Worksheets("TMP").Visible = True
Worksheets("TMP").Select

i = 2
Do While Range("A" & i) <> ""
 i = i + 1
Loop
ROZSAH = "=TMP!R2C1:R" & i - 1 & "C1"
ActiveWorkbook.Names.Add Name:="STLookup", RefersToR1C1:=ROZSAH
Worksheets("TMP").Visible = False
'---pocet techniku na sheetu TECHNICI
Worksheets("TECHNICI").Select
i = 12
Do While Range("A" & i) <> "Po|fffd|et technik|fffd|:" 'And Range("A" & I) <> "" '---pocet mista pro techniky
 'MsgBox I & Range("A" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 12
'MsgBox POCETTECHNIKU

'---validace na sheetu TECHNICI

Worksheets("TECHNICI").Select
Range(Cells(12, 1), Cells(12 + POCETTECHNIKU - 1, 1)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 3), Cells(12 + POCETTECHNIKU - 1, 7)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 10), Cells(12 + POCETTECHNIKU - 1, 14)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With

'--- zacatek a konec Technik
R = 1
Do While Worksheets("MASTERS").Cells(R, 5).Value <> "|fffd|rove|fffd| z|fffd|kladn|fffd|  1 - Technik"
 R = R + 1
Loop
RTSTART = R
R = RTSTART
Do While Worksheets("MASTERS").Cells(R, 5).Value = "|fffd|rove|fffd| z|fffd|kladn|fffd|  1 - Technik"
 R = R + 1
Loop
RTSTOP = R - 1
'MsgBox RTSTART & "-" & RTSTOP

'---smazani starsich prehledu na MASTERS - smazat cele sloupce
Worksheets("MASTERS").Select
C = 10 'startovaci sloupec
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 If Cells(RTSTART, C).Value <> "" Then
  Columns(C).Select
  'MsgBox C
  Selection.Delete Shift:=xlToLeft
  C = C - 1
 End If
 C = C + 1
Loop

'---kde zacit
C = 10 'startovaci sloupec
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 C = C + 1
Loop
CTSTART = C

'---Technici na MASTERS
Worksheets("TECHNICI").Select
J = CTSTART '--- vychozi pozice na MASTERS pro jmena
For i = 12 To 12 + POCETTECHNIKU - 1
 If Cells(i, 11).Value <> "" Then
  Worksheets("MASTERS").Cells(1, J).Value = Cells(i, 11).Value
  J = J + 1
 End If
Next
'---
'---kontrola provedenych skoleni na MASTERS
C = CTSTART 'startovaci sloupec
R = RTSTART 'startovaci radek pro Technik

Worksheets("MASTERS").Select
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 Do While Worksheets("MASTERS").Cells(R, 5).Value = "|fffd|rove|fffd| z|fffd|kladn|fffd|  1 - Technik"
  'If UzBylSkolen(Worksheets("MASTERS").Cells(1, C).Value, Worksheets("MASTERS").Cells(R, 1).Value) Then
  XY = UzBylSkolenARR(Worksheets("MASTERS").Cells(1, C).Value, Worksheets("MASTERS").Cells(R, 1).Value)
  If XY <> "XXX" Then
   Worksheets("MASTERS").Cells(R, C).Value = "HOTOVO" & " - " & XY
   Worksheets("MASTERS").Cells(R, C).Interior.ColorIndex = 4
  Else
   Worksheets("MASTERS").Cells(R, C).Value = "NE|fffd|KOLENO"
   Worksheets("MASTERS").Cells(R, C).Interior.ColorIndex = 45
   Worksheets("MASTERS").Cells(R, C).Select
   With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="DO|fffd|KOLIT,ALTERNATIVA"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
   End With
  End If
  R = R + 1
  RTSTOP = R
 Loop
 R = RTSTART
 C = C + 1
Loop
Worksheets("MASTERS").Select

'--formatovani
Call Formatuj(RTSTART, 1, RTSTOP - 1, C - 1)

End Sub

Sub MakePlanST()
'--- skoleni do pole
Call Skol2ARR
'---vsude stejna jmena
'----seznam jmen techniku ze sheetu 'Prehled skoleni', bez duplicit
Worksheets("Prehled Skoleni").Select
i = 2
Do While Range("H" & i) <> ""
 'MsgBox I & Range("H" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 2
'MsgBox POCETTECHNIKU

'----srovnani podle jmena
Worksheets("Prehled Skoleni").Select
Range("A2:I" & POCETTECHNIKU + 1).Select
    Selection.Sort Key1:=Range("H3"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
'----duplicity pryc
SEZNAMTECHNIKU = Range("H3").Value
L = 3
'Worksheets("TMP").Cells.ClearContents
Worksheets("TMP").Cells(L - 2, 1).Value = "Seznam techniku"
Worksheets("TMP").Cells(L - 1, 1).Value = Range("H3").Value
For J = 4 To POCETTECHNIKU + 1
 KDO = Range("H" & J).Value
 DUPL = "NO"
 For K = J - 1 To 3 Step -1
  If Range("H" & K).Value = KDO Then
    DUPL = "YES"
    Exit For
  End If
 Next
 If DUPL <> "YES" Then
  SEZNAMTECHNIKU = SEZNAMTECHNIKU & vbCrLf & KDO
  Worksheets("TMP").Cells(L, 1).Value = KDO
  L = L + 1
 End If

Next

'MsgBox SEZNAMTECHNIKU
'---named range
Worksheets("TMP").Visible = True
Worksheets("TMP").Select

i = 2
Do While Range("A" & i) <> ""
 i = i + 1
Loop
ROZSAH = "=TMP!R2C1:R" & i - 1 & "C1"
ActiveWorkbook.Names.Add Name:="STLookup", RefersToR1C1:=ROZSAH
Worksheets("TMP").Visible = False
'---pocet techniku na sheetu TECHNICI
Worksheets("TECHNICI").Select
i = 12
Do While Range("A" & i) <> "Po|fffd|et technik|fffd|:" 'And Range("A" & I) <> "" '---pocet mista pro techniky
 'MsgBox I & Range("A" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 12
'MsgBox POCETTECHNIKU

'---validace na sheetu TECHNICI

Worksheets("TECHNICI").Select
Range(Cells(12, 1), Cells(12 + POCETTECHNIKU - 1, 1)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 3), Cells(12 + POCETTECHNIKU - 1, 7)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 10), Cells(12 + POCETTECHNIKU - 1, 14)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With

'--- zacatek a konec Starsi Technik
R = 1
Do While Worksheets("MASTERS").Cells(R, 5).Value <> "|fffd|rove|fffd| st|fffd|edn|fffd| 2 - Star|fffd||fffd| technik"
 R = R + 1
Loop
RSTSTART = R
R = RSTSTART
Do While Worksheets("MASTERS").Cells(R, 5).Value = "|fffd|rove|fffd| st|fffd|edn|fffd| 2 - Star|fffd||fffd| technik"
 R = R + 1
Loop
RSTSTOP = R - 1
'MsgBox RSTSTART & "-" & RSTSTOP

'---smazani starsich prehledu na MASTERS - smazat cele sloupce
Worksheets("MASTERS").Select
C = 10 'startovaci sloupec
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 If Cells(RSTSTART, C).Value <> "" Then
  Columns(C).Select
  'MsgBox C
  Selection.Delete Shift:=xlToLeft
  C = C - 1
 End If
 C = C + 1
Loop

'---kde zacit
C = 10 'startovaci sloupec
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 C = C + 1
Loop
CSTSTART = C

'---Technici na MASTERS
Worksheets("TECHNICI").Select
J = CSTSTART '--- vychozi pozice na MASTERS pro jmena
For i = 12 To 12 + POCETTECHNIKU - 1
 If Cells(i, 13).Value <> "" Then
  Worksheets("MASTERS").Cells(1, J).Value = Cells(i, 13).Value
  J = J + 1
 End If
Next

'---
'---kontrola provedenych skoleni na MASTERS
C = CSTSTART 'startovaci sloupec
R = RSTSTART 'startovaci radek pro starsi technik

Worksheets("MASTERS").Select
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 Do While Worksheets("MASTERS").Cells(R, 5).Value = "|fffd|rove|fffd| st|fffd|edn|fffd| 2 - Star|fffd||fffd| technik"
  'MsgBox "jmeno=" & Worksheets("MASTERS").Cells(1, C).Value & " Skoleni=" & Worksheets("MASTERS").Cells(R, 1).Value & " " & XY
  'If UzBylSkolen(Worksheets("MASTERS").Cells(1, C).Value, Worksheets("MASTERS").Cells(R, 1).Value) Then
  XY = UzBylSkolenARR(Worksheets("MASTERS").Cells(1, C).Value, Worksheets("MASTERS").Cells(R, 1).Value)
  If XY <> "XXX" Then
   Worksheets("MASTERS").Cells(R, C).Value = "HOTOVO" & "-" & XY
   Worksheets("MASTERS").Cells(R, C).Interior.ColorIndex = 4
  Else
   Worksheets("MASTERS").Cells(R, C).Value = "NE|fffd|KOLENO"
   Worksheets("MASTERS").Cells(R, C).Interior.ColorIndex = 45
   Worksheets("MASTERS").Cells(R, C).Select
   With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="DO|fffd|KOLIT,ALTERNATIVA"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
   End With
   
  End If
  R = R + 1
  RSTSTOP = R
 Loop
 R = RSTSTART
 C = C + 1
Loop
Worksheets("MASTERS").Select

'--formatovani
Call Formatuj(RSTSTART, 1, RSTSTOP - 1, C - 1)


End Sub

Sub MakePlanHT()
'--- skoleni do pole
Call Skol2ARR
'---vsude stejna jmena
'----seznam jmen techniku ze sheetu 'Prehled skoleni', bez duplicit
Worksheets("Prehled Skoleni").Select
i = 2
Do While Range("H" & i) <> ""
 'MsgBox I & Range("H" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 2
'MsgBox POCETTECHNIKU

'----srovnani podle jmena
Worksheets("Prehled Skoleni").Select
Range("A2:I" & POCETTECHNIKU + 1).Select
    Selection.Sort Key1:=Range("H3"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
'----duplicity pryc
SEZNAMTECHNIKU = Range("H3").Value
L = 3
Worksheets("TMP").Cells.ClearContents
Worksheets("TMP").Cells(L - 2, 1).Value = "Seznam techniku"
Worksheets("TMP").Cells(L - 1, 1).Value = Range("H3").Value
For J = 4 To POCETTECHNIKU + 1
 KDO = Range("H" & J).Value
 DUPL = "NO"
 For K = J - 1 To 3 Step -1
  If Range("H" & K).Value = KDO Then
    DUPL = "YES"
    Exit For
  End If
 Next
 If DUPL <> "YES" Then
  SEZNAMTECHNIKU = SEZNAMTECHNIKU & vbCrLf & KDO
  Worksheets("TMP").Cells(L, 1).Value = KDO
  L = L + 1
 End If

Next

'MsgBox SEZNAMTECHNIKU
'---named range
Worksheets("TMP").Visible = True
Worksheets("TMP").Select

i = 2
Do While Range("A" & i) <> ""
 i = i + 1
Loop
ROZSAH = "=TMP!R2C1:R" & i - 1 & "C1"
ActiveWorkbook.Names.Add Name:="STLookup", RefersToR1C1:=ROZSAH
Worksheets("TMP").Visible = False
'---pocet techniku na sheetu TECHNICI
Worksheets("TECHNICI").Select
i = 12
Do While Range("A" & i) <> "Po|fffd|et technik|fffd|:" 'And Range("A" & I) <> "" '---pocet mista pro techniky
 'MsgBox I & Range("A" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 12
'MsgBox POCETTECHNIKU

'---validace na sheetu TECHNICI

Worksheets("TECHNICI").Select
Range(Cells(12, 1), Cells(12 + POCETTECHNIKU - 1, 1)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 3), Cells(12 + POCETTECHNIKU - 1, 7)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 10), Cells(12 + POCETTECHNIKU - 1, 14)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With

'--- zacatek a konec Hlavni Technik
R = 1
Do While Worksheets("MASTERS").Cells(R, 5).Value <> "|fffd|rove|fffd| vy|fffd||fffd||fffd| 3 - Hlavn|fffd| technik"
 R = R + 1
Loop
RHTSTART = R
R = RHTSTART
Do While Worksheets("MASTERS").Cells(R, 5).Value = "|fffd|rove|fffd| vy|fffd||fffd||fffd| 3 - Hlavn|fffd| technik"
 R = R + 1
Loop
RHTSTOP = R - 1
'MsgBox RHTSTART & "-" & RHTSTOP

'---smazani starsich prehledu na MASTERS - smazat cele sloupce
Worksheets("MASTERS").Select
C = 10 'startovaci sloupec
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 If Cells(RHTSTART, C).Value <> "" Then
  Columns(C).Select
  'MsgBox C
  Selection.Delete Shift:=xlToLeft
  C = C - 1
 End If
 C = C + 1
Loop

'---kde zacit
C = 10 'startovaci sloupec
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 C = C + 1
Loop
CHTSTART = C

'---Technici na MASTERS
Worksheets("TECHNICI").Select
J = CHTSTART '--- vychozi pozice na MASTERS pro jmena
For i = 12 To 12 + POCETTECHNIKU - 1
 If Cells(i, 14).Value <> "" Then
  Worksheets("MASTERS").Cells(1, J).Value = Cells(i, 14).Value
  J = J + 1
 End If
Next

'---
'---kontrola provedenych skoleni na MASTERS
C = CHTSTART 'startovaci sloupec
R = RHTSTART 'startovaci radek pro hlavni technik

Worksheets("MASTERS").Select
Do While Worksheets("MASTERS").Cells(1, C).Value <> ""
 Do While Worksheets("MASTERS").Cells(R, 5).Value = "|fffd|rove|fffd| vy|fffd||fffd||fffd| 3 - Hlavn|fffd| technik"
  'If UzBylSkolen(Worksheets("MASTERS").Cells(1, C).Value, Worksheets("MASTERS").Cells(R, 1).Value) Then
  XY = UzBylSkolenARR(Worksheets("MASTERS").Cells(1, C).Value, Worksheets("MASTERS").Cells(R, 1).Value)
  If XY <> "XXX" Then
   Worksheets("MASTERS").Cells(R, C).Value = "HOTOVO" & "-" & XY
   Worksheets("MASTERS").Cells(R, C).Interior.ColorIndex = 4
  Else
   Worksheets("MASTERS").Cells(R, C).Value = "NE|fffd|KOLENO"
   Worksheets("MASTERS").Cells(R, C).Interior.ColorIndex = 45
   Worksheets("MASTERS").Cells(R, C).Select
   With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="DO|fffd|KOLIT,ALTERNATIVA"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
   End With
   
  End If
  
  R = R + 1
  RHTSTOP = R
 Loop
 R = RHTSTART
 C = C + 1
Loop
Worksheets("MASTERS").Select

'--formatovani
Call Formatuj(RHTSTART, 1, RHTSTOP - 1, C - 1)
'Range(Cells(RHTSTART, 1), Cells(RHTSTOP - 1, C - 1)).Select

End Sub

Sub Formatuj(RS, CS, RE, CE)
  Range(Cells(RS, 1), Cells(RE, CE)).Select
  Selection.Borders(xlDiagonalDown).LineStyle = xlNone
  Selection.Borders(xlDiagonalUp).LineStyle = xlNone
  Selection.Borders(xlEdgeLeft).LineStyle = xlNone
  Selection.Borders(xlEdgeTop).LineStyle = xlNone
  Selection.Borders(xlEdgeBottom).LineStyle = xlNone
  Selection.Borders(xlEdgeRight).LineStyle = xlNone
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
  Selection.Borders(xlDiagonalDown).LineStyle = xlNone
  Selection.Borders(xlDiagonalUp).LineStyle = xlNone
  With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
  End With
  With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
  End With
  With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
  End With
  With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
  End With
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
  '--conditional formatting
  Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=""DO|fffd|KOLIT"""
  Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
  With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
  End With
  Selection.FormatConditions(1).StopIfTrue = False
  Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=""ALTERNATIVA"""
  Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
  With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight2
        .TintAndShade = 0.599963377788629
  End With
  Selection.FormatConditions(1).StopIfTrue = False
  
  Range("A1").Select

End Sub

Sub MakeSeznam()
'-- smazat sheet DOSKOLIT a ALTERNATIVNE DOSKOLIT
 Worksheets("DOSKOLIT").Activate
 Cells.Select
 Selection.Delete Shift:=xlUp
 Range("A1").Select
 Range("A1").Value = "Jm|fffd|no mechanika"
 Range("B1").Value = "Dealersk|fffd| k|fffd|d"
 Range("C1").Value = "K|fffd|d |fffd|kolen|fffd|"
 Range("D1").Value = "N|fffd|zev kurzu"
 Range("E1").Value = "|fffd|rove|fffd|"
 Range("F1").Value = "D|fffd|lka |fffd|kolen|fffd|"
 Range("G1").Value = "Volitelnost"
 Range(Cells(1, 1), Cells(1, 7)).Select
 Selection.Borders(xlDiagonalDown).LineStyle = xlNone
 Selection.Borders(xlDiagonalUp).LineStyle = xlNone
 With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 Selection.Borders(xlDiagonalDown).LineStyle = xlNone
 Selection.Borders(xlDiagonalUp).LineStyle = xlNone
 With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
 With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
        .PatternTintAndShade = 0
 End With
 Selection.Font.Bold = True
 Worksheets("ALTERNATIVA").Activate
 Cells.Select
 Selection.Delete Shift:=xlUp
 Range("A1").Select
 Range("A1").Value = "Jm|fffd|no mechanika"
 Range("B1").Value = "Dealersk|fffd| k|fffd|d"
 Range("C1").Value = "K|fffd|d |fffd|kolen|fffd|"
 Range("D1").Value = "N|fffd|zev kurzu"
 Range("E1").Value = "|fffd|rove|fffd|"
 Range("F1").Value = "D|fffd|lka |fffd|kolen|fffd|"
 Range("G1").Value = "Volitelnost"
 Range(Cells(1, 1), Cells(1, 7)).Select
 Selection.Borders(xlDiagonalDown).LineStyle = xlNone
 Selection.Borders(xlDiagonalUp).LineStyle = xlNone
 With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 Selection.Borders(xlDiagonalDown).LineStyle = xlNone
 Selection.Borders(xlDiagonalUp).LineStyle = xlNone
 With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
 End With
 With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
 End With
 Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
 With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
        .PatternTintAndShade = 0
 End With
 Selection.Font.Bold = True
'--loop pres MASTERS, hledat DO|fffd|KOLIT, kdy|fffd| nalezeno, vlo|fffd|it |fffd|daje do DOSKOLIT
C = 10 'start sloupec
R = 2 'start radek
DR = 2 'radek na sheetu DOSKOLIT
DLR = Worksheets("TECHNICI").Cells(4, 4).Value 'dealer kod
Worksheets("MASTERS").Activate
Do While Worksheets("MASTERS").Cells(1, C) <> ""
 R = 2
 Do While Worksheets("MASTERS").Cells(R, 1) <> ""
  
  If Cells(R, C).Value = "DO|fffd|KOLIT" Then
   '--vlozit zaznam do DOSKOLIT
   'MsgBox R & "-" & C
   Worksheets("DOSKOLIT").Cells(DR, 1).Value = Worksheets("MASTERS").Cells(1, C).Value
   Worksheets("DOSKOLIT").Cells(DR, 2).Value = DLR
   Worksheets("DOSKOLIT").Cells(DR, 3).Value = Worksheets("MASTERS").Cells(R, 1).Value
   Worksheets("DOSKOLIT").Cells(DR, 4).Value = Worksheets("MASTERS").Cells(R, 2).Value
   Worksheets("DOSKOLIT").Cells(DR, 5).Value = Worksheets("MASTERS").Cells(R, 5).Value
   Worksheets("DOSKOLIT").Cells(DR, 6).Value = Worksheets("MASTERS").Cells(R, 6).Value
   Worksheets("DOSKOLIT").Cells(DR, 7).Value = Worksheets("MASTERS").Cells(R, 4).Value
   DR = DR + 1
  End If
  
  R = R + 1
 Loop
 C = C + 1
Loop
'--loop pres MASTERS, hledat ALTERNATIVA, kdy|fffd| nalezeno, vlo|fffd|it |fffd|daje do ALTERNATIVA
C = 10 'start sloupec
R = 2 'start radek
DR = 2 'radek na sheetu DOSKOLIT
DLR = Worksheets("TECHNICI").Cells(4, 4).Value 'dealer kod
Worksheets("MASTERS").Activate
Do While Worksheets("MASTERS").Cells(1, C) <> ""
 R = 2
 Do While Worksheets("MASTERS").Cells(R, 1) <> ""
  
  If Cells(R, C).Value = "ALTERNATIVA" Then
   '--vlozit zaznam do DOSKOLIT
   'MsgBox R & "-" & C
   Worksheets("ALTERNATIVA").Cells(DR, 1).Value = Worksheets("MASTERS").Cells(1, C).Value
   Worksheets("ALTERNATIVA").Cells(DR, 2).Value = DLR
   Worksheets("ALTERNATIVA").Cells(DR, 3).Value = Worksheets("MASTERS").Cells(R, 1).Value
   Worksheets("ALTERNATIVA").Cells(DR, 4).Value = Worksheets("MASTERS").Cells(R, 2).Value
   Worksheets("ALTERNATIVA").Cells(DR, 5).Value = Worksheets("MASTERS").Cells(R, 5).Value
   Worksheets("ALTERNATIVA").Cells(DR, 6).Value = Worksheets("MASTERS").Cells(R, 6).Value
   Worksheets("ALTERNATIVA").Cells(DR, 7).Value = Worksheets("MASTERS").Cells(R, 4).Value
   DR = DR + 1
  End If
  
  R = R + 1
 Loop
 C = C + 1
Loop
 MsgBox "end"
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()

Call Show_MyMenu

End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{6FC4B27A-9739-4C13-956A-FED98F7B1891}{63AE8302-6824-4FB2-A65E-59C4A4D68312}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
 FullName = UserForm1.Jmeno & " " & UserForm1.Prijmeni
 'MsgBox FullName
'----novy user na konec
If FullName <> "," Then
Worksheets("Prehled Skoleni").Select
i = 2
Do While Range("H" & i) <> ""
 'MsgBox I & Range("H" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 2
'MsgBox POCETTECHNIKU
Range("H" & POCETTECHNIKU).Select
Range("H" & POCETTECHNIKU + 2).Value = FullName
Range("A" & POCETTECHNIKU + 2).Value = "x"
Range("B" & POCETTECHNIKU + 2).Value = "x"
Range("C" & POCETTECHNIKU + 2).Value = "x"
Range("D" & POCETTECHNIKU + 2).Value = "x"
Range("E" & POCETTECHNIKU + 2).Value = "x"
Range("F" & POCETTECHNIKU + 2).Value = "x"
Range("G" & POCETTECHNIKU + 2).Value = "x"
Range("I" & POCETTECHNIKU + 2).Value = "x"
End If
 
'----seznam jmen techniku ze sheetu 'Prehled skoleni', bez duplicit
Worksheets("Prehled Skoleni").Select
i = 2
Do While Range("H" & i) <> ""
 'MsgBox I & Range("H" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 2
'MsgBox POCETTECHNIKU
'----srovnani podle jmena
Worksheets("Prehled Skoleni").Select
Range("A2:I" & POCETTECHNIKU + 2).Select
    Selection.Sort Key1:=Range("H3"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
'----duplicity pryc
SEZNAMTECHNIKU = Range("H3").Value
L = 3
Worksheets("TMP").Cells.ClearContents
Worksheets("TMP").Cells(L - 2, 1).Value = "Seznam techniku"
Worksheets("TMP").Cells(L - 1, 1).Value = Range("H3").Value
For J = 4 To POCETTECHNIKU + 1
 KDO = Range("H" & J).Value
 DUPL = "NO"
 For K = J - 1 To 3 Step -1
  If Range("H" & K).Value = KDO Then
    DUPL = "YES"
    Exit For
  End If
 Next
 If DUPL <> "YES" Then
  SEZNAMTECHNIKU = SEZNAMTECHNIKU & vbCrLf & KDO
  Worksheets("TMP").Cells(L, 1).Value = KDO
  L = L + 1
 End If

Next

'MsgBox SEZNAMTECHNIKU
'---named range
Worksheets("TMP").Visible = True
Worksheets("TMP").Select
i = 2
Do While Range("A" & i) <> ""
 i = i + 1
Loop
ROZSAH = "=TMP!R2C1:R" & i - 1 & "C1"
ActiveWorkbook.Names.Add Name:="STLookup", RefersToR1C1:=ROZSAH
Worksheets("TMP").Visible = False
'---pocet techniku na sheetu TECHNICI
Worksheets("TECHNICI").Select
i = 12
Do While Range("A" & i) <> "Po|fffd|et technik|fffd|:" 'And Range("A" & I) <> "" '---pocet mista pro techniky
 'MsgBox I & Range("A" & I).Value
 i = i + 1
Loop
POCETTECHNIKU = i - 12
'MsgBox POCETTECHNIKU

'---validace na sheetu TECHNICI
Worksheets("TECHNICI").Select
Range(Cells(12, 1), Cells(12 + POCETTECHNIKU - 1, 1)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 3), Cells(12 + POCETTECHNIKU - 1, 7)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With
Range(Cells(12, 10), Cells(12 + POCETTECHNIKU - 1, 14)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=STLookup"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Chyba"
        .InputMessage = ""
        .ErrorMessage = "Nezname jmeno, pridej ho na seznam v Prehledu Skoleni !!!"
        .ShowInput = True
        .ShowError = True
    End With


 UserForm1.Jmeno = ""
 UserForm1.Prijmeni = ""
 UserForm1.Hide
End Sub




INQUEST-PP=macro
