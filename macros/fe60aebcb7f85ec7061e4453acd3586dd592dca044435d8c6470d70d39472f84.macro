Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
Application.ScreenUpdating = False
On Error GoTo Err_Worksheet_Change

' If the user changes the Shared Tools Indicator from Yes to No or vice versa,
'   then adjust the New Tools and Modified Delete worksheets to either show or
'   hide the LCR and Cost Allocation sections
  
  If Target.Row = 6 And Target.Column = 13 Then
    If UCase(Target.Value) = "YES" Then
      Worksheets(3).Columns("AA:BU").EntireColumn.Hidden = False
      Worksheets(4).Columns("W:BQ").EntireColumn.Hidden = False
    Else
      Worksheets(3).Columns("AA:BU").EntireColumn.Hidden = True
      Worksheets(4).Columns("W:BQ").EntireColumn.Hidden = True
    End If
  End If

Exit_Worksheet_Change:
    Application.ScreenUpdating = True
    Exit Sub

Err_Worksheet_Change:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : Worksheet_Change" & vbCrLf & "SHEET : EZ1810 Welcome Screen"
    Application.ScreenUpdating = True
    Resume Exit_Worksheet_Change
End Sub

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Const CON_COL_TC = 5            ' TOOL CATEGORY
Const CON_COL_TT = 6            ' TOOL TYPE
Const CON_COL_CURR = 10         ' CURRENCY
Const CON_COL_CM = 10           ' COUNTRY OF TOOL MANUFACTURER
Const CON_COL_TL = 11           ' TOOL LOCATION COUNTRY
Const CON_COL_GMML = 13         ' COUNTRY OF GM MANUFACTURING LOCATION
Const CON_COL_PP = 17           ' PROGRESSIVE PAYMENT

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
On Error GoTo Err_Worksheet_BeforeDoubleClick
  
  Dim bolValid As Boolean
  Dim intLCV As Integer
  Dim intMax As Integer
  
  gblRow = Target.Row
  gblCol = Target.Column
  gblSheet = "New Tools EZ1810 R6.5"

  bolValid = False
  intLCV = 22

  While (ActiveSheet.Cells(intLCV, 2).Value <> "" And ActiveSheet.Cells(intLCV, 2).Value <> "END")
    intLCV = intLCV + 1
  Wend
  intMax = intLCV - 1

  If gblRow > intMax Then
    Cancel = True
  Else
    If gblRow > 21 Then
      Select Case gblCol
      Case CON_COL_TC
        gblDataStart = 2
        gblDataEnd = 7
        gblDataColumn = 13
        gblTitle = "Select Tool Category"
        gblCaption = "Please select the Tool Category from the options below."
        bolValid = True
      Case CON_COL_TT
        If ActiveSheet.Cells(gblRow, 5).Value = "" Then
          MsgBox "ERROR : Please select a Tool Category prior to selecting a Tool Type.", vbCritical + vbOKOnly, "ERROR"
          Cancel = True
        Else
          With frmToolingType
            .StartUpPosition = 0
            .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
            .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
            .Show
          End With
          Cancel = True
        End If
      Case CON_COL_CM
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Country of Tool Manufacturer"
        gblCaption = "Please select the Country of Tool Manufacturer from the options below."
        bolValid = True
      Case CON_COL_TL
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Tool Location Country"
        gblCaption = "Please select the Tool Location Country from the options below."
        bolValid = True
      Case CON_COL_GMML
        gblDataStart = 2
        gblDataEnd = 23
        gblDataColumn = 8
        gblTitle = "Select Country of GM Manufacturing Location"
        gblCaption = "Please select the Country of GM Manufacturing Location from the options below."
        bolValid = True
      Case CON_COL_PP
        With frmProgressPayment
          .StartUpPosition = 0
          .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
          .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
          .Show
        End With
        Cancel = True
      End Select
    Else
      If (gblRow = 8 And gblCol = CON_COL_CURR) Then
        gblDataStart = 2
        gblDataEnd = 192
        gblDataColumn = 10
        gblTitle = "Select Currency"
        gblCaption = "Please select the Currency from the options below."
        bolValid = True
      End If
    End If
    If bolValid Then
      With frmGeneric
        .StartUpPosition = 0
        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
        .Show
      End With
      Cancel = True
    End If
  End If
  
Exit_Worksheet_BeforeDoubleClick:
    Exit Sub

Err_Worksheet_BeforeDoubleClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : Worksheet_BeforeDoubleClick" & vbCrLf & "SHEET : New Tools EZ1810"
    Resume Exit_Worksheet_BeforeDoubleClick
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
On Error GoTo Err_Worksheet_BeforeRightClick

  Dim bolValid As Boolean
  Dim intLCV As Integer
  Dim intMax As Integer
  
  gblRow = Target.Row
  gblCol = Target.Column
  gblSheet = "New Tools EZ1810 R6.5"
  
  bolValid = False
  intLCV = 22

  While (ActiveSheet.Cells(intLCV, 2).Value <> "" And ActiveSheet.Cells(intLCV, 2).Value <> "END")
    intLCV = intLCV + 1
  Wend
  intMax = intLCV - 1

  If gblRow > intMax Then
    Cancel = True
  Else
    If gblRow > 21 Then
      Select Case gblCol
      Case CON_COL_TC
        gblDataStart = 2
        gblDataEnd = 7
        gblDataColumn = 13
        gblTitle = "Select Tool Category"
        gblCaption = "Please select the Tool Category from the options below."
        bolValid = True
      Case CON_COL_TT
        If ActiveSheet.Cells(gblRow, 5).Value = "" Then
          MsgBox "ERROR : Please select a Tool Category prior to selecting a Tool Type.", vbCritical + vbOKOnly, "ERROR"
          Cancel = True
        Else
          With frmToolingType
            .StartUpPosition = 0
            .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
            .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
            .Show
          End With
          Cancel = True
        End If
      Case CON_COL_CM
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Country of Tool Manufacturer"
        gblCaption = "Please select the Country of Tool Manufacturer from the options below."
        bolValid = True
      Case CON_COL_TL
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Tool Location Country"
        gblCaption = "Please select the Tool Location Country from the options below."
        bolValid = True
      Case CON_COL_GMML
        gblDataStart = 2
        gblDataEnd = 23
        gblDataColumn = 8
        gblTitle = "Select Country of GM Manufacturing Location"
        gblCaption = "Please select the Country of GM Manufacturing Location from the options below."
        bolValid = True
      Case CON_COL_PP
        With frmProgressPayment
          .StartUpPosition = 0
          .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
          .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
          .Show
        End With
        Cancel = True
      End Select
    Else
      If (gblRow = 8 And gblCol = CON_COL_CURR) Then
        gblDataStart = 2
        gblDataEnd = 192
        gblDataColumn = 10
        gblTitle = "Select Currency"
        gblCaption = "Please select the Currency from the options below."
        bolValid = True
      End If
    End If
    If bolValid Then
      With frmGeneric
        .StartUpPosition = 0
        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
        .Show
      End With
      Cancel = True
    End If
  End If

Exit_Worksheet_BeforeRightClick:
    Exit Sub

Err_Worksheet_BeforeRightClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : Worksheet_BeforeRightClick" & vbCrLf & "SHEET : New Tools EZ1810"
    Resume Exit_Worksheet_BeforeRightClick
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)

Application.ScreenUpdating = False
Application.EnableEvents = False
Dim ws As Worksheet
Set ws = ThisWorkbook.Sheets(3)
ws.Columns("AA").ColumnWidth = 0.0625
ws.Columns("AM").ColumnWidth = 0.0625
ws.Columns("AX").ColumnWidth = 0.0625


Application.ScreenUpdating = True
Application.EnableEvents = True

End Sub
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Const CON_COL_MD = 4            ' MODIFY DELETE
Const CON_COL_BSOT = 7          ' BUILD STATUS OF TOOL
Const CON_COL_CLOT = 8          ' CURRENT LOCATION OF TOOL
Const CON_COL_CURR = 10         ' CURRENCY
Const CON_COL_TMD = 11          ' COUNTRY OF TOOL MODIFICATION / DELETE
Const CON_COL_GMML = 12         ' COUNTRY OF GM MANUFACTURING LOCATION

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
On Error GoTo Err_Worksheet_BeforeDoubleClick

  Dim bolValid As Boolean
  Dim intLCV As Integer
  Dim intMax As Integer
  
  gblRow = Target.Row
  gblCol = Target.Column
  gblSheet = "Modified Delete EZ1810 R6.5"
  
  bolValid = False
  intLCV = 22

  While (ActiveSheet.Cells(intLCV, 2).Value <> "" And ActiveSheet.Cells(intLCV, 2).Value <> "END")
    intLCV = intLCV + 1
  Wend
  intMax = intLCV - 1

  If gblRow > intMax Then
    Cancel = True
  Else
    If gblRow > 21 Then
      Select Case gblCol
      Case CON_COL_MD
        gblTitle = "Select Modify / Delete"
        gblCaption = "Please select Modify / Delete from the options below."
        bolValid = True
      Case CON_COL_BSOT
        gblDataStart = 41
        gblDataEnd = 44
        gblDataColumn = 13
        gblTitle = "Select Current Build Status of Tool"
        gblCaption = "Please select the Current Build Status of Tool from the options below."
        bolValid = True
      Case CON_COL_CLOT
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Country of Current Location of Tool"
        gblCaption = "Please select the Country of Current Location of Tool from the options below."
        bolValid = True
      Case CON_COL_TMD
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Tool Location Country"
        gblCaption = "Please select the Tool Location Country from the options below."
        bolValid = True
      Case CON_COL_GMML
        gblDataStart = 2
        gblDataEnd = 24
        gblDataColumn = 8
        gblTitle = "Select Country of GM Manufacturing Location"
        gblCaption = "Please select the Country of GM Manufacturing Location from the options below."
        bolValid = True
      End Select
    Else
      If (gblRow = 8 And gblCol = CON_COL_CURR) Then
        gblDataStart = 2
        gblDataEnd = 192
        gblDataColumn = 10
        gblTitle = "Select Currency"
        gblCaption = "Please select the Currency from the options below."
        bolValid = True
      End If
    End If
    If bolValid Then
      With frmGeneric
        .StartUpPosition = 0
        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
        .Show
      End With
      Cancel = True
    End If
  End If

Exit_Worksheet_BeforeDoubleClick:
    Exit Sub

Err_Worksheet_BeforeDoubleClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : Worksheet_BeforeDoubleClick" & vbCrLf & "SHEET : Modify Delete EZ1810"
    Resume Exit_Worksheet_BeforeDoubleClick
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
On Error GoTo Err_Worksheet_BeforeRightClick

  Dim bolValid As Boolean
  Dim intLCV As Integer
  Dim intMax As Integer
  
  gblRow = Target.Row
  gblCol = Target.Column
  gblSheet = "Modified Delete EZ1810 R6.5"
  
  bolValid = False
  intLCV = 22

  While (ActiveSheet.Cells(intLCV, 2).Value <> "" And ActiveSheet.Cells(intLCV, 2).Value <> "END")
    intLCV = intLCV + 1
  Wend
  intMax = intLCV - 1

  If gblRow > intMax Then
    Cancel = True
  Else
    If gblRow > 21 Then
      Select Case gblCol
      Case CON_COL_MD
        gblTitle = "Select Modify / Delete"
        gblCaption = "Please select Modify / Delete from the options below."
        bolValid = True
      Case CON_COL_BSOT
        gblDataStart = 41
        gblDataEnd = 44
        gblDataColumn = 13
        gblTitle = "Select Current Build Status of Tool"
        gblCaption = "Please select the Current Build Status of Tool from the options below."
        bolValid = True
      Case CON_COL_CLOT
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Country of Current Location of Tool"
        gblCaption = "Please select the Country of Current Location of Tool from the options below."
        bolValid = True
      Case CON_COL_TMD
        gblDataStart = 2
        gblDataEnd = 54
        gblDataColumn = 7
        gblTitle = "Select Tool Location Country"
        gblCaption = "Please select the Tool Location Country from the options below."
        bolValid = True
      Case CON_COL_GMML
        gblDataStart = 2
        gblDataEnd = 24
        gblDataColumn = 8
        gblTitle = "Select Country of GM Manufacturing Location"
        gblCaption = "Please select the Country of GM Manufacturing Location from the options below."
        bolValid = True
      End Select
    Else
      If (gblRow = 8 And gblCol = CON_COL_CURR) Then
        gblDataStart = 2
        gblDataEnd = 192
        gblDataColumn = 10
        gblTitle = "Select Currency"
        gblCaption = "Please select the Currency from the options below."
        bolValid = True
      End If
    End If
    If bolValid Then
      With frmGeneric
        .StartUpPosition = 0
        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
        .Show
      End With
      Cancel = True
    End If
  End If

Exit_Worksheet_BeforeRightClick:
    Exit Sub

Err_Worksheet_BeforeRightClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : Worksheet_BeforeRightClick" & vbCrLf & "SHEET : Modify Delete EZ1810"
    Resume Exit_Worksheet_BeforeRightClick
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)

Application.ScreenUpdating = False
Application.EnableEvents = False
Dim ws As Worksheet
Set ws = ThisWorkbook.Sheets(4)
ws.Columns("W").ColumnWidth = 0.0625
ws.Columns("AI").ColumnWidth = 0.0625
ws.Columns("AT").ColumnWidth = 0.0625


Application.ScreenUpdating = True
Application.EnableEvents = True

End Sub

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
On Error GoTo Err_Workbook_BeforeSave

  Dim shpOption1 As Shape
  Dim shpOption2 As Shape
  Dim shpOption3 As Shape
  Dim shpOption4 As Shape
  Dim strError As String
  
  Set shpOption1 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 1")
  Set shpOption2 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 2")
  Set shpOption3 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 3")
  Set shpOption4 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 4")
  
  If Worksheets("EZ1810 Welcome Screen").Range("L10") <> Null Then
    If shpOption1.ControlFormat.Value = xlOn Then
      strError = fncCheckNew
      If strError <> "" Then
        If (6 <> MsgBox("There are Errors on the 1810.  Save anyways?", vbQuestion + vbYesNo, "ERRORS IDENTIFIED")) Then
          Cancel = True
        End If
      End If
    End If
  
    If shpOption2.ControlFormat.Value = xlOn Then
      strError = fncCheckMD
      If strError <> "" Then
        If (6 <> MsgBox("There are Errors on the 1810.  Save anyways?", vbQuestion + vbYesNo, "ERRORS IDENTIFIED")) Then
          Cancel = True
        End If
      End If
    End If
  
    If shpOption3.ControlFormat.Value = xlOn Then
      strError = fncCheckNew & fncCheckMD
      If strError <> "" Then
        If (6 <> MsgBox("There are Errors on the 1810.  Save anyways?", vbQuestion + vbYesNo, "ERRORS IDENTIFIED")) Then
          Cancel = True
        End If
      End If
    End If
  
    If shpOption4.ControlFormat.Value = xlOn Then
      strError = fncCheckNew & fncCheckMD
      If strError <> "" Then
        If (6 <> MsgBox("There are Errors on the 1810.  Save anyways?", vbQuestion + vbYesNo, "ERRORS IDENTIFIED")) Then
          Cancel = True
        End If
      End If
    End If
  End If

Exit_Workbook_BeforeSave:
    Exit Sub

Err_Workbook_BeforeSave:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : Workbook_BeforeSave" & vbCrLf & "SHEET : All"
    Resume Exit_Workbook_BeforeSave
End Sub

Private Sub Workbook_Open()
On Error GoTo Err_Workbook_Open

  Worksheets(1).Protect Password:=gblPassword, UserInterfaceOnly:=True
  Worksheets(2).Protect Password:=gblPassword, UserInterfaceOnly:=True
  Worksheets(3).Protect Password:=gblPassword, UserInterfaceOnly:=True
  Worksheets(4).Protect Password:=gblPassword, UserInterfaceOnly:=True
  Worksheets(5).Visible = xlVeryHidden
  Worksheets(6).Visible = xlVeryHidden
  Sheets(2).Activate
  Application.DisplayCommentIndicator = xlCommentIndicatorOnly
  
Exit_Workbook_Open:
    Exit Sub

Err_Workbook_Open:
'Suppress Errors from Displaying as they are due to either Enabling Macros or exiting Read Only Mode and had no effect on the functionality
    Resume Exit_Workbook_Open
End Sub
Attribute VB_Name = "frmGeneric"
Attribute VB_Base = "0{B0644F5E-4A2E-4438-A1E0-2ED7D2B22F66}{7782CDED-E33A-4DB7-B787-C02875F06E71}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Function fncSelect()
On Error GoTo Err_fncSelect

  Dim strR1US, strR2US As String
  Dim strR1MX, strR2MX As String
  Dim strR1CA, strR2CA As String
  Dim strR1TC As String
  Dim strReset As String
  Dim intCC As Integer
  
  Select Case gblSheet
  Case "New Tools EZ1810 R6.5"
    strR1US = "AA" & gblRow & ":AE" & gblRow
    strR2US = "AG" & gblRow & ":AK" & gblRow
    strR1MX = "AA" & gblRow & ":AF" & gblRow
    strR2MX = "AH" & gblRow & ":AK" & gblRow
    strR1CA = "AA" & gblRow & ":AG" & gblRow
    strR2CA = "AI" & gblRow & ":AK" & gblRow
    strR1TC = "AK" & gblRow & ":AK" & gblRow
    strReset = "AA" & gblRow & ":AK" & gblRow
    intCC = 14
    
    Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value
    If gblCol = 5 Then
      gblCol = gblCol + 1
      ActiveSheet.Range("D" & gblRow).Value = ""
      With frmToolingType
        .StartUpPosition = 0
        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
        .Show
      End With
    End If
' If Country of Tool Manufacturer is the same as the Tool Location Country, then Customs
' defaults to 0.000% and is not editable
    If Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 10).Value = Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 11).Value Then
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Value = 0
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Locked = True
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Interior.ThemeColor = xlThemeColorAccent3
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Interior.TintAndShade = 0.599993896298105
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Interior.PatternTintAndShade = 0
    Else
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Locked = False
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Interior.Pattern = xlNone
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Interior.TintAndShade = 0
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, 16).Interior.PatternTintAndShade = 0
    End If
  Case "Modified Delete EZ1810 R6.5"
    strR1US = "W" & gblRow & ":AA" & gblRow
    strR2US = "AC" & gblRow & ":AG" & gblRow
    strR1MX = "W" & gblRow & ":AB" & gblRow
    strR2MX = "AD" & gblRow & ":AG" & gblRow
    strR1CA = "W" & gblRow & ":AC" & gblRow
    strR2CA = "AE" & gblRow & ":AG" & gblRow
    strR1TC = "AG" & gblRow & ":AG" & gblRow
    strReset = "W" & gblRow & ":AG" & gblRow
    intCC = 12
    
    Worksheets("Modified Delete EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value
  End Select
  frmGeneric.Hide
  
  With Range(strReset).Interior
    .Pattern = xlNone
    .TintAndShade = 0
    .PatternTintAndShade = 0
  End With
  Range(strReset).ClearContents
  Range(strReset).Locked = False
  
  Select Case Worksheets(gblSheet).Cells(gblRow, intCC).Value
  Case "1000"
    Range(strR1US).Locked = True
    Range(strR2US).Locked = True
    With Range(strR1US).Interior
      .ThemeColor = xlThemeColorAccent3
      .TintAndShade = 0.599993896298105
      .PatternTintAndShade = 0
    End With
    With Range(strR2US).Interior
      .ThemeColor = xlThemeColorAccent3
      .TintAndShade = 0.599993896298105
      .PatternTintAndShade = 0
    End With
  Case "3000"
    Range(strR1CA).Locked = True
    Range(strR2CA).Locked = True
    With Range(strR1CA).Interior
      .ThemeColor = xlThemeColorAccent3
      .TintAndShade = 0.599993896298105
      .PatternTintAndShade = 0
    End With
    With Range(strR2CA).Interior
      .ThemeColor = xlThemeColorAccent3
      .TintAndShade = 0.599993896298105
      .PatternTintAndShade = 0
    End With
  Case "7090"
    Range(strR1MX).Locked = True
    Range(strR2MX).Locked = True
    With Range(strR1MX).Interior
      .ThemeColor = xlThemeColorAccent3
      .TintAndShade = 0.599993896298105
      .PatternTintAndShade = 0
    End With
    With Range(strR2MX).Interior
      .ThemeColor = xlThemeColorAccent3
      .TintAndShade = 0.599993896298105
      .PatternTintAndShade = 0
    End With
  Case "TBD"
    If gblSheet = "New Tools EZ1810 R6.5" Then
      If Worksheets(gblSheet).Cells(gblRow, 11).Value = "Mexico" And Worksheets(gblSheet).Cells(gblRow, 13).Value = "Multiple" Then
        Range(strR1TC).Locked = True
        With Range(strR1TC).Interior
          .ThemeColor = xlThemeColorAccent3
          .TintAndShade = 0.599993896298105
         .PatternTintAndShade = 0
        End With
      End If
    Else
      If Worksheets(gblSheet).Cells(gblRow, 11).Value = "Mexico" And Worksheets(gblSheet).Cells(gblRow, 12).Value = "Multiple" Then
        Range(strR1TC).Locked = True
        With Range(strR1TC).Interior
          .ThemeColor = xlThemeColorAccent3
          .TintAndShade = 0.599993896298105
         .PatternTintAndShade = 0
        End With
      End If
    End If
  End Select

Exit_fncSelect:
    Exit Function

Err_fncSelect:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncSelect" & vbCrLf & "SHEET : frmGeneric"
    Resume Exit_fncSelect
End Function

Private Sub cmdCancel_Click()
On Error GoTo Err_cmdCancel_Click

  frmGeneric.Hide

Exit_cmdCancel_Click:
    Exit Sub

Err_cmdCancel_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdCancel_Click" & vbCrLf & "SHEET : frmGeneric"
    Resume Exit_cmdCancel_Click
End Sub

Private Sub cmdOK_Click()
On Error GoTo Err_cmdOK_Click

  fncSelect

Exit_cmdOK_Click:
    Exit Sub

Err_cmdOK_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdOK_Click" & vbCrLf & "SHEET : frmGeneric"
    Resume Exit_cmdOK_Click
End Sub

Private Sub lstData_Click()
On Error GoTo Err_lstData_Click

  cmdOK.Enabled = True
 
Exit_lstData_Click:
    Exit Sub

Err_lstData_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : lstData_Click" & vbCrLf & "SHEET : frmGeneric"
    Resume Exit_lstData_Click
End Sub

Private Sub lstData_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_lstData_DblClick
  
  fncSelect

Exit_lstData_DblClick:
    Exit Sub

Err_lstData_DblClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : lstData_DblClick" & vbCrLf & "SHEET : frmGeneric"
    Resume Exit_lstData_DblClick
End Sub

Private Sub UserForm_Activate()
On Error GoTo Err_UserForm_Activate

  Dim intLCV As Integer

  cmdOK.Enabled = False
  
  For intLCV = 1 To lstData.ListCount
    lstData.RemoveItem 0
  Next intLCV
  
  frmGeneric.Caption = gblTitle
  lblTitle.Caption = gblCaption

  If (gblRow = 8) Then
    lstData.ColumnCount = 2
    lstData.ColumnWidths = "30;125"
  Else
    lstData.ColumnCount = 1
    lstData.ColumnWidths = "155"
  End If
  
  Select Case gblSheet
  Case "New Tools EZ1810 R6.5"
    For intLCV = gblDataStart To gblDataEnd
      If gblTitle = "Select Country of GM Manufacturing Location" And Worksheets("Data").Cells(intLCV, gblDataColumn) = "Multiple" And Worksheets("EZ1810 Welcome Screen").Cells(6, 13) = "No" Then
      Else
        If (gblRow = 8) Then
          lstData.AddItem Worksheets("Data").Cells(intLCV, gblDataColumn)
          lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, gblDataColumn + 1)
        Else
          lstData.AddItem Worksheets("Data").Cells(intLCV, gblDataColumn)
        End If
      End If
    Next intLCV
  Case "Modified Delete EZ1810 R6.5"
    If (gblCol = 4) Then
      lstData.AddItem "Modify"
      lstData.AddItem "Delete"
      lstData.AddItem "Decrease"
    Else
      For intLCV = 1 To lstData.ListCount
        lstData.RemoveItem 0
      Next intLCV
    
      frmGeneric.Caption = gblTitle
      lblTitle.Caption = gblCaption

      For intLCV = gblDataStart To gblDataEnd
        If gblTitle = "Select Country of GM Manufacturing Location" And Worksheets("Data").Cells(intLCV, gblDataColumn) = "Multiple" And Worksheets("EZ1810 Welcome Screen").Cells(6, 13) = "No" Then
        Else
          If (gblRow = 8) Then
            lstData.AddItem Worksheets("Data").Cells(intLCV, gblDataColumn)
            lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, gblDataColumn + 1)
          Else
            lstData.AddItem Worksheets("Data").Cells(intLCV, gblDataColumn)
          End If
        End If
      Next intLCV
    End If
  End Select
  cmdCancel.SetFocus

Exit_UserForm_Activate:
    Exit Sub

Err_UserForm_Activate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : UserForm_Activate" & vbCrLf & "SHEET : frmGeneric"
    Resume Exit_UserForm_Activate
End Sub
Attribute VB_Name = "frmModifyDelete"
Attribute VB_Base = "0{68FF7CFB-F7A9-49B8-A335-D7D60B60351D}{6AD10BC8-8B67-430A-975B-987C5851BC17}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdCancel_Click()
On Error GoTo Err_cmdCancel_Click

  frmModifyDelete.Hide
  gblCancel = -1

Exit_cmdCancel_Click:
    Exit Sub

Err_cmdCancel_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdCancel_Click" & vbCrLf & "SHEET : frmModifyDelete"
    Resume Exit_cmdCancel_Click
End Sub

Private Sub cmdOK_Click()
On Error GoTo Err_cmdOK_Click
  
  If txtWBS = "" Then
    lblError.Visible = True
  Else
    If txtGL = "" Then
      lblError.Visible = True
    Else
      lblError.Visible = False
      gblWBS = txtWBS
      gblGL = txtGL
      frmModifyDelete.Hide
    End If
  End If
  
Exit_cmdOK_Click:
    Exit Sub

Err_cmdOK_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdOK_Click" & vbCrLf & "SHEET : frmModifyDelete"
    Resume Exit_cmdOK_Click
End Sub

Private Sub UserForm_Activate()
On Error GoTo Err_UserForm_Activate

  gblWBS = ""
  gblGL = ""
  lblError.Caption = "WBS and G/L Numbers are required to proceed."
  lblError.Visible = False
  
Exit_UserForm_Activate:
    Exit Sub

Err_UserForm_Activate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : UserForm_Activate" & vbCrLf & "SHEET : frmModifyDelete"
    Resume Exit_UserForm_Activate
End Sub

Attribute VB_Name = "frmProgressPayment"
Attribute VB_Base = "0{26F23819-D45C-46C1-B2DA-E46D2869C357}{55685D00-2FDF-44BC-B725-7A04A173A0A0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Function fncAdditionalData()
On Error GoTo Err_fncAdditionalData
    
  lbl2.Visible = False
  txt2.Visible = False
  lbl3.Visible = False
  txt3.Visible = False
  
  Select Case lstData.Value
  Case "Pull ahead tooling"
    lbl2.Visible = True
    lbl2.Caption = "Quantity Pulled Ahead"
    txt2.Visible = True
    lbl3.Visible = True
    lbl3.Caption = "Unit Cost of Pull Ahead"
    txt3.Visible = True
  End Select
  
Exit_fncAdditionalData:
    Exit Function

Err_fncAdditionalData:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncAdditionalData" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_fncAdditionalData
End Function

Private Function fncSelect()
On Error GoTo Err_fncSelect

  If lstData.Value = "Pull ahead tooling" Then
    If txt2.Value = "" Or txt3.Value = "" Then
      MsgBox "Quantity Pulled Ahead and Unit Cost of Pull Ahead are required.", vbCritical + vbOKOnly, "ERROR"
    Else
      Select Case gblSheet
      Case "New Tools EZ1810 R6.5"
        Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt2.Value & "/" & txt3.Value
      Case "Modified Delete EZ1810 R6.5"
        Worksheets("Modified Delete EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt2.Value & "/" & txt3.Value
      End Select
      frmProgressPayment.Hide
    End If
  Else
    Select Case gblSheet
    Case "New Tools EZ1810 R6.5"
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value
    Case "Modified Delete EZ1810 R6.5"
      Worksheets("Modified Delete EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value
    End Select
    frmProgressPayment.Hide
  End If
  
Exit_fncSelect:
    Exit Function

Err_fncSelect:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncSelect" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_fncSelect
End Function

Private Sub cmdCancel_Click()
On Error GoTo Err_cmdCancel_Click

  Unload frmProgressPayment

Exit_cmdCancel_Click:
    Exit Sub

Err_cmdCancel_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdCancel_Click" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_cmdCancel_Click
End Sub

Private Sub cmdOK_Click()
On Error GoTo Err_cmdOK_Click

  fncSelect
  
Exit_cmdOK_Click:
    Exit Sub

Err_cmdOK_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdOK_Click" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_cmdOK_Click
End Sub

Private Sub lstData_Click()
On Error GoTo Err_lstData_Click

  fncAdditionalData
  cmdOK.Enabled = True
 
Exit_lstData_Click:
    Exit Sub

Err_lstData_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : lstData_Click" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_lstData_Click
End Sub

Private Sub lstData_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_lstData_DblClick
  
  fncSelect

Exit_lstData_DblClick:
    Exit Sub

Err_lstData_DblClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : lstData_DblClick" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_lstData_DblClick
End Sub

Private Sub txt2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_txt2_BeforeUpdate

  If Not IsNumeric(txt2.Value) Then
    MsgBox "ERROR : Value must be Numeric.", vbCritical + vbOKOnly, "ERROR"
    Cancel = True
  End If
  
Exit_txt2_BeforeUpdate:
    Exit Sub

Err_txt2_BeforeUpdate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : txt2_BeforeUpdate" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_txt2_BeforeUpdate
End Sub

Private Sub txt3_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_txt3_BeforeUpdate

  If Not IsNumeric(txt3.Value) Then
    MsgBox "ERROR : Value must be Numeric.", vbCritical + vbOKOnly, "ERROR"
    Cancel = True
  End If
  
Exit_txt3_BeforeUpdate:
    Exit Sub

Err_txt3_BeforeUpdate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : txt3_BeforeUpdate" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_txt3_BeforeUpdate
End Sub

Private Sub UserForm_Activate()
On Error GoTo Err_UserForm_Activate

  Dim intLCV As Integer
   
  For intLCV = 1 To lstData.ListCount
    lstData.RemoveItem 0
  Next intLCV
 
  frmToolingType.Caption = "Select Progress Payment Type"
  lblTitle.Caption = "Please select the Progress Payment Type from the options below."
  lstData.ColumnWidths = "200"
  
    For intLCV = 35 To 38
      lstData.AddItem Worksheets("Data").Cells(intLCV, 13)
    Next intLCV
  cmdCancel.SetFocus
  
Exit_UserForm_Activate:
    Exit Sub

Err_UserForm_Activate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : UserForm_Activate" & vbCrLf & "SHEET : frmProgressPayment"
    Resume Exit_UserForm_Activate
End Sub
Attribute VB_Name = "frmToolingType"
Attribute VB_Base = "0{24451709-9685-43C7-B933-9F7545E45E69}{8B322F81-4F7C-40AA-B065-1E31FAE35352}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Function fncAdditionalData()
On Error GoTo Err_fncAdditionalData

  lblOther.Visible = False
  txtOther.Visible = False
  lbl1.Visible = False
  txt1.Visible = False
  lbl2.Visible = False
  txt2.Visible = False
  lbl3.Visible = False
  txt3.Visible = False

  Select Case Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol - 1).Value
  Case "Jig_or_Fixture"
    Select Case lstData.Value
    Case "Other"
      lblOther.Visible = True
      txtOther.Visible = True
    End Select
  Case "Mold"
    Select Case lstData.Value
    Case "Blow Mold"
      lbl1.Visible = True
      lbl1.Caption = "Total Number of Cavities"
      txt1.Visible = True
    Case "InjectionPlastic", "Injection Rubber", "Inj2shotRotation", "Inj2shotRetrCore"
      lbl1.Visible = True
      lbl1.Caption = "Total Number of Cavities"
      txt1.Visible = True
      lbl2.Visible = True
      lbl2.Caption = "Total Number of Injection Points"
      txt2.Visible = True
      lbl3.Visible = True
      lbl3.Caption = "Total Number of Mechanisms"
      txt3.Visible = True
    Case "Other"
      lblOther.Visible = True
      txtOther.Visible = True
    End Select
  Case "Casting"
    Select Case lstData.Value
    Case "Other"
      lblOther.Visible = True
      txtOther.Visible = True
    Case Else
      lbl1.Visible = True
      lbl1.Caption = "Total Number of Cavities"
      txt1.Visible = True
    End Select
  Case "Stamping"
    Select Case lstData.Value
    Case "Progressive Die"
      lbl1.Visible = True
      lbl1.Caption = "Coil Width (mm)"
      txt1.Visible = True
      lbl2.Visible = True
      lbl2.Caption = "Number of Stations"
      txt2.Visible = True
    Case "Other"
      lblOther.Visible = True
      txtOther.Visible = True
    Case Else
      lbl1.Visible = True
      lbl1.Caption = "Material Width (mm)"
      txt1.Visible = True
      lbl2.Visible = True
      lbl2.Caption = "Material Length (mm)"
      txt2.Visible = True
    End Select
  Case "Forming", "Misc"
    Select Case lstData.Value
    Case "Other"
      lblOther.Visible = True
      txtOther.Visible = True
    End Select
  End Select

Exit_fncAdditionalData:
    Exit Function

Err_fncAdditionalData:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncAdditionalData" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_fncAdditionalData
End Function

Private Function fncSelect()
On Error GoTo Err_fncSelect

  Dim intCode As Integer
  Dim strAdditional As String
  
  If (txtAdditional <> "") Then
    strAdditional = "-" & Left(txtAdditional, 15)
  Else
    strAdditional = ""
  End If
  
  intCode = 0
  If txt1.Visible Then
    intCode = intCode + 1
  End If
  If txt2.Visible Then
    intCode = intCode + 2
  End If
  If txt3.Visible Then
    intCode = intCode + 4
  End If
  If txtOther.Visible Then
    intCode = intCode + 8
  End If

  If ((txt1.Visible = True) And (txt1.Value = "")) Or ((txt2.Visible = True) And (txt2.Value = "")) Or ((txt3.Visible = True) And (txt3.Value = "")) Or ((txtOther.Visible = True) And (txtOther.Value = "")) Then
     MsgBox "ERROR : Please enter all required fields.", vbCritical + vbOKOnly, "ERROR"
  Else
    Select Case intCode
    Case 0
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & strAdditional
    Case 1
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt1.Value & strAdditional
    Case 3
      If (Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol - 1).Value = "Stamping") Then
        If (lstData.Value = "Progressive Die") Then
          Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt1.Value & "/" & txt2.Value & strAdditional
        Else
          Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt1.Value & "x" & txt2.Value & strAdditional
        End If
        Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt1.Value & "x" & txt2.Value & strAdditional
      Else
        Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt1.Value & "/" & txt2.Value & strAdditional
      End If
    Case 7
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & " " & txt1.Value & "/" & txt2.Value & "/" & txt3.Value & strAdditional
    Case 8
      Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol).Value = lstData.Value & "-" & txtOther.Value & strAdditional
    End Select
    Unload frmToolingType
  End If
  
Exit_fncSelect:
    Exit Function

Err_fncSelect:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncSelect" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_fncSelect
End Function

Private Sub cmdCancel_Click()
On Error GoTo Err_cmdCancel_Click

  Unload frmToolingType

Exit_cmdCancel_Click:
    Exit Sub

Err_cmdCancel_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdCancel_Click" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_cmdCancel_Click
End Sub

Private Sub cmdOK_Click()
On Error GoTo Err_cmdOK_Click

  fncSelect
  
Exit_cmdOK_Click:
    Exit Sub

Err_cmdOK_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : cmdOK_Click" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_cmdOK_Click
End Sub

Private Sub lstData_Click()
On Error GoTo Err_lstData_Click
  
  fncAdditionalData
  cmdOK.Enabled = True
 
Exit_lstData_Click:
    Exit Sub

Err_lstData_Click:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : lstData_Click" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_lstData_Click
End Sub

Private Sub lstData_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_lstData_DblClick
  
  fncSelect

Exit_lstData_DblClick:
    Exit Sub

Err_lstData_DblClick:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : lstData_DblClick" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_lstData_DblClick
End Sub

Private Sub txt1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_txt1_BeforeUpdate

  If Not IsNumeric(txt1.Value) Then
    MsgBox "ERROR : Value must be Numeric.", vbCritical + vbOKOnly, "ERROR"
    Cancel = True
  End If

Exit_txt1_BeforeUpdate:
    Exit Sub

Err_txt1_BeforeUpdate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : txt1_BeforeUpdate" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_txt1_BeforeUpdate
End Sub

Private Sub txt2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_txt2_BeforeUpdate

  If Not IsNumeric(txt2.Value) Then
    MsgBox "ERROR : Value must be Numeric.", vbCritical + vbOKOnly, "ERROR"
    Cancel = True
  End If
  
Exit_txt2_BeforeUpdate:
    Exit Sub

Err_txt2_BeforeUpdate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : txt2_BeforeUpdate" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_txt2_BeforeUpdate
End Sub

Private Sub txt3_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_txt3_BeforeUpdate

  If Not IsNumeric(txt3.Value) Then
    MsgBox "ERROR : Value must be Numeric.", vbCritical + vbOKOnly, "ERROR"
    Cancel = True
  End If
  
Exit_txt3_BeforeUpdate:
    Exit Sub

Err_txt3_BeforeUpdate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : txt3_BeforeUpdate" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_txt3_BeforeUpdate
End Sub

Private Sub txtAdditional_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
On Error GoTo Err_txtAdditional_BeforeUpdate

  If Len(txtAdditional) > 15 Then
    MsgBox "WARNING : Fifteen (15) character maximum allowed, any extra characterd will be truncated.", vbInformation + vbOKOnly, "WARNING"
  End If

Exit_txtAdditional_BeforeUpdate:
    Exit Sub

Err_txtAdditional_BeforeUpdate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : txtAdditional_BeforeUpdate" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_txtAdditional_BeforeUpdate
End Sub

Private Sub UserForm_Activate()
On Error GoTo Err_UserForm_Activate

  Dim intLCV As Integer
   
  lstData.ColumnWidths = "150;0"
  frmToolingType.Caption = "Select Tool Type"
  lblTitle.Caption = "Please select the Tool Type from the options below."
    
  Select Case Worksheets("New Tools EZ1810 R6.5").Cells(gblRow, gblCol - 1).Value
  Case "Jig_or_Fixture"
    For intLCV = 2 To 19
      lstData.AddItem Worksheets("Data").Cells(intLCV, 15)
      lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, 16)
    Next intLCV
  Case "Mold"
    For intLCV = 2 To 13
      lstData.AddItem Worksheets("Data").Cells(intLCV, 18)
      lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, 19)
    Next intLCV
  Case "Casting"
    For intLCV = 2 To 9
      lstData.AddItem Worksheets("Data").Cells(intLCV, 21)
      lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, 22)
    Next intLCV
  Case "Stamping"
    For intLCV = 2 To 16
      lstData.AddItem Worksheets("Data").Cells(intLCV, 24)
      lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, 25)
    Next intLCV
  Case "Forming"
    For intLCV = 2 To 12
      lstData.AddItem Worksheets("Data").Cells(intLCV, 27)
      lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, 28)
    Next intLCV
  Case "Misc"
    For intLCV = 2 To 6
      lstData.AddItem Worksheets("Data").Cells(intLCV, 30)
      lstData.List(lstData.ListCount - 1, 1) = Worksheets("Data").Cells(intLCV, 31)
    Next intLCV
  Case Else
  End Select
  
  cmdCancel.SetFocus
  
Exit_UserForm_Activate:
    Exit Sub

Err_UserForm_Activate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : UserForm_Activate" & vbCrLf & "SHEET : frmToolingType"
    Resume Exit_UserForm_Activate
End Sub
Attribute VB_Name = "modBOM"
Option Explicit

Sub subBOMNT()
On Error GoTo Err_subBOMNT

  Const conUsgInd = "V"
  Const conQty = "1"

  Dim objSheet As Worksheet
  Dim sapSheet As Worksheet
  Dim sapWorkbook As Workbook
  Dim intRow As Integer
  Dim intSAPRow As Integer
  Dim intLCV As Integer
  Dim intComma As Integer
  Dim strPart As String
  Dim bolDone As Boolean
     
  intRow = 22
  intSAPRow = 2
  If (ActiveSheet.Range("B22").Value = "") Then
    MsgBox "Please ensure that there is data in the first row of the SMART 1810.", vbCritical + vbOKOnly, "ERROR"
  Else
    Set objSheet = ActiveSheet
    Set sapWorkbook = Workbooks.Add
    Set sapSheet = sapWorkbook.ActiveSheet
    sapSheet.Columns("A:B").ColumnWidth = 25
    sapSheet.Range("A1").Value = "Usage Factor"
    sapSheet.Range("B1").Value = "Part"
    sapSheet.Range("C1").Value = ""
    sapSheet.Range("D1").Value = "Quantity"
    While (objSheet.Cells(intRow, 2) <> "") And (objSheet.Cells(intRow, 2) <> "END")
      strPart = ""
      For intLCV = 1 To Len(objSheet.Cells(intRow, 3).Value)
        If (Mid(objSheet.Cells(intRow, 3).Value, intLCV, 1) <> " ") Then
          strPart = strPart & Mid(objSheet.Cells(intRow, 3).Value, intLCV, 1)
        End If
      Next intLCV
      intComma = InStr(strPart, ",")
      bolDone = False
      While Not bolDone
        If (intComma = 0) Then
          sapSheet.Cells(intSAPRow, 1).Value = conUsgInd
          sapSheet.Cells(intSAPRow, 2).Value = strPart
          sapSheet.Cells(intSAPRow, 3).Value = ""
          sapSheet.Cells(intSAPRow, 4).Value = conQty
          intSAPRow = intSAPRow + 1
          bolDone = True
        Else
          sapSheet.Cells(intSAPRow, 1).Value = conUsgInd
          sapSheet.Cells(intSAPRow, 2).Value = Left(strPart, intComma - 1)
          sapSheet.Cells(intSAPRow, 3).Value = ""
          sapSheet.Cells(intSAPRow, 4).Value = conQty
          strPart = Right(strPart, (Len(strPart) - intComma))
          Debug.Print strPart
          intComma = InStr(strPart, ",")
          intSAPRow = intSAPRow + 1
        End If
      Wend
      intRow = intRow + 1
    Wend
    sapSheet.Range("A:D").RemoveDuplicates Columns:=Array(1, 2, 3, 4), Header:=xlYes
  End If
  
Exit_subBOMNT:
    Exit Sub

Err_subBOMNT:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subBOMNT" & vbCrLf & "SHEET : modBOM"
    Resume Exit_subBOMNT
End Sub

Sub subBOMMD()
On Error GoTo Err_subBOMMD

  Const conUsgInd = "V"
  Const conQty = "1"

  Dim objSheet As Worksheet
  Dim sapSheet As Worksheet
  Dim sapWorkbook As Workbook
  Dim intRow As Integer
  Dim intSAPRow As Integer
  Dim intLCV As Integer
  Dim intComma As Integer
  Dim strPart As String
  Dim bolDone As Boolean
     
  intRow = 22
  intSAPRow = 2
  If (ActiveSheet.Range("B22").Value = "") Then
    MsgBox "Please ensure that there is data in the first row of the SMART 1810.", vbCritical + vbOKOnly, "ERROR"
  Else
    Set objSheet = ActiveSheet
    Set sapWorkbook = Workbooks.Add
    Set sapSheet = sapWorkbook.ActiveSheet
    sapSheet.Columns("A:B").ColumnWidth = 25
    sapSheet.Range("A1").Value = "Usage Factor"
    sapSheet.Range("B1").Value = "Part"
    sapSheet.Range("C1").Value = ""
    sapSheet.Range("D1").Value = "Quantity"
    While (objSheet.Cells(intRow, 2) <> "") And (objSheet.Cells(intRow, 2) <> "END")
      strPart = ""
      For intLCV = 1 To Len(objSheet.Cells(intRow, 5).Value)
        If (Mid(objSheet.Cells(intRow, 5).Value, intLCV, 1) <> " ") Then
          strPart = strPart & Mid(objSheet.Cells(intRow, 5).Value, intLCV, 1)
        End If
      Next intLCV
      intComma = InStr(strPart, ",")
      bolDone = False
      While Not bolDone
        If (intComma = 0) Then
          sapSheet.Cells(intSAPRow, 1).Value = conUsgInd
          sapSheet.Cells(intSAPRow, 2).Value = strPart
          sapSheet.Cells(intSAPRow, 3).Value = ""
          sapSheet.Cells(intSAPRow, 4).Value = conQty
          intSAPRow = intSAPRow + 1
          bolDone = True
        Else
          sapSheet.Cells(intSAPRow, 1).Value = conUsgInd
          sapSheet.Cells(intSAPRow, 2).Value = Left(strPart, intComma - 1)
          sapSheet.Cells(intSAPRow, 3).Value = ""
          sapSheet.Cells(intSAPRow, 4).Value = conQty
          strPart = Right(strPart, (Len(strPart) - intComma))
          Debug.Print strPart
          intComma = InStr(strPart, ",")
          intSAPRow = intSAPRow + 1
        End If
      Wend
      intRow = intRow + 1
    Wend
    sapSheet.Range("A:D").RemoveDuplicates Columns:=Array(1, 2, 3, 4), Header:=xlYes
  End If
  
Exit_subBOMMD:
    Exit Sub

Err_subBOMMD:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subBOMMD" & vbCrLf & "SHEET : modBOM"
    Resume Exit_subBOMMD
End Sub
Attribute VB_Name = "modCopyToDetail"
Option Explicit

Function fncPad(strString As String, intLength As Integer, strLR As String) As String
On Error GoTo Err_fncPad

  Dim tempString As String
  
  tempString = strString
  If Len(tempString) > intLength Then
    tempString = Left(tempString, intLength)
  Else
    While Len(tempString) < intLength
      If strLR = "L" Then
        tempString = " " & tempString
      Else
        tempString = tempString & " "
      End If
    Wend
  End If
  
  fncPad = tempString
  
Exit_fncPad:
    Exit Function

Err_fncPad:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncPad" & vbCrLf & "SHEET : modCopyToDetail"
    Resume Exit_fncPad
End Function

Sub subExportGPSNew()
On Error GoTo Err_subExportGPSNew

  Dim obj As New DataObject
  Dim objSheet As Object
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intRow As Integer
  Dim strRefPart As String
  Dim strRefPartTemp As String
  Dim strOutput As String
  Dim rngRange As Excel.Range
  
  Worksheets("New Tools EZ1810 R6.5").Activate
  Set objSheet = ActiveSheet
  
  strOutput = "********** New Tools EZ1810 R6.0 **********" & vbCrLf
  strOutput = strOutput & "Curr : " & objSheet.Cells(8, 10) & vbCrLf
  strOutput = strOutput & "Total Cost      QTY   Part Name      Part#      Tool Description    Tax Rate  Tax Amount     " & vbCrLf
  
  intLCV = 22
  intRow = 4
  Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
    strRefPartTemp = ""
    For intLCV2 = 1 To Len(objSheet.Cells(intLCV, 3).Value)
      If (Mid(objSheet.Cells(intLCV, 3).Value, intLCV2, 1) <> " ") Then
        strRefPartTemp = strRefPartTemp & Mid(objSheet.Cells(intLCV, 3).Value, intLCV2, 1)
      End If
    Next intLCV2
    If InStr(strRefPartTemp, ",") = 0 Then
      strRefPart = strRefPartTemp
    Else
      strRefPart = Left(strRefPartTemp, InStr(strRefPartTemp, ",") - 1)
    End If
    
    strOutput = strOutput & fncPad(objSheet.Cells(intLCV, 15).Value, 15, "L") & " " & _
                "(" & fncPad(objSheet.Cells(intLCV, 9).Value, 3, "R") & ") " & _
                fncPad(objSheet.Cells(intLCV, 2).Value, 15, "R") & " " & _
                fncPad(strRefPart, 10, "R") & " " & fncPad(objSheet.Cells(intLCV, 6).Value, 20, "R") & _
                fncPad(objSheet.Cells(intLCV, 18).Value, 10, "R") & fncPad(objSheet.Cells(intLCV, 19).Value, 15, "R") & vbCrLf
    intRow = intRow + 1
    intLCV = intLCV + 1
  Loop
      
  obj.SetText strOutput
  obj.PutInClipboard
  
  MsgBox "You can now paste the data into GPS."
  
Exit_subExportGPSNew:
    Exit Sub

Err_subExportGPSNew:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subExportGPSNew" & vbCrLf & "SHEET : modCopyToDetail"
    Resume Exit_subExportGPSNew
End Sub

Sub subExportGPSMD()
On Error GoTo Err_subExportGPSMD

  Dim obj As New DataObject
  Dim objSheet As Object
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intRow As Integer
  Dim strRefPart As String
  Dim strRefPartTemp As String
  Dim strOutput As String
  Dim rngRange As Excel.Range
  
  Worksheets("Modified Delete EZ1810 R6.5").Activate
  Set objSheet = ActiveSheet
  
  strOutput = "********** Modify Delete EZ1810 R5.0 **********" & vbCrLf
  strOutput = strOutput & "Curr : " & objSheet.Cells(8, 10) & vbCrLf
  strOutput = strOutput & "Modified  Total Cost      eSAP Equipment#   Part#      Tool Modification Description    Tax Rate  Tax Amount     " & vbCrLf
  
  intLCV = 22
  intRow = 4
  Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
    strRefPartTemp = ""
    For intLCV2 = 1 To Len(objSheet.Cells(intLCV, 5).Value)
      If (Mid(objSheet.Cells(intLCV, 5).Value, intLCV2, 1) <> " ") Then
        strRefPartTemp = strRefPartTemp & Mid(objSheet.Cells(intLCV, 5).Value, intLCV2, 1)
      End If
    Next intLCV2
    If InStr(strRefPartTemp, ",") = 0 Then
      strRefPart = strRefPartTemp
    Else
      strRefPart = Left(strRefPartTemp, InStr(strRefPartTemp, ",") - 1)
    End If
    
    strOutput = strOutput & fncPad(objSheet.Cells(intLCV, 4).Value, 9, "R") & " " & _
                fncPad(objSheet.Cells(intLCV, 9).Value, 15, "R") & " " & _
                fncPad(objSheet.Cells(intLCV, 2).Value, 17, "R") & " " & _
                fncPad(strRefPart, 10, "R") & " " & _
                fncPad(objSheet.Cells(intLCV, 6).Value, 33, "R") & fncPad(objSheet.Cells(intLCV, 18).Value, 14, "R") & fncPad(objSheet.Cells(intLCV, 15).Value, 15, "R") & vbCrLf
    intRow = intRow + 1
    intLCV = intLCV + 1
  Loop
      
  obj.SetText strOutput
  obj.PutInClipboard
  
  MsgBox "You can now paste the data into GPS."

Exit_subExportGPSMD:
    Exit Sub

Err_subExportGPSMD:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subExportGPSMD" & vbCrLf & "SHEET : modCopyToDetail"
    Resume Exit_subExportGPSMD
End Sub


Attribute VB_Name = "modErrorCheck"
Option Explicit

Function fncHighlight(strCell As String, intError As Integer)
On Error GoTo Err_fncHighlight

    Dim varPattern As Variant
    Dim lngColor As Long
    Dim lngFont As Long
        
    Select Case intError
    Case 0
      lngColor = 16777215
      varPattern = xlNone
      lngFont = 0
    Case 1
      lngColor = 255
      varPattern = xlSolid
      lngFont = -16777216
    End Select
    
    With ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Interior
        .Pattern = varPattern
        .PatternColorIndex = xlAutomatic
        .Color = lngColor
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Font
        .Color = lngFont
        .TintAndShade = 0
    End With

Exit_fncHighlight:
    Exit Function

Err_fncHighlight:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncHighlight" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncHighlight
End Function

Function fncPartNumber(strName As String, strCell As String) As String
On Error GoTo Err_fncPartNumber

  Dim strError As String
  Dim varValue As Variant
  Dim intLCV As Integer
  Dim intCount As Integer
  Dim bolError As Boolean
  Dim bolInNum As Boolean
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value

'# Check to see if the value is Null or Empty
  If IsNull(varValue) Or varValue = "" Then
    fncPartNumber = vbCrLf & "ERROR : " & strName & " is a required field."
    Call fncHighlight(strCell, 1)
  Else
    intCount = 0
    bolError = False
    For intLCV = 1 To Len(varValue)
      Select Case UCase(Mid(varValue, intLCV, 1))
      Case "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"
        intCount = intCount + 1
        bolInNum = True
      Case " ", ","
        If intCount < 4 Then
          If bolInNum Then
            bolError = True
          End If
        Else
          intCount = 0
        End If
        bolInNum = False
      Case Else
        bolError = True
      End Select
    Next intLCV
    If intCount < 4 Then
      bolError = True
    End If
    If bolError Then
      fncPartNumber = vbCrLf & "ERROR : " & strName & " contains illegal characters or a Part Number less than 4 digits."
      Call fncHighlight(strCell, 1)
    Else
      fncPartNumber = ""
      Call fncHighlight(strCell, 0)
    End If
  End If

Exit_fncPartNumber:
    Exit Function

Err_fncPartNumber:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncPartNumber" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncPartNumber
End Function

Function fncCheckLine(intLine As Integer, strCol As String) As Boolean
On Error GoTo Err_fncCheckLine

  Dim rngTemp As Range
  Dim bolBlank As Boolean
  
  bolBlank = True
  
  If ActiveSheet.Cells(intLine, 2).Value <> "END" Then
    For Each rngTemp In Range("B" & intLine & ":" & strCol & intLine)
      If rngTemp.Value <> "" Then
        bolBlank = False
      End If
    Next rngTemp
    fncCheckLine = bolBlank
  Else
    fncCheckLine = True
  End If

Exit_fncCheckLine:
    Exit Function

Err_fncCheckLine:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCheckLine" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncCheckLine
End Function

Function fncDate(strName As String, strCell As String) As String
On Error GoTo Err_fncDate

  Dim strError As String
  Dim varValue As Variant
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value

'# Check to see that a Date has been entered
  If IsNull(varValue) Or varValue = "" Then
    fncDate = vbCrLf & "ERROR : " & strName & " is a required field."
    Call fncHighlight(strCell, 1)
  Else
'# Check to see if the Date is a valid Date
    If Not IsDate(varValue) Then
      fncDate = vbCrLf & "ERROR : " & strName & " must be a valid date."
      Call fncHighlight(strCell, 1)
    Else
'# Check to see if the Date is greater than or equal to Today
      If DateDiff("d", varValue, Now()) > 0 Then
        fncDate = vbCrLf & "ERROR : " & strName & " must be greater than or equal to Current Date."
        Call fncHighlight(strCell, 1)
      Else
        fncDate = ""
        Call fncHighlight(strCell, 0)
      End If
    End If
  End If

Exit_fncDate:
    Exit Function

Err_fncDate:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncDate" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncDate
End Function

Function fncPercent(strName As String, strCell As String) As String
On Error GoTo Err_fncPercent

  Dim strError As String
  Dim bolError As Boolean
  Dim varValue As Variant
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value
  bolError = False

'# Check to see if the value is numeric
  If Not IsNumeric(varValue) Or IsNull(varValue) Or varValue = "" Then
    bolError = True
    strError = "ERROR : " & strName & " needs to be a numeric value."
  Else
'# Check to see if the value is between 0 and 1
    If CDbl(varValue) > 1 Or CDbl(varValue) < 0 Then
      bolError = True
      strError = "ERROR : " & strName & " is not between 0 and 1."
    End If
  End If
  If bolError Then
    fncPercent = vbCrLf & strError
    Call fncHighlight(strCell, 1)
  Else
    fncPercent = ""
    Call fncHighlight(strCell, 0)
  End If

Exit_fncPercent:
    Exit Function

Err_fncPercent:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncPercent" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncPercent
End Function

Function fncNotNull(strName As String, strCell As String) As String
On Error GoTo Err_fncNotNull

  Dim strError As String
  Dim varValue As Variant
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value

'# Check to see if the value is Null or Empty
  If IsNull(varValue) Or varValue = "" Then
    fncNotNull = vbCrLf & "ERROR : " & strName & " is a required field."
    Call fncHighlight(strCell, 1)
  Else
    fncNotNull = ""
    Call fncHighlight(strCell, 0)
  End If

Exit_fncNotNull:
    Exit Function

Err_fncNotNull:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncNotNull" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncNotNull
End Function

Function fncPositiveNumeric(strName As String, strCell As String, Optional intDecimals As Integer = 0, Optional strType As String = "N") As String
On Error GoTo Err_fncPositiveNumeric

  Dim intLCV As Integer
  Dim strError As String
  Dim bolError As Boolean
  Dim varValue As Variant
  Dim varType As Variant
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value
  bolError = False

'# Check to see if the value is numeric
  If Not IsNumeric(varValue) Then
    bolError = True
    strError = "ERROR : " & strName & " needs to be a numeric value."
  Else
'# Check to see if the value is positive
    If CDbl(varValue) <= 0 Then
'# Check to see if the type is MD
      If (strType = "MD") Then
        varType = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), 4).Value
        If Not ((varType = "Decrease") Or (varType = "Delete")) Then
          bolError = True
          strError = "ERROR : " & strName & " is not a positive value."
        End If
      Else
        bolError = True
        strError = "ERROR : " & strName & " is not a positive value."
      End If
    Else
'# Check to see if the value has less than the number of Decimals Allowed
      If InStr(1, CStr(varValue), ".", vbTextCompare) <> 0 And intDecimals < Len(Right(CStr(varValue), Len(CStr(varValue)) - InStr(1, CStr(varValue), ".", vbTextCompare))) Then
        bolError = True
        strError = "ERROR : " & strName & " has more than " & intDecimals & " decimal places."
      End If
    End If
  End If
  If bolError Then
    fncPositiveNumeric = vbCrLf & strError
    Call fncHighlight(strCell, 1)
  Else
    fncPositiveNumeric = ""
    Call fncHighlight(strCell, 0)
  End If
  
Exit_fncPositiveNumeric:
    Exit Function

Err_fncPositiveNumeric:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncPositiveNumeric" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncPositiveNumeric
End Function

Function fncPositiveInteger(strName As String, strCell As String, Optional intLength As Integer = 0, Optional intMax As Integer = 0) As String
On Error GoTo Err_fncPositiveInteger

  Dim intLCV As Integer
  Dim strError As String
  Dim bolError As Boolean
  Dim varValue As Variant
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value
  
  bolError = False

'# Check to see if the value is less than or equal to the specified Length, if provided
  If intLength > 0 Then
    If Len(varValue) > intLength Then
      bolError = True
      strError = "ERROR : " & strName & " has a length greater than " & intLength & " characters."
    End If
  Else
'# Check to see if the value exceeds the maximum, if provided
    If intMax > 0 Then
      If CLng(varValue) > intMax Then
        bolError = True
        strError = "ERROR : " & strName & " has a value greater than " & intMax & "."
      End If
    End If
  End If
  
  If Not bolError Then
'# Check to see if the value is numeric
    If Not IsNumeric(varValue) Then
      bolError = True
      strError = "ERROR : " & strName & " needs to be a numeric value."
    Else
'# Check to see if the value is an Integer
      If InStr(1, CStr(varValue), ".", vbTextCompare) <> 0 Then
        bolError = True
        strError = "ERROR : " & strName & " is not an Integer value."
      Else
'# Check to see if the value is positive
        If CLng(varValue) <= 0 Then
          bolError = True
          strError = "ERROR : " & strName & " is not a positive value."
        Else
'# Check to see if the value is less than or equal to the specified Length, if provided
          If intLength > 0 Then
            If Len(varValue) > intLength Then
              bolError = True
              strError = "ERROR : " & strName & " has a length greater than " & intLength & " characters."
            End If
          Else
'# Check to see if the value exceeds the maximum, if provided
            If intMax > 0 Then
              If CLng(varValue) > intMax Then
                bolError = True
                strError = "ERROR : " & strName & " has a value greater than " & intMax & "."
              End If
            End If
          End If
        End If
      End If
    End If
  End If
  
  If bolError Then
    fncPositiveInteger = vbCrLf & strError
    Call fncHighlight(strCell, 1)
  Else
    fncPositiveInteger = ""
    Call fncHighlight(strCell, 0)
  End If
  
Exit_fncPositiveInteger:
    Exit Function

Err_fncPositiveInteger:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncPositiveInteger" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncPositiveInteger
End Function

Function fncNonNegativeInteger(strName As String, strCell As String, Optional intLength As Integer = 0, Optional intMax As Integer = 0) As String
On Error GoTo Err_fncNonNegativeInteger

  Dim intLCV As Integer
  Dim strError As String
  Dim bolError As Boolean
  Dim varValue As Variant
  
  varValue = ActiveSheet.Cells(CLng(Left(strCell, Len(strCell) - 3)), CLng(Right(strCell, 2))).Value
  
  bolError = False

'# Check to see if the value is numeric
  If Not IsNumeric(varValue) Then
    bolError = True
    strError = "ERROR : " & strName & " needs to be a numeric value."
  Else
'# Check to see if the value is an Integer
    If CLng(varValue) <> CDbl(varValue) Then
      bolError = True
      strError = "ERROR : " & strName & " is not an Integer value."
    Else
'# Check to see if the value is non negative
      If CLng(varValue) < 0 Then
        bolError = True
        strError = "ERROR : " & strName & " is not a positive value."
      Else
'# Check to see if the value is less than or equal to the specified Length, if provided
        If intLength > 0 Then
          If Len(varValue) > intLength Then
            bolError = True
            strError = "ERROR : " & strName & " has a length greater than " & intLength & " characters."
          End If
        Else
'# Check to see if the value exceeds the maximum, if provided
          If intMax > 0 Then
            If CLng(varValue) > intMax Then
              bolError = True
              strError = "ERROR : " & strName & " has a value greater than " & intMax & "."
            End If
          End If
        End If
      End If
    End If
  End If
  If bolError Then
    fncNonNegativeInteger = vbCrLf & strError
    Call fncHighlight(strCell, 1)
  Else
    fncNonNegativeInteger = ""
    Call fncHighlight(strCell, 0)
  End If
  
Exit_fncNonNegativeInteger:
    Exit Function

Err_fncNonNegativeInteger:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncNonNegativeInteger" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncNonNegativeInteger
End Function

Function fncCheckPartial() As String
On Error GoTo Err_fncCheckPartial

  Const CON_MFG_DUNS = "11,03"
  Const CON_SPD = "10,08"
  Const CON_ANN_CAP = "7,10"
  Const CON_DPY = "10,10"
  Const CON_TC = ",05"
  Const CON_TT = ",06"
  Const CON_QOT = ",09"
  Const CON_TOOL_DUNS = ",12"
  
  Dim strError As String
  Dim strCCError As String
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  
  strCCError = ""
  Sheets("New Tools EZ1810 R6.5").Activate
    
  strError = fncPositiveInteger("Manufacturing DUNS", CON_MFG_DUNS, 9)
  strError = strError & fncPositiveInteger("Shifts Per Day", CON_SPD, , 3)
  strError = strError & fncPositiveInteger("Annual Capacity", CON_ANN_CAP)
  strError = strError & fncPositiveInteger("Days / Year", CON_DPY, , 366)
  
  intLCV = 22
  While Not fncCheckLine(intLCV, "M")
' IF SHARED TOOLING = YES, THEN CHECK LCRS
    If (Sheets("EZ1810 Welcome Screen").Cells(6, 13).Value = "Yes") Then
      For intLCV2 = 24 To 34
      If Cells(intLCV, intLCV2).Interior.TintAndShade = 0 Then
        strError = strError & fncNonNegativeInteger("LCR", intLCV & "," & intLCV2)
      End If
      Next intLCV2
    End If
  
    strError = strError & fncNotNull("Tool Category", intLCV & CON_TC)
    strError = strError & fncNotNull("Tool Type", intLCV & CON_TT)
    strError = strError & fncPositiveInteger("Quantity of Tools", intLCV & CON_QOT)
    strError = strError & fncPositiveInteger("Tool Location DUNS", intLCV & CON_TOOL_DUNS, 9)
    intLCV = intLCV + 1
  Wend
  strError = strError & strCCError
  fncCheckPartial = strError

Exit_fncCheckPartial:
    Exit Function

Err_fncCheckPartial:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCheckPartial" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncCheckPartial
End Function

Function fncCheckNew() As String
On Error GoTo Err_fncCheckNew

  Const CON_PROGRAM = "12,10"
  Const CON_MFG_DUNS = "11,03"
  Const CON_TYPE = "09,10"
  Const CON_EWO = "09,11"
  Const CON_SPD = "10,08"
  Const CON_ANN_CAP = "07,10"
  Const CON_LW = "07,11"
  Const CON_DPY = "10,10"
  Const CON_CURR = "08,10"
  Const CON_PPAP = "11,10"
  Const CON_PN = ",02"
  Const CON_PART_NUM = ",03"
  Const CON_TC = ",05"
  Const CON_TT = ",06"
  Const CON_TCT = ",07"
  Const CON_PPC = ",08"
  Const CON_QOT = ",09"
  Const CON_CTM = ",10"
  Const CON_TLC = ",11"
  Const CON_TOOL_DUNS = ",12"
  Const CON_GMML = ",13"
  Const CON_TTC = ",15"
  Const CON_DUTY = ",16"
  Const CON_PPT = ",17"
  Const CON_TAX = ",18"
  Const CON_TAX_REC = ",21"
  
  Dim strError As String
  Dim strCCError As String
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  
  strCCError = ""
  Sheets("New Tools EZ1810 R6.5").Activate
    
  strError = fncPositiveInteger("Manufacturing DUNS", CON_MFG_DUNS, 9)
  strError = strError & fncPositiveInteger("Shifts Per Day", CON_SPD, , 3)
  strError = strError & fncPositiveInteger("Annual Capacity", CON_ANN_CAP)
  strError = strError & fncPositiveInteger("Lead Weeks", CON_LW)
  strError = strError & fncPositiveInteger("Days / Year", CON_DPY, , 366)
  strError = strError & fncNotNull("Currency", CON_CURR)
  strError = strError & fncNotNull("Type", CON_TYPE)
  If ActiveSheet.Cells(9, 10).Value = "EWO" Then
    strError = strError & fncNotNull("EWO", CON_EWO)
  End If
  If ActiveSheet.Cells(9, 10).Value = "Sourcing" Then
    strError = strError & fncNotNull("RFQ Number", CON_EWO)
  End If
  If ActiveSheet.Cells(9, 10).Value = "TKO" Then
    strError = strError & fncNotNull("P Release Number", CON_EWO)
  End If
  strError = strError & fncNotNull("Program / Model Year / Part Description", CON_PROGRAM)
  strError = strError & fncDate("PPAP Date", CON_PPAP)
  
  intLCV = 22
  While Not fncCheckLine(intLCV, "M")
' IF SHARED TOOLING = YES, THEN CHECK LCRS
    If (Sheets("EZ1810 Welcome Screen").Cells(6, 13).Value = "Yes") Then
      For intLCV2 = 27 To 37
      If Cells(intLCV, intLCV2).Interior.TintAndShade = 0 Then
        strError = strError & fncNonNegativeInteger("LCR", intLCV & "," & intLCV2)
      End If
      Next intLCV2
    End If
  
    strError = strError & fncNotNull("Part Name", intLCV & CON_PN)
    strError = strError & fncPartNumber("Part Number", intLCV & CON_PART_NUM)
    strError = strError & fncNotNull("Tool Category", intLCV & CON_TC)
    strError = strError & fncNotNull("Tool Type", intLCV & CON_TT)
    strError = strError & fncPositiveNumeric("Tool Cycle Time", intLCV & CON_TCT)
    strError = strError & fncPositiveInteger("Pieces Per Cycle", intLCV & CON_PPC)
    strError = strError & fncPositiveInteger("Quantity of Tools", intLCV & CON_QOT)
    strError = strError & fncNotNull("Country of Tool Manufacturer", intLCV & CON_CTM)
    strError = strError & fncNotNull("Tool Location Country", intLCV & CON_TLC)
    strError = strError & fncPositiveInteger("Tool Location DUNS", intLCV & CON_TOOL_DUNS, 9)
    strError = strError & fncNotNull("Country of GM Manufacturing Location", intLCV & CON_GMML)
    strError = strError & fncPositiveNumeric("Total Tool Cost", intLCV & CON_TTC, 2, "MD")
    strError = strError & fncPercent("Customs Duties", intLCV & CON_DUTY)
    strError = strError & fncNotNull("Progress Payment Type", intLCV & CON_PPT)
    strError = strError & fncPercent("Transactional Tax Rate", intLCV & CON_TAX)
    strError = strError & fncNotNull("Transactional Tax Rate Recoverable", intLCV & CON_TAX_REC)
    intLCV = intLCV + 1
  Wend
  strError = strError & strCCError
  fncCheckNew = strError

Exit_fncCheckNew:
    Exit Function

Err_fncCheckNew:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCheckNew" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncCheckNew
End Function

Function fncCheckMD() As String
On Error GoTo Err_fncCheckMD

  Const CON_PROGRAM = "12,10"
  Const CON_MFG_DUNS = "11,03"
  Const CON_SPD = "10,08"
  Const CON_ANN_CAP = "7,10"
  Const CON_LW = "7,11"
  Const CON_DPY = "10,10"
  Const CON_CURR = "8,10"
  Const CON_EWO = "9,10"
  Const CON_PPAP = "11,10"
  Const CON_EN = ",02"
  Const CON_MD = ",04"
  Const CON_PPAP_PART = ",05"
  Const CON_DOT = ",06"
  Const CON_BST = ",07"
  Const CON_LOT = ",08"
  Const CON_TOOL_COST = ",09"
  Const CON_PRIOR_TOOL_COST = ",10"
  Const CON_CMP = ",11"
  Const CON_GMML = ",12"
  Const CON_TAX = ",14"

  Dim strError As String
  Dim strCCError As String
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  
  Sheets("Modified Delete EZ1810 R6.5").Activate
  strError = fncPositiveInteger("Manufacturing DUNS", CON_MFG_DUNS, 9)
  strError = strError & fncPositiveInteger("Shifts Per Day", CON_SPD, , 3)
  strError = strError & fncPositiveInteger("Annual Capacity", CON_ANN_CAP)
  strError = strError & fncPositiveInteger("Lead Weeks", CON_LW)
  strError = strError & fncPositiveInteger("Days / Year", CON_DPY, , 366)
  strError = strError & fncNotNull("Currency", CON_CURR)
  strError = strError & fncNotNull("Program / Model Year / Part Description", CON_PROGRAM)
  strError = strError & fncNotNull("EWO", CON_EWO)
  strError = strError & fncDate("PPAP Date", CON_PPAP)
  
  intLCV = 22
  While Not fncCheckLine(intLCV, "K")
  ' IF SHARED TOOLING = YES, THEN CHECK LCRS
    If (Sheets("EZ1810 Welcome Screen").Cells(6, 13).Value = "Yes") Then
      For intLCV2 = 21 To 13
      If Cells(intLCV, intLCV2).Interior.TintAndShade = 0 Then
        strError = strError & fncNonNegativeInteger("LCR", intLCV & "," & intLCV2)
      End If
      Next intLCV2
    End If

    strError = strError & fncPositiveInteger("eSAP Equipment Number", intLCV & CON_EN, 10)
    strError = strError & fncNotNull("Modify / Delete", intLCV & CON_MD)
    strError = strError & fncPartNumber("New PPAP Part", intLCV & CON_PPAP_PART)
    strError = strError & fncNotNull("Description of Tool", intLCV & CON_DOT)
    strError = strError & fncNotNull("Build Status of Tool", intLCV & CON_BST)
    strError = strError & fncNotNull("Current Location of Tool", intLCV & CON_LOT)
    strError = strError & fncPositiveNumeric("Total Tool Cost", intLCV & CON_TOOL_COST, 2, "MD")
    strError = strError & fncPositiveNumeric("Prior Tool Cost", intLCV & CON_PRIOR_TOOL_COST, 2, "MD")
    strError = strError & fncNotNull("Country Modification Performed", intLCV & CON_CMP)
    strError = strError & fncNotNull("Country of GM Manufacturing Location", intLCV & CON_GMML)
    strError = strError & fncPercent("Transactional Tax Rate", intLCV & CON_TAX)
    intLCV = intLCV + 1
  Wend
  strError = strError & strCCError
  fncCheckMD = strError

Exit_fncCheckMD:
    Exit Function

Err_fncCheckMD:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCheckMD" & vbCrLf & "SHEET : modErrorCheck"
    Resume Exit_fncCheckMD
End Function
Attribute VB_Name = "modExportMD"
Option Explicit
Global strCompanyCode As String
Global strCompanyCodes() As String

Function fncCreateColumnHeaders(ByVal objSheet As Object)
On Error GoTo Err_fncCreateColumnHeaders

  With objSheet
    .Columns("A:AK").ColumnWidth = 15
    .Range("A1").Value = "Document Type (M)"
    .Range("B1").Value = "Vendor DUNS (M)"
    .Range("C1").Value = "Purch Organization"
    .Range("D1").Value = "Purch Group (M)"
    .Range("E1").Value = "Company Code (M)"
    .Range("F1").Value = "Validity Start Date"
    .Range("G1").Value = "Validity End Date(M)"
    .Range("H1").Value = "Reference Part Number (M)"
    .Range("I1").Value = "Purchase Type (M)"
    .Range("J1").Value = "Request Type (M)"
    .Range("K1").Value = "Tooling capacity (qty/day)"
    .Range("L1").Value = "Tooling capacity (Hrs/day)"
    .Range("M1").Value = "Equipment Number (M)"
    .Range("N1").Value = "Progress Payment"
    .Range("O1").Value = "Approver Email ID (M)"
    .Range("P1").Value = "Payment Terms"
    .Range("Q1").Value = "Currency (M)"
    .Range("R1").Value = "Delivery Date"
    .Range("S1").Value = "Account Assignment Category (M)"
    .Range("T1").Value = "PO Quantity (M)"
    .Range("U1").Value = "Unit Price (M)"
    .Range("V1").Value = "Per (M)"
    .Range("W1").Value = "Item Category"
    .Range("X1").Value = "Plant (M)"
    .Range("Y1").Value = "G/L Account"
    .Range("Z1").Value = "Cost Center"
    .Range("AA1").Value = "Internal Order Number"
    .Range("AB1").Value = "WBS Element Number"
    .Range("AC1").Value = "Service Text (M)"
    .Range("AD1").Value = "Tax Usage Indicator"
    .Range("AE1").Value = "EWO Number (M)"
    .Range("AF1").Value = "PO Number (Output)"
    .Range("AG1").Value = "ZEWO PO Result (Output)"
  End With

Exit_fncCreateColumnHeaders:
    Exit Function

Err_fncCreateColumnHeaders:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCreateColumnHeaders" & vbCrLf & "SHEET : modExportMD"
    Resume Exit_fncCreateColumnHeaders
End Function

Sub subModifiedDelete()
On Error GoTo Err_subModifiedDelete

  Dim strPurGroup As String
  Dim strError As String
  Dim bolCancel As Boolean
    
  strError = fncCheckMD
  If strError = "" Then
    bolCancel = False
    strPurGroup = InputBox("Please enter a value for Purchasing Group", "Purchasing Group")
    While Len(strPurGroup) <> 3 And Not bolCancel
      If Len(strPurGroup) = 0 Then
        bolCancel = True
      Else
        MsgBox "The Purchasing Group cannot be Blank and must be exactly three (3) characters.", vbCritical + vbOKOnly, "ERROR"
        strPurGroup = InputBox("Please enter a value for Purchasing Group", "Purchasing Group")
      End If
    Wend
    
    If Not bolCancel Then
      Select Case Sheets("EZ1810 Welcome Screen").Cells(6, 13).Value
      Case "Yes"
        fncModifiedDeleteST (strPurGroup)
      Case "No"
        fncModifiedDeleteNoST (strPurGroup)
      End Select
    End If
  Else
    MsgBox strError, vbCritical + vbOKOnly, "ERROR"
  End If

Exit_subModifiedDelete:
    Exit Sub

Err_subModifiedDelete:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subModifiedDelete" & vbCrLf & "SHEET : modExportMD"
    Resume Exit_subModifiedDelete
End Sub

Function fncModifiedDeleteNoST(strPurGroup As String)
On Error GoTo Err_fncModifiedDeleteNoST

'# CONSTANTS
  Const constDocType = "ZEWO"
  Const constPurchOrg = "GDIR"
  Const constPurchType = "Regular Purchase"
  Const constReqType = "Tool Modification"
  Const constAAC = "Y"
  Const constPer = "1"
  
  Dim strPPAP As String
  Dim strValidityStart As String
  Dim strValidityEnd As String
  Dim strDUNS As String
  Dim strCurr As String
  Dim strRefPart As String
  Dim strRefPartTemp As String
  Dim objWorkbook As Workbook
  Dim objSheet As Object
  Dim objWorking As Object
  Dim intCount As Integer
  Dim intSheet As Integer
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intLCV3 As Integer
  Dim intNewLCV As Integer
  Dim intToolCap As Double
  Dim intToolCapHPD As Integer
  Dim strPP As String
  Dim strPath As String
  Dim strID As String
  
  gblCancel = 0
  With frmModifyDelete
    .StartUpPosition = 0
    .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
    .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
    .Show
  End With

  If gblCancel <> -1 Then
    Worksheets("Modified Delete EZ1810 R6.5").Activate
    Set objSheet = ActiveSheet
    Set objWorking = Worksheets("Working")
   
    Call fncCountCompanyCodes(objSheet, CC_MD, 0)
    intCount = objWorking.Cells(1, 1).Value
    ReDim objNewWorkbook(intCount) As Workbook
    ReDim objNewSheet(intCount) As Object
    
    strValidityStart = Format(Now(), "YYYYMMDD")
    strValidityEnd = Format(DateAdd("YYYY", 3, Now()), "YYYYMMDD")
    strDUNS = objSheet.Range("C11").Value2
    strCurr = objSheet.Range("J8").Value
    intToolCap = WorksheetFunction.RoundDown(objSheet.Range("J7").Value / objSheet.Range("J10").Value, 0)
    intToolCapHPD = 8 * objSheet.Range("H10").Value
    strPPAP = Format(objSheet.Range("J11").Value, "YYYYMMDD")
    
    Set objWorkbook = ActiveWorkbook
    For intLCV2 = 1 To intCount
      Set objNewWorkbook(intLCV2) = Workbooks.Add
      Set objNewSheet(intLCV2) = objNewWorkbook(intLCV2).ActiveSheet
      Call fncCreateColumnHeaders(objNewSheet(intLCV2))
    Next intLCV2
    
    intLCV = 22
    
    Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
      Select Case objSheet.Cells(intLCV, 9)
      Case Is < 0
        strPP = "NEG"
      Case Else
        strPP = "POS"
      End Select
      
      strRefPartTemp = ""
      For intLCV3 = 1 To Len(objSheet.Cells(intLCV, 5).Value)
        If (Mid(objSheet.Cells(intLCV, 5).Value, intLCV3, 1) <> " ") Then
          strRefPartTemp = strRefPartTemp & Mid(objSheet.Cells(intLCV, 5).Value, intLCV3, 1)
        End If
      Next intLCV3
      
      If InStr(strRefPartTemp, ",") = 0 Then
        strRefPart = strRefPartTemp
      Else
        strRefPart = Left(strRefPartTemp, InStr(strRefPartTemp, ",") - 1)
      End If
      
      For intLCV2 = 1 To intCount
        If objWorking.Cells(intLCV2 + 1, 1).Value = objSheet.Cells(intLCV, 13).Value2 & strPP Then
          intSheet = intLCV2
          intNewLCV = objWorking.Cells(intLCV2 + 1, 3).Value
          objWorking.Cells(intLCV2 + 1, 3).Value = objWorking.Cells(intLCV2 + 1, 3).Value + 1
        End If
      Next intLCV2
      
      objNewSheet(intSheet).Cells(intNewLCV, 1).Value = constDocType
      objNewSheet(intSheet).Cells(intNewLCV, 2).Value = strDUNS
      objNewSheet(intSheet).Cells(intNewLCV, 3).Value = constPurchOrg
      objNewSheet(intSheet).Cells(intNewLCV, 4).Value = strPurGroup & "'"
      objNewSheet(intSheet).Cells(intNewLCV, 5).Value = objSheet.Cells(intLCV, 13).Value2 & "'"
      objNewSheet(intSheet).Cells(intNewLCV, 6).Value = strValidityStart
      objNewSheet(intSheet).Cells(intNewLCV, 7).Value = strValidityEnd
      objNewSheet(intSheet).Cells(intNewLCV, 8).Value = strRefPart
      objNewSheet(intSheet).Cells(intNewLCV, 9).Value = constPurchType
      objNewSheet(intSheet).Cells(intNewLCV, 10).Value = constReqType
      objNewSheet(intSheet).Cells(intNewLCV, 11).Value = intToolCap
      objNewSheet(intSheet).Cells(intNewLCV, 12).Value = intToolCapHPD
      objNewSheet(intSheet).Cells(intNewLCV, 13).Value = objSheet.Cells(intLCV, 2).Value
      objNewSheet(intSheet).Cells(intNewLCV, 17).Value = strCurr
      objNewSheet(intSheet).Cells(intNewLCV, 18).Value = strPPAP
      objNewSheet(intSheet).Cells(intNewLCV, 19).Value = constAAC
      objNewSheet(intSheet).Cells(intNewLCV, 20).Value = "1"
      objNewSheet(intSheet).Cells(intNewLCV, 21).Value = objSheet.Cells(intLCV, 9).Value
      objNewSheet(intSheet).Cells(intNewLCV, 22).Value = constPer
      objNewSheet(intSheet).Cells(intNewLCV, 23).Value = "D"
      objNewSheet(intSheet).Cells(intNewLCV, 24).Value = fncDeterminePlant(objSheet.Cells(intLCV, 13).Value2)
      objNewSheet(intSheet).Cells(intNewLCV, 25).Value = gblGL
      objNewSheet(intSheet).Cells(intNewLCV, 28).Value = gblWBS
      objNewSheet(intSheet).Cells(intNewLCV, 29).Value = objSheet.Cells(intLCV, 6).Value
      objNewSheet(intSheet).Cells(intNewLCV, 31).Value = objSheet.Cells(9, 10).Value
      intLCV = intLCV + 1
    Loop

    strID = Environ("Username")
    strPath = "C:\Users\" & strID & "\Desktop\" & Left(objWorkbook.Name, Len(objWorkbook.Name) - 5)
    
    For intLCV = 1 To intCount
      If InStr(1, objWorking.Cells(intLCV + 1, 1).Value, "NEG", vbTextCompare) = 0 Then
        objNewWorkbook(intLCV).SaveAs Filename:=strPath & "-MD-" & objWorking.Cells(intLCV + 1, 1).Value & ".csv", FileFormat:=xlCSVMSDOS, CreateBackup:=False
        objNewWorkbook(intLCV).Close False
      Else
        objNewWorkbook(intLCV).Close False
      End If
    Next intLCV
  
    If intCount > 1 Then
      MsgBox "NOTICE : " & intCount & " CSV Files were generated due to multiple Comapny Codes on the SMART 1810.  Please refer to Column H on the Output CSV File to identify the Company Code.  NOTE : Negative Value line items are excluded from output.", vbInformation + vbOKOnly, "NOTICE"
    End If
  End If
  
Exit_fncModifiedDeleteNoST:
    Exit Function

Err_fncModifiedDeleteNoST:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncModifiedDeleteNoST" & vbCrLf & "SHEET : modExportMD"
    Resume Exit_fncModifiedDeleteNoST
End Function

Function fncModifiedDeleteST(strPurGroup As String)
On Error GoTo Err_fncModifiedDeleteST

'# CONSTANTS
  Const constDocType = "ZEWO"
  Const constPurchOrg = "GDIR"
  Const constPurchType = "Regular Purchase"
  Const constReqType = "Tool Modification"
  Const constAAC = "Y"
  Const constPer = "1"
  
  Dim strPPAP As String
  Dim strValidityStart As String
  Dim strValidityEnd As String
  Dim strDUNS As String
  Dim strCurr As String
  Dim strRefPart As String
  Dim strRefPartTemp As String
  Dim strCC As String
  Dim objWorkbook As Workbook
  Dim objSheet As Object
  Dim objWorking As Object
  Dim intCount As Integer
  Dim intSheet As Integer
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intLCV3 As Integer
  Dim intLCV4 As Integer
  Dim intNewLCV As Integer
  Dim intToolCap As Double
  Dim intToolCapHPD As Integer
  Dim strPP As String
  Dim strPath As String
  Dim strID As String
  
  gblCancel = 0
  With frmModifyDelete
    .StartUpPosition = 0
    .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)
    .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)
    .Show
  End With


  If gblCancel <> -1 Then
    Worksheets("Modified Delete EZ1810 R6.5").Activate
    Set objSheet = ActiveSheet
    Set objWorking = Worksheets("Working")
   
    Call fncCountCompanyCodes(objSheet, CC_MD, 0)
    intCount = objWorking.Cells(1, 1).Value
    ReDim objNewWorkbook(intCount) As Workbook
    ReDim objNewSheet(intCount) As Object
    
    strValidityStart = Format(Now(), "YYYYMMDD")
    strValidityEnd = Format(DateAdd("YYYY", 3, Now()), "YYYYMMDD")
    strDUNS = objSheet.Range("C11").Value2
    strCurr = objSheet.Range("J8").Value
    intToolCap = WorksheetFunction.RoundDown(objSheet.Range("J7").Value / objSheet.Range("J10").Value, 0)
    intToolCapHPD = 8 * objSheet.Range("H10").Value
    strPPAP = Format(objSheet.Range("J11").Value, "YYYYMMDD")
    
    Set objWorkbook = ActiveWorkbook
    For intLCV2 = 1 To intCount
      Set objNewWorkbook(intLCV2) = Workbooks.Add
      Set objNewSheet(intLCV2) = objNewWorkbook(intLCV2).ActiveSheet
      Call fncCreateColumnHeaders(objNewSheet(intLCV2))
    Next intLCV2
    
    intLCV = 22
    
    objSheet.Activate
    objSheet.Calculate
    
    Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
      Select Case objSheet.Cells(intLCV, 9)
      Case Is < 0
        strPP = "NEG"
      Case Else
        strPP = "POS"
      End Select
      
      strRefPartTemp = ""
      For intLCV3 = 1 To Len(objSheet.Cells(intLCV, 5).Value)
        If (Mid(objSheet.Cells(intLCV, 5).Value, intLCV3, 1) <> " ") Then
          strRefPartTemp = strRefPartTemp & Mid(objSheet.Cells(intLCV, 5).Value, intLCV3, 1)
        End If
      Next intLCV3
      If InStr(strRefPartTemp, ",") = 0 Then
        strRefPart = strRefPartTemp
      Else
        strRefPart = Left(strRefPartTemp, InStr(strRefPartTemp, ",") - 1)
      End If
      
      For intLCV4 = 59 To 65
        If objSheet.Cells(intLCV, intLCV4).Value <> 0 Then
          Select Case intLCV4
          Case 59
            strCC = "5K20"
          Case 61
            strCC = "2C70"
          Case 62
            strCC = "1000"
          Case 63
            strCC = "7090"
          Case 64
            strCC = "3000"
          Case 65
            strCC = "4C00"
          End Select
          For intLCV2 = 1 To intCount
            If objWorking.Cells(intLCV2 + 1, 1).Value = strCC & strPP Then
              intSheet = intLCV2
              intNewLCV = objWorking.Cells(intLCV2 + 1, 3).Value
              objWorking.Cells(intLCV2 + 1, 3).Value = objWorking.Cells(intLCV2 + 1, 3).Value + 1
            End If
          Next intLCV2
          objNewSheet(intSheet).Cells(intNewLCV, 1).Value = constDocType
          objNewSheet(intSheet).Cells(intNewLCV, 2).Value = strDUNS
          objNewSheet(intSheet).Cells(intNewLCV, 3).Value = constPurchOrg
          objNewSheet(intSheet).Cells(intNewLCV, 4).Value = strPurGroup & "'"
          objNewSheet(intSheet).Cells(intNewLCV, 5).Value = strCC
          objNewSheet(intSheet).Cells(intNewLCV, 6).Value = strValidityStart
          objNewSheet(intSheet).Cells(intNewLCV, 7).Value = strValidityEnd
          objNewSheet(intSheet).Cells(intNewLCV, 8).Value = strRefPart
          objNewSheet(intSheet).Cells(intNewLCV, 9).Value = constPurchType
          objNewSheet(intSheet).Cells(intNewLCV, 10).Value = constReqType
          objNewSheet(intSheet).Cells(intNewLCV, 11).Value = intToolCap
          objNewSheet(intSheet).Cells(intNewLCV, 12).Value = intToolCapHPD
          objNewSheet(intSheet).Cells(intNewLCV, 13).Value = objSheet.Cells(intLCV, 2).Value
          objNewSheet(intSheet).Cells(intNewLCV, 17).Value = strCurr
          objNewSheet(intSheet).Cells(intNewLCV, 18).Value = strPPAP
          objNewSheet(intSheet).Cells(intNewLCV, 19).Value = constAAC
          objNewSheet(intSheet).Cells(intNewLCV, 20).Value = "1"
          objNewSheet(intSheet).Cells(intNewLCV, 21).Value = Format(objSheet.Cells(intLCV, intLCV4).Value, "0.00")
          objNewSheet(intSheet).Cells(intNewLCV, 22).Value = constPer
          objNewSheet(intSheet).Cells(intNewLCV, 23).Value = "D"
          objNewSheet(intSheet).Cells(intNewLCV, 24).Value = fncDeterminePlant(strCC)
          objNewSheet(intSheet).Cells(intNewLCV, 25).Value = gblGL
          objNewSheet(intSheet).Cells(intNewLCV, 28).Value = gblWBS
          objNewSheet(intSheet).Cells(intNewLCV, 29).Value = objSheet.Cells(intLCV, 6).Value
          objNewSheet(intSheet).Cells(intNewLCV, 31).Value = objSheet.Cells(9, 10).Value
        End If
      Next intLCV4
      intLCV = intLCV + 1
    Loop

    strID = Environ("Username")
    strPath = "C:\Users\" & strID & "\Desktop\" & Left(objWorkbook.Name, Len(objWorkbook.Name) - 5)
    
    For intLCV = 1 To intCount
      If InStr(1, objWorking.Cells(intLCV + 1, 1).Value, "NEG", vbTextCompare) = 0 Then
        objNewWorkbook(intLCV).SaveAs Filename:=strPath & "-MD-" & objWorking.Cells(intLCV + 1, 1).Value & ".csv", FileFormat:=xlCSVMSDOS, CreateBackup:=False
        objNewWorkbook(intLCV).Close False
      Else
        objNewWorkbook(intLCV).Close False
      End If
    Next intLCV
  
    If intCount > 1 Then
      MsgBox "NOTICE : " & intCount & " CSV Files were generated due to multiple Comapny Codes on the SMART 1810.  Please refer to Column H on the Output CSV File to identify the Company Code.  NOTE : Negative Value line items are excluded from output.", vbInformation + vbOKOnly, "NOTICE"
    End If
  End If
  
Exit_fncModifiedDeleteST:
    Exit Function

Err_fncModifiedDeleteST:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncModifiedDeleteST" & vbCrLf & "SHEET : modExportMD"
    Resume Exit_fncModifiedDeleteST
End Function
Attribute VB_Name = "modExportNew"
Option Explicit
Global strCompanyCode As String
Global strCompanyCodes() As String

Function fncCreateColumnHeaders(ByVal objSheet As Object)
On Error GoTo Err_fncCreateColumnHeaders

  With objSheet
    .Columns("A:AK").ColumnWidth = 15
    .Range("A1").Value = "Tool Material Number"
    .Range("B1").Value = "Tool Description (M)"
    .Range("C1").Value = "Tool Category (M)"
    .Range("D1").Value = "Document Type (M)"
    .Range("E1").Value = "Vendor DUNS (M)"
    .Range("F1").Value = "Purch Organization"
    .Range("G1").Value = "Purch Group (M)"
    .Range("H1").Value = "Company Code (M)"
    .Range("I1").Value = "Validity Start"
    .Range("J1").Value = "Validity End (M)"
    .Range("K1").Value = "Reference Part Number (M)"
    .Range("L1").Value = "Purchase Type (M)"
    .Range("M1").Value = "Request Type (M)"
    .Range("N1").Value = "Parent Equipment Number (M)"
    .Range("O1").Value = "Progress Payment"
    .Range("P1").Value = "Payment Terms"
    .Range("Q1").Value = "Currency (M)"
    .Range("R1").Value = "Estimated Delivery Date"
    .Range("S1").Value = "Tooling capacity (qty/day)"
    .Range("T1").Value = "Tooling capacity (Hrs/day)"
    .Range("U1").Value = "Tier 2 Vendor"
    .Range("V1").Value = "Account Assignment Category (M)"
    .Range("W1").Value = "Target Quantity (M)"
    .Range("X1").Value = "Unit Price (M)"
    .Range("Y1").Value = "Per (M)"
    .Range("Z1").Value = "Item Category"
    .Range("AA1").Value = "Plant (M for Material Master)"
    .Range("AB1").Value = "G/L Account"
    .Range("AC1").Value = "Cost Center"
    .Range("AD1").Value = "Internal Order Number"
    .Range("AE1").Value = "WBS Element Number"
    .Range("AF1").Value = "Service Text"
    .Range("AG1").Value = "Tax Usage Indicator"
    .Range("AH1").Value = "Contract Number (Output)"
    .Range("AI1").Value = "Contract Item (Output)"
    .Range("AJ1").Value = "Material Result (Output)"
    .Range("AK1").Value = "Contract Result (Output)"
  End With

Exit_fncCreateColumnHeaders:
    Exit Function

Err_fncCreateColumnHeaders:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCreateColumnHeaders" & vbCrLf & "SHEET : modExportNew"
    Resume Exit_fncCreateColumnHeaders
End Function

Sub subPartialNewTool()
On Error GoTo Err_subPartialNewTool

'# User wants to create a CSV for the purpose of creating eSAP Equipment IDs ONLY, no Contract
'# or POs will be generated, so certain liberties can be taken, specifically omitting certain
'# fields on the CSV.

'# Per Michael Garbarz, these are the only required fields :
'#   Tool Description (M)
'#   Tool Category (M)
'#   Vendor DUNS (M)
'#   Tooling capacity (qty/day)
'#   Tooling capacity (Hrs/day)
'#   Tier 2 Vendor
'#   Target Quantity (M)
'#   Per (M)
'#   Plant (M for Material Master)

'# CONSTANTS
  Const constPer = "1"
  Const constPlant = "USNA"
  
  Dim strDUNS As String
  Dim objWorkbook As Workbook
  Dim objNewWorkbook As Workbook
  Dim objNewSheet As Object
  Dim objSheet As Object
  Dim intCount As Integer
  Dim intSheet As Integer
  Dim intLCV As Integer
  Dim intToolCap As Double
  Dim intToolCapHPD As Integer
  Dim strError As String
  Dim strID As String
  Dim strPath As String
  
'# CHECK FOR ERRORS
  strError = fncCheckPartial
  
  If strError = "" Then
    Worksheets("New Tools EZ1810 R6.5").Activate
    
    Set objSheet = ActiveSheet
    
    strDUNS = objSheet.Range("C11").Value2
    intToolCap = WorksheetFunction.RoundDown(objSheet.Range("J7").Value / objSheet.Range("J10").Value, 0)
    intToolCapHPD = 8 * objSheet.Range("H10").Value
        
    Set objWorkbook = ActiveWorkbook
    Set objNewWorkbook = Workbooks.Add
    Set objNewSheet = objNewWorkbook.ActiveSheet
    Call fncCreateColumnHeaders(objNewSheet)
    
    intLCV = 22
    
    Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
      objNewSheet.Cells(intLCV - 20, 2).Value = objSheet.Cells(intLCV, 6).Value
      objNewSheet.Cells(intLCV - 20, 3).Value = objSheet.Cells(intLCV, 5).Value
      objNewSheet.Cells(intLCV - 20, 5).Value = strDUNS
      objNewSheet.Cells(intLCV - 20, 19).Value = intToolCap
      objNewSheet.Cells(intLCV - 20, 20).Value = intToolCapHPD
      objNewSheet.Cells(intLCV - 20, 21).Value = objSheet.Cells(intLCV, 12).Value
      objNewSheet.Cells(intLCV - 20, 23).Value = objSheet.Cells(intLCV, 9).Value
      objNewSheet.Cells(intLCV - 20, 25).Value = constPer
      objNewSheet.Cells(intLCV - 20, 27).Value = constPlant
      intLCV = intLCV + 1
    Loop

    strID = Environ("Username")
    strPath = "C:\Users\" & strID & "\Desktop\" & Left(objWorkbook.Name, Len(objWorkbook.Name) - 5)
    objNewWorkbook.SaveAs Filename:=strPath & "-PARTIAL.csv", FileFormat:=xlCSVMSDOS, CreateBackup:=False
    objNewWorkbook.Close False
  Else
    MsgBox strError, vbCritical + vbOKOnly, "ERROR"
  End If

Exit_subPartialNewTool:
    Exit Sub

Err_subPartialNewTool:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subPartialNewTool" & vbCrLf & "SHEET : modExportNew"
    Resume Exit_subPartialNewTool
End Sub

Sub subNewTool()
On Error GoTo Err_subNewTool

  Dim strPurGroup As String
  Dim strError As String
  Dim bolCancel As Boolean
    
  strError = fncCheckNew
  If strError = "" Then
    bolCancel = False
    strPurGroup = InputBox("Please enter a value for Purchasing Group", "Purchasing Group")
    While Len(strPurGroup) <> 3 And Not bolCancel
      If Len(strPurGroup) = 0 Then
        bolCancel = True
      Else
        MsgBox "The Purchasing Group cannot be Blank and must be exactly three (3) characters.", vbCritical + vbOKOnly, "ERROR"
        strPurGroup = InputBox("Please enter a value for Purchasing Group", "Purchasing Group")
      End If
    Wend
    
    If Not bolCancel Then
      Select Case Sheets("EZ1810 Welcome Screen").Cells(6, 13).Value
      Case "Yes"
        fncNewToolST (strPurGroup)
      Case "No"
        fncNewToolNoST (strPurGroup)
      End Select
    End If
  Else
    MsgBox strError, vbCritical + vbOKOnly, "ERROR"
  End If
  
Exit_subNewTool:
    Exit Sub

Err_subNewTool:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subNewTool" & vbCrLf & "SHEET : modExportNew"
    Resume Exit_subNewTool
End Sub

Function fncNewToolNoST(strPurGroup As String)
On Error GoTo Err_fncNewToolNoST

'# CONSTANTS
  Const constDocType = "ZVTC"
  Const constPurchOrg = "GDIR"
  Const constPurchType = "Regular Purchase"
  Const constReqType = "Initial Tool"
  Const constAAC = "U"
  Const constPer = "1"
  
  Dim strPPAP As String
  Dim strValidityStart As String
  Dim strValidityEnd As String
  Dim strDUNS As String
  Dim strCurr As String
  Dim strRefPart As String
  Dim strRefPartTemp As String
  Dim objWorkbook As Workbook
  Dim objSheet As Object
  Dim objWorking As Object
  Dim intCount As Integer
  Dim intSheet As Integer
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intLCV3 As Integer
  Dim intNewLCV As Integer
  Dim intToolCap As Double
  Dim intToolCapHPD As Integer
  Dim strPP As String
  Dim strPath As String
  Dim strID As String

    Worksheets("New Tools EZ1810 R6.5").Activate
    Set objSheet = ActiveSheet
    Set objWorking = Worksheets("Working")
  
    Call fncCountCompanyCodes(objSheet, CC_NT, PP_NT)
    intCount = objWorking.Cells(1, 1).Value
    ReDim objNewWorkbook(intCount) As Workbook
    ReDim objNewSheet(intCount) As Object
    
    strValidityStart = Format(Now(), "YYYYMMDD")
    strValidityEnd = Format(DateAdd("YYYY", 3, Now()), "YYYYMMDD")
    strDUNS = objSheet.Range("C11").Value2
    strCurr = objSheet.Range("J8").Value
    intToolCap = WorksheetFunction.RoundDown(objSheet.Range("J7").Value / objSheet.Range("J10").Value, 0)
    intToolCapHPD = 8 * objSheet.Range("H10").Value
    strPPAP = Format(objSheet.Range("J11").Value, "YYYYMMDD")
    
    Set objWorkbook = ActiveWorkbook
    For intLCV2 = 1 To intCount
      Set objNewWorkbook(intLCV2) = Workbooks.Add
      Set objNewSheet(intLCV2) = objNewWorkbook(intLCV2).ActiveSheet
      Call fncCreateColumnHeaders(objNewSheet(intLCV2))
    Next intLCV2
    
    intLCV = 22
    
    Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
      Select Case UCase(Left(objSheet.Cells(intLCV, 17), 4))
      Case "NONE"
        strPP = "NO PP"
      Case "PULL", "M1 M", "CAPI"
        strPP = "PP"
      End Select
      
      strRefPartTemp = ""
      For intLCV3 = 1 To Len(objSheet.Cells(intLCV, 3).Value)
        If (Mid(objSheet.Cells(intLCV, 3).Value, intLCV3, 1) <> " ") Then
          strRefPartTemp = strRefPartTemp & Mid(objSheet.Cells(intLCV, 3).Value, intLCV3, 1)
        End If
      Next intLCV3
      If InStr(strRefPartTemp, ",") = 0 Then
        strRefPart = strRefPartTemp
      Else
        strRefPart = Left(strRefPartTemp, InStr(strRefPartTemp, ",") - 1)
      End If
      
      For intLCV2 = 1 To intCount
        If objWorking.Cells(intLCV2 + 1, 1).Value = objSheet.Cells(intLCV, 14).Value2 & strPP Then
          intSheet = intLCV2
          intNewLCV = objWorking.Cells(intLCV2 + 1, 3).Value
          objWorking.Cells(intLCV2 + 1, 3).Value = objWorking.Cells(intLCV2 + 1, 3).Value + 1
        End If
      Next intLCV2
      objNewSheet(intSheet).Cells(intNewLCV, 1).Value = objSheet.Cells(intLCV, 4).Value
      objNewSheet(intSheet).Cells(intNewLCV, 2).Value = objSheet.Cells(intLCV, 6).Value
      objNewSheet(intSheet).Cells(intNewLCV, 3).Value = objSheet.Cells(intLCV, 5).Value
      objNewSheet(intSheet).Cells(intNewLCV, 4).Value = constDocType
      objNewSheet(intSheet).Cells(intNewLCV, 5).Value = strDUNS
      objNewSheet(intSheet).Cells(intNewLCV, 6).Value = constPurchOrg
      objNewSheet(intSheet).Cells(intNewLCV, 7).Value = strPurGroup & "'"
      objNewSheet(intSheet).Cells(intNewLCV, 8).Value = objSheet.Cells(intLCV, 14).Value2 & "'"
      objNewSheet(intSheet).Cells(intNewLCV, 9).Value = strValidityStart
      objNewSheet(intSheet).Cells(intNewLCV, 10).Value = strValidityEnd
      objNewSheet(intSheet).Cells(intNewLCV, 11).Value = strRefPart
      objNewSheet(intSheet).Cells(intNewLCV, 12).Value = constPurchType
      objNewSheet(intSheet).Cells(intNewLCV, 13).Value = constReqType
      If strPP <> "NO PP" Then
        objNewSheet(intSheet).Cells(intNewLCV, 15).Value = "X"
      End If
      objNewSheet(intSheet).Cells(intNewLCV, 17).Value = strCurr
      objNewSheet(intSheet).Cells(intNewLCV, 18).Value = strPPAP
      objNewSheet(intSheet).Cells(intNewLCV, 19).Value = intToolCap
      objNewSheet(intSheet).Cells(intNewLCV, 20).Value = intToolCapHPD
      objNewSheet(intSheet).Cells(intNewLCV, 21).Value = objSheet.Cells(intLCV, 12).Value
      objNewSheet(intSheet).Cells(intNewLCV, 22).Value = constAAC
      objNewSheet(intSheet).Cells(intNewLCV, 23).Value = objSheet.Cells(intLCV, 9).Value
      objNewSheet(intSheet).Cells(intNewLCV, 24).Value = Format(objSheet.Cells(intLCV, 15).Value / objSheet.Cells(intLCV, 9).Value, "0.00")
      objNewSheet(intSheet).Cells(intNewLCV, 25).Value = constPer
      objNewSheet(intSheet).Cells(intNewLCV, 27).Value = fncDeterminePlant(objSheet.Cells(intLCV, 14).Value2)
      intLCV = intLCV + 1
    Loop

    strID = Environ("Username")
    strPath = "C:\Users\" & strID & "\Desktop\" & Left(objWorkbook.Name, Len(objWorkbook.Name) - 5)
    
    For intLCV = 1 To intCount
      objNewWorkbook(intLCV).SaveAs Filename:=strPath & "-NEW-" & objWorking.Cells(intLCV + 1, 1).Value & ".csv", FileFormat:=xlCSVMSDOS, CreateBackup:=False
      objNewWorkbook(intLCV).Close False
    Next intLCV
  
    If intCount > 1 Then
      MsgBox "NOTICE : " & intCount & " CSV Files were generated due to multiple Comapny Codes and/or Progress Payment Types on the SMART 1810.  " & _
             "Please refer to Columns H and O on the Output CSV File to identify the Company Code.", vbInformation + vbOKOnly, "NOTICE"
    End If

Exit_fncNewToolNoST:
    Exit Function

Err_fncNewToolNoST:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncNewToolNoST" & vbCrLf & "SHEET : modExportNew"
    Resume Exit_fncNewToolNoST
End Function

Function fncNewToolST(strPurGroup As String)
On Error GoTo Err_fncNewToolST

'# CONSTANTS
  Const constDocType = "ZVTC"
  Const constPurchOrg = "GDIR"
  Const constPurchType = "Regular Purchase"
  Const constReqType = "Initial Tool"
  Const constAAC = "U"
  Const constPer = "1"
  
  Dim strPPAP As String
  Dim strValidityStart As String
  Dim strValidityEnd As String
  Dim strDUNS As String
  Dim strCurr As String
  Dim strRefPart As String
  Dim strRefPartTemp As String
  Dim strCC As String
  Dim objWorkbook As Workbook
  Dim objSheet As Object
  Dim objWorking As Object
  Dim intCount As Integer
  Dim intSheet As Integer
  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intLCV3 As Integer
  Dim intLCV4 As Integer
  Dim intNewLCV As Integer
  Dim intToolCap As Double
  Dim intToolCapHPD As Integer
  Dim strPP As String
  Dim strPath As String
  Dim strID As String

    Worksheets("New Tools EZ1810 R6.5").Activate
    Set objSheet = ActiveSheet
    Set objWorking = Worksheets("Working")
  
    Call fncCountCompanyCodes(objSheet, CC_NT, PP_NT)
    intCount = objWorking.Cells(1, 1).Value
    ReDim objNewWorkbook(intCount) As Workbook
    ReDim objNewSheet(intCount) As Object
    
    strValidityStart = Format(Now(), "YYYYMMDD")
    strValidityEnd = Format(DateAdd("YYYY", 3, Now()), "YYYYMMDD")
    strDUNS = objSheet.Range("C11").Value2
    strCurr = objSheet.Range("J8").Value
    intToolCap = WorksheetFunction.RoundDown(objSheet.Range("J7").Value / objSheet.Range("J10").Value, 0)
    intToolCapHPD = 8 * objSheet.Range("H10").Value
    strPPAP = Format(objSheet.Range("J11").Value, "YYYYMMDD")
    
    Set objWorkbook = ActiveWorkbook
    For intLCV2 = 1 To intCount
      Set objNewWorkbook(intLCV2) = Workbooks.Add
      Set objNewSheet(intLCV2) = objNewWorkbook(intLCV2).ActiveSheet
      Call fncCreateColumnHeaders(objNewSheet(intLCV2))
    Next intLCV2
    
    intLCV = 22
    
    objSheet.Activate
    objSheet.Calculate
    
    Do While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
      Select Case UCase(Left(objSheet.Cells(intLCV, 17), 4))
      Case "NONE"
        strPP = "NO PP"
      Case "PULL", "M1 M", "CAPI"
        strPP = "PP"
      End Select
      
      strRefPartTemp = ""
      For intLCV3 = 1 To Len(objSheet.Cells(intLCV, 3).Value)
        If (Mid(objSheet.Cells(intLCV, 3).Value, intLCV3, 1) <> " ") Then
          strRefPartTemp = strRefPartTemp & Mid(objSheet.Cells(intLCV, 3).Value, intLCV3, 1)
        End If
      Next intLCV3
      If InStr(strRefPartTemp, ",") = 0 Then
        strRefPart = strRefPartTemp
      Else
        strRefPart = Left(strRefPartTemp, InStr(strRefPartTemp, ",") - 1)
      End If
      
      For intLCV4 = 63 To 69
        If objSheet.Cells(intLCV, intLCV4).Value <> 0 Then
          Select Case intLCV4
          Case 63
            strCC = "5K20"
          Case 65
            strCC = "2C70"
          Case 66
            strCC = "1000"
          Case 67
            strCC = "7090"
          Case 68
            strCC = "3000"
          Case 69
            strCC = "4C00"
          End Select
          
          For intLCV2 = 1 To intCount
            If objWorking.Cells(intLCV2 + 1, 1).Value = strCC & strPP Then
              intSheet = intLCV2
              intNewLCV = objWorking.Cells(intLCV2 + 1, 3).Value
              objWorking.Cells(intLCV2 + 1, 3).Value = objWorking.Cells(intLCV2 + 1, 3).Value + 1
            End If
          Next intLCV2
          objNewSheet(intSheet).Cells(intNewLCV, 1).Value = objSheet.Cells(intLCV, 4).Value
          objNewSheet(intSheet).Cells(intNewLCV, 2).Value = objSheet.Cells(intLCV, 6).Value
          objNewSheet(intSheet).Cells(intNewLCV, 3).Value = objSheet.Cells(intLCV, 5).Value
          objNewSheet(intSheet).Cells(intNewLCV, 4).Value = constDocType
          objNewSheet(intSheet).Cells(intNewLCV, 5).Value = strDUNS
          objNewSheet(intSheet).Cells(intNewLCV, 6).Value = constPurchOrg
          objNewSheet(intSheet).Cells(intNewLCV, 7).Value = strPurGroup & "'"
          objNewSheet(intSheet).Cells(intNewLCV, 8).Value = strCC & "'"
          objNewSheet(intSheet).Cells(intNewLCV, 9).Value = strValidityStart
          objNewSheet(intSheet).Cells(intNewLCV, 10).Value = strValidityEnd
          objNewSheet(intSheet).Cells(intNewLCV, 11).Value = strRefPart
          objNewSheet(intSheet).Cells(intNewLCV, 12).Value = constPurchType
          objNewSheet(intSheet).Cells(intNewLCV, 13).Value = constReqType
          If strPP <> "NO PP" Then
            objNewSheet(intSheet).Cells(intNewLCV, 15).Value = "X"
          End If
          objNewSheet(intSheet).Cells(intNewLCV, 17).Value = strCurr
          objNewSheet(intSheet).Cells(intNewLCV, 18).Value = strPPAP
          objNewSheet(intSheet).Cells(intNewLCV, 19).Value = intToolCap
          objNewSheet(intSheet).Cells(intNewLCV, 20).Value = intToolCapHPD
          objNewSheet(intSheet).Cells(intNewLCV, 21).Value = objSheet.Cells(intLCV, 12).Value 'value used to be strDUNS, should have been Tier 2 DUNS
          objNewSheet(intSheet).Cells(intNewLCV, 22).Value = constAAC
          objNewSheet(intSheet).Cells(intNewLCV, 23).Value = objSheet.Cells(intLCV, 9).Value
          objNewSheet(intSheet).Cells(intNewLCV, 24).Value = Format(objSheet.Cells(intLCV, intLCV4).Value / objSheet.Cells(intLCV, 9).Value, "0.00")
          objNewSheet(intSheet).Cells(intNewLCV, 25).Value = constPer
          objNewSheet(intSheet).Cells(intNewLCV, 27).Value = fncDeterminePlant(strCC)
        End If
      Next intLCV4
      intLCV = intLCV + 1
    Loop
    
    strID = Environ("Username")
    strPath = "C:\Users\" & strID & "\Desktop\" & Left(objWorkbook.Name, Len(objWorkbook.Name) - 5)
    
    For intLCV = 1 To intCount
      objNewWorkbook(intLCV).SaveAs Filename:=strPath & "-NEW-" & objWorking.Cells(intLCV + 1, 1).Value & ".csv", FileFormat:=xlCSVMSDOS, CreateBackup:=False
      objNewWorkbook(intLCV).Close False
    Next intLCV
  
    If intCount > 1 Then
      MsgBox "NOTICE : " & intCount & " CSV Files were generated due to multiple Comapny Codes and/or Progress Payment Types on the SMART 1810.  Please refer to Columns H and O on the Output CSV File to identify the Company Code.", vbInformation + vbOKOnly, "NOTICE"
    End If

Exit_fncNewToolST:
    Exit Function

Err_fncNewToolST:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncNewToolST" & vbCrLf & "SHEET : modExportNew"
    Stop
    Resume Exit_fncNewToolST
End Function
Attribute VB_Name = "modGlobal"
Option Explicit

Global Const CC_MD = 13
Global Const CC_NT = 14
Global Const PP_NT = 17

Global gblRow, gblCol, gblDataStart, gblDataEnd, gblDataColumn As Integer
Global gblSheet As String
Global gblTitle, gblCaption As String
Global gblWBS, gblGL As String
Global gblCancel As Integer
Global Const gblPassword = "volt16"
Attribute VB_Name = "modSupport"
Option Explicit

Public Function fncCalc(intSheet As Integer, strTLC As String, strGMML As String, strCC As String, lngCol As Long, lngRow As Long, rngRange As Range, bolMD As Boolean) As Double
'On Error GoTo Err_fncCalc
  
  Const badcol = "1, 2, 4, 5, 6, 7, 8, 9, 11"
  Dim iterator As Variant
  Dim counter As Long
  Dim GMK_CKD As String ' values in this column should always be 0, but decision was made not to remove this variable 1/24/2018
  Dim GM_KOREA As String 'renamed from GMK_NON_CKD since this column has been repurposed in Q1 2018 for Korea project
  Dim GME As String
  Dim GMI As String
  Dim GMLAAM As String
  Dim GMNA_US As String
  Dim GMNA_MEX As String
  Dim GMNA_CAN As String
  Dim GMTH As String
  Dim SGM As String
  Dim TOOLCO_US As String
  Dim TOTAL As String
  
  If bolMD Then
    GMK_CKD = "AT"
    GM_KOREA = "AU"
    GME = "AV"
    GMI = "AW"
    GMLAAM = "AX"
    GMNA_US = "AY"
    GMNA_MEX = "AZ"
    GMNA_CAN = "BA"
    GMTH = "BB"
    SGM = "BC"
    TOOLCO_US = "BD"
    TOTAL = "BE"
  Else
    GMK_CKD = "AX"
    GM_KOREA = "AY"
    GME = "AZ"
    GMI = "BA"
    GMLAAM = "BB"
    GMNA_US = "BC"
    GMNA_MEX = "BD"
    GMNA_CAN = "BE"
    GMTH = "BF"
    SGM = "BG"
    TOOLCO_US = "BH"
    TOTAL = "BI"
  End If
  
  Application.Volatile True
  Const strEurope = "Austria, Belgium, Bulgaria, Croatia, Czech Republic, Denmark, Finland, France, Germany, Greece, Hungary, Ireland, Italy, Netherlands, Norway, Poland, Portugal Romania, Slovak Republic, Slovenia, Spain, Sweden, Switzerland, UK"
  Dim intLCV As Integer
  Dim lngTot As Double
  Dim intCount As Integer
If intSheet = 4 Then
  If lngCol = 61 Then
      If lngRow = 22 Then
      '    Stop
      End If
  End If
End If
  If (strTLC = "Canada" And strGMML = "Multiple") Then
    If (strCC = "3000") Then

' SCENARIO 1
'   This will generate 1 CSV for CC3000
      fncCalc = Sheets(intSheet).Range(TOTAL & lngRow).Value - Sheets(intSheet).Range(SGM & lngRow).Value - Sheets(intSheet).Range(GME & lngRow).Value
    End If
  Else
    If (strTLC = "Mexico" And strGMML = "Multiple") Then

' SCENARIO 2
'   This will generate up to 4 CSVs for CC1000,7090,3000, 4C00 also Grey out Toolco US LCR
      Select Case strCC
      Case "1000" ' Add in GMI and GMTH and GMLAAM (If any of these individual values are > 30% then indicate it somehow
' = GMNA US + GMI + GMTH + GM LAAM
        fncCalc = Sheets(intSheet).Range(GMNA_US & lngRow).Value + Sheets(intSheet).Range(GMI & lngRow).Value + Sheets(intSheet).Range(GMTH & lngRow).Value + Sheets(intSheet).Range(GMLAAM & lngRow).Value
      Case "7090"
' = GMNA MEX
        fncCalc = Sheets(intSheet).Range(GMNA_MEX & lngRow).Value
      Case "3000"
' = GMNA CAN
        fncCalc = Sheets(intSheet).Range(GMNA_CAN & lngRow).Value
      Case "4C00"
' = GMK
        fncCalc = Sheets(intSheet).Range(GM_KOREA & lngRow).Value
        'Change to have GMK 4C00 calculate 1_22_2018 Gary Bellia
      End Select
    Else
      If InStr(1, strEurope, strTLC, vbTextCompare) = 0 And InStr(1, "Mexico, Canada", strGMML, vbTextCompare) = 0 And strGMML = "Multiple" Then
      'All three of these : 1) Tool Location/Country of Modification is NOT EUROPE, 2) Mfg location is NOT MEXICO OR CANADA, and 3) Mfg Loc. = Multiple

' SCENARIO 3
'   MODIFIED BY ADRIANA 02172016
        lngTot = 0
        intCount = 0
        For intLCV = 1 To rngRange.Columns.Count
            If InStr(1, badcol, intLCV) > 0 And rngRange.Cells(1, intLCV) <> 0 Then
                counter = counter + 1
            End If
        Next intLCV
        
        For intLCV = 1 To rngRange.Columns.Count
          If intLCV <> 10 Then
            If IsNumeric(rngRange.Cells(1, intLCV)) Then
                If strCC <> "2C70" And strCC <> "1000" And strCC <> "7090" And strCC <> "3000" Then
                    lngTot = lngTot + CDbl(rngRange.Cells(1, intLCV))
                  
                ElseIf strCC = "7090" And counter = 1 And rngRange(1, 7) <> 0 Then
                    fncCalc = rngRange(1, 7)
                    Exit Function
                ElseIf strCC = "3000" And counter = 1 And rngRange(1, 8) <> 0 Then
                    fncCalc = rngRange(1, 8)
                    Exit Function
                Else
                    If counter > 1 Then
                       If intLCV <> 3 And intLCV <> 10 Then
                         lngTot = lngTot + CDbl(rngRange.Cells(1, intLCV))
                       End If
                    Else
                        If strCC = "1000" And counter = 1 And rngRange.Cells(1, 6) <> 0 Then
                            fncCalc = CDbl(rngRange.Cells(1, 6))
                            Exit Function
                        Else
                            fncCalc = 0
                            Exit Function
                        End If
                    End If
                End If
            End If
            If rngRange.Cells(1, intLCV) <> 0 Then
              intCount = intCount + 1
            End If
          End If
        Next intLCV
        If lngTot = CLng(rngRange.Cells(1, 6)) And strCC = "1000" Then
          fncCalc = rngRange.Cells(1, 6)
        Else
          If lngTot = CLng(rngRange.Cells(1, 7)) And strCC = "7090" Then
            fncCalc = rngRange.Cells(1, 7)
          Else
            If lngTot = CLng(rngRange.Cells(1, 8)) And strCC = "3000" Then
              fncCalc = rngRange.Cells(1, 8)
            Else
              If intCount > 1 And strCC = "2C70" Then
                fncCalc = lngTot
              End If
            End If
          End If
        End If
      Else
        If InStr(1, strEurope, strTLC, vbTextCompare) <> 0 And InStr(1, "United States, Mexico, Canada, Multiple", strGMML, vbTextCompare) <> 0 Then
' SCENARIO 4 - This will generate 1 CSV for CCode 02C8
' = GMK CKD + GMK NON CKD + GME + GMNA US + GMNA MEX + GMNA CAN
          If strCC = "5K20" Then 'Updated to 5K20 from 02C8 9/18/2019 XXXXXX
            fncCalc = Sheets(intSheet).Range(GMK_CKD & lngRow).Value + Sheets(intSheet).Range(GM_KOREA & lngRow).Value + Sheets(intSheet).Range(GMNA_US & lngRow).Value + Sheets(intSheet).Range(GMNA_MEX & lngRow).Value + Sheets(intSheet).Range(GMNA_CAN & lngRow).Value
            'fncCalc = Sheets(intSheet).Range(GMK_CKD & lngRow).Value + Sheets(intSheet).Range(GMK_NON_CKD & lngRow).Value + Sheets(intSheet).Range(GME & lngRow).Value + Sheets(intSheet).Range(GMNA_US & lngRow).Value + Sheets(intSheet).Range(GMNA_MEX & lngRow).Value + Sheets(intSheet).Range(GMNA_CAN & lngRow).Value
          End If
        Else
' DEFAULT SCENARIO
          Select Case strCC
          Case "2C70"
            fncCalc = Sheets(intSheet).Range(TOOLCO_US & lngRow).Value
          Case "1000"
            fncCalc = Sheets(intSheet).Range(GMNA_US & lngRow).Value
          Case "7090"
            fncCalc = Sheets(intSheet).Range(GMNA_MEX & lngRow).Value
          Case "3000"
            fncCalc = Sheets(intSheet).Range(GMNA_CAN & lngRow).Value
          Case "4C00"
            fncCalc = Sheets(intSheet).Range(GM_KOREA & lngRow).Value
          End Select
        End If
      End If
    End If
  End If

Exit_fncCalc:
    Exit Function

Err_fncCalc:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCalc" & vbCrLf & "SHEET : modSupport"
    Resume 'Exit_fncCalc
End Function

Function fncAddCompanyCode(strCC, strPP As String, ByRef intCount As Integer)
On Error GoTo Err_fncAddCompanyCode

  Dim bolRepeat As Boolean
  Dim intLCV As Integer
    
  bolRepeat = False
  For intLCV = 2 To intCount + 1
    If Sheets("Working").Cells(intLCV, 1).Value = strCC & strPP Then
      bolRepeat = True
    End If
  Next intLCV
    
  If Not bolRepeat Then
    Sheets("Working").Cells(intCount + 1, 1).Value = strCC & strPP
    Sheets("Working").Cells(intCount + 1, 2).Value = intCount
    Sheets("Working").Cells(intCount + 1, 3).Value = 2
    intCount = intCount + 1
  End If

Exit_fncAddCompanyCode:
    Exit Function

Err_fncAddCompanyCode:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncAddCompanyCode" & vbCrLf & "SHEET : modSupport"
    Resume Exit_fncAddCompanyCode
End Function

Function fncCountCompanyCodes(objSheet As Object, intColCC As Integer, intColPP As Integer)
On Error GoTo Err_fncCountCompanyCodes

  Const CC_5K20 = 63
  Const CC_2C70 = 65
  Const CC_1000 = 66
  Const CC_7090 = 67
  Const CC_3000 = 68
  Const CC_4C00 = 69
  Const CC_MD_OFFSET = -4
  
  Dim intCount As Integer
  Dim intLCV As Integer
  Dim intRow As Integer
  Dim intOffset As Integer
  Dim strPP As String
  Dim strCC As String
  Dim bolST As Boolean
  Dim bolRepeat As Boolean
  
'# Clear existing data
  For intLCV = 1 To 25
    Sheets("Working").Cells(intLCV, 1).Value = ""
    Sheets("Working").Cells(intLCV, 2).Value = ""
  Next intLCV

  intLCV = 22
  intCount = 0
  
  If (Sheets("EZ1810 Welcome Screen").Cells(6, 13).Value = "Yes") Then
    bolST = True
  Else
    bolST = False
  End If
  
  Select Case objSheet.Name
  Case "New Tools EZ1810 R6.5"
    intOffset = 0
  Case "Modified Delete EZ1810 R6.5"
    intOffset = CC_MD_OFFSET
  End Select


  If bolST Then
    intCount = intCount + 1
    While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
' Modified Delete does not use Progressive Payments so instead use this for negative vs positive numbers in the
' total supplier tool cost.
      If intColPP = 0 Then
        Select Case objSheet.Cells(intLCV, 9).Value
        Case Is < 0
          strPP = "NEG"
        Case Else
          strPP = "POS"
        End Select
      Else
        Select Case Left(objSheet.Cells(intLCV, intColPP), 4)
        Case "None"
          strPP = "NO PP"
        Case "Pull", "M1 m", "Capi"
          strPP = "PP"
        End Select
      End If
    
      If objSheet.Cells(intLCV, CC_5K20 + intOffset).Value2 <> 0 Then
        strCC = "5K20"
        fncAddCompanyCode strCC, strPP, intCount
      End If
    
      If objSheet.Cells(intLCV, CC_2C70 + intOffset).Value2 <> 0 Then
        strCC = "2C70"
        fncAddCompanyCode strCC, strPP, intCount
      End If
      
      If objSheet.Cells(intLCV, CC_1000 + intOffset).Value2 <> 0 Then
        strCC = "1000"
        fncAddCompanyCode strCC, strPP, intCount
      End If
        
      If objSheet.Cells(intLCV, CC_7090 + intOffset).Value2 <> 0 Then
        strCC = "7090"
        fncAddCompanyCode strCC, strPP, intCount
      End If
        
      If objSheet.Cells(intLCV, CC_3000 + intOffset).Value2 <> 0 Then
        strCC = "3000"
        fncAddCompanyCode strCC, strPP, intCount
      End If
      
      If objSheet.Cells(intLCV, CC_4C00 + intOffset).Value2 <> 0 Then
        strCC = "4C00"
        fncAddCompanyCode strCC, strPP, intCount
      End If
      
      intLCV = intLCV + 1
    Wend
    Sheets("Working").Cells(1, 1).Value = intCount - 1
  Else
    While (objSheet.Cells(intLCV, 2).Value <> "") And (objSheet.Cells(intLCV, 2).Value <> "END")
      intCount = intCount + 1
      If intColPP = 0 Then
' Modified Delete does not use Progressive Payments so instead use this for negative vs positive numbers in the
' total supplier tool cost.
        Select Case objSheet.Cells(intLCV, 9).Value
          Case Is < 0
            strPP = "NEG"
          Case Else
            strPP = "POS"
        End Select
      Else
        Select Case Left(objSheet.Cells(intLCV, intColPP), 4)
          Case "None"
            strPP = "NO PP"
          Case "Pull", "M1 m", "Capi"
            strPP = "PP"
        End Select
      End If
      bolRepeat = False
      For intRow = 2 To intCount + 1
        If Sheets("Working").Cells(intRow, 1).Value = objSheet.Cells(intLCV, intColCC) & strPP Then
          bolRepeat = True
        End If
      Next intRow
      
      If Not bolRepeat Then
        Sheets("Working").Cells(intCount + 1, 1).Value = objSheet.Cells(intLCV, intColCC) & strPP
        Sheets("Working").Cells(intCount + 1, 2).Value = intCount
        Sheets("Working").Cells(intCount + 1, 3).Value = 2
      Else
        intCount = intCount - 1
      End If
      intLCV = intLCV + 1
    Wend
    Sheets("Working").Cells(1, 1).Value = intCount
  End If
    
Exit_fncCountCompanyCodes:
    Exit Function

Err_fncCountCompanyCodes:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncCountCompanyCodes" & vbCrLf & "SHEET : modSupport"
    Resume Exit_fncCountCompanyCodes
End Function

Sub subPaste()
On Error GoTo Err_subPaste

  Dim objClipboard As New MSForms.DataObject
  Dim varRows As Variant
  Dim intLCV As Integer

  intLCV = 0
  objClipboard.GetFromClipboard
  varRows = objClipboard.GetText
  varRows = Split(varRows, vbCrLf)

  If ActiveCell.Row < 22 Then
    MsgBox "Pasting only allowed in the detail section", vbCritical + vbOKOnly, "ERROR"
  Else
    While ActiveSheet.Cells(ActiveCell.Row + intLCV, 2).Value <> "END" Or intLCV > 100
      intLCV = intLCV + 1
    Wend
    
    If intLCV < UBound(varRows) Then
      MsgBox "Not enough empty rows, please add rows to the 1810", vbCritical + vbOKOnly, "ERROR"
    Else
      ActiveSheet.Paste
    End If
  End If

Exit_subPaste:
    Exit Sub

Err_subPaste:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subPaste" & vbCrLf & "SHEET : modSupport"
    Resume Exit_subPaste
End Sub

Function fncUpdateTotals(strSheet As String, intRow As Integer, strRow As String)
On Error GoTo Err_fncUpdateTotals

  Select Case strSheet
  Case "NT"
    ActiveSheet.Range("O" & intRow).Formula = "=SUM(O22:O" & strRow & ")"
    ActiveSheet.Range("S" & intRow).Formula = "=SUM(S22:S" & strRow & ")"
    ActiveSheet.Range("T" & intRow).Formula = "=SUM(T22:T" & strRow & ")"
    ActiveSheet.Range("V" & intRow).Formula = "=SUM(V22:V" & strRow & ")"
    ActiveSheet.Range("Y" & intRow).Formula = "=SUM(Y22:Y" & strRow & ")"
    ActiveSheet.Range("Z" & intRow).Formula = "=SUM(Z22:Z" & strRow & ")"
    ActiveSheet.Range("AA" & intRow).Formula = "=SUM(AA22:AA" & strRow & ")"
    ActiveSheet.Range("AB" & intRow).Formula = "=SUM(AB22:AB" & strRow & ")"
    ActiveSheet.Range("AC" & intRow).Formula = "=SUM(AC22:AC" & strRow & ")"
    ActiveSheet.Range("AD" & intRow).Formula = "=SUM(AD22:AD" & strRow & ")"
    ActiveSheet.Range("AE" & intRow).Formula = "=SUM(AE22:AE" & strRow & ")"
    ActiveSheet.Range("AF" & intRow).Formula = "=SUM(AF22:AF" & strRow & ")"
    ActiveSheet.Range("AG" & intRow).Formula = "=SUM(AG22:AG" & strRow & ")"
    ActiveSheet.Range("AH" & intRow).Formula = "=SUM(AH22:AH" & strRow & ")"
    ActiveSheet.Range("AI" & intRow).Formula = "=SUM(AI22:AI" & strRow & ")"
    ActiveSheet.Range("AJ" & intRow).Formula = "=SUM(AJ22:AJ" & strRow & ")"
    ActiveSheet.Range("AK" & intRow).Formula = "=SUM(AK22:AK" & strRow & ")"
    ActiveSheet.Range("AL" & intRow).Formula = "=SUM(AL22:AL" & strRow & ")"
    ActiveSheet.Range("AX" & intRow).Formula = "=SUM(AX22:AX" & strRow & ")"
    ActiveSheet.Range("AY" & intRow).Formula = "=SUM(AY22:AY" & strRow & ")"
    ActiveSheet.Range("AZ" & intRow).Formula = "=SUM(AZ22:AZ" & strRow & ")"
    ActiveSheet.Range("BA" & intRow).Formula = "=SUM(BA22:BA" & strRow & ")"
    ActiveSheet.Range("BB" & intRow).Formula = "=SUM(BB22:BB" & strRow & ")"
    ActiveSheet.Range("BC" & intRow).Formula = "=SUM(BC22:BC" & strRow & ")"
    ActiveSheet.Range("BD" & intRow).Formula = "=SUM(BD22:BD" & strRow & ")"
    ActiveSheet.Range("BE" & intRow).Formula = "=SUM(BE22:BE" & strRow & ")"
    ActiveSheet.Range("BF" & intRow).Formula = "=SUM(BF22:BF" & strRow & ")"
    ActiveSheet.Range("BG" & intRow).Formula = "=SUM(BG22:BG" & strRow & ")"
    ActiveSheet.Range("BH" & intRow).Formula = "=SUM(BH22:BH" & strRow & ")"
    ActiveSheet.Range("BI" & intRow).Formula = "=SUM(BI22:BI" & strRow & ")"
    ActiveSheet.Range("BK" & intRow).Formula = "=SUM(BK22:BK" & strRow & ")"
    ActiveSheet.Range("BM" & intRow).Formula = "=SUM(BM22:BM" & strRow & ")"
    ActiveSheet.Range("BN" & intRow).Formula = "=SUM(BN22:BN" & strRow & ")"
    ActiveSheet.Range("BO" & intRow).Formula = "=SUM(BO22:BO" & strRow & ")"
    ActiveSheet.Range("BP" & intRow).Formula = "=SUM(BP22:BP" & strRow & ")"
    ActiveSheet.Range("BQ" & intRow).Formula = "=SUM(BQ22:BQ" & strRow & ")"
    ActiveSheet.Range("BS" & intRow).Formula = "=SUM(BS22:BS" & strRow & ")"
  Case "MD"
    ActiveSheet.Range("I" & intRow).Formula = "=SUM(I22:I" & strRow & ")"
    ActiveSheet.Range("J" & intRow).Formula = "=SUM(J22:J" & strRow & ")"
    ActiveSheet.Range("O" & intRow).Formula = "=SUM(O22:O" & strRow & ")"
    ActiveSheet.Range("P" & intRow).Formula = "=SUM(P22:P" & strRow & ")"
    ActiveSheet.Range("R" & intRow).Formula = "=SUM(R22:R" & strRow & ")"
    ActiveSheet.Range("S" & intRow).Formula = "=SUM(S22:S" & strRow & ")"
    ActiveSheet.Range("T" & intRow).Formula = "=SUM(T22:T" & strRow & ")"
    ActiveSheet.Range("U" & intRow).Formula = "=SUM(U22:U" & strRow & ")"
    ActiveSheet.Range("V" & intRow).Formula = "=SUM(V22:V" & strRow & ")"
    ActiveSheet.Range("W" & intRow).Formula = "=SUM(W22:W" & strRow & ")"
    ActiveSheet.Range("X" & intRow).Formula = "=SUM(X22:X" & strRow & ")"
    ActiveSheet.Range("Y" & intRow).Formula = "=SUM(Y22:Y" & strRow & ")"
    ActiveSheet.Range("Z" & intRow).Formula = "=SUM(Z22:Z" & strRow & ")"
    ActiveSheet.Range("AA" & intRow).Formula = "=SUM(AA22:AA" & strRow & ")"
    ActiveSheet.Range("AB" & intRow).Formula = "=SUM(AB22:AB" & strRow & ")"
    ActiveSheet.Range("AC" & intRow).Formula = "=SUM(AC22:AC" & strRow & ")"
    ActiveSheet.Range("AD" & intRow).Formula = "=SUM(AD22:AD" & strRow & ")"
    ActiveSheet.Range("AE" & intRow).Formula = "=SUM(AE22:AE" & strRow & ")"
    ActiveSheet.Range("AF" & intRow).Formula = "=SUM(AF22:AF" & strRow & ")"
    ActiveSheet.Range("AR" & intRow).Formula = "=SUM(AR22:AR" & strRow & ")"
    ActiveSheet.Range("AS" & intRow).Formula = "=SUM(AS22:AS" & strRow & ")"
    ActiveSheet.Range("AT" & intRow).Formula = "=SUM(AT22:AT" & strRow & ")"
    ActiveSheet.Range("AU" & intRow).Formula = "=SUM(AU22:AU" & strRow & ")"
    ActiveSheet.Range("AV" & intRow).Formula = "=SUM(AV22:AV" & strRow & ")"
    ActiveSheet.Range("AW" & intRow).Formula = "=SUM(AW22:AW" & strRow & ")"
    ActiveSheet.Range("AX" & intRow).Formula = "=SUM(AX22:AX" & strRow & ")"
    ActiveSheet.Range("AY" & intRow).Formula = "=SUM(AY22:AY" & strRow & ")"
    ActiveSheet.Range("AZ" & intRow).Formula = "=SUM(AZ22:AZ" & strRow & ")"
    ActiveSheet.Range("BA" & intRow).Formula = "=SUM(BA22:BA" & strRow & ")"
    ActiveSheet.Range("BB" & intRow).Formula = "=SUM(BB22:BB" & strRow & ")"
    ActiveSheet.Range("BC" & intRow).Formula = "=SUM(BC22:BC" & strRow & ")"
    ActiveSheet.Range("BE" & intRow).Formula = "=SUM(BE22:BE" & strRow & ")"
    ActiveSheet.Range("BG" & intRow).Formula = "=SUM(BG22:BG" & strRow & ")"
    ActiveSheet.Range("BH" & intRow).Formula = "=SUM(BH22:BH" & strRow & ")"
    ActiveSheet.Range("BI" & intRow).Formula = "=SUM(BI22:BI" & strRow & ")"
    ActiveSheet.Range("BJ" & intRow).Formula = "=SUM(BJ22:BJ" & strRow & ")"
    ActiveSheet.Range("BK" & intRow).Formula = "=SUM(BK22:BK" & strRow & ")"
    ActiveSheet.Range("BM" & intRow).Formula = "=SUM(BM22:BM" & strRow & ")"
  End Select

Exit_fncUpdateTotals:
    Exit Function

Err_fncUpdateTotals:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncUpdateTotals" & vbCrLf & "SHEET : modSupport"
    Resume Exit_fncUpdateTotals
End Function

Sub subAddRow()
On Error GoTo Err_subAddRow

  Dim intLCV As Integer
  Dim intLCV2 As Integer
  Dim intRow As Integer
  Dim strRow As String
  Dim bolFull As Boolean
  
  intLCV = 22
  bolFull = False
    
  For intLCV2 = 1 To ActiveSheet.Range("A21").Value
    While (ActiveSheet.Range("B" & intLCV).Value <> "") And Not bolFull
      If ActiveSheet.Range("B" & intLCV).Value = "END" Then
        bolFull = True
        intRow = intLCV - 1
      Else
        intLCV = intLCV + 1
      End If
    Wend
  
    If ActiveSheet.Range("B" & intLCV).Value = "" Then
      intRow = intLCV
    End If

    ActiveSheet.Range(intRow & ":" & intRow).Select
    Selection.Copy
    ActiveSheet.Range(intRow & ":" & intRow).Select
    Selection.Insert Shift:=xlDown
    Select Case ActiveSheet.Range("A2").Value
    Case "New Tools"
      ActiveSheet.Range("B" & intRow + 1 & ":" & "M" & intRow + 1).Select
      Selection.ClearContents
      ActiveSheet.Range("O" & intRow + 1 & ":" & "R" & intRow + 1).Select
      Selection.ClearContents
      ActiveSheet.Range("W" & intRow + 1 & ":" & "AK" & intRow + 1).Select
      Selection.ClearContents
      ActiveSheet.Range("B" & intRow).Select
      intRow = 22
      While (ActiveSheet.Range("B" & intRow).Value <> "END")
        intRow = intRow + 1
      Wend
      strRow = intRow - 1
      fncUpdateTotals "NT", intRow, strRow
    Case "Modified Delete Tools"
      ActiveSheet.Range("B" & intRow + 1 & ":" & "L" & intRow + 1).Select
      Selection.ClearContents
      ActiveSheet.Range("N" & intRow + 1 & ":" & "N" & intRow + 1).Select
      Selection.ClearContents
      ActiveSheet.Range("S" & intRow + 1 & ":" & "AG" & intRow + 1).Select
      Selection.ClearContents
      ActiveSheet.Range("B" & intRow).Select
      intRow = 22
      While (ActiveSheet.Range("B" & intRow).Value <> "END")
        intRow = intRow + 1
      Wend
      strRow = intRow - 1
      fncUpdateTotals "MD", intRow, strRow
    End Select
  Next intLCV2
  
  Select Case ActiveSheet.Range("A2").Value
  Case "New Tools"
    fncUpdateTotals "NT", intRow, strRow
  Case "Modified Delete Tools"
    fncUpdateTotals "MD", intRow, strRow
  End Select
  
Exit_subAddRow:
    Exit Sub

Err_subAddRow:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subAddRow" & vbCrLf & "SHEET : modSupport"
    Resume Exit_subAddRow
End Sub

Sub subDelRow()
On Error GoTo Err_subDelRow

  Dim intLCV As Integer
  Dim intCount As Integer
  Dim bolFull As Boolean
  
  intCount = 0
  intLCV = 22
  bolFull = False
  
  While (ActiveSheet.Range("B" & intLCV).Value <> "END")
    intCount = intCount + 1
    intLCV = intLCV + 1
  Wend
  
  intLCV = 22
  While (ActiveSheet.Range("B" & intLCV).Value <> "") And Not bolFull
    If ActiveSheet.Range("B" & intLCV).Value = "END" Then
      bolFull = True
    Else
      intLCV = intLCV + 1
    End If
  Wend
  
  If Not bolFull Then
    If intCount > 2 Then
      ActiveSheet.Range("B" & intLCV).Select
      ActiveCell.EntireRow.Delete
    Else
      Select Case ActiveSheet.Range("A2").Value
      Case "New Tools"
        ActiveSheet.Range("B" & intLCV & ":" & "M" & intLCV).Select
        Selection.ClearContents
        ActiveSheet.Range("O" & intLCV & ":" & "R" & intLCV).Select
        Selection.ClearContents
        ActiveSheet.Range("W" & intLCV & ":" & "AK" & intLCV).Select
        Selection.ClearContents
        ActiveSheet.Range("B" & intLCV).Select
      Case "Modified Delete Tools"
        ActiveSheet.Range("B" & intLCV & ":" & "L" & intLCV).Select
        Selection.ClearContents
        ActiveSheet.Range("N" & intLCV & ":" & "N" & intLCV).Select
        Selection.ClearContents
        ActiveSheet.Range("Q" & intLCV & ":" & "AE" & intLCV).Select
        Selection.ClearContents
        ActiveSheet.Range("B" & intLCV).Select
      End Select
    End If
  Else
    MsgBox "ERROR : There are no blank records to delete.", vbCritical + vbOKOnly, "ERROR"
  End If
  
Exit_subDelRow:
    Exit Sub

Err_subDelRow:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subDelRow" & vbCrLf & "SHEET : modSupport"
    Resume Exit_subDelRow
End Sub

Public Function fncDeterminePlant(strCC As String) As String
On Error GoTo Err_fncDeterminePlant

  Select Case strCC
  Case "3000"
    fncDeterminePlant = "CA65"
  Case "7090"
    fncDeterminePlant = "MX2A"
  Case "1000"
    fncDeterminePlant = "USNA"
  Case "2C70"
    fncDeterminePlant = "US1J"
  Case "7530"
    fncDeterminePlant = "ARWB"
  Case "4C00"
    fncDeterminePlant = "KR05"
  Case "5K20"
    fncDeterminePlant = "GB07"
  End Select

Exit_fncDeterminePlant:
    Exit Function

Err_fncDeterminePlant:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : fncDeterminePlant" & vbCrLf & "SHEET : modSupport"
    Resume Exit_fncDeterminePlant
End Function
Attribute VB_Name = "modWelcomeScreen"
Option Explicit

Sub subSelection()
On Error GoTo Err_subSelection

  Dim shpOption1 As Shape
  Dim shpOption2 As Shape
  Dim shpOption3 As Shape
  Dim shpOption4 As Shape
  
  Set shpOption1 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 1")
  Set shpOption2 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 2")
  Set shpOption3 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 3")
  Set shpOption4 = Worksheets("EZ1810 Welcome Screen").Shapes("Option Button 4")
  
  ' #NEW TOOLS
  If shpOption1.ControlFormat.Value = xlOn Then
    Worksheets(3).Visible = xlSheetVisible
    Worksheets(4).Visible = xlSheetHidden
    Worksheets("EZ1810 Welcome Screen").Select
    Range("A21").FormulaR1C1 = "SHEET(S) REQUIRED : New Tools EZ1810 R6.5"
    Range("A23").FormulaR1C1 = "The New Tools sheet will be used by the buyer to upload into SAP to create your Purchase Order.  In order for"
    Range("A24").FormulaR1C1 = "the buyer to generate your Purchase Order in a timely manner, please ensure that all required fields are filled in correctly."
    Range("A25").FormulaR1C1 = ""
    Range("A26").FormulaR1C1 = "When you attempt to save the document, the SMART EZ1810 will attempt to do some basic Error Checking and"
    Range("A27").FormulaR1C1 = "give you a visual cue to any fields that may be filled out incorrectly along with some verbiage on what may be incorrect."
    Range("A28").FormulaR1C1 = ""
    Range("A29").FormulaR1C1 = ""
    Range("A30").FormulaR1C1 = ""
    Range("A31").FormulaR1C1 = ""
    Range("K20").FormulaR1C1 = "FULL PROCESS (eSAP) / Regional System Process"
  End If

  ' #MODIFY DELETE
  If shpOption2.ControlFormat.Value = xlOn Then
    Worksheets(3).Visible = xlSheetHidden
    Worksheets(4).Visible = xlSheetVisible
    Worksheets("EZ1810 Welcome Screen").Select
    Range("A21").FormulaR1C1 = "SHEET(S) REQUIRED : Modified Delete EZ1810 R6.5"
    Range("A23").FormulaR1C1 = "The Modify Delete Tools sheet will be used by the buyer to upload into SAP to create your Purchase Order.  In order for the buyer to generate"
    Range("A24").FormulaR1C1 = " your Purchase Order in a timely manner, please ensure that all required fields are filled in correctly."
    Range("A25").FormulaR1C1 = ""
    Range("A26").FormulaR1C1 = "Please utilize your eSAP generated Equipment Numbers to identify which tools need modification/ refurbishment.  If you currently only have"
    Range("A27").FormulaR1C1 = "GQTS Asset IDs, they have been converted to eSAP Equipment Numbers for you and can be found by accessing the SAP Vendor Tooling Portal."
    Range("A28").FormulaR1C1 = ""
    Range("A29").FormulaR1C1 = "When you attempt to save the document, the SMART EZ1810 will attempt to do some basic Error Checking and give you a visual cue to any fields"
    Range("A30").FormulaR1C1 = " that may be filled out incorrectly along with some verbiage on what may be incorrect."
    Range("A31").FormulaR1C1 = ""
    Range("K20").FormulaR1C1 = "EWO PROCESS"
  End If

  ' #NEW TOOLS / MODIFY DELETE
  If shpOption3.ControlFormat.Value = xlOn Then
    Worksheets(3).Visible = xlSheetVisible
    Worksheets(4).Visible = xlSheetVisible
    Worksheets("EZ1810 Welcome Screen").Select
    Range("A21").FormulaR1C1 = "SHEET(S) REQUIRED : New Tools EZ1810 R6.0 / Modified Delete EZ1810 R6.5"
    Range("A23").FormulaR1C1 = "The New Tools sheet will be used by the buyer to upload into SAP to create your Purchase Order.  In order for the buyer to generate"
    Range("A24").FormulaR1C1 = " your Purchase Order in a timely manner, please ensure that all required fields are filled in correctly."
    Range("A25").FormulaR1C1 = ""
    Range("A26").FormulaR1C1 = "The Modify Delete Tools sheet will be used by the buyer to upload into SAP to create a second Purchase Order for the tools being"
    Range("A27").FormulaR1C1 = "modified which already have eSAP Equipment Numbers created and referenced."
    Range("A28").FormulaR1C1 = ""
    Range("A29").FormulaR1C1 = ""
    Range("A30").FormulaR1C1 = ""
    Range("A31").FormulaR1C1 = ""
    Range("K20").FormulaR1C1 = "FULL PROCESS (eSAP) / Regional System Process / EWO PROCESS"
  End If

  ' #NEW TOOLS / MODIFY DELETE
  If shpOption4.ControlFormat.Value = xlOn Then
    Worksheets(3).Visible = xlSheetVisible
    Worksheets(4).Visible = xlSheetVisible
    Worksheets("EZ1810 Welcome Screen").Select
    Range("A21").FormulaR1C1 = "SHEET(S) REQUIRED : New Tools EZ1810 R6.0 / Modified Delete EZ1810 R6.5"
    Range("A23").FormulaR1C1 = "The New Tools sheet will be used by the buyer to upload into eSAP to create new eSAP Equipment Record Numbers."
    Range("A24").FormulaR1C1 = ""
    Range("A25").FormulaR1C1 = "Once the buyer has created the new eSAP Equipment Numbers for your tools, he or she may contact you to ensure"
    Range("A26").FormulaR1C1 = "that they use the correct eSAP Equipment Numbers on the Modified/Delete Tools tab."
    Range("A27").FormulaR1C1 = ""
    Range("A28").FormulaR1C1 = "The modified tab will be used by the buyer to upload into eSAP to create your new Purchase Order. In order for"
    Range("A29").FormulaR1C1 = "the buyer to generate your Purchase Order and Equipment Records in a timely manner, please ensure that all"
    Range("A30").FormulaR1C1 = "required fields are filled out correctly."
    Range("A31").FormulaR1C1 = ""
    Range("K20").FormulaR1C1 = "PARTIAL / EWO PROCESS"
  End If

  Set shpOption1 = Nothing
  Set shpOption2 = Nothing
  Set shpOption3 = Nothing
  Set shpOption4 = Nothing
  
Exit_subSelection:
    Exit Sub

Err_subSelection:
    MsgBox "ERROR : " & Err.Number & " " & Err.Description & vbCrLf & "CODE : subSelection" & vbCrLf & "SHEET : modWelcomeScreen"
    Resume Exit_subSelection
End Sub


INQUEST-PP=macro
Attribute VB_Name = "CheckBox_related_1st"
Sub bublu()

                Dim s As CheckBox
                On Error Resume Next
                For Each s In ActiveSheet.CheckBoxes
                s.delete
                's.OnAction = ""
                Next
End Sub
Sub clear_all_checkbox()

'1
x = 0
Do
x = x + 1
Call bublu
If x = 50 Then Exit Do
Loop

End Sub
Sub selecting_valid_country()

                Dim s As CheckBox
                On Error Resume Next
                For Each s In ActiveSheet.CheckBoxes
                s.delete
                's.OnAction = ""
                Next
                On Error GoTo 0
                Call clear_all_checkbox
If Range("F20").Value = "Thailand" Then
                    x = 26
                    y = "G"
                    Z = "s"
                    o = "T4820m"
                    n = "T4820n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 27
                    y = "G"
                    Z = "s"
                    o = "T4A10m"
                    n = "T4A10n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 28
                    y = "G"
                    Z = "s"
                    o = "T4230m"
                    n = "T4230n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    Else
                    End If

    If Range("F20").Value = "New Zealand" Then
                    x = 29
                    y = "G"
                    Z = "s"
                    o = "n4020m"
                    n = "n4020n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
    Else
    End If

    If Range("F20").Value = "Australia" Then
                    x = 31
                    y = "G"
                    Z = "s"
                    o = "A4501m"
                    n = "A4501n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                        End With
                                        x = 31
                    x = 51
                    y = "G"
                    Z = "s"
                    o = "A4E70m"
                    n = "A4E70n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                        End With

    Else
    End If

    If Range("F20").Value = "Philippines" Then
    
                    x = 34
                    y = "G"
                    Z = "s"
                    o = "P4570m"
                    n = "P4570n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 35
                    y = "G"
                    Z = "s"
                    o = "P4E50m"
                    n = "P4E50n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                                  
    Else
    End If

  If Range("F20").Value = "Singapore" Then
    
                    x = 36
                    y = "G"
                    Z = "s"
                    o = "S4290m"
                    n = "S4290n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 37
                    y = "G"
                    Z = "s"
                    o = "S4E30m"
                    n = "S4E30n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With

                    x = 50
                    y = "G"
                    Z = "s"
                    o = "A4F10m"
                    n = "A4F10n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                        End With


                                  
    Else
    End If
    
     If Range("F20").Value = "Indonesia" Then
    
                    x = 39
                    y = "G"
                    Z = "s"
                    o = "I4250m"
                    n = "I4250n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 40
                    y = "G"
                    Z = "s"
                    o = "I4A80m"
                    n = "I4A80n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                                  
    Else
    End If
    
    If Range("F20").Value = "India" Then
    
                    x = 41
                    y = "G"
                    Z = "s"
                    o = "IGMIm"
                    n = "IGMIn"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 42
                    y = "G"
                    Z = "s"
                    o = "IGMIMm"
                    n = "IGMIMn"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 43
                    y = "G"
                    Z = "s"
                    o = "IGMTPm"
                    n = "IGMTPn"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 44
                    y = "G"
                    Z = "s"
                    o = "I4A40m"
                    n = "I4A40n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With

                                  
    Else
    End If

     If Range("F20").Value = "Utd.Arab Emir." Then
    
                    x = 47
                    y = "G"
                    Z = "s"
                    o = "U2190m"
                    n = "U2190n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 48
                    y = "G"
                    Z = "s"
                    o = "U6500m"
                    n = "U6500n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                                  
    Else
    End If

     If Range("F20").Value = "Vietnam" Then
    
                    x = 49
                    y = "G"
                    Z = "s"
                    o = "V4C10m"
                    n = "V4C10n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With

                                  
    Else
    End If

Range("F20").Select
End Sub

Sub vendorcatogery_and_its_checkboxes()

Call UnPro
Range("A61:A63").EntireRow.Hidden = False
Range("A72:A77").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete

                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

                    xrow = 62
                    ycolumn = "D"
                    Zlinked = "D" & 63
                    oonaction = "vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 62
                    ycolumn = "G"
                    Zlinked = "G" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select

                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
''''                    xrow = 62
''''                    ycolumn = "I"
''''                    Zlinked = "I" & 63
''''                    oonaction = "vendercatogery_multiple_select_control"
''''                    nname = "pv"
''''
''''
''''                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
''''                                                                    Cells(xrow, ycolumn).Top, _
''''                                                                    80, 17).Select
''''                                        With Selection
''''                                            .Caption = ""
''''                                            .Value = xlOff '
''''                                            .LinkedCell = Zlinked
''''                                            .Display3DShading = True
''''                                    '        .lock = False
''''                                            .Name = nname
''''                                            .OnAction = oonaction
''''
''''                                  End With
                    xrow = 62
                    ycolumn = "m"
                    Zlinked = "m" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 62
                    ycolumn = "P"
                    Zlinked = "P" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 62
                    ycolumn = "S"
                    Zlinked = "S" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                                  
          If Range("A76").Value = "Thailand" Or Range("F20").Value = "Indonesia" Then
          Range("F20").EntireRow.Hidden = False
                    xrow = 76
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "SAP_Customer_No" '"purchasing_vendor_ERS_category"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
            Else
            Range("A76").EntireRow.Hidden = True
            End If


Range("F20").Select
End Sub
Sub purchasing_vendor_ERS_category()

Call UnPro

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

If Range("D63").Value = True Then
Range("A63:A65").EntireRow.Hidden = False
'Range("A71:A77").EntireRow.Hidden = False

                    
                    xrow = 64
                    ycolumn = "G"
                    Zlinked = "G" & 65
                    oonaction = "ERS_multiple_select_control"
                    nname = "ERSpv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 64
                    ycolumn = "I"
                    Zlinked = "I" & 65
                    oonaction = "ERS_multiple_select_control"
                    nname = "ERSpv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Else
Range("A63:A65").EntireRow.Hidden = True

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0


End If
Range("F74").Select
End Sub

Sub Supplier_type_inter_non_inter()
Call UnPro
Range("A52:A54").EntireRow.Hidden = False

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("STi").delete
                    ActiveSheet.CheckBoxes("STi").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0


'Range("A71:A77").EntireRow.Hidden = False

                    
                    xrow = 53
                    ycolumn = "E"
                    Zlinked = "E" & 54
                    oonaction = "STi_multiple_select_control"
                    nname = "STi"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 53
                    ycolumn = "H"
                    Zlinked = "H" & 54
                    oonaction = "STi_multiple_select_control"
                    nname = "STi"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Range("F20").Select

End Sub
Sub STi_multiple_select_control()
Call UnPro
Dim iVal As Integer

If Range("F20").Value = "Utd.Arab Emir." And Range("Q18").Value = "New Duns/Vendor Code creation" Then
Range("A69:A71").EntireRow.Hidden = False
Else
Range("A69:A71").EntireRow.Hidden = True
End If

iVal = Application.WorksheetFunction.CountIf(Range("C54:J54"), True)

If iVal > 1 Then
    Range("E54").Value = False
    Range("H54").Value = False
    'Range("I63").Value = False
    'Range("M63").Value = False
    'Range("P63").Value = False
    'Range("S63").Value = False
    MsgBox "You can not select the both types "
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    On Error GoTo 0
Else
End If

If Range("E54").Value = True Then
'Range("A64:A71").EntireRow.Hidden = False
Call vendorcatogery_and_its_checkboxes
Else
Range("A55:A78").EntireRow.Hidden = True
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    On Error GoTo 0

End If

If Range("H54").Value = True Then
Range("A66:A69").EntireRow.Hidden = False
'Call purchasing_vendor_ERS_category
Else
Range("A66:A69").EntireRow.Hidden = True

End If

If Range("F20").Value = "Utd.Arab Emir." And Range("Q18").Value = "New Duns/Vendor Code creation" Then
Range("A69:A71").EntireRow.Hidden = False
Range("F70").Value = ""
Else
Range("A69:A71").EntireRow.Hidden = True
Range("F70").Value = ""
End If

Call Pro
End Sub
Sub vendercatogery_multiple_select_control()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("C63:U63"), True)

If iVal > 1 Then
    
    Range("D63").Value = False
    Range("G63").Value = False
    'Range("I63").Value = False
    Range("M63").Value = False
    Range("P63").Value = False
    Range("S63").Value = False
    MsgBox "One vendor category at a time"

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

Else
End If



If Range("I63").Value = True Then
Range("A64:A71").EntireRow.Hidden = False
Else
Range("A64:A71").EntireRow.Hidden = True
End If


If Range("D63").Value = True Then
If Range("s44").Value = True Then Else Call purchasing_vendor_ERS_category
Else

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
'Range("A64:A71").EntireRow.Hidden = True
End If



Call Pro
End Sub


Sub ERS_multiple_select_control()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("D65:J65"), True)

If iVal > 1 Then
    
    Range("G65").Value = False
    Range("I65").Value = False
    'Range("I63").Value = False
    'Range("M63").Value = False
    'Range("P63").Value = False
    'Range("S63").Value = False
    MsgBox "You can not select the both options"
    
Else
End If

'
'If Range("I63").Value = True Then
'Range("A64:A71").EntireRow.Hidden = False
'Else
'Range("A64:A71").EntireRow.Hidden = True
'End If
Call Pro
End Sub


Sub TDS_configuration_checkboxes()
Range("A78:A106").EntireRow.Hidden = True
Range("A78:A81").EntireRow.Hidden = False

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("tds").delete
                    ActiveSheet.CheckBoxes("tds").delete
                    ActiveSheet.CheckBoxes("tdsrequired").delete
                    
                    On Error GoTo 0
                    xrow = 80
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "Taxconfig_required"
                    nname = "tds"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 80
                    ycolumn = "J"
                    Zlinked = "J" & xrow + 1
                    oonaction = "Taxconfig_required"
                    nname = "tds"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("F81").Locked = False
Range("J81").Locked = False

End Sub

Sub Taxconfig_required()

Call UnPro
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("tdsrequired").delete
                    On Error GoTo 0

If Range("F81").Value = True Then
                    Range("A82:A87").EntireRow.Hidden = False
                    xrow = 87
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "Lower_TDS_set_up_required"
                    nname = "tdsrequired"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Else
Range("A82:A88").EntireRow.Hidden = True
End If



If Range("F81").Locked = True Then MsgBox "TDS in not applicable for Material Suppliers"

ciVal = Application.WorksheetFunction.CountIf(Range("E81:K81"), True)

If ciVal > 1 Then
Range("F81").Value = False
Range("J81").Value = False
MsgBox "Both the options are cannot be selected at a time"
Else
End If

Call Pro
End Sub

Sub Lower_TDS_set_up_required()
Call UnPro
If Range("F88").Value = True Then
Range("A88:A92").EntireRow.Hidden = False
Else
Range("A88:A92").EntireRow.Hidden = True
End If
Call Pro
End Sub

Sub new_creation_supplier()
Call UnPro
Range("A108:A137").EntireRow.Hidden = False

On Error Resume Next
ActiveSheet.CheckBoxes("altpayeeduns").delete
On Error GoTo 0


                    xrow = 136
                    ycolumn = "H"
                    Zlinked = "H" & xrow + 1
                    oonaction = "Alternative_Payee_Duns"
                    nname = "altpayeeduns"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

'Call Pro
End Sub

Sub Alternative_Payee_Duns()
Call UnPro
                    If Range("H137").Value = True Then
                    Range("A139:A164").EntireRow.Hidden = False
                    Else
                    Range("A139:A164").EntireRow.Hidden = True
                    End If
Call Pro
End Sub


Sub banking_information()
Call UnPro

Range("A594:A674").EntireRow.Hidden = False
On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
On Error GoTo 0

Range("A594:A674").EntireRow.Hidden = True

Range("A594:A608").EntireRow.Hidden = False

If Range("F20").Value = "India" Then

Range("O603").Value = "IFSC"
Range("O618").Value = "IFSC"
Range("O632").Value = "IFSC"
Range("O645").Value = "IFSC"
Range("O658").Value = "IFSC"
Range("O671").Value = "IFSC"

Else

Range("O603").Value = "Telephone Number"
Range("O618").Value = "Telephone Number"
Range("O632").Value = "Telephone Number"
Range("O645").Value = "Telephone Number"
Range("O658").Value = "Telephone Number"
Range("O671").Value = "Telephone Number"

End If




'1st bank
                    xrow = 607
                    ycolumn = "G"
                    Zlinked = ycolumn & xrow + 1
                    nname = "adbank"
                    oonaction = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'2nd bank
                    xrow = 607
                    ycolumn = "J"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank2m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'3rd bank
                    xrow = 607
                    ycolumn = "M"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank3m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

'4th bank
                    xrow = 607
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank4m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'5th bank
                    xrow = 607
                    ycolumn = "S"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "additional_bank_required_field"
                    'nname = "adbank5n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Range("F597").Select
'Call Pro
End Sub
Sub eft_cheque_check()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("B524:P524"), True)

If iVal > 1 Then
Range("E524").Value = False
Range("K524").Value = False
MsgBox ("Please select a valid mode of payment")
Else
End If

If Range("E524").Locked = True And Range("K524").Locked = True Then
MsgBox "Please note that supplier payment mode has changed to EFT"
Call Pro
Exit Sub

Else
End If
        'for thailand pickup details.
        If Range("F20").Value = "Thailand" Then
            If Range("K524").Value = True Then
            Range("A475:A478").EntireRow.Hidden = False
            Else
            Range("A475:A478").EntireRow.Hidden = True
            End If
        Else
        Range("A475:A478").EntireRow.Hidden = True
        End If
        
        'for thailand pickup details.
'        If Range("F20").Value = "Thailand" Then
            If Range("E524").Value = True Then
            Call banking_information
            Else
                Range("A594:A674").EntireRow.Hidden = False
                On Error Resume Next
                'ActiveSheet.CheckBoxes("EFTpayment").Delete
                'ActiveSheet.CheckBoxes("Chequepayment").Delete

                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                On Error GoTo 0
                Range("A594:A674").EntireRow.Hidden = True

            End If
'        Else
'        Range("A475:A478").EntireRow.Hidden = True
'        End If

Call Pro
End Sub

Sub additional_bank_required_field()

Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("F608:S608"), True)

If iVal > 1 Then

Range("G608").Value = False
Range("J608").Value = False
Range("M608").Value = False
Range("P608").Value = False
Range("S608").Value = False
MsgBox ("Only 5 additional banks can be added maximum")
Else
End If

Range("A609:A674").EntireRow.Hidden = True

If Range("G608").Value = True Then
Range("A609:A622").EntireRow.Hidden = False
Else
End If

If Range("J608").Value = True Then
Range("A609:A635").EntireRow.Hidden = False
Else
End If

If Range("M608").Value = True Then
Range("A609:A648").EntireRow.Hidden = False
Else
End If

If Range("P608").Value = True Then
Range("A609:A661").EntireRow.Hidden = False
Else
End If

If Range("S608").Value = True Then
Range("A609:A674").EntireRow.Hidden = False
Else
End If
Call Pro
End Sub

Sub payment_term_with_checkbox()
Call UnPro
Range("A222:A230").EntireRow.Hidden = False

'financin section
                    xrow = 225
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "financing_section"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'purchasing section
                    xrow = 225
                    ycolumn = "I"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "purchasing_section"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

        Range("F223").Select
        Call Pro
End Sub

Sub new_creation_supplier_australia_and_newz()

Call UnPro
Range("A398:A423").EntireRow.Hidden = False

                    xrow = 422
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "for_newcreation_of_austrandnew_alternative_payee"
                    nname = "payee_chekbox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("F420").Select
'Call Pro
End Sub

Sub new_creation_supplier_other_region()

Call UnPro
If Range("F20").Value = "Thailand" Or Range("F20").Value = "Philippines" Then
Range("A365:A370").EntireRow.Hidden = False

                    xrow = 366
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "TDS"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    xrow = 366
                    ycolumn = "J"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "TDSno"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Else
Range("A365:A370").EntireRow.Hidden = True
End If

Range("A372:A396").EntireRow.Hidden = False

                    xrow = 395
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "for_newcreation_of_other_countries_alternative_payee"
                    nname = "payee_chekbox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    xrow = 395
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "for_newcreation_of_other_countries_Ship_from_duns"
                    nname = "shipfrom_chekbox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Range("F373").Select

'for thailand no ship from duns is required

    If Range("F20").Value = "Thailand" Then
On Error Resume Next
    ActiveSheet.Shapes.Range(Array("payee_chekbox")).delete

    With Range("H395").Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With
Else
    With Range("H395").Font
        .Color = -10477568
        .TintAndShade = 0
    End With

End If
On Error GoTo 0

'Call Pro
End Sub


Sub EFTCheque()
Call UnPro
Range("A523").EntireRow.Hidden = False
Range("B986").EntireRow.Hidden = True
    



                    xrow = 523 '347
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_cheque_check"
                    nname = "EFTpayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With


                    'xrow = 347
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_cheque_check"
                    nname = "Chequepayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                End With

If Range("F20").Value = "India" Then
Call banking_information
Range("E348").Value = True
Range("K348").Value = False
Range("E348").Locked = True
Range("K348").Locked = True
Else
Range("E348").Value = False
Range("K348").Value = False
Range("E348").Locked = False
Range("K348").Locked = False
End If

'Call Pro
End Sub

Sub Beneinter()
Call UnPro
Range("A591:A593").EntireRow.Hidden = False




                    xrow = 592
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "beninter_check"
                    nname = "Bene"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With


                    xrow = 592
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "beninter_check"
                    nname = "inter"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Call Pro
End Sub

Sub beninter_check()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("E593:K593"), True)

If iVal > 1 Then
Range("E593").Value = False
Range("K593").Value = False
MsgBox ("Please select a valid Bank Account type")
Else
End If

Call Pro
End Sub

Sub clear_gmio_only_header_info()
Call UnPro
Range("F10:L10,Q10:U10,F12:L12,F14:L14,Q12:U12,Q18:U18,F20:L20").ClearContents
Call Pro
End Sub

Sub clear_GMIO_all_fieled_except_header_info()

'On Error Resume Next
Union(Range("F122:J122,F124:J124,F126:J126,F128:N128,F130:U130"), _
Range("F134:U134,F132:J132,M132:U132"), _
Range("F57:L57,F59:U59,E67:F67,L67:M67,F83:J83,F85:J85,M85:Q85,T85:U85,F89:J89,F91:J91,M89:Q89,M91:Q91,T89:U89,S96:U96,K94:O94,K96:O96,E94:H94,E96:H96,E98:H98,E100:H100,E102:H102,E105:H105,K102:O102,K100:O100,K98:O98,F109:L109"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120,F122:J122,F124:J124,O122:U122,O124:U124,O126:U126,F126:J126,F128:U128,F130:U130,F132:J132,M132:U132,F134:U134,F109:L109,F140:L140,F143:U143,F145:U145,F147:U147,F149:J149,F151:J151"), _
Range("M149:U149,M151:U151,F153:J153,F155:J155,M155:U155,M153:U153,F157:U157,F159:U159,F161:J161,M161:U161,F163:U163,F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180,F182:U182,F184:U184"), _
Range("O206:U206,F206:K206,F211:L211,F213:U213,F217:U219,F223:I223,O223:U223,F227:U229,F233:I233,O233:U233,F235:U237,F241:U241,F243:U243,F245:J245"), Range("M245:P245,S245:U245,F247:U247,F249:U251,F255:U255,F257:U257,F259:U261,F265:U265,F267:U267,F269:U269,F271:J271,M271:U271,F273:J273,F275:N275,F277:N277,F279:J279,M279:P279,S279:U279,F281:U281"), Range("F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180"), Range("F182:N182,F184:U184,F186:J186,M186:U186,F188:U188,F192:L192,F194:U194,F198:I198,F200:I200,F202:I202,P200:S200,P202:S202"), _
Range("F369:J369,N369:R369,F373:L373,F375:U375,F377:U377,F379:U379,F381:J381,M381:U381,M383:U383,F383:J383,F385:J385,M385:U385,F387:U387,F389:U389,F391:J391,M391:U391,F393:U393"), _
Range("F399:L399,F402:U402,F404:U404,F406:U406,F408:J408,M408:U408,F410:J410,M410:U410,M412:U412,F412:J412,F414:N414,F416:N416,F418:J418,M418:U418,F420:U420,F425:L425,F428:U428,F430:U430,F432:U432,F434:J434,M434:U434,F436:J436,M436:U436,M438:U438,F438:J438"), _
Range("F440:N440,F442:N442,F444:J444,M444:U444,F446:U446"), _
Range("F452:L452,F454:U454,F456:U456,F458:U458,F460:J460,M460:U460,F462:J462,M462:U462,F464:J464,M464:U464,F466:U466,F468:U468,F470:J470,M470:U470,F472:U472"), _
Range("F477:K477,O477:U477,F481:L481,F483:U483"), _
Range("F499:L499,F502:U502,F504:U504,F506:U506,F508:J508,M508:U508,M510:U510,F510:J510,F512:J512,M512:U512,F514:U514,F516:U516,F518:J518,M518:U518,F520:U520,F525:L525,F527:U527,F529:U529,F531:U531,F533:J533,M533:U533,M535:U535,F535:J535,F537:J537,M537:U537"), _
Range("F539:U539,F541:U541,F543:J543,M543:U543,F545:U545,F548:L548,F550:U550,F552:U552,F554:U554"), _
Range("F556:J556,M556:U556,M558:U558,F558:J558,F560:J560,M560:U560,F562:U562,F564:U564,F566:J566,M566:U566,F568:U568,F571:L571,F573:U573"), _
Range("F575:U575,F577:U577,F579:J579,M579:U579,F581:J581,M581:U581,F583:J583,M583:U583,F585:U585,F587:U587"), _
Range("F589:J589,M589:U589,F595:Q595,F597:Q597,T597:U597,F599:Q599,F601:I601,L601:N601,R601:U601,F603:N603,F605:N605,R603:U603,R605:U605"), _
Range("F610:Q610,F612:Q612,F614:Q614,T612:U612,F616:I616,L616:N616,R616:U616,F618:N618,F620:N620,R618:U618,R620:U620"), _
Range("F624:Q624,F626:Q626,T626:U626,F628:Q628,F630:I630,L630:N630,R630:U630,R632:U632,F632:N632,F634:N634,R634:U634"), _
Range("F637:Q637,F639:Q639,F641:Q641,T639:U639,F643:I643,L643:N643,R643:U643,R645:U645,F645:N645,F647:N647,R647:U647"), _
Range("F650:Q650,F652:Q652,T652:U652,F654:Q654,F656:I656,L656:N656,R656:U656,R658:U658,F658:N658,F660:N660,R660:U660"), _
Range("F663:Q663,F665:Q665,T665:U665,F667:Q667,F669:I669,L669:N669,R669:U669,R671:U671,F671:N671,F673:N673,R673:U673"), _
Range("D988:D992,F995:U997")).ClearContents

'Range("").Select

End Sub

Sub LowerTDSC_Only()

Call UnPro
Range("B86:B92").EntireRow.Hidden = True
Range("B86:B87").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("tdsrequired").delete
                    On Error GoTo 0

If Range("F87").EntireRow.Hidden = False Then
                    If Range("Q18").Value = "With holding Tax configuration" Then Range("B88:B92").EntireRow.Hidden = True
                    If Range("Q18").Value = "Lower TDS configuration" Then Range("B88:B92").EntireRow.Hidden = False
                    xrow = 87
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "Lower_TDS_set_up_required"
                    nname = "tdsrequired"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOn '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    If Range("Q18").Value = "With holding Tax configuration" Then Range("F88").Value = False

Else
Range("B88:B92").EntireRow.Hidden = True
End If
Call Pro
End Sub


Sub inactivat_delete_checkBox()

                    xrow = 980
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "onetic_at_a_time"
                    nname = "inactivat_delete_checkBox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 980
                    ycolumn = "I"
                    Zlinked = "I" & xrow + 1
                    oonaction = "onetic_at_a_time"
                    nname = "inactivat_delete_checkBox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

End Sub


Sub onetic_at_a_time()
If Range("F981").Value = True And Range("I981").Value = True Then
MsgBox ("Both option can not be selected at a time")

Range("F981").Value = False
Range("I981").Value = flase
Else
End If
End Sub




Sub GM_IO_add_delete_change_bank()

Call UnPro
Range("A341:A344").EntireRow.Hidden = False
'Range("A64:A73").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                     
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

                    xrow = 342
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_for_add_change_delete" '"purchasing_vendor_ERS_category"
                    nname = "ADC"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "ADC"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select

                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 62
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_for_add_change_delete"
                    nname = "ADC"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Range("F20").Select
End Sub

Sub eft_for_add_change_delete()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("H343:Q343"), True)

If iVal > 1 Then
Range("H343").Value = False
Range("K343").Value = False
Range("P343").Value = False

MsgBox ("Please select a valid option")
Else
End If


''If Range("E524").Locked = True And Range("K524").Locked = True Then
''MsgBox "Please note that supplier payment mode has changed to EFT"
''Call Pro
''Exit Sub


        'for thailand pickup details.
        If Range("F20").Value = "Thailand" Then
            If Range("K524").Value = True Then
            Range("A475:A478").EntireRow.Hidden = False
            Else
            Range("A475:A478").EntireRow.Hidden = True
            End If
        Else
        Range("A475:A478").EntireRow.Hidden = True
        End If
        
        'for thailand pickup details.
'        If Range("F20").Value = "Thailand" Then
            If Range("H343").Value = True Or Range("K343").Value = True Or Range("P343").Value = True Then
            Call banking_information
                If Range("P343").Value = True Then
                
                'old bank details hiding
                Range("B348:B360").EntireRow.Hidden = True
                Range("A364").EntireRow.Hidden = True
                
                Range("A986:A993").EntireRow.Hidden = True
                Else
                'old bank details unhiding
                Range("B348:B360").EntireRow.Hidden = False
                Range("A364").EntireRow.Hidden = False
                
                Range("A986:A993").EntireRow.Hidden = False
                End If
            
            Else

                'old bank details hiding
                Range("B348:B360").EntireRow.Hidden = True
                Range("A364").EntireRow.Hidden = True

                Range("A594:A674").EntireRow.Hidden = False
                On Error Resume Next
                'ActiveSheet.CheckBoxes("EFTpayment").Delete
                'ActiveSheet.CheckBoxes("Chequepayment").Delete

                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                On Error GoTo 0
                Range("A594:A674").EntireRow.Hidden = True

            End If
'        Else
'        Range("A475:A478").EntireRow.Hidden = True
'        End If

Call Pro
End Sub


Sub SAP_Customer_No()

Call UnPro
If Range("F77").Value = True Then
'to editable
    With Range("I76:K76").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Locked = False
Else
'to no-editable
    With Range("I76:K76").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    Range("I76:K76").Locked = True

End If
Call Pro
End Sub
Attribute VB_Name = "CheckBox_related_2nd"
Sub T4820m()
Call UnPro
                    
                    'for company code T4820 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4820indirect").delete
                    ActiveSheet.CheckBoxes("T4820direct").delete
                    On Error GoTo 0
                    
                    If Range("s26").Value = True Then
                    
                    x = 26
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4820indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 26
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4820direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    
                Else
                End If
                Range("F20").Select
                

Range("V25").Formula = "4820"

Call Pro
End Sub

Sub T4A10m()
Call UnPro
Range("V25").Formula = "4A10"

                    'for company code T4A10 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4A10indirect").delete
                    ActiveSheet.CheckBoxes("T4A10direct").delete
                    On Error GoTo 0
                    
                    If Range("s27").Value = True Then
                    
                    x = 27
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4A10indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 27
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4A10direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    
                Else
                End If
                Range("F20").Select
                
Call Pro
End Sub


Sub T4230m()
Call UnPro
Range("V25").Formula = "4230"

                    'for company code T4230 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4230indirect").delete
                    ActiveSheet.CheckBoxes("T4230direct").delete
                    On Error GoTo 0
                    
                    If Range("s28").Value = True Then
                    
                    x = 28
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4230indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 28
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4230direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    
                Else
                End If
                Range("F20").Select
                
Call Pro
End Sub

Sub n4020m()
Call UnPro
Range("V25").Formula = "4020"


                   'for company code T4020 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4020indirect").delete
                    ActiveSheet.CheckBoxes("T4020indirect2").delete
                    ActiveSheet.CheckBoxes("T4020direct").delete
                    On Error GoTo 0
                    
                    If Range("s29").Value = True Then
                    
                    x = 29
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4020indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 29
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4020direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                
                    x = 30
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4020indirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                Else
                End If
                Range("F20").Select
                


Call Pro
End Sub


'''''
Sub A4501m()
Call UnPro
Range("V25").Formula = "4501"

                    'for company code A4501 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("A4501indirect").delete
                    ActiveSheet.CheckBoxes("A4501indirect2").delete
                    ActiveSheet.CheckBoxes("A4501direct").delete
                    ActiveSheet.CheckBoxes("A4501direct2").delete
                    ActiveSheet.CheckBoxes("A4501direct3").delete
                    On Error GoTo 0
                    
                    If Range("s31").Value = True Then
                    
                    x = 31
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4501indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 31
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "A4501direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With

                    
                    x = 32
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4501indirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 32
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "A4501direct2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                
                    x = 33
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "A4501direct3"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                Else
                End If
                Range("F20").Select
                


Call Pro
'MsgBox Range("v25").Value
End Sub


Sub P4570m()

Call UnPro
Range("V25").Formula = "4570"

                    'for company code P4570 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("P4570indirect").delete
                    ActiveSheet.CheckBoxes("P4570direct").delete

                    On Error GoTo 0
                    
                    If Range("s34").Value = True Then
                    
                    x = 34
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "P4570indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 34
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "P4570direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
Else
End If
Range("F20").Select


Call Pro
End Sub


Sub P4E50m()

Range("V25").Formula = "'4E50"

End Sub

Sub S4290m()
Call UnPro
Range("V25").Formula = "4290"


                    'for company code S4290m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("S4290mindirect").delete
                    ActiveSheet.CheckBoxes("S4290mdirect").delete

                    On Error GoTo 0
                    
                    If Range("s36").Value = True Then
                    
                    x = 36
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "S4290mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 36
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "S4290mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
Else
End If
Range("F20").Select

Call Pro
End Sub


Sub S4E30m()
Call UnPro
Range("V25").Formula = "'4E30"

'S4E30m

                    'for company code S4E30m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("S4E30mindirect").delete
                    ActiveSheet.CheckBoxes("S4E30mdirect").delete
                    ActiveSheet.CheckBoxes("S4E30mdirect2").delete
                    On Error GoTo 0
                    
                    If Range("S37").Value = True Then
                    
                    x = 37
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "S4E30mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 37
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "S4E30mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With

                    x = 38
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "S4E30mdirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With


Else
End If
Range("F20").Select

Call Pro
End Sub

Sub I4250m()
Call UnPro
Range("V25").Formula = "4250"

'I4250m


                    'for company code I4250m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4250mindirect").delete
                    ActiveSheet.CheckBoxes("I4250mdirect").delete
                    'ActiveSheet.CheckBoxes("I4250mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S39").Value = True Then
                    
                    x = 39
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4250mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 39
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "I4250mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select

Call Pro
End Sub



Sub I4A80m()
Call UnPro
Range("V25").Formula = "4A80"

'I4A80m

                    'for company code I4A80m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A80mindirect").delete
                    ActiveSheet.CheckBoxes("I4A80mdirect").delete
                    'ActiveSheet.CheckBoxes("I4A80mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S40").Value = True Then
                    
                    x = 40
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A80mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 40
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "I4A80mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select

Call Pro
End Sub

Sub IGMIm()
Call UnPro
Range("V25").Formula = "GMI"

'IGMIm

                    'for company code IGMIm creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("IGMImindirect").delete
                    ActiveSheet.CheckBoxes("IGMImdirect").delete
                    'ActiveSheet.CheckBoxes("IGMImdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S41").Value = True Then
                    
                    x = 41
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "IGMImindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 41
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "IGMImdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select

Call Pro
End Sub

Sub IGMIMm()
Call UnPro
Range("V25").Formula = "GMIM"

'IGMIMm

                    'for company code IGMIMm creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("IGMIMmindirect").delete
                    ActiveSheet.CheckBoxes("IGMIMmdirect").delete
                    'ActiveSheet.CheckBoxes("IGMIMmdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S42").Value = True Then
                    
                    x = 42
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "IGMIMmindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 42
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "IGMIMmdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub IGMTPm()
Call UnPro
Range("V25").Formula = "GMTP"

'IGMTPm

                    'for company code IGMTPm creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("IGMTPmindirect").delete
                    ActiveSheet.CheckBoxes("IGMTPmdirect").delete
                    'ActiveSheet.CheckBoxes("IGMTPmdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S43").Value = True Then
                    
                    x = 43
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "IGMTPmindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 43
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "IGMTPmdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub


Sub I4A40m()
Call UnPro
Range("V25").Formula = "4A40"

'I4A40m

                    'for company code I4A40m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A40mindirect").delete
                    ActiveSheet.CheckBoxes("I4A40mdirect").delete
                    'ActiveSheet.CheckBoxes("I4A40mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("s44").Value = True Then
                    
                    x = 44
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A40mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 44
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "I4A40mdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With
Else
End If

                    'for company code I4A40m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A40mindirect2").delete
                    ActiveSheet.CheckBoxes("I4A40mdirect2").delete
                    'ActiveSheet.CheckBoxes("I4A40mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("s44").Value = True Then
                    
                    x = 45
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A40mindirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 45
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "I4A40mdirect2"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With
Else
End If

                    'for company code I4A40m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A40mindirect3").delete
                    ActiveSheet.CheckBoxes("I4A40mdirect3").delete
                    'ActiveSheet.CheckBoxes("I4A40mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("s44").Value = True Then
                    
                    x = 46
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A40mindirect3"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 46
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "I4A40mdirect3"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub


Sub U2190m()
Call UnPro
Range("V25").Formula = "'2190"

'U2190m

                    'for company code U2190m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("U2190mindirect").delete
                    ActiveSheet.CheckBoxes("U2190mdirect").delete
                    'ActiveSheet.CheckBoxes("U2190mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S47").Value = True Then
                    
                    x = 47
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "U2190mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 47
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "U2190mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub U6500m()
Call UnPro
Range("V25").Formula = "'6500"

'U6500m

                    'for company code U6500m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("U6500mindirect").delete
                    ActiveSheet.CheckBoxes("U6500mdirect").delete
                    'ActiveSheet.CheckBoxes("U6500mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S48").Value = True Then
                    
                    x = 48
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "U6500mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 48
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "U6500mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub V4C10m()
Call UnPro
Range("V25").Formula = "4C10"

'V4C10m

                    'for company code V4C10m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("V4C10mindirect").delete
                    ActiveSheet.CheckBoxes("V4C10mdirect").delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S49").Value = True Then
                    
                    x = 49
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "V4C10mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 49
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "V4C10mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub for_newcreation_of_austrandnew_alternative_payee()
Call UnPro
If Range("H423").Value = True Then

Range("A424:A449").EntireRow.Hidden = False
Else
Range("A424:A449").EntireRow.Hidden = True
End If

Call Pro
End Sub

Sub for_newcreation_of_other_countries_alternative_payee()
Call UnPro
If Range("H396").Value = True Then

Range("A524:A546").EntireRow.Hidden = False
Else
Range("A524:A546").EntireRow.Hidden = True
End If

Call Pro
End Sub
Sub for_newcreation_of_other_countries_Ship_from_duns()
Call UnPro
If Range("P396").Value = True Then

Range("A547:A569").EntireRow.Hidden = False
Else
Range("A547:A569").EntireRow.Hidden = True
End If

Call Pro
End Sub
Sub A4F10m()
Call UnPro

                    Range("V25").Formula = "4F10"
                    'for company code V4C10m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("A4F10mindirect").delete
                    ActiveSheet.CheckBoxes("A4F10mindirect").delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
                    If Range("S50").Value = True Then
                    x = 50
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4F10mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    Else
                    End If
Call Pro
End Sub

Sub A4E70m()
Call UnPro
                    Range("V25").Formula = "'4E70"
                    'for company code V4C10m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("A4E70mindirect").delete
                    ActiveSheet.CheckBoxes("A4E70mindirect").delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
                    If Range("S51").Value = True Then
                    x = 51
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4E70mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    Else
                    End If
Call Pro
End Sub

Sub runnothing()

End Sub
Attribute VB_Name = "GME_Validation_only"
Sub GM_E_only_validation()

'this sub is created only for checking validation before save for further update.
Call UnPro
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
Range("d66").Value = False And _
Range("G66").Value = False And _
Range("K66").Value = False And _
Range("N66").Value = False And _
Range("o66").Value = False And _
Range("S66").Value = False Then
     'MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
    ActiveWindow.ScrollRow = 28
    
'highlight
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
'    Call Pro
'     Exit Sub
chk = "fail"
Else

'back to normal
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

End If

'next step will be checking mandatory feild for new dun creation, hence calling NDC check
'**************************************abu added start**************************************************************************************




'New Duns creation ctrl check
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
        Range("P115").Value = "" Or _
        Range("F115").Value = "" Or _
        Range("F117").Value = "" Or _
        Range("F239").Value = "" Or _
        Range("F236").Value = "" Or _
        Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" And Range("D424").EntireRow.Hidden = False Or _
        Range("F253").Value & Range("F255").Value = "" Then
        
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            
        '    If Range("P115").Value = "" Then Range("P115").Interior.Color = 65535 Else Range("P115").Interior.Pattern = xlNone
        '    If Range("F115").Value = "" Then Range("F115").Interior.Color = 65535 Else Range("F115").Interior.Pattern = xlNone
        '    If Range("F117").Value = "" Then Range("F117").Interior.Color = 65535 Else Range("F117").Interior.Pattern = xlNone
        '    If Range("F239").Value = "" Then Range("F239").Interior.Color = 65535 Else Range("F239").Interior.Pattern = xlNone
            
            Range("F115:I115,F117:I117,P115:S115,F239:U239,F236:L236").Select
            Range("F239").Activate
            Call if_selected_cell_blank_conditional_format
            
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                Else
                End If
                'Range("D426").Interior.Pattern = xlNone
               
                If Range("F253").Value & Range("F255").Value = "" Then
                Range("F255:N255,F253:N253").Select
                Range("F253").Activate
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$253,$F$255)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
                    
                Else
                End If
            ActiveWindow.SmallScroll up:=1000000
            'Call Pro
             chk = "fail"
        
        Else
        End If
End If
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Range("F163").Value = "" Then
            'Range("F121").Value = "" Then
            
            Range("F163:U165").Select
            Call if_selected_cell_blank_conditional_format

            
            'call pro
            chk = "fail"
            Else
            
            End If
            
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Sheets("Mass Change").Range("F1").Value > 1 Then
            Else
            
            MsgBox "Could not find any update in Mass Change Sheet"
            Call Pro
            Sheets("Mass change").Select
            Exit Sub
            End If
End If
'-------------------------------------------------------------------------------------------------------------------
'Cells.FormatConditions.Delete
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Or Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
Else
    If Range("F121").EntireRow.Hidden = False Then
            If Range("F121").Value = "" Or Range("F123").Value = "" Then
            
            Range("F121:U121,F123:U123").Select
            Call if_selected_cell_blank_conditional_format
            
'            MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If
'-------------------------------------------------------------------------------------------------------------------

'-------------------------------------------------------------------------------------------------------------------

If Sheets("GM EU Form").Range("q18").Value = "Email ID set up" Then

    If Range("F149").EntireRow.Hidden = False Then
            If Range("F149").Value & Range("F151").Value = "" Then
            Call UnPro
                Range("F149:N149,F151:N151").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$149,$F$151)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
            Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If

'-----------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("D51").EntireRow.Hidden = False Then
Call UnPro
            If Sheets("GM EU Form").Range("D47").Value & Range("D48").Value & Range("D49").Value & Range("D50").Value & Range("D51").Value = "" Then
        
                Range("D47:D51").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($D$47:$D$51)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 65535
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            
            Else
            End If
Else
End If

If Range("D424").EntireRow.Hidden = False Then
Call UnPro
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
                            'call pro
                            chk = "fail"

                Else
                End If

Else
End If


'###starts################################################################################
'this lines are checking mandatory fields for bank details
'2
If Range("P369:Q369,F375:O375,R375:U375").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P369").Value = "" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    Range("P369:Q369").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If
      
End If

'Please select GM Business Unit first
        If Sheets("GM EU Form"). _
                Range("Q18").Value = "Please select GM Business Unit first" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    'Range("P369:Q369").Select
                    'Call if_selected_cell_blank_conditional_format
                MsgBox "Please select a valid Submission Reason", vbCritical
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If


If Range("F375,F377").EntireRow.Hidden = False And Range("F375").Value = "" And Range("F377").Value = "" Then

    Range("F375,F377").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$375="""",$F$377="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R373,R375").EntireRow.Hidden = False And Range("R373").Value = "" And Range("R375").Value = "" Then

    Range("R373,R375").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$373="""",$R$375="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If


'3
If Range("P380:Q380,F386:O386,R386:U386").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P380").Value = "" Then
                'Range("R386").Value = "" Then
                'Range("R386").Value = "" Then
    
                    Range("P380:Q380").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F386,F388").EntireRow.Hidden = False And Range("F386").Value = "" And Range("F388").Value = "" Then

    Range("F386,F388").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$386="""",$F$388="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R384,R386").EntireRow.Hidden = False And Range("R384").Value = "" And Range("R386").Value = "" Then

    Range("R384,R386").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$384="""",$R$386="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'4
If Range("P391:Q391,F397:O397,R397:U397").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P391").Value = "" Then
                'Range("R397").Value = "" Then
                'Range("R397").Value = "" Then
    
                    Range("P391:Q391").Select
                    Call if_selected_cell_blank_conditional_format
                
               ' Call Pro
               ' Exit Sub
               chk = "fail"
        Else
        End If
      
End If

If Range("F397,F399").EntireRow.Hidden = False And Range("F397").Value = "" And Range("F399").Value = "" Then

    Range("F397,F399").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$397="""",$F$399="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If
'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R395,R397").EntireRow.Hidden = False And Range("R395").Value = "" And Range("R397").Value = "" Then

    Range("R395,R397").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$395="""",$R$397="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'5th bank
If Range("P402:Q402,R408:U408").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P402").Value = "" Then
                'Range("R408").Value = "" Then
                'Range("R408").Value = "" Then
    
                    Range("P402:Q402").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F408,F410").EntireRow.Hidden = False And Range("F408").Value = "" And Range("F410").Value = "" Then

    Range("F408,F410").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$408="""",$F$410="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R406,R408").EntireRow.Hidden = False And Range("R406").Value = "" And Range("R408").Value = "" Then

    Range("R406,R408").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$406="""",$R$408="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'6th bank

If Range("P413:Q413,F419:O419,R419:U419").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P413").Value = "" Then
                'Range("R419").Value = "" Then
                'Range("R419").Value = "" Then
    
                    Range("P413:Q413").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F419,F421").EntireRow.Hidden = False And Range("F419").Value = "" And Range("F421").Value = "" Then

    Range("F419,F421").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$419="""",$F$421="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R417,R419").EntireRow.Hidden = False And Range("R417").Value = "" And Range("R419").Value = "" Then

    Range("R417,R419").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$417="""",$R$419="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'1 st bank
If Range("F357:M357,R363:U363,F363:O363").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F357").Value = "" Then
                'Range("R363").Value = "" Then
                'Range("F363").Value = "" Then
    
                    Range("F357:M357").Select
                    On Error Resume Next
                            
                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

                            If Range("F357").Value = "" Then Range("F357").AddComment
                            'If Range("R363").Value = "" Then Range("R363").AddComment
                            'If Range("F363").Value = "" Then Range("F363").AddComment
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Visible = False
                            'If Range("R363").Value = "" Then Range("R363").Comment.Visible = False
                            'If Range("F363").Value = "" Then Range("F363").Comment.Visible = False
                            'Selection.Comment.Visible = False
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("P413").Select
'                            Selection.ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                             Range("P413").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("R363").Value = "" Then Range("R363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("F419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("F419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("F363").Value = "" Then Range("F363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("R419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("R419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                    'On Error GoTo 0
                    
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'bank1 validation on either a/c # or IBAN is madatory added nov 2016
If Range("F363,F365").EntireRow.Hidden = False And Range("F363").Value = "" And Range("F365").Value = "" Then

    Range("F363,F365").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$363="""",$F$365="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank1 validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R361,R363").EntireRow.Hidden = False And Range("R361").Value = "" And Range("R363").Value = "" Then

    Range("R361,R363").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$361="""",$R$363="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'checking duns mandatory field
If Range("F215").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F215").Value = "" Then
    
                    Range("F215").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking 2 nd duns mandatory field
If Range("F38").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F38").Value = "" Then
    
                    Range("F38").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2 nd duns mandatory field
If Range("F236").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F236").Value = "" Then
    
                    Range("F236").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking supplier's name mandatory field
If Range("F218").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F218").Value = "" Then
    
                    Range("F218").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2nd supplier's name mandatory field
If Range("F40").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F40").Value = "" Then
    
                    Range("F40").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If
'ends###################################################################################




'**************************************Abu added end*********************************************************************************

      If Sheets("GM EU Form").Range("F10").Value = "" Then
     'MsgBox "Please Enter Requester Name", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     
     Range("F10").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F14").Value = "" Then
     'MsgBox "Please Update Requester Email ID", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F14").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F18").Value = "" Then
     'MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   If Sheets("GM EU Form").Range("Q18").Value = "" Then
     'MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("Q18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
     
   End If
   

   If Sheets("GM EU Form").Range("F20").Value = "" Then
     'MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F20").Select
     Call if_selected_cell_blank_conditional_format
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(240, 240, 0) 'yellow
     chk = "fail"
     Else
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
     End If
'If chek = check Then MsgBox " not exit sub"
'If chek = check Then Else MsgBox " exit sub"

If chk = "fail" Then

MsgBox "Form is getting saved with incomplete details, please update mandatory fields (highlighted in yellow) and save again for more accuracy" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & " " & vbNewLine & " ", vbCritical, "Required Entry"
Call Pro
Exit Sub
Else

End If

End Sub
Attribute VB_Name = "GME_validation_n_submit"
Sub Aj()
Attribute Aj.VB_ProcData.VB_Invoke_Func = " \n14"
Application.DisplayAlerts = False
'Application.UseSystemSeparators = False
'Application.ThousandsSeparator = ","
'Application.DecimalSeparator = "."

Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object
Dim aw As String
Dim chk
Application.ScreenUpdating = False
Sheets("GM EU Form").Activate
Call UnPro


If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
Range("d66").Value = False And _
Range("G66").Value = False And _
Range("K66").Value = False And _
Range("N66").Value = False And _
Range("o66").Value = False And _
Range("S66").Value = False Then
     'MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
    ActiveWindow.ScrollRow = 28
    
'highlight
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
'    Call Pro
'     Exit Sub
chk = "fail"
Else

'back to normal
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

End If

'next step will be checking mandatory feild for new dun creation, hence calling NDC check
'**************************************abu added start**************************************************************************************




'New Duns creation ctrl check
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
        Range("P115").Value = "" Or _
        Range("F115").Value = "" Or _
        Range("F117").Value = "" Or _
        Range("F239").Value = "" Or _
        Range("F236").Value = "" Or _
        Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" And Range("D424").EntireRow.Hidden = False Or _
        Range("F253").Value & Range("F255").Value = "" Then
        
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            
        '    If Range("P115").Value = "" Then Range("P115").Interior.Color = 65535 Else Range("P115").Interior.Pattern = xlNone
        '    If Range("F115").Value = "" Then Range("F115").Interior.Color = 65535 Else Range("F115").Interior.Pattern = xlNone
        '    If Range("F117").Value = "" Then Range("F117").Interior.Color = 65535 Else Range("F117").Interior.Pattern = xlNone
        '    If Range("F239").Value = "" Then Range("F239").Interior.Color = 65535 Else Range("F239").Interior.Pattern = xlNone
            
            Range("F115:I115,F117:I117,P115:S115,F239:U239,F236:L236").Select
            Range("F239").Activate
            Call if_selected_cell_blank_conditional_format
            
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                Else
                End If
                'Range("D426").Interior.Pattern = xlNone
               
                If Range("F253").Value & Range("F255").Value = "" Then
                Range("F255:N255,F253:N253").Select
                Range("F253").Activate
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$253,$F$255)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
                    
                Else
                End If
            ActiveWindow.SmallScroll up:=1000000
            'Call Pro
             chk = "fail"
        
        Else
        End If
End If
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Range("F163").Value = "" Then
            'Range("F121").Value = "" Then
            
            Range("F163:U165").Select
            Call if_selected_cell_blank_conditional_format

            
            'call pro
            chk = "fail"
            Else
            
            End If
            
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Sheets("Mass Change").Range("F1").Value > 1 Then
            Else
            
            MsgBox "Could not find any update in Mass Change Sheet"
            Call Pro
            Sheets("Mass change").Select
            Exit Sub
            End If
End If
'-------------------------------------------------------------------------------------------------------------------
'Cells.FormatConditions.Delete
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Or Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
Else
    If Range("F121").EntireRow.Hidden = False Then
            If Range("F121").Value = "" Or Range("F123").Value = "" Then
            
            Range("F121:U121,F123:U123").Select
            Call if_selected_cell_blank_conditional_format
            
'            MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If
'-------------------------------------------------------------------------------------------------------------------

'-------------------------------------------------------------------------------------------------------------------

If Sheets("GM EU Form").Range("q18").Value = "Email ID set up" Then

    If Range("F149").EntireRow.Hidden = False Then
            If Range("F149").Value & Range("F151").Value = "" Then
            Call UnPro
                Range("F149:N149,F151:N151").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$149,$F$151)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
            Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If

'-----------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("D51").EntireRow.Hidden = False Then
Call UnPro
            If Sheets("GM EU Form").Range("D47").Value & Range("D48").Value & Range("D49").Value & Range("D50").Value & Range("D51").Value = "" Then
        
                Range("D47:D51").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($D$47:$D$51)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 65535
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            
            Else
            End If
Else
End If

If Range("D424").EntireRow.Hidden = False Then
Call UnPro
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
                            'call pro
                            chk = "fail"

                Else
                End If

Else
End If


'###starts################################################################################
'this lines are checking mandatory fields for bank details
'2
If Range("P369:Q369,F375:O375,R375:U375").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P369").Value = "" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    Range("P369:Q369").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If
      
End If

'Please select GM Business Unit first
        If Sheets("GM EU Form"). _
                Range("Q18").Value = "Please select GM Business Unit first" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    'Range("P369:Q369").Select
                    'Call if_selected_cell_blank_conditional_format
                MsgBox "Please select a valid Submission Reason", vbCritical
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If


If Range("F375,F377").EntireRow.Hidden = False And Range("F375").Value = "" And Range("F377").Value = "" Then

    Range("F375,F377").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$375="""",$F$377="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R373,R375").EntireRow.Hidden = False And Range("R373").Value = "" And Range("R375").Value = "" Then

    Range("R373,R375").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$373="""",$R$375="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If


'3
If Range("P380:Q380,F386:O386,R386:U386").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P380").Value = "" Then
                'Range("R386").Value = "" Then
                'Range("R386").Value = "" Then
    
                    Range("P380:Q380").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F386,F388").EntireRow.Hidden = False And Range("F386").Value = "" And Range("F388").Value = "" Then

    Range("F386,F388").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$386="""",$F$388="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R384,R386").EntireRow.Hidden = False And Range("R384").Value = "" And Range("R386").Value = "" Then

    Range("R384,R386").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$384="""",$R$386="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'4
If Range("P391:Q391,F397:O397,R397:U397").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P391").Value = "" Then
                'Range("R397").Value = "" Then
                'Range("R397").Value = "" Then
    
                    Range("P391:Q391").Select
                    Call if_selected_cell_blank_conditional_format
                
               ' Call Pro
               ' Exit Sub
               chk = "fail"
        Else
        End If
      
End If

If Range("F397,F399").EntireRow.Hidden = False And Range("F397").Value = "" And Range("F399").Value = "" Then

    Range("F397,F399").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$397="""",$F$399="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If
'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R395,R397").EntireRow.Hidden = False And Range("R395").Value = "" And Range("R397").Value = "" Then

    Range("R395,R397").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$395="""",$R$397="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'5th bank
If Range("P402:Q402,R408:U408").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P402").Value = "" Then
                'Range("R408").Value = "" Then
                'Range("R408").Value = "" Then
    
                    Range("P402:Q402").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F408,F410").EntireRow.Hidden = False And Range("F408").Value = "" And Range("F410").Value = "" Then

    Range("F408,F410").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$408="""",$F$410="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R406,R408").EntireRow.Hidden = False And Range("R406").Value = "" And Range("R408").Value = "" Then

    Range("R406,R408").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$406="""",$R$408="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'6th bank

If Range("P413:Q413,F419:O419,R419:U419").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P413").Value = "" Then
                'Range("R419").Value = "" Then
                'Range("R419").Value = "" Then
    
                    Range("P413:Q413").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F419,F421").EntireRow.Hidden = False And Range("F419").Value = "" And Range("F421").Value = "" Then

    Range("F419,F421").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$419="""",$F$421="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R417,R419").EntireRow.Hidden = False And Range("R417").Value = "" And Range("R419").Value = "" Then

    Range("R417,R419").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$417="""",$R$419="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'1 st bank
If Range("F357:M357,R363:U363,F363:O363").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F357").Value = "" Then
                'Range("R363").Value = "" Then
                'Range("F363").Value = "" Then
    
                    Range("F357:M357").Select
                    On Error Resume Next
                            
                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

                            If Range("F357").Value = "" Then Range("F357").AddComment
                            'If Range("R363").Value = "" Then Range("R363").AddComment
                            'If Range("F363").Value = "" Then Range("F363").AddComment
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Visible = False
                            'If Range("R363").Value = "" Then Range("R363").Comment.Visible = False
                            'If Range("F363").Value = "" Then Range("F363").Comment.Visible = False
                            'Selection.Comment.Visible = False
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("P413").Select
'                            Selection.ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                             Range("P413").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("R363").Value = "" Then Range("R363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("F419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("F419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("F363").Value = "" Then Range("F363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("R419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("R419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                    'On Error GoTo 0
                    
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'bank1 validation on either a/c # or IBAN is madatory added nov 2016
If Range("F363,F365").EntireRow.Hidden = False And Range("F363").Value = "" And Range("F365").Value = "" Then

    Range("F363,F365").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$363="""",$F$365="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank1 validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R361,R363").EntireRow.Hidden = False And Range("R361").Value = "" And Range("R363").Value = "" Then

    Range("R361,R363").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$361="""",$R$363="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'checking duns mandatory field
If Range("F215").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F215").Value = "" Then
    
                    Range("F215").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking 2 nd duns mandatory field
If Range("F38").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F38").Value = "" Then
    
                    Range("F38").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2 nd duns mandatory field
If Range("F236").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F236").Value = "" Then
    
                    Range("F236").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking supplier's name mandatory field
If Range("F218").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F218").Value = "" Then
    
                    Range("F218").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2nd supplier's name mandatory field
If Range("F40").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F40").Value = "" Then
    
                    Range("F40").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If
'ends###################################################################################




'**************************************Abu added end*********************************************************************************

      If Sheets("GM EU Form").Range("F10").Value = "" Then
     'MsgBox "Please Enter Requester Name", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     
     Range("F10").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F14").Value = "" Then
     'MsgBox "Please Update Requester Email ID", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F14").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F18").Value = "" Then
     'MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   If Sheets("GM EU Form").Range("Q18").Value = "" Then
     'MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("Q18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
     
   End If
   

   If Sheets("GM EU Form").Range("F20").Value = "" Then
     'MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F20").Select
     Call if_selected_cell_blank_conditional_format
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(240, 240, 0) 'yellow
     chk = "fail"
     Else
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
     End If
'If chek = check Then MsgBox " not exit sub"
'If chek = check Then Else MsgBox " exit sub"

If chk = "fail" Then

MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
Call Pro
Exit Sub
Else

End If



  If Sheets("GM EU Form").Range("Q18").Value = "Email ID set up" And Sheets("GM EU Form").Range("F121").Value = "" Then
     MsgBox "Duns or Vendor cannot be left blank!", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Exit Sub
     End If
     
  If Sheets("GM EU Form").Range("M18").Value = "Email ID set up" And Sheets("GM EU Form").Range("E34").Value = "" Then
     MsgBox "Supplier name cannot be left blank", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Exit Sub
     End If
      If Sheets("GM EU Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'GM Europe Multiple BU &PO'", vbExclamation, "Required Entry"
     MsgBox "you have selected " & Sheets("GM Europe Multiple BU &PO").Range("f1").Value & " GM BU"
     Exit Sub
     End If
    ' MsgBox Sheets("GM Europe Multiple BU &PO").Range("f1").Value & "BU Found"
     If Sheets("GM EU Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value <> 0 Then
     Sheets("GM Europe Multiple BU &PO").Visible = True
     Sheets("GM Europe Multiple BU &PO").Select
     er = Range("e2").End(xlDown).Row
     Range("a2:F5000").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$F$5100").AutoFilter Field:=4, Criteria1:="TRUE"
    End If
    'MsgBox "Validation has been completed succesfully ", vbInformation
    If MsgBox("Validation has been completed succesfully" & vbNewLine & "All required fields are updated properly and preparing for submit..!", vbOKCancel + vbDefaultButton2, "Please confirm submition") = vbCancel Then
    'Do you want to submit this form now
Exit Sub
End If
     ActiveWorkbook.Save
     Application.ScreenUpdating = False

If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
If MsgBox("Are you a Supplier?", vbYesNo, Validation) = vbYes Then
MsgBox "Please send back this updated form to GM rather than sending it to Master Data, Since Master Data does not accept New Creation request directly from Supplier"
Call Pro
Exit Sub
Else
End If
End If


     'unhiding all sheets
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
     'Sheets("GM EU Form").Move Before:=Sheets(1)
   'Sheets("GM Europe Multiple BU &PO").Move Before:=Sheets(2)
        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub


subm = ThisWorkbook.Sheets("GM EU Form").Range("Q18").Value

If ThisWorkbook.Sheets("GM EU Form").Range("f26").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f26").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f38").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f38").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f121").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f121").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f215").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f215").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value = "Conduent will Initiate DUNS Assignment process" Then
DUN = "No DUNS"
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f236").Value
End If

If ThisWorkbook.Sheets("GM EU Form").Range("f28").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f28").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f40").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f40").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f123").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f123").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f218").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f218").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f239").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f239").Value
End If
subj = subm & "-" & DUN & "-" & SUP


            WkbName = subj 'Range("q18").Value & " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array("<", ">", "|", "/", "*", "[", "]", "{", "}", "-", "\", "?", """")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName = Replace(WkbName, MyArray(x), "_", 1)
            Next x
            'MsgBox WkbName
        
            WkbName_first = mypath 'Range("I9").Value '& " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array(".xls", "xlsx")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName_first = Replace(WkbName_first, MyArray(x), "_", 1)
            Next x



'aw = Application.ActiveWorkbook.Path & "\"
   'tb = InputBox("give the file name", , any_Name)
 '  ta = tb & ".xls" '".pdf"
  ' tt = aw & ta
  pbn = ActiveWorkbook.Name
  
   Sheets(Array("GM Europe Multiple BU &PO", "Mass change")).Select
  ActiveWindow.SelectedSheets.Copy
  cbn = ActiveWorkbook.Name
  
  ActiveWorkbook.Sheets.Add Before:=Worksheets(1) ', Count:=3
  
  'sheets("Sheet
  'ActiveWorkbook.Worksheets.Add
  ActiveSheet.Name = "Form"
  
  On Error GoTo 0
  Windows(pbn).Activate
  Sheets("GM EU Form").Select
  Call UnPro
  'Range("A1:V3327").Select
'Selection.Copy
'Selection.SpecialCells(xlCellTypeVisible).Copy
'Range("A1:V3327")

''''''''''''''''''''''''''''''''''''

Range("W1:W3326").ClearContents
    Range("W1:W3326").SpecialCells(xlCellTypeVisible).FormulaR1C1 = "UN"
    Cells.Copy
    
Windows(cbn).Activate
Sheets("Form").Select
Range("A1").Select

'    Windows.Add
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveSheet.Paste

       ' Range("A1:W1").Insert Shift:=xlDown
''''    Range("A1:W1").FormulaR1C1 = " "
       ' Range("A1").Select
       ' Selection.AutoFilter
    
        Range("$A$1:$W$3379").Select
        Selection.AutoFilter
        ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, Criteria1:="<>"
    
     '   Selection.AutoFilter , VisibleDropDown:=False
       ' ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, VisibleDropDown:=False, Criteria1:="<>"
        ActiveWindow.ScrollRow = 1
        
        Selection.AutoFilter Field:=1, VisibleDropDown:=False
        Selection.AutoFilter Field:=22, VisibleDropDown:=False
     '   Selection.AutoFilter Field:=23, VisibleDropDown:=False
    '
      '  Range("W1").Select
''''    Do
''''    If ActiveCell.Value = "UN" Then ActiveCell.EntireRow.Hidden = False Else ActiveCell.EntireRow.Hidden = True
''''    ActiveCell.Offset(1, 0).Select
''''    If ActiveCell.Row >= 3379 Then Exit Do
''''
''''    Loop

    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Application.DisplayFormulaBar = False
    Range("A1").Select
    
    On Error Resume Next
    If Range("B1").Value = "" Then Range("A1").EntireRow.Hidden = True
    On Error GoTo 0
''''''''''''''''''''''''''''''''''''

'ActiveSheet.Paste
Range("A1").Select
Cells.FormatConditions.delete

           On Error Resume Next

'deleting irrelevent sheets from product
    If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then Else Sheets("GM Europe Multiple BU &PO").delete
    If Sheets("Form").Range("Q18").Value = "Mass changes" Then Else Sheets("Mass change").delete
        ' '========================
            On Error GoTo 0
            



        ActiveWorkbook.SaveAs (WkbName_first & " " & WkbName & ".xls"), FileFormat:=51

'deleting unselected rows from GM multiple BU
If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then '!!!
        Sheets("GM Europe Multiple BU &PO").Select
        Call UnPro
        If ActiveSheet.Name = "GM Europe Multiple BU &PO" Then '!!
        
                Range("D3").Select
                Do
                On Error GoTo ivd
                If ActiveCell.Value = "" Then Exit Do
                If ActiveCell.Value = "False" Then
                ActiveCell.EntireRow.delete
                Else
                ActiveCell.Offset(1, 0).Select
                End If
                Loop
ivd:
On Error GoTo 0
        Range("A1").EntireRow.delete
        Range("A1").Select
        On Error Resume Next
        ActiveSheet.DrawingObjects("CheckEU1").Visible = False
        
        
                Range(Range("B1048570").End(xlUp).Offset(1, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                Selection.EntireRow.Hidden = False
                Range(Range("B1048570").End(xlUp).Offset(2, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                On Error Resume Next
'                Selection.EntireRow.Hidden = True
                'On Error GoTo 0
                Dim s As Shape
                On Error Resume Next
                For Each s In ActiveSheet.Shapes
                
                s.OnAction = ""
                Next
                On Error GoTo 0
'''        ActiveSheet.Shapes.Visible = False
''        ActiveSheet.Shapes.SelectAll
''        Selection.ShapeRange.Visible = False
        On Error GoTo 0
        Call Pro
        Else '!!
        End If '!!
Else '!!!
End If '!!!
        'also you can give like left 10000 nos to eliminate xls from my path
        Sheets(1).Select
        

        
        'write here to alter form copy
   '         On Error Resume Next
'            ActiveSheet.DrawingObjects.Visible = False
           ' ActiveSheet.DrawingObjects.Delete
 '           ActiveSheet.DrawingObjects.Hide
  '          On Error GoTo 0
''    Call UnPro
''    Range("A1").Select
''    On Error Resume Next
       ActiveWindow.SmallScroll up:=1000000
''          ActiveSheet.Shapes.Range(Array("Group 5", "CommandButton1", "CommandButton2", "CommandButton3", "CommandButton4", "submit")).Delete
''Range("a1:V3336").Locked = True
'''Range("Q3331").ClearContents
'Application.ScreenUpdating = False
  On Error GoTo 0

On Error Resume Next

ActiveSheet.Shapes.SelectAll
'ActiveSheet.Shapes.OnAction = "nidhi"
Selection.OnAction = ""


'xxx
'On Error Resume Next
'For Each s In ActiveSheet.Shapes
's.OnAction = ""
'Next

On Error Resume Next

        If ActiveSheet.Name = "Form" Then Range("F20:L20").Locked = True
        If ActiveSheet.Name = "Form" Then Range("F10:L10").Locked = True
        Range("F21:N21").ClearContents
        
    On Error GoTo 0
    

    
    
    Call Pro
       '     ActiveSheet.DrawingObjects.Visible = False
            
            
        ActiveWorkbook.UpdateLinks = xlUpdateLinksNever
        
        'added for one mail project
        ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
        ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"
        Sheets("Form").Select
        ActiveSheet.Name = "Form_GBS"
        
        ActiveWorkbook.Save
        
        ffname = ActiveWorkbook.FullName
        fname = ActiveWorkbook.Name
        
        ActiveWorkbook.Close
        'MsgBox " Request Copy Has Been Saved as " & fname
        ' '============================
        tt1 = ffname
        
  '  .ExportAsFixedFormat Type:=xlTypexls, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  'End With
   
  
  
  
'''abu added=======================================================================================
''                 'Sheets("ORD").Select (False)
''                  'Sheets("Standardchanges").Select (False)
''                  ActiveWindow.SelectedSheets.Copy
''
''                  Application.StatusBar = False
''
''                    Dim appXL As New Excel.Application
''    Dim MyDate
''    MyDate = Date    ' MyDate contains the current system date.
''    Dim MyTime
''    MyTime = Time    ' Return current system time.
''    Dim TestStr As String
''    TestStr = Format(MyTime, "hh.mm.ss")
''    Dim Test1Str As String
''    Test1Str = Format(MyDate, "DD-MM-YYYY")
''
''    Application.DisplayAlerts = False
''    'MsgBox ActiveWorkbook.Name
''
''    ActiveWorkbook.SaveAs Filename:="C:\STD Changes\Bank\" & ree & " " & Test1Str & " " & TestStr & " " & ".xlsx" 'ActiveWorkbook.name
''    'ActiveWorkbook.SaveAs Filename:="C:\Std Changes\RAW DATA\" & "Test"
''    ActiveWorkbook.Save
''    bn = ActiveWorkbook.FullName
'''abu added=====================================================================================
  ' Call page

'Next i
'Else
Windows(pbn).Activate

Sheets("GM EU Form").Select
Range("A1").Select
Call UnPro

If UserForm3.OptionButton1.Value = True Then

Set rng = Nothing

Set rng = Sheets("GM EU Form").Range("B9:v24").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

subm = ThisWorkbook.Sheets("GM EU Form").Range("Q18").Value

If ThisWorkbook.Sheets("GM EU Form").Range("f26").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f26").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f38").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f38").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f121").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f121").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f215").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f215").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value = "Conduent will Initiate DUNS Assignment process" Then
DUN = "No DUNS"
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f236").Value
End If

If ThisWorkbook.Sheets("GM EU Form").Range("f28").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f28").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f40").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f40").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f123").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f123").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f218").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f218").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f239").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f239").Value
End If
subj = subm & "-" & DUN & "-" & SUP
With OutMail
    .To = Range("E6").Value & ";" & Range("F14").Value
    .cc = Range("Q14").Value
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
'    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
'  If Sheets("GM EU Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value <> 0 Then
'  Sheets("GM Europe Multiple BU &PO").Select
'  Range("A1").Select
'  Selection.AutoFilter
 ' End If
 
 Else
'        If ActiveSheet.OptionButton2.Value = True Then MsgBox "Form has been saved in the below Directory " _
'        & vbNewLine & vbNewLine & vbNewLine & ffname
    'If UserForm3.OptionButton2.Value = True Then
    MsgBox "Form has been saved in the below Directory " & vbNewLine & vbNewLine & vbNewLine & ffname
    MsgBox "Finished..!", vbInformation
    Exit Sub
  
 End If
       For I = 3 To Sheets.Count
     Sheets(I).Visible = 2
     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM EU Form").Select
     Call Pro
     Application.ScreenUpdating = True
     MsgBox "Finished..!", vbInformation
     Application.DisplayAlerts = True

Application.UseSystemSeparators = True
     
End Sub


Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM EU Form").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function

Sub justsave()
If MsgBox("Do you really want to save the form for further step? " & Chr(13) & "Please submit the form only after the complete updates.", vbYesNo, "Save") = vbNo Then
Call Pro
Exit Sub
End If
Application.ScreenUpdating = False

''''Range("W1").Select
''''Call UnPro
''''    ActiveCell.FormulaR1C1 = "save"
''''Call Pro
'ActiveWorkbook.Save
 
 If ActiveSheet.Name = "GM EU Form" Then

sela = Range("F10").Value
b = Range("F12").Value
c = Range("Q10").Value
d = Range("Q12").Value
E = Range("F14").Value
f = Range("F18").Value
g = Range("F20").Value
h = Range("Q18").Value

    If sela = 0 And b = 0 And c = 0 And d = 0 And E = 0 And f = "Please update the requester name" And g = 0 And h = 0 Then
     Cancel = False
      Exit Sub
      End If
    If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And Range("d66").Value = False And Range("G66").Value = False And Range("K66").Value = False And Range("N66").Value = False And Range("o66").Value = False And Range("S66").Value = False Then
         MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
      Cancel = True
         Exit Sub
    End If

    If Sheets("GM EU Form").Range("F10").Value = "" Then
     MsgBox "Please enter Requester name", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   
   If Sheets("GM EU Form").Range("F14").Value = "" Then
     MsgBox "Please enter Requester email ID", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   
   If Sheets("GM EU Form").Range("F18").Value = "" Then
     MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   If Sheets("GM EU Form").Range("Q18").Value = "" Then
     MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   If Sheets("GM EU Form").Range("F20").Value = "" Then
     MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
     End If
     
  If Sheets("GM EU Form").Range("Q18").Value = "Email ID set up" And Sheets("GM EU Form").Range("F121").Value = "" Then
     MsgBox "Duns or Vendor Details Cannot Be Blank.!", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
     End If
     
  If Sheets("GM EU Form").Range("M18").Value = "Email ID set up" And Sheets("GM EU Form").Range("E34").Value = "" Then
     MsgBox "Please Enter Supplier name in Cell E34", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
     End If
 If Sheets("GM EU Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'Multiple BU Tab'", vbExclamation, "Required Entry"
     Cancel = True
     Exit Sub
     End If
End If
 
         mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xlsm), *.xlsm", Title:="This Location Is Asked For Getting Form Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r), FileFormat:=ThisWorkbook.FileFormat
    If ActiveSheet.Name = "GM_IO_Form" Or ActiveSheet.Name = "GM EU Form" Or ActiveSheet.Name = "GM_NA" Then
    mm = ActiveSheet.Name
    Else
    mm = "The FORM"
    End If

        MsgBox mm & " has been saved in the below directory: " & vbNewLine & vbNewLine & vbNewLine & "Location: " & ActiveWorkbook.FullName, vbInformation

''''Range("W1").Select
''''Call UnPro
''''    ActiveCell.FormulaR1C1 = ""
''''    Call Pro
''''    ''Application.ScreenUpdating = False

End Sub

Attribute VB_Name = "GMIO_validation_n_Submit"
Sub Kudhal()
'GMIO_GM_BU_validation
Application.ScreenUpdating = False
Application.UseSystemSeparators = False
Application.ThousandsSeparator = ","
Application.DecimalSeparator = "."

Call UnPro
Sheets("GM_IO_Form").Select
Cells.FormatConditions.delete
Dim count1 As Integer
Dim count2 As Integer
Dim count3 As Integer
Dim count4 As Integer
Dim count5 As Integer

'validation_GMIO()
'requester name, email, submission reason, country validation
        If Sheets("GM_IO_Form"). _
                Range("F10").Value = "" Or _
                Range("F14").Value = "" Or _
                Range("Q18").Value = "" Or _
                Range("F20").Value = "" Then
    
                    Range("F10:F10,F14:F14,Q18:Q18,F20:F20").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
        Else
        End If
        

'validation_vendor_name_and_Vendor_code()
If Range("$F$57:$L$57").EntireRow.Hidden = True Then
Else
        If Sheets("GM_IO_Form"). _
                Range("F57").Value = "" Or _
                Range("F59").Value = "" Then
    
                    Range("$F$57:$L$57,$F$59:$U$59").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
        Else
        End If
End If

count1 = Application.WorksheetFunction.CountIf(Range("S26:S49"), True)
If count1 < 1 Then

chk = "fail"
Else
End If

'#####MANDATORY checkup

    'this is line added because PO is not mandatory for rest of the reason from below mentioned.
    If Range("Q18").Value = "New Duns/Vendor Code creation" Or Range("Q18").Value = "Extend to New Business Unit/Company Code" Or Range("Q18").Value = "Extend to New Purchasing Org" Then
    mandatory = True
    Else
    mandatory = False
    End If


'GM Europe Business Units
'thailand
If Sheets("GM_IO_Form").Range("E26").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S26:S28"), True)
            
            
            count2 = Application.WorksheetFunction.CountIf(Range("T26:U26"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T27:U27"), True)
            count4 = Application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            
            
            If count1 < 1 Then
                    
            chk = "fail"
                        
                        
            Else
                If Range("S26").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
            End If
            
            If Range("S27").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
            Else
            End If


            If Range("S28").Value = True Then
                    If count4 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
            Else
            End If



End If

'New Zealand
If Sheets("GM_IO_Form").Range("E29:F30").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S29:S30"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T29:U30"), True)
            'count3 = application.WorksheetFunction.CountIf(Range("T27:U27"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S29").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
            End If

End If

'Australia
If Sheets("GM_IO_Form").Range("E31:F33").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S31:S33"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T31:U33"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("S51"), True)
            count4 = Application.WorksheetFunction.CountIf(Range("T51:U51"), True)
            
                        
            If count1 + count3 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S31").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                
                
                'GM Holden Aus NSC Ltd-4E70
                If Range("S51").Value = True Then
                            If count4 < 1 Then
                            
                            
                            If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                            chk = "fail"
                            End If
                            
                            Else
                            End If
                Else
                End If
                        
                
            End If
End If


'Philippines
If Sheets("GM_IO_Form").Range("E34:F35").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S34:S35"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T34:U34"), True)
            'count3 = application.WorksheetFunction.CountIf(Range("T27:U27"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S34").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
            End If

End If


'Singapore

If Sheets("GM_IO_Form").Range("E36:F38").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S36:S38"), True) + Application.WorksheetFunction.CountIf(Range("S50"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T36:U36"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T37:U38"), True)
            
            'T50:U50
            count4 = Application.WorksheetFunction.CountIf(Range("T50:U50"), True)
            
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S36").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                
                If Range("S37").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If

                If Range("S50").Value = True Then
                    If count4 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If

            End If

End If

'indonesia

If Sheets("GM_IO_Form").Range("E39:F40").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S39:S40"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T39:U39"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T40:U40"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            'count5 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S39").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                If Range("S40").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If


            End If

End If

'india

If Sheets("GM_IO_Form").Range("E41:F46").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S41:S46"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T41:U41"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T42:U42"), True)
            count4 = Application.WorksheetFunction.CountIf(Range("T43:U43"), True)
            count5 = Application.WorksheetFunction.CountIf(Range("T44:U46"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S41").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                If Range("S42").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If


            End If
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S43").Value = True Then
                    If count4 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                If Range("S44").Value = True Then
                    If count5 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If


            End If

End If

'india second validation
'PAN number is mandatory
If Range("O120").EntireRow.Hidden = False And Trim(UCase(Range("O120").Value)) = "INDIA" And Range("F124").Value = "" Then

        Range("F124").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($O$120))=""INDIA"",trim($F$124)="""")"
    Range("F124").FormatConditions(Range("F124").FormatConditions.Count).SetFirstPriority
    With Range("F124").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207 '10092543
        .TintAndShade = 0
    End With
    Range("F124").FormatConditions(1).StopIfTrue = False

chk = "fail"
Else
End If

'india bankfield mandatory

    If Range("F20").Value = "India" Then
    
'primary bank
        If Range("$R$603").EntireRow.Hidden = False And Range("$O$603").Value = "IFSC" And Range("B605").Value = "" Then
        chk = "fail"
        
            Range("R603:U603,R605:U605").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$605="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If
        
'1st additional bank
        If Range("$B$620").EntireRow.Hidden = False And Range("$O$618").Value = "IFSC" And Range("$B$620").Value = "" Then
        chk = "fail"
        
            Range("R618:U618,R620:U620").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$620="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'2nd additional bank
        If Range("$B$634").EntireRow.Hidden = False And Range("O632").Value = "IFSC" And Range("$B$634").Value = "" Then
        chk = "fail"
        
            Range("R634:U634,R632:U632").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$634="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'3rd additional bank
        If Range("$B$647").EntireRow.Hidden = False And Range("O645").Value = "IFSC" And Range("$B$647").Value = "" Then
        chk = "fail"
        
            Range("R645:U645,R647:U647").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$647="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'4th additional bank
        If Range("$B$660").EntireRow.Hidden = False And Range("O658").Value = "IFSC" And Range("$B$660").Value = "" Then
        chk = "fail"
        
            Range("R658:U658,R660:U660").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$660="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'5th additional bank
        If Range("$B$673").EntireRow.Hidden = False And Range("O671").Value = "IFSC" And Range("$B$673").Value = "" Then
        chk = "fail"
        
            Range("R671:U671,R673:U673").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$673="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If


    Else
    End If



'for extent new business, extension details are mandatory.

If Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
        
        'indian field
        If Range("F198").EntireRow.Hidden = False Then
        If Range("F198").Value = "" Or Range("F200").Value = "" Or Range("F202").Value = "" Or Range("P200").Value = "" Or Range("P202").Value = "" Then
        chk = "fail"
        Range("F198:I198,F200:I200,F202:I202,P200:S200,P202:S202").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If
End If


'FOR NEW CREATION address fields like state,country,postal,street are mandatory

If Range("Q18").Value = "New Duns/Vendor Code creation" Then
        
        'indian field
        If Range("F116").EntireRow.Hidden = False Then
        If Range("F116").Value = "" Or Range("F118").Value = "" Or Range("O118").Value = "" Or Range("F120").Value = "" Or Range("O120").Value = "" Then
        chk = "fail"
        Range("F116:U116,F118:J118,F120:J120,O118:U118,O120:U120").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If
    
        'australian,new zealand field
        If Range("F406").EntireRow.Hidden = False Then
        If Range("F406").Value = "" _
        Or Range("F408").Value = "" _
        Or Range("M408").Value = "" _
        Or Range("F410").Value = "" _
        Or Range("M410").Value = "" Then
        
        chk = "fail"
        Range("F406:U406,F408:J408,M408:U408,M410:U410,F410:J410").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If

        'Indonesia/philipino/singapore/thai/viatnam
        If Range("F379").EntireRow.Hidden = False Then
        If Range("F379").Value = "" _
        Or Range("F381").Value = "" _
        Or Range("M381").Value = "" _
        Or Range("F383").Value = "" _
        Or Range("M383").Value = "" Then
        
        chk = "fail"
        Range("F379:U379,F381:J381,M381:U381,F383:J383,M383:U383").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If

        'UAE
        If Range("F458").EntireRow.Hidden = False Then
        If Range("F458").Value = "" _
        Or Range("F460").Value = "" _
        Or Range("M460").Value = "" _
        Or Range("F462").Value = "" _
        Or Range("M462").Value = "" Then
        
        chk = "fail"
        Range("F458:U458,F460:J460,M460:U460,F462:J462,M462:U462").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If

Else
End If

'country australia ABN code mandatory

countryucase = Trim(UCase(Range("M410").Value))
If Range("M410").EntireRow.Hidden = False And countryucase = "AUSTRALIA" And Range("M412").Value = "" Then

    Range("M412").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($M$410))=""AUSTRALIA"",trim($M$412)="""")"
    Range("M412").FormatConditions(Range("M412").FormatConditions.Count).SetFirstPriority
    With Range("M412").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Range("M412").FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'Utd.Arab Emir.
If Sheets("GM_IO_Form").Range("E47:F48").EntireRow.Hidden = True Then
Else
            count1 = Application.WorksheetFunction.CountIf(Range("S47:S48"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T47:U47"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T48:U48"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            'count5 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S39").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    chk = "fail"
                    
                    Else
                    End If
                Else
                End If
                If Range("S40").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    chk = "fail"
                    
                    Else
                    End If
                Else
                End If


            End If
            
End If

'Vietnam
If Sheets("GM_IO_Form").Range("E49:F49").EntireRow.Hidden = True Then
Else
            count1 = Application.WorksheetFunction.CountIf(Range("S49"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T49:U49"), True)
            'count3 = application.WorksheetFunction.CountIf(Range("T48:U48"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            'count5 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S49").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    chk = "fail"
                    
                    Else
                    End If
                Else
                End If

            End If
            
End If


'formatconditon_gmBU_First_checkbox()

'1
    Range("$G$26:$M$28").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$26:$S$28,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''2
'    Range("$G$27:$M$27").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$27,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'
''3
'    Range("$G$28:$M$28").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$28,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'4
    Range("$G$29:$M$30").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$29,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'5
    'Range("$G$31:$M$33").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$31,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'
'
'
'
    Range("G51:M51,G31:M33").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$31,TRUE)+COUNTIF($S$51,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
'6
    Range("$G$34:$M$35").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$34:$S$35,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''7
'    Range("$G$35:$M$35").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$35,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False

'8

    Range("$G$36:$M$38,$G$50:$M$50").Select
'    Range("G31").Activate
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$36:$S$38,TRUE)+COUNTIF($S$50,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'
'    Range("$G$36:$M$38").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$36:$S$38,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False

''9
'    Range("$G$37:$M$38").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$37,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'10
    Range("$G$39:$M$40").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$39:$S$40,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

''11
'    Range("$G$40:$M$40").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$40,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False

'12
    Range("$G$41:$M$46").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$41:$S$46,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''13
'    Range("$G$42:$M$42").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$42,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
''14
'    Range("$G$43:$M$43").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$43,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
''15
'    Range("$G$44:$M$46").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$44,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'16
    Range("$G$47:$M$48").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$47:$S$48,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''17
'    Range("$G$48:$M$48").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$48,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'18
    Range("$G$49:$M$49").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$49,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'formatconditon_gmBU_second_checkbox()
'thailand format condition
'1
    Range("N26:Q26").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$26=TRUE, COUNTIF($T$26:$U$26,TRUE), 1)<1)"
    '"=AND($G$63<>TRUE,IF($S$43=TRUE,
    
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'2
    Range("N27:Q27").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$27=TRUE, COUNTIF($T$27:$U$27,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'3

    Range("N28:Q28").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$28=TRUE, COUNTIF($T$28:$U$28,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
'New Zealand format condition
'1
    Range("N29:Q29,N30:O30").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$29=TRUE, COUNTIF($T$29:$U$30,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'australia
    Range("N31:Q33").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$31=TRUE, COUNTIF($T$31:$U$33,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'2
    Range("N51:O51").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$51=TRUE, COUNTIF($T$51:$U$51,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'philippine
    Range("N$34:Q$34").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$34=TRUE, COUNTIF($T$34:$U$34,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'singapore
'1
    Range("N$36:Q$36").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$36=TRUE, COUNTIF($T$36:$U$36,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'2
        Range("N$37:O$37,P$37:Q$38").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$37=TRUE, COUNTIF($T$38:$U$37,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'3
        Range("$N$50:$O$50").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$50=TRUE, COUNTIF($T$50:$U$50,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'indonesia

    Range("N$39:Q$39").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$39=TRUE, COUNTIF($T$39:$U$39,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$40:Q$40").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$40=TRUE, COUNTIF($T$40:$U$40,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
'india
    Range("N$41:Q$41").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$41=TRUE, COUNTIF($T$41:$U$41,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$42:Q$42").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$42=TRUE, COUNTIF($T$42:$U$42,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("N$43:Q$43").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$43=TRUE, COUNTIF($T$43:$U$43,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$44:Q$46").Select

    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$44=TRUE, COUNTIF($T$44:$U$46,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'UAE
    
    Range("N$47:Q$47").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$47=TRUE, COUNTIF($T$47:$U$47,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$48:Q$48").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$48=TRUE, COUNTIF($T$48:$U$48,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'vietnam
    Range("N$49:Q$49").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$49=TRUE, COUNTIF($T$49:$U$49,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'other special cells and fields
'purchase_finance_E_ID_mandatory()
    If Range("$F$128").EntireRow.Hidden = False And Range("F130").Value = "" And Range("F128").Value = "" Then
    Range("F130:N130,F128:N128").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$128="""",$F$130="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Else
    End If
    
    If Range("$F$585").EntireRow.Hidden = False And Range("F585").Value = "" And Range("F587").Value = "" Then
    Range("F585:N585,F587:N587").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$585="""",$F$587="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F157:N157").EntireRow.Hidden = False And Range("F157").Value = "" And Range("F159").Value = "" Then
    Range("F159:N159,F157:N157").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$157="""",$F$159="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F182:N182").EntireRow.Hidden = False And Range("F182").Value = "" And Range("F184").Value = "" Then
    Range("F182:N182,F184:N184").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$182="""",$F$184="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F241:N241,F243:N243").EntireRow.Hidden = False And Range("F241").Value = "" And Range("F243").Value = "" Then
    Range("F241:N241,F243:N243").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$241="""",$F$243="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If


    If Range("F255:N255,F257:N257").EntireRow.Hidden = False And Range("F255").Value = "" And Range("F257").Value = "" Then
    Range("F255:N255,F257:N257").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$255="""",$F$257="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F277:N277,F275:N275").EntireRow.Hidden = False And Range("F277").Value = "" And Range("F275").Value = "" Then
    Range("F277:N277,F275:N275").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$275="""",$F$277="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F387:N387,F389:N389").EntireRow.Hidden = False And Range("F387").Value = "" And Range("F389").Value = "" Then
    Range("F387:N387,F389:N389").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$387="""",$F$389="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    

    If Range("F414:N414,F416:N416").EntireRow.Hidden = False And Range("F414").Value = "" And Range("F416").Value = "" Then
    Range("F414:N414,F416:N416").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$414="""",$F$416="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F440:N440,F442:N442").EntireRow.Hidden = False And Range("F440").Value = "" And Range("F442").Value = "" Then
    Range("F440:N440,F442:N442").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$440="""",$F$442="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    If Range("F466:N466,F468:N468").EntireRow.Hidden = False And Range("F466").Value = "" And Range("F468").Value = "" Then
    Range("F466:N466,F468:N468").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$466="""",$F$468="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    If Range("F514:N514,F516:N516").EntireRow.Hidden = False And Range("F514").Value = "" And Range("F516").Value = "" Then
    Range("F514:N514,F516:N516").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$514="""",$F$516="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F539:N539,F541:N541").EntireRow.Hidden = False And Range("F539").Value = "" And Range("F541").Value = "" Then
    Range("F539:N539,F541:N541").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$539="""",$F$541="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
    If Range("F562:N562,F564:N564").EntireRow.Hidden = False And Range("F562").Value = "" And Range("F564").Value = "" Then
    Range("F562:N562,F564:N564").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$562="""",$F$564="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
    If Range("F182:N182").EntireRow.Hidden = False And Range("F182").Value = "" And Range("F184").Value = "" Then
    Range("F182:N182,F184:N184").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$182="""",$F$184="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("$F$387").EntireRow.Hidden = False And Range("$F$387").Value = "" And Range("$F$389").Value = "" Then
    Range("F387:N387,F389:N389").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$387="""",$F$389="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
'IFSC_Code()

''            'Cells.FormatConditions.Delete
''            If Range("$R$603").EntireRow.Hidden = False And Range("$O$603").Value = "IFSC" And Range("$R$603").Value = "" Then
''            Range("R603:U603").Select
''            Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
''                "=AND($O$603=""IFSC"",$R$603="""")"
''            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
''            With Selection.FormatConditions(1).Interior
''                .PatternColorIndex = xlAutomatic
''                .Color = 6750207
''                .TintAndShade = 0
''            End With
''            Selection.FormatConditions(1).StopIfTrue = False
''            chk = "fail"
''            Else
''            End If
'Doc()

    If Range("$D$988").EntireRow.Hidden = False And Range("$D$988").Value = "" And Range("$D$989").Value = "" _
    And Range("$D$990").Value = "" And Range("$D$991").Value = "" And Range("$D$992").Value = "" Then
    
    Range("D988:D992").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($D$988="""",$D$989="""",$D$990="""",$D$991="""",$D$992="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
'other one by one cells, like supplier code, name, etc
'''''    If Range("F605").EntireRow.Hidden = False And Range("F605").Value = "" Then
'''''        Range("F605").Select
'''''        Call if_selected_cell_blank_conditional_format
'''''        chk = "fail"
'''''    Else
'''''    End If

    If Range("F112:U112").EntireRow.Hidden = False Then
        If Range("F112").Value = "" Then
            Range("F112:U112").Select
            Call if_selected_cell_blank_conditional_format
            chk = "fail"
        Else
        End If
    Else
    End If
    
    If Range("F402:U402").EntireRow.Hidden = False Then
        If Range("F402").Value = "" Then
            Range("F402:U402").Select
            Call if_selected_cell_blank_conditional_format
            chk = "fail"
        Else
        End If
    Else
    End If
    
    
    If Range("P74:S74").EntireRow.Hidden = False Then
    If Range("P74").Value = "" Then
        Range("P74:S74").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F603:N603").EntireRow.Hidden = False Then
    If Range("F603").Value = "" Then
        Range("F603:N603").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F375:U375").EntireRow.Hidden = False Then
    If Range("F375").Value = "" Then
        Range("F375:U375").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F59:U59").EntireRow.Hidden = False Then
    If Range("F59").Value = "" Then
        Range("F59:U59").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If


    If Range("F143:U143").EntireRow.Hidden = False Then
    If Range("F143").Value = "" Then
        Range("F143:U143").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F168:U168").EntireRow.Hidden = False Then
    If Range("F168").Value = "" Then
        Range("F168:U168").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F194:U194").EntireRow.Hidden = False Then
    If Range("F194").Value = "" Then
        Range("F194:U194").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F213:U213").EntireRow.Hidden = False Then
    If Range("F213").Value = "" Then
        Range("F213:U213").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F223:I223").EntireRow.Hidden = False Then
    If Range("F223").Value = "" Then
        Range("F223:I223").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F233:I233").EntireRow.Hidden = False Then
    If Range("F233").Value = "" Then
        Range("F233:I233").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F265:U265").EntireRow.Hidden = False Then
    If Range("F265").Value = "" Then
        Range("F265:U265").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F483:U483").EntireRow.Hidden = False Then
    If Range("F483").Value = "" Then
        Range("F483:U483").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F502:U502").EntireRow.Hidden = False Then
    If Range("F502").Value = "" Then
        Range("F502:U502").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F527:U527").EntireRow.Hidden = False Then
    If Range("F527").Value = "" Then
        Range("F527:U527").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F550:U550").EntireRow.Hidden = False Then
    If Range("F550").Value = "" Then
        Range("F550:U550").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F573:U573").EntireRow.Hidden = False Then
    If Range("F573").Value = "" Then
        Range("F573:U573").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F428:U428").EntireRow.Hidden = False Then
    If Range("F428").Value = "" Then
        Range("F428:U428").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F454:U454").EntireRow.Hidden = False Then
    If Range("F454").Value = "" Then
        Range("F454:U454").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    '1
    If Range("F618:N618").EntireRow.Hidden = False Then
    If Range("F618").Value = "" Then
        Range("F618:N618").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    '2
    If Range("F632:N632").EntireRow.Hidden = False Then
    If Range("F632").Value = "" Then
        Range("F632:N632").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'3
    If Range("F645:N645").EntireRow.Hidden = False Then
    If Range("F645").Value = "" Then
        Range("F645:N645").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'4
    If Range("F658:N658").EntireRow.Hidden = False Then
    If Range("F658").Value = "" Then
        Range("F658:N658").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'5
    If Range("F671:N671").EntireRow.Hidden = False Then
    If Range("F671").Value = "" Then
        Range("F671:N671").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'Tax_configaration()

    If Range("F80,J80").EntireRow.Hidden = False Then
    Range("F80,J80").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($F$81:$M$81,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If

    If Range("F366,J366").EntireRow.Hidden = False Then
    Range("F366,J366").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($F$367:$N$367,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If



    If Range("E592:H592,K592:O592").EntireRow.Hidden = False Then
    Range("E592:H592,K592:O592").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($E$593:$N$593,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If


    If Range("E362,K362").EntireRow.Hidden = False Then
    Range("E362,K362").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($E$363:$O$363,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If


    If Range("E347,K347").EntireRow.Hidden = False Then
    Range("E347,K347").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($E$348:$Q$348,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If

'-------------------------------------------------------------------------
    'Appropreate vendor code
    Range("D62,G62,I62,M62,P62,S62,E62,H62,J62,K62,N62,Q62,T62,U62,R62").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($D$63:$U$63,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'--------------------------------------------------------------------------
'out side suuplier or inter company
    If Range("E53").EntireRow.Hidden = False Then
    If Application.WorksheetFunction.CountIf(Range("E54:H54"), True) < 1 Then
        'Range("F59:U59").Select
        'Call if_selected_cell_blank_conditional_format
        chk = "fail"
        
        Range("E53:J53").Select
        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
            "=COUNTIF($E$54:$I$54,TRUE)<1"
        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
        With Selection.FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 6750207
            .TintAndShade = 0
        End With
        Selection.FormatConditions(1).StopIfTrue = False
        
    Else
    End If
    Else
    End If

    'Appropreate vendor code

'---------------------------------------------------------------------------
'ERS Supplier or non ers supplier
    If Range("G64").EntireRow.Hidden = False Then
    If Application.WorksheetFunction.CountIf(Range("G65:K65"), True) < 1 Then
        'Range("F59:U59").Select
        'Call if_selected_cell_blank_conditional_format
        chk = "fail"
        
        Range("G64:J64").Select
        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
            "=COUNTIF($G$65:$J$65,TRUE)<1"
        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
        With Selection.FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 6750207
            .TintAndShade = 0
        End With
        Selection.FormatConditions(1).StopIfTrue = False
        
    Else
    End If
    Else
    End If

    'Appropreate vendor code

'---------------------------------------------------------------------------

If chk = "fail" Then

MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
Range("F20").Select

If mandatory = True And Range("G63").Value <> True Then Else Range("N26:Q51").FormatConditions.delete

Call Pro
Exit Sub
Else

End If




'till here go then, lets say validation has been completed

     'unhiding all sheets
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
     'Sheets("GM_IO_Form").Move Before:=Sheets(1)
   'Sheets("GM Europe Multiple BU &PO").Move Before:=Sheets(2)
        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub


subm = ThisWorkbook.Sheets("GM_IO_Form").Range("Q18").Value & " " & Range("F20").Value
DUN = Range("F57").Value & Range("F109").Value & Range("F140").Value & Range("F192").Value & Range("F211").Value & Range("F373").Value & Range("F399").Value & Range("F425").Value & Range("F452").Value & Range("F499").Value & Range("F525").Value & Range("F548").Value & Range("F571").Value
SUP = Range("F59").Value & Range("F112").Value & Range("F143").Value & Range("F168").Value & Range("F194").Value & Range("F213").Value & Range("F265").Value & Range("F375").Value & Range("F402").Value & Range("F428").Value & Range("F454").Value & Range("F483").Value & Range("F502").Value & Range("F527").Value & Range("F550").Value & Range("F573").Value

subj = subm + "-" + DUN + "-" + SUP


            WkbName = subj 'Range("q18").Value & " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array("<", ">", "|", "/", "*", "[", "]", "{", "}", "-", "\", "?", """")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName = Replace(WkbName, MyArray(x), "_", 1)
            Next x
            'MsgBox WkbName
        
            WkbName_first = mypath 'Range("I9").Value '& " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array(".xls", "xlsx")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName_first = Replace(WkbName_first, MyArray(x), "_", 1)
            Next x



'aw = Application.ActiveWorkbook.Path & "\"
   'tb = InputBox("give the file name", , any_Name)
 '  ta = tb & ".xls" '".pdf"
  ' tt = aw & ta
  pbn = ActiveWorkbook.Name
  
   Sheets(Array("Mass change")).Select
  ActiveWindow.SelectedSheets.Copy
  cbn = ActiveWorkbook.Name
  
  ActiveWorkbook.Sheets.Add Before:=Worksheets(1) ', Count:=3
  
  'sheets("Sheet
  'ActiveWorkbook.Worksheets.Add
  ActiveSheet.Name = "Form"
  
  On Error GoTo 0
  Windows(pbn).Activate
  Sheets("GM_IO_Form").Select
  Call UnPro
  'Range("A1:V3327").Select
'Selection.Copy
'Selection.SpecialCells(xlCellTypeVisible).Copy
'Range("A1:V3327")

''''''''''''''''''''''''''''''''''''

Range("W1:W1000").ClearContents
    Range("W1:W1000").SpecialCells(xlCellTypeVisible).FormulaR1C1 = "UN"
    Cells.Copy
    
Windows(cbn).Activate
Sheets("Form").Select
Range("A1").Select

'    Windows.Add
Application.DisplayAlerts = False
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveSheet.Paste

       ' Range("A1:W1").Insert Shift:=xlDown
''''    Range("A1:W1").FormulaR1C1 = " "
       ' Range("A1").Select
       ' Selection.AutoFilter
    
        Range("$A$1:$W$1000").Select
        Selection.AutoFilter
        ActiveSheet.Range("$A$1:$W$1000").AutoFilter Field:=23, Criteria1:="<>"
    
     '   Selection.AutoFilter , VisibleDropDown:=False
       ' ActiveSheet.Range("$A$1:$W$1000").AutoFilter Field:=23, VisibleDropDown:=False, Criteria1:="<>"
        ActiveWindow.ScrollRow = 1
        
        Selection.AutoFilter Field:=1, VisibleDropDown:=False
        Selection.AutoFilter Field:=22, VisibleDropDown:=False
     '   Selection.AutoFilter Field:=23, VisibleDropDown:=False
    '
      '  Range("W1").Select
''''    Do
''''    If ActiveCell.Value = "UN" Then ActiveCell.EntireRow.Hidden = False Else ActiveCell.EntireRow.Hidden = True
''''    ActiveCell.Offset(1, 0).Select
''''    If ActiveCell.Row >= 1000 Then Exit Do
''''
''''    Loop

    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Application.DisplayFormulaBar = False
    Range("A1").Select
    
    On Error Resume Next
    If Range("B1").Value = "" Then Range("A1").EntireRow.Hidden = True
    On Error GoTo 0
''''''''''''''''''''''''''''''''''''

'ActiveSheet.Paste
Range("A1").Select
Cells.FormatConditions.delete

           On Error Resume Next

'deleting irrelevent sheets from product
    'If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then Else Sheets("GM Europe Multiple BU &PO").Delete
    If Sheets("Form").Range("Q18").Value = "Mass changes" Then Else Sheets("Mass change").delete
        ' '========================
            On Error GoTo 0
            



        ActiveWorkbook.SaveAs (WkbName_first & " " & WkbName & ".xls"), FileFormat:=51
''
'''deleting unselected rows from GM multiple BU
''If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then '!!!
''        Sheets("GM Europe Multiple BU &PO").Select
''        Call UnPro
''        If ActiveSheet.Name = "GM Europe Multiple BU &PO" Then '!!
''
''                Range("D3").Select
''                Do
''                On Error GoTo ivd
''                If ActiveCell.Value = "" Then Exit Do
''                If ActiveCell.Value = "False" Then
''                ActiveCell.EntireRow.Delete
''                Else
''                ActiveCell.Offset(1, 0).Select
''                End If
''                Loop
''ivd:
''On Error GoTo 0
''        Range("A1").EntireRow.Delete
''        Range("A1").Select
''        On Error Resume Next
''        ActiveSheet.DrawingObjects("CheckEU1").Visible = False
''
''
''                Range(Range("B1048570").End(xlUp).Offset(1, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
''                Selection.EntireRow.Hidden = False
''                Range(Range("B1048570").End(xlUp).Offset(2, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
''                On Error Resume Next
'''                Selection.EntireRow.Hidden = True
''                'On Error GoTo 0
''                Dim s As Shape
''                On Error Resume Next
''                For Each s In ActiveSheet.Shapes
''
''                s.OnAction = ""
''                Next
''                On Error GoTo 0
'''''        ActiveSheet.Shapes.Visible = False
''''        ActiveSheet.Shapes.SelectAll
''''        Selection.ShapeRange.Visible = False
''        On Error GoTo 0
''        Call Pro
''        Else '!!
''        End If '!!
''Else '!!!
''End If '!!!
        'also you can give like left 10000 nos to eliminate xls from my path
        Sheets(1).Select
        

        
        'write here to alter form copy
   '         On Error Resume Next
'            ActiveSheet.DrawingObjects.Visible = False
           ' ActiveSheet.DrawingObjects.Delete
 '           ActiveSheet.DrawingObjects.Hide
  '          On Error GoTo 0
''    Call UnPro
''    Range("A1").Select
''    On Error Resume Next
ActiveWindow.SmallScroll up:=1000000
''          ActiveSheet.Shapes.Range(Array("Group 5", "CommandButton1", "CommandButton2", "CommandButton3", "CommandButton4", "submit")).Delete
''Range("a1:V3336").Locked = True
'''Range("Q3331").ClearContents
'Application.ScreenUpdating = False
On Error GoTo 0

On Error Resume Next

ActiveSheet.Shapes.SelectAll
'ActiveSheet.Shapes.OnAction = "nidhi"
Selection.OnAction = ""

'xxx

On Error Resume Next
For Each s In ActiveSheet.Shapes
s.OnAction = ""
Next

        'If ActiveSheet.Name = "Form" Then Range("F20:L20").Locked = True
        'If ActiveSheet.Name = "Form" Then Range("F10:L10").Locked = True
        'Range("F21:N21").ClearContents
        
    On Error GoTo 0
    

    
    
        Call Pro
        
        ActiveWorkbook.UpdateLinks = xlUpdateLinksNever
        
        'added for one mail project
        ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
        ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"
        Sheets("Form").Select
        ActiveSheet.Name = "Form_GBS"
        
        ActiveWorkbook.Save
        
        ffname = ActiveWorkbook.FullName
        fname = ActiveWorkbook.Name
        
        ActiveWorkbook.Close
        'MsgBox " Request Copy Has Been Saved as " & fname
        ' '============================
        tt1 = ffname
        
  '  .ExportAsFixedFormat Type:=xlTypexls, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  'End With
   
  
  
  
'''abu added=======================================================================================
''                 'Sheets("ORD").Select (False)
''                  'Sheets("Standardchanges").Select (False)
''                  ActiveWindow.SelectedSheets.Copy
''
''                  Application.StatusBar = False
''
''                    Dim appXL As New Excel.Application
''    Dim MyDate
''    MyDate = Date    ' MyDate contains the current system date.
''    Dim MyTime
''    MyTime = Time    ' Return current system time.
''    Dim TestStr As String
''    TestStr = Format(MyTime, "hh.mm.ss")
''    Dim Test1Str As String
''    Test1Str = Format(MyDate, "DD-MM-YYYY")
''
''    Application.DisplayAlerts = False
''    'MsgBox ActiveWorkbook.Name
''
''    ActiveWorkbook.SaveAs Filename:="C:\STD Changes\Bank\" & ree & " " & Test1Str & " " & TestStr & " " & ".xlsx" 'ActiveWorkbook.name
''    'ActiveWorkbook.SaveAs Filename:="C:\Std Changes\RAW DATA\" & "Test"
''    ActiveWorkbook.Save
''    bn = ActiveWorkbook.FullName
'''abu added=====================================================================================
  ' Call page

'Next i
'Else
Windows(pbn).Activate

Sheets("GM_IO_Form").Select
Range("A1").Select
Call UnPro

''
If UserForm3.OptionButton1.Value = True Then

Dim rng As Range
Set rng = Nothing

Set rng = Sheets("GM_IO_Form").Range("A9:W23").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)


subj = subm + "-" + DUN + "-" + SUP
With OutMail
    .To = Range("I6").Value & ";" & Range("C6").Value ' & ";" & Range("F14").Value
    .cc = Range("F14").Value
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
'    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
'  If Sheets("GM_IO_Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value <> 0 Then
'  Sheets("GM Europe Multiple BU &PO").Select
'  Range("A1").Select
'  Selection.AutoFilter
 ' End If
 
Else
'        If ActiveSheet.OptionButton2.Value = True Then MsgBox "Form has been saved in the below Directory " _
'        & vbNewLine & vbNewLine & vbNewLine & ffname
    'If UserForm3.OptionButton2.Value = True Then
MsgBox "Form has been saved in the below Directory " & vbNewLine & vbNewLine & vbNewLine & ffname
aska = MsgBox("Do you wan to open the Generated Form?", vbYesNo)
    If aska = 6 Then
    Application.DisplayAlerts = False
    Workbooks.Open (ffname)
    
    Else
        MsgBox "Finished..!", vbInformation
    End If
Application.DisplayAlerts = True
Exit Sub
End If

'''       For I = 3 To Sheets.Count
'''     Sheets(I).Visible = 2
'''     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM_IO_Form").Select
     Call Pro
     Application.ScreenUpdating = True
     MsgBox "Finished..!", vbInformation
     Application.DisplayAlerts = True
    Application.UseSystemSeparators = True
End Sub



Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM EU Form").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function






Attribute VB_Name = "GM_NA_Functions"
Sub GM_NA_vendorcatogery_and_its_checkboxes()

Call UnPro
Range("A64:A66").EntireRow.Hidden = False
'Range("A64:A73").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                     
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

                    xrow = 65
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 62
''''''                    ycolumn = "B"
''''''                    Zlinked = ycolumn & xrow + 1
''''''                    'oonaction = "vendercatogery_multiple_select_control"
''''''                    nname = "pv"
''''''
''''''
''''''                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
''''''                                                                    Cells(xrow, ycolumn).Top, _
''''''                                                                    80, 17).Select
''''''
''''''                                        With Selection
''''''                                            .Caption = ""
''''''                                            .Value = xlOff '
''''''                                            .LinkedCell = Zlinked
''''''                                            .Display3DShading = True
''''''                                    '        .lock = False
''''''                                            .Name = nname
''''''                                            .OnAction = oonaction
''''''
''''''                                  End With

                    'xrow = 62
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select

                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 62
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    'xrow = 62
                    ycolumn = "N"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 62
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 62
                    ycolumn = "S"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("F20").Select
End Sub

Sub GM_NA_vendercatogery_multiple_select_control()

Call UnPro
Dim iVal As Integer
Call Delete_unnecessary_checkboxes
iVal = Application.WorksheetFunction.CountIf(Range("E66:T66"), True)

'valide GM BU has to be selected
If Range("F20").Value = "" Then
MsgBox "Please select a valid GM Business Unit", vbInformation
    Range("E66").Value = False
    Range("H66").Value = False
    Range("K66").Value = False
    Range("N66").Value = False
    Range("P66").Value = False
    Range("S66").Value = False
Call Pro
Exit Sub
End If

'if incase selecting more than one vendor at a time
If iVal > 1 Then
    'Range("B66").Value = False
    Range("E66").Value = False
    Range("H66").Value = False
    Range("K66").Value = False
    Range("N66").Value = False
    Range("P66").Value = False
    Range("S66").Value = False
    MsgBox "More than one vendor categories can not be selected at a time", vbExclamation
    

Else
        'for finance vendors, inco term is not required, and its text too
        Call incoterm_and_text_for_finance_vendors
        Call GM_service_provider_us_nu
End If

'If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then 'And Range("P64").Value = False Then
    
    Range("A354:A422").EntireRow.Hidden = True

        'inter co true then
        If Range("S66").Value = True Then
        Range("A69:A71").EntireRow.Hidden = False
        Else
        Range("A69:A71").EntireRow.Hidden = True
        End If
        
        
        'finance and service vendor true then
        If Range("K66").Value = True Or Range("H66").Value = True Then
        Range("A67:A69").EntireRow.Hidden = False
        Range("A76").EntireRow.Hidden = False
        
        Else
        Range("A67:A69").EntireRow.Hidden = True
        End If

        'tire2 vendor true then
        If Range("N66").Value = True Then
        Range("B76:B79").EntireRow.Hidden = True
        Range("B114:B118").EntireRow.Hidden = True
        

        Range("A261:A331,A351:A429").EntireRow.Hidden = True
        Range("A235:A262").EntireRow.Hidden = True
        
        'Range("A310:A331").EntireRow.Hidden = False
        
        'A619:A647
        Range("A619:A647").EntireRow.Hidden = False
        Range("A565:A569").EntireRow.Hidden = True
        
        Call GM_NA_DCB
        'Call purchasing_vendor_ERS_category
        Else

        
        Range("A546:A552").EntireRow.Hidden = False
        Range("A565:A569").EntireRow.Hidden = False
        
         Range("A619:A647").EntireRow.Hidden = True
        Range("A235:A262").EntireRow.Hidden = False

        Call EFTCheque_GM_NA_for_banking_details
        Range("A261:A263").EntireRow.Hidden = False
        Call GM_NA_remi_ship_header
        
        Call GM_NA_DCB
        Range("B114:B118").EntireRow.Hidden = False
                            'On Error Resume Next
                            'ActiveSheet.CheckBoxes("ERSpv").Delete
                            'ActiveSheet.CheckBoxes("ERSpv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
        
                            'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
         '                   On Error GoTo 0
        'multiple business unit for applied Vendor Catogeries
        'If Range("B66").Value = True Or
        'Range("K66").Value = True Or _
        'Range("S66").Value = True
        
        If Range("E66").Value = True Or _
        Range("H66").Value = True Or _
        Range("P66").Value = True Then
         Range("A546:A552").EntireRow.Hidden = True
        
        
                If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then
                MsgBox "Please update a valid GM Business Unit from 'GM_Multiple_BU' tab"
                mm = ActiveSheet.Name
                Call Pro
                Sheets("GM_NA_Multiple_BU").Visible = True
                Sheets("GM_NA_Multiple_BU").Select
                Sheets("Index").Range("C1").Value = mm
                Else
                                If Range("F20").Value = "See Mass Change tab" Then Else Range("B76:B79").EntireRow.Hidden = False
                    'Call Pro
                End If
            
        Else
        Range("B76:B79").EntireRow.Hidden = True
        Range("A546:A552").EntireRow.Hidden = True
        
        End If
        End If
        
If Range("K66").Value = True Or Range("H66").Value = True Then Range("A76").EntireRow.Hidden = False
        
        If ActiveSheet.Name = "GM_NA" Then Call Pro
'''If Range("E66").Value = True Or _
'''Range("H66").Value = True Or _
'''Range("K66").Value = True Or _
'''Range("P66").Value = True Or _
'''Range("S66").Value = True Then
'''Else
'''Range("B76:B79").EntireRow.Hidden = True
'''End If


End Sub

Sub GM_NA_Additional_banking_information()

If Range("E353").Value = True And Range("K353").Value = True Then
MsgBox "Please select a valid mode of payment"
Range("E353").Value = False
Range("K353").Value = False
'Exit Sub
Else

''    If Range("E353").Value = True Or Range("K353").Value = True Then
''    Call UnPro
''    Range("A354:A422").EntireRow.Hidden = True
''
''    End If

End If

'Range("A368:A422").EntireRow.Hidden = True
Call UnPro
On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
On Error GoTo 0

'Range("A354:A422").EntireRow.Hidden = True

If Range("E353").Value = True Then
Call GM_NA_Bank_plus_chkbx
Range("A448:A461").EntireRow.Hidden = False
Range("A546:A552").EntireRow.Hidden = False
'Call Pro
Else
Range("A546:A552").EntireRow.Hidden = True
Range("A354:A422").EntireRow.Hidden = True
Range("A448:A461").EntireRow.Hidden = True
End If

If Range("K353").Value = True Then
Range("A546:A552").EntireRow.Hidden = True
Range("A546:A552").EntireRow.Hidden = True
Else

End If

Call Pro
End Sub

Sub GM_NA_additional_bank_required_field()

Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("G367:S367"), True)

If iVal > 1 Then

Range("G367").Value = False
Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False
MsgBox ("Only 5 additional banks can be added maximum")
Else
End If

Range("A368:A422").EntireRow.Hidden = True
'1
If Range("G367").Value = True Then
Range("A368:A378").EntireRow.Hidden = False
Else
End If
'2
If Range("J367").Value = True Then
Range("A368:A389").EntireRow.Hidden = False
Else
End If
'3
If Range("M367").Value = True Then
Range("A368:A400").EntireRow.Hidden = False
Else
End If
'4
If Range("P367").Value = True Then
Range("A368:A411").EntireRow.Hidden = False
Else
End If
'5
If Range("S367").Value = True Then
Range("A368:A422").EntireRow.Hidden = False
Else
End If
Call Pro
End Sub


Sub GM_NA_remi_ship_header()

If Range("A261").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete

'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 261
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_remi_ship_header_slection" '"purchasing_vendor_ERS_category"
                    nname = "RSH"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 261
                    ycolumn = "M"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    'nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With


                    'xrow = 261
                    ycolumn = "R"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    'nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With


'''                    'xrow = 261
'''                    ycolumn = "P"
'''                    Zlinked = ycolumn & xrow + 1
'''                    oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
'''                    'nname = "pv"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
'''                                                                    Cells(xrow, ycolumn).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Zlinked
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = nname
'''                                            .OnAction = oonaction
'''
'''                                  End With

Range("R259").Select
Else
End If
End Sub

Sub GM_NA_remi_ship_header_slection()
'remi
Call UnPro
If Range("H262").Value = True Then
Range("A263:A285").EntireRow.Hidden = False
Else
Range("A263:A285").EntireRow.Hidden = True
End If


If Range("M262").Value = True Then
        If Range("Q18").Value = "New Duns creation" And Range("F69").Value = "Yes" Then
        Range("M262").Value = False
        Range("A286:A309").EntireRow.Hidden = True
        MsgBox "Not applicable for DOA/EPS Vendors"
        Else
        Range("A286:A309").EntireRow.Hidden = False
        End If
Else
Range("A286:A309").EntireRow.Hidden = True
End If

If Range("R262").Value = True Then
    If Range("Q18").Value = "New Duns creation" And Range("F69").Value = "Yes" Then
        Range("R262").Value = False
        Range("A310:A331").EntireRow.Hidden = True
        MsgBox "Not applicable for DOA/EPS Vendors"
    Else
    Range("A310:A331").EntireRow.Hidden = False
    End If
Else
Range("A310:A331").EntireRow.Hidden = True
End If

Call GM_NA_DCB

Call Pro
End Sub

Sub GM_NA_bank_ac_maintanance_checkbox()

If Range("G42").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("BAM").delete
ActiveSheet.CheckBoxes("BAM").delete
ActiveSheet.CheckBoxes("BAM").delete
ActiveSheet.CheckBoxes("BAM").delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 42
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_BAM_Add" '"purchasing_vendor_ERS_category"
                    nname = "BAM"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 261
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_BAM_Change" '"purchasing_vendor_ERS_category"
                    'nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 261
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_BAM_Delete" '"purchasing_vendor_ERS_category"
                    'nname = "pv"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With

                    xrow = 43
                    ycolumn = "C"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    'nname = "pv"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Range("R259").Select
Else
End If
End Sub

Sub GM_NA_BAM_Add()
'document
'banking
'comment
Call UnPro

Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("H43:P43"), True)

If iVal > 1 Then

Range("H43").Value = False
Range("K43").Value = False
Range("P43").Value = False
'Range("P367").Value = False
'Range("S367").Value = False
MsgBox ("Please select a valid Maintanace, only one at a time"), vbExclamation
Else
End If

If Range("H43").Value = True Or Range("P43").Value = True Then
'Range("A46:A52").EntireRow.Hidden = False

Range("A546:A552").EntireRow.Hidden = False
Range("A565:A569").EntireRow.Hidden = False

Range("A354:A367").EntireRow.Hidden = False
Range("A354:A367").EntireRow.Hidden = False

Call GM_NA_Bank_plus_chkbx
Range("A546:A552,A565:A569").EntireRow.Hidden = False
Range("A448:V461").EntireRow.Hidden = False

Else

'Range("A46:A52").EntireRow.Hidden = true
Range("A546:A552").EntireRow.Hidden = True
'Range("A565:A569").EntireRow.Hidden = True

Range("A354:A367").EntireRow.Hidden = True
Range("A354:A422,A546:A552").EntireRow.Hidden = True
Range("A448:V461").EntireRow.Hidden = True
On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
On Error GoTo 0
End If


If Range("K43").Value = True Then

Range("A473:A500").EntireRow.Hidden = False
'Range("A500:A525").EntireRow.Hidden = False
Range("A546:A552").EntireRow.Hidden = False
'Range("A565:A569").EntireRow.Hidden = False
Call BAMAdd_additional_bank_for_change

Else

On Error Resume Next
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
On Error GoTo 0

Range("A473:A525").EntireRow.Hidden = True
'Range("A500:A525").EntireRow.Hidden = True
'Range("A546:A552").EntireRow.Hidden = True
'Or Range("K43").Value = True
End If

Call Pro
End Sub

Sub GM_NA_BAM_Change()
'document
'banking
'comment
End Sub

Sub GM_NA_BAM_Delete()
'document
'banking
'comment
End Sub

Sub GM_NA_Modified_P_term_checkbox()

If Range("F128").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("MPT").delete
ActiveSheet.CheckBoxes("MPT").delete
ActiveSheet.CheckBoxes("MPT").delete
ActiveSheet.CheckBoxes("MPT").delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 128
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    xrow = 128
                    ycolumn = "I"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Range("R259").Select
Else
End If
End Sub

Sub GM_NA_E_Mail_ID_setup_checkbox()

If Range("A543").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete

'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 543
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    nname = "EIDS"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    'xrow = 128
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    'nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    'xrow = 128
                    ycolumn = "N"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    'nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With

Range("F20").Select
Else
End If
End Sub


Sub GM_NA_BU_checkboxes()
Application.ScreenUpdating = False
Sheets("GM_NA_Multiple_BU").Select
Call clear_all_checkbox
ycolumn = "B"
oonaction = "runnothing" '"purchasing_vendor_ERS_category"
nname = "GM_NA_BU"

Range("C7").Select

Do

                    xrow = ActiveCell.Offset(0, -1).Row
                    Zlinked = "C" & xrow ' + 1

                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    33, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
ActiveCell.Offset(1, 0).Select
If ActiveCell.Offset(0, -1).Value = "" Then Exit Do
Loop
End Sub

Sub EFTCheque_GM_NA_for_banking_details()
Call UnPro
Range("A351:A353").EntireRow.Hidden = False
Range("A354:A367").EntireRow.Hidden = True
    
On Error Resume Next
'to delete all checkbox related to EFT/check
ActiveSheet.CheckBoxes("EFTpayment").delete
ActiveSheet.CheckBoxes("Chequepayment").delete

On Error GoTo 0

                    xrow = 352 '347
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_Additional_banking_information"
                    nname = "EFTpayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With


                    'xrow = 347
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "eft_cheque_check"
                    nname = "Chequepayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                End With


'Call Pro
End Sub















Sub Delete_unnecessary_checkboxes()
Call UnPro
On Error Resume Next
'to delete all checkbox related to additional banking details
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete

'to delete all checkbox related to EFT/check
ActiveSheet.CheckBoxes("EFTpayment").delete
ActiveSheet.CheckBoxes("Chequepayment").delete

'to delete all checkbox related to remittance/shipfrom/heder/ordering DUNS
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
On Error GoTo 0
End Sub

Sub clear_all_field_GM_NA()
'headers
Application.ScreenUpdating = False
'Range("F10:L10").ClearContents
'Range("Q10:U10").ClearContents
'Range("F12:L12").ClearContents
'Range("Q12:U12").ClearContents
'Range("F14:L14").ClearContents
'Range("Q14:U14").ClearContents
'Range("Q18:U18").ClearContents
'Range("F20:L20").ClearContents
'Range("Q20:U20").ClearContents
'Range("F21:N21").ClearContents
Range("F26:I26").ClearContents
Range("F28:U28").ClearContents
Range("F30").ClearContents
Range("F32:N32").ClearContents
Range("F34:N34").ClearContents
Range("F38:I38").ClearContents
Range("F40:U40").ClearContents
Range("G42").ClearContents
Range("J42").ClearContents
Range("O42").ClearContents
'Range("F43").ClearContents
Range("H43").ClearContents
Range("K43").ClearContents
Range("P43").ClearContents
'Range("C44").ClearContents
'Range("F44").ClearContents
Range("D47").ClearContents
Range("D48").ClearContents
Range("D49").ClearContents
Range("D50").ClearContents
Range("D51").ClearContents
Range("F55:U55").ClearContents
Range("F57:U57").ClearContents
Range("F59:I59").ClearContents
Range("L59:O59").ClearContents
Range("S59:U59").ClearContents
Range("F61:J61").ClearContents
Range("N61:U61").ClearContents
Range("B66").ClearContents
Range("E66").ClearContents
Range("H66").ClearContents
Range("K66").ClearContents
Range("N66").ClearContents
Range("P66").ClearContents
Range("S66").ClearContents
Range("E70:F70").ClearContents
Range("L70:M70").ClearContents
Range("Q70").ClearContents
'Range("F115:I115").ClearContents
'Range("P115:S115").ClearContents
'Range("F117:I117").ClearContents
'Range("P117:S117").ClearContents


Range("E115:F115").ClearContents
Range("J115:M115").ClearContents
'Range("O115:T115").ClearContents
Range("E117:L117").ClearContents
'Range("O117:U117").ClearContents




Range("F121:U121").ClearContents
Range("F123:U123").ClearContents
Range("F126:L126").ClearContents
Range("P126:U126").ClearContents
Range("F129").ClearContents
Range("I129").ClearContents
Range("F130:U130").ClearContents
Range("F133:L133").ClearContents
Range("P133:U133").ClearContents
Range("F135:U137").ClearContents
Range("F140:L140").ClearContents
Range("F142:U144").ClearContents
'Range("F147").ClearContents
Range("H148").ClearContents
Range("K148").ClearContents
Range("N148").ClearContents
Range("F149:N149").ClearContents
Range("F151:N151").ClearContents
Range("F154:I154").ClearContents
Range("F156:L156").ClearContents
Range("F158:U160").ClearContents
Range("F163:U165").ClearContents
Range("F168:U170").ClearContents
Range("F173:L173").ClearContents
Range("F176:U176").ClearContents
Range("F178:U178").ClearContents
Range("F180:L180").ClearContents
Range("F182:U182").ClearContents
Range("F184:U184").ClearContents
Range("F186:U186").ClearContents
Range("F188:U188").ClearContents
Range("F190:U190").ClearContents
Range("F194:L194").ClearContents
Range("F197:U197").ClearContents
Range("F199:U199").ClearContents
Range("F201:L201").ClearContents
Range("F203:U203").ClearContents
Range("F205:U205").ClearContents
Range("F207:U207").ClearContents
Range("F209:U209").ClearContents
Range("F211:U211").ClearContents
Range("F215:L215").ClearContents
Range("F218:U218").ClearContents
Range("F220:U220").ClearContents
Range("F222:L222").ClearContents
Range("F224:U224").ClearContents
Range("F226:U226").ClearContents
Range("F228:U228").ClearContents
Range("F230:U230").ClearContents
Range("F232:U232").ClearContents
Range("F236:L236").ClearContents
Range("M236").ClearContents
Range("F239:U239").ClearContents
Range("F241:U241").ClearContents
Range("F243:U243").ClearContents
Range("F245:J245").ClearContents
'Range("M245:U245").ClearContents

Range("M245:P245").ClearContents
Range("R245:U245").ClearContents


Range("F247:J247").ClearContents
Range("M247:P247").ClearContents
Range("S247:U247").ClearContents
Range("F249:J249").ClearContents
Range("M249:U249").ClearContents
Range("F251:J251").ClearContents
Range("M251:P251").ClearContents
Range("R251:U251").ClearContents
Range("F253:N253").ClearContents
Range("F255:N255").ClearContents
Range("F257:L257").ClearContents
Range("N257:U257").ClearContents
Range("F259:L259").ClearContents
Range("H262").ClearContents
Range("M262").ClearContents
Range("R262").ClearContents
Range("F265:L265").ClearContents
Range("F268:U268").ClearContents
Range("F270:U270").ClearContents
Range("F272:J272").ClearContents
Range("M272:U272").ClearContents
Range("F274:J274").ClearContents
Range("M274:P274").ClearContents
Range("S274:U274").ClearContents
Range("F276:J276").ClearContents
Range("M276:U276").ClearContents
Range("F278:J278").ClearContents
Range("M278:P278").ClearContents
Range("R278:U278").ClearContents
Range("F280:U280").ClearContents
Range("F282:L282").ClearContents
Range("N282:U282").ClearContents
Range("F284:U284").ClearContents
Range("F287:L287").ClearContents
Range("F290:U290").ClearContents
Range("F292:U292").ClearContents
Range("F294:J294").ClearContents
Range("M294:U294").ClearContents
Range("F296:J296").ClearContents
Range("M296:P296").ClearContents
Range("S296:U296").ClearContents
Range("F298:J298").ClearContents
Range("M298:U298").ClearContents
Range("F300:J300").ClearContents
Range("M300:P300").ClearContents
Range("R300:U300").ClearContents
Range("F302:I302").ClearContents
Range("F304:U304").ClearContents
Range("F306:L306").ClearContents
Range("N306:U306").ClearContents
Range("F308:U308").ClearContents
Range("F311:L311").ClearContents
Range("F314:U314").ClearContents
Range("F316:U316").ClearContents
Range("F318:J318").ClearContents
Range("M318:U318").ClearContents
Range("F320:J320").ClearContents
Range("M320:P320").ClearContents
Range("S320:U320").ClearContents
Range("F322:J322").ClearContents
Range("M322:U322").ClearContents
Range("F324:J324").ClearContents
Range("M324:P324").ClearContents
Range("R324:U324").ClearContents
Range("F326:U326").ClearContents
Range("F328:L328").ClearContents
Range("N328:U328").ClearContents
Range("F330:U330").ClearContents
Range("F333:L333").ClearContents
Range("F336:U336").ClearContents
Range("F338:U338").ClearContents
Range("F340:J340").ClearContents
Range("M340:U340").ClearContents
Range("F342:J342").ClearContents
Range("M342:P342").ClearContents
Range("S342:U342").ClearContents
Range("F344:J344").ClearContents
Range("M344:U344").ClearContents
Range("F346:U346").ClearContents
Range("E348").ClearContents
Range("F348:L348").ClearContents
Range("N348:U348").ClearContents
Range("F350:U350").ClearContents
Range("E353").ClearContents
Range("K353").ClearContents
Range("F357:M357").ClearContents
Range("P357:Q357").ClearContents
Range("T357:U357").ClearContents
Range("F359:U359").ClearContents
Range("F361:I361").ClearContents
Range("L361:O361").ClearContents
Range("R361:U361").ClearContents
Range("F363:O363").ClearContents
Range("R363:U363").ClearContents
Range("F365:O365").ClearContents
Range("G367").ClearContents
Range("J367").ClearContents
Range("M367").ClearContents
Range("P367").ClearContents
Range("S367").ClearContents
'Range("V367").ClearContents
'Range("E368").ClearContents
Range("F369:M369").ClearContents
Range("P369:Q369").ClearContents
Range("T369:U369").ClearContents
Range("F371:U371").ClearContents
Range("F373:I373").ClearContents
Range("L373:O373").ClearContents
Range("R373:U373").ClearContents
Range("F375:O375").ClearContents
Range("R375:U375").ClearContents
Range("F377:O377").ClearContents
'Range("E379").ClearContents
Range("F380:M380").ClearContents
Range("P380:Q380").ClearContents
Range("T380:U380").ClearContents
Range("F382:U382").ClearContents
Range("F384:I384").ClearContents
Range("L384:O384").ClearContents
Range("R384:U384").ClearContents
Range("F386:O386").ClearContents
Range("R386:U386").ClearContents
Range("F388:O388").ClearContents
'Range("E390").ClearContents
Range("F391:M391").ClearContents
Range("P391:Q391").ClearContents
Range("T391:U391").ClearContents
Range("F393:U393").ClearContents
Range("F395:I395").ClearContents
Range("L395:O395").ClearContents
Range("R395:U395").ClearContents
Range("F397:O397").ClearContents
Range("R397:U397").ClearContents
Range("F399:O399").ClearContents
'Range("E401").ClearContents
Range("F402:M402").ClearContents
Range("P402:Q402").ClearContents
Range("T402:U402").ClearContents
Range("F404:U404").ClearContents
Range("F406:I406").ClearContents
Range("L406:O406").ClearContents
Range("R406:U406").ClearContents
Range("F408:O408").ClearContents
Range("R408:U408").ClearContents
Range("F410:O410").ClearContents
'Range("E412").ClearContents
Range("F413:M413").ClearContents
Range("P413:Q413").ClearContents
Range("T413:U413").ClearContents
Range("F415:U415").ClearContents
Range("F417:I417").ClearContents
Range("L417:O417").ClearContents
Range("R417:U417").ClearContents
Range("F419:O419").ClearContents
Range("R419:U419").ClearContents
Range("F421:O421").ClearContents
Range("D424").ClearContents
Range("D425").ClearContents
Range("D426").ClearContents
Range("D427").ClearContents
Range("D428").ClearContents
Range("F431:N431").ClearContents
Range("F433:N433").ClearContents
Range("F435:J435").ClearContents
Range("M435:U435").ClearContents
Range("F437:U437").ClearContents
Range("F439:U440").ClearContents
Range("F443:U445").ClearContents

Range("E476:J476,E478:J478,E480:H480,E482:J482,E484:J484,E486:J486,E488:H488,E490:J490,E493:J493,E494:J494,E495:J495,E497:G497,I497:J497,N497:P497,R497:U497,N495:S495,N494:S494,N493:S493,N490:U490,N488:Q488,N486:U486,N484:U484,N482:U482,N480:Q480,N478:U478").Select
Range("N476:U476,E476:J476,E478:J478,N478:U478").ClearContents
Range("E503:J503,E505:J505,E507:H507,E509:J509,E511:J511,E513:J513,E515:H515,E517:J517,E520:J520,E521:J521,E522:J522,E524:G524,I524:J524,N503:U503,N505:U505,N507:Q507,N509:U509,N511:U511,N513:U513,N515:Q515,N517:U517,N520:S520,N521:S521,N522:S522,N524:P524").ClearContents
Range("R524:U524,D547:D551,F566:U568").ClearContents

Range("F673:L673,F675:R675").ClearContents
Range("F686:L686,F688:L688,F690:U690,F692:U692,F694:U694,F696:L696,P696:U696,F698:L698,P698:U698,F701:R701,F703:L703,I711,F713:U713,F715:L715,P715:U715,F717:L717,P717:U717").ClearContents
Range("F723:L723,Q723:U723,F725:L725,F727:L727,F729:L729,F731:L731,F734:U736,F739:U741,F745:U747").ClearContents
'Range("F712:L712,Q712:U712,F714:L714,F716:L716,F718:L718,F720:L720,F723:U725").Select
'Range("F729:H729,F731:L731,F733:L733,F735:L735,F737:L737,F739:U741,F745:U747").Select



End Sub

Sub GM_NA_DCB()

Call UnPro
        If Range("F236").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(236, "M").Left, _
                                                Cells(236, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 236
                        .Display3DShading = True
                        .Name = "gg"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete

                    On Error GoTo 0
        End If
 '2
      If Range("F265").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg1").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(265, "M").Left, _
                                                Cells(265, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 265
                        .Display3DShading = True
                        .Name = "gg1"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg1").delete
                    ActiveSheet.CheckBoxes("gg1").delete
                    On Error GoTo 0
        End If
'3
      If Range("F287:L287").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg2").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(287, "M").Left, _
                                                Cells(287, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 287
                        .Display3DShading = True
                        .Name = "gg2"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg2").delete
                    ActiveSheet.CheckBoxes("gg2").delete
                    On Error GoTo 0
        End If

'4
      If Range("F311:L311").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg3").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(311, "M").Left, _
                                                Cells(311, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 311
                        .Display3DShading = True
                        .Name = "gg3"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg3").delete
                    ActiveSheet.CheckBoxes("gg3").delete
                    On Error GoTo 0
        End If

'5
      If Range("F173:L173").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg4").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(173, "M").Left, _
                                                Cells(173, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 173
                        .Display3DShading = True
                        .Name = "gg4"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg4").delete
                    ActiveSheet.CheckBoxes("gg4").delete
                    On Error GoTo 0
        End If


'Call Pro
End Sub
Sub GM_NA_Bank_plus_chkbx()

Range("A354:A367").EntireRow.Hidden = False
'Range("A546:A552").EntireRow.Hidden = False

'Range("A594:A674").EntireRow.Hidden = False


'1st bank
                    xrow = 366
                    ycolumn = "G"
                    Zlinked = ycolumn & xrow + 1
                    nname = "adbank"
                    oonaction = "GM_NA_additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'2nd bank
                    'xrow = 607
                    ycolumn = "J"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank2m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'3rd bank
                    'xrow = 607
                    ycolumn = "M"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank3m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

'4th bank
                    'xrow = 607
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank4m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'5th bank
                    'xrow = 607
                    ycolumn = "S"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "additional_bank_required_field"
                    'nname = "adbank5n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'bank giro
     '               xrow = 335
      '              ycolumn = "N"
'                    Zlinked = ycolumn & xrow + 1
'                    oonaction = "runnothing"
                    'nname = "adbank5n"
                    
 '
  '                                      ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
   '                                                                 Cells(xrow, ycolumn).Top, _
    '                                                                80, 17).Select
     '                                   With Selection
      ''                                      .Caption = ""
        '                                    .Value = xlOff '
         '                                   .LinkedCell = Zlinked
          '                                  .Display3DShading = True
           '                         '        .lock = False
            '                                .Name = nname
             '                               .OnAction = oonaction
                                        
              '                    End With

'post giro
                    'xrow = 607
     '               ycolumn = "R"
      '              Zlinked = ycolumn & xrow + 1
       '             'oonaction = "additional_bank_required_field"
        '            'nname = "adbank5n"
         '
          '
           '                             ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
            '                                                        Cells(xrow, ycolumn).Top, _
             '                                                       80, 17).Select
              '                          With Selection
               '                             .Caption = ""
                '                            .Value = xlOff '
                 '                           .LinkedCell = Zlinked
                  '                          .Display3DShading = True
                   '                 '        .lock = False
                    '                        .Name = nname
                     '                       .OnAction = oonaction
                                        
                      '            End With
'
Range("F365").Select

End Sub





Sub incoterm_and_text_for_finance_vendors()

Call UnPro
If Range("K66").Value = True Then
'Range("F236").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
Range("O115").Value = ""
Range("O117").Value = ""
    With Range("O115:T115,O117:U117").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("O115:T115,O117:U117").Locked = True

'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("O115:T115,O117:U117").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O115:T115,O117:U117").Locked = False


    
End If
'Call Pro
End Sub

Sub GM_service_provider_us_nu()

'If Range("F67:H67").EntireRow.Hidden = flase Then

Call UnPro
Range("F67:H67").Value = ""
If Range("B67").Value = "US" Then

'to editable
    With Range("F67:H67").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F67:H67").Locked = False

Else

'non editable
    With Range("F67:H67").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    Range("F67:H67").Locked = True
    
End If

End Sub

Sub BAMAdd_additional_bank_for_change()

On Error Resume Next
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete

On Error GoTo 0

If Range("K43").Value = True Then

                    xrow = 499
                    ycolumn = "D"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_BAMAdd_Add"
                    nname = "BAMAdd"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("E497").Select
Else
End If
End Sub


Sub GM_NA_BAMAdd_Add()
Call UnPro
If Range("D500").Value = True Then
Range("A501:A525").EntireRow.Hidden = False
Else
Range("A501:A525").EntireRow.Hidden = True
End If

Call Pro
End Sub


Sub ms()
        
        If Range("I711").Value = "" Then Exit Sub
        
        Call UnPro
        'If Range("I711").Value = "Yes" Then Range("A713:A720").EntireRow.Hidden = True
        
        If Range("I711").Value = "No" Then
        Range("A713:A720").EntireRow.Hidden = False
        Else
        Range("A713:A720").EntireRow.Hidden = True
        End If
        
        Call Pro

End Sub










Attribute VB_Name = "GM_NA_Validation_n_Submit"
Sub Kudhal_GM_NA()
'Exit Sub
Application.DisplayAlerts = False
'Application.UseSystemSeparators = False
'Application.ThousandsSeparator = ","
'Application.DecimalSeparator = "."

Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object
Dim aw As String
Dim gmnachk
Application.ScreenUpdating = False
Sheets("GM_NA").Activate
Call UnPro


Call format_condition_for_all_reasons_for_mandatory_field

'header
If Range("F10:L10").EntireRow.Hidden = False And Range("F10").Value = "" Then gmnachk = "failed"
If Range("F14:L14").EntireRow.Hidden = False And Range("F14").Value = "" Then gmnachk = "failed"
If Range("Q18:U18").EntireRow.Hidden = False And Range("Q18").Value = "" Then gmnachk = "failed"
If Range("F20:L20").EntireRow.Hidden = False And Range("F20").Value = "" Then gmnachk = "failed"

If Sheets("GM_NA").Range("q18").Value = "New Duns creation" Then
'new creation
If Range("B65").EntireRow.Hidden = False And Range("B65").Value = "" Then gmnachk = "failed"
If Range("E115:F115").EntireRow.Hidden = False And Range("E115").Value = "" Then gmnachk = "failed"
If Range("J115:M115").EntireRow.Hidden = False And Range("J115").Value = "" Then gmnachk = "failed"
If Range("V115").EntireRow.Hidden = False And Range("V115").Value = "" Then gmnachk = "failed"
If Range("E117:L117").EntireRow.Hidden = False And Range("E117").Value = "" Then gmnachk = "failed"
If Range("F236:L236").EntireRow.Hidden = False And Range("F236").Value = "" Then gmnachk = "failed"
If Range("F239:U239").EntireRow.Hidden = False And Range("F239").Value = "" Then gmnachk = "failed"
If Range("F243:U243").EntireRow.Hidden = False And Range("F243").Value = "" Then gmnachk = "failed"
If Range("F245:J245").EntireRow.Hidden = False And Range("F245").Value = "" Then gmnachk = "failed"

If Range("M245:P245").EntireRow.Hidden = False And Range("M245").Value = "" Then gmnachk = "failed"
If Range("R245:U245").EntireRow.Hidden = False And Range("R245").Value = "" Then gmnachk = "failed"


If Range("F249:J249").EntireRow.Hidden = False And Range("F249").Value = "" Then gmnachk = "failed"
If Range("B255").EntireRow.Hidden = False And Range("B255").Value = "" Then gmnachk = "failed"
If Range("B257").EntireRow.Hidden = False And Range("B257").Value = "" Then gmnachk = "failed"
If Range("F265:L265").EntireRow.Hidden = False And Range("F265").Value = "" Then gmnachk = "failed"
If Range("F268:U268").EntireRow.Hidden = False And Range("F268").Value = "" Then gmnachk = "failed"
If Range("F280:U280").EntireRow.Hidden = False And Range("F280").Value = "" Then gmnachk = "failed"
If Range("F282:L282").EntireRow.Hidden = False And Range("F282").Value = "" Then gmnachk = "failed"
If Range("F287:L287").EntireRow.Hidden = False And Range("F287").Value = "" Then gmnachk = "failed"
If Range("F290:U290").EntireRow.Hidden = False And Range("F290").Value = "" Then gmnachk = "failed"
If Range("F304:U304").EntireRow.Hidden = False And Range("F304").Value = "" Then gmnachk = "failed"
If Range("F311:L311").EntireRow.Hidden = False And Range("F311").Value = "" Then gmnachk = "failed"
If Range("F314:U314").EntireRow.Hidden = False And Range("F314").Value = "" Then gmnachk = "failed"
If Range("F316:U316").EntireRow.Hidden = False And Range("F316").Value = "" Then gmnachk = "failed"
If Range("F318:J318").EntireRow.Hidden = False And Range("F318").Value = "" Then gmnachk = "failed"
If Range("M318:U318").EntireRow.Hidden = False And Range("M318").Value = "" Then gmnachk = "failed"
If Range("F322:J322").EntireRow.Hidden = False And Range("F322").Value = "" Then gmnachk = "failed"
If Range("B352").EntireRow.Hidden = False And Range("B352").Value = "" Then gmnachk = "failed"
If Range("F357:M357").EntireRow.Hidden = False And Range("F357").Value = "" Then gmnachk = "failed"
If Range("P357:Q357").EntireRow.Hidden = False And Range("P357").Value = "" Then gmnachk = "failed"
If Range("F361:I361").EntireRow.Hidden = False And Range("F361").Value = "" Then gmnachk = "failed"
If Range("B363").EntireRow.Hidden = False And Range("B363").Value = "" Then gmnachk = "failed"
If Range("B364").EntireRow.Hidden = False And Range("B364").Value = "" Then gmnachk = "failed"
If Range("B375").EntireRow.Hidden = False And Range("B375").Value = "" Then gmnachk = "failed"
If Range("B376").EntireRow.Hidden = False And Range("B376").Value = "" Then gmnachk = "failed"
If Range("B386").EntireRow.Hidden = False And Range("B386").Value = "" Then gmnachk = "failed"
If Range("B387").EntireRow.Hidden = False And Range("B387").Value = "" Then gmnachk = "failed"
If Range("B397").EntireRow.Hidden = False And Range("B397").Value = "" Then gmnachk = "failed"
If Range("B398").EntireRow.Hidden = False And Range("B398").Value = "" Then gmnachk = "failed"
If Range("B408").EntireRow.Hidden = False And Range("B408").Value = "" Then gmnachk = "failed"
If Range("B409").EntireRow.Hidden = False And Range("B409").Value = "" Then gmnachk = "failed"
If Range("B419").EntireRow.Hidden = False And Range("B419").Value = "" Then gmnachk = "failed"
If Range("B420").EntireRow.Hidden = False And Range("B420").Value = "" Then gmnachk = "failed"
If Range("B547").EntireRow.Hidden = False And Range("B547").Value = "" Then gmnachk = "failed"

If Range("B251").EntireRow.Hidden = False And Range("B251").Value = "" Then gmnachk = "failed"


Else
End If


'Name / Address modification
If Sheets("GM_NA").Range("q18").Value = "Name / Address modification" Then

If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
If Range("F575:L575").EntireRow.Hidden = False And Range("F575").Value = "" Then gmnachk = "failed"
If Range("F578:U578").EntireRow.Hidden = False And Range("F578").Value = "" Then gmnachk = "failed"
If Range("F580:U580").EntireRow.Hidden = False And Range("F580").Value = "" Then gmnachk = "failed"
If Range("F582:L582").EntireRow.Hidden = False And Range("F582").Value = "" Then gmnachk = "failed"
If Range("F584:U584").EntireRow.Hidden = False And Range("F584").Value = "" Then gmnachk = "failed"
If Range("F586:U586").EntireRow.Hidden = False And Range("F586").Value = "" Then gmnachk = "failed"
If Range("F590:U590").EntireRow.Hidden = False And Range("F590").Value = "" Then gmnachk = "failed"
If Range("F592:U592").EntireRow.Hidden = False And Range("F592").Value = "" Then gmnachk = "failed"

Else
End If

'Alternative Payee/Factoring Setup
If Sheets("GM_NA").Range("q18").Value = "Alternative Payee/Factoring Setup" Then

If Range("F173:L173").EntireRow.Hidden = False And Range("F173").Value = "" Then gmnachk = "failed"
If Range("F176:U176").EntireRow.Hidden = False And Range("F176").Value = "" Then gmnachk = "failed"
If Range("F178:U178").EntireRow.Hidden = False And Range("F178").Value = "" Then gmnachk = "failed"
If Range("F180:L180").EntireRow.Hidden = False And Range("F180").Value = "" Then gmnachk = "failed"
If Range("F182:U182").EntireRow.Hidden = False And Range("F182").Value = "" Then gmnachk = "failed"
If Range("F184:U184").EntireRow.Hidden = False And Range("F184").Value = "" Then gmnachk = "failed"
If Range("F188:U188").EntireRow.Hidden = False And Range("F188").Value = "" Then gmnachk = "failed"
If Range("F190:U190").EntireRow.Hidden = False And Range("F190").Value = "" Then gmnachk = "failed"
If Range("F236:L236").EntireRow.Hidden = False And Range("F236").Value = "" Then gmnachk = "failed"
If Range("F239:U239").EntireRow.Hidden = False And Range("F239").Value = "" Then gmnachk = "failed"
If Range("F243:U243").EntireRow.Hidden = False And Range("F243").Value = "" Then gmnachk = "failed"
If Range("F245:J245").EntireRow.Hidden = False And Range("F245").Value = "" Then gmnachk = "failed"
'If Range("M245:U245").EntireRow.Hidden = False And Range("M245").Value = "" Then gmnachk = "failed"

If Range("M245:P245").EntireRow.Hidden = False And Range("M245").Value = "" Then gmnachk = "failed"
If Range("R245:U245").EntireRow.Hidden = False And Range("R245").Value = "" Then gmnachk = "failed"


If Range("F249:J249").EntireRow.Hidden = False And Range("F249").Value = "" Then gmnachk = "failed"
If Range("B253").EntireRow.Hidden = False And Range("B253").Value = "" Then gmnachk = "failed"
If Range("B352").EntireRow.Hidden = False And Range("B352").Value = "" Then gmnachk = "failed"
If Range("F357:M357").EntireRow.Hidden = False And Range("F357").Value = "" Then gmnachk = "failed"
If Range("P357:Q357").EntireRow.Hidden = False And Range("P357").Value = "" Then gmnachk = "failed"
If Range("F361:I361").EntireRow.Hidden = False And Range("F361").Value = "" Then gmnachk = "failed"
If Range("B363").EntireRow.Hidden = False And Range("B363").Value = "" Then gmnachk = "failed"
If Range("B364").EntireRow.Hidden = False And Range("B364").Value = "" Then gmnachk = "failed"
If Range("B375").EntireRow.Hidden = False And Range("B375").Value = "" Then gmnachk = "failed"
If Range("B376").EntireRow.Hidden = False And Range("B376").Value = "" Then gmnachk = "failed"
If Range("B386").EntireRow.Hidden = False And Range("B386").Value = "" Then gmnachk = "failed"
If Range("B387").EntireRow.Hidden = False And Range("B387").Value = "" Then gmnachk = "failed"
If Range("B397").EntireRow.Hidden = False And Range("B397").Value = "" Then gmnachk = "failed"
If Range("B398").EntireRow.Hidden = False And Range("B398").Value = "" Then gmnachk = "failed"
If Range("B408").EntireRow.Hidden = False And Range("B408").Value = "" Then gmnachk = "failed"
If Range("B409").EntireRow.Hidden = False And Range("B409").Value = "" Then gmnachk = "failed"
If Range("B419").EntireRow.Hidden = False And Range("B419").Value = "" Then gmnachk = "failed"
Else
End If

'Bank Account Maintenance
If Sheets("GM_NA").Range("q18").Value = "Bank Account Maintenance" Then

If Range("F25:I25").EntireRow.Hidden = False And Range("F25").Value = "" Then gmnachk = "failed"
If Range("F27:U27").EntireRow.Hidden = False And Range("F27").Value = "" Then gmnachk = "failed"
If Range("F29:U29").EntireRow.Hidden = False And Range("F29").Value = "" Then gmnachk = "failed"
If Range("F31:L31").EntireRow.Hidden = False And Range("F31").Value = "" Then gmnachk = "failed"
If Range("Q31:U31").EntireRow.Hidden = False And Range("Q31").Value = "" Then gmnachk = "failed"
If Range("F33:U33").EntireRow.Hidden = False And Range("F33").Value = "" Then gmnachk = "failed"
If Range("F357:M357").EntireRow.Hidden = False And Range("F357").Value = "" Then gmnachk = "failed"

If Range("P357:Q357").EntireRow.Hidden = False And Range("P357").Value = "" Then gmnachk = "failed"
If Range("F361:I361").EntireRow.Hidden = False And Range("F361").Value = "" Then gmnachk = "failed"
If Range("B363").EntireRow.Hidden = False And Range("B363").Value = "" Then gmnachk = "failed"
If Range("B364").EntireRow.Hidden = False And Range("B364").Value = "" Then gmnachk = "failed"
If Range("B375").EntireRow.Hidden = False And Range("B375").Value = "" Then gmnachk = "failed"
If Range("B376").EntireRow.Hidden = False And Range("B376").Value = "" Then gmnachk = "failed"
If Range("B386").EntireRow.Hidden = False And Range("B386").Value = "" Then gmnachk = "failed"
If Range("B387").EntireRow.Hidden = False And Range("B387").Value = "" Then gmnachk = "failed"
If Range("B397").EntireRow.Hidden = False And Range("B397").Value = "" Then gmnachk = "failed"
If Range("B398").EntireRow.Hidden = False And Range("B398").Value = "" Then gmnachk = "failed"
If Range("B408").EntireRow.Hidden = False And Range("B408").Value = "" Then gmnachk = "failed"
If Range("B409").EntireRow.Hidden = False And Range("B409").Value = "" Then gmnachk = "failed"
If Range("B419").EntireRow.Hidden = False And Range("B419").Value = "" Then gmnachk = "failed"
If Range("B482").EntireRow.Hidden = False And Range("B482").Value = "" Then gmnachk = "failed"
If Range("B483").EntireRow.Hidden = False And Range("B483").Value = "" Then gmnachk = "failed"
If Range("B497").EntireRow.Hidden = False And Range("B497").Value = "" Then gmnachk = "failed"
If Range("B498").EntireRow.Hidden = False And Range("B498").Value = "" Then gmnachk = "failed"
If Range("E490:J490").EntireRow.Hidden = False And Range("E490").Value = "" Then gmnachk = "failed"
If Range("N490:U490").EntireRow.Hidden = False And Range("N490").Value = "" Then gmnachk = "failed"
If Range("N480:Q480").EntireRow.Hidden = False And Range("N480").Value = "" Then gmnachk = "failed"
If Range("N476:U476").EntireRow.Hidden = False And Range("N476").Value = "" Then gmnachk = "failed"
If Range("B509").EntireRow.Hidden = False And Range("B509").Value = "" Then gmnachk = "failed"
If Range("B510").EntireRow.Hidden = False And Range("B510").Value = "" Then gmnachk = "failed"
If Range("B524").EntireRow.Hidden = False And Range("B524").Value = "" Then gmnachk = "failed"
If Range("B525").EntireRow.Hidden = False And Range("B525").Value = "" Then gmnachk = "failed"
If Range("N503:U503").EntireRow.Hidden = False And Range("N503").Value = "" Then gmnachk = "failed"
If Range("N507:Q507").EntireRow.Hidden = False And Range("N507").Value = "" Then gmnachk = "failed"
If Range("N517:U517").EntireRow.Hidden = False And Range("N517").Value = "" Then gmnachk = "failed"
If Range("E517:J517").EntireRow.Hidden = False And Range("E517").Value = "" Then gmnachk = "failed"
If Range("B547").EntireRow.Hidden = False And Range("B547").Value = "" Then gmnachk = "failed"

Else
End If

'Contact Details Modification
If Sheets("GM_NA").Range("q18").Value = "Contact Details Modification" Then
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
If Range("B543").EntireRow.Hidden = False And Range("B543").Value = "" Then gmnachk = "failed"
If Range("B554").EntireRow.Hidden = False And Range("B554").Value = "" Then gmnachk = "failed"
Else
End If


'Extend to New Business Unit/Company Code
If Sheets("GM_NA").Range("q18").Value = "Extend to New Business Unit/Company Code" Then
If Range("F154:I154").EntireRow.Hidden = False And Range("F154").Value = "" Then gmnachk = "failed"
If Range("F156:L156").EntireRow.Hidden = False And Range("F156").Value = "" Then gmnachk = "failed"
If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
Else
End If

'Inactivation/Mark for Deletion
If Sheets("GM_NA").Range("q18").Value = "Inactivation/Mark for Deletion" Then
If Range("F140:L140").EntireRow.Hidden = False And Range("F140").Value = "" Then gmnachk = "failed"
If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Mass changes" Then
'Mass changes
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Modify Payment Method" Then
'Modify Payment Method
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
If Range("F133:L133").EntireRow.Hidden = False And Range("F133").Value = "" Then gmnachk = "failed"
If Range("P133:U133").EntireRow.Hidden = False And Range("P133").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Modify Payment Terms" Then
'Modify Payment Terms
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
If Range("F126:L126").EntireRow.Hidden = False And Range("F126").Value = "" Then gmnachk = "failed"
If Range("P126:U126").EntireRow.Hidden = False And Range("P126").Value = "" Then gmnachk = "failed"
If Range("B128").EntireRow.Hidden = False And Range("B128").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Payment/Posting/Purchasing Block or Unblock" Then
'Payment/Posting/Purchasing Block or Unblock
If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F529:L529").EntireRow.Hidden = False And Range("F529").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Others - enter Details in Comments column" Then
'Others - enter Details in Comments column
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
Else
End If


'CSIDS mandatory check
If Range("F675").EntireRow.Hidden = False And Range("F675").Value = "" Then gmnachk = "failed"
If Range("F690").EntireRow.Hidden = False And Range("F690").Value = "" Then gmnachk = "failed"
If Range("F694").EntireRow.Hidden = False And Range("F694").Value = "" Then gmnachk = "failed"
If Range("F696").EntireRow.Hidden = False And Range("F696").Value = "" Then gmnachk = "failed"
If Range("P696").EntireRow.Hidden = False And Range("P696").Value = "" Then gmnachk = "failed"
If Range("F698").EntireRow.Hidden = False And Range("F698").Value = "" Then gmnachk = "failed"
If Range("P698").EntireRow.Hidden = False And Range("P698").Value = "" Then gmnachk = "failed"
If Range("F703").EntireRow.Hidden = False And Range("F703").Value = "" Then gmnachk = "failed"
If Range("V686").EntireRow.Hidden = False And Range("V686").Value = False Then gmnachk = "failed"

If gmnachk = "failed" Then 'MsgBox gmnachk
MsgBox "Validation has been failed since some required fields are missed to update!" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
Call Pro
Exit Sub
Else
End If


     If Sheets("GM_NA").Range("F20").Value = "See GM Units Multiple Business Units Tab" And Sheets("GM_NA_Multiple_BU").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'GM_NA_Multiple_BU'", vbExclamation, "Required Entry"
     MsgBox "you have selected " & Sheets("GM_NA_Multiple_BU").Range("f1").Value & " GM BU"
     Exit Sub
     End If
     
     If Sheets("GM_NA").Range("U20").Value <> "" And Sheets("GM_NA_Multiple_BU").Range("f1").Value <> 0 Then
     Sheets("GM_NA_Multiple_BU").Visible = True
     Sheets("GM_NA_Multiple_BU").Select
     er = Range("e2").End(xlDown).Row
     Range("a2:F5000").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$F$5100").AutoFilter Field:=4, Criteria1:="TRUE"
    End If
    
    If MsgBox("Validation has been completed succesfully" & vbNewLine & "All required fields are updated properly and preparing for submit..!", vbOKCancel + vbDefaultButton2, "Please confirm submition") = vbCancel Then
    'Do you want to submit this form now
    Exit Sub
    Call Pro
    End If
     ActiveWorkbook.Save
     Application.ScreenUpdating = False

If Sheets("GM_NA").Range("q18").Value = "New Duns creation" Then
If MsgBox("Are you a Supplier?", vbYesNo, Validation) = vbYes Then
MsgBox "Please send back this updated form to GM rather than sending it to Master Data, Since Master Data does not accept New Creation request directly from Supplier"
Call Pro
Exit Sub
Else
End If
End If


     'unhiding all sheets
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
     'Sheets("GM_NA").Move Before:=Sheets(1)
   'Sheets("GM_NA_Multiple_BU").Move Before:=Sheets(2)
        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub


subm = ThisWorkbook.Sheets("GM_NA").Range("Q18").Value
DUN = Range("F25").Value & Range("F38").Value & Range("F121").Value & Range("F173").Value & Range("F215").Value & Range("F236").Value & Range("F265").Value & Range("F287").Value & Range("F311").Value & Range("F333").Value & Range("F575").Value
SUP = Range("F27").Value & Range("F40").Value & Range("F123").Value & Range("F176").Value & Range("F197").Value & Range("F218").Value & Range("F239").Value & Range("F268").Value & Range("F290").Value & Range("F314").Value & Range("F336").Value & Range("F578").Value

subj = subm & "-" & DUN & "-" & SUP


            WkbName = subj 'Range("q18").Value & " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array("<", ">", "|", "/", "*", "[", "]", "{", "}", "-", "\", "?", """")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName = Replace(WkbName, MyArray(x), "_", 1)
            Next x
            'MsgBox WkbName
        
            WkbName_first = mypath 'Range("I9").Value '& " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array(".xls", "xlsx")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName_first = Replace(WkbName_first, MyArray(x), "_", 1)
            Next x



'aw = Application.ActiveWorkbook.Path & "\"
   'tb = InputBox("give the file name", , any_Name)
 '  ta = tb & ".xls" '".pdf"
  ' tt = aw & ta
  pbn = ActiveWorkbook.Name
  
   Sheets(Array("GM_NA_Multiple_BU", "Mass change")).Select
  ActiveWindow.SelectedSheets.Copy
  cbn = ActiveWorkbook.Name
  
  ActiveWorkbook.Sheets.Add Before:=Worksheets(1) ', Count:=3
  
  'sheets("Sheet
  'ActiveWorkbook.Worksheets.Add
  ActiveSheet.Name = "Form"
  
    'ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
    'ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"

  
  On Error GoTo 0
  Windows(pbn).Activate
  Sheets("GM_NA").Select
  Call UnPro
  'Range("A1:V3327").Select
'Selection.Copy
'Selection.SpecialCells(xlCellTypeVisible).Copy
'Range("A1:V3327")

''''''''''''''''''''''''''''''''''''

Range("W1:W3326").ClearContents
    Range("W1:W3326").SpecialCells(xlCellTypeVisible).FormulaR1C1 = "UN"
    Cells.Copy
    
Windows(cbn).Activate
Sheets("Form").Select
Range("A1").Select

'    Windows.Add
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveSheet.Paste

       ' Range("A1:W1").Insert Shift:=xlDown
''''    Range("A1:W1").FormulaR1C1 = " "
       ' Range("A1").Select
       ' Selection.AutoFilter
    
        Range("$A$1:$W$3379").Select
        Selection.AutoFilter
        ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, Criteria1:="<>"
    
     '   Selection.AutoFilter , VisibleDropDown:=False
       ' ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, VisibleDropDown:=False, Criteria1:="<>"
        ActiveWindow.ScrollRow = 1
        
        Selection.AutoFilter Field:=1, VisibleDropDown:=False
        Selection.AutoFilter Field:=22, VisibleDropDown:=False
     '   Selection.AutoFilter Field:=23, VisibleDropDown:=False
    '
      '  Range("W1").Select
''''    Do
''''    If ActiveCell.Value = "UN" Then ActiveCell.EntireRow.Hidden = False Else ActiveCell.EntireRow.Hidden = True
''''    ActiveCell.Offset(1, 0).Select
''''    If ActiveCell.Row >= 3379 Then Exit Do
''''
''''    Loop

    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Application.DisplayFormulaBar = False
    Range("A1").Select
    
    On Error Resume Next
    If Range("B1").Value = "" Then Range("A1").EntireRow.Hidden = True
    On Error GoTo 0
''''''''''''''''''''''''''''''''''''

'ActiveSheet.Paste
Range("A1").Select
Cells.FormatConditions.delete

           On Error Resume Next

'deleting irrelevent sheets from product
    If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then Else Sheets("GM_NA_Multiple_BU").delete
    If Sheets("Form").Range("Q18").Value = "Mass changes" Then Else Sheets("Mass change").delete
        ' '========================
            On Error GoTo 0
            


        
        ActiveWorkbook.SaveAs (WkbName_first & " " & WkbName & ".xls"), FileFormat:=51

'deleting unselected rows from GM multiple BU
If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then '!!!
        Sheets("GM_NA_Multiple_BU").Select
        Call UnPro
        If ActiveSheet.Name = "GM_NA_Multiple_BU" Then '!!
        
                Range("C7").Select
                Do
                On Error GoTo ivd
                If ActiveCell.Value = "" Then Exit Do
                If ActiveCell.Value = False Then
                ActiveCell.EntireRow.delete
                Else
                ActiveCell.Offset(1, 0).Select
                End If
                Loop
ivd:
On Error GoTo 0
        Range("A1:A5").EntireRow.delete
        Range("A1").Select
        On Error Resume Next
        ActiveSheet.DrawingObjects("CheckEU1").Visible = False
        
        
                Range(Range("B1048570").End(xlUp).Offset(1, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                Selection.EntireRow.Hidden = False
                Range(Range("B1048570").End(xlUp).Offset(2, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                On Error Resume Next
'                Selection.EntireRow.Hidden = True
                'On Error GoTo 0
                Dim s As Shape
                On Error Resume Next
                For Each s In ActiveSheet.Shapes
                
                s.OnAction = ""
                Next
                On Error GoTo 0
'''        ActiveSheet.Shapes.Visible = False
''        ActiveSheet.Shapes.SelectAll
''        Selection.ShapeRange.Visible = False
        On Error GoTo 0
        Call Pro
        Else '!!
        End If '!!
Else '!!!
End If '!!!
        'also you can give like left 10000 nos to eliminate xls from my path
        Sheets(1).Select
        

        
        'write here to alter form copy
   '         On Error Resume Next
'            ActiveSheet.DrawingObjects.Visible = False
           ' ActiveSheet.DrawingObjects.Delete
 '           ActiveSheet.DrawingObjects.Hide
  '          On Error GoTo 0
''    Call UnPro
''    Range("A1").Select
''    On Error Resume Next
       ActiveWindow.SmallScroll up:=1000000
''          ActiveSheet.Shapes.Range(Array("Group 5", "CommandButton1", "CommandButton2", "CommandButton3", "CommandButton4", "submit")).Delete
''Range("a1:V3336").Locked = True
'''Range("Q3331").ClearContents
'Application.ScreenUpdating = False
  On Error GoTo 0

On Error Resume Next

ActiveSheet.Shapes.SelectAll
'ActiveSheet.Shapes.OnAction = "nidhi"
Selection.OnAction = ""


'xxx
'On Error Resume Next
'For Each s In ActiveSheet.Shapes
's.OnAction = ""
'Next

On Error Resume Next

        If ActiveSheet.Name = "Form" Then Range("F20:L20").Locked = True
        If ActiveSheet.Name = "Form" Then Range("F10:L10").Locked = True
        Range("F21:N21").ClearContents
        
    On Error GoTo 0
    

    
    
    Call Pro
       '     ActiveSheet.DrawingObjects.Visible = False
            
            
        ActiveWorkbook.UpdateLinks = xlUpdateLinksNever
        
        'added for one mail project
        ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
        ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"
        Sheets("Form").Select
        ActiveSheet.Name = "Form_GBS"
        ActiveWorkbook.Save
        
        ffname = ActiveWorkbook.FullName
        fname = ActiveWorkbook.Name
        
        
        ActiveWorkbook.Close
        'MsgBox " Request Copy Has Been Saved as " & fname
        ' '============================
        tt1 = ffname
        
  '  .ExportAsFixedFormat Type:=xlTypexls, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  'End With
   
  
  
  
'''abu added=======================================================================================
''                 'Sheets("ORD").Select (False)
''                  'Sheets("Standardchanges").Select (False)
''                  ActiveWindow.SelectedSheets.Copy
''
''                  Application.StatusBar = False
''
''                    Dim appXL As New Excel.Application
''    Dim MyDate
''    MyDate = Date    ' MyDate contains the current system date.
''    Dim MyTime
''    MyTime = Time    ' Return current system time.
''    Dim TestStr As String
''    TestStr = Format(MyTime, "hh.mm.ss")
''    Dim Test1Str As String
''    Test1Str = Format(MyDate, "DD-MM-YYYY")
''
''    Application.DisplayAlerts = False
''    'MsgBox ActiveWorkbook.Name
''
''    ActiveWorkbook.SaveAs Filename:="C:\STD Changes\Bank\" & ree & " " & Test1Str & " " & TestStr & " " & ".xlsx" 'ActiveWorkbook.name
''    'ActiveWorkbook.SaveAs Filename:="C:\Std Changes\RAW DATA\" & "Test"
''    ActiveWorkbook.Save
''    bn = ActiveWorkbook.FullName
'''abu added=====================================================================================
  ' Call page

'Next i
'Else
Windows(pbn).Activate

Sheets("GM_NA").Select
Range("A1").Select
Call UnPro

If UserForm3.OptionButton1.Value = True Then

Set rng = Nothing

Set rng = Sheets("GM_NA").Range("B9:v21").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

subm = ThisWorkbook.Sheets("GM_NA").Range("Q18").Value

DUN = Range("F25").Value & Range("F38").Value & Range("F121").Value & Range("F173").Value & Range("F215").Value & Range("F236").Value & Range("F265").Value & Range("F287").Value & Range("F311").Value & Range("F333").Value & Range("F575").Value
'''
'''If ThisWorkbook.Sheets("GM_NA").Range("F25").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f26").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f38").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f38").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f121").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f121").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f215").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f215").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f236").Value = "Conduent will Initiate DUNS Assignment process" Then
'''DUN = "No DUNS"
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f236").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f236").Value
'''End If

'''If ThisWorkbook.Sheets("GM_NA").Range("f28").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f28").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f40").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f40").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f123").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f123").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f218").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f218").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f239").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f239").Value
'''End If

SUP = Range("F27").Value & Range("F40").Value & Range("F123").Value & Range("F176").Value & Range("F197").Value & Range("F218").Value & Range("F239").Value & Range("F268").Value & Range("F290").Value & Range("F314").Value & Range("F336").Value & Range("F578").Value

subj = subm & "-" & DUN & "-" & SUP

If Range("Q18").Value = "Bank Account Maintenance" Then
GMB = "VNAEFTDesk@conduent.com"
Else



    If Range("Q18").Value = "New Duns creation" Then
    
        If Range("E66").Value = True Or Range("H66").Value = True Or Range("P66").Value = True Then
        GMB = "OPSVendorMaster@conduent.com"
        Else
        GMB = "VNAAddlink@conduent.com"
        End If
    
    Else
    
    GMB = "OPSVendorMaster@ conduent.com"
    
    
    
    End If
End If


If Range("Q18").Value = "GPS/CCA/Logistics Request" Then GMB = "VNAAddlink@conduent.com"

With OutMail
    .To = GMB & ";" & Range("F14").Value
    .cc = Range("Q14").Value
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
'    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
'  If Sheets("GM_NA").Range("U20").Value <> "" And Sheets("GM_NA_Multiple_BU").Range("f1").Value <> 0 Then
'  Sheets("GM_NA_Multiple_BU").Select
'  Range("A1").Select
'  Selection.AutoFilter
 ' End If
 
 Else
'        If ActiveSheet.OptionButton2.Value = True Then MsgBox "Form has been saved in the below Directory " _
'        & vbNewLine & vbNewLine & vbNewLine & ffname
    'If UserForm3.OptionButton2.Value = True Then
    MsgBox "Form has been saved in the below Directory " & vbNewLine & vbNewLine & vbNewLine & ffname
    MsgBox "Finished..!", vbInformation
    Exit Sub
  
 End If
       For I = 3 To Sheets.Count
     'Sheets(I).Visible = 2
     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM_NA").Visible = True
     Sheets("GM_NA").Select
     Call Pro
     Application.ScreenUpdating = True
     MsgBox "Finished..!", vbInformation
     Application.DisplayAlerts = True

Application.UseSystemSeparators = True

End Sub


Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM_NA").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function


Attribute VB_Name = "GM_NA_mandatory_fiel"
Sub format_condition_for_all_reasons_for_mandatory_field()

    Call UnPro
    Cells.FormatConditions.delete
    
    'new creation#################################################################

'new creation
Range("F10:L10,F14:L14,Q18:U18,F20:L20").Select
Call if_selected_cell_blank_conditional_format

Range("E70:F70").Select
Call if_selected_cell_blank_conditional_format


Range("F361:I361,F373:I373,F384:I384,F406:I406,F417:I417,F395:I395").Select
Call if_selected_cell_blank_conditional_format

Range("F316:U316,F318:J318,M318:U318,F322:J322").Select
Call if_selected_cell_blank_conditional_format

Range("F243:U243,F245:J245,M245:P245,R245:U245,F249:J249").Select
Call if_selected_cell_blank_conditional_format

Range("E115:F115,J115:M115,E117:L117").Select
Call if_selected_cell_blank_conditional_format

Range("P369:Q369,P380:Q380,P391:Q391,P402:Q402,P413:Q413,P357:Q357").Select
Call if_selected_cell_blank_conditional_format

Range("F236:L236,F239:U239").Select
Call if_selected_cell_blank_conditional_format

Range("F265:L265,F268:U268,F282:L282,F280:U280,F287:L287,F290:U290,F304:U304,F311:L311,F314:U314,F357:M357").Select
Call if_selected_cell_blank_conditional_format

Range("F369:M369,F380:M380,F391:M391,F402:M402,F413:M413").Select
Call if_selected_cell_blank_conditional_format

'inco term mandatory field

    Range("O115:T115").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$V$115="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'if supplied from canada then tax numkber is mandatory

    Range("F251:J251").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$251="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    'Select the appropriate vendor category
''''        'Range("G64").FormulaR1C1 = "=COUNTIF(R[2]C[-4]:R[2]C[14],TRUE)"
''''        Range("C65:V65").FormatConditions.Add Type:=xlExpression, Formula1:="=$G$64=0"
''''        Range("C65:V65").FormatConditions(Range("C65:V65").FormatConditions.Count).SetFirstPriority
''''        With Range("C65:V65").FormatConditions(1).Interior
''''            .PatternColorIndex = xlAutomatic
''''            .Color = 65535
''''            .TintAndShade = 0
''''        End With
''''        Range("C65:V65").FormatConditions(1).StopIfTrue = False
    
    Range("D65:V65").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$65="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


    'purchase email id finance email id
        'Range("B253").FormulaR1C1 = "=RC[4]&R[2]C[4]"
        
        
    Range("F253:N253").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$255="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    Range("F255:N255").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$257="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
        
'''        Range("F255:N255,F253:N253").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$253="""""
'''        Range("F255:N255,F253:N253").FormatConditions(Range("F255:N255,F253:N253").FormatConditions.Count).SetFirstPriority
'''        With Range("F255:N255,F253:N253").FormatConditions(1).Interior
'''            .PatternColorIndex = xlAutomatic
'''            .Color = 65535
'''            .TintAndShade = 0
'''        End With
'''        Range("F255:N255,F253:N253").FormatConditions(1).StopIfTrue = False



    
    'Select if Payment through EFT mode or Select if Payment through check mode
    
        'Range("B352").FormulaR1C1 = "=COUNTIF(R[1]C[2]:R[1]C[15],TRUE)"

    Range("D352:O352").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$352="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'''            Range("D352:O352").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$352=0"
'''            Range("D352:O352").FormatConditions(Range("D352:O352").FormatConditions.Count).SetFirstPriority
'''            With Range("D352:O352").FormatConditions(1).Interior
'''                .PatternColorIndex = xlAutomatic
'''                .Color = 65535
'''                .TintAndShade = 0
'''            End With
'''            Range("D352:O352").FormatConditions(1).StopIfTrue = False
    
    'documents to confirm the bank account details provided above.
    
        'Range("B547").FormulaR1C1 = "=RC[2]&R[1]C[2]&R[2]C[2]&R[3]C[2]&R[4]C[2]"
        Range("D547:D551").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$547="""""
        Range("D547:D551").FormatConditions(Range("D547:D551").FormatConditions.Count).SetFirstPriority
        With Range("D547:D551").FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 65535
            .TintAndShade = 0
        End With
        Range("D547:D551").FormatConditions(1).StopIfTrue = False


'banking_field_abacode_ac_iban_swift()
'0 bank
    Range("F363:O363,F365:O365").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$363="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R361:U361,R363:U363").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$364="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
'1 bank
    Range("F375:O375,F377:O377").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$375="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R373:U373,R375:U375").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$376="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'2 bank
    Range("F386:O386,F388:O388").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$386="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R384:U384,R386:U386").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$387="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'3 rd abnk
    Range("F397:O397,F399:O399").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$397="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R395:U395,R397:U397").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$398="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'4th bank
    Range("F408:O408,F410:O410").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$408="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R406:U406,R408:U408").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$409="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'5 th bank
    Range("F419:O419,F421:O421").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$419="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R417:U417,R419:U419").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$420="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    '#################################################################

'Name / Address modification
Range("F215:L215,F218:U218,F575:L575,F578:U578,F590:U590,F592:U592").Select
Call if_selected_cell_blank_conditional_format

Range("F220:U220,F222:L222,F224:U224,F226:U226").Select
Call if_selected_cell_blank_conditional_format

Range("F580:U580,F582:L582,F584:U584,F586:U586").Select
Call if_selected_cell_blank_conditional_format


'Alternative Payee/Factoring Setup
Range("F173:L173,F176:U176,F188:U188,F190:U190").Select
Call if_selected_cell_blank_conditional_format

Range("F178:U178,F180:L180,F182:U182,F184:U184").Select
Call if_selected_cell_blank_conditional_format

'Bank Account Maintenance
Range("F25:I25,F27:U27,F29:U29,F31:L31,Q31:U31,F33:U33").Select
Call if_selected_cell_blank_conditional_format

Range("E490:J490,N503:U503,N507:Q507,N517:U517").Select
Call if_selected_cell_blank_conditional_format

Range("N476:U476,N480:Q480,N490:U490,E517:J517").Select
Call if_selected_cell_blank_conditional_format


'banking_field_abacode_ac_iban_swift()
'1
'change from bank
    Range("E482:J482,E484:J484,E486:J486").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$482="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("E497:G497,I497:J497").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$497="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'change to bank
    Range("N482:U482,N484:U484,N486:U486").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$483="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("N497:P497,R497:U497").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$498="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'2
'change from bank
    Range("E509:J509,E511:J511,E513:J513").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$509="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("E524:G524,I524:J524").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$524="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'change to bank
    Range("N509:U509,N511:U511,N513:U513").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$510="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("N524:P524,R524:U524").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$525="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'Add Bank Account/Change exsisting Bank Account/Delete exisitng Bank Account
Range("F38:I38,F40:U40").Select
Call if_selected_cell_blank_conditional_format
    
    'Range("B42").FormulaR1C1 = "=COUNTIF(R[1]C[4]:R[1]C[19],TRUE)"

    Range("G42:S42").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$42="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'''    Range("F42:U42").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$42=0"
'''    Range("F42:U42").FormatConditions(Range("F42:U42").FormatConditions.Count).SetFirstPriority
'''    With Range("F42:U42").FormatConditions(1).Interior
'''        .PatternColorIndex = xlAutomatic
'''        .Color = 65535
'''        .TintAndShade = 0
'''    End With
'''    Range("F42:U42").FormatConditions(1).StopIfTrue = False

'Contact Details Modification
Range("F121:U121,F123:U123").Select
Call if_selected_cell_blank_conditional_format

'chek box
    Range("G543:O543").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$543="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'email ID
    Range("F554:N554,F556:N556").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$554="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'Extend to New Business Unit/Company Code
Range("F154:I154,F156:L156,F215:L215,F218:U218").Select
Call if_selected_cell_blank_conditional_format

'Inactivation/Mark for Deletion
Range("F140:L140,F215:L215,F218:U218").Select
Call if_selected_cell_blank_conditional_format

'Mass changes
Range("F121:U121").Select
Call if_selected_cell_blank_conditional_format

'Modify Payment Method
Range("F133:L133,P133:U133,F121:U121,F123:U123").Select
Call if_selected_cell_blank_conditional_format


'Modify Payment Terms
Range("F121:U121,F123:U123,F126:L126,P126:U126").Select
Call if_selected_cell_blank_conditional_format

'chek box
    Range("F128:K128").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$128="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'Payment/Posting/Purchasing Block or Unblock
Range("F215:L215,F218:U218,F529:L529").Select
Call if_selected_cell_blank_conditional_format

Range("F121:U121,F123:U123").Select
Call if_selected_cell_blank_conditional_format


'Call mandatory_stoping_for_with_messages


Range("F673:L673,F690:U690,F694:U694,F696:L696,F698:L698,P696:U696,P698:U698,F703:L703,I711").Select
Call if_selected_cell_blank_conditional_format


    Range("F686:L686").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=$V$686=FALSE"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

Call Pro

End Sub





Attribute VB_Name = "Instruction"
Attribute VB_Base = "0{157D5A02-D2D3-40EB-838F-4EC25F9B3D95}{AAF84264-B587-4E42-B68F-A102DF7BCEE5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
'english
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF_Instructions_English").Visible = True
Sheets("VDRF_Instructions_English").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton2_Click()
'italian
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Istruzioni in Italiano").Visible = True
Sheets("VDRF Istruzioni in Italiano").Select
Sheets("Index").Range("D1").Value = mm
End Sub

Private Sub CommandButton3_Click()
'french
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instructions Fran|fffd|ais").Visible = True
Sheets("VDRF Instructions Fran|fffd|ais").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton4_Click()
'dutch
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Anleitung Deutsch").Visible = True
Sheets("VDRF Anleitung Deutsch").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton5_Click()
'portugal
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instru|fffd||fffd|es em Portugu|fffd|s ").Visible = True
Sheets("VDRF Instru|fffd||fffd|es em Portugu|fffd|s ").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton6_Click()
'Polskie
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instrukcje Polskie").Visible = True
Sheets("VDRF Instrukcje Polskie").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton7_Click()

'norwegian
Instruction.Hide
mm = ActiveSheet.Name
Sheets("instruksjon i Norwegian").Visible = True
Sheets("instruksjon i Norwegian").Select
Sheets("Index").Range("D1").Value = mm

End Sub


Private Sub CommandButton8_Click()
'spanish
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instrucciones en Espa|fffd|ol").Visible = True
Sheets("VDRF Instrucciones en Espa|fffd|ol").Select
Sheets("Index").Range("D1").Value = mm
End Sub








Attribute VB_Name = "Iobuttons"
Sub Addb()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 1
For Each cel In Range("f26,j26").Cells
Application.ScreenUpdating = False

d = cel.Row
E = cel.Column
c = Cells(d + 1, E).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 1 And id = 0 Then
id = 1
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
             cbx.Display3DShading = True
 ' with a linked can trap sheet change event or link to other formulas
        cbx.LinkedCell = c
        If id = 1 Then
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!taxx1"
        Else
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!tax0"
        End If
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb1()

For I = 1 To 2
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addb1()
If Range("m20") = "Thai" Then
Exit Sub
End If
Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 3
For Each cel In Range("f33").Cells
Application.ScreenUpdating = False

d = cel.Row
E = cel.Column
c = Cells(d, E - 1).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 3 And id = 0 Then
id = 3
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
        cbx.LinkedCell = c
            cbx.Display3DShading = True

     cbx.OnAction = "'" & ThisWorkbook.Name & "'!tlower"
        
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb2()

On Error Resume Next
ActiveSheet.CheckBoxes("tickbox3").Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox3").delete
On Error GoTo 0
    
End Sub

Sub Addb2()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 4
For Each cel In Range("I64").Cells
Application.ScreenUpdating = False

d = cel.Row
E = cel.Column
c = Cells(d, E - 1).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 4 And id = 0 Then
id = 4
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
        cbx.LinkedCell = c

     cbx.OnAction = "'" & ThisWorkbook.Name & "'!tlower1"
         cbx.Display3DShading = True
        
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb3()

On Error Resume Next
ActiveSheet.CheckBoxes("tickbox4").Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox4").delete
On Error GoTo 0
    
End Sub
Sub Addb3()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 5
j = 0
For Each cel In Range("G226,j226,m226,p226,s226").Cells
Application.ScreenUpdating = False
j = j + 1
d = cel.Row
E = cel.Column
c = Cells(d + 1, E).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 5 And id = 0 Then
id = 5
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
            cbx.Display3DShading = True
        cbx.LinkedCell = c
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!uhidebank" & j
        
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb4()
For I = 5 To 9
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
End Sub

Sub Addb4()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 10
For Each cel In Range("f214,j214").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 10 And id = 0 Then
id = 10
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "tickbox" & id
            cbx.Display3DShading = True
        cbx.Caption = ""
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Delb5()
For I = 10 To 11
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
End Sub

Sub Addb5()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 12
For Each cel In Range("f159,I159,L159").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 12 And id = 0 Then
id = 12
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "tickbox" & id
            cbx.Display3DShading = True
        cbx.Caption = ""
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Delb6()
For I = 12 To 14
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
End Sub
Attribute VB_Name = "List_separator"
Declare Function GetLocaleInfo Lib "kernel32" Alias _
"GetLocaleInfoA" (ByVal Locale As Long, ByVal LCType As Long, _
ByVal lpLCData As String, ByVal cchData As Long) As Long

Declare Function SetLocaleInfo Lib "kernel32" Alias _
"SetLocaleInfoA" (ByVal Locale As Long, ByVal LCType As Long, _
ByVal lpLCData As String) As Boolean

Declare Function GetUserDefaultLCID% Lib "kernel32" ()


'parm value
Public Const LOCALE_SLIST = &HC
Option Explicit
Public Sub Get_listseparator_in_system() ' Retrieve the regional setting
    Dim mm
      Dim Symbol As String
      Dim iRet1 As Long
      Dim iRet2 As Long
      Dim lpLCDataVar As String
      Dim Pos As Integer
      Dim Locale As Long
      
      Locale = GetUserDefaultLCID()
      
      iRet1 = GetLocaleInfo(Locale, LOCALE_SLIST, _
      lpLCDataVar, 0)
      Symbol = String$(iRet1, 0)
      
      iRet2 = GetLocaleInfo(Locale, LOCALE_SLIST, Symbol, iRet1)
      Pos = InStr(Symbol, Chr$(0))
      If Pos > 0 Then
           Symbol = Left$(Symbol, Pos - 1)
           'MsgBox "Regional Setting = " + Symbol
           
           If Symbol = "," Then
           Sheets("Index").Range("B5").Value = ""
           Exit Sub
           Else
           mm = ActiveWorkbook.Name
           Sheets("Index").Range("B5").Value = "changed"
'           Sheets("Index").Range("c5").Value = Sheets("Index").Range("c5").Value + 1
           Sheets("Index").Range("C5").Value = Symbol
           
           MsgBox "The System separator setting is not compatible with Form setting. Hence it has been changed from '" _
           & Sheets("Index").Range("C5").Value & "' To ','" & vbNewLine & vbNewLine & " same will be Restored, Please proceed"
           'MsgBox Sheets("Index").Range("B5").Value
           'MsgBox Sheets("Index").Range("C5").Value
           Call change_list_separator_in_system
           Application.DisplayAlerts = False
           ActiveWorkbook.Save
            Call ExcelRestart_to_apply_list_separator
            Application.DisplayAlerts = False
            Sheets("Index").Range("B5").Value = ""
            ActiveWorkbook.Close savechanges:=False
            Application.DisplayAlerts = True
            Windows(mm).Activate
            'ActiveWorkbook.Close ([no])
           End If
           'MsgBox "completed"
      End If

End Sub


'KillProcesses
'ExcelRestart
Public Sub change_list_separator_in_system() 'Change the regional setting

      Dim Symbol As String
      Dim iRet As Long
      Dim Locale As Long

      Locale = GetUserDefaultLCID() 'Get user Locale ID
      Symbol = "," 'New character for the locale
      iRet = SetLocaleInfo(Locale, LOCALE_SLIST, Symbol)
     
End Sub
Sub ExcelRestart_to_apply_list_separator()
  Dim xlApp
  Dim xlBook
  Dim fname
  Set xlApp = CreateObject("Excel.Application")
  xlApp.DisplayAlerts = False
  fname = ActiveWorkbook.FullName
  Set xlBook = xlApp.Workbooks.Open(fname)
'"C:\Users\50011229\Desktop\kudhal\9 eye programme\list separator.xlsm"
  xlApp.Visible = True
  xlBook.Activate
  Set xlBook = Nothing
  Set xlApp = Nothing
End Sub

'Sheets("Index").Range("B5").Value
Public Sub change_list_separator_in_system_to_previousone() 'Change the regional setting
If Sheets("Index").Range("C5").Value = "" Then Exit Sub
If Sheets("Index").Range("B5").Value = "changed" Then
On Error Resume Next
      Dim Symbol As String
      Dim iRet As Long
      Dim Locale As Long

      Locale = GetUserDefaultLCID() 'Get user Locale ID
      Symbol = Sheets("Index").Range("C5").Value '"," 'New character for the locale
      iRet = SetLocaleInfo(Locale, LOCALE_SLIST, Symbol)
      MsgBox "System setting has been Restored"
On Error GoTo 0
Else
End If
    
End Sub
Attribute VB_Name = "Module1"
Sub Macro11()
Attribute Macro11.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro11 Macro
'

'
    Range("F686:L686").Select
    Range("F686:L686").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=$V$686=FALSE"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
End Sub
Attribute VB_Name = "Module10"

Sub hooligan()

    With ActiveWorkbook.Names("GM_IO_PA")
        '.Name = "GM_IO_PA"
        'GM_IO_PA
        .RefersToR1C1 = "=GMIO_PA_IN_validation!RC:R[4]C"
        .Comment = ""
    End With

    With ActiveWorkbook.Names("GM_IO_IN")
        .Name = "mod"
        .RefersToR1C1 = "=Sheet1!R6C6:R10C6"
        .Comment = ""
    End With
    
End Sub
Sub Macro9()
Attribute Macro9.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro9 Macro

'
End Sub
Sub Macro10()
Attribute Macro10.VB_ProcData.VB_Invoke_Func = " \n14"

    With Selection.Validation
        .delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=GMIO_PA_IN_validation!$I$6:$I$91"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
End Sub
Attribute VB_Name = "Module11"
Sub Macro4()
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'

    ActiveWindow.DisplayHorizontalScrollBar = True

    Range("A5").Select
    Range(Selection, Selection.End(xlToRight)).Select
    ActiveWorkbook.Names.Add Name:="Header_pain", RefersToR1C1:= _
        "=GMIO_PA_IN_validation!R5C1:R5C68"
    Range("A6").Select
    Selection.End(xlToLeft).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    Range("BG5").Select
    Selection.End(xlToLeft).Select
    With ActiveWorkbook.Names("Header_pain")
        .Name = "GMIO_pain_Heade"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R5C1:R5C68"
        .Comment = ""
    End With
    With ActiveWorkbook.Names("GMIO_pain_Heade")
        .Name = "GMIO_pain_Header"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R5C1:R5C68"
        .Comment = ""
    End With
    Range("A6").Select
    Selection.End(xlToLeft).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("A6:BP91").Select
    ActiveWindow.ScrollColumn = 58
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 56
    ActiveWindow.ScrollColumn = 53
    ActiveWindow.ScrollColumn = 48
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.SmallScroll Down:=3
    Range("A6:BP90").Select
    ActiveWindow.SmallScroll Down:=2
    ActiveWindow.ScrollColumn = 58
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 54
    ActiveWindow.ScrollColumn = 47
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 39
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 37
    ActiveWindow.ScrollColumn = 36
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 33
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 29
    ActiveWindow.ScrollColumn = 28
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 25
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 22
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 19
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.LargeScroll Down:=3
    Range("A6").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("A6:A424").Select
    Range(Selection, Selection.End(xlToRight)).Select
    ActiveWindow.ScrollRow = 393
    ActiveWindow.ScrollRow = 391
    ActiveWindow.ScrollRow = 390
    ActiveWindow.ScrollRow = 389
    ActiveWindow.ScrollRow = 384
    ActiveWindow.ScrollRow = 379
    ActiveWindow.ScrollRow = 369
    ActiveWindow.ScrollRow = 337
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 129
    ActiveWindow.ScrollRow = 101
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll ToRight:=2
    ActiveWorkbook.Names.Add Name:="pain_body_gmio", RefersToR1C1:= _
        "=GMIO_PA_IN_validation!R6C1:R424C68"
    Range("A5").Select
    Range(Selection, Selection.End(xlToRight)).Select
    With ActiveWorkbook.Names("GMIO_pain_Header")
        .Name = "pain_Header_GMIO"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R5C1:R5C68"
        .Comment = ""
    End With
    Range("A6").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range("C2:C3").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Columns("F:F").ColumnWidth = 29.29
    Range("F2").Select
    ActiveSheet.Paste
    ActiveCell.FormulaR1C1 = "pain_header_GMIO"
    Range("F3").Select
    Selection.FillDown
    ActiveCell.FormulaR1C1 = "pain_body_GMIO"
    Range("F4").Select
    ActiveSheet.Paste
    Selection.FillDown
    Range("F4").Select
    ActiveCell.FormulaR1C1 = "pain_colno_GMIO"
    Range("F5").Select
    Selection.FillDown
    Range("F5").Select
    ActiveCell.FormulaR1C1 = "pain_collist_GMIO"
    Range("F6").Select
    Selection.FillDown
    ActiveCell.FormulaR1C1 = "pain_totallines_GMIO"
    Range("C4").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_colno_GMIO", RefersToR1C1:= _
        "=MATCH(GM_IO_Form!R25C22,pain_Header_GMIO,0)"
    ActiveWorkbook.Names("pain_colno_GMIO").Comment = ""
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("V25").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(R[6]C[-15],4)"
    Range("G31:M33").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("C5").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("F402:U402").Select
    ActiveCell.FormulaR1C1 = "=pai"
    Range("F402:U402").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("F402:U402").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("F402:U402").Select
    ActiveWindow.DisplayFormulas = True
    ActiveWindow.DisplayFormulas = False
    Selection.ClearContents
    Range("N61").Select
    ActiveSheet.Paste
    Range("N61").Select
    Selection.ClearContents
    Range("P74:S74").Select
    Sheets("GMIO_PA_IN_validation").Select
    Windows("excel study.xlsm").Activate
    Range("F5").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Range("B7").Select
    ActiveCell.FormulaR1C1 = "2"
    Range("F6").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_totallines_GMIO", RefersToR1C1:= _
        "=COUNTA(pain_collist_GMIO)"
    ActiveWorkbook.Names("pain_totallines_GMIO").Comment = ""
    Windows("excel study.xlsm").Activate
    Range("D5").Select
    Selection.ClearContents
    Range("F6").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Range("D27").Select
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Range("F5").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_collist_GMIO", RefersToR1C1:= _
        "=INDEX(pain_body_gmio,,pain_colnot_GMIO)"
    ActiveWorkbook.Names("pain_collist_GMIO").Comment = ""
    Windows("excel study.xlsm").Activate
    Range("F13").Select
    ActiveSheet.Paste
    Range("F2:F6").Select
    Range("F6").Activate
    Selection.Copy
    Application.CutCopyMode = False
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Range("F6").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_paymentterm_GMIO", RefersToR1C1:= _
        "=INDEX(pain_body_gmio,1,pain_colno_GMIO):INDEX(pain_body_gmio,pain_lineitems_GMIO,pain_colno_GMIO)"
    ActiveWorkbook.Names("pain_paymentterm_GMIO").Comment = ""
    With ActiveWorkbook.Names("pain_totallines_GMIO")
        .Name = "pain_totallimes_GMIO"
        .RefersToR1C1 = "=COUNTA(pain_collist_GMIO)"
        .Comment = ""
    End With
    With ActiveWorkbook.Names("pain_body_gmio")
        .Name = "pain_body_GMIO"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R6C1:R424C68"
        .Comment = ""
    End With
    Sheets("GMIO_PA_IN_validation").Select
    Sheets.Add After:=ActiveSheet
    Range("H12").Select
    ActiveCell.FormulaR1C1 = "=pa"
    Range("H12").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("H13").Select
    ActiveCell.FormulaR1C1 = "=pain_totallimes_GMIO"
    Range("H13").Select
    ActiveWorkbook.Names("pain_collist_GMIO").RefersToR1C1 = _
        "=INDEX(pain_body_GMIO,,pain_colno_GMIO)"
    Range("H14").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Validation
        .delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=pain_paymentterm_GMIO"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Range("H16").Select
    With ActiveWorkbook.Names("pain_totallimes_GMIO")
        .Name = "pain_totallineitems_GMIO"
        .RefersToR1C1 = "=COUNTA(pain_collist_GMIO)"
        .Comment = ""
    End With
    Range("H14").Select
    ActiveWorkbook.Names("pain_paymentterm_GMIO").RefersToR1C1 = _
        "=INDEX(pain_body_GMIO,1,pain_colno_GMIO):INDEX(pain_body_GMIO,pain_totallineitems_GMIO,pain_colno_GMIO)"
    Range("J15").Select
    Columns("H:H").EntireColumn.AutoFit
    Range("I14").Select
    Columns("H:H").EntireColumn.AutoFit
    Range("H14").Select
    Sheets("GM_IO_Form").Select
    With Selection.Validation
        .delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=pain_paymentterm_GMIO"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Range("V25").Select
    Sheets("GMIO_PA_IN_validation").Select
    Selection.End(xlUp).Select
    Range("I5").Select
    Selection.Copy
    Range("C5:E5").Select
    Range("E5").Activate
    Application.CutCopyMode = False
    Selection.Copy
    Workbooks.Add
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
    Range("B1").Select
    Columns("A:A").EntireColumn.AutoFit
    Range("A2").Select
    Application.CutCopyMode = False
    Selection.Copy
    Windows("VDRF New 1.10.xlsm").Activate
    Application.CutCopyMode = False
    Application.DisplayFullScreen = False
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Windows("Book1").Activate
    Windows("VDRF New 1.10.xlsm").Activate
    Windows("Book1").Activate
    Selection.Copy
    Windows("VDRF New 1.10.xlsm").Activate
    Application.CutCopyMode = False
    Application.DisplayFullScreen = False
    Windows("Book1").Activate
    Selection.Copy
    Application.CutCopyMode = False
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Range("V25").Select
    ActiveCell.FormulaR1C1 = "GMI_IN_C"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_collist_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_collist_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("O61").Select
    ActiveCell.FormulaR1C1 = "=INDEX(pain_body_GMIO,2,(pain_colno_GMIO+1))"
    Range("T33").Select
    Range("V33").Select
    ActiveCell.FormulaR1C1 = "=pain"
    Range("V33").Select
    Range("V33").Select
    Selection.Copy
    Application.CutCopyMode = False
    Selection.ClearContents
    Range("O50").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("O50").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO+1"
    Range("O50").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E8").Select
    Sheets("GM_IO_Form").Select
    Range("N50").Select
    ActiveCell.FormulaR1C1 = ""
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_bo_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("P74:U74").Select
    Selection.Copy
    Application.CutCopyMode = False
    Sheets("GMIO_PA_IN_validation").Select
    Range("D23").Select
    Columns("D:D").EntireColumn.AutoFit
    Columns("D:D").ColumnWidth = 12.29
    Range("C5").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("O61").Select
    Range("P74:S74").Select
    Selection.Copy
    Sheets("GMIO_PA_IN_validation").Select
    Cells.Find(What:="Delivered cleared by customs   ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Range("C15").Select
    Cells.Find(What:="Delivered cleared by customs   ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="Delivered cleared by customs ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="Delivered cleared by customs", After:=ActiveCell, LookIn _
        :=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _
        xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.FindNext(After:=ActiveCell).Activate
    Range("A11").Select
    Cells.Find(What:="Delivered cleared by customs   ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="Delivered cleared by customs", After:=ActiveCell, LookIn _
        :=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _
        xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Range("E22:F22").Select
    Range("F22").Activate
    Application.CutCopyMode = False
    Selection.Copy
    Application.CutCopyMode = False
    Range("E5").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("P74:S74").Select
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("P74:S74").Select
    Windows("Book1").Activate
    Windows("VDRF New 1.10.xlsm").Activate
    Windows("Book1").Activate
    Windows("VDRF New 1.10.xlsm").Activate
    Sheets("GMIO_PA_IN_validation").Select
    Application.DisplayFullScreen = False
    ActiveWorkbook.Save
    Range("E12:F12").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Application.CutCopyMode = False
    Sheets("GMIO_PA_IN_validation").Select
    Range("E17").Select
    Cells.Find(What:="Letter of Credit at Sight", After:=ActiveCell, LookIn:= _
        xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _
        xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Range("D63").Select
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    Range("E12").Select
    Sheets("GM_IO_Form").Select
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("Q50").Select
    ActiveCell.FormulaR1C1 = "=MATCH(R[24]C[-1],pain_collist_GMIO)"
    Range("R50").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO+1"
    Range("S50").Select
    ActiveCell.FormulaR1C1 = "=INDEX(pain_body_GMIO,79,6)"
    Range("S50").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("A1:B1").Select
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E5").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 78
    ActiveWindow.ScrollRow = 77
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 78
    Sheets("GM_IO_Form").Select
    Range("P74:S74").Select
    Sheets("GMIO_PA_IN_validation").Select
    ActiveWindow.ScrollRow = 77
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    Range("E65").Select
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    Sheets("GM_IO_Form").Select
    Range("S50").Select
    Application.GoTo Reference:= _
        "GMIO_PA_IN_validation!R[301]C[34]:R[1048459]C[16351]"
    ActiveWindow.SmallScroll Down:=-4
    Range("F6:F32").Select
    ActiveWindow.SmallScroll Down:=2
    Range("E6:E83").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E84").Select
    ActiveWindow.SmallScroll Down:=7
    Range("E84:F84").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("P74:S74").Select
    Application.CutCopyMode = False
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T75").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E84").Select
    Sheets("GM_IO_Form").Select
    Range("Q50").Select
    Application.GoTo Reference:="pain_collist_GMIO"
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    Sheets("GM_IO_Form").Select
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO,0)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    Sheets("GMIO_PA_IN_validation").Select
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    Range("E13").Select
    ActiveWorkbook.Save
    Sheets("GM_IO_Form").Select
    Range("O50:S50").Select
    Selection.ClearContents
    Range("T77").Select
    Sheets("GMIO_PA_IN_validation").Select
    Columns("A:B").Select
    Range("A2").Activate
    Selection.AutoFilter
    Rows("5:5").Select
    Range("B5").Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.AutoFilter
    Rows("5:5").Select
    Range("B5").Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.AutoFilter
    Selection.End(xlUp).Select
    Range("B5").Select
    ActiveSheet.Range("$A$5:$BU$423").AutoFilter Field:=2, Criteria1:="="
    Range("B60").Select
    Range(Selection, Selection.End(xlToLeft)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("A60:B423").Select
    Range("B60").Activate
    Selection.SpecialCells(xlCellTypeVisible).Select
    Selection.AutoFilter
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    Selection.ClearContents
    Range("D57").Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("D2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("F7").Select
    Selection.End(xlDown).Select
    Range("F29").Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("F5").Select
    Selection.AutoFilter
    Range("F2").Select
    ActiveSheet.Range("$A$2:$BP$423").AutoFilter Field:=6, Criteria1:="="
    Range("E28").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("E28:F71").Select
    Selection.SpecialCells(xlCellTypeVisible).Select
    Selection.AutoFilter
    Selection.delete Shift:=xlUp
    Range("G6").Select
    Selection.End(xlDown).Select
    Range("H28").Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Range("H6").Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("I6").Select
    Selection.End(xlDown).Select
    Range("J90").Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("J2").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$BP$423").AutoFilter Field:=10, Criteria1:="="
    Range("I28:J28").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("I28:J71").Select
    Selection.SpecialCells(xlCellTypeVisible).Select
    Selection.AutoFilter
    Selection.delete Shift:=xlUp
    Range("J29").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.SmallScroll ToRight:=4
    Range("L28:L29").Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("N2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("M18:N18").Select
    Range("N18").Activate
End Sub
Sub Macro5()
Attribute Macro5.VB_ProcData.VB_Invoke_Func = " \n14"

Do
    If ActiveCell.Offset(0, -1).Value = "" Then Exit Do
    
    If ActiveCell.Value = "" Then
    aa = ActiveCell.Address
    Range(ActiveCell.Offset(0, -1), ActiveCell).Select
    Selection.delete Shift:=xlUp
    Range(aa).Select
    Else
    ActiveCell.Offset(1, 0).Select
    End If
Loop
'    Range("N24").Select
'    Selection.End(xlDown).Select
'    Range("M64:N64").Select
'    Range("N64").Activate
'    Selection.Delete Shift:=xlUp
'    Range("M65:N65").Select
'    Range("N65").Activate
'    Selection.Delete Shift:=xlUp
End Sub
Sub Macro6()
Attribute Macro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
'

'
    Range("N66").Select
    Range(Selection, Selection.End(xlUp)).Select
    Range("M22:N66").Select
    Range("N66").Activate
End Sub
Attribute VB_Name = "Module12"
Sub Macro8()
Attribute Macro8.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro8 Macro
'

'
    Selection.FormatConditions.delete
    ActiveWindow.SmallScroll Down:=-12
End Sub
Attribute VB_Name = "Module13"

Attribute VB_Name = "Module14"
Sub ghjk()

Application.ThousandsSeparator = ","
Application.DecimalSeparator = "."

MsgBox Application.ThousandsSeparator
MsgBox Application.DecimalSeparator

If Application.ThousandsSeparator = ";" Then
MsgBox "A"
Else
MsgBox "c"
End If
End Sub
Attribute VB_Name = "Module15"
Option Explicit

Private Declare Function SetLocaleInfo _
Lib "kernel32" Alias "SetLocaleInfoA" ( _
ByVal Locale As Long, _
ByVal LCType As Long, _
ByVal lpLCData As String) As Boolean

Private Declare Function GetUserDefaultLCID% Lib "kernel32" ()

Private Const LOCALE_SLIST = &HC
Private Const LOCALE_NAME_MAX_LENGTH = 85
Private Const LOCALE_NAME_USER_DEFAULT = vbNullString

'Get Locale Info
Private Declare Function GetLocaleInfoEx _
Lib "kernel32" ( _
ByVal lpLocaleName As String, _
ByVal LCType As Long, _
ByVal lpLCData As String, _
ByVal cchData As Long) As Long

Private Declare Function GetLastError Lib "kernel32" () As Long

Sub M1DelimiterSetup()

Dim lngTryAgainCtr As Long
Dim strBuffer As String
Dim strListSeparator As String
Dim lpLCData As String
Dim Long1 As Long

    lngTryAgainCtr = 0

TryAgain:
    lngTryAgainCtr = lngTryAgainCtr + 1

    'Change delimiter to pipe
    Call SetLocaleInfo(GetUserDefaultLCID(), LOCALE_SLIST, "|")

    'Check to make sure setting separator as pipe worked correctly
    strBuffer = String$(85, 0)
    Long1 = GetLocaleInfoEx(LOCALE_NAME_USER_DEFAULT, LOCALE_SLIST, lpLCData, 0)

    strListSeparator = String$(Long1, 0)
    Long1 = GetLocaleInfoEx(LOCALE_NAME_USER_DEFAULT, LOCALE_SLIST, strListSeparator, Long1)

    If InStr(strListSeparator, "|") = 0 Then
        If lngTryAgainCtr < 3 Then
            GoTo TryAgain
        Else
            If GetLocaleInfoEx(LOCALE_NAME_USER_DEFAULT, LOCALE_SLIST, strListSeparator, Long1) <> 0 Then Debug.Print GetLastError
            'pass part 1 error message
            'need error message for if run actively instead of part of script
        End If
    End If

    'Close workbook to allow Excel to reset its memory of delimiter
    'Show alerts if more workbooks open
    If Workbooks.Count = 1 Then Application.DisplayAlerts = False
    Application.Quit

End Sub

Attribute VB_Name = "Module16"
Attribute VB_Name = "Module17"

Sub mandatory_stoping_for_with_messages()


End Sub

Attribute VB_Name = "Module18"



Sub Macro12()
Attribute Macro12.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro12 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Check Box 421")).Select
    Range("M262").Select
    ActiveWindow.SmallScroll Down:=-186
    Sheets("GM_NA").Select
    Range("Q18:U18").Select
    ActiveCell.FormulaR1C1 = "New Duns creation"
    Range("E115:F115").Select
    ActiveWindow.SmallScroll Down:=-27
    Range("H66").Select
    Application.Run "'VDRF New 2.7.xlsm'!SHEETUNHIDE"
    ActiveSheet.Shapes.Range(Array("pv")).Select
    ActiveSheet.Shapes.Range(Array("pv")).Select
    Range("Q18:U18").Select
    ActiveCell.FormulaR1C1 = "New Duns creation"
    Range("Q19").Select
    Application.Run "'VDRF New 2.7.xlsm'!SHEETUNHIDE"
    ActiveSheet.Shapes.Range(Array("pv")).Select
    ActiveWindow.SmallScroll Down:=-192
    Range("Q18:U18").Select
    ActiveWindow.SmallScroll Down:=-15
    Range("Q18:U18").Select
    ActiveCell.FormulaR1C1 = "New Duns creation"
    Range("F239:U239").Select
    ActiveWindow.SmallScroll Down:=30
    ActiveWorkbook.Save
    ActiveWindow.SmallScroll Down:=-240
    Range("F20:L20").Select
    ActiveWindow.SmallScroll Down:=-123
    Application.Run "'VDRF New 2.7.xlsm'!pack_the_form_to_ready_for_use"
    ActiveWorkbook.Save
    ActiveWorkbook.Save
End Sub
Attribute VB_Name = "Module19"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Range("R603:U603,R605:U605").Select
    Range("R605").Activate
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$605="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("C605").Select
End Sub
Attribute VB_Name = "Module2"
Sub Macro13()
Attribute Macro13.VB_ProcData.VB_Invoke_Func = " \n14"
'
If Range("F20").Value = "Thailand" Then
On Error Resume Next
    ActiveSheet.Shapes.Range(Array("payee_chekbox")).delete

    With Range("H395").Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With
Else
    With Range("H395").Font
        .Color = -10477568
        .TintAndShade = 0
    End With

End If
On Error GoTo 0

End Sub
Sub Macro14()
Attribute Macro14.VB_ProcData.VB_Invoke_Func = " \n14"


ActiveWindow.ActivatePrevious.Select

End Sub
Attribute VB_Name = "Module3"
Sub Macro15()
Attribute Macro15.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro15 Macro
'

'
    ActiveSheet.Unprotect
    Selection.Locked = True
    Selection.FormulaHidden = False
End Sub
Attribute VB_Name = "Module4"
Sub Macro16()
Attribute Macro16.VB_ProcData.VB_Invoke_Func = " \n14"

Call UnPro
    
    If Range("E24").Value = "India" Then
    Range("E24").FormulaR1C1 = "GM Region"
    Range("G24").FormulaR1C1 = "GM IO Business Units"
    Range("N24").FormulaR1C1 = "PO ORG"
    Else
    Range("E24:P24").ClearContents
    End If
    
End Sub
Sub Macro17()
Attribute Macro17.VB_ProcData.VB_Invoke_Func = " \n14"
    
    ActiveCell.FormulaR1C1 = "FALSE"
    Range("F81").Locked = True
    'Selection.Locked = True
    Selection.FormulaHidden = True

End Sub
Sub Macro18()
Attribute Macro18.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro18 Macro
'

'
    ActiveSheet.Unprotect
    ActiveSheet.Shapes.Range(Array("tds")).Select
End Sub
Sub Macro19()
Attribute Macro19.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro19 Macro
'

'


End Sub
Sub Macro20()
Attribute Macro20.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro20 Macro
'

'
    Range("F124:J124").Select
    ActiveSheet.Unprotect
    Cells.FormatConditions.delete
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(RIGHT($O$120,4)=""ndia"",$F$124="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    ActiveCell.FormulaR1C1 = "fd"
    Range("F124:J124").Select
End Sub
Attribute VB_Name = "Module5"
Sub Macro21()
Attribute Macro21.VB_ProcData.VB_Invoke_Func = " \n14"
Call UnPro
If Range("O120").EntireRow.Hidden = False And Trim(UCase(Range("O120").Value)) = "INDIA" And Range("F124").Value = "" Then

        Range("F122").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($O$120))=""INDIA"",trim($F$124)="""")"
    Range("F122").FormatConditions(Range("F122").FormatConditions.Count).SetFirstPriority
    With Range("F122").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207 '10092543
        .TintAndShade = 0
    End With
    Range("F122").FormatConditions(1).StopIfTrue = False

chk = "fail"

Else
End If


countryucase = Trim(UCase(Range("M410").Value))
If Range("M410").EntireRow.Hidden = False And countryucase = "AUSTRALIA" And Range("M412").Value = "" Then

    Range("M412").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($M$410))=""AUSTRALIA"",trim($M$412)="""")"
    Range("M412").FormatConditions(Range("M412").FormatConditions.Count).SetFirstPriority
    With Range("M412").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Range("M412").FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

''    Range("M412").Select
''
''
''    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
''        "=AND($M$410=""australia"",$M$412="""")"
''    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
''    With Selection.FormatConditions(1).Interior
''        .PatternColorIndex = xlAutomatic
''        .Color = 6750207
''        .TintAndShade = 0
''    End With
''    Selection.FormatConditions(1).StopIfTrue = False
''    Range("F412:J412").Select
''    ActiveCell.FormulaR1C1 = "=AND(M410=""australia"",M412="""")"
''    Range("F412:J412").Select
''    Selection.ClearContents
''    Range("M410:U410").Select
''    ActiveCell.FormulaR1C1 = "Australia"
''    Range("N413").Select
End Sub
Attribute VB_Name = "Module6"
Sub Macro7()
Attribute Macro7.VB_ProcData.VB_Invoke_Func = " \n14"
'
Union(Range("F122:J122,F124:J124,F126:J126,F128:N128,F130:N130"), _
Range("F134:U134,F132:J132,M132:U132"), _
Range("F57:L57,F59:U59,E67:F67,L67:M67,F74:I74,F76:I76,P76:S76,P74:S74,F83:J83,F85:J85,M85:Q85,T85:U85,F89:J89,F91:J91,M89:Q89,M91:Q91,T89:U89,S96:U96,K94:O94,K96:O96,E94:H94,E96:H96,E98:H98,E100:H100,E102:H102,E105:H105,K102:O102,K100:O100,K98:O98,F109:L109"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120,F122:J122,F124:J124,O122:U122,O124:U124,O126:U126,F126:J126,F128:N128,F130:N130,F132:J132,M132:U132,F134:U134,F109:L109,F140:L140,F143:U143,F145:U145,F147:U147,F149:J149,F151:J151"), _
Range("M149:U149,M151:U151,F153:J153,F155:J155,M155:U155,M153:U153,F157:N157,F159:N159,F161:J161,M161:U161,F163:U163,F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180,F182:N182,F184:N184"), _
Range("O206:U206,F206:K206,F211:L211,F213:U213,F217:U219,F223:I223,O223:U223,F227:U229,F233:I233,O233:U233,F235:U237,F241:N241,F243:N243,F245:J245"), Range("M245:P245,S245:U245,F247:U247,F249:U251,F255:N255,F257:N257,F259:U261,F265:U265,F267:U267,F269:U269,F271:J271,M271:U271,F273:J273,F275:N275,F277:N277,F279:J279,M279:P279,S279:U279,F281:U281"), Range("F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180"), Range("F182:N182,F184:N184,F186:J186,M186:U186,F188:U188,F192:L192,F194:U194,F198:I198,F200:I200,F202:I202,P200:S200,P202:S202"), _
Range("F369:J369,N369:R369,F373:L373,F375:U375,F377:U377,F379:U379,F381:J381,M381:U381,M383:U383,F383:J383,F385:J385,M385:U385,F387:N387,F389:N389,F391:J391,M391:U391,F393:U393"), _
Range("F399:L399,F402:U402,F404:U404,F406:U406,F408:J408,M408:U408,F410:J410,M410:U410,M412:U412,F412:J412,F414:N414,F416:N416,F418:J418,M418:U418,F420:U420,F425:L425,F428:U428,F430:U430,F432:U432,F434:J434,M434:U434,F436:J436,M436:U436,M438:U438,F438:J438"), _
Range("F440:N440,F442:N442,F444:J444,M444:U444,F446:U446"), _
Range("F452:L452,F454:U454,F456:U456,F458:U458,F460:J460,M460:U460,F462:J462,M462:U462,F464:J464,M464:U464,F466:N466,F468:N468,F470:J470,M470:U470,F472:U472"), _
Range("F477:K477,O477:U477,F481:L481,F483:U483"), _
Range("F499:L499,F502:U502,F504:U504,F506:U506,F508:J508,M508:U508,M510:U510,F510:J510,F512:J512,M512:U512,F514:N514,F516:N516,F518:J518,M518:U518,F520:U520,F525:L525,F527:U527,F529:U529,F531:U531,F533:J533,M533:U533,M535:U535,F535:J535,F537:J537,M537:U537"), _
Range("F539:N539,F541:N541,F543:J543,M543:U543,F545:U545,F548:L548,F550:U550,F552:U552,F554:U554"), _
Range("F556:J556,M556:U556,M558:U558,F558:J558,F560:J560,M560:U560,F562:N562,F564:N564,F566:J566,M566:U566,F568:U568,F571:L571,F573:U573"), _
Range("F575:U575,F577:U577,F579:J579,M579:U579,F581:J581,M581:U581,F583:J583,M583:U583,F585:N585,F587:N587"), _
Range("F589:J589,M589:U589,F595:Q595,F597:Q597,T597:U597,F599:Q599,F601:I601,L601:N601,R601:U601,F603:N603,F605:N605,R603:U603,R605:U605"), _
Range("F610:Q610,F612:Q612,F614:Q614,T612:U612,F616:I616,L616:N616,R616:U616,F618:N618,F620:N620,R618:U618,R620:U620"), _
Range("F624:Q624,F626:Q626,T626:U626,F628:Q628,F630:I630,L630:N630,R630:U630,R632:U632,F632:N632,F634:N634,R634:U634"), _
Range("F637:Q637,F639:Q639,F641:Q641,T639:U639,F643:I643,L643:N643,R643:U643,R645:U645,F645:N645,F647:N647,R647:U647"), _
Range("F650:Q650,F652:Q652,T652:U652,F654:Q654,F656:I656,L656:N656,R656:U656,R658:U658,F658:N658,F660:N660,R660:U660"), _
Range("F663:Q663,F665:Q665,T665:U665,F667:Q667,F669:I669,L669:N669,R669:U669,R671:U671,F671:N671,F673:N673,R673:U673"), _
Range("D988:D992,F995:U997")).Select


End Sub
Attribute VB_Name = "Module7"
Sub Macro23()
Attribute Macro23.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro23 Macro
'

'
    Application.Run "'VDRF New 2.2.xlsm'!SHEETUNHIDE"
    Range("N44:O44").Select
    Application.Run "'VDRF New 2.2.xlsm'!SHEETUNHIDE"
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$43=TRUE, COUNTIF($T$43:$U$43,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    Selection.FormatConditions(1).StopIfTrue = False
End Sub
Attribute VB_Name = "Module8"
Sub ghj()
Dim s As Shape
'On Error Resume Next
For Each s In ActiveSheet.Shapes
's.Select
'aa = Selection.Value
''dd = Selection.Value
''s.Value = xlOff
'''s.AutoShapeType
's.OnAction = ""
s.SetShapesDefaultProperties
'MsgBox ss
Next
On Error GoTo 0


End Sub


Sub Query()
    WkbName = Range("q18").Value
    MyArray = Array("<", ">", "|", "/", "*", "\", "?", """")
    For x = LBound(MyArray) To UBound(MyArray)
        WkbName = Replace(WkbName, MyArray(x), "_", 1)
    Next x
    MsgBox WkbName
End Sub


Attribute VB_Name = "Module9"
Sub tds_lock_and_unlock_for_india()

If Range("F74").Value = "" Then Exit Sub
Call UnPro
If Range("Q18").Value = "New Duns/Vendor Code creation" And Range("F20").Value = "India" And Range("D63").Value = True And Left(Range("F74"), 8) = "Material" Then

Range("F81").Value = False
Range("J81").Value = True
Range("F81").Locked = True
Range("J81").Locked = True

Else
Range("F81").Value = False
Range("J81").Value = False
Range("F81").Locked = False
Range("J81").Locked = False
End If
Call Pro
End Sub

Sub india_pan_mandatory()
Call UnPro
If Range("O120").Value = "" Then Exit Sub
        Range("F124").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(RIGHT($O$120,4)=""ndia"",$F$124="""")"
    Range("F124").FormatConditions(Range("F124").FormatConditions.Count).SetFirstPriority
    With Range("F124").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Range("F124").FormatConditions(1).StopIfTrue = False

Call Pro
End Sub

Sub masschange_update()
   Sheets("Mass Change").Select
   Application.ScreenUpdating = True
   MsgBox "Please update the Mass Change details "
Sheets("Mass Change").Calculate
Range("A1").Select
   Call UnPro

End Sub




















Attribute VB_Name = "PO_Auditing"
Sub auditing_PO()
Application.ScreenUpdating = False
Sheets("Finder_PO").Range("A1:N1").FormulaR1C1 = "=MATCH(R[1]C,ALL_in_one!R,0)"



Sheets("PO_comparison").Select
Sheets("PO_comparison").Cells.delete Shift:=xlUp



    Sheets("Finder_PO").Range("A1:N1").Copy
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

Sheets("PO_comparison").Select
Range("A1").Select

Do

'MsgBox ActiveCell.Formula
    If ActiveCell.Formula = "#N/A" Then
    MsgBox ("Invalid SAP Extract"), vbCritical
    Sheets("control").Select
    Exit Sub
    Else
    If ActiveCell.Value = "" Then Exit Do
    ActiveCell.Offset(0, 1).Select
    End If

Loop

'Sheets("ALL_in_one").Select
    Sheets("ALL_in_one").UsedRange.AutoFilter Field:=134, Operator:= _
        xlFilterAutomaticFontColor

'Sheets("Finder_PO").Select


'Sheets("PO_comparison").Select
Range("A1").Select

Do

Sheets("ALL_in_one").Columns(ActiveCell.Value).SpecialCells(xlCellTypeVisible).Copy
ActiveSheet.Paste
ActiveCell.Offset(0, 1).Select
If ActiveCell.Value = "" Then Exit Do
Loop

'Sheets("ALL_in_one").Columns(3).SpecialCells(xlCellTypeVisible).Copy
'Range("X1").Select
'ActiveSheet.Paste

'Sub coc_length_adjustment()

Range("B2").Select
'''            Do
'''            If ActiveCell.Value = "" Then Exit Do
'''
'''                If Len(ActiveCell.Value) < 4 Then
'''                ActiveCell.Value = "'" & Right("0000" & ActiveCell.Value, 4)
'''                Else
'''                End If
'''
'''                'sort key
'''                If Len(ActiveCell.Offset(0, 5).Value) < 3 Then
'''                ActiveCell.Offset(0, 5).Value = "'" & Right("000" & ActiveCell.Offset(0, 5).Value, 3)
'''                Else
'''                End If
'''
'''
'''                If ActiveCell.Offset(0, -1).Value = "" Then
'''                ActiveCell.Offset(0, -1).FillDown
'''                Else
'''                End If
'''
'''                If ActiveCell.Offset(0, 1).Value = "" Then
'''                ActiveCell.Offset(0, 1).FillDown
'''                Else
'''                End If
'''
'''            ActiveCell.Offset(1, 0).Select
'''            Loop

    Sheets("Finder_PO").Range("C2:N2").Copy
    Sheets("PO_comparison").Select
    Range("P1").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("O1:A1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
        .PatternTintAndShade = 0
    End With




    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 15).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-14]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,2,0),VLOOKUP(R3C1,PO_mannual!C1:C24,2,0))=0,"""",IF(RC[-14]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,2,0),VLOOKUP(R3C1,PO_mannual!C1:C24,2,0))),""In Valid input"")"


    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 16).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-15]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,3,0),VLOOKUP(R3C1,PO_mannual!C1:C24,3,0))=0,"""",IF(RC[-15]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,3,0),VLOOKUP(R3C1,PO_mannual!C1:C24,3,0))),""In Valid input"")"


    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 17).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-16]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,4,0),VLOOKUP(R3C1,PO_mannual!C1:C24,4,0))=0,"""",IF(RC[-16]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,4,0),VLOOKUP(R3C1,PO_mannual!C1:C24,4,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 18).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-17]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,5,0),VLOOKUP(R3C1,PO_mannual!C1:C24,5,0))=0,"""",IF(RC[-17]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,5,0),VLOOKUP(R3C1,PO_mannual!C1:C24,5,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 19).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-18]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,6,0),VLOOKUP(R3C1,PO_mannual!C1:C24,6,0))=0,"""",IF(RC[-18]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,6,0),VLOOKUP(R3C1,PO_mannual!C1:C24,6,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 20).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-19]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,7,0),VLOOKUP(R3C1,PO_mannual!C1:C24,7,0))=0,"""",IF(RC[-19]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,7,0),VLOOKUP(R3C1,PO_mannual!C1:C24,7,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 21).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-20]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,8,0),VLOOKUP(R3C1,PO_mannual!C1:C24,8,0))=0,"""",IF(RC[-20]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,8,0),VLOOKUP(R3C1,PO_mannual!C1:C24,8,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 22).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-21]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,9,0),VLOOKUP(R3C1,PO_mannual!C1:C24,9,0))=0,"""",IF(RC[-21]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,9,0),VLOOKUP(R3C1,PO_mannual!C1:C24,9,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 23).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-22]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,10,0),VLOOKUP(R3C1,PO_mannual!C1:C24,10,0))=0,"""",IF(RC[-22]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,10,0),VLOOKUP(R3C1,PO_mannual!C1:C24,10,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 24).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-23]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,11,0),VLOOKUP(R3C1,PO_mannual!C1:C24,11,0))=0,"""",IF(RC[-23]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,11,0),VLOOKUP(R3C1,PO_mannual!C1:C24,11,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 25).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-24]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,12,0),VLOOKUP(R3C1,PO_mannual!C1:C24,12,0))=0,"""",IF(RC[-24]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,12,0),VLOOKUP(R3C1,PO_mannual!C1:C24,12,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 26).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-25]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,13,0),VLOOKUP(R3C1,PO_mannual!C1:C24,13,0))=0,"""",IF(RC[-25]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,13,0),VLOOKUP(R3C1,PO_mannual!C1:C24,13,0))),""In Valid input"")"



'===============================
'
'    Range(Range("A1048576").End(xlUp).Offset(0, 3), Range("M2")).SpecialCells(xlCellTypeVisible).Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=D1<>O1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 16767487
'        .TintAndShade = 0
'    End With
'==================
'Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 12).FormulaR1C1 = _
    "=IFERROR(VLOOKUP(RC[-11],COC_Mannual!C[-12],1,0),""error"")"

Range("O2").Select
Do
'On Error Resume Next
If ActiveCell.Value = "" Then Exit Do

    If ActiveCell.Value = "error" Then
    ActiveCell.EntireRow.delete
    Else
    ActiveCell.Offset(1, 0).Select
    End If

Loop

''Range("A2").Select
''        Do
''
''        If ActiveCell.Value = "" Then Exit Do
''
''            If ActiveCell.Offset(0, 7).Value = "" Then
''
''            Else
''            ActiveCell.Offset(0, 7).Value = "YES"
''            End If
''        ActiveCell.Offset(1, 0).Select
''        Loop

    Range("C2").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=C2<>P2"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.Copy
    Range(Range("A1048576").End(xlUp).Offset(0, 2), Range("N2")).SpecialCells(xlCellTypeVisible).Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False

    Range("A2").Select
    ActiveWindow.FreezePanes = True

''    Columns("X:X").Select
''    Selection.Cut
''    Columns("C:C").Select
''    Selection.Insert Shift:=xlToRight

Range("A1").Select
MsgBox "Finished!..", vbInformation
End Sub


Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton6, 1213, 1, MSForms, CommandButton"
Attribute VB_Control = "CheckBox1, 606, 2, MSForms, CheckBox"
Attribute VB_Control = "CommandButton4, 62, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 61, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 8, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 6, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 1105, 7, MSForms, CommandButton"
Attribute VB_Control = "ComboBox1, 1211, 8, MSForms, ComboBox"

Private Sub CheckBox1_Click()

If CheckBox1.Value = True Then
Range("F236").Value = "Please Apply For DUNS"
MsgBox "Please Apply for DUNS"
Else
Range("F236").Value = ""
End If
End Sub


Private Sub ComboBox1_Change()
If ActiveSheet.Name = "GM EU Form" Then Else Exit Sub
If ActiveSheet.Name = "GM EU Form" Then
 'If Range("Q18").Value = "" Then MsgBox "Please update Submition Reason before updating Business Units"
        If Range("f20").Value = "" Then Range("A1").Select
        'If Range("f20").Value = "" Then Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(25500, 25500, 0) 'yellow
        
        If Range("f20").Value = "" Then Else Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
        
'            If Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.Value = "See GM Units Multiple Business Units Tab" Then MsgBox "Yes"
'            Sheets("GM Europe Multiple BU &PO").Visible = True
'            Call reseting_GM_BU_multiple_business_field
'            application.ScreenUpdating = True
'            MsgBox "Please select GM Units and respective PO"
'            application.ScreenUpdating = False
        
Else
End If
End Sub

Private Sub ComboBox1_Click()
If ActiveSheet.Name = "GM EU Form" Then Else Exit Sub
   If ActiveSheet.Name = "GM EU Form" Then
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
        Call UnPro

        ' Display a message when one of the designated cells has been
        ' changed.
        
        'MsgBox "Cell " & Target.Address & " has changed."
        If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then
        On Error Resume Next
                    'Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here for multiple Business Unit and Purchase ORG list"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
            Else
            On Error Resume Next
                    If ActiveSheet.ProtectContents = True Then Call UnPro
                    If Range("f20").Value = "See Mass Change tab" Then Else Range("F21:N21").ClearContents
                    Sheets("GM Europe Multiple BU &PO").Visible = False
'                    Range("F21:N21").Locked = True
            
        End If
        On Error GoTo 0

        If Range("f20").Value = "See Mass Change tab" Then
        On Error Resume Next
                    'Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here for updating Mass Change details."
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
                    Sheets("Mass change").Visible = True
            Else
            
            On Error Resume Next
                    If ActiveSheet.ProtectContents = True Then Call UnPro
                   If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then Else Range("F21:N21").ClearContents
                    'Sheets("GM Europe Multiple BU &PO").Visible = False
'                    Range("F21:N21").Locked = True
            
        End If
        On Error GoTo 0

        Call Pro
'    End If
        If Range("f20").Value = "" Then Range("A1").Select
        If Range("F20").Value = "GM Greece - 5H20" Then
                On Error Resume Next
                If Range("B355").EntireRow.Hidden = False Then
                Call UnPro
                
                Range("B354:B429").EntireRow.Hidden = True
                ActiveSheet.CheckBoxes("Checkbox_19").delete
                ActiveSheet.CheckBoxes("Checkbox_20").delete
                ActiveSheet.CheckBoxes("Checkbox_21").delete
                ActiveSheet.CheckBoxes("Checkbox_22").delete
                ActiveSheet.CheckBoxes("Checkbox_23").delete
                ActiveSheet.CheckBoxes("Checkbox_24").delete
                ActiveSheet.CheckBoxes("Checkbox_25").delete
                
                On Error GoTo 0
                Call Pro
                Else
                End If
        Else
        End If
Else
End If
End Sub

Private Sub ComboBox1_GotFocus()
    ComboBox1.ListFillRange = "DropDownLista"
    Me.ComboBox1.DropDown
End Sub

Private Sub CommandButton1_Click()
Call sheetselection
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()

Sheets("GM EU Form").Range("A1").Value = "fu"

Sheets("Index").Range("A1").Value = "furtherupdate"
Sheets("Index").Range("B1").Value = ActiveSheet.Name

Call GM_E_only_validation
'UserForm1.CommandButton7.Visible = True
Call justsave
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton3_Click()

ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select


Call Group9_Click
UnPro
'Range("A1").Value = "S"

        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r & ".xlsm"), FileFormat:=ThisWorkbook.FileFormat
dddnew = ActiveWorkbook.Name
'Windows(ddd).Activate
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Windows(dddnew).Activate

Call Pro
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
Call Group9_Click
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Range("F10").Select
Application.ScreenUpdating = True
End Sub

Private Sub OptionButton1_Click()
'Range("Q3331").Value = "OL"

End Sub

Private Sub OptionButton2_Click()
'Range("Q3331").Value = "WM"
End Sub

Private Sub CommandButton5_Click()
Instruction.Show
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()

mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Application.ScreenUpdating = True
End Sub

Private Sub submit_Click()

mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Application.ScreenUpdating = True
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
If ActiveSheet.Name = "GM EU Form" Then Else Exit Sub
Application.ScreenUpdating = False
Dim KeyCells As Range
 Set KeyCells = Range("Q18")
 
On Error GoTo aaa
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
     If ActiveSheet.ProtectContents = True Then Call UnPro
'continue option visible/invisible
     Sheets("GM EU Form").Range("A1").Value = ""
     Sheets("Index").Range("A1").Value = ""
     'UserForm1.CommandButton7.Visible = False

     
     Range("W1:W3326").ClearContents
    'Range("F20").Value = ""
'    Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.Value = ""


     'Hide unwanted fields
If Sheets("GM EU Form").ProtectContents = True Then Call UnPro
Sheets("GM EU Form").Cells.FormatConditions.delete

'this is for removing yellow highlight'-------------------
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
'--------------------------------------------------------

Call GM_EU_form_entire_field_reset
Cells.ClearComments
'Call reseting_GM_BU_multiple_business_field
Call hideall12



    'delete all check box in BU multiple sheets to reset
'Call checkdelete
'Call reseting_GM_BU_multiple_business_field
'Dim changed As Range
'Dim iLastRow As Long
'Dim i As Long
'Set changed = Intersect(Target, Worksheets("GM EU Form").Range("F18"))
'If Not changed Is Nothing Then
'Worksheets("Multiple BU Tab").Range("B24:B190").EntireRow.Hidden = True
'Select Case Target.Value
'Case "GM Europe"
'Worksheets("Multiple BU Tab").Range("C2:C48").EntireRow.Hidden = False
'Case "GM IO"


If Range("f18").Value = "GM IO" And Range("Q18").Value = "New Duns/Vendor Code creation" Or Range("f18").Value = "GM Europe" And Range("Q18").Value = "New Duns creation" Then
Worksheets("GM EU Form").Activate
Range("B115:B118").Select
    Selection.EntireRow.Hidden = False
    Range("B235:B262").Select
    Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False
 Range("B64:B66").Select
    Selection.EntireRow.Hidden = False
    Range("B423:B429").Select
    Selection.EntireRow.Hidden = False

Range("A442:A446").EntireRow.Hidden = False
Range("f18").Select

'Edit
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False


End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Contact Details Modification" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Hidden = False
Rows("430:441").Hidden = False

'Rows("442:446").Hidden = False
'Rows("120:124").Select
'    Selection.EntireRow.Hidden = False
'Rows("408:419").Select
'    Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
Worksheets("GM EU Form").Activate
Rows("119:124").Select
    Selection.EntireRow.Hidden = False
    Rows("153:161").Select
    Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Modify Payment Terms" Then
Worksheets("GM EU Form").Activate
Rows("119:131").Select
    Selection.EntireRow.Hidden = False
Range("f18").Select
End If
If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Modify Payment Method" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("132:138").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Inactivation/Mark for Deletion" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("139:145").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Others - enter Details in Comments column" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("167:171").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Email ID set up" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("146:152").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Name / Address modification" Then
Worksheets("GM EU Form").Activate
    Range("B214:B234").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False
Range("f18").Select
End If
If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Bank Account Maintenance" Then
Worksheets("GM EU Form").Activate
    Range("B37:B45").Select
Selection.EntireRow.Hidden = False
Rows("474:478").Hidden = False

Range("f18").Select
End If
If Range("f18").Value = "GM Europe" And Range("Q18").Value = "UBD request [User Block Duns]" Then
Worksheets("GM EU Form").Activate
    Range("B235:B263").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False

     Range("B354:B367").Select
Selection.EntireRow.Hidden = False


Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Factoring Set up" Then
Worksheets("GM EU Form").Activate
    Range("B120:B124").Select
Selection.EntireRow.Hidden = False
   Range("B193:B213").Select
   Selection.EntireRow.Hidden = False
   Rows("442:446").Hidden = False
   Rows("442:446").Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Mass changes" Then
Worksheets("GM EU Form").Activate
    Range("B120:B122").Select
Selection.EntireRow.Hidden = False
   Range("B163:B166").Select
   Selection.EntireRow.Hidden = False
       Sheets("Mass Change").Visible = True
    Sheets("Mass Change").Move After:=Sheets("GM EU Form")
     'Sheets("Mass Change").Select
     
     Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
     Sheets("Mass Change").Range("G1").FormulaR1C1 = "GM EU Form"
     masschangeselect = True
     Sheets("GM EU Form").Select

End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Alternative Payee set up" Then
Worksheets("GM EU Form").Activate
    Range("B120:B124").Select
Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False

Selection.EntireRow.Hidden = False
   Range("B172:B192").Select
   Selection.EntireRow.Hidden = False
   Rows("442:446").Hidden = False
End If


Call hidecheckeu


'Case "GM NA"
'Worksheets("Multiple BU Tab").Range("C75:C105").EntireRow.Hidden = False
'Case "GM SA"
'Worksheets("Multiple BU Tab").Range("C110:C124").EntireRow.Hidden = False
'End Select
'End If

If Range("Q18").Value <> "Mass changes" And Sheets("Mass Change").Visible = True Then
Sheets("Mass Change").Visible = 2
End If

'=====================================
        If Range("F236").EntireRow.Hidden = False Then
'            If ActiveSheet.CheckBoxes("gg").Visible = True Then
            'Else
                Call UnPro
                    
                    ActiveSheet.CheckBoxes.Add(Cells(236, "M").Left, _
                                                Cells(236, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 236
                        .Display3DShading = True
                '        .lock = False
                        .Name = "gg"
                        .OnAction = "header_duns_checkbox_tick"
                    End With
        '            Call Pro
                    'Next
            'End If
        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    'Selection.Delete
                    On Error GoTo 0
            'End If
        End If
      '  If Sheets("GM EU Form").Range("F236").EntireRow.Hidden = True Then Else Sheets("GM EU Form").CheckBox1.Visible = True
      '  If Sheets("GM EU Form").Range("F236").EntireRow.Hidden = True Then Sheets("GM EU Form").CheckBox1.Visible = False

'======================================
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll Down:=9

If ActiveSheet.ProtectContents = False Then Call Pro

'If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Mass changes" Then Sheets("Mass Change").Select
'    'And masschangeselect = "True"

End If

'===============
'hide unhide check boxes in main sheet
'Header Duns is not updated then tick box should be created and have option to update the same in f236
'==================

'==================
    ' The variable KeyCells contains the cells that will
    ' cause an alert when they are changed.
    Set KeyCells = Range("F20")
    
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
        Call UnPro

        ' Display a message when one of the designated cells has been
        ' changed.
        
        'MsgBox "Cell " & Target.Address & " has changed."
        If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then
                    Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here for multiple Business Unit and Purchase ORG list"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
            Sheets("GM Europe Multiple BU &PO").Visible = True
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
                    Range("F21:N21").ClearContents
                    Sheets("GM Europe Multiple BU &PO").Visible = False
                    'Range("F21:N21").Locked = True
        End If

        If Range("f20").Value = "See Mass Change tab" Then
                    Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here to update Mass Change Details"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
            Sheets("Mass Change").Visible = True
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
                    Range("F21:N21").ClearContents
                    'Sheets("GM Europe Multiple BU &PO").Visible = False
                    'Range("F21:N21").Locked = True
        End If
'Click here to update Mass Change Details

        Call Pro


   End If
'================================
'''Application.ScreenUpdating = False



'additional bank account
 Set KeyCells = Range("V367")
 
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    
        If Range("V367").EntireRow.Hidden = False Then
        Call UnPro
        Range("b368:b422").EntireRow.Hidden = True

                numberofbank = Range("V367").Value
                If numberofbank = "" Then
                Else
                    
                    If numberofbank = 1 Then Range("b368:b378").EntireRow.Hidden = False

                    
                    If numberofbank = 2 Then Range("b368:b389").EntireRow.Hidden = False


                    If numberofbank = 3 Then Range("b368:b400").EntireRow.Hidden = False

                    
                    If numberofbank = 4 Then Range("b368:b411").EntireRow.Hidden = False


                    
                    If numberofbank = 5 Then Range("b368:b422").EntireRow.Hidden = False
                
                    If numberofbank > 5 Then MsgBox "Maximum Additional Bank can be added is 5"
                Call Pro
                End If
        
        Else
        End If
        
    Else
    End If
    

aaa:
On Error GoTo 0
'Exit Sub
'================================
End Sub

'Private Sub Worksheet_Change2(ByVal Target As Range)
'Dim fld As Range
' Set fld = Range("F10")
'
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'           Is Nothing Then
'If Range("f18").Value = "" Then Selection.Interior.Color = 65535 Else Selection.Interior.Pattern = xlNone
'
'End Sub
'
''Private Sub Worksheet_Change(ByVal Target As Range)
''Dim KeyCells As Range
'' Set KeyCells = Range("F12")
''
''    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
''           Is Nothing Then
''
''End Sub
        ''''======================
        '''Private Sub Worksheet_SelectionChange(ByVal Target As Range)
        '''Dim fld As Range
        ''' 'Set fld = Range("F10")
        ''' 'If ActiveCell.Address = "$F$10" Then
        '''
        '''     If Range("f10").EntireRow.Hidden = False Then If Range("f10").Value = "" Then Range("f10").Interior.Color = 65535 Else Range("f10").Interior.Pattern = xlNone
        '''     If Range("f14").EntireRow.Hidden = False Then If Range("f14").Value = "" Then Range("f14").Interior.Color = 65535 Else Range("f14").Interior.Pattern = xlNone
        '''    'Please input the requester name
        '''     If Range("f18").EntireRow.Hidden = False Then If Range("f18").Value = "Please input the requester name" Then Range("f18").Interior.Color = 65535 Else Range("f18").Interior.Pattern = xlNone
        '''     If Range("q18").EntireRow.Hidden = False Then If Range("q18").Value = "" Then Range("q18").Interior.Color = 65535 Else Range("q18").Interior.Pattern = xlNone
        '''     If Range("f20").EntireRow.Hidden = False Then If Range("f20").Value = "" Then Range("f20").Interior.Color = 65535 Else Range("f20").Interior.Pattern = xlNone
        '''
        '''End Sub



Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
  'Check if the Target Address is same as you have given
    'In the above example i have taken A4 Cell, so I am
    'Comparing this with $A$4

    If Target.Range.Address = "$F$21" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
    'MsgBox "Row " & ActiveCell.Row & " is clicked"
    If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then
    Call Pentagon11_Click
    Else
    End If

    If Range("F20").Value = "See Mass Change tab" Then
    mm = ActiveSheet.Name
    Sheets("Mass Change").Select
    Sheets("Index").Range("C1").Value = mm
    Else
    End If

    End If

        If Target.Range.Address = "$F$288" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
        UserForm2.Show
    
        Exit Sub
    End If


End Sub



Sub nidhi()

End Sub













Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 2, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 3, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 4, 4, MSForms, CommandButton"
Attribute VB_Control = "CheckBox1, 6, 5, MSForms, CheckBox"
Attribute VB_Control = "CommandButton5, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 9, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 35, 8, MSForms, CommandButton"

Private Sub CommandButton1_Click()
Call sheetselection
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()

Sheets("GM EU Form").Range("A1").Value = "fu"

Sheets("Index").Range("A1").Value = "furtherupdate"
Sheets("Index").Range("B1").Value = ActiveSheet.Name

'UserForm1.CommandButton7.Visible = True
Call justsave
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton3_Click()

ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select


'Call Group9_Click' deactivated for GM NA
UnPro
'Range("A1").Value = "S"

        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r & ".xlsm"), FileFormat:=ThisWorkbook.FileFormat
dddnew = ActiveWorkbook.Name
'Windows(ddd).Activate
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Windows(dddnew).Activate

Call Pro
Application.ScreenUpdating = True
End Sub



Private Sub CommandButton4_Click()
'Call Group9_Click deactivated for GM NA
    'ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Range("Q18:U18").ClearContents
Range("F20:L20").ClearContents
'Range("Q20:U20").ClearContents

Range("F10").Select
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton5_Click()
Instruction.Show
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()
'Exit Sub
Application.ScreenUpdating = False
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
'Application.ScreenUpdating = True
End Sub

Private Sub submit_Click()

'Exit Sub
Application.ScreenUpdating = False
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
'Application.ScreenUpdating = True
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
If ActiveSheet.Name = "GM_NA" Then Else Exit Sub
Application.ScreenUpdating = False
Dim KeyCells As Range


        Set KeyCells = Range("I711")
    
        If Not Application.Intersect(KeyCells, Range(Target.Address)) _
               Is Nothing Then
        Call ms
        End If
    
 Set KeyCells = Range("Q18")

'Exit Sub
'On Error GoTo aaa
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
     If ActiveSheet.ProtectContents = True Then Call UnPro
'continue option visible/invisible
     Sheets("GM_NA").Range("A1").Value = ""
     Sheets("Index").Range("A1").Value = ""
     'UserForm1.CommandButton7.Visible = False

     
     Range("W1:W3326").ClearContents
    'Range("F20").Value = ""
'    Worksheets("GM_NA").OLEObjects("ComboBox1").Object.Value = ""


     'Hide unwanted fields
If Sheets("GM_NA").ProtectContents = True Then Call UnPro
Sheets("GM_NA").Cells.FormatConditions.delete

'this is for removing yellow highlight'-------------------
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
'--------------------------------------------------------

'Call GM_EU_form_entire_field_reset
'Call reseting_GM_BU_multiple_business_field
'Call hideall13



    'delete all check box in BU multiple sheets to reset
'Call checkdelete
'Call reseting_GM_BU_multiple_business_field
'Dim changed As Range
'Dim iLastRow As Long
'Dim i As Long
'Set changed = Intersect(Target, Worksheets("GM_NA").Range("F18"))
'If Not changed Is Nothing Then
'Worksheets("Multiple BU Tab").Range("B24:B190").EntireRow.Hidden = True
'Select Case Target.Value
'Case "GM North America"
'Worksheets("Multiple BU Tab").Range("C2:C48").EntireRow.Hidden = False
'Case "GM IO"
'Call UnPro
Call clear_all_checkbox
Call clear_all_field_GM_NA
Cells.ClearComments
Range("B24:B3325").EntireRow.Hidden = True
Range("A22:A23").EntireRow.Hidden = True

If Range("f18").Value = "GM North America" And Range("Q18").Value = "New Duns/Vendor Code creation" Or Range("f18").Value = "GM North America" And Range("Q18").Value = "New Duns creation" Then
Worksheets("GM_NA").Activate
Range("B114:B118").Select
    Selection.EntireRow.Hidden = False
    Range("B235:B262").Select
    Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False
 Range("B64:B66").EntireRow.Hidden = False
    Range("A565:A569").Select
    Selection.EntireRow.Hidden = False

Range("A546:A552").EntireRow.Hidden = True
'Range("A62:A63").EntireRow.Hidden = True

Range("f18").Select

'Edit
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False

Call GM_NA_vendorcatogery_and_its_checkboxes
Call EFTCheque_GM_NA_for_banking_details
Call GM_NA_remi_ship_header

End If


'CSIDS===================================================================

If Range("f18").Value = "GM North America" And Range("Q18").Value = "GPS/CCA/Logistics Request" Then
'Call UnPro
Worksheets("GM_NA").Activate
Range("F20:L20").Value = "Not Applicable"
Call UnPro
Range("A666:A748").EntireRow.Hidden = False
'Range("A742:A748").EntireRow.Hidden = False

Range("A713:A720").EntireRow.Hidden = True
Range("A669:A672").EntireRow.Hidden = True
Range("A677:A683").EntireRow.Hidden = True
Range("A705:A710").EntireRow.Hidden = True

'Range("A676").EntireRow.Hidden = True

Range("A677:A679").EntireRow.Hidden = False
'Range("A546:A552").EntireRow.Hidden = True
'Range("A62:A63").EntireRow.Hidden = True

'Call GM_NA_vendorcatogery_and_its_checkboxes
'Call EFTCheque_GM_NA_for_banking_details
'Call GM_NA_remi_ship_header
Else
'Call UnPro
Range("F20:L20").Value = ""
Call UnPro

End If



'========================================================================
'CMBS Vendor Creation (DACOR)
If Range("f18").Value = "GM North America" And Range("Q18").Value = "CMBS Vendor Creation (DACOR)" Then
Worksheets("GM_NA").Activate
Range("B114:B118").Select
    Selection.EntireRow.Hidden = False
    Range("B235:B262").Select
    Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False
 Range("B64:B66").Select
    Selection.EntireRow.Hidden = False
    Range("A565:A569").Select
    Selection.EntireRow.Hidden = False

Range("A546:A552").EntireRow.Hidden = False
'Range("A62:A63").EntireRow.Hidden = True
Range("f18").Select
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False
'Range("Q20").Value = "DACOR"

Call GM_NA_vendorcatogery_and_its_checkboxes
Call EFTCheque_GM_NA_for_banking_details
Call GM_NA_remi_ship_header
End If


If Range("Q18").Value = "Payment Block/Unblock" Or Range("Q18").Value = "Payment/Posting/Purchasing Block or Unblock" Then
Worksheets("GM_NA").Activate
Range("A214:A219").EntireRow.Hidden = False
'Range("A62:A63").EntireRow.Hidden = True
'Call GM_NA_vendorcatogery_and_its_checkboxes
'Call EFTCheque_GM_NA_for_banking_details
'Call GM_NA_remi_ship_header
'Range("A546:A552").EntireRow.Hidden = False
Range("A565:A569").EntireRow.Hidden = False
Range("A528:A530").EntireRow.Hidden = False

End If


If Range("f18").Value = "GM North America" And Range("Q18").Value = "Tier-2 Vendor Addition" Then
Worksheets("GM_NA").Activate

Range("A217:A234").EntireRow.Hidden = False
Range("A546:A552").EntireRow.Hidden = False

Range("f18").Select

'Edit
'    With Range("F236:L236").Interior
 '       .Pattern = xlNone
  '      .TintAndShade = 0
   '     .PatternTintAndShade = 0
   ' End With
   ' Range("F236:L236").Locked = False

'Call GM_NA_vendorcatogery_and_its_checkboxes

End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Contact Details Modification" Then
Worksheets("GM_NA").Activate
'Rows("120:124").Hidden = False
'Rows("430:441").Hidden = False
Range("A218:A234").EntireRow.Hidden = False
Range("B122:B123").EntireRow.Hidden = True

Range("A120:A124,A146:A152").EntireRow.Hidden = False
Range("A149:A152").EntireRow.Hidden = True
Range("A146:A148").EntireRow.Hidden = True

Range("A542:A544,A553:A561,A565:A569").EntireRow.Hidden = False

'Rows("442:446").Hidden = False
'Rows("120:124").Select
'    Selection.EntireRow.Hidden = False
'Rows("408:419").Select
'    Selection.EntireRow.Hidden = False

Call GM_NA_E_Mail_ID_setup_checkbox
Range("f18").Select
End If


''If Range("f18").Value = "GM North America" And Range("Q18").Value = "Email ID set up" Then
''Worksheets("GM_NA").Activate
''Rows("120:124").Select
''    Selection.EntireRow.Hidden = False
''    Rows("146:152").Select
''Selection.EntireRow.Hidden = False
''Rows("442:446").Hidden = False
''Call GM_NA_E_Mail_ID_setup_checkbox
''Range("f18").Select
''End If


If Range("f18").Value = "GM North America" And Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
Worksheets("GM_NA").Activate
'Rows("119:124").EntireRow.Hidden = False
Rows("153:161").EntireRow.Hidden = False
Range("A214:A234").EntireRow.Hidden = False
Range("A442:A446").EntireRow.Hidden = False

Range("f18").Select
End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Modify Payment Terms" Then
Worksheets("GM_NA").Activate
Rows("119:131").Select
    Selection.EntireRow.Hidden = False
    
'Range("B64:B66").EntireRow.Hidden = False
'Call GM_NA_vendorcatogery_and_its_checkboxes

    
Call GM_NA_Modified_P_term_checkbox
Range("f18").Select
End If
If Range("f18").Value = "GM North America" And Range("Q18").Value = "Modify Payment Method" Then
Worksheets("GM_NA").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("132:138").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Inactivation/Mark for Deletion" Then
Worksheets("GM_NA").Activate
'Rows("120:124").Select
 '   Selection.EntireRow.Hidden = False
    Rows("139:145").Select
Selection.EntireRow.Hidden = False
Range("A214:A234").EntireRow.Hidden = False
'A442:A446
'Range("A442:A446").EntireRow.Hidden = False

Range("f18").Select
End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Others - enter Details in Comments column" Then
Worksheets("GM_NA").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("167:171").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If


If Range("f18").Value = "GM North America" And Range("Q18").Value = "Name / Address modification" Then
Worksheets("GM_NA").Activate
Range("B215:B234").EntireRow.Hidden = False
'Rows("442:446").Hidden = False

Range("B109:B110").EntireRow.Hidden = False
Range("A572:A599").EntireRow.Hidden = False

Range("f18").Select

End If
If Range("f18").Value = "GM North America" And Range("Q18").Value = "Bank Account Maintenance" Then
Worksheets("GM_NA").Activate
    Range("B41:B45").Select
Selection.EntireRow.Hidden = False
Range("A565:A569").EntireRow.Hidden = False

Call GM_NA_bank_ac_maintanance_checkbox

Range("A23:A35").EntireRow.Hidden = False

Range("f18").Select
End If
If Range("f18").Value = "GM North America" And Range("Q18").Value = "UBD request [User Block Duns]" Then
Worksheets("GM_NA").Activate
    Range("B235:B263").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False
Range("f18").Select
End If

''''    If Range("f18").Value = "GM North America" And Range("Q18").Value = "Factoring Set up" Then
''''    Worksheets("GM_NA").Activate
''''        Range("B120:B124").Select
''''    Selection.EntireRow.Hidden = False
''''       Range("B193:B213").Select
''''       Selection.EntireRow.Hidden = False
''''       Rows("442:446").Hidden = False
''''       Rows("442:446").Hidden = False
''''    Range("f18").Select
''''    End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Mass changes" Then
Worksheets("GM_NA").Activate
    Range("B120:B122").Select
Selection.EntireRow.Hidden = False
   Range("B163:B166").Select
   Selection.EntireRow.Hidden = False
       Sheets("Mass Change").Visible = True
    Sheets("Mass Change").Move After:=Sheets("GM_NA")
     'Sheets("Mass Change").Select
     
     Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
     Sheets("Mass Change").Range("G1").FormulaR1C1 = "GM_NA"
     masschangeselect = True
     Sheets("GM_NA").Select

End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Alternative Payee/Factoring Setup" Then

Worksheets("GM_NA").Activate
Range("B120:B124").Select
    
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False


Range("A235:A260").EntireRow.Hidden = False

Selection.EntireRow.Hidden = False
   Range("B172:B192").Select
   Selection.EntireRow.Hidden = False
   Rows("442:446").Hidden = False

Call EFTCheque_GM_NA_for_banking_details

End If

'Call GM_NA_Additional_banking_information
'Call hidecheckeu


'Case "GM NA"
'Worksheets("Multiple BU Tab").Range("C75:C105").EntireRow.Hidden = False
'Case "GM SA"
'Worksheets("Multiple BU Tab").Range("C110:C124").EntireRow.Hidden = False
'End Select
'End If

If Range("Q18").Value <> "Mass changes" And Sheets("Mass Change").Visible = True Then
Sheets("Mass Change").Visible = 2
End If

Call GM_NA_DCB

'=====================================
      '  If Sheets("GM_NA").Range("F236").EntireRow.Hidden = True Then Else Sheets("GM_NA").CheckBox1.Visible = True
      '  If Sheets("GM_NA").Range("F236").EntireRow.Hidden = True Then Sheets("GM_NA").CheckBox1.Visible = False

'======================================
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll Down:=9

If ActiveSheet.ProtectContents = False Then Call Pro

'If Range("f18").Value = "GM North America" And Range("Q18").Value = "Mass changes" Then Sheets("Mass Change").Select
'    'And masschangeselect = "True"

'Call format_condition_for_all_reasons_for_mandatory_field
End If

'===============
'hide unhide check boxes in main sheet
'Header Duns is not updated then tick box should be created and have option to update the same in f236
'==================

'==================
    ' The variable KeyCells contains the cells that will
    ' cause an alert when they are changed.
    Set KeyCells = Range("F20")
    
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
        Call UnPro

Range("B77:B79").EntireRow.Hidden = True
    Range("E66").Value = False
    Range("H66").Value = False
    Range("K66").Value = False
    Range("N66").Value = False
    Range("P66").Value = False
    Range("S66").Value = False

        ' Display a message when one of the designated cells has been
        ' changed.
        
        'MsgBox "Cell " & Target.Address & " has changed."
        If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then
                    Range("F21:N21").Locked = False

                    Range("F21").FormulaR1C1 = "Click here for multiple Business Unit and Purchase ORG list"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM_NA'!F21"
            Sheets("GM_NA_Multiple_BU").Visible = True
            
            If Range("A65").EntireRow.Hidden = False Then Range("F21:N21").ClearContents
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
                    Range("F21:N21").ClearContents
                    Sheets("GM_NA_Multiple_BU").Visible = False
                    'Range("F21:N21").Locked = True
        End If

        If Range("f20").Value = "See Mass Change tab" Then
                    Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here to update Mass Change Details"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM_NA'!F21"
            Sheets("Mass Change").Visible = True
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
            
                    If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then Else Range("F21:N21").ClearContents
                    'Sheets("GM_NA_Multiple_BU").Visible = False
                    'Range("F21:N21").Locked = True
        End If
'Click here to update Mass Change Details

        Call Pro


   End If
'================================
'''Application.ScreenUpdating = False


                         Set KeyCells = Range("F69")

                        'Exit Sub
                        'On Error GoTo aaa
                            If Not Application.Intersect(KeyCells, Range(Target.Address)) _
                                   Is Nothing Then
                            Call UnPro
                            If Range("f69").Value = "Yes" Then

                                Range("O115").Value = "SRV - Services- Not Applicable"
                                Range("O117").Value = "Services- Not Applicable"

                                Range("O115:T115,O117:U117").Select
                                With Selection.Interior
                                    .Pattern = xlSolid
                                    .PatternColorIndex = xlAutomatic
                                    .ThemeColor = xlThemeColorAccent5
                                    .TintAndShade = 0.799981688894314
                                    .PatternTintAndShade = 0
                                End With
                                Selection.Locked = True
                                Range("F69:H69").Select
                                
                            Else
                            
                                Range("O115:T115,O117:U117").Select
                                Selection.ClearContents
                                
                                
                                If Range("K66").Value = True Then
                                Else
    
                                    Selection.Locked = False
                                    With Selection.Interior
                                        .Pattern = xlNone
                                        .TintAndShade = 0
                                        .PatternTintAndShade = 0
                                    End With
                                End If
                                    Range("F69:H69").Select
                            End If

                            Call Pro
                            End If

'additional bank account
''''''' Set KeyCells = Range("V367")
'''''''
'''''''    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'''''''           Is Nothing Then
'''''''
'''''''        If Range("V367").EntireRow.Hidden = False Then
'''''''        Call UnPro
'''''''        Range("b368:b422").EntireRow.Hidden = True
'''''''
'''''''                numberofbank = Range("V367").Value
'''''''                If numberofbank = "" Then
'''''''                Else
'''''''
'''''''                    If numberofbank = 1 Then Range("b368:b378").EntireRow.Hidden = False
'''''''
'''''''
'''''''                    If numberofbank = 2 Then Range("b368:b389").EntireRow.Hidden = False
'''''''
'''''''
'''''''                    If numberofbank = 3 Then Range("b368:b400").EntireRow.Hidden = False
'''''''
'''''''
'''''''                    If numberofbank = 4 Then Range("b368:b411").EntireRow.Hidden = False
'''''''
'''''''
'''''''
'''''''                    If numberofbank = 5 Then Range("b368:b422").EntireRow.Hidden = False
'''''''
'''''''                    If numberofbank > 5 Then MsgBox "Maximum Additional Bank can be added is 5"
'''''''                Call Pro
'''''''                End If
'''''''
'''''''        Else
'''''''        End If
'''''''
'''''''    Else
'''''''    End If
    

aaa:
On Error GoTo 0
'Exit Sub
'================================
End Sub

'Private Sub Worksheet_Change2(ByVal Target As Range)
'Dim fld As Range
' Set fld = Range("F10")
'
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'           Is Nothing Then
'If Range("f18").Value = "" Then Selection.Interior.Color = 65535 Else Selection.Interior.Pattern = xlNone
'
'End Sub
'
''Private Sub Worksheet_Change(ByVal Target As Range)
''Dim KeyCells As Range
'' Set KeyCells = Range("F12")
''
''    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
''           Is Nothing Then
''
''End Sub
        ''''======================
        '''Private Sub Worksheet_SelectionChange(ByVal Target As Range)
        '''Dim fld As Range
        ''' 'Set fld = Range("F10")
        ''' 'If ActiveCell.Address = "$F$10" Then
        '''
        '''     If Range("f10").EntireRow.Hidden = False Then If Range("f10").Value = "" Then Range("f10").Interior.Color = 65535 Else Range("f10").Interior.Pattern = xlNone
        '''     If Range("f14").EntireRow.Hidden = False Then If Range("f14").Value = "" Then Range("f14").Interior.Color = 65535 Else Range("f14").Interior.Pattern = xlNone
        '''    'Please input the requester name
        '''     If Range("f18").EntireRow.Hidden = False Then If Range("f18").Value = "Please input the requester name" Then Range("f18").Interior.Color = 65535 Else Range("f18").Interior.Pattern = xlNone
        '''     If Range("q18").EntireRow.Hidden = False Then If Range("q18").Value = "" Then Range("q18").Interior.Color = 65535 Else Range("q18").Interior.Pattern = xlNone
        '''     If Range("f20").EntireRow.Hidden = False Then If Range("f20").Value = "" Then Range("f20").Interior.Color = 65535 Else Range("f20").Interior.Pattern = xlNone
        '''
        '''End Sub



Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
  'Check if the Target Address is same as you have given
    'In the above example i have taken A4 Cell, so I am
    'Comparing this with $A$4

    If Target.Range.Address = "$F$21" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
    'MsgBox "Row " & ActiveCell.Row & " is clicked"
    If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then
    'Call Pentagon11_Click

'    If Range("F20").Value = "See Mass Change tab" Then
    mm = ActiveSheet.Name
    Sheets("GM_NA_Multiple_BU").Visible = True
    Sheets("GM_NA_Multiple_BU").Select
    Sheets("Index").Range("C1").Value = mm
    Else
    End If

    If Range("F20").Value = "See Mass Change tab" Then
                
                mm = ActiveSheet.Name
                Sheets("Masschange_GMNA").Visible = True
                Sheets("Masschange_GMNA").Select
                Sheets("Index").Range("C1").Value = mm
    Else
    End If

    End If

        If Target.Range.Address = "$F$288:$L$288" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
        UserForm2.Show
    'MsgBox Target.Range.Address
        Exit Sub
    End If


End Sub










Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Worksheet_Change(ByVal Target As Range)
'If ActiveSheet.Name = "GM Europe Multiple BU &PO" Then Else Exit Sub
'Application.ScreenUpdating = False
'Dim KeyCells As Range
' Set KeyCells = Range("F1")
'
'On Error GoTo aaa
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'           Is Nothing Then
'    MsgBox "Yes"
'End If
'aaa:
'End Sub
'
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton6, 1862, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton7, 1863, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton8, 1864, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton9, 1865, 8, MSForms, CommandButton"
Attribute VB_Control = "CommandButton10, 1866, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton11, 1867, 10, MSForms, CommandButton"



Private Sub CommandButton1_Click()
     MsgBox "You have selected a non-standard payment term which required additional approval " & Sheets("Validation").Range("C40").Value

End Sub

Private Sub CommandButton2_Click()

End Sub

Private Sub CommandButton3_Click()

End Sub

Private Sub CommandButton4_Click()

End Sub

Private Sub CommandButton10_Click()
Call UnPro
Range("A1").Value = ""
Sheets("Index").Range("A1").Value = ""
Range("Q18").Value = ""
Range("F20").Value = ""
Call Pro
End Sub

Private Sub CommandButton11_Click()
Instruction.Show
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()
ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
'Sheets("Index").Range("A1").Value = ""
UserForm3.Show
'MsgBox "Finished.!", vbInformation
dddnew = ActiveWorkbook.Name
Windows(ddd).Activate
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Windows(dddnew).Activate
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton7_Click()
Call sheetselection
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton8_Click()
Call UnPro
Sheets("GM_IO_Form").Range("A1").Value = "fu"

Sheets("Index").Range("A1").Value = "furtherupdate"
Sheets("Index").Range("B1").Value = ActiveSheet.Name

Call Pro
Call justsave

'MsgBox mm & " has been saved in the below directory: " & vbNewLine & vbNewLine & vbNewLine & "Location: " & ActiveWorkbook.FullName, vbInformation

'UserForm1.CommandButton7.Visible = True
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton9_Click()
ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select

Call clear_gmio_only_header_info

UnPro
'Range("A1").Value = "S"

        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r & ".xlsm"), FileFormat:=ThisWorkbook.FileFormat
'Range("A1").Value = "S"
'ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select

Call Pro
Application.ScreenUpdating = True

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
'Exit Sub
Dim KeyCells As Range

'#################################################################################################################################
 
Set KeyCells = Range("F20")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call UnPro
    Cells.FormatConditions.delete
    If Range("F20").Value = "Please select a valid Submision reason." Then
    Range("F20").Value = ""
    MsgBox "Please select a valid Submision reason before selecting country name", vbExclamation
    Exit Sub
    End If
    
    Range("GM_IO_Form!V25").Formula = "NOGMBU"
    Range("N25").FormulaR1C1 = "Indirect PO ORG"
    Range("P25").FormulaR1C1 = "Direct PO ORG"
    
        'adding check boxes
 '  Range("A24:A740").EntireRow.Hidden = False
    Range("A24:A998").EntireRow.Hidden = False
    
    Call clear_all_checkbox
    Call clear_GMIO_all_fieled_except_header_info
    Range("A24:A998").EntireRow.Hidden = True
    Sheets("GM_IO_Form").Range("A1").Value = ""
    Sheets("Index").Range("A1").Value = ""
    
    'thailand
    If Range("F20").Value = "Thailand" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A26:A28").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'New Zealand
    If Range("F20").Value = "New Zealand" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A29:A30").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If

    'Australia
    If Range("F20").Value = "Australia" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A31:A33").EntireRow.Hidden = False
    Range("A51").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'Philippines
    If Range("F20").Value = "Philippines" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A34:A35").EntireRow.Hidden = False
    'added new line item recently

    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'Singapore
    If Range("F20").Value = "Singapore" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A36:A38").EntireRow.Hidden = False
    Range("A50").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If

    'Indonesia
    If Range("F20").Value = "Indonesia" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A39:A40").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'India
    If Range("F20").Value = "India" Then
        Range("A24:A25").EntireRow.Hidden = False
        Range("A41:A46").EntireRow.Hidden = False
        Range("A55").EntireRow.Hidden = False
        'Range("A25").EntireRow.Hidden = True
        
            
            'Range("E24").FormulaR1C1 = "GM Region"
            'Range("G24").FormulaR1C1 = "GM IO Business Units"
            Range("N25").FormulaR1C1 = "PO ORG"
            Range("P24:Q25").ClearContents
    
        
    Else
    End If
    
    'Utd.Arab Emir.
    If Range("F20").Value = "Utd.Arab Emir." Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A47:A48").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'Vietnam
    If Range("F20").Value = "Vietnam" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A49").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If


    Call selecting_valid_country



'combination of india/other countries and reason for submition
    If Range("F20").Value = "India" And Range("Q18").Value = "New Duns/Vendor Code creation" Then

    Call Supplier_type_inter_non_inter
    Call TDS_configuration_checkboxes
    'tds below area
    'Range("A93:A107").EntireRow.Hidden = False
    Call new_creation_supplier
    Call EFTCheque
    '''Call banking_information
    'documentation and comment
    'A459:A471
    Range("A986:A998").EntireRow.Hidden = False

    
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "Name / Address modification" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    Range("A165:A189").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "Bank Account Maintenance" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    'Call new_creation_supplier
    '''Call banking_information
    
    Call GM_IO_add_delete_change_bank
       '''Call EFTCheque
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    Range("A986:A993").EntireRow.Hidden = True
    Else
    End If

    If Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A197:A203").EntireRow.Hidden = False
    'Call new_creation_supplier
    Call banking_information
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    Else
    End If

    If Range("Q18").Value = "Inactivation\Deletion" And Range("F20").Value <> "" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A978:A985").EntireRow.Hidden = False
    Call inactivat_delete_checkBox
    'Range("A88:A92").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    'Call LowerTDSC_Only
    Else
    End If

    If Range("Q18").Value = "Extend to New Purchasing Org" Then
    
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "New Zealand" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A197:A203").EntireRow.Hidden = False
    'Call new_creation_supplier
    Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    Else
    End If
    Else
    End If

    If Range("Q18").Value = "Modify Payment Terms" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Call payment_term_with_checkbox
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
'    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If
    Else
    End If

    If Range("Q18").Value = "Modify Payment Method" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A232:A238").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A288:A290").EntireRow.Hidden = True
    
    Else
    End If
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "With holding Tax configuration" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A79:A86").EntireRow.Hidden = False
    
        'to hide/get blue shaded color
    Range("J80").Value = ""
    With Range("J80").Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With

    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Call LowerTDSC_Only
    Else
        'to black/unhide
        Call UnPro
    Range("J80").Value = "Tax configuration not required"
    With Range("J80").Font
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
    End With

    
    End If

    If Range("Q18").Value = "With holding Tax configuration" And Range("F20").Value = "Thailand" Or Range("F20").Value = "Philippines" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A288:A290").EntireRow.Hidden = False
    'Range("A79:A86").EntireRow.Hidden = False
    
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    'Call LowerTDSC_Only
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "Lower TDS configuration" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    
    'Range("A88:A92").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    Call LowerTDSC_Only
    Else
    End If



    If Range("Q18").Value = "Contact Details Modification" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A240:A252").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    
    Range("A994:A998").EntireRow.Hidden = True
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Email ID set up" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A254:A263").EntireRow.Hidden = False
    
    Range("A259:A262").EntireRow.Hidden = True
    Range("A994:A998").EntireRow.Hidden = True
    
    If Range("F20").Value = "Utd.Arab Emir." Then Range("A975:A977").EntireRow.Hidden = False
    If Range("F20").Value = "Utd.Arab Emir." Then Range("A263").EntireRow.Hidden = True
    
    
    
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A998").EntireRow.Hidden = False
    Call email_id_change_delete_add_GMIO
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Mass changes" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A210:A214").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    'mass change sheet visible true
    Sheets("Mass Change").Visible = True
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Others - enter Details in Comments column" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    'Range("A210:A214").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If

    Else
    End If

'combination of Australia or new zealand and reason for submition

    If Range("Q18").Value = "New Duns/Vendor Code creation" Then
    If Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    Call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    'Range("A56:A60").EntireRow.Hidden = False
    'Range("A56:A60").EntireRow.Hidden = False
    Call Beneinter
    
    Call new_creation_supplier_australia_and_newz
    '''Call banking_information
    Call EFTCheque
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Name / Address modification" Then
    If Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    'Range("A56:A60").EntireRow.Hidden = False
    Range("A498:A523").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If
    Else
    End If

'new duns creation for remaining countries
    If Range("Q18").Value = "New Duns/Vendor Code creation" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Vietnam" Then
    Call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    'Range("A56:A60").EntireRow.Hidden = False
   'Range("A56:A60").EntireRow.Hidden = False
    Call new_creation_supplier_other_region
    '''Call banking_information
    Call EFTCheque
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Name / Address modification" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Vietnam" Then
    'Call vendorcatogery_and_its_checkboxes
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A570:A590").EntireRow.Hidden = False
    'Range("A56:A60").EntireRow.Hidden = False
   'Range("A56:A60").EntireRow.Hidden = False
    'Call new_creation_supplier_other_region
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

'new duns creation Utd.Arab Emir.
    If Range("Q18").Value = "New Duns/Vendor Code creation" Then
    If Range("F20").Value = "Utd.Arab Emir." Then
    Call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A205:A208").EntireRow.Hidden = False
    Range("A451:A473").EntireRow.Hidden = False
    
    'Call new_creation_supplier_other_region
    Call EFTCheque
    '''Call banking_information
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Name / Address modification" Then
    If Range("F20").Value = "Utd.Arab Emir." Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A973:A975").EntireRow.Hidden = False
    Range("A451:A473").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If
    Else
    End If

'bank account maintance aus, new, viat
'vendornam, beniinter, banking info, doc , comment

    If Range("Q18").Value = "Bank Account Maintenance" Then
    If Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Or Range("F20").Value = "Vietnam" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A56:A60").EntireRow.Hidden = False
    Call Beneinter
    'Range("A451:A473").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    '''Call banking_information
    'Call EFTCheque
    
    Call GM_IO_add_delete_change_bank
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    Range("A986:A993").EntireRow.Hidden = True
    
    Else
    End If
    Else
    End If

'Indonesia/Singapore/Philippines/'thai
'vendoname,eftcheck, banking,doc, comment
'that is for thai 'vendorname, eftchecqu (if eft then: no extra and if it is cheq then pickup location),banking info,doc, comment



    If Range("Q18").Value = "Bank Account Maintenance" Then
    If Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Thailand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A56:A60").EntireRow.Hidden = False
    ''Call EFTCheque
    
    Call GM_IO_add_delete_change_bank
    'Range("A451:A473").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    '''Call banking_information
    'documentation and comment
    'Call UnPro
    Range("A986:A1000").EntireRow.Hidden = False
    Range("A986:A993").EntireRow.Hidden = True
    Else
    End If
    Else
    End If


Call Pro
End If


 Set KeyCells = Range("Q18")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call UnPro
    Call clear_all_checkbox
    Cells.FormatConditions.delete
'    Range("F20").Value = ""

'ignored mass change request mass change sheet update, hold on
       If Range("F18").Value = "GM IO" And Range("Q18").Value = "Mass changes" Then
           mm = ActiveSheet.Name
       Sheets("Mass Change").Visible = True
        Sheets("Mass Change").Select
        Sheets("Index").Range("C1").Value = mm
       MsgBox "Please update the Mass Change details "
       Exit Sub
       End If
'''''''''''                Worksheets("GM_IO_Form").Activate
'''''''''''                Sheets("Mass Change").Visible = True
'''''''''''                Sheets("Mass Change").Move After:=Sheets("GM_IO_Form")
'''''''''''                 'Sheets("Mass Change").Select
'''''''''''
'''''''''''                 Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
'''''''''''                 Sheets("Mass Change").Range("G1").FormulaR1C1 = "GM_IO_Form"
'''''''''''
'''''''''''                 Sheets("GM_IO_Form").Select
'''''''''''
'''''''''''                'Range("F20").Formula = ""
'''''''''''                Call Pro
'''''''''''                Sheets("Mass Change").Select
'''''''''''                Sheets("Mass Change").Activate
'''''''''''                Application.ScreenUpdating = True
'''''''''''                MsgBox "Please update the Mass Change details "
'''''''''''
'''''''''''
'''''''''''
'''''''''''
'''''''''''                'Application.CutCopyMode = xlCopy
'''''''''''            End If
'            Range("F20").Value = ""
    End If
'Application.CutCopyMode = xlCopy
 Set KeyCells = Range("V25")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then

    Range("P74:S74").Value = ""
    Range("P76:S76").Value = ""
    End If

 Set KeyCells = Range("F74")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call tds_lock_and_unlock_for_india
    End If
    

 Set KeyCells = Range("O120")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call india_pan_mandatory
    End If
    

 Set KeyCells = Range("P74")
 Application.ScreenUpdating = False
 
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then

If Range("P74").Value = "" Then
Else
        If ActiveSheet.Name = "GM_IO_Form" Then Else Exit Sub
        
        If Range("s41").Value = True Or Range("s42").Value = True Or Range("s43").Value = True Then
            If Range("T74").Value = "GM47" Then
            Else
            'MsgBox "You have selected a non-standard payment term which required additional approval " & Sheets("Validation").Range("C40").Value, vbInformation
            End If
         Else
            If Range("S44").Value = True Then

            If Range("T74").Value = "MNS2" Then
            Else
            'MsgBox "You have selected a non-standard payment term which required additional approval " & Sheets("Validation").Range("C40").Value, vbInformation
            End If

            Else
            End If
         End If
End If
    End If
    

End Sub
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
'MsgBox Sheets("Index").Range("C1").Value
Sheets(Sheets("Index").Range("C1").Value).Select
End Sub
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
'MsgBox Sheets("Index").Range("C1").Value
Sheets(Sheets("Index").Range("C1").Value).Select
End Sub
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton3, 455, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 34, 2, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Sheets("GM_NA").Visible = True
Sheets("GM_NA").Select
End Sub

Private Sub CommandButton2_Click()
Call GM_NA_BU_checkboxes
End Sub

Private Sub CommandButton3_Click()
Range("C7:C34").Value = True
End Sub
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Suport"
Sub aburun()
Attribute aburun.VB_ProcData.VB_Invoke_Func = " \n14"
'
' aburun Macro
'

'
    Range("F18:L18").Select
    With Selection.Interior
        '.Pattern = xlSolid
        '.PatternColorIndex = xlAutomatic
        .Color = 65535
        '.TintAndShade = 0
        '.PatternTintAndShade = 0
    End With
    Range("F20:L20").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F18:L18").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("H21").Select
End Sub

Sub filtr()
Selection.Interior.Color = 65535
Selection.Interior.Pattern = xlNone
End Sub

Sub unlck()
'If InputBox("Input the password", "Password") = "open" Then
For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I
'Else
'MsgBox ("Wrong Password")
'End If
End Sub



Sub if_selected_cell_blank_conditional_format()
Call UnPro
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


End Sub

Sub GM_EU_form_entire_field_reset()

        Union(Range( _
        "F92:J92,N92:U92,F95:U95,F97:U97,R99:U99,L99:O99,F99:I99,F101:J101,N101:U101,F104:U104,F106:U106,F108:I108,L108:O108,R108:U108,N110:U110,F110:J110,F115:I115,F117:I117,P115:S115,P117:S117,F121:U121,F123:U123,F126:L126,P126:U126,F130:U130,F133:L133,P133:U133" _
        ), Range( _
        "F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170,F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211" _
        ), Range( _
        "F230:U230,F232:U232,F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,F257:L257,N257:U257,F265:L265,F268:U268,F270:U270,F272:J272" _
        ), Range( _
        "F287:L287,F290:U290,F292:U292,F294:J294,M294:U294,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F326:U326,F328:L328,N328:U328,F330:U330,F333:L333,F336:U336" _
        ), Range( _
        "F357:M357,P357:Q357,T357:U357,F359:U359,F361:I361,L361:O361,R361:U361,R363:U363,F363:O363,F365:O365,F369:M369,P369:Q369,T369:U369,F371:U371,R373:U373,L373:O373,F373:I373,F375:O375,R375:U375,F377:O377,T380:U380" _
        ), Range( _
        "R386:U386,F388:O388,F391:M391,P391:Q391,T391:U391,F393:U393,R395:U395,L395:O395,F395:I395,F397:O397,R397:U397,F399:O399,F402:M402,F404:U404,P402:Q402,T402:U402,R406:U406,R408:U408,L406:O406,F408:O408,F406:I406,F410:O410,P413:Q413,T413:U413,F413:M413" _
        ), Range( _
        "D424,D425,D426,D427,D428,F431:N431,F433:N433,F435:J435,M435:U435,F437:U437,F439:U440,F437:U437,F26:I26,F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,D47,D48,D49,D50,D51,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,E70:F70" _
        ), Range("R324:U324,F338:U338,F340:J340,M340:U340,F342:J342,M342:P342,S342:U342,M344:U344,F344:J344,F346:U346,F348:L348,N348:U348,F350:U350,F380:M380,P380:Q380,F382:U382,F384:I384,L384:O384,R384:U384,F386:O386,F415:U415,F417:I417,L417:O417,R417:U417,R419:U419"), Range( _
        "M274:P274,S274:U274,M276:U276,F276:J276,F278:J278,F280:U280,M278:P278,R278:U278,N282:U282,F282:L282,F284:U284,F284:U284,F296:J296,F298:J298,F300:J300,M296:P296,M298:U298,M300:P300,S296:U296,R300:U300,F318:J318,M318:U318,S320:U320,M320:P320,F320:J320" _
        ), Range( _
        "L70:M70,F135:U137,F274:J274,F322:J322,M272:U272,F228:U228,F419:O419,F421:O421,F140:L140,F142:U144,F215:L215,F218:U218,F220:U220,F224:U224,F226:U226,F222:L222,F77:U77,F79:U79,F81:I81,F83:J83,L81:O81,R81:U81,N83:U83,F86:U86,F88:U88,F90:I90,L90:O90,R90:U90" _
        )).Select
Call clear_all_field
'        Union(Range("R324:U324,F338:U338,F340:J340,M340:U340,F342:J342,M342:P342,S342:U342,M344:U344,F344:J344,F346:U346,F348:L348,N348:U348,F350:U350,F380:M380,P380:Q380,F382:U382,F384:I384,L384:O384,R384:U384,F386:O386,F415:U415,F417:I417,L417:O417,R417:U417,R419:U419"), Range( _
'        "M274:P274,S274:U274,M276:U276,F276:J276,F278:J278,F280:U280,M278:P278,R278:U278,N282:U282,F282:L282,F284:U284,F284:U284,F296:J296,F298:J298,F300:J300,M296:P296,M298:U298,M300:P300,S296:U296,R300:U300,F318:J318,M318:U318,S320:U320,M320:P320,F320:J320" _
'        )).Select

    Selection.ClearContents
End Sub

Sub Pro()
'If ActiveSheet.ProtectContents = False Then
Application.ScreenUpdating = False
Dim password    'This line of code is optional
password = "Abu"
ActiveSheet.Protect password, True, True, True
'End If
End Sub

Sub UnPro()
'If ActiveSheet.ProtectContents = True Then
Application.ScreenUpdating = False
password = "Abu"
ActiveSheet.Unprotect password
'End If
End Sub

Sub Prob()
Windows("JUSTapp.xlsm").Activate
If ActiveWorkbook.ProtectStructure Then
Else
ActiveWorkbook.Protect password:="Abu"
End If
End Sub
Sub unProb()
'Windows("JUSTapp.xlsm").Activate
On Error Resume Next
ActiveWorkbook.Unprotect password:="Abu"

End Sub

Sub clear_all_field()

If ActiveSheet.Name = "GM EU Form" Then
Call UnPro
    Union(Range( _
        "F92:J92,N92:U92,F95:U95,F97:U97,R99:U99,L99:O99,F99:I99,F101:J101,N101:U101,F104:U104,F106:U106,F108:I108,L108:O108,R108:U108,N110:U110,F110:J110,F115:I115,F117:I117,P115:S115,P117:S117,F121:U121,F123:U123,F126:L126,P126:U126,F130:U130,F133:L133,P133:U133" _
        ), Range( _
        "F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170,F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211" _
        ), Range( _
        "F230:U230,F232:U232,F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,F257:L257,N257:U257,F265:L265,F268:U268,F270:U270,F272:L272" _
        ), Range( _
        "F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,F328:L328,N328:U328,F330:U330,F333:L333,F336:U336" _
        ), Range( _
        "F348:U348,F350:L350,N350:U350,F352:U352,F357:M357,P357:Q357,T357:U357,F359:U359,F361:I361,L361:O361,R361:U361,R363:U363,F363:O363,F365:O365,F369:M369,P369:Q369,T369:U369,F371:U371,R373:U373,L373:O373,F373:I373,F375:O375,R375:U375,F377:O377,T380:U380" _
        ), Range( _
        "R386:U386,F388:O388,F391:M391,P391:Q391,T391:U391,F393:U393,R395:U395,L395:O395,F395:I395,F397:O397,R397:U397,F399:O399,F402:M402,F404:U404,P402:Q402,T402:U402,R406:U406,R408:U408,L406:O406,F408:O408,F406:I406,F410:O410,P413:Q413,T413:U413,F413:M413" _
        ), Range( _
        "D424,D425,D426,D427,D428,F431:N431,F433:N433,F435:J435,M435:U435,F437:U437,F439:U440,F437:U437,F26:I26,F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,D47,D48,D49,D50,D51,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,E70:F70" _
        ), Range( _
        "L70:M70,F77:U77,F79:U79,F81:I81,F83:J83,L81:O81,R81:U81,N83:U83,F86:U86,F88:U88,F90:I90,L90:O90,R90:U90" _
        ), Range("R417:U417,R419:U419,F419:O419,F421:O421,F415:U415,F135:U137,F140:L140,F142:U144,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228,F274:U274,F276:U276,F278:U278,F280:U280,N282:U282,F282:L282,F284:U284,F338:U338,F340:L340,F342:U342"), Range("R384:U384,F386:O386,F415:U415,F417:I417,L417:O417"), Range("F344:U344,F346:U346,F380:M380,F382:U382,P380:Q380,L384:O384,F384:I384,F380:M380, F443:U445") _
).Select
'ClearContents

    Selection.ClearContents
    Selection.ClearComments
    Selection.FormatConditions.delete
    Range("F259:L259,R259:U259,R255:U255").Select
    Selection.ClearContents
    Selection.ClearComments
    Selection.FormatConditions.delete

Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
Else
End If
End Sub

Sub header_duns_checkbox_tick()

Call UnPro
'1
If Range("M236").Value = True Then
Range("F236").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F236:L236").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F236:L236").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False


Range("F236").Value = ""
End If

'2
If Range("M265").Value = True Then
Range("F265").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F265:L265").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F265:L265").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F265:L265").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F265:L265").Locked = False


Range("F265").Value = ""
End If

'3
If Range("M287").Value = True Then
Range("F287").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F287:L287").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F287:L287").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F287:L287").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F287:L287").Locked = False


Range("F287").Value = ""
End If

'4
If Range("M311").Value = True Then
Range("F311").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F311:L311").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F311:L311").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F311:L311").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F311:L311").Locked = False


Range("F311").Value = ""
End If


'5
If Range("M173").Value = True Then
Range("F173").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F173:L173").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F173:L173").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F173:L173").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F173:L173").Locked = False


Range("F173").Value = ""
End If


Call Pro
'If msg = "yes" Then MsgBox "Conduent will Initiate DUNS Assignment process"
End Sub

Sub reseting_GM_BU_multiple_business_field()

Application.ScreenUpdating = False
ws = ActiveSheet.Name
'If MsgBox("Do you want to reset the current Business Unit selection?", vbYesNo + vbDefaultButton2) = vbYes Then
    If ws = "GM EU Form" Then
    Sheets("GM Europe Multiple BU &PO").Visible = True
    Sheets("GM Europe Multiple BU &PO").Select
    Call UnPro
    ElseIf ws = "GM IO Form" Then
    Sheets("GM IO Multiple BU &PO").Visible = True
    Sheets("GM IO Multiple BU &PO").Select
    End If
Call checkdelete
    Dim cb As CheckBox
        Range("e2").Select
Cou = Range(ActiveCell, ActiveCell.End(xlDown)).Count - 1
Call UnPro
Dim cel As Range
Dim cbx As CheckBox

cc = 2
For I = 1 To Cou
id = cc + I
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, 4)
        Set cel = ActiveSheet.Cells(id, 4)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Check_" & id
        cbx.Caption = ""
        cbx.OnAction = "add_dynamic"
        cbx.LinkedCell = ActiveSheet.Cells(id, 4).Address
        ActiveSheet.Cells(id, 4).Value = "False"
        ActiveSheet.Cells(id, 4).Activate
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Next

Call DeSelectAllCheckBox

If ws = "GM EU Form" Then
Sheets("GM Europe Multiple BU &PO").Visible = True
Sheets("GM Europe Multiple BU &PO").Select
Range("A1").Select
ElseIf ws = "GM IO Form" Then
Sheets("GM IO Multiple BU &PO").Visible = True
Sheets("GM IO Multiple BU &PO").Select
End If
Sheets("GM EU Form").Select

End Sub

Sub HideAllSheetsBarOne()
shtnm = ActiveSheet.Name
Dim sht As Object

For Each sht In Sheets
If sht.Name <> shtnm Then
sht.Visible = xlSheetHidden
End If
Next sht

End Sub
Sub format_sheet()
    Application.DisplayFormulaBar = False
    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Call Pro
    
End Sub
Sub format_sheet_normal()
    Application.DisplayFormulaBar = True
    ActiveWindow.DisplayHeadings = True
    ActiveWindow.DisplayGridlines = True
    Call Pro
    
End Sub

Sub pack_the_form_to_ready_for_use()
Attribute pack_the_form_to_ready_for_use.VB_ProcData.VB_Invoke_Func = "H\n14"

Call SHEETUNHIDE
Sheets("GM EU Form").Select
Call format_sheet

Sheets("GM_IO_Form").Select
Call format_sheet

Sheets("GM_NA").Select
Call format_sheet

Sheets("Execution Page").Visible = True
Sheets("Execution Page").Select
Call HideAllSheetsBarOne
'ActiveWorkbook.Save
ActiveWindow.DisplayWorkbookTabs = False

End Sub









Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Activate()
'application.DisplayFullScreen = True
'ActiveWindow.DisplayWorkbookTabs = False
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Call change_list_separator_in_system_to_previousone
End Sub

'Private Sub Workbook_BeforeClose(Cancel As Boolean)
'Application.ScreenUpdating = False
'Application.DisplayAlerts = False
'Sheets("Execution Page").Visible = True
'Sheets("Execution Page").Select
'Application.DisplayFullScreen = False
'''Application.ScreenUpdating = False
'End Sub
'________________________________________________________________________
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
If Sheets("Index").Range("E1").Value = "S" Then Exit Sub
Application.DisplayAlerts = False
'                If Range("W1") = "save" Then
'                Cancel = False
'                Exit Sub
'                End If

If ActiveSheet.Name = "GM EU Form" Then
    If Range("A1").Value = "fu" Then
        
    Else
    'MsgBox "Data can not be saved directly, please use 'Save for Furhter Update' Option ", vbInformation
    'Cancel = True
    Exit Sub
    End If
Else
End If


If ActiveSheet.Name = "GM_IO_Form" Then
    If Range("GM_IO_Form!A1").Value = "fu" Then
        
    Else
'    MsgBox "Data can not be saved directly, please use 'Save for Furhter Update' Option ", vbInformation
'    Cancel = True
    Exit Sub
    End If
Else
End If

End Sub

Sub ClearUserdata()
Dim main|fffd|work|fffd|Book As Workbook
Set main|fffd|work|fffd|Book = ActiveWorkbook
mainworkBook.Sheets("GM EU Form").UsedRange.ClearContents
End Sub

Private Sub Workbook_Deactivate()
Application.DisplayFullScreen = False
End Sub

Private Sub Workbook_Open()
Application.ScreenUpdating = False

Sheets("Execution Page").Visible = True
Sheets("Execution Page").Move Before:=Sheets(1)
Call Get_listseparator_in_system
On Error Resume Next
For I = 2 To Sheets.Count
Sheets(I).Visible = 2
Next I
On Error GoTo 0
Application.DisplayFullScreen = True
'UserForm1.Show
'MsgBox Sheets("GM EU Form").Range("A1").Value
'If Sheets("GM EU Form").Range("A1").Value = "fu" Then UserForm1.CommandButton7.Visible = True
If Sheets("Index").Range("A1").Value = "furtherupdate" Then

Sheets(Sheets("Index").Range("B1").Value).Visible = True
Sheets(Sheets("Index").Range("B1").Value).Select
MsgBox Sheets("Index").Range("B1").Value & " has selected by default since the Form is saved for further update by last user" & vbNewLine & vbNewLine & " Please continue with further updates"
Else
UserForm1.Show
End If

'If Sheets("GM_IO_Form").Range("A1").Value = "fu" Then
'Sheets("GM_IO_Form").Visible = True
'Sheets("GM_IO_Form").Select
'Else
'UserForm1.Show
'End If

End Sub

Sub sheetsunhide()
'If InputBox("Input the password", "Password") = "open" Then
For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I
'Else
'MsgBox ("Wrong Password")
'End If
End Sub


Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{58C0982B-7057-42C5-B473-6EABD65BDCD2}{EC423BCB-41B6-4622-86BF-CFE18BF16536}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()

End Sub

Private Sub CommandButton3_Click()
Application.DisplayFullScreen = True
Application.ScreenUpdating = False
'MsgBox "Region is Under Development"
'Exit Sub

UserForm1.Hide
'Unload Me
Sheets("GM_IO_Form").Visible = True
Sheets("GM_IO_Form").Activate

Range("Q18:U18,Q12:U12,Q10:U10,F10:L10,F12:L12,F14:L14,F20:L20").ClearContents
Range("f10").Select
Call UnPro
Range("A1").Value = ""
Sheets("Index").Range("A1").Value = ""
Range("I6").Value = "GMVENDOR.MASTERDATA@CONDUENT.COM"
Call Pro
'Unload Me
   Sheets("Execution Page").Visible = 2
   Application.ScreenUpdating = True
UserForm1.Hide

End Sub

Private Sub CommandButton5_Click()

Application.ScreenUpdating = False
''If Sheets("GM EU Form").Range("A1").Value = "fu" Then
''Sheets("GM EU Form").Select
''Exit Sub
''End If
Unload Me
Application.DisplayFullScreen = True
Call UnPro

Sheets("GM EU Form").Visible = True
'Sheets("VDRF_Instructions_English").Visible = True
'VDRF_Instructions_English
Sheets("GM EU Form").Activate

Call UnPro

                  On Error Resume Next
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    'Selection.Delete
                                    Call clear_all_checkbox
                On Error GoTo 0
                

If ActiveSheet.Name = "GM EU Form" Then Call clear_all_field

'If ActiveSheet.Name = "GM EU Form" Then Range("Q18").Select
'Selection.ClearContents

'Call UnPro
Range("f10").Select
'Range("C6").Value = "IFSSC_VENDOR_MASTER@Conduent.COM"
Range("F18").Value = "GM Europe"
'u:IFSSC_VENDOR_MASTER@Conduent.COM
'io:GMVENDOR.MASTERDATA@Conduent.COM
'na:OPSVENDORMASTER@Conduent.COM


'On Error Resume Next
 Sheets("GM EU Form").Rows("25:407").Select
    Selection.EntireRow.Hidden = True
    Range("A1").Select
    Sheets("GM EU Form").Select
    Range("A442:A446").EntireRow.Hidden = True
    Call hidecheckeu
    Call Pro
 '   On Error GoTo 0
    Sheets("Execution Page").Visible = 2
Call Pro
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()
Application.DisplayFullScreen = True
Application.ScreenUpdating = False
'MsgBox "Region is Under Development"
'Exit Sub

UserForm1.Hide
'Unload Me
Sheets("GM_NA").Visible = True
Sheets("GM_NA").Activate

'Range("Q18:U18,Q12:U12,Q10:U10,F10:L10,F12:L12,F14:L14,F20:L20").ClearContents
Range("f10").Select
Call UnPro
Range("A1").Value = ""
Sheets("Index").Range("A1").Value = ""
Range("D6").Value = "gmnar2phelp@gm.com" '"gmmasterdata@mailgb.custhelp.com"
Call Pro
'Unload Me
   Sheets("Execution Page").Visible = 2
   Application.ScreenUpdating = True
UserForm1.Hide
End Sub

Private Sub CommandButton7_Click()
Sheets("GM EU Form").Visible = True
Sheets("GM EU Form").Select
UserForm1.Hide
End Sub

Private Sub TextBox1_Change()

End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{6BC52EF6-71B1-4D91-9587-9EAFFDFF2AC5}{BBB39ACB-BB74-4DD2-B07D-D0F30FBF0C8B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
UserForm2.Hide
End Sub
Attribute VB_Name = "UserForm22"
Attribute VB_Base = "0{AFF7D3E0-DF0C-447F-9C97-096D1D3A53BF}{9614F0FB-DA31-4FB9-9DD4-DB6B397380FC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
'aa = ComboBox1.Text
'Sheets("GM IO Form").Range("E20").Value = ComboBox1.Text
 Sheets("GM IO Form").Calculate
 Unload Me
 
End Sub

Private Sub CommandButton2_Click()
Call Group9_Click
Unload Me
End Sub


Private Sub UserForm_Initialize()
 With ComboBox1
.ColumnHeads = False
.ColumnCount = 1
.RowSource = "=Validation!d70:d78"
.BoundColumn = 0
End With
End Sub


Sub hh()
Sheets("GM IO Form").Calculate
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{517ADFD5-A343-4773-9245-24DBCEF7D6E5}{546CA990-1C8B-4239-9CB8-D73D60A4E443}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
UserForm3.Hide
Sheets("Index").Range("A1").Value = ""
If UserForm3.OptionButton1.Value = False And UserForm3.OptionButton2.Value = False Then
MsgBox "Please select a valid option to Submit the Form"
Exit Sub

Else
End If
If ActiveSheet.Name = "GM EU Form" Then Call Aj
If ActiveSheet.Name = "GM_IO_Form" Then Call Kudhal
If ActiveSheet.Name = "GM_NA" Then Call Kudhal_GM_NA

Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()
UserForm3.Hide
Exit Sub

End Sub

Attribute VB_Name = "back1"
Sub sheetselection()
ws = ActiveSheet.Name
Sheets("Execution Page").Visible = True
Sheets("Execution Page").Activate
Call Pro
Call HideAllSheetsBarOne
Sheets(ws).Visible = False
UserForm1.Show
End Sub
Sub sheetselectionmultiplebu()
If ActiveSheet.Name = "GM IO Multiple BU &PO" Then
ws = "GM IO Form"

ElseIf ActiveSheet.Name = "GM Europe Multiple BU &PO" Then
ws = "GM EU Form"
End If
If Range("e3") = Empty Then
Call sheetselection
End If

If Range("F1").Value = 0 Then
MsgBox "Please update at least one BU"
Exit Sub
Else
End If

If Range("G1").Value = 0 Then
MsgBox "Please select a valid PO ORG"
Exit Sub
Else
End If

Sheets(ws).Visible = True
Sheets(ws).Activate

End Sub
Sub test()

End Sub
Attribute VB_Name = "cleararea"
Sub cleario()
Attribute cleario.VB_ProcData.VB_Invoke_Func = " \n14"
Dim a, b, c, d, E, f, g, h, mulrng As Range
    Set a = Range("F10:L10,F12:L12,Q10:U10,Q12:U12,F14:L14,F20:L20,F22:L22,Q18:U18")
   Set b = Range("F29:J29,F31:J31,M31:Q31,T31:U31,T35:U35,M35:Q35,F35:J35,F39:L39,F42:U42,F44:U44")
    Set c = Range("F69:L69,F71:U71,F75:L75,F78:U78,F80:U80,F82:U82,F84:J84,M84:U84,F86:J86,M86:U86,M88:U88,F88:J88,F90:J90,M90:U90,L92,F92:N92,F94:N94,F96:J96,M96:U96,F98:U98")
    Set d = Range("F101:L101,F103:U103,F105:U105,F107:U107,F109:J109,M109:U109,F111:J111,M111:U111,F113:J113,M113:U113,F115:J115,M115:U115,I117,F117:N117,F119:N119,F121:J121,M121:U121,F123:U123,F127:L127,F129:U129,F133:I133,F135:I135,F137:I137,P135:S135,P137:S137,F139:U141")
    Set E = Range("F145:L145,F147:U147,F151:U153,F157:I157,O157:U157,F161:U162,F166:I166,O166:U166,F168:U169,F173:N173,F175:N175,F177:J177,F179:U179,M177:U177,F181:U182,F186,F186:N186,F188:N188,F190:U191")
    Set f = Range("F195:U195,F197:U197,F199:U199,F201:J201,M201:U201,F203:J203,H205,F205:N205,F207:N207,F209:J209,M209:U209,F211:U211,F216:Q216,T216:U216,F218:Q218,F220:I220,L220:N220,R220:U220,R222:U222,F222:N222,F224:N224,R224:U224")
    Set g = Range("F231:Q231,F233:Q233,F235:I235,L235:N235,R235:U235,T231:U231,R237:U237,R239:U239,F237:N237,F239:N239,F245:Q245,F247:Q247,T245:U245,R249:U249,L249:N249,F249:I249,F251:N251,R251:U251,R253:U253,F253:N253,F258:Q258,T258:U258,F260:Q260,F262:I262,L262:N262")
    Set h = Range("F271:Q271,F273:Q273,T271:U271,R275:U275,R277:U277,R279:U279,F279:N279,F277:N277,L275:N275,F275:I275,F284:Q284,F286:Q286,T284:U284,R288:U288,R290:U290,R292:U292,L288:N288,F288:I288,F290:N290,F292:N292,F295:U297")
Set mulrng = Union(a, b, c, d, E, f, g, h)
  Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents
  ''Application.ScreenUpdating = False
End Sub
Sub Macro3()
Dim a, b, c, d, E, f, h, mulrng As Range

Set a = Range("F10:L10,Q10:U10,Q12:U12,F12:L12,F14:L14,F18:L18,Q18:U18,F20:L20,F22:L22")
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F128:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F259:L259,R259:U259,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353,F355:O355")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")
For I = 11 To 18
    ActiveSheet.Protection.AllowEditRanges.Add Title:="Range" & I, Range:=h
 Next I
End Sub



Sub hideallIO()
Call UnPro
Set b = Range("F29:J29,F31:J31,M31:Q31,T31:U31,T35:U35,M35:Q35,F35:J35,F39:L39,F42:U42,F44:U44")
    Set c = Range("F69:L69,F71:U71,F75:L75,F78:U78,F80:U80,F82:U82,F84:J84,M84:U84,F86:J86,M86:U86,M88:U88,F88:J88,F90:J90,M90:U90,L92,F92:N92,F94:N94,F96:J96,M96:U96,F98:U98")
    Set d = Range("F101:L101,F103:U103,F105:U105,F107:U107,F109:J109,M109:U109,F111:J111,M111:U111,F113:J113,M113:U113,F115:J115,M115:U115,I117,F117:N117,F119:N119,F121:J121,M121:U121,F123:U123,F127:L127,F129:U129,F133:I133,F135:I135,F137:I137,P135:S135,P137:S137,F139:U141")
    Set E = Range("F145:L145,F147:U147,F151:U153,F157:I157,O157:U157,F161:U162,F166:I166,O166:U166,F168:U169,F173:N173,F175:N175,F177:J177,F179:U179,M177:U177,F181:U182,F186,F186:N186,F188:N188,F190:U191")
    Set f = Range("F195:U195,F197:U197,F199:U199,F201:J201,M201:U201,F203:J203,H205,F205:N205,F207:N207,F209:J209,M209:U209,F211:U211,F216:Q216,T216:U216,F218:Q218,F220:I220,L220:N220,R220:U220,R222:U222,F222:N222,F224:N224,R224:U224")
    Set g = Range("F231:Q231,F233:Q233,F235:I235,L235:N235,R235:U235,T231:U231,R237:U237,R239:U239,F237:N237,F239:N239,F245:Q245,F247:Q247,T245:U245,R249:U249,L249:N249,F249:I249,F251:N251,R251:U251,R253:U253,F253:N253,F258:Q258,T258:U258,F260:Q260,F262:I262,L262:N262")
    Set h = Range("F271:Q271,F273:Q273,T271:U271,R275:U275,R277:U277,R279:U279,F279:N279,F277:N277,L275:N275,F275:I275,F284:Q284,F286:Q286,T284:U284,R288:U288,R290:U290,R292:U292,L288:N288,F288:I288,F290:N290,F292:N292,F295:U297")
Set mulrng = Union(b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents
 Sheets("GM IO Form").Rows("24:669").Select
    Selection.EntireRow.Hidden = True
End Sub

Attribute VB_Name = "emailIo"
Sub E_maiaIO()
Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object
Dim aw As String
Application.ScreenUpdating = False
If Sheets("GM IO Form").Range("q18").Value = "New Duns creation" And Range("d66").Value = False And Range("G66").Value = False And Range("K66").Value = False And Range("N66").Value = False And Range("o66").Value = False And Range("S66").Value = False Then
     MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
     Exit Sub
End If
      If Sheets("GM IO Form").Range("F10").Value = "" Then
     MsgBox "Please enter Requester name", vbExclamation, "Required Entry"
     Exit Sub
   End If
   
   If Sheets("GM IO Form").Range("F14").Value = "" Then
     MsgBox "Please enter Requester email ID", vbExclamation, "Required Entry"
     Exit Sub
   End If
   
   If Sheets("GM IO Form").Range("F18").Value = "" Then
     MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     Exit Sub
   End If
   If Sheets("GM IO Form").Range("Q18").Value = "" Then
     MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     Exit Sub
   End If
   If Sheets("GM IO Form").Range("F20").Value = "" Then
     MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     Exit Sub
     End If
     
  If Sheets("GM IO Form").Range("Q18").Value = "Email ID set up" And Sheets("GM IO Form").Range("F32").Value = "" Then
     MsgBox "Please Enter Duns or Vendor code in Cell F32", vbExclamation, "Required Entry"
     Exit Sub
     End If
     
  If Sheets("GM IO Form").Range("M18").Value = "Email ID set up" And Sheets("GM IO Form").Range("E34").Value = "" Then
     MsgBox "Please Enter Supplier name in Cell E34", vbExclamation, "Required Entry"
     Exit Sub
     End If
      If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'GM IO Multiple BU &PO'", vbExclamation, "Required Entry"
     Exit Sub
     End If
     If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value <> 0 Then
     Sheets("GM IO Multiple BU &PO").Select
     er = Range("e2").End(xlDown).Row
     Range("a2:F5000").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$F$5100").AutoFilter Field:=4, Criteria1:="TRUE"
    End If
    If MsgBox("Do you really want to submit?", vbOKCancel + vbDefaultButton2, "Confirm submit") = vbCancel Then
Exit Sub
End If
     ActiveWorkbook.Save
     Application.ScreenUpdating = False
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
aw = Application.ActiveWorkbook.Path & "\"
   tb = InputBox("give the file name")
   ta = tb & ".pdf"
   tt = aw & ta
   If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value <> 0 Then
    Sheets("GM IO Form").Move Before:=Sheets(1)
   Sheets("GM IO Multiple BU &PO").Move Before:=Sheets(2)
For I = 1 To 2
Sheets(I).Select
Call page
If I = 2 Then
tt1 = aw & tb & "Bu selection.pdf"

 With ActiveSheet
    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  End With
   
Else
 With ActiveSheet
    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=tt, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  End With
   Call page
End If
Next I
Else
   Sheets("GM IO Form").Select
      Call page
    With ActiveSheet
    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=tt, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  End With
    End If
Set rng = Nothing

Set rng = Sheets("GM IO Form").Range("B9:v24").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

subm = ThisWorkbook.Sheets("GM IO Form").Range("Q18").Value

If ThisWorkbook.Sheets("GM IO Form").Range("f26").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f26").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f38").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f38").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f121").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f121").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f215").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f215").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f236").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f236").Value
End If

If ThisWorkbook.Sheets("GM IO Form").Range("f28").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f28").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f40").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f40").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f123").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f123").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f218").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f218").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f239").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f239").Value
End If
subj = subm + "-" + DUN + "-" + SUP
With OutMail
    .To = ""
    .cc = ""
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
  If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value <> 0 Then
  Sheets("GM IO Multiple BU &PO").Select
  Range("A1").Select
  Selection.AutoFilter
  End If
   For I = 3 To Sheets.Count
     Sheets(I).Visible = 2
     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM IO Form").Select
End Sub


Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM IO Form").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function

Sub justsaveio()
If MsgBox("Are you want to save the workbook?" & Chr(13) & "Please submit the form only after the complete updates.", vbYesNo, "Save") = vbNo Then
Exit Sub
End If
Application.ScreenUpdating = False

Range("W1").Select
    ActiveCell.FormulaR1C1 = "save"
ActiveWorkbook.Save
 
Range("W1").Select
    ActiveCell.FormulaR1C1 = ""
    ''Application.ScreenUpdating = False
End Sub



Attribute VB_Name = "eubuttons"
Sub Addbuttons()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 1
For Each cel In Range("g42,J42,O42,F43").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 1 And id = 0 Then
id = 1
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
 ' with a linked can trap sheet change event or link to other formulas
        cbx.LinkedCell = c
        If id <= 2 Then
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!bankdetails"
        Else
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!BnkDetails"
        End If
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del1()
For I = 1 To 4
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons1()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 5
For Each cel In Range("G30,J30,N30").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)


If I = 5 And id = 0 Then
id = 5
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
 ''Application.ScreenUpdating = False
 
    
End Sub

Sub Del2()
For I = 5 To 7
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons2()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 8
For Each cel In Range("G147,J147,N147").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)


If I = 8 And id = 0 Then
id = 8
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
 ''Application.ScreenUpdating = False
 
    
End Sub

Sub Del3()
For I = 8 To 10
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub

Sub Addbuttons3()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 11
For Each cel In Range("G261,L261,o261,S261").Cells
Application.ScreenUpdating = False
c = cel.Address
If c = Range("S261").Address Then
c = Range("r261").Address
Else
c = cel.Address
End If
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)

If I = 11 And id = 0 Then
id = 11
Else
id = id + 1
End If
If id = 14 Then
id = 50
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
           cbx.LinkedCell = c
           cbx.Display3DShading = True
           cbx.OnAction = "'" & ThisWorkbook.Name & "'!Alternative_" & id
    Next


 ''Application.ScreenUpdating = False
 
    
End Sub

Sub Del4()
For I = 11 To 13
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
    ActiveSheet.CheckBoxes("Checkbox_50").Select
    Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_50").delete
 On Error GoTo 0
    
End Sub
Sub Addbuttons4()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 14
For Each cel In Range("G65,J65,M65,P65,s65").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 14 And id = 0 Then
id = 14
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
For I = 14 To 18
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.OnAction = "bank" & I
Next I
I = 13
For Each cel In Range("e66,e75,e84,e93,e102").Cells
I = I + 1
c = cel.Address
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
Selection.LinkedCell = c
Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del5()
For I = 14 To 18
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons5()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 19
For Each cel In Range("G366,J366,M366,P366,s366").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 19 And id = 0 Then
id = 19
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
For I = 19 To 23
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.OnAction = "bank" & I
Next I
I = 18
For Each cel In Range("G367,J367,M367,P367,s367").Cells
I = I + 1
c = cel.Address
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
Selection.LinkedCell = c
Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del6()
For I = 19 To 23
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons6()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 24
For Each cel In Range("n355,r355").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 24 And id = 0 Then
id = 24
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next

 ''Application.ScreenUpdating = False
End Sub

Sub Del7()
For I = 24 To 25
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons7()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 26
For Each cel In Range("D65,G65,K65,N65,o65,s65").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 26 And id = 0 Then
id = 26
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
   c = Cells(d + 1, E).Address
    
        ActiveSheet.CheckBoxes("Checkbox_" & id).Select
          Selection.OnAction = "Count"
Selection.LinkedCell = c
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del8()
For I = 26 To 31
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
Selection.FormatConditions.delete
ActiveSheet.CheckBoxes("Checkbox_" & I).delete
Next
On Error GoTo 0
End Sub
Sub Addbuttons8()
Dim cel As Range
Dim cbx As CheckBox
Set rng = ActiveSheet.Cells(70, 17)
With cel
Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
End With
cbx.Name = "Checkbox_32"
cbx.Caption = ""
cbx.Display3DShading = True
End Sub
Sub Del9()
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_32").Select
Selection.FormatConditions.delete
ActiveSheet.CheckBoxes("Checkbox_32").delete
On Error GoTo 0
End Sub

Sub Addbuttons9()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 60
For Each cel In Range("F128,I128").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 60 And id = 0 Then
id = 60
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
 ''Application.ScreenUpdating = False
End Sub
Sub Del10()
For I = 60 To 62
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
End Sub
Attribute VB_Name = "euclear"
Sub Group9_Click()
Call UnPro
ws1 = ActiveSheet.Name
If ActiveSheet.Name = "GM IO Form" Then
Call cleario
Sheets("GM IO Form").Rows("24:669").Select
    Selection.EntireRow.Hidden = True
    Range("A1").Select
    Call hidecheckio
    On Error Resume Next
ActiveSheet.CheckBoxes.delete
Selection.FormatConditions.delete
On Error GoTo 0
  
ElseIf ActiveSheet.Name = "GM EU Form" Then
If MsgBox("Do you really want to clear the Contents??", vbOKCancel, "Clear") = vbCancel Then
Call Pro
Exit Sub
Else
Dim a, b, c, d, E, f, h, I, mulrng As Range

Set a = Range("Q18:U18,F20:L20,F22:L22")
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F259:L259,R259:U259,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F369:M369,P369:Q369,T369:U369,F371:U371,F373:I373,L373:O373,R373:U373,R375:U375,F375:O375,F377:O377,F380:M380,P380:Q380,T380:U380,F382:U382,R384:U384,R386:U386,L384:O384,F386:O386,F384:I384,F388:O388,P391:Q391,F391:M391,T391:U391,F393:U393,L395:O395")
Set h = Range("T402:U402,F404:U404,R406:U406,R408:U408,L406:O406,F406:I406,F408:O408,F410:O410,F413:M413,F415:U415,P413:Q413,T413:U413,F417:I417,L417:O417,R417:U417,R419:U419,F421:O421,F419:O419,D424:D428,F369:M369,P369:Q369,T369:U369,F371:U371,F373:I373,L373:O373")
Set mulrng = Union(a, b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents
Call UnPro
Sheets("GM EU Form").Rows("24:669").Select

    Selection.EntireRow.Hidden = True
    Range("A1").Select
''Application.ScreenUpdating = False
End If
On Error Resume Next
ActiveSheet.CheckBoxes.delete
Selection.FormatConditions.delete
On Error GoTo 0
End If
Application.ScreenUpdating = False

For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I

Sheets(ws1).Move Before:=Sheets(1)
For I = 2 To Sheets.Count
Sheets(I).Visible = 2
Next I
''Application.ScreenUpdating = False
If ActiveSheet.Name = "GM EU Form" Then Call clear_all_field
Call Pro
End Sub
Sub Macro2()

Dim rng As Range
Set rng = Range("F10:L10,F12:L12,Q10:U10,Q12:U12,F14:L14,F18:L18,F20:L20,Q18:U18,F22:L22")
cl = rng.Value
For Each cl In rng
If cl = Empty Then
MsgBox ("empty")
End If
Next
    Range("F22").Activate
End Sub

Sub unhide()

Application.ScreenUpdating = False
   Rows("25:669").Select
    Selection.EntireRow.Hidden = False
    Range("a1").Select
If ActiveSheet.Name = "GM EU Form" Then
    Call bankdetails
        Call hidecheckeu
        ElseIf ActiveSheet.Name = "GM IO Form" Then
        Call hidecheckio
        
        End If

''Application.ScreenUpdating = False
        End Sub

Sub hideall12()
Call UnPro
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")

Set mulrng = Union(b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents

                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

 Sheets("GM EU Form").Rows("24:3325").Select
    Selection.EntireRow.Hidden = True

End Sub


Sub hideall13()
Call UnPro
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")

Set mulrng = Union(b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents

                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

 Sheets("GM_NA").Rows("24:3325").Select
    Selection.EntireRow.Hidden = True

End Sub
    
Sub TTE()
Dim a, b, c, d, E, f, h, mulrng As Range

Set a = Range("F10:L10,Q10:U10,Q12:U12,F12:L12,F14:L14,F18:L18,Q18:U18,F20:L20,F22:L22")
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:U121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170,P126:U126,P133:U133")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F259:L259,R259:U259,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353,F355:O355")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")
a.Select
b.Select
c.Select
d.Select
E.Select
f.Select
g.Select
h.Select
End Sub
Attribute VB_Name = "eutickselection"
Sub Alternative_11()
If ActiveSheet.ProtectContents = True Then Call UnPro
Application.ScreenUpdating = False
If Range("G261").Value = False Then
    Range("B263:B285").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
    Range("B264:B285").Select
    Selection.EntireRow.Hidden = False
      Range("F265").Select
    End If
''Application.ScreenUpdating = False

Range("K272").Value = "City"
Range("K274").Value = "PO Box- City"
Range("K276").Value = "VAT ID"
Range("K278").Value = "Tax No. 2"
Range("Q274").Value = "PO Box-Postal code"
Range("Q278").Value = "Tax No. 3"


If ActiveSheet.ProtectContents = False Then Call Pro
End Sub
Sub Alternative_12()
If ActiveSheet.ProtectContents = True Then Call UnPro
Application.ScreenUpdating = False
If Range("L261").Value = False Then
    Range("B286:B309").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
     Range("B286:B309").Select
    Selection.EntireRow.Hidden = False
    Range("F287").Select
    End If
Range("K294").Value = "City"
Range("K296").Value = "PO Box- City"
Range("K298").Value = "VAT ID"
Range("K300").Value = "Tax No. 2"
Range("Q296").Value = "PO Box-Postal code"
Range("Q300").Value = "Tax No. 3"

    ''Application.ScreenUpdating = False
If ActiveSheet.ProtectContents = False Then Call Pro
End Sub
Sub Alternative_13()
Call UnPro
Application.ScreenUpdating = False
If Range("O261").Value = False Then
    Range("B310:B331").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
   Range("B310:B331").Select
    Selection.EntireRow.Hidden = False
     Range("B323:B326").Select
    Selection.EntireRow.Hidden = True
    Range("F311").Select
    End If

Range("K318").Value = "City"
Range("K320").Value = "PO Box- City"
Range("K322").Value = "VAT ID"
'Range("Q320").Value = "Tax No. 2"
Range("Q320").Value = "PO Box-Postal code"
'Range("Q300").Value = "Tax No. 3"
    ''Application.ScreenUpdating = False
End Sub

Sub bank19()
Call UnPro
Application.ScreenUpdating = False

Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 1
'If Range("G367") = False Then
'    Range("b368:b378").Select
'    Selection.EntireRow.Hidden = True
'    Range("F357").Select
'    Else
'    Range("b368:b378").Select
'    Selection.EntireRow.Hidden = False
'      Range("F369").Select
'    End If
'    ''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
    
    Call Pro
End Sub
Sub bank20()
Call UnPro
Application.ScreenUpdating = False
Range("G367").Value = False
'Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 2
'    If Range("J367") = False Then
'   Range("b379:b389").Select
'      Selection.EntireRow.Hidden = True
'     Range("F357").Select
'      Else
'    Range("b379:b389").Select
'      Selection.EntireRow.Hidden = False
'       Range("F380").Select
'      End If
'      ''Application.ScreenUpdating = False

If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub bank21()
Call UnPro
Application.ScreenUpdating = False

Range("G367").Value = False
Range("J367").Value = False
'Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 3
'      If Range("M367") = False Then
'    Range("b390:b400").Select
'    Selection.EntireRow.Hidden = True
'  Range("F357").Select
'    Else
'    Range("b390:b400").Select
'    Selection.EntireRow.Hidden = False
'     Range("F391").Select
'    End If
'    ''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub bank22()
Call UnPro
Application.ScreenUpdating = False

Range("G367").Value = False
Range("J367").Value = False
Range("M367").Value = False
'Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 4
'    If Range("P367") = False Then
'    Range("b401:b411").Select
'    Selection.EntireRow.Hidden = True
'       Range("F357").Select
'    Else
'        Range("b401:b411").Select
'    Selection.EntireRow.Hidden = False
'    Range("F402").Select
'    End If
'    ''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub bank23()
Call UnPro
Range("G367").Value = False
Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
'Range("S367").Value = False
Range("V367").Value = 5
'Application.ScreenUpdating = False
'     If Range("S367") = False Then
'    Range("b412:b422").Select
'    Selection.EntireRow.Hidden = True
'Range("F357").Select
'  Else
'  Range("b412:b422").Select
'    Selection.EntireRow.Hidden = False
'     Range("F413").Select
'    End If
'    '''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub all()
  Dim cb As CheckBox
        Range("e2").Select
Cou = Range(ActiveCell, ActiveCell.End(xlDown)).Count - 1

Dim cel As Range
Dim cbx As CheckBox
cc = 2
For I = 1 To Cou
id = cc + I
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, 4)
        Set cel = ActiveSheet.Cells(id, 4)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Check_" & id
        cbx.Caption = ""
    Next
End Sub

Sub BnkDetails()
Call UnPro
Application.ScreenUpdating = False
'If Range("O42") = True Or Range("f43") = True Then
If Range("O42") = True Then
    Rows("354:367").Select
    Selection.EntireRow.Hidden = False
          Rows("366:366").Select
          Selection.EntireRow.Hidden = True
          Range("F357").Select
Else
    Rows("354:367").Select
    Selection.EntireRow.Hidden = True
Call bankdetails
''Application.ScreenUpdating = False
End If
Call hidecheckeu
Call Pro
End Sub

Sub Count()
If ActiveSheet.ProtectContents = True Then Call UnPro
Dim x As Long, var1 As Long, var2 As String
Application.ScreenUpdating = True
Sheets("GM EU Form").Select
var2 = "True"
With ThisWorkbook.Sheets("GM EU Form")
var1 = Application.WorksheetFunction.CountIf(Range("C66:U66"), var2)
End With
If var1 > 1 Then
MsgBox ("Please select one appropriate vendor catogory")
Range("d66").Value = False
Range("G66").Value = False
Range("K66").Value = False
Range("N66").Value = False
Range("o66").Value = False
Range("S66").Value = False
Call hide_inter
''Application.ScreenUpdating = False
If ActiveSheet.ProtectContents = False Then Call Pro
Exit Sub
End If
Application.ScreenUpdating = False
If Range("K66").Value = True Then
Call hide_inter
Else

'back to normal
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

Call hide_inter
End If
''Application.ScreenUpdating = False
If ActiveSheet.ProtectContents = False Then Call Pro
End Sub
Sub hide_inter()
Call UnPro
Application.ScreenUpdating = False
If Range("K66").Value = True Then
Range("b69:b72").Select
Selection.EntireRow.Hidden = False
                    ActiveSheet.CheckBoxes.Add(Cells(70, "Q").Left, _
                                                Cells(70, "Q").Top, _
                                                180, 17.25).Select

                    With Selection
                        .Caption = "Select if not netting participant"
                        .Value = xlOff '
                        .LinkedCell = "Q" & 70
                        .Display3DShading = True
                '        .lock = False
                        .Name = "nt"
                        .OnAction = ""
                    End With

Range("e70").Select
Else
Range("b69:b72").Select
Selection.EntireRow.Hidden = True
Range("f115").Select

On Error Resume Next
ActiveSheet.CheckBoxes("nt").delete
ActiveSheet.CheckBoxes("nt").delete
ActiveSheet.CheckBoxes("nt").delete
On Error GoTo 0

End If
''Application.ScreenUpdating = False
Call Pro
End Sub

Sub Alternative_50()
Call UnPro
Application.ScreenUpdating = False
If Range("R261").Value = False Then
    Range("B332:B353").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
     Range("B332:B353").Select
    Selection.EntireRow.Hidden = False
    Range("F333").Select
    End If
    ''Application.ScreenUpdating = False
    
Range("K340").Value = "City"
Range("K342").Value = "PO Box- City"
Range("K344").Value = "VAT ID"
'Range("K300").Value = "Tax No. 2"
Range("Q342").Value = "PO Box-Postal code"
'Range("Q300").Value = "Tax No. 3"

    Call Pro
End Sub

Attribute VB_Name = "functions"

Public Function WorksheetExists(ByVal WorksheetName As String) As Boolean
    Dim sht As Worksheet
    Dim sheetName As String
        
    WorksheetExists = False
        
    For Each sht In ThisWorkbook.Worksheets
        sheetName = sht.Name
        
        If sheetName = WorksheetName Then
        WorksheetExists = True
        ThisWorkbook.Activate
        Sheets(1).Select
        End If
    Next sht
End Function

Function FindRowMatch(strColumn As String, strSearch As String) As Integer

    Dim rng1 As Range

    Set rng1 = Range(strColumn & ":" & strColumn).Find(strSearch, , xlValues, xlPart)

    If Not rng1 Is Nothing Then
        FindRowMatch = rng1.Row
    Else
        FindRowMatch = 0
    End If

End Function

Function HideRows(intStart As Integer, intEnd As Integer)

If intStart = 0 Or intEnd = 0 Then
Exit Function
End If

ActiveSheet.Rows(intStart + 1 & ":" & intEnd - 1).Hidden = True

End Function

Function UnhideRows(intStart As Integer, intEnd As Integer)

If intStart = 0 Or intEnd = 0 Then
Exit Function
End If

ActiveSheet.Rows(intStart + 1 & ":" & intEnd - 1).Hidden = False

End Function
Sub bankdetails()
Call UnPro
Application.ScreenUpdating = False
If Range("G42") = False And Range("J42") = False Then
 Range("B46:B52").Select
 Selection.EntireRow.Hidden = True
  Range("B354:B367").Select
    Selection.EntireRow.Hidden = True
    Range("f357").Select
    Else
     Range("B46:B52").Select
    Selection.EntireRow.Hidden = False
    Range("B354:B367").Select
    Selection.EntireRow.Hidden = False
    'Range("B366:B366").Select
    ' Selection.EntireRow.Hidden = True
    End If

'old bank  details are added recently to GME
If Range("G42").Value = True Or Range("J42").Value = True Then
'A112
Range("A112").EntireRow.Hidden = False
Range("A76:A88").EntireRow.Hidden = False
Else
Range("A112").EntireRow.Hidden = True
Range("A76:A88").EntireRow.Hidden = True
End If

Call hidecheckeu
''Application.ScreenUpdating = False
Call Pro
End Sub


Sub bankdetails1()
Application.ScreenUpdating = False
If Range("f43") = False And Range("O42") = False Then
bankd1 True
Else
bankd1 False
End If
Call hidecheck
''Application.ScreenUpdating = False
End Sub

Sub bankd1(blnHide As Boolean)
Application.ScreenUpdating = False
Dim intStart As Integer
Dim intEnd As Integer
intStart = FindRowMatch("B", "a1")
intEnd = FindRowMatch("B", "a2")
If blnHide = True Then
HideRows intStart, intEnd
Else
UnhideRows intStart, intEnd
End If
''Application.ScreenUpdating = False
Call hidecheck
End Sub

Attribute VB_Name = "hidecheck"
Sub hidecheckeu()
Application.ScreenUpdating = False
Sheets("GM EU Form").Activate
If Rows("42:44").Hidden = True Then
Call Del1
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_1")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del1
Call Addbuttons
End If
End If
If Rows("65:65").Hidden = True Then
Call Del8
Else
On Error Resume Next
 ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_26")).Select
cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del8
Call Addbuttons7
End If
End If
If Rows("30:30").Hidden = True Then
Call Del2
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_5")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del2
Call Addbuttons1
End If
End If

If Rows("147:147").Hidden = True Then
Call Del3
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_8")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del3
Call Addbuttons2
End If
End If

If Rows("261:261").Hidden = True Then
Call Del4
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_11")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del4
Call Addbuttons3
End If
End If

If Rows("366:366").Hidden = True Then
Call Del6
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_19")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del6
Call Addbuttons5
End If
End If


If Rows("355:355").Hidden = True Then
Call Del7
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_24")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del7
Call Addbuttons6
End If
End If
Range("f18").Select
If Rows("70:70").Hidden = True Then
Call Del9
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_32")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del9
Call Addbuttons8
End If
End If

If Rows("128:128").Hidden = True Then
Call Del10
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_60")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del10
Call Addbuttons9
End If
End If

End Sub
Sub hideint()

If Rows("70:70").Hidden = True Then
Call Del9
Else
On Error Resume Next
   a = ActiveSheet.Shapes.Range(Array("Checkbox_32")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del9
Call Addbuttons8
End If
End If

End Sub
Sub hidecheckio()

Application.ScreenUpdating = False
Sheets("GM IO Form").Activate

If Rows("26:26").Hidden = True Then
Call Delb1
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox1")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb1
Call Addb
End If
End If


If Rows("33:33").Hidden = True Then
Call Delb2
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox3")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb2
Call Addb1
End If
End If

If Rows("64:64").Hidden = True Then
Call Delb3
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox4")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb3
Call Addb2
End If
End If

If Rows("226:226").Hidden = True Then
Call Delb4
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox5")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb4
Call Addb3
End If
End If

If Rows("214:214").Hidden = True Then
Call Delb5
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox10")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb5
Call Addb4
End If
End If

If Rows("159:159").Hidden = True Then
Call Delb6
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox13")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb6
Call Addb5
End If
End If

End Sub
Attribute VB_Name = "iotickselection"

Sub Bevel1_Click()
Attribute Bevel1_Click.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets("GM EU Form").Select
    Range("F20:L20").Select
End Sub

Sub tax0()
If Range("f27") = True Then
Range("J27") = False
MsgBox ("Please select one category")
Exit Sub
End If

If Range("J27") = True Then
Range("B29:B37").Select
Selection.EntireRow.Hidden = True
Range("i26").Select
Else
Range("i26").Select
End If
End Sub

Sub taxx1()
If Range("J27") = True Then
Range("F27") = False
MsgBox ("Please select one category")
Exit Sub
End If
Application.ScreenUpdating = False
If Range("f27") = True Then
If Range("m20") = "Thai" Or Range("m20") = "QT01" Then
Range("B36:B38").Select
Else
Range("B29:B34").Select
End If
Selection.EntireRow.Hidden = False
Call Addb1
Range("F29").Select
If Range("m20") = "Thai" Then
Range("F37").Select
End If
Else
Range("B29:B37").Select
Selection.EntireRow.Hidden = True
Range("H26").Select
Call Delb2
End If
''Application.ScreenUpdating = False
End Sub
Sub tlower()
Application.ScreenUpdating = False
If Range("E33") = True Then
Range("B35:B36").Select
Selection.EntireRow.Hidden = False
Range("F35").Select
Else
Range("B35:B36").Select
Selection.EntireRow.Hidden = True
Range("F29").Select
End If
''Application.ScreenUpdating = False
End Sub
Sub tlower1()
Application.ScreenUpdating = False
If Range("H64") = True Then
Range("B74:B99").Select
Selection.EntireRow.Hidden = False
Range("F75").Select
If Range("m20").Value = "E-SAP" Then
Range("B90:B91").Select
Selection.EntireRow.Hidden = True
Range("H64").Select
End If
Else
Range("B74:B99").Select
Selection.EntireRow.Hidden = True
Range("H64").Select
End If
''Application.ScreenUpdating = False
End Sub

Sub uhidebank1()
Application.ScreenUpdating = False
If Range("G227") = False Then
    Range("b228:b241").Select
    Selection.EntireRow.Hidden = True
    Range("F216").Select
    Else
    Range("b228:b241").Select
    Selection.EntireRow.Hidden = False
      Range("F231").Select
    End If
    ''Application.ScreenUpdating = False
End Sub
Sub uhidebank2()
Application.ScreenUpdating = False
    If Range("j227") = False Then
   Range("b242:b254").Select
      Selection.EntireRow.Hidden = True
       Range("F216").Select
      Else
   Range("b242:b254").Select
      Selection.EntireRow.Hidden = False
       Range("F245").Select
      End If
      ''Application.ScreenUpdating = False
End Sub
Sub uhidebank3()
Application.ScreenUpdating = False
      If Range("m227") = False Then
    Range("b255:b267").Select
    Selection.EntireRow.Hidden = True
     Range("F216").Select
    Else
    Range("b255:b267").Select
    Selection.EntireRow.Hidden = False
     Range("F258").Select
    End If
    ''Application.ScreenUpdating = False
End Sub
Sub uhidebank4()
Application.ScreenUpdating = False
    If Range("p227") = False Then
    Range("b268:b280").Select
    Selection.EntireRow.Hidden = True
         Range("F216").Select
    Else
 Range("b268:b280").Select
    Selection.EntireRow.Hidden = False
     Range("F271").Select
    End If
    ''Application.ScreenUpdating = False
End Sub
Sub uhidebank5()
Application.ScreenUpdating = False
     If Range("s227") = False Then
    Range("b281:b293").Select
    Selection.EntireRow.Hidden = True
     Range("F216").Select
  Else
  Range("b281:b293").Select
    Selection.EntireRow.Hidden = False
     Range("F284").Select
    End If
    ''Application.ScreenUpdating = False
End Sub

Sub email_id_change_delete_add_GMIO()
Call UnPro

                    
                    'for company code T4820 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    On Error GoTo 0


Range("B254").EntireRow.Hidden = False

                    x = 254
                    y = "H"
                    Z = "S"
                    o = "runnothing"
                    n = "ACDamail"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With


                   x = 254
                    y = "K"
                    Z = "T"
                    o = "runnothing"
                    n = "ACDamail"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With

                   x = 254
                    y = "O"
                    Z = "U"
                    o = "runnothing"
                    n = "ACDamail"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
Call Pro
End Sub
Attribute VB_Name = "multiplebu"
Sub Pentagon11_Click()

ws = ActiveSheet.Name
If MsgBox("Do you want to reset the current Business Unit selection?", vbYesNo + vbDefaultButton2) = vbYes Then
If ws = "GM EU Form" Then
Sheets("GM Europe Multiple BU &PO").Visible = True
Sheets("GM Europe Multiple BU &PO").Select
Call UnPro
ElseIf ws = "GM IO Form" Then
Sheets("GM IO Multiple BU &PO").Visible = True
Sheets("GM IO Multiple BU &PO").Select
End If
Call checkdelete
    Dim cb As CheckBox
        Range("e2").Select
Cou = Range(ActiveCell, ActiveCell.End(xlDown)).Count - 1
Call UnPro
Dim cel As Range
Dim cbx As CheckBox

cc = 2
For I = 1 To Cou
id = cc + I
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, 4)
        Set cel = ActiveSheet.Cells(id, 4)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Check_" & id
        cbx.Caption = ""
        cbx.OnAction = "add_dynamic"
        cbx.LinkedCell = ActiveSheet.Cells(id, 4).Address
        cbx.Display3DShading = True
        ActiveSheet.Cells(id, 4).Value = "False"
        ActiveSheet.Cells(id, 4).Activate
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Next

Call DeSelectAllCheckBox
End If
If ws = "GM EU Form" Then
Sheets("GM Europe Multiple BU &PO").Visible = True
Sheets("GM Europe Multiple BU &PO").Select
Range("A1").Select
ElseIf ws = "GM IO Form" Then
Sheets("GM IO Multiple BU &PO").Visible = True
Sheets("GM IO Multiple BU &PO").Select
End If
End Sub
Sub checkdelete()
Call UnPro
   Dim cb1 As CheckBox
   Worksheets("GM Europe Multiple BU &PO").Unprotect "Abu"
   For Each cb1 In Worksheets("GM Europe Multiple BU &PO").CheckBoxes
If cb1.Name <> Worksheets("GM Europe Multiple BU &PO").CheckBoxes("CheckEU1").Name Then
cb1.delete
End If
Next
   For Each cb1 In Worksheets("GM IO Multiple BU &PO").CheckBoxes
If cb1.Name <> Worksheets("GM IO Multiple BU &PO").CheckBoxes("CheckIO1").Name Then
cb1.delete
End If
Next
Worksheets("GM Europe Multiple BU &PO").Protect "Abu", True, True, True
End Sub
Sub checkdelete1()
   Dim cb1 As CheckBox
   For Each cb1 In Worksheets("master data").CheckBoxes
If cb1.Name <> Worksheets("master data").CheckBoxes("Check Box 1").Name Then
cb1.delete
End If
Next

End Sub
Sub page()
        
'MsgBox "Mandatory Feilds cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"

End Sub

Sub SHEETHIDE()
c = Sheets.Count
For I = 1 To c
Sheets(I).Visible = 2
Next I
End Sub
Sub SHEETUNHIDE()
Attribute SHEETUNHIDE.VB_ProcData.VB_Invoke_Func = "U\n14"
Application.ScreenUpdating = False
'If InputBox("Input the password", "Password") = "open" Then
Call UnPro
aa = ActiveSheet.Name
For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I
Call UnPro
Sheets(aa).Activate
'Else
'MsgBox ("Wrong Password")

Sheets("GM EU Form").Select
Call format_sheet_normal

Sheets("GM_IO_Form").Select
Call format_sheet_normal

Sheets("GM_NA").Select
Call format_sheet_normal

Sheets(aa).Activate
ActiveWindow.DisplayWorkbookTabs = True
Call UnPro
'End If
End Sub
Sub add_dynamic()
'application.ScreenUpdating = True
Call UnPro
Dim cel As Range
Dim cbx As CheckBox
ws = ActiveSheet.Name
Call deleteb1
cc = 2

Cou = Range("e2").End(xlDown).Row
If ws = "GM Europe Multiple BU &PO" Then
k = 8
ElseIf ws = "GM IO Multiple BU &PO" Then
k = 11
End If
For j = 6 To k
For I = 1 To Cou
id = cc + I
If Cells(id, j) <> Empty And Cells(id, 4) = True Then
If ws = "GM Europe Multiple BU &PO" Then
Range(Cells(id, 6), Cells(id, 8)).Select

'ActiveCell.Offset(0, 3).Value = "T"
'Range(Cells(id, 9), Cells(id, 9)).Select
Range(Cells(id, 9), Cells(id, 9)).Value = "T"

ElseIf ws = "GM IO Multiple BU &PO" Then
Range(Cells(id, 6), Cells(id, 11)).Select
End If
 With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, j)
        Set cel = ActiveSheet.Cells(id, j)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        ''Application.ScreenUpdating = False
        cbx.Name = "Check" & j & "_" & id
        cbx.Caption = ""
        cbx.LinkedCell = ActiveSheet.Cells(id, j + 4).Address '"J" & id
        cbx.Display3DShading = True
        'MsgBox ActiveSheet.Cells(id, j + 4).Address
        Else
        'Range(Cells(id, 9), Cells(id, 9)).Value = ""
        ActiveSheet.Cells(id, j + 4).Value = ""
        End If
    Next I
    Next j
Range("E3").Select
Range("A1").Select
Call Pro
End Sub

Sub deleteb1()
ws = ActiveSheet.Name
Call UnPro
Application.ScreenUpdating = False
If ws = "GM Europe Multiple BU &PO" Then
Range("f3:h53").Select
ElseIf ws = "GM IO Multiple BU &PO" Then
Range("f3:k23").Select
End If
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
        With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
Range("i:i").ClearContents

For j = 6 To 11
For I = 1 To 100
On Error Resume Next
ActiveSheet.CheckBoxes("Check" & j & "_" & I).Select
  Selection.FormatConditions.delete
ActiveSheet.CheckBoxes("Check" & j & "_" & I).delete
    Next I
    Next j
 On Error GoTo 0
 Range("E3").Select
 ''Application.ScreenUpdating = False
 'Call Pro
End Sub

    
    
Sub DeSelectAllCheckBox()
Call UnPro
Application.ScreenUpdating = False
ws = ActiveSheet.Name
Worksheets(ws).CheckBoxes = False
Call add_dynamic
Range("J3:L60").ClearContents
''Application.ScreenUpdating = False
End Sub


Sub SelectAllCheckBox()
ws = ActiveSheet.Name
Application.ScreenUpdating = False
    Dim cb As CheckBox
        For Each cb In Worksheets(ws).CheckBoxes
        If ws = "GM Europe Multiple BU &PO" Then
        checkname = "CheckEU1"
        ElseIf ws = "GM IO Multiple BU &PO" Then
         checkname = "CheckIO1"
         End If
        If cb.Name <> Worksheets(ws).CheckBoxes(checkname).Name Then
            cb.Value = Worksheets(ws).CheckBoxes(checkname).Value
        End If
    Next cb
Call add_dynamic
''Application.ScreenUpdating = False
End Sub



Attribute VB_Name = "shortcuts"

' InQuest injected base64 decoded content
' bpZ'

INQUEST-PP=macro
Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"



Sub SAP()
Attribute SAP.VB_Description = "Macro recorded 07.12.00 by HZ4540"
Attribute SAP.VB_ProcData.VB_Invoke_Func = "|fffd|\n14"
'
' SAP Macro
' Macro recorded 07.12.00 by HZ4540
'
' Keyboard Shortcut: Ctrl+|fffd|
'
    Range("B7").Select
    Selection.Copy
    Sheets("Auftragsformular").Select
    Range("I1").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
    Sheets("Verfolgungsliste").Select
    Range("D7").Select
    Sheets("Verfolgungsliste").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Auftragsformular").Select
    Range("E3").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
    Sheets("Verfolgungsliste").Select
    Range("E7").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Auftragsformular").Select
    Range("J3").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
End Sub


INQUEST-PP=macro
Attribute VB_Name = "CheckBox_related_1st"
Sub bublu()

                Dim s As CheckBox
                On Error Resume Next
                For Each s In ActiveSheet.CheckBoxes
                s.delete
                's.OnAction = ""
                Next
End Sub
Sub clear_all_checkbox()

'1
x = 0
Do
x = x + 1
Call bublu
If x = 50 Then Exit Do
Loop

End Sub
Sub selecting_valid_country()

                Dim s As CheckBox
                On Error Resume Next
                For Each s In ActiveSheet.CheckBoxes
                s.delete
                's.OnAction = ""
                Next
                On Error GoTo 0
                Call clear_all_checkbox
If Range("F20").Value = "Thailand" Then
                    x = 26
                    y = "G"
                    Z = "s"
                    o = "T4820m"
                    n = "T4820n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 27
                    y = "G"
                    Z = "s"
                    o = "T4A10m"
                    n = "T4A10n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 28
                    y = "G"
                    Z = "s"
                    o = "T4230m"
                    n = "T4230n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    Else
                    End If

    If Range("F20").Value = "New Zealand" Then
                    x = 29
                    y = "G"
                    Z = "s"
                    o = "n4020m"
                    n = "n4020n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
    Else
    End If

    If Range("F20").Value = "Australia" Then
                    x = 31
                    y = "G"
                    Z = "s"
                    o = "A4501m"
                    n = "A4501n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                        End With
                                        x = 31
                    x = 51
                    y = "G"
                    Z = "s"
                    o = "A4E70m"
                    n = "A4E70n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                        End With

    Else
    End If

    If Range("F20").Value = "Philippines" Then
    
                    x = 34
                    y = "G"
                    Z = "s"
                    o = "P4570m"
                    n = "P4570n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 35
                    y = "G"
                    Z = "s"
                    o = "P4E50m"
                    n = "P4E50n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                                  
    Else
    End If

  If Range("F20").Value = "Singapore" Then
    
                    x = 36
                    y = "G"
                    Z = "s"
                    o = "S4290m"
                    n = "S4290n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 37
                    y = "G"
                    Z = "s"
                    o = "S4E30m"
                    n = "S4E30n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With

                    x = 50
                    y = "G"
                    Z = "s"
                    o = "A4F10m"
                    n = "A4F10n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                        End With


                                  
    Else
    End If
    
     If Range("F20").Value = "Indonesia" Then
    
                    x = 39
                    y = "G"
                    Z = "s"
                    o = "I4250m"
                    n = "I4250n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 40
                    y = "G"
                    Z = "s"
                    o = "I4A80m"
                    n = "I4A80n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                                  
    Else
    End If
    
    If Range("F20").Value = "India" Then
    
                    x = 41
                    y = "G"
                    Z = "s"
                    o = "IGMIm"
                    n = "IGMIn"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 42
                    y = "G"
                    Z = "s"
                    o = "IGMIMm"
                    n = "IGMIMn"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 43
                    y = "G"
                    Z = "s"
                    o = "IGMTPm"
                    n = "IGMTPn"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 44
                    y = "G"
                    Z = "s"
                    o = "I4A40m"
                    n = "I4A40n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With

                                  
    Else
    End If

     If Range("F20").Value = "Utd.Arab Emir." Then
    
                    x = 47
                    y = "G"
                    Z = "s"
                    o = "U2190m"
                    n = "U2190n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                    x = 48
                    y = "G"
                    Z = "s"
                    o = "U6500m"
                    n = "U6500n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With
                                  
    Else
    End If

     If Range("F20").Value = "Vietnam" Then
    
                    x = 49
                    y = "G"
                    Z = "s"
                    o = "V4C10m"
                    n = "V4C10n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    290, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        
                                  End With

                                  
    Else
    End If

Range("F20").Select
End Sub

Sub vendorcatogery_and_its_checkboxes()

Call UnPro
Range("A61:A63").EntireRow.Hidden = False
Range("A72:A77").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete

                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

                    xrow = 62
                    ycolumn = "D"
                    Zlinked = "D" & 63
                    oonaction = "vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 62
                    ycolumn = "G"
                    Zlinked = "G" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select

                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
''''                    xrow = 62
''''                    ycolumn = "I"
''''                    Zlinked = "I" & 63
''''                    oonaction = "vendercatogery_multiple_select_control"
''''                    nname = "pv"
''''
''''
''''                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
''''                                                                    Cells(xrow, ycolumn).Top, _
''''                                                                    80, 17).Select
''''                                        With Selection
''''                                            .Caption = ""
''''                                            .Value = xlOff '
''''                                            .LinkedCell = Zlinked
''''                                            .Display3DShading = True
''''                                    '        .lock = False
''''                                            .Name = nname
''''                                            .OnAction = oonaction
''''
''''                                  End With
                    xrow = 62
                    ycolumn = "m"
                    Zlinked = "m" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 62
                    ycolumn = "P"
                    Zlinked = "P" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 62
                    ycolumn = "S"
                    Zlinked = "S" & 63
                    oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                                  
          If Range("A76").Value = "Thailand" Or Range("F20").Value = "Indonesia" Then
          Range("F20").EntireRow.Hidden = False
                    xrow = 76
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "SAP_Customer_No" '"purchasing_vendor_ERS_category"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
            Else
            Range("A76").EntireRow.Hidden = True
            End If


Range("F20").Select
End Sub
Sub purchasing_vendor_ERS_category()

Call UnPro

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

If Range("D63").Value = True Then
Range("A63:A65").EntireRow.Hidden = False
'Range("A71:A77").EntireRow.Hidden = False

                    
                    xrow = 64
                    ycolumn = "G"
                    Zlinked = "G" & 65
                    oonaction = "ERS_multiple_select_control"
                    nname = "ERSpv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 64
                    ycolumn = "I"
                    Zlinked = "I" & 65
                    oonaction = "ERS_multiple_select_control"
                    nname = "ERSpv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Else
Range("A63:A65").EntireRow.Hidden = True

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0


End If
Range("F74").Select
End Sub

Sub Supplier_type_inter_non_inter()
Call UnPro
Range("A52:A54").EntireRow.Hidden = False

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("STi").delete
                    ActiveSheet.CheckBoxes("STi").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0


'Range("A71:A77").EntireRow.Hidden = False

                    
                    xrow = 53
                    ycolumn = "E"
                    Zlinked = "E" & 54
                    oonaction = "STi_multiple_select_control"
                    nname = "STi"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 53
                    ycolumn = "H"
                    Zlinked = "H" & 54
                    oonaction = "STi_multiple_select_control"
                    nname = "STi"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Range("F20").Select

End Sub
Sub STi_multiple_select_control()
Call UnPro
Dim iVal As Integer

If Range("F20").Value = "Utd.Arab Emir." And Range("Q18").Value = "New Duns/Vendor Code creation" Then
Range("A69:A71").EntireRow.Hidden = False
Else
Range("A69:A71").EntireRow.Hidden = True
End If

iVal = Application.WorksheetFunction.CountIf(Range("C54:J54"), True)

If iVal > 1 Then
    Range("E54").Value = False
    Range("H54").Value = False
    'Range("I63").Value = False
    'Range("M63").Value = False
    'Range("P63").Value = False
    'Range("S63").Value = False
    MsgBox "You can not select the both types "
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    On Error GoTo 0
Else
End If

If Range("E54").Value = True Then
'Range("A64:A71").EntireRow.Hidden = False
Call vendorcatogery_and_its_checkboxes
Else
Range("A55:A78").EntireRow.Hidden = True
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    On Error GoTo 0

End If

If Range("H54").Value = True Then
Range("A66:A69").EntireRow.Hidden = False
'Call purchasing_vendor_ERS_category
Else
Range("A66:A69").EntireRow.Hidden = True

End If

If Range("F20").Value = "Utd.Arab Emir." And Range("Q18").Value = "New Duns/Vendor Code creation" Then
Range("A69:A71").EntireRow.Hidden = False
Range("F70").Value = ""
Else
Range("A69:A71").EntireRow.Hidden = True
Range("F70").Value = ""
End If

Call Pro
End Sub
Sub vendercatogery_multiple_select_control()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("C63:U63"), True)

If iVal > 1 Then
    
    Range("D63").Value = False
    Range("G63").Value = False
    'Range("I63").Value = False
    Range("M63").Value = False
    Range("P63").Value = False
    Range("S63").Value = False
    MsgBox "One vendor category at a time"

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

Else
End If



If Range("I63").Value = True Then
Range("A64:A71").EntireRow.Hidden = False
Else
Range("A64:A71").EntireRow.Hidden = True
End If


If Range("D63").Value = True Then
If Range("s44").Value = True Then Else Call purchasing_vendor_ERS_category
Else

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    ActiveSheet.CheckBoxes("ERSpv").delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete
                    'ActiveSheet.CheckBoxes("pv").Delete

                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
'Range("A64:A71").EntireRow.Hidden = True
End If



Call Pro
End Sub


Sub ERS_multiple_select_control()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("D65:J65"), True)

If iVal > 1 Then
    
    Range("G65").Value = False
    Range("I65").Value = False
    'Range("I63").Value = False
    'Range("M63").Value = False
    'Range("P63").Value = False
    'Range("S63").Value = False
    MsgBox "You can not select the both options"
    
Else
End If

'
'If Range("I63").Value = True Then
'Range("A64:A71").EntireRow.Hidden = False
'Else
'Range("A64:A71").EntireRow.Hidden = True
'End If
Call Pro
End Sub


Sub TDS_configuration_checkboxes()
Range("A78:A106").EntireRow.Hidden = True
Range("A78:A81").EntireRow.Hidden = False

                    On Error Resume Next
                    ActiveSheet.CheckBoxes("tds").delete
                    ActiveSheet.CheckBoxes("tds").delete
                    ActiveSheet.CheckBoxes("tdsrequired").delete
                    
                    On Error GoTo 0
                    xrow = 80
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "Taxconfig_required"
                    nname = "tds"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 80
                    ycolumn = "J"
                    Zlinked = "J" & xrow + 1
                    oonaction = "Taxconfig_required"
                    nname = "tds"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("F81").Locked = False
Range("J81").Locked = False

End Sub

Sub Taxconfig_required()

Call UnPro
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("tdsrequired").delete
                    On Error GoTo 0

If Range("F81").Value = True Then
                    Range("A82:A87").EntireRow.Hidden = False
                    xrow = 87
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "Lower_TDS_set_up_required"
                    nname = "tdsrequired"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Else
Range("A82:A88").EntireRow.Hidden = True
End If



If Range("F81").Locked = True Then MsgBox "TDS in not applicable for Material Suppliers"

ciVal = Application.WorksheetFunction.CountIf(Range("E81:K81"), True)

If ciVal > 1 Then
Range("F81").Value = False
Range("J81").Value = False
MsgBox "Both the options are cannot be selected at a time"
Else
End If

Call Pro
End Sub

Sub Lower_TDS_set_up_required()
Call UnPro
If Range("F88").Value = True Then
Range("A88:A92").EntireRow.Hidden = False
Else
Range("A88:A92").EntireRow.Hidden = True
End If
Call Pro
End Sub

Sub new_creation_supplier()
Call UnPro
Range("A108:A137").EntireRow.Hidden = False

On Error Resume Next
ActiveSheet.CheckBoxes("altpayeeduns").delete
On Error GoTo 0


                    xrow = 136
                    ycolumn = "H"
                    Zlinked = "H" & xrow + 1
                    oonaction = "Alternative_Payee_Duns"
                    nname = "altpayeeduns"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

'Call Pro
End Sub

Sub Alternative_Payee_Duns()
Call UnPro
                    If Range("H137").Value = True Then
                    Range("A139:A164").EntireRow.Hidden = False
                    Else
                    Range("A139:A164").EntireRow.Hidden = True
                    End If
Call Pro
End Sub


Sub banking_information()
Call UnPro

Range("A594:A674").EntireRow.Hidden = False
On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
On Error GoTo 0

Range("A594:A674").EntireRow.Hidden = True

Range("A594:A608").EntireRow.Hidden = False

If Range("F20").Value = "India" Then

Range("O603").Value = "IFSC"
Range("O618").Value = "IFSC"
Range("O632").Value = "IFSC"
Range("O645").Value = "IFSC"
Range("O658").Value = "IFSC"
Range("O671").Value = "IFSC"

Else

Range("O603").Value = "Telephone Number"
Range("O618").Value = "Telephone Number"
Range("O632").Value = "Telephone Number"
Range("O645").Value = "Telephone Number"
Range("O658").Value = "Telephone Number"
Range("O671").Value = "Telephone Number"

End If




'1st bank
                    xrow = 607
                    ycolumn = "G"
                    Zlinked = ycolumn & xrow + 1
                    nname = "adbank"
                    oonaction = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'2nd bank
                    xrow = 607
                    ycolumn = "J"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank2m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'3rd bank
                    xrow = 607
                    ycolumn = "M"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank3m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

'4th bank
                    xrow = 607
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank4m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'5th bank
                    xrow = 607
                    ycolumn = "S"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "additional_bank_required_field"
                    'nname = "adbank5n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Range("F597").Select
'Call Pro
End Sub
Sub eft_cheque_check()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("B524:P524"), True)

If iVal > 1 Then
Range("E524").Value = False
Range("K524").Value = False
MsgBox ("Please select a valid mode of payment")
Else
End If

If Range("E524").Locked = True And Range("K524").Locked = True Then
MsgBox "Please note that supplier payment mode has changed to EFT"
Call Pro
Exit Sub

Else
End If
        'for thailand pickup details.
        If Range("F20").Value = "Thailand" Then
            If Range("K524").Value = True Then
            Range("A475:A478").EntireRow.Hidden = False
            Else
            Range("A475:A478").EntireRow.Hidden = True
            End If
        Else
        Range("A475:A478").EntireRow.Hidden = True
        End If
        
        'for thailand pickup details.
'        If Range("F20").Value = "Thailand" Then
            If Range("E524").Value = True Then
            Call banking_information
            Else
                Range("A594:A674").EntireRow.Hidden = False
                On Error Resume Next
                'ActiveSheet.CheckBoxes("EFTpayment").Delete
                'ActiveSheet.CheckBoxes("Chequepayment").Delete

                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                On Error GoTo 0
                Range("A594:A674").EntireRow.Hidden = True

            End If
'        Else
'        Range("A475:A478").EntireRow.Hidden = True
'        End If

Call Pro
End Sub

Sub additional_bank_required_field()

Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("F608:S608"), True)

If iVal > 1 Then

Range("G608").Value = False
Range("J608").Value = False
Range("M608").Value = False
Range("P608").Value = False
Range("S608").Value = False
MsgBox ("Only 5 additional banks can be added maximum")
Else
End If

Range("A609:A674").EntireRow.Hidden = True

If Range("G608").Value = True Then
Range("A609:A622").EntireRow.Hidden = False
Else
End If

If Range("J608").Value = True Then
Range("A609:A635").EntireRow.Hidden = False
Else
End If

If Range("M608").Value = True Then
Range("A609:A648").EntireRow.Hidden = False
Else
End If

If Range("P608").Value = True Then
Range("A609:A661").EntireRow.Hidden = False
Else
End If

If Range("S608").Value = True Then
Range("A609:A674").EntireRow.Hidden = False
Else
End If
Call Pro
End Sub

Sub payment_term_with_checkbox()
Call UnPro
Range("A222:A230").EntireRow.Hidden = False

'financin section
                    xrow = 225
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "financing_section"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'purchasing section
                    xrow = 225
                    ycolumn = "I"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "purchasing_section"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

        Range("F223").Select
        Call Pro
End Sub

Sub new_creation_supplier_australia_and_newz()

Call UnPro
Range("A398:A423").EntireRow.Hidden = False

                    xrow = 422
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "for_newcreation_of_austrandnew_alternative_payee"
                    nname = "payee_chekbox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("F420").Select
'Call Pro
End Sub

Sub new_creation_supplier_other_region()

Call UnPro
If Range("F20").Value = "Thailand" Or Range("F20").Value = "Philippines" Then
Range("A365:A370").EntireRow.Hidden = False

                    xrow = 366
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "TDS"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    xrow = 366
                    ycolumn = "J"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing"
                    nname = "TDSno"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Else
Range("A365:A370").EntireRow.Hidden = True
End If

Range("A372:A396").EntireRow.Hidden = False

                    xrow = 395
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "for_newcreation_of_other_countries_alternative_payee"
                    nname = "payee_chekbox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    xrow = 395
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "for_newcreation_of_other_countries_Ship_from_duns"
                    nname = "shipfrom_chekbox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

Range("F373").Select

'for thailand no ship from duns is required

    If Range("F20").Value = "Thailand" Then
On Error Resume Next
    ActiveSheet.Shapes.Range(Array("payee_chekbox")).delete

    With Range("H395").Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With
Else
    With Range("H395").Font
        .Color = -10477568
        .TintAndShade = 0
    End With

End If
On Error GoTo 0

'Call Pro
End Sub


Sub EFTCheque()
Call UnPro
Range("A523").EntireRow.Hidden = False
Range("B986").EntireRow.Hidden = True
    



                    xrow = 523 '347
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_cheque_check"
                    nname = "EFTpayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With


                    'xrow = 347
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_cheque_check"
                    nname = "Chequepayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                End With

If Range("F20").Value = "India" Then
Call banking_information
Range("E348").Value = True
Range("K348").Value = False
Range("E348").Locked = True
Range("K348").Locked = True
Else
Range("E348").Value = False
Range("K348").Value = False
Range("E348").Locked = False
Range("K348").Locked = False
End If

'Call Pro
End Sub

Sub Beneinter()
Call UnPro
Range("A591:A593").EntireRow.Hidden = False




                    xrow = 592
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "beninter_check"
                    nname = "Bene"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With


                    xrow = 592
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "beninter_check"
                    nname = "inter"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Call Pro
End Sub

Sub beninter_check()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("E593:K593"), True)

If iVal > 1 Then
Range("E593").Value = False
Range("K593").Value = False
MsgBox ("Please select a valid Bank Account type")
Else
End If

Call Pro
End Sub

Sub clear_gmio_only_header_info()
Call UnPro
Range("F10:L10,Q10:U10,F12:L12,F14:L14,Q12:U12,Q18:U18,F20:L20").ClearContents
Call Pro
End Sub

Sub clear_GMIO_all_fieled_except_header_info()

'On Error Resume Next
Union(Range("F122:J122,F124:J124,F126:J126,F128:N128,F130:U130"), _
Range("F134:U134,F132:J132,M132:U132"), _
Range("F57:L57,F59:U59,E67:F67,L67:M67,F83:J83,F85:J85,M85:Q85,T85:U85,F89:J89,F91:J91,M89:Q89,M91:Q91,T89:U89,S96:U96,K94:O94,K96:O96,E94:H94,E96:H96,E98:H98,E100:H100,E102:H102,E105:H105,K102:O102,K100:O100,K98:O98,F109:L109"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120,F122:J122,F124:J124,O122:U122,O124:U124,O126:U126,F126:J126,F128:U128,F130:U130,F132:J132,M132:U132,F134:U134,F109:L109,F140:L140,F143:U143,F145:U145,F147:U147,F149:J149,F151:J151"), _
Range("M149:U149,M151:U151,F153:J153,F155:J155,M155:U155,M153:U153,F157:U157,F159:U159,F161:J161,M161:U161,F163:U163,F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180,F182:U182,F184:U184"), _
Range("O206:U206,F206:K206,F211:L211,F213:U213,F217:U219,F223:I223,O223:U223,F227:U229,F233:I233,O233:U233,F235:U237,F241:U241,F243:U243,F245:J245"), Range("M245:P245,S245:U245,F247:U247,F249:U251,F255:U255,F257:U257,F259:U261,F265:U265,F267:U267,F269:U269,F271:J271,M271:U271,F273:J273,F275:N275,F277:N277,F279:J279,M279:P279,S279:U279,F281:U281"), Range("F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180"), Range("F182:N182,F184:U184,F186:J186,M186:U186,F188:U188,F192:L192,F194:U194,F198:I198,F200:I200,F202:I202,P200:S200,P202:S202"), _
Range("F369:J369,N369:R369,F373:L373,F375:U375,F377:U377,F379:U379,F381:J381,M381:U381,M383:U383,F383:J383,F385:J385,M385:U385,F387:U387,F389:U389,F391:J391,M391:U391,F393:U393"), _
Range("F399:L399,F402:U402,F404:U404,F406:U406,F408:J408,M408:U408,F410:J410,M410:U410,M412:U412,F412:J412,F414:N414,F416:N416,F418:J418,M418:U418,F420:U420,F425:L425,F428:U428,F430:U430,F432:U432,F434:J434,M434:U434,F436:J436,M436:U436,M438:U438,F438:J438"), _
Range("F440:N440,F442:N442,F444:J444,M444:U444,F446:U446"), _
Range("F452:L452,F454:U454,F456:U456,F458:U458,F460:J460,M460:U460,F462:J462,M462:U462,F464:J464,M464:U464,F466:U466,F468:U468,F470:J470,M470:U470,F472:U472"), _
Range("F477:K477,O477:U477,F481:L481,F483:U483"), _
Range("F499:L499,F502:U502,F504:U504,F506:U506,F508:J508,M508:U508,M510:U510,F510:J510,F512:J512,M512:U512,F514:U514,F516:U516,F518:J518,M518:U518,F520:U520,F525:L525,F527:U527,F529:U529,F531:U531,F533:J533,M533:U533,M535:U535,F535:J535,F537:J537,M537:U537"), _
Range("F539:U539,F541:U541,F543:J543,M543:U543,F545:U545,F548:L548,F550:U550,F552:U552,F554:U554"), _
Range("F556:J556,M556:U556,M558:U558,F558:J558,F560:J560,M560:U560,F562:U562,F564:U564,F566:J566,M566:U566,F568:U568,F571:L571,F573:U573"), _
Range("F575:U575,F577:U577,F579:J579,M579:U579,F581:J581,M581:U581,F583:J583,M583:U583,F585:U585,F587:U587"), _
Range("F589:J589,M589:U589,F595:Q595,F597:Q597,T597:U597,F599:Q599,F601:I601,L601:N601,R601:U601,F603:N603,F605:N605,R603:U603,R605:U605"), _
Range("F610:Q610,F612:Q612,F614:Q614,T612:U612,F616:I616,L616:N616,R616:U616,F618:N618,F620:N620,R618:U618,R620:U620"), _
Range("F624:Q624,F626:Q626,T626:U626,F628:Q628,F630:I630,L630:N630,R630:U630,R632:U632,F632:N632,F634:N634,R634:U634"), _
Range("F637:Q637,F639:Q639,F641:Q641,T639:U639,F643:I643,L643:N643,R643:U643,R645:U645,F645:N645,F647:N647,R647:U647"), _
Range("F650:Q650,F652:Q652,T652:U652,F654:Q654,F656:I656,L656:N656,R656:U656,R658:U658,F658:N658,F660:N660,R660:U660"), _
Range("F663:Q663,F665:Q665,T665:U665,F667:Q667,F669:I669,L669:N669,R669:U669,R671:U671,F671:N671,F673:N673,R673:U673"), _
Range("D988:D992,F995:U997")).ClearContents

'Range("").Select

End Sub

Sub LowerTDSC_Only()

Call UnPro
Range("B86:B92").EntireRow.Hidden = True
Range("B86:B87").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("tdsrequired").delete
                    On Error GoTo 0

If Range("F87").EntireRow.Hidden = False Then
                    If Range("Q18").Value = "With holding Tax configuration" Then Range("B88:B92").EntireRow.Hidden = True
                    If Range("Q18").Value = "Lower TDS configuration" Then Range("B88:B92").EntireRow.Hidden = False
                    xrow = 87
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "Lower_TDS_set_up_required"
                    nname = "tdsrequired"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOn '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    If Range("Q18").Value = "With holding Tax configuration" Then Range("F88").Value = False

Else
Range("B88:B92").EntireRow.Hidden = True
End If
Call Pro
End Sub


Sub inactivat_delete_checkBox()

                    xrow = 980
                    ycolumn = "F"
                    Zlinked = "F" & xrow + 1
                    oonaction = "onetic_at_a_time"
                    nname = "inactivat_delete_checkBox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    xrow = 980
                    ycolumn = "I"
                    Zlinked = "I" & xrow + 1
                    oonaction = "onetic_at_a_time"
                    nname = "inactivat_delete_checkBox"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

End Sub


Sub onetic_at_a_time()
If Range("F981").Value = True And Range("I981").Value = True Then
MsgBox ("Both option can not be selected at a time")

Range("F981").Value = False
Range("I981").Value = flase
Else
End If
End Sub




Sub GM_IO_add_delete_change_bank()

Call UnPro
Range("A341:A344").EntireRow.Hidden = False
'Range("A64:A73").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                    ActiveSheet.CheckBoxes("ADC").delete
                     
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

                    xrow = 342
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_for_add_change_delete" '"purchasing_vendor_ERS_category"
                    nname = "ADC"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "ADC"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select

                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 62
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "eft_for_add_change_delete"
                    nname = "ADC"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Range("F20").Select
End Sub

Sub eft_for_add_change_delete()
Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("H343:Q343"), True)

If iVal > 1 Then
Range("H343").Value = False
Range("K343").Value = False
Range("P343").Value = False

MsgBox ("Please select a valid option")
Else
End If


''If Range("E524").Locked = True And Range("K524").Locked = True Then
''MsgBox "Please note that supplier payment mode has changed to EFT"
''Call Pro
''Exit Sub


        'for thailand pickup details.
        If Range("F20").Value = "Thailand" Then
            If Range("K524").Value = True Then
            Range("A475:A478").EntireRow.Hidden = False
            Else
            Range("A475:A478").EntireRow.Hidden = True
            End If
        Else
        Range("A475:A478").EntireRow.Hidden = True
        End If
        
        'for thailand pickup details.
'        If Range("F20").Value = "Thailand" Then
            If Range("H343").Value = True Or Range("K343").Value = True Or Range("P343").Value = True Then
            Call banking_information
                If Range("P343").Value = True Then
                
                'old bank details hiding
                Range("B348:B360").EntireRow.Hidden = True
                Range("A364").EntireRow.Hidden = True
                
                Range("A986:A993").EntireRow.Hidden = True
                Else
                'old bank details unhiding
                Range("B348:B360").EntireRow.Hidden = False
                Range("A364").EntireRow.Hidden = False
                
                Range("A986:A993").EntireRow.Hidden = False
                End If
            
            Else

                'old bank details hiding
                Range("B348:B360").EntireRow.Hidden = True
                Range("A364").EntireRow.Hidden = True

                Range("A594:A674").EntireRow.Hidden = False
                On Error Resume Next
                'ActiveSheet.CheckBoxes("EFTpayment").Delete
                'ActiveSheet.CheckBoxes("Chequepayment").Delete

                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                
                ActiveSheet.CheckBoxes("adbank").delete
                ActiveSheet.CheckBoxes("adbank").delete
                On Error GoTo 0
                Range("A594:A674").EntireRow.Hidden = True

            End If
'        Else
'        Range("A475:A478").EntireRow.Hidden = True
'        End If

Call Pro
End Sub


Sub SAP_Customer_No()

Call UnPro
If Range("F77").Value = True Then
'to editable
    With Range("I76:K76").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Locked = False
Else
'to no-editable
    With Range("I76:K76").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    Range("I76:K76").Locked = True

End If
Call Pro
End Sub
Attribute VB_Name = "CheckBox_related_2nd"
Sub T4820m()
Call UnPro
                    
                    'for company code T4820 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4820indirect").delete
                    ActiveSheet.CheckBoxes("T4820direct").delete
                    On Error GoTo 0
                    
                    If Range("s26").Value = True Then
                    
                    x = 26
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4820indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 26
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4820direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    
                Else
                End If
                Range("F20").Select
                

Range("V25").Formula = "4820"

Call Pro
End Sub

Sub T4A10m()
Call UnPro
Range("V25").Formula = "4A10"

                    'for company code T4A10 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4A10indirect").delete
                    ActiveSheet.CheckBoxes("T4A10direct").delete
                    On Error GoTo 0
                    
                    If Range("s27").Value = True Then
                    
                    x = 27
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4A10indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 27
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4A10direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    
                Else
                End If
                Range("F20").Select
                
Call Pro
End Sub


Sub T4230m()
Call UnPro
Range("V25").Formula = "4230"

                    'for company code T4230 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4230indirect").delete
                    ActiveSheet.CheckBoxes("T4230direct").delete
                    On Error GoTo 0
                    
                    If Range("s28").Value = True Then
                    
                    x = 28
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4230indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 28
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4230direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    
                Else
                End If
                Range("F20").Select
                
Call Pro
End Sub

Sub n4020m()
Call UnPro
Range("V25").Formula = "4020"


                   'for company code T4020 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("T4020indirect").delete
                    ActiveSheet.CheckBoxes("T4020indirect2").delete
                    ActiveSheet.CheckBoxes("T4020direct").delete
                    On Error GoTo 0
                    
                    If Range("s29").Value = True Then
                    
                    x = 29
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4020indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 29
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "T4020direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                
                    x = 30
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "T4020indirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                Else
                End If
                Range("F20").Select
                


Call Pro
End Sub


'''''
Sub A4501m()
Call UnPro
Range("V25").Formula = "4501"

                    'for company code A4501 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("A4501indirect").delete
                    ActiveSheet.CheckBoxes("A4501indirect2").delete
                    ActiveSheet.CheckBoxes("A4501direct").delete
                    ActiveSheet.CheckBoxes("A4501direct2").delete
                    ActiveSheet.CheckBoxes("A4501direct3").delete
                    On Error GoTo 0
                    
                    If Range("s31").Value = True Then
                    
                    x = 31
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4501indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 31
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "A4501direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With

                    
                    x = 32
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4501indirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 32
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "A4501direct2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                
                    x = 33
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "A4501direct3"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                Else
                End If
                Range("F20").Select
                


Call Pro
'MsgBox Range("v25").Value
End Sub


Sub P4570m()

Call UnPro
Range("V25").Formula = "4570"

                    'for company code P4570 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("P4570indirect").delete
                    ActiveSheet.CheckBoxes("P4570direct").delete

                    On Error GoTo 0
                    
                    If Range("s34").Value = True Then
                    
                    x = 34
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "P4570indirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 34
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "P4570direct"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
Else
End If
Range("F20").Select


Call Pro
End Sub


Sub P4E50m()

Range("V25").Formula = "'4E50"

End Sub

Sub S4290m()
Call UnPro
Range("V25").Formula = "4290"


                    'for company code S4290m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("S4290mindirect").delete
                    ActiveSheet.CheckBoxes("S4290mdirect").delete

                    On Error GoTo 0
                    
                    If Range("s36").Value = True Then
                    
                    x = 36
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "S4290mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 36
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "S4290mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
Else
End If
Range("F20").Select

Call Pro
End Sub


Sub S4E30m()
Call UnPro
Range("V25").Formula = "'4E30"

'S4E30m

                    'for company code S4E30m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("S4E30mindirect").delete
                    ActiveSheet.CheckBoxes("S4E30mdirect").delete
                    ActiveSheet.CheckBoxes("S4E30mdirect2").delete
                    On Error GoTo 0
                    
                    If Range("S37").Value = True Then
                    
                    x = 37
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "S4E30mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 37
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "S4E30mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With

                    x = 38
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "S4E30mdirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With


Else
End If
Range("F20").Select

Call Pro
End Sub

Sub I4250m()
Call UnPro
Range("V25").Formula = "4250"

'I4250m


                    'for company code I4250m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4250mindirect").delete
                    ActiveSheet.CheckBoxes("I4250mdirect").delete
                    'ActiveSheet.CheckBoxes("I4250mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S39").Value = True Then
                    
                    x = 39
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4250mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 39
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "I4250mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select

Call Pro
End Sub



Sub I4A80m()
Call UnPro
Range("V25").Formula = "4A80"

'I4A80m

                    'for company code I4A80m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A80mindirect").delete
                    ActiveSheet.CheckBoxes("I4A80mdirect").delete
                    'ActiveSheet.CheckBoxes("I4A80mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S40").Value = True Then
                    
                    x = 40
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A80mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 40
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "I4A80mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select

Call Pro
End Sub

Sub IGMIm()
Call UnPro
Range("V25").Formula = "GMI"

'IGMIm

                    'for company code IGMIm creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("IGMImindirect").delete
                    ActiveSheet.CheckBoxes("IGMImdirect").delete
                    'ActiveSheet.CheckBoxes("IGMImdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S41").Value = True Then
                    
                    x = 41
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "IGMImindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 41
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "IGMImdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select

Call Pro
End Sub

Sub IGMIMm()
Call UnPro
Range("V25").Formula = "GMIM"

'IGMIMm

                    'for company code IGMIMm creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("IGMIMmindirect").delete
                    ActiveSheet.CheckBoxes("IGMIMmdirect").delete
                    'ActiveSheet.CheckBoxes("IGMIMmdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S42").Value = True Then
                    
                    x = 42
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "IGMIMmindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 42
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "IGMIMmdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub IGMTPm()
Call UnPro
Range("V25").Formula = "GMTP"

'IGMTPm

                    'for company code IGMTPm creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("IGMTPmindirect").delete
                    ActiveSheet.CheckBoxes("IGMTPmdirect").delete
                    'ActiveSheet.CheckBoxes("IGMTPmdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S43").Value = True Then
                    
                    x = 43
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "IGMTPmindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 43
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "IGMTPmdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub


Sub I4A40m()
Call UnPro
Range("V25").Formula = "4A40"

'I4A40m

                    'for company code I4A40m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A40mindirect").delete
                    ActiveSheet.CheckBoxes("I4A40mdirect").delete
                    'ActiveSheet.CheckBoxes("I4A40mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("s44").Value = True Then
                    
                    x = 44
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A40mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 44
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "I4A40mdirect"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With
Else
End If

                    'for company code I4A40m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A40mindirect2").delete
                    ActiveSheet.CheckBoxes("I4A40mdirect2").delete
                    'ActiveSheet.CheckBoxes("I4A40mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("s44").Value = True Then
                    
                    x = 45
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A40mindirect2"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 45
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "I4A40mdirect2"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With
Else
End If

                    'for company code I4A40m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("I4A40mindirect3").delete
                    ActiveSheet.CheckBoxes("I4A40mdirect3").delete
                    'ActiveSheet.CheckBoxes("I4A40mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("s44").Value = True Then
                    
                    x = 46
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "I4A40mindirect3"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
'''                    x = 46
'''                    y = "P"
'''                    Z = "U"
'''                    o = ""
'''                    n = "I4A40mdirect3"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
'''                                                                    Cells(x, y).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Z & x
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = n
'''                                            .OnAction = o
'''                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub


Sub U2190m()
Call UnPro
Range("V25").Formula = "'2190"

'U2190m

                    'for company code U2190m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("U2190mindirect").delete
                    ActiveSheet.CheckBoxes("U2190mdirect").delete
                    'ActiveSheet.CheckBoxes("U2190mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S47").Value = True Then
                    
                    x = 47
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "U2190mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 47
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "U2190mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub U6500m()
Call UnPro
Range("V25").Formula = "'6500"

'U6500m

                    'for company code U6500m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("U6500mindirect").delete
                    ActiveSheet.CheckBoxes("U6500mdirect").delete
                    'ActiveSheet.CheckBoxes("U6500mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S48").Value = True Then
                    
                    x = 48
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "U6500mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 48
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "U6500mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub V4C10m()
Call UnPro
Range("V25").Formula = "4C10"

'V4C10m

                    'for company code V4C10m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("V4C10mindirect").delete
                    ActiveSheet.CheckBoxes("V4C10mdirect").delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
                    
                    If Range("S49").Value = True Then
                    
                    x = 49
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "V4C10mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    x = 49
                    y = "P"
                    Z = "U"
                    o = ""
                    n = "V4C10mdirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With



Else
End If
Range("F20").Select
Call Pro
End Sub

Sub for_newcreation_of_austrandnew_alternative_payee()
Call UnPro
If Range("H423").Value = True Then

Range("A424:A449").EntireRow.Hidden = False
Else
Range("A424:A449").EntireRow.Hidden = True
End If

Call Pro
End Sub

Sub for_newcreation_of_other_countries_alternative_payee()
Call UnPro
If Range("H396").Value = True Then

Range("A524:A546").EntireRow.Hidden = False
Else
Range("A524:A546").EntireRow.Hidden = True
End If

Call Pro
End Sub
Sub for_newcreation_of_other_countries_Ship_from_duns()
Call UnPro
If Range("P396").Value = True Then

Range("A547:A569").EntireRow.Hidden = False
Else
Range("A547:A569").EntireRow.Hidden = True
End If

Call Pro
End Sub
Sub A4F10m()
Call UnPro

                    Range("V25").Formula = "4F10"
                    'for company code V4C10m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("A4F10mindirect").delete
                    ActiveSheet.CheckBoxes("A4F10mindirect").delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
                    If Range("S50").Value = True Then
                    x = 50
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4F10mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    Else
                    End If
Call Pro
End Sub

Sub A4E70m()
Call UnPro
                    Range("V25").Formula = "'4E70"
                    'for company code V4C10m creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("A4E70mindirect").delete
                    ActiveSheet.CheckBoxes("A4E70mindirect").delete
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0
                    If Range("S51").Value = True Then
                    x = 51
                    y = "N"
                    Z = "T"
                    o = ""
                    n = "A4E70mindirect"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
                    Else
                    End If
Call Pro
End Sub

Sub runnothing()

End Sub
Attribute VB_Name = "GME_Validation_only"
Sub GM_E_only_validation()

'this sub is created only for checking validation before save for further update.
Call UnPro
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
Range("d66").Value = False And _
Range("G66").Value = False And _
Range("K66").Value = False And _
Range("N66").Value = False And _
Range("o66").Value = False And _
Range("S66").Value = False Then
     'MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
    ActiveWindow.ScrollRow = 28
    
'highlight
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
'    Call Pro
'     Exit Sub
chk = "fail"
Else

'back to normal
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

End If

'next step will be checking mandatory feild for new dun creation, hence calling NDC check
'**************************************abu added start**************************************************************************************




'New Duns creation ctrl check
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
        Range("P115").Value = "" Or _
        Range("F115").Value = "" Or _
        Range("F117").Value = "" Or _
        Range("F239").Value = "" Or _
        Range("F236").Value = "" Or _
        Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" And Range("D424").EntireRow.Hidden = False Or _
        Range("F253").Value & Range("F255").Value = "" Then
        
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            
        '    If Range("P115").Value = "" Then Range("P115").Interior.Color = 65535 Else Range("P115").Interior.Pattern = xlNone
        '    If Range("F115").Value = "" Then Range("F115").Interior.Color = 65535 Else Range("F115").Interior.Pattern = xlNone
        '    If Range("F117").Value = "" Then Range("F117").Interior.Color = 65535 Else Range("F117").Interior.Pattern = xlNone
        '    If Range("F239").Value = "" Then Range("F239").Interior.Color = 65535 Else Range("F239").Interior.Pattern = xlNone
            
            Range("F115:I115,F117:I117,P115:S115,F239:U239,F236:L236").Select
            Range("F239").Activate
            Call if_selected_cell_blank_conditional_format
            
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                Else
                End If
                'Range("D426").Interior.Pattern = xlNone
               
                If Range("F253").Value & Range("F255").Value = "" Then
                Range("F255:N255,F253:N253").Select
                Range("F253").Activate
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$253,$F$255)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
                    
                Else
                End If
            ActiveWindow.SmallScroll up:=1000000
            'Call Pro
             chk = "fail"
        
        Else
        End If
End If
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Range("F163").Value = "" Then
            'Range("F121").Value = "" Then
            
            Range("F163:U165").Select
            Call if_selected_cell_blank_conditional_format

            
            'call pro
            chk = "fail"
            Else
            
            End If
            
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Sheets("Mass Change").Range("F1").Value > 1 Then
            Else
            
            MsgBox "Could not find any update in Mass Change Sheet"
            Call Pro
            Sheets("Mass change").Select
            Exit Sub
            End If
End If
'-------------------------------------------------------------------------------------------------------------------
'Cells.FormatConditions.Delete
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Or Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
Else
    If Range("F121").EntireRow.Hidden = False Then
            If Range("F121").Value = "" Or Range("F123").Value = "" Then
            
            Range("F121:U121,F123:U123").Select
            Call if_selected_cell_blank_conditional_format
            
'            MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If
'-------------------------------------------------------------------------------------------------------------------

'-------------------------------------------------------------------------------------------------------------------

If Sheets("GM EU Form").Range("q18").Value = "Email ID set up" Then

    If Range("F149").EntireRow.Hidden = False Then
            If Range("F149").Value & Range("F151").Value = "" Then
            Call UnPro
                Range("F149:N149,F151:N151").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$149,$F$151)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
            Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If

'-----------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("D51").EntireRow.Hidden = False Then
Call UnPro
            If Sheets("GM EU Form").Range("D47").Value & Range("D48").Value & Range("D49").Value & Range("D50").Value & Range("D51").Value = "" Then
        
                Range("D47:D51").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($D$47:$D$51)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 65535
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            
            Else
            End If
Else
End If

If Range("D424").EntireRow.Hidden = False Then
Call UnPro
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
                            'call pro
                            chk = "fail"

                Else
                End If

Else
End If


'###starts################################################################################
'this lines are checking mandatory fields for bank details
'2
If Range("P369:Q369,F375:O375,R375:U375").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P369").Value = "" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    Range("P369:Q369").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If
      
End If

'Please select GM Business Unit first
        If Sheets("GM EU Form"). _
                Range("Q18").Value = "Please select GM Business Unit first" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    'Range("P369:Q369").Select
                    'Call if_selected_cell_blank_conditional_format
                MsgBox "Please select a valid Submission Reason", vbCritical
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If


If Range("F375,F377").EntireRow.Hidden = False And Range("F375").Value = "" And Range("F377").Value = "" Then

    Range("F375,F377").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$375="""",$F$377="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R373,R375").EntireRow.Hidden = False And Range("R373").Value = "" And Range("R375").Value = "" Then

    Range("R373,R375").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$373="""",$R$375="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If


'3
If Range("P380:Q380,F386:O386,R386:U386").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P380").Value = "" Then
                'Range("R386").Value = "" Then
                'Range("R386").Value = "" Then
    
                    Range("P380:Q380").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F386,F388").EntireRow.Hidden = False And Range("F386").Value = "" And Range("F388").Value = "" Then

    Range("F386,F388").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$386="""",$F$388="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R384,R386").EntireRow.Hidden = False And Range("R384").Value = "" And Range("R386").Value = "" Then

    Range("R384,R386").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$384="""",$R$386="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'4
If Range("P391:Q391,F397:O397,R397:U397").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P391").Value = "" Then
                'Range("R397").Value = "" Then
                'Range("R397").Value = "" Then
    
                    Range("P391:Q391").Select
                    Call if_selected_cell_blank_conditional_format
                
               ' Call Pro
               ' Exit Sub
               chk = "fail"
        Else
        End If
      
End If

If Range("F397,F399").EntireRow.Hidden = False And Range("F397").Value = "" And Range("F399").Value = "" Then

    Range("F397,F399").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$397="""",$F$399="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If
'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R395,R397").EntireRow.Hidden = False And Range("R395").Value = "" And Range("R397").Value = "" Then

    Range("R395,R397").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$395="""",$R$397="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'5th bank
If Range("P402:Q402,R408:U408").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P402").Value = "" Then
                'Range("R408").Value = "" Then
                'Range("R408").Value = "" Then
    
                    Range("P402:Q402").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F408,F410").EntireRow.Hidden = False And Range("F408").Value = "" And Range("F410").Value = "" Then

    Range("F408,F410").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$408="""",$F$410="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R406,R408").EntireRow.Hidden = False And Range("R406").Value = "" And Range("R408").Value = "" Then

    Range("R406,R408").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$406="""",$R$408="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'6th bank

If Range("P413:Q413,F419:O419,R419:U419").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P413").Value = "" Then
                'Range("R419").Value = "" Then
                'Range("R419").Value = "" Then
    
                    Range("P413:Q413").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F419,F421").EntireRow.Hidden = False And Range("F419").Value = "" And Range("F421").Value = "" Then

    Range("F419,F421").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$419="""",$F$421="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R417,R419").EntireRow.Hidden = False And Range("R417").Value = "" And Range("R419").Value = "" Then

    Range("R417,R419").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$417="""",$R$419="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'1 st bank
If Range("F357:M357,R363:U363,F363:O363").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F357").Value = "" Then
                'Range("R363").Value = "" Then
                'Range("F363").Value = "" Then
    
                    Range("F357:M357").Select
                    On Error Resume Next
                            
                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

                            If Range("F357").Value = "" Then Range("F357").AddComment
                            'If Range("R363").Value = "" Then Range("R363").AddComment
                            'If Range("F363").Value = "" Then Range("F363").AddComment
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Visible = False
                            'If Range("R363").Value = "" Then Range("R363").Comment.Visible = False
                            'If Range("F363").Value = "" Then Range("F363").Comment.Visible = False
                            'Selection.Comment.Visible = False
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("P413").Select
'                            Selection.ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                             Range("P413").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("R363").Value = "" Then Range("R363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("F419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("F419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("F363").Value = "" Then Range("F363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("R419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("R419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                    'On Error GoTo 0
                    
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'bank1 validation on either a/c # or IBAN is madatory added nov 2016
If Range("F363,F365").EntireRow.Hidden = False And Range("F363").Value = "" And Range("F365").Value = "" Then

    Range("F363,F365").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$363="""",$F$365="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank1 validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R361,R363").EntireRow.Hidden = False And Range("R361").Value = "" And Range("R363").Value = "" Then

    Range("R361,R363").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$361="""",$R$363="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'checking duns mandatory field
If Range("F215").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F215").Value = "" Then
    
                    Range("F215").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking 2 nd duns mandatory field
If Range("F38").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F38").Value = "" Then
    
                    Range("F38").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2 nd duns mandatory field
If Range("F236").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F236").Value = "" Then
    
                    Range("F236").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking supplier's name mandatory field
If Range("F218").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F218").Value = "" Then
    
                    Range("F218").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2nd supplier's name mandatory field
If Range("F40").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F40").Value = "" Then
    
                    Range("F40").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If
'ends###################################################################################




'**************************************Abu added end*********************************************************************************

      If Sheets("GM EU Form").Range("F10").Value = "" Then
     'MsgBox "Please Enter Requester Name", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     
     Range("F10").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F14").Value = "" Then
     'MsgBox "Please Update Requester Email ID", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F14").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F18").Value = "" Then
     'MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   If Sheets("GM EU Form").Range("Q18").Value = "" Then
     'MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("Q18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
     
   End If
   

   If Sheets("GM EU Form").Range("F20").Value = "" Then
     'MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F20").Select
     Call if_selected_cell_blank_conditional_format
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(240, 240, 0) 'yellow
     chk = "fail"
     Else
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
     End If
'If chek = check Then MsgBox " not exit sub"
'If chek = check Then Else MsgBox " exit sub"

If chk = "fail" Then

MsgBox "Form is getting saved with incomplete details, please update mandatory fields (highlighted in yellow) and save again for more accuracy" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & " " & vbNewLine & " ", vbCritical, "Required Entry"
Call Pro
Exit Sub
Else

End If

End Sub
Attribute VB_Name = "GME_validation_n_submit"
Sub Aj()
Attribute Aj.VB_ProcData.VB_Invoke_Func = " \n14"
Application.DisplayAlerts = False
'Application.UseSystemSeparators = False
'Application.ThousandsSeparator = ","
'Application.DecimalSeparator = "."

Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object
Dim aw As String
Dim chk
Application.ScreenUpdating = False
Sheets("GM EU Form").Activate
Call UnPro


If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
Range("d66").Value = False And _
Range("G66").Value = False And _
Range("K66").Value = False And _
Range("N66").Value = False And _
Range("o66").Value = False And _
Range("S66").Value = False Then
     'MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
    ActiveWindow.ScrollRow = 28
    
'highlight
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
'    Call Pro
'     Exit Sub
chk = "fail"
Else

'back to normal
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

End If

'next step will be checking mandatory feild for new dun creation, hence calling NDC check
'**************************************abu added start**************************************************************************************




'New Duns creation ctrl check
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And _
        Range("P115").Value = "" Or _
        Range("F115").Value = "" Or _
        Range("F117").Value = "" Or _
        Range("F239").Value = "" Or _
        Range("F236").Value = "" Or _
        Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" And Range("D424").EntireRow.Hidden = False Or _
        Range("F253").Value & Range("F255").Value = "" Then
        
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            
        '    If Range("P115").Value = "" Then Range("P115").Interior.Color = 65535 Else Range("P115").Interior.Pattern = xlNone
        '    If Range("F115").Value = "" Then Range("F115").Interior.Color = 65535 Else Range("F115").Interior.Pattern = xlNone
        '    If Range("F117").Value = "" Then Range("F117").Interior.Color = 65535 Else Range("F117").Interior.Pattern = xlNone
        '    If Range("F239").Value = "" Then Range("F239").Interior.Color = 65535 Else Range("F239").Interior.Pattern = xlNone
            
            Range("F115:I115,F117:I117,P115:S115,F239:U239,F236:L236").Select
            Range("F239").Activate
            Call if_selected_cell_blank_conditional_format
            
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                Else
                End If
                'Range("D426").Interior.Pattern = xlNone
               
                If Range("F253").Value & Range("F255").Value = "" Then
                Range("F255:N255,F253:N253").Select
                Range("F253").Activate
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$253,$F$255)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
                    
                Else
                End If
            ActiveWindow.SmallScroll up:=1000000
            'Call Pro
             chk = "fail"
        
        Else
        End If
End If
'-------------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Then Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Range("F163").Value = "" Then
            'Range("F121").Value = "" Then
            
            Range("F163:U165").Select
            Call if_selected_cell_blank_conditional_format

            
            'call pro
            chk = "fail"
            Else
            
            End If
            
            
            If Sheets("GM EU Form").Range("q18").Value = "Mass changes" And _
            Sheets("Mass Change").Range("F1").Value > 1 Then
            Else
            
            MsgBox "Could not find any update in Mass Change Sheet"
            Call Pro
            Sheets("Mass change").Select
            Exit Sub
            End If
End If
'-------------------------------------------------------------------------------------------------------------------
'Cells.FormatConditions.Delete
If Sheets("GM EU Form").Range("q18").Value = "Mass changes" Or Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
Else
    If Range("F121").EntireRow.Hidden = False Then
            If Range("F121").Value = "" Or Range("F123").Value = "" Then
            
            Range("F121:U121,F123:U123").Select
            Call if_selected_cell_blank_conditional_format
            
'            MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If
'-------------------------------------------------------------------------------------------------------------------

'-------------------------------------------------------------------------------------------------------------------

If Sheets("GM EU Form").Range("q18").Value = "Email ID set up" Then

    If Range("F149").EntireRow.Hidden = False Then
            If Range("F149").Value & Range("F151").Value = "" Then
            Call UnPro
                Range("F149:N149,F151:N151").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($F$149,$F$151)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 6750207
                    .TintAndShade = 0
                End With
            Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            End If
    Else
    End If
End If

'-----------------------------------------------------------------------------------------------------------------
If Sheets("GM EU Form").Range("D51").EntireRow.Hidden = False Then
Call UnPro
            If Sheets("GM EU Form").Range("D47").Value & Range("D48").Value & Range("D49").Value & Range("D50").Value & Range("D51").Value = "" Then
        
                Range("D47:D51").Select
                Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                    "=COUNTA($D$47:$D$51)=0"
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 65535
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
            
            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
            'call pro
            chk = "fail"
            
            Else
            End If
Else
End If

If Range("D424").EntireRow.Hidden = False Then
Call UnPro
                If Range("D424").Value & Range("D425").Value & Range("D426").Value & Range("D427").Value & Range("D428").Value = "" Then
                        Range("D424:D428").Select
                        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
                            "=COUNTA($D$424:$D$428)=0"
                        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                        With Selection.FormatConditions(1).Interior
'
'                                .Pattern = xlSolid
'                                .PatternColorIndex = xlAutomatic
'                                .Color = 6750207
'                                .TintAndShade = 0
'                                .PatternTintAndShade = 0
'
                        
                            .PatternColorIndex = xlAutomatic
                            .Color = 6750207
                            .TintAndShade = 0
                        End With
                Selection.FormatConditions(1).StopIfTrue = False
                            'MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
                            'call pro
                            chk = "fail"

                Else
                End If

Else
End If


'###starts################################################################################
'this lines are checking mandatory fields for bank details
'2
If Range("P369:Q369,F375:O375,R375:U375").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P369").Value = "" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    Range("P369:Q369").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If
      
End If

'Please select GM Business Unit first
        If Sheets("GM EU Form"). _
                Range("Q18").Value = "Please select GM Business Unit first" Then
                'Range("R375").Value = "" Then
                'Range("R375").Value = "" Then
    
                    'Range("P369:Q369").Select
                    'Call if_selected_cell_blank_conditional_format
                MsgBox "Please select a valid Submission Reason", vbCritical
                chk = "fail"
'                Call Pro
'                chk = "fail"
        Else
        End If


If Range("F375,F377").EntireRow.Hidden = False And Range("F375").Value = "" And Range("F377").Value = "" Then

    Range("F375,F377").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$375="""",$F$377="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R373,R375").EntireRow.Hidden = False And Range("R373").Value = "" And Range("R375").Value = "" Then

    Range("R373,R375").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$373="""",$R$375="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If


'3
If Range("P380:Q380,F386:O386,R386:U386").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P380").Value = "" Then
                'Range("R386").Value = "" Then
                'Range("R386").Value = "" Then
    
                    Range("P380:Q380").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F386,F388").EntireRow.Hidden = False And Range("F386").Value = "" And Range("F388").Value = "" Then

    Range("F386,F388").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$386="""",$F$388="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R384,R386").EntireRow.Hidden = False And Range("R384").Value = "" And Range("R386").Value = "" Then

    Range("R384,R386").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$384="""",$R$386="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'4
If Range("P391:Q391,F397:O397,R397:U397").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P391").Value = "" Then
                'Range("R397").Value = "" Then
                'Range("R397").Value = "" Then
    
                    Range("P391:Q391").Select
                    Call if_selected_cell_blank_conditional_format
                
               ' Call Pro
               ' Exit Sub
               chk = "fail"
        Else
        End If
      
End If

If Range("F397,F399").EntireRow.Hidden = False And Range("F397").Value = "" And Range("F399").Value = "" Then

    Range("F397,F399").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$397="""",$F$399="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If
'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R395,R397").EntireRow.Hidden = False And Range("R395").Value = "" And Range("R397").Value = "" Then

    Range("R395,R397").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$395="""",$R$397="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'5th bank
If Range("P402:Q402,R408:U408").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P402").Value = "" Then
                'Range("R408").Value = "" Then
                'Range("R408").Value = "" Then
    
                    Range("P402:Q402").Select
                    Call if_selected_cell_blank_conditional_format
                chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F408,F410").EntireRow.Hidden = False And Range("F408").Value = "" And Range("F410").Value = "" Then

    Range("F408,F410").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$408="""",$F$410="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016

If Range("R406,R408").EntireRow.Hidden = False And Range("R406").Value = "" And Range("R408").Value = "" Then

    Range("R406,R408").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$406="""",$R$408="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'6th bank

If Range("P413:Q413,F419:O419,R419:U419").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("P413").Value = "" Then
                'Range("R419").Value = "" Then
                'Range("R419").Value = "" Then
    
                    Range("P413:Q413").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

If Range("F419,F421").EntireRow.Hidden = False And Range("F419").Value = "" And Range("F421").Value = "" Then

    Range("F419,F421").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$419="""",$F$421="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R417,R419").EntireRow.Hidden = False And Range("R417").Value = "" And Range("R419").Value = "" Then

    Range("R417,R419").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$417="""",$R$419="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'1 st bank
If Range("F357:M357,R363:U363,F363:O363").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F357").Value = "" Then
                'Range("R363").Value = "" Then
                'Range("F363").Value = "" Then
    
                    Range("F357:M357").Select
                    On Error Resume Next
                            
                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

                            If Range("F357").Value = "" Then Range("F357").AddComment
                            'If Range("R363").Value = "" Then Range("R363").AddComment
                            'If Range("F363").Value = "" Then Range("F363").AddComment
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Visible = False
                            'If Range("R363").Value = "" Then Range("R363").Comment.Visible = False
                            'If Range("F363").Value = "" Then Range("F363").Comment.Visible = False
                            'Selection.Comment.Visible = False
                            
                            If Range("F357").Value = "" Then Range("F357").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("P413").Select
'                            Selection.ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                             Range("P413").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("R363").Value = "" Then Range("R363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("F419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("F419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                            'If Range("F363").Value = "" Then Range("F363").Comment.Text Text:= _
                                "Master Data COE:" & Chr(10) & "" & Chr(10) & "Please Update NA if this Field is not required to be updated in SAP" & Chr(10) & "" & Chr(10) & ""
'                            Range("R419").ShapeRange.ScaleWidth 1.02, msoFalse, msoScaleFromTopLeft
'                            Range("R419").ShapeRange.ScaleHeight 1.48, msoFalse, msoScaleFromTopLeft

                    'On Error GoTo 0
                    
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'bank1 validation on either a/c # or IBAN is madatory added nov 2016
If Range("F363,F365").EntireRow.Hidden = False And Range("F363").Value = "" And Range("F365").Value = "" Then

    Range("F363,F365").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$363="""",$F$365="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'bank1 validation on either ABA code or SWIFT code is madatory added nov 2016
If Range("R361,R363").EntireRow.Hidden = False And Range("R361").Value = "" And Range("R363").Value = "" Then

    Range("R361,R363").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($R$361="""",$R$363="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'checking duns mandatory field
If Range("F215").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F215").Value = "" Then
    
                    Range("F215").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking 2 nd duns mandatory field
If Range("F38").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F38").Value = "" Then
    
                    Range("F38").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2 nd duns mandatory field
If Range("F236").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F236").Value = "" Then
    
                    Range("F236").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If


'checking supplier's name mandatory field
If Range("F218").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F218").Value = "" Then
    
                    Range("F218").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If

'checking 2nd supplier's name mandatory field
If Range("F40").EntireRow.Hidden = True Then
Else

        If Sheets("GM EU Form"). _
                Range("F40").Value = "" Then
    
                    Range("F40").Select
                    Call if_selected_cell_blank_conditional_format
               chk = "fail"
               ' Call Pro
               ' Exit Sub
        Else
        End If
      
End If
'ends###################################################################################




'**************************************Abu added end*********************************************************************************

      If Sheets("GM EU Form").Range("F10").Value = "" Then
     'MsgBox "Please Enter Requester Name", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     
     Range("F10").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F14").Value = "" Then
     'MsgBox "Please Update Requester Email ID", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F14").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   
   If Sheets("GM EU Form").Range("F18").Value = "" Then
     'MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
   End If
   If Sheets("GM EU Form").Range("Q18").Value = "" Then
     'MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("Q18").Select
     Call if_selected_cell_blank_conditional_format
     chk = "fail"
     
   End If
   

   If Sheets("GM EU Form").Range("F20").Value = "" Then
     'MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Range("F20").Select
     Call if_selected_cell_blank_conditional_format
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(240, 240, 0) 'yellow
     chk = "fail"
     Else
     Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
     End If
'If chek = check Then MsgBox " not exit sub"
'If chek = check Then Else MsgBox " exit sub"

If chk = "fail" Then

MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
Call Pro
Exit Sub
Else

End If



  If Sheets("GM EU Form").Range("Q18").Value = "Email ID set up" And Sheets("GM EU Form").Range("F121").Value = "" Then
     MsgBox "Duns or Vendor cannot be left blank!", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Exit Sub
     End If
     
  If Sheets("GM EU Form").Range("M18").Value = "Email ID set up" And Sheets("GM EU Form").Range("E34").Value = "" Then
     MsgBox "Supplier name cannot be left blank", vbExclamation, "Required Entry"
     ActiveWindow.ScrollRow = 1
     Exit Sub
     End If
      If Sheets("GM EU Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'GM Europe Multiple BU &PO'", vbExclamation, "Required Entry"
     MsgBox "you have selected " & Sheets("GM Europe Multiple BU &PO").Range("f1").Value & " GM BU"
     Exit Sub
     End If
    ' MsgBox Sheets("GM Europe Multiple BU &PO").Range("f1").Value & "BU Found"
     If Sheets("GM EU Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value <> 0 Then
     Sheets("GM Europe Multiple BU &PO").Visible = True
     Sheets("GM Europe Multiple BU &PO").Select
     er = Range("e2").End(xlDown).Row
     Range("a2:F5000").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$F$5100").AutoFilter Field:=4, Criteria1:="TRUE"
    End If
    'MsgBox "Validation has been completed succesfully ", vbInformation
    If MsgBox("Validation has been completed succesfully" & vbNewLine & "All required fields are updated properly and preparing for submit..!", vbOKCancel + vbDefaultButton2, "Please confirm submition") = vbCancel Then
    'Do you want to submit this form now
Exit Sub
End If
     ActiveWorkbook.Save
     Application.ScreenUpdating = False

If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" Then
If MsgBox("Are you a Supplier?", vbYesNo, Validation) = vbYes Then
MsgBox "Please send back this updated form to GM rather than sending it to Master Data, Since Master Data does not accept New Creation request directly from Supplier"
Call Pro
Exit Sub
Else
End If
End If


     'unhiding all sheets
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
     'Sheets("GM EU Form").Move Before:=Sheets(1)
   'Sheets("GM Europe Multiple BU &PO").Move Before:=Sheets(2)
        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub


subm = ThisWorkbook.Sheets("GM EU Form").Range("Q18").Value

If ThisWorkbook.Sheets("GM EU Form").Range("f26").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f26").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f38").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f38").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f121").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f121").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f215").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f215").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value = "Conduent will Initiate DUNS Assignment process" Then
DUN = "No DUNS"
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f236").Value
End If

If ThisWorkbook.Sheets("GM EU Form").Range("f28").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f28").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f40").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f40").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f123").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f123").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f218").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f218").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f239").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f239").Value
End If
subj = subm & "-" & DUN & "-" & SUP


            WkbName = subj 'Range("q18").Value & " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array("<", ">", "|", "/", "*", "[", "]", "{", "}", "-", "\", "?", """")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName = Replace(WkbName, MyArray(x), "_", 1)
            Next x
            'MsgBox WkbName
        
            WkbName_first = mypath 'Range("I9").Value '& " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array(".xls", "xlsx")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName_first = Replace(WkbName_first, MyArray(x), "_", 1)
            Next x



'aw = Application.ActiveWorkbook.Path & "\"
   'tb = InputBox("give the file name", , any_Name)
 '  ta = tb & ".xls" '".pdf"
  ' tt = aw & ta
  pbn = ActiveWorkbook.Name
  
   Sheets(Array("GM Europe Multiple BU &PO", "Mass change")).Select
  ActiveWindow.SelectedSheets.Copy
  cbn = ActiveWorkbook.Name
  
  ActiveWorkbook.Sheets.Add Before:=Worksheets(1) ', Count:=3
  
  'sheets("Sheet
  'ActiveWorkbook.Worksheets.Add
  ActiveSheet.Name = "Form"
  
  On Error GoTo 0
  Windows(pbn).Activate
  Sheets("GM EU Form").Select
  Call UnPro
  'Range("A1:V3327").Select
'Selection.Copy
'Selection.SpecialCells(xlCellTypeVisible).Copy
'Range("A1:V3327")

''''''''''''''''''''''''''''''''''''

Range("W1:W3326").ClearContents
    Range("W1:W3326").SpecialCells(xlCellTypeVisible).FormulaR1C1 = "UN"
    Cells.Copy
    
Windows(cbn).Activate
Sheets("Form").Select
Range("A1").Select

'    Windows.Add
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveSheet.Paste

       ' Range("A1:W1").Insert Shift:=xlDown
''''    Range("A1:W1").FormulaR1C1 = " "
       ' Range("A1").Select
       ' Selection.AutoFilter
    
        Range("$A$1:$W$3379").Select
        Selection.AutoFilter
        ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, Criteria1:="<>"
    
     '   Selection.AutoFilter , VisibleDropDown:=False
       ' ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, VisibleDropDown:=False, Criteria1:="<>"
        ActiveWindow.ScrollRow = 1
        
        Selection.AutoFilter Field:=1, VisibleDropDown:=False
        Selection.AutoFilter Field:=22, VisibleDropDown:=False
     '   Selection.AutoFilter Field:=23, VisibleDropDown:=False
    '
      '  Range("W1").Select
''''    Do
''''    If ActiveCell.Value = "UN" Then ActiveCell.EntireRow.Hidden = False Else ActiveCell.EntireRow.Hidden = True
''''    ActiveCell.Offset(1, 0).Select
''''    If ActiveCell.Row >= 3379 Then Exit Do
''''
''''    Loop

    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Application.DisplayFormulaBar = False
    Range("A1").Select
    
    On Error Resume Next
    If Range("B1").Value = "" Then Range("A1").EntireRow.Hidden = True
    On Error GoTo 0
''''''''''''''''''''''''''''''''''''

'ActiveSheet.Paste
Range("A1").Select
Cells.FormatConditions.delete

           On Error Resume Next

'deleting irrelevent sheets from product
    If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then Else Sheets("GM Europe Multiple BU &PO").delete
    If Sheets("Form").Range("Q18").Value = "Mass changes" Then Else Sheets("Mass change").delete
        ' '========================
            On Error GoTo 0
            



        ActiveWorkbook.SaveAs (WkbName_first & " " & WkbName & ".xls"), FileFormat:=51

'deleting unselected rows from GM multiple BU
If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then '!!!
        Sheets("GM Europe Multiple BU &PO").Select
        Call UnPro
        If ActiveSheet.Name = "GM Europe Multiple BU &PO" Then '!!
        
                Range("D3").Select
                Do
                On Error GoTo ivd
                If ActiveCell.Value = "" Then Exit Do
                If ActiveCell.Value = "False" Then
                ActiveCell.EntireRow.delete
                Else
                ActiveCell.Offset(1, 0).Select
                End If
                Loop
ivd:
On Error GoTo 0
        Range("A1").EntireRow.delete
        Range("A1").Select
        On Error Resume Next
        ActiveSheet.DrawingObjects("CheckEU1").Visible = False
        
        
                Range(Range("B1048570").End(xlUp).Offset(1, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                Selection.EntireRow.Hidden = False
                Range(Range("B1048570").End(xlUp).Offset(2, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                On Error Resume Next
'                Selection.EntireRow.Hidden = True
                'On Error GoTo 0
                Dim s As Shape
                On Error Resume Next
                For Each s In ActiveSheet.Shapes
                
                s.OnAction = ""
                Next
                On Error GoTo 0
'''        ActiveSheet.Shapes.Visible = False
''        ActiveSheet.Shapes.SelectAll
''        Selection.ShapeRange.Visible = False
        On Error GoTo 0
        Call Pro
        Else '!!
        End If '!!
Else '!!!
End If '!!!
        'also you can give like left 10000 nos to eliminate xls from my path
        Sheets(1).Select
        

        
        'write here to alter form copy
   '         On Error Resume Next
'            ActiveSheet.DrawingObjects.Visible = False
           ' ActiveSheet.DrawingObjects.Delete
 '           ActiveSheet.DrawingObjects.Hide
  '          On Error GoTo 0
''    Call UnPro
''    Range("A1").Select
''    On Error Resume Next
       ActiveWindow.SmallScroll up:=1000000
''          ActiveSheet.Shapes.Range(Array("Group 5", "CommandButton1", "CommandButton2", "CommandButton3", "CommandButton4", "submit")).Delete
''Range("a1:V3336").Locked = True
'''Range("Q3331").ClearContents
'Application.ScreenUpdating = False
  On Error GoTo 0

On Error Resume Next

ActiveSheet.Shapes.SelectAll
'ActiveSheet.Shapes.OnAction = "nidhi"
Selection.OnAction = ""


'xxx
'On Error Resume Next
'For Each s In ActiveSheet.Shapes
's.OnAction = ""
'Next

On Error Resume Next

        If ActiveSheet.Name = "Form" Then Range("F20:L20").Locked = True
        If ActiveSheet.Name = "Form" Then Range("F10:L10").Locked = True
        Range("F21:N21").ClearContents
        
    On Error GoTo 0
    

    
    
    Call Pro
       '     ActiveSheet.DrawingObjects.Visible = False
            
            
        ActiveWorkbook.UpdateLinks = xlUpdateLinksNever
        
        'added for one mail project
        ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
        ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"
        Sheets("Form").Select
        ActiveSheet.Name = "Form_GBS"
        
        ActiveWorkbook.Save
        
        ffname = ActiveWorkbook.FullName
        fname = ActiveWorkbook.Name
        
        ActiveWorkbook.Close
        'MsgBox " Request Copy Has Been Saved as " & fname
        ' '============================
        tt1 = ffname
        
  '  .ExportAsFixedFormat Type:=xlTypexls, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  'End With
   
  
  
  
'''abu added=======================================================================================
''                 'Sheets("ORD").Select (False)
''                  'Sheets("Standardchanges").Select (False)
''                  ActiveWindow.SelectedSheets.Copy
''
''                  Application.StatusBar = False
''
''                    Dim appXL As New Excel.Application
''    Dim MyDate
''    MyDate = Date    ' MyDate contains the current system date.
''    Dim MyTime
''    MyTime = Time    ' Return current system time.
''    Dim TestStr As String
''    TestStr = Format(MyTime, "hh.mm.ss")
''    Dim Test1Str As String
''    Test1Str = Format(MyDate, "DD-MM-YYYY")
''
''    Application.DisplayAlerts = False
''    'MsgBox ActiveWorkbook.Name
''
''    ActiveWorkbook.SaveAs Filename:="C:\STD Changes\Bank\" & ree & " " & Test1Str & " " & TestStr & " " & ".xlsx" 'ActiveWorkbook.name
''    'ActiveWorkbook.SaveAs Filename:="C:\Std Changes\RAW DATA\" & "Test"
''    ActiveWorkbook.Save
''    bn = ActiveWorkbook.FullName
'''abu added=====================================================================================
  ' Call page

'Next i
'Else
Windows(pbn).Activate

Sheets("GM EU Form").Select
Range("A1").Select
Call UnPro

If UserForm3.OptionButton1.Value = True Then

Set rng = Nothing

Set rng = Sheets("GM EU Form").Range("B9:v24").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

subm = ThisWorkbook.Sheets("GM EU Form").Range("Q18").Value

If ThisWorkbook.Sheets("GM EU Form").Range("f26").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f26").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f38").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f38").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f121").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f121").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f215").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f215").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value = "Conduent will Initiate DUNS Assignment process" Then
DUN = "No DUNS"
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f236").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM EU Form").Range("f236").Value
End If

If ThisWorkbook.Sheets("GM EU Form").Range("f28").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f28").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f40").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f40").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f123").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f123").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f218").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f218").Value
ElseIf ThisWorkbook.Sheets("GM EU Form").Range("f239").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM EU Form").Range("f239").Value
End If
subj = subm & "-" & DUN & "-" & SUP
With OutMail
    .To = Range("E6").Value & ";" & Range("F14").Value
    .cc = Range("Q14").Value
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
'    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
'  If Sheets("GM EU Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value <> 0 Then
'  Sheets("GM Europe Multiple BU &PO").Select
'  Range("A1").Select
'  Selection.AutoFilter
 ' End If
 
 Else
'        If ActiveSheet.OptionButton2.Value = True Then MsgBox "Form has been saved in the below Directory " _
'        & vbNewLine & vbNewLine & vbNewLine & ffname
    'If UserForm3.OptionButton2.Value = True Then
    MsgBox "Form has been saved in the below Directory " & vbNewLine & vbNewLine & vbNewLine & ffname
    MsgBox "Finished..!", vbInformation
    Exit Sub
  
 End If
       For I = 3 To Sheets.Count
     Sheets(I).Visible = 2
     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM EU Form").Select
     Call Pro
     Application.ScreenUpdating = True
     MsgBox "Finished..!", vbInformation
     Application.DisplayAlerts = True

Application.UseSystemSeparators = True
     
End Sub


Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM EU Form").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function

Sub justsave()
If MsgBox("Do you really want to save the form for further step? " & Chr(13) & "Please submit the form only after the complete updates.", vbYesNo, "Save") = vbNo Then
Call Pro
Exit Sub
End If
Application.ScreenUpdating = False

''''Range("W1").Select
''''Call UnPro
''''    ActiveCell.FormulaR1C1 = "save"
''''Call Pro
'ActiveWorkbook.Save
 
 If ActiveSheet.Name = "GM EU Form" Then

sela = Range("F10").Value
b = Range("F12").Value
c = Range("Q10").Value
d = Range("Q12").Value
E = Range("F14").Value
f = Range("F18").Value
g = Range("F20").Value
h = Range("Q18").Value

    If sela = 0 And b = 0 And c = 0 And d = 0 And E = 0 And f = "Please update the requester name" And g = 0 And h = 0 Then
     Cancel = False
      Exit Sub
      End If
    If Sheets("GM EU Form").Range("q18").Value = "New Duns creation" And Range("d66").Value = False And Range("G66").Value = False And Range("K66").Value = False And Range("N66").Value = False And Range("o66").Value = False And Range("S66").Value = False Then
         MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
      Cancel = True
         Exit Sub
    End If

    If Sheets("GM EU Form").Range("F10").Value = "" Then
     MsgBox "Please enter Requester name", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   
   If Sheets("GM EU Form").Range("F14").Value = "" Then
     MsgBox "Please enter Requester email ID", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   
   If Sheets("GM EU Form").Range("F18").Value = "" Then
     MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   If Sheets("GM EU Form").Range("Q18").Value = "" Then
     MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
   End If
   If Sheets("GM EU Form").Range("F20").Value = "" Then
     MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
     End If
     
  If Sheets("GM EU Form").Range("Q18").Value = "Email ID set up" And Sheets("GM EU Form").Range("F121").Value = "" Then
     MsgBox "Duns or Vendor Details Cannot Be Blank.!", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
     End If
     
  If Sheets("GM EU Form").Range("M18").Value = "Email ID set up" And Sheets("GM EU Form").Range("E34").Value = "" Then
     MsgBox "Please Enter Supplier name in Cell E34", vbExclamation, "Required Entry"
     Cancel = True 'cancels the save event
     Exit Sub
     End If
 If Sheets("GM EU Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'Multiple BU Tab'", vbExclamation, "Required Entry"
     Cancel = True
     Exit Sub
     End If
End If
 
         mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xlsm), *.xlsm", Title:="This Location Is Asked For Getting Form Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r), FileFormat:=ThisWorkbook.FileFormat
    If ActiveSheet.Name = "GM_IO_Form" Or ActiveSheet.Name = "GM EU Form" Or ActiveSheet.Name = "GM_NA" Then
    mm = ActiveSheet.Name
    Else
    mm = "The FORM"
    End If

        MsgBox mm & " has been saved in the below directory: " & vbNewLine & vbNewLine & vbNewLine & "Location: " & ActiveWorkbook.FullName, vbInformation

''''Range("W1").Select
''''Call UnPro
''''    ActiveCell.FormulaR1C1 = ""
''''    Call Pro
''''    ''Application.ScreenUpdating = False

End Sub

Attribute VB_Name = "GMIO_validation_n_Submit"
Sub Kudhal()
'GMIO_GM_BU_validation
Application.ScreenUpdating = False
Application.UseSystemSeparators = False
Application.ThousandsSeparator = ","
Application.DecimalSeparator = "."

Call UnPro
Sheets("GM_IO_Form").Select
Cells.FormatConditions.delete
Dim count1 As Integer
Dim count2 As Integer
Dim count3 As Integer
Dim count4 As Integer
Dim count5 As Integer

'validation_GMIO()
'requester name, email, submission reason, country validation
        If Sheets("GM_IO_Form"). _
                Range("F10").Value = "" Or _
                Range("F14").Value = "" Or _
                Range("Q18").Value = "" Or _
                Range("F20").Value = "" Then
    
                    Range("F10:F10,F14:F14,Q18:Q18,F20:F20").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
        Else
        End If
        

'validation_vendor_name_and_Vendor_code()
If Range("$F$57:$L$57").EntireRow.Hidden = True Then
Else
        If Sheets("GM_IO_Form"). _
                Range("F57").Value = "" Or _
                Range("F59").Value = "" Then
    
                    Range("$F$57:$L$57,$F$59:$U$59").Select
                    Call if_selected_cell_blank_conditional_format
                
                chk = "fail"
        Else
        End If
End If

count1 = Application.WorksheetFunction.CountIf(Range("S26:S49"), True)
If count1 < 1 Then

chk = "fail"
Else
End If

'#####MANDATORY checkup

    'this is line added because PO is not mandatory for rest of the reason from below mentioned.
    If Range("Q18").Value = "New Duns/Vendor Code creation" Or Range("Q18").Value = "Extend to New Business Unit/Company Code" Or Range("Q18").Value = "Extend to New Purchasing Org" Then
    mandatory = True
    Else
    mandatory = False
    End If


'GM Europe Business Units
'thailand
If Sheets("GM_IO_Form").Range("E26").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S26:S28"), True)
            
            
            count2 = Application.WorksheetFunction.CountIf(Range("T26:U26"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T27:U27"), True)
            count4 = Application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            
            
            If count1 < 1 Then
                    
            chk = "fail"
                        
                        
            Else
                If Range("S26").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
            End If
            
            If Range("S27").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
            Else
            End If


            If Range("S28").Value = True Then
                    If count4 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
            Else
            End If



End If

'New Zealand
If Sheets("GM_IO_Form").Range("E29:F30").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S29:S30"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T29:U30"), True)
            'count3 = application.WorksheetFunction.CountIf(Range("T27:U27"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S29").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
            End If

End If

'Australia
If Sheets("GM_IO_Form").Range("E31:F33").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S31:S33"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T31:U33"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("S51"), True)
            count4 = Application.WorksheetFunction.CountIf(Range("T51:U51"), True)
            
                        
            If count1 + count3 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S31").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                
                
                'GM Holden Aus NSC Ltd-4E70
                If Range("S51").Value = True Then
                            If count4 < 1 Then
                            
                            
                            If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                            chk = "fail"
                            End If
                            
                            Else
                            End If
                Else
                End If
                        
                
            End If
End If


'Philippines
If Sheets("GM_IO_Form").Range("E34:F35").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S34:S35"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T34:U34"), True)
            'count3 = application.WorksheetFunction.CountIf(Range("T27:U27"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S34").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
            End If

End If


'Singapore

If Sheets("GM_IO_Form").Range("E36:F38").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S36:S38"), True) + Application.WorksheetFunction.CountIf(Range("S50"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T36:U36"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T37:U38"), True)
            
            'T50:U50
            count4 = Application.WorksheetFunction.CountIf(Range("T50:U50"), True)
            
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S36").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                
                If Range("S37").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If

                If Range("S50").Value = True Then
                    If count4 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If

            End If

End If

'indonesia

If Sheets("GM_IO_Form").Range("E39:F40").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S39:S40"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T39:U39"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T40:U40"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            'count5 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S39").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                If Range("S40").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If


            End If

End If

'india

If Sheets("GM_IO_Form").Range("E41:F46").EntireRow.Hidden = True Then
Else
    
            count1 = Application.WorksheetFunction.CountIf(Range("S41:S46"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T41:U41"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T42:U42"), True)
            count4 = Application.WorksheetFunction.CountIf(Range("T43:U43"), True)
            count5 = Application.WorksheetFunction.CountIf(Range("T44:U46"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S41").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                If Range("S42").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If


            End If
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S43").Value = True Then
                    If count4 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If
                If Range("S44").Value = True Then
                    If count5 < 1 Then
                    'S26
                    
                    If mandatory = True And Range("G63").Value <> True And Range("G63").EntireRow.Hidden = False Then
                    chk = "fail"
                    End If
                    
                    Else
                    End If
                Else
                End If


            End If

End If

'india second validation
'PAN number is mandatory
If Range("O120").EntireRow.Hidden = False And Trim(UCase(Range("O120").Value)) = "INDIA" And Range("F124").Value = "" Then

        Range("F124").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($O$120))=""INDIA"",trim($F$124)="""")"
    Range("F124").FormatConditions(Range("F124").FormatConditions.Count).SetFirstPriority
    With Range("F124").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207 '10092543
        .TintAndShade = 0
    End With
    Range("F124").FormatConditions(1).StopIfTrue = False

chk = "fail"
Else
End If

'india bankfield mandatory

    If Range("F20").Value = "India" Then
    
'primary bank
        If Range("$R$603").EntireRow.Hidden = False And Range("$O$603").Value = "IFSC" And Range("B605").Value = "" Then
        chk = "fail"
        
            Range("R603:U603,R605:U605").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$605="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If
        
'1st additional bank
        If Range("$B$620").EntireRow.Hidden = False And Range("$O$618").Value = "IFSC" And Range("$B$620").Value = "" Then
        chk = "fail"
        
            Range("R618:U618,R620:U620").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$620="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'2nd additional bank
        If Range("$B$634").EntireRow.Hidden = False And Range("O632").Value = "IFSC" And Range("$B$634").Value = "" Then
        chk = "fail"
        
            Range("R634:U634,R632:U632").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$634="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'3rd additional bank
        If Range("$B$647").EntireRow.Hidden = False And Range("O645").Value = "IFSC" And Range("$B$647").Value = "" Then
        chk = "fail"
        
            Range("R645:U645,R647:U647").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$647="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'4th additional bank
        If Range("$B$660").EntireRow.Hidden = False And Range("O658").Value = "IFSC" And Range("$B$660").Value = "" Then
        chk = "fail"
        
            Range("R658:U658,R660:U660").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$660="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If

'5th additional bank
        If Range("$B$673").EntireRow.Hidden = False And Range("O671").Value = "IFSC" And Range("$B$673").Value = "" Then
        chk = "fail"
        
            Range("R671:U671,R673:U673").Select
            Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$673="""""
            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
            With Selection.FormatConditions(1).Interior
                .PatternColorIndex = xlAutomatic
                .Color = 65535
                .TintAndShade = 0
            End With
            Selection.FormatConditions(1).StopIfTrue = False
        
        Else
        End If


    Else
    End If



'for extent new business, extension details are mandatory.

If Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
        
        'indian field
        If Range("F198").EntireRow.Hidden = False Then
        If Range("F198").Value = "" Or Range("F200").Value = "" Or Range("F202").Value = "" Or Range("P200").Value = "" Or Range("P202").Value = "" Then
        chk = "fail"
        Range("F198:I198,F200:I200,F202:I202,P200:S200,P202:S202").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If
End If


'FOR NEW CREATION address fields like state,country,postal,street are mandatory

If Range("Q18").Value = "New Duns/Vendor Code creation" Then
        
        'indian field
        If Range("F116").EntireRow.Hidden = False Then
        If Range("F116").Value = "" Or Range("F118").Value = "" Or Range("O118").Value = "" Or Range("F120").Value = "" Or Range("O120").Value = "" Then
        chk = "fail"
        Range("F116:U116,F118:J118,F120:J120,O118:U118,O120:U120").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If
    
        'australian,new zealand field
        If Range("F406").EntireRow.Hidden = False Then
        If Range("F406").Value = "" _
        Or Range("F408").Value = "" _
        Or Range("M408").Value = "" _
        Or Range("F410").Value = "" _
        Or Range("M410").Value = "" Then
        
        chk = "fail"
        Range("F406:U406,F408:J408,M408:U408,M410:U410,F410:J410").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If

        'Indonesia/philipino/singapore/thai/viatnam
        If Range("F379").EntireRow.Hidden = False Then
        If Range("F379").Value = "" _
        Or Range("F381").Value = "" _
        Or Range("M381").Value = "" _
        Or Range("F383").Value = "" _
        Or Range("M383").Value = "" Then
        
        chk = "fail"
        Range("F379:U379,F381:J381,M381:U381,F383:J383,M383:U383").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If

        'UAE
        If Range("F458").EntireRow.Hidden = False Then
        If Range("F458").Value = "" _
        Or Range("F460").Value = "" _
        Or Range("M460").Value = "" _
        Or Range("F462").Value = "" _
        Or Range("M462").Value = "" Then
        
        chk = "fail"
        Range("F458:U458,F460:J460,M460:U460,F462:J462,M462:U462").Select
        Call if_selected_cell_blank_conditional_format
        Else
        End If
        Else
        End If

Else
End If

'country australia ABN code mandatory

countryucase = Trim(UCase(Range("M410").Value))
If Range("M410").EntireRow.Hidden = False And countryucase = "AUSTRALIA" And Range("M412").Value = "" Then

    Range("M412").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($M$410))=""AUSTRALIA"",trim($M$412)="""")"
    Range("M412").FormatConditions(Range("M412").FormatConditions.Count).SetFirstPriority
    With Range("M412").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Range("M412").FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

'Utd.Arab Emir.
If Sheets("GM_IO_Form").Range("E47:F48").EntireRow.Hidden = True Then
Else
            count1 = Application.WorksheetFunction.CountIf(Range("S47:S48"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T47:U47"), True)
            count3 = Application.WorksheetFunction.CountIf(Range("T48:U48"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            'count5 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S39").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    chk = "fail"
                    
                    Else
                    End If
                Else
                End If
                If Range("S40").Value = True Then
                    If count3 < 1 Then
                    'S26
                    
                    chk = "fail"
                    
                    Else
                    End If
                Else
                End If


            End If
            
End If

'Vietnam
If Sheets("GM_IO_Form").Range("E49:F49").EntireRow.Hidden = True Then
Else
            count1 = Application.WorksheetFunction.CountIf(Range("S49"), True)
            count2 = Application.WorksheetFunction.CountIf(Range("T49:U49"), True)
            'count3 = application.WorksheetFunction.CountIf(Range("T48:U48"), True)
            'count4 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
            'count5 = application.WorksheetFunction.CountIf(Range("T28:U28"), True)
                        
            If count1 < 1 Then
                    
            chk = "fail"
            
            Else
                If Range("S49").Value = True Then
                    If count2 < 1 Then
                    'S26
                    
                    chk = "fail"
                    
                    Else
                    End If
                Else
                End If

            End If
            
End If


'formatconditon_gmBU_First_checkbox()

'1
    Range("$G$26:$M$28").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$26:$S$28,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''2
'    Range("$G$27:$M$27").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$27,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'
''3
'    Range("$G$28:$M$28").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$28,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'4
    Range("$G$29:$M$30").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$29,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'5
    'Range("$G$31:$M$33").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$31,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'
'
'
'
    Range("G51:M51,G31:M33").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$31,TRUE)+COUNTIF($S$51,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
'6
    Range("$G$34:$M$35").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$34:$S$35,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''7
'    Range("$G$35:$M$35").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$35,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False

'8

    Range("$G$36:$M$38,$G$50:$M$50").Select
'    Range("G31").Activate
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$36:$S$38,TRUE)+COUNTIF($S$50,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'
'    Range("$G$36:$M$38").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$36:$S$38,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False

''9
'    Range("$G$37:$M$38").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$37,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'10
    Range("$G$39:$M$40").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$39:$S$40,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

''11
'    Range("$G$40:$M$40").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$40,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False

'12
    Range("$G$41:$M$46").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$41:$S$46,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''13
'    Range("$G$42:$M$42").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$42,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
''14
'    Range("$G$43:$M$43").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$43,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
''15
'    Range("$G$44:$M$46").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$44,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'16
    Range("$G$47:$M$48").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$47:$S$48,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
''17
'    Range("$G$48:$M$48").Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
'        "=(COUNTIF($S$48,TRUE))<1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 6750207
'        .TintAndShade = 0
'    End With
'    Selection.FormatConditions(1).StopIfTrue = False
'18
    Range("$G$49:$M$49").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=(COUNTIF($S$49,TRUE))<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'formatconditon_gmBU_second_checkbox()
'thailand format condition
'1
    Range("N26:Q26").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$26=TRUE, COUNTIF($T$26:$U$26,TRUE), 1)<1)"
    '"=AND($G$63<>TRUE,IF($S$43=TRUE,
    
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'2
    Range("N27:Q27").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$27=TRUE, COUNTIF($T$27:$U$27,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'3

    Range("N28:Q28").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$28=TRUE, COUNTIF($T$28:$U$28,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
'New Zealand format condition
'1
    Range("N29:Q29,N30:O30").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$29=TRUE, COUNTIF($T$29:$U$30,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'australia
    Range("N31:Q33").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$31=TRUE, COUNTIF($T$31:$U$33,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'2
    Range("N51:O51").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$51=TRUE, COUNTIF($T$51:$U$51,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'philippine
    Range("N$34:Q$34").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$34=TRUE, COUNTIF($T$34:$U$34,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'singapore
'1
    Range("N$36:Q$36").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$36=TRUE, COUNTIF($T$36:$U$36,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'2
        Range("N$37:O$37,P$37:Q$38").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$37=TRUE, COUNTIF($T$38:$U$37,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'3
        Range("$N$50:$O$50").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$50=TRUE, COUNTIF($T$50:$U$50,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'indonesia

    Range("N$39:Q$39").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$39=TRUE, COUNTIF($T$39:$U$39,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$40:Q$40").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$40=TRUE, COUNTIF($T$40:$U$40,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
'india
    Range("N$41:Q$41").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$41=TRUE, COUNTIF($T$41:$U$41,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$42:Q$42").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$42=TRUE, COUNTIF($T$42:$U$42,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("N$43:Q$43").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$43=TRUE, COUNTIF($T$43:$U$43,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$44:Q$46").Select

    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$44=TRUE, COUNTIF($T$44:$U$46,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'UAE
    
    Range("N$47:Q$47").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$47=TRUE, COUNTIF($T$47:$U$47,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    
    Range("N$48:Q$48").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$48=TRUE, COUNTIF($T$48:$U$48,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'vietnam
    Range("N$49:Q$49").Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$49=TRUE, COUNTIF($T$49:$U$49,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'other special cells and fields
'purchase_finance_E_ID_mandatory()
    If Range("$F$128").EntireRow.Hidden = False And Range("F130").Value = "" And Range("F128").Value = "" Then
    Range("F130:N130,F128:N128").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$128="""",$F$130="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Else
    End If
    
    If Range("$F$585").EntireRow.Hidden = False And Range("F585").Value = "" And Range("F587").Value = "" Then
    Range("F585:N585,F587:N587").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$585="""",$F$587="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F157:N157").EntireRow.Hidden = False And Range("F157").Value = "" And Range("F159").Value = "" Then
    Range("F159:N159,F157:N157").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$157="""",$F$159="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F182:N182").EntireRow.Hidden = False And Range("F182").Value = "" And Range("F184").Value = "" Then
    Range("F182:N182,F184:N184").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$182="""",$F$184="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F241:N241,F243:N243").EntireRow.Hidden = False And Range("F241").Value = "" And Range("F243").Value = "" Then
    Range("F241:N241,F243:N243").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$241="""",$F$243="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If


    If Range("F255:N255,F257:N257").EntireRow.Hidden = False And Range("F255").Value = "" And Range("F257").Value = "" Then
    Range("F255:N255,F257:N257").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$255="""",$F$257="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F277:N277,F275:N275").EntireRow.Hidden = False And Range("F277").Value = "" And Range("F275").Value = "" Then
    Range("F277:N277,F275:N275").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$275="""",$F$277="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F387:N387,F389:N389").EntireRow.Hidden = False And Range("F387").Value = "" And Range("F389").Value = "" Then
    Range("F387:N387,F389:N389").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$387="""",$F$389="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    

    If Range("F414:N414,F416:N416").EntireRow.Hidden = False And Range("F414").Value = "" And Range("F416").Value = "" Then
    Range("F414:N414,F416:N416").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$414="""",$F$416="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F440:N440,F442:N442").EntireRow.Hidden = False And Range("F440").Value = "" And Range("F442").Value = "" Then
    Range("F440:N440,F442:N442").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$440="""",$F$442="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    If Range("F466:N466,F468:N468").EntireRow.Hidden = False And Range("F466").Value = "" And Range("F468").Value = "" Then
    Range("F466:N466,F468:N468").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$466="""",$F$468="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    If Range("F514:N514,F516:N516").EntireRow.Hidden = False And Range("F514").Value = "" And Range("F516").Value = "" Then
    Range("F514:N514,F516:N516").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$514="""",$F$516="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("F539:N539,F541:N541").EntireRow.Hidden = False And Range("F539").Value = "" And Range("F541").Value = "" Then
    Range("F539:N539,F541:N541").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$539="""",$F$541="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
    If Range("F562:N562,F564:N564").EntireRow.Hidden = False And Range("F562").Value = "" And Range("F564").Value = "" Then
    Range("F562:N562,F564:N564").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$562="""",$F$564="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
    If Range("F182:N182").EntireRow.Hidden = False And Range("F182").Value = "" And Range("F184").Value = "" Then
    Range("F182:N182,F184:N184").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$182="""",$F$184="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If

    If Range("$F$387").EntireRow.Hidden = False And Range("$F$387").Value = "" And Range("$F$389").Value = "" Then
    Range("F387:N387,F389:N389").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($F$387="""",$F$389="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
'IFSC_Code()

''            'Cells.FormatConditions.Delete
''            If Range("$R$603").EntireRow.Hidden = False And Range("$O$603").Value = "IFSC" And Range("$R$603").Value = "" Then
''            Range("R603:U603").Select
''            Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
''                "=AND($O$603=""IFSC"",$R$603="""")"
''            Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
''            With Selection.FormatConditions(1).Interior
''                .PatternColorIndex = xlAutomatic
''                .Color = 6750207
''                .TintAndShade = 0
''            End With
''            Selection.FormatConditions(1).StopIfTrue = False
''            chk = "fail"
''            Else
''            End If
'Doc()

    If Range("$D$988").EntireRow.Hidden = False And Range("$D$988").Value = "" And Range("$D$989").Value = "" _
    And Range("$D$990").Value = "" And Range("$D$991").Value = "" And Range("$D$992").Value = "" Then
    
    Range("D988:D992").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($D$988="""",$D$989="""",$D$990="""",$D$991="""",$D$992="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    chk = "fail"
    Else
    End If
    
'other one by one cells, like supplier code, name, etc
'''''    If Range("F605").EntireRow.Hidden = False And Range("F605").Value = "" Then
'''''        Range("F605").Select
'''''        Call if_selected_cell_blank_conditional_format
'''''        chk = "fail"
'''''    Else
'''''    End If

    If Range("F112:U112").EntireRow.Hidden = False Then
        If Range("F112").Value = "" Then
            Range("F112:U112").Select
            Call if_selected_cell_blank_conditional_format
            chk = "fail"
        Else
        End If
    Else
    End If
    
    If Range("F402:U402").EntireRow.Hidden = False Then
        If Range("F402").Value = "" Then
            Range("F402:U402").Select
            Call if_selected_cell_blank_conditional_format
            chk = "fail"
        Else
        End If
    Else
    End If
    
    
    If Range("P74:S74").EntireRow.Hidden = False Then
    If Range("P74").Value = "" Then
        Range("P74:S74").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F603:N603").EntireRow.Hidden = False Then
    If Range("F603").Value = "" Then
        Range("F603:N603").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F375:U375").EntireRow.Hidden = False Then
    If Range("F375").Value = "" Then
        Range("F375:U375").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F59:U59").EntireRow.Hidden = False Then
    If Range("F59").Value = "" Then
        Range("F59:U59").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If


    If Range("F143:U143").EntireRow.Hidden = False Then
    If Range("F143").Value = "" Then
        Range("F143:U143").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F168:U168").EntireRow.Hidden = False Then
    If Range("F168").Value = "" Then
        Range("F168:U168").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F194:U194").EntireRow.Hidden = False Then
    If Range("F194").Value = "" Then
        Range("F194:U194").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F213:U213").EntireRow.Hidden = False Then
    If Range("F213").Value = "" Then
        Range("F213:U213").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F223:I223").EntireRow.Hidden = False Then
    If Range("F223").Value = "" Then
        Range("F223:I223").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F233:I233").EntireRow.Hidden = False Then
    If Range("F233").Value = "" Then
        Range("F233:I233").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F265:U265").EntireRow.Hidden = False Then
    If Range("F265").Value = "" Then
        Range("F265:U265").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F483:U483").EntireRow.Hidden = False Then
    If Range("F483").Value = "" Then
        Range("F483:U483").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F502:U502").EntireRow.Hidden = False Then
    If Range("F502").Value = "" Then
        Range("F502:U502").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F527:U527").EntireRow.Hidden = False Then
    If Range("F527").Value = "" Then
        Range("F527:U527").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F550:U550").EntireRow.Hidden = False Then
    If Range("F550").Value = "" Then
        Range("F550:U550").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F573:U573").EntireRow.Hidden = False Then
    If Range("F573").Value = "" Then
        Range("F573:U573").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    If Range("F428:U428").EntireRow.Hidden = False Then
    If Range("F428").Value = "" Then
        Range("F428:U428").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    If Range("F454:U454").EntireRow.Hidden = False Then
    If Range("F454").Value = "" Then
        Range("F454:U454").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If

    '1
    If Range("F618:N618").EntireRow.Hidden = False Then
    If Range("F618").Value = "" Then
        Range("F618:N618").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
    
    '2
    If Range("F632:N632").EntireRow.Hidden = False Then
    If Range("F632").Value = "" Then
        Range("F632:N632").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'3
    If Range("F645:N645").EntireRow.Hidden = False Then
    If Range("F645").Value = "" Then
        Range("F645:N645").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'4
    If Range("F658:N658").EntireRow.Hidden = False Then
    If Range("F658").Value = "" Then
        Range("F658:N658").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'5
    If Range("F671:N671").EntireRow.Hidden = False Then
    If Range("F671").Value = "" Then
        Range("F671:N671").Select
        Call if_selected_cell_blank_conditional_format
        chk = "fail"
    Else
    End If
    Else
    End If
'Tax_configaration()

    If Range("F80,J80").EntireRow.Hidden = False Then
    Range("F80,J80").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($F$81:$M$81,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If

    If Range("F366,J366").EntireRow.Hidden = False Then
    Range("F366,J366").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($F$367:$N$367,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If



    If Range("E592:H592,K592:O592").EntireRow.Hidden = False Then
    Range("E592:H592,K592:O592").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($E$593:$N$593,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If


    If Range("E362,K362").EntireRow.Hidden = False Then
    Range("E362,K362").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($E$363:$O$363,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If


    If Range("E347,K347").EntireRow.Hidden = False Then
    Range("E347,K347").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($E$348:$Q$348,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Else
    End If

'-------------------------------------------------------------------------
    'Appropreate vendor code
    Range("D62,G62,I62,M62,P62,S62,E62,H62,J62,K62,N62,Q62,T62,U62,R62").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=COUNTIF($D$63:$U$63,TRUE)<1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'--------------------------------------------------------------------------
'out side suuplier or inter company
    If Range("E53").EntireRow.Hidden = False Then
    If Application.WorksheetFunction.CountIf(Range("E54:H54"), True) < 1 Then
        'Range("F59:U59").Select
        'Call if_selected_cell_blank_conditional_format
        chk = "fail"
        
        Range("E53:J53").Select
        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
            "=COUNTIF($E$54:$I$54,TRUE)<1"
        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
        With Selection.FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 6750207
            .TintAndShade = 0
        End With
        Selection.FormatConditions(1).StopIfTrue = False
        
    Else
    End If
    Else
    End If

    'Appropreate vendor code

'---------------------------------------------------------------------------
'ERS Supplier or non ers supplier
    If Range("G64").EntireRow.Hidden = False Then
    If Application.WorksheetFunction.CountIf(Range("G65:K65"), True) < 1 Then
        'Range("F59:U59").Select
        'Call if_selected_cell_blank_conditional_format
        chk = "fail"
        
        Range("G64:J64").Select
        Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
            "=COUNTIF($G$65:$J$65,TRUE)<1"
        Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
        With Selection.FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 6750207
            .TintAndShade = 0
        End With
        Selection.FormatConditions(1).StopIfTrue = False
        
    Else
    End If
    Else
    End If

    'Appropreate vendor code

'---------------------------------------------------------------------------

If chk = "fail" Then

MsgBox "Mandatory Fields cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
Range("F20").Select

If mandatory = True And Range("G63").Value <> True Then Else Range("N26:Q51").FormatConditions.delete

Call Pro
Exit Sub
Else

End If




'till here go then, lets say validation has been completed

     'unhiding all sheets
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
     'Sheets("GM_IO_Form").Move Before:=Sheets(1)
   'Sheets("GM Europe Multiple BU &PO").Move Before:=Sheets(2)
        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub


subm = ThisWorkbook.Sheets("GM_IO_Form").Range("Q18").Value & " " & Range("F20").Value
DUN = Range("F57").Value & Range("F109").Value & Range("F140").Value & Range("F192").Value & Range("F211").Value & Range("F373").Value & Range("F399").Value & Range("F425").Value & Range("F452").Value & Range("F499").Value & Range("F525").Value & Range("F548").Value & Range("F571").Value
SUP = Range("F59").Value & Range("F112").Value & Range("F143").Value & Range("F168").Value & Range("F194").Value & Range("F213").Value & Range("F265").Value & Range("F375").Value & Range("F402").Value & Range("F428").Value & Range("F454").Value & Range("F483").Value & Range("F502").Value & Range("F527").Value & Range("F550").Value & Range("F573").Value

subj = subm + "-" + DUN + "-" + SUP


            WkbName = subj 'Range("q18").Value & " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array("<", ">", "|", "/", "*", "[", "]", "{", "}", "-", "\", "?", """")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName = Replace(WkbName, MyArray(x), "_", 1)
            Next x
            'MsgBox WkbName
        
            WkbName_first = mypath 'Range("I9").Value '& " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array(".xls", "xlsx")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName_first = Replace(WkbName_first, MyArray(x), "_", 1)
            Next x



'aw = Application.ActiveWorkbook.Path & "\"
   'tb = InputBox("give the file name", , any_Name)
 '  ta = tb & ".xls" '".pdf"
  ' tt = aw & ta
  pbn = ActiveWorkbook.Name
  
   Sheets(Array("Mass change")).Select
  ActiveWindow.SelectedSheets.Copy
  cbn = ActiveWorkbook.Name
  
  ActiveWorkbook.Sheets.Add Before:=Worksheets(1) ', Count:=3
  
  'sheets("Sheet
  'ActiveWorkbook.Worksheets.Add
  ActiveSheet.Name = "Form"
  
  On Error GoTo 0
  Windows(pbn).Activate
  Sheets("GM_IO_Form").Select
  Call UnPro
  'Range("A1:V3327").Select
'Selection.Copy
'Selection.SpecialCells(xlCellTypeVisible).Copy
'Range("A1:V3327")

''''''''''''''''''''''''''''''''''''

Range("W1:W1000").ClearContents
    Range("W1:W1000").SpecialCells(xlCellTypeVisible).FormulaR1C1 = "UN"
    Cells.Copy
    
Windows(cbn).Activate
Sheets("Form").Select
Range("A1").Select

'    Windows.Add
Application.DisplayAlerts = False
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveSheet.Paste

       ' Range("A1:W1").Insert Shift:=xlDown
''''    Range("A1:W1").FormulaR1C1 = " "
       ' Range("A1").Select
       ' Selection.AutoFilter
    
        Range("$A$1:$W$1000").Select
        Selection.AutoFilter
        ActiveSheet.Range("$A$1:$W$1000").AutoFilter Field:=23, Criteria1:="<>"
    
     '   Selection.AutoFilter , VisibleDropDown:=False
       ' ActiveSheet.Range("$A$1:$W$1000").AutoFilter Field:=23, VisibleDropDown:=False, Criteria1:="<>"
        ActiveWindow.ScrollRow = 1
        
        Selection.AutoFilter Field:=1, VisibleDropDown:=False
        Selection.AutoFilter Field:=22, VisibleDropDown:=False
     '   Selection.AutoFilter Field:=23, VisibleDropDown:=False
    '
      '  Range("W1").Select
''''    Do
''''    If ActiveCell.Value = "UN" Then ActiveCell.EntireRow.Hidden = False Else ActiveCell.EntireRow.Hidden = True
''''    ActiveCell.Offset(1, 0).Select
''''    If ActiveCell.Row >= 1000 Then Exit Do
''''
''''    Loop

    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Application.DisplayFormulaBar = False
    Range("A1").Select
    
    On Error Resume Next
    If Range("B1").Value = "" Then Range("A1").EntireRow.Hidden = True
    On Error GoTo 0
''''''''''''''''''''''''''''''''''''

'ActiveSheet.Paste
Range("A1").Select
Cells.FormatConditions.delete

           On Error Resume Next

'deleting irrelevent sheets from product
    'If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then Else Sheets("GM Europe Multiple BU &PO").Delete
    If Sheets("Form").Range("Q18").Value = "Mass changes" Then Else Sheets("Mass change").delete
        ' '========================
            On Error GoTo 0
            



        ActiveWorkbook.SaveAs (WkbName_first & " " & WkbName & ".xls"), FileFormat:=51
''
'''deleting unselected rows from GM multiple BU
''If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then '!!!
''        Sheets("GM Europe Multiple BU &PO").Select
''        Call UnPro
''        If ActiveSheet.Name = "GM Europe Multiple BU &PO" Then '!!
''
''                Range("D3").Select
''                Do
''                On Error GoTo ivd
''                If ActiveCell.Value = "" Then Exit Do
''                If ActiveCell.Value = "False" Then
''                ActiveCell.EntireRow.Delete
''                Else
''                ActiveCell.Offset(1, 0).Select
''                End If
''                Loop
''ivd:
''On Error GoTo 0
''        Range("A1").EntireRow.Delete
''        Range("A1").Select
''        On Error Resume Next
''        ActiveSheet.DrawingObjects("CheckEU1").Visible = False
''
''
''                Range(Range("B1048570").End(xlUp).Offset(1, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
''                Selection.EntireRow.Hidden = False
''                Range(Range("B1048570").End(xlUp).Offset(2, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
''                On Error Resume Next
'''                Selection.EntireRow.Hidden = True
''                'On Error GoTo 0
''                Dim s As Shape
''                On Error Resume Next
''                For Each s In ActiveSheet.Shapes
''
''                s.OnAction = ""
''                Next
''                On Error GoTo 0
'''''        ActiveSheet.Shapes.Visible = False
''''        ActiveSheet.Shapes.SelectAll
''''        Selection.ShapeRange.Visible = False
''        On Error GoTo 0
''        Call Pro
''        Else '!!
''        End If '!!
''Else '!!!
''End If '!!!
        'also you can give like left 10000 nos to eliminate xls from my path
        Sheets(1).Select
        

        
        'write here to alter form copy
   '         On Error Resume Next
'            ActiveSheet.DrawingObjects.Visible = False
           ' ActiveSheet.DrawingObjects.Delete
 '           ActiveSheet.DrawingObjects.Hide
  '          On Error GoTo 0
''    Call UnPro
''    Range("A1").Select
''    On Error Resume Next
ActiveWindow.SmallScroll up:=1000000
''          ActiveSheet.Shapes.Range(Array("Group 5", "CommandButton1", "CommandButton2", "CommandButton3", "CommandButton4", "submit")).Delete
''Range("a1:V3336").Locked = True
'''Range("Q3331").ClearContents
'Application.ScreenUpdating = False
On Error GoTo 0

On Error Resume Next

ActiveSheet.Shapes.SelectAll
'ActiveSheet.Shapes.OnAction = "nidhi"
Selection.OnAction = ""

'xxx

On Error Resume Next
For Each s In ActiveSheet.Shapes
s.OnAction = ""
Next

        'If ActiveSheet.Name = "Form" Then Range("F20:L20").Locked = True
        'If ActiveSheet.Name = "Form" Then Range("F10:L10").Locked = True
        'Range("F21:N21").ClearContents
        
    On Error GoTo 0
    

    
    
        Call Pro
        
        ActiveWorkbook.UpdateLinks = xlUpdateLinksNever
        
        'added for one mail project
        ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
        ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"
        Sheets("Form").Select
        ActiveSheet.Name = "Form_GBS"
        
        ActiveWorkbook.Save
        
        ffname = ActiveWorkbook.FullName
        fname = ActiveWorkbook.Name
        
        ActiveWorkbook.Close
        'MsgBox " Request Copy Has Been Saved as " & fname
        ' '============================
        tt1 = ffname
        
  '  .ExportAsFixedFormat Type:=xlTypexls, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  'End With
   
  
  
  
'''abu added=======================================================================================
''                 'Sheets("ORD").Select (False)
''                  'Sheets("Standardchanges").Select (False)
''                  ActiveWindow.SelectedSheets.Copy
''
''                  Application.StatusBar = False
''
''                    Dim appXL As New Excel.Application
''    Dim MyDate
''    MyDate = Date    ' MyDate contains the current system date.
''    Dim MyTime
''    MyTime = Time    ' Return current system time.
''    Dim TestStr As String
''    TestStr = Format(MyTime, "hh.mm.ss")
''    Dim Test1Str As String
''    Test1Str = Format(MyDate, "DD-MM-YYYY")
''
''    Application.DisplayAlerts = False
''    'MsgBox ActiveWorkbook.Name
''
''    ActiveWorkbook.SaveAs Filename:="C:\STD Changes\Bank\" & ree & " " & Test1Str & " " & TestStr & " " & ".xlsx" 'ActiveWorkbook.name
''    'ActiveWorkbook.SaveAs Filename:="C:\Std Changes\RAW DATA\" & "Test"
''    ActiveWorkbook.Save
''    bn = ActiveWorkbook.FullName
'''abu added=====================================================================================
  ' Call page

'Next i
'Else
Windows(pbn).Activate

Sheets("GM_IO_Form").Select
Range("A1").Select
Call UnPro

''
If UserForm3.OptionButton1.Value = True Then

Dim rng As Range
Set rng = Nothing

Set rng = Sheets("GM_IO_Form").Range("A9:W23").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)


subj = subm + "-" + DUN + "-" + SUP
With OutMail
    .To = Range("I6").Value & ";" & Range("C6").Value ' & ";" & Range("F14").Value
    .cc = Range("F14").Value
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
'    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
'  If Sheets("GM_IO_Form").Range("U20").Value <> "" And Sheets("GM Europe Multiple BU &PO").Range("f1").Value <> 0 Then
'  Sheets("GM Europe Multiple BU &PO").Select
'  Range("A1").Select
'  Selection.AutoFilter
 ' End If
 
Else
'        If ActiveSheet.OptionButton2.Value = True Then MsgBox "Form has been saved in the below Directory " _
'        & vbNewLine & vbNewLine & vbNewLine & ffname
    'If UserForm3.OptionButton2.Value = True Then
MsgBox "Form has been saved in the below Directory " & vbNewLine & vbNewLine & vbNewLine & ffname
aska = MsgBox("Do you wan to open the Generated Form?", vbYesNo)
    If aska = 6 Then
    Application.DisplayAlerts = False
    Workbooks.Open (ffname)
    
    Else
        MsgBox "Finished..!", vbInformation
    End If
Application.DisplayAlerts = True
Exit Sub
End If

'''       For I = 3 To Sheets.Count
'''     Sheets(I).Visible = 2
'''     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM_IO_Form").Select
     Call Pro
     Application.ScreenUpdating = True
     MsgBox "Finished..!", vbInformation
     Application.DisplayAlerts = True
    Application.UseSystemSeparators = True
End Sub



Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM EU Form").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function






Attribute VB_Name = "GM_NA_Functions"
Sub GM_NA_vendorcatogery_and_its_checkboxes()

Call UnPro
Range("A64:A66").EntireRow.Hidden = False
'Range("A64:A73").EntireRow.Hidden = False
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                    ActiveSheet.CheckBoxes("pv").delete
                     
                    'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
                    On Error GoTo 0

                    xrow = 65
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 62
''''''                    ycolumn = "B"
''''''                    Zlinked = ycolumn & xrow + 1
''''''                    'oonaction = "vendercatogery_multiple_select_control"
''''''                    nname = "pv"
''''''
''''''
''''''                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
''''''                                                                    Cells(xrow, ycolumn).Top, _
''''''                                                                    80, 17).Select
''''''
''''''                                        With Selection
''''''                                            .Caption = ""
''''''                                            .Value = xlOff '
''''''                                            .LinkedCell = Zlinked
''''''                                            .Display3DShading = True
''''''                                    '        .lock = False
''''''                                            .Name = nname
''''''                                            .OnAction = oonaction
''''''
''''''                                  End With

                    'xrow = 62
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select

                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 62
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    'xrow = 62
                    ycolumn = "N"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 62
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 62
                    ycolumn = "S"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_vendercatogery_multiple_select_control"
                    nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("F20").Select
End Sub

Sub GM_NA_vendercatogery_multiple_select_control()

Call UnPro
Dim iVal As Integer
Call Delete_unnecessary_checkboxes
iVal = Application.WorksheetFunction.CountIf(Range("E66:T66"), True)

'valide GM BU has to be selected
If Range("F20").Value = "" Then
MsgBox "Please select a valid GM Business Unit", vbInformation
    Range("E66").Value = False
    Range("H66").Value = False
    Range("K66").Value = False
    Range("N66").Value = False
    Range("P66").Value = False
    Range("S66").Value = False
Call Pro
Exit Sub
End If

'if incase selecting more than one vendor at a time
If iVal > 1 Then
    'Range("B66").Value = False
    Range("E66").Value = False
    Range("H66").Value = False
    Range("K66").Value = False
    Range("N66").Value = False
    Range("P66").Value = False
    Range("S66").Value = False
    MsgBox "More than one vendor categories can not be selected at a time", vbExclamation
    

Else
        'for finance vendors, inco term is not required, and its text too
        Call incoterm_and_text_for_finance_vendors
        Call GM_service_provider_us_nu
End If

'If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then 'And Range("P64").Value = False Then
    
    Range("A354:A422").EntireRow.Hidden = True

        'inter co true then
        If Range("S66").Value = True Then
        Range("A69:A71").EntireRow.Hidden = False
        Else
        Range("A69:A71").EntireRow.Hidden = True
        End If
        
        
        'finance and service vendor true then
        If Range("K66").Value = True Or Range("H66").Value = True Then
        Range("A67:A69").EntireRow.Hidden = False
        Range("A76").EntireRow.Hidden = False
        
        Else
        Range("A67:A69").EntireRow.Hidden = True
        End If

        'tire2 vendor true then
        If Range("N66").Value = True Then
        Range("B76:B79").EntireRow.Hidden = True
        Range("B114:B118").EntireRow.Hidden = True
        

        Range("A261:A331,A351:A429").EntireRow.Hidden = True
        Range("A235:A262").EntireRow.Hidden = True
        
        'Range("A310:A331").EntireRow.Hidden = False
        
        'A619:A647
        Range("A619:A647").EntireRow.Hidden = False
        Range("A565:A569").EntireRow.Hidden = True
        
        Call GM_NA_DCB
        'Call purchasing_vendor_ERS_category
        Else

        
        Range("A546:A552").EntireRow.Hidden = False
        Range("A565:A569").EntireRow.Hidden = False
        
         Range("A619:A647").EntireRow.Hidden = True
        Range("A235:A262").EntireRow.Hidden = False

        Call EFTCheque_GM_NA_for_banking_details
        Range("A261:A263").EntireRow.Hidden = False
        Call GM_NA_remi_ship_header
        
        Call GM_NA_DCB
        Range("B114:B118").EntireRow.Hidden = False
                            'On Error Resume Next
                            'ActiveSheet.CheckBoxes("ERSpv").Delete
                            'ActiveSheet.CheckBoxes("ERSpv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
                            'ActiveSheet.CheckBoxes("pv").Delete
        
                            'ActiveSheet.CheckBoxes("V4C10mdirect2").Delete
         '                   On Error GoTo 0
        'multiple business unit for applied Vendor Catogeries
        'If Range("B66").Value = True Or
        'Range("K66").Value = True Or _
        'Range("S66").Value = True
        
        If Range("E66").Value = True Or _
        Range("H66").Value = True Or _
        Range("P66").Value = True Then
         Range("A546:A552").EntireRow.Hidden = True
        
        
                If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then
                MsgBox "Please update a valid GM Business Unit from 'GM_Multiple_BU' tab"
                mm = ActiveSheet.Name
                Call Pro
                Sheets("GM_NA_Multiple_BU").Visible = True
                Sheets("GM_NA_Multiple_BU").Select
                Sheets("Index").Range("C1").Value = mm
                Else
                                If Range("F20").Value = "See Mass Change tab" Then Else Range("B76:B79").EntireRow.Hidden = False
                    'Call Pro
                End If
            
        Else
        Range("B76:B79").EntireRow.Hidden = True
        Range("A546:A552").EntireRow.Hidden = True
        
        End If
        End If
        
If Range("K66").Value = True Or Range("H66").Value = True Then Range("A76").EntireRow.Hidden = False
        
        If ActiveSheet.Name = "GM_NA" Then Call Pro
'''If Range("E66").Value = True Or _
'''Range("H66").Value = True Or _
'''Range("K66").Value = True Or _
'''Range("P66").Value = True Or _
'''Range("S66").Value = True Then
'''Else
'''Range("B76:B79").EntireRow.Hidden = True
'''End If


End Sub

Sub GM_NA_Additional_banking_information()

If Range("E353").Value = True And Range("K353").Value = True Then
MsgBox "Please select a valid mode of payment"
Range("E353").Value = False
Range("K353").Value = False
'Exit Sub
Else

''    If Range("E353").Value = True Or Range("K353").Value = True Then
''    Call UnPro
''    Range("A354:A422").EntireRow.Hidden = True
''
''    End If

End If

'Range("A368:A422").EntireRow.Hidden = True
Call UnPro
On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
On Error GoTo 0

'Range("A354:A422").EntireRow.Hidden = True

If Range("E353").Value = True Then
Call GM_NA_Bank_plus_chkbx
Range("A448:A461").EntireRow.Hidden = False
Range("A546:A552").EntireRow.Hidden = False
'Call Pro
Else
Range("A546:A552").EntireRow.Hidden = True
Range("A354:A422").EntireRow.Hidden = True
Range("A448:A461").EntireRow.Hidden = True
End If

If Range("K353").Value = True Then
Range("A546:A552").EntireRow.Hidden = True
Range("A546:A552").EntireRow.Hidden = True
Else

End If

Call Pro
End Sub

Sub GM_NA_additional_bank_required_field()

Call UnPro
Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("G367:S367"), True)

If iVal > 1 Then

Range("G367").Value = False
Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False
MsgBox ("Only 5 additional banks can be added maximum")
Else
End If

Range("A368:A422").EntireRow.Hidden = True
'1
If Range("G367").Value = True Then
Range("A368:A378").EntireRow.Hidden = False
Else
End If
'2
If Range("J367").Value = True Then
Range("A368:A389").EntireRow.Hidden = False
Else
End If
'3
If Range("M367").Value = True Then
Range("A368:A400").EntireRow.Hidden = False
Else
End If
'4
If Range("P367").Value = True Then
Range("A368:A411").EntireRow.Hidden = False
Else
End If
'5
If Range("S367").Value = True Then
Range("A368:A422").EntireRow.Hidden = False
Else
End If
Call Pro
End Sub


Sub GM_NA_remi_ship_header()

If Range("A261").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete

'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 261
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_remi_ship_header_slection" '"purchasing_vendor_ERS_category"
                    nname = "RSH"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 261
                    ycolumn = "M"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    'nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With


                    'xrow = 261
                    ycolumn = "R"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
                    'nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With


'''                    'xrow = 261
'''                    ycolumn = "P"
'''                    Zlinked = ycolumn & xrow + 1
'''                    oonaction = "GM_NA_vendercatogery_multiple_select_control" '"purchasing_vendor_ERS_category"
'''                    'nname = "pv"
'''
'''
'''                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
'''                                                                    Cells(xrow, ycolumn).Top, _
'''                                                                    80, 17).Select
'''                                        With Selection
'''                                            .Caption = ""
'''                                            .Value = xlOff '
'''                                            .LinkedCell = Zlinked
'''                                            .Display3DShading = True
'''                                    '        .lock = False
'''                                            .Name = nname
'''                                            .OnAction = oonaction
'''
'''                                  End With

Range("R259").Select
Else
End If
End Sub

Sub GM_NA_remi_ship_header_slection()
'remi
Call UnPro
If Range("H262").Value = True Then
Range("A263:A285").EntireRow.Hidden = False
Else
Range("A263:A285").EntireRow.Hidden = True
End If


If Range("M262").Value = True Then
        If Range("Q18").Value = "New Duns creation" And Range("F69").Value = "Yes" Then
        Range("M262").Value = False
        Range("A286:A309").EntireRow.Hidden = True
        MsgBox "Not applicable for DOA/EPS Vendors"
        Else
        Range("A286:A309").EntireRow.Hidden = False
        End If
Else
Range("A286:A309").EntireRow.Hidden = True
End If

If Range("R262").Value = True Then
    If Range("Q18").Value = "New Duns creation" And Range("F69").Value = "Yes" Then
        Range("R262").Value = False
        Range("A310:A331").EntireRow.Hidden = True
        MsgBox "Not applicable for DOA/EPS Vendors"
    Else
    Range("A310:A331").EntireRow.Hidden = False
    End If
Else
Range("A310:A331").EntireRow.Hidden = True
End If

Call GM_NA_DCB

Call Pro
End Sub

Sub GM_NA_bank_ac_maintanance_checkbox()

If Range("G42").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("BAM").delete
ActiveSheet.CheckBoxes("BAM").delete
ActiveSheet.CheckBoxes("BAM").delete
ActiveSheet.CheckBoxes("BAM").delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 42
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_BAM_Add" '"purchasing_vendor_ERS_category"
                    nname = "BAM"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
                    'xrow = 261
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_BAM_Change" '"purchasing_vendor_ERS_category"
                    'nname = "pv"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

                    'xrow = 261
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "GM_NA_BAM_Delete" '"purchasing_vendor_ERS_category"
                    'nname = "pv"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With

                    xrow = 43
                    ycolumn = "C"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    'nname = "pv"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Range("R259").Select
Else
End If
End Sub

Sub GM_NA_BAM_Add()
'document
'banking
'comment
Call UnPro

Dim iVal As Integer
iVal = Application.WorksheetFunction.CountIf(Range("H43:P43"), True)

If iVal > 1 Then

Range("H43").Value = False
Range("K43").Value = False
Range("P43").Value = False
'Range("P367").Value = False
'Range("S367").Value = False
MsgBox ("Please select a valid Maintanace, only one at a time"), vbExclamation
Else
End If

If Range("H43").Value = True Or Range("P43").Value = True Then
'Range("A46:A52").EntireRow.Hidden = False

Range("A546:A552").EntireRow.Hidden = False
Range("A565:A569").EntireRow.Hidden = False

Range("A354:A367").EntireRow.Hidden = False
Range("A354:A367").EntireRow.Hidden = False

Call GM_NA_Bank_plus_chkbx
Range("A546:A552,A565:A569").EntireRow.Hidden = False
Range("A448:V461").EntireRow.Hidden = False

Else

'Range("A46:A52").EntireRow.Hidden = true
Range("A546:A552").EntireRow.Hidden = True
'Range("A565:A569").EntireRow.Hidden = True

Range("A354:A367").EntireRow.Hidden = True
Range("A354:A422,A546:A552").EntireRow.Hidden = True
Range("A448:V461").EntireRow.Hidden = True
On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
On Error GoTo 0
End If


If Range("K43").Value = True Then

Range("A473:A500").EntireRow.Hidden = False
'Range("A500:A525").EntireRow.Hidden = False
Range("A546:A552").EntireRow.Hidden = False
'Range("A565:A569").EntireRow.Hidden = False
Call BAMAdd_additional_bank_for_change

Else

On Error Resume Next
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
On Error GoTo 0

Range("A473:A525").EntireRow.Hidden = True
'Range("A500:A525").EntireRow.Hidden = True
'Range("A546:A552").EntireRow.Hidden = True
'Or Range("K43").Value = True
End If

Call Pro
End Sub

Sub GM_NA_BAM_Change()
'document
'banking
'comment
End Sub

Sub GM_NA_BAM_Delete()
'document
'banking
'comment
End Sub

Sub GM_NA_Modified_P_term_checkbox()

If Range("F128").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("MPT").delete
ActiveSheet.CheckBoxes("MPT").delete
ActiveSheet.CheckBoxes("MPT").delete
ActiveSheet.CheckBoxes("MPT").delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 128
                    ycolumn = "F"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    xrow = 128
                    ycolumn = "I"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
Range("R259").Select
Else
End If
End Sub

Sub GM_NA_E_Mail_ID_setup_checkbox()

If Range("A543").EntireRow.Hidden = False Then


On Error Resume Next
'ActiveSheet.CheckBoxes("EFTpayment").Delete
'ActiveSheet.CheckBoxes("Chequepayment").Delete

ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete
ActiveSheet.CheckBoxes("EIDS").delete

'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
'ActiveSheet.CheckBoxes("adbank").Delete
On Error GoTo 0


                    xrow = 543
                    ycolumn = "H"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    nname = "EIDS"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    'xrow = 128
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    'nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With
                    'xrow = 128
                    ycolumn = "N"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "runnothing" '"purchasing_vendor_ERS_category"
                    'nname = "MPT"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With

Range("F20").Select
Else
End If
End Sub


Sub GM_NA_BU_checkboxes()
Application.ScreenUpdating = False
Sheets("GM_NA_Multiple_BU").Select
Call clear_all_checkbox
ycolumn = "B"
oonaction = "runnothing" '"purchasing_vendor_ERS_category"
nname = "GM_NA_BU"

Range("C7").Select

Do

                    xrow = ActiveCell.Offset(0, -1).Row
                    Zlinked = "C" & xrow ' + 1

                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    33, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
ActiveCell.Offset(1, 0).Select
If ActiveCell.Offset(0, -1).Value = "" Then Exit Do
Loop
End Sub

Sub EFTCheque_GM_NA_for_banking_details()
Call UnPro
Range("A351:A353").EntireRow.Hidden = False
Range("A354:A367").EntireRow.Hidden = True
    
On Error Resume Next
'to delete all checkbox related to EFT/check
ActiveSheet.CheckBoxes("EFTpayment").delete
ActiveSheet.CheckBoxes("Chequepayment").delete

On Error GoTo 0

                    xrow = 352 '347
                    ycolumn = "E"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_Additional_banking_information"
                    nname = "EFTpayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                  End With


                    'xrow = 347
                    ycolumn = "K"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "eft_cheque_check"
                    nname = "Chequepayment"


                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction

                                End With


'Call Pro
End Sub















Sub Delete_unnecessary_checkboxes()
Call UnPro
On Error Resume Next
'to delete all checkbox related to additional banking details
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete
ActiveSheet.CheckBoxes("adbank").delete

'to delete all checkbox related to EFT/check
ActiveSheet.CheckBoxes("EFTpayment").delete
ActiveSheet.CheckBoxes("Chequepayment").delete

'to delete all checkbox related to remittance/shipfrom/heder/ordering DUNS
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
ActiveSheet.CheckBoxes("RSH").delete
On Error GoTo 0
End Sub

Sub clear_all_field_GM_NA()
'headers
Application.ScreenUpdating = False
'Range("F10:L10").ClearContents
'Range("Q10:U10").ClearContents
'Range("F12:L12").ClearContents
'Range("Q12:U12").ClearContents
'Range("F14:L14").ClearContents
'Range("Q14:U14").ClearContents
'Range("Q18:U18").ClearContents
'Range("F20:L20").ClearContents
'Range("Q20:U20").ClearContents
'Range("F21:N21").ClearContents
Range("F26:I26").ClearContents
Range("F28:U28").ClearContents
Range("F30").ClearContents
Range("F32:N32").ClearContents
Range("F34:N34").ClearContents
Range("F38:I38").ClearContents
Range("F40:U40").ClearContents
Range("G42").ClearContents
Range("J42").ClearContents
Range("O42").ClearContents
'Range("F43").ClearContents
Range("H43").ClearContents
Range("K43").ClearContents
Range("P43").ClearContents
'Range("C44").ClearContents
'Range("F44").ClearContents
Range("D47").ClearContents
Range("D48").ClearContents
Range("D49").ClearContents
Range("D50").ClearContents
Range("D51").ClearContents
Range("F55:U55").ClearContents
Range("F57:U57").ClearContents
Range("F59:I59").ClearContents
Range("L59:O59").ClearContents
Range("S59:U59").ClearContents
Range("F61:J61").ClearContents
Range("N61:U61").ClearContents
Range("B66").ClearContents
Range("E66").ClearContents
Range("H66").ClearContents
Range("K66").ClearContents
Range("N66").ClearContents
Range("P66").ClearContents
Range("S66").ClearContents
Range("E70:F70").ClearContents
Range("L70:M70").ClearContents
Range("Q70").ClearContents
'Range("F115:I115").ClearContents
'Range("P115:S115").ClearContents
'Range("F117:I117").ClearContents
'Range("P117:S117").ClearContents


Range("E115:F115").ClearContents
Range("J115:M115").ClearContents
'Range("O115:T115").ClearContents
Range("E117:L117").ClearContents
'Range("O117:U117").ClearContents




Range("F121:U121").ClearContents
Range("F123:U123").ClearContents
Range("F126:L126").ClearContents
Range("P126:U126").ClearContents
Range("F129").ClearContents
Range("I129").ClearContents
Range("F130:U130").ClearContents
Range("F133:L133").ClearContents
Range("P133:U133").ClearContents
Range("F135:U137").ClearContents
Range("F140:L140").ClearContents
Range("F142:U144").ClearContents
'Range("F147").ClearContents
Range("H148").ClearContents
Range("K148").ClearContents
Range("N148").ClearContents
Range("F149:N149").ClearContents
Range("F151:N151").ClearContents
Range("F154:I154").ClearContents
Range("F156:L156").ClearContents
Range("F158:U160").ClearContents
Range("F163:U165").ClearContents
Range("F168:U170").ClearContents
Range("F173:L173").ClearContents
Range("F176:U176").ClearContents
Range("F178:U178").ClearContents
Range("F180:L180").ClearContents
Range("F182:U182").ClearContents
Range("F184:U184").ClearContents
Range("F186:U186").ClearContents
Range("F188:U188").ClearContents
Range("F190:U190").ClearContents
Range("F194:L194").ClearContents
Range("F197:U197").ClearContents
Range("F199:U199").ClearContents
Range("F201:L201").ClearContents
Range("F203:U203").ClearContents
Range("F205:U205").ClearContents
Range("F207:U207").ClearContents
Range("F209:U209").ClearContents
Range("F211:U211").ClearContents
Range("F215:L215").ClearContents
Range("F218:U218").ClearContents
Range("F220:U220").ClearContents
Range("F222:L222").ClearContents
Range("F224:U224").ClearContents
Range("F226:U226").ClearContents
Range("F228:U228").ClearContents
Range("F230:U230").ClearContents
Range("F232:U232").ClearContents
Range("F236:L236").ClearContents
Range("M236").ClearContents
Range("F239:U239").ClearContents
Range("F241:U241").ClearContents
Range("F243:U243").ClearContents
Range("F245:J245").ClearContents
'Range("M245:U245").ClearContents

Range("M245:P245").ClearContents
Range("R245:U245").ClearContents


Range("F247:J247").ClearContents
Range("M247:P247").ClearContents
Range("S247:U247").ClearContents
Range("F249:J249").ClearContents
Range("M249:U249").ClearContents
Range("F251:J251").ClearContents
Range("M251:P251").ClearContents
Range("R251:U251").ClearContents
Range("F253:N253").ClearContents
Range("F255:N255").ClearContents
Range("F257:L257").ClearContents
Range("N257:U257").ClearContents
Range("F259:L259").ClearContents
Range("H262").ClearContents
Range("M262").ClearContents
Range("R262").ClearContents
Range("F265:L265").ClearContents
Range("F268:U268").ClearContents
Range("F270:U270").ClearContents
Range("F272:J272").ClearContents
Range("M272:U272").ClearContents
Range("F274:J274").ClearContents
Range("M274:P274").ClearContents
Range("S274:U274").ClearContents
Range("F276:J276").ClearContents
Range("M276:U276").ClearContents
Range("F278:J278").ClearContents
Range("M278:P278").ClearContents
Range("R278:U278").ClearContents
Range("F280:U280").ClearContents
Range("F282:L282").ClearContents
Range("N282:U282").ClearContents
Range("F284:U284").ClearContents
Range("F287:L287").ClearContents
Range("F290:U290").ClearContents
Range("F292:U292").ClearContents
Range("F294:J294").ClearContents
Range("M294:U294").ClearContents
Range("F296:J296").ClearContents
Range("M296:P296").ClearContents
Range("S296:U296").ClearContents
Range("F298:J298").ClearContents
Range("M298:U298").ClearContents
Range("F300:J300").ClearContents
Range("M300:P300").ClearContents
Range("R300:U300").ClearContents
Range("F302:I302").ClearContents
Range("F304:U304").ClearContents
Range("F306:L306").ClearContents
Range("N306:U306").ClearContents
Range("F308:U308").ClearContents
Range("F311:L311").ClearContents
Range("F314:U314").ClearContents
Range("F316:U316").ClearContents
Range("F318:J318").ClearContents
Range("M318:U318").ClearContents
Range("F320:J320").ClearContents
Range("M320:P320").ClearContents
Range("S320:U320").ClearContents
Range("F322:J322").ClearContents
Range("M322:U322").ClearContents
Range("F324:J324").ClearContents
Range("M324:P324").ClearContents
Range("R324:U324").ClearContents
Range("F326:U326").ClearContents
Range("F328:L328").ClearContents
Range("N328:U328").ClearContents
Range("F330:U330").ClearContents
Range("F333:L333").ClearContents
Range("F336:U336").ClearContents
Range("F338:U338").ClearContents
Range("F340:J340").ClearContents
Range("M340:U340").ClearContents
Range("F342:J342").ClearContents
Range("M342:P342").ClearContents
Range("S342:U342").ClearContents
Range("F344:J344").ClearContents
Range("M344:U344").ClearContents
Range("F346:U346").ClearContents
Range("E348").ClearContents
Range("F348:L348").ClearContents
Range("N348:U348").ClearContents
Range("F350:U350").ClearContents
Range("E353").ClearContents
Range("K353").ClearContents
Range("F357:M357").ClearContents
Range("P357:Q357").ClearContents
Range("T357:U357").ClearContents
Range("F359:U359").ClearContents
Range("F361:I361").ClearContents
Range("L361:O361").ClearContents
Range("R361:U361").ClearContents
Range("F363:O363").ClearContents
Range("R363:U363").ClearContents
Range("F365:O365").ClearContents
Range("G367").ClearContents
Range("J367").ClearContents
Range("M367").ClearContents
Range("P367").ClearContents
Range("S367").ClearContents
'Range("V367").ClearContents
'Range("E368").ClearContents
Range("F369:M369").ClearContents
Range("P369:Q369").ClearContents
Range("T369:U369").ClearContents
Range("F371:U371").ClearContents
Range("F373:I373").ClearContents
Range("L373:O373").ClearContents
Range("R373:U373").ClearContents
Range("F375:O375").ClearContents
Range("R375:U375").ClearContents
Range("F377:O377").ClearContents
'Range("E379").ClearContents
Range("F380:M380").ClearContents
Range("P380:Q380").ClearContents
Range("T380:U380").ClearContents
Range("F382:U382").ClearContents
Range("F384:I384").ClearContents
Range("L384:O384").ClearContents
Range("R384:U384").ClearContents
Range("F386:O386").ClearContents
Range("R386:U386").ClearContents
Range("F388:O388").ClearContents
'Range("E390").ClearContents
Range("F391:M391").ClearContents
Range("P391:Q391").ClearContents
Range("T391:U391").ClearContents
Range("F393:U393").ClearContents
Range("F395:I395").ClearContents
Range("L395:O395").ClearContents
Range("R395:U395").ClearContents
Range("F397:O397").ClearContents
Range("R397:U397").ClearContents
Range("F399:O399").ClearContents
'Range("E401").ClearContents
Range("F402:M402").ClearContents
Range("P402:Q402").ClearContents
Range("T402:U402").ClearContents
Range("F404:U404").ClearContents
Range("F406:I406").ClearContents
Range("L406:O406").ClearContents
Range("R406:U406").ClearContents
Range("F408:O408").ClearContents
Range("R408:U408").ClearContents
Range("F410:O410").ClearContents
'Range("E412").ClearContents
Range("F413:M413").ClearContents
Range("P413:Q413").ClearContents
Range("T413:U413").ClearContents
Range("F415:U415").ClearContents
Range("F417:I417").ClearContents
Range("L417:O417").ClearContents
Range("R417:U417").ClearContents
Range("F419:O419").ClearContents
Range("R419:U419").ClearContents
Range("F421:O421").ClearContents
Range("D424").ClearContents
Range("D425").ClearContents
Range("D426").ClearContents
Range("D427").ClearContents
Range("D428").ClearContents
Range("F431:N431").ClearContents
Range("F433:N433").ClearContents
Range("F435:J435").ClearContents
Range("M435:U435").ClearContents
Range("F437:U437").ClearContents
Range("F439:U440").ClearContents
Range("F443:U445").ClearContents

Range("E476:J476,E478:J478,E480:H480,E482:J482,E484:J484,E486:J486,E488:H488,E490:J490,E493:J493,E494:J494,E495:J495,E497:G497,I497:J497,N497:P497,R497:U497,N495:S495,N494:S494,N493:S493,N490:U490,N488:Q488,N486:U486,N484:U484,N482:U482,N480:Q480,N478:U478").Select
Range("N476:U476,E476:J476,E478:J478,N478:U478").ClearContents
Range("E503:J503,E505:J505,E507:H507,E509:J509,E511:J511,E513:J513,E515:H515,E517:J517,E520:J520,E521:J521,E522:J522,E524:G524,I524:J524,N503:U503,N505:U505,N507:Q507,N509:U509,N511:U511,N513:U513,N515:Q515,N517:U517,N520:S520,N521:S521,N522:S522,N524:P524").ClearContents
Range("R524:U524,D547:D551,F566:U568").ClearContents

Range("F673:L673,F675:R675").ClearContents
Range("F686:L686,F688:L688,F690:U690,F692:U692,F694:U694,F696:L696,P696:U696,F698:L698,P698:U698,F701:R701,F703:L703,I711,F713:U713,F715:L715,P715:U715,F717:L717,P717:U717").ClearContents
Range("F723:L723,Q723:U723,F725:L725,F727:L727,F729:L729,F731:L731,F734:U736,F739:U741,F745:U747").ClearContents
'Range("F712:L712,Q712:U712,F714:L714,F716:L716,F718:L718,F720:L720,F723:U725").Select
'Range("F729:H729,F731:L731,F733:L733,F735:L735,F737:L737,F739:U741,F745:U747").Select



End Sub

Sub GM_NA_DCB()

Call UnPro
        If Range("F236").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(236, "M").Left, _
                                                Cells(236, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 236
                        .Display3DShading = True
                        .Name = "gg"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete

                    On Error GoTo 0
        End If
 '2
      If Range("F265").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg1").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(265, "M").Left, _
                                                Cells(265, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 265
                        .Display3DShading = True
                        .Name = "gg1"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg1").delete
                    ActiveSheet.CheckBoxes("gg1").delete
                    On Error GoTo 0
        End If
'3
      If Range("F287:L287").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg2").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(287, "M").Left, _
                                                Cells(287, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 287
                        .Display3DShading = True
                        .Name = "gg2"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg2").delete
                    ActiveSheet.CheckBoxes("gg2").delete
                    On Error GoTo 0
        End If

'4
      If Range("F311:L311").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg3").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(311, "M").Left, _
                                                Cells(311, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 311
                        .Display3DShading = True
                        .Name = "gg3"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg3").delete
                    ActiveSheet.CheckBoxes("gg3").delete
                    On Error GoTo 0
        End If

'5
      If Range("F173:L173").EntireRow.Hidden = False Then
                
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg4").delete
                    On Error GoTo 0
                    
                    ActiveSheet.CheckBoxes.Add(Cells(173, "M").Left, _
                                                Cells(173, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 173
                        .Display3DShading = True
                        .Name = "gg4"
                        .OnAction = "header_duns_checkbox_tick"
                    End With

        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg4").delete
                    ActiveSheet.CheckBoxes("gg4").delete
                    On Error GoTo 0
        End If


'Call Pro
End Sub
Sub GM_NA_Bank_plus_chkbx()

Range("A354:A367").EntireRow.Hidden = False
'Range("A546:A552").EntireRow.Hidden = False

'Range("A594:A674").EntireRow.Hidden = False


'1st bank
                    xrow = 366
                    ycolumn = "G"
                    Zlinked = ycolumn & xrow + 1
                    nname = "adbank"
                    oonaction = "GM_NA_additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'2nd bank
                    'xrow = 607
                    ycolumn = "J"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank2m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'3rd bank
                    'xrow = 607
                    ycolumn = "M"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank3m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With

'4th bank
                    'xrow = 607
                    ycolumn = "P"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "adbank4m"
                    'nname = "additional_bank_required_field"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'5th bank
                    'xrow = 607
                    ycolumn = "S"
                    Zlinked = ycolumn & xrow + 1
                    'oonaction = "additional_bank_required_field"
                    'nname = "adbank5n"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
'bank giro
     '               xrow = 335
      '              ycolumn = "N"
'                    Zlinked = ycolumn & xrow + 1
'                    oonaction = "runnothing"
                    'nname = "adbank5n"
                    
 '
  '                                      ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
   '                                                                 Cells(xrow, ycolumn).Top, _
    '                                                                80, 17).Select
     '                                   With Selection
      ''                                      .Caption = ""
        '                                    .Value = xlOff '
         '                                   .LinkedCell = Zlinked
          '                                  .Display3DShading = True
           '                         '        .lock = False
            '                                .Name = nname
             '                               .OnAction = oonaction
                                        
              '                    End With

'post giro
                    'xrow = 607
     '               ycolumn = "R"
      '              Zlinked = ycolumn & xrow + 1
       '             'oonaction = "additional_bank_required_field"
        '            'nname = "adbank5n"
         '
          '
           '                             ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
            '                                                        Cells(xrow, ycolumn).Top, _
             '                                                       80, 17).Select
              '                          With Selection
               '                             .Caption = ""
                '                            .Value = xlOff '
                 '                           .LinkedCell = Zlinked
                  '                          .Display3DShading = True
                   '                 '        .lock = False
                    '                        .Name = nname
                     '                       .OnAction = oonaction
                                        
                      '            End With
'
Range("F365").Select

End Sub





Sub incoterm_and_text_for_finance_vendors()

Call UnPro
If Range("K66").Value = True Then
'Range("F236").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
Range("O115").Value = ""
Range("O117").Value = ""
    With Range("O115:T115,O117:U117").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("O115:T115,O117:U117").Locked = True

'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("O115:T115,O117:U117").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O115:T115,O117:U117").Locked = False


    
End If
'Call Pro
End Sub

Sub GM_service_provider_us_nu()

'If Range("F67:H67").EntireRow.Hidden = flase Then

Call UnPro
Range("F67:H67").Value = ""
If Range("B67").Value = "US" Then

'to editable
    With Range("F67:H67").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F67:H67").Locked = False

Else

'non editable
    With Range("F67:H67").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    Range("F67:H67").Locked = True
    
End If

End Sub

Sub BAMAdd_additional_bank_for_change()

On Error Resume Next
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete
ActiveSheet.CheckBoxes("BAMAdd").delete

On Error GoTo 0

If Range("K43").Value = True Then

                    xrow = 499
                    ycolumn = "D"
                    Zlinked = ycolumn & xrow + 1
                    oonaction = "GM_NA_BAMAdd_Add"
                    nname = "BAMAdd"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(xrow, ycolumn).Left, _
                                                                    Cells(xrow, ycolumn).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Zlinked
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = nname
                                            .OnAction = oonaction
                                        
                                  End With
Range("E497").Select
Else
End If
End Sub


Sub GM_NA_BAMAdd_Add()
Call UnPro
If Range("D500").Value = True Then
Range("A501:A525").EntireRow.Hidden = False
Else
Range("A501:A525").EntireRow.Hidden = True
End If

Call Pro
End Sub


Sub ms()
        
        If Range("I711").Value = "" Then Exit Sub
        
        Call UnPro
        'If Range("I711").Value = "Yes" Then Range("A713:A720").EntireRow.Hidden = True
        
        If Range("I711").Value = "No" Then
        Range("A713:A720").EntireRow.Hidden = False
        Else
        Range("A713:A720").EntireRow.Hidden = True
        End If
        
        Call Pro

End Sub










Attribute VB_Name = "GM_NA_Validation_n_Submit"
Sub Kudhal_GM_NA()
'Exit Sub
Application.DisplayAlerts = False
'Application.UseSystemSeparators = False
'Application.ThousandsSeparator = ","
'Application.DecimalSeparator = "."

Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object
Dim aw As String
Dim gmnachk
Application.ScreenUpdating = False
Sheets("GM_NA").Activate
Call UnPro


Call format_condition_for_all_reasons_for_mandatory_field

'header
If Range("F10:L10").EntireRow.Hidden = False And Range("F10").Value = "" Then gmnachk = "failed"
If Range("F14:L14").EntireRow.Hidden = False And Range("F14").Value = "" Then gmnachk = "failed"
If Range("Q18:U18").EntireRow.Hidden = False And Range("Q18").Value = "" Then gmnachk = "failed"
If Range("F20:L20").EntireRow.Hidden = False And Range("F20").Value = "" Then gmnachk = "failed"

If Sheets("GM_NA").Range("q18").Value = "New Duns creation" Then
'new creation
If Range("B65").EntireRow.Hidden = False And Range("B65").Value = "" Then gmnachk = "failed"
If Range("E115:F115").EntireRow.Hidden = False And Range("E115").Value = "" Then gmnachk = "failed"
If Range("J115:M115").EntireRow.Hidden = False And Range("J115").Value = "" Then gmnachk = "failed"
If Range("V115").EntireRow.Hidden = False And Range("V115").Value = "" Then gmnachk = "failed"
If Range("E117:L117").EntireRow.Hidden = False And Range("E117").Value = "" Then gmnachk = "failed"
If Range("F236:L236").EntireRow.Hidden = False And Range("F236").Value = "" Then gmnachk = "failed"
If Range("F239:U239").EntireRow.Hidden = False And Range("F239").Value = "" Then gmnachk = "failed"
If Range("F243:U243").EntireRow.Hidden = False And Range("F243").Value = "" Then gmnachk = "failed"
If Range("F245:J245").EntireRow.Hidden = False And Range("F245").Value = "" Then gmnachk = "failed"

If Range("M245:P245").EntireRow.Hidden = False And Range("M245").Value = "" Then gmnachk = "failed"
If Range("R245:U245").EntireRow.Hidden = False And Range("R245").Value = "" Then gmnachk = "failed"


If Range("F249:J249").EntireRow.Hidden = False And Range("F249").Value = "" Then gmnachk = "failed"
If Range("B255").EntireRow.Hidden = False And Range("B255").Value = "" Then gmnachk = "failed"
If Range("B257").EntireRow.Hidden = False And Range("B257").Value = "" Then gmnachk = "failed"
If Range("F265:L265").EntireRow.Hidden = False And Range("F265").Value = "" Then gmnachk = "failed"
If Range("F268:U268").EntireRow.Hidden = False And Range("F268").Value = "" Then gmnachk = "failed"
If Range("F280:U280").EntireRow.Hidden = False And Range("F280").Value = "" Then gmnachk = "failed"
If Range("F282:L282").EntireRow.Hidden = False And Range("F282").Value = "" Then gmnachk = "failed"
If Range("F287:L287").EntireRow.Hidden = False And Range("F287").Value = "" Then gmnachk = "failed"
If Range("F290:U290").EntireRow.Hidden = False And Range("F290").Value = "" Then gmnachk = "failed"
If Range("F304:U304").EntireRow.Hidden = False And Range("F304").Value = "" Then gmnachk = "failed"
If Range("F311:L311").EntireRow.Hidden = False And Range("F311").Value = "" Then gmnachk = "failed"
If Range("F314:U314").EntireRow.Hidden = False And Range("F314").Value = "" Then gmnachk = "failed"
If Range("F316:U316").EntireRow.Hidden = False And Range("F316").Value = "" Then gmnachk = "failed"
If Range("F318:J318").EntireRow.Hidden = False And Range("F318").Value = "" Then gmnachk = "failed"
If Range("M318:U318").EntireRow.Hidden = False And Range("M318").Value = "" Then gmnachk = "failed"
If Range("F322:J322").EntireRow.Hidden = False And Range("F322").Value = "" Then gmnachk = "failed"
If Range("B352").EntireRow.Hidden = False And Range("B352").Value = "" Then gmnachk = "failed"
If Range("F357:M357").EntireRow.Hidden = False And Range("F357").Value = "" Then gmnachk = "failed"
If Range("P357:Q357").EntireRow.Hidden = False And Range("P357").Value = "" Then gmnachk = "failed"
If Range("F361:I361").EntireRow.Hidden = False And Range("F361").Value = "" Then gmnachk = "failed"
If Range("B363").EntireRow.Hidden = False And Range("B363").Value = "" Then gmnachk = "failed"
If Range("B364").EntireRow.Hidden = False And Range("B364").Value = "" Then gmnachk = "failed"
If Range("B375").EntireRow.Hidden = False And Range("B375").Value = "" Then gmnachk = "failed"
If Range("B376").EntireRow.Hidden = False And Range("B376").Value = "" Then gmnachk = "failed"
If Range("B386").EntireRow.Hidden = False And Range("B386").Value = "" Then gmnachk = "failed"
If Range("B387").EntireRow.Hidden = False And Range("B387").Value = "" Then gmnachk = "failed"
If Range("B397").EntireRow.Hidden = False And Range("B397").Value = "" Then gmnachk = "failed"
If Range("B398").EntireRow.Hidden = False And Range("B398").Value = "" Then gmnachk = "failed"
If Range("B408").EntireRow.Hidden = False And Range("B408").Value = "" Then gmnachk = "failed"
If Range("B409").EntireRow.Hidden = False And Range("B409").Value = "" Then gmnachk = "failed"
If Range("B419").EntireRow.Hidden = False And Range("B419").Value = "" Then gmnachk = "failed"
If Range("B420").EntireRow.Hidden = False And Range("B420").Value = "" Then gmnachk = "failed"
If Range("B547").EntireRow.Hidden = False And Range("B547").Value = "" Then gmnachk = "failed"

If Range("B251").EntireRow.Hidden = False And Range("B251").Value = "" Then gmnachk = "failed"


Else
End If


'Name / Address modification
If Sheets("GM_NA").Range("q18").Value = "Name / Address modification" Then

If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
If Range("F575:L575").EntireRow.Hidden = False And Range("F575").Value = "" Then gmnachk = "failed"
If Range("F578:U578").EntireRow.Hidden = False And Range("F578").Value = "" Then gmnachk = "failed"
If Range("F580:U580").EntireRow.Hidden = False And Range("F580").Value = "" Then gmnachk = "failed"
If Range("F582:L582").EntireRow.Hidden = False And Range("F582").Value = "" Then gmnachk = "failed"
If Range("F584:U584").EntireRow.Hidden = False And Range("F584").Value = "" Then gmnachk = "failed"
If Range("F586:U586").EntireRow.Hidden = False And Range("F586").Value = "" Then gmnachk = "failed"
If Range("F590:U590").EntireRow.Hidden = False And Range("F590").Value = "" Then gmnachk = "failed"
If Range("F592:U592").EntireRow.Hidden = False And Range("F592").Value = "" Then gmnachk = "failed"

Else
End If

'Alternative Payee/Factoring Setup
If Sheets("GM_NA").Range("q18").Value = "Alternative Payee/Factoring Setup" Then

If Range("F173:L173").EntireRow.Hidden = False And Range("F173").Value = "" Then gmnachk = "failed"
If Range("F176:U176").EntireRow.Hidden = False And Range("F176").Value = "" Then gmnachk = "failed"
If Range("F178:U178").EntireRow.Hidden = False And Range("F178").Value = "" Then gmnachk = "failed"
If Range("F180:L180").EntireRow.Hidden = False And Range("F180").Value = "" Then gmnachk = "failed"
If Range("F182:U182").EntireRow.Hidden = False And Range("F182").Value = "" Then gmnachk = "failed"
If Range("F184:U184").EntireRow.Hidden = False And Range("F184").Value = "" Then gmnachk = "failed"
If Range("F188:U188").EntireRow.Hidden = False And Range("F188").Value = "" Then gmnachk = "failed"
If Range("F190:U190").EntireRow.Hidden = False And Range("F190").Value = "" Then gmnachk = "failed"
If Range("F236:L236").EntireRow.Hidden = False And Range("F236").Value = "" Then gmnachk = "failed"
If Range("F239:U239").EntireRow.Hidden = False And Range("F239").Value = "" Then gmnachk = "failed"
If Range("F243:U243").EntireRow.Hidden = False And Range("F243").Value = "" Then gmnachk = "failed"
If Range("F245:J245").EntireRow.Hidden = False And Range("F245").Value = "" Then gmnachk = "failed"
'If Range("M245:U245").EntireRow.Hidden = False And Range("M245").Value = "" Then gmnachk = "failed"

If Range("M245:P245").EntireRow.Hidden = False And Range("M245").Value = "" Then gmnachk = "failed"
If Range("R245:U245").EntireRow.Hidden = False And Range("R245").Value = "" Then gmnachk = "failed"


If Range("F249:J249").EntireRow.Hidden = False And Range("F249").Value = "" Then gmnachk = "failed"
If Range("B253").EntireRow.Hidden = False And Range("B253").Value = "" Then gmnachk = "failed"
If Range("B352").EntireRow.Hidden = False And Range("B352").Value = "" Then gmnachk = "failed"
If Range("F357:M357").EntireRow.Hidden = False And Range("F357").Value = "" Then gmnachk = "failed"
If Range("P357:Q357").EntireRow.Hidden = False And Range("P357").Value = "" Then gmnachk = "failed"
If Range("F361:I361").EntireRow.Hidden = False And Range("F361").Value = "" Then gmnachk = "failed"
If Range("B363").EntireRow.Hidden = False And Range("B363").Value = "" Then gmnachk = "failed"
If Range("B364").EntireRow.Hidden = False And Range("B364").Value = "" Then gmnachk = "failed"
If Range("B375").EntireRow.Hidden = False And Range("B375").Value = "" Then gmnachk = "failed"
If Range("B376").EntireRow.Hidden = False And Range("B376").Value = "" Then gmnachk = "failed"
If Range("B386").EntireRow.Hidden = False And Range("B386").Value = "" Then gmnachk = "failed"
If Range("B387").EntireRow.Hidden = False And Range("B387").Value = "" Then gmnachk = "failed"
If Range("B397").EntireRow.Hidden = False And Range("B397").Value = "" Then gmnachk = "failed"
If Range("B398").EntireRow.Hidden = False And Range("B398").Value = "" Then gmnachk = "failed"
If Range("B408").EntireRow.Hidden = False And Range("B408").Value = "" Then gmnachk = "failed"
If Range("B409").EntireRow.Hidden = False And Range("B409").Value = "" Then gmnachk = "failed"
If Range("B419").EntireRow.Hidden = False And Range("B419").Value = "" Then gmnachk = "failed"
Else
End If

'Bank Account Maintenance
If Sheets("GM_NA").Range("q18").Value = "Bank Account Maintenance" Then

If Range("F25:I25").EntireRow.Hidden = False And Range("F25").Value = "" Then gmnachk = "failed"
If Range("F27:U27").EntireRow.Hidden = False And Range("F27").Value = "" Then gmnachk = "failed"
If Range("F29:U29").EntireRow.Hidden = False And Range("F29").Value = "" Then gmnachk = "failed"
If Range("F31:L31").EntireRow.Hidden = False And Range("F31").Value = "" Then gmnachk = "failed"
If Range("Q31:U31").EntireRow.Hidden = False And Range("Q31").Value = "" Then gmnachk = "failed"
If Range("F33:U33").EntireRow.Hidden = False And Range("F33").Value = "" Then gmnachk = "failed"
If Range("F357:M357").EntireRow.Hidden = False And Range("F357").Value = "" Then gmnachk = "failed"

If Range("P357:Q357").EntireRow.Hidden = False And Range("P357").Value = "" Then gmnachk = "failed"
If Range("F361:I361").EntireRow.Hidden = False And Range("F361").Value = "" Then gmnachk = "failed"
If Range("B363").EntireRow.Hidden = False And Range("B363").Value = "" Then gmnachk = "failed"
If Range("B364").EntireRow.Hidden = False And Range("B364").Value = "" Then gmnachk = "failed"
If Range("B375").EntireRow.Hidden = False And Range("B375").Value = "" Then gmnachk = "failed"
If Range("B376").EntireRow.Hidden = False And Range("B376").Value = "" Then gmnachk = "failed"
If Range("B386").EntireRow.Hidden = False And Range("B386").Value = "" Then gmnachk = "failed"
If Range("B387").EntireRow.Hidden = False And Range("B387").Value = "" Then gmnachk = "failed"
If Range("B397").EntireRow.Hidden = False And Range("B397").Value = "" Then gmnachk = "failed"
If Range("B398").EntireRow.Hidden = False And Range("B398").Value = "" Then gmnachk = "failed"
If Range("B408").EntireRow.Hidden = False And Range("B408").Value = "" Then gmnachk = "failed"
If Range("B409").EntireRow.Hidden = False And Range("B409").Value = "" Then gmnachk = "failed"
If Range("B419").EntireRow.Hidden = False And Range("B419").Value = "" Then gmnachk = "failed"
If Range("B482").EntireRow.Hidden = False And Range("B482").Value = "" Then gmnachk = "failed"
If Range("B483").EntireRow.Hidden = False And Range("B483").Value = "" Then gmnachk = "failed"
If Range("B497").EntireRow.Hidden = False And Range("B497").Value = "" Then gmnachk = "failed"
If Range("B498").EntireRow.Hidden = False And Range("B498").Value = "" Then gmnachk = "failed"
If Range("E490:J490").EntireRow.Hidden = False And Range("E490").Value = "" Then gmnachk = "failed"
If Range("N490:U490").EntireRow.Hidden = False And Range("N490").Value = "" Then gmnachk = "failed"
If Range("N480:Q480").EntireRow.Hidden = False And Range("N480").Value = "" Then gmnachk = "failed"
If Range("N476:U476").EntireRow.Hidden = False And Range("N476").Value = "" Then gmnachk = "failed"
If Range("B509").EntireRow.Hidden = False And Range("B509").Value = "" Then gmnachk = "failed"
If Range("B510").EntireRow.Hidden = False And Range("B510").Value = "" Then gmnachk = "failed"
If Range("B524").EntireRow.Hidden = False And Range("B524").Value = "" Then gmnachk = "failed"
If Range("B525").EntireRow.Hidden = False And Range("B525").Value = "" Then gmnachk = "failed"
If Range("N503:U503").EntireRow.Hidden = False And Range("N503").Value = "" Then gmnachk = "failed"
If Range("N507:Q507").EntireRow.Hidden = False And Range("N507").Value = "" Then gmnachk = "failed"
If Range("N517:U517").EntireRow.Hidden = False And Range("N517").Value = "" Then gmnachk = "failed"
If Range("E517:J517").EntireRow.Hidden = False And Range("E517").Value = "" Then gmnachk = "failed"
If Range("B547").EntireRow.Hidden = False And Range("B547").Value = "" Then gmnachk = "failed"

Else
End If

'Contact Details Modification
If Sheets("GM_NA").Range("q18").Value = "Contact Details Modification" Then
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
If Range("B543").EntireRow.Hidden = False And Range("B543").Value = "" Then gmnachk = "failed"
If Range("B554").EntireRow.Hidden = False And Range("B554").Value = "" Then gmnachk = "failed"
Else
End If


'Extend to New Business Unit/Company Code
If Sheets("GM_NA").Range("q18").Value = "Extend to New Business Unit/Company Code" Then
If Range("F154:I154").EntireRow.Hidden = False And Range("F154").Value = "" Then gmnachk = "failed"
If Range("F156:L156").EntireRow.Hidden = False And Range("F156").Value = "" Then gmnachk = "failed"
If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
Else
End If

'Inactivation/Mark for Deletion
If Sheets("GM_NA").Range("q18").Value = "Inactivation/Mark for Deletion" Then
If Range("F140:L140").EntireRow.Hidden = False And Range("F140").Value = "" Then gmnachk = "failed"
If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F220:U220").EntireRow.Hidden = False And Range("F220").Value = "" Then gmnachk = "failed"
If Range("F222:L222").EntireRow.Hidden = False And Range("F222").Value = "" Then gmnachk = "failed"
If Range("F224:U224").EntireRow.Hidden = False And Range("F224").Value = "" Then gmnachk = "failed"
If Range("F226:U226").EntireRow.Hidden = False And Range("F226").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Mass changes" Then
'Mass changes
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Modify Payment Method" Then
'Modify Payment Method
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
If Range("F133:L133").EntireRow.Hidden = False And Range("F133").Value = "" Then gmnachk = "failed"
If Range("P133:U133").EntireRow.Hidden = False And Range("P133").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Modify Payment Terms" Then
'Modify Payment Terms
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
If Range("F126:L126").EntireRow.Hidden = False And Range("F126").Value = "" Then gmnachk = "failed"
If Range("P126:U126").EntireRow.Hidden = False And Range("P126").Value = "" Then gmnachk = "failed"
If Range("B128").EntireRow.Hidden = False And Range("B128").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Payment/Posting/Purchasing Block or Unblock" Then
'Payment/Posting/Purchasing Block or Unblock
If Range("F215:L215").EntireRow.Hidden = False And Range("F215").Value = "" Then gmnachk = "failed"
If Range("F218:U218").EntireRow.Hidden = False And Range("F218").Value = "" Then gmnachk = "failed"
If Range("F529:L529").EntireRow.Hidden = False And Range("F529").Value = "" Then gmnachk = "failed"
Else
End If

If Sheets("GM_NA").Range("q18").Value = "Others - enter Details in Comments column" Then
'Others - enter Details in Comments column
If Range("F121:U121").EntireRow.Hidden = False And Range("F121").Value = "" Then gmnachk = "failed"
If Range("F123:U123").EntireRow.Hidden = False And Range("F123").Value = "" Then gmnachk = "failed"
Else
End If


'CSIDS mandatory check
If Range("F675").EntireRow.Hidden = False And Range("F675").Value = "" Then gmnachk = "failed"
If Range("F690").EntireRow.Hidden = False And Range("F690").Value = "" Then gmnachk = "failed"
If Range("F694").EntireRow.Hidden = False And Range("F694").Value = "" Then gmnachk = "failed"
If Range("F696").EntireRow.Hidden = False And Range("F696").Value = "" Then gmnachk = "failed"
If Range("P696").EntireRow.Hidden = False And Range("P696").Value = "" Then gmnachk = "failed"
If Range("F698").EntireRow.Hidden = False And Range("F698").Value = "" Then gmnachk = "failed"
If Range("P698").EntireRow.Hidden = False And Range("P698").Value = "" Then gmnachk = "failed"
If Range("F703").EntireRow.Hidden = False And Range("F703").Value = "" Then gmnachk = "failed"
If Range("V686").EntireRow.Hidden = False And Range("V686").Value = False Then gmnachk = "failed"

If gmnachk = "failed" Then 'MsgBox gmnachk
MsgBox "Validation has been failed since some required fields are missed to update!" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"
Call Pro
Exit Sub
Else
End If


     If Sheets("GM_NA").Range("F20").Value = "See GM Units Multiple Business Units Tab" And Sheets("GM_NA_Multiple_BU").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'GM_NA_Multiple_BU'", vbExclamation, "Required Entry"
     MsgBox "you have selected " & Sheets("GM_NA_Multiple_BU").Range("f1").Value & " GM BU"
     Exit Sub
     End If
     
     If Sheets("GM_NA").Range("U20").Value <> "" And Sheets("GM_NA_Multiple_BU").Range("f1").Value <> 0 Then
     Sheets("GM_NA_Multiple_BU").Visible = True
     Sheets("GM_NA_Multiple_BU").Select
     er = Range("e2").End(xlDown).Row
     Range("a2:F5000").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$F$5100").AutoFilter Field:=4, Criteria1:="TRUE"
    End If
    
    If MsgBox("Validation has been completed succesfully" & vbNewLine & "All required fields are updated properly and preparing for submit..!", vbOKCancel + vbDefaultButton2, "Please confirm submition") = vbCancel Then
    'Do you want to submit this form now
    Exit Sub
    Call Pro
    End If
     ActiveWorkbook.Save
     Application.ScreenUpdating = False

If Sheets("GM_NA").Range("q18").Value = "New Duns creation" Then
If MsgBox("Are you a Supplier?", vbYesNo, Validation) = vbYes Then
MsgBox "Please send back this updated form to GM rather than sending it to Master Data, Since Master Data does not accept New Creation request directly from Supplier"
Call Pro
Exit Sub
Else
End If
End If


     'unhiding all sheets
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
     'Sheets("GM_NA").Move Before:=Sheets(1)
   'Sheets("GM_NA_Multiple_BU").Move Before:=Sheets(2)
        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub


subm = ThisWorkbook.Sheets("GM_NA").Range("Q18").Value
DUN = Range("F25").Value & Range("F38").Value & Range("F121").Value & Range("F173").Value & Range("F215").Value & Range("F236").Value & Range("F265").Value & Range("F287").Value & Range("F311").Value & Range("F333").Value & Range("F575").Value
SUP = Range("F27").Value & Range("F40").Value & Range("F123").Value & Range("F176").Value & Range("F197").Value & Range("F218").Value & Range("F239").Value & Range("F268").Value & Range("F290").Value & Range("F314").Value & Range("F336").Value & Range("F578").Value

subj = subm & "-" & DUN & "-" & SUP


            WkbName = subj 'Range("q18").Value & " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array("<", ">", "|", "/", "*", "[", "]", "{", "}", "-", "\", "?", """")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName = Replace(WkbName, MyArray(x), "_", 1)
            Next x
            'MsgBox WkbName
        
            WkbName_first = mypath 'Range("I9").Value '& " " & Range("F121").Value & " " & Range("F123").Value & " " & Range("F10").Value
            MyArray = Array(".xls", "xlsx")
            For x = LBound(MyArray) To UBound(MyArray)
                WkbName_first = Replace(WkbName_first, MyArray(x), "_", 1)
            Next x



'aw = Application.ActiveWorkbook.Path & "\"
   'tb = InputBox("give the file name", , any_Name)
 '  ta = tb & ".xls" '".pdf"
  ' tt = aw & ta
  pbn = ActiveWorkbook.Name
  
   Sheets(Array("GM_NA_Multiple_BU", "Mass change")).Select
  ActiveWindow.SelectedSheets.Copy
  cbn = ActiveWorkbook.Name
  
  ActiveWorkbook.Sheets.Add Before:=Worksheets(1) ', Count:=3
  
  'sheets("Sheet
  'ActiveWorkbook.Worksheets.Add
  ActiveSheet.Name = "Form"
  
    'ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
    'ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"

  
  On Error GoTo 0
  Windows(pbn).Activate
  Sheets("GM_NA").Select
  Call UnPro
  'Range("A1:V3327").Select
'Selection.Copy
'Selection.SpecialCells(xlCellTypeVisible).Copy
'Range("A1:V3327")

''''''''''''''''''''''''''''''''''''

Range("W1:W3326").ClearContents
    Range("W1:W3326").SpecialCells(xlCellTypeVisible).FormulaR1C1 = "UN"
    Cells.Copy
    
Windows(cbn).Activate
Sheets("Form").Select
Range("A1").Select

'    Windows.Add
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveSheet.Paste

       ' Range("A1:W1").Insert Shift:=xlDown
''''    Range("A1:W1").FormulaR1C1 = " "
       ' Range("A1").Select
       ' Selection.AutoFilter
    
        Range("$A$1:$W$3379").Select
        Selection.AutoFilter
        ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, Criteria1:="<>"
    
     '   Selection.AutoFilter , VisibleDropDown:=False
       ' ActiveSheet.Range("$A$1:$W$3379").AutoFilter Field:=23, VisibleDropDown:=False, Criteria1:="<>"
        ActiveWindow.ScrollRow = 1
        
        Selection.AutoFilter Field:=1, VisibleDropDown:=False
        Selection.AutoFilter Field:=22, VisibleDropDown:=False
     '   Selection.AutoFilter Field:=23, VisibleDropDown:=False
    '
      '  Range("W1").Select
''''    Do
''''    If ActiveCell.Value = "UN" Then ActiveCell.EntireRow.Hidden = False Else ActiveCell.EntireRow.Hidden = True
''''    ActiveCell.Offset(1, 0).Select
''''    If ActiveCell.Row >= 3379 Then Exit Do
''''
''''    Loop

    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Application.DisplayFormulaBar = False
    Range("A1").Select
    
    On Error Resume Next
    If Range("B1").Value = "" Then Range("A1").EntireRow.Hidden = True
    On Error GoTo 0
''''''''''''''''''''''''''''''''''''

'ActiveSheet.Paste
Range("A1").Select
Cells.FormatConditions.delete

           On Error Resume Next

'deleting irrelevent sheets from product
    If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then Else Sheets("GM_NA_Multiple_BU").delete
    If Sheets("Form").Range("Q18").Value = "Mass changes" Then Else Sheets("Mass change").delete
        ' '========================
            On Error GoTo 0
            


        
        ActiveWorkbook.SaveAs (WkbName_first & " " & WkbName & ".xls"), FileFormat:=51

'deleting unselected rows from GM multiple BU
If Sheets("Form").Range("F20").Value = "See GM Units Multiple Business Units Tab" Then '!!!
        Sheets("GM_NA_Multiple_BU").Select
        Call UnPro
        If ActiveSheet.Name = "GM_NA_Multiple_BU" Then '!!
        
                Range("C7").Select
                Do
                On Error GoTo ivd
                If ActiveCell.Value = "" Then Exit Do
                If ActiveCell.Value = False Then
                ActiveCell.EntireRow.delete
                Else
                ActiveCell.Offset(1, 0).Select
                End If
                Loop
ivd:
On Error GoTo 0
        Range("A1:A5").EntireRow.delete
        Range("A1").Select
        On Error Resume Next
        ActiveSheet.DrawingObjects("CheckEU1").Visible = False
        
        
                Range(Range("B1048570").End(xlUp).Offset(1, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                Selection.EntireRow.Hidden = False
                Range(Range("B1048570").End(xlUp).Offset(2, 0), Range("B1048570").End(xlUp).Offset(2, 0).End(xlDown)).Select '.EntireRow.Hidden = True
                On Error Resume Next
'                Selection.EntireRow.Hidden = True
                'On Error GoTo 0
                Dim s As Shape
                On Error Resume Next
                For Each s In ActiveSheet.Shapes
                
                s.OnAction = ""
                Next
                On Error GoTo 0
'''        ActiveSheet.Shapes.Visible = False
''        ActiveSheet.Shapes.SelectAll
''        Selection.ShapeRange.Visible = False
        On Error GoTo 0
        Call Pro
        Else '!!
        End If '!!
Else '!!!
End If '!!!
        'also you can give like left 10000 nos to eliminate xls from my path
        Sheets(1).Select
        

        
        'write here to alter form copy
   '         On Error Resume Next
'            ActiveSheet.DrawingObjects.Visible = False
           ' ActiveSheet.DrawingObjects.Delete
 '           ActiveSheet.DrawingObjects.Hide
  '          On Error GoTo 0
''    Call UnPro
''    Range("A1").Select
''    On Error Resume Next
       ActiveWindow.SmallScroll up:=1000000
''          ActiveSheet.Shapes.Range(Array("Group 5", "CommandButton1", "CommandButton2", "CommandButton3", "CommandButton4", "submit")).Delete
''Range("a1:V3336").Locked = True
'''Range("Q3331").ClearContents
'Application.ScreenUpdating = False
  On Error GoTo 0

On Error Resume Next

ActiveSheet.Shapes.SelectAll
'ActiveSheet.Shapes.OnAction = "nidhi"
Selection.OnAction = ""


'xxx
'On Error Resume Next
'For Each s In ActiveSheet.Shapes
's.OnAction = ""
'Next

On Error Resume Next

        If ActiveSheet.Name = "Form" Then Range("F20:L20").Locked = True
        If ActiveSheet.Name = "Form" Then Range("F10:L10").Locked = True
        Range("F21:N21").ClearContents
        
    On Error GoTo 0
    

    
    
    Call Pro
       '     ActiveSheet.DrawingObjects.Visible = False
            
            
        ActiveWorkbook.UpdateLinks = xlUpdateLinksNever
        
        'added for one mail project
        ActiveWorkbook.BuiltinDocumentProperties("Keywords").Value = "GBS_Form"
        ActiveWorkbook.BuiltinDocumentProperties("Category").Value = "GBS_Vdrf"
        Sheets("Form").Select
        ActiveSheet.Name = "Form_GBS"
        ActiveWorkbook.Save
        
        ffname = ActiveWorkbook.FullName
        fname = ActiveWorkbook.Name
        
        
        ActiveWorkbook.Close
        'MsgBox " Request Copy Has Been Saved as " & fname
        ' '============================
        tt1 = ffname
        
  '  .ExportAsFixedFormat Type:=xlTypexls, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  'End With
   
  
  
  
'''abu added=======================================================================================
''                 'Sheets("ORD").Select (False)
''                  'Sheets("Standardchanges").Select (False)
''                  ActiveWindow.SelectedSheets.Copy
''
''                  Application.StatusBar = False
''
''                    Dim appXL As New Excel.Application
''    Dim MyDate
''    MyDate = Date    ' MyDate contains the current system date.
''    Dim MyTime
''    MyTime = Time    ' Return current system time.
''    Dim TestStr As String
''    TestStr = Format(MyTime, "hh.mm.ss")
''    Dim Test1Str As String
''    Test1Str = Format(MyDate, "DD-MM-YYYY")
''
''    Application.DisplayAlerts = False
''    'MsgBox ActiveWorkbook.Name
''
''    ActiveWorkbook.SaveAs Filename:="C:\STD Changes\Bank\" & ree & " " & Test1Str & " " & TestStr & " " & ".xlsx" 'ActiveWorkbook.name
''    'ActiveWorkbook.SaveAs Filename:="C:\Std Changes\RAW DATA\" & "Test"
''    ActiveWorkbook.Save
''    bn = ActiveWorkbook.FullName
'''abu added=====================================================================================
  ' Call page

'Next i
'Else
Windows(pbn).Activate

Sheets("GM_NA").Select
Range("A1").Select
Call UnPro

If UserForm3.OptionButton1.Value = True Then

Set rng = Nothing

Set rng = Sheets("GM_NA").Range("B9:v21").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

subm = ThisWorkbook.Sheets("GM_NA").Range("Q18").Value

DUN = Range("F25").Value & Range("F38").Value & Range("F121").Value & Range("F173").Value & Range("F215").Value & Range("F236").Value & Range("F265").Value & Range("F287").Value & Range("F311").Value & Range("F333").Value & Range("F575").Value
'''
'''If ThisWorkbook.Sheets("GM_NA").Range("F25").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f26").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f38").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f38").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f121").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f121").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f215").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f215").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f236").Value = "Conduent will Initiate DUNS Assignment process" Then
'''DUN = "No DUNS"
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f236").Value <> Empty Then
'''DUN = ThisWorkbook.Sheets("GM_NA").Range("f236").Value
'''End If

'''If ThisWorkbook.Sheets("GM_NA").Range("f28").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f28").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f40").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f40").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f123").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f123").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f218").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f218").Value
'''ElseIf ThisWorkbook.Sheets("GM_NA").Range("f239").Value <> Empty Then
'''SUP = ThisWorkbook.Sheets("GM_NA").Range("f239").Value
'''End If

SUP = Range("F27").Value & Range("F40").Value & Range("F123").Value & Range("F176").Value & Range("F197").Value & Range("F218").Value & Range("F239").Value & Range("F268").Value & Range("F290").Value & Range("F314").Value & Range("F336").Value & Range("F578").Value

subj = subm & "-" & DUN & "-" & SUP

If Range("Q18").Value = "Bank Account Maintenance" Then
GMB = "VNAEFTDesk@conduent.com"
Else



    If Range("Q18").Value = "New Duns creation" Then
    
        If Range("E66").Value = True Or Range("H66").Value = True Or Range("P66").Value = True Then
        GMB = "OPSVendorMaster@conduent.com"
        Else
        GMB = "VNAAddlink@conduent.com"
        End If
    
    Else
    
    GMB = "OPSVendorMaster@ conduent.com"
    
    
    
    End If
End If


If Range("Q18").Value = "GPS/CCA/Logistics Request" Then GMB = "VNAAddlink@conduent.com"

With OutMail
    .To = GMB & ";" & Range("F14").Value
    .cc = Range("Q14").Value
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
'    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
'  If Sheets("GM_NA").Range("U20").Value <> "" And Sheets("GM_NA_Multiple_BU").Range("f1").Value <> 0 Then
'  Sheets("GM_NA_Multiple_BU").Select
'  Range("A1").Select
'  Selection.AutoFilter
 ' End If
 
 Else
'        If ActiveSheet.OptionButton2.Value = True Then MsgBox "Form has been saved in the below Directory " _
'        & vbNewLine & vbNewLine & vbNewLine & ffname
    'If UserForm3.OptionButton2.Value = True Then
    MsgBox "Form has been saved in the below Directory " & vbNewLine & vbNewLine & vbNewLine & ffname
    MsgBox "Finished..!", vbInformation
    Exit Sub
  
 End If
       For I = 3 To Sheets.Count
     'Sheets(I).Visible = 2
     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM_NA").Visible = True
     Sheets("GM_NA").Select
     Call Pro
     Application.ScreenUpdating = True
     MsgBox "Finished..!", vbInformation
     Application.DisplayAlerts = True

Application.UseSystemSeparators = True

End Sub


Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM_NA").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function


Attribute VB_Name = "GM_NA_mandatory_fiel"
Sub format_condition_for_all_reasons_for_mandatory_field()

    Call UnPro
    Cells.FormatConditions.delete
    
    'new creation#################################################################

'new creation
Range("F10:L10,F14:L14,Q18:U18,F20:L20").Select
Call if_selected_cell_blank_conditional_format

Range("E70:F70").Select
Call if_selected_cell_blank_conditional_format


Range("F361:I361,F373:I373,F384:I384,F406:I406,F417:I417,F395:I395").Select
Call if_selected_cell_blank_conditional_format

Range("F316:U316,F318:J318,M318:U318,F322:J322").Select
Call if_selected_cell_blank_conditional_format

Range("F243:U243,F245:J245,M245:P245,R245:U245,F249:J249").Select
Call if_selected_cell_blank_conditional_format

Range("E115:F115,J115:M115,E117:L117").Select
Call if_selected_cell_blank_conditional_format

Range("P369:Q369,P380:Q380,P391:Q391,P402:Q402,P413:Q413,P357:Q357").Select
Call if_selected_cell_blank_conditional_format

Range("F236:L236,F239:U239").Select
Call if_selected_cell_blank_conditional_format

Range("F265:L265,F268:U268,F282:L282,F280:U280,F287:L287,F290:U290,F304:U304,F311:L311,F314:U314,F357:M357").Select
Call if_selected_cell_blank_conditional_format

Range("F369:M369,F380:M380,F391:M391,F402:M402,F413:M413").Select
Call if_selected_cell_blank_conditional_format

'inco term mandatory field

    Range("O115:T115").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$V$115="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'if supplied from canada then tax numkber is mandatory

    Range("F251:J251").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$251="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    'Select the appropriate vendor category
''''        'Range("G64").FormulaR1C1 = "=COUNTIF(R[2]C[-4]:R[2]C[14],TRUE)"
''''        Range("C65:V65").FormatConditions.Add Type:=xlExpression, Formula1:="=$G$64=0"
''''        Range("C65:V65").FormatConditions(Range("C65:V65").FormatConditions.Count).SetFirstPriority
''''        With Range("C65:V65").FormatConditions(1).Interior
''''            .PatternColorIndex = xlAutomatic
''''            .Color = 65535
''''            .TintAndShade = 0
''''        End With
''''        Range("C65:V65").FormatConditions(1).StopIfTrue = False
    
    Range("D65:V65").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$65="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


    'purchase email id finance email id
        'Range("B253").FormulaR1C1 = "=RC[4]&R[2]C[4]"
        
        
    Range("F253:N253").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$255="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    Range("F255:N255").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$257="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
        
'''        Range("F255:N255,F253:N253").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$253="""""
'''        Range("F255:N255,F253:N253").FormatConditions(Range("F255:N255,F253:N253").FormatConditions.Count).SetFirstPriority
'''        With Range("F255:N255,F253:N253").FormatConditions(1).Interior
'''            .PatternColorIndex = xlAutomatic
'''            .Color = 65535
'''            .TintAndShade = 0
'''        End With
'''        Range("F255:N255,F253:N253").FormatConditions(1).StopIfTrue = False



    
    'Select if Payment through EFT mode or Select if Payment through check mode
    
        'Range("B352").FormulaR1C1 = "=COUNTIF(R[1]C[2]:R[1]C[15],TRUE)"

    Range("D352:O352").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$352="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'''            Range("D352:O352").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$352=0"
'''            Range("D352:O352").FormatConditions(Range("D352:O352").FormatConditions.Count).SetFirstPriority
'''            With Range("D352:O352").FormatConditions(1).Interior
'''                .PatternColorIndex = xlAutomatic
'''                .Color = 65535
'''                .TintAndShade = 0
'''            End With
'''            Range("D352:O352").FormatConditions(1).StopIfTrue = False
    
    'documents to confirm the bank account details provided above.
    
        'Range("B547").FormulaR1C1 = "=RC[2]&R[1]C[2]&R[2]C[2]&R[3]C[2]&R[4]C[2]"
        Range("D547:D551").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$547="""""
        Range("D547:D551").FormatConditions(Range("D547:D551").FormatConditions.Count).SetFirstPriority
        With Range("D547:D551").FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 65535
            .TintAndShade = 0
        End With
        Range("D547:D551").FormatConditions(1).StopIfTrue = False


'banking_field_abacode_ac_iban_swift()
'0 bank
    Range("F363:O363,F365:O365").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$363="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R361:U361,R363:U363").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$364="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
'1 bank
    Range("F375:O375,F377:O377").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$375="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R373:U373,R375:U375").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$376="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'2 bank
    Range("F386:O386,F388:O388").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$386="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R384:U384,R386:U386").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$387="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'3 rd abnk
    Range("F397:O397,F399:O399").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$397="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R395:U395,R397:U397").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$398="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'4th bank
    Range("F408:O408,F410:O410").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$408="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R406:U406,R408:U408").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$409="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
'5 th bank
    Range("F419:O419,F421:O421").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$419="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("R417:U417,R419:U419").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$420="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    '#################################################################

'Name / Address modification
Range("F215:L215,F218:U218,F575:L575,F578:U578,F590:U590,F592:U592").Select
Call if_selected_cell_blank_conditional_format

Range("F220:U220,F222:L222,F224:U224,F226:U226").Select
Call if_selected_cell_blank_conditional_format

Range("F580:U580,F582:L582,F584:U584,F586:U586").Select
Call if_selected_cell_blank_conditional_format


'Alternative Payee/Factoring Setup
Range("F173:L173,F176:U176,F188:U188,F190:U190").Select
Call if_selected_cell_blank_conditional_format

Range("F178:U178,F180:L180,F182:U182,F184:U184").Select
Call if_selected_cell_blank_conditional_format

'Bank Account Maintenance
Range("F25:I25,F27:U27,F29:U29,F31:L31,Q31:U31,F33:U33").Select
Call if_selected_cell_blank_conditional_format

Range("E490:J490,N503:U503,N507:Q507,N517:U517").Select
Call if_selected_cell_blank_conditional_format

Range("N476:U476,N480:Q480,N490:U490,E517:J517").Select
Call if_selected_cell_blank_conditional_format


'banking_field_abacode_ac_iban_swift()
'1
'change from bank
    Range("E482:J482,E484:J484,E486:J486").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$482="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("E497:G497,I497:J497").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$497="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'change to bank
    Range("N482:U482,N484:U484,N486:U486").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$483="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("N497:P497,R497:U497").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$498="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'2
'change from bank
    Range("E509:J509,E511:J511,E513:J513").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$509="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("E524:G524,I524:J524").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$524="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'change to bank
    Range("N509:U509,N511:U511,N513:U513").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$510="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("N524:P524,R524:U524").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$525="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'Add Bank Account/Change exsisting Bank Account/Delete exisitng Bank Account
Range("F38:I38,F40:U40").Select
Call if_selected_cell_blank_conditional_format
    
    'Range("B42").FormulaR1C1 = "=COUNTIF(R[1]C[4]:R[1]C[19],TRUE)"

    Range("G42:S42").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$42="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'''    Range("F42:U42").FormatConditions.Add Type:=xlExpression, Formula1:="=$B$42=0"
'''    Range("F42:U42").FormatConditions(Range("F42:U42").FormatConditions.Count).SetFirstPriority
'''    With Range("F42:U42").FormatConditions(1).Interior
'''        .PatternColorIndex = xlAutomatic
'''        .Color = 65535
'''        .TintAndShade = 0
'''    End With
'''    Range("F42:U42").FormatConditions(1).StopIfTrue = False

'Contact Details Modification
Range("F121:U121,F123:U123").Select
Call if_selected_cell_blank_conditional_format

'chek box
    Range("G543:O543").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$543="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'email ID
    Range("F554:N554,F556:N556").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$554="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

'Extend to New Business Unit/Company Code
Range("F154:I154,F156:L156,F215:L215,F218:U218").Select
Call if_selected_cell_blank_conditional_format

'Inactivation/Mark for Deletion
Range("F140:L140,F215:L215,F218:U218").Select
Call if_selected_cell_blank_conditional_format

'Mass changes
Range("F121:U121").Select
Call if_selected_cell_blank_conditional_format

'Modify Payment Method
Range("F133:L133,P133:U133,F121:U121,F123:U123").Select
Call if_selected_cell_blank_conditional_format


'Modify Payment Terms
Range("F121:U121,F123:U123,F126:L126,P126:U126").Select
Call if_selected_cell_blank_conditional_format

'chek box
    Range("F128:K128").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$128="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


'Payment/Posting/Purchasing Block or Unblock
Range("F215:L215,F218:U218,F529:L529").Select
Call if_selected_cell_blank_conditional_format

Range("F121:U121,F123:U123").Select
Call if_selected_cell_blank_conditional_format


'Call mandatory_stoping_for_with_messages


Range("F673:L673,F690:U690,F694:U694,F696:L696,F698:L698,P696:U696,P698:U698,F703:L703,I711").Select
Call if_selected_cell_blank_conditional_format


    Range("F686:L686").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=$V$686=FALSE"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False

Call Pro

End Sub





Attribute VB_Name = "Instruction"
Attribute VB_Base = "0{157D5A02-D2D3-40EB-838F-4EC25F9B3D95}{AAF84264-B587-4E42-B68F-A102DF7BCEE5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
'english
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF_Instructions_English").Visible = True
Sheets("VDRF_Instructions_English").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton2_Click()
'italian
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Istruzioni in Italiano").Visible = True
Sheets("VDRF Istruzioni in Italiano").Select
Sheets("Index").Range("D1").Value = mm
End Sub

Private Sub CommandButton3_Click()
'french
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instructions Fran|fffd|ais").Visible = True
Sheets("VDRF Instructions Fran|fffd|ais").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton4_Click()
'dutch
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Anleitung Deutsch").Visible = True
Sheets("VDRF Anleitung Deutsch").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton5_Click()
'portugal
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instru|fffd||fffd|es em Portugu|fffd|s ").Visible = True
Sheets("VDRF Instru|fffd||fffd|es em Portugu|fffd|s ").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton6_Click()
'Polskie
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instrukcje Polskie").Visible = True
Sheets("VDRF Instrukcje Polskie").Select
Sheets("Index").Range("D1").Value = mm

End Sub

Private Sub CommandButton7_Click()

'norwegian
Instruction.Hide
mm = ActiveSheet.Name
Sheets("instruksjon i Norwegian").Visible = True
Sheets("instruksjon i Norwegian").Select
Sheets("Index").Range("D1").Value = mm

End Sub


Private Sub CommandButton8_Click()
'spanish
Instruction.Hide
mm = ActiveSheet.Name
Sheets("VDRF Instrucciones en Espa|fffd|ol").Visible = True
Sheets("VDRF Instrucciones en Espa|fffd|ol").Select
Sheets("Index").Range("D1").Value = mm
End Sub








Attribute VB_Name = "Iobuttons"
Sub Addb()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 1
For Each cel In Range("f26,j26").Cells
Application.ScreenUpdating = False

d = cel.Row
E = cel.Column
c = Cells(d + 1, E).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 1 And id = 0 Then
id = 1
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
             cbx.Display3DShading = True
 ' with a linked can trap sheet change event or link to other formulas
        cbx.LinkedCell = c
        If id = 1 Then
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!taxx1"
        Else
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!tax0"
        End If
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb1()

For I = 1 To 2
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addb1()
If Range("m20") = "Thai" Then
Exit Sub
End If
Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 3
For Each cel In Range("f33").Cells
Application.ScreenUpdating = False

d = cel.Row
E = cel.Column
c = Cells(d, E - 1).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 3 And id = 0 Then
id = 3
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
        cbx.LinkedCell = c
            cbx.Display3DShading = True

     cbx.OnAction = "'" & ThisWorkbook.Name & "'!tlower"
        
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb2()

On Error Resume Next
ActiveSheet.CheckBoxes("tickbox3").Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox3").delete
On Error GoTo 0
    
End Sub

Sub Addb2()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 4
For Each cel In Range("I64").Cells
Application.ScreenUpdating = False

d = cel.Row
E = cel.Column
c = Cells(d, E - 1).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 4 And id = 0 Then
id = 4
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
        cbx.LinkedCell = c

     cbx.OnAction = "'" & ThisWorkbook.Name & "'!tlower1"
         cbx.Display3DShading = True
        
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb3()

On Error Resume Next
ActiveSheet.CheckBoxes("tickbox4").Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox4").delete
On Error GoTo 0
    
End Sub
Sub Addb3()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 5
j = 0
For Each cel In Range("G226,j226,m226,p226,s226").Cells
Application.ScreenUpdating = False
j = j + 1
d = cel.Row
E = cel.Column
c = Cells(d + 1, E).Address
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 5 And id = 0 Then
id = 5
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "tickbox" & id
        cbx.Caption = ""
            cbx.Display3DShading = True
        cbx.LinkedCell = c
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!uhidebank" & j
        
    Next
 ''Application.ScreenUpdating = False
    
End Sub

Sub Delb4()
For I = 5 To 9
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
End Sub

Sub Addb4()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 10
For Each cel In Range("f214,j214").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 10 And id = 0 Then
id = 10
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "tickbox" & id
            cbx.Display3DShading = True
        cbx.Caption = ""
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Delb5()
For I = 10 To 11
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
End Sub

Sub Addb5()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 12
For Each cel In Range("f159,I159,L159").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 12 And id = 0 Then
id = 12
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "tickbox" & id
            cbx.Display3DShading = True
        cbx.Caption = ""
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Delb6()
For I = 12 To 14
On Error Resume Next
ActiveSheet.CheckBoxes("tickbox" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("tickbox" & I).delete
    Next
 On Error GoTo 0
End Sub
Attribute VB_Name = "List_separator"
Declare Function GetLocaleInfo Lib "kernel32" Alias _
"GetLocaleInfoA" (ByVal Locale As Long, ByVal LCType As Long, _
ByVal lpLCData As String, ByVal cchData As Long) As Long

Declare Function SetLocaleInfo Lib "kernel32" Alias _
"SetLocaleInfoA" (ByVal Locale As Long, ByVal LCType As Long, _
ByVal lpLCData As String) As Boolean

Declare Function GetUserDefaultLCID% Lib "kernel32" ()


'parm value
Public Const LOCALE_SLIST = &HC
Option Explicit
Public Sub Get_listseparator_in_system() ' Retrieve the regional setting
    Dim mm
      Dim Symbol As String
      Dim iRet1 As Long
      Dim iRet2 As Long
      Dim lpLCDataVar As String
      Dim Pos As Integer
      Dim Locale As Long
      
      Locale = GetUserDefaultLCID()
      
      iRet1 = GetLocaleInfo(Locale, LOCALE_SLIST, _
      lpLCDataVar, 0)
      Symbol = String$(iRet1, 0)
      
      iRet2 = GetLocaleInfo(Locale, LOCALE_SLIST, Symbol, iRet1)
      Pos = InStr(Symbol, Chr$(0))
      If Pos > 0 Then
           Symbol = Left$(Symbol, Pos - 1)
           'MsgBox "Regional Setting = " + Symbol
           
           If Symbol = "," Then
           Sheets("Index").Range("B5").Value = ""
           Exit Sub
           Else
           mm = ActiveWorkbook.Name
           Sheets("Index").Range("B5").Value = "changed"
'           Sheets("Index").Range("c5").Value = Sheets("Index").Range("c5").Value + 1
           Sheets("Index").Range("C5").Value = Symbol
           
           MsgBox "The System separator setting is not compatible with Form setting. Hence it has been changed from '" _
           & Sheets("Index").Range("C5").Value & "' To ','" & vbNewLine & vbNewLine & " same will be Restored, Please proceed"
           'MsgBox Sheets("Index").Range("B5").Value
           'MsgBox Sheets("Index").Range("C5").Value
           Call change_list_separator_in_system
           Application.DisplayAlerts = False
           ActiveWorkbook.Save
            Call ExcelRestart_to_apply_list_separator
            Application.DisplayAlerts = False
            Sheets("Index").Range("B5").Value = ""
            ActiveWorkbook.Close savechanges:=False
            Application.DisplayAlerts = True
            Windows(mm).Activate
            'ActiveWorkbook.Close ([no])
           End If
           'MsgBox "completed"
      End If

End Sub


'KillProcesses
'ExcelRestart
Public Sub change_list_separator_in_system() 'Change the regional setting

      Dim Symbol As String
      Dim iRet As Long
      Dim Locale As Long

      Locale = GetUserDefaultLCID() 'Get user Locale ID
      Symbol = "," 'New character for the locale
      iRet = SetLocaleInfo(Locale, LOCALE_SLIST, Symbol)
     
End Sub
Sub ExcelRestart_to_apply_list_separator()
  Dim xlApp
  Dim xlBook
  Dim fname
  Set xlApp = CreateObject("Excel.Application")
  xlApp.DisplayAlerts = False
  fname = ActiveWorkbook.FullName
  Set xlBook = xlApp.Workbooks.Open(fname)
'"C:\Users\50011229\Desktop\kudhal\9 eye programme\list separator.xlsm"
  xlApp.Visible = True
  xlBook.Activate
  Set xlBook = Nothing
  Set xlApp = Nothing
End Sub

'Sheets("Index").Range("B5").Value
Public Sub change_list_separator_in_system_to_previousone() 'Change the regional setting
If Sheets("Index").Range("C5").Value = "" Then Exit Sub
If Sheets("Index").Range("B5").Value = "changed" Then
On Error Resume Next
      Dim Symbol As String
      Dim iRet As Long
      Dim Locale As Long

      Locale = GetUserDefaultLCID() 'Get user Locale ID
      Symbol = Sheets("Index").Range("C5").Value '"," 'New character for the locale
      iRet = SetLocaleInfo(Locale, LOCALE_SLIST, Symbol)
      MsgBox "System setting has been Restored"
On Error GoTo 0
Else
End If
    
End Sub
Attribute VB_Name = "Module1"
Sub Macro11()
Attribute Macro11.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro11 Macro
'

'
    Range("F686:L686").Select
    Range("F686:L686").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=$V$686=FALSE"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
End Sub
Attribute VB_Name = "Module10"

Sub hooligan()

    With ActiveWorkbook.Names("GM_IO_PA")
        '.Name = "GM_IO_PA"
        'GM_IO_PA
        .RefersToR1C1 = "=GMIO_PA_IN_validation!RC:R[4]C"
        .Comment = ""
    End With

    With ActiveWorkbook.Names("GM_IO_IN")
        .Name = "mod"
        .RefersToR1C1 = "=Sheet1!R6C6:R10C6"
        .Comment = ""
    End With
    
End Sub
Sub Macro9()
Attribute Macro9.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro9 Macro

'
End Sub
Sub Macro10()
Attribute Macro10.VB_ProcData.VB_Invoke_Func = " \n14"

    With Selection.Validation
        .delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=GMIO_PA_IN_validation!$I$6:$I$91"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
End Sub
Attribute VB_Name = "Module11"
Sub Macro4()
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'

    ActiveWindow.DisplayHorizontalScrollBar = True

    Range("A5").Select
    Range(Selection, Selection.End(xlToRight)).Select
    ActiveWorkbook.Names.Add Name:="Header_pain", RefersToR1C1:= _
        "=GMIO_PA_IN_validation!R5C1:R5C68"
    Range("A6").Select
    Selection.End(xlToLeft).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    Range("BG5").Select
    Selection.End(xlToLeft).Select
    With ActiveWorkbook.Names("Header_pain")
        .Name = "GMIO_pain_Heade"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R5C1:R5C68"
        .Comment = ""
    End With
    With ActiveWorkbook.Names("GMIO_pain_Heade")
        .Name = "GMIO_pain_Header"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R5C1:R5C68"
        .Comment = ""
    End With
    Range("A6").Select
    Selection.End(xlToLeft).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("A6:BP91").Select
    ActiveWindow.ScrollColumn = 58
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 56
    ActiveWindow.ScrollColumn = 53
    ActiveWindow.ScrollColumn = 48
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.SmallScroll Down:=3
    Range("A6:BP90").Select
    ActiveWindow.SmallScroll Down:=2
    ActiveWindow.ScrollColumn = 58
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 54
    ActiveWindow.ScrollColumn = 47
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 39
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 37
    ActiveWindow.ScrollColumn = 36
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 33
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 29
    ActiveWindow.ScrollColumn = 28
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 25
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 22
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 19
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.LargeScroll Down:=3
    Range("A6").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("A6:A424").Select
    Range(Selection, Selection.End(xlToRight)).Select
    ActiveWindow.ScrollRow = 393
    ActiveWindow.ScrollRow = 391
    ActiveWindow.ScrollRow = 390
    ActiveWindow.ScrollRow = 389
    ActiveWindow.ScrollRow = 384
    ActiveWindow.ScrollRow = 379
    ActiveWindow.ScrollRow = 369
    ActiveWindow.ScrollRow = 337
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 129
    ActiveWindow.ScrollRow = 101
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll ToRight:=2
    ActiveWorkbook.Names.Add Name:="pain_body_gmio", RefersToR1C1:= _
        "=GMIO_PA_IN_validation!R6C1:R424C68"
    Range("A5").Select
    Range(Selection, Selection.End(xlToRight)).Select
    With ActiveWorkbook.Names("GMIO_pain_Header")
        .Name = "pain_Header_GMIO"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R5C1:R5C68"
        .Comment = ""
    End With
    Range("A6").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range("C2:C3").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Columns("F:F").ColumnWidth = 29.29
    Range("F2").Select
    ActiveSheet.Paste
    ActiveCell.FormulaR1C1 = "pain_header_GMIO"
    Range("F3").Select
    Selection.FillDown
    ActiveCell.FormulaR1C1 = "pain_body_GMIO"
    Range("F4").Select
    ActiveSheet.Paste
    Selection.FillDown
    Range("F4").Select
    ActiveCell.FormulaR1C1 = "pain_colno_GMIO"
    Range("F5").Select
    Selection.FillDown
    Range("F5").Select
    ActiveCell.FormulaR1C1 = "pain_collist_GMIO"
    Range("F6").Select
    Selection.FillDown
    ActiveCell.FormulaR1C1 = "pain_totallines_GMIO"
    Range("C4").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_colno_GMIO", RefersToR1C1:= _
        "=MATCH(GM_IO_Form!R25C22,pain_Header_GMIO,0)"
    ActiveWorkbook.Names("pain_colno_GMIO").Comment = ""
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("V25").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(R[6]C[-15],4)"
    Range("G31:M33").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("C5").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("F402:U402").Select
    ActiveCell.FormulaR1C1 = "=pai"
    Range("F402:U402").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("F402:U402").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("F402:U402").Select
    ActiveWindow.DisplayFormulas = True
    ActiveWindow.DisplayFormulas = False
    Selection.ClearContents
    Range("N61").Select
    ActiveSheet.Paste
    Range("N61").Select
    Selection.ClearContents
    Range("P74:S74").Select
    Sheets("GMIO_PA_IN_validation").Select
    Windows("excel study.xlsm").Activate
    Range("F5").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Range("B7").Select
    ActiveCell.FormulaR1C1 = "2"
    Range("F6").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_totallines_GMIO", RefersToR1C1:= _
        "=COUNTA(pain_collist_GMIO)"
    ActiveWorkbook.Names("pain_totallines_GMIO").Comment = ""
    Windows("excel study.xlsm").Activate
    Range("D5").Select
    Selection.ClearContents
    Range("F6").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Range("D27").Select
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Range("F5").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_collist_GMIO", RefersToR1C1:= _
        "=INDEX(pain_body_gmio,,pain_colnot_GMIO)"
    ActiveWorkbook.Names("pain_collist_GMIO").Comment = ""
    Windows("excel study.xlsm").Activate
    Range("F13").Select
    ActiveSheet.Paste
    Range("F2:F6").Select
    Range("F6").Activate
    Selection.Copy
    Application.CutCopyMode = False
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Windows("excel study.xlsm").Activate
    Range("F6").Select
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    ActiveWorkbook.Names.Add Name:="pain_paymentterm_GMIO", RefersToR1C1:= _
        "=INDEX(pain_body_gmio,1,pain_colno_GMIO):INDEX(pain_body_gmio,pain_lineitems_GMIO,pain_colno_GMIO)"
    ActiveWorkbook.Names("pain_paymentterm_GMIO").Comment = ""
    With ActiveWorkbook.Names("pain_totallines_GMIO")
        .Name = "pain_totallimes_GMIO"
        .RefersToR1C1 = "=COUNTA(pain_collist_GMIO)"
        .Comment = ""
    End With
    With ActiveWorkbook.Names("pain_body_gmio")
        .Name = "pain_body_GMIO"
        .RefersToR1C1 = "=GMIO_PA_IN_validation!R6C1:R424C68"
        .Comment = ""
    End With
    Sheets("GMIO_PA_IN_validation").Select
    Sheets.Add After:=ActiveSheet
    Range("H12").Select
    ActiveCell.FormulaR1C1 = "=pa"
    Range("H12").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("H13").Select
    ActiveCell.FormulaR1C1 = "=pain_totallimes_GMIO"
    Range("H13").Select
    ActiveWorkbook.Names("pain_collist_GMIO").RefersToR1C1 = _
        "=INDEX(pain_body_GMIO,,pain_colno_GMIO)"
    Range("H14").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Validation
        .delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=pain_paymentterm_GMIO"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Range("H16").Select
    With ActiveWorkbook.Names("pain_totallimes_GMIO")
        .Name = "pain_totallineitems_GMIO"
        .RefersToR1C1 = "=COUNTA(pain_collist_GMIO)"
        .Comment = ""
    End With
    Range("H14").Select
    ActiveWorkbook.Names("pain_paymentterm_GMIO").RefersToR1C1 = _
        "=INDEX(pain_body_GMIO,1,pain_colno_GMIO):INDEX(pain_body_GMIO,pain_totallineitems_GMIO,pain_colno_GMIO)"
    Range("J15").Select
    Columns("H:H").EntireColumn.AutoFit
    Range("I14").Select
    Columns("H:H").EntireColumn.AutoFit
    Range("H14").Select
    Sheets("GM_IO_Form").Select
    With Selection.Validation
        .delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=pain_paymentterm_GMIO"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Range("V25").Select
    Sheets("GMIO_PA_IN_validation").Select
    Selection.End(xlUp).Select
    Range("I5").Select
    Selection.Copy
    Range("C5:E5").Select
    Range("E5").Activate
    Application.CutCopyMode = False
    Selection.Copy
    Workbooks.Add
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
    Range("B1").Select
    Columns("A:A").EntireColumn.AutoFit
    Range("A2").Select
    Application.CutCopyMode = False
    Selection.Copy
    Windows("VDRF New 1.10.xlsm").Activate
    Application.CutCopyMode = False
    Application.DisplayFullScreen = False
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Windows("Book1").Activate
    Windows("VDRF New 1.10.xlsm").Activate
    Windows("Book1").Activate
    Selection.Copy
    Windows("VDRF New 1.10.xlsm").Activate
    Application.CutCopyMode = False
    Application.DisplayFullScreen = False
    Windows("Book1").Activate
    Selection.Copy
    Application.CutCopyMode = False
    Windows("VDRF New 1.10.xlsm").Activate
    Application.DisplayFullScreen = False
    Range("V25").Select
    ActiveCell.FormulaR1C1 = "GMI_IN_C"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_collist_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_collist_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("O61").Select
    ActiveCell.FormulaR1C1 = "=INDEX(pain_body_GMIO,2,(pain_colno_GMIO+1))"
    Range("T33").Select
    Range("V33").Select
    ActiveCell.FormulaR1C1 = "=pain"
    Range("V33").Select
    Range("V33").Select
    Selection.Copy
    Application.CutCopyMode = False
    Selection.ClearContents
    Range("O50").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO"
    Range("O50").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO+1"
    Range("O50").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E8").Select
    Sheets("GM_IO_Form").Select
    Range("N50").Select
    ActiveCell.FormulaR1C1 = ""
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_bo_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("P74:U74").Select
    Selection.Copy
    Application.CutCopyMode = False
    Sheets("GMIO_PA_IN_validation").Select
    Range("D23").Select
    Columns("D:D").EntireColumn.AutoFit
    Columns("D:D").ColumnWidth = 12.29
    Range("C5").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("O61").Select
    Range("P74:S74").Select
    Selection.Copy
    Sheets("GMIO_PA_IN_validation").Select
    Cells.Find(What:="Delivered cleared by customs   ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Range("C15").Select
    Cells.Find(What:="Delivered cleared by customs   ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="Delivered cleared by customs ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="Delivered cleared by customs", After:=ActiveCell, LookIn _
        :=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _
        xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.FindNext(After:=ActiveCell).Activate
    Range("A11").Select
    Cells.Find(What:="Delivered cleared by customs   ", After:=ActiveCell, _
        LookIn:=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, _
        SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Cells.Find(What:="Delivered cleared by customs", After:=ActiveCell, LookIn _
        :=xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _
        xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Range("E22:F22").Select
    Range("F22").Activate
    Application.CutCopyMode = False
    Selection.Copy
    Application.CutCopyMode = False
    Range("E5").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("P74:S74").Select
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("P74:S74").Select
    Windows("Book1").Activate
    Windows("VDRF New 1.10.xlsm").Activate
    Windows("Book1").Activate
    Windows("VDRF New 1.10.xlsm").Activate
    Sheets("GMIO_PA_IN_validation").Select
    Application.DisplayFullScreen = False
    ActiveWorkbook.Save
    Range("E12:F12").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Application.CutCopyMode = False
    Sheets("GMIO_PA_IN_validation").Select
    Range("E17").Select
    Cells.Find(What:="Letter of Credit at Sight", After:=ActiveCell, LookIn:= _
        xlFormulas, Lookat:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _
        xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Range("D63").Select
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    Range("E12").Select
    Sheets("GM_IO_Form").Select
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("Q50").Select
    ActiveCell.FormulaR1C1 = "=MATCH(R[24]C[-1],pain_collist_GMIO)"
    Range("R50").Select
    ActiveCell.FormulaR1C1 = "=pain_colno_GMIO+1"
    Range("S50").Select
    ActiveCell.FormulaR1C1 = "=INDEX(pain_body_GMIO,79,6)"
    Range("S50").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("A1:B1").Select
    Sheets("GM_IO_Form").Select
    Range("V25").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E5").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 78
    ActiveWindow.ScrollRow = 77
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 78
    Sheets("GM_IO_Form").Select
    Range("P74:S74").Select
    Sheets("GMIO_PA_IN_validation").Select
    ActiveWindow.ScrollRow = 77
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    Range("E65").Select
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    Sheets("GM_IO_Form").Select
    Range("S50").Select
    Application.GoTo Reference:= _
        "GMIO_PA_IN_validation!R[301]C[34]:R[1048459]C[16351]"
    ActiveWindow.SmallScroll Down:=-4
    Range("F6:F32").Select
    ActiveWindow.SmallScroll Down:=2
    Range("E6:E83").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E84").Select
    ActiveWindow.SmallScroll Down:=7
    Range("E84:F84").Select
    Selection.Copy
    Sheets("GM_IO_Form").Select
    Range("P74:S74").Select
    Application.CutCopyMode = False
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO)),(pain_colno_GMIO+1))"
    Range("T75").Select
    Sheets("GMIO_PA_IN_validation").Select
    Range("E84").Select
    Sheets("GM_IO_Form").Select
    Range("Q50").Select
    Application.GoTo Reference:="pain_collist_GMIO"
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    Sheets("GM_IO_Form").Select
    Range("T74:U74").Select
    ActiveCell.FormulaR1C1 = _
        "=INDEX(pain_body_GMIO,(MATCH(RC[-4],pain_collist_GMIO,0)),(pain_colno_GMIO+1))"
    Range("T74:U74").Select
    Sheets("GMIO_PA_IN_validation").Select
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    Range("E13").Select
    ActiveWorkbook.Save
    Sheets("GM_IO_Form").Select
    Range("O50:S50").Select
    Selection.ClearContents
    Range("T77").Select
    Sheets("GMIO_PA_IN_validation").Select
    Columns("A:B").Select
    Range("A2").Activate
    Selection.AutoFilter
    Rows("5:5").Select
    Range("B5").Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.AutoFilter
    Rows("5:5").Select
    Range("B5").Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.AutoFilter
    Selection.End(xlUp).Select
    Range("B5").Select
    ActiveSheet.Range("$A$5:$BU$423").AutoFilter Field:=2, Criteria1:="="
    Range("B60").Select
    Range(Selection, Selection.End(xlToLeft)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("A60:B423").Select
    Range("B60").Activate
    Selection.SpecialCells(xlCellTypeVisible).Select
    Selection.AutoFilter
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    Selection.ClearContents
    Range("D57").Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("D2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("F7").Select
    Selection.End(xlDown).Select
    Range("F29").Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("F5").Select
    Selection.AutoFilter
    Range("F2").Select
    ActiveSheet.Range("$A$2:$BP$423").AutoFilter Field:=6, Criteria1:="="
    Range("E28").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("E28:F71").Select
    Selection.SpecialCells(xlCellTypeVisible).Select
    Selection.AutoFilter
    Selection.delete Shift:=xlUp
    Range("G6").Select
    Selection.End(xlDown).Select
    Range("H28").Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Range("H6").Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("I6").Select
    Selection.End(xlDown).Select
    Range("J90").Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("J2").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$BP$423").AutoFilter Field:=10, Criteria1:="="
    Range("I28:J28").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("I28:J71").Select
    Selection.SpecialCells(xlCellTypeVisible).Select
    Selection.AutoFilter
    Selection.delete Shift:=xlUp
    Range("J29").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.SmallScroll ToRight:=4
    Range("L28:L29").Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("N2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Selection.End(xlUp).Select
    Range("M18:N18").Select
    Range("N18").Activate
End Sub
Sub Macro5()
Attribute Macro5.VB_ProcData.VB_Invoke_Func = " \n14"

Do
    If ActiveCell.Offset(0, -1).Value = "" Then Exit Do
    
    If ActiveCell.Value = "" Then
    aa = ActiveCell.Address
    Range(ActiveCell.Offset(0, -1), ActiveCell).Select
    Selection.delete Shift:=xlUp
    Range(aa).Select
    Else
    ActiveCell.Offset(1, 0).Select
    End If
Loop
'    Range("N24").Select
'    Selection.End(xlDown).Select
'    Range("M64:N64").Select
'    Range("N64").Activate
'    Selection.Delete Shift:=xlUp
'    Range("M65:N65").Select
'    Range("N65").Activate
'    Selection.Delete Shift:=xlUp
End Sub
Sub Macro6()
Attribute Macro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
'

'
    Range("N66").Select
    Range(Selection, Selection.End(xlUp)).Select
    Range("M22:N66").Select
    Range("N66").Activate
End Sub
Attribute VB_Name = "Module12"
Sub Macro8()
Attribute Macro8.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro8 Macro
'

'
    Selection.FormatConditions.delete
    ActiveWindow.SmallScroll Down:=-12
End Sub
Attribute VB_Name = "Module13"

Attribute VB_Name = "Module14"
Sub ghjk()

Application.ThousandsSeparator = ","
Application.DecimalSeparator = "."

MsgBox Application.ThousandsSeparator
MsgBox Application.DecimalSeparator

If Application.ThousandsSeparator = ";" Then
MsgBox "A"
Else
MsgBox "c"
End If
End Sub
Attribute VB_Name = "Module15"
Option Explicit

Private Declare Function SetLocaleInfo _
Lib "kernel32" Alias "SetLocaleInfoA" ( _
ByVal Locale As Long, _
ByVal LCType As Long, _
ByVal lpLCData As String) As Boolean

Private Declare Function GetUserDefaultLCID% Lib "kernel32" ()

Private Const LOCALE_SLIST = &HC
Private Const LOCALE_NAME_MAX_LENGTH = 85
Private Const LOCALE_NAME_USER_DEFAULT = vbNullString

'Get Locale Info
Private Declare Function GetLocaleInfoEx _
Lib "kernel32" ( _
ByVal lpLocaleName As String, _
ByVal LCType As Long, _
ByVal lpLCData As String, _
ByVal cchData As Long) As Long

Private Declare Function GetLastError Lib "kernel32" () As Long

Sub M1DelimiterSetup()

Dim lngTryAgainCtr As Long
Dim strBuffer As String
Dim strListSeparator As String
Dim lpLCData As String
Dim Long1 As Long

    lngTryAgainCtr = 0

TryAgain:
    lngTryAgainCtr = lngTryAgainCtr + 1

    'Change delimiter to pipe
    Call SetLocaleInfo(GetUserDefaultLCID(), LOCALE_SLIST, "|")

    'Check to make sure setting separator as pipe worked correctly
    strBuffer = String$(85, 0)
    Long1 = GetLocaleInfoEx(LOCALE_NAME_USER_DEFAULT, LOCALE_SLIST, lpLCData, 0)

    strListSeparator = String$(Long1, 0)
    Long1 = GetLocaleInfoEx(LOCALE_NAME_USER_DEFAULT, LOCALE_SLIST, strListSeparator, Long1)

    If InStr(strListSeparator, "|") = 0 Then
        If lngTryAgainCtr < 3 Then
            GoTo TryAgain
        Else
            If GetLocaleInfoEx(LOCALE_NAME_USER_DEFAULT, LOCALE_SLIST, strListSeparator, Long1) <> 0 Then Debug.Print GetLastError
            'pass part 1 error message
            'need error message for if run actively instead of part of script
        End If
    End If

    'Close workbook to allow Excel to reset its memory of delimiter
    'Show alerts if more workbooks open
    If Workbooks.Count = 1 Then Application.DisplayAlerts = False
    Application.Quit

End Sub

Attribute VB_Name = "Module16"
Attribute VB_Name = "Module17"

Sub mandatory_stoping_for_with_messages()


End Sub

Attribute VB_Name = "Module18"



Sub Macro12()
Attribute Macro12.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro12 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Check Box 421")).Select
    Range("M262").Select
    ActiveWindow.SmallScroll Down:=-186
    Sheets("GM_NA").Select
    Range("Q18:U18").Select
    ActiveCell.FormulaR1C1 = "New Duns creation"
    Range("E115:F115").Select
    ActiveWindow.SmallScroll Down:=-27
    Range("H66").Select
    Application.Run "'VDRF New 2.7.xlsm'!SHEETUNHIDE"
    ActiveSheet.Shapes.Range(Array("pv")).Select
    ActiveSheet.Shapes.Range(Array("pv")).Select
    Range("Q18:U18").Select
    ActiveCell.FormulaR1C1 = "New Duns creation"
    Range("Q19").Select
    Application.Run "'VDRF New 2.7.xlsm'!SHEETUNHIDE"
    ActiveSheet.Shapes.Range(Array("pv")).Select
    ActiveWindow.SmallScroll Down:=-192
    Range("Q18:U18").Select
    ActiveWindow.SmallScroll Down:=-15
    Range("Q18:U18").Select
    ActiveCell.FormulaR1C1 = "New Duns creation"
    Range("F239:U239").Select
    ActiveWindow.SmallScroll Down:=30
    ActiveWorkbook.Save
    ActiveWindow.SmallScroll Down:=-240
    Range("F20:L20").Select
    ActiveWindow.SmallScroll Down:=-123
    Application.Run "'VDRF New 2.7.xlsm'!pack_the_form_to_ready_for_use"
    ActiveWorkbook.Save
    ActiveWorkbook.Save
End Sub
Attribute VB_Name = "Module19"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Range("R603:U603,R605:U605").Select
    Range("R605").Activate
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$B$605="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("C605").Select
End Sub
Attribute VB_Name = "Module2"
Sub Macro13()
Attribute Macro13.VB_ProcData.VB_Invoke_Func = " \n14"
'
If Range("F20").Value = "Thailand" Then
On Error Resume Next
    ActiveSheet.Shapes.Range(Array("payee_chekbox")).delete

    With Range("H395").Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With
Else
    With Range("H395").Font
        .Color = -10477568
        .TintAndShade = 0
    End With

End If
On Error GoTo 0

End Sub
Sub Macro14()
Attribute Macro14.VB_ProcData.VB_Invoke_Func = " \n14"


ActiveWindow.ActivatePrevious.Select

End Sub
Attribute VB_Name = "Module3"
Sub Macro15()
Attribute Macro15.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro15 Macro
'

'
    ActiveSheet.Unprotect
    Selection.Locked = True
    Selection.FormulaHidden = False
End Sub
Attribute VB_Name = "Module4"
Sub Macro16()
Attribute Macro16.VB_ProcData.VB_Invoke_Func = " \n14"

Call UnPro
    
    If Range("E24").Value = "India" Then
    Range("E24").FormulaR1C1 = "GM Region"
    Range("G24").FormulaR1C1 = "GM IO Business Units"
    Range("N24").FormulaR1C1 = "PO ORG"
    Else
    Range("E24:P24").ClearContents
    End If
    
End Sub
Sub Macro17()
Attribute Macro17.VB_ProcData.VB_Invoke_Func = " \n14"
    
    ActiveCell.FormulaR1C1 = "FALSE"
    Range("F81").Locked = True
    'Selection.Locked = True
    Selection.FormulaHidden = True

End Sub
Sub Macro18()
Attribute Macro18.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro18 Macro
'

'
    ActiveSheet.Unprotect
    ActiveSheet.Shapes.Range(Array("tds")).Select
End Sub
Sub Macro19()
Attribute Macro19.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro19 Macro
'

'


End Sub
Sub Macro20()
Attribute Macro20.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro20 Macro
'

'
    Range("F124:J124").Select
    ActiveSheet.Unprotect
    Cells.FormatConditions.delete
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(RIGHT($O$120,4)=""ndia"",$F$124="""")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    ActiveCell.FormulaR1C1 = "fd"
    Range("F124:J124").Select
End Sub
Attribute VB_Name = "Module5"
Sub Macro21()
Attribute Macro21.VB_ProcData.VB_Invoke_Func = " \n14"
Call UnPro
If Range("O120").EntireRow.Hidden = False And Trim(UCase(Range("O120").Value)) = "INDIA" And Range("F124").Value = "" Then

        Range("F122").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($O$120))=""INDIA"",trim($F$124)="""")"
    Range("F122").FormatConditions(Range("F122").FormatConditions.Count).SetFirstPriority
    With Range("F122").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207 '10092543
        .TintAndShade = 0
    End With
    Range("F122").FormatConditions(1).StopIfTrue = False

chk = "fail"

Else
End If


countryucase = Trim(UCase(Range("M410").Value))
If Range("M410").EntireRow.Hidden = False And countryucase = "AUSTRALIA" And Range("M412").Value = "" Then

    Range("M412").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(trim(upper($M$410))=""AUSTRALIA"",trim($M$412)="""")"
    Range("M412").FormatConditions(Range("M412").FormatConditions.Count).SetFirstPriority
    With Range("M412").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Range("M412").FormatConditions(1).StopIfTrue = False
chk = "fail"
Else
End If

''    Range("M412").Select
''
''
''    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
''        "=AND($M$410=""australia"",$M$412="""")"
''    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
''    With Selection.FormatConditions(1).Interior
''        .PatternColorIndex = xlAutomatic
''        .Color = 6750207
''        .TintAndShade = 0
''    End With
''    Selection.FormatConditions(1).StopIfTrue = False
''    Range("F412:J412").Select
''    ActiveCell.FormulaR1C1 = "=AND(M410=""australia"",M412="""")"
''    Range("F412:J412").Select
''    Selection.ClearContents
''    Range("M410:U410").Select
''    ActiveCell.FormulaR1C1 = "Australia"
''    Range("N413").Select
End Sub
Attribute VB_Name = "Module6"
Sub Macro7()
Attribute Macro7.VB_ProcData.VB_Invoke_Func = " \n14"
'
Union(Range("F122:J122,F124:J124,F126:J126,F128:N128,F130:N130"), _
Range("F134:U134,F132:J132,M132:U132"), _
Range("F57:L57,F59:U59,E67:F67,L67:M67,F74:I74,F76:I76,P76:S76,P74:S74,F83:J83,F85:J85,M85:Q85,T85:U85,F89:J89,F91:J91,M89:Q89,M91:Q91,T89:U89,S96:U96,K94:O94,K96:O96,E94:H94,E96:H96,E98:H98,E100:H100,E102:H102,E105:H105,K102:O102,K100:O100,K98:O98,F109:L109"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120"), _
Range("F114:U114,F112:U112,F116:U116,F118:J118,O118:U118,F120:J120,O120:U120,F122:J122,F124:J124,O122:U122,O124:U124,O126:U126,F126:J126,F128:N128,F130:N130,F132:J132,M132:U132,F134:U134,F109:L109,F140:L140,F143:U143,F145:U145,F147:U147,F149:J149,F151:J151"), _
Range("M149:U149,M151:U151,F153:J153,F155:J155,M155:U155,M153:U153,F157:N157,F159:N159,F161:J161,M161:U161,F163:U163,F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180,F182:N182,F184:N184"), _
Range("O206:U206,F206:K206,F211:L211,F213:U213,F217:U219,F223:I223,O223:U223,F227:U229,F233:I233,O233:U233,F235:U237,F241:N241,F243:N243,F245:J245"), Range("M245:P245,S245:U245,F247:U247,F249:U251,F255:N255,F257:N257,F259:U261,F265:U265,F267:U267,F269:U269,F271:J271,M271:U271,F273:J273,F275:N275,F277:N277,F279:J279,M279:P279,S279:U279,F281:U281"), Range("F166:L166,F168:U168,F170:U170,F172:U172,F174:J174,M174:U174,F176:J176,M176:U176,M178:U178,F178:J178,F180:J180,M180:U180"), Range("F182:N182,F184:N184,F186:J186,M186:U186,F188:U188,F192:L192,F194:U194,F198:I198,F200:I200,F202:I202,P200:S200,P202:S202"), _
Range("F369:J369,N369:R369,F373:L373,F375:U375,F377:U377,F379:U379,F381:J381,M381:U381,M383:U383,F383:J383,F385:J385,M385:U385,F387:N387,F389:N389,F391:J391,M391:U391,F393:U393"), _
Range("F399:L399,F402:U402,F404:U404,F406:U406,F408:J408,M408:U408,F410:J410,M410:U410,M412:U412,F412:J412,F414:N414,F416:N416,F418:J418,M418:U418,F420:U420,F425:L425,F428:U428,F430:U430,F432:U432,F434:J434,M434:U434,F436:J436,M436:U436,M438:U438,F438:J438"), _
Range("F440:N440,F442:N442,F444:J444,M444:U444,F446:U446"), _
Range("F452:L452,F454:U454,F456:U456,F458:U458,F460:J460,M460:U460,F462:J462,M462:U462,F464:J464,M464:U464,F466:N466,F468:N468,F470:J470,M470:U470,F472:U472"), _
Range("F477:K477,O477:U477,F481:L481,F483:U483"), _
Range("F499:L499,F502:U502,F504:U504,F506:U506,F508:J508,M508:U508,M510:U510,F510:J510,F512:J512,M512:U512,F514:N514,F516:N516,F518:J518,M518:U518,F520:U520,F525:L525,F527:U527,F529:U529,F531:U531,F533:J533,M533:U533,M535:U535,F535:J535,F537:J537,M537:U537"), _
Range("F539:N539,F541:N541,F543:J543,M543:U543,F545:U545,F548:L548,F550:U550,F552:U552,F554:U554"), _
Range("F556:J556,M556:U556,M558:U558,F558:J558,F560:J560,M560:U560,F562:N562,F564:N564,F566:J566,M566:U566,F568:U568,F571:L571,F573:U573"), _
Range("F575:U575,F577:U577,F579:J579,M579:U579,F581:J581,M581:U581,F583:J583,M583:U583,F585:N585,F587:N587"), _
Range("F589:J589,M589:U589,F595:Q595,F597:Q597,T597:U597,F599:Q599,F601:I601,L601:N601,R601:U601,F603:N603,F605:N605,R603:U603,R605:U605"), _
Range("F610:Q610,F612:Q612,F614:Q614,T612:U612,F616:I616,L616:N616,R616:U616,F618:N618,F620:N620,R618:U618,R620:U620"), _
Range("F624:Q624,F626:Q626,T626:U626,F628:Q628,F630:I630,L630:N630,R630:U630,R632:U632,F632:N632,F634:N634,R634:U634"), _
Range("F637:Q637,F639:Q639,F641:Q641,T639:U639,F643:I643,L643:N643,R643:U643,R645:U645,F645:N645,F647:N647,R647:U647"), _
Range("F650:Q650,F652:Q652,T652:U652,F654:Q654,F656:I656,L656:N656,R656:U656,R658:U658,F658:N658,F660:N660,R660:U660"), _
Range("F663:Q663,F665:Q665,T665:U665,F667:Q667,F669:I669,L669:N669,R669:U669,R671:U671,F671:N671,F673:N673,R673:U673"), _
Range("D988:D992,F995:U997")).Select


End Sub
Attribute VB_Name = "Module7"
Sub Macro23()
Attribute Macro23.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro23 Macro
'

'
    Application.Run "'VDRF New 2.2.xlsm'!SHEETUNHIDE"
    Range("N44:O44").Select
    Application.Run "'VDRF New 2.2.xlsm'!SHEETUNHIDE"
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND($G$63<>TRUE,IF($S$43=TRUE, COUNTIF($T$43:$U$43,TRUE), 1)<1)"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    Selection.FormatConditions(1).StopIfTrue = False
End Sub
Attribute VB_Name = "Module8"
Sub ghj()
Dim s As Shape
'On Error Resume Next
For Each s In ActiveSheet.Shapes
's.Select
'aa = Selection.Value
''dd = Selection.Value
''s.Value = xlOff
'''s.AutoShapeType
's.OnAction = ""
s.SetShapesDefaultProperties
'MsgBox ss
Next
On Error GoTo 0


End Sub


Sub Query()
    WkbName = Range("q18").Value
    MyArray = Array("<", ">", "|", "/", "*", "\", "?", """")
    For x = LBound(MyArray) To UBound(MyArray)
        WkbName = Replace(WkbName, MyArray(x), "_", 1)
    Next x
    MsgBox WkbName
End Sub


Attribute VB_Name = "Module9"
Sub tds_lock_and_unlock_for_india()

If Range("F74").Value = "" Then Exit Sub
Call UnPro
If Range("Q18").Value = "New Duns/Vendor Code creation" And Range("F20").Value = "India" And Range("D63").Value = True And Left(Range("F74"), 8) = "Material" Then

Range("F81").Value = False
Range("J81").Value = True
Range("F81").Locked = True
Range("J81").Locked = True

Else
Range("F81").Value = False
Range("J81").Value = False
Range("F81").Locked = False
Range("J81").Locked = False
End If
Call Pro
End Sub

Sub india_pan_mandatory()
Call UnPro
If Range("O120").Value = "" Then Exit Sub
        Range("F124").FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=AND(RIGHT($O$120,4)=""ndia"",$F$124="""")"
    Range("F124").FormatConditions(Range("F124").FormatConditions.Count).SetFirstPriority
    With Range("F124").FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Range("F124").FormatConditions(1).StopIfTrue = False

Call Pro
End Sub

Sub masschange_update()
   Sheets("Mass Change").Select
   Application.ScreenUpdating = True
   MsgBox "Please update the Mass Change details "
Sheets("Mass Change").Calculate
Range("A1").Select
   Call UnPro

End Sub




















Attribute VB_Name = "PO_Auditing"
Sub auditing_PO()
Application.ScreenUpdating = False
Sheets("Finder_PO").Range("A1:N1").FormulaR1C1 = "=MATCH(R[1]C,ALL_in_one!R,0)"



Sheets("PO_comparison").Select
Sheets("PO_comparison").Cells.delete Shift:=xlUp



    Sheets("Finder_PO").Range("A1:N1").Copy
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

Sheets("PO_comparison").Select
Range("A1").Select

Do

'MsgBox ActiveCell.Formula
    If ActiveCell.Formula = "#N/A" Then
    MsgBox ("Invalid SAP Extract"), vbCritical
    Sheets("control").Select
    Exit Sub
    Else
    If ActiveCell.Value = "" Then Exit Do
    ActiveCell.Offset(0, 1).Select
    End If

Loop

'Sheets("ALL_in_one").Select
    Sheets("ALL_in_one").UsedRange.AutoFilter Field:=134, Operator:= _
        xlFilterAutomaticFontColor

'Sheets("Finder_PO").Select


'Sheets("PO_comparison").Select
Range("A1").Select

Do

Sheets("ALL_in_one").Columns(ActiveCell.Value).SpecialCells(xlCellTypeVisible).Copy
ActiveSheet.Paste
ActiveCell.Offset(0, 1).Select
If ActiveCell.Value = "" Then Exit Do
Loop

'Sheets("ALL_in_one").Columns(3).SpecialCells(xlCellTypeVisible).Copy
'Range("X1").Select
'ActiveSheet.Paste

'Sub coc_length_adjustment()

Range("B2").Select
'''            Do
'''            If ActiveCell.Value = "" Then Exit Do
'''
'''                If Len(ActiveCell.Value) < 4 Then
'''                ActiveCell.Value = "'" & Right("0000" & ActiveCell.Value, 4)
'''                Else
'''                End If
'''
'''                'sort key
'''                If Len(ActiveCell.Offset(0, 5).Value) < 3 Then
'''                ActiveCell.Offset(0, 5).Value = "'" & Right("000" & ActiveCell.Offset(0, 5).Value, 3)
'''                Else
'''                End If
'''
'''
'''                If ActiveCell.Offset(0, -1).Value = "" Then
'''                ActiveCell.Offset(0, -1).FillDown
'''                Else
'''                End If
'''
'''                If ActiveCell.Offset(0, 1).Value = "" Then
'''                ActiveCell.Offset(0, 1).FillDown
'''                Else
'''                End If
'''
'''            ActiveCell.Offset(1, 0).Select
'''            Loop

    Sheets("Finder_PO").Range("C2:N2").Copy
    Sheets("PO_comparison").Select
    Range("P1").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("O1:A1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
        .PatternTintAndShade = 0
    End With




    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 15).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-14]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,2,0),VLOOKUP(R3C1,PO_mannual!C1:C24,2,0))=0,"""",IF(RC[-14]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,2,0),VLOOKUP(R3C1,PO_mannual!C1:C24,2,0))),""In Valid input"")"


    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 16).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-15]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,3,0),VLOOKUP(R3C1,PO_mannual!C1:C24,3,0))=0,"""",IF(RC[-15]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,3,0),VLOOKUP(R3C1,PO_mannual!C1:C24,3,0))),""In Valid input"")"


    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 17).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-16]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,4,0),VLOOKUP(R3C1,PO_mannual!C1:C24,4,0))=0,"""",IF(RC[-16]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,4,0),VLOOKUP(R3C1,PO_mannual!C1:C24,4,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 18).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-17]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,5,0),VLOOKUP(R3C1,PO_mannual!C1:C24,5,0))=0,"""",IF(RC[-17]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,5,0),VLOOKUP(R3C1,PO_mannual!C1:C24,5,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 19).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-18]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,6,0),VLOOKUP(R3C1,PO_mannual!C1:C24,6,0))=0,"""",IF(RC[-18]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,6,0),VLOOKUP(R3C1,PO_mannual!C1:C24,6,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 20).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-19]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,7,0),VLOOKUP(R3C1,PO_mannual!C1:C24,7,0))=0,"""",IF(RC[-19]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,7,0),VLOOKUP(R3C1,PO_mannual!C1:C24,7,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 21).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-20]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,8,0),VLOOKUP(R3C1,PO_mannual!C1:C24,8,0))=0,"""",IF(RC[-20]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,8,0),VLOOKUP(R3C1,PO_mannual!C1:C24,8,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 22).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-21]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,9,0),VLOOKUP(R3C1,PO_mannual!C1:C24,9,0))=0,"""",IF(RC[-21]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,9,0),VLOOKUP(R3C1,PO_mannual!C1:C24,9,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 23).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-22]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,10,0),VLOOKUP(R3C1,PO_mannual!C1:C24,10,0))=0,"""",IF(RC[-22]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,10,0),VLOOKUP(R3C1,PO_mannual!C1:C24,10,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 24).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-23]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,11,0),VLOOKUP(R3C1,PO_mannual!C1:C24,11,0))=0,"""",IF(RC[-23]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,11,0),VLOOKUP(R3C1,PO_mannual!C1:C24,11,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 25).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-24]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,12,0),VLOOKUP(R3C1,PO_mannual!C1:C24,12,0))=0,"""",IF(RC[-24]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,12,0),VLOOKUP(R3C1,PO_mannual!C1:C24,12,0))),""In Valid input"")"

    Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 26).FormulaR1C1 = _
        "=IFERROR(IF(IF(RC[-25]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,13,0),VLOOKUP(R3C1,PO_mannual!C1:C24,13,0))=0,"""",IF(RC[-25]=""X"",VLOOKUP(R3C1,PO_mannual!C1:C22,13,0),VLOOKUP(R3C1,PO_mannual!C1:C24,13,0))),""In Valid input"")"



'===============================
'
'    Range(Range("A1048576").End(xlUp).Offset(0, 3), Range("M2")).SpecialCells(xlCellTypeVisible).Select
'    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=D1<>O1"
'    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
'    With Selection.FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 16767487
'        .TintAndShade = 0
'    End With
'==================
'Range(Range("A1048576").End(xlUp), Range("A2")).SpecialCells(xlCellTypeVisible).Offset(0, 12).FormulaR1C1 = _
    "=IFERROR(VLOOKUP(RC[-11],COC_Mannual!C[-12],1,0),""error"")"

Range("O2").Select
Do
'On Error Resume Next
If ActiveCell.Value = "" Then Exit Do

    If ActiveCell.Value = "error" Then
    ActiveCell.EntireRow.delete
    Else
    ActiveCell.Offset(1, 0).Select
    End If

Loop

''Range("A2").Select
''        Do
''
''        If ActiveCell.Value = "" Then Exit Do
''
''            If ActiveCell.Offset(0, 7).Value = "" Then
''
''            Else
''            ActiveCell.Offset(0, 7).Value = "YES"
''            End If
''        ActiveCell.Offset(1, 0).Select
''        Loop

    Range("C2").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=C2<>P2"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.Copy
    Range(Range("A1048576").End(xlUp).Offset(0, 2), Range("N2")).SpecialCells(xlCellTypeVisible).Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False

    Range("A2").Select
    ActiveWindow.FreezePanes = True

''    Columns("X:X").Select
''    Selection.Cut
''    Columns("C:C").Select
''    Selection.Insert Shift:=xlToRight

Range("A1").Select
MsgBox "Finished!..", vbInformation
End Sub


Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton6, 1213, 1, MSForms, CommandButton"
Attribute VB_Control = "CheckBox1, 606, 2, MSForms, CheckBox"
Attribute VB_Control = "CommandButton4, 62, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 61, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 8, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 6, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 1105, 7, MSForms, CommandButton"
Attribute VB_Control = "ComboBox1, 1211, 8, MSForms, ComboBox"

Private Sub CheckBox1_Click()

If CheckBox1.Value = True Then
Range("F236").Value = "Please Apply For DUNS"
MsgBox "Please Apply for DUNS"
Else
Range("F236").Value = ""
End If
End Sub


Private Sub ComboBox1_Change()
If ActiveSheet.Name = "GM EU Form" Then Else Exit Sub
If ActiveSheet.Name = "GM EU Form" Then
 'If Range("Q18").Value = "" Then MsgBox "Please update Submition Reason before updating Business Units"
        If Range("f20").Value = "" Then Range("A1").Select
        'If Range("f20").Value = "" Then Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(25500, 25500, 0) 'yellow
        
        If Range("f20").Value = "" Then Else Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
        
'            If Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.Value = "See GM Units Multiple Business Units Tab" Then MsgBox "Yes"
'            Sheets("GM Europe Multiple BU &PO").Visible = True
'            Call reseting_GM_BU_multiple_business_field
'            application.ScreenUpdating = True
'            MsgBox "Please select GM Units and respective PO"
'            application.ScreenUpdating = False
        
Else
End If
End Sub

Private Sub ComboBox1_Click()
If ActiveSheet.Name = "GM EU Form" Then Else Exit Sub
   If ActiveSheet.Name = "GM EU Form" Then
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
        Call UnPro

        ' Display a message when one of the designated cells has been
        ' changed.
        
        'MsgBox "Cell " & Target.Address & " has changed."
        If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then
        On Error Resume Next
                    'Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here for multiple Business Unit and Purchase ORG list"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
            Else
            On Error Resume Next
                    If ActiveSheet.ProtectContents = True Then Call UnPro
                    If Range("f20").Value = "See Mass Change tab" Then Else Range("F21:N21").ClearContents
                    Sheets("GM Europe Multiple BU &PO").Visible = False
'                    Range("F21:N21").Locked = True
            
        End If
        On Error GoTo 0

        If Range("f20").Value = "See Mass Change tab" Then
        On Error Resume Next
                    'Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here for updating Mass Change details."
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
                    Sheets("Mass change").Visible = True
            Else
            
            On Error Resume Next
                    If ActiveSheet.ProtectContents = True Then Call UnPro
                   If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then Else Range("F21:N21").ClearContents
                    'Sheets("GM Europe Multiple BU &PO").Visible = False
'                    Range("F21:N21").Locked = True
            
        End If
        On Error GoTo 0

        Call Pro
'    End If
        If Range("f20").Value = "" Then Range("A1").Select
        If Range("F20").Value = "GM Greece - 5H20" Then
                On Error Resume Next
                If Range("B355").EntireRow.Hidden = False Then
                Call UnPro
                
                Range("B354:B429").EntireRow.Hidden = True
                ActiveSheet.CheckBoxes("Checkbox_19").delete
                ActiveSheet.CheckBoxes("Checkbox_20").delete
                ActiveSheet.CheckBoxes("Checkbox_21").delete
                ActiveSheet.CheckBoxes("Checkbox_22").delete
                ActiveSheet.CheckBoxes("Checkbox_23").delete
                ActiveSheet.CheckBoxes("Checkbox_24").delete
                ActiveSheet.CheckBoxes("Checkbox_25").delete
                
                On Error GoTo 0
                Call Pro
                Else
                End If
        Else
        End If
Else
End If
End Sub

Private Sub ComboBox1_GotFocus()
    ComboBox1.ListFillRange = "DropDownLista"
    Me.ComboBox1.DropDown
End Sub

Private Sub CommandButton1_Click()
Call sheetselection
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()

Sheets("GM EU Form").Range("A1").Value = "fu"

Sheets("Index").Range("A1").Value = "furtherupdate"
Sheets("Index").Range("B1").Value = ActiveSheet.Name

Call GM_E_only_validation
'UserForm1.CommandButton7.Visible = True
Call justsave
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton3_Click()

ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select


Call Group9_Click
UnPro
'Range("A1").Value = "S"

        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r & ".xlsm"), FileFormat:=ThisWorkbook.FileFormat
dddnew = ActiveWorkbook.Name
'Windows(ddd).Activate
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Windows(dddnew).Activate

Call Pro
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
Call Group9_Click
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Range("F10").Select
Application.ScreenUpdating = True
End Sub

Private Sub OptionButton1_Click()
'Range("Q3331").Value = "OL"

End Sub

Private Sub OptionButton2_Click()
'Range("Q3331").Value = "WM"
End Sub

Private Sub CommandButton5_Click()
Instruction.Show
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()

mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Application.ScreenUpdating = True
End Sub

Private Sub submit_Click()

mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Application.ScreenUpdating = True
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
If ActiveSheet.Name = "GM EU Form" Then Else Exit Sub
Application.ScreenUpdating = False
Dim KeyCells As Range
 Set KeyCells = Range("Q18")
 
On Error GoTo aaa
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
     If ActiveSheet.ProtectContents = True Then Call UnPro
'continue option visible/invisible
     Sheets("GM EU Form").Range("A1").Value = ""
     Sheets("Index").Range("A1").Value = ""
     'UserForm1.CommandButton7.Visible = False

     
     Range("W1:W3326").ClearContents
    'Range("F20").Value = ""
'    Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.Value = ""


     'Hide unwanted fields
If Sheets("GM EU Form").ProtectContents = True Then Call UnPro
Sheets("GM EU Form").Cells.FormatConditions.delete

'this is for removing yellow highlight'-------------------
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
'--------------------------------------------------------

Call GM_EU_form_entire_field_reset
Cells.ClearComments
'Call reseting_GM_BU_multiple_business_field
Call hideall12



    'delete all check box in BU multiple sheets to reset
'Call checkdelete
'Call reseting_GM_BU_multiple_business_field
'Dim changed As Range
'Dim iLastRow As Long
'Dim i As Long
'Set changed = Intersect(Target, Worksheets("GM EU Form").Range("F18"))
'If Not changed Is Nothing Then
'Worksheets("Multiple BU Tab").Range("B24:B190").EntireRow.Hidden = True
'Select Case Target.Value
'Case "GM Europe"
'Worksheets("Multiple BU Tab").Range("C2:C48").EntireRow.Hidden = False
'Case "GM IO"


If Range("f18").Value = "GM IO" And Range("Q18").Value = "New Duns/Vendor Code creation" Or Range("f18").Value = "GM Europe" And Range("Q18").Value = "New Duns creation" Then
Worksheets("GM EU Form").Activate
Range("B115:B118").Select
    Selection.EntireRow.Hidden = False
    Range("B235:B262").Select
    Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False
 Range("B64:B66").Select
    Selection.EntireRow.Hidden = False
    Range("B423:B429").Select
    Selection.EntireRow.Hidden = False

Range("A442:A446").EntireRow.Hidden = False
Range("f18").Select

'Edit
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False


End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Contact Details Modification" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Hidden = False
Rows("430:441").Hidden = False

'Rows("442:446").Hidden = False
'Rows("120:124").Select
'    Selection.EntireRow.Hidden = False
'Rows("408:419").Select
'    Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
Worksheets("GM EU Form").Activate
Rows("119:124").Select
    Selection.EntireRow.Hidden = False
    Rows("153:161").Select
    Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Modify Payment Terms" Then
Worksheets("GM EU Form").Activate
Rows("119:131").Select
    Selection.EntireRow.Hidden = False
Range("f18").Select
End If
If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Modify Payment Method" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("132:138").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Inactivation/Mark for Deletion" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("139:145").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Others - enter Details in Comments column" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("167:171").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Email ID set up" Then
Worksheets("GM EU Form").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("146:152").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Name / Address modification" Then
Worksheets("GM EU Form").Activate
    Range("B214:B234").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False
Range("f18").Select
End If
If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Bank Account Maintenance" Then
Worksheets("GM EU Form").Activate
    Range("B37:B45").Select
Selection.EntireRow.Hidden = False
Rows("474:478").Hidden = False

Range("f18").Select
End If
If Range("f18").Value = "GM Europe" And Range("Q18").Value = "UBD request [User Block Duns]" Then
Worksheets("GM EU Form").Activate
    Range("B235:B263").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False

     Range("B354:B367").Select
Selection.EntireRow.Hidden = False


Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Factoring Set up" Then
Worksheets("GM EU Form").Activate
    Range("B120:B124").Select
Selection.EntireRow.Hidden = False
   Range("B193:B213").Select
   Selection.EntireRow.Hidden = False
   Rows("442:446").Hidden = False
   Rows("442:446").Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Mass changes" Then
Worksheets("GM EU Form").Activate
    Range("B120:B122").Select
Selection.EntireRow.Hidden = False
   Range("B163:B166").Select
   Selection.EntireRow.Hidden = False
       Sheets("Mass Change").Visible = True
    Sheets("Mass Change").Move After:=Sheets("GM EU Form")
     'Sheets("Mass Change").Select
     
     Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
     Sheets("Mass Change").Range("G1").FormulaR1C1 = "GM EU Form"
     masschangeselect = True
     Sheets("GM EU Form").Select

End If

If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Alternative Payee set up" Then
Worksheets("GM EU Form").Activate
    Range("B120:B124").Select
Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False

Selection.EntireRow.Hidden = False
   Range("B172:B192").Select
   Selection.EntireRow.Hidden = False
   Rows("442:446").Hidden = False
End If


Call hidecheckeu


'Case "GM NA"
'Worksheets("Multiple BU Tab").Range("C75:C105").EntireRow.Hidden = False
'Case "GM SA"
'Worksheets("Multiple BU Tab").Range("C110:C124").EntireRow.Hidden = False
'End Select
'End If

If Range("Q18").Value <> "Mass changes" And Sheets("Mass Change").Visible = True Then
Sheets("Mass Change").Visible = 2
End If

'=====================================
        If Range("F236").EntireRow.Hidden = False Then
'            If ActiveSheet.CheckBoxes("gg").Visible = True Then
            'Else
                Call UnPro
                    
                    ActiveSheet.CheckBoxes.Add(Cells(236, "M").Left, _
                                                Cells(236, "M").Top, _
                                                180, 17.25).Select
                    With Selection
                        .Caption = "Select the checkbox if DUNS is not available"
                        .Value = xlOff '
                        .LinkedCell = "M" & 236
                        .Display3DShading = True
                '        .lock = False
                        .Name = "gg"
                        .OnAction = "header_duns_checkbox_tick"
                    End With
        '            Call Pro
                    'Next
            'End If
        Else
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    ActiveSheet.CheckBoxes("gg").delete
                    'Selection.Delete
                    On Error GoTo 0
            'End If
        End If
      '  If Sheets("GM EU Form").Range("F236").EntireRow.Hidden = True Then Else Sheets("GM EU Form").CheckBox1.Visible = True
      '  If Sheets("GM EU Form").Range("F236").EntireRow.Hidden = True Then Sheets("GM EU Form").CheckBox1.Visible = False

'======================================
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll Down:=9

If ActiveSheet.ProtectContents = False Then Call Pro

'If Range("f18").Value = "GM Europe" And Range("Q18").Value = "Mass changes" Then Sheets("Mass Change").Select
'    'And masschangeselect = "True"

End If

'===============
'hide unhide check boxes in main sheet
'Header Duns is not updated then tick box should be created and have option to update the same in f236
'==================

'==================
    ' The variable KeyCells contains the cells that will
    ' cause an alert when they are changed.
    Set KeyCells = Range("F20")
    
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
        Call UnPro

        ' Display a message when one of the designated cells has been
        ' changed.
        
        'MsgBox "Cell " & Target.Address & " has changed."
        If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then
                    Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here for multiple Business Unit and Purchase ORG list"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
            Sheets("GM Europe Multiple BU &PO").Visible = True
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
                    Range("F21:N21").ClearContents
                    Sheets("GM Europe Multiple BU &PO").Visible = False
                    'Range("F21:N21").Locked = True
        End If

        If Range("f20").Value = "See Mass Change tab" Then
                    Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here to update Mass Change Details"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM EU Form'!F21"
            Sheets("Mass Change").Visible = True
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
                    Range("F21:N21").ClearContents
                    'Sheets("GM Europe Multiple BU &PO").Visible = False
                    'Range("F21:N21").Locked = True
        End If
'Click here to update Mass Change Details

        Call Pro


   End If
'================================
'''Application.ScreenUpdating = False



'additional bank account
 Set KeyCells = Range("V367")
 
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    
        If Range("V367").EntireRow.Hidden = False Then
        Call UnPro
        Range("b368:b422").EntireRow.Hidden = True

                numberofbank = Range("V367").Value
                If numberofbank = "" Then
                Else
                    
                    If numberofbank = 1 Then Range("b368:b378").EntireRow.Hidden = False

                    
                    If numberofbank = 2 Then Range("b368:b389").EntireRow.Hidden = False


                    If numberofbank = 3 Then Range("b368:b400").EntireRow.Hidden = False

                    
                    If numberofbank = 4 Then Range("b368:b411").EntireRow.Hidden = False


                    
                    If numberofbank = 5 Then Range("b368:b422").EntireRow.Hidden = False
                
                    If numberofbank > 5 Then MsgBox "Maximum Additional Bank can be added is 5"
                Call Pro
                End If
        
        Else
        End If
        
    Else
    End If
    

aaa:
On Error GoTo 0
'Exit Sub
'================================
End Sub

'Private Sub Worksheet_Change2(ByVal Target As Range)
'Dim fld As Range
' Set fld = Range("F10")
'
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'           Is Nothing Then
'If Range("f18").Value = "" Then Selection.Interior.Color = 65535 Else Selection.Interior.Pattern = xlNone
'
'End Sub
'
''Private Sub Worksheet_Change(ByVal Target As Range)
''Dim KeyCells As Range
'' Set KeyCells = Range("F12")
''
''    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
''           Is Nothing Then
''
''End Sub
        ''''======================
        '''Private Sub Worksheet_SelectionChange(ByVal Target As Range)
        '''Dim fld As Range
        ''' 'Set fld = Range("F10")
        ''' 'If ActiveCell.Address = "$F$10" Then
        '''
        '''     If Range("f10").EntireRow.Hidden = False Then If Range("f10").Value = "" Then Range("f10").Interior.Color = 65535 Else Range("f10").Interior.Pattern = xlNone
        '''     If Range("f14").EntireRow.Hidden = False Then If Range("f14").Value = "" Then Range("f14").Interior.Color = 65535 Else Range("f14").Interior.Pattern = xlNone
        '''    'Please input the requester name
        '''     If Range("f18").EntireRow.Hidden = False Then If Range("f18").Value = "Please input the requester name" Then Range("f18").Interior.Color = 65535 Else Range("f18").Interior.Pattern = xlNone
        '''     If Range("q18").EntireRow.Hidden = False Then If Range("q18").Value = "" Then Range("q18").Interior.Color = 65535 Else Range("q18").Interior.Pattern = xlNone
        '''     If Range("f20").EntireRow.Hidden = False Then If Range("f20").Value = "" Then Range("f20").Interior.Color = 65535 Else Range("f20").Interior.Pattern = xlNone
        '''
        '''End Sub



Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
  'Check if the Target Address is same as you have given
    'In the above example i have taken A4 Cell, so I am
    'Comparing this with $A$4

    If Target.Range.Address = "$F$21" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
    'MsgBox "Row " & ActiveCell.Row & " is clicked"
    If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then
    Call Pentagon11_Click
    Else
    End If

    If Range("F20").Value = "See Mass Change tab" Then
    mm = ActiveSheet.Name
    Sheets("Mass Change").Select
    Sheets("Index").Range("C1").Value = mm
    Else
    End If

    End If

        If Target.Range.Address = "$F$288" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
        UserForm2.Show
    
        Exit Sub
    End If


End Sub



Sub nidhi()

End Sub













Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 2, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 3, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 4, 4, MSForms, CommandButton"
Attribute VB_Control = "CheckBox1, 6, 5, MSForms, CheckBox"
Attribute VB_Control = "CommandButton5, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 9, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 35, 8, MSForms, CommandButton"

Private Sub CommandButton1_Click()
Call sheetselection
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()

Sheets("GM EU Form").Range("A1").Value = "fu"

Sheets("Index").Range("A1").Value = "furtherupdate"
Sheets("Index").Range("B1").Value = ActiveSheet.Name

'UserForm1.CommandButton7.Visible = True
Call justsave
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton3_Click()

ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select


'Call Group9_Click' deactivated for GM NA
UnPro
'Range("A1").Value = "S"

        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r & ".xlsm"), FileFormat:=ThisWorkbook.FileFormat
dddnew = ActiveWorkbook.Name
'Windows(ddd).Activate
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Windows(dddnew).Activate

Call Pro
Application.ScreenUpdating = True
End Sub



Private Sub CommandButton4_Click()
'Call Group9_Click deactivated for GM NA
    'ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Range("Q18:U18").ClearContents
Range("F20:L20").ClearContents
'Range("Q20:U20").ClearContents

Range("F10").Select
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton5_Click()
Instruction.Show
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()
'Exit Sub
Application.ScreenUpdating = False
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
'Application.ScreenUpdating = True
End Sub

Private Sub submit_Click()

'Exit Sub
Application.ScreenUpdating = False
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
UserForm3.Show
'MsgBox "Finished.!", vbInformation
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
'Application.ScreenUpdating = True
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
If ActiveSheet.Name = "GM_NA" Then Else Exit Sub
Application.ScreenUpdating = False
Dim KeyCells As Range


        Set KeyCells = Range("I711")
    
        If Not Application.Intersect(KeyCells, Range(Target.Address)) _
               Is Nothing Then
        Call ms
        End If
    
 Set KeyCells = Range("Q18")

'Exit Sub
'On Error GoTo aaa
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
     If ActiveSheet.ProtectContents = True Then Call UnPro
'continue option visible/invisible
     Sheets("GM_NA").Range("A1").Value = ""
     Sheets("Index").Range("A1").Value = ""
     'UserForm1.CommandButton7.Visible = False

     
     Range("W1:W3326").ClearContents
    'Range("F20").Value = ""
'    Worksheets("GM_NA").OLEObjects("ComboBox1").Object.Value = ""


     'Hide unwanted fields
If Sheets("GM_NA").ProtectContents = True Then Call UnPro
Sheets("GM_NA").Cells.FormatConditions.delete

'this is for removing yellow highlight'-------------------
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
'--------------------------------------------------------

'Call GM_EU_form_entire_field_reset
'Call reseting_GM_BU_multiple_business_field
'Call hideall13



    'delete all check box in BU multiple sheets to reset
'Call checkdelete
'Call reseting_GM_BU_multiple_business_field
'Dim changed As Range
'Dim iLastRow As Long
'Dim i As Long
'Set changed = Intersect(Target, Worksheets("GM_NA").Range("F18"))
'If Not changed Is Nothing Then
'Worksheets("Multiple BU Tab").Range("B24:B190").EntireRow.Hidden = True
'Select Case Target.Value
'Case "GM North America"
'Worksheets("Multiple BU Tab").Range("C2:C48").EntireRow.Hidden = False
'Case "GM IO"
'Call UnPro
Call clear_all_checkbox
Call clear_all_field_GM_NA
Cells.ClearComments
Range("B24:B3325").EntireRow.Hidden = True
Range("A22:A23").EntireRow.Hidden = True

If Range("f18").Value = "GM North America" And Range("Q18").Value = "New Duns/Vendor Code creation" Or Range("f18").Value = "GM North America" And Range("Q18").Value = "New Duns creation" Then
Worksheets("GM_NA").Activate
Range("B114:B118").Select
    Selection.EntireRow.Hidden = False
    Range("B235:B262").Select
    Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False
 Range("B64:B66").EntireRow.Hidden = False
    Range("A565:A569").Select
    Selection.EntireRow.Hidden = False

Range("A546:A552").EntireRow.Hidden = True
'Range("A62:A63").EntireRow.Hidden = True

Range("f18").Select

'Edit
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False

Call GM_NA_vendorcatogery_and_its_checkboxes
Call EFTCheque_GM_NA_for_banking_details
Call GM_NA_remi_ship_header

End If


'CSIDS===================================================================

If Range("f18").Value = "GM North America" And Range("Q18").Value = "GPS/CCA/Logistics Request" Then
'Call UnPro
Worksheets("GM_NA").Activate
Range("F20:L20").Value = "Not Applicable"
Call UnPro
Range("A666:A748").EntireRow.Hidden = False
'Range("A742:A748").EntireRow.Hidden = False

Range("A713:A720").EntireRow.Hidden = True
Range("A669:A672").EntireRow.Hidden = True
Range("A677:A683").EntireRow.Hidden = True
Range("A705:A710").EntireRow.Hidden = True

'Range("A676").EntireRow.Hidden = True

Range("A677:A679").EntireRow.Hidden = False
'Range("A546:A552").EntireRow.Hidden = True
'Range("A62:A63").EntireRow.Hidden = True

'Call GM_NA_vendorcatogery_and_its_checkboxes
'Call EFTCheque_GM_NA_for_banking_details
'Call GM_NA_remi_ship_header
Else
'Call UnPro
Range("F20:L20").Value = ""
Call UnPro

End If



'========================================================================
'CMBS Vendor Creation (DACOR)
If Range("f18").Value = "GM North America" And Range("Q18").Value = "CMBS Vendor Creation (DACOR)" Then
Worksheets("GM_NA").Activate
Range("B114:B118").Select
    Selection.EntireRow.Hidden = False
    Range("B235:B262").Select
    Selection.EntireRow.Hidden = False
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False
 Range("B64:B66").Select
    Selection.EntireRow.Hidden = False
    Range("A565:A569").Select
    Selection.EntireRow.Hidden = False

Range("A546:A552").EntireRow.Hidden = False
'Range("A62:A63").EntireRow.Hidden = True
Range("f18").Select
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False
'Range("Q20").Value = "DACOR"

Call GM_NA_vendorcatogery_and_its_checkboxes
Call EFTCheque_GM_NA_for_banking_details
Call GM_NA_remi_ship_header
End If


If Range("Q18").Value = "Payment Block/Unblock" Or Range("Q18").Value = "Payment/Posting/Purchasing Block or Unblock" Then
Worksheets("GM_NA").Activate
Range("A214:A219").EntireRow.Hidden = False
'Range("A62:A63").EntireRow.Hidden = True
'Call GM_NA_vendorcatogery_and_its_checkboxes
'Call EFTCheque_GM_NA_for_banking_details
'Call GM_NA_remi_ship_header
'Range("A546:A552").EntireRow.Hidden = False
Range("A565:A569").EntireRow.Hidden = False
Range("A528:A530").EntireRow.Hidden = False

End If


If Range("f18").Value = "GM North America" And Range("Q18").Value = "Tier-2 Vendor Addition" Then
Worksheets("GM_NA").Activate

Range("A217:A234").EntireRow.Hidden = False
Range("A546:A552").EntireRow.Hidden = False

Range("f18").Select

'Edit
'    With Range("F236:L236").Interior
 '       .Pattern = xlNone
  '      .TintAndShade = 0
   '     .PatternTintAndShade = 0
   ' End With
   ' Range("F236:L236").Locked = False

'Call GM_NA_vendorcatogery_and_its_checkboxes

End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Contact Details Modification" Then
Worksheets("GM_NA").Activate
'Rows("120:124").Hidden = False
'Rows("430:441").Hidden = False
Range("A218:A234").EntireRow.Hidden = False
Range("B122:B123").EntireRow.Hidden = True

Range("A120:A124,A146:A152").EntireRow.Hidden = False
Range("A149:A152").EntireRow.Hidden = True
Range("A146:A148").EntireRow.Hidden = True

Range("A542:A544,A553:A561,A565:A569").EntireRow.Hidden = False

'Rows("442:446").Hidden = False
'Rows("120:124").Select
'    Selection.EntireRow.Hidden = False
'Rows("408:419").Select
'    Selection.EntireRow.Hidden = False

Call GM_NA_E_Mail_ID_setup_checkbox
Range("f18").Select
End If


''If Range("f18").Value = "GM North America" And Range("Q18").Value = "Email ID set up" Then
''Worksheets("GM_NA").Activate
''Rows("120:124").Select
''    Selection.EntireRow.Hidden = False
''    Rows("146:152").Select
''Selection.EntireRow.Hidden = False
''Rows("442:446").Hidden = False
''Call GM_NA_E_Mail_ID_setup_checkbox
''Range("f18").Select
''End If


If Range("f18").Value = "GM North America" And Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
Worksheets("GM_NA").Activate
'Rows("119:124").EntireRow.Hidden = False
Rows("153:161").EntireRow.Hidden = False
Range("A214:A234").EntireRow.Hidden = False
Range("A442:A446").EntireRow.Hidden = False

Range("f18").Select
End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Modify Payment Terms" Then
Worksheets("GM_NA").Activate
Rows("119:131").Select
    Selection.EntireRow.Hidden = False
    
'Range("B64:B66").EntireRow.Hidden = False
'Call GM_NA_vendorcatogery_and_its_checkboxes

    
Call GM_NA_Modified_P_term_checkbox
Range("f18").Select
End If
If Range("f18").Value = "GM North America" And Range("Q18").Value = "Modify Payment Method" Then
Worksheets("GM_NA").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("132:138").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Inactivation/Mark for Deletion" Then
Worksheets("GM_NA").Activate
'Rows("120:124").Select
 '   Selection.EntireRow.Hidden = False
    Rows("139:145").Select
Selection.EntireRow.Hidden = False
Range("A214:A234").EntireRow.Hidden = False
'A442:A446
'Range("A442:A446").EntireRow.Hidden = False

Range("f18").Select
End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Others - enter Details in Comments column" Then
Worksheets("GM_NA").Activate
Rows("120:124").Select
    Selection.EntireRow.Hidden = False
    Rows("167:171").Select
Selection.EntireRow.Hidden = False
Range("f18").Select
End If


If Range("f18").Value = "GM North America" And Range("Q18").Value = "Name / Address modification" Then
Worksheets("GM_NA").Activate
Range("B215:B234").EntireRow.Hidden = False
'Rows("442:446").Hidden = False

Range("B109:B110").EntireRow.Hidden = False
Range("A572:A599").EntireRow.Hidden = False

Range("f18").Select

End If
If Range("f18").Value = "GM North America" And Range("Q18").Value = "Bank Account Maintenance" Then
Worksheets("GM_NA").Activate
    Range("B41:B45").Select
Selection.EntireRow.Hidden = False
Range("A565:A569").EntireRow.Hidden = False

Call GM_NA_bank_ac_maintanance_checkbox

Range("A23:A35").EntireRow.Hidden = False

Range("f18").Select
End If
If Range("f18").Value = "GM North America" And Range("Q18").Value = "UBD request [User Block Duns]" Then
Worksheets("GM_NA").Activate
    Range("B235:B263").Select
Selection.EntireRow.Hidden = False
Rows("442:446").Hidden = False
Range("f18").Select
End If

''''    If Range("f18").Value = "GM North America" And Range("Q18").Value = "Factoring Set up" Then
''''    Worksheets("GM_NA").Activate
''''        Range("B120:B124").Select
''''    Selection.EntireRow.Hidden = False
''''       Range("B193:B213").Select
''''       Selection.EntireRow.Hidden = False
''''       Rows("442:446").Hidden = False
''''       Rows("442:446").Hidden = False
''''    Range("f18").Select
''''    End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Mass changes" Then
Worksheets("GM_NA").Activate
    Range("B120:B122").Select
Selection.EntireRow.Hidden = False
   Range("B163:B166").Select
   Selection.EntireRow.Hidden = False
       Sheets("Mass Change").Visible = True
    Sheets("Mass Change").Move After:=Sheets("GM_NA")
     'Sheets("Mass Change").Select
     
     Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
     Sheets("Mass Change").Range("G1").FormulaR1C1 = "GM_NA"
     masschangeselect = True
     Sheets("GM_NA").Select

End If

If Range("f18").Value = "GM North America" And Range("Q18").Value = "Alternative Payee/Factoring Setup" Then

Worksheets("GM_NA").Activate
Range("B120:B124").Select
    
     Range("B354:B367").Select
Selection.EntireRow.Hidden = False


Range("A235:A260").EntireRow.Hidden = False

Selection.EntireRow.Hidden = False
   Range("B172:B192").Select
   Selection.EntireRow.Hidden = False
   Rows("442:446").Hidden = False

Call EFTCheque_GM_NA_for_banking_details

End If

'Call GM_NA_Additional_banking_information
'Call hidecheckeu


'Case "GM NA"
'Worksheets("Multiple BU Tab").Range("C75:C105").EntireRow.Hidden = False
'Case "GM SA"
'Worksheets("Multiple BU Tab").Range("C110:C124").EntireRow.Hidden = False
'End Select
'End If

If Range("Q18").Value <> "Mass changes" And Sheets("Mass Change").Visible = True Then
Sheets("Mass Change").Visible = 2
End If

Call GM_NA_DCB

'=====================================
      '  If Sheets("GM_NA").Range("F236").EntireRow.Hidden = True Then Else Sheets("GM_NA").CheckBox1.Visible = True
      '  If Sheets("GM_NA").Range("F236").EntireRow.Hidden = True Then Sheets("GM_NA").CheckBox1.Visible = False

'======================================
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll Down:=9

If ActiveSheet.ProtectContents = False Then Call Pro

'If Range("f18").Value = "GM North America" And Range("Q18").Value = "Mass changes" Then Sheets("Mass Change").Select
'    'And masschangeselect = "True"

'Call format_condition_for_all_reasons_for_mandatory_field
End If

'===============
'hide unhide check boxes in main sheet
'Header Duns is not updated then tick box should be created and have option to update the same in f236
'==================

'==================
    ' The variable KeyCells contains the cells that will
    ' cause an alert when they are changed.
    Set KeyCells = Range("F20")
    
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
        Call UnPro

Range("B77:B79").EntireRow.Hidden = True
    Range("E66").Value = False
    Range("H66").Value = False
    Range("K66").Value = False
    Range("N66").Value = False
    Range("P66").Value = False
    Range("S66").Value = False

        ' Display a message when one of the designated cells has been
        ' changed.
        
        'MsgBox "Cell " & Target.Address & " has changed."
        If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then
                    Range("F21:N21").Locked = False

                    Range("F21").FormulaR1C1 = "Click here for multiple Business Unit and Purchase ORG list"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM_NA'!F21"
            Sheets("GM_NA_Multiple_BU").Visible = True
            
            If Range("A65").EntireRow.Hidden = False Then Range("F21:N21").ClearContents
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
                    Range("F21:N21").ClearContents
                    Sheets("GM_NA_Multiple_BU").Visible = False
                    'Range("F21:N21").Locked = True
        End If

        If Range("f20").Value = "See Mass Change tab" Then
                    Range("F21:N21").Locked = False
        
                    Range("F21").FormulaR1C1 = "Click here to update Mass Change Details"
                    ActiveSheet.Hyperlinks.Add Anchor:=Range("F21"), Address:="", SubAddress:= _
                        "'GM_NA'!F21"
            Sheets("Mass Change").Visible = True
            
            'Call reseting_GM_BU_multiple_business_field
            
            Else
            
                    If Range("f20").Value = "See GM Units Multiple Business Units Tab" Then Else Range("F21:N21").ClearContents
                    'Sheets("GM_NA_Multiple_BU").Visible = False
                    'Range("F21:N21").Locked = True
        End If
'Click here to update Mass Change Details

        Call Pro


   End If
'================================
'''Application.ScreenUpdating = False


                         Set KeyCells = Range("F69")

                        'Exit Sub
                        'On Error GoTo aaa
                            If Not Application.Intersect(KeyCells, Range(Target.Address)) _
                                   Is Nothing Then
                            Call UnPro
                            If Range("f69").Value = "Yes" Then

                                Range("O115").Value = "SRV - Services- Not Applicable"
                                Range("O117").Value = "Services- Not Applicable"

                                Range("O115:T115,O117:U117").Select
                                With Selection.Interior
                                    .Pattern = xlSolid
                                    .PatternColorIndex = xlAutomatic
                                    .ThemeColor = xlThemeColorAccent5
                                    .TintAndShade = 0.799981688894314
                                    .PatternTintAndShade = 0
                                End With
                                Selection.Locked = True
                                Range("F69:H69").Select
                                
                            Else
                            
                                Range("O115:T115,O117:U117").Select
                                Selection.ClearContents
                                
                                
                                If Range("K66").Value = True Then
                                Else
    
                                    Selection.Locked = False
                                    With Selection.Interior
                                        .Pattern = xlNone
                                        .TintAndShade = 0
                                        .PatternTintAndShade = 0
                                    End With
                                End If
                                    Range("F69:H69").Select
                            End If

                            Call Pro
                            End If

'additional bank account
''''''' Set KeyCells = Range("V367")
'''''''
'''''''    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'''''''           Is Nothing Then
'''''''
'''''''        If Range("V367").EntireRow.Hidden = False Then
'''''''        Call UnPro
'''''''        Range("b368:b422").EntireRow.Hidden = True
'''''''
'''''''                numberofbank = Range("V367").Value
'''''''                If numberofbank = "" Then
'''''''                Else
'''''''
'''''''                    If numberofbank = 1 Then Range("b368:b378").EntireRow.Hidden = False
'''''''
'''''''
'''''''                    If numberofbank = 2 Then Range("b368:b389").EntireRow.Hidden = False
'''''''
'''''''
'''''''                    If numberofbank = 3 Then Range("b368:b400").EntireRow.Hidden = False
'''''''
'''''''
'''''''                    If numberofbank = 4 Then Range("b368:b411").EntireRow.Hidden = False
'''''''
'''''''
'''''''
'''''''                    If numberofbank = 5 Then Range("b368:b422").EntireRow.Hidden = False
'''''''
'''''''                    If numberofbank > 5 Then MsgBox "Maximum Additional Bank can be added is 5"
'''''''                Call Pro
'''''''                End If
'''''''
'''''''        Else
'''''''        End If
'''''''
'''''''    Else
'''''''    End If
    

aaa:
On Error GoTo 0
'Exit Sub
'================================
End Sub

'Private Sub Worksheet_Change2(ByVal Target As Range)
'Dim fld As Range
' Set fld = Range("F10")
'
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'           Is Nothing Then
'If Range("f18").Value = "" Then Selection.Interior.Color = 65535 Else Selection.Interior.Pattern = xlNone
'
'End Sub
'
''Private Sub Worksheet_Change(ByVal Target As Range)
''Dim KeyCells As Range
'' Set KeyCells = Range("F12")
''
''    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
''           Is Nothing Then
''
''End Sub
        ''''======================
        '''Private Sub Worksheet_SelectionChange(ByVal Target As Range)
        '''Dim fld As Range
        ''' 'Set fld = Range("F10")
        ''' 'If ActiveCell.Address = "$F$10" Then
        '''
        '''     If Range("f10").EntireRow.Hidden = False Then If Range("f10").Value = "" Then Range("f10").Interior.Color = 65535 Else Range("f10").Interior.Pattern = xlNone
        '''     If Range("f14").EntireRow.Hidden = False Then If Range("f14").Value = "" Then Range("f14").Interior.Color = 65535 Else Range("f14").Interior.Pattern = xlNone
        '''    'Please input the requester name
        '''     If Range("f18").EntireRow.Hidden = False Then If Range("f18").Value = "Please input the requester name" Then Range("f18").Interior.Color = 65535 Else Range("f18").Interior.Pattern = xlNone
        '''     If Range("q18").EntireRow.Hidden = False Then If Range("q18").Value = "" Then Range("q18").Interior.Color = 65535 Else Range("q18").Interior.Pattern = xlNone
        '''     If Range("f20").EntireRow.Hidden = False Then If Range("f20").Value = "" Then Range("f20").Interior.Color = 65535 Else Range("f20").Interior.Pattern = xlNone
        '''
        '''End Sub



Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
  'Check if the Target Address is same as you have given
    'In the above example i have taken A4 Cell, so I am
    'Comparing this with $A$4

    If Target.Range.Address = "$F$21" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
    'MsgBox "Row " & ActiveCell.Row & " is clicked"
    If Range("F20").Value = "See GM Units Multiple Business Units Tab" Then
    'Call Pentagon11_Click

'    If Range("F20").Value = "See Mass Change tab" Then
    mm = ActiveSheet.Name
    Sheets("GM_NA_Multiple_BU").Visible = True
    Sheets("GM_NA_Multiple_BU").Select
    Sheets("Index").Range("C1").Value = mm
    Else
    End If

    If Range("F20").Value = "See Mass Change tab" Then
                
                mm = ActiveSheet.Name
                Sheets("Masschange_GMNA").Visible = True
                Sheets("Masschange_GMNA").Select
                Sheets("Index").Range("C1").Value = mm
    Else
    End If

    End If

        If Target.Range.Address = "$F$288:$L$288" Then
        'Write your all VBA Code, which you want to execute
        'Or Call the function or Macro which you have
        'written or recorded.
        UserForm2.Show
    'MsgBox Target.Range.Address
        Exit Sub
    End If


End Sub










Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Worksheet_Change(ByVal Target As Range)
'If ActiveSheet.Name = "GM Europe Multiple BU &PO" Then Else Exit Sub
'Application.ScreenUpdating = False
'Dim KeyCells As Range
' Set KeyCells = Range("F1")
'
'On Error GoTo aaa
'    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
'           Is Nothing Then
'    MsgBox "Yes"
'End If
'aaa:
'End Sub
'
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton6, 1862, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton7, 1863, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton8, 1864, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton9, 1865, 8, MSForms, CommandButton"
Attribute VB_Control = "CommandButton10, 1866, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton11, 1867, 10, MSForms, CommandButton"



Private Sub CommandButton1_Click()
     MsgBox "You have selected a non-standard payment term which required additional approval " & Sheets("Validation").Range("C40").Value

End Sub

Private Sub CommandButton2_Click()

End Sub

Private Sub CommandButton3_Click()

End Sub

Private Sub CommandButton4_Click()

End Sub

Private Sub CommandButton10_Click()
Call UnPro
Range("A1").Value = ""
Sheets("Index").Range("A1").Value = ""
Range("Q18").Value = ""
Range("F20").Value = ""
Call Pro
End Sub

Private Sub CommandButton11_Click()
Instruction.Show
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()
ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select
'Sheets("Index").Range("A1").Value = ""
UserForm3.Show
'MsgBox "Finished.!", vbInformation
dddnew = ActiveWorkbook.Name
Windows(ddd).Activate
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select
Windows(dddnew).Activate
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton7_Click()
Call sheetselection
    ActiveWindow.ScrollRow = 1
    'ActiveWindow.SmallScroll Down:=9
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton8_Click()
Call UnPro
Sheets("GM_IO_Form").Range("A1").Value = "fu"

Sheets("Index").Range("A1").Value = "furtherupdate"
Sheets("Index").Range("B1").Value = ActiveSheet.Name

Call Pro
Call justsave

'MsgBox mm & " has been saved in the below directory: " & vbNewLine & vbNewLine & vbNewLine & "Location: " & ActiveWorkbook.FullName, vbInformation

'UserForm1.CommandButton7.Visible = True
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton9_Click()
ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = "S"
Sheets(mm).Select

Call clear_gmio_only_header_info

UnPro
'Range("A1").Value = "S"

        mypath = Application.GetSaveAsFilename(FileFilter:="Excel Files (*.xls), *.xls", Title:="This Location Is Asked For Getting Attachment Is Saved, Please Select The Folder")
        If mypath <> False Then Else Exit Sub
            
        ActiveWorkbook.SaveAs (mypath & r & ".xlsm"), FileFormat:=ThisWorkbook.FileFormat
'Range("A1").Value = "S"
'ddd = ActiveWorkbook.Name
mm = ActiveSheet.Name
Sheets("Index").Visible = True
Sheets("Index").Select
Sheets("Index").Range("E1").Value = ""
Sheets(mm).Select

Call Pro
Application.ScreenUpdating = True

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
'Exit Sub
Dim KeyCells As Range

'#################################################################################################################################
 
Set KeyCells = Range("F20")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call UnPro
    Cells.FormatConditions.delete
    If Range("F20").Value = "Please select a valid Submision reason." Then
    Range("F20").Value = ""
    MsgBox "Please select a valid Submision reason before selecting country name", vbExclamation
    Exit Sub
    End If
    
    Range("GM_IO_Form!V25").Formula = "NOGMBU"
    Range("N25").FormulaR1C1 = "Indirect PO ORG"
    Range("P25").FormulaR1C1 = "Direct PO ORG"
    
        'adding check boxes
 '  Range("A24:A740").EntireRow.Hidden = False
    Range("A24:A998").EntireRow.Hidden = False
    
    Call clear_all_checkbox
    Call clear_GMIO_all_fieled_except_header_info
    Range("A24:A998").EntireRow.Hidden = True
    Sheets("GM_IO_Form").Range("A1").Value = ""
    Sheets("Index").Range("A1").Value = ""
    
    'thailand
    If Range("F20").Value = "Thailand" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A26:A28").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'New Zealand
    If Range("F20").Value = "New Zealand" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A29:A30").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If

    'Australia
    If Range("F20").Value = "Australia" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A31:A33").EntireRow.Hidden = False
    Range("A51").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'Philippines
    If Range("F20").Value = "Philippines" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A34:A35").EntireRow.Hidden = False
    'added new line item recently

    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'Singapore
    If Range("F20").Value = "Singapore" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A36:A38").EntireRow.Hidden = False
    Range("A50").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If

    'Indonesia
    If Range("F20").Value = "Indonesia" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A39:A40").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'India
    If Range("F20").Value = "India" Then
        Range("A24:A25").EntireRow.Hidden = False
        Range("A41:A46").EntireRow.Hidden = False
        Range("A55").EntireRow.Hidden = False
        'Range("A25").EntireRow.Hidden = True
        
            
            'Range("E24").FormulaR1C1 = "GM Region"
            'Range("G24").FormulaR1C1 = "GM IO Business Units"
            Range("N25").FormulaR1C1 = "PO ORG"
            Range("P24:Q25").ClearContents
    
        
    Else
    End If
    
    'Utd.Arab Emir.
    If Range("F20").Value = "Utd.Arab Emir." Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A47:A48").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If
    
    'Vietnam
    If Range("F20").Value = "Vietnam" Then
    Range("A24:A25").EntireRow.Hidden = False
    Range("A49").EntireRow.Hidden = False
    Range("A55").EntireRow.Hidden = False
    Else
    End If


    Call selecting_valid_country



'combination of india/other countries and reason for submition
    If Range("F20").Value = "India" And Range("Q18").Value = "New Duns/Vendor Code creation" Then

    Call Supplier_type_inter_non_inter
    Call TDS_configuration_checkboxes
    'tds below area
    'Range("A93:A107").EntireRow.Hidden = False
    Call new_creation_supplier
    Call EFTCheque
    '''Call banking_information
    'documentation and comment
    'A459:A471
    Range("A986:A998").EntireRow.Hidden = False

    
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "Name / Address modification" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    Range("A165:A189").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "Bank Account Maintenance" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    'Call new_creation_supplier
    '''Call banking_information
    
    Call GM_IO_add_delete_change_bank
       '''Call EFTCheque
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    Range("A986:A993").EntireRow.Hidden = True
    Else
    End If

    If Range("Q18").Value = "Extend to New Business Unit/Company Code" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A197:A203").EntireRow.Hidden = False
    'Call new_creation_supplier
    Call banking_information
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    Else
    End If

    If Range("Q18").Value = "Inactivation\Deletion" And Range("F20").Value <> "" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A978:A985").EntireRow.Hidden = False
    Call inactivat_delete_checkBox
    'Range("A88:A92").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    'Call LowerTDSC_Only
    Else
    End If

    If Range("Q18").Value = "Extend to New Purchasing Org" Then
    
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "New Zealand" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A197:A203").EntireRow.Hidden = False
    'Call new_creation_supplier
    Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    Else
    End If
    Else
    End If

    If Range("Q18").Value = "Modify Payment Terms" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Call payment_term_with_checkbox
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
'    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If
    Else
    End If

    If Range("Q18").Value = "Modify Payment Method" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A232:A238").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A288:A290").EntireRow.Hidden = True
    
    Else
    End If
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "With holding Tax configuration" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A79:A86").EntireRow.Hidden = False
    
        'to hide/get blue shaded color
    Range("J80").Value = ""
    With Range("J80").Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With

    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Call LowerTDSC_Only
    Else
        'to black/unhide
        Call UnPro
    Range("J80").Value = "Tax configuration not required"
    With Range("J80").Font
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
    End With

    
    End If

    If Range("Q18").Value = "With holding Tax configuration" And Range("F20").Value = "Thailand" Or Range("F20").Value = "Philippines" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A288:A290").EntireRow.Hidden = False
    'Range("A79:A86").EntireRow.Hidden = False
    
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    'Call LowerTDSC_Only
    Else
    End If

    If Range("F20").Value = "India" And Range("Q18").Value = "Lower TDS configuration" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    
    'Range("A88:A92").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    Call LowerTDSC_Only
    Else
    End If



    If Range("Q18").Value = "Contact Details Modification" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A240:A252").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    
    Range("A994:A998").EntireRow.Hidden = True
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Email ID set up" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A254:A263").EntireRow.Hidden = False
    
    Range("A259:A262").EntireRow.Hidden = True
    Range("A994:A998").EntireRow.Hidden = True
    
    If Range("F20").Value = "Utd.Arab Emir." Then Range("A975:A977").EntireRow.Hidden = False
    If Range("F20").Value = "Utd.Arab Emir." Then Range("A263").EntireRow.Hidden = True
    
    
    
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A998").EntireRow.Hidden = False
    Call email_id_change_delete_add_GMIO
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Mass changes" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    Range("A210:A214").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    'mass change sheet visible true
    Sheets("Mass Change").Visible = True
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Others - enter Details in Comments column" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Vietnam" Or Range("F20").Value = "India" Or Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    Range("A56:A60").EntireRow.Hidden = False
    'Range("A210:A214").EntireRow.Hidden = False
    'Call new_creation_supplier
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If

    Else
    End If

'combination of Australia or new zealand and reason for submition

    If Range("Q18").Value = "New Duns/Vendor Code creation" Then
    If Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    Call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    'Range("A56:A60").EntireRow.Hidden = False
    'Range("A56:A60").EntireRow.Hidden = False
    Call Beneinter
    
    Call new_creation_supplier_australia_and_newz
    '''Call banking_information
    Call EFTCheque
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Name / Address modification" Then
    If Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    'Range("A56:A60").EntireRow.Hidden = False
    Range("A498:A523").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If
    Else
    End If

'new duns creation for remaining countries
    If Range("Q18").Value = "New Duns/Vendor Code creation" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Vietnam" Then
    Call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    'Range("A56:A60").EntireRow.Hidden = False
   'Range("A56:A60").EntireRow.Hidden = False
    Call new_creation_supplier_other_region
    '''Call banking_information
    Call EFTCheque
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Name / Address modification" Then
    If Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Thailand" Or Range("F20").Value = "Vietnam" Then
    'Call vendorcatogery_and_its_checkboxes
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A570:A590").EntireRow.Hidden = False
    'Range("A56:A60").EntireRow.Hidden = False
   'Range("A56:A60").EntireRow.Hidden = False
    'Call new_creation_supplier_other_region
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

'new duns creation Utd.Arab Emir.
    If Range("Q18").Value = "New Duns/Vendor Code creation" Then
    If Range("F20").Value = "Utd.Arab Emir." Then
    Call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A205:A208").EntireRow.Hidden = False
    Range("A451:A473").EntireRow.Hidden = False
    
    'Call new_creation_supplier_other_region
    Call EFTCheque
    '''Call banking_information
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    
    Else
    End If
    
    Else
    End If

    If Range("Q18").Value = "Name / Address modification" Then
    If Range("F20").Value = "Utd.Arab Emir." Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A973:A975").EntireRow.Hidden = False
    Range("A451:A473").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    'Call banking_information
    'documentation and comment
    Range("A994:A1000").EntireRow.Hidden = False
    Else
    End If
    Else
    End If

'bank account maintance aus, new, viat
'vendornam, beniinter, banking info, doc , comment

    If Range("Q18").Value = "Bank Account Maintenance" Then
    If Range("F20").Value = "Australia" Or Range("F20").Value = "New Zealand" Or Range("F20").Value = "Vietnam" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A56:A60").EntireRow.Hidden = False
    Call Beneinter
    'Range("A451:A473").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    '''Call banking_information
    'Call EFTCheque
    
    Call GM_IO_add_delete_change_bank
    'documentation and comment
    Range("A986:A1000").EntireRow.Hidden = False
    Range("A986:A993").EntireRow.Hidden = True
    
    Else
    End If
    Else
    End If

'Indonesia/Singapore/Philippines/'thai
'vendoname,eftcheck, banking,doc, comment
'that is for thai 'vendorname, eftchecqu (if eft then: no extra and if it is cheq then pickup location),banking info,doc, comment



    If Range("Q18").Value = "Bank Account Maintenance" Then
    If Range("F20").Value = "Utd.Arab Emir." Or Range("F20").Value = "Singapore" Or Range("F20").Value = "Indonesia" Or Range("F20").Value = "Philippines" Or Range("F20").Value = "Thailand" Then
    'call Supplier_type_inter_non_inter
    'Call TDS_configuration_checkboxes
    'tds below area
    'A397:A449
    'A397:A423
    Range("A56:A60").EntireRow.Hidden = False
    ''Call EFTCheque
    
    Call GM_IO_add_delete_change_bank
    'Range("A451:A473").EntireRow.Hidden = False
    'Call new_creation_supplier_australia_and_newz
    '''Call banking_information
    'documentation and comment
    'Call UnPro
    Range("A986:A1000").EntireRow.Hidden = False
    Range("A986:A993").EntireRow.Hidden = True
    Else
    End If
    Else
    End If


Call Pro
End If


 Set KeyCells = Range("Q18")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call UnPro
    Call clear_all_checkbox
    Cells.FormatConditions.delete
'    Range("F20").Value = ""

'ignored mass change request mass change sheet update, hold on
       If Range("F18").Value = "GM IO" And Range("Q18").Value = "Mass changes" Then
           mm = ActiveSheet.Name
       Sheets("Mass Change").Visible = True
        Sheets("Mass Change").Select
        Sheets("Index").Range("C1").Value = mm
       MsgBox "Please update the Mass Change details "
       Exit Sub
       End If
'''''''''''                Worksheets("GM_IO_Form").Activate
'''''''''''                Sheets("Mass Change").Visible = True
'''''''''''                Sheets("Mass Change").Move After:=Sheets("GM_IO_Form")
'''''''''''                 'Sheets("Mass Change").Select
'''''''''''
'''''''''''                 Sheets("Mass Change").Range("F1").FormulaR1C1 = "=COUNTA(C[-4])"
'''''''''''                 Sheets("Mass Change").Range("G1").FormulaR1C1 = "GM_IO_Form"
'''''''''''
'''''''''''                 Sheets("GM_IO_Form").Select
'''''''''''
'''''''''''                'Range("F20").Formula = ""
'''''''''''                Call Pro
'''''''''''                Sheets("Mass Change").Select
'''''''''''                Sheets("Mass Change").Activate
'''''''''''                Application.ScreenUpdating = True
'''''''''''                MsgBox "Please update the Mass Change details "
'''''''''''
'''''''''''
'''''''''''
'''''''''''
'''''''''''                'Application.CutCopyMode = xlCopy
'''''''''''            End If
'            Range("F20").Value = ""
    End If
'Application.CutCopyMode = xlCopy
 Set KeyCells = Range("V25")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then

    Range("P74:S74").Value = ""
    Range("P76:S76").Value = ""
    End If

 Set KeyCells = Range("F74")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call tds_lock_and_unlock_for_india
    End If
    

 Set KeyCells = Range("O120")
    Application.ScreenUpdating = False
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
    Call india_pan_mandatory
    End If
    

 Set KeyCells = Range("P74")
 Application.ScreenUpdating = False
 
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then

If Range("P74").Value = "" Then
Else
        If ActiveSheet.Name = "GM_IO_Form" Then Else Exit Sub
        
        If Range("s41").Value = True Or Range("s42").Value = True Or Range("s43").Value = True Then
            If Range("T74").Value = "GM47" Then
            Else
            'MsgBox "You have selected a non-standard payment term which required additional approval " & Sheets("Validation").Range("C40").Value, vbInformation
            End If
         Else
            If Range("S44").Value = True Then

            If Range("T74").Value = "MNS2" Then
            Else
            'MsgBox "You have selected a non-standard payment term which required additional approval " & Sheets("Validation").Range("C40").Value, vbInformation
            End If

            Else
            End If
         End If
End If
    End If
    

End Sub
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
'MsgBox Sheets("Index").Range("C1").Value
Sheets(Sheets("Index").Range("C1").Value).Select
End Sub
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
'MsgBox Sheets("Index").Range("C1").Value
Sheets(Sheets("Index").Range("C1").Value).Select
End Sub
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton3, 455, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 34, 2, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Sheets("GM_NA").Visible = True
Sheets("GM_NA").Select
End Sub

Private Sub CommandButton2_Click()
Call GM_NA_BU_checkboxes
End Sub

Private Sub CommandButton3_Click()
Range("C7:C34").Value = True
End Sub
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
On Error Resume Next
Sheets(Sheets("Index").Range("D1").Value).Select
End Sub
Attribute VB_Name = "Suport"
Sub aburun()
Attribute aburun.VB_ProcData.VB_Invoke_Func = " \n14"
'
' aburun Macro
'

'
    Range("F18:L18").Select
    With Selection.Interior
        '.Pattern = xlSolid
        '.PatternColorIndex = xlAutomatic
        .Color = 65535
        '.TintAndShade = 0
        '.PatternTintAndShade = 0
    End With
    Range("F20:L20").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F18:L18").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("H21").Select
End Sub

Sub filtr()
Selection.Interior.Color = 65535
Selection.Interior.Pattern = xlNone
End Sub

Sub unlck()
'If InputBox("Input the password", "Password") = "open" Then
For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I
'Else
'MsgBox ("Wrong Password")
'End If
End Sub



Sub if_selected_cell_blank_conditional_format()
Call UnPro
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="="""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6750207
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False


End Sub

Sub GM_EU_form_entire_field_reset()

        Union(Range( _
        "F92:J92,N92:U92,F95:U95,F97:U97,R99:U99,L99:O99,F99:I99,F101:J101,N101:U101,F104:U104,F106:U106,F108:I108,L108:O108,R108:U108,N110:U110,F110:J110,F115:I115,F117:I117,P115:S115,P117:S117,F121:U121,F123:U123,F126:L126,P126:U126,F130:U130,F133:L133,P133:U133" _
        ), Range( _
        "F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170,F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211" _
        ), Range( _
        "F230:U230,F232:U232,F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,F257:L257,N257:U257,F265:L265,F268:U268,F270:U270,F272:J272" _
        ), Range( _
        "F287:L287,F290:U290,F292:U292,F294:J294,M294:U294,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F326:U326,F328:L328,N328:U328,F330:U330,F333:L333,F336:U336" _
        ), Range( _
        "F357:M357,P357:Q357,T357:U357,F359:U359,F361:I361,L361:O361,R361:U361,R363:U363,F363:O363,F365:O365,F369:M369,P369:Q369,T369:U369,F371:U371,R373:U373,L373:O373,F373:I373,F375:O375,R375:U375,F377:O377,T380:U380" _
        ), Range( _
        "R386:U386,F388:O388,F391:M391,P391:Q391,T391:U391,F393:U393,R395:U395,L395:O395,F395:I395,F397:O397,R397:U397,F399:O399,F402:M402,F404:U404,P402:Q402,T402:U402,R406:U406,R408:U408,L406:O406,F408:O408,F406:I406,F410:O410,P413:Q413,T413:U413,F413:M413" _
        ), Range( _
        "D424,D425,D426,D427,D428,F431:N431,F433:N433,F435:J435,M435:U435,F437:U437,F439:U440,F437:U437,F26:I26,F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,D47,D48,D49,D50,D51,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,E70:F70" _
        ), Range("R324:U324,F338:U338,F340:J340,M340:U340,F342:J342,M342:P342,S342:U342,M344:U344,F344:J344,F346:U346,F348:L348,N348:U348,F350:U350,F380:M380,P380:Q380,F382:U382,F384:I384,L384:O384,R384:U384,F386:O386,F415:U415,F417:I417,L417:O417,R417:U417,R419:U419"), Range( _
        "M274:P274,S274:U274,M276:U276,F276:J276,F278:J278,F280:U280,M278:P278,R278:U278,N282:U282,F282:L282,F284:U284,F284:U284,F296:J296,F298:J298,F300:J300,M296:P296,M298:U298,M300:P300,S296:U296,R300:U300,F318:J318,M318:U318,S320:U320,M320:P320,F320:J320" _
        ), Range( _
        "L70:M70,F135:U137,F274:J274,F322:J322,M272:U272,F228:U228,F419:O419,F421:O421,F140:L140,F142:U144,F215:L215,F218:U218,F220:U220,F224:U224,F226:U226,F222:L222,F77:U77,F79:U79,F81:I81,F83:J83,L81:O81,R81:U81,N83:U83,F86:U86,F88:U88,F90:I90,L90:O90,R90:U90" _
        )).Select
Call clear_all_field
'        Union(Range("R324:U324,F338:U338,F340:J340,M340:U340,F342:J342,M342:P342,S342:U342,M344:U344,F344:J344,F346:U346,F348:L348,N348:U348,F350:U350,F380:M380,P380:Q380,F382:U382,F384:I384,L384:O384,R384:U384,F386:O386,F415:U415,F417:I417,L417:O417,R417:U417,R419:U419"), Range( _
'        "M274:P274,S274:U274,M276:U276,F276:J276,F278:J278,F280:U280,M278:P278,R278:U278,N282:U282,F282:L282,F284:U284,F284:U284,F296:J296,F298:J298,F300:J300,M296:P296,M298:U298,M300:P300,S296:U296,R300:U300,F318:J318,M318:U318,S320:U320,M320:P320,F320:J320" _
'        )).Select

    Selection.ClearContents
End Sub

Sub Pro()
'If ActiveSheet.ProtectContents = False Then
Application.ScreenUpdating = False
Dim password    'This line of code is optional
password = "Abu"
ActiveSheet.Protect password, True, True, True
'End If
End Sub

Sub UnPro()
'If ActiveSheet.ProtectContents = True Then
Application.ScreenUpdating = False
password = "Abu"
ActiveSheet.Unprotect password
'End If
End Sub

Sub Prob()
Windows("JUSTapp.xlsm").Activate
If ActiveWorkbook.ProtectStructure Then
Else
ActiveWorkbook.Protect password:="Abu"
End If
End Sub
Sub unProb()
'Windows("JUSTapp.xlsm").Activate
On Error Resume Next
ActiveWorkbook.Unprotect password:="Abu"

End Sub

Sub clear_all_field()

If ActiveSheet.Name = "GM EU Form" Then
Call UnPro
    Union(Range( _
        "F92:J92,N92:U92,F95:U95,F97:U97,R99:U99,L99:O99,F99:I99,F101:J101,N101:U101,F104:U104,F106:U106,F108:I108,L108:O108,R108:U108,N110:U110,F110:J110,F115:I115,F117:I117,P115:S115,P117:S117,F121:U121,F123:U123,F126:L126,P126:U126,F130:U130,F133:L133,P133:U133" _
        ), Range( _
        "F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170,F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211" _
        ), Range( _
        "F230:U230,F232:U232,F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,F257:L257,N257:U257,F265:L265,F268:U268,F270:U270,F272:L272" _
        ), Range( _
        "F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,F328:L328,N328:U328,F330:U330,F333:L333,F336:U336" _
        ), Range( _
        "F348:U348,F350:L350,N350:U350,F352:U352,F357:M357,P357:Q357,T357:U357,F359:U359,F361:I361,L361:O361,R361:U361,R363:U363,F363:O363,F365:O365,F369:M369,P369:Q369,T369:U369,F371:U371,R373:U373,L373:O373,F373:I373,F375:O375,R375:U375,F377:O377,T380:U380" _
        ), Range( _
        "R386:U386,F388:O388,F391:M391,P391:Q391,T391:U391,F393:U393,R395:U395,L395:O395,F395:I395,F397:O397,R397:U397,F399:O399,F402:M402,F404:U404,P402:Q402,T402:U402,R406:U406,R408:U408,L406:O406,F408:O408,F406:I406,F410:O410,P413:Q413,T413:U413,F413:M413" _
        ), Range( _
        "D424,D425,D426,D427,D428,F431:N431,F433:N433,F435:J435,M435:U435,F437:U437,F439:U440,F437:U437,F26:I26,F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,D47,D48,D49,D50,D51,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,E70:F70" _
        ), Range( _
        "L70:M70,F77:U77,F79:U79,F81:I81,F83:J83,L81:O81,R81:U81,N83:U83,F86:U86,F88:U88,F90:I90,L90:O90,R90:U90" _
        ), Range("R417:U417,R419:U419,F419:O419,F421:O421,F415:U415,F135:U137,F140:L140,F142:U144,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228,F274:U274,F276:U276,F278:U278,F280:U280,N282:U282,F282:L282,F284:U284,F338:U338,F340:L340,F342:U342"), Range("R384:U384,F386:O386,F415:U415,F417:I417,L417:O417"), Range("F344:U344,F346:U346,F380:M380,F382:U382,P380:Q380,L384:O384,F384:I384,F380:M380, F443:U445") _
).Select
'ClearContents

    Selection.ClearContents
    Selection.ClearComments
    Selection.FormatConditions.delete
    Range("F259:L259,R259:U259,R255:U255").Select
    Selection.ClearContents
    Selection.ClearComments
    Selection.FormatConditions.delete

Worksheets("GM EU Form").OLEObjects("ComboBox1").Object.BackColor = RGB(255, 255, 255) 'white
Else
End If
End Sub

Sub header_duns_checkbox_tick()

Call UnPro
'1
If Range("M236").Value = True Then
Range("F236").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F236:L236").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F236:L236").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F236:L236").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F236:L236").Locked = False


Range("F236").Value = ""
End If

'2
If Range("M265").Value = True Then
Range("F265").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F265:L265").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F265:L265").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F265:L265").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F265:L265").Locked = False


Range("F265").Value = ""
End If

'3
If Range("M287").Value = True Then
Range("F287").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F287:L287").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F287:L287").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F287:L287").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F287:L287").Locked = False


Range("F287").Value = ""
End If

'4
If Range("M311").Value = True Then
Range("F311").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F311:L311").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F311:L311").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F311:L311").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F311:L311").Locked = False


Range("F311").Value = ""
End If


'5
If Range("M173").Value = True Then
Range("F173").Value = "Conduent will Initiate DUNS Assignment process"
'unedit
    With Range("F173:L173").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
        Range("F173:L173").Locked = True

msg = "yes" 'MsgBox "Conduent will Initiate DUNS Assignment process"
Else


'Edit
    With Range("F173:L173").Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F173:L173").Locked = False


Range("F173").Value = ""
End If


Call Pro
'If msg = "yes" Then MsgBox "Conduent will Initiate DUNS Assignment process"
End Sub

Sub reseting_GM_BU_multiple_business_field()

Application.ScreenUpdating = False
ws = ActiveSheet.Name
'If MsgBox("Do you want to reset the current Business Unit selection?", vbYesNo + vbDefaultButton2) = vbYes Then
    If ws = "GM EU Form" Then
    Sheets("GM Europe Multiple BU &PO").Visible = True
    Sheets("GM Europe Multiple BU &PO").Select
    Call UnPro
    ElseIf ws = "GM IO Form" Then
    Sheets("GM IO Multiple BU &PO").Visible = True
    Sheets("GM IO Multiple BU &PO").Select
    End If
Call checkdelete
    Dim cb As CheckBox
        Range("e2").Select
Cou = Range(ActiveCell, ActiveCell.End(xlDown)).Count - 1
Call UnPro
Dim cel As Range
Dim cbx As CheckBox

cc = 2
For I = 1 To Cou
id = cc + I
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, 4)
        Set cel = ActiveSheet.Cells(id, 4)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Check_" & id
        cbx.Caption = ""
        cbx.OnAction = "add_dynamic"
        cbx.LinkedCell = ActiveSheet.Cells(id, 4).Address
        ActiveSheet.Cells(id, 4).Value = "False"
        ActiveSheet.Cells(id, 4).Activate
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Next

Call DeSelectAllCheckBox

If ws = "GM EU Form" Then
Sheets("GM Europe Multiple BU &PO").Visible = True
Sheets("GM Europe Multiple BU &PO").Select
Range("A1").Select
ElseIf ws = "GM IO Form" Then
Sheets("GM IO Multiple BU &PO").Visible = True
Sheets("GM IO Multiple BU &PO").Select
End If
Sheets("GM EU Form").Select

End Sub

Sub HideAllSheetsBarOne()
shtnm = ActiveSheet.Name
Dim sht As Object

For Each sht In Sheets
If sht.Name <> shtnm Then
sht.Visible = xlSheetHidden
End If
Next sht

End Sub
Sub format_sheet()
    Application.DisplayFormulaBar = False
    ActiveWindow.DisplayHeadings = False
    ActiveWindow.DisplayGridlines = False
    Call Pro
    
End Sub
Sub format_sheet_normal()
    Application.DisplayFormulaBar = True
    ActiveWindow.DisplayHeadings = True
    ActiveWindow.DisplayGridlines = True
    Call Pro
    
End Sub

Sub pack_the_form_to_ready_for_use()
Attribute pack_the_form_to_ready_for_use.VB_ProcData.VB_Invoke_Func = "H\n14"

Call SHEETUNHIDE
Sheets("GM EU Form").Select
Call format_sheet

Sheets("GM_IO_Form").Select
Call format_sheet

Sheets("GM_NA").Select
Call format_sheet

Sheets("Execution Page").Visible = True
Sheets("Execution Page").Select
Call HideAllSheetsBarOne
'ActiveWorkbook.Save
ActiveWindow.DisplayWorkbookTabs = False

End Sub









Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Activate()
'application.DisplayFullScreen = True
'ActiveWindow.DisplayWorkbookTabs = False
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Call change_list_separator_in_system_to_previousone
End Sub

'Private Sub Workbook_BeforeClose(Cancel As Boolean)
'Application.ScreenUpdating = False
'Application.DisplayAlerts = False
'Sheets("Execution Page").Visible = True
'Sheets("Execution Page").Select
'Application.DisplayFullScreen = False
'''Application.ScreenUpdating = False
'End Sub
'________________________________________________________________________
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
If Sheets("Index").Range("E1").Value = "S" Then Exit Sub
Application.DisplayAlerts = False
'                If Range("W1") = "save" Then
'                Cancel = False
'                Exit Sub
'                End If

If ActiveSheet.Name = "GM EU Form" Then
    If Range("A1").Value = "fu" Then
        
    Else
    'MsgBox "Data can not be saved directly, please use 'Save for Furhter Update' Option ", vbInformation
    'Cancel = True
    Exit Sub
    End If
Else
End If


If ActiveSheet.Name = "GM_IO_Form" Then
    If Range("GM_IO_Form!A1").Value = "fu" Then
        
    Else
'    MsgBox "Data can not be saved directly, please use 'Save for Furhter Update' Option ", vbInformation
'    Cancel = True
    Exit Sub
    End If
Else
End If

End Sub

Sub ClearUserdata()
Dim main|fffd|work|fffd|Book As Workbook
Set main|fffd|work|fffd|Book = ActiveWorkbook
mainworkBook.Sheets("GM EU Form").UsedRange.ClearContents
End Sub

Private Sub Workbook_Deactivate()
Application.DisplayFullScreen = False
End Sub

Private Sub Workbook_Open()
Application.ScreenUpdating = False

Sheets("Execution Page").Visible = True
Sheets("Execution Page").Move Before:=Sheets(1)
Call Get_listseparator_in_system
On Error Resume Next
For I = 2 To Sheets.Count
Sheets(I).Visible = 2
Next I
On Error GoTo 0
Application.DisplayFullScreen = True
'UserForm1.Show
'MsgBox Sheets("GM EU Form").Range("A1").Value
'If Sheets("GM EU Form").Range("A1").Value = "fu" Then UserForm1.CommandButton7.Visible = True
If Sheets("Index").Range("A1").Value = "furtherupdate" Then

Sheets(Sheets("Index").Range("B1").Value).Visible = True
Sheets(Sheets("Index").Range("B1").Value).Select
MsgBox Sheets("Index").Range("B1").Value & " has selected by default since the Form is saved for further update by last user" & vbNewLine & vbNewLine & " Please continue with further updates"
Else
UserForm1.Show
End If

'If Sheets("GM_IO_Form").Range("A1").Value = "fu" Then
'Sheets("GM_IO_Form").Visible = True
'Sheets("GM_IO_Form").Select
'Else
'UserForm1.Show
'End If

End Sub

Sub sheetsunhide()
'If InputBox("Input the password", "Password") = "open" Then
For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I
'Else
'MsgBox ("Wrong Password")
'End If
End Sub


Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{58C0982B-7057-42C5-B473-6EABD65BDCD2}{EC423BCB-41B6-4622-86BF-CFE18BF16536}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()

End Sub

Private Sub CommandButton3_Click()
Application.DisplayFullScreen = True
Application.ScreenUpdating = False
'MsgBox "Region is Under Development"
'Exit Sub

UserForm1.Hide
'Unload Me
Sheets("GM_IO_Form").Visible = True
Sheets("GM_IO_Form").Activate

Range("Q18:U18,Q12:U12,Q10:U10,F10:L10,F12:L12,F14:L14,F20:L20").ClearContents
Range("f10").Select
Call UnPro
Range("A1").Value = ""
Sheets("Index").Range("A1").Value = ""
Range("I6").Value = "GMVENDOR.MASTERDATA@CONDUENT.COM"
Call Pro
'Unload Me
   Sheets("Execution Page").Visible = 2
   Application.ScreenUpdating = True
UserForm1.Hide

End Sub

Private Sub CommandButton5_Click()

Application.ScreenUpdating = False
''If Sheets("GM EU Form").Range("A1").Value = "fu" Then
''Sheets("GM EU Form").Select
''Exit Sub
''End If
Unload Me
Application.DisplayFullScreen = True
Call UnPro

Sheets("GM EU Form").Visible = True
'Sheets("VDRF_Instructions_English").Visible = True
'VDRF_Instructions_English
Sheets("GM EU Form").Activate

Call UnPro

                  On Error Resume Next
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    ActiveSheet.CheckBoxes("gg").delete
                                    'Selection.Delete
                                    Call clear_all_checkbox
                On Error GoTo 0
                

If ActiveSheet.Name = "GM EU Form" Then Call clear_all_field

'If ActiveSheet.Name = "GM EU Form" Then Range("Q18").Select
'Selection.ClearContents

'Call UnPro
Range("f10").Select
'Range("C6").Value = "IFSSC_VENDOR_MASTER@Conduent.COM"
Range("F18").Value = "GM Europe"
'u:IFSSC_VENDOR_MASTER@Conduent.COM
'io:GMVENDOR.MASTERDATA@Conduent.COM
'na:OPSVENDORMASTER@Conduent.COM


'On Error Resume Next
 Sheets("GM EU Form").Rows("25:407").Select
    Selection.EntireRow.Hidden = True
    Range("A1").Select
    Sheets("GM EU Form").Select
    Range("A442:A446").EntireRow.Hidden = True
    Call hidecheckeu
    Call Pro
 '   On Error GoTo 0
    Sheets("Execution Page").Visible = 2
Call Pro
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton6_Click()
Application.DisplayFullScreen = True
Application.ScreenUpdating = False
'MsgBox "Region is Under Development"
'Exit Sub

UserForm1.Hide
'Unload Me
Sheets("GM_NA").Visible = True
Sheets("GM_NA").Activate

'Range("Q18:U18,Q12:U12,Q10:U10,F10:L10,F12:L12,F14:L14,F20:L20").ClearContents
Range("f10").Select
Call UnPro
Range("A1").Value = ""
Sheets("Index").Range("A1").Value = ""
Range("D6").Value = "gmnar2phelp@gm.com" '"gmmasterdata@mailgb.custhelp.com"
Call Pro
'Unload Me
   Sheets("Execution Page").Visible = 2
   Application.ScreenUpdating = True
UserForm1.Hide
End Sub

Private Sub CommandButton7_Click()
Sheets("GM EU Form").Visible = True
Sheets("GM EU Form").Select
UserForm1.Hide
End Sub

Private Sub TextBox1_Change()

End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{6BC52EF6-71B1-4D91-9587-9EAFFDFF2AC5}{BBB39ACB-BB74-4DD2-B07D-D0F30FBF0C8B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
UserForm2.Hide
End Sub
Attribute VB_Name = "UserForm22"
Attribute VB_Base = "0{AFF7D3E0-DF0C-447F-9C97-096D1D3A53BF}{9614F0FB-DA31-4FB9-9DD4-DB6B397380FC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
'aa = ComboBox1.Text
'Sheets("GM IO Form").Range("E20").Value = ComboBox1.Text
 Sheets("GM IO Form").Calculate
 Unload Me
 
End Sub

Private Sub CommandButton2_Click()
Call Group9_Click
Unload Me
End Sub


Private Sub UserForm_Initialize()
 With ComboBox1
.ColumnHeads = False
.ColumnCount = 1
.RowSource = "=Validation!d70:d78"
.BoundColumn = 0
End With
End Sub


Sub hh()
Sheets("GM IO Form").Calculate
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{517ADFD5-A343-4773-9245-24DBCEF7D6E5}{546CA990-1C8B-4239-9CB8-D73D60A4E443}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
UserForm3.Hide
Sheets("Index").Range("A1").Value = ""
If UserForm3.OptionButton1.Value = False And UserForm3.OptionButton2.Value = False Then
MsgBox "Please select a valid option to Submit the Form"
Exit Sub

Else
End If
If ActiveSheet.Name = "GM EU Form" Then Call Aj
If ActiveSheet.Name = "GM_IO_Form" Then Call Kudhal
If ActiveSheet.Name = "GM_NA" Then Call Kudhal_GM_NA

Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()
UserForm3.Hide
Exit Sub

End Sub

Attribute VB_Name = "back1"
Sub sheetselection()
ws = ActiveSheet.Name
Sheets("Execution Page").Visible = True
Sheets("Execution Page").Activate
Call Pro
Call HideAllSheetsBarOne
Sheets(ws).Visible = False
UserForm1.Show
End Sub
Sub sheetselectionmultiplebu()
If ActiveSheet.Name = "GM IO Multiple BU &PO" Then
ws = "GM IO Form"

ElseIf ActiveSheet.Name = "GM Europe Multiple BU &PO" Then
ws = "GM EU Form"
End If
If Range("e3") = Empty Then
Call sheetselection
End If

If Range("F1").Value = 0 Then
MsgBox "Please update at least one BU"
Exit Sub
Else
End If

If Range("G1").Value = 0 Then
MsgBox "Please select a valid PO ORG"
Exit Sub
Else
End If

Sheets(ws).Visible = True
Sheets(ws).Activate

End Sub
Sub test()

End Sub
Attribute VB_Name = "cleararea"
Sub cleario()
Attribute cleario.VB_ProcData.VB_Invoke_Func = " \n14"
Dim a, b, c, d, E, f, g, h, mulrng As Range
    Set a = Range("F10:L10,F12:L12,Q10:U10,Q12:U12,F14:L14,F20:L20,F22:L22,Q18:U18")
   Set b = Range("F29:J29,F31:J31,M31:Q31,T31:U31,T35:U35,M35:Q35,F35:J35,F39:L39,F42:U42,F44:U44")
    Set c = Range("F69:L69,F71:U71,F75:L75,F78:U78,F80:U80,F82:U82,F84:J84,M84:U84,F86:J86,M86:U86,M88:U88,F88:J88,F90:J90,M90:U90,L92,F92:N92,F94:N94,F96:J96,M96:U96,F98:U98")
    Set d = Range("F101:L101,F103:U103,F105:U105,F107:U107,F109:J109,M109:U109,F111:J111,M111:U111,F113:J113,M113:U113,F115:J115,M115:U115,I117,F117:N117,F119:N119,F121:J121,M121:U121,F123:U123,F127:L127,F129:U129,F133:I133,F135:I135,F137:I137,P135:S135,P137:S137,F139:U141")
    Set E = Range("F145:L145,F147:U147,F151:U153,F157:I157,O157:U157,F161:U162,F166:I166,O166:U166,F168:U169,F173:N173,F175:N175,F177:J177,F179:U179,M177:U177,F181:U182,F186,F186:N186,F188:N188,F190:U191")
    Set f = Range("F195:U195,F197:U197,F199:U199,F201:J201,M201:U201,F203:J203,H205,F205:N205,F207:N207,F209:J209,M209:U209,F211:U211,F216:Q216,T216:U216,F218:Q218,F220:I220,L220:N220,R220:U220,R222:U222,F222:N222,F224:N224,R224:U224")
    Set g = Range("F231:Q231,F233:Q233,F235:I235,L235:N235,R235:U235,T231:U231,R237:U237,R239:U239,F237:N237,F239:N239,F245:Q245,F247:Q247,T245:U245,R249:U249,L249:N249,F249:I249,F251:N251,R251:U251,R253:U253,F253:N253,F258:Q258,T258:U258,F260:Q260,F262:I262,L262:N262")
    Set h = Range("F271:Q271,F273:Q273,T271:U271,R275:U275,R277:U277,R279:U279,F279:N279,F277:N277,L275:N275,F275:I275,F284:Q284,F286:Q286,T284:U284,R288:U288,R290:U290,R292:U292,L288:N288,F288:I288,F290:N290,F292:N292,F295:U297")
Set mulrng = Union(a, b, c, d, E, f, g, h)
  Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents
  ''Application.ScreenUpdating = False
End Sub
Sub Macro3()
Dim a, b, c, d, E, f, h, mulrng As Range

Set a = Range("F10:L10,Q10:U10,Q12:U12,F12:L12,F14:L14,F18:L18,Q18:U18,F20:L20,F22:L22")
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F128:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F259:L259,R259:U259,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353,F355:O355")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")
For I = 11 To 18
    ActiveSheet.Protection.AllowEditRanges.Add Title:="Range" & I, Range:=h
 Next I
End Sub



Sub hideallIO()
Call UnPro
Set b = Range("F29:J29,F31:J31,M31:Q31,T31:U31,T35:U35,M35:Q35,F35:J35,F39:L39,F42:U42,F44:U44")
    Set c = Range("F69:L69,F71:U71,F75:L75,F78:U78,F80:U80,F82:U82,F84:J84,M84:U84,F86:J86,M86:U86,M88:U88,F88:J88,F90:J90,M90:U90,L92,F92:N92,F94:N94,F96:J96,M96:U96,F98:U98")
    Set d = Range("F101:L101,F103:U103,F105:U105,F107:U107,F109:J109,M109:U109,F111:J111,M111:U111,F113:J113,M113:U113,F115:J115,M115:U115,I117,F117:N117,F119:N119,F121:J121,M121:U121,F123:U123,F127:L127,F129:U129,F133:I133,F135:I135,F137:I137,P135:S135,P137:S137,F139:U141")
    Set E = Range("F145:L145,F147:U147,F151:U153,F157:I157,O157:U157,F161:U162,F166:I166,O166:U166,F168:U169,F173:N173,F175:N175,F177:J177,F179:U179,M177:U177,F181:U182,F186,F186:N186,F188:N188,F190:U191")
    Set f = Range("F195:U195,F197:U197,F199:U199,F201:J201,M201:U201,F203:J203,H205,F205:N205,F207:N207,F209:J209,M209:U209,F211:U211,F216:Q216,T216:U216,F218:Q218,F220:I220,L220:N220,R220:U220,R222:U222,F222:N222,F224:N224,R224:U224")
    Set g = Range("F231:Q231,F233:Q233,F235:I235,L235:N235,R235:U235,T231:U231,R237:U237,R239:U239,F237:N237,F239:N239,F245:Q245,F247:Q247,T245:U245,R249:U249,L249:N249,F249:I249,F251:N251,R251:U251,R253:U253,F253:N253,F258:Q258,T258:U258,F260:Q260,F262:I262,L262:N262")
    Set h = Range("F271:Q271,F273:Q273,T271:U271,R275:U275,R277:U277,R279:U279,F279:N279,F277:N277,L275:N275,F275:I275,F284:Q284,F286:Q286,T284:U284,R288:U288,R290:U290,R292:U292,L288:N288,F288:I288,F290:N290,F292:N292,F295:U297")
Set mulrng = Union(b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents
 Sheets("GM IO Form").Rows("24:669").Select
    Selection.EntireRow.Hidden = True
End Sub

Attribute VB_Name = "emailIo"
Sub E_maiaIO()
Dim rng As Range
Dim OutApp As Object
Dim OutMail As Object
Dim aw As String
Application.ScreenUpdating = False
If Sheets("GM IO Form").Range("q18").Value = "New Duns creation" And Range("d66").Value = False And Range("G66").Value = False And Range("K66").Value = False And Range("N66").Value = False And Range("o66").Value = False And Range("S66").Value = False Then
     MsgBox "Please Select the appropriate vendor category", vbExclamation, "Required Entry"
     Exit Sub
End If
      If Sheets("GM IO Form").Range("F10").Value = "" Then
     MsgBox "Please enter Requester name", vbExclamation, "Required Entry"
     Exit Sub
   End If
   
   If Sheets("GM IO Form").Range("F14").Value = "" Then
     MsgBox "Please enter Requester email ID", vbExclamation, "Required Entry"
     Exit Sub
   End If
   
   If Sheets("GM IO Form").Range("F18").Value = "" Then
     MsgBox "Please select GM Region", vbExclamation, "Required Entry"
     Exit Sub
   End If
   If Sheets("GM IO Form").Range("Q18").Value = "" Then
     MsgBox "Please select Submission reason", vbExclamation, "Required Entry"
     Exit Sub
   End If
   If Sheets("GM IO Form").Range("F20").Value = "" Then
     MsgBox "Please select GM Business Unit", vbExclamation, "Required Entry"
     Exit Sub
     End If
     
  If Sheets("GM IO Form").Range("Q18").Value = "Email ID set up" And Sheets("GM IO Form").Range("F32").Value = "" Then
     MsgBox "Please Enter Duns or Vendor code in Cell F32", vbExclamation, "Required Entry"
     Exit Sub
     End If
     
  If Sheets("GM IO Form").Range("M18").Value = "Email ID set up" And Sheets("GM IO Form").Range("E34").Value = "" Then
     MsgBox "Please Enter Supplier name in Cell E34", vbExclamation, "Required Entry"
     Exit Sub
     End If
      If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value = 0 Then
     MsgBox "Please Select the BU from 'GM IO Multiple BU &PO'", vbExclamation, "Required Entry"
     Exit Sub
     End If
     If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value <> 0 Then
     Sheets("GM IO Multiple BU &PO").Select
     er = Range("e2").End(xlDown).Row
     Range("a2:F5000").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$2:$F$5100").AutoFilter Field:=4, Criteria1:="TRUE"
    End If
    If MsgBox("Do you really want to submit?", vbOKCancel + vbDefaultButton2, "Confirm submit") = vbCancel Then
Exit Sub
End If
     ActiveWorkbook.Save
     Application.ScreenUpdating = False
     For I = 1 To Sheets.Count
     Sheets(I).Visible = True
     Next I
aw = Application.ActiveWorkbook.Path & "\"
   tb = InputBox("give the file name")
   ta = tb & ".pdf"
   tt = aw & ta
   If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value <> 0 Then
    Sheets("GM IO Form").Move Before:=Sheets(1)
   Sheets("GM IO Multiple BU &PO").Move Before:=Sheets(2)
For I = 1 To 2
Sheets(I).Select
Call page
If I = 2 Then
tt1 = aw & tb & "Bu selection.pdf"

 With ActiveSheet
    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=tt1, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  End With
   
Else
 With ActiveSheet
    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=tt, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  End With
   Call page
End If
Next I
Else
   Sheets("GM IO Form").Select
      Call page
    With ActiveSheet
    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=tt, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
  End With
    End If
Set rng = Nothing

Set rng = Sheets("GM IO Form").Range("B9:v24").SpecialCells(xlCellTypeVisible)

If rng Is Nothing Then
    MsgBox "The selection is not a range or the sheet is protected. " & _
           vbNewLine & "Please correct and try again.", vbOKOnly
    Exit Sub
End If

With Application
    .EnableEvents = False
    .ScreenUpdating = False
End With

Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

subm = ThisWorkbook.Sheets("GM IO Form").Range("Q18").Value

If ThisWorkbook.Sheets("GM IO Form").Range("f26").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f26").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f38").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f38").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f121").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f121").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f215").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f215").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f236").Value <> Empty Then
DUN = ThisWorkbook.Sheets("GM IO Form").Range("f236").Value
End If

If ThisWorkbook.Sheets("GM IO Form").Range("f28").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f28").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f40").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f40").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f123").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f123").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f218").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f218").Value
ElseIf ThisWorkbook.Sheets("GM IO Form").Range("f239").Value <> Empty Then
SUP = ThisWorkbook.Sheets("GM IO Form").Range("f239").Value
End If
subj = subm + "-" + DUN + "-" + SUP
With OutMail
    .To = ""
    .cc = ""
    .BCC = ""
    .Subject = subj
    .HTMLBody = "Hello Master Data CoE,<Br>" & RangetoHTML(rng)
    On Error Resume Next
    .Attachments.Add tt
    .Attachments.Add tt1
    On Error GoTo 0
    .display
End With
On Error GoTo 0

With Application
    .EnableEvents = True
    .ScreenUpdating = True
End With

Set OutMail = Nothing
Set OutApp = Nothing
  If Sheets("GM IO Form").Range("U20").Value <> "" And Sheets("GM IO Multiple BU &PO").Range("f1").Value <> 0 Then
  Sheets("GM IO Multiple BU &PO").Select
  Range("A1").Select
  Selection.AutoFilter
  End If
   For I = 3 To Sheets.Count
     Sheets(I).Visible = 2
     Next I
     ''Application.ScreenUpdating = False
     Sheets("GM IO Form").Select
End Sub


Function RangetoHTML(rng As Range)
' By Ron de Bruin.
    Dim fso As Object
    Dim ts As Object
    Dim TempFile As String
    Dim TempWB As Workbook
Sheets("GM IO Form").Select
    TempFile = Environ$("temp") & "/" & Format(Now, "dd-mm-yy h-mm-ss") & ".htm"

    'Copy the range and create a new workbook to past the data in
    rng.Copy
    Set TempWB = Workbooks.Add(1)
    With TempWB.Sheets(1)
        .Cells(1).PasteSpecial Paste:=8
        .Cells(1).PasteSpecial xlPasteValues, , False, False
        .Cells(1).PasteSpecial xlPasteFormats, , False, False
        .Cells(1).Select
        Application.CutCopyMode = False
        On Error Resume Next
        .DrawingObjects.Visible = True
        .DrawingObjects.delete
        On Error GoTo 0
    End With

    'Publish the sheet to a htm file
    With TempWB.PublishObjects.Add( _
         SourceType:=xlSourceRange, _
         Filename:=TempFile, _
         Sheet:=TempWB.Sheets(1).Name, _
         Source:=TempWB.Sheets(1).UsedRange.Address, _
         HtmlType:=xlHtmlStatic)
        .Publish (True)
    End With

    'Read all data from the htm file into RangetoHTML
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)
    RangetoHTML = ts.ReadAll
    ts.Close
    RangetoHTML = Replace(RangetoHTML, "align=center x:publishsource=", _
                          "align=left x:publishsource=")

    'Close TempWB
    TempWB.Close savechanges:=False

    'Delete the htm file we used in this function
    Kill TempFile

    Set ts = Nothing
    Set fso = Nothing
    Set TempWB = Nothing
End Function

Sub justsaveio()
If MsgBox("Are you want to save the workbook?" & Chr(13) & "Please submit the form only after the complete updates.", vbYesNo, "Save") = vbNo Then
Exit Sub
End If
Application.ScreenUpdating = False

Range("W1").Select
    ActiveCell.FormulaR1C1 = "save"
ActiveWorkbook.Save
 
Range("W1").Select
    ActiveCell.FormulaR1C1 = ""
    ''Application.ScreenUpdating = False
End Sub



Attribute VB_Name = "eubuttons"
Sub Addbuttons()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 1
For Each cel In Range("g42,J42,O42,F43").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 1 And id = 0 Then
id = 1
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
' height will autosize larger to the font
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
 ' with a linked can trap sheet change event or link to other formulas
        cbx.LinkedCell = c
        If id <= 2 Then
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!bankdetails"
        Else
        cbx.OnAction = "'" & ThisWorkbook.Name & "'!BnkDetails"
        End If
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del1()
For I = 1 To 4
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons1()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 5
For Each cel In Range("G30,J30,N30").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)


If I = 5 And id = 0 Then
id = 5
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
 ''Application.ScreenUpdating = False
 
    
End Sub

Sub Del2()
For I = 5 To 7
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons2()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 8
For Each cel In Range("G147,J147,N147").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)


If I = 8 And id = 0 Then
id = 8
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
 ''Application.ScreenUpdating = False
 
    
End Sub

Sub Del3()
For I = 8 To 10
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub

Sub Addbuttons3()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 11
For Each cel In Range("G261,L261,o261,S261").Cells
Application.ScreenUpdating = False
c = cel.Address
If c = Range("S261").Address Then
c = Range("r261").Address
Else
c = cel.Address
End If
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)

If I = 11 And id = 0 Then
id = 11
Else
id = id + 1
End If
If id = 14 Then
id = 50
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
           cbx.LinkedCell = c
           cbx.Display3DShading = True
           cbx.OnAction = "'" & ThisWorkbook.Name & "'!Alternative_" & id
    Next


 ''Application.ScreenUpdating = False
 
    
End Sub

Sub Del4()
For I = 11 To 13
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
    ActiveSheet.CheckBoxes("Checkbox_50").Select
    Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_50").delete
 On Error GoTo 0
    
End Sub
Sub Addbuttons4()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 14
For Each cel In Range("G65,J65,M65,P65,s65").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 14 And id = 0 Then
id = 14
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
For I = 14 To 18
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.OnAction = "bank" & I
Next I
I = 13
For Each cel In Range("e66,e75,e84,e93,e102").Cells
I = I + 1
c = cel.Address
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
Selection.LinkedCell = c
Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del5()
For I = 14 To 18
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons5()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 19
For Each cel In Range("G366,J366,M366,P366,s366").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 19 And id = 0 Then
id = 19
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
For I = 19 To 23
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.OnAction = "bank" & I
Next I
I = 18
For Each cel In Range("G367,J367,M367,P367,s367").Cells
I = I + 1
c = cel.Address
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
Selection.LinkedCell = c
Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del6()
For I = 19 To 23
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons6()

Dim I As Long, id As Long

Dim cel As Range
Dim cbx As CheckBox
I = 24
For Each cel In Range("n355,r355").Cells
Application.ScreenUpdating = False
c = cel.Address
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 24 And id = 0 Then
id = 24
Else
       id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next

 ''Application.ScreenUpdating = False
End Sub

Sub Del7()
For I = 24 To 25
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
 On Error GoTo 0
    
End Sub
Sub Addbuttons7()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 26
For Each cel In Range("D65,G65,K65,N65,o65,s65").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 26 And id = 0 Then
id = 26
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
   c = Cells(d + 1, E).Address
    
        ActiveSheet.CheckBoxes("Checkbox_" & id).Select
          Selection.OnAction = "Count"
Selection.LinkedCell = c
    Next
 ''Application.ScreenUpdating = False
End Sub

Sub Del8()
For I = 26 To 31
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
Selection.FormatConditions.delete
ActiveSheet.CheckBoxes("Checkbox_" & I).delete
Next
On Error GoTo 0
End Sub
Sub Addbuttons8()
Dim cel As Range
Dim cbx As CheckBox
Set rng = ActiveSheet.Cells(70, 17)
With cel
Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
End With
cbx.Name = "Checkbox_32"
cbx.Caption = ""
cbx.Display3DShading = True
End Sub
Sub Del9()
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_32").Select
Selection.FormatConditions.delete
ActiveSheet.CheckBoxes("Checkbox_32").delete
On Error GoTo 0
End Sub

Sub Addbuttons9()
Dim I As Long, id As Long
Dim cel As Range
Dim cbx As CheckBox
I = 60
For Each cel In Range("F128,I128").Cells
Application.ScreenUpdating = False
d = cel.Row
E = cel.Column
Cells(d, E).Activate
Set rng = ActiveSheet.Cells(d, E)
If I = 60 And id = 0 Then
id = 60
Else
id = id + 1
End If
        Set cel = ActiveSheet.Cells(d, E)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Checkbox_" & id
        cbx.Caption = ""
        cbx.Display3DShading = True
    Next
 ''Application.ScreenUpdating = False
End Sub
Sub Del10()
For I = 60 To 62
On Error Resume Next
ActiveSheet.CheckBoxes("Checkbox_" & I).Select
  Selection.FormatConditions.delete
  ActiveSheet.CheckBoxes("Checkbox_" & I).delete
    Next
End Sub
Attribute VB_Name = "euclear"
Sub Group9_Click()
Call UnPro
ws1 = ActiveSheet.Name
If ActiveSheet.Name = "GM IO Form" Then
Call cleario
Sheets("GM IO Form").Rows("24:669").Select
    Selection.EntireRow.Hidden = True
    Range("A1").Select
    Call hidecheckio
    On Error Resume Next
ActiveSheet.CheckBoxes.delete
Selection.FormatConditions.delete
On Error GoTo 0
  
ElseIf ActiveSheet.Name = "GM EU Form" Then
If MsgBox("Do you really want to clear the Contents??", vbOKCancel, "Clear") = vbCancel Then
Call Pro
Exit Sub
Else
Dim a, b, c, d, E, f, h, I, mulrng As Range

Set a = Range("Q18:U18,F20:L20,F22:L22")
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F259:L259,R259:U259,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F369:M369,P369:Q369,T369:U369,F371:U371,F373:I373,L373:O373,R373:U373,R375:U375,F375:O375,F377:O377,F380:M380,P380:Q380,T380:U380,F382:U382,R384:U384,R386:U386,L384:O384,F386:O386,F384:I384,F388:O388,P391:Q391,F391:M391,T391:U391,F393:U393,L395:O395")
Set h = Range("T402:U402,F404:U404,R406:U406,R408:U408,L406:O406,F406:I406,F408:O408,F410:O410,F413:M413,F415:U415,P413:Q413,T413:U413,F417:I417,L417:O417,R417:U417,R419:U419,F421:O421,F419:O419,D424:D428,F369:M369,P369:Q369,T369:U369,F371:U371,F373:I373,L373:O373")
Set mulrng = Union(a, b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents
Call UnPro
Sheets("GM EU Form").Rows("24:669").Select

    Selection.EntireRow.Hidden = True
    Range("A1").Select
''Application.ScreenUpdating = False
End If
On Error Resume Next
ActiveSheet.CheckBoxes.delete
Selection.FormatConditions.delete
On Error GoTo 0
End If
Application.ScreenUpdating = False

For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I

Sheets(ws1).Move Before:=Sheets(1)
For I = 2 To Sheets.Count
Sheets(I).Visible = 2
Next I
''Application.ScreenUpdating = False
If ActiveSheet.Name = "GM EU Form" Then Call clear_all_field
Call Pro
End Sub
Sub Macro2()

Dim rng As Range
Set rng = Range("F10:L10,F12:L12,Q10:U10,Q12:U12,F14:L14,F18:L18,F20:L20,Q18:U18,F22:L22")
cl = rng.Value
For Each cl In rng
If cl = Empty Then
MsgBox ("empty")
End If
Next
    Range("F22").Activate
End Sub

Sub unhide()

Application.ScreenUpdating = False
   Rows("25:669").Select
    Selection.EntireRow.Hidden = False
    Range("a1").Select
If ActiveSheet.Name = "GM EU Form" Then
    Call bankdetails
        Call hidecheckeu
        ElseIf ActiveSheet.Name = "GM IO Form" Then
        Call hidecheckio
        
        End If

''Application.ScreenUpdating = False
        End Sub

Sub hideall12()
Call UnPro
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")

Set mulrng = Union(b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents

                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

 Sheets("GM EU Form").Rows("24:3325").Select
    Selection.EntireRow.Hidden = True

End Sub


Sub hideall13()
Call UnPro
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:S121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")

Set mulrng = Union(b, c, d, E, f, g, h)
Application.ScreenUpdating = False
mulrng.Select
Selection.ClearContents

                            Range("F357").ClearComments
                            Range("R363").ClearComments
                            Range("F363").ClearComments

 Sheets("GM_NA").Rows("24:3325").Select
    Selection.EntireRow.Hidden = True

End Sub
    
Sub TTE()
Dim a, b, c, d, E, f, h, mulrng As Range

Set a = Range("F10:L10,Q10:U10,Q12:U12,F12:L12,F14:L14,F18:L18,Q18:U18,F20:L20,F22:L22")
Set b = Range("F26:I26,F28:U28,F32:N32,F34:N34,F38:I38,F40:U40,F55:U55,F57:U57,F59:I59,L59:O59,R59:U59,N61:U61,F61:J61,D47,D48,D49,D50,D51,E70:F70,L70:M70")
Set c = Range("F115:I115,P115:S115,P117:S117,F117:I117,F121:U121,F123:U123,F126:L126,F130:U130,F133:L133,F135:U137,F140:L140,F142:U144,F149:N149,F151:N151,F154:I154,F156:L156,F158:U160,F163:U165,F168:U170,P126:U126,P133:U133")
Set d = Range("F173:L173,F176:U176,F178:U178,F180:L180,F182:U182,F184:U184,F186:U186,F188:U188,F190:U190,F194:L194,F197:U197,F199:U199,F201:L201,F203:U203,F205:U205,F207:U207,F209:U209,F211:U211,F215:L215,F218:U218,F220:U220,F222:L222,F224:U224,F226:U226,F228:U228")
Set E = Range("F236:L236,F239:U239,F241:U241,F243:U243,M245:U245,F245:J245,F247:J247,N247,M247:P247,S247:U247,M249:U249,F249:J249,F251:J251,M251:P251,R251:U251,F253:N253,F255:N255,N257:U257,F257:L257,F259:L259,R259:U259,F265:L265,F268:U268,F270:U270,F272:L272,F274:U274,F276:U276")
Set f = Range("F287:L287,F290:U290,F292:U292,F294:L294,F296:U296,F298:U298,F300:U300,F302:I302,F304:U304,F306:L306,N306:U306,F308:U308,F311:L311,F314:U314,F316:U316,F318:L318,F320:U320,F322:U322,F324:U324,F326:U326,N328:U328,F328:L328,F330:U330")
Set g = Range("F335:M335,P335:Q335,T335:U335,F337:U337,F339:I339,L339:O339,R339:U339,R341:U341,F341:O341,F343:O343,F347:M347,P347:Q347,T347:U347,F349:U349,L351:O351,F351:I351,R351:U351,R353:U353,F353:O353,F355:O355")
Set h = Range("F358:M358,F360:U360,P358:Q358,T358:U358,R362:U362,T369:U369")
a.Select
b.Select
c.Select
d.Select
E.Select
f.Select
g.Select
h.Select
End Sub
Attribute VB_Name = "eutickselection"
Sub Alternative_11()
If ActiveSheet.ProtectContents = True Then Call UnPro
Application.ScreenUpdating = False
If Range("G261").Value = False Then
    Range("B263:B285").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
    Range("B264:B285").Select
    Selection.EntireRow.Hidden = False
      Range("F265").Select
    End If
''Application.ScreenUpdating = False

Range("K272").Value = "City"
Range("K274").Value = "PO Box- City"
Range("K276").Value = "VAT ID"
Range("K278").Value = "Tax No. 2"
Range("Q274").Value = "PO Box-Postal code"
Range("Q278").Value = "Tax No. 3"


If ActiveSheet.ProtectContents = False Then Call Pro
End Sub
Sub Alternative_12()
If ActiveSheet.ProtectContents = True Then Call UnPro
Application.ScreenUpdating = False
If Range("L261").Value = False Then
    Range("B286:B309").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
     Range("B286:B309").Select
    Selection.EntireRow.Hidden = False
    Range("F287").Select
    End If
Range("K294").Value = "City"
Range("K296").Value = "PO Box- City"
Range("K298").Value = "VAT ID"
Range("K300").Value = "Tax No. 2"
Range("Q296").Value = "PO Box-Postal code"
Range("Q300").Value = "Tax No. 3"

    ''Application.ScreenUpdating = False
If ActiveSheet.ProtectContents = False Then Call Pro
End Sub
Sub Alternative_13()
Call UnPro
Application.ScreenUpdating = False
If Range("O261").Value = False Then
    Range("B310:B331").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
   Range("B310:B331").Select
    Selection.EntireRow.Hidden = False
     Range("B323:B326").Select
    Selection.EntireRow.Hidden = True
    Range("F311").Select
    End If

Range("K318").Value = "City"
Range("K320").Value = "PO Box- City"
Range("K322").Value = "VAT ID"
'Range("Q320").Value = "Tax No. 2"
Range("Q320").Value = "PO Box-Postal code"
'Range("Q300").Value = "Tax No. 3"
    ''Application.ScreenUpdating = False
End Sub

Sub bank19()
Call UnPro
Application.ScreenUpdating = False

Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 1
'If Range("G367") = False Then
'    Range("b368:b378").Select
'    Selection.EntireRow.Hidden = True
'    Range("F357").Select
'    Else
'    Range("b368:b378").Select
'    Selection.EntireRow.Hidden = False
'      Range("F369").Select
'    End If
'    ''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
    
    Call Pro
End Sub
Sub bank20()
Call UnPro
Application.ScreenUpdating = False
Range("G367").Value = False
'Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 2
'    If Range("J367") = False Then
'   Range("b379:b389").Select
'      Selection.EntireRow.Hidden = True
'     Range("F357").Select
'      Else
'    Range("b379:b389").Select
'      Selection.EntireRow.Hidden = False
'       Range("F380").Select
'      End If
'      ''Application.ScreenUpdating = False

If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub bank21()
Call UnPro
Application.ScreenUpdating = False

Range("G367").Value = False
Range("J367").Value = False
'Range("M367").Value = False
Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 3
'      If Range("M367") = False Then
'    Range("b390:b400").Select
'    Selection.EntireRow.Hidden = True
'  Range("F357").Select
'    Else
'    Range("b390:b400").Select
'    Selection.EntireRow.Hidden = False
'     Range("F391").Select
'    End If
'    ''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub bank22()
Call UnPro
Application.ScreenUpdating = False

Range("G367").Value = False
Range("J367").Value = False
Range("M367").Value = False
'Range("P367").Value = False
Range("S367").Value = False

Range("V367").Value = 4
'    If Range("P367") = False Then
'    Range("b401:b411").Select
'    Selection.EntireRow.Hidden = True
'       Range("F357").Select
'    Else
'        Range("b401:b411").Select
'    Selection.EntireRow.Hidden = False
'    Range("F402").Select
'    End If
'    ''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub bank23()
Call UnPro
Range("G367").Value = False
Range("J367").Value = False
Range("M367").Value = False
Range("P367").Value = False
'Range("S367").Value = False
Range("V367").Value = 5
'Application.ScreenUpdating = False
'     If Range("S367") = False Then
'    Range("b412:b422").Select
'    Selection.EntireRow.Hidden = True
'Range("F357").Select
'  Else
'  Range("b412:b422").Select
'    Selection.EntireRow.Hidden = False
'     Range("F413").Select
'    End If
'    '''Application.ScreenUpdating = False
If Range("G367").Value = False And _
Range("J367").Value = False And _
Range("M367").Value = False And _
Range("P367").Value = False And _
Range("S367").Value = False Then Range("V367").Value = 0
Call Pro
End Sub
Sub all()
  Dim cb As CheckBox
        Range("e2").Select
Cou = Range(ActiveCell, ActiveCell.End(xlDown)).Count - 1

Dim cel As Range
Dim cbx As CheckBox
cc = 2
For I = 1 To Cou
id = cc + I
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, 4)
        Set cel = ActiveSheet.Cells(id, 4)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Check_" & id
        cbx.Caption = ""
    Next
End Sub

Sub BnkDetails()
Call UnPro
Application.ScreenUpdating = False
'If Range("O42") = True Or Range("f43") = True Then
If Range("O42") = True Then
    Rows("354:367").Select
    Selection.EntireRow.Hidden = False
          Rows("366:366").Select
          Selection.EntireRow.Hidden = True
          Range("F357").Select
Else
    Rows("354:367").Select
    Selection.EntireRow.Hidden = True
Call bankdetails
''Application.ScreenUpdating = False
End If
Call hidecheckeu
Call Pro
End Sub

Sub Count()
If ActiveSheet.ProtectContents = True Then Call UnPro
Dim x As Long, var1 As Long, var2 As String
Application.ScreenUpdating = True
Sheets("GM EU Form").Select
var2 = "True"
With ThisWorkbook.Sheets("GM EU Form")
var1 = Application.WorksheetFunction.CountIf(Range("C66:U66"), var2)
End With
If var1 > 1 Then
MsgBox ("Please select one appropriate vendor catogory")
Range("d66").Value = False
Range("G66").Value = False
Range("K66").Value = False
Range("N66").Value = False
Range("o66").Value = False
Range("S66").Value = False
Call hide_inter
''Application.ScreenUpdating = False
If ActiveSheet.ProtectContents = False Then Call Pro
Exit Sub
End If
Application.ScreenUpdating = False
If Range("K66").Value = True Then
Call hide_inter
Else

'back to normal
    With Range("B64:E64").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With

Call hide_inter
End If
''Application.ScreenUpdating = False
If ActiveSheet.ProtectContents = False Then Call Pro
End Sub
Sub hide_inter()
Call UnPro
Application.ScreenUpdating = False
If Range("K66").Value = True Then
Range("b69:b72").Select
Selection.EntireRow.Hidden = False
                    ActiveSheet.CheckBoxes.Add(Cells(70, "Q").Left, _
                                                Cells(70, "Q").Top, _
                                                180, 17.25).Select

                    With Selection
                        .Caption = "Select if not netting participant"
                        .Value = xlOff '
                        .LinkedCell = "Q" & 70
                        .Display3DShading = True
                '        .lock = False
                        .Name = "nt"
                        .OnAction = ""
                    End With

Range("e70").Select
Else
Range("b69:b72").Select
Selection.EntireRow.Hidden = True
Range("f115").Select

On Error Resume Next
ActiveSheet.CheckBoxes("nt").delete
ActiveSheet.CheckBoxes("nt").delete
ActiveSheet.CheckBoxes("nt").delete
On Error GoTo 0

End If
''Application.ScreenUpdating = False
Call Pro
End Sub

Sub Alternative_50()
Call UnPro
Application.ScreenUpdating = False
If Range("R261").Value = False Then
    Range("B332:B353").Select
    Selection.EntireRow.Hidden = True
    Range("F357").Select
Else
     Range("B332:B353").Select
    Selection.EntireRow.Hidden = False
    Range("F333").Select
    End If
    ''Application.ScreenUpdating = False
    
Range("K340").Value = "City"
Range("K342").Value = "PO Box- City"
Range("K344").Value = "VAT ID"
'Range("K300").Value = "Tax No. 2"
Range("Q342").Value = "PO Box-Postal code"
'Range("Q300").Value = "Tax No. 3"

    Call Pro
End Sub

Attribute VB_Name = "functions"

Public Function WorksheetExists(ByVal WorksheetName As String) As Boolean
    Dim sht As Worksheet
    Dim sheetName As String
        
    WorksheetExists = False
        
    For Each sht In ThisWorkbook.Worksheets
        sheetName = sht.Name
        
        If sheetName = WorksheetName Then
        WorksheetExists = True
        ThisWorkbook.Activate
        Sheets(1).Select
        End If
    Next sht
End Function

Function FindRowMatch(strColumn As String, strSearch As String) As Integer

    Dim rng1 As Range

    Set rng1 = Range(strColumn & ":" & strColumn).Find(strSearch, , xlValues, xlPart)

    If Not rng1 Is Nothing Then
        FindRowMatch = rng1.Row
    Else
        FindRowMatch = 0
    End If

End Function

Function HideRows(intStart As Integer, intEnd As Integer)

If intStart = 0 Or intEnd = 0 Then
Exit Function
End If

ActiveSheet.Rows(intStart + 1 & ":" & intEnd - 1).Hidden = True

End Function

Function UnhideRows(intStart As Integer, intEnd As Integer)

If intStart = 0 Or intEnd = 0 Then
Exit Function
End If

ActiveSheet.Rows(intStart + 1 & ":" & intEnd - 1).Hidden = False

End Function
Sub bankdetails()
Call UnPro
Application.ScreenUpdating = False
If Range("G42") = False And Range("J42") = False Then
 Range("B46:B52").Select
 Selection.EntireRow.Hidden = True
  Range("B354:B367").Select
    Selection.EntireRow.Hidden = True
    Range("f357").Select
    Else
     Range("B46:B52").Select
    Selection.EntireRow.Hidden = False
    Range("B354:B367").Select
    Selection.EntireRow.Hidden = False
    'Range("B366:B366").Select
    ' Selection.EntireRow.Hidden = True
    End If

'old bank  details are added recently to GME
If Range("G42").Value = True Or Range("J42").Value = True Then
'A112
Range("A112").EntireRow.Hidden = False
Range("A76:A88").EntireRow.Hidden = False
Else
Range("A112").EntireRow.Hidden = True
Range("A76:A88").EntireRow.Hidden = True
End If

Call hidecheckeu
''Application.ScreenUpdating = False
Call Pro
End Sub


Sub bankdetails1()
Application.ScreenUpdating = False
If Range("f43") = False And Range("O42") = False Then
bankd1 True
Else
bankd1 False
End If
Call hidecheck
''Application.ScreenUpdating = False
End Sub

Sub bankd1(blnHide As Boolean)
Application.ScreenUpdating = False
Dim intStart As Integer
Dim intEnd As Integer
intStart = FindRowMatch("B", "a1")
intEnd = FindRowMatch("B", "a2")
If blnHide = True Then
HideRows intStart, intEnd
Else
UnhideRows intStart, intEnd
End If
''Application.ScreenUpdating = False
Call hidecheck
End Sub

Attribute VB_Name = "hidecheck"
Sub hidecheckeu()
Application.ScreenUpdating = False
Sheets("GM EU Form").Activate
If Rows("42:44").Hidden = True Then
Call Del1
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_1")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del1
Call Addbuttons
End If
End If
If Rows("65:65").Hidden = True Then
Call Del8
Else
On Error Resume Next
 ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_26")).Select
cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del8
Call Addbuttons7
End If
End If
If Rows("30:30").Hidden = True Then
Call Del2
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_5")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del2
Call Addbuttons1
End If
End If

If Rows("147:147").Hidden = True Then
Call Del3
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_8")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del3
Call Addbuttons2
End If
End If

If Rows("261:261").Hidden = True Then
Call Del4
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_11")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del4
Call Addbuttons3
End If
End If

If Rows("366:366").Hidden = True Then
Call Del6
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_19")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del6
Call Addbuttons5
End If
End If


If Rows("355:355").Hidden = True Then
Call Del7
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_24")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del7
Call Addbuttons6
End If
End If
Range("f18").Select
If Rows("70:70").Hidden = True Then
Call Del9
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_32")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del9
Call Addbuttons8
End If
End If

If Rows("128:128").Hidden = True Then
Call Del10
Else
On Error Resume Next
   ckeua = ActiveSheet.Shapes.Range(Array("Checkbox_60")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del10
Call Addbuttons9
End If
End If

End Sub
Sub hideint()

If Rows("70:70").Hidden = True Then
Call Del9
Else
On Error Resume Next
   a = ActiveSheet.Shapes.Range(Array("Checkbox_32")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Del9
Call Addbuttons8
End If
End If

End Sub
Sub hidecheckio()

Application.ScreenUpdating = False
Sheets("GM IO Form").Activate

If Rows("26:26").Hidden = True Then
Call Delb1
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox1")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb1
Call Addb
End If
End If


If Rows("33:33").Hidden = True Then
Call Delb2
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox3")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb2
Call Addb1
End If
End If

If Rows("64:64").Hidden = True Then
Call Delb3
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox4")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb3
Call Addb2
End If
End If

If Rows("226:226").Hidden = True Then
Call Delb4
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox5")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb4
Call Addb3
End If
End If

If Rows("214:214").Hidden = True Then
Call Delb5
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox10")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb5
Call Addb4
End If
End If

If Rows("159:159").Hidden = True Then
Call Delb6
Else
On Error Resume Next
   ticka = ActiveSheet.Shapes.Range(Array("tickbox13")).Select
 cb = 1
If Err.Number <> 0 Then
cb = 0
End If
On Error GoTo 0

If cb = 0 Then
Call Delb6
Call Addb5
End If
End If

End Sub
Attribute VB_Name = "iotickselection"

Sub Bevel1_Click()
Attribute Bevel1_Click.VB_ProcData.VB_Invoke_Func = " \n14"
    Sheets("GM EU Form").Select
    Range("F20:L20").Select
End Sub

Sub tax0()
If Range("f27") = True Then
Range("J27") = False
MsgBox ("Please select one category")
Exit Sub
End If

If Range("J27") = True Then
Range("B29:B37").Select
Selection.EntireRow.Hidden = True
Range("i26").Select
Else
Range("i26").Select
End If
End Sub

Sub taxx1()
If Range("J27") = True Then
Range("F27") = False
MsgBox ("Please select one category")
Exit Sub
End If
Application.ScreenUpdating = False
If Range("f27") = True Then
If Range("m20") = "Thai" Or Range("m20") = "QT01" Then
Range("B36:B38").Select
Else
Range("B29:B34").Select
End If
Selection.EntireRow.Hidden = False
Call Addb1
Range("F29").Select
If Range("m20") = "Thai" Then
Range("F37").Select
End If
Else
Range("B29:B37").Select
Selection.EntireRow.Hidden = True
Range("H26").Select
Call Delb2
End If
''Application.ScreenUpdating = False
End Sub
Sub tlower()
Application.ScreenUpdating = False
If Range("E33") = True Then
Range("B35:B36").Select
Selection.EntireRow.Hidden = False
Range("F35").Select
Else
Range("B35:B36").Select
Selection.EntireRow.Hidden = True
Range("F29").Select
End If
''Application.ScreenUpdating = False
End Sub
Sub tlower1()
Application.ScreenUpdating = False
If Range("H64") = True Then
Range("B74:B99").Select
Selection.EntireRow.Hidden = False
Range("F75").Select
If Range("m20").Value = "E-SAP" Then
Range("B90:B91").Select
Selection.EntireRow.Hidden = True
Range("H64").Select
End If
Else
Range("B74:B99").Select
Selection.EntireRow.Hidden = True
Range("H64").Select
End If
''Application.ScreenUpdating = False
End Sub

Sub uhidebank1()
Application.ScreenUpdating = False
If Range("G227") = False Then
    Range("b228:b241").Select
    Selection.EntireRow.Hidden = True
    Range("F216").Select
    Else
    Range("b228:b241").Select
    Selection.EntireRow.Hidden = False
      Range("F231").Select
    End If
    ''Application.ScreenUpdating = False
End Sub
Sub uhidebank2()
Application.ScreenUpdating = False
    If Range("j227") = False Then
   Range("b242:b254").Select
      Selection.EntireRow.Hidden = True
       Range("F216").Select
      Else
   Range("b242:b254").Select
      Selection.EntireRow.Hidden = False
       Range("F245").Select
      End If
      ''Application.ScreenUpdating = False
End Sub
Sub uhidebank3()
Application.ScreenUpdating = False
      If Range("m227") = False Then
    Range("b255:b267").Select
    Selection.EntireRow.Hidden = True
     Range("F216").Select
    Else
    Range("b255:b267").Select
    Selection.EntireRow.Hidden = False
     Range("F258").Select
    End If
    ''Application.ScreenUpdating = False
End Sub
Sub uhidebank4()
Application.ScreenUpdating = False
    If Range("p227") = False Then
    Range("b268:b280").Select
    Selection.EntireRow.Hidden = True
         Range("F216").Select
    Else
 Range("b268:b280").Select
    Selection.EntireRow.Hidden = False
     Range("F271").Select
    End If
    ''Application.ScreenUpdating = False
End Sub
Sub uhidebank5()
Application.ScreenUpdating = False
     If Range("s227") = False Then
    Range("b281:b293").Select
    Selection.EntireRow.Hidden = True
     Range("F216").Select
  Else
  Range("b281:b293").Select
    Selection.EntireRow.Hidden = False
     Range("F284").Select
    End If
    ''Application.ScreenUpdating = False
End Sub

Sub email_id_change_delete_add_GMIO()
Call UnPro

                    
                    'for company code T4820 creating sub checkboxes
                    On Error Resume Next
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    ActiveSheet.CheckBoxes("ACDamail").delete
                    On Error GoTo 0


Range("B254").EntireRow.Hidden = False

                    x = 254
                    y = "H"
                    Z = "S"
                    o = "runnothing"
                    n = "ACDamail"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With


                   x = 254
                    y = "K"
                    Z = "T"
                    o = "runnothing"
                    n = "ACDamail"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With

                   x = 254
                    y = "O"
                    Z = "U"
                    o = "runnothing"
                    n = "ACDamail"
                    
                    
                                        ActiveSheet.CheckBoxes.Add(Cells(x, y).Left, _
                                                                    Cells(x, y).Top, _
                                                                    80, 17).Select
                                        With Selection
                                            .Caption = ""
                                            .Value = xlOff '
                                            .LinkedCell = Z & x
                                            .Display3DShading = True
                                    '        .lock = False
                                            .Name = n
                                            .OnAction = o
                                        End With
Call Pro
End Sub
Attribute VB_Name = "multiplebu"
Sub Pentagon11_Click()

ws = ActiveSheet.Name
If MsgBox("Do you want to reset the current Business Unit selection?", vbYesNo + vbDefaultButton2) = vbYes Then
If ws = "GM EU Form" Then
Sheets("GM Europe Multiple BU &PO").Visible = True
Sheets("GM Europe Multiple BU &PO").Select
Call UnPro
ElseIf ws = "GM IO Form" Then
Sheets("GM IO Multiple BU &PO").Visible = True
Sheets("GM IO Multiple BU &PO").Select
End If
Call checkdelete
    Dim cb As CheckBox
        Range("e2").Select
Cou = Range(ActiveCell, ActiveCell.End(xlDown)).Count - 1
Call UnPro
Dim cel As Range
Dim cbx As CheckBox

cc = 2
For I = 1 To Cou
id = cc + I
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, 4)
        Set cel = ActiveSheet.Cells(id, 4)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        cbx.Name = "Check_" & id
        cbx.Caption = ""
        cbx.OnAction = "add_dynamic"
        cbx.LinkedCell = ActiveSheet.Cells(id, 4).Address
        cbx.Display3DShading = True
        ActiveSheet.Cells(id, 4).Value = "False"
        ActiveSheet.Cells(id, 4).Activate
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Next

Call DeSelectAllCheckBox
End If
If ws = "GM EU Form" Then
Sheets("GM Europe Multiple BU &PO").Visible = True
Sheets("GM Europe Multiple BU &PO").Select
Range("A1").Select
ElseIf ws = "GM IO Form" Then
Sheets("GM IO Multiple BU &PO").Visible = True
Sheets("GM IO Multiple BU &PO").Select
End If
End Sub
Sub checkdelete()
Call UnPro
   Dim cb1 As CheckBox
   Worksheets("GM Europe Multiple BU &PO").Unprotect "Abu"
   For Each cb1 In Worksheets("GM Europe Multiple BU &PO").CheckBoxes
If cb1.Name <> Worksheets("GM Europe Multiple BU &PO").CheckBoxes("CheckEU1").Name Then
cb1.delete
End If
Next
   For Each cb1 In Worksheets("GM IO Multiple BU &PO").CheckBoxes
If cb1.Name <> Worksheets("GM IO Multiple BU &PO").CheckBoxes("CheckIO1").Name Then
cb1.delete
End If
Next
Worksheets("GM Europe Multiple BU &PO").Protect "Abu", True, True, True
End Sub
Sub checkdelete1()
   Dim cb1 As CheckBox
   For Each cb1 In Worksheets("master data").CheckBoxes
If cb1.Name <> Worksheets("master data").CheckBoxes("Check Box 1").Name Then
cb1.delete
End If
Next

End Sub
Sub page()
        
'MsgBox "Mandatory Feilds cannot be left as blank" & vbNewLine & vbNewLine & vbNewLine & vbNewLine & "Note:" & vbNewLine & "Yellow highlighted fields are mandatory", vbExclamation, "Required Entry"

End Sub

Sub SHEETHIDE()
c = Sheets.Count
For I = 1 To c
Sheets(I).Visible = 2
Next I
End Sub
Sub SHEETUNHIDE()
Attribute SHEETUNHIDE.VB_ProcData.VB_Invoke_Func = "U\n14"
Application.ScreenUpdating = False
'If InputBox("Input the password", "Password") = "open" Then
Call UnPro
aa = ActiveSheet.Name
For I = 1 To Sheets.Count
Sheets(I).Visible = True
Next I
Call UnPro
Sheets(aa).Activate
'Else
'MsgBox ("Wrong Password")

Sheets("GM EU Form").Select
Call format_sheet_normal

Sheets("GM_IO_Form").Select
Call format_sheet_normal

Sheets("GM_NA").Select
Call format_sheet_normal

Sheets(aa).Activate
ActiveWindow.DisplayWorkbookTabs = True
Call UnPro
'End If
End Sub
Sub add_dynamic()
'application.ScreenUpdating = True
Call UnPro
Dim cel As Range
Dim cbx As CheckBox
ws = ActiveSheet.Name
Call deleteb1
cc = 2

Cou = Range("e2").End(xlDown).Row
If ws = "GM Europe Multiple BU &PO" Then
k = 8
ElseIf ws = "GM IO Multiple BU &PO" Then
k = 11
End If
For j = 6 To k
For I = 1 To Cou
id = cc + I
If Cells(id, j) <> Empty And Cells(id, 4) = True Then
If ws = "GM Europe Multiple BU &PO" Then
Range(Cells(id, 6), Cells(id, 8)).Select

'ActiveCell.Offset(0, 3).Value = "T"
'Range(Cells(id, 9), Cells(id, 9)).Select
Range(Cells(id, 9), Cells(id, 9)).Value = "T"

ElseIf ws = "GM IO Multiple BU &PO" Then
Range(Cells(id, 6), Cells(id, 11)).Select
End If
 With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
Application.ScreenUpdating = False
Set rng = ActiveSheet.Cells(id, j)
        Set cel = ActiveSheet.Cells(id, j)
        With cel
            Set cbx = ActiveSheet.CheckBoxes.Add(rng.Left, rng.Top, rng.Width, rng.Height)
        End With
        ''Application.ScreenUpdating = False
        cbx.Name = "Check" & j & "_" & id
        cbx.Caption = ""
        cbx.LinkedCell = ActiveSheet.Cells(id, j + 4).Address '"J" & id
        cbx.Display3DShading = True
        'MsgBox ActiveSheet.Cells(id, j + 4).Address
        Else
        'Range(Cells(id, 9), Cells(id, 9)).Value = ""
        ActiveSheet.Cells(id, j + 4).Value = ""
        End If
    Next I
    Next j
Range("E3").Select
Range("A1").Select
Call Pro
End Sub

Sub deleteb1()
ws = ActiveSheet.Name
Call UnPro
Application.ScreenUpdating = False
If ws = "GM Europe Multiple BU &PO" Then
Range("f3:h53").Select
ElseIf ws = "GM IO Multiple BU &PO" Then
Range("f3:k23").Select
End If
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
        With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
Range("i:i").ClearContents

For j = 6 To 11
For I = 1 To 100
On Error Resume Next
ActiveSheet.CheckBoxes("Check" & j & "_" & I).Select
  Selection.FormatConditions.delete
ActiveSheet.CheckBoxes("Check" & j & "_" & I).delete
    Next I
    Next j
 On Error GoTo 0
 Range("E3").Select
 ''Application.ScreenUpdating = False
 'Call Pro
End Sub

    
    
Sub DeSelectAllCheckBox()
Call UnPro
Application.ScreenUpdating = False
ws = ActiveSheet.Name
Worksheets(ws).CheckBoxes = False
Call add_dynamic
Range("J3:L60").ClearContents
''Application.ScreenUpdating = False
End Sub


Sub SelectAllCheckBox()
ws = ActiveSheet.Name
Application.ScreenUpdating = False
    Dim cb As CheckBox
        For Each cb In Worksheets(ws).CheckBoxes
        If ws = "GM Europe Multiple BU &PO" Then
        checkname = "CheckEU1"
        ElseIf ws = "GM IO Multiple BU &PO" Then
         checkname = "CheckIO1"
         End If
        If cb.Name <> Worksheets(ws).CheckBoxes(checkname).Name Then
            cb.Value = Worksheets(ws).CheckBoxes(checkname).Value
        End If
    Next cb
Call add_dynamic
''Application.ScreenUpdating = False
End Sub



Attribute VB_Name = "shortcuts"

' InQuest injected base64 decoded content
' bpZ'

INQUEST-PP=macro
