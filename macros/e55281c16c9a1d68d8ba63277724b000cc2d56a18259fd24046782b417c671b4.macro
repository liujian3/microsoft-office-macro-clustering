Attribute VB_Name = "ChangeCase"
Sub Uppercase()
   ' Loop to cycle through each cell in the specified range.
   For Each X In Range("A1:A5")
      ' Change the text in the range to uppercase letters.
      X.Value = UCase(X.Value)
   Next
End Sub

Sub Lowercase()
   ' Loop to cycle through each cell in the specified range.
   For Each X In Range("B1:B5")
      X.Value = LCase(X.Value)
   Next
End Sub

Sub Proper_Case()
   ' Loop to cycle through each cell in the specified range.
   For Each X In Range("C1:C5")
      ' There is not a Proper function in Visual Basic for Applications.
      ' So, you must use the worksheet function in the following form:
      X.Value = Application.Proper(X.Value)
   Next
End Sub

Attribute VB_Name = "ClearQuote"
Public Sub Clear_Quote()
Attribute Clear_Quote.VB_ProcData.VB_Invoke_Func = "C\n14"
   
    On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.FilterMode = False Then
        
            If MsgBox("Are you sure you want to Clear ALL inputs on this tab...?", vbQuestion + vbYesNo) <> vbYes Then
                Exit Sub
            Else
               Application.ScreenUpdating = False
            
               With ActiveSheet
                   .ShowAllData
                   .Range("B19:F518").ClearContents
                   .Range("B524:B600").ClearContents
                   .Range("B608:B750").ClearContents
                   .Range("B754:H803").ClearContents
                   .Range("F754:F803").Value = "<Select>"
                   .Range("D9:D10").ClearContents
                   .Range("G9").Value = "STANDARD"
                   .Shapes("Option Button 7").ControlFormat.Value = xlOn
                   .EnableSelection = xlUnlockedCells
               End With
            End If
            ActiveWindow.ScrollRow = 1
            Range("D10").Select
            Application.ScreenUpdating = True
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub

Public Sub Clear_WriteIn()
   
   On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.FilterMode = False Then
            If MsgBox("Are you sure you want to clear ALL inputs on this tab...?", vbQuestion + vbYesNo) <> vbYes Then
                Exit Sub
            Else
               Application.ScreenUpdating = False
               With ActiveSheet
                   .ShowAllData
                   .Range("B15:B1044").ClearContents
                   .Range("B1045:F1105").ClearContents
                   .Shapes("Option Button 1").ControlFormat.Value = xlOn
                   .EnableSelection = xlUnlockedCells
               End With
            End If
            ActiveWindow.ScrollRow = 1
            Range("B15").Select
            Application.ScreenUpdating = True
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub

Public Sub Clear_Maint()

   On Error Resume Next
    
    ActiveSheet.Select
    
    Application.ScreenUpdating = False
    
    With ActiveSheet
        .ShowAllData

        Set myRange1 = Range("K21, K23, K25, (K33:K34),(K38:K39)")
        For Each cl In myRange1
            If Not IsEmpty(cl.Value) Then cl.Value = "<Select>"
        Next cl
        
        Set myRange2 = Range("K22, (K26:K29), (K31:K32), (K35:K36)")
        For Each cl In myRange2
            If Not IsEmpty(cl.Value) Then cl.Value = "0"
        Next cl
        .Range("B44:H60").ClearContents
        .Range("K21").Select
    End With
    
    Sheet10.Select
                
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheet9.Select
    ActiveSheet.Range("L2").Value = "Edit " & ChrW(8593)
    ActiveWindow.ScrollRow = 18
    Range("K21").Select
    Application.ScreenUpdating = True
    
End Sub

Public Sub Clear_Material()
   
    On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.FilterMode = False Then
            If MsgBox("Are you sure you want to clear the CPE Material section...?", vbQuestion + vbYesNo) <> vbYes Then
                Exit Sub
            Else
                Application.ScreenUpdating = False
                With ActiveSheet
                    .ShowAllData
                    .Range("B19:F518").ClearContents
                    .Range("B19").Select
                    .Shapes("Option Button 7").ControlFormat.Value = xlOn
                    .EnableSelection = xlUnlockedCells
                End With
                ActiveWindow.ScrollRow = 17
                Application.ScreenUpdating = True
            End If
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub
Public Sub Clear_Labor()
   
    On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.FilterMode = False Then
            If MsgBox("Are you sure you want to clear the Labor section...?", vbQuestion + vbYesNo) <> vbYes Then
                Exit Sub
            Else
                Application.ScreenUpdating = False
                With ActiveSheet
                    .ShowAllData
                    .Range("B524:B600").ClearContents
                    .Range("B525").Select
                    .Shapes("Option Button 8").ControlFormat.Value = xlOn
                    .EnableSelection = xlUnlockedCells
                End With
                ActiveWindow.ScrollRow = 522
                Application.ScreenUpdating = True
            End If
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub

Public Sub Clear_InstallMats()
   
    On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.FilterMode = False Then
            If MsgBox("Are you sure you want to clear the Install Materials section...?", vbQuestion + vbYesNo) <> vbYes Then
                Exit Sub
            Else
                Application.ScreenUpdating = False
                With ActiveSheet
                    .ShowAllData
                    .Range("B608:B750").ClearContents
                    .Range("B608").Select
                    .Shapes("Option Button 9").ControlFormat.Value = xlOn
                    .EnableSelection = xlUnlockedCells
                End With
                ActiveWindow.ScrollRow = 606
                Application.ScreenUpdating = True
            End If
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub

Public Sub Clear_SubCont()
   
    On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.FilterMode = False Then
            If MsgBox("Are you sure you want to clear the Sub/Freight/Misc section...?", vbQuestion + vbYesNo) <> vbYes Then
                Exit Sub
            Else
                Application.ScreenUpdating = False
                With ActiveSheet
                    .ShowAllData
                    .Range("B754:H803").ClearContents
                    .Range("F754:F803").Value = "<Select>"
                    .Range("B754").Select
                    .Shapes("Option Button 10").ControlFormat.Value = xlOn
                    .EnableSelection = xlUnlockedCells
                End With
                ActiveWindow.ScrollRow = 752
                Application.ScreenUpdating = True
            End If
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub

Attribute VB_Name = "Export"
Sub ExportToExcel()

'
' Export Itemized Pricing to New Excel Workbook
'
    Range("A1:F4165").Select
    Selection.Copy
    Workbooks.Add
    
    Cells.Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With

    ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
        , SkipBlanks:=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _
        xlNone, SkipBlanks:=False, Transpose:=False
    ActiveSheet.Shapes.Range(Array("PrintBtn", "ExcelBtn", "AdobeBtn")).Select
    Selection.Cut
    
    Selection.RowHeight = 48
    Rows("2:2").Select
    Selection.RowHeight = 15
    Rows("3:3").Select
    Selection.RowHeight = 6
    Rows("4:4").Select
    Selection.RowHeight = 15
    Rows("5:5").Select
    Selection.RowHeight = 6
    Rows("6:6").Select
    Selection.RowHeight = 8.25
    Rows("7:7").Select
    Selection.RowHeight = 15
    Rows("8:8").Select
    Selection.RowHeight = 6
    Rows("9:4175").Select
    Selection.RowHeight = 15

    Range("B1:F1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .MergeCells = True
    End With
    
    ActiveCell.FormulaR1C1 = "Exported Copy"
    Range("B1:F1").Select
    With Selection.Font
        .Name = "Arial Nova"
        .Size = 20
        .Shadow = True
        .Color = -6448487
        .TintAndShade = 0
        .ThemeColor = xlThemeColorDark1
    End With
    
    Range("B2:F2").Select
    With Selection.Font
        .ThemeColor = xlThemeColorLight2
        .TintAndShade = 0
    End With
    
    Range("A1").Select
    
    ThisWorkbook.Activate
    Application.CutCopyMode = False
    Range("A1").Select
    'ActiveSheet.Protect ("config")
       
End Sub

Sub PrintItemizedPricing()
'
    On Error Resume Next
    Columns("A:A").ColumnWidth = 1
    Selection.AutoFilter Field:=1, Criteria1:="1"
    With ActiveSheet
        .PageSetup.PrintArea = "$B$1:$F$4165"
        .PageSetup.Orientation = xlPortrait
        .PageSetup.FitToPagesTall = 1
        .PageSetup.FitToPagesWide = 1
        .PageSetup.CenterPortrait = True
        .PageSetup.Draft = False
        Application.Dialogs(xlDialogPrinterSetup).Show
        .PrintOut Copies:=1, Preview:=True, Collate:=True
        .EnableSelection = xlNoSelection
        .Range("A1").Select
    End With
End Sub

Sub ExportAsPDF()
    On Error Resume Next
    
    ActiveSheet.Range("B1:F4165").ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Quality:=xlQualityStandard, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=True
End Sub
Attribute VB_Name = "GotoSection"
Sub goTo1()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 14
    Range("B15").Select
End Sub

Sub goTo2()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 101
    Range("B102").Select
End Sub

Sub goTo3()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 159
    Range("B160").Select
End Sub

Sub goTo4()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 199
    Range("B200").Select
End Sub

Sub goTo5()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 255
    Range("B256").Select
End Sub

Sub goTo6()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 320
    Range("B321").Select
End Sub

Sub goTo7()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 370
    Range("B371").Select
End Sub
Sub goTo8()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 410
    Range("B411").Select
End Sub

Sub goTo9()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 451
    Range("B452").Select
End Sub

Sub goTo10()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 469
    Range("B470").Select
End Sub

Sub goTo11()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 475
    Range("B476").Select
End Sub

Sub goTo12()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 481
    Range("B482").Select
End Sub

Sub goTo13()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 672
    Range("B673").Select
End Sub

Sub goTo14()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 678
    Range("B679").Select
End Sub

Sub goTo15()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 757
    Range("B758").Select
End Sub

Sub goTo16()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 798
    Range("B799").Select
End Sub

Sub goTo17()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 832
    Range("B833").Select
End Sub

Sub goTo18()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 837
    Range("B838").Select
End Sub

Sub goTo19()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 855
    Range("B856").Select
End Sub

Sub goTo20()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 934
    Range("B935").Select
End Sub

Sub goTo21()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 985
    Range("B986").Select
End Sub

Sub goTo22()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 1044
    Range("B1045").Select
End Sub

Sub goToCPEMaterials()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 17
    Range("B19").Select
End Sub

Sub goToLabor()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 522
    Range("B525").Select
End Sub

Sub goToInstallMaterials()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 606
    Range("B609").Select
End Sub

Sub goToSubCont()
'
On Error Resume Next
    ActiveWindow.ScrollRow = 752
    Range("B754").Select
End Sub

Attribute VB_Name = "Import_to_A1"
Sub ImportA1()
Dim vendor As Range
Set vendor = Sheets("Calculations").Range("AM2")

On Error Resume Next
    
    If vendor.Value = "Mitel Std" Then
        Call ImportCPQStdA1
    
    ElseIf vendor.Value = "Mitel NJPA" Then
        Call ImportNjpaA1
    
    ElseIf vendor.Value = "Mitel Order" Then
        Call ImportCPQOrderA1
        
    ElseIf vendor.Value = "Mitel SPA" Then
        Call ImportCPQSPAA1
        
    ElseIf vendor.Value = "Avaya A1S" Then
        Call ImportAvayaA1SA1
        
    ElseIf vendor.Value = "Adtran" Then
        Call ImportAdtranA1
        
    ElseIf vendor.Value = "CCW Estimate" Then
        Call ImportCcwEstA1
        
    ElseIf vendor.Value = "Ingram" Then
        Call ImportIngramA1
        
    ElseIf vendor.Value = "Ingram 2" Then
        Call ImportIngram2A1
                
    ElseIf vendor.Value = "Ingram 3" Then
        Call ImportIngram3A1
                
    ElseIf vendor.Value = "Arris" Then
        Call ImportArrisA1
        
    ElseIf vendor.Value = "Jenne" Then
        Call ImportJenneA1
        
    End If
End Sub
    
    
Function LastRowInRange_Find(ByVal Rng As Range) As Long

    Dim rngFind As Range
    
    Set rngFind = Rng.Find(what:="*", _
        After:=Cells(Rng.Row, Rng.Column), _
        LookAt:=xlWhole, _
        LookIn:=xlValues, _
        SearchOrder:=xlByRows, _
        SearchDirection:=xlPrevious)

    If Not rngFind Is Nothing Then
        LastRowInRange_Find = rngFind.Row
    Else
        LastRowInRange_Find = Rng.Row
    End If

End Function

Sub ImportCPQStdA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 12).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 5)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 9)
        'Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQSPAA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 11).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQOrderA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 6)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Sub ImportNjpaA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 3)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = ucost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("G9").Value = "NJPA"
    Range("B19").Value = 1
    Range("D19").Value = "Mitel Sourcewell contract #040314-MBS"
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAvayaA1SA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim term As Range

Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO6")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 1).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 4)
        Set cost = Sheets("Vendor Quote").Cells(i, 7)
        Set term = Sheets("Vendor Quote").Cells(i, 2)

        If term > 0 Then
            qty = term
        Else
            qty = Sheets("Vendor Quote").Cells(i, 1)
        End If

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAdtranA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim testRange As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A1erow = Sheets("Alternate 1").Range("B19:F518")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set cost = Sheets("Vendor Quote").Cells(i, 5)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote. You must validate item cost against latest Adtran price list."

End Sub

Sub ImportCcwEstA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range
    
Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("I13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 6)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set list = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = list.Value
        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If
        
    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngramA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO9")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 5)
        Set cost = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram2A1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("N14")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set pno = Sheets("Vendor Quote").Cells(i, 2)
        Set desc = Sheets("Vendor Quote").Cells(i, 3)
        Set list = Sheets("Vendor Quote").Cells(i, 8)
        Set disc = Sheets("Vendor Quote").Cells(i, 12)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = list.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportJenneA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A1erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set A1erow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("L2")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 17).Value = 2 Then
                
        lrow = LastRowInRange_Find(A1erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 1").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 1").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram3A1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 16)
        Set part = Sheets("Vendor Quote").Cells(i, 4)
        Set desc = Sheets("Vendor Quote").Cells(i, 8)
        Set cost = Sheets("Vendor Quote").Cells(i, 14)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value
    End If
Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B19").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Sub ImportArrisA1()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim pcost As Single

Set bqerow = Sheets("Alternate 1").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("C17")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    If Sheets("Vendor Quote").Cells(i, 10).Value = 2 Then

        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 7)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 6)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        If qty < 1 Then
            pcost = qty.Cells.Value * ucost.Cells.Value
            Sheets("Alternate 1").Cells(erow, 5).Value = pcost
            Sheets("Alternate 1").Cells(erow, 2).Value = 1
        Else
            Sheets("Alternate 1").Cells(erow, 5).Value = ucost.Cells.Value
            Sheets("Alternate 1").Cells(erow, 2).Value = qty.Cells.Value
        End If

        Sheets("Alternate 1").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Alternate 1").Cells(erow, 4).Value = desc.Cells.Value

        If disc > 0 Then
            Sheets("Alternate 1").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If
Next i

    Sheets("Itemized Pricing").Activate

        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With

    Sheets("Alternate 1").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Attribute VB_Name = "Import_to_A2"
Sub ImportA2()
Dim vendor As Range
Set vendor = Sheets("Calculations").Range("AM2")

On Error Resume Next
    
    If vendor.Value = "Mitel Std" Then
        Call ImportCPQStdA2
    
    ElseIf vendor.Value = "Mitel NJPA" Then
        Call ImportNjpaA2
    
    ElseIf vendor.Value = "Mitel Order" Then
        Call ImportCPQOrderA2
        
    ElseIf vendor.Value = "Mitel SPA" Then
        Call ImportCPQSPAA2
        
    ElseIf vendor.Value = "Avaya A1S" Then
        Call ImportAvayaA1SA2
        
    ElseIf vendor.Value = "Adtran" Then
        Call ImportAdtranA2
        
    ElseIf vendor.Value = "CCW Estimate" Then
        Call ImportCcwEstA2
        
    ElseIf vendor.Value = "Ingram" Then
        Call ImportIngramA2
        
    ElseIf vendor.Value = "Ingram 2" Then
        Call ImportIngram2A2
                
    ElseIf vendor.Value = "Ingram 3" Then
        Call ImportIngram3A2
                
    ElseIf vendor.Value = "Arris" Then
        Call ImportArrisA2
        
    ElseIf vendor.Value = "Jenne" Then
        Call ImportJenneA2
        
    End If
End Sub
    
    
Function LastRowInRange_Find(ByVal Rng As Range) As Long

    'searches range from bottom up looking for "*" (anything)
    Dim rngFind As Range
    Set rngFind = Rng.Find(what:="*", _
                            After:=Cells(Rng.Row, Rng.Column), _
                            LookAt:=xlWhole, _
                            LookIn:=xlValues, _
                            SearchOrder:=xlByRows, _
                            SearchDirection:=xlPrevious)

    If Not rngFind Is Nothing Then
        LastRowInRange_Find = rngFind.Row
    Else
        LastRowInRange_Find = Rng.Row
    End If

End Function

Sub ImportCPQStdA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 12).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 5)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 9)
        'Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQSPAA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 11).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQOrderA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 6)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Sub ImportNjpaA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 3)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = ucost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("G9").Value = "NJPA"
    Range("B19").Value = 1
    Range("D19").Value = "Mitel Sourcewell contract #040314-MBS"
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAvayaA1SA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim term As Range

Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO6")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 1).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 4)
        Set cost = Sheets("Vendor Quote").Cells(i, 7)
        Set term = Sheets("Vendor Quote").Cells(i, 2)

        If term > 0 Then
            qty = term
        Else
            qty = Sheets("Vendor Quote").Cells(i, 1)
        End If

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAdtranA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim testRange As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A2erow = Sheets("Alternate 2").Range("B19:F518")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set cost = Sheets("Vendor Quote").Cells(i, 5)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote. You must validate item cost against latest Adtran price list."

End Sub

Sub ImportCcwEstA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range
    
Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("I13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 6)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set list = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = list.Value
        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If
        
    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngramA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO9")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 5)
        Set cost = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram2A2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("N14")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set pno = Sheets("Vendor Quote").Cells(i, 2)
        Set desc = Sheets("Vendor Quote").Cells(i, 3)
        Set list = Sheets("Vendor Quote").Cells(i, 8)
        Set disc = Sheets("Vendor Quote").Cells(i, 12)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = list.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportJenneA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A2erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set A2erow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("L2")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 17).Value = 3 Then
                
        lrow = LastRowInRange_Find(A2erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 2").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 2").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram3A2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 16)
        Set part = Sheets("Vendor Quote").Cells(i, 4)
        Set desc = Sheets("Vendor Quote").Cells(i, 8)
        Set cost = Sheets("Vendor Quote").Cells(i, 14)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value
    End If
Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B19").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportArrisA2()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim pcost As Single

Set bqerow = Sheets("Alternate 2").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("C17")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow

    If Sheets("Vendor Quote").Cells(i, 10).Value = 3 Then

        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 7)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 6)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        If qty < 1 Then
            pcost = qty.Cells.Value * ucost.Cells.Value
            Sheets("Alternate 2").Cells(erow, 5).Value = pcost
            Sheets("Alternate 2").Cells(erow, 2).Value = 1
        Else
            Sheets("Alternate 2").Cells(erow, 5).Value = ucost.Cells.Value
            Sheets("Alternate 2").Cells(erow, 2).Value = qty.Cells.Value
        End If

        Sheets("Alternate 2").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Alternate 2").Cells(erow, 4).Value = desc.Cells.Value

        If disc > 0 Then
            Sheets("Alternate 2").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate

        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With

    Sheets("Alternate 2").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub



Attribute VB_Name = "Import_to_A3"
Sub ImportA3()
Dim vendor As Range
Set vendor = Sheets("Calculations").Range("AM2")

On Error Resume Next
    
    If vendor.Value = "Mitel Std" Then
        Call ImportCPQStdA3
    
    ElseIf vendor.Value = "Mitel NJPA" Then
        Call ImportNjpaA3
    
    ElseIf vendor.Value = "Mitel Order" Then
        Call ImportCPQOrderA3
        
    ElseIf vendor.Value = "Mitel SPA" Then
        Call ImportCPQSPAA3
        
    ElseIf vendor.Value = "Avaya A1S" Then
        Call ImportAvayaA1SA3
        
    ElseIf vendor.Value = "Adtran" Then
        Call ImportAdtranA3
        
    ElseIf vendor.Value = "CCW Estimate" Then
        Call ImportCcwEstA3
        
    ElseIf vendor.Value = "Ingram" Then
        Call ImportIngramA3
        
    ElseIf vendor.Value = "Ingram 2" Then
        Call ImportIngram2A3
                
    ElseIf vendor.Value = "Ingram 3" Then
        Call ImportIngram3A3
                
    ElseIf vendor.Value = "Arris" Then
        Call ImportArrisA3
        
    ElseIf vendor.Value = "Jenne" Then
        Call ImportJenneA3
        
    End If
End Sub
        
Function LastRowInRange_Find(ByVal Rng As Range) As Long

    Dim rngFind As Range
    Set rngFind = Rng.Find(what:="*", _
        After:=Cells(Rng.Row, Rng.Column), _
        LookAt:=xlWhole, _
        LookIn:=xlValues, _
        SearchOrder:=xlByRows, _
        SearchDirection:=xlPrevious)
    
    If Not rngFind Is Nothing Then
        LastRowInRange_Find = rngFind.Row
    Else
        LastRowInRange_Find = Rng.Row
    End If

End Function

Sub ImportCPQStdA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 12).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 5)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 9)
        'Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True

    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQSPAA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 11).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True

    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQOrderA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 6)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Sub ImportNjpaA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 3)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = ucost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("G9").Value = "NJPA"
    Range("B19").Value = 1
    Range("D19").Value = "Mitel Sourcewell contract #040314-MBS"
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAvayaA1SA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim term As Range

Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO6")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 1).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 4)
        Set cost = Sheets("Vendor Quote").Cells(i, 7)
        Set term = Sheets("Vendor Quote").Cells(i, 2)

        If term > 0 Then
            qty = term
        Else
            qty = Sheets("Vendor Quote").Cells(i, 1)
        End If

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAdtranA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim testRange As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set A3erow = Sheets("Alternate 3").Range("B19:F518")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set cost = Sheets("Vendor Quote").Cells(i, 5)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote. You must validate item cost against latest Adtran price list."

End Sub

Sub ImportCcwEstA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range
    
Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("I13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 6)
        Set pno = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set list = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = list.Value
        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If
        
    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngramA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO9")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 5)
        Set cost = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram2A3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("N14")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set pno = Sheets("Vendor Quote").Cells(i, 2)
        Set desc = Sheets("Vendor Quote").Cells(i, 3)
        Set list = Sheets("Vendor Quote").Cells(i, 8)
        Set disc = Sheets("Vendor Quote").Cells(i, 12)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = list.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportJenneA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim A3erow As Range

Dim qty As Range
Dim pno As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set A3erow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("L2")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 17).Value = 4 Then
                
        lrow = LastRowInRange_Find(A3erow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set pno = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Alternate 3").Cells(erow, 3).Value = pno.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Alternate 3").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Alternate 3").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram3A3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 16)
        Set part = Sheets("Vendor Quote").Cells(i, 4)
        Set desc = Sheets("Vendor Quote").Cells(i, 8)
        Set cost = Sheets("Vendor Quote").Cells(i, 14)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value
    End If
Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B19").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportArrisA3()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim pcost As Single

Set bqerow = Sheets("Alternate 3").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("C17")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow

    If Sheets("Vendor Quote").Cells(i, 10).Value = 4 Then

        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 7)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 6)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        If qty < 1 Then
            pcost = qty.Cells.Value * ucost.Cells.Value
            Sheets("Alternate 3").Cells(erow, 5).Value = pcost
            Sheets("Alternate 3").Cells(erow, 2).Value = 1
        Else
            Sheets("Alternate 3").Cells(erow, 5).Value = ucost.Cells.Value
            Sheets("Alternate 3").Cells(erow, 2).Value = qty.Cells.Value
        End If

        Sheets("Alternate 3").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Alternate 3").Cells(erow, 4).Value = desc.Cells.Value

        If disc > 0 Then
            Sheets("Alternate 3").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate

        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With

    Sheets("Alternate 3").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Attribute VB_Name = "Import_to_BQ"
Sub ImportBQ()
    Dim vendor As Range
    Set vendor = Sheets("Calculations").Range("AM2")
    
    On Error Resume Next
    If ActiveSheet.FilterMode = False Then
        If Sheet2.Range("N2").Value <> "Locked" Then
            
            If vendor.Value = "Mitel Std" Then
                Call ImportCPQStdBQ
            
            ElseIf vendor.Value = "Mitel NJPA" Then
                Call ImportNjpaBQ
            
            ElseIf vendor.Value = "Mitel Order" Then
                Call ImportCPQOrderBQ
                
            ElseIf vendor.Value = "Mitel SPA" Then
                Call ImportCPQSPABQ
                
            ElseIf vendor.Value = "Avaya A1S" Then
                Call ImportAvayaA1SBQ
                
            ElseIf vendor.Value = "Adtran" Then
                Call ImportAdtranBQ
                
            ElseIf vendor.Value = "CCW Estimate" Then
                Call ImportCcwEstBQ
                
            ElseIf vendor.Value = "Ingram" Then
                Call ImportIngramBQ
                
            ElseIf vendor.Value = "Ingram 2" Then
                Call ImportIngram2BQ
                
            ElseIf vendor.Value = "Ingram 3" Then
                Call ImportIngram3BQ
                
            ElseIf vendor.Value = "Arris" Then
                Call ImportArrisBQ
                
            ElseIf vendor.Value = "Jenne" Then
                Call ImportJenneBQ
                
            End If
        Else
            Exit Sub
        End If
    Else
        Exit Sub
    End If
End Sub
    
    
Function LastRowInRange_Find(ByVal Rng As Range) As Long

    Dim rngFind As Range
    Set rngFind = Rng.Find(what:="*", _
        After:=Cells(Rng.Row, Rng.Column), _
        LookAt:=xlWhole, _
        LookIn:=xlValues, _
        SearchOrder:=xlByRows, _
        SearchDirection:=xlPrevious)

    If Not rngFind Is Nothing Then
        LastRowInRange_Find = rngFind.Row
    Else
        LastRowInRange_Find = Rng.Row
    End If

End Function

Sub ImportCPQStdBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 12).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 5)
        Set part = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 9)
        'Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = ucost.Cells.Value
        'If disc > 0 Then
            'Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value / 100
        'End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True

    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQSPABQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 11).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True

    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportCPQOrderBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ulist = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 6)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = ulist.Cells.Value
        If disc > 0 Then
            Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            ActiveSheet.ShowAllData
            ActiveSheet.EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Sub ImportNjpaBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("B4")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 3)
        Set part = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = ucost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("G9").Value = "NJPA"
    Range("B19").Value = 1
    Range("D19").Value = "Mitel Sourcewell contract #040314-MBS"
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAvayaA1SBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim term As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO6")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 1).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 4)
        Set cost = Sheets("Vendor Quote").Cells(i, 7)
        Set term = Sheets("Vendor Quote").Cells(i, 2)

        If term > 0 Then
            qty = term
        Else
            qty = Sheets("Vendor Quote").Cells(i, 1)
        End If

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportAdtranBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim testRange As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

    
Set bqerow = Sheets("Base Quote").Range("B19:F518")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 1)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set cost = Sheets("Vendor Quote").Cells(i, 5)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote. You must validate item cost against latest Adtran price list."

End Sub

Sub ImportCcwEstBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range
    
Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("I13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 10).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 6)
        Set part = Sheets("Vendor Quote").Cells(i, 1)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set list = Sheets("Vendor Quote").Cells(i, 5)
        Set disc = Sheets("Vendor Quote").Cells(i, 8)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Value
        Sheets("Base Quote").Cells(erow, 5).Value = list.Value
        If disc > 0 Then
            Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If
        
    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngramBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO9")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 15).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 4)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 5)
        Set cost = Sheets("Vendor Quote").Cells(i, 10)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportIngram2BQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("N14")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set part = Sheets("Vendor Quote").Cells(i, 2)
        Set desc = Sheets("Vendor Quote").Cells(i, 3)
        Set list = Sheets("Vendor Quote").Cells(i, 8)
        Set disc = Sheets("Vendor Quote").Cells(i, 12)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = list.Cells.Value
        If disc > 0 Then
            Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Sub ImportIngram3BQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim list As Range
Dim disc As Range
Dim cost As Range

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Calculations").Range("AO13")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 23).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 16)
        Set part = Sheets("Vendor Quote").Cells(i, 4)
        Set desc = Sheets("Vendor Quote").Cells(i, 8)
        Set cost = Sheets("Vendor Quote").Cells(i, 14)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = cost.Cells.Value
    End If
Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B19").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportArrisBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range
Dim pcost As Single

Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("C17")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow

    If Sheets("Vendor Quote").Cells(i, 10).Value = 1 Then

        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 7)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 6)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        If qty < 1 Then
            pcost = qty.Cells.Value * ucost.Cells.Value
            Sheets("Base Quote").Cells(erow, 5).Value = pcost
            Sheets("Base Quote").Cells(erow, 2).Value = 1
        Else
            Sheets("Base Quote").Cells(erow, 5).Value = ucost.Cells.Value
            Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        End If

        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value

        If disc > 0 Then
            Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate

        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With

    Sheets("Base Quote").Activate
    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub

Sub ImportJenneBQ()

Dim lastRow As Long
Dim lrow As Long
Dim i As Long
Dim irow As Long
Dim erow As Long

Dim quoteID As Range
Dim qID As Range
Dim bqerow As Range

Dim qty As Range
Dim part As Range
Dim desc As Range
Dim ulist As Range
Dim disc As Range
Dim ucost As Range

    
Set bqerow = Sheets("Base Quote").Range("B19:F518")
Set quoteID = ActiveSheet.Range("D9")
Set qID = Sheets("Vendor Quote").Range("L2")

On Error Resume Next

    Application.ScreenUpdating = False
    Call expand
    Sheets("Vendor Quote").Select
    lastRow = Sheets("Vendor Quote").Cells(Rows.Count, 2).End(xlUp).Row

For i = 1 To lastRow
    
    If Sheets("Vendor Quote").Cells(i, 17).Value = 1 Then
                
        lrow = LastRowInRange_Find(bqerow)
        erow = lrow + 1

        Set qty = Sheets("Vendor Quote").Cells(i, 9)
        Set part = Sheets("Vendor Quote").Cells(i, 3)
        Set desc = Sheets("Vendor Quote").Cells(i, 2)
        Set ucost = Sheets("Vendor Quote").Cells(i, 8)
        'Set disc = Sheets("Vendor Quote").Cells(i, 7)

        Sheets("Base Quote").Cells(erow, 2).Value = qty.Cells.Value
        Sheets("Base Quote").Cells(erow, 3).Value = part.Cells.Value
        Sheets("Base Quote").Cells(erow, 4).Value = desc.Cells.Value
        Sheets("Base Quote").Cells(erow, 5).Value = ucost.Cells.Value
        If disc > 0 Then
            Sheets("Base Quote").Cells(erow, 6).Value = disc.Cells.Value / 100
        End If

    End If

Next i

    Sheets("Itemized Pricing").Activate
            
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
    
    Sheets("Base Quote").Activate

    quoteID = qID
    Range("B17").Activate
    Application.ScreenUpdating = True
    MsgBox "Finished Importing Vendor Quote"

End Sub
Attribute VB_Name = "LastColumn"
Sub sblastcolumnOfASheet()
Dim xLastcolumn As Long
xLastcolumn = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Column
'MsgBox "Last Used column: " & xLastcolumn
Do While Application.CountA(ActiveSheet.Columns(xLastcolumn)) = 0 And xLastcolumn <> 1
    xLastcolumn = xLastcolumn - 1
Loop
MsgBox "Last column with Data: " & xLastcolumn
End Sub
Attribute VB_Name = "LastWorkSheet"
Public LastSheet As String
Sub Select_Last()
    Application.Sheets(LastSheet).Select
End Sub
Attribute VB_Name = "Protect_Unprotect"
Sub ProtectAll()
    Dim wsh As Worksheet
    Application.ScreenUpdating = False
    
        For Each wsh In Worksheets
            wsh.Protect ("config"), UserInterfaceOnly:=True
        Next wsh
    
    Sheet8.Visible = xlSheetVeryHidden
    Sheet98.Visible = xlSheetVeryHidden
    Sheet99.Visible = xlSheetVeryHidden
    Sheet22.Unprotect ("config")
    Sheet1.Select
    Range("a1").Select
    Application.ScreenUpdating = True
End Sub
    
Sub UnprotectAll()
    Dim wsh As Worksheet
    Application.ScreenUpdating = False
    
        For Each wsh In Worksheets
            wsh.Unprotect ("config")
        Next wsh
    
    Sheet8.Visible = xlSheetHidden
    Sheet98.Visible = xlSheetHidden
    Sheet99.Visible = xlSheetHidden
    Sheet1.Select
    Range("a1").Select
    Application.ScreenUpdating = True
End Sub

Sub CheckProtect()
    If ActiveSheet.ProtectContents = False Then
        Call ProtectAll
    Else
        Call UnprotectAll
    End If
End Sub

Sub Protectsheet()
    On Error Resume Next
    If Sheet2.Range("N2").Value <> "Locked" Then
        If ActiveSheet.ProtectContents = False Then
            ActiveSheet.Protect ("config"), UserInterfaceOnly:=True
            ActiveSheet.EnableSelection = xlUnlockedCells
        Else
            ActiveSheet.Unprotect ("config")
        End If
    Else
        Exit Sub
    End If
End Sub

Sub LockQuoteTabs()
    Dim quote As Worksheet
    Dim pwd As Variant
    Set quotes = Sheets(Array("Base Quote", "Alternate 1", "Alternate 2", "Alternate 3", "Write-in Materials", "Maintenance"))
    Set Tabs = Sheets(Array("Cost Summary"))
    
    If Sheet2.Range("N2").Value = "Unlocked" Then
        For Each quote In quotes
            quote.Unprotect ("config")
            quote.Protect ("Phoenix"), UserInterfaceOnly:=True
            quote.EnableSelection = xlNoSelection
        Next
        Sheet2.Select
        Sheet2.Range("N2").Value = "Locked"
        Sheet2.Shapes("Graphic 2").Fill.Transparency = 0
        Sheet2.Shapes("Graphic 5").Fill.Transparency = 1
    Else
        Application.ScreenUpdating = False
        pwd = InputBox("Enter Unlock Password")
        If pwd = "Phoenix" Then
            For Each quote In quotes
                quote.Unprotect ("Phoenix")
                quote.EnableSelection = xlUnlockedCells
                quote.Protect ("config"), UserInterfaceOnly:=True
            Next
            Sheet2.Select
            Sheet2.Unprotect ("config")
            Sheet2.Range("N2").Value = "Unlocked"
            Sheet2.Shapes("Graphic 2").Fill.Transparency = 1
            Sheet2.Shapes("Graphic 5").Fill.Transparency = 0
            Sheet2.Protect ("config"), UserInterfaceOnly:=True
        Else
            MsgBox ("Password entered is not correct"), vbOKOnly
        End If
        Application.ScreenUpdating = True
    End If
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
    
    On Error Resume Next
    
    If Intersect(Target, Range("A1:Z60")) Is Nothing Or Target.Cells.Count > 1 Then Exit Sub
    Application.EnableEvents = False
    Target = StrConv(Target, vbProperCase)
    Application.EnableEvents = True
    
    If Not Intersect(Target, Range("O4")) Is Nothing Then
        Application.EnableEvents = False
        Range("N4").Value = Range("N4").Value + 0.01
        Application.EnableEvents = True
    End If
    
End Sub

Private Sub Worksheet_Activate()
    On Error Resume Next
    Application.ScreenUpdating = False
    With ActiveSheet
        .EnableCalculation = True
        .EnableSelection = xlUnlockedCells
        .Protect ("config"), UserInterfaceOnly:=True
    End With
    Columns("A:A").ColumnWidth = 1
    ActiveWindow.ScrollRow = 1
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    On Error Resume Next
    Application.ScreenUpdating = False
    With ActiveSheet
        .EnableCalculation = True
        .EnableSelection = xlNoSelection
        .Protect ("config"), UserInterfaceOnly:=True
    End With
    Columns("A:A").ColumnWidth = 1
    Selection.AutoFilter Field:=1, Criteria1:="1"
    ActiveWindow.ScrollRow = 1
    Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
        
    On Error Resume Next
    If Intersect(Target, Range("C8:C12,C14,F8:F14,H8:H14")) Is Nothing Or Target.Cells.Count > 1 Then Exit Sub
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Columns("A:A").ColumnWidth = 1
    Selection.AutoFilter Field:=1, Criteria1:="1"
    
    Sheet10.Select
    With ActiveSheet
        ActiveSheet.ShowAllData
        ActiveSheet.EnableCalculation = True
        Columns("A:A").ColumnWidth = 1
        Selection.AutoFilter Field:=1, Criteria1:="1"
    End With
    
    Sheet2.Select
    ActiveWindow.ScrollRow = 1
    
    If Sheets("Cost Summary").Range("C8").Value = "Exclude" Then
        Sheets("Base Quote").Visible = xlSheetHidden
    Else
        Sheet3.Visible = True
    End If

    If Sheets("Cost Summary").Range("C9").Value = "Exclude" Then
        Sheets("Alternate 1").Visible = xlSheetHidden
    Else
        Sheet4.Visible = True
    End If

    If Sheets("Cost Summary").Range("C10").Value = "Exclude" Then
        Sheet5.Visible = xlSheetHidden
    Else
        Sheet5.Visible = True
    End If

    If Sheets("Cost Summary").Range("C11").Value = "Exclude" Then
        Sheet6.Visible = xlSheetHidden
    Else
        Sheet6.Visible = True
    End If
    
    If Sheets("Cost Summary").Range("C14").Value = "Exclude" Then
        Sheet9.Visible = xlSheetHidden
    Else
        Sheet9.Visible = True
    End If
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub

Private Sub Worksheet_Activate()
    On Error Resume Next
    Application.ScreenUpdating = False
    With ActiveSheet
        .EnableCalculation = True
        .EnableSelection = xlUnlockedCells
        .Protect ("config"), UserInterfaceOnly:=True
    End With
    Columns("A:A").ColumnWidth = 1
    ActiveWindow.ScrollRow = 1
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
 Dim sObject As Shape
    On Error Resume Next
    Application.ScreenUpdating = False
    If Sheet2.Range("N2").Value = "Locked" Then
        If ActiveSheet.FilterMode = True Then
            Exit Sub
        Else
            With ActiveSheet
                .Range("L2").Value = "Expand " & ChrW(8593)
                .Shapes("Option Button 7").ControlFormat.Value = xlOn
                .Range("A:A").Select
                Selection.AutoFilter Field:=1, Criteria1:="1"
                Columns("A:A").ColumnWidth = 1
                
                For Each sObject In ActiveSheet.Shapes
                    sObject.Visible = False
                Next
                .Shapes("ftrLogo").Visible = True
                .Shapes("Graphic 6").Visible = True
                .Shapes("Option Button 7").Visible = True
                .Shapes("Option Button 8").Visible = True
                .Shapes("Option Button 9").Visible = True
                .Shapes("Option Button 10").Visible = True
                .Range("J2:K2").Font.ThemeColor = xlThemeColorAccent2
                .Range("B19").Activate
                .EnableSelection = xlNoSelection
                ActiveWindow.ScrollRow = 1
            End With
        End If
    Else
        Exit Sub
    End If
    Application.ScreenUpdating = True
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    On Error Resume Next
    If Application.Intersect(Target, Range("G9")) Is Nothing Then Exit Sub
    '' 'G10' has been changed ''
    With Range("F19:F518")
        If (Range("G9").Value) = "NJPA" Then
            .ClearContents
            .Locked = True
        Else
            .Locked = False
        End If
    End With
End Sub

Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
 Dim sObject As Shape
    On Error Resume Next
    Application.ScreenUpdating = False
    If Sheet2.Range("N2").Value = "Locked" Then
        ActiveSheet.Range("A:A").Select
        If ActiveSheet.FilterMode = True Then
            Exit Sub
        Else
            With ActiveSheet
                If Sheet2.Range("N2").Value = "Locked" Then
                    .Unprotect ("Phoenix")
                Else
                    .Unprotect ("config")
                End If
                .Range("L2").Value = "Expand " & ChrW(8593)
                .Shapes("Option Button 7").ControlFormat.Value = xlOn
                .Range("A:A").Select
                Selection.AutoFilter Field:=1, Criteria1:="1"
                Columns("A:A").ColumnWidth = 1
                
                For Each sObject In ActiveSheet.Shapes
                    sObject.Visible = False
                Next
                .Shapes("ftrLogo").Visible = True
                .Shapes("Graphic 6").Visible = True
                .Shapes("Option Button 7").Visible = True
                .Shapes("Option Button 8").Visible = True
                .Shapes("Option Button 9").Visible = True
                .Shapes("Option Button 10").Visible = True
                .Range("J2:K2").Font.ThemeColor = xlThemeColorAccent2
                .Range("B19").Activate
                .EnableSelection = xlNoSelection
                ActiveWindow.ScrollRow = 1
                If Sheet2.Range("N2").Value = "Locked" Then
                    .Protect ("Phoenix")
                Else
                    .Protect ("config")
                End If
            End With
        End If
    Else
        Exit Sub
    End If
    Application.ScreenUpdating = True
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
    On Error Resume Next
    If Application.Intersect(Target, Range("G9")) Is Nothing Then Exit Sub
    
    '' 'G9' has been changed ''
    With Range("F19:F518")
        If (Range("G9").Value) = "NJPA" Then
            .ClearContents
            .Locked = True
        Else
            .Locked = False
        End If
    End With
    ActiveWindow.ScrollRow = 1
End Sub

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
 Dim sObject As Shape
    On Error Resume Next
    Application.ScreenUpdating = False
    'ActiveSheet.Protect ("config"), UserInterfaceOnly:=True
    If Sheet2.Range("N2").Value = "Locked" Then
        ActiveSheet.Range("A:A").Select
        If ActiveSheet.FilterMode = True Then
            Exit Sub
        Else
            With ActiveSheet
                If Sheet2.Range("N2").Value = "Locked" Then
                    .Unprotect ("Phoenix")
                Else
                    .Unprotect ("config")
                End If
                .Range("L2").Value = "Expand " & ChrW(8593)
                .Shapes("Option Button 7").ControlFormat.Value = xlOn
                .Range("A:A").Select
                Selection.AutoFilter Field:=1, Criteria1:="1"
                Columns("A:A").ColumnWidth = 1
                
                For Each sObject In ActiveSheet.Shapes
                    sObject.Visible = False
                Next
                .Shapes("ftrLogo").Visible = True
                .Shapes("Graphic 6").Visible = True
                .Shapes("Option Button 7").Visible = True
                .Shapes("Option Button 8").Visible = True
                .Shapes("Option Button 9").Visible = True
                .Shapes("Option Button 10").Visible = True
                .Range("J2:K2").Font.ThemeColor = xlThemeColorAccent2
                .Range("B19").Activate
                .EnableSelection = xlNoSelection
                ActiveWindow.ScrollRow = 1
                If Sheet2.Range("N2").Value = "Locked" Then
                    .Protect ("Phoenix")
                Else
                    .Protect ("config")
                End If
            End With
        End If
    Else
        Exit Sub
    End If
    Application.ScreenUpdating = True
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
    On Error Resume Next
    If Application.Intersect(Target, Range("G9")) Is Nothing Then Exit Sub
    
    '' 'G10' has been changed ''
    With Range("F19:F518")
        If (Range("G9").Value) = "NJPA" Then
            .ClearContents
            .Locked = True
        Else
            .Locked = False
        End If
    End With
    ActiveWindow.ScrollRow = 1
End Sub

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
 Dim sObject As Shape
    On Error Resume Next
    Application.ScreenUpdating = False
    'ActiveSheet.Protect ("config"), UserInterfaceOnly:=True
    If Sheet2.Range("N2").Value = "Locked" Then
        ActiveSheet.Range("A:A").Select
        If ActiveSheet.FilterMode = True Then
            Exit Sub
        Else
            With ActiveSheet
                If Sheet2.Range("N2").Value = "Locked" Then
                    .Unprotect ("Phoenix")
                Else
                    .Unprotect ("config")
                End If
                .Range("L2").Value = "Expand " & ChrW(8593)
                .Shapes("Option Button 7").ControlFormat.Value = xlOn
                .Range("A:A").Select
                Selection.AutoFilter Field:=1, Criteria1:="1"
                Columns("A:A").ColumnWidth = 1
                
                For Each sObject In ActiveSheet.Shapes
                    sObject.Visible = False
                Next
                .Shapes("ftrLogo").Visible = True
                .Shapes("Graphic 6").Visible = True
                .Shapes("Option Button 7").Visible = True
                .Shapes("Option Button 8").Visible = True
                .Shapes("Option Button 9").Visible = True
                .Shapes("Option Button 10").Visible = True
                .Range("J2:K2").Font.ThemeColor = xlThemeColorAccent2
                .Range("B19").Activate
                .EnableSelection = xlNoSelection
                ActiveWindow.ScrollRow = 1
                If Sheet2.Range("N2").Value = "Locked" Then
                    .Protect ("Phoenix")
                Else
                    .Protect ("config")
                End If
            End With
        End If
    Else
        Exit Sub
    End If
    Application.ScreenUpdating = True
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
    
    On Error Resume Next
    If Application.Intersect(Target, Range("G9")) Is Nothing Then Exit Sub
    
    '' 'G10' has been changed ''
    With Range("F19:F518")
        If (Range("G9").Value) = "NJPA" Then
            .ClearContents
            .Locked = True
        Else
            .Locked = False
        End If
    End With
    ActiveWindow.ScrollRow = 1
End Sub

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    On Error Resume Next
    Application.ScreenUpdating = False
    ActiveSheet.Protect ("config"), UserInterfaceOnly:=True
    If Sheet2.Range("N2").Value = "Locked" Then
        ActiveSheet.Range("A:A").Select
        If ActiveSheet.FilterMode = True Then
            Exit Sub
        Else
            With ActiveSheet
                Columns("A:A").ColumnWidth = 1
                Selection.AutoFilter Field:=1, Criteria1:="1"
                .Range("J2").Value = "Expand " & ChrW(8593)
                .Shapes("Option Button 1").ControlFormat.Value = xlOn
                    .Shapes("Graphic 2").Visible = False
                    .Range("I2").Font.ThemeColor = xlThemeColorAccent2
                    .Range("B15").Activate
                    .EnableSelection = xlNoSelection
                    ActiveWindow.ScrollRow = 1
            End With
        End If
    Else
        Exit Sub
    End If
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    On Error Resume Next
    Application.ScreenUpdating = False
    If Sheet2.Range("N2").Value = "Locked" Then
        If ActiveSheet.FilterMode = True Then
            Exit Sub
        Else
            With ActiveSheet
                Columns("A:A").ColumnWidth = 1
                Selection.AutoFilter Field:=1, Criteria1:="1"
                .Range("L2").Value = "Expand " & ChrW(8593)
                .Shapes("Option Button 1").ControlFormat.Value = xlOn
                    .Shapes("Graphic 2").Visible = False
                    .Shapes("Graphic 3").Visible = False
                    .Range("K2:L2").Font.ThemeColor = xlThemeColorAccent2
                    .EnableSelection = xlNoSelection
                    ActiveWindow.ScrollRow = 1
            End With
        End If
    Else
        If ActiveSheet.FilterMode = True Then
            With ActiveSheet
                .Range("L2").Font.ThemeColor = xlThemeColorDark1
                .Shapes("Graphic 3").Visible = True
            End With
        Else
            With ActiveSheet
                .Range("K2").Font.ThemeColor = xlThemeColorDark1
                .Shapes("Graphic 2").Visible = True
                .EnableSelection = xlUnlockedCells
            End With
        End If
    End If
    Application.ScreenUpdating = True
End Sub

    
Attribute VB_Name = "Sheet98"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet99"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
    Dim wSheetName As Worksheet
    If Sheet2.Range("N2").Value = "Locked" Then
        Exit Sub
    Else
        For Each wSheetName In Worksheets
            wSheetName.Protect ("config"), UserInterfaceOnly:=True
        Next wSheetName
        Sheet22.Unprotect ("config")
    End If
End Sub

Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)
LastSheet = Sh.Name
End Sub
Attribute VB_Name = "UpdateQuotes"
Sub UpdateQuote()
 On Error Resume Next
    Application.ScreenUpdating = False
    With ActiveSheet
        ActiveSheet.ShowAllData
        ActiveSheet.EnableCalculation = True
        Columns("A:A").ColumnWidth = 1
        Selection.AutoFilter Field:=1, Criteria1:="1"
    End With
    Range("a1").Select
    Application.ScreenUpdating = True
End Sub
 
Sub collapse()
    On Error Resume Next
    Application.ScreenUpdating = False
    With ActiveSheet
        ActiveSheet.ShowAllData
        ActiveSheet.EnableCalculation = True
        Columns("A:A").ColumnWidth = 1
        Selection.AutoFilter Field:=1, Criteria1:="1"
    End With
    Range("a1").Select
    Application.ScreenUpdating = True
End Sub

Sub expand()
    On Error Resume Next
    With ActiveSheet
        ActiveSheet.ShowAllData
        Range("A1").Select
    End With
End Sub

Sub update_Quote()
 Dim sObject As Shape
    On Error Resume Next
    Application.ScreenUpdating = False
    ActiveSheet.Range("A:A").Select
    If ActiveSheet.FilterMode = True Then
        With ActiveSheet
            .ShowAllData
            .Range("L2").Value = "Collapse " & ChrW(8593)
            .Range("B19").Select
            If Sheet2.Range("N2").Value <> "Locked" Then
                For Each sObject In ActiveSheet.Shapes
                    sObject.Visible = True
                Next
                .Range("J2:K2").Font.ThemeColor = xlThemeColorDark1
                .EnableSelection = xlUnlockedCells
            Else
                For Each sObject In ActiveSheet.Shapes
                    sObject.Visible = False
                Next
                .Shapes("ftrLogo").Visible = True
                .Shapes("Graphic 6").Visible = True
                .Shapes("Option Button 7").Visible = True
                .Shapes("Option Button 8").Visible = True
                .Shapes("Option Button 9").Visible = True
                .Shapes("Option Button 10").Visible = True
                .EnableSelection = xlNoSelection
            End If
        End With
    Else
        With ActiveSheet
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
            .Range("L2").Value = "Expand " & ChrW(8593)
            .Shapes("Option Button 7").ControlFormat.Value = xlOn
            For Each sObject In ActiveSheet.Shapes
                sObject.Visible = False
            Next
            .Shapes("ftrLogo").Visible = True
            .Shapes("Graphic 6").Visible = True
            .Shapes("Option Button 7").Visible = True
            .Shapes("Option Button 8").Visible = True
            .Shapes("Option Button 9").Visible = True
            .Shapes("Option Button 10").Visible = True
            .Range("J2:K2").Font.ThemeColor = xlThemeColorAccent2
            .Range("B19").Activate
            .EnableSelection = xlNoSelection
            ActiveWindow.ScrollRow = 1
        End With
    End If
    Application.ScreenUpdating = True
End Sub

Sub update_Writein()
 
 Dim sObject As Shape
    On Error Resume Next
    Application.ScreenUpdating = False
    ActiveSheet.Range("A:A").Select
    If ActiveSheet.FilterMode = True Then
        With ActiveSheet
            .ShowAllData
            .Range("J2").Value = "Collapse " & ChrW(8593)
            .Range("B15").Select
            .Shapes("Option Button 1").ControlFormat.Value = xlOn
            If Sheet2.Range("N2").Value <> "Locked" Then
                .Range("I2").Font.ThemeColor = xlThemeColorDark1
                .Shapes("Graphic 2").Visible = True
                .EnableSelection = xlUnlockedCells
            Else
                .Shapes("Graphic 2").Visible = False
                .EnableSelection = xlNoSelection
            End If
        End With
    Else
        With ActiveSheet
            If Sheet2.Range("N2").Value <> "Locked" Then
                .Range("I2").Font.ThemeColor = xlThemeColorDark1
                .EnableSelection = xlUnlockedCells
            Else
                .EnableSelection = xlNoSelection
            End If
            .Range("J2").Value = "Expand " & ChrW(8593)
            .Shapes("Option Button 1").ControlFormat.Value = xlOn
            .Range("I2").Font.ThemeColor = xlThemeColorAccent2
            .Shapes("Graphic 2").Visible = False
            .Range("B15").Activate
        End With
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
    End If
    ActiveWindow.ScrollRow = 1
    Application.ScreenUpdating = True
End Sub

Sub update_Maint()
    On Error Resume Next
    Application.ScreenUpdating = False
    ActiveSheet.Range("A:A").Select
    If ActiveSheet.FilterMode = True Then
        With ActiveSheet
            .ShowAllData
            .Range("L2").Value = "Collapse " & ChrW(8593)
            '.Rows("21").EntireRow.Hidden = True
            .Rows("62:304").EntireRow.Hidden = True
            .Range("K21").Select
            If Sheet2.Range("N2").Value <> "Locked" Then
                .Range("K2").Font.ThemeColor = xlThemeColorDark1
                .Shapes("Graphic 2").Visible = True
                .EnableSelection = xlUnlockedCells
            Else
                .Shapes("Graphic 2").Visible = False
                .EnableSelection = xlNoSelection
            End If
        End With
    Else
        With ActiveSheet
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
            If Sheet2.Range("N2").Value <> "Locked" Then
                .Range("I2").Font.ThemeColor = xlThemeColorDark1
                .EnableSelection = xlUnlockedCells
            Else
                .EnableSelection = xlNoSelection
            End If
            .Range("L2").Value = "Expand " & ChrW(8593)
            .Shapes("Option Button 1").ControlFormat.Value = xlOn
            .Range("K2").Font.ThemeColor = xlThemeColorAccent2
            .Shapes("Graphic 2").Visible = False
            .Range("A1").Select
        End With
            ActiveWindow.ScrollRow = 1
    End If
    Application.ScreenUpdating = True
End Sub

Sub update_Itemized()
    On Error Resume Next
    Sheets("Itemized Pricing").Select
    Application.ScreenUpdating = False
    With ActiveSheet
        .ShowAllData
        .EnableCalculation = True
        Columns("A:A").ColumnWidth = 1
        Selection.AutoFilter Field:=1, Criteria1:="1"
    End With
    Application.ScreenUpdating = True
End Sub

Sub update_Labor()
    On Error Resume Next
    Application.ScreenUpdating = False
    ActiveSheet.Range("A:A").Select
    If ActiveSheet.FilterMode = True Then
        With ActiveSheet
            .ShowAllData
            .Range("L2").Value = "Update " & ChrW(8593)
            .Protect Password:=("config")
            .Range("A1").Select
        End With
    Else
        Columns("A:A").ColumnWidth = 1
        Selection.AutoFilter Field:=1, Criteria1:="1"
        Sheets("Itemized Pricing").Select
        With ActiveSheet
            .ShowAllData
            .EnableCalculation = True
            Columns("A:A").ColumnWidth = 1
            Selection.AutoFilter Field:=1, Criteria1:="1"
        End With
        Sheet8.Select
        ActiveSheet.Range("L2").Value = "Expand " & ChrW(8593)
        Range("a12").Select
    End If
    Application.ScreenUpdating = True
End Sub



INQUEST-PP=macro
