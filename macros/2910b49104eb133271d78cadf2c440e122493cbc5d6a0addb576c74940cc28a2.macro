Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforePrint(Cancel As Boolean)
If ActiveSheet.Name = "Aufma|fffd|verwaltung" Then
Hinweis.Show
End If
End Sub

Private Sub Workbook_Open()
If Sheets("Abfrage").Range("A1") = 1 Then
Call |fffd|bernahme
End If
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
Sheets("Abfrage").Range("A1").Value = Sheets("Abfrage").Range("A1").Value + 1
End Sub

Attribute VB_Name = "Hinweis"
Attribute VB_Base = "0{8D056582-3C80-45C2-8251-C900159A1E7F}{062EC958-20B6-4933-842C-76A1AFC7BFE5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub ok_Click()
result = True
Hide
End Sub

Private Sub abbrechen_Click()
result = False
Hide
SendKeys "{esc}"
End Sub
Attribute VB_Name = "Modul1"
Sub Summierung()
' Titel- und Gewerkesummen bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    Range("J5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 8).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("J4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 7).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("J4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 8).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("J4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("E9").Select
    Range("J9").Select
    
End Sub

Sub Summierung2()

'Titel- und Gewerkesummen Aufma|fffd| 1 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 11).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -11).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 11).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -11).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 11).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -11).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 11).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -11).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 11).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -11).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 11).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -11).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 11).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -11).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 11).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -11).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 11).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -11).Range("A1").Select
    End If
    Loop
    Range("L5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 10).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -11).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("L4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -11).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("L4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 10).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -11).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("L4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("L9").Select
    
End Sub


Sub Summierung3()

'Titel- und Gewerkesummen Aufma|fffd| 2 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 15).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -15).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 15).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -15).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 15).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -15).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 15).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -15).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 15).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -15).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 15).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -15).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 15).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -15).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 15).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -15).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 15).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -15).Range("A1").Select
    End If
    Loop
    Range("P5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 14).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -15).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("P4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 13).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -15).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("P4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 14).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -15).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("P4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("P9").Select
    
End Sub


Sub Summierung4()

'Titel- und Gewerkesummen Aufma|fffd| 3 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 19).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -19).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 19).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -19).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 19).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -19).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 19).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -19).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 19).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -19).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 19).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -19).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 19).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -19).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 19).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -19).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 19).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -19).Range("A1").Select
    End If
    Loop
    Range("T5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 18).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -19).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("T4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 17).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -19).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("T4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 18).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -19).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("T4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("T9").Select
    
End Sub


Sub Summierung5()

'Titel- und Gewerkesummen Aufma|fffd| 4 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 23).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -23).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 23).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -23).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 23).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -23).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 23).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -23).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 23).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -23).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 23).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -23).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 23).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -23).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 23).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -23).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 23).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -23).Range("A1").Select
    End If
    Loop
    Range("X5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 22).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -23).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("X4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 21).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -23).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("X4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 22).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -23).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("X4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("X9").Select
    
End Sub



Sub Summierung6()

'Titel- und Gewerkesummen Aufma|fffd| 5 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 27).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -27).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 27).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -27).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 27).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -27).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 27).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -27).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 27).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -27).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 27).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -27).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 27).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -27).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 27).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -27).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 27).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -27).Range("A1").Select
    End If
    Loop
    Range("AB5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 26).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -27).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AB4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 25).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -27).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AB4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 26).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -27).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AB4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AB9").Select
    
End Sub




Sub Summierung7()

'Titel- und Gewerkesummen Aufma|fffd| 6 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 31).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -31).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 31).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -31).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 31).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -31).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 31).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -31).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 31).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -31).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 31).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -31).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 31).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -31).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 31).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -31).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 31).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -31).Range("A1").Select
    End If
    Loop
    Range("AF5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 30).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -31).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AF4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 29).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -31).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AF4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 30).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -31).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AF4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AF9").Select
    
End Sub





Sub Summierung8()

'Titel- und Gewerkesummen Aufma|fffd| 7 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 35).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -35).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 35).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -35).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 35).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -35).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 35).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -35).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 35).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -35).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 35).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -35).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 35).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -35).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 35).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -35).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 35).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -35).Range("A1").Select
    End If
    Loop
    Range("AJ5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 34).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -35).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AJ4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 33).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -35).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AJ4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 34).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -35).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AJ4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AJ9").Select
    
End Sub







Sub Summierung9()

'Titel- und Gewerkesummen Aufma|fffd| 8 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 39).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -39).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 39).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -39).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 39).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -39).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 39).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -39).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 39).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -39).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 39).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -39).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 39).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -39).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 39).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -39).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 39).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -39).Range("A1").Select
    End If
    Loop
    Range("AN5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 38).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -39).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AN4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 37).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -39).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AN4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 38).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -39).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AN4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AN9").Select
    
End Sub





Sub Summierung10()

'Titel- und Gewerkesummen Aufma|fffd| 9 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 43).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -43).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 43).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -43).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 43).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -43).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 43).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -43).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 43).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -43).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 43).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -43).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 43).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -43).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 43).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -43).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 43).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -43).Range("A1").Select
    End If
    Loop
    Range("AR5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 42).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -43).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AR4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 41).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -43).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AR4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 42).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -43).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AR4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AR9").Select
    
End Sub





Sub Summierung11()

'Titel- und Gewerkesummen Aufma|fffd| 10 bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 47).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -47).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 47).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -47).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 47).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -47).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 47).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -47).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 47).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -47).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 47).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -47).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 47).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -47).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 47).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -47).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 47).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -47).Range("A1").Select
    End If
    Loop
    Range("AV5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 46).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -47).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AV4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 45).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -47).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AV4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 46).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -47).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AV4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AV9").Select
    
End Sub





Sub Summierung12()

'Titel- und Gewerkesummen Prognose bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 50).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -50).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 50).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -50).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 50).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -50).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 50).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -50).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 50).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -50).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 50).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -50).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 50).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -50).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 50).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -50).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 50).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -50).Range("A1").Select
    End If
    Loop
    Range("AY5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 49).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -50).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AY4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 48).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -50).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AY4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 49).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -50).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("AY4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("AY9").Select
    
End Sub









Attribute VB_Name = "Modul2"
Sub |fffd|bernahme()

' LV |fffd|ffnen
Workbooks.Open Filename:="W:\09-ABD Anlagenbau Deutschland\09-ABD Daten|fffd|bergabe\AllePositionen.xls"

' Rausl|fffd|schen nichtben|fffd|tigter Spalten, Formatieren
    Range("A1").Select
    Columns("A:A").Select
    Selection.Delete Shift:=xlToLeft
    Columns("C:D").Select
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select
    ActiveWindow.DisplayZeros = False
    Cells.Select
    With Selection.Font
        .Name = "Arial"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Columns("G:K").Select
    Selection.NumberFormat = "#,##0.00 [$|fffd|-1]"
    Columns("E:E").Select
    Selection.NumberFormat = "#,##0.00"
    Columns("C:C").Select
    Selection.ColumnWidth = 39.43
    Selection.ColumnWidth = 50.29
    Range("A1").Select

' Rausl|fffd|schen nichtben|fffd|tigter Zeilen, Formatieren
    Rows("1:7").Select
    Selection.Delete Shift:=xlUp
    Range("M1").Select
        
Do While Not IsEmpty(ActiveCell)

ActiveCell.Offset(1, 0).Select

    If ActiveCell.Value Like "U" Or ActiveCell.Value Like "D" Then
        ActiveCell.EntireRow.Select
        Selection.Delete
        ActiveCell.Offset(-1, 12).Select
    End If
         
    If ActiveCell.Value Like "A" Then
        Selection.Copy
        ActiveCell.Offset(0, -1).Select
        ActiveSheet.Paste
        ActiveCell.Offset(0, 1).Select
    End If
    
    If ActiveCell.Value Like "E" Then
        Selection.Copy
        ActiveCell.Offset(0, -1).Select
        ActiveSheet.Paste
        ActiveCell.Offset(0, 1).Select
    End If
   
Loop
    
' Rausl|fffd|schen nichtben|fffd|tigter Spalten, Formatieren
    Columns("M:M").Select
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select
    
' Hinweistexte rausl|fffd|schen
    Range("L1").Select
        
Do While Not IsEmpty(ActiveCell)

    ActiveCell.Offset(1, 0).Select

    If ActiveCell.Value Like "B" Then
        ActiveCell.EntireRow.Select
        Selection.Delete
        ActiveCell.Offset(-1, 11).Select
    End If

Loop
    
'Titelspalte vorholen
    
    Columns("L:L").Select
    Selection.Cut
    Columns("A:A").Select
    Selection.Insert Shift:=xlToRight
      
' nach KWP-|fffd|bernahme kopieren

    Cells.Select
    Selection.Copy
    
    Windows("KWP-|fffd|bernahme_L_Heyne1").Activate
    Sheets("Daten aus KWP").Select
    Range("A1").Select
    ActiveSheet.Paste
    Range("B2").Select
    Columns("J:J").Select
    Selection.TextToColumns Destination:=Range("J1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1)
       
    'Windows("KWP-|fffd|bernahme.xls").Activate
    Sheets("Aufma|fffd|verwaltung").Select
    Range("A1").Select
    
    'LV schlie|fffd|en
    Windows("AllePositionen.xls").Activate
    Application.DisplayAlerts = False
    ActiveWindow.Close
    Application.DisplayAlerts = True
    
    'Kopieren und nur Werte wieder einf|fffd|gen
    Columns("A:F").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
'Alternativpos. grau hinterlegen, GP l|fffd|schen
    
    Range("A9").Select
    
Do While Not IsEmpty(ActiveCell)

    If ActiveCell.Value Like "A" Then
        ActiveCell.Offset(0, 0).Range("A1:AZ1").Select
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
        ActiveCell.Offset(0, 9).Range("A1:A1").Select
        Selection.ClearContents
        ActiveCell.Offset(0, -9).Select
    End If

    If ActiveCell.Value Like "E" Then
        ActiveCell.Offset(0, 0).Range("A1:AZ1").Select
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
        ActiveCell.Offset(0, 0).Range("A1:A1").Select
    End If
              
ActiveCell.Offset(1, 0).Select
Loop
    
    
                 
' in Aufma|fffd|verwaltung Zeilen formatieren
    Range("B9").Select
    Do While Not IsEmpty(ActiveCell)

'1. Ebene formatieren
    If ActiveCell.Value Like "*." Then
        ActiveCell.Range("A1:AY1").Select
        With Selection.Interior
            .ColorIndex = 46
            .Pattern = xlSolid
        End With
        Selection.Font.Bold = True
        Selection.Font.ColorIndex = 2
        ActiveCell.Offset(0, 2).Range("A1:AZ1").Select
        Selection.ClearContents
        ActiveCell.Offset(0, -3).Select
        ActiveCell.Value = 1
        ActiveCell.Offset(0, 1).Select
    End If

'2. Ebene formatieren
    If ActiveCell.Value Like "*.*." Then
        ActiveCell.Range("A1:AY1").Select
        With Selection.Interior
            .ColorIndex = 45
            .Pattern = xlSolid
        End With
        Selection.Font.Bold = True
        ActiveCell.Offset(0, 2).Range("A1:C1").Select
        Selection.ClearContents
        ActiveCell.Offset(0, -3).Select
        ActiveCell.Value = 2
        ActiveCell.Offset(0, 1).Select
    End If
     
'3. Ebene formatieren
    If ActiveCell.Value Like "*.*.*." Then
        ActiveCell.Range("A1:AY1").Select
        With Selection.Interior
            .ColorIndex = 7
            .Pattern = xlSolid
        End With
        Selection.Font.Bold = True
        ActiveCell.Offset(0, 2).Range("A1:C1").Select
        Selection.ClearContents
        ActiveCell.Offset(0, -3).Select
        ActiveCell.Value = 3
        ActiveCell.Offset(0, 1).Select
    End If
    
'4. Ebene formatieren
    If ActiveCell.Value Like "*.*.*.*." Then
        ActiveCell.Range("A1:AY1").Select
        With Selection.Interior
            .ColorIndex = 38
            .Pattern = xlSolid
        End With
        Selection.Font.Bold = True
        ActiveCell.Offset(0, 2).Range("A1:C1").Select
        Selection.ClearContents
        ActiveCell.Offset(0, -3).Select
        ActiveCell.Value = 4
        ActiveCell.Offset(0, 1).Select
    End If
    

ActiveCell.Offset(1, 0).Select
Loop
    
' Titel- und Gewerkesummen bilden

Dim i As Double, j As Double
Dim k As Double

  ActiveSheet.Range("A9").Activate
  
  'Cursor ans Ende fahren
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate


'Positionen aufsummieren
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    k = 0
    Do While Not IsNumeric(ActiveCell) And Not IsEmpty(ActiveCell)
    On Error GoTo Abbruch
    If Not IsNumeric(ActiveCell) Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    k = k + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else: ActiveCell.Offset(-1, 0).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    ActiveCell.Value = k
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop
 
Abbruch:

  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 4.Ebenen addieren und in 3.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 3 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 4 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop

'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 3.Ebenen addieren und in 2.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 2 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 3 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop
  
'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate
  
' Summen der 2.Ebenen addieren und in 1.Ebene schreiben
  Do While Not IsEmpty(ActiveCell)
  On Error GoTo Start
        i = 0
    Do While Not ActiveCell.Value = 1 And Not IsEmpty(ActiveCell)
    ActiveCell.Offset(-1, 0).Range("A1").Select
   
    If ActiveCell.Value = 2 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(0, 9).Range("A1").Select
    If ActiveCell.Value = 0 Then ActiveCell.Value = i
    ActiveCell.Offset(-1, -9).Range("A1").Select
  Loop
  
  'Cursor ans Ende fahren
  Range("A9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, 0).Range("A1").Activate

'Summen der 1.Ebenen addieren und in Kopf schreiben
        i = 0
    Do While Not IsEmpty(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(-1, 0).Range("A1").Select
    If ActiveCell.Value = 1 Then
    ActiveCell.Offset(0, 9).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(0, -9).Range("A1").Select
    End If
    Loop
    Range("J5").Select
    ActiveCell.Value = i

'Edit Denny Marschner 13.09.2010
'Summierung der Nachtr|fffd|ge die mit "N" als Positionsnummer beginnen
'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
  ' eine Zelle h|fffd|her und auf letzte Spalte springen
  ActiveCell.Offset(-1, -1).Range("A1").Activate
      
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "N*.*" Then
    ActiveCell.Offset(0, 8).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("J4").Select
    ActiveCell.Value = i
    
'Summierung aller Positionen, die im Pos.-Text mit "NA" beginnen
'Cursor ans Ende fahren
  Range("C9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -2).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 2).Range("A1").Select
    If ActiveCell.Value Like "NA *" Then
    ActiveCell.Offset(0, 7).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -2).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("J4").Select
    ActiveCell.Value = ActiveCell.Value + i
    
    'Summierung aller Positionen, die mit "99.?" als Positionsnummer beginnen
    'Cursor ans Ende fahren
  Range("B9").Select
  Do While Not IsEmpty(ActiveCell)
  ActiveCell.Offset(1, 0).Range("A1").Activate
  Loop
     ' eine Zelle h|fffd|her und auf letzte Spalte springen
      ActiveCell.Offset(-1, -1).Range("A1").Activate
        
'Summen der Nachtr|fffd|ge addieren und in Kopf schreiben
    i = 0
    Do While Not IsEmpty(ActiveCell)
    Do While Not IsNumeric(ActiveCell)
    On Error GoTo Start
    ActiveCell.Offset(0, 1).Range("A1").Select
    If ActiveCell.Value Like "99*.*" Then
    ActiveCell.Offset(0, 8).Range("A1").Select
    i = i + ActiveCell.Value
    ActiveCell.Offset(-1, -9).Range("A1").Select
    Else
    ActiveCell.Offset(-1, -1).Range("A1").Select
    End If
    Loop
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Loop
    Range("J4").Select
    ActiveCell.Value = ActiveCell.Value + i
Start:
    Range("E9").Select
    Range("A9").Select
    
    'Datei speichern
    ChDrive "W:\"
    ChDir "W:\09-ABD Anlagenbau Deutschland\09-ABD Baustellen\"
MsgBox "KWP-Daten erfolgreich in EXCEL eingef|fffd|gt ! Datei bitte im Projektpfad speichern !"
Application.Dialogs(xlDialogSaveAs).Show
MsgBox "ACHTUNG !  Neuer Rechenalgorithmus !  Ergebnisse deshalb bitte besonders kritisch pr|fffd|fen !"
MsgBox "Zur Beschleunigung des Summierens bitte nichtbelegte Zeilen unterhalb letzter Posiotion bis Zeile 3000 l|fffd|schen !"
    
End Sub

Attribute VB_Name = "Modul31"
Sub |fffd|bernahme_AM(Aufma|fffd|)
Attribute |fffd|bernahme_AM.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd|bernahme_AM Makro
'
Dim pos
Dim am As Double
Dim sprung As Double
Dim datei

datei = ThisWorkbook.Name

If Aufma|fffd| = "Aufma|fffd| 1" Then
    sprung = 9
ElseIf Aufma|fffd| = "Aufma|fffd| 2" Then
    sprung = 12
ElseIf Aufma|fffd| = "Aufma|fffd| 3" Then
    sprung = 16
ElseIf Aufma|fffd| = "Aufma|fffd| 4" Then
    sprung = 20
ElseIf Aufma|fffd| = "Aufma|fffd| 5" Then
    sprung = 24
ElseIf Aufma|fffd| = "Aufma|fffd| 6" Then
    sprung = 28
ElseIf Aufma|fffd| = "Aufma|fffd| 7" Then
    sprung = 32
ElseIf Aufma|fffd| = "Aufma|fffd| 8" Then
    sprung = 36
ElseIf Aufma|fffd| = "Aufma|fffd| 9" Then
    sprung = 40
ElseIf Aufma|fffd| = "Aufma|fffd| 10" Then
    sprung = 44
Else
MsgBox "Fehler bei |fffd|bernahme, bitte an Herr Marschner wenden"
Exit Sub
End If

Sheets("Aufma|fffd|").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    Workbooks.Open Filename:="W:\09-ABD Anlagenbau Deutschland\09-ABD Daten|fffd|bergabe\export.xlsx"
    Columns("A:C").Select
    Selection.Copy
Windows(datei).Activate
    Sheets("Aufma|fffd|").Select
    Cells.Select
    ActiveSheet.Paste
Application.DisplayAlerts = False
    Windows("export.xlsx").Close
Application.DisplayAlerts = True
ActiveSheet.Range("A1").Activate
   
   Dim intRow As Integer, intLastRow As Integer
   intLastRow = Cells.SpecialCells(xlCellTypeLastCell).Row
   For intRow = intLastRow To 1 Step -1
      If Application.CountA(Rows(intRow)) = 0 Then
         Rows(intRow).Delete
      End If
   Next intRow
Do While Not IsEmpty(ActiveCell)
ActiveCell.Value = Trim(ActiveCell.Value)
pos = ActiveCell.Value
am = ActiveCell.Offset(0, 2).Value
Application.CutCopyMode = False
Sheets("Aufma|fffd|verwaltung").Select
Columns("B:B").Select
    Cells.Find(What:=pos, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
On Error GoTo fehler
ActiveCell.Offset(0, sprung).Value = am
Sheets("Aufma|fffd|").Select
ActiveCell.Offset(1, 0).Activate
Loop
Sheets("Aufma|fffd|verwaltung").Select
ActiveSheet.Range("B9").Activate
End

fehler:
MsgBox "Fehler bei |fffd|bernahme. LV.-Nr. konnte nicht gefunden werden, bitte LV |fffd|berpr|fffd|fen."
End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton13, 17, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton12, 16, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton11, 15, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton10, 14, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton9, 13, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton8, 12, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton7, 11, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 10, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 9, 8, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 8, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 6, 10, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 5, 11, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 2, 12, MSForms, CommandButton"

Private Sub CommandButton1_Click()
Call Summierung
End Sub

Private Sub CommandButton10_Click()
Call Summierung10
End Sub

Private Sub CommandButton11_Click()
Call Summierung11
End Sub

Private Sub CommandButton12_Click()
Call Summierung12
End Sub

Private Sub CommandButton13_Click()
Call UserForm1.Show
End Sub

Private Sub CommandButton2_Click()
Call Summierung2
End Sub

Private Sub CommandButton3_Click()
Call Summierung3
End Sub

Private Sub CommandButton4_Click()
Call Summierung4
End Sub

Private Sub CommandButton5_Click()
Call Summierung5
End Sub

Private Sub CommandButton6_Click()
Call Summierung6
End Sub

Private Sub CommandButton7_Click()
Call Summierung7
End Sub

Private Sub CommandButton8_Click()
Call Summierung8
End Sub

Private Sub CommandButton9_Click()
Call Summierung9
End Sub


Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)

End Sub
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{260F775C-A87A-4A41-964D-286EDAD35743}{8DA3AF27-C15A-4AFE-A6F7-6839E7FC2077}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


 Private Sub UserForm_Initialize()
' Die Daten werden im Code Zeilenweise eingetragen
With Me.ComboBox2
.AddItem "Aufma|fffd| 1"
.AddItem "Aufma|fffd| 2"
.AddItem "Aufma|fffd| 3"
.AddItem "Aufma|fffd| 4"
.AddItem "Aufma|fffd| 5"
.AddItem "Aufma|fffd| 6"
.AddItem "Aufma|fffd| 7"
.AddItem "Aufma|fffd| 8"
.AddItem "Aufma|fffd| 9"
.AddItem "Aufma|fffd| 10"
.ListIndex = 0 'Vorbelegung "Schmitz" bei Formularstart
.Style = fmStyleDropDownList
End With
End Sub

Private Sub CommandButton1_Click()
Aufma|fffd| = ComboBox2.Value
Call |fffd|bernahme_AM(Aufma|fffd|)
Hide
End Sub

Private Sub CommandButton2_Click()
Hide
End Sub



INQUEST-PP=macro
