Attribute VB_Name = "Module1"
Public Sub ButtonSet()

With ActiveSheet.OLEObjects("AddLogo")
      .Object.Font.Size = 11
      .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
      
       .Top = Range("X4").Top
       .Left = Range("X4").Left
        .Width = 252
        .Height = 41.4
End With

With ActiveSheet.OLEObjects("BT_PRN")
      .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
       .Top = Range("X8").Top
       .Left = Range("X8").Left
        .Width = 252
        .Height = 41.4
         .Object.Font.Size = 11
      .Object.WordWrap = True
End With

With ActiveSheet.OLEObjects("BT_PDF")
     .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
        .Top = Range("X8").Top + 43
       .Left = Range("X8").Left
        .Width = 252
        .Height = 41.4
         .Object.Font.Size = 11
      .Object.WordWrap = True
End With

With ActiveSheet.OLEObjects("att1")
   .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
   .Object.AutoSize = False
   ' .Object.AutoSize = True
       
       .Top = Range("Y13").Top + 2
       .Left = Range("Y13").Left
       .Width = 92.4
       .Height = 40.8
      
      .Object.Font.Size = 11
      .Object.WordWrap = True
   
End With
            
With ActiveSheet.OLEObjects("att2")
     .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
       .Top = Range("AB13").Top + 2
       .Left = Range("AB13").Left
      
        
      '  .Top = 227
      '  .Left = 1531.8
        .Width = 92.4
        .Height = 40.8
         .Object.Font.Size = 11
      .Object.WordWrap = True
End With

With ActiveSheet.OLEObjects("SendMe")
        .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
           .Top = Range("X22").Top
       .Left = Range("X22").Left
        .Width = 252
        .Height = 41.4
         .Object.Font.Size = 11
      .Object.WordWrap = True
End With
' Application.ScreenUpdating = True
End Sub
Public Sub ButtonReset()

With ActiveSheet.OLEObjects("AddLogo")
      .Object.Font.Size = 11
      .Object.WordWrap = True
     .Object.AutoSize = False
    .Object.AutoSize = True
      
       .Top = Range("X4").Top
       .Left = Range("X4").Left
        .Width = 252
        .Height = 41.4
     
End With

With ActiveSheet.OLEObjects("BT_PRN")
         .Object.AutoSize = False
    .Object.AutoSize = True
  
       
       .Top = Range("X8").Top
       .Left = Range("X8").Left
        .Width = 252
        .Height = 41.4
End With

With ActiveSheet.OLEObjects("BT_PDF")
        .Top = Range("X8").Top + 43
       .Left = Range("X8").Left
        .Width = 252
        .Height = 41.4
End With


' Application.ScreenUpdating = True
 
 End Sub

Sub EmbedGif()
    
ActiveSheet.Unprotect Password:=100
    
    Dim Bytes() As Byte
    Dim FileNum As Integer
    Dim Var() As Variant
    Const Gif_Path_Name As String = "C:\a.gif"
    

    FileNum = FreeFile
    
    ReDim Bytes(1 To FileLen(Gif_Path_Name))

    Open Gif_Path_Name For Binary As #FileNum
        Get #FileNum, 1, Bytes
    Close FileNum
    
        With Worksheets("Macros")
            .Range(.Cells(100, 100), .Cells(UBound(Bytes), 1)).value = Application.Transpose(Bytes)
        End With
        ThisWorkbook.Save
End Sub

Sub BTAtt()

With ActiveSheet.OLEObjects("BT_SendMe")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("B27").Top
       .Left = Range("B27").Left
        .Width = 255
        .Height = 30
End With

With ActiveSheet.OLEObjects("Bt_Att_1")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("B5").Top
       .Left = Range("B5").Left - 2
        .Width = 128
        .Height = 30
End With

With ActiveSheet.OLEObjects("Bt_Att_2")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("D5").Top
       .Left = Range("D5").Left - 2
        .Width = 128
        .Height = 30
End With


With ActiveSheet.OLEObjects("Bt_Att_3")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("F5").Top
       .Left = Range("F5").Left - 2
        .Width = 128
        .Height = 30
End With

With ActiveSheet.OLEObjects("Bt_Att_4")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("H5").Top
       .Left = Range("H5").Left - 2
        .Width = 128
        .Height = 30
End With
With ActiveSheet.OLEObjects("Bt_Att_5")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("J5").Top
       .Left = Range("J5").Left - 2
        .Width = 128
        .Height = 30
End With

With ActiveSheet.OLEObjects("Bt_Att_6")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("F11").Top
       .Left = Range("F11").Left - 2
        .Width = 128
        .Height = 30
End With

With ActiveSheet.OLEObjects("Bt_Att_7")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("H11").Top
       .Left = Range("H11").Left - 2
        .Width = 128
        .Height = 30
End With

With ActiveSheet.OLEObjects("Bt_Att_8")
       
        .Object.AutoSize = False
    .Object.AutoSize = True
   
       .Top = Range("J11").Top
       .Left = Range("J11").Left - 2
        .Width = 128
        .Height = 30
End With




End Sub

Sub Openlist()
selectCons.Show
End Sub
Public Sub HideDataSheet()

Worksheets("Data").Visible = xlSheetVeryHidden
Worksheets("macros").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd|_12").Visible = True
'Worksheets("Att").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_01-11").Visible = True
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_1-5").Visible = xlSheetVeryHidden

End Sub
Public Sub ShowDataSheet()

Worksheets("Data").Visible = True
Worksheets("macros").Visible = True
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd|_12").Visible = True
'Worksheets("Att").Visible = True
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_01-11").Visible = True
'Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_1-5").Visible = True

End Sub
Attribute VB_Name = "Module2"
Public Sub Add_Pdf()
ThisWorkbook.Save
ActiveSheet.Unprotect Password:=100

Range("Y13").Select
'=========================================
VariableFile = Application.GetOpenFilename("PDF Files (*.pdf), *pdf")
If VariableFile = False Then
GoTo Cancel
End If
ActiveSheet.OLEObjects.Add(fileName:=VariableFile, Link:=False, _
DisplayAsIcon:=False, IconLabel:="PDF").Select
'============================================
If Val(Application.Version) >= 13 Then

With Selection
.ShapeRange.LockAspectRatio = msoFalse
.ShapeRange.Width = 99#
.ShapeRange.Height = 162#
.ShapeRange.IncrementLeft -1
'.ShapeRange.IncrementTop 2050
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Select
End With
MsgBox Selection.Name
MsgBox VariableFile


Range("AC50").value = VariableFile
Range("AC51").value = Selection.Name

Else
With Selection
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("Y13").Left
.Top = Range("Y13").Top
.ShapeRange.Width = 99#
.ShapeRange.Height = 162#
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Name
MsgBox Selection.Name

End With
Range("AC50").value = VariableFile
Range("AC51").value = Selection.Name

Range("D97").Select

End If
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
Call ButtonReset
'==================================================
Cancel:
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
Call ButtonReset

End Sub

Public Sub Add_AttPDF()
ThisWorkbook.Save
ActiveSheet.Unprotect Password:=100
Range("AB13").Select
'=========================================
VariableFile = Application.GetOpenFilename("PDF Files (*.pdf), *pdf")
If VariableFile = False Then
'Add_HNivhan.Select
GoTo Cancel
End If
ActiveSheet.OLEObjects.Add(fileName:=VariableFile, Link:=False, _
DisplayAsIcon:=False, IconLabel:="PDF").Select
'============================================
If Val(Application.Version) >= 13 Then

With Selection
.ShapeRange.LockAspectRatio = msoFalse
.ShapeRange.Width = 99#
.ShapeRange.Height = 162#
.ShapeRange.IncrementLeft -1
'.ShapeRange.IncrementTop 2050
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Select
End With
MsgBox Selection.Name
MsgBox VariableFile

Range("AC53").value = VariableFile
Range("AB51").value = Selection.Name

Else
With Selection
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("AB13").Left
.Top = Range("AB13").Top
.ShapeRange.Width = 99#
.ShapeRange.Height = 162#
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft

End With
MsgBox Selection.Name
MsgBox VariableFile

Range("AC53").value = VariableFile
Range("AB51").value = Selection.Name

Range("D97").Select
'Add_HNivhan.Select

End If
'==================================================
Call ButtonReset





ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
'Add_HNivhan.Select


Cancel:
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
Call ButtonReset

End Sub
Public Sub ShowArrow()
 Dim tNow As Date
 ActiveSheet.Shapes.Range(Array("Pic_1")).Visible = True
     
    tNow = Now + TimeValue("00:00:02")
    Do Until tNow < Now
       ActiveSheet.Shapes.Range(Array("Pic_1")).Visible = True
       ActiveSheet.Shapes.Range(Array("Pic_2")).Visible = True
  On Error Resume Next
        DoEvents
    Loop
     
ActiveSheet.Shapes.Range(Array("Pic_1")).Visible = False
ActiveSheet.Shapes.Range(Array("Pic_2")).Visible = False

    Application.ScreenUpdating = True

End Sub
Public Sub Add_Pdf1()
ThisWorkbook.Save
ActiveSheet.Unprotect Password:=100

Range("B8").Select
'=========================================
VariableFile = Application.GetOpenFilename("PDF Files (*.pdf), *pdf")
If VariableFile = False Then
GoTo Cancel
End If
ActiveSheet.OLEObjects.Add(fileName:=VariableFile, Link:=False, _
DisplayAsIcon:=False, IconLabel:="PDF").Select
'============================================
If Val(Application.Version) >= 13 Then

With Selection
.ShapeRange.LockAspectRatio = msoFalse
.ShapeRange.Width = 125#
.ShapeRange.Height = 180#
.ShapeRange.IncrementLeft -307
'.ShapeRange.IncrementTop 2050
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Select
End With
'MsgBox Selection.Name
'MsgBox VariableFile


Range("B9").value = VariableFile
Range("B10").value = Selection.Name

Else
With Selection
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("B8").Left
.Top = Range("B8").Top
.ShapeRange.Width = 125#
.ShapeRange.Height = 180#
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Name
MsgBox Selection.Name

End With
Range("B9").value = VariableFile
Range("B10").value = Selection.Name

Range("D8").Select

End If
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
'Call ButtonReset
'==================================================
Cancel:
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
'Call ButtonReset

End Sub

Attribute VB_Name = "Module4"
Function SetAtt()
ActiveSheet.Unprotect Password:=100

Dim objOLE As OLEObject
Dim objOLE2 As OLEObject

 Dim Str As String
Str = Range("AC51").value
'MsgBox Str
On Error Resume Next
Set objOLE = ActiveSheet.OLEObjects(Str)
If Err.Number <> 0 Then
    ' OLEObject doesn't exist
    MsgBox "no"
    Range("AC50").value = ""
Else
    ' OLEObject does exist
    MsgBox "ok"
End If
Dim Str2 As String
Str2 = Range("AB51").value
On Error Resume Next
Set objOLE2 = ActiveSheet.OLEObjects(Str2)
If Err.Number <> 0 Then
    ' OLEObject doesn't exist
    MsgBox "no2"
    Range("AC53").value = ""
Else
    ' OLEObject does exist
    MsgBox "ok2"
End If
Dim myVar As Shapes
    Dim myShape As sHape
    Set myVar = ActiveSheet.Shapes
 
    For Each myShape In myVar

'Str = "Object"
Str2 = Range("AB51").value

' MsgBox Str

 Range("AC52").value = ""
 Range("AC54").value = ""
      
   '    MsgBox "Index = " & myShape.ZOrderPosition & vbCrLf & "Name = " _
           & myShape.Name
 ' MsgBox myShape.Name
  If myShape.Name Like Str Or myShape.Name Like Str2 Then
GoTo msg
End If
    Next
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
    
Exit Function
msg:
'  MsgBox "gg"
Range("AC52").value = Range("AC50").value
Range("AC54").value = Range("AC53").value



ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
MsgBox "sanding"
'Wait.Show
Call ButtonReset


End Function

Sub show6()
'Application.Sheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_01-05").Visible = True

End Sub
Attribute VB_Name = "Ok"
Attribute VB_Base = "0{697DE760-4EF4-42FC-86A4-8A237292CA43}{28A73B8D-16F8-4396-A7A3-A033B69A0CF2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Private Sub Bt_Close_Click()
Unload Me
End Sub


Private Sub CommandButton1_Click()
'ActiveWorkbook.Saved = True
'Application.Quit
ActiveWorkbook.Close SaveChanges:=False
End Sub

Private Sub UserForm_Activate()
'WebBrowser1.Navigate "http://www.twyo.org.il\progress_bar1.gif"
'Call NoCloseX
Unload WaitNew
End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Const WelcomePage = "Macros"

Private Sub Workbook_Activate()



End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Range("D12").Select

'ActiveSheet.Unprotect Password:=100, DrawingObjects:=True, Contents:=True, Scenarios:=True
ThisWorkbook.Unprotect Password:=100

  'Turn off events to prevent unwanted loops
    Application.EnableEvents = False
    
    'Evaluate if workbook is saved and emulate default propmts
    With ThisWorkbook
        If Not .Saved Then
            Select Case MsgBox("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| '" & .Name & "'?", _
                vbYesNoCancel + vbExclamation)
                Case Is = vbYes
                    'Call customized save routine
                    Call CustomSave
                Case Is = vbNo
                    'Do not save
                Case Is = vbCancel
                    'Set up procedure to cancel close
                    Cancel = True
                    ActiveSheet.Protect Password:=100, DrawingObjects:=True, Contents:=True, Scenarios:=True

            End Select
        End If
    
    'If Cancel was clicked, turn events back on and cancel close,
    'otherwise close the workbook without saving further changes
        If Not Cancel = True Then
            .Saved = True
            Application.EnableEvents = True
            .Close SaveChanges:=False
        Else
            Application.EnableEvents = True
        End If
    End With
   ' Call SHowTool
    Dim x As CommandBar
    For Each x In Application.CommandBars

      x.Enabled = True
    Next x
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
ThisWorkbook.Unprotect Password:=100
   
   'Turn off events to prevent unwanted loops
    Application.EnableEvents = False
    
    'Call customized save routine and set workbook's saved property to true
    '(To cancel regular saving)
    Call CustomSave(SaveAsUI)
    Cancel = True
    
    'Turn events back on an set saved property to true
    Application.EnableEvents = True
    ThisWorkbook.Saved = True
   ' Range("D12").Select

End Sub

Private Sub Workbook_Open()
 '  Application.ScreenUpdating = True
 On Error Resume Next
    Call ShowAllSheets
'Worksheets("Data").Visible = xlSheetVeryHidden
   
'   Application.ScreenUpdating = False
'   ActiveWindow.DisplayHeadings = False
  
   'Call HideTool
'=================================================================
 '  Application.ScreenUpdating = False
'   ActiveWindow.DisplayHeadings = False
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
'ActiveSheet.EnableSelection = xlUnlockedCells



    Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2019").Select

    'Range("A1").Select
   
' Range("D12").Select
  
   

'
    Range("NameCons").Select
 '      Range("E5").Select
  ' BT_SendMe.Visible = False
  
  
  
With ActiveWindow
 .WindowState = xlNormal
 .Top = 1
 .Left = 1
 .Height = Application.UsableHeight
 .Width = Application.UsableWidth
End With
Application.WindowState = xlMaximized
ActiveWindow.Zoom = 75
ActiveWindow.View = xlNormalView
Call ButtonReset
Application.ScreenUpdating = True
'=====================================================================

   
End Sub
Private Sub CustomSave(Optional SaveAs As Boolean)
    Dim ws As Worksheet, aWs As Worksheet, newFname As String
    'Turn off screen flashing
    Application.ScreenUpdating = False
    
    'Record active worksheet
    Set aWs = ActiveSheet
    
    'Hide all sheets
    Call HideAllSheets
    
    'Save workbook directly or prompt for saveas filename
    If SaveAs = True Then
        newFname = Application.GetSaveAsFilename( _
            fileFilter:="Excel Files (*.xlsm), *.xlsm")
        If Not newFname = "False" Then ThisWorkbook.SaveAs newFname
    Else
        ThisWorkbook.Save
    End If
    
    'Restore file to where user was
    Call ShowAllSheets
    aWs.Activate
    
    'Restore screen updates
    Application.ScreenUpdating = True
End Sub
Private Sub HideAllSheets()
    'Hide all worksheets except the macro welcome page
    Dim ws As Worksheet
    
    Worksheets(WelcomePage).Visible = xlSheetVisible
    
    For Each ws In ThisWorkbook.Worksheets
        If Not ws.Name = WelcomePage Then ws.Visible = xlSheetVeryHidden
        Worksheets("Data").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd|_12").Visible = True
'Worksheets("Att").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_01-11").Visible = True
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_1-5").Visible = xlSheetVeryHidden

'Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_2019").Visible = xlSheetVeryHidden

    Next ws
    
    Worksheets(WelcomePage).Activate
End Sub

Private Sub ShowAllSheets()
    'Show all worksheets except the macro welcome page
    
    Dim ws As Worksheet
    
    For Each ws In ThisWorkbook.Worksheets
        If Not ws.Name = WelcomePage Then ws.Visible = xlSheetVisible
    Next ws
    
    Worksheets(WelcomePage).Visible = xlSheetVeryHidden
    Worksheets("Data").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd|_12").Visible = True
'Worksheets("Att").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_01-11").Visible = True
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_1-5").Visible = xlSheetVeryHidden
Worksheets("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_2019").Visible = xlSheetVeryHidden

End Sub

Private Sub Workbook_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)
    ActiveWindow.DisplayHeadings = False
End Sub
Private Sub Workbook_NewSheet(ByVal sh As Object)
Application.DisplayAlerts = False
MsgBox "|fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|", vbInformation, "OOOOPS"
sh.Delete
Application.DisplayAlerts = True

End Sub
Private Sub Workbook_SheetBeforeRightClick(ByVal sh As Object, ByVal Target As Range, Cancel As Boolean)
Cancel = True
   MsgBox (" ! |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| "), vbInformation, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub




Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{BB01271B-09D5-4911-B4BC-3A065D1E34FA}{C5D16805-8DFD-4D7D-BF90-0F5056717E25}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub UserForm_Initialize()
    CreateGifFile Environ("temp") & "\MyGif.gif"
    Me.WebBrowser1.Navigate2 Environ("temp") & "\MyGif.gif"
On Error Resume Next
Application.ScreenUpdating = False
Me.WebBrowser1.Document.body.Style.Border = "none"
Me.WebBrowser1.Document.body.Scroll = "no"
Application.ScreenUpdating = True
End Sub
Private Sub WebBrowser1_DocumentComplete(ByVal pDisp As Object, URL As Variant)
On Error Resume Next
Application.ScreenUpdating = False
Me.WebBrowser1.Document.body.Style.Border = "none"
Me.WebBrowser1.Document.body.Scroll = "no"

Application.ScreenUpdating = True
End Sub
Private Sub UserForm_Terminate()
    Kill Environ("temp") & "\MyGif.gif"
End Sub

Private Sub CreateGifFile(ByVal GifFile As String)
    Dim Bytes() As Byte
    Dim FileNum As Integer
    Dim Var() As Variant
    Dim x As Long
    
    Var = ThisWorkbook.Worksheets("Macros").UsedRange.value
     
    ReDim Bytes(LBound(Var) To UBound(Var))
    For x = LBound(Var) To UBound(Var)
        Bytes(x) = CByte(Var(x, 1))
    Next
    
    FileNum = FreeFile
    Open GifFile For Binary As #FileNum
        Put #FileNum, 1, Bytes
    Close FileNum
    
End Sub

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{53C06503-A474-40E9-B253-744E0CC4F639}{A5746D87-7C80-42E6-B797-4A7F19E3C92A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox1_Change()
Range("AG3") = CheckBox1.value
ActiveSheet.Protect Password:=100, DrawingObjects:=False

End Sub

Private Sub CommandButton1_Click()
ActiveSheet.Protect Password:=100, DrawingObjects:=False

Unload Me
End Sub

Private Sub CommandButton2_Click()
Me.PrintForm
End Sub

Private Sub Label10_Click()

End Sub

Private Sub Label9_Click()

End Sub
Attribute VB_Name = "WaitNew"
Attribute VB_Base = "0{A6AA289C-BF03-4759-87FF-32CB9A508F9D}{97FB07DD-A600-4E3C-95E7-774231EDDE3B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub UserForm_Initialize()
    CreateGifFile Environ("temp") & "\PB2.gif"
   Me.WebBrowser1.Navigate2 Environ("temp") & "\PB2.gif"
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
        Cancel = True
       MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|.", vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
   End If
End Sub

Private Sub UserForm_Terminate()
    Kill Environ("temp") & "\PB2.gif"
End Sub

Private Sub CreateGifFile(ByVal GifFile As String)
    Dim Bytes() As Byte
    Dim FileNum As Integer
    Dim Var() As Variant
    Dim x As Long
    
    Var = ThisWorkbook.Worksheets("Macros").UsedRange.value
     
    ReDim Bytes(LBound(Var) To UBound(Var))
    For x = LBound(Var) To UBound(Var)
        Bytes(x) = CByte(Var(x, 1))
    Next
    
    FileNum = FreeFile
    Open GifFile For Binary As #FileNum
        Put #FileNum, 1, Bytes
    Close FileNum
    
End Sub

Private Sub CommandButton1_Click()
Unload Me
End Sub

Private Sub UserForm_Activate()

   
   Dim wb1 As Workbook
    Dim wb2 As Workbook
    Dim TempFilePath As String
    Dim TempFileName As String
    Dim FileExtStr As String
    Dim OutApp As Object
    Dim OutMail As Object
    Dim OutApp2 As Object

    Set wb1 = ActiveWorkbook
    If Val(Application.Version) >= 12 Then
        If wb1.FileFormat = 51 And wb1.HasVBProject = True Then
            MsgBox "There is VBA code in this xlsx file. There will" & vbNewLine & _
                   "be no VBA code in the file you send. Save the" & vbNewLine & _
                   "file as a macro-enabled (. Xlsm) and then retry the macro.", vbInformation
            Exit Sub
        End If
    End If

    With Application
        .ScreenUpdating = False
        .EnableEvents = False
    End With
    

    ' Make a copy of the file.
    TempFilePath = Application.ActiveWorkbook.Path & "\"

    TempFileName = Range("B40")
    FileExtStr = "." & LCase(Right(wb1.Name, _
                                   Len(wb1.Name) - InStrRev(wb1.Name, ".", , 1)))

Dim AttFile As String
AttFile = TempFilePath & TempFileName & FileExtStr

Dim AttFile1, AttFile2, AttFile3, AttFile4, AttFile5, AttFile6, AttFile7, AttFile8 As String
AttFile1 = Range("AttStr1")
AttFile2 = Range("AttStr2")
AttFile3 = Range("AttStr3")
AttFile4 = Range("AttStr4")
AttFile5 = Range("AttStr5")
AttFile6 = Range("AttStr6")
AttFile7 = Range("AttStr7")
AttFile8 = Range("AttStr8")

Dim SubjectTXT_1 As String
Dim SubjectTXT_2 As String

Dim StrHtml As String
StrHtml = "<meta http-equiv=''content-type'' content=''text/ html; charset=windows -1255''>"


Dim DirFile As String
DirFile = TempFilePath & TempFileName & FileExtStr
'MsgBox DirFile

Dim strbody As String
Set mymail = CreateObject("CDO.Message")

'===============================================
 Dim FSO As Object
 Dim FilePath As String

    Set FSO = CreateObject("scripting.filesystemobject")

    FilePath = TempFilePath & TempFileName & FileExtStr

    If FSO.FileExists(FilePath) = False Then
    '    MsgBox "file doesn't exist"
    wb1.SaveCopyAs TempFilePath & TempFileName & FileExtStr
AttFile = TempFilePath & TempFileName & FileExtStr
mymail.Subject = Range("B40")

GoTo Send_Me
    
        
        Exit Sub
    Else
    
wb1.SaveCopyAs TempFilePath & TempFileName & "_|fffd||fffd||fffd||fffd||fffd|" & FileExtStr
AttFile = TempFilePath & TempFileName & "_|fffd||fffd||fffd||fffd||fffd|" & FileExtStr
mymail.Subject = "|fffd||fffd||fffd||fffd||fffd|" & Range("B40")
'MsgBox TempFilePath & TempFileName & "_|fffd||fffd||fffd||fffd||fffd|" & FileExtStr

GoTo Send_Me
        
    End If


'============================================================================================================
Send_Me:

 On Error GoTo ErrMsg
'Set mymail = CreateObject("CDO.Message")

'====================================================================================================
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusername") = "mail@y-noam.com"
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "mail.y-noam.com"
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendpassword") = "ny@box1"
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpauthenticate") = 1
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/Importance") = CdoHigh
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/httpmail/importance") = 1
mymail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/mailheader/X-Priority") = 1

'====================================================================================================
  
    

strbody = "<HTML>" & "<BODY bottomMargin=0 leftMargin=0 topMargin=0 rightMargin=0>" _
& StrHtml _
& "<TABLE cellSpacing=0 cellPadding=0 width=100% align=right border=0>" _
& "<TR>" & "<TD vAlign=top dir=rtl>" & "<BR>" _
& "|fffd||fffd||fffd||fffd||fffd| :" & "<BR>" _
& "<b>" & "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" _
& "<u>" & "<BR>" & "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & "</u>" & "</b>" _
& "<BR><Br>" & "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" _
& "<BR><Br>" & "|fffd||fffd||fffd||fffd| |fffd||fffd|," _
& "<br><BR><BR><b><u>" & "|fffd||fffd||fffd||fffd||fffd|:" & Range("B40") & "<BR><br></b></u>" _
& "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & Range("B40") & "<BR>" _
& "<BR><BR>" & "|fffd||fffd||fffd||fffd||fffd| " _
& "<BR><b>" & Range("Menahel") & " - " & Range("NameCons") & "</b>" _
& "<BR>" & Range("TelMosad") _
& "<BR>" & Range("SelMosad") _
& "<BR>" & Range("EmailMosad") _
& "<BR><b>" _
& "</TD><TD vAlign=top width=50 >" _
& "</BODY> </HTML>"
 
'====================================================================================================
mymail.Subject = Range("B40")
'====
mymail.From = "mail@y-noam.com"
mymail.To = "y-noam@bezeqint.net" & ";" & "rinale@education.gov.il" & ";" & "sigalha@education.gov.il"

mymail.BCC = ""
mymail.CC = Range("EmailMosad")
mymail.htmlbody = strbody
'mymail.AddAttachment AttFile
With mymail
'.AddAttachment AttFile
If AttFile1 <> "" Then .AddAttachment AttFile1
If AttFile2 <> "" Then .AddAttachment AttFile2
If AttFile3 <> "" Then .AddAttachment AttFile3
If AttFile4 <> "" Then .AddAttachment AttFile4
If AttFile5 <> "" Then .AddAttachment AttFile5
If AttFile6 <> "" Then .AddAttachment AttFile6
If AttFile7 <> "" Then .AddAttachment AttFile7
If AttFile8 <> "" Then .AddAttachment AttFile8




'.AddAttachment AttFile2

End With
mymail.ReplyTo = "y-noam@bezeqint.net"

mymail.Configuration.Fields.Update
mymail.Send

Set mymail = Nothing

'     MsgBox "|fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
'======================================|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|==================

Beep
Ok.Show
Exit Sub
 
 


ErrMsg:
Beep
'MsgBox Err.Number & Err.Description
MsgBox "! |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" & vbNewLine & ": |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
& vbNewLine _
& "1. |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| 0522805628 |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine _
& "2. |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" & vbNewLine _
& "y-noam@bezeqint.net" & vbNewLine & "rinale@education.gov.il" _
, vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Unload Me
Exit Sub


End Sub




Attribute VB_Name = "bas_EmbeedBytes"
Option Explicit

Sub EmbedGif()
    Dim Bytes() As Byte
    Dim FileNum As Integer
    Dim Var() As Variant
    Const Gif_Path_Name As String = "C:\a.gif"
    

    FileNum = FreeFile
    
    ReDim Bytes(1 To FileLen(Gif_Path_Name))

    Open Gif_Path_Name For Binary As #FileNum
        Get #FileNum, 1, Bytes
    Close FileNum
    
        With Worksheets("macros")
            .Range(.Cells(1, 100), .Cells(UBound(Bytes), 1)).value = Application.Transpose(Bytes)
        End With
        ThisWorkbook.Save
End Sub

Attribute VB_Name = "selectCons"
Attribute VB_Base = "0{F8FFB899-5440-4AD1-A82F-640574A9420D}{00BEFBB9-678C-4F87-BBA8-E5EAC96A671B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub OptionButton1_Click()
Range("NameCons").value = OptionButton1.Caption
Unload Me
End Sub

Private Sub OptionButton10_Click()
Range("NameCons").value = OptionButton10.Caption
Unload Me

End Sub

Private Sub OptionButton11_Click()
Range("NameCons").value = OptionButton11.Caption
Unload Me

End Sub

Private Sub OptionButton12_Click()
Range("NameCons").value = OptionButton12.Caption
Unload Me

End Sub

Private Sub OptionButton13_Click()
Range("NameCons").value = OptionButton13.Caption
Unload Me

End Sub

Private Sub OptionButton14_Click()
Range("NameCons").value = OptionButton14.Caption
Unload Me

End Sub

Private Sub OptionButton15_Click()
Range("NameCons").value = OptionButton15.Caption
Unload Me

End Sub

Private Sub OptionButton16_Click()
Range("NameCons").value = OptionButton16.Caption
Unload Me

End Sub

Private Sub OptionButton17_Click()
Range("NameCons").value = OptionButton17.Caption
Unload Me

End Sub

Private Sub OptionButton18_Click()
Range("NameCons").value = OptionButton18.Caption
Unload Me

End Sub

Private Sub OptionButton19_Click()
Range("NameCons").value = OptionButton19.Caption
Unload Me

End Sub

Private Sub OptionButton20_Click()
Range("NameCons").value = OptionButton20.Caption
Unload Me

End Sub

Private Sub OptionButton21_Click()
Range("NameCons").value = OptionButton21.Caption
Unload Me

End Sub

Private Sub OptionButton22_Click()
Range("NameCons").value = OptionButton22.Caption
Unload Me

End Sub

Private Sub OptionButton23_Click()
Range("NameCons").value = OptionButton23.Caption
Unload Me

End Sub

Private Sub OptionButton24_Click()
Range("NameCons").value = OptionButton24.Caption
Unload Me

End Sub

Private Sub OptionButton25_Click()
Range("NameCons").value = OptionButton25.Caption
Unload Me

End Sub

Private Sub OptionButton26_Click()
Range("NameCons").value = OptionButton26.Caption
Unload Me

End Sub

Private Sub OptionButton27_Click()
Range("NameCons").value = OptionButton27.Caption
Unload Me

End Sub

Private Sub OptionButton28_Click()
Range("NameCons").value = OptionButton28.Caption
Unload Me

End Sub

Private Sub OptionButton29_Click()
Range("NameCons").value = OptionButton29.Caption
Unload Me

End Sub

Private Sub OptionButton30_Click()
Range("NameCons").value = OptionButton30.Caption
Unload Me

End Sub

Private Sub OptionButton31_Click()
Range("NameCons").value = OptionButton31.Caption
Unload Me

End Sub

Private Sub OptionButton32_Click()
Range("NameCons").value = OptionButton32.Caption
Unload Me

End Sub

Private Sub OptionButton33_Click()
Range("NameCons").value = OptionButton33.Caption
Unload Me

End Sub

Private Sub OptionButton34_Click()
Range("NameCons").value = OptionButton34.Caption
Unload Me

End Sub

Private Sub OptionButton35_Click()
Range("NameCons").value = OptionButton35.Caption
Unload Me

End Sub

Private Sub OptionButton36_Click()
Range("NameCons").value = OptionButton36.Caption
Unload Me

End Sub

Private Sub OptionButton37_Click()
Range("NameCons").value = OptionButton37.Caption
Unload Me

End Sub

Private Sub OptionButton38_Click()
Range("NameCons").value = OptionButton38.Caption
Unload Me

End Sub

Private Sub OptionButton39_Click()
Range("NameCons").value = OptionButton39.Caption
Unload Me

End Sub

Private Sub OptionButton4_Click()
Range("NameCons").value = OptionButton4.Caption

End Sub

Private Sub OptionButton40_Click()
Range("NameCons").value = OptionButton40.Caption
Unload Me

End Sub

Private Sub OptionButton41_Click()
Range("NameCons").value = OptionButton41.Caption
Unload Me

End Sub

Private Sub OptionButton42_Click()
Range("NameCons").value = OptionButton42.Caption
Unload Me

End Sub

Private Sub OptionButton43_Click()
Range("NameCons").value = OptionButton43.Caption
Unload Me

End Sub

Private Sub OptionButton44_Click()
Range("NameCons").value = OptionButton44.Caption
Unload Me

End Sub

Private Sub OptionButton45_Click()
Range("NameCons").value = OptionButton45.Caption
Unload Me

End Sub

Private Sub OptionButton46_Click()
Range("NameCons").value = OptionButton46.Caption
Unload Me

End Sub

Private Sub OptionButton47_Click()
Range("NameCons").value = OptionButton47.Caption
Unload Me

End Sub

Private Sub OptionButton48_Click()
Range("NameCons").value = OptionButton48.Caption
Unload Me

End Sub

Private Sub OptionButton49_Click()
Range("NameCons").value = OptionButton49.Caption
Unload Me

End Sub

Private Sub OptionButton5_Click()
Range("NameCons").value = OptionButton5.Caption
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

Unload Me

End Sub

Private Sub OptionButton50_Click()
Range("NameCons").value = OptionButton50.Caption
Unload Me

End Sub

Private Sub OptionButton51_Click()
Range("NameCons").value = OptionButton51.Caption
Unload Me

End Sub

Private Sub OptionButton52_Click()
Range("NameCons").value = OptionButton52.Caption
Unload Me

End Sub

Private Sub OptionButton53_Click()
Range("NameCons").value = OptionButton53.Caption
Unload Me

End Sub

Private Sub OptionButton54_Click()
Range("NameCons").value = OptionButton54.Caption
Unload Me

End Sub

Private Sub OptionButton55_Click()
Range("NameCons").value = OptionButton55.Caption
Unload Me

End Sub

Private Sub OptionButton56_Click()
Range("NameCons").value = OptionButton56.Caption
Unload Me

End Sub

Private Sub OptionButton57_Click()
Range("NameCons").value = OptionButton57.Caption
Unload Me

End Sub

Private Sub OptionButton58_Click()
Range("NameCons").value = OptionButton58.Caption
Unload Me

End Sub

Private Sub OptionButton59_Click()
Range("NameCons").value = OptionButton59.Caption
Unload Me

End Sub

Private Sub OptionButton6_Click()
Range("NameCons").value = OptionButton6.Caption
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

Unload Me

End Sub

Private Sub OptionButton60_Click()
Range("NameCons").value = OptionButton60.Caption
Unload Me

End Sub

Private Sub OptionButton61_Click()
Range("NameCons").value = OptionButton61.Caption
Unload Me

End Sub

Private Sub OptionButton62_Click()
Range("NameCons").value = OptionButton62.Caption
Unload Me

End Sub

Private Sub OptionButton63_Click()
Range("NameCons").value = OptionButton63.Caption
Unload Me

End Sub

Private Sub OptionButton64_Click()
Range("NameCons").value = OptionButton64.Caption
Unload Me

End Sub

Private Sub OptionButton65_Click()
Range("NameCons").value = OptionButton65.Caption
Unload Me

End Sub

Private Sub OptionButton66_Click()
Range("NameCons").value = OptionButton66.Caption
Unload Me

End Sub

Private Sub OptionButton67_Click()
Range("NameCons").value = OptionButton67.Caption
Unload Me

End Sub

Private Sub OptionButton68_Click()
Range("NameCons").value = OptionButton68.Caption
Unload Me

End Sub

Private Sub OptionButton69_Click()
Range("NameCons").value = OptionButton69.Caption
Unload Me

End Sub

Private Sub OptionButton7_Click()
Range("NameCons").value = OptionButton7.Caption
Unload Me

End Sub

Private Sub OptionButton70_Click()
Range("NameCons").value = OptionButton70.Caption
Unload Me

End Sub

Private Sub OptionButton71_Click()
Range("NameCons").value = OptionButton71.Caption
Unload Me

End Sub

Private Sub OptionButton72_Click()
Range("NameCons").value = OptionButton72.Caption
Unload Me

End Sub

Private Sub OptionButton8_Click()
Range("NameCons").value = OptionButton8.Caption
Unload Me

End Sub

Private Sub OptionButton9_Click()
Range("NameCons").value = OptionButton9.Caption
Unload Me

End Sub

Private Sub UserForm_Deactivate()
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "AddLogo, 89, 6, MSForms, CommandButton"
Attribute VB_Control = "BT_Prn, 92, 7, MSForms, CommandButton"
Attribute VB_Control = "BT_PDF, 129, 8, MSForms, CommandButton"
Sub TestInsertPicture()
    InsertPicture "C:\FolderName\PictureFileName.gif", _
        Range("D10"), True, True
End Sub

Sub InsertPicture(PictureFileName As String, TargetCell As Range, _
    CenterH As Boolean, CenterV As Boolean)
' inserts a picture at the top left position of TargetCell
' the picture can be centered horizontally and/or vertically
Dim p As Object, t As Double, l As Double, w As Double, h As Double
    If TypeName(ActiveSheet) <> "Worksheet" Then Exit Sub
    If Dir(PictureFileName) = "" Then Exit Sub
    ' import picture
    Set p = ActiveSheet.Pictures.Insert(PictureFileName)
    ' determine positions
    With TargetCell
        t = .Top
        l = .Left
        If CenterH Then
            w = .Offset(0, 1).Left - .Left
            l = l + w / 2 - p.Width / 2
            If l < 1 Then l = 1
        End If
        If CenterV Then
            h = .Offset(1, 0).Top - .Top
            t = t + h / 2 - p.Height / 2
            If t < 1 Then t = 1
        End If
    End With
    ' position picture
    With p
        .Top = t
        .Left = l
    End With
    Set p = Nothing
End Sub

Private Sub CommandButton1_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then End
Range("S2").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("S2").Left
.Top = Range("S2").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
Range("t4").Select

End Sub

Private Sub Add_att_Click()
Call Add_AttPDF
End Sub

Private Sub Add_Att1_Click()
ThisWorkbook.Save
ActiveSheet.Unprotect Password:=100
Range("D77").Select
'=========================================
VariableFile = Application.GetOpenFilename("PDF Files (*.pdf), *pdf")
If VariableFile = False Then
'Add_HNivhan.Select
GoTo Cancel
End If
ActiveSheet.OLEObjects.Add(fileName:=VariableFile, Link:=False, _
DisplayAsIcon:=False, IconLabel:="PDF").Select
'============================================
If Val(Application.Version) >= 13 Then

With Selection
.ShapeRange.LockAspectRatio = msoFalse
.ShapeRange.Width = 128#
.ShapeRange.Height = 190#
.ShapeRange.IncrementLeft -226
'.ShapeRange.IncrementTop 2050
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Select
End With
'Range("H238").Select
'Add_HNivhan.Select
'Range("AC51").value = Selection.Name

Else
With Selection
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("D77").Left
.Top = Range("D77").Top
.ShapeRange.Width = 128#
.ShapeRange.Height = 190#
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft

End With
Range("AC50").value = VariableFile
Range("AC51").value = Selection.Name

Range("G77").Select
'Add_HNivhan.Select

End If
'==================================================




ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
'Add_HNivhan.Select


Cancel:
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True

End Sub

Private Sub Add_Att2_Click()
ThisWorkbook.Save
ActiveSheet.Unprotect Password:=100
Range("G77").Select
'=========================================
VariableFile = Application.GetOpenFilename("PDF Files (*.pdf), *pdf")
If VariableFile = False Then
'Add_HNivhan.Select
GoTo Cancel
End If
ActiveSheet.OLEObjects.Add(fileName:=VariableFile, Link:=False, _
DisplayAsIcon:=False, IconLabel:="PDF").Select
'============================================
If Val(Application.Version) >= 13 Then

With Selection
.ShapeRange.LockAspectRatio = msoFalse
.ShapeRange.Width = 128#
.ShapeRange.Height = 190#
.ShapeRange.IncrementLeft -95
'.ShapeRange.IncrementTop 2050
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
.Select
End With
'Range("H238").Select
'Add_HNivhan.Select

Else
With Selection
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("G77").Left
.Top = Range("G77").Top
.ShapeRange.Width = 128#
.ShapeRange.Height = 190#
.ShapeRange.ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft

End With
Range("G77").Select
'Add_HNivhan.Select

End If
'==================================================




ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True
'Add_HNivhan.Select


Cancel:
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True, Scenarios:=True


End Sub

Private Sub Add_Copy_Click()
Call Add_Pdf
End Sub


Private Sub Att1_Click()
Call Add_Pdf

End Sub

Private Sub Att2_Click()
Call Add_AttPDF

End Sub

Private Sub BT_PDF_Click()
On Error GoTo ErrMsg

Dim myPath As String
Dim folderPath As String
Dim n As String
n = Range("B73").value
folderPath = Application.ActiveWorkbook.Path & "\"
myPath = Application.ActiveWorkbook.FullName
Dim PdfTofes As String
PdfTofes = folderPath & n
    
   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _
       PdfTofes & ".pdf" _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, OpenAfterPublish:=False

Beep
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & PdfTofes & ".pdf", vbInformation, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

ErrMsg:
Beep
MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & " |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

End Sub

Private Sub BT_Prn_Click()
ActiveSheet.PageSetup.BlackAndWhite = True
ActiveSheet.PageSetup.PrintErrors = xlPrintErrorsBlank
ActiveSheet.PrintOut
Call ButtonReset

End Sub


Private Sub AddLogo_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
Dim pas As String
pas = 100
ActiveSheet.Unprotect Password:=pas
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then GoTo Cancel
Range("R1").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("R1").Left
.Top = Range("R1").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
Range("D12").Select
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Cancel:
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Range("D12").Select
End Sub

Private Sub SendMe_Click()
Call SetAtt

'Wait.Show
'Call ButtonReset

End Sub

Private Sub Worksheet_Activate()
ActiveWindow.Zoom = 75
ActiveWindow.View = xlNormalView
ActiveWindow.ScrollIntoView Left:=0, Top:=0, Width:=100, Height:=100
'Application.ScreenUpdating = True
If IsEmpty(Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2019").Range("Namecons")) Then
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset
'Exit Sub
Else
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset
'Exit Sub
End If
ActiveWindow.DisplayHeadings = False
Application.DisplayFormulaBar = False
Call ShowArrow
Application.ScreenUpdating = True

End Sub


Private Sub Worksheet_Change(ByVal Target As Range)

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "AddLogo, 1, 3, MSForms, CommandButton"
Attribute VB_Control = "BT_PRN, 20, 4, MSForms, CommandButton"
Attribute VB_Control = "BT_PDF, 21, 5, MSForms, CommandButton"


Private Sub BT_PDF_Click()
On Error GoTo ErrMsg

Dim myPath As String
Dim folderPath As String
Dim n As String
n = Range("B73").value
folderPath = Application.ActiveWorkbook.Path & "\"
myPath = Application.ActiveWorkbook.FullName
Dim PdfTofes1 As String
PdfTofes1 = folderPath & n
    
   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _
       PdfTofes1 & ".pdf" _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, OpenAfterPublish:=False
Beep
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & PdfTofes1 & ".pdf", vbInformation, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

ErrMsg:
Beep
MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & " |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub
End Sub

Private Sub BT_Prn_Click()
ActiveSheet.PageSetup.BlackAndWhite = True
ActiveSheet.PageSetup.PrintErrors = xlPrintErrorsBlank

ActiveSheet.PrintOut
Call ButtonReset

End Sub

Private Sub AddLogo_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
Dim pas As String
pas = 100
ActiveSheet.Unprotect Password:=pas
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then GoTo Cancel
Range("R1").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("R1").Left
.Top = Range("R1").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
Range("D12").Select
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Call ButtonReset
Exit Sub
Cancel:
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Call ButtonReset
Exit Sub
Range("D12").Select

End Sub

Private Sub CommandButton2_Click()
'MsgBox "Print"
'ActiveSheet.PageSetup.BlackAndWhite = True
'ActiveSheet.PrintOut
'Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2017").PrintOut
With Att1
'.Caption = "|fffd||fffd||fffd||fffd||fffd|"
'.Left = 1384.2
'.Top = 227.4
'.Width = 92.4
'.Height = 40.8
'.Font = 12
End With
Call ButtonSet
End Sub


Private Sub SendMe_Click()
Call SetAtt
'Wait.Show
'Call ButtonReset

End Sub

Private Sub Worksheet_Activate()
If Range("AG3").value = False Then
ActiveSheet.Unprotect Password:=100
Beep
UserForm2.Show
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

Else
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

End If


ActiveWindow.Zoom = 75
ActiveWindow.View = xlNormalView
ActiveWindow.ScrollIntoView Left:=0, Top:=0, Width:=100, Height:=100
'If IsEmpty(Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2018").Range("Namecons")) Then
'Application.ScreenUpdating = False
'Application.ScreenUpdating = True
Call ButtonReset
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

'Else
'Application.ScreenUpdating = False
'Application.ScreenUpdating = True
'ActiveSheet.Protect Password:=100, DrawingObjects:=False

'End If
'ActiveWindow.DisplayHeadings = False
'Application.DisplayFormulaBar = False
Call ShowArrow
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

Application.ScreenUpdating = True





'ActiveSheet.Protect Password:=100, DrawingObjects:=False

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
ActiveSheet.Protect Password:=100, DrawingObjects:=False, Contents:=True

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "AddLogo, 3, 3, MSForms, CommandButton"
Attribute VB_Control = "BT_Prn, 4, 4, MSForms, CommandButton"
Attribute VB_Control = "BT_PDF, 5, 5, MSForms, CommandButton"
Private Sub Att1_Click()
Call Add_Pdf

End Sub

Private Sub Att2_Click()
Call Add_AttPDF

End Sub

Private Sub AddLogo_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
Dim pas As String
pas = 100
ActiveSheet.Unprotect Password:=pas
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then GoTo Cancel
Range("R1").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("R1").Left
.Top = Range("R1").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
Range("D12").Select
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Cancel:
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Range("D12").Select

End Sub


Private Sub BT_PDF_Click()
On Error GoTo ErrMsg

Dim myPath As String
Dim folderPath As String
Dim n As String
n = Range("B73").value
folderPath = Application.ActiveWorkbook.Path & "\"
myPath = Application.ActiveWorkbook.FullName
Dim PdfTofes As String
PdfTofes = folderPath & n
    
   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _
       PdfTofes & ".pdf" _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, OpenAfterPublish:=False

Beep
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & PdfTofes & ".pdf", vbInformation, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

ErrMsg:
Beep
MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & " |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

End Sub

Private Sub BT_Prn_Click()
ActiveSheet.PageSetup.BlackAndWhite = True
ActiveSheet.PageSetup.PrintErrors = xlPrintErrorsBlank

ActiveSheet.PrintOut
Call ButtonReset
End Sub

Private Sub SendMe_Click()
Call SetAtt

'Wait.Show
'Call ButtonReset

End Sub

Private Sub Worksheet_Activate()
ActiveWindow.Zoom = 75
ActiveWindow.View = xlNormalView
ActiveWindow.ScrollIntoView Left:=0, Top:=0, Width:=100, Height:=100
If IsEmpty(Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2019").Range("Namecons")) Then
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset


Else
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset

End If

ActiveWindow.DisplayHeadings = False
Application.DisplayFormulaBar = False
Call ShowArrow

Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "AddLogo, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "BT_Prn, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "BT_PDF, 7, 6, MSForms, CommandButton"

'
Private Sub AddLogo_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
Dim pas As String
pas = 100
ActiveSheet.Unprotect Password:=pas
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then GoTo Cancel
Range("R1").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("R1").Left
.Top = Range("R1").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
Range("D12").Select
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Cancel:
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Range("D12").Select
Call ButtonReset

End Sub

Private Sub BT_PDF_Click()
On Error GoTo ErrMsg

Dim myPath As String
Dim folderPath As String
Dim n As String
n = Range("B73").value
folderPath = Application.ActiveWorkbook.Path & "\"
myPath = Application.ActiveWorkbook.FullName
Dim PdfTofes As String
PdfTofes = folderPath & n
    
   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _
       PdfTofes & ".pdf" _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, OpenAfterPublish:=False

Beep
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & PdfTofes & ".pdf", vbInformation, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

ErrMsg:
Beep
MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & " |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

End Sub

Private Sub BT_Prn_Click()
ActiveSheet.PageSetup.BlackAndWhite = True
ActiveSheet.PageSetup.PrintErrors = xlPrintErrorsBlank

ActiveSheet.PrintOut
Call ButtonReset

End Sub

Private Sub CommandButton1_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
Dim pas As String
pas = 100
ActiveSheet.Unprotect Password:=pas
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then GoTo Cancel
Range("R1").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("R1").Left
.Top = Range("R1").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
Range("D12").Select
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Cancel:
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Range("D12").Select
End Sub

Private Sub CommandButton2_Click()
ActiveSheet.PageSetup.BlackAndWhite = True
ActiveSheet.PrintOut

End Sub

'
Private Sub Worksheet_Activate()
ActiveWindow.Zoom = 75
ActiveWindow.View = xlNormalView
ActiveWindow.ScrollIntoView Left:=0, Top:=0, Width:=100, Height:=100
If IsEmpty(Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2019").Range("Namecons")) Then
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset


Else
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset

End If
ActiveWindow.DisplayHeadings = False
Application.DisplayFormulaBar = False
Call ShowArrow

Application.ScreenUpdating = True

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "AddLogo, 3, 3, MSForms, CommandButton"
Attribute VB_Control = "BT_Prn, 4, 4, MSForms, CommandButton"
Attribute VB_Control = "BT_PDF, 5, 5, MSForms, CommandButton"
Private Sub Att1_Click()
Call Add_Pdf

End Sub

Private Sub Att2_Click()
Call Add_AttPDF

End Sub

Private Sub AddLogo_Click()
Dim oPict, PictObj
Dim sImgFileFormat As String
Dim pas As String
pas = 100
ActiveSheet.Unprotect Password:=pas
'Open file
GetPict:
oPict = Application.GetOpenFilename("All Pictures (*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff),*.tif; *.bmp; *.jpg; *.gif; *.jpeg; *.png; *.cpt; *.tiff")
If oPict = False Then GoTo Cancel
Range("R1").Select
Set PictObj = ActiveSheet.Pictures.Insert(oPict)
With PictObj
.ShapeRange.LockAspectRatio = msoFalse
.Left = Range("R1").Left
.Top = Range("R1").Top

.ShapeRange.Width = 65#
.ShapeRange.Height = 65#
End With
PictObj.Select
With PictObj
Selection.ShapeRange.IncrementLeft 1#
Selection.ShapeRange.IncrementTop 1#
End With
'Range("D12").Select
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
Cancel:
ActiveSheet.Protect Password:=pas, DrawingObjects:=False
Exit Sub
'Range("D12").Select
Call ButtonReset

End Sub


Private Sub BT_PDF_Click()
On Error GoTo ErrMsg

Dim myPath As String
Dim folderPath As String
Dim n As String
n = Range("B73").value
folderPath = Application.ActiveWorkbook.Path & "\"
myPath = Application.ActiveWorkbook.FullName
Dim PdfTofes As String
PdfTofes = folderPath & n
    
   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _
       PdfTofes & ".pdf" _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, OpenAfterPublish:=False


Beep
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & PdfTofes & ".pdf", vbInformation, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

ErrMsg:
Beep
MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & " |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call ButtonReset

Exit Sub

End Sub

Private Sub BT_Prn_Click()
ActiveSheet.PageSetup.BlackAndWhite = True
ActiveSheet.PageSetup.PrintErrors = xlPrintErrorsBlank

ActiveSheet.PrintOut
Call ButtonReset

End Sub

Private Sub SendMe_Click()
Call SetAtt

'Wait.Show
'Call ButtonReset

End Sub

Private Sub Worksheet_Activate()
 ActiveWindow.Zoom = 75
ActiveWindow.View = xlNormalView
ActiveWindow.ScrollIntoView Left:=0, Top:=0, Width:=100, Height:=100
If IsEmpty(Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 2019").Range("Namecons")) Then
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset

Else
Application.ScreenUpdating = False
Application.ScreenUpdating = True
Call ButtonReset

End If
ActiveWindow.DisplayHeadings = False
Application.DisplayFormulaBar = False
Call ShowArrow

Application.ScreenUpdating = True


End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
'Application.ScreenUpdating = False
'Application.CutCopyMode = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'Application.ScreenUpdating = False

'Application.CutCopyMode = True
End Sub


INQUEST-PP=macro
