Attribute VB_Name = "Module1"
Option Explicit
Public Declare Function GetSystemDirectory Lib "kernel32" _
   Alias "GetSystemDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Long) As Long

Public zc As Double
Public ZipCode As Variant
Public menu As Variant
Public nullmenu As Variant
Public OpenPicture As Variant
Public Folder As Variant
Public UserValue As Integer
Public EndRow As Double
Public paper(1 To 20) As String


Public Function GetSystemDir() As String

Dim tmp As String * 1024
Dim nSize As Long

nSize = GetSystemDirectory(tmp, 1024)

GetSystemDir = Left$(tmp, nSize)

End Function

Public Function Replace(st, strTemp, Find, Repl)
Dim lc, fc, X As Integer
    lc = Len(strTemp)
    fc = Len(Find)
    X = InStr(st, strTemp, Find)
    If X > 0 Then
        Replace = Left(strTemp, X - 1) + Repl + Right(strTemp, lc - fc - X + 1)
    Else
        Replace = strTemp
    End If
End Function
Attribute VB_Name = "Module5"
Public SD As String
Public up As Integer
Public lastfind As Integer
Dim zc As Double
Public memAddr(45000) As String
Dim m_arrZipCode(1000) As String
Dim Addr(20) As String

Sub |fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||6b5||fffd||fffd||2fb||fffd|()
'
'****************************************
'(0)=|fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd|  '(1)=|fffd||fffd||fffd||fffd|   '(2)=|fffd||1f9||fffd||fffd||fffd|
'(3)=|fffd||fffd|           '(4)=|fffd||fffd||fffd||fffd|   '(5)=|223|
'(6)=|fffd||fffd||fffd||fffd||1ae||fffd||fffd|
'****************************************

Dim guAddr(234) As String    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||33a||fffd| |fffd||3b5||fffd|
Dim OrgAddr As String
Dim strTemp, strTmp, dong As String
Dim i, j, X, bldg, bldg2 As Integer
Dim s_b, e_b As Integer
Dim r, r2 As Double
Dim success As Single
'1004|fffd||fffd||178||fffd||4ff||fffd||fffd||fffd||fffd||7fb||fffd||fffd||fffd||fffd||fffd| REMARK|fffd||fffd| |fffd||fffd||fffd||fffd|
'Application.WindowState = xlMaximized
Folder = ThisWorkbook.Path
SD = GetSystemDir
If Right(SD, 1) <> "\" Then SD = SD + "\"

sTime = Time
f_count = 0

On Error GoTo ErrorHandler
'ZipFinder |fffd||fffd||fffd||fffd||fffd||fffd||223| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||178||fffd||fffd| |fffd||7b8||38bbf||fffd| |fffd||3b5||fffd|
Open SD + "ZipFinder.ini" For Input As #1
gulast = 0
Do Until EOF(1)
    Line Input #1, strTemp
    gulast = gulast + 1
    guAddr(gulast) = strTemp
Loop
Close #1
If gulast = 0 Then End

'ZipFinder |fffd||fffd||fffd||fffd||fffd||fffd||223| |fffd||fffd||fffd||fffd||178||fffd||fffd| |fffd||7b8||38bbf||fffd| |fffd||3b5||fffd|
Open SD + "ZipFinder.txt" For Input As #1
Line Input #1, strTemp
zc = 0
Do Until EOF(1)
    Line Input #1, strTemp
    zc = zc + 1
    memAddr(zc) = strTemp
Loop
Close #1
If zc = 0 Then End
zc = zc - 1

'Option Base 1
Worksheets("|fffd||fffd||fffd||fffd|").Activate
r = 1
'r = Selection.Row - 1
st_r = r
Do
   r = r + 1
   If Range("C" & r).Value = "" Then
   For X = 0 To 20 '|fffd||8fed| |fffd||2b1||fffd||22d|
      Addr(X) = ""
   Next
   bldg = 0: s_b = 0: e_b = 0
   notbunji = 0
   up = 0  '|fffd||fffd|->|fffd||fffd|, |fffd||f8||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
   Range("D" & r).Select
   Selection.Interior.ColorIndex = xlNone
    
   OrgAddr = Selection.Value
   If OrgAddr = "" Then Exit Do
   OrgAddr = Trim(OrgAddr) & " " & Trim(Range("E" & r).Value)
   OrgAddr = Trim(UCase(OrgAddr))
   OrgAddr = AptRepl(OrgAddr)
   strTemp = OrgAddr
    
   If InStr(strTemp, "|fffd||fffd||fc||fffd||fffd|") And InStr(strTemp, "|fffd||7f2d||fffd||fffd|") And saseo = 0 Then
      sepos = InStr(strTemp, "|fffd||fffd||fc||fffd||fffd|")
      For i = sepos - 1 To 1 Step -1
         strTmp = Mid(strTemp, i, 1)
         If strTmp = " " Then
            If i <> sepos - 1 Then Exit For
         Else
            Addr(0) = strTmp & Addr(0)
         End If
      Next
      If Addr(0) <> "" Then
         Addr(0) = Addr(0) & "|fffd||fffd||fc||fffd||fffd||fffd||7f2d||fffd||fffd|"
         Addr(1) = "|fffd||7f2d||fffd||fffd|"
      End If
        
      sepos = InStr(strTemp, "|fffd||7f2d||fffd||fffd|")
      For i = sepos + 3 To Len(strTemp)
         strTmp = Mid(strTemp, i, 1)
         If strTmp Like "#" Then
            Addr(4) = Val(Mid(strTemp, i))
            Exit For
         End If
      Next
    Else
      i = 6  '|fffd||8fed|(7~20)|fffd||fffd| |fffd||5bc||4ba||fffd||fffd||fffd| |fffd||fffd||fffd|
      saseo = 0
      Do
         i = i + 1
         sepos = InStr(strTemp, " ")  '|fffd||5bc||4b8||fffd| |fffd||fffd||fffd||9e6e||fffd||6b7||fffd| |fffd||438||fffd|
         If sepos = 0 Then
            Addr(i) = strTemp
            Exit Do
         End If
         Addr(i) = Left(strTemp, sepos - 1)
         strTemp = Trim(Mid(strTemp, sepos))
      Loop While i < 20
      selast = i  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||8fed| |fffd||fffd||121|
      
      '*** |f9||fffd||fffd||b0| |fffd||73e||ec21| |fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| - Addr(1)|fffd||fffd| |fffd||fffd||fffd||fffd|
      strTemp = Addr(7)
      Select Case Left(strTemp, 2)
      Case "|fffd||fffd||fffd||fffd|", "|fffd||3bb||fffd|", "|fffd||fffd||f5|", "|fffd||bc78|", "|fffd||fffd||f5|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|", _
      "|fffd||6cf2|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||6cf2|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|"
         Addr(1) = Left(strTemp, 2): i = 7
      Case "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fb|"
         Addr(1) = Left(strTemp, 1) & Mid(strTemp, 3, 1): i = 7
      Case Else
         Addr(1) = "": i = 6
      End Select
      sepos = i   '|fffd||fffd||fffd||fffd| DO|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||2b1||fffd||22d||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

      Do Until i > selast
         i = i + 1
         strTemp = Addr(i)
         Select Case Right(strTemp, 1)
         Case "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|"
            sTmp = Right(Addr(i - 1), 1)
            If sTmp = "|fffd||fffd|" Or sTmp = "|fffd||fffd|" Then
               '******************************
               '|fffd||fffd| |fffd||fffd|,|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||be||fffd||fffd| -> |fffd||1bb||fffd||fffd|)
               Addr(i - 1) = OldTranNew(Addr(i - 1))
                
               '******************************
               '|fffd||7f8||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||6d7f|2|fffd||fffd| -> |fffd||fffd|2|fffd||fffd|)
               Select Case Right(Addr(i), 3)
               Case "|fffd||fffd|1|fffd||fffd|", "|fffd||fffd|2|fffd||fffd|", "|fffd||fffd|3|fffd||fffd|", "|fffd||fffd|4|fffd||fffd|"
                  strTemp = Left(Addr(i), Len(Addr(i)) - 3) + Right(Addr(i), 2)
                  up = 1
               Case "|fffd||fffd|1|fffd||fffd|", "|fffd||fffd|2|fffd||fffd|", "|fffd||fffd|3|fffd||fffd|", "|fffd||fffd|4|fffd||fffd|"
                  If Left(Addr(i), 2) = "|fffd||fffd||fffd||fffd|" Then
                     strTemp = Left(Addr(i), 2) & "|fffd||fffd|" & Right(Addr(i), 2)
                  End If
                  up = 1
               Case "1|fffd||fffd||fffd||fffd|", "2|fffd||fffd||fffd||fffd|"
                  If Left(Addr(i), 2) = "|fffd||7f3||fffd|" Then
                     strTemp = Replace(1, Addr(i), "|fffd||fffd||fffd||fffd|", "|fffd||fffd|")
                  End If
                  up = 1
               Case "|fffd||fffd|3|fffd||fffd|", "|fffd||fffd|2|fffd||fffd|", "|fffd||fffd|8|fffd||fffd|", "|fffd||fffd|7|fffd||fffd|"
                  strTemp = Left(Addr(i), 3) & "." & Right(Addr(i), 2)
               End Select
                
               '******************************
               'Addr(0)|fffd||fffd| |fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
               Addr(0) = Addr(i - 1) + "^" + strTemp
               Exit Do
            End If
         Case "|fffd||fffd|", "|fffd||fffd|"
            sTmp = Right(Addr(i - 1), 1)
            If sTmp = "|fffd||fffd|" Or sTmp = "|fffd||fffd|" Or sTmp = "|fffd||fffd|" Then
               '******************************
               '|fffd||fffd| |fffd||fffd|,|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||be||fffd||fffd| -> |fffd||1bb||fffd||fffd|)
               Addr(i - 1) = OldTranNew(Addr(i - 1))
               '******************************
               'Addr(0)|fffd||fffd| |fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
               If Left(Addr(i - 1), 2) = "|fffd||fffd||fffd||fffd|" And (strTemp = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or strTemp = "|fffd||fffd||fffd||238||fffd|") Then
                  Addr(i - 1) = "|fffd||fffd||fffd||fffd|": up = 1
               End If
               If strTemp = "|fffd||3b8||fffd||fffd||fffd|" Then
                  Addr(i - 1) = "|fffd||fffd||fffd||fffd|": up = 1
               End If
               If strTemp = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or strTemp = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or (Left(strTemp, 2) = "|fffd||fffd||fffd||fffd|" And Addr(i - 1) = "|22d||fffd||fffd||fffd||fffd|") Then
                  If Right(Addr(i + 1), 1) = "|fffd||fffd|" Then
                     Addr(0) = Addr(i - 1) + "^" + Left(Addr(i + 1), Len(Addr(i + 1)) - 1) + "|fffd||fffd|"
                     i = i + 1
                  Else
                     Addr(0) = Addr(i - 1) + "^"
                  End If
                  up = 1
               Else
                  Addr(0) = Addr(i - 1) + "^" + strTemp
               End If
               If (Addr(i - 1) = "|fffd||fffd||22d||fffd||fffd|" Or Addr(i - 1) = "|fffd||fffd||fffd||fffd||fffd||fffd|") And Addr(1) = "|fffd||fffd||fffd|" Then
                  Addr(1) = "|fffd||fffd||f5|": up = 1
               End If
               Exit Do
            End If
         End Select
      Loop
      If i > selast Then i = sepos
    
      '******************************
      '|fffd||fffd||fffd||fffd| |fffd||73e||fffd||fffd| |fffd||335||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1f9||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||13e||fffd|
      i = i + 1: strTemp = Addr(i)
      If (Right(strTemp, 2) Like "#|fffd||fffd|") Or (Right(strTemp, 2) Like "#|fffd||fffd|") Then
         Addr(0) = Addr(0) & Addr(i)
         i = i + 1: strTemp = Addr(i)
      ElseIf (Addr(0) = "") And (Right(Addr(i + 1), 2) Like "#|fffd||fffd|" Or Right(Addr(i + 1), 2) Like "#|fffd||fffd|") Then
         Addr(0) = Addr(i) & Addr(i + 1)
         i = i + 2: strTemp = Addr(i)
      End If
      If Addr(0) Like "*|238||fffd||fffd|#|fffd||fffd|" Or Addr(0) Like "*|fffd||fffd||fffd||fffd|#|fffd||fffd|" Then
         Addr(0) = Left(Addr(0), Len(Addr(0)) - 2) + "|fffd||fffd|" + Right(Addr(0), 2)
      End If
      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
      If Right(strTemp, 1) = "|fffd||fffd|" Then
         Addr(3) = strTemp
         i = i + 1: strTemp = Addr(i)
      ElseIf strTemp Like "*|fffd||fffd|#*" Then
         For x1 = 1 To Len(strTemp)
            If Mid(strTemp, x1, 1) = "|fffd||fffd|" And Mid(strTemp, x1 + 1, 1) Like "#" Then
               Addr(3) = Left(strTemp, x1)
               strTemp = Mid(strTemp, x1 + 1)
            End If
         Next
      End If
      If (Right(strTemp, 2) Like "#|fffd||fffd|") And Len(strTemp) < 4 Then
         i = i + 1: strTemp = Addr(i)
      End If
      If (Right(strTemp, 2) Like "#|fffd||fffd|") And Len(strTemp) < 6 Then
         i = i + 1: strTemp = Addr(i)
      End If
      If (Right(strTemp, 2) Like "#|fffd||fffd|") And Len(strTemp) < 4 Then
         i = i + 1: strTemp = Addr(i)
      End If
      If strTemp = "|fffd||fffd|" And Left(Addr(i + 1), 1) <= "9" Then
         i = i + 1: strTemp = strTemp + Addr(i)
      End If
                
      '******************************
      '|fffd||fffd||fffd||fffd| |fffd||73e||fffd||fffd| |fffd||335||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1f9||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||13e||fffd|
      If Left(strTemp, 1) <= "9" Or (Left(strTemp, 1) = "|fffd||fffd|" And Mid(strTemp, 2, 1) <= "9") Then
         If InStr(1, strTemp, "-") > 0 Then
            sepos = InStr(1, strTemp, "-")  '|fffd||fffd||fffd||fffd| |e3||fffd||fffd|
         ElseIf InStr(1, strTemp, "|fffd||fffd||fffd||fffd|") > 0 Then
            sepos = InStr(1, strTemp, "|fffd||fffd||fffd||fffd|")  '|fffd||fffd||fffd||fffd| |e3||fffd||fffd|
         ElseIf Right(strTemp, 1) <= "9" Then
            sepos = 0
         ElseIf Right(strTemp, 1) = "|223|" Then
            sepos = 999
            Addr(5) = Val(strTemp)  '|223|
         Else
            sepos = 1000 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||fffd| |fffd||fffd||fffd|
            Addr(4) = strTemp 'Val(strTemp)
         End If
                    
         Select Case sepos
         Case 0
            Addr(4) = strTemp 'Val(strTemp)
            i = i + 1: strTemp = Addr(i)
            If Left(strTemp, 1) <= "9" Then
               If Right(strTemp, 1) <= "9" Or Right(strTemp, 1) = "|223|" Then
                  Addr(5) = Val(strTemp)  '|223|
                  i = i + 1
               End If
            End If
         Case 999
         Case 1000
         Case Else
            Addr(4) = Left(strTemp, sepos - 1)  '|fffd||fffd||fffd||fffd|
            X = Val(Mid(strTemp, sepos + 1))  '|223|
            i = i + 1
            If X = 0 Then
               strTemp = Addr(i)
               If Left(strTemp, 1) <= "9" Then
                  If Right(strTemp, 1) <= "9" Or Right(strTemp, 1) = "|223|" Then
                     Addr(5) = Val(strTemp)  '|223|
                     i = i + 1
                  End If
               End If
            Else
               Addr(5) = X
            End If
         End Select
      End If

      Addr(2) = Addr(i)
      If Addr(2) Like "#|fffd||fffd|" Then
         i = i + 1
         Addr(2) = Addr(i)
      End If
      If Addr(2) Like "#|fffd||fffd|" Then
         i = i + 1
         Addr(2) = Addr(i)
      End If
      
      If Len(Addr(2)) < 3 Then
         i = i + 1
         Addr(2) = Addr(2) + Addr(i)
      End If
      If Addr(2) <> "" Then
         If Addr(2) Like "*A#*" Then
            For x1 = Len(Addr(2)) To 1 Step -1
               If Mid(Addr(2), x1, 1) = "A" Then
                  Addr(6) = Mid(Addr(2), x1 + 1)
                  Addr(2) = Left(Addr(2), x1 - 1) + "|fffd||fffd||fffd||fffd||1ae|"
                  Exit For
               End If
            Next
         ElseIf InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") Then
            If InStr(Addr(0), "|fffd||fffd||fffd||fffd|") And InStr(Addr(2), "|fffd||fffd|") And InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") Then
               Addr(2) = Replace(1, Addr(2), "|fffd||fffd|", "|fffd||17d||f0||fffd||fffd||fffd|")
            ElseIf InStr(Addr(0), "|fffd||fffd|") And InStr(Addr(2), "|fffd||17d||f0||fffd||fffd||fffd|") And InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") Then
               Addr(2) = Replace(1, Addr(2), "|fffd||17d||f0||fffd||fffd||fffd|", "|fffd||fffd|")
            End If
      
            If InStr(InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|"), Addr(2), "|fffd||fffd|") Then
               Addr(6) = ""
               x1 = InStr(InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|"), Addr(2), "|fffd||fffd|")
               For X = x1 - 1 To InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") Step -1
                  If Mid(Addr(2), X, 1) > "9" Then
                     Addr(2) = Left(Addr(2), X)
                     Exit For
                  Else
                     Addr(6) = Mid(Addr(2), X, 1) & Addr(6)
                  End If
               Next
            ElseIf InStr(InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|"), Addr(2), "/") Then
               Addr(6) = ""
               x1 = InStr(InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|"), Addr(2), "/")
               For X = x1 - 1 To InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") Step -1
                  If Mid(Addr(2), X, 1) > "9" Then
                     Addr(2) = Left(Addr(2), X)
                     Exit For
                  Else
                     Addr(6) = Mid(Addr(2), X, 1) & Addr(6)
                  End If
               Next
            End If
         Else
            Addr(2) = BldgRepl
         End If
      End If
      '************************
      '|fffd||fffd||fffd||fffd||1ae| |fffd||fffd| |e3||fffd||fffd|
      '|fffd||fffd||fffd||fffd||fffd||73e||ec21| ?|fffd||fffd|,?|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||574||73e||efe1| |fffd||fffd||fffd||fffd|
      For X = i + 1 To selast
         strTemp = Addr(X)
         If Right(strTemp, 1) = "|fffd||fffd|" Or Right(strTemp, 2) = "|fffd||fffd||fffd||fffd|" Or InStr(strTemp, "|fffd||fffd||fffd||fffd||1ae|") Then
            Select Case Addr(0)
            Case "|fffd||fffd||fffd||7c78|^|22d||fffd||fffd|", "|fffd||3fb||ac78|^|fffd||3fb||fffd|"
            Case Else
               If Right(strTemp, 1) <> "|fffd||fffd|" Then Addr(2) = Addr(2) & strTemp
            End Select
         ElseIf Left(strTemp, 1) <= "9" Then
            Addr(6) = Val(strTemp)
            Exit For
         End If
      Next
      If Right(Addr(2), 1) = "A" Then
         Addr(2) = Left(Addr(2), Len(Addr(2)) - 1) & "|fffd||fffd||fffd||fffd||1ae|"
      End If

      If Addr(6) = "" And InStr(Addr(2), "-") Then
         strTemp = ""
            For i = 1 To Len(Addr(2))
               strTmp = Mid(Addr(2), i, 1)
               If strTmp > "9" Then
                  strTemp = strTemp & strTmp
               Else
                  Addr(6) = Mid(Addr(2), i)
                  Addr(2) = strTemp
                  Exit For
               End If
            Next
         End If
      End If
    
      X = 0
      Do
         If bldg2 = 1 Then
            bldg2 = 0: Addr(2) = ""
         End If
         '***********************
         '|fffd||fffd||fffd||9d7f| |e3||fffd||fffd|    '(0)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd|"
         a% = 0: lastfind = 0
         If Addr(0) = "" Then Exit Do
         dong = Right(Addr(0), 1)
         Addr(0) = Left(Addr(0), Len(Addr(0)) - 1)
         For X = 1 To zc
            InstrAddr = InStr(memAddr(X), Addr(0))
            If InstrAddr > 0 Then
               compAddr = Mid(memAddr(X), InstrAddr + Len(Addr(0)), 1)
               If compAddr <= "9" Or compAddr = dong Or compAddr = "|fffd||fffd|" _
               Or compAddr = "|fffd||fffd|" Or compAddr = "|fffd||fffd|" Then
                  a% = a% + 1
                  m_arrZipCode(a%) = memAddr(X)
                  If a% = 500 Then Exit For
               End If
            End If
         Next
         'Not Found |fffd||338||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd|
         If a% = 1 Then
            X = a%: lastfind = a%: Exit Do
         ElseIf a% = 0 Then
            If Addr(1) = "|fffd||7f2d||fffd||fffd|" Then
               r = r - 1: saseo = 1
               Exit Do
            End If
            strTemp = Addr(0)
            xleng = Len(strTemp)
            For i = xleng To 1 Step -1
               If Right(strTemp, 1) > "9" Then
                  Exit For
               Else
                  strTemp = Left(strTemp, Len(strTemp) - 1)
               End If
            Next
            If i = xleng Then Exit Do   '|fffd||fffd||fffd||6b0||fffd| |fffd||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||3f8||fffd| |fffd||fffd|
            '(0)|fffd||fffd| |fffd||67d||fffd| |e3||fffd||fffd|
            Addr(0) = strTemp
            For X = 1 To zc
               If (InStr(memAddr(X), Addr(0)) > 0) Then
                  a% = a% + 1
                  m_arrZipCode(a%) = memAddr(X)
                  If a% = 10000 Then Exit For
               End If
            Next
         End If
         saseo = 0
        
         'Not Found |fffd||338||fffd|
         If a% = 0 Then Exit Do
        
         '***********************
         '|fffd||fffd||fffd||fffd||fffd||e1||fffd||fffd||fffd| |e3||fffd||fffd|    '(1)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||fffd|","|fffd||fffd||fffd|"
         lastfind = a%
         strTemp = Addr(1)
         If strTemp <> "" Then
            a% = 0
            For X = 1 To lastfind
               If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                  a% = a% + 1
                  m_arrZipCode(a%) = m_arrZipCode(X)
               End If
            Next
         End If
         'Not Found |fffd||338||fffd|
         If a% = 0 Then X = 0: Exit Do
        
         '***********************
         '|fffd||1f9||fffd| |e3||fffd||fffd|  '(2)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||fffd||1ae|","|fffd||1f9||fffd|"
         lastfind = a%: a% = 0
         If Addr(2) <> "" Then
            'Addr(2) = BldgRepl
            If Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd|" Or Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^|f6||fffd||fffd|" Or Addr(0) = "|fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd|" Then
            Else
               For X = 1 To lastfind
                  If InStr(18, m_arrZipCode(X), " ") > 0 Then
                     m_arrZipCode(X) = Replace(18, m_arrZipCode(X), " ", "")
                  End If
                  If (InStr(m_arrZipCode(X), Addr(2)) > 0) Then
                     a% = a% + 1
                     m_arrZipCode(a%) = m_arrZipCode(X)
                     bldg = 1000
                  End If
               Next
            End If
            
            '|fffd||2fb||fffd||fffd||fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd||330||fffd| |fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||121||fffd||fffd| |fffd||fffd|
            If a% = 1 And InStr(m_arrZipCode(1), "^" & Addr(2) & "^") Then
               If InStr(m_arrZipCode(1), "(") Then
                  a% = 0
               Else
                  X = a%
                  Exit Do
               End If
            End If
            If a% = 0 Then '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
               If InStr(Addr(2), "|fffd||fffd||fffd||fffd|") > 0 Then
                  Addr(2) = Danji(Addr(2), "|fffd||fffd||fffd||fffd|")
               ElseIf InStr(Addr(2), "(|fffd||fffd|)") > 0 Then
                  If InStr(Addr(2), "(|fffd||fffd|)") = 1 Then
                     Addr(2) = Right(Addr(2), Len(Addr(2)) - 3)
                  Else
                     Addr(2) = Replace(1, Addr(2), "(|fffd||fffd|) ", "")
                  End If
               ElseIf InStr(Addr(2), "|fffd||fffd|") > 0 Then
                  If InStr(Addr(2), "|fffd||fffd|") = 1 Then
                     Addr(2) = Right(Addr(2), Len(Addr(2)) - 1)
                  Else
                     Addr(2) = Replace(1, Addr(2), "|fffd||fffd|", "")
                  End If
               End If
               If InStr(Addr(2), "|fffd||fffd|") > 0 Then
                  Addr(2) = Danji(Addr(2), "|fffd||fffd|")
               End If
               If InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") > 3 Then
                  If Addr(6) = "" Then
                     For i = InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") To Len(Addr(2))
                        If Mid(Addr(2), i, 1) <= "9" Then Addr(6) = Mid(Addr(2), i): Exit For
                     Next
                     Addr(2) = Left(Addr(2), InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") + 2)
                  Else
                     strTmp = Mid(Addr(0), InStr(1, Addr(0), "^") + 1, 2)
                     If Left(Addr(2), 2) = strTmp Then
                        Addr(2) = Right(Addr(2), Len(Addr(2)) - 2)
                     End If
                  End If
               End If
                
               For X = 1 To lastfind
                  If InStr(m_arrZipCode(X), "|fffd||fffd||fffd||fffd|") > 0 Then
                     m_arrZipCode(X) = Danji(m_arrZipCode(X), "|fffd||fffd||fffd||fffd|")
                  ElseIf InStr(m_arrZipCode(X), "|fffd||fffd|") > 0 Then
                     m_arrZipCode(X) = Danji(m_arrZipCode(X), "|fffd||fffd|")
                  End If
                  If (InStr(m_arrZipCode(X), Addr(2)) > 0) Then
                     a% = a% + 1
                     m_arrZipCode(a%) = m_arrZipCode(X)
                     bldg = 1000
                  End If
               Next
            End If
            If a% = 0 And (InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") Or InStr(Addr(2), "|fffd||fffd||fffd||fffd|")) Then '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||3f0||fffd| |fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd|
               Addr(2) = Left(Addr(2), 4)
               For X = 1 To lastfind
                  If (InStr(m_arrZipCode(X), Addr(2)) > 0) Then
                     a% = a% + 1
                     m_arrZipCode(a%) = m_arrZipCode(X)
                     bldg = 1000
                  End If
               Next
            End If
            
         End If
        
         Select Case bldg
         Case 1000   '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd|(|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)
            '***********************
            '|fffd||fffd||fffd||fffd| |fffd||5b4||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||13e||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |e3||fffd||fffd|  '(3)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|"
            strTemp = Addr(3)
            If strTemp <> "" Then
'               If Right(strTemp, 1) = "|fffd||fffd|" Then strTemp = Left(strTemp, Len(strTemp) - 1)
               lastfind = a%: a% = 0
               For X = 1 To lastfind
                  If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                     a% = a% + 1
                     m_arrZipCode(a%) = m_arrZipCode(X)
                     'bldg = A%
                  End If
               Next
               '|fffd||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd|
               If a% = 0 Then
                  xleng = Len(strTemp)
                  For i = xleng To 1 Step -1
                     If Right(strTemp, 1) <> "|fffd||fffd|" And Right(strTemp, 1) > "9" Then
                        Exit For
                     Else
                        strTemp = Left(strTemp, Len(strTemp) - 1)
                     End If
                  Next
                           
                  For X = 1 To lastfind
                     If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        'bldg = A%
                     End If
                  Next
               End If
            
               If a% = 0 Then
                  strTemp = "^" & Addr(2)
                  For X = 1 To lastfind
                     If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        'bldg = A%
                     End If
                  Next
               End If
            End If
        
         Case Else   '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
            '***********************
            '|fffd||1f9||fffd||e3||fffd||fffd| |fffd||fffd||fffd||7f0||173||fffd| |fffd||1f9||fffd||fffd||fffd| |fffd||1b4||fffd| |fffd||fffd| '|fffd||fffd|'|fffd||fffd| |fffd||5b4||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            'lastfind = a%: a% = 0
            strTemp = Addr(3)
            If strTemp <> "" Then
               For X = 1 To lastfind
                  If (InStr(m_arrZipCode(X), "^" & strTemp & "^") > 0) Then
                     a% = a% + 1
                     m_arrZipCode(a%) = m_arrZipCode(X)
                     'bldg = A%
                  End If
               Next
               '|fffd||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd|
               If a% = 0 Then
                  xleng = Len(strTemp)
                  For i = xleng To 1 Step -1
                     If Right(strTemp, 1) <> "|fffd||fffd|" And Right(strTemp, 1) > "9" Then
                        Exit For
                     Else
                        strTemp = Left(strTemp, Len(strTemp) - 1)
                     End If
                  Next
                  strTemp = "^" & strTemp & "|fffd||fffd|^"
                  For X = 1 To lastfind
                     If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        'bldg = A%
                     End If
                  Next
                  If a% = 0 Then
                     X = CompDong(dong): Exit Do
                  Else
                     lastfind = a%
                  End If
               Else
                  lastfind = a%
               End If
            End If
         End Select
        
         If Addr(1) = "|fffd||7f2d||fffd||fffd|" Then
            bldg = lastfind: a% = lastfind
         ElseIf a% = 0 And bldg = 0 And lastfind <> 0 Then
            For X = 1 To lastfind
               If (InStr(m_arrZipCode(X), "^^") > 0) Then
                  If (InStr(m_arrZipCode(X), "|fffd||7f2d||fffd||fffd|") = 0) Then
                     a% = a% + 1
                     m_arrZipCode(a%) = m_arrZipCode(X)
                     bldg = a%
                  End If
               End If
            Next
         End If
        
         '***************************************
         If lastfind = 0 Then
            X = lastfind
         ElseIf bldg <> 1000 And Addr(4) <> "" Then  '|fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |e3||fffd||fffd|
            lastfind = a%
            a% = 0
            X = CompDong(dong)
            If X <> 0 Then X = f_Bunji(r)
            X = f_Bunji(r)
         ElseIf bldg <> 1000 And Addr(4) = "" Then  '|fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
            X = lastfind: Exit Do
         ElseIf Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||3fe||fffd|" And InStr(Addr(2), "|fffd||5b0||fffd|") And Val(Addr(6)) < 114 Then
            X = 0: Exit Do
         Else
            lastfind = a%: a% = 0
            bunji_a = Val(Addr(6))
            For X = 1 To lastfind
               tmp = m_arrZipCode(X)
               sepos = InStr(1, tmp, "(")
               bunji_b = Right(tmp, Len(tmp) - sepos)
               seb = InStr(bunji_b, "|fffd||fffd|")
               If seb > 0 Then
                  s_b = Val(Left(bunji_b, seb - 1))
                  e_b = Val(Right(bunji_b, Len(bunji_b) - seb))
                  If bunji_a >= s_b And bunji_a <= e_b Then
                     Exit For
                  End If
               Else
                  If bunji_a = Val(bunji_b) Then Exit For
                  If sepos = 0 And lastfind = 1 Then Exit Do
               End If
            Next
            If X > lastfind Or X = 0 Then
               bldg2 = 1: bldg = 0: lastfind = 0 ': r = r - 1
            End If
         End If
         If X > lastfind And lastfind <> 0 Then X = lastfind
         Worksheets("|fffd||fffd||fffd||fffd|").Activate
         If X = 0 And lastfind <> 0 Then
            xleng = Len(Addr(0))
            For i = xleng To 1 Step -1
               If Right(Addr(0), 1) > "9" Then
                  Exit For
               Else
                  Addr(0) = Left(Addr(0), Len(Addr(0)) - 1)
               End If
            Next
            '|fffd||fffd||fffd||9d7f| |fffd||67d||fffd| |e3||fffd||fffd|    '(0)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd|"
            a% = 0
            For X = 1 To zc
               If (InStr(memAddr(X), Addr(0)) > 0) Then
                  a% = a% + 1
                  m_arrZipCode(a%) = memAddr(X)
                  If a% = 10000 Then Exit For
               End If
            Next
            X = a%
            Range("D" & r).Select
            With Selection.Interior
               .ColorIndex = 6
               .Pattern = xlSolid
            End With
         End If
         If bldg2 = 0 Then Exit Do
      Loop
      If saseo = 1 Or bldg2 = 1 Then
      ElseIf X = 0 Or lastfind = 0 Then
         Range("D" & r).Select
         With Selection.Interior
            .ColorIndex = 6
            .Pattern = xlSolid
         End With
         Range("C" & r).ClearComments

'*****************************************************
'|e3||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||178| |fffd||67d||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd|
'*****************************************************
      For X = 0 To 20 '|fffd||8fed| |fffd||2b1||fffd||22d|
        Addr(X) = ""
      Next
      dong = "": dongfind = 0
      bldg = 0: bldg2 = 0
      X = 0: lastfind = 0
      s_b = 0: e_b = 0
      notbunji = 0
      up = 0  '|fffd||fffd|->|fffd||fffd|, |fffd||f8||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
      Range("D" & r).Interior.ColorIndex = 15  'xlNone
      
      strTemp = OrgAddr
      If InStr(strTemp, "-") Then
         If Mid(strTemp, InStr(strTemp, "-") - 1, 1) > "9" And Mid(strTemp, InStr(strTemp, "-") + 1, 1) > "9" Then
            For i = 1 To 4
               strTemp = Replace(1, strTemp, "-", " ")
            Next
         End If
      End If
      If Left(strTemp, 1) > "9" Then
'*******************9/11 remark
'       If InStr(strTemp, "|fffd||fffd||fc||fffd||fffd|") > 0 And InStr(strTemp, "|fffd||7f2d||fffd||fffd|") > 0 And saseo = 0 Then
        
'        sepos = InStr(strTemp, "|fffd||fffd||fc||fffd||fffd|")
'        For i = sepos - 1 To 1 Step -1
'            strTmp = Mid(strTemp, i, 1)
'            If strTmp = " " Then
'                If i <> sepos - 1 Then Exit For
'            Else
'                Addr(0) = strTmp & Addr(0)
'            End If
'        Next
'        If Addr(0) <> "" Then
'            Addr(0) = Addr(0) & "|fffd||fffd||fc||fffd||fffd|"
'            Addr(1) = "|fffd||7f2d||fffd||fffd|"
'        End If
        
'        sepos = InStr(strTemp, "|fffd||7f2d||fffd||fffd|")
'        Addr(4) = Val(Mid(strTemp, sepos + 3))
    
'       Else
    
    i = 6  '|fffd||8fed|(7~20)|fffd||fffd| |fffd||5bc||4ba||fffd||fffd||fffd| |fffd||fffd||fffd|
   Do
      i = i + 1
      sepos = InStr(1, strTemp, " ")  '|fffd||5bc||4b8||fffd| |fffd||fffd||fffd||9e6e||fffd||6b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||438||fffd|
      If sepos = 0 Then
         Addr(i) = strTemp
         If Addr(i) = "" Or Addr(i) = "|fffd||fffd||fffd||fffd|" Then
            Addr(i) = ""
            i = i - 1
         End If
         Exit Do
      End If
      Addr(i) = Trim(Left(strTemp, sepos - 1))
      strTemp = Mid(strTemp, sepos + 1)
        
      If Len(Addr(i)) = 1 Then
         If Addr(i) = "|fffd||fffd|" Then
            Addr(i - 1) = Addr(i - 1) + Addr(i)
            i = i - 1
   '      Else
   '         strTemp = Addr(i) + strTemp
         End If
      Else
        
        If (Addr(i) Like "#|fffd||fffd|") Or (Addr(i) Like "#|fffd||fffd|") Then
            Addr(i - 1) = Addr(i - 1) & Addr(i)
            i = i - 1
        ElseIf Right(Addr(i), 2) = "|fffd||fffd||fffd||fffd|" And Left(strTemp, 1) > "9" Then
               strTemp = Addr(i) & strTemp
              sepos = InStr(1, strTemp, " ")
              If sepos = 0 Then
                  Addr(i) = strTemp
                  Exit Do
               Else
                  Addr(i) = Trim(Left(strTemp, sepos - 1))
                  strTemp = Mid(strTemp, sepos + 1)
               End If
        End If
        If Addr(i) = "" Or Addr(i) = "|fffd||fffd||fffd||fffd|" Then
            Addr(i) = ""
            i = i - 1
        End If
        End If
    Loop While i < 20
    selast = i  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||8fed| |fffd||fffd||121|

    '*** |f9||fffd||fffd||b0| |fffd||73e||ec21| |fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd| - Addr(1)|fffd||fffd| |fffd||fffd||fffd||fffd|
    i = 7
    strTemp = Addr(7)
    Select Case Left(strTemp, 2)
    Case "|fffd||fffd||fffd||fffd|", "|fffd||3bb||fffd|", "|fffd||fffd||f5|", "|fffd||bc78|", "|fffd||fffd||f5|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|", _
    "|fffd||6cf2|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||6cf2|", "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|"
         Addr(1) = "^" & Left(strTemp, 2) & "^"
         If Len(strTemp) > 2 Then
         Addr(7) = Mid(Addr(7), 3)
         If Mid(Addr(7), 1, 1) = "|fffd||fffd|" Or Mid(Addr(7), 1, 1) = "|fffd||fffd|" Then
            Addr(7) = Mid(Addr(7), 2)
         ElseIf Mid(Addr(7), 1, 2) = "|fffd||fffd||fffd||fffd|" Or Mid(Addr(7), 1, 2) = "|fffd||3f5||fffd|" Then
            Addr(7) = Mid(Addr(7), 3)
         ElseIf Mid(Addr(7), 1, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or Mid(Addr(7), 1, 3) = "|1af||fffd||fffd||fffd||fffd|" Then
            Addr(7) = Mid(Addr(7), 4)
         End If
         Else
'            Addr(7) = Left(strTemp, 2)
            i = 8
         End If
    Case "|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fb|"
         If Mid(Addr(7), 3, 2) = "|fffd||fffd||fffd||fffd|" Or Mid(Addr(7), 3, 2) = "|fffd||3f5||fffd|" Then
            Addr(7) = Mid(Addr(7), 5)
         Else
            Addr(7) = Left(strTemp, 1) & Mid(strTemp, 3, 1): Addr(1) = "^" & Addr(7) & "^"
            i = 8
         End If
    Case Else
        Addr(1) = "": i = 7
    End Select
    If Addr(7) = "" Then i = i + 1

    '*** |fffd||fffd|.|fffd||fffd|.|fffd||fffd| |e3||fffd||fffd| - Addr(1)|fffd||fffd| |fffd||fffd||fffd||fffd|
    strTemp = Addr(i)
    Lstr = "," & Left(strTemp, 2)
    For X = 1 To gulast
        If InStr(guAddr(X), Lstr) Then
            strTmp = Mid(guAddr(X), InStr(InStr(guAddr(X), ",") + 1, guAddr(X), ",") + 1)
            If Right(strTemp, 1) = "|fffd||fffd|" And strTmp <> "|fffd||fffd||fffd||fffd||fffd|" Then
                strTmp = Trim(strTmp + " " + Mid(strTemp, Len(strTmp) + 1))
            End If
            Addr(0) = strTmp & "^"
            If Len(strTemp) > Len(strTmp) Then
               For x1 = 1 To Len(strTemp)
                  If Mid(strTemp, x1, 1) <> Mid(strTmp, x1, 1) Then
                     Addr(i) = Mid(strTemp, x1)
                     Exit For
                  End If
               Next
            Else
               If Right(strTemp, 1) = "|fffd||fffd|" Or Right(strTemp, 1) = "|fffd||fffd|" Or Right(strTemp, 1) = "|fffd||fffd|" Then
               Else
                i = i + 1
               End If
            End If
            Exit For
        End If
    Next
    If X > gulast And Right(strTemp, 1) = "|fffd||fffd|" Then
      Addr(0) = "^"
      i = i + 1
   End If
    
   Select Case Addr(0)
   Case "|fffd||fffd||fffd||fffd||fffd|^", "|fffd||fffd||f5||fffd||fffd|^", "|fffd||fffd||fffd||fffd||fffd||fffd|^", "|fffd||fffd||fffd||fffd||fffd||fffd|^", "|fffd||23e||fffd||fffd|^", "|fffd||23b||fffd||fffd|^"
      Addr(1) = "|fffd||fffd||fffd|^" & Left(Addr(0), 3)
      Addr(0) = ""
      Select Case Left(Addr(i), 2)
      Case "|fffd||fffd||fffd||fffd|", "|fffd||3fb||fffd|", "|fffd||4bb||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||434||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||7ff||fffd|", _
      "|fffd||1fc||fffd|", "|fffd||fffd||fffd|", "|fffd||234||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||73f||fffd|", "|fffd||fffd||fffd|"
         If Len(Addr(i)) = 2 Then
            Addr(0) = Addr(i) & "|fffd||fffd|^"
            Addr(i) = ""
         ElseIf Mid(Addr(i), 3, 1) = "|fffd||fffd|" Then
            Addr(0) = Left(Addr(i), 3) & "^"
            Addr(i) = Mid(Addr(i), 4)
         End If
         If Addr(i) = "" Then i = i + 1
      End Select
      If Right(Addr(i), 1) = "|fffd||fffd|" Then i = i + 1
   Case "|fb||fffd||5bd||fffd|^"
      Addr(1) = "|fffd||fffd||fffd|^" & Left(Addr(0), 3)
      Addr(0) = ""
      Select Case Left(Addr(i), 2)
      Case "|fffd||fffd||fffd|", "|fffd||fffd||fffd|"
         If Len(Addr(i)) = 2 Then
            Addr(0) = Addr(i) & "|fffd||fffd|^"
            Addr(i) = ""
         ElseIf Mid(Addr(i), 3, 1) = "|fffd||fffd|" Then
            Addr(0) = Left(Addr(i), 3) & "^"
            Addr(i) = Mid(Addr(i), 4)
         End If
         If Addr(i) = "" Then i = i + 1
      End Select
      If Right(Addr(i), 1) = "|fffd||fffd|" Then i = i + 1
   Case "|fffd||fffd||fffd||5bd||fffd|^"
      Addr(1) = "|fffd||fffd||fffd||fffd|^" & Left(Addr(0), 3)
      Addr(0) = ""
      Select Case Left(Addr(i), 2)
      Case "|fffd||3fb||fffd|", "|fffd||fffd||fffd||fffd|"
         If Len(Addr(i)) = 2 Then
            Addr(0) = Addr(i) & "|fffd||fffd|^"
            Addr(i) = ""
         ElseIf Mid(Addr(i), 3, 1) = "|fffd||fffd|" Then
            Addr(0) = Left(Addr(i), 3) & "^"
            Addr(i) = Mid(Addr(i), 4)
         End If
         If Addr(i) = "" Then i = i + 1
      End Select
      If Right(Addr(i), 1) = "|fffd||fffd|" Then i = i + 1
   Case "|fffd||fffd||fffd||5fd||fffd|^"
      If Right(Addr(i), 1) <> "|fffd||fffd|" And (Left(Addr(i), 1) = "|fffd||fffd|" Or Left(Addr(i), 1) = "|fffd||fffd|") Then
         Addr(0) = "|fffd||fffd||fffd||5fd||fffd| " + Left(Addr(i), 1) + "|fffd||fffd|^"
         i = i + 1
      Else
         Addr(0) = "|fffd||fffd||fffd||5fd||fffd| "
      End If
   Case Else
   End Select
    
    '*** |fffd||fffd|.|fffd||fffd|.|fffd||fffd| |e3||fffd||fffd| - Addr(0)|fffd||fffd| |fffd||fffd||fffd||fffd|
    strTemp = Addr(i)
    If Right(strTemp, 1) = "|fffd||fffd|" Then
        i = i + 1
        Addr(0) = strTemp & "^"
        If Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^" Or Addr(0) = "|238||fffd||fffd||fffd||fffd|^" Then Addr(0) = "|fffd||fffd||fffd||fffd||fffd|^"
    End If
    strTemp = Addr(i)
    Select Case Right(strTemp, 1)
    Case "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|"
        '******************************
        If Right(Addr(0), 1) = "^" Then
         Addr(0) = Addr(0) & strTemp
        Else
         Addr(1) = Addr(1) & Addr(0)
         Addr(0) = strTemp
      End If
        i = i + 1
    Case "|fffd||fffd|", "|fffd||fffd|"
         Addr(0) = Addr(0) & strTemp
         
         i = i + 1
         If Right(Addr(i), 1) = "|fffd||fffd|" Then
            Addr(3) = Addr(i)
            i = i + 1
         End If
    Case Else
        For X = 2 To Len(strTemp)
            Lstr = Mid(strTemp, X, 1)
            Select Case Lstr
            Case "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|"
                '******************************
                'Addr(0)|fffd||fffd| "^|fffd||fffd||fffd||fffd|" |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                
                 If Right(Addr(0), 1) = "^" Then
                      Addr(0) = Addr(0) & Left(strTemp, X)
                  Else
                     Addr(1) = Addr(1) & Addr(0)
                   Addr(0) = Left(strTemp, X)
               End If
                
'                Addr(0) = Addr(0) & Left(strTemp, x)
                Addr(i) = Mid(strTemp, X + 1)
                If Left(Addr(i), 2) Like "#|fffd||fffd|" Then
                    Addr(0) = Addr(0) & Left(Addr(i), 2)
                    Addr(i) = Mid(Addr(i), 3)
                End If
                dongfind = 1
                Exit For
            Case "|fffd||fffd|", "|fffd||fffd|"
                Addr(0) = Addr(0) & Left(strTemp, X)
                Addr(i) = Mid(strTemp, X + 1)
                If Right(Addr(i), 1) = "|fffd||fffd|" Then
                    Addr(3) = Addr(i)
                    i = i + 1
                End If
                dongfind = 1
                Exit For
            Case Else
            End Select
        Next
        If dongfind = 0 Then
            If Right(Addr(i + 1), 1) = "|fffd||fffd|" Then
                Addr(0) = Addr(0) & strTemp & Addr(i + 1)
                i = i + 2
            ElseIf Right(strTemp, 1) = "|fffd||fffd|" Then
                Addr(3) = strTemp
                i = i + 1
            ElseIf Right(Addr(0), 1) = " " Then
                Addr(0) = strTemp
                i = i + 1
            ElseIf Len(strTemp) < 4 Then
                Addr(0) = Addr(0) & strTemp
                i = i + 1
            End If
        End If
    End Select
    
      '******************************
      '|fffd||fffd||fffd||fffd| |fffd||73e||ec21| "|fffd||fffd|"|fffd||fffd||fffd||fffd| |fffd||13e||fffd|
      strTemp = Addr(i)
      
      If Right(strTemp, 1) = "|fffd||fffd|" Then
         Addr(3) = strTemp
         i = i + 1: strTemp = Addr(i)
      ElseIf strTemp Like "*|fffd||fffd|#*" Then
         For x1 = 1 To Len(strTemp)
            If Mid(strTemp, x1, 1) = "|fffd||fffd|" And Mid(strTemp, x1 + 1, 1) Like "#" Then
               Addr(3) = Left(strTemp, x1)
               strTemp = Mid(strTemp, x1 + 1)
            End If
         Next
      ElseIf Left(Addr(i), 2) Like "#|fffd||fffd|" Then
         Addr(0) = Addr(0) & Left(Addr(i), 2)
         Addr(i) = Mid(Addr(i), 3)
      End If
         
         If Addr(3) <> "" And (Right(Addr(0), 3) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or Right(Addr(0), 3) = "|fffd||fffd||fffd||fffd||fffd||fffd|") Then
            Addr(0) = Left(Addr(0), Len(Addr(0)) - 3) + Left(Addr(3), Len(Addr(3)) - 1) + "|fffd||fffd|"
            Addr(3) = ""
            up = 1
         End If
      
      '******************************
      '|fffd||fffd||fffd||fffd| |fffd||73e||ec21| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1f9||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||13e||fffd|
      If strTemp = "|fffd||fffd|" Then
         i = i + 1
         strTemp = strTemp + Addr(i)
      End If
    If Left(strTemp, 1) <= "9" Or (Left(strTemp, 1) = "|fffd||fffd|" And Mid(strTemp, 2, 1) <= "9") Then
        If InStr(1, strTemp, "-") > 0 Then
            sepos = InStr(1, strTemp, "-")  '|fffd||fffd||fffd||fffd| |e3||fffd||fffd|
        ElseIf InStr(1, strTemp, "|fffd||fffd||fffd||fffd|") > 0 Then
            sepos = InStr(1, strTemp, "|fffd||fffd||fffd||fffd|")  '|fffd||fffd||fffd||fffd| |e3||fffd||fffd|
        ElseIf Right(strTemp, 1) <= "9" Then
            sepos = 0
        Else
            sepos = 1000 '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||1b4||fffd| |fffd||fffd||fffd|
            Addr(4) = Val(strTemp)
        End If
                    
        Select Case sepos
        Case 0
            Addr(4) = Val(strTemp)
            i = i + 1: strTemp = Addr(i)
            If Left(strTemp, 1) <= "9" Then
                If Right(strTemp, 1) <= "9" Or Right(strTemp, 1) = "|223|" Then
                    Addr(5) = Val(strTemp)  '|223|
                    i = i + 1
                End If
            End If
        Case 1000
        Case Else
            Addr(4) = Left(strTemp, sepos - 1)  '|fffd||fffd||fffd||fffd|
            X = Val(Mid(strTemp, sepos + 1))  '|223|
            i = i + 1
            If X = 0 Then
                strTemp = Addr(i)
                If Left(strTemp, 1) <= "9" Then
                    If Right(strTemp, 1) <= "9" Or Right(strTemp, 1) = "|223|" Then
                        Addr(5) = Val(strTemp)  '|223|
                        i = i + 1
                    End If
                End If
            Else
                Addr(5) = X
            End If
        End Select
    End If
    
    Addr(2) = Addr(i)
    If Len(Addr(2)) < 3 Then
      i = i + 1
       Addr(2) = Addr(2) + Addr(i)
      End If
      
    
    '************************
    '|fffd||fffd||fffd||fffd||1ae| |fffd||fffd| |e3||fffd||fffd|
    '|fffd||fffd||fffd||fffd||fffd||73e||ec21| ?|fffd||fffd|,?|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||1ae||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||574||73e||efe1| |fffd||fffd||fffd||fffd|
    For X = i + 1 To selast
        strTemp = Addr(X)
        If Right(strTemp, 1) = "|fffd||fffd|" Or Right(strTemp, 2) = "|fffd||fffd||fffd||fffd|" Or Right(strTemp, 3) = "|fffd||fffd||fffd||fffd||1ae|" Then
            Select Case Addr(0)
            Case "|fffd||fffd||fffd||7c78|^|22d||fffd||fffd|", "|fffd||3fb||ac78|^|fffd||3fb||fffd|"
            Case Else
                If Right(strTemp, 1) <> "|fffd||fffd|" Then Addr(2) = Addr(2) & strTemp
            End Select
        ElseIf Left(strTemp, 1) <= "9" Then '|fffd||fffd||fffd||fffd||1ae| |fffd||fffd| |e3||fffd||fffd|
            Addr(6) = Val(strTemp)
            Exit For
        End If
    Next

'    If InStr(Addr(2), "APT") > 0 Then
'        Addr(2) = Replace(1, Addr(2), "APT", "|fffd||fffd||fffd||fffd||1ae|")
'    ElseIf InStr(Addr(2), "A.P.T") > 0 Then
'        Addr(2) = Replace(1, Addr(2), "A.P.T", "|fffd||fffd||fffd||fffd||1ae|")
'    ElseIf InStr(Addr(2), "BLDG.") > 0 Then
'        Addr(2) = Replace(1, Addr(2), "BLDG.", "|fffd||fffd||fffd||fffd|")
'    ElseIf InStr(Addr(2), "BLDG") > 0 Then
'        Addr(2) = Replace(1, Addr(2), "BLDG.", "|fffd||fffd||fffd||fffd|")
'    ElseIf InStr(Addr(2), "@") > 0 Then
'        Addr(2) = Replace(1, Addr(2), "@.", "|fffd||fffd||fffd||fffd||1ae|")
    If Right(Addr(2), 1) = "A" Then
        Addr(2) = Left(Addr(2), Len(Addr(2)) - 1) & "|fffd||fffd||fffd||fffd||1ae|"
    End If
    
    If Addr(6) = "" And InStr(Addr(2), "-") Then
        strTemp = ""
        For i = 1 To Len(Addr(2))
            strTmp = Mid(Addr(2), i, 1)
            If strTmp > "9" Then
                strTemp = strTemp & strTmp
            Else
                Addr(6) = Mid(Addr(2), i)
                Addr(2) = strTemp
                Exit For
            End If
        Next
    End If
    
'*********************9/12 rem
    'End If
    
    X = 0
    Do
        '***********************
        '|fffd||fffd||fffd||9d7f| |e3||fffd||fffd|    '(0)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd|"
        a% = 0: lastfind = 0
        If Addr(0) = "" Then Exit Do
        If bldg2 = 1 Then
            bldg2 = 0: Addr(2) = ""
        Else
        
        If Right(Addr(0), 1) <> "^" Then
            If Right(Addr(0), 4) Like "|fffd||1b9||fffd|#|fffd||fffd|" Then
                Addr(0) = Left(Addr(0), Len(Addr(0)) - 2) & "|fffd||fffd|" & Right(Addr(0), 2)
            ElseIf Right(Addr(0), 3) Like "#|fffd||fffd||fffd||fffd|" Then
                Addr(0) = Left(Addr(0), Len(Addr(0)) - 3) & "|fffd||fffd|" & Mid(Addr(0), Len(Addr(0)) - 2, 2)
            End If

            dong = Right(Addr(0), 1)
            'If InStr(Addr(0), "^") Then
            'If Mid(Addr(0), Len(Addr(0)) - 1, 1) <> "^" Then
               Addr(0) = Left(Addr(0), Len(Addr(0)) - 1)
            'End If
            'End If
        End If
        
        End If
        If Addr(0) = "" Then Exit Do
        If InStr(Addr(0), "^") = 0 Then Addr(0) = "^" & Addr(0)
        For X = 1 To zc
            InstrAddr = InStr(memAddr(X), Addr(0))
            If InstrAddr > 0 Then
                compAddr = Mid(memAddr(X), InstrAddr + Len(Addr(0)), 1)
                If compAddr = "|fffd||fffd|" And InStr(InstrAddr + 1, memAddr(X), Addr(0)) Then
                  InstrAddr = InStr(InstrAddr + 1, memAddr(X), Addr(0))
                   compAddr = Mid(memAddr(X), InstrAddr + Len(Addr(0)), 1)
               End If
                compAddr = Mid(memAddr(X), InstrAddr + Len(Addr(0)), 1)
                If dong = "" Or compAddr <= "9" Or compAddr = dong Or compAddr = "|fffd||fffd|" _
                Or compAddr = "|fffd||fffd|" Or compAddr = "|fffd||fffd|" Or compAddr = "|fffd||fffd|" Or compAddr = "^" Then
                  If dong = "|fffd||fffd|" Then
                     If compAddr <= "9" Or compAddr = dong Or compAddr = "|fffd||fffd|" Then
                        a% = a% + 1
                          m_arrZipCode(a%) = memAddr(X)
                          If a% = 500 Then Exit For
                     End If
                  Else
                    a% = a% + 1
                    m_arrZipCode(a%) = memAddr(X)
                    If a% = 500 Then Exit For
                  End If
                End If
            End If
        Next
        'Not Found |fffd||338||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd|
        If a% = 0 Then
            If Addr(1) = "|fffd||7f2d||fffd||fffd|" Then
                r = r - 1: saseo = 1
                Exit Do
            End If
            saseo = 0
            
            Select Case Left(Addr(0), 4)
            Case "|fffd||23e||fffd||fffd|^"
                Addr(0) = Mid(Addr(0), 5)
                strTemp = Addr(0)
            Case Else
                strTemp = Addr(0)
                xleng = Len(strTemp)
                For i = xleng To 1 Step -1
                    If Right(strTemp, 1) > "9" Then
                        Exit For
                   Else
                     strTemp = Left(strTemp, Len(strTemp) - 1)
                    End If
                Next
                If i = xleng Then
                  If Addr(3) <> "" And InStr(Addr(0), "^") Then
                     Addr(0) = Left(Addr(0), InStr(Addr(0), "^") - 1)
                     strTemp = Addr(0)
                  Else
                     Exit Do   '|fffd||fffd||fffd||6b0||fffd| |fffd||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||3f8||fffd| |fffd||fffd|
                  End If
               End If
            End Select
            '(0)|fffd||fffd| |fffd||67d||fffd| |e3||fffd||fffd|
            Addr(0) = strTemp
            For X = 1 To zc
                If (InStr(memAddr(X), Addr(0)) > 0) Then
                    a% = a% + 1
                    m_arrZipCode(a%) = memAddr(X)
                    If a% = 500 Then Exit For
                End If
            Next
        End If
        saseo = 0
        
        'Not Found |fffd||338||fffd|
        If a% = 0 Then Exit Do
        
        '***********************
        '|fffd||fffd||fffd||fffd||fffd||e1||fffd||fffd||fffd| |e3||fffd||fffd|    '(1)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||fffd|","|fffd||fffd||fffd|"
        lastfind = a%
        strTemp = Addr(1)
        If strTemp <> "" Then
            a% = 0
            For X = 1 To lastfind
                If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                    a% = a% + 1
                    m_arrZipCode(a%) = m_arrZipCode(X)
                End If
            Next
        End If
        'Not Found |fffd||338||fffd|
        If a% = 0 Then X = 0: Exit Do
        
        
        '***********************
        '|fffd||1f9||fffd| |e3||fffd||fffd|  '(2)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||fffd||1ae|","|fffd||1f9||fffd|"
        lastfind = a%: a% = 0
        If Addr(2) <> "" Then
            If Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd|" Or Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^|f6||fffd||fffd|" Or Addr(0) = "|fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd|" Then
            Else
                For X = 1 To lastfind
                    If InStr(18, m_arrZipCode(X), " ") > 0 Then
                        m_arrZipCode(X) = Replace(18, m_arrZipCode(X), " ", "")
                    End If
                    If (InStr(m_arrZipCode(X), Addr(2)) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        bldg = 1000
                    End If
                Next
            End If
            
            If a% = 0 Then '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
                If InStr(Addr(2), "|fffd||fffd||fffd||fffd|") > 0 Then
                    Addr(2) = Danji(Addr(2), "|fffd||fffd||fffd||fffd|")
                End If
                If InStr(Addr(2), "|fffd||fffd|") > 0 Then
                    Addr(2) = Danji(Addr(2), "|fffd||fffd|")
                End If
                If InStr(Addr(2), "|fffd||fffd||fffd||fffd||1ae|") > 3 Then
                    strTmp = Mid(Addr(0), InStr(1, Addr(0), "^") + 1, 2)
                    If Left(Addr(2), 2) = strTmp Then
                        Addr(2) = Right(Addr(2), Len(Addr(2)) - 2)
                    End If
                End If
                
                For X = 1 To lastfind
                    If InStr(m_arrZipCode(X), "|fffd||fffd||fffd||fffd|") > 0 Then
                        m_arrZipCode(X) = Danji(m_arrZipCode(X), "|fffd||fffd||fffd||fffd|")
                    ElseIf InStr(m_arrZipCode(X), "|fffd||fffd|") > 0 Then
                        m_arrZipCode(X) = Danji(m_arrZipCode(X), "|fffd||fffd|")
                    End If
                    If (InStr(m_arrZipCode(X), Addr(2)) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        bldg = 1000
                    End If
                Next
            End If
            If a% = 0 And Len(Addr(2)) > 4 Then '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||3f0||fffd| |fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd|
                Addr(2) = Left(Addr(2), 4)
                For X = 1 To lastfind
                    If (InStr(m_arrZipCode(X), Addr(2)) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        bldg = 1000
                    End If
                Next
            End If
        End If
        
        Select Case bldg
        Case 1000   '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd|(|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)
        '***********************
        '|fffd||fffd||fffd||fffd| |fffd||5b4||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||13e||fffd||fffd||3f0||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |e3||fffd||fffd|  '(3)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|"
'        strTemp = Addr(3)
'        If strTemp <> "" Then
'            lastfind = a%: a% = 0
'            For x = 1 To lastfind
'                If (InStr(m_arrZipCode(x), strTemp) > 0) Then
'                    a% = a% + 1
'                    m_arrZipCode(a%) = m_arrZipCode(x)
'                    bldg = a%
'                End If
'            Next
            '|fffd||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd|
'            If a% = 0 Then
'                xleng = Len(strTemp)
'                For i = xleng To 1 Step -1
'                    If Right(strTemp, 1) <> "|fffd||fffd|" And Right(strTemp, 1) > "9" Then
'                        Exit For
'                    Else
'                        strTemp = Left(strTemp, Len(strTemp) - 1)
'                    End If
'                Next
                           
'                For x = 1 To lastfind
'                    If (InStr(m_arrZipCode(x), strTemp) > 0) Then
'                        a% = a% + 1
'                        m_arrZipCode(a%) = m_arrZipCode(x)
'                        bldg = a%
'                    End If
'                Next
 '           End If
            
 '           If a% = 0 Then
 '              strTemp = "^" & Addr(2)
 '               For x = 1 To lastfind
 '                   If (InStr(m_arrZipCode(x), strTemp) > 0) Then
 '                       a% = a% + 1
 '                       m_arrZipCode(a%) = m_arrZipCode(x)
                        'bldg = A%
'                    End If
'                Next
 '           End If
            
'            If a% = 0 Then
'                If lastfind = 1 Then
'                    x = 1
'                Else
'                    x = 0
'                End If
'                Exit Do
'            ElseIf a% = 1 Then
'                x = a%: Exit Do
'            End If
 '       End If
        
        Case Else   '|fffd||1f9||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
        '***********************
        '|fffd||1f9||fffd||e3||fffd||fffd| |fffd||fffd||fffd||7f0||173||fffd| |fffd||1f9||fffd||fffd||fffd| |fffd||1b4||fffd| |fffd||fffd| '|fffd||fffd|'|fffd||fffd| |fffd||5b4||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        'lastfind = a%: a% = 0
        strTemp = Addr(3)
        If strTemp <> "" Then
            For X = 1 To lastfind
                If (InStr(m_arrZipCode(X), "^" & strTemp & "^") > 0) Then
                    a% = a% + 1
                    m_arrZipCode(a%) = m_arrZipCode(X)
                    bldg = a%
                End If
            Next
            '|fffd||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||fffd|
            If a% = 0 Then
                xleng = Len(strTemp)
                For i = xleng To 1 Step -1
                    If Right(strTemp, 1) <> "|fffd||fffd|" And Right(strTemp, 1) > "9" Then
                        Exit For
                    Else
                        strTemp = Left(strTemp, Len(strTemp) - 1)
                    End If
                Next
                strTemp = "^" & strTemp & "|fffd||fffd|^"
                For X = 1 To lastfind
                    If (InStr(m_arrZipCode(X), strTemp) > 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        bldg = a%
                    End If
                Next
'                If a% = 0 Then x = lastfind: Exit Do
                If a% = 0 Then
                  X = CompDong(dong): Exit Do
               End If
            Else
                lastfind = a%
            End If
        End If
        End Select
        
        If Addr(1) = "|fffd||7f2d||fffd||fffd|" Then
            bldg = lastfind
        ElseIf a% = 0 And bldg = 0 And lastfind <> 0 And dong <> "|fffd||fffd|" Then
            For X = 1 To lastfind
                If (InStr(m_arrZipCode(X), "^^") > 0) Then
                    If (InStr(m_arrZipCode(X), "|fffd||7f2d||fffd||fffd|") = 0) Then
                        a% = a% + 1
                        m_arrZipCode(a%) = m_arrZipCode(X)
                        bldg = a%
                    End If
                End If
            Next
        End If
        
'***************************************
        If lastfind = 0 Then
            X = lastfind
        ElseIf a% = 1 Then
            X = 1
    
        ElseIf bldg <> 1000 And Addr(4) <> "" Then  '|fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |e3||fffd||fffd|
            lastfind = bldg: a% = 0
            X = CompDong(dong)
            If X <> 0 Then X = f_Bunji(r)
        ElseIf bldg <> 1000 And Addr(4) = "" Then  '|fffd||1f9||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
            lastfind = bldg: a% = 0
            X = CompDong(dong)
'            If Right(Addr(0), 1) = "^" Then
'                x = 0
'            Else
                'x = lastfind
            
'                x = a%
'            End If
            Exit Do
        ElseIf Addr(0) = "|fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||3fe||fffd|" And InStr(Addr(2), "|fffd||5b0||fffd|") And Val(Addr(6)) < 114 Then
            X = 0: Exit Do
        Else
            lastfind = a%: a% = 0
            X = CompDong(dong)
            If X <> 0 Then
            bunji_a = Val(Addr(6))
            For X = 1 To lastfind
                tmp = m_arrZipCode(X)
                bunji_b = Right(tmp, Len(tmp) - InStr(1, tmp, "("))
                seb = InStr(bunji_b, "|fffd||fffd|")
                If seb > 0 Then
                    s_b = Val(Left(bunji_b, seb - 1))
                    e_b = Val(Right(bunji_b, Len(bunji_b) - seb))
                    If bunji_a >= s_b And bunji_a <= e_b Then
                        Exit For
                    End If
                Else
                    If bunji_a = Val(bunji_b) Then Exit For
                End If
            Next
            End If
            If bldg = 1000 And a% > 1 Then X = 0: Exit Do
            If X > lastfind And lastfind > 1 Then
                bldg2 = 1: bldg = 0: lastfind = 0 ': r = r - 1
            End If
            
        End If
        If X > lastfind And lastfind <> 0 Then X = lastfind
        Worksheets("|fffd||fffd||fffd||fffd|").Activate
        If X = 0 And lastfind <> 0 Then
            xleng = Len(Addr(0))
            For i = xleng To 1 Step -1
                If Right(Addr(0), 1) > "9" Then
                    Exit For
                Else
                    Addr(0) = Left(Addr(0), Len(Addr(0)) - 1)
                End If
            Next
            '|fffd||fffd||fffd||9d7f| |fffd||67d||fffd| |e3||fffd||fffd|    '(0)|fffd||fffd| |e3||fffd||fffd| "|fffd||fffd||fffd||3b1||fffd|^|fffd||fffd||fffd||fffd|"
            a% = 0
            For X = 1 To zc
                If (InStr(memAddr(X), Addr(0)) > 0) Then
                    a% = a% + 1
                    m_arrZipCode(a%) = memAddr(X)
                    If a% = 10000 Then Exit For
                End If
            Next
            X = a%
            Range("D" & r).Select
            With Selection.Interior
                .ColorIndex = 6
                .Pattern = xlSolid
            End With
        End If
        If bldg2 = 0 Then Exit Do
    Loop
    End If
    If saseo = 1 Or bldg2 = 1 Then
    ElseIf X = 0 Or lastfind = 0 Then
        Range("D" & r).Select
        With Selection.Interior
            .ColorIndex = 6
            .Pattern = xlSolid
        End With
        Range("C" & r).ClearComments
        mis_count = mis_count + 1
    Else
        f_count = f_count + 1
        Range("C" & r).Value = Left(m_arrZipCode(X), 7)
        '******ZipFinder |fffd||5bc||fffd| |fffd||fffd||fffd|
        'Range("E" & r).Value = Right(m_arrZipCode(x), Len(m_arrZipCode(x)) - 8)
    End If
    If up = 1 Then
        Range("D" & r).Select
        With Selection.Interior
            .ColorIndex = 8
            .Pattern = xlSolid
        End With
    End If
'*****************************************************
'|e3||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||178| |fffd||67d||fffd| |e3||fffd||fffd| |fffd||fffd|
'*****************************************************
      
      Else
         Range("C" & r).Value = Left(m_arrZipCode(X), 7)
         '******ZipFinder |fffd||5bc||fffd| |fffd||fffd||fffd|
         'Range("E" & r).Value = Right(m_arrZipCode(x), Len(m_arrZipCode(x)) - 8)
         f_count = f_count + 1
      End If
      If up = 1 Then
         Range("D" & r).Select
         With Selection.Interior
            .ColorIndex = 8
            .Pattern = xlSolid
         End With
      End If
   End If
Loop

t_count = r - 2
f_count = t_count - mis_count
If f_count <> 0 Then success = Int(f_count / t_count * 1000 + 0.5) / 10

eTime = Time
t1 = Int((eTime - sTime) / (1 / 86400))
tm = Int(t1 / 60)
ts = t1 - tm * 60
th = Int(tm / 60)
tm = tm - th * 60
tdisp = Right(Str(100 + th), 2) & ":" & Right(Str(100 + tm), 2) & ":" & Right(Str(100 + ts), 2)
If mis_count = 0 Then
    MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||178| : " & t_count _
        & vbCr & vbCr & "|fffd||fffd||f3||fffd||fffd| |fffd||1fc||fffd| : " & mis_count _
        & vbCr & vbCr & "|fffd||fffd| |fffd||4bf||fffd||f0||fffd| : " & tdisp _
        & vbCr & vbCr & "|fffd||fffd||fffd||fffd||fffd||fffd||223| |fffd||2fb||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & success & "% |fffd||534||3f4||fffd|." _
        , vbOKOnly + vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||2fb||fffd||fffd||fffd||fffd|"
Else
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||223| |fffd||2fb||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & success & "% |fffd||534||3f4||fffd|." _
        & vbCr & vbCr & "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||178| : " & t_count _
        & vbCr & vbCr & "|fffd||fffd||f3||fffd||fffd| |fffd||1fc||fffd| : " & mis_count _
        & vbCr & vbCr & "|fffd||fffd| |fffd||4bf||fffd||f0||fffd| : " & tdisp _
        & vbCr & vbCr & "|fffd||fffd||f3||fffd||fffd||fffd||fffd| |fffd||5bc||4b8||fffd| |fffd||fffd||fffd||fffd||fffd||3f0||fffd| |fffd||67d||fffd| |fffd||fffd||fffd||fffd||fffd||3fd||f1||fffd| |fffd||676||fffd||fffd||3f4||fffd|.  " _
        & vbCr & vbCr & "* ZipTrans|fffd||fffd| 'C'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||5b4||fffd| |fffd||e38| |f3||fffd||fffd||fffd||574||3f4||fffd|." _
        , vbOKOnly + vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||2fb||fffd||fffd||fffd||fffd|"
End If
'Range("B2").Select
Exit Sub

ErrorHandler:
    Select Case Err
    Case Is = 53
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||fffd| |fffd||fffd||fffd||fffd||178||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||2bd||fffd||fffd||3f4||fffd|." & vbCr & vbCr _
        & "ZipFinder(|fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||2fb||fffd||fffd||fffd|)|fffd||fffd| |fffd||fffd||121||fffd||3fd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||3fc||fffd||fffd||fffd|." & vbCr & vbCr _
        & "|fffd||67f||fffd||7b4||fffd| |fffd||fffd| : http://www.postman.pe.kr", vbCritical, "|fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||fffd| |fffd||fffd||fffd||fffd|"
    Case Is = 9 And gulast > 234
        MsgBox "|fffd||fffd||fffd||3b1||5f7||fffd||fffd||fffd| |fffd||fffd||fffd||5f7||fffd||fffd||335||fffd| |fffd||1fe||fffd||fffd||fffd||fffd||3f4||fffd|." & vbCr & vbCr _
        & "|fffd||fffd| |fffd||fffd||fffd||3b1||5f7||fffd||fffd||fffd| |fffd||67f||fffd||7be||fffd| |fffd||fffd||fffd||fffd||3fd||f1||fffd| |fffd||676||fffd||fffd||3f4||fffd|. " & vbCr & vbCr _
        & "|fffd||67f||fffd||7b4||fffd| |fffd||fffd| : http://www.postman.pe.kr", vbCritical, "|fffd||fffd||fffd||5f7||fffd||fffd||335||fffd| |fffd||2f8||fffd|"
        Close #1
    Case Else
        MsgBox Error$(Err) + " " + Str(Err) & vbCr & vbCr _
        & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||7fb||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|(|fffd||5bc||fffd|)|fffd||fffd| |fffd||2f7||fffd||fffd||5bd||f8||fffd| |fffd||fffd||fffd||fffd||fffd||3f5||fffd||fffd||fffd| |fffd||3f0||6bd||fffd||fffd||3f4||fffd|." & vbCr & vbCr _
        & "|fffd||fffd||22d| : 0505-588-9900 (|fffd||fffd||fffd||fffd||fffd||fffd| |232||fffd||fffd||fffd||fffd|)" & vbCr & vbCr _
        & "|fffd||338||fffd||fffd||fffd| : ideaman@krpost.net", 48, "|fffd||fffd||fffd||fffd| |fffd||2f8||fffd|"
    End Select
End Sub

Function f_Bunji(ByVal r As Double) As Integer
'|fffd||fffd||fffd||fffd||e3||fffd||fffd|
            
Dim sFind, sFind2 As Double   '|e3||fffd||fffd| |fffd||fffd||fffd||fffd|, |223||fffd||fffd|
Dim st_bun, ed_bun, st_ho, ed_ho As Integer   '|e3||fffd||fffd| |fffd||fffd||fffd||fffd|, |223||fffd||fffd|
Dim san, gaji As Boolean
Dim st_bunji As String
Dim tmp As String

'lastfind = bldg: a% = 0
            
'|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3b8||fffd| |fffd||1f4||fffd|
If Left(Addr(4), 1) = "|fffd||fffd|" Then
    san = True: sFind = Val(Right(Addr(4), Len(Addr(4)) - 1))
Else
    san = False: sFind = Val(Addr(4))
End If
sFind2 = Val(Addr(5))   '|223|

For X = 1 To lastfind
    tmp = m_arrZipCode(X)
    '|fffd||fffd||fffd||fffd| |fffd||5b4||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||cfe1| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    If Addr(3) = "" Then
        tmp = Right(tmp, Len(tmp) - InStr(1, tmp, "^^") - 1)
    Else
        tmp = Right(tmp, Len(tmp) - InStr(1, tmp, "|fffd||fffd|^") - 1)
    End If
    
    If tmp <> "" Then
        notbunji = 1
        sepos = InStr(tmp, "-") '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        sepos2 = InStr(tmp, "|fffd||fffd|")
        Select Case sepos
        Case 0
            gaji = False
            If sepos2 = 0 Then
                st_bunji = tmp
                st_ho = 0
                ed_bun = 0
                ed_ho = 0
            Else    '1~10
                st_bunji = Left(tmp, sepos2 - 1)
                st_ho = 0
                ed_bun = Val(Right(tmp, Len(tmp) - sepos2))
                ed_ho = 0
            End If
        Case Else   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b4||fffd| |fffd||fffd||fffd|
            gaji = True
            If sepos2 = 0 Then  '1-(1)
                st_bunji = Left(tmp, sepos - 1)
                st_ho = Val(Mid(tmp, sepos + 2, InStr(tmp, ")") - sepos - 2))
                ed_bun = 0
                ed_ho = st_ho
            ElseIf sepos > sepos2 Then  '1~10-(1)
                st_bunji = Left(tmp, sepos2 - 1)
                st_ho = 0
                ed_bun = Val(Mid(tmp, sepos2 + 1, sepos - sepos2 - 1))
                ed_ho = Val(Mid(tmp, sepos + 2, InStr(tmp, ")") - sepos - 2))
            ElseIf InStr(tmp, ")") < sepos2 Then    '1-(1)~10
                st_bunji = Left(tmp, sepos - 1)
                st_ho = Val(Mid(tmp, sepos + 2, InStr(tmp, ")") - sepos - 2))
                ed_bun = Val(Mid(tmp, sepos2 + 1))
                ed_ho = 0
            ElseIf InStr(sepos2 + 1, tmp, "-") Then '1-(1)~10-(1)
                st_bunji = Left(tmp, sepos - 1)
                st_ho = Val(Mid(tmp, sepos + 2, InStr(tmp, ")") - sepos - 2))
                sepos = InStr(sepos2, tmp, "-")
                ed_bun = Val(Mid(tmp, sepos2 + 1, sepos - sepos2 - 1))
                ed_ho = Val(Mid(tmp, sepos + 2, InStr(tmp, ")") - sepos - 2))
            Else    '1-(1~10)
                st_bunji = Left(tmp, sepos - 1)
                st_ho = Val(Mid(tmp, sepos + 2, sepos2 - sepos - 2))
                ed_bun = 0
                ed_ho = Val(Mid(tmp, sepos2 + 1, InStr(tmp, ")") - sepos2 - 1))
            End If
        End Select
        
        
        If san = False And Left(st_bunji, 1) = "|fffd||fffd|" Then
        ElseIf san = True And Left(st_bunji, 1) <> "|fffd||fffd|" Then
        Else
            If Left(st_bunji, 1) = "|fffd||fffd|" Then
                st_bun = Val(Right(st_bunji, Len(st_bunji) - 1))
            Else
                st_bun = Val(st_bunji)
            End If
            If ed_bun = 0 Then ed_bun = st_bun
            
            '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3f1||fffd|
            If gaji Then    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||5b4||fffd| |fffd||fffd||fffd|
                If sFind >= st_bun And sFind <= ed_bun Then
                    If st_bun = ed_bun Then
                        If sFind2 >= st_ho And sFind2 <= ed_ho Then Exit For
                    Else
                        If ed_ho = 0 Then
                            If (sFind = st_bun And sFind2 >= st_ho) Or sFind > st_bun Then
                                Exit For
                            End If
                        ElseIf st_ho = 0 Then
                            If (sFind = ed_bun And sFind2 <= ed_ho) Or sFind < ed_bun Then
                                Exit For
                            End If
                        Else
                            If sFind = st_bun And sFind2 >= st_ho Then Exit For
                            If sFind = ed_bun And sFind2 <= ed_ho Then Exit For
                            If sFind > st_bun And sFind < ed_bun Then Exit For
                        End If
                    End If
                End If
            Else
                If sFind >= st_bun And sFind <= ed_bun Then
                    Exit For
                End If
            End If
        End If
    End If
Next
            
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||5bc||4b0||fffd| |fffd||fffd||fffd||fffd||fffd||3b5||fffd||fffd||fffd| |e3||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||478||fffd|
If notbunji = 1 And X > lastfind Then
    Range("D" & r).Select
    With Selection.Interior
        .ColorIndex = 45
        .Pattern = xlSolid
    End With
End If

f_Bunji = X
        
End Function
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Function Danji(ByVal sTarget As String, ByVal sFind As String) As String
    Dim P As Long, i As Integer
    P = InStr(sTarget, sFind)
    For i = P - 1 To 1 Step -1
        tmp = Mid(sTarget, i, 1)
        If tmp > "9" Then
            Exit For
        End If
    Next
    If i = P - 1 Then
        Danji = sTarget
    Else
        Danji = Left(sTarget, i) & Mid(sTarget, P + Len(sFind))
    End If
End Function

Function OldTranNew(ByVal sTarget As String) As String

    up = 1
    Select Case sTarget
    Case "|fffd||be||fffd||fffd|"
        OldTranNew = "|fffd||1bb||fffd||fffd|"
    Case "|fffd||fffd||fffd||5b1||fffd|"
        OldTranNew = "|fffd||fffd||fffd||5bd||fffd|"
    Case "|22d||fffd||fffd||fffd||fffd|"
        OldTranNew = "|22d||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd|", "|238||fffd||fffd||fffd||fffd|" ', "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||238||fffd||fffd||fffd||fffd|"
        OldTranNew = "|fffd||fffd||fffd||fffd||fffd|"
    Case Else
        OldTranNew = sTarget
        up = 0
    End Select

End Function

Function BldgRepl() As String
   If Right(Addr(2), 2) Like "#|223|" Then
   '|fffd||1f9||fffd||fffd||fffd||fffd||fffd| ##|223||fffd||fffd| |fffd||67f||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||438||fffd|
      For x1 = Len(Addr(2)) - 1 To 1 Step -1
         If Mid(Addr(2), x1, 1) > "9" Then
            Addr(2) = Left(Addr(2), x1)
            Exit For
         End If
      Next
   End If
    If Addr(0) = "|fffd||7f1||fffd|^|fffd||4b0||fffd|" Then
        If InStr(Addr(2), "|fffd||535||fffd||fffd||fffd||22d||fffd||fffd|") Or InStr(Addr(2), "|fffd||535||fffd||fffd||fffd||fffd||fffd|") Then
            BldgRepl = "|fffd||535||fffd|"
        Else
            BldgRepl = Addr(2)
        End If
    ElseIf InStr(Addr(2), "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then
        BldgRepl = Replace(1, Addr(2), "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    ElseIf InStr(Addr(2), "|fffd||fffd||fffd||33e||fffd|") Then
        BldgRepl = Replace(1, Addr(2), "|fffd||fffd||fffd||33e||fffd|", "")
    ElseIf InStr(Addr(2), "|fffd||1bb||fffd||fffd||fffd||730||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then
        BldgRepl = "|fffd||fffd||fffd||fffd||fffd||1bb||aeb4||fffd||fffd|"
    ElseIf InStr(Addr(2), "|fffd||b8||fffd||fffd||178||fffd||fffd|") Then
        BldgRepl = "|fffd||b8||fffd||fffd||fffd||fffd||fffd||1fa||fffd||fffd||fffd|"
    ElseIf InStr(Addr(2), "|fffd||fffd||3f5||fffd||fb|") Then
        BldgRepl = "|fffd||fffd||fffd||3f5||fffd||fffd||fffd||fb|"
    ElseIf InStr(Addr(0), "|fffd||178||fffd|") And Addr(2) = "|fffd||fffd||fffd||fffd||fffd||fffd||431||fffd|" Then
        BldgRepl = "|fffd||fffd||fffd||fffd||fffd||fffd||431||fffd|^"
    ElseIf InStr(Addr(2), "|fffd||fffd||fffd||fffd|") Then
        BldgRepl = Replace(1, Addr(2), "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb|")
    ElseIf InStr(Addr(2), "|fffd||479||438||fffd|") Then
        BldgRepl = Replace(1, Addr(2), "|fffd||479||438||fffd|", "|fffd||479||338||fffd|")
    ElseIf Left(Addr(2), 4) = "|fffd||471||fffd||fffd||fffd||fffd||fffd|" Then
        BldgRepl = Replace(1, Addr(2), "|fffd||471||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|")
    Else
        BldgRepl = Addr(2)
    End If
End Function

Function AptRepl(sTarget As String) As String
    '|fffd||1f9||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||22d| |fffd||fffd||1be|
    sTarget = StrConv(sTarget, 8)   '|fffd||fffd||fffd||6b9||fffd||fffd||6b8||fffd| |fffd||fffd||fffd||6b9||fffd||fffd||6b7||fffd| |fffd||fffd||22f|

    If InStr(sTarget, "APT.") Then
        AptRepl = Replace(1, sTarget, "APT.", "|fffd||fffd||fffd||fffd||1ae|")
    ElseIf InStr(sTarget, "A.P.T") Then
        AptRepl = Replace(1, sTarget, "A.P.T", "|fffd||fffd||fffd||fffd||1ae|")
    ElseIf InStr(sTarget, "APT") Then
        AptRepl = Replace(1, sTarget, "APT", "|fffd||fffd||fffd||fffd||1ae|")
    ElseIf InStr(sTarget, "A ") Then
        AptRepl = Replace(1, sTarget, "A ", "|fffd||fffd||fffd||fffd||1ae| ")
    ElseIf InStr(sTarget, "BLDG.") Then
        AptRepl = Replace(1, sTarget, "BLDG.", "|fffd||fffd||fffd||fffd|")
    ElseIf InStr(sTarget, "BLDG") > 0 Then
        AptRepl = Replace(1, sTarget, "BLDG", "|fffd||fffd||fffd||fffd|")
    ElseIf InStr(sTarget, "B/D") > 0 Then
        AptRepl = Replace(1, sTarget, "B/D", "|fffd||fffd||fffd||fffd|")
    ElseIf InStr(sTarget, "@") > 0 Then
        AptRepl = Replace(1, sTarget, "@", "|fffd||fffd||fffd||fffd||1ae|")
    ElseIf InStr(sTarget, "|fffd||479||438||fffd|") Then
        AptRepl = Replace(1, sTarget, "|fffd||479||438||fffd|", "|fffd||479||338||fffd|")
    ElseIf InStr(sTarget, "(|fffd||fffd|)") Then
        AptRepl = Replace(1, sTarget, "(|fffd||fffd|)", "|fffd||fffd||fffd||fffd||1ae|")
    Else
        AptRepl = sTarget
    End If

    If InStr(AptRepl, "|fffd||230||fffd||fffd||335||fffd|") Then
        AptRepl = Replace(1, AptRepl, "|fffd||230||fffd||fffd||335||fffd|", "|fffd||230||fffd|2|fffd||fffd|")
    ElseIf InStr(AptRepl, "|fffd||230||fffd||fffd||3f5||fffd|") Then
        AptRepl = Replace(1, AptRepl, "|fffd||230||fffd||fffd||3f5||fffd|", "|fffd||230||fffd|1|fffd||fffd|")
    ElseIf InStr(AptRepl, "|fffd||5b7||fffd|") Then
        AptRepl = Replace(1, AptRepl, "|fffd||5b7||fffd|", "|fffd||5bf||fffd|")
    End If
    If InStr(AptRepl, "|fffd||fffd||178|") Then
        AptRepl = Replace(1, AptRepl, "|fffd||fffd||178|", "|fffd||fffd||fffd||fffd|")
    ElseIf InStr(AptRepl, "|fffd||fffd||178|") Then
        AptRepl = Replace(1, AptRepl, "|fffd||fffd||178|", "|fffd||fffd||fffd||fffd|")
    ElseIf InStr(AptRepl, "|fffd||fffd||fffd||fffd|") Then
        AptRepl = Replace(1, AptRepl, "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|")
    End If
    If InStr(AptRepl, "(") Then
      If Mid(AptRepl, InStr(AptRepl, "(") + 1, 1) > "9" Then
        AptRepl = Replace(1, AptRepl, "(", " ")
      End If
    End If
End Function
    
Function CompDong(dong As String)
   '|fffd||fffd||fffd||fffd||fffd| |fffd||f1||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||2fb||fffd|
   Dim strTemp As String
   strTemp = Mid(m_arrZipCode(1), 9, InStr(12, m_arrZipCode(1), "^") - 7)
   For x1 = 1 To lastfind
      If InStr(m_arrZipCode(x1), strTemp) = 0 Then
         CompDong = 0: lastfind = 0
         Exit Function
      End If
   Next
   CompDong = lastfind
End Function
    



Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CB5, 8, 4, MSForms, CommandButton"
Attribute VB_Control = "CB2, 9, 5, MSForms, CommandButton"
Attribute VB_Control = "CB1, 10, 6, MSForms, CommandButton"
Attribute VB_Control = "CB3, 11, 7, MSForms, CommandButton"
Attribute VB_Control = "CB4, 12, 8, MSForms, CommandButton"


Private Sub CB1_Click()
    Call |fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||6b5||fffd||fffd||2fb||fffd|
End Sub

Private Sub CB2_Click()
    Worksheets("|fffd||fffd||fffd||fffd|").Activate
    ActiveSheet.Columns("C:C").Select
    Selection.Replace What:="-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False
    ActiveSheet.Range("C2").Select
End Sub

Private Sub CB3_Click()
'|fffd||5bc||fffd||fffd||fffd||fffd||3fa||4b7||fffd||fffd||fffd||fffd||fffd|
Dim fName As Variant
Dim sFilter As String
Dim sTitle As String

sFilter = "|fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd||fffd||5bc||fffd||fffd||fffd||fffd||fffd| (*.txt),*.txt"
sTitle = "|fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd| |fffd||5bc||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"

fName = Application.GetOpenFilename(FileFilter:=sFilter, Title:=sTitle)
If fName <> False Then
   Worksheets("|fffd||fffd||fffd||fffd|").Activate
   ActiveSheet.UsedRange.Select
   r = Selection.Rows.Count
   If r > 1 Then ActiveSheet.Rows("2:" & r).Delete
   ActiveSheet.Range("A2").Select
   
   'ZipFinder |fffd||fffd||fffd||fffd||fffd||fffd||223| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||178||fffd||fffd| |fffd||7b8||38bbf||fffd| |fffd||3b5||fffd|
   Open fName For Input As #1
   r = 1
   Do Until EOF(1)
      Line Input #1, strTemp
      r = r + 1
      
      sepos = InStr(strTemp, "|")  '|fffd||fffd||fffd||fffd||178||fffd||fffd| "\"|fffd||fffd||fffd||6b7||fffd| |fffd||438||fffd|
      If sepos = 0 Then
         strTmp1 = ""
         strTmp2 = ""
         strTmp3 = strTemp
      Else
         strTmp1 = Trim(Left(strTemp, sepos - 1))
         strTmp2 = Trim(Mid(strTemp, sepos + 1))
         sepos = InStr(strTmp2, "|")  '|fffd||fffd||fffd||fffd||178||fffd||fffd| "\"|fffd||fffd||fffd||6b7||fffd| |fffd||438||fffd|
         If sepos = 0 Then
            strTmp1 = ""
            strTmp2 = ""
            strTmp3 = strTemp
         Else
            strTmp3 = Trim(Mid(strTmp2, sepos + 1))
            strTmp2 = Trim(Left(strTmp2, sepos - 1))
         End If
      End If
      With ActiveSheet
         .Range("A" & r).Value = strTmp1
         .Range("C" & r).Value = strTmp2
         .Range("D" & r).Value = strTmp3
      End With
   Loop
   Close #1
End If
End Sub

Private Sub CB4_Click()
'|fffd||5bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim fName As Variant
Dim sFilter As String
Dim sTitle As String
Dim fExt, fEnd As Integer

UserForm1.Show
If UserValue = -1 Then Exit Sub
sFilter = "|fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (*.txt),*.txt"
sTitle = "|fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd| |fffd||5bc||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"

fName = Application.GetSaveAsFilename(InitialFilename:="", FileFilter:=sFilter, Title:=sTitle)
If fName <> False Then
'   For r = Len(fName) To 1 Step -1
'      strTemp = Mid(fName, r, 1)
'      If strTemp = "\" Then
'         fDir = Left(fName, r)
         fDir = Left(fName, Len(fName) - 4)
'         Exit For
'      End If
'   Next
'   Call CB1_Click
   Worksheets("|fffd||fffd||fffd||fffd|").Activate
   r = 1: fExt = 1
   Do
      fName = fDir + Right(Str(100 + fExt), 2) + ".txt"
      c = 0
      Open fName For Output As #1
      Do
         r = r + 1
         strTmp1 = ActiveSheet.Range("A" & r).Value
         strTmp2 = ActiveSheet.Range("B" & r).Value
         strTmp3 = ActiveSheet.Range("C" & r).Value
         strTmp4 = ActiveSheet.Range("D" & r).Value
         strTmp5 = ActiveSheet.Range("E" & r).Value
      
         If strTmp1 = "" Or strTmp3 = "" Or strTmp4 = "" Then
            fEnd = 1
            Exit Do
         End If
         strTmp1 = Trim(strTmp1 & " " & strTmp2)
         strTmp4 = Trim(strTmp4 & " " & strTmp5)
         
         strTemp = strTmp1 & "|" & strTmp3 & "|" & strTmp4
         Print #1, strTemp
         c = c + 1
         If UserValue <> 0 And c = UserValue Then Exit Do
      Loop
      Close #1
      If c = 0 Then
         Kill fName
         fExt = fExt - 1
         Exit Do
      End If
      If fEnd = 1 Then Exit Do
      fExt = fExt + 1
   Loop
   ActiveSheet.Range("C" & r).Select
   MsgBox fExt & "|fffd||fffd||fffd||fffd| |fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd| |fffd||5bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||6fc||fffd||fffd||3ff||fffd||fffd||fffd||fffd||3f4||fffd|." _
        , vbOKOnly + vbInformation, "|fffd||5bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f7||fffd|"

Else
   MsgBox "|fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd| |fffd||5bc||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||3f4||fffd|." _
        , vbOKOnly + vbInformation, "|fffd||5bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If
End Sub

Private Sub CB5_Click()
   '|fffd||fffd||1bc||13f| |fffd||3bc||fffd|
   Dim Page1, Page2, i, j, last As Integer
   Dim FoundCell As Variant
   Dim stAddress As String
   Dim NoExchanges, st, ed As Integer
   
   Worksheets("|fffd||fffd||fffd||fffd|").Activate
   If ActiveSheet.Range("C2").Value = "" Then
      myBtn = MsgBox("|fffd||3bc||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||370||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|." & Chr(13) & "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||223||fffd||fffd| |fffd||2fb||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||3fd||2bd||ff||fffd|.", vbExclamation, "|fffd||fffd||1bc||13f||fffd||3bc||fffd| |fffd||fffd||fffd||fffd|")
      Exit Sub
   Else
      ActiveSheet.Range("C1").Select
      Selection.End(xlDown).Select
      EndRow = ActiveCell.Row
   End If
   
   Worksheets("|fffd||3bc||fffd||fffd||fffd|").Activate
   With ActiveSheet
      .Range("A1").Select
      Set FoundCell = .Cells.Find(What:="|fffd||fffd|", LookAt:=xlPart)
      If FoundCell Is Nothing Then
         MsgBox "|fffd||634||fffd||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."
         Worksheets("|fffd||7b4||fffd|").Activate
         End
      Else
         .Cells.FindNext(After:=ActiveCell).Activate
         stAddress = ActiveCell.Address
         i = 1
         paper(i) = ActiveCell.Value
         Do While i < 20
            .Cells.FindNext(After:=ActiveCell).Activate
            If ActiveCell.Address = stAddress Then Exit Do
            i = i + 1
            paper(i) = ActiveCell.Value
         Loop
         last = i
      End If
   End With
   
   Do
      NoExchanges = True
      ' Loop through each element in the array.
      For i = 1 To UBound(paper) - 1

                  ' If the element is greater than the element
                  ' following it, exchange the two elements.
         If paper(i) = paper(i + 1) Then paper(i + 1) = ""
         If paper(i) = "" And paper(i + 1) <> "" Then
               NoExchanges = False
               iTemp = paper(i)
               paper(i) = paper(i + 1)
               paper(i + 1) = iTemp
         ElseIf paper(i) > paper(i + 1) Then
            If paper(i + 1) <> "" Then
               NoExchanges = False
               iTemp = paper(i)
               paper(i) = paper(i + 1)
               paper(i + 1) = iTemp
            End If
         End If
      Next i
   Loop While Not (NoExchanges)
   
   
   Worksheets("|fffd||7b4||fffd|").Activate
   UserForm2.Show
   
   If UserValue = -1 Then Exit Sub
   Page1 = Val(UserForm2.TextBox1.Value)
   Page2 = Val(UserForm2.TextBox2.Value)
   If Page1 = 0 Then Exit Sub
   PageMargin = UserForm2.TextBox3.Value
   
   If UserForm2.OptionButton7.Value = True Then
      PaperForm = 1
      PaperName = "|fffd||fffd||fffd||fffd|"
      cStep = 1
      rStep = 1
   Else
      PaperForm = Val(Left(UserForm2.ComboBox2.Value, InStr(UserForm2.ComboBox2.Value, "|fffd||fffd|") - 1))
      PaperName = Mid(UserForm2.ComboBox2.Value, InStr(UserForm2.ComboBox2.Value, "(") + 1)
      PaperName = Left(PaperName, Len(PaperName) - 1)
      cStep = Val(Left(PaperName, InStr(PaperName, "|fffd||fffd|") - 1))
      rStep = Val(Mid(PaperName, InStr(PaperName, "|fffd||fffd|") + 1))
   End If
   r = Page1 * PaperForm - PaperForm + 2
   Endr = Page2 * PaperForm + 1
   If UserForm2.ComboBox1.ListIndex < 0 Then
      Sir = UserForm2.ComboBox1.Text
   Else
      Sir = UserForm2.ComboBox1.List(UserForm2.ComboBox1.ListIndex)
      If Sir = "|fffd||fffd||fffd||fffd|" Then Sir = ""
   End If
   If UserForm2.CB1.Value = True Then
      fNameSep = 1
   Else
      fNameSep = 0
   End If
   
   Worksheets("|fffd||fffd||1bc||13f|").Visible = -1
   Worksheets("|fffd||fffd||1bc||13f|").Activate
   With ActiveSheet
      .UsedRange.Select
      Application.CutCopyMode = False
      With Selection
         .WrapText = False
         .Orientation = 0
         .AddIndent = False
         .ShrinkToFit = False
         .MergeCells = False
      End With
   End With
   
   Worksheets("|fffd||3bc||fffd||fffd||fffd|").Activate
   With ActiveSheet
      If UserForm2.OptionButton7.Value = True Then
         .Range("B7").Value = PageMargin
         .Range("B2").Value = "3"
      ElseIf UserForm2.OptionButton1.Value = True Then
         .Range("B1").Value = PageMargin
         .Range("B2").Value = "1"
      Else
         .Range("B1").Value = PageMargin
         .Range("B2").Value = "2"
      End If
      '.Range("B2").Value = UserForm2.OptionButton1.Value
      .Range("B3").Value = UserForm2.ComboBox2.ListIndex
      .Range("B4").Value = UserForm2.ComboBox1.ListIndex
      .Range("B5").Value = UserForm2.CB1.Value
      .Range("B6").Value = UserForm2.CB2.Value
      If .Range("B4").Value < 0 Then .Range("B4").Value = 0
      Set FoundCell = .Cells.Find(What:=PaperName, LookAt:=xlWhole)
      If FoundCell Is Nothing Then
         MsgBox "|fffd||634||fffd||fffd||3f4||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||3f4||fffd|."
         End
      Else
         .Cells.FindNext(After:=ActiveCell).Activate
         fr1 = ActiveCell.Row
         fc1 = ActiveCell.Column
         .Cells.FindNext(After:=ActiveCell).Activate
         fr2 = ActiveCell.Row
         fc2 = ActiveCell.Column
         If fr2 < fr1 Then
            fr3 = fr2: fr2 = fr1: fr1 = fr3
            fc3 = fc2: fc2 = fc1: fc1 = fc3
         End If
      End If
   End With
   
   ActiveSheet.Range(ActiveSheet.Cells(fr1, fc1), ActiveSheet.Cells(fr2, fc2)).Select
   Selection.Copy
   
   Worksheets("|fffd||fffd||1bc||13f|").Activate
With ActiveSheet
  
   .Range("A1").Select
   .Paste
   
   If UserForm2.OptionButton1.Value = False Then
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeLeft).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   End If
   
   Selection.Copy
   cGap = fc2 - fc1 + 1
   rGap = fr2 - fr1 + 1
   
   For i = 1 To rGap
      For j = 1 To cGap
         Select Case ActiveSheet.Cells(i, j).Value
         Case "|fffd||fffd||fffd||fffd|"
            rName = i: cName = j
         Case "|fffd||5bc||fffd|1"
            rAddr1 = i: cAddr1 = j
         Case "|fffd||5bc||fffd|2"
            rAddr2 = i: cAddr2 = j
         Case "|fffd||5bc||fffd|1+|fffd||5bc||fffd|2"
            rAddr = i: cAddr = j
         Case "zipcode"
            rCode = i: cCode = j
         Case "|fffd||fffd||fffd||fffd||fffd||fffd||223|"
            rRegNum = i: cRegNum = j
         Case Else
         End Select
      Next
   Next
   
   If UserForm2.OptionButton7.Value = False Then
      For i = 1 To rGap
         For j = 1 To cGap
            Select Case ActiveSheet.Cells(i, j).Value
            Case "|fffd||7fd||fffd||fffd||fffd|"
               ActiveSheet.Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B8").Value
            Case "|fffd||7fd||fffd||fffd||5bc||fffd|1"
               ActiveSheet.Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B9").Value
            Case "|fffd||7fd||fffd||fffd||5bc||fffd|2"
               ActiveSheet.Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B10").Value
            Case "|fffd||7fd||fffd||fffd||5bc||fffd|1+|fffd||7fd||fffd||fffd||5bc||fffd|2"
               ActiveSheet.Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B9").Value _
               & " " & Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B10").Value
            Case "zipcode1"
               fCode = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B11").Value
               ActiveSheet.Cells(i, j).Value = Left(fCode, 1)
               ActiveSheet.Cells(i, j + 2).Value = Mid(fCode, 2, 1)
               ActiveSheet.Cells(i, j + 4).Value = Mid(fCode, 3, 1)
               fCode1 = Right(fCode, 3)
               ActiveSheet.Cells(i, j + 6).Value = Left(fCode1, 1)
               ActiveSheet.Cells(i, j + 8).Value = Mid(fCode1, 2, 1)
               ActiveSheet.Cells(i, j + 10).Value = Right(fCode1, 1)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||223|1"
               ActiveSheet.Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B12").Value
            Case Else
            End Select
         Next
      Next
   End If
   
   For i = 2 To cStep
      .Cells(1, ((i - 1) * cGap + 1)).Select
      .Paste
   Next
   
   j = 0
   For i = fr1 To fr2
      j = j + 1
      .Rows(j).RowHeight = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Rows(i).RowHeight
   Next
   j = 0
   For i = fc1 To fc2
      j = j + 1
      .Columns(j).ColumnWidth = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Columns(i).ColumnWidth
   Next
   
   .Rows("1:" & rGap).Select
   Selection.Copy
   For i = 2 To rStep
      .Range("A" & ((i - 1) * rGap + 1)).Select
      .Paste
   Next
   
   For i = 2 To cStep
      For j = 1 To cGap
         .Columns(j + (i - 1) * cGap).ColumnWidth = .Columns(j).ColumnWidth
      Next
   Next

   If UserForm2.OptionButton7.Value = True Then
      For i = 1 To rGap
         For j = 1 To cGap
            Select Case ActiveSheet.Cells(i, j).Value
            Case "|fffd||7fd||fffd||fffd||fffd|"
               .Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B8").Value
            Case "|fffd||7fd||fffd||fffd||5bc||fffd|1"
               .Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B9").Value
            Case "|fffd||7fd||fffd||fffd||5bc||fffd|2"
               .Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B10").Value
            Case "|fffd||7fd||fffd||fffd||5bc||fffd|1+|fffd||7fd||fffd||fffd||5bc||fffd|2"
               .Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B9").Value _
               & " " & Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B10").Value
            Case "zipcode1"
               fCode = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B11").Value
               .Cells(i, j).Value = Left(fCode, 1)
               .Cells(i, j + 2).Value = Mid(fCode, 2, 1)
               .Cells(i, j + 4).Value = Mid(fCode, 3, 1)
               fCode1 = Right(fCode, 3)
               .Cells(i, j + 6).Value = Left(fCode1, 1)
               .Cells(i, j + 8).Value = Mid(fCode1, 2, 1)
               .Cells(i, j + 10).Value = Right(fCode1, 1)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||223|1"
               .Cells(i, j).Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B12").Value
            Case Else
            End Select
         Next
      Next
      .Cells(1, 1).Value = ""
      .Cells(rGap, cGap).Value = ""
      
   Else
      ActiveSheet.Cells.Select
      Selection.ClearContents
   End If

End With
   
   Worksheets("|fffd||7b4||fffd|").Activate
   If UserForm2.OptionButton8.Value = True Then
      fName = Trim(Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B8").Value)
      fCode = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B11").Value
      fAddr1 = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B9").Value
      fAddr2 = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B10").Value
      fRegNum = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B12").Value
      Sir = ""
   End If
   r2 = 0
   Do
      If UserForm2.OptionButton8.Value = False Then
         fName = Trim(Worksheets("|fffd||fffd||fffd||fffd|").Range("A" & r).Value)
         If fNameSep = 1 Then
            strTemp = ""
            For i = 1 To Len(fName)
               strTemp = strTemp + Mid(fName, i, 1) + " "
            Next
            fName = strTemp
         End If
         If UserForm2.CB2.Value = True Then
            fName = fName + " " + Worksheets("|fffd||fffd||fffd||fffd|").Range("B" & r).Value
         End If
         fCode = Worksheets("|fffd||fffd||fffd||fffd|").Range("C" & r).Value
         fAddr1 = Worksheets("|fffd||fffd||fffd||fffd|").Range("D" & r).Value
         fAddr2 = Worksheets("|fffd||fffd||fffd||fffd|").Range("E" & r).Value
         fRegNum = Worksheets("|fffd||fffd||fffd||fffd|").Range("F" & r).Value
      End If
      If fCode = "" Then
         fEnd = 1
      Else
         rc = ((r - 1 + cStep) Mod cStep) - 1
         If rc < 0 Then rc = cStep - 1
         With Worksheets("|fffd||fffd||1bc||13f|")
            .Cells(r2 + rName, rc * cGap + cName).Value = fName + "  " + Sir
            If rAddr1 <> 0 Then .Cells(r2 + rAddr1, rc * cGap + cAddr1).Value = fAddr1
            If rAddr2 <> 0 Then .Cells(r2 + rAddr2, rc * cGap + cAddr2).Value = fAddr2
            If rAddr <> 0 Then .Cells(r2 + rAddr, rc * cGap + cAddr).Value = Trim(fAddr1 + " " + fAddr2)
            If UserForm2.OptionButton7.Value = True Then
               .Cells(r2 + rCode, rc * cGap + cCode).Value = Left(fCode, 1)
               .Cells(r2 + rCode, rc * cGap + cCode + 2).Value = Mid(fCode, 2, 1)
               .Cells(r2 + rCode, rc * cGap + cCode + 4).Value = Mid(fCode, 3, 1)
               fCode1 = Right(fCode, 3)
               .Cells(r2 + rCode, rc * cGap + cCode + 6).Value = Left(fCode1, 1)
               .Cells(r2 + rCode, rc * cGap + cCode + 8).Value = Mid(fCode1, 2, 1)
               .Cells(r2 + rCode, rc * cGap + cCode + 10).Value = Right(fCode1, 1)
            Else
               Code1 = Left(fCode, 1) & " " & Mid(fCode, 2, 1) & " " & Mid(fCode, 3, 1) & " - "
               fCode1 = Right(fCode, 3)
               .Cells(r2 + rCode, rc * cGap + cCode).Value = Code1 & Left(fCode1, 1) & " " & Mid(fCode1, 2, 1) & " " & Right(fCode1, 1)
            End If
            If rRegNum <> 0 Then .Cells(r2 + rRegNum, rc * cGap + cRegNum).Value = fRegNum
         End With
         If rc = (cStep - 1) Then r2 = r2 + rGap
      End If
      If (r - 1) Mod PaperForm = 0 Or fEnd = 1 Then
         With Worksheets("|fffd||fffd||1bc||13f|")
            .PageSetup.TopMargin = Application.InchesToPoints(PageMargin)
            .Range(.Cells(1, 1), .Cells(rStep * rGap, cStep * cGap)).PrintOut Copies:=1, Collate:=True
            If UserForm2.OptionButton7.Value = False Then
               .Range(.Cells(1, 1), .Cells(rStep * rGap, cStep * cGap)).Value = ""
            End If
         End With
         r2 = 0
         Page1 = Page1 + 1
         If Page1 > Page2 Then Exit Do
      End If
      r = r + 1
   Loop
   Worksheets("|fffd||fffd||1bc||13f|").Visible = 0
End Sub

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{04435FF4-0152-11D8-B005-0050FC3BFD7C}{04435FE2-0152-11D8-B005-0050FC3BFD7C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit

Private Sub CommandButton1_Click()
'Dim fName As Variant
'Dim sFilter As String
'Dim sTitle As String
'Dim strTmp1, strTmp2, strTmp3, strTmp4, strTemp As String
'Dim r As Double
   
   UserValue = Val(UserForm1.TextBox1.Value)
   UserForm1.Hide

End Sub

Private Sub CommandButton2_Click()
   UserForm1.Hide
   UserValue = -1
   MsgBox "|fffd||fffd||fc||fffd||fffd||fffd||fffd||fffd||6bf||fffd||fffd||fffd||fffd||fffd| |fffd||5bc||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||3ff||fffd||fffd||fffd||fffd||3f4||fffd|." _
        , vbOKOnly + vbInformation, "|fffd||5bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Private Sub UserForm_Click()

End Sub

Private Sub UserForm_Terminate()
   Call CommandButton2_Click
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{04435FF8-0152-11D8-B005-0050FC3BFD7C}{04435FEA-0152-11D8-B005-0050FC3BFD7C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit

Private Sub UserForm_Initialize()
   Dim PaperForm, i, st, ed, CB2 As Integer
   Dim iTemp As String
   
   i = 1
   UserForm2.ComboBox2.Clear
   Do While paper(i) <> ""
      st = Val(Left(paper(i), InStr(paper(i), "|fffd||fffd|") - 1))
      ed = Val(Right(paper(i), Len(paper(i)) - InStr(paper(i), "|fffd||fffd|")))
      iTemp = Trim(Str(st * ed) & "|fffd||17f||fffd| (" & paper(i)) & ")"
      UserForm2.ComboBox2.AddItem iTemp
      i = i + 1
   Loop
   
   CB2 = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B3").Value
   If CB2 > i - 2 Then CB2 = 0
   UserForm2.ComboBox2.ListIndex = CB2

   PaperForm = Val(Left(UserForm2.ComboBox2.Value, InStr(UserForm2.ComboBox2.Value, "|fffd||fffd|") - 1))
   
   UserForm2.TextBox1.Value = 1
   UserForm2.TextBox2.Value = Int((EndRow + PaperForm - 2) / PaperForm)
   UserForm2.TextBox3.Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B1").Value
   Select Case Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B2").Value
   Case "1"
      UserForm2.OptionButton1.Value = True
      UserForm2.OptionButton1.SetFocus
   Case "2"
      UserForm2.OptionButton2.Value = True
      UserForm2.OptionButton2.SetFocus
   Case "3"
      UserForm2.OptionButton7.Value = True
      UserForm2.OptionButton7.SetFocus
   End Select
   UserForm2.OptionButton9.Value = True
   
   UserForm2.ComboBox1.Clear
   UserForm2.ComboBox1.AddItem "|fffd||fffd||fffd||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||fffd||fffd||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||fffd||fffd||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||37f||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||532||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||fffd||fffd||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
   UserForm2.ComboBox1.AddItem "|fffd||fffd||fffd||fffd|"
   UserForm2.ComboBox1.ListIndex = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B4").Value
   UserForm2.CB1.Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B5").Value
   UserForm2.CB2.Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B6").Value
End Sub

Private Sub ComboBox1_Change()

End Sub

Private Sub ComboBox2_Change()
   Dim PaperForm As Integer
   PaperForm = Val(Left(UserForm2.ComboBox2.Value, InStr(UserForm2.ComboBox2.Value, "|fffd||fffd|") - 1))
   UserForm2.TextBox1.Value = 1
   UserForm2.TextBox2.Value = Int((EndRow + PaperForm - 2) / PaperForm)
End Sub

Private Sub CommandButton1_Click()
   If UserForm2.OptionButton5 = True Then
      UserForm2.TextBox1.Value = 1
      'UserForm2.TextBox2.Value = Int((EndRow + 14) / 16)
   End If
   UserForm2.Hide
   UserValue = 1
End Sub

Private Sub CommandButton2_Click()
   UserForm2.Hide
   UserValue = -1
End Sub

Private Sub OptionButton3_Enter()
   UserForm2.TextBox2.Value = Int((EndRow + 14) / 16)
End Sub

Private Sub OptionButton4_Enter()
   UserForm2.TextBox2.Value = Int((EndRow + 14) / 14)
End Sub

Private Sub Frame5_Click()

End Sub

Private Sub OptionButton1_Click()

End Sub

Private Sub OptionButton2_Click()

End Sub

Private Sub OptionButton5_Click()
   Dim PaperForm As Integer
   PaperForm = Val(Left(UserForm2.ComboBox2.Value, InStr(UserForm2.ComboBox2.Value, "|fffd||fffd|") - 1))
   UserForm2.TextBox1.Value = 1
   UserForm2.TextBox2.Value = Int((EndRow + PaperForm - 2) / PaperForm)
End Sub

Private Sub OptionButton7_Change()
   Dim PaperForm As Integer
   If UserForm2.OptionButton7.Value = True Then
      UserForm2.Frame6.Enabled = False
      UserForm2.OptionButton8.Enabled = False
      UserForm2.OptionButton9.Enabled = False
      UserForm2.ComboBox2.Enabled = False
      UserForm2.TextBox3.Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B7").Value
      PaperForm = 1
      UserForm2.TextBox1.Value = 1
      UserForm2.TextBox2.Value = Int((EndRow + PaperForm - 2) / PaperForm)
   Else
      UserForm2.Frame6.Enabled = True
      UserForm2.OptionButton8.Enabled = True
      UserForm2.OptionButton9.Enabled = True
      UserForm2.ComboBox2.Enabled = True
      UserForm2.TextBox3.Value = Worksheets("|fffd||3bc||fffd||fffd||fffd|").Range("B1").Value
      PaperForm = Val(Left(UserForm2.ComboBox2.Value, InStr(UserForm2.ComboBox2.Value, "|fffd||fffd|") - 1))
      UserForm2.TextBox2.Value = Int((EndRow + PaperForm - 2) / PaperForm)
   End If
End Sub

Private Sub TextBox1_Enter()
   OptionButton6.Value = True
End Sub

Private Sub TextBox2_Enter()
   OptionButton6.Value = True
End Sub

Private Sub UserForm_Terminate()
   Call CommandButton2_Click
End Sub


INQUEST-PP=macro
