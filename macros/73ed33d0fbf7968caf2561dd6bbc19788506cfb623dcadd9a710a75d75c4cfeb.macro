Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then
        ClearCells ' greyed out cells
        Exit Sub
    End If

    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        
        ActiveSheet.Unprotect Password:="Password"
        
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            'Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            ' use exact color match instead
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.Color = Range(Target.Cells(1).Offset(-1, index).Address).Interior.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            ' Update Sequence (row count)
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            ' Insert formula by filling-down:
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "formula") = 0 Then
                Target.Cells(1).Offset(-4, index).FillDown
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        
        UpdateRowCounts
        
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        
        ' Get the string value above the "Delete Row" button
        Dim sDeleteRowAction As String
        sDeleteRowAction = Target.Cells(1).Offset(-1, 0).Value
        sDeleteRowAction = Range("A" & ActiveCell.Row - 1).Value

        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub ' does not work. replaced with below:
        If StrComp(sDeleteRowAction, "___Multiple_Row_Start___") = 0 Then Exit Sub ' prevent first row being deleted
        
        ActiveSheet.Unprotect Password:="Password"
        
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        
        UpdateRowCounts
        
        ActiveSheet.Protect Password:="Password"
    End If

End Sub
Private Sub UpdateRowCounts()

    Dim Ref1 As String
    Dim Ref2 As String
    Dim Ref3 As String
    
    Dim Count1 As Integer
    Dim Count2 As Integer
    Dim Count3 As Integer
    
    ' Find "Add Row" buttons (3 rows below the hidden "___Multiple_Row___")
    Ref1 = ActiveWorkbook.Worksheets("Standing Data").Columns(1).Find("___Multiple_Row___").Offset(3, 0).Address
    Ref2 = ActiveWorkbook.Worksheets("Standing Data").Columns(1).Find("___Multiple_Row___", After:=Range(Ref1)).Offset(3, 0).Address
    Ref3 = ActiveWorkbook.Worksheets("Standing Data").Columns(1).Find("___Multiple_Row___", After:=Range(Ref2)).Offset(3, 0).Address
    
    ' Set the parameters to the Sequence number (i.e. the Row Count)
    Count1 = Range(Ref1).Offset(-4, 0).Value
    Count2 = Range(Ref2).Offset(-4, 0).Value
    Count3 = Range(Ref3).Offset(-4, 0).Value
    
    ' Update the spreadsheet with the parameter values
    ActiveWorkbook.Worksheets("results").Range("CountFeederFunds").Value = Count1
    ActiveWorkbook.Worksheets("results").Range("CountSubFunds").Value = Count2
    ActiveWorkbook.Worksheets("results").Range("CountOperators").Value = Count3
        
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Range("Q1.3")) Is Nothing Then
        ClearCells
        Exit Sub
    End If
    
    If Not Intersect(Target, Range("Q1.3.1")) Is Nothing Then
        ClearCells
        Exit Sub
    End If
End Sub
Private Sub ClearCells()
    If ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3").Value <> "Multi-Fund" Then
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.16").ClearContents
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.17").ClearContents
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.18i").ClearContents
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.18ii").ClearContents
    End If
    
    If ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.1").Value <> "Master Fund" Then
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.2").ClearContents
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.3").ClearContents
    End If
    
    If ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.1").Value <> "Feeder Fund" Then
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.10").ClearContents
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.11").ClearContents
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.12").ClearContents
    End If
    
    If ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3").Value = "Multi-Fund" Then
        UpdateMultiFundDetails
    End If

End Sub
Private Sub UpdateMultiFundDetails()
    If ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3").Value = "Multi-Fund" Then
        'ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.16").Value = 1 'removed as per request from ISD
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.17").Value = 1
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.18i").Value = ActiveWorkbook.Worksheets("Standing Data").Range("Q1.1").Value
        ActiveWorkbook.Worksheets("Standing Data").Range("Q1.3.18ii").Value = "Yes"
    End If
End Sub
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            'Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            ' use exact color match instead
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.Color = Range(Target.Cells(1).Offset(-1, index).Address).Interior.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            ' Update Sequence (row count)
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            ' Insert formula by filling-down:
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "formula") = 0 Then
                Target.Cells(1).Offset(-4, index).FillDown
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        
        ' Get the string value above the "Delete Row" button
        Dim sDeleteRowAction As String
        sDeleteRowAction = Target.Cells(1).Offset(-1, 0).Value
        sDeleteRowAction = Range("A" & ActiveCell.Row - 1).Value ' get value in first column of current row

        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub ' does not work. replaced with below:
        If StrComp(sDeleteRowAction, "___Multiple_Row_Start___") = 0 Then Exit Sub ' prevent first row being deleted

        ActiveSheet.Unprotect Password:="Password"
        
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        
        Range(Target.Cells(1).Address).EntireRow.Delete
        
        ActiveSheet.Protect Password:="Password"
        
    End If
End Sub


Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub worksheet_selectionchange(ByVal Target As Range)
    If Target.Cells.Count > 1 Then Exit Sub
    If Target.Cells(1).Locked = False Then Exit Sub
    If (Target.Cells(1).Column = 1) Then
        ' Add row
        If Target.Cells(1).Row() < 4 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(-3, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If Target.Cells(1).Offset(-3, 0).Locked = False Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        Range(Target.Cells(1).Offset(-3, 0).Address).EntireRow.Insert
        Dim index As Integer
        index = 0
        Do While StrComp(Target.Cells(1).Offset(-3, index).Value, "___Multiple_Row___") = 0
            Target.Cells(1).Offset(-4, index).Value = Target.Cells(1).Offset(-1, index).Value
            Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle = Range(Target.Cells(1).Offset(-1, index).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-4, index).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Weight = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-4, index).Address).Borders.Color = Range(Target.Cells(1).Offset(-1, index).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-4, index).Address).Interior.ColorIndex = Range(Target.Cells(1).Offset(-1, index).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Color = Range(Target.Cells(1).Offset(-1, index).Address).Font.Color
            Range(Target.Cells(1).Offset(-4, index).Address).Font.Bold = Range(Target.Cells(1).Offset(-1, index).Address).Font.Bold
            Range(Target.Cells(1).Offset(-4, index).Address).Locked = Range(Target.Cells(1).Offset(-1, index).Address).Locked
            If StrComp(Target.Cells(1).Offset(-2, index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(-1, index).Value = Target.Cells(1).Offset(-1, index).Value + 1
            End If
            On Error Resume Next
                Target.Cells(1).Offset(-4, index).AddComment WorksheetFunction.Clean(Target.Cells(1).Offset(-1, index).comment.Text)
            On Error GoTo 0
            index = index + 1
        Loop
        Target.Cells(1).Offset(-5, index - 1).Borders.LineStyle = xlLineStyleNone
        Target.Cells(1).Offset(-5, index - 1).Interior.ColorIndex = 0
        Target.Cells(1).Offset(-5, index - 1).Value = ""
        ActiveSheet.Protect Password:="Password"
    Else
        ' Delete row
        If StrComp(Target.Cells(1).Offset(1, 0).Value, "___Multiple_Row___") <> 0 Then Exit Sub
        If StrComp(Target.Cells(1).Offset(1, 1).Value, "___Multiple_Row___") = 0 Then Exit Sub
        If StrComp(Target.Cells(1).Value, "___Multiple_Row_Start___") = 0 Then Exit Sub
        ActiveSheet.Unprotect Password:="Password"
        If StrComp(Target.Cells(1).Offset(-1, 0).Value, "___Multiple_Row_Start___") <> 0 Then
            Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle = Range(Target.Cells(1).Address).Borders.LineStyle
            If Range(Target.Cells(1).Offset(-1, 0).Address).Borders.LineStyle <> xlLineStyleNone Then
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Weight = Range(Target.Cells(1).Address).Borders.Weight
                Range(Target.Cells(1).Offset(-1, 0).Address).Borders.Color = Range(Target.Cells(1).Address).Borders.Color
            End If
            Range(Target.Cells(1).Offset(-1, 0).Address).Interior.ColorIndex = Range(Target.Cells(1).Address).Interior.ColorIndex
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Color = Range(Target.Cells(1).Address).Font.Color
            Range(Target.Cells(1).Offset(-1, 0).Address).Font.Bold = Range(Target.Cells(1).Address).Font.Bold
            Target.Cells(1).Offset(-1, 0).Value = Target.Cells(1).Value
        End If
        index = Target.Cells(1).Column() - 1
        Do While index > 0
            If StrComp(Target.Cells(1).Offset(2, -index).Value, "sequence") = 0 Then
                Target.Cells(1).Offset(3, -index).Value = Target.Cells(1).Offset(3, -index).Value - 1
            End If
            index = index - 1
        Loop
        Range(Target.Cells(1).Address).EntireRow.Delete
        ActiveSheet.Protect Password:="Password"
    End If
End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Workbook_Activate()
'    Application.CutCopyMode = False
'    Application.OnKey "^c", ""
'    Application.CellDragAndDrop = False
'End Sub
'Private Sub Workbook_Deactivate()
'    Application.CellDragAndDrop = True
'    Application.OnKey "^c"
'    Application.CutCopyMode = False
'End Sub
'Private Sub Workbook_WindowActivate(ByVal Wn As Window)
'    Application.CutCopyMode = False
'    Application.OnKey "^c", ""
'    Application.CellDragAndDrop = False
'End Sub
'Private Sub Workbook_WindowDeactivate(ByVal Wn As Window)
'    Application.CellDragAndDrop = True
'    Application.OnKey "^c"
'    Application.CutCopyMode = False
'End Sub
'Private Sub Workbook_SheetBeforeRightClick(ByVal Sh As Object, ByVal Target As Range, Cancel As Boolean)
'    Cancel = True
'    MsgBox "Right click menu deactivated." & vbCrLf & _
'    "Cannot copy or ''drag & drop''.", 16, "For this workbook:"
'End Sub
'Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)
'    Application.CutCopyMode = False
'End Sub
'Private Sub Workbook_SheetActivate(ByVal Sh As Object)
'    Application.OnKey "^c", ""
'    Application.CellDragAndDrop = False
'    Application.CutCopyMode = False
'End Sub
'Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)
'    Application.CutCopyMode = False
'End Sub
    
    


INQUEST-PP=macro
