Attribute VB_Name = "Module1"
'Declara|fffd||fffd|o de vari|fffd|veis

Public Utilizador
Public PalavraChave As Variant
Public PalavraEncriptada As Variant
Public PalavraChaveNova As Variant
Public Valido As Boolean

Sub VerificaValidade()
' Verifica a validade da Password e Utilizador
  Utilizador = UserForm1.ComboBox1.Text
  PalavraChave = UserForm1.TextBox1.Text
  If Utilizador = "" Then
    Erro12 = MsgBox("Attention!! No user was selected.", vbOKOnly)
    Valido = False
  Else
    Valido = True
    PalavraEncriptada = EncriptarPassword(PalavraChave)
    Sheet2.Select
    PalavraChaveNaFolha = Sheet2.Cells(Cells(1, 4) + 2, 2)

  ' Se a Password encriptada for diferente da Password na folha "Auxiliar" acaba.
    If PalavraEncriptada <> PalavraChaveNaFolha Then
      Erro = MsgBox("Wrong Password. Attention!! Only authorized users can use this option.", vbOKOnly)
      Valido = False
    End If
  End If
End Sub
Function EncriptarPassword(PalavraChave As Variant) As Variant
' Cria array para a PalavraChave Encriptada
  Dim Auxilio() As Integer
  Dim PalavraAuxiliar As Variant
  Comprimento = Len(PalavraChave)
  ReDim Auxilio(Comprimento)
  
  For i = 1 To Comprimento
    Auxilio(i) = Asc(Mid(PalavraChave, i, 1))
  Next i
  For i = 1 To Comprimento
    Auxilio(i) = Auxilio(i) + Application.WorksheetFunction.Round(((4 * i) / 3), 0)
  Next i
  For i = 1 To Comprimento
    PalavraAuxiliar = PalavraAuxiliar + Chr(Auxilio(i))
  Next i
  EncriptarPassword = PalavraAuxiliar
End Function

Sub Autorizar8D()
    ' --------------------
    ' Escreve na folha "Auxiliar" "n" (Management n|fffd|o desprotegeu a folha)
    Sheet2.Select
    ' Desproteger a folha "Auxiliar"
    ActiveSheet.Unprotect ("Protege-G8D")
    ' Escreve "n" na folha "Auxiliar"
    Sheet2.Cells(1, 16).Value = "n"
    ' Actualiza o Status date para a data de Today()
    Sheet2.Range("G1").Select
    Selection.Copy
    Sheet1.Select
    Range("F2").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False

  ' Procurar a palavra "Champion / Line Leader:"
  i = 1
  Palavra = "Champion / Line Leader:"
  Sheet1.Select
  Sheet1.Range("C1").Select
  Do While Sheet1.Cells(i, 3) <> Palavra
    i = i + 1
  Loop
  ' Escreve a informa|fffd||fffd|o de Autoriza|fffd||fffd|o na folha
  Sheet1.Cells(i + 1, 3).Font.Color = RGB(0, 0, 255)
  Sheet1.Cells(i + 1, 3).Value = Utilizador
  Sheet1.Cells(i + 2, 3).Font.Color = RGB(0, 255, 0)
'  Sheet1.Cells(i + 2, 4).Value = "Verified"
' Encriptar a data
  Sheet1.Cells(i + 2, 3).Value = EncriptarPassword(Sheet2.Cells(1, 7))

' ------------------------------------
  ' Copia os dados da aprova|fffd||fffd|o do Champion / Line Leader para a folha "Auxiliar"
  ' no caso de ser necess|fffd|rio esta informa|fffd||fffd|o ser|fffd| utilizada
  Sheet1.Range(Cells(i + 1, 3), Cells(i + 2, 3)).Select
  Selection.Copy
  Sheet2.Select
  Range("C2").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
' -------------------------------------

    Sheet2.Select
    ' Proteger a folha "Auxiliar"
    With ActiveSheet
      .Protect DrawingObjects:=True
      .Protect Contents:=True
      .Protect Scenarios:=True
      .Protect ("Protege-G8D")
    End With
    ' -------------------
    ' Esconde a folha "Auxiliar"
    Sheet2.Select
    ActiveWindow.SelectedSheets.Visible = False

' Proteje a folha toda
  Sheet1.Select
  With Selection
    .Cells.Select
    .Locked = True
    .FormulaHidden = False
  End With
 
' Proteje a folha
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
' P|fffd|e vis|fffd|veis/invis|fffd|veis os Bot|fffd|es da Sheet1
  Sheet1.CommandButton1.Visible = False ' Champion / Line Leader
  Sheet1.CommandButton2.Visible = True  ' Desproteger
  Sheet1.CommandButton3.Visible = True  ' Qualidade
  Sheet1.CommandButton4.Visible = False ' Management
End Sub

Sub AlterarPassword()
  PalavraChaveNova = UserForm2.TextBox1.Text
  PalavraEncriptada = EncriptarPassword(PalavraChaveNova)
  
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  ' Escrever na folha Auxiliar:
  '   a nova Password na coluna 2 e na Linha do Utilizador
  Sheet2.Cells(Cells(1, 4) + 2, 2) = PalavraEncriptada
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Sub AdicionarUtilizador()

' escrever na 1|fffd| linha em branco da coluna "a":
'   nome do novo utilizador
'   Password (na coluna ao lado)
  Utilizador = UserForm3.TextBox1.Text
  PalavraChave = UserForm3.TextBox2.Text
  PalavraEncriptada = EncriptarPassword(PalavraChave)

  ' Localizar c|fffd|lula em branco no fim da folha
  i = 1
  Sheet2.Select
  Sheet2.Range("A1").Select
  Do While Sheet2.Cells(i, 1) <> ""
    i = i + 1
  Loop
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  ' Escrever na folha "Auxiliar" o novo utilizador e a respectiva Password
  Sheet2.Cells(i, 1) = Utilizador
  Sheet2.Cells(i, 2) = PalavraEncriptada
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Sub RetirarUtilizador()
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
      
  ' Apagar a linha do utilizador seleccionado
  Sheet2.Cells((Cells(1, 6) + 2), 1).Select
  Selection.Delete Shift:=xlUp
  Sheet2.Cells((Cells(1, 6) + 2), 2).Select
  Selection.Delete Shift:=xlUp
  
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub
Attribute VB_Name = "Module2"

' Casos especiais devido |fffd| 2|fffd| assinatura - Qualidade
Sub VerificaValidade2()
' Verifica a validade da Password e Utilizador
  Utilizador = UserForm5.ComboBox1.Text
  PalavraChave = UserForm5.TextBox1.Text
  If Utilizador = "" Then
    Erro122 = MsgBox("Attention!! No user was selected.", vbOKOnly)
    Valido = False
  Else
    Valido = True
    PalavraEncriptada = EncriptarPassword(PalavraChave)
    Sheet2.Select
    PalavraChaveNaFolha = Sheet2.Cells(Cells(1, 12) + 2, 10)

  ' Se a Password encriptada for diferente da Password na folha "Auxiliar" acaba.
    If PalavraEncriptada <> PalavraChaveNaFolha Then
      Erro = MsgBox("Wrong Password. Attention!! Only authorized users can use this option.", vbOKOnly)
      Valido = False
    End If
  End If
End Sub

Sub Autorizar8DQualidade()
  Sheet1.Select
  ' Desproteger a folha "t8D"
  ActiveSheet.Unprotect ("Protege-G8D")
  ' ----------------------
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")

  ' Actualiza o Status date para a data de Today()
  ' Determina onde colocar a data
  Palavra = " Status Date"
  Sheet1.Select
  Sheet1.Range("I1").Select
  i = 1
  Do While Sheet1.Cells(i, 9) <> Palavra
    i = i + 1
  Loop
  ' Copia a data que est|fffd| na folha "Auxiliar"
  Sheet2.Select
  Sheet2.Range("G1").Select
  Selection.Copy
  Sheet1.Select
  Sheet1.Range(Cells(i + 1, 9), Cells(i + 1, 9)).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
' -------------------
  
' Se a Qualidade desprotegeu a folha copia os dados do aprovador anterior (Champion)
' para a folha "t8D"
  If Sheet2.Range("P1") = "s" Then
  ' Procurar a palavra "Champion / Line Leader:"
    i = 1
    Palavra = "Champion / Line Leader:"
    Sheet1.Select
    Sheet1.Range("C1").Select
    Do While Sheet1.Cells(i, 3) <> Palavra
      i = i + 1
    Loop
    ' Copia o nome do Aprovador (Champion / Line Leader) para a folha "t8D"
    Sheet2.Select
    Sheet2.Range("C2:C3").Select
    Selection.Copy
    Sheet1.Select
    Sheet1.Range(Cells(i + 1, 3), Cells(i + 2, 3)).Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
    Sheet1.Cells(i + 1, 3).Font.Color = RGB(0, 0, 255)
    Sheet1.Cells(i + 2, 3).Font.Color = RGB(0, 255, 0)
 '  Sheet1.Range(Cells(i + 1, 2), Cells(i + 2, 2)).Font.Color = RGB(0, 0, 0)
  End If
  
' Procurar a palavra "Quality Management:"
  i = 1
  Palavra = "Quality Management:"
  Sheet1.Select
  Sheet1.Range("E1").Select
  Do While Sheet1.Cells(i, 5) <> Palavra
    i = i + 1
  Loop
   
  ' Escreve a informa|fffd||fffd|o de Autoriza|fffd||fffd|o na folha
  Sheet1.Cells(i + 1, 5).Value = Utilizador
' Sheet1.Cells(i + 2, 4).Value = "Verified"
' Encripta a data
  Sheet1.Cells(i + 2, 5).Value = EncriptarPassword(Sheet2.Cells(1, 7))
  
  If Sheet2.Cells(1, 16) = "s" Then
    Sheet1.Range(Cells(i + 1, 5), Cells(i + 2, 5)).Font.Color = RGB(0, 0, 0)
  Else
    Sheet1.Cells(i + 1, 5).Font.Color = RGB(0, 0, 255)
    Sheet1.Cells(i + 2, 5).Font.Color = RGB(0, 255, 0)
  End If
  
 ' ------------------------------------
  ' Copia os dados da aprova|fffd||fffd|o do Quality Management para a folha "Auxiliar"
  ' no caso de ser necess|fffd|rio esta informa|fffd||fffd|o ser|fffd| utilizada
  Sheet1.Range(Cells(i + 1, 5), Cells(i + 2, 5)).Select
  Selection.Copy
  Sheet2.Select
  Sheet2.Range("K2").Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
' -------------------------------------
  
  ' Proteger a folha "Auxiliar"
  Sheet2.Select
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
   
' Proteje a folha toda
  Sheet1.Select
  With Selection
    .Cells.Select
    .Locked = True
    .FormulaHidden = False
  End With
' --------------------- Zona de mudan|fffd|a AMARELO -> BRANCO
' Selecciona todas as caixas de texto para as colocar Brancas
'  Dim S As Shape
'  For Each S In ActiveSheet.Shapes
'    If S.Type = msoTextBox Then
'      S.Fill.ForeColor.SchemeColor = 65 ' Branco
'    End If
'  Next
' --------------------- Fim da Zona de mudan|fffd|a AMARELO -> BRANCO
 
' Proteje a folha
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
' P|fffd|e vis|fffd|veis/invis|fffd|veis os Bot|fffd|es da Sheet1
  Sheet1.CommandButton1.Visible = False
  Sheet1.CommandButton2.Visible = True
  Sheet1.CommandButton3.Visible = False
  Sheet1.CommandButton4.Visible = True
End Sub

Sub Desproteger8DQualidade()
  
  ' Escreve, se necess|fffd|rio, na folha "Auxiliar" "s" (Qualidade desprotegeu a folha)
    Sheet2.Select
  ' Desproteger a folha "Auxiliar"
    ActiveSheet.Unprotect ("Protege-G8D")
    
    If Sheet2.Cells(1, 16).Value = "n" Then
    ' Escreve "s" na folha "Auxiliar"
      Sheet2.Cells(1, 16).Value = "s"
  
      ' Desproteje a folha "G8-D"
      Sheet1.Select
      Sheet1.Range("A2").Select
      ActiveSheet.Unprotect ("Protege-G8D")
  
      ' Procurar a palavra "Champion / Line Leader:"
      i = 1
      Palavra = "Champion / Line Leader:"
      Sheet1.Select
      Sheet1.Range("C1").Select
      Do While Sheet1.Cells(i, 3) <> Palavra
        i = i + 1
      Loop
      ' Copia Utilizador e Verified para a folha "Auxiliar"
      Sheet1.Range(Cells(i + 1, 3), Cells(i + 2, 3)).Select
      Selection.Copy
      Sheet2.Select
      Range("C2").Select
      Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
          False, Transpose:=False
    End If
    
    ' Proteger a folha "Auxiliar"
    With ActiveSheet
      .Protect DrawingObjects:=True
      .Protect Contents:=True
      .Protect Scenarios:=True
      .Protect ("Protege-G8D")
    End With
  
End Sub

Sub AlterarPassword2()
  PalavraChaveNova = UserForm6.TextBox1.Text
  PalavraEncriptada = EncriptarPassword(PalavraChaveNova)
  
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  ' Escrever na folha Auxiliar:
  '   a nova Password na coluna 10 e na Linha do Utilizador
  Sheet2.Cells(Cells(1, 12) + 2, 10) = PalavraEncriptada
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Sub AdicionarUtilizador2()

' escrever na 1|fffd| linha em branco da coluna "a":
'   nome do novo utilizador
'   Password (na coluna ao lado)
  Utilizador = UserForm7.TextBox1.Text
  PalavraChave = UserForm7.TextBox2.Text
  PalavraEncriptada = EncriptarPassword(PalavraChave)

  ' Localizar c|fffd|lula em branco no fim da folha
  i = 1
  Sheet2.Select
  Sheet2.Range("I1").Select
  Do While Sheet2.Cells(i, 9) <> ""
    i = i + 1
  Loop
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  ' Escrever na folha "Auxiliar" o novo utilizador e a respectiva Password
  Sheet2.Cells(i, 9) = Utilizador
  Sheet2.Cells(i, 10) = PalavraEncriptada
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Sub RetirarUtilizador2()
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
      
  ' Apagar a linha do utilizador seleccionado
  Sheet2.Cells((Cells(1, 14) + 2), 9).Select
  Selection.Delete Shift:=xlUp
  Sheet2.Cells((Cells(1, 14) + 2), 10).Select
  Selection.Delete Shift:=xlUp
  
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Attribute VB_Name = "Module3"
' Fun|fffd||fffd|es para c|fffd|lculo do Tabela Binomial de acordo com Clopper-Pearson
' Fun|fffd||fffd|o retirada da internet a 26.03.04 - Obrigado |fffd| Google.com

Function BinomHigh(vx As Double, vN As Double, p As Double) As Double
Dim vP As Double
vP = vx / vN
Dim v As Double
v = (1 + vP) / 2
Dim vsL As Double
vsL = vP
Dim vsH As Double
vsH = 1
Do While (vsH - vsL) > 0.000001
    If BinomP(vN, v, 0, vx) < p Then
        vsH = v
        v = (vsL + v) / 2
        Else
        vsL = v
        v = (v + vsH) / 2
        End If
    Loop
BinomHigh = v
End Function
Function BinomP(N As Double, p As Double, x1 As Double, x2 As Double) As Double
Dim q As Double
q = p / (1 - p)
Dim k As Double
k = 0
Dim v As Double
v = 1
Dim S As Double
S = 0
Dim Tot As Double
Tot = 0
Do While k <= N
    Tot = Tot + v
    If k >= x1 And k <= x2 Then
        S = S + v
        End If
    If Tot > 1E+30 Then
        S = S / 1E+30
        Tot = Tot / 1E+30
        v = v / 1E+30
        End If
    k = k + 1
    v = v * q * (N + 1 - k) / k
    Loop
BinomP = S / Tot
End Function

Attribute VB_Name = "Module4"
' Casos especiais devido |fffd| 3|fffd| Assinatura - Management
Sub VerificaValidade3()
' Verifica a validade da Password e Utilizador
  Utilizador = UserForm9.ComboBox1.Text
  PalavraChave = UserForm9.TextBox1.Text
  If Utilizador = "" Then
    Erro122 = MsgBox("Attention!! No user was selected.", vbOKOnly)
    Valido = False
  Else
    Valido = True
    PalavraEncriptada = EncriptarPassword(PalavraChave)
    Sheet2.Select
    PalavraChaveNaFolha = Sheet2.Cells(Cells(1, 21) + 2, 19)

  ' Se a Password encriptada for diferente da Password na folha "Auxiliar" acaba.
    If PalavraEncriptada <> PalavraChaveNaFolha Then
      Erro = MsgBox("Wrong Password. Attention!! Only authorized users can use this option.", vbOKOnly)
      Valido = False
    End If
  End If
End Sub

Sub Autorizar8DManagement()
  Sheet1.Select
  ' Desproteger a folha "G8-D"
  ActiveSheet.Unprotect ("Protege-G8D")
  ' ----------------------
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")

  ' Actualiza o Status date para a data de Today()
  ' Determina onde colocar a data
  Palavra = " Status Date"
  Sheet1.Select
  Sheet1.Range("I1").Select
  i = 1
  Do While Sheet1.Cells(i, 9) <> Palavra
    i = i + 1
  Loop
  ' Copia a data que est|fffd| na folha "Auxiliar"
  Sheet2.Select
  Sheet2.Range("G1").Select
  Selection.Copy
  Sheet1.Select
  Sheet1.Range(Cells(i + 1, 9), Cells(i + 1, 9)).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
  ' -------------------
  
  ' Copia para o t8D" o nome do aprovador "Champion / Line Leader"
  ' Procurar a palavra "Champion / Line Leader:"
  i = 1
  Palavra = "Champion / Line Leader:"
  Sheet1.Select
  Sheet1.Range("C1").Select
  Do While Sheet1.Cells(i, 3) <> Palavra
    i = i + 1
  Loop
  ' Copia o nome do Aprovador (Champion / Line Leader)para a folha "t8D"
  Sheet2.Select
  Sheet2.Range("C2:C3").Select
  Selection.Copy
  Sheet1.Select
  Sheet1.Range(Cells(i + 1, 3), Cells(i + 2, 3)).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
  Sheet1.Cells(i + 1, 3).Font.Color = RGB(0, 0, 255)
  Sheet1.Cells(i + 2, 3).Font.Color = RGB(0, 255, 0)
  ' Sheet1.Range(Cells(i + 1, 4), Cells(i + 2, 4)).Font.Color = RGB(0, 0, 0)
      
  ' Copia para o t8D" o nome do aprovador da Qualidade
  ' Procurar a palavra "Quality Management:"
  i = 1
  Palavra = "Quality Management:"
  Sheet1.Select
  Sheet1.Range("E1").Select
  Do While Sheet1.Cells(i, 5) <> Palavra
    i = i + 1
  Loop
  ' Copia o nome do Aprovador (Quality Management)para a folha "t8D"
  Sheet2.Select
  Sheet2.Range("K2:K3").Select
  Selection.Copy
  Sheet1.Select
  Sheet1.Range(Cells(i + 1, 5), Cells(i + 2, 5)).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
  
  If Sheet2.Cells(1, 16) = "s" Then
    Sheet1.Range(Cells(i + 1, 5), Cells(i + 2, 5)).Font.Color = RGB(0, 0, 0)
  Else
    Sheet1.Cells(i + 1, 5).Font.Color = RGB(0, 0, 255)
    Sheet1.Cells(i + 2, 5).Font.Color = RGB(0, 255, 0)
  End If
  
  ' Procurar a palavra "Management:"
  i = 1
  Palavra = "Management:"
  Sheet1.Select
  Sheet1.Range("G1").Select
  Do While Sheet1.Cells(i, 7) <> Palavra
    i = i + 1
  Loop
  ' Escreve a informa|fffd||fffd|o de Autoriza|fffd||fffd|o na folha
  Sheet1.Cells(i + 1, 7).Value = Utilizador
'  Sheet1.Cells(i + 2, 4).Value = "Verified"
' Encriptar a data
  Sheet1.Cells(i + 2, 7).Value = EncriptarPassword(Sheet2.Cells(1, 7))

  If Sheet2.Cells(1, 25) = "s" Then
    Sheet1.Range(Cells(i + 1, 7), Cells(i + 2, 7)).Font.Color = RGB(0, 0, 0)
  Else
    Sheet1.Cells(i + 1, 7).Font.Color = RGB(0, 0, 255)
    Sheet1.Cells(i + 2, 7).Font.Color = RGB(0, 255, 0)
  End If
 
  ' 16 E 25 passam "n" ap|fffd|s aprova|fffd||fffd|o total da folha
  ' Escreve "n" na folha "Auxiliar"
  Sheet2.Select
  Sheet2.Cells(1, 16).Value = "n"
  Sheet2.Cells(1, 25).Value = "n"

  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  
' Proteje a folha toda
  Sheet1.Select
  With Selection
    .Cells.Select
    .Locked = True
    .FormulaHidden = False
  End With
' --------------------- Zona de mudan|fffd|a AMARELO -> BRANCO
 
  ' Procurar a palavra "Status Report No."
  i = 1
  Palavra = "Status Report No."
  Sheet1.Select
  Sheet1.Range("I1").Select
  Do While Sheet1.Cells(i, 9) <> Palavra
    i = i + 1
  Loop
 ' Muda a cor do fundo da c|fffd|lula
  Sheet1.Range(Cells(i + 1, 9), Cells(i + 1, 9)).Select
  Selection.Interior.ColorIndex = xlNone
  
 ' Procurar a palavra "Team Leader:"
  i = 1
  Palavra = "Team Leader:"
  Sheet1.Select
  Sheet1.Range("A1").Select
  Do While Sheet1.Cells(i, 1) <> Palavra
    i = i + 1
  Loop
 ' Muda a cor do fundo das c|fffd|lulas
  Sheet1.Range(Cells(i + 1, 1), Cells(i + 1, 9)).Select
  Selection.Interior.ColorIndex = xlNone
  
' Procurar a palavra "Champion:"
  i = 1
  Palavra = "Champion:"
  Sheet1.Select
  Sheet1.Range("A1").Select
  Do While Sheet1.Cells(i, 1) <> Palavra
    i = i + 1
  Loop
 ' Muda a cor do fundo das c|fffd|lulas
  Sheet1.Range(Cells(i + 1, 1), Cells(i + 1, 9)).Select
  Selection.Interior.ColorIndex = xlNone
 
' Procurar a palavra "Comments"
  i = 1
  Palavra = "Comments"
  Sheet1.Select
  Sheet1.Range("B1").Select
  Do While Sheet1.Cells(i, 2) <> Palavra
    i = i + 1
  Loop
 ' Muda a cor do fundo das c|fffd|lulas
  Sheet1.Range(Cells(i + 1, 2), Cells(i + 2, 9)).Select
  Selection.Interior.ColorIndex = xlNone

' Procurar a palavra "Systematic Preventive Actions"
  i = 1
  Palavra = "Systematic Preventive Actions"
  Sheet1.Select
  Sheet1.Range("A1").Select
  Do While Sheet1.Cells(i, 1) <> Palavra
    i = i + 1
  Loop
 ' Muda a cor do fundo das c|fffd|lulas
  Sheet1.Range(Cells(i + 1, 1), Cells(i + 10, 5)).Select
  Selection.Interior.ColorIndex = xlNone

' Selecciona todas as caixas de texto para as colocar Brancas
  Dim S As Shape
  For Each S In ActiveSheet.Shapes
    If S.Type = msoTextBox Then
      S.Fill.ForeColor.SchemeColor = 65 ' Branco
    End If
  Next
' --------------------- Fim da Zona de mudan|fffd|a AMARELO -> BRANCO
 
' Proteje a folha
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
' P|fffd|e vis|fffd|veis/invis|fffd|veis os Bot|fffd|es da Sheet1
  Sheet1.CommandButton1.Visible = False ' Aprova Champion
  Sheet1.CommandButton2.Visible = True  ' Desprotege
  Sheet1.CommandButton3.Visible = False ' Aprova Qualidade
  Sheet1.CommandButton4.Visible = False ' Aprova Management
End Sub

Sub Desproteger8DManagement()
  
  ' Escreve, se necess|fffd|rio, na folha "Auxiliar" "s" (Management desprotegeu a folha)
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  If Sheet2.Cells(1, 25).Value = "n" Then
  ' Escreve "s" na folha "Auxiliar"
    Sheet2.Cells(1, 25).Value = "s"
  
  ' Desproteje a folha "G8-D"
    Sheet1.Select
    Sheet1.Range("A2").Select
    ActiveSheet.Unprotect ("Protege-G8D")
    
    If Sheet2.Cells(1, 16).Value = "n" Then
  ' Procurar a palavra "Champion / Line Leader:"
      i = 1
      Palavra = "Champion / Line Leader:"
      Sheet1.Select
      Sheet1.Range("C1").Select
      Do While Sheet1.Cells(i, 3) <> Palavra
        i = i + 1
      Loop
  ' Copia Utilizador e Verified para a folha "Auxiliar"
      Sheet1.Range(Cells(i + 1, 3), Cells(i + 2, 3)).Select
      Selection.Copy
      Sheet2.Select
      Range("C2").Select
      Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
          False, Transpose:=False
    End If
    ' Procurar a palavra "Quality Management:"
    i = 1
    Palavra = "Quality Management:"
    Sheet1.Select
    Sheet1.Range("E1").Select
    Do While Sheet1.Cells(i, 5) <> Palavra
      i = i + 1
    Loop
  ' Copia Utilizador e Verified para a folha "Auxiliar"
    Sheet1.Range(Cells(i + 1, 5), Cells(i + 2, 5)).Select
    Selection.Copy
    Sheet2.Select
    Range("K2").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
         False, Transpose:=False
  End If
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With

End Sub

Sub AlterarPassword3()
  PalavraChaveNova = UserForm10.TextBox1.Text
  PalavraEncriptada = EncriptarPassword(PalavraChaveNova)
  
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  ' Escrever na folha Auxiliar:
  '   a nova Password na coluna 10 e na Linha do Utilizador
  Sheet2.Cells(Cells(1, 21) + 2, 19) = PalavraEncriptada
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Sub AdicionarUtilizador3()

' escrever na 1|fffd| linha em branco da coluna "a":
'   nome do novo utilizador
'   Password (na coluna ao lado)
  Utilizador = UserForm11.TextBox1.Text
  PalavraChave = UserForm11.TextBox2.Text
  PalavraEncriptada = EncriptarPassword(PalavraChave)

  ' Localizar c|fffd|lula em branco no fim da folha
  i = 1
  Sheet2.Select
  Sheet2.Range("R1").Select
  Do While Sheet2.Cells(i, 18) <> ""
    i = i + 1
  Loop
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
  
  ' Escrever na folha "Auxiliar" o novo utilizador e a respectiva Password
  Sheet2.Cells(i, 18) = Utilizador
  Sheet2.Cells(i, 19) = PalavraEncriptada
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Sub RetirarUtilizador3()
  Sheet2.Select
  ' Desproteger a folha "Auxiliar"
  ActiveSheet.Unprotect ("Protege-G8D")
      
  ' Apagar a linha do utilizador seleccionado
  Sheet2.Cells((Cells(1, 23) + 2), 18).Select
  Selection.Delete Shift:=xlUp
  Sheet2.Cells((Cells(1, 23) + 2), 19).Select
  Selection.Delete Shift:=xlUp
  
  ' Proteger a folha "Auxiliar"
  With ActiveSheet
    .Protect DrawingObjects:=True
    .Protect Contents:=True
    .Protect Scenarios:=True
    .Protect ("Protege-G8D")
  End With
  Sheet1.Select
End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OptionButton1, 37, 0, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 38, 1, MSForms, OptionButton"
Attribute VB_Control = "CommandButton1, 201, 3, MSForms, CommandButton"
Attribute VB_Control = "OptionButton3, 51, 4, MSForms, OptionButton"
Attribute VB_Control = "OptionButton4, 52, 5, MSForms, OptionButton"
Attribute VB_Control = "OptionButton5, 55, 6, MSForms, OptionButton"
Attribute VB_Control = "OptionButton6, 56, 7, MSForms, OptionButton"
Attribute VB_Control = "OptionButton7, 59, 8, MSForms, OptionButton"
Attribute VB_Control = "OptionButton8, 60, 9, MSForms, OptionButton"
Attribute VB_Control = "OptionButton9, 63, 10, MSForms, OptionButton"
Attribute VB_Control = "OptionButton10, 64, 11, MSForms, OptionButton"
Attribute VB_Control = "OptionButton11, 165, 12, MSForms, OptionButton"
Attribute VB_Control = "OptionButton12, 166, 13, MSForms, OptionButton"
Attribute VB_Control = "OptionButton13, 167, 14, MSForms, OptionButton"
Attribute VB_Control = "OptionButton14, 168, 15, MSForms, OptionButton"
Attribute VB_Control = "OptionButton15, 169, 16, MSForms, OptionButton"
Attribute VB_Control = "OptionButton16, 170, 17, MSForms, OptionButton"
Attribute VB_Control = "OptionButton17, 171, 18, MSForms, OptionButton"
Attribute VB_Control = "OptionButton18, 172, 19, MSForms, OptionButton"
Attribute VB_Control = "OptionButton19, 173, 20, MSForms, OptionButton"
Attribute VB_Control = "OptionButton20, 174, 21, MSForms, OptionButton"
Attribute VB_Control = "OptionButton21, 175, 22, MSForms, OptionButton"
Attribute VB_Control = "OptionButton22, 176, 23, MSForms, OptionButton"
Attribute VB_Control = "OptionButton23, 177, 24, MSForms, OptionButton"
Attribute VB_Control = "OptionButton24, 178, 25, MSForms, OptionButton"
Attribute VB_Control = "OptionButton25, 179, 26, MSForms, OptionButton"
Attribute VB_Control = "OptionButton26, 180, 27, MSForms, OptionButton"
Attribute VB_Control = "OptionButton27, 181, 28, MSForms, OptionButton"
Attribute VB_Control = "OptionButton28, 182, 29, MSForms, OptionButton"
Attribute VB_Control = "OptionButton29, 183, 30, MSForms, OptionButton"
Attribute VB_Control = "OptionButton30, 184, 31, MSForms, OptionButton"
Attribute VB_Control = "OptionButton31, 185, 32, MSForms, OptionButton"
Attribute VB_Control = "OptionButton32, 186, 33, MSForms, OptionButton"
Attribute VB_Control = "OptionButton33, 187, 34, MSForms, OptionButton"
Attribute VB_Control = "OptionButton34, 188, 35, MSForms, OptionButton"
Attribute VB_Control = "OptionButton35, 189, 36, MSForms, OptionButton"
Attribute VB_Control = "OptionButton36, 190, 37, MSForms, OptionButton"
Attribute VB_Control = "OptionButton37, 191, 38, MSForms, OptionButton"
Attribute VB_Control = "OptionButton38, 192, 39, MSForms, OptionButton"
Attribute VB_Control = "OptionButton39, 193, 40, MSForms, OptionButton"
Attribute VB_Control = "OptionButton40, 194, 41, MSForms, OptionButton"
Private Sub CommandButton1_Click()
' Escreve FALSE em todas as linhas das colunas P e Q
' Procurar a palavra "P|fffd|ra"
  i = 1
  Palavra = "P|fffd|ra"
  'Sheet10.Select
  ' Sheet1.Range("D1").Select
  Range("P1").Select
  Do While Cells(i, 16) <> Palavra
    i = i + 1
  Loop
  
  i = i + 1
  Sair = False
  Contador = 0
  Do While Sair = False
    If Cells(i, 16) <> "" Then
      Contador = 0
      Cells(i, 16).Value = "FALSE"
      Cells(i, 17).Value = "FALSE"
    End If
    If Cells(i, 16) = "" Then
      Contador = Contador + 1
    End If
    If Contador = 10 Then
      Sair = True
    End If
    i = i + 1
  Loop
  Range("A10").Select
End Sub
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub OptionButton1_Click()
    Range("Score_D1").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton10_Click()
    Range("Score_D4A").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton11_Click()
    Range("Score_D4A").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton12_Click()
    Range("Score_D4A").Select
    ActiveCell.FormulaR1C1 = "12"
End Sub

Private Sub OptionButton13_Click()
    Range("Score_D4B").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton14_Click()
    Range("Score_D4B").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton15_Click()
    Range("Score_D4B").Select
    ActiveCell.FormulaR1C1 = "12"
End Sub

Private Sub OptionButton16_Click()
    Range("Score_D5").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton17_Click()
    Range("Score_D5").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton18_Click()
    Range("Score_D5").Select
    ActiveCell.FormulaR1C1 = "12"
End Sub

Private Sub OptionButton19_Click()
    Range("Score_D6").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton2_Click()
    Range("Score_D1").Select
    ActiveCell.FormulaR1C1 = "4"
End Sub

Private Sub OptionButton20_Click()
    Range("Score_D6").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton21_Click()
    Range("Score_D6").Select
    ActiveCell.FormulaR1C1 = "12"
End Sub

Private Sub OptionButton22_Click()
    Range("Score_D7").Select
    ActiveCell.FormulaR1C1 = "0"

End Sub

Private Sub OptionButton23_Click()
    Range("Score_D7").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton24_Click()
    Range("Score_D7").Select
    ActiveCell.FormulaR1C1 = "12"
End Sub

Private Sub OptionButton25_Click()
    Range("Score_D8").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton26_Click()
    Range("Score_D8").Select
    ActiveCell.FormulaR1C1 = "4"
End Sub

Private Sub OptionButton27_Click()
    Range("Score_D8").Select
    ActiveCell.FormulaR1C1 = "6"
End Sub

Private Sub OptionButton28_Click()
    Range("Score_G").Select
    ActiveCell.FormulaR1C1 = "0"

End Sub

Private Sub OptionButton29_Click()
    Range("Score_G").Select
    ActiveCell.FormulaR1C1 = "4"
End Sub

Private Sub OptionButton3_Click()
    Range("Score_D1").Select
    ActiveCell.FormulaR1C1 = "6"
End Sub

Private Sub OptionButton30_Click()
    Range("Score_G").Select
    ActiveCell.FormulaR1C1 = "6"
End Sub

Private Sub OptionButton4_Click()
    Range("Score_D2").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton5_Click()
    Range("Score_D2").Select
    ActiveCell.FormulaR1C1 = "8"
End Sub

Private Sub OptionButton6_Click()
    Range("Score_D2").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton7_Click()
    Range("Score_D3").Select
    ActiveCell.FormulaR1C1 = "0"
End Sub

Private Sub OptionButton8_Click()
    Range("Score_D3").Select
    ActiveCell.FormulaR1C1 = "10"
End Sub

Private Sub OptionButton9_Click()
    Range("Score_D3").Select
    ActiveCell.FormulaR1C1 = "12"
End Sub
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox1, 39, 4, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 40, 5, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 41, 6, MSForms, CheckBox"
Private Sub CommandButton1_Click()
' Coloca em Branco o que est|fffd| a Amarelo
'Congelamento do monitor
  Application.ScreenUpdating = False

' Selecciona todas as caixas de texto para as colocar Brancas
  Dim S As Shape
  For Each S In ActiveSheet.Shapes
    If S.Type = msoTextBox Then
      S.Fill.ForeColor.SchemeColor = 65 ' Branco
    End If
  Next
     
  CommandButton1.Visible = False
  CommandButton2.Visible = True
  
' Descongelamento do monitor
  Application.ScreenUpdating = True
  ActiveSheet.Range("A2").Select
End Sub

Private Sub CommandButton2_Click()
' Coloca em Branco o que est|fffd| a Amarelo
'Congelamento do monitor
  Application.ScreenUpdating = False

' Selecciona todas as caixas de texto para as colocar Brancas
  Dim S As Shape
  For Each S In ActiveSheet.Shapes
    If S.Type = msoTextBox Then
      S.Fill.ForeColor.SchemeColor = 26 ' Amarelo Claro
    End If
  Next
    
  CommandButton1.Visible = True
  CommandButton2.Visible = False
  
' Descongelamento do monitor
  Application.ScreenUpdating = True
  ActiveSheet.Range("A2").Select
End Sub

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox1, 12, 0, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 13, 1, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 14, 2, MSForms, CheckBox"
Attribute VB_Control = "CheckBox4, 15, 3, MSForms, CheckBox"
Attribute VB_Control = "CheckBox5, 19, 4, MSForms, CheckBox"
Attribute VB_Control = "CheckBox6, 20, 5, MSForms, CheckBox"
Attribute VB_Control = "CheckBox7, 24, 6, MSForms, CheckBox"
Attribute VB_Control = "CheckBox8, 25, 7, MSForms, CheckBox"
Attribute VB_Control = "CheckBox9, 32, 8, MSForms, CheckBox"
Attribute VB_Control = "CheckBox10, 33, 9, MSForms, CheckBox"
Attribute VB_Control = "CheckBox11, 34, 10, MSForms, CheckBox"
Attribute VB_Control = "CheckBox12, 35, 11, MSForms, CheckBox"
Attribute VB_Control = "CheckBox13, 39, 12, MSForms, CheckBox"
Attribute VB_Control = "CheckBox14, 40, 13, MSForms, CheckBox"
Attribute VB_Control = "CheckBox15, 44, 14, MSForms, CheckBox"
Attribute VB_Control = "CheckBox16, 45, 15, MSForms, CheckBox"
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox1, 7, 0, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 8, 1, MSForms, CheckBox"
Attribute VB_Control = "CheckBox5, 9, 2, MSForms, CheckBox"
Attribute VB_Control = "CheckBox7, 10, 3, MSForms, CheckBox"
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{2A2EB59A-B8B1-47D7-BDBF-BCDFCA365FE4}{2413BA12-6E16-429C-928F-3B811C476E72}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
' Autorizar 8D - QM
  VerificaValidade
  If Valido = True Then
    Autorizar8D
    Erro11 = MsgBox("8D-Report is already Authorized.", vbOKOnly)

    ' Descarrega o UserForm1
    Unload Me
    Sheet1.Select
    Application.ScreenUpdating = True
    Sheet1.Range("A2").Select
  Else
'  Unload UserForm1
'  Sheet1.Select
'  Application.ScreenUpdating = True
  End If
End Sub

Private Sub CommandButton2_Click()
' Alterar Password do UserForm1
  VerificaValidade
  If Valido = True Then
    UserForm2.Show
  Else
  End If
End Sub

Private Sub CommandButton3_Click()
' Cancelar UserForm1
' Esconde a folha "Auxiliar"
  Sheet2.Select
  ActiveWindow.SelectedSheets.Visible = False
  ' Descarrega o UserForm1
  Unload Me
    'UserForm1.Hide
  Sheet1.Select
  Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
' Adicionar Utilizador
  VerificaValidade
  If Valido = True Then
    UserForm3.Show
  Else
  End If
End Sub

Private Sub CommandButton5_Click()
' Retirar Utilizador
  VerificaValidade
  If Valido = True Then
    UserForm4.Show
  Else
  End If
End Sub



Attribute VB_Name = "UserForm10"
Attribute VB_Base = "0{782E0BF1-7870-4376-A3E5-76E16C9E4746}{1A249A64-5D21-4A61-A776-BD854DAFEA4B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' OK do Form para Alterar a Password - Management

' Verifica se o texto da TextBox1 = texto da TextBox2
  Texto1 = UserForm10.TextBox1.Text
  Texto2 = UserForm10.TextBox2.Text
  If Texto1 <> Texto2 Then
    Erro22 = MsgBox("Passwords does not match.", vbOKOnly)
    Unload UserForm10
  Else
    If Texto1 = "" Or Texto2 = "" Then
      Erro32 = MsgBox("Password without characters is not allowed.", vbOKOnly)
      Unload UserForm10
    Else
      AlterarPassword3
      Erro102 = MsgBox("Password already changed.", vbOKOnly)
      Unload UserForm10
    End If
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm10
  Unload Me
End Sub

Private Sub Label1_Click()

End Sub
Attribute VB_Name = "UserForm11"
Attribute VB_Base = "0{341B5D86-2596-40B0-959E-7B815B82B442}{F30E28CC-C0A4-4DF9-B038-BE2C12E8BF84}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' OK do Form para Adicionar Utilizador - Management
' Verifica o texto do nome do utilizador
  Texto1 = UserForm11.TextBox1.Text
  ExisteUtilizador = True
  If Texto1 = "" Then
    Erro42 = MsgBox("Username was not written", vbOKOnly)
    ExisteUtilizador = False
  End If
' Verifica se o texto da TextBox2 = texto da TextBox3
  Texto2 = UserForm11.TextBox2.Text
  Texto3 = UserForm11.TextBox3.Text
  If Texto2 <> Texto3 Then
    Erro52 = MsgBox("Passwords does not match.", vbOKOnly)
    Unload UserForm11
  Else
    If Texto3 = "" Or Texto3 = "" Then
      Erro62 = MsgBox("Password without characters is not allowed.", vbOKOnly)
      Unload UserForm11
    Else
      If ExisteUtilizador = True Then
        AdicionarUtilizador3
        Erro92 = MsgBox("User already added.", vbOKOnly)
        Unload UserForm11
      Else
        Unload UserForm11
      End If
    End If
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm11
  Unload Me
End Sub

Attribute VB_Name = "UserForm12"
Attribute VB_Base = "0{4B99CABC-D5D3-42B3-AD5C-1D584AC419B8}{0799050C-E7C7-4F04-B217-03C797DB490B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' OK do Form para Retirar Utilizador-Management
' Verifica o texto do nome do utilizador
  Texto1 = UserForm12.ComboBox1.Text
  ExisteUtilizador = True
  If Texto1 = "" Then
    Erro72 = MsgBox("Username was not written", vbOKOnly)
    Unload UserForm12
  Else
    RetirarUtilizador3
    Erro82 = MsgBox("User already removed", vbOKOnly)
    Unload UserForm12
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm12
  Unload Me
End Sub

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{0A97460F-DAF4-4687-A41B-E9714B00CCD9}{CBD0E389-5DC3-44EA-A32C-C40CED2BEB68}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
' OK do Form para Alterar a Password

' Verifica se o texto da TextBox1 = texto da TextBox2
  Texto1 = UserForm2.TextBox1.Text
  Texto2 = UserForm2.TextBox2.Text
  If Texto1 <> Texto2 Then
    Erro2 = MsgBox("Passwords n|fffd|o coincidem.", vbOKOnly)
    Unload UserForm2
  Else
    If Texto1 = "" Or Texto2 = "" Then
      Erro3 = MsgBox("Password sem caracteres n|fffd|o |fffd| autorizada.", vbOKOnly)
      Unload UserForm2
    Else
      AlterarPassword
      Erro10 = MsgBox("A Password j|fffd| foi Alterada.", vbOKOnly)
      Unload UserForm2
    End If
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm2
  Unload Me
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{9B6520CB-A08E-4C64-A4AE-3CB6D36279C0}{100C1EDA-CA57-49AB-878C-0E1D2186EF40}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
' OK do Form para Adicionar Utilizador
' Verifica o texto do nome do utilizador
  Texto1 = UserForm3.TextBox1.Text
  ExisteUtilizador = True
  If Texto1 = "" Then
    Erro4 = MsgBox("Username was not written", vbOKOnly)
    ExisteUtilizador = False
  End If
' Verifica se o texto da TextBox2 = texto da TextBox3
  Texto2 = UserForm3.TextBox2.Text
  Texto3 = UserForm3.TextBox3.Text
  If Texto2 <> Texto3 Then
    Erro5 = MsgBox("Passwords does not match.", vbOKOnly)
    Unload UserForm3
  Else
    If Texto3 = "" Or Texto3 = "" Then
      Erro6 = MsgBox("Password without characters is not allowed.", vbOKOnly)
      Unload UserForm3
    Else
      If ExisteUtilizador = True Then
        AdicionarUtilizador
        Erro9 = MsgBox("User already added.", vbOKOnly)
        Unload UserForm3
      Else
        Unload UserForm3
      End If
    End If
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm3
  Unload Me
End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{E7A55CC4-DDE0-4DFD-A18D-8668F70F65A6}{CF590C27-36CF-49F0-91CA-A0BBECDA28BA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
' OK do Form para Retirar Utilizador
' Verifica o texto do nome do utilizador
  Texto1 = UserForm4.ComboBox1.Text
  ExisteUtilizador = True
  If Texto1 = "" Then
    Erro7 = MsgBox("Username was not written", vbOKOnly)
    Unload UserForm4
  Else
    RetirarUtilizador
    Erro8 = MsgBox("User already removed", vbOKOnly)
    Unload UserForm4
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm4
  Unload Me
End Sub
Attribute VB_Name = "UserForm5"
Attribute VB_Base = "0{5AE87FEE-B8EE-449B-879A-0B362FAEFAC4}{1D73DC5A-5CB0-4524-BE60-9ED025F8756D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' Autorizar 8D - Qualidade
  VerificaValidade2
  If Valido = True Then
    Autorizar8DQualidade
    Erro112 = MsgBox("8D-Report is already Authorized.", vbOKOnly)
    ' Esconde a folha "Auxiliar"
    Sheet2.Select
    ActiveWindow.SelectedSheets.Visible = False
    ' Descarrega o UserForm5
    Unload Me
    Sheet1.Select
    Application.ScreenUpdating = True
    Sheet1.Range("A2").Select
  Else
'  Unload UserForm5
'  Sheet1.Select
'  Application.ScreenUpdating = True
  End If
End Sub

Private Sub CommandButton2_Click()
' Alterar Password do UserForm5
  VerificaValidade2
  If Valido = True Then
    UserForm6.Show
  Else
  End If
End Sub

Private Sub CommandButton3_Click()
' Cancelar UserForm5
' Esconde a folha "Auxiliar"
  Sheet2.Select
  ActiveWindow.SelectedSheets.Visible = False
  ' Descarrega o UserForm5
  Unload Me
    'UserForm1.Hide
  Sheet1.Select
  Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
' Adicionar Utilizador - Qualidade (UserForm5)
  VerificaValidade2
  If Valido = True Then
    UserForm7.Show
  Else
  End If
End Sub

Private Sub CommandButton5_Click()
' Retirar Utilizador - Qualidade
  VerificaValidade2
  If Valido = True Then
    UserForm8.Show
  Else
  End If
End Sub

Private Sub CommandButton6_Click()
' Qualidade Desprotege para altera|fffd||fffd|es ap|fffd|s a assinatura do Line Leader
'Congelamento do monitor
 Application.ScreenUpdating = False
  VerificaValidade2
  If Valido = True Then
    Desproteger8DQualidade
    Erro112 = MsgBox("8D-Report is already unprotected.", vbOKOnly)
 
    ' Esconde a folha "Auxiliar"
    Sheet2.Select
    ActiveWindow.SelectedSheets.Visible = False
    ' Descarrega o UserForm5
    Unload Me
    Sheet1.Select
' Descongelamento do monitor
    Application.ScreenUpdating = True
    Sheet1.Range("A2").Select
  Else
'  Unload UserForm5
'  Sheet1.Select
'  Application.ScreenUpdating = True
  End If
End Sub

Attribute VB_Name = "UserForm6"
Attribute VB_Base = "0{774EB1DF-9B05-4173-A3C8-868E3A7FE0CE}{73C9FE7C-42D9-428F-B423-AB34A67593AA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' OK do Form para Alterar a Password - Management

' Verifica se o texto da TextBox1 = texto da TextBox2
  Texto1 = UserForm6.TextBox1.Text
  Texto2 = UserForm6.TextBox2.Text
  If Texto1 <> Texto2 Then
    Erro22 = MsgBox("Passwords does not match.", vbOKOnly)
    Unload UserForm6
  Else
    If Texto1 = "" Or Texto2 = "" Then
      Erro32 = MsgBox("Password without characters.", vbOKOnly)
      Unload UserForm6
    Else
      AlterarPassword2
      Erro102 = MsgBox("Password already changed.", vbOKOnly)
      Unload UserForm6
    End If
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm6
  Unload Me
End Sub

Attribute VB_Name = "UserForm7"
Attribute VB_Base = "0{B6F8A676-E418-4DC5-A5AA-DF28F14E28F0}{FCA59DB2-A163-49CC-87D8-F46C4644A55D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' OK do Form para Adicionar Utilizador - Management
' Verifica o texto do nome do utilizador
  Texto1 = UserForm7.TextBox1.Text
  ExisteUtilizador = True
  If Texto1 = "" Then
    Erro42 = MsgBox("Username not written", vbOKOnly)
    ExisteUtilizador = False
  End If
' Verifica se o texto da TextBox2 = texto da TextBox3
  Texto2 = UserForm7.TextBox2.Text
  Texto3 = UserForm7.TextBox3.Text
  If Texto2 <> Texto3 Then
    Erro52 = MsgBox("Passwords does not match.", vbOKOnly)
    Unload UserForm7
  Else
    If Texto3 = "" Or Texto3 = "" Then
      Erro62 = MsgBox("Password without characters is not allowed.", vbOKOnly)
      Unload UserForm7
    Else
      If ExisteUtilizador = True Then
        AdicionarUtilizador2
        Erro92 = MsgBox("User already added.", vbOKOnly)
        Unload UserForm7
      Else
        Unload UserForm7
      End If
    End If
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm7
  Unload Me
End Sub
Attribute VB_Name = "UserForm8"
Attribute VB_Base = "0{8B05684B-FE0B-4CE6-B655-E1721F8E7137}{2C01BE36-9281-40EE-A170-95D5FC174629}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' OK do Form para Retirar Utilizador-Management
' Verifica o texto do nome do utilizador
  Texto1 = UserForm8.ComboBox1.Text
  ExisteUtilizador = True
  If Texto1 = "" Then
    Erro72 = MsgBox("Username was not written", vbOKOnly)
    Unload UserForm8
  Else
    RetirarUtilizador2
    Erro82 = MsgBox("User already removed", vbOKOnly)
    Unload UserForm8
  End If
End Sub

Private Sub CommandButton2_Click()
' Cancelar UserForm8
  Unload Me
End Sub

Attribute VB_Name = "UserForm9"
Attribute VB_Base = "0{32D71823-A26C-45FA-A209-6D6DC8F8E1D0}{4A59FA1E-70EC-4466-8C93-4694FE2CFA8F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
' Autorizar 8D - Management
  VerificaValidade3
  If Valido = True Then
    Autorizar8DManagement
    Erro112 = MsgBox("8D-Report is already Authorized.", vbOKOnly)
    ' Esconde a folha "Auxiliar"
    Sheet2.Select
    ActiveWindow.SelectedSheets.Visible = False
    ' Descarrega o UserForm1
    Unload Me
    Sheet1.Select
    Application.ScreenUpdating = True
    Sheet1.Range("A2").Select
  Else
'  Unload UserForm1
'  Sheet1.Select
'  Application.ScreenUpdating = True
  End If
End Sub


Private Sub CommandButton2_Click()
' Alterar Password do UserForm9
  VerificaValidade3
  If Valido = True Then
    UserForm10.Show
  Else
  End If
End Sub

Private Sub CommandButton3_Click()
' Cancelar UserForm9
' Esconde a folha "Auxiliar"
  Sheet2.Select
  ActiveWindow.SelectedSheets.Visible = False
  ' Descarrega o UserForm9
  Unload Me
    'UserForm1.Hide
  Sheet1.Select
  Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
' Adicionar Utilizador
  VerificaValidade3
  If Valido = True Then
    UserForm11.Show
  Else
  End If
End Sub

Private Sub CommandButton5_Click()
' Retirar Utilizador - Management
  VerificaValidade3
  If Valido = True Then
    UserForm12.Show
  Else
  End If
End Sub

Private Sub CommandButton6_Click()
' Management Desprotege para altera|fffd||fffd|es ap|fffd|s a assinatura do QM
'Congelamento do monitor
 Application.ScreenUpdating = False
  VerificaValidade3
  If Valido = True Then
    Desproteger8DManagement
    Erro112 = MsgBox("8D-Report is already unprotected.", vbOKOnly)
 
    ' Esconde a folha "Auxiliar"
    Sheet2.Select
    ActiveWindow.SelectedSheets.Visible = False
    ' Descarrega o UserForm5
    Unload Me
    Sheet1.Select
' Descongelamento do monitor
    Application.ScreenUpdating = True
    Sheet1.Range("A2").Select
  Else
'  Unload UserForm5
'  Sheet1.Select
'  Application.ScreenUpdating = True
  End If
End Sub



INQUEST-PP=macro
