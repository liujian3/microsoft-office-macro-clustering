Attribute VB_Name = "MECHANICAL"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OB_PIPULATOR, 644, 14, MSForms, OptionButton"
Attribute VB_Control = "OB_UNITS, 712, 46, MSForms, OptionButton"
Attribute VB_Control = "OB_FHC_PUMP, 684, 49, MSForms, OptionButton"
Attribute VB_Control = "OB_SPRINKLER_PUMP, 685, 50, MSForms, OptionButton"
Attribute VB_Control = "OB_COMBINED_PUMP, 686, 51, MSForms, OptionButton"
Attribute VB_Control = "OB_JOCKEY_PUMP, 687, 52, MSForms, OptionButton"
Attribute VB_Control = "OB_FHC_PIPES, 688, 53, MSForms, OptionButton"
Attribute VB_Control = "OB_SPRINKLER_PIPES, 689, 54, MSForms, OptionButton"
Attribute VB_Control = "OB_COMBINED_PIPES, 690, 55, MSForms, OptionButton"
Attribute VB_Control = "OB_CO2_PIPES, 691, 56, MSForms, OptionButton"
Attribute VB_Control = "OB_sprinkler_distribut, 701, 66, MSForms, OptionButton"
Attribute VB_Control = "OB_FM_200_NOZZLES, 702, 67, MSForms, OptionButton"
Attribute VB_Control = "OB_CO2_NOZZLES, 703, 68, MSForms, OptionButton"
Attribute VB_Control = "OB_FM_200_STORAGE, 704, 69, MSForms, OptionButton"
Attribute VB_Control = "OB_CO2_STORAGE, 705, 70, MSForms, OptionButton"


Private Sub CB_MECH_QUIT_Click()
Application.ScreenUpdating = False: Call air

ActiveWorkbook.Close
End Sub


Private Sub OB_pipulator_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_PIPULATOR.Visible = -1
SH_PIPULATOR.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_ductulator_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_H_DCTLTR.Visible = -1
SH_H_DCTLTR.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_UNITS_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_units.Visible = -1
SH_units.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub


Private Sub OB_fhc_pump_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_FPFHCS.Visible = -1
SH_F_FPFHCS.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Private Sub OB_sprinkler_pump_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SMSH_F_FPSS.Visible = -1
SMSH_F_FPSS.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Private Sub OB_combined_pump_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SMSH_F_FPCS.Visible = -1
SMSH_F_FPCS.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Private Sub OB_jockey_pump_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_JP.Visible = -1
SH_F_JP.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Private Sub OB_fhc_pipes_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sh_F_FHCP.Visible = -1
Sh_F_FHCP.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_sprinkler_pipes_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_SP.Visible = -1
SH_F_SP.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_combined_pipes_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_CSP.Visible = -1
SH_F_CSP.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_co2_pipes_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_C02P.Visible = -1
SH_F_C02P.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Private Sub OB_sprinkler_distribut_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_FSD.Visible = -1
SH_F_FSD.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_Fm_200_nozzles_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_FM200N.Visible = -1
SH_F_FM200N.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_co2_nozzles_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_C02N.Visible = -1
SH_F_C02N.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_fm_200_storage_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_FM200SC.Visible = -1
SH_F_FM200SC.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Private Sub OB_co2_storage_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
SH_F_CO2_sc.Visible = -1
SH_F_CO2_sc.Select
ActiveSheet.Protect Password:=qwe & rty & uio
MECHANICAL.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub





Attribute VB_Name = "M_T1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Sub Macro1()
Attribute Macro1.VB_Description = "Macro recorded 2/6/01 by Osama Taye"
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
' Macro recorded 2/6/01 by Osama Taye
'

'

 osa = 20
 
   'Range("m2:p2").Select
   ' Selection.Copy
   For i = 0 To osa
   Range("F3:I3").Select
    Cells(3 + i, 6).Select
   Selection.Clear
 Next i
 
   osa = Range("b4")
    Range("m3:p3").Select
    Selection.Copy
   For i = 0 To osa
   Range("F3:I3").Select
    Cells(3 + i, 6).Select
    
    
    
        ActiveSheet.PASTE
    Next i
    Application.CutCopyMode = False
    
    
   For i = 1 To osa
Range("F3").Select
    Cells(2 + i, 6) = i
    Next i
    
    
End Sub
Sub Macro2()
Attribute Macro2.VB_Description = "Macro recorded 2/6/01 by Osama Taye"
Attribute Macro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
' Macro recorded 2/6/01 by Osama Taye
'

'
    Range("F2:I2").Select
    Selection.Copy
    Range("F3:I8").Select
    ActiveSheet.PASTE
    Range("G9,H9,G11").Select
    Range("G11").Activate
End Sub
Sub Macro3()
Attribute Macro3.VB_Description = "Macro recorded 2/6/01 by Osama Taye"
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
' Macro recorded 2/6/01 by Osama Taye
'

'
    Range("M7:P7").Select
    Selection.Copy
    ActiveSheet.PASTE
    Application.CutCopyMode = False
    Range("M7:P8").Select
    Selection.Copy
    Application.CutCopyMode = False
    Selection.ClearContents
End Sub
Sub Macro4()
Attribute Macro4.VB_Description = "Macro recorded 2/6/01 by Osama Taye"
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro4 Macro
' Macro recorded 2/6/01 by Osama Taye
'

'
    Range("F16:I17").Select
    Range("I17").Activate
    Selection.Clear
    Range("J11").Select
    
End Sub
Attribute VB_Name = "Module10"
Sub Macro5()
Attribute Macro5.VB_Description = "Macro recorded 2/17/2001 by Rashad Masri"
Attribute Macro5.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro5 Macro
' Macro recorded 2/17/2001 by Rashad Masri
'

'
    Rows("19:37").Select
    Selection.EntireRow.Hidden = False
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
    Selection.EntireRow.Hidden = True
End Sub
Sub Macro6()
Attribute Macro6.VB_Description = "Macro recorded 2/17/2001 by Rashad Masri"
Attribute Macro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
' Macro recorded 2/17/2001 by Rashad Masri
'

'
For i = 0 To 20

    osa = ScrollBar
      
    osa = osa + 1
    Range("K20") = osa
Next i

    'ActiveWindow.LargeScroll Down:=-2
End Sub
Attribute VB_Name = "Module101"
Sub Macro11()
Attribute Macro11.VB_Description = "Macro recorded 18/04/99 by wissam sweissy"
Attribute Macro11.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro11 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
    Range("B6:Q15").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("A18").Select
    ActiveWindow.LargeScroll Down:=1
    Range("B22").Select
    ActiveSheet.PASTE
    Selection.Interior.ColorIndex = xlNone
End Sub
Attribute VB_Name = "Module110"
Function temper(tem, fr, t)

temper = 0
If fr = 1 Then
  If t = 1 Then temper = tem
  If t = 2 Then temper = 1.8 * tem + 32
  If t = 3 Then temper = tem + 273.15
End If
If fr = 2 Then
  If t = 2 Then temper = tem
  If t = 1 Then temper = 0.55 * (tem - 32)
  If t = 3 Then temper = 0.55 * (tem - 32) + 273.15
End If
If fr = 3 Then
  If t = 3 Then temper = tem
  If t = 1 Then temper = tem - 273.15
  If t = 2 Then temper = (tem - 273.15) * 1.8 + 32
End If

End Function
Sub UNITS_choose(a, B)
Attribute UNITS_choose.VB_Description = "Macro recorded 8/26/2002 by user"
Attribute UNITS_choose.VB_ProcData.VB_Invoke_Func = " \n14"

    Application.ScreenUpdating = False
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("List Box 12").Select
    With Selection
        .ListFillRange = a
        .LinkedCell = "$S$2"
        .MultiSelect = xlNone
        .Display3DShading = True
    End With
    ActiveSheet.Shapes("List Box 13").Select
    With Selection
        .ListFillRange = a
        .LinkedCell = "$R$2"
        .MultiSelect = xlNone
        .Display3DShading = True
    End With
    ActiveWindow.SmallScroll ToRight:=-4
Range("s2").Value = 1
Range("r2").Value = 1
Range("k3").Value = 1

Range("L3").Formula = "=INDEX(" & a & ",s2)"
Range("L5").Formula = "=INDEX(" & a & ",r2)"

If a = "$T$34:$T$36" Then
Range("k5").Formula = "=temper(k3,s2,r2)"
Range("k5").NumberFormat = "general"
Else
Range("k5").Formula = "=INDEX(" & B & ",s2,r2)*k3"
Range("k5").NumberFormat = "0.000;;"
End If
Range("k3").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub

Sub UNITS_length()
a = "$T$3:$T$7"
B = "$U$3:$Y$7"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_area()
a = "$T$11:$T$15"
B = "$U$11:$Y$15"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_volume()
a = "$T$19:$T$25"
B = "$U$19:$AA$25"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_mass()
a = "$T$29:$T$30"
B = "$U$29:$V$30"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_temp()
a = "$T$34:$T$36"
B = "$U$34:$W$36"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_flow()
a = "$T$40:$T$45"
B = "$U$40:$Z$45"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_velocity()
a = "$T$48:$T$50"
B = "$U$48:$W$50"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_pressure()
a = "$T$54:$T$64"
B = "$U$54:$AE$64"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_power()
a = "$T$68:$T$72"
B = "$U$68:$Y$72"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_heat_transfer()
a = "$T$76:$T$78"
B = "$U$76:$W$78"
Call UNITS_choose(a, B)
End Sub
Sub UNITS_Linear_Friction_loss()
a = "$T$82:$T$86"
B = "$U$82:$y$86"
Call UNITS_choose(a, B)
End Sub

Attribute VB_Name = "Module113"

Sub CALCULATE_Click()
Application.ScreenUpdating = False: Call air
If (SH_H_DCTLTR.Range("G7").Value > 0 And SH_H_DCTLTR.Range("G10").Value > 0) Then
SH_H_DCTLTR.Range("L9").Value = 25
a = SH_H_DCTLTR.Range("L9").Value
If (SH_H_DCTLTR.Range("G6").Value = 1 And SH_H_DCTLTR.Range("G9").Value > 0) Then
Do While SH_H_DCTLTR.Range("O9").Value > SH_H_DCTLTR.Range("G9").Value
a = a + 25
SH_H_DCTLTR.Range("L9").Value = a
Loop
SH_H_DCTLTR.Range("E7").Value = SH_H_DCTLTR.Range("G7").Value
SH_H_DCTLTR.Range("E8").Value = SH_H_DCTLTR.Range("S9").Value
SH_H_DCTLTR.Range("E9").Value = SH_H_DCTLTR.Range("O9").Value
SH_H_DCTLTR.Range("E10").Value = SH_H_DCTLTR.Range("G10").Value
SH_H_DCTLTR.Range("E11").Value = SH_H_DCTLTR.Range("L9").Value
SH_H_DCTLTR.Range("E12").Value = SH_H_DCTLTR.Range("N9").Value

End If
If (SH_H_DCTLTR.Range("G6").Value = 2 And SH_H_DCTLTR.Range("G8").Value > 0) Then
Do While SH_H_DCTLTR.Range("S9").Value > SH_H_DCTLTR.Range("G8").Value
a = a + 25
SH_H_DCTLTR.Range("L9").Value = a
Loop
SH_H_DCTLTR.Range("E7").Value = SH_H_DCTLTR.Range("G7").Value
SH_H_DCTLTR.Range("E8").Value = SH_H_DCTLTR.Range("S9").Value
SH_H_DCTLTR.Range("E9").Value = SH_H_DCTLTR.Range("O9").Value
SH_H_DCTLTR.Range("E10").Value = SH_H_DCTLTR.Range("G10").Value
SH_H_DCTLTR.Range("E11").Value = SH_H_DCTLTR.Range("L9").Value
SH_H_DCTLTR.Range("E12").Value = SH_H_DCTLTR.Range("N9").Value
End If
End If
End Sub
Sub DUCTRESET()
Attribute DUCTRESET.VB_Description = "Macro recorded 8/19/96 by  "
Attribute DUCTRESET.VB_ProcData.VB_Invoke_Func = " \n14"
'
' DUCTRESET Macro
' Macro recorded 8/19/96 by
'

Application.ScreenUpdating = False: Call air
Range("C7:E10").Select
    Selection.ClearContents
    Range("E11:E12").Select
    Selection.ClearContents
    Range("C7").Select
End Sub
Attribute VB_Name = "Module12"
Attribute VB_Name = "Module13"
Sub proper()
Attribute proper.VB_Description = "Macro recorded 7/17/1995 by Mai"
Attribute proper.VB_ProcData.VB_Invoke_Func = "q\n14"
'
' paste_value Macro
' Macro recorded 7/17/1995 by Mai
'

'
  
 Application.ScreenUpdating = False: Call air
 ActiveSheet.UNPROTECT
  DEDE = """" & ActiveCell.Value & """"
 ActiveCell.FormulaR1C1 = "" & "=proper(" & DEDE & ")" & ""
ActiveCell.Copy
ActiveCell.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
 
 
mai = Selection.Font.Size
Selection.Font.Size = mai + 1
ActiveSheet.Protect

End Sub

Attribute VB_Name = "Module14"

Function Multi_If(ARRAY1, ARRAY2, VARIABLE)
Attribute Multi_If.VB_Description = "Macro recorded 13-06-1995 by Mai"
Attribute Multi_If.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
' Macro recorded 13-06-1995 by Mai
'
    
For i = 1 To 500
If ARRAY1(i) = VARIABLE Then Multi_If = ARRAY2(i)
 Next i
End Function

Attribute VB_Name = "Module15"
Attribute VB_Name = "Module17"

Sub REPLACE()
Attribute REPLACE.VB_ProcData.VB_Invoke_Func = "r\n14"



Application.ScreenUpdating = False: Call air
'ActiveWorkbook.UNPROTECT

'may = Sheets.Count
'For x = 1 To may

'Sheets(x).Visible = -1
'Sheets(x).Select
'If Left(Sheets(x).Name, 6) = "Dialog" Or Left(Sheets(x).Name, 6) = "dialog" Or Left(Sheets(x).Name, 6) = "DIALOG" Then GoTo LINE1:

ActiveSheet.UNPROTECT
For i = 1 To 30
For j = 1 To 30
Cells(i, j).Select

If Cells(i, j).Value = "PREPARED BY MHD EL-MAI, MHD MAWASSI, FADI ABDUL RAHIM" Then Cells(i, j) = "Prepared by Engs. Mohamed El-Mai and Elie Tohme"
Next j
Next i
'LINE1:
ActiveSheet.Protect

'Sheets(x).Visible = 0

'Next x
'ActiveWorkbook.PROTECT


'Dim SHT_PUMP_NAME(200)
'may = Sheets.Count

'j = 1
'For i = 1 To may
'If Left(Sheets(i).Name, 4) = "BPS_" And Right(Sheets(i).Name, 10) = "_DISCHARGE" Then
'j = j + 1
'End If

'Next i

End Sub
Sub mmmmmmm()
'
' mmmmmmm Macro
' Macro recorded 7/19/1995 by Mai
'

'
End Sub

Attribute VB_Name = "Module19"
Sub power()
Attribute power.VB_Description = "Macro recorded 10/4/1996 by user"
Attribute power.VB_ProcData.VB_Invoke_Func = " \n14"
'
' POWER Macro
' Macro recorded 10/4/1996 by user
'

'
    ActiveWindow.SmallScroll ToRight:=7
    Range("N3").Select
    ActiveCell.FormulaR1C1 = "=R[9]C[4]"
    Range("I4").Select
    ActiveCell.Formula = "=M4"
    
    Range("N4").Select
    ActiveWindow.SmallScroll ToRight:=-7
End Sub
Sub RESETBOOSTER()
Attribute RESETBOOSTER.VB_Description = "Macro recorded 10/4/1996 by user"
Attribute RESETBOOSTER.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RESETBOOSTER Macro
' Macro recorded 10/4/1996 by user
'

'
    Range("F6").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("N3").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("F9:F11").Select
    Selection.ClearContents
    Range("F14:F15").Select
    Selection.ClearContents
    Range("I4").Select
    ActiveCell.FormulaR1C1 = ""
    ActiveWindow.SmallScroll ToLEFT:=2
End Sub
Attribute VB_Name = "Module2"
Sub PASSWORD_SHEETS_PROTECTION()
Application.ScreenUpdating = False: Call air
'NEW PASSWORD
a = "LUC_"
a1 = "PH_RM"
a2 = "_2002"
'OLD WORKBOOK PASSWORD IF PROTECT
B = ""
'OLD WORKBOOK PASSWORD IF UNPROTECT
''B = "LUC_PH_RM_2002"
ActiveWorkbook.UNPROTECT Password:=B
mai = Sheets.Count
For i = 1 To mai
osa = ActiveSheet.Name

Sheets(i).Visible = -1
Sheets(i).Select
Sheets(osa).Visible = 0
'OLD SHEET PASSWORD
ActiveSheet.UNPROTECT Password:=B
'NEW SHEET PASSWORD IF PROTECT
ActiveSheet.Protect Password:=a & a1 & a2
''NEW SHEET PASSWORD IF UNPROTECT
''ActiveSheet.PROTECT PASSWORD:= QWE & RTY & UIO
Next i
'Sheets("LIST REFERENCE").Visible = -1
'Sheets("List reference").Select: ActiveSheet.UNPROTECT password:= qwe & rty & uio
'WITH NEW PASSWORD
'Sheets("LIST REFERENCE").UNPROTECT password:=a & a1 & a2
'Sheets("LIST REFERENCE").Visible = 0
'NEW WORKBOOK PASSWORD IF PROTECT
ActiveWorkbook.Protect Password:=a & a1 & a2
''NEW WORKBOOK PASSWORD IF UNPROTECT
''ActiveWorkbook.PROTECT PASSWORD:= QWE & RTY & UIO
'*N.B. Don't forget to replace the password in the current project to avoid debugging. BUT THIS
' MUST BE AFTER RUNNING THIS MACRO.
End Sub


Attribute VB_Name = "Module20"
Sub bstr_exp_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("G23")
OSA2 = Range("G24")
OSA3 = Range("G25")
OSA4 = Range("G26")


  DialogSheets("Dialog_bstr_exp_DATA").Visible = -1
 DialogSheets("Dialog_bstr_exp_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_bstr_exp_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3
ActiveSheet.Shapes("Edit Box 7").Select
Selection.Characters.Text = OSA4
Sheets(osa).Select
DialogSheets("Dialog_bstr_exp_DATA").Show

End Sub

Sub bstr_exp_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_bstr_exp_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 7").Select
  mai4 = Selection.Characters.Text
 
  
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  DialogSheets("Dialog_bstr_exp_DATA").Visible = 0

  Range("G23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("G24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("G25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("G26").Select
  ActiveCell.FormulaR1C1 = mai4
Range("f29:g29").Select
  
  'ActiveWorkbook.PROTECT password:= qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub bstr_exp_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_bstr_exp_DATA").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub Reset_bstr_exp()
'
' Reset_bstr_exp Macro
' Macro recorded 10/30/1996 by user
'

'
    Application.ScreenUpdating = False: Call air
    If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If


    Range("f29:g31,f35:g35,f40:g41,G23:G26").ClearContents
   
    Range("n3").Select
    ActiveCell.FormulaR1C1 = "1"
   
    
 DialogSheets("Dialog_bstr_exp_DATA").Visible = -1
    Sheets("Dialog_bstr_exp_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 7").Select
    Selection.Characters.Text = ""
    
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("booster expansion tank").Select
    DialogSheets("Dialog_bstr_exp_DATA").Visible = 0
    Sheets("Dialog_option_bstr_exp").Visible = 0
   Sheets("List reference").Visible = 0
    
     ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 60
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("L48").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
    Range("f29:g29").Select
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub



Sub PRINT_bstr_exp()
'
' PRINT_BOOSTER_bstr_exp_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    With ActiveSheet.PageSetup
        .PrintTitleRows = ""
        .PrintTitleColumns = ""
    End With
    ActiveSheet.PageSetup.PrintArea = "$B$21:$H$46"
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&8&D"
        .CenterFooter = ""
        .RightFooter = "&8Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.2)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 100
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("C23:C26,G23:G26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 9.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    
  Range("B28:j46").Select
    Range("B28").Activate
    Selection.Interior.ColorIndex = xlNone
    
    Range("B29:e32,B35:e36,B39:e41,B44:e46").Select
    Range("B44").Activate
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
    
    
 Rows("10:27").Select
 Selection.EntireRow.Hidden = False
 
 
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True

 Range("B28:j46").Select
    Range("B28").Activate
    With Selection.Interior
        .ColorIndex = 50
        .Pattern = xlSolid
    End With
     
     Range("B29:g32,B35:g36,B39:g41,B44:g46").Select
    Range("B44").Activate
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
      
    Range("f29:g31,f35:g35,f40:g41").Select
    Range("f40").Activate
    With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
         End With
 Rows("10:27").Select
Selection.EntireRow.Hidden = True
 

   ActiveSheet.PageSetup.PrintArea = ""
   
    ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 60
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("L48").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
     Range("f29:g29").Select
    
       ActiveSheet.Protect Password:=qwe & rty & uio
       
End Sub

Sub option_bstr_exp()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

'DAREEN = Range("J27")
Dim SHT_tank_NAME(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 10) = "BSTR_TANK_" Then
SHT_tank_NAME(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 34) = SHT_tank_NAME(i)
Next i


LST_NAME = "'List reference'!$Ah$3:$Ah$" & j + 2
Sheets("Dialog_option_bstr_exp").Visible = -1
Sheets("Dialog_option_bstr_exp").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio


    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$Ah$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("booster expansion tank").Select
  
    DialogSheets("Dialog_option_bstr_exp").Show

  
End Sub

Sub OPEN_bstr_exp()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("Dialog_OPTION_bstr_exp").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No tank has been selected to be opened."), "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("booster expansion tank").Select: Sheets("Dialog_OPTION_bstr_exp").Visible = 0:    Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no tank with this No. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("booster expansion tank").Select: Sheets("Dialog_OPTION_bstr_exp").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
   
   ActiveSheet.Protect Password:=qwe & rty & uio
   
   Sheets("booster expansion tank").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("Dialog_OPTION_bstr_exp").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("booster expansion tank").Visible = 0
    
   
 Sheets("Dialog_option_bstr_exp").Visible = -1
   Sheets("Dialog_option_bstr_exp").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_option_bstr_exp").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub SAVE_bstr_exp()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
   
   

Dim tankNO As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

tankNO = UCase(Range("G26"))
If Len(tankNO) > 21 Then MsgBox ("The number of tank No. characters must be less than 22."), vbCritical, "MAI Fire Fighting Calculations": Call bstr_exp_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If tankNO = "" Then MsgBox ("The tank No. has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call bstr_exp_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("BSTR_TANK_" & tankNO)

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This tank No. has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call bstr_exp_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("n26").Select
'ActiveCell.FormulaR1C1 = tankNO
         
     
  Sheets("booster expansion tank").Select
   Sheets("booster expansion tank").Copy Before:=Sheets(1)
  'tankNO1 = Range("n26")
   With ActiveCell.Characters(Start:=1, length:=6).Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
  End With
Sheets("booster expansion tank (2)").Select
 Sheets("booster expansion tank (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("c1") = "BSTR_TANK_" & Range("G26")
 ActiveSheet.Shapes("Button 3").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 2").Select
    Selection.OnAction = "Back_to_bstr_exp"
    Range("A1:k1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
   ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 60
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("L48").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
    Range("f29:g29").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "BSTR_TANK_" & tankNO
Sheets("booster expansion tank").Select

Call Reset_bstr_exp
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("booster expansion tank").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("Dialog_OPTION_bstr_exp").Visible = 0
Sheets("List reference").Visible = 0
'ActiveWorkbook.PROTECT password:= qwe & rty & uio Structure:=True, Windows:=False


ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub DELETE_bstr_exp()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("Dialog_option_bstr_exp").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
  If may = "" Then MsgBox ("No tank has been selected to be deleted."), "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("booster expansion tank").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("Dialog_OPTION_bstr_exp").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no tank with this No. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("booster expansion tank").Select: Sheets("Dialog_OPTION_bstr_exp").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("Dialog_option_bstr_exp").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("booster expansion tank").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_option_bstr_exp").Visible = 0
   Sheets("List reference").Visible = 0
   
    
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_bstr_exp_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("booster expansion tank").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_option_bstr_exp").Visible = 0
Sheets("List reference").Visible = 0
'ActiveWorkbook = PROTECT password:= qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_bstr_exp()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("booster expansion tank").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("booster expansion tank").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub




Attribute VB_Name = "Module23"
Sub Back_to_Main_Menu()
Attribute Back_to_Main_Menu.VB_Description = "Macro recorded 7/5/1995 by Mai"
Attribute Back_to_Main_Menu.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio


If ActiveSheet.Name = "PIPULATOR" Then
ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 60
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("N25").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
 Range("d11").Select
 End If

If ActiveSheet.Name = "DUCTULATOR" Then
ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 60
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("J18").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
 Range("C7").Select
 End If

If ActiveSheet.Name = "UNITS CONVERTOR" Then
ActiveWindow.FreezePanes = False
Range("k3").Value = 1
 ActiveWindow.Zoom = 80
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("O19").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
 End If



If ActiveSheet.Name = "FIRE HOSE CABINET PUMP" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 50
ActiveWindow.ScrollRow = 1
ActiveWindow.ScrollColumn = 1
Range("Z31").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 63
Range("S5:V5").Select
End If

If ActiveSheet.Name = "FIRE PUMP FOR SPRINKLER" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 80
ActiveWindow.ScrollRow = 1
ActiveWindow.ScrollColumn = 1
Range("L15").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 100
Range("C5:G9").Select
End If

If ActiveSheet.Name = "FIRE PUMP FOR COMBINED SYSTEM" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 80
ActiveWindow.ScrollRow = 1
ActiveWindow.ScrollColumn = 1
Range("L15").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 100
Range("C5:G9").Select
End If

If ActiveSheet.Name = "JOCKEY PUMP" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 70
ActiveWindow.ScrollRow = 1
ActiveWindow.ScrollColumn = 1
Range("P14").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 100
Range("C5").Select
End If

If ActiveSheet.Name = "FIRE HOSE CABINET PIPING SIZING" Then

 mai = Range("b6")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter3
counter3 = 29
Do While counter3 < mai + 28
Cells(counter3, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE101:
End If

            prop = UCase(Cells(counter3, 7).Value)
            Cells(counter3, 7).Value = prop
LINE101:

            counter3 = counter3 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio



ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
ActiveWindow.ScrollRow = 1
ActiveWindow.ScrollColumn = 1
Range("R29").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 75
Range("d6").Select
End If

If ActiveSheet.Name = "SPRINKLERS PIPING SIZING" Then

 mai = Range("b12")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 5).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE102:
End If

            prop = UCase(Cells(counter13, 5).Value)
            Cells(counter13, 5).Value = prop
LINE102:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
ActiveWindow.ScrollRow = 1
ActiveWindow.ScrollColumn = 1
Range("O29").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 75
Range("d12").Select
End If

If ActiveSheet.Name = "COMBINED SYSTEM PIPING SIZING" Then

mai = Range("B18")
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop

ActiveSheet.Protect Password:=qwe & rty & uio

Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("U30").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 65
Range("d18").Select
End If

If ActiveSheet.Name = "CO2 SYSTEM PIPING SIZING" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("L29").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 75
Range("d11").Select
End If

If ActiveSheet.Name = "FIRE SPRINKLERS DISTRIBUTION" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("M29").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 72
Range("d9").Select
End If

If ActiveSheet.Name = "FM-200 NOZZLES DISTRIBUTION" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("N29").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 75
Range("d7").Select
End If

If ActiveSheet.Name = "CO2 NOZZLES DISTRIBUTION" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("N29").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 75
Range("d7").Select
End If

If ActiveSheet.Name = "FM-200 SYSTEM STORAGE CAPACITY" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("N40").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 75
Range("b29").Select
End If

If ActiveSheet.Name = "CO2 STORAGE CAPACITY" Then
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 25
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
Range("Z104").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 55
If Range("c4") = 1 Then Range("b31").Select
If Range("c4") = 2 Then Range("b44").Select
If Range("c4") = 3 Then Range("b57").Select
If Range("c4") = 4 Then Range("b70").Select
End If

Sheets("mECHANICAL").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("mECHANICAL").Select
 ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 60
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("n25").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
Range("H28").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "Module24"
Public qwe As String
Public rty As String
Public uio As String

Sub MECHANICAL_PROJECT_DATA()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
  DialogSheets("Dialog_PROJECT_DATA").Visible = -1
  DialogSheets("Dialog_PROJECT_DATA").Show

End Sub

Sub MECHANICAL_PROJECT_DATA_OK_NEW()

Application.ScreenUpdating = False: Call air

  Sheets("Dialog_PROJECT_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveSheet.Shapes("Edit Box 5").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 7").Select
  mai3 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 8").Select
  mai4 = Selection.Characters.Text
  ActiveSheet.Protect Password:=qwe & rty & uio
  M_T1.Select
  DialogSheets("Dialog_PROJECT_DATA").Visible = 0
  Sheets("List reference").Visible = -1
 Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  mai = Application.WorksheetFunction.CountA(Columns(131)) - 1

For i = 1 To mai
MAJ = Cells(i + 1, 131)
Sheets(MAJ).Visible = -1
With Sheets(MAJ)
.Range("c23") = mai1
.Range("c24") = mai2
.Range("c25") = mai3
.Range("c26") = mai4
End With
Sheets(MAJ).Visible = 0
Next i

  Sheets("MAI Fire Fighting Calculations").Select
  Sheets("list Reference").Visible = 0

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub MECHANICAL_PROJECT_DATA_OK_OLD()
Application.ScreenUpdating = False: Call air
  Sheets("Dialog_PROJECT_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveSheet.Shapes("Edit Box 5").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 7").Select
  mai3 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 8").Select
  mai4 = Selection.Characters.Text
  ActiveSheet.Protect Password:=qwe & rty & uio
M_T1.Select
  DialogSheets("Dialog_PROJECT_DATA").Visible = 0

Sheets("BOOSTER PUMP SET HEAD").Visible = -1
Sheets("FIRE HOSE CABINET PUMP").Visible = -1
Sheets("BOOSTER PUMP SET DISCHARGE").Visible = -1
Sheets("HOT WATER CIRCULATING PUMP").Visible = -1
Sheets("SUBMERSIBLE PUMP DISCHARGE").Visible = -1
Sheets("SUBMERSIBLE PUMP HEAD").Visible = -1
Sheets("SUMP PIT").Visible = -1
Sheets("FIRE HOSE CABINET PIPING SIZING").Visible = -1
Sheets("COMBINED SYSTEM PIPING SIZING").Visible = -1
Sheets("SPRINKLERS PIPING SIZING").Visible = -1
Sheets("CO2 SYSTEM PIPING SIZING").Visible = -1
Sheets("FIRE SPRINKLERS DISTRIBUTION").Visible = -1
Sheets("FM-200 NOZZLES DISTRIBUTION").Visible = -1
Sheets("DEEP SEATED FIRES").Visible = -1
Sheets("VOLUME CALCULATION METHOD").Visible = -1
Sheets("AREA CALCULATION METHOD").Visible = -1
Sheets("SURFACE FIRES").Visible = -1
Sheets("FM-200 SYSTEM STORAGE CAPACITY").Visible = -1
Sheets("ROOF DRAINS").Visible = -1
Sheets("RAIN WATER DRAINAGE PIPES").Visible = -1
Sheets("WASTE DRAINAGE PIPES").Visible = -1
Sheets("VENT PIPES").Visible = -1
Sheets("COLD & HOT WATER PIPES").Visible = -1
Sheets("HOT WATER RETURN PIPES").Visible = -1
Sheets("COMPRESSED AIR PIPES").Visible = -1
Sheets("VACUUM AIR PIPES").Visible = -1
Sheets("FUEL PIPES").Visible = -1
Sheets("SUBMERSIBLE PUMP DISCHARGE PIPE").Visible = -1

  Sheets(Array("BOOSTER PUMP SET HEAD", "FIRE HOSE CABINET PUMP", "BOOSTER PUMP SET DISCHARGE", "HOT WATER CIRCULATING PUMP", "SUBMERSIBLE PUMP DISCHARGE", "SUBMERSIBLE PUMP HEAD", "SUMP PIT", "FIRE HOSE CABINET PIPING SIZING", "COMBINED SYSTEM PIPING SIZING", "SPRINKLERS PIPING SIZING", "CO2 SYSTEM PIPING SIZING", "FIRE SPRINKLERS DISTRIBUTION", "FM-200 NOZZLES DISTRIBUTION", "DEEP SEATED FIRES", "VOLUME CALCULATION METHOD", "AREA CALCULATION METHOD", "SURFACE FIRES", "FM-200 SYSTEM STORAGE CAPACITY", "ROOF DRAINS", "RAIN WATER DRAINAGE PIPES", "WASTE DRAINAGE PIPES", "VENT PIPES", "COLD & HOT WATER PIPES", "HOT WATER RETURN PIPES", "COMPRESSED AIR PIPES", "VACUUM AIR PIPES", "FUEL PIPES", "SUBMERSIBLE PUMP DISCHARGE PIPE")).Select
  Sheets("BOOSTER PUMP SET DISCHARGE").Activate
  Range("c23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("c24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("c25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("c26").Select
  ActiveCell.FormulaR1C1 = mai4
  Range("a1").Select
  Sheets("MAI Fire Fighting Calculations").Select
  Sheets(Array("BOOSTER PUMP SET HEAD", "FIRE HOSE CABINET PUMP", "BOOSTER PUMP SET DISCHARGE", "HOT WATER CIRCULATING PUMP", "SUBMERSIBLE PUMP DISCHARGE", "SUBMERSIBLE PUMP HEAD", "SUMP PIT", "FIRE HOSE CABINET PIPING SIZING", "COMBINED SYSTEM PIPING SIZING", "SPRINKLERS PIPING SIZING", "CO2 SYSTEM PIPING SIZING", "FIRE SPRINKLERS DISTRIBUTION", "FM-200 NOZZLES DISTRIBUTION", "DEEP SEATED FIRES", "VOLUME CALCULATION METHOD", "AREA CALCULATION METHOD", "SURFACE FIRES", "FM-200 SYSTEM STORAGE CAPACITY", "ROOF DRAINS", "RAIN WATER DRAINAGE PIPES", "WASTE DRAINAGE PIPES", "VENT PIPES", "COLD & HOT WATER PIPES", "HOT WATER RETURN PIPES", "COMPRESSED AIR PIPES", "VACUUM AIR PIPES", "FUEL PIPES", "SUBMERSIBLE PUMP DISCHARGE PIPE")).Visible = 0
  'ActiveWorkbook.PROTECT password:= qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub MECHANICAL_PROJECT_DATA_CANCEL()
Application.ScreenUpdating = False: Call air
Sheets("MAI Fire Fighting Calculations").Select
DialogSheets("Dialog_PROJECT_DATA").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub air()
qwe = "LUC_"
rty = "PH_RM_"
uio = "2002"
End Sub
Attribute VB_Name = "Module25"

Sub DUCTRESET()
'
' RESETNOISECALCULATION Macro
' Macro recorded 10/27/01 by wissam
'

Application.ScreenUpdating = False: Call air
    Range("E7").Select
    Selection.ClearContents
    Range("F8:M8").Select
    Selection.ClearContents
    Range("C10").Select
    Selection.ClearContents
    Range("E10").Select
    Selection.ClearContents
    Range("C12:C14").Select
    Selection.ClearContents
    Range("E12:E14").Select
    Selection.ClearContents
    Range("C16:C18").Select
    Selection.ClearContents
    Range("E16:E18").Select
    Selection.ClearContents
    Range("C20").Select
    Selection.ClearContents
    Range("E20").Select
    Selection.ClearContents
    Range("B2:B4").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=15
    Range("C25").Select
    Selection.ClearContents
    Range("C30:C31").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=9
    Range("C39").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-156

End Sub
Attribute VB_Name = "Module28"
Sub REPLACE_TITLE()
Attribute REPLACE_TITLE.VB_Description = "Macro recorded 24-07-1996 by Mai"
Attribute REPLACE_TITLE.VB_ProcData.VB_Invoke_Func = " \n14"
'
' MM Macro
' Macro recorded 24-07-1996 by Mai
'

'
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT

  Sheets("List reference").Visible = -1
 Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  mai = Application.WorksheetFunction.CountA(Columns(131)) - 1

For i = 1 To mai
MAJ = Cells(i + 1, 131)
Sheets(MAJ).Visible = -1
Sheets(MAJ).Select
Sheets(MAJ).UNPROTECT

Range("B21").Select
    ActiveCell.FormulaR1C1 = "MAI Fire Fighting Calculations"
    With ActiveCell.Characters(Start:=1, length:=3).Font
        .Name = "Arial"
        .FontStyle = "Bold Italic"
        '.Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    With ActiveCell.Characters(Start:=4, length:=1).Font
        .Name = "Arial"
        .FontStyle = "Bold"
        '.Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    With ActiveCell.Characters(Start:=5, length:=23).Font
        .Name = "Arial"
        .FontStyle = "Regular"
        '.Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
Sheets(MAJ).Protect
Sheets(MAJ).Visible = 0
Next i

  Sheets("MECHANICAL").Select
  Sheets("list Reference").Visible = 0


ActiveWorkbook.Protect

End Sub
Attribute VB_Name = "Module3"
Sub RESET_NEW()
Attribute RESET_NEW.VB_Description = "Macro recorded 2/12/01 by MAI"
Attribute RESET_NEW.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RESET_NEW Macro
' Macro recorded 2/12/01 by MAI
'

'
   Application.ScreenUpdating = False: Call air
    Range("L10:L34").Select
    Selection.ClearContents
    Range("M39").Select
    Selection.ClearContents
    Range("L10").Select
    
    
End Sub
Attribute VB_Name = "Module31"
Sub Macro1000()
Attribute Macro1000.VB_Description = "Macro recorded 8/10/96 by  "
Attribute Macro1000.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
' Macro recorded 8/10/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveWindow.WindowState = xlMinimized
    ActiveWorkbook.Close
    ActiveWindow.WindowState = xlMaximized
End Sub
Attribute VB_Name = "Module32"

Function MIF(a, B, C)
For i = 1 To 100
If a = B(i) Then
MIF = C(i)
Exit For
End If
Next i
End Function
Function condensate(data, load)
If load = 0 Then condensate = ""
If load > 430 Then condensate = 5: Exit Function
For i = 1 To 15
If load > data(i, 2) And load <= data(i + 1, 2) Then condensate = data(i + 1, 1): Exit Function
Next i
End Function
'Function condensate(data, load)
'If load > 430 Then condensate = 5: Exit Function
'For I = 1 To 15
'If load > data(I, 2) And load <= data(I + 1, 2) Then condensate = data(I + 1, 1): Exit Function
'Next I
'End Function
Function refr_test(data, length_m)
l = length_m * 1.5
Lomc = 0
For i = 1 To 12
If l > data(1, i) And l <= data(1, i + 1) Then Lomc = i + 1: Exit For
Next i
If Lomc = 0 Then MsgBox ("Length of pipe must be less then 60 m."), vbCritical, "MAI Fire Fighting Calculations"
End Function

Function refr(data, load_tons, length_m)
refr = 0
l = length_m * 1.5
Lomc = 0
For i = 1 To 12
If l > data(1, i) And l <= data(1, i + 1) Then Lomc = i + 1: Exit For
Next i
If Lomc = 0 Then
'MsgBox ("Length of pipe must be less then 60 m."), vbCritical, "MAI Fire Fighting Calculations"
Exit Function
Else
For i = 2 To 16
If load_tons > data(i, Lomc) And load_tons <= data(i + 1, Lomc) Then refr = data(i + 1, 1): Exit For
Next i
End If
If refr = 0 Then MsgBox ("Cooling capacity is high, No calculation exist for the refrigerant pipes."), vbCritical, "MAI Fire Fighting Calculations"
End Function

Function open_exp_tank_test(a, B)
If a < B Then MsgBox ("Min. temperature must be less then max. temperature."), vbCritical, "MAI Fire Fighting Calculations"
End Function
Function open_exp_tank_height(w, l, h, flow)
open_exp_tank_height = 0
'If flow > 0 And w <> 0 And w < 30 Then MsgBox ("Vessel width should not be less then 30 cm"),,"MAI Fire Fighting Calculations"
'If flow > 0 And l <> 0 And l < 30 Then MsgBox ("Vessel length should not be less then 30 cm"),,"MAI Fire Fighting Calculations"
If h < 40 And h <> 0 And flow > 0 Then MsgBox ("The Vessel length or width should be decreased"), , "MAI Fire Fighting Calculations"
'If w >= 30 And l >= 30 And h >= 40 Then open_exp_tank_height = h
If h >= 40 Then open_exp_tank_height = h

End Function
Function total_equiv_length_pump_head(MAT, DATA_ENTRY_FITTINGS, DATA_EQUIV_LENGTH, DATA_INTER_DIAM, INTER_DIAM)
For i = 1 To 15

If INTER_DIAM = DATA_INTER_DIAM(i, MAT) Then
total_equiv_length_pump_head = DATA_ENTRY_FITTINGS(1, 1) * DATA_EQUIV_LENGTH(i, 1) + DATA_ENTRY_FITTINGS(1, 2) * DATA_EQUIV_LENGTH(i, 2) + DATA_ENTRY_FITTINGS(1, 3) * DATA_EQUIV_LENGTH(i, 3) + DATA_ENTRY_FITTINGS(1, 4) * DATA_EQUIV_LENGTH(i, 4) + DATA_ENTRY_FITTINGS(1, 5) * DATA_EQUIV_LENGTH(i, 5) + DATA_ENTRY_FITTINGS(1, 6) * DATA_EQUIV_LENGTH(i, 6) + DATA_ENTRY_FITTINGS(1, 7) * DATA_EQUIV_LENGTH(i, 7) + DATA_ENTRY_FITTINGS(1, 8) * DATA_EQUIV_LENGTH(i, 8) + DATA_ENTRY_FITTINGS(1, 9) * DATA_EQUIV_LENGTH(i, 9)
Exit For
End If
Next i

End Function
Function pump_head_internal_diameter(MAT, data, diameter)
For i = 1 To 15

If diameter = data(i, 6) Then
pump_head_internal_diameter = data(i, MAT)
Exit For
End If
Next i

End Function

Function Bstr_EXp_TANK_P1_P2_H0(P1, P2, H0, Pc, Cond_p2, cond_pc)
Bstr_EXp_TANK_P1_P2_H0 = 0
If Cond_p2 > 0 And P2 < P1 Then MsgBox ("Switch On pressure must be less than switch Off pressure."), vbCritical, "MAI Fire Fighting Calculations": Bstr_EXp_TANK_P1_P2_H0 = 1: Exit Function
If Cond_p2 > 0 And P2 > H0 Then MsgBox ("Switch Off pressure must be less than pump zero-flow pressure."), vbCritical, "MAI Fire Fighting Calculations": Bstr_EXp_TANK_P1_P2_H0 = 1: Exit Function
If cond_pc > 0 And Pc > P1 Then MsgBox ("Tank precharge pressure must be less than switch On pressure."), vbCritical, "MAI Fire Fighting Calculations": Bstr_EXp_TANK_P1_P2_H0 = 1
End Function
Function exp_tank_TANK_PPW_PAC(PPW, PAC)
If PPW * PAC > 0 Then
If PPW <= PAC Then MsgBox ("Air Cushion Pressure(Pac) must be less than Max. Allowable Pressure(Ppw)."), vbCritical, "MAI Fire Fighting Calculations":  Exit Function
If PPW > 8 Or PAC > 8 Then MsgBox ("Air Cushion Pressure(Pac) and Max. Allowable Pressure(Ppw)can not be greater than 8."), vbCritical, "MAI Fire Fighting Calculations"
End If

End Function

Function CLOSED_EXp_TANK_PPW_PAC(PPW, PAC)
If PPW * PAC > 0 Then
If PPW <= PAC Then MsgBox ("Air Cushion Pressure(Pac) must be less than Max. Allowable Pressure(Ppw)."), vbCritical, "MAI Fire Fighting Calculations":  Exit Function
If PPW > 8 Or PAC > 8 Then MsgBox ("Air Cushion Pressure(Pac) and Max. Allowable Pressure(Ppw)can not be greater than 8."), vbCritical, "MAI Fire Fighting Calculations"
End If

End Function

Function FRIC_LOSS_PSI_100FT(Q_GPM, C, D_INCH)

FRIC_LOSS_PSI_100FT = 452 * Q_GPM ^ 1.85 / C ^ 1.85 / D_INCH ^ 4.87
End Function

Function DIAM_INCH(Q_GPM, C, DP_PSI_100FT)

DIAM_INCH = (452 * Q_GPM ^ 1.85 / C ^ 1.85 / DP_PSI_100FT) ^ (1 / 4.87)
End Function

Function VELOCITY_F_S(Q_GPM, D_INCH)

VELOCITY_F_S = (Q_GPM / 15.85 / 1000 / 3.1416 / (D_INCH * 0.0254) ^ 2 * 4) * 3.28
End Function

'Function FRIC_LOSS_PSI_100FT(Q_GPM, C, D_INCH)

'FRIC_LOSS_PSI_100FT = 452 * Q_GPM ^ 1.85 / C ^ 1.85 / D_INCH ^ 4.87
'End Function

'Function DIAM_INCH(Q_GPM, C, DP_PSI_100FT)

'DIAM_INCH = (452 * Q_GPM ^ 1.85 / C ^ 1.85 / DP_PSI_100FT) ^ (1 / 4.87)
'End Function

'Function VELOCITY_F_S(Q_GPM, D_INCH)

'VELOCITY_F_S = (Q_GPM / 15.85 / 1000 / 3.1416 / (D_INCH * 0.0254) ^ 2 * 4) * 3.28
'End Function



Function Calculate(a, C, data)
'a gpm
'c material
'data diameters

  Select Case a
  Case 0 To 40:
  MINDIAM = (a / 15.85 * 1000 / 1.22 * 28 / 22) ^ 0.5 / 25.4
  Case 40.00000001 To 1268:
  MINDIAM = DIAM_INCH(a, C, 1.8)
  Case Is > 1268
  MINDIAM = (a / 15.85 * 1000 / 3 * 28 / 22) ^ 0.5 / 25.4
  End Select
  
   Col = 1 + Range("aq8").Value
   
   
  For i = 2 To 21
   If (MINDIAM > data(i - 1, Col) And MINDIAM <= data(i, Col)) Then
    INTDIAM = data(i, Col)
    stddiam = data(i, 1)
    Exit For
   End If
  Next i

If INTDIAM = 0 Then
  MsgBox ("No selection exist for your data,Try another material")
Else
 Calculate = stddiam
 End If
 
End Function
Function radiator(a, data)
radiator = 100
a = WorksheetFunction.proper(a)
For i = 1 To 30
If a = data(i, 2) Then
radiator = data(i, 1)
End If
Next i
'If radiator = 100 Then B = MsgBox("Radiator type is not correct, Try another type", , "M&T")

End Function


Function ROOF_DRAIN_SIZE(area, RAIN_FALL, data)

For i = 1 To 7
If area * Range("u33") > data(i, 1 + RAIN_FALL) And area * Range("u33") <= data(i + 1, 1 + RAIN_FALL) Then
ROOF_DRAIN_SIZE = data(i + 1, 1)
Exit For
End If
Next i


End Function

Function RW_PIPES_AREA_FROM_DFU(RAIN_FALL, DFU)
If DFU > 0 And DFU <= 256 Then RW_PIPES_AREA_FROM_DFU = 1000 * 4 / (RAIN_FALL + 1)
If DFU > 256 Then RW_PIPES_AREA_FROM_DFU = DFU * 3.9 * 4 / (RAIN_FALL + 1)

End Function
Function RW_PIPES_SIZE(RAIN_FALL, TOTAL_AREA, PIPE_SLOPE, data)

If PIPE_SLOPE = 1 Then

For i = 1 To 9
If TOTAL_AREA * Range("y34") > data(i, RAIN_FALL + 1) And TOTAL_AREA * Range("y34") <= data(i + 1, RAIN_FALL + 1) Then
RW_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

ElseIf PIPE_SLOPE = 2 Then

For i = 1 To 9
If TOTAL_AREA * Range("y34") > data(i, RAIN_FALL + 6) And TOTAL_AREA * Range("y34") <= data(i + 1, RAIN_FALL + 6) Then
RW_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

ElseIf PIPE_SLOPE = 3 Then

For i = 1 To 9
If TOTAL_AREA * Range("y34") > data(i, RAIN_FALL + 11) And TOTAL_AREA * Range("y34") <= data(i + 1, RAIN_FALL + 11) Then
RW_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

ElseIf PIPE_SLOPE = 4 Then

For i = 1 To 9
If TOTAL_AREA * Range("y34") > data(i, RAIN_FALL + 16) And TOTAL_AREA * Range("y34") <= data(i + 1, RAIN_FALL + 16) Then
RW_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

End If
End Function

Function WASTE_PIPES_SIZE(TOTAL_DFU, PIPE_SLOPE_OR_DESCRIPTION, DRAIN_TYPE, data)

If UCase(DRAIN_TYPE) = "BDS" Then

For i = 1 To 12
If TOTAL_DFU > data(i, PIPE_SLOPE_OR_DESCRIPTION + 1) And TOTAL_DFU <= data(i + 1, PIPE_SLOPE_OR_DESCRIPTION + 1) Then
WASTE_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

ElseIf UCase(DRAIN_TYPE) = "HFBS" Then

For i = 1 To 12
If TOTAL_DFU > data(i, PIPE_SLOPE_OR_DESCRIPTION + 5) And TOTAL_DFU <= data(i + 1, PIPE_SLOPE_OR_DESCRIPTION + 5) Then
WASTE_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

End If

End Function
Function WASTE_PIPES_PIPE_DESCRIPTION_NOT_ENTERED(TOTAL_DFU, PIPE_DESCRIPTION, DRAIN_TYPE)

If TOTAL_DFU = 0 Then Exit Function
par = 0
If DRAIN_TYPE = "BDS" Then
If TOTAL_DFU > 0 And UCase(PIPE_DESCRIPTION) = "0.5% SLOPE" Or UCase(PIPE_DESCRIPTION) = "1% SLOPE" Or UCase(PIPE_DESCRIPTION) = "2% SLOPE" Or UCase(PIPE_DESCRIPTION) = "4% SLOPE" Then
par = 1

End If
If par = 0 Then MsgBox ("The pipe description has not been entered (0.5% SLOPE,1% SLOPE, 2% SLOPE or 4% SLOPE)"), , "MAI Fire Fighting Calculations"
End If

If DRAIN_TYPE = "HFBS" Then
If TOTAL_DFU > 0 And UCase(PIPE_DESCRIPTION) = "HB<3ST" Or UCase(PIPE_DESCRIPTION) = "S<3ST" Or UCase(PIPE_DESCRIPTION) = "S>3ST" Or UCase(PIPE_DESCRIPTION) = "MHB>3ST" Then
par = 1

End If
If par = 0 Then MsgBox ("The pipe description has not been entered (HB<3ST, S<3ST, S>3ST or MHB<3ST)"), , "MAI Fire Fighting Calculations"
End If
WASTE_PIPES_PIPE_DESCRIPTION_NOT_ENTERED = par
End Function
Function VENT_PIPES_SIZE(TOTAL_DFU, pipe_length, WASTE_STACK_SIZE, data)

If WASTE_STACK_SIZE = 1.25 Then

If TOTAL_DFU > data(4, 2) And TOTAL_DFU <= data(5, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(5, j) And pipe_length * Range("bk45") <= data(5, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
End If

ElseIf WASTE_STACK_SIZE = 1.5 Then

For i = 6 To 7
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 2 Then

For i = 9 To 10
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 2.5 Then

If TOTAL_DFU > data(12, 2) And TOTAL_DFU <= data(13, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(13, j) And pipe_length * Range("bk45") <= data(13, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
End If

ElseIf WASTE_STACK_SIZE = 3 Then

For i = 14 To 16
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 4 Then

For i = 18 To 20
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 5 Then

For i = 22 To 24
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 6 Then

For i = 26 To 29
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45")(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 8 Then

For i = 31 To 34
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

ElseIf WASTE_STACK_SIZE = 10 Then

For i = 36 To 39
If TOTAL_DFU > data(i, 2) And TOTAL_DFU <= data(i + 1, 2) Then
For j = 3 To 11
If pipe_length * Range("bk45") > data(i + 1, j) And pipe_length * Range("bk45") <= data(i + 1, j + 1) Then
VENT_PIPES_SIZE = data(2, j + 1)
Exit For
End If
Next j
Exit For
End If
Next i

End If

End Function
Function IncreaseWasteStackSize(DIAM, DFU, length, pipe_size)
    If DIAM = 0 And DFU > 0 And length > 0 And pipe_size = "N/A" Then MsgBox ("Either the size of waste stack must be increased, or the length of the pipe is out of range."), vbCritical, "MAI Fire Fighting Calculations"
    End Function

Function CW_HW_PIPES_FU_DISCHARGE(FLUSHING_TYPE, TOTAL_FU)


If UCase(Right(FLUSHING_TYPE, 4)) = "TANK" Or UCase(FLUSHING_TYPE) = "HW" Then

If TOTAL_FU > 0 And TOTAL_FU <= 250 Then CW_HW_PIPES_FU_DISCHARGE = (0.28715551 + 0.79216926 * TOTAL_FU - 0.0052741819 * TOTAL_FU ^ 2 + 2.0532355 * 10 ^ (-5) * TOTAL_FU ^ 3 - 2.9342311 * 10 ^ (-8) * TOTAL_FU ^ 4) / 15.85
If TOTAL_FU > 250 And TOTAL_FU <= 750 Then CW_HW_PIPES_FU_DISCHARGE = 0.012 * TOTAL_FU + 2
If TOTAL_FU > 750 And TOTAL_FU <= 3000 Then CW_HW_PIPES_FU_DISCHARGE = 0.008 * TOTAL_FU + 5.333
If TOTAL_FU > 3000 And TOTAL_FU <= 14900 Then CW_HW_PIPES_FU_DISCHARGE = 0.006 * TOTAL_FU + 8.588
If TOTAL_FU > 14900 And TOTAL_FU <= 30000 Then CW_HW_PIPES_FU_DISCHARGE = 0.006 * TOTAL_FU + 18.166

ElseIf UCase(Right(FLUSHING_TYPE, 5)) = "VALVE" Then

If TOTAL_FU > 0 And TOTAL_FU <= 250 Then CW_HW_PIPES_FU_DISCHARGE = (((0.23295611 * 195.71105) + 1902.4978 * TOTAL_FU ^ 0.43050388) / (195.71105 + TOTAL_FU ^ 0.43050388)) / 15.85
If TOTAL_FU > 250 And TOTAL_FU <= 750 Then CW_HW_PIPES_FU_DISCHARGE = 0.009 * TOTAL_FU + 4.25
If TOTAL_FU > 750 And TOTAL_FU <= 3000 Then CW_HW_PIPES_FU_DISCHARGE = 0.008 * TOTAL_FU + 5.333
If TOTAL_FU > 3000 And TOTAL_FU <= 14900 Then CW_HW_PIPES_FU_DISCHARGE = 0.006 * TOTAL_FU + 8.588
If TOTAL_FU > 14900 And TOTAL_FU <= 30000 Then CW_HW_PIPES_FU_DISCHARGE = 0.006 * TOTAL_FU + 18.166

End If

End Function
Function cw_HW_ADD_TWO_PIPES_DYMAND_TYPE(PIPE1, PIPE2)

If UCase(PIPE1) = "HW" And UCase(PIPE2) = "HW" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "HW"
If UCase(PIPE1) = "TD-F VALVE" Or UCase(PIPE2) = "TD-F VALVE" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "TD-F VALVE"
If UCase(PIPE1) = "CW-F VALVE" Or UCase(PIPE2) = "CW-F VALVE" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "CW-F VALVE"
If UCase(PIPE1) = "TD-F TANK" And UCase(PIPE2) = "TD-F TANK" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "TD-F TANK"
If UCase(PIPE1) = "CW-F TANK" And UCase(PIPE2) = "CW-F TANK" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "CW-F TANK"
If Right(UCase(PIPE1), 2) = "NK" And Right(UCase(PIPE2), 2) = "HW" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "TD-F TANK"
If Right(UCase(PIPE1), 2) = "HW" And Right(UCase(PIPE2), 2) = "NK" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "TD-F TANK"
If Right(UCase(PIPE1), 2) = "VE" And Right(UCase(PIPE2), 2) = "HW" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "TD-F VALVE"
If Right(UCase(PIPE1), 2) = "HW" And Right(UCase(PIPE2), 2) = "VE" Then cw_HW_ADD_TWO_PIPES_DYMAND_TYPE = "TD-F VALVE"
End Function
Function CW_HW_IF_THERE_IS_FLUSH_VALVE(FLUSHING_TYPE, TOTAL_FU)

If TOTAL_FU = "N/A" And FLUSHING_TYPE <> "N/A" Then
MsgBox ("The flushing type must be changed to be ""F VALVE""."), vbCritical, "MAI Fire Fighting Calculations"
End If
End Function
Function CW_HW_PIPES_SIZE(total_discharge, MAT, data)

For i = 1 To 19
If total_discharge / Range("av34") > data(i, 1 + MAT) And total_discharge / Range("av34") <= data(i + 1, 1 + MAT) Then
CW_HW_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

End Function
Function HWR_PIPES_SIZE(total_discharge, MAT, data)

For i = 1 To 19
If total_discharge / Range("r34") > data(i, 1 + MAT) And total_discharge / Range("r34") <= data(i + 1, 1 + MAT) Then
HWR_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

End Function


Function comp_air_PIPES_SIZE(total_discharge, working_pressure, data)

For i = 1 To 14
If total_discharge > data(i, 1 + working_pressure) And total_discharge <= data(i + 1, 1 + working_pressure) Then
comp_air_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

End Function
Function vacuum_PIPES_SIZE(total_discharge, data)

For i = 1 To 9
If total_discharge > data(i, 2) And total_discharge <= data(i + 1, 2) Then
vacuum_PIPES_SIZE = data(i + 1, 1)
Exit For
End If
Next i

End Function
Function FUEL_PIPES_MaxPress_PressDrop(MaxPress, PressDrop)
If MaxPress * PressDrop > 0 And MaxPress <= PressDrop Then MsgBox ("Maximum pressure must be greater than pressure drop."), vbCritical, "MAI Fire Fighting Calculations"

End Function
Function FUEL_PIPES_add_equiv_length(MaxPress, PressDrop, equiv_length, total_length, fittings_quantity, total_discharge, Cell_CE11, pipe_length)
If fittings_quantity >= 1 And equiv_length = "N/A" And total_length <> "N/A" And total_length > 0 And MaxPress > PressDrop Then
'Call ADD_EQUIVALENT_LENGTH_FOR_FITTINGS_fuel_pipe
MsgBox ("Use Add Equivalent Length button to add the equivalent fittings length to the total length of the main pipe."), vbCritical, "MAI Fire Fighting Calculations"
Exit Function
End If
If MaxPress * PressDrop * pipe_length * fittings_quantity * total_discharge > 0 And equiv_length <> Cell_CE11 Then
'Call ADD_EQUIVALENT_LENGTH_FOR_FITTINGS_fuel_pipe
MsgBox ("Use Add Equivalent Length button to add the equivalent fittings length to the total length of the main pipe."), vbCritical, "MAI Fire Fighting Calculations"
End If
End Function
Function FUEL_PIPES_BIGGER_THAN_TOTAL_DISCHARGE(total_discharge, pipe_discharge, MaxPress, PressDrop, pipe_length)
If total_discharge * MaxPress * PressDrop * pipe_length = 0 And pipe_discharge > 0 Then MsgBox ("The total length of the main pipe must be determined first to enable pipe sizing."), vbCritical, "MAI Fire Fighting Calculations": Exit Function
If total_discharge < pipe_discharge Then MsgBox ("The total flow rate of the main pipe must be greater than any other pipe flow rate."), vbCritical, "MAI Fire Fighting Calculations"

End Function
Function FUEL_PIPES_SIZE(DATA_FUEL_PROPERTY, USED_FUEL, TEMP_oF, TOTAL_PIPE_LENGTH, MAX_PRESSURE, PRESSURE_DROP, total_discharge, pipe_discharge, MAT, DATA_PIPE)

Cr = 0.00354 * DATA_FUEL_PROPERTY(USED_FUEL, 2) * TEMP_oF * (DATA_FUEL_PROPERTY(USED_FUEL, 3) / DATA_FUEL_PROPERTY(USED_FUEL, 2)) ^ 0.152
If MAX_PRESSURE <= 1.5 Then INT_PIPE_DIAM = (pipe_discharge / 2313 * (Cr * TOTAL_PIPE_LENGTH / (PRESSURE_DROP * 27.68675)) ^ 0.541) ^ (1 / 2.623)
If MAX_PRESSURE > 1.5 Then INT_PIPE_DIAM = (pipe_discharge / 2237 * (Cr * TOTAL_PIPE_LENGTH / ((MAX_PRESSURE + 14.7) ^ 2 - (MAX_PRESSURE - PRESSURE_DROP + 14.7) ^ 2) / DATA_FUEL_PROPERTY(USED_FUEL, 4)) ^ 0.541) ^ (1 / 2.623)
 
For i = 1 To 16
If INT_PIPE_DIAM > DATA_PIPE(i, MAT + 1) And INT_PIPE_DIAM <= DATA_PIPE(i + 1, MAT + 1) Then
FUEL_PIPES_SIZE = DATA_PIPE(i + 1, 1)
Exit For
End If
Next i


End Function

Function fhc_pump_head_internal_diameter(data, diameter)
For i = 1 To 15

If diameter = data(i, 2) Then
fhc_pump_head_internal_diameter = data(i, 1)
Exit For
End If
Next i

End Function





'Function FUEL_PIPES_BIGGER_THAN_TOTAL_DISCHARGE(main_pipe_DISCHARGE, PIPE_DISCHARGE)
'If PIPE_DISCHARGE > main_pipe_DISCHARGE Then
'MsgBox ("The pipe dischage can not be bigger than the main pipe discharge. Check the Calculations and modify one of them."), vbCritical, "MAI Fire Fighting Calculations"

'End If
'End Function
Function total_equiv_length_fhc_pump_head(DATA_ENTRY_FITTINGS, DATA_EQUIV_LENGTH, DATA_INTER_DIAM, INTER_DIAM)
For i = 1 To 15

If INTER_DIAM = DATA_INTER_DIAM(i, 1) Then
total_equiv_length_fhc_pump_head = DATA_ENTRY_FITTINGS(1, 1) * DATA_EQUIV_LENGTH(i, 1) + DATA_ENTRY_FITTINGS(1, 2) * DATA_EQUIV_LENGTH(i, 2) + DATA_ENTRY_FITTINGS(1, 3) * DATA_EQUIV_LENGTH(i, 3) + DATA_ENTRY_FITTINGS(1, 4) * DATA_EQUIV_LENGTH(i, 4) + DATA_ENTRY_FITTINGS(1, 5) * DATA_EQUIV_LENGTH(i, 5) + DATA_ENTRY_FITTINGS(1, 6) * DATA_EQUIV_LENGTH(i, 6) + DATA_ENTRY_FITTINGS(1, 7) * DATA_EQUIV_LENGTH(i, 7) + DATA_ENTRY_FITTINGS(1, 8) * DATA_EQUIV_LENGTH(i, 8) + DATA_ENTRY_FITTINGS(1, 9) * DATA_EQUIV_LENGTH(i, 9)
Exit For
End If
Next i

End Function


Function FHC_PIPES_TOTAL_DISCHARGE(FHC_RISER_NO, FHC_CLASS)

If FHC_CLASS = 0 And FHC_RISER_NO > 0 And FHC_RISER_NO <= 1000 Then FHC_PIPES_TOTAL_DISCHARGE = 0: Exit Function

If FHC_CLASS = 1 Or FHC_CLASS = 3 And FHC_RISER_NO > 0 And FHC_RISER_NO <= 1000 Then FHC_PIPES_TOTAL_DISCHARGE = MINN(FHC_RISER_NO * 250, 1250)

'If FHC_CLASS = 1 Or FHC_CLASS = 3 And FHC_RISER_NO > 5 And FHC_RISER_NO <= 1000 Then FHC_PIPES_TOTAL_DISCHARGE = 1250

If FHC_CLASS = 2 And FHC_RISER_NO > 0 And FHC_RISER_NO <= 1000 Then FHC_PIPES_TOTAL_DISCHARGE = 100

End Function

Function FHC_PIPES_SIZE(total_discharge, DIST_MOST_REMOTE_FHC, data)

If total_discharge = 0 Or DIST_MOST_REMOTE_FHC = 0 Then FHC_PIPES_SIZE = 0: Exit Function

For i = 1 To 5
If total_discharge * Range("ad32") > data(i, 1) And total_discharge * Range("ad32") <= data(i + 1, 1) Then
FHC_PIPES_SIZE = data(i + 1, DIST_MOST_REMOTE_FHC + 2)
Exit For
End If
Next i

End Function

Function FHC_PIPES_NO_CLASS(FHC_RISER_NO, PIPE_DIAM, FHC_CLASS)


If FHC_CLASS <> "CLASS I" And FHC_CLASS <> "CLASS II" And FHC_CLASS <> "CLASS III" And FHC_RISER_NO > 0 And FHC_RISER_NO <= 1000 And PIPE_DIAM = "N/A" Then MsgBox ("The fire hose cabinet class must be either ""CLASS I"", ""CLASS II"" or ""CLASS III"". Any other class is not accepted."), vbCritical, "MAI Fire Fighting Calculations": Exit Function
'If FHC_CLASS = "CLASS I" Or FHC_CLASS = "CLASS II" Or FHC_CLASS = "CLASS III" And FHC_RISER_NO > 0 And FHC_RISER_NO <= 1000 And PIPE_DIAM = 0 Then MsgBox ("Please enter the distance from the furthest fire hose cabinet."), vbCritical, "MAI Fire Fighting Calculations"
End Function
Function fhc_ADD_TWO_PIPES_class(PIPE1, PIPE2)

If UCase(PIPE1) = "CLASS III" Or UCase(PIPE2) = "CLASS III" Then fhc_ADD_TWO_PIPES_class = "CLASS III"
If UCase(PIPE1) = "CLASS II" And UCase(PIPE2) = "CLASS I" Then fhc_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS I" And UCase(PIPE2) = "CLASS II" Then fhc_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS I" And UCase(PIPE2) = "CLASS I" Then fhc_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS II" And UCase(PIPE2) = "CLASS II" Then fhc_ADD_TWO_PIPES_class = "CLASS II"
If UCase(PIPE1) <> "CLASS I" And UCase(PIPE1) <> "CLASS II" And UCase(PIPE1) <> "CLASS III" Then fhc_ADD_TWO_PIPES_class = "N/A"
If UCase(PIPE2) <> "CLASS I" And UCase(PIPE2) <> "CLASS II" And UCase(PIPE2) <> "CLASS III" Then fhc_ADD_TWO_PIPES_class = "N/A"
End Function
Function fhc_ADD_TWO_PIPES_max_distance(pipe_class, PIPE1_class, PIPE2_class, pipe1_dist, pipe2_dist)

If pipe_class = "N/A" Then
fhc_ADD_TWO_PIPES_max_distance = "N/A"
Exit Function
End If

If UCase(PIPE1_class) = UCase(PIPE2_class) Then
fhc_ADD_TWO_PIPES_max_distance = MAXX(pipe1_dist, pipe2_dist)
Exit Function
End If


If UCase(PIPE1_class) <> UCase(PIPE2_class) And UCase(PIPE1_class) <> "CLASS II" And UCase(PIPE2_class) <> "CLASS II" Then
fhc_ADD_TWO_PIPES_max_distance = MAXX(pipe1_dist, pipe2_dist)
Exit Function
End If


If UCase(PIPE1_class) <> UCase(PIPE2_class) And (UCase(PIPE1_class) = "CLASS II" Or UCase(PIPE2_class) = "CLASS II") Then
If UCase(pipe_class) = UCase(PIPE1_class) Then fhc_ADD_TWO_PIPES_max_distance = pipe1_dist
If UCase(pipe_class) = UCase(PIPE2_class) Then fhc_ADD_TWO_PIPES_max_distance = pipe2_dist
Exit Function
End If


End Function

Function SPR_PIPES_SIZE(SPR_NO, MAT, HAZARD, NO_SPR_BRNCH, DIST_TWO_SPR, SPR_LH_DATA, SPR_OH_DATA, SPR_EH_DATA)

If HAZARD = 2 Then

For i = 1 To 12
If SPR_NO > SPR_LH_DATA(i, MAT ^ 2 + 1) And SPR_NO <= SPR_LH_DATA(i + 1, MAT ^ 2 + 1) Then
PS = SPR_LH_DATA(i + 1, MAT ^ 2)
Exit For
End If
Next i

ElseIf HAZARD = 3 Then

If NO_SPR_BRNCH = "N/A" Then PS = "N/A": MsgBox ("The maximum No. of sprinklers on one branch shall be less than 11 sprinkler."), vbCritical, "MAI Fire Fighting Calculations": Exit Function

For i = 1 To 24
If SPR_NO > SPR_OH_DATA(i, MAT * 5 + MAT ^ 2 + 1) And SPR_NO <= SPR_OH_DATA(i + 1, MAT * 5 + MAT ^ 2 + 1) Then
PS = SPR_OH_DATA(i + 1, NO_SPR_BRNCH + DIST_TWO_SPR ^ 2 + (-1) ^ MAT * (MAT ^ 2 * 2 - 1))
Exit For
End If
Next i


ElseIf HAZARD = 4 Then

For i = 1 To 10
If SPR_NO > SPR_EH_DATA(i, MAT ^ 2 + 1) And SPR_NO <= SPR_EH_DATA(i + 1, MAT ^ 2 + 1) Then
PS = SPR_EH_DATA(i + 1, MAT ^ 2)
Exit For
End If
Next i

End If
SPR_PIPES_SIZE = PS


End Function
Function spr_ADD_TWO_PIPES_hazard(PIPE1, PIPE2)

If UCase(PIPE1) = "EXTRA" Or UCase(PIPE2) = "EXTRA" Then spr_ADD_TWO_PIPES_hazard = "EXTRA"
If UCase(PIPE1) = "LIGHT" And UCase(PIPE2) = "ORDINARY" Then spr_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "ORDINARY" And UCase(PIPE2) = "LIGHT" Then spr_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "ORDINARY" And UCase(PIPE2) = "ORDINARY" Then spr_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "LIGHT" And UCase(PIPE2) = "LIGHT" Then spr_ADD_TWO_PIPES_hazard = "LIGHT"
If UCase(PIPE1) <> "ORDINARY" And UCase(PIPE1) <> "LIGHT" And UCase(PIPE1) <> "EXTRA" Then spr_ADD_TWO_PIPES_hazard = "N/A"
If UCase(PIPE2) <> "ORDINARY" And UCase(PIPE2) <> "LIGHT" And UCase(PIPE2) <> "EXTRA" Then spr_ADD_TWO_PIPES_hazard = "N/A"
End Function

Function SPR_PIPES_NO_HAZARD_SELECTED(HAZARD, SPR_NO, PIPE_DIAM)

If UCase(HAZARD) <> "EXTRA" And UCase(HAZARD) <> "ORDINARY" And UCase(HAZARD) <> "LIGHT" And SPR_NO >= 1 And PIPE_DIAM = "N/A" Then MsgBox ("The occupancy hazard must be either ""EXTRA"", ""ORDINARY"" or ""LIGHT"". Any other hazard is not accepted."), vbCritical, "MAI Fire Fighting Calculations"

End Function


Function COMBINED_PIPES_SIZE(SPR_NO, FHC_RISER_NO, total_discharge, MAT, HAZARD, NO_SPR_BRNCH, DIST_TWO_SPR, PIPE_TYPE, FHC_CLASS, DIST_MOST_REMOTE_FHC, SPR_LH_DATA, SPR_OH_DATA, SPR_EH_DATA, FHC_DATA)

If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And PIPE_TYPE = 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And HAZARD = 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And FHC_CLASS = 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And DIST_MOST_REMOTE_FHC = 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And HAZARD = 5 Then
COMBINED_PIPES_SIZE = "N/A"
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And FHC_CLASS = 4 Then
COMBINED_PIPES_SIZE = "N/A"
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And PIPE_TYPE = 3 Then
COMBINED_PIPES_SIZE = "N/A"
Exit Function
End If

If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And HAZARD = 5 Then
COMBINED_PIPES_SIZE = "N/A"
Exit Function
End If
If Val(SPR_NO) > 0 And Val(SPR_NO) < 100000 And HAZARD = 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If

If Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And FHC_CLASS = 4 And DIST_MOST_REMOTE_FHC > 0 Then
COMBINED_PIPES_SIZE = "N/A"
Exit Function
End If
If Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And total_discharge = 0 And FHC_CLASS = 0 And DIST_MOST_REMOTE_FHC > 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If

If Val(FHC_RISER_NO) > 0 And Val(FHC_RISER_NO) < 100000 And total_discharge = 0 And FHC_CLASS > 0 And FHC_CLASS < 4 And DIST_MOST_REMOTE_FHC = 0 Then
COMBINED_PIPES_SIZE = 0
Exit Function
End If


If HAZARD = 2 Then

For i = 1 To 12
If SPR_NO > SPR_LH_DATA(i, MAT ^ 2 + 1) And SPR_NO <= SPR_LH_DATA(i + 1, MAT ^ 2 + 1) Then
PS_SPR = SPR_LH_DATA(i + 1, MAT ^ 2)
Exit For
End If
Next i

ElseIf HAZARD = 3 Then

If NO_SPR_BRNCH = "N/A" Then PS = "N/A": MsgBox ("The maximum No. of sprinklers on one branch shall be less than 11 sprinkler."), vbCritical, "MAI Fire Fighting Calculations": Exit Function

For i = 1 To 24

If SPR_NO > SPR_OH_DATA(i, MAT * 5 + MAT ^ 2 + 1) And SPR_NO <= SPR_OH_DATA(i + 1, MAT * 5 + MAT ^ 2 + 1) Then
PS_SPR = SPR_OH_DATA(i + 1, NO_SPR_BRNCH + DIST_TWO_SPR ^ 2 + (-1) ^ MAT * (MAT ^ 2 * 2 - 1))
Exit For
End If
Next i


ElseIf HAZARD = 4 Then

For i = 1 To 10
If SPR_NO > SPR_EH_DATA(i, MAT ^ 2 + 1) And SPR_NO <= SPR_EH_DATA(i + 1, MAT ^ 2 + 1) Then
PS_SPR = SPR_EH_DATA(i + 1, MAT ^ 2)
Exit For
End If
Next i

End If

If total_discharge = 0 Or DIST_MOST_REMOTE_FHC = 0 Then PS_FHC = 0: GoTo LINE10:
For j = 1 To 5
If total_discharge * Range("aj34") > FHC_DATA(j, 1) And total_discharge * Range("aj34") <= FHC_DATA(j + 1, 1) Then
PS_FHC = FHC_DATA(j + 1, DIST_MOST_REMOTE_FHC + 2)
Exit For
End If
Next j

'PS_FHC = FHC_PIPES_SIZE(total_discharge, DIST_MOST_REMOTE_FHC, FHC_DATA)
LINE10:
PS = MAXX(PS_SPR, PS_FHC)


If FHC_CLASS = 2 And DIST_MOST_REMOTE_FHC <> 3 And SPR_NO * FHC_RISER_NO > 0 Then PS = MAXX(2.5, PS)
If FHC_CLASS = 2 And DIST_MOST_REMOTE_FHC = 3 And SPR_NO * FHC_RISER_NO > 0 Then PS = MAXX(3, PS)


If PIPE_TYPE = 2 And SPR_NO * FHC_RISER_NO > 0 Then PS = MAXX(PS, 6)
COMBINED_PIPES_SIZE = PS
End Function
Function COMBINED_PIPES_NO_PIPE_TYPE(SPR_NO, FHC_RISER_NO, PIPE_DIAM, PIPE_TYPE)


If PIPE_TYPE <> "HORIZONTAL" And PIPE_TYPE <> "RISER" And FHC_RISER_NO > 0 And FHC_RISER_NO <= 1000 And SPR_NO > 0 And SPR_NO <= 1000 And PIPE_DIAM = "N/A" Then MsgBox ("The pipe type must be either ""HORIZONTAL"" or ""RISER"". Any other type is not accepted."), vbCritical, "MAI Fire Fighting Calculations"

End Function

Function COMBINED_ADD_TWO_PIPES_max_distance(PIPE1_NO_FHC_RISERS, PIPE2_NO_FHC_RISERS, pipe_class, PIPE1_class, PIPE2_class, pipe1_dist, pipe2_dist)

If pipe_class = "N/A" Then
COMBINED_ADD_TWO_PIPES_max_distance = "N/A"
Exit Function
End If

If PIPE1_NO_FHC_RISERS = 0 And PIPE2_NO_FHC_RISERS > 0 And PIPE2_NO_FHC_RISERS < 10000 Then
COMBINED_ADD_TWO_PIPES_max_distance = pipe2_dist
Exit Function
End If

If PIPE2_NO_FHC_RISERS = 0 And PIPE1_NO_FHC_RISERS > 0 And PIPE1_NO_FHC_RISERS < 10000 Then
COMBINED_ADD_TWO_PIPES_max_distance = pipe1_dist
Exit Function
End If

If PIPE2_NO_FHC_RISERS = 0 And PIPE1_NO_FHC_RISERS = 0 Then
COMBINED_ADD_TWO_PIPES_max_distance = MAXX(pipe1_dist, pipe2_dist)
Exit Function
End If

If PIPE2_NO_FHC_RISERS = "" And PIPE1_NO_FHC_RISERS = "" Then
COMBINED_ADD_TWO_PIPES_max_distance = MAXX(pipe1_dist, pipe2_dist)
Exit Function
End If


If PIPE1_NO_FHC_RISERS = "" And PIPE2_NO_FHC_RISERS > 0 And PIPE2_NO_FHC_RISERS < 10000 Then
COMBINED_ADD_TWO_PIPES_max_distance = pipe2_dist
Exit Function
End If

If PIPE2_NO_FHC_RISERS = "" And PIPE1_NO_FHC_RISERS > 0 And PIPE1_NO_FHC_RISERS < 10000 Then
COMBINED_ADD_TWO_PIPES_max_distance = pipe1_dist
Exit Function
End If

If UCase(PIPE1_class) = UCase(PIPE2_class) Then
COMBINED_ADD_TWO_PIPES_max_distance = MAXX(pipe1_dist, pipe2_dist)
Exit Function
End If

If UCase(PIPE1_class) <> UCase(PIPE2_class) And UCase(PIPE1_class) <> "CLASS II" And UCase(PIPE2_class) <> "CLASS II" Then
COMBINED_ADD_TWO_PIPES_max_distance = MAXX(pipe1_dist, pipe2_dist)
Exit Function
End If



If UCase(PIPE1_class) <> UCase(PIPE2_class) And (UCase(PIPE1_class) = "CLASS II" Or UCase(PIPE2_class) = "CLASS II") Then
If UCase(pipe_class) = UCase(PIPE1_class) Then COMBINED_ADD_TWO_PIPES_max_distance = pipe1_dist
If UCase(pipe_class) = UCase(PIPE2_class) Then COMBINED_ADD_TWO_PIPES_max_distance = pipe2_dist
Exit Function
End If


End Function
'Function COMBINED_PIPES_NO_HAZARD_NO_CLASS_NO_PIPE_TYPE_NO_DIST(SPR_NO, FHC_RISER_NO, HAZARD, FHC_CLASS, PIPE_TYPE, DIST_MOST_REMOTE_FHC)
'
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The sprinkler occupancy hazard, class of fire hose cabinet, type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The class of fire hose cabinet, type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value <> 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The sprinkler occupancy hazard, type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The sprinkler occupancy hazard, class of fire hose cabinet and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard, class of fire hose cabinet and type of pipe have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value <> 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The class of fire hose cabinet and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The class of fire hose cabinet and type of pipe have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value <> 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The sprinkler occupancy hazard and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard and class of fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value = 0 And Range("FHC_CLASS").Value <> 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value = 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The class of fire hose cabinet has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value <> 0 And Range("PIPE_TYPE").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The type of pipe has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("HAZARD").Value <> 0 And Range("FHC_CLASS").Value <> 0 And Range("PIPE_TYPE").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The distance from the most remote fire hose cabinet has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations"
'
'If Range("SPR_NO").Value >= 1 And Range("SPR_NO").Value < 100000 And Range("FHC_RISER_NO").Value = 0 And Range("HAZARD").Value = 0 Then MsgBox ("The sprinkler occupancy hazard has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": Exit Function
'
'If Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("SPR_NO").Value = 0 And Range("FHC_CLASS").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The class of fire hose cabinet and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("SPR_NO").Value = 0 And Range("FHC_CLASS").Value <> 0 And Range("DIST_MOST_REMOTE_FHC").Value = 0 Then MsgBox ("The distance from the most remote fire hose cabinet has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations"
'If Range("FHC_RISER_NO").Value >= 1 And Range("FHC_RISER_NO").Value < 100000 And Range("SPR_NO").Value = 0 And Range("FHC_CLASS").Value = 0 And Range("DIST_MOST_REMOTE_FHC").Value <> 0 Then MsgBox ("The class of fire hose cabinet has not been entered for this pipe. Please enter it."), vbCritical, "MAI Fire Fighting Calculations"
'
'End Function
Function COMBINED_ADD_TWO_PIPES_hazard(PIPE1, PIPE2)

If UCase(PIPE1) = "EXTRA" Or UCase(PIPE2) = "EXTRA" Then COMBINED_ADD_TWO_PIPES_hazard = "EXTRA"
If UCase(PIPE1) = "LIGHT" And UCase(PIPE2) = "ORDINARY" Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "ORDINARY" And UCase(PIPE2) = "LIGHT" Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "ORDINARY" And UCase(PIPE2) = "ORDINARY" Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "ORDINARY" And UCase(PIPE2) = 0 Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "ORDINARY" And UCase(PIPE2) = "" Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = 0 And UCase(PIPE2) = "ORDINARY" Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "" And UCase(PIPE2) = "ORDINARY" Then COMBINED_ADD_TWO_PIPES_hazard = "ORDINARY"
If UCase(PIPE1) = "LIGHT" And UCase(PIPE2) = "LIGHT" Then COMBINED_ADD_TWO_PIPES_hazard = "LIGHT"
If UCase(PIPE1) = 0 And UCase(PIPE2) = "LIGHT" Then COMBINED_ADD_TWO_PIPES_hazard = "LIGHT"
If UCase(PIPE1) = "" And UCase(PIPE2) = "LIGHT" Then COMBINED_ADD_TWO_PIPES_hazard = "LIGHT"
If UCase(PIPE1) = "LIGHT" And UCase(PIPE2) = 0 Then COMBINED_ADD_TWO_PIPES_hazard = "LIGHT"
If UCase(PIPE1) = "LIGHT" And UCase(PIPE2) = "" Then COMBINED_ADD_TWO_PIPES_hazard = "LIGHT"
If UCase(PIPE1) = 0 And UCase(PIPE2) = 0 Then COMBINED_ADD_TWO_PIPES_hazard = 0
If UCase(PIPE1) = "" And UCase(PIPE2) = "" Then COMBINED_ADD_TWO_PIPES_hazard = 0
If UCase(PIPE1) <> 0 And UCase(PIPE1) <> "" And UCase(PIPE1) <> "ORDINARY" And UCase(PIPE1) <> "LIGHT" And UCase(PIPE1) <> "EXTRA" Then COMBINED_ADD_TWO_PIPES_hazard = "N/A"
If UCase(PIPE2) <> 0 And UCase(PIPE2) <> "" And UCase(PIPE2) <> "ORDINARY" And UCase(PIPE2) <> "LIGHT" And UCase(PIPE2) <> "EXTRA" Then COMBINED_ADD_TWO_PIPES_hazard = "N/A"
End Function
Function COMBINED_ADD_TWO_PIPES_class(PIPE1, PIPE2)

If UCase(PIPE1) = "CLASS III" Or UCase(PIPE2) = "CLASS III" Then COMBINED_ADD_TWO_PIPES_class = "CLASS III"
If UCase(PIPE1) = "CLASS II" And UCase(PIPE2) = "CLASS I" Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS I" And UCase(PIPE2) = "CLASS II" Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS I" And UCase(PIPE2) = "CLASS I" Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = 0 And UCase(PIPE2) = "CLASS I" Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "" And UCase(PIPE2) = "CLASS I" Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS I" And UCase(PIPE2) = 0 Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS I" And UCase(PIPE2) = "" Then COMBINED_ADD_TWO_PIPES_class = "CLASS I"
If UCase(PIPE1) = "CLASS II" And UCase(PIPE2) = "CLASS II" Then COMBINED_ADD_TWO_PIPES_class = "CLASS II"
If UCase(PIPE1) = 0 And UCase(PIPE2) = "CLASS II" Then COMBINED_ADD_TWO_PIPES_class = "CLASS II"
If UCase(PIPE1) = "" And UCase(PIPE2) = "CLASS II" Then COMBINED_ADD_TWO_PIPES_class = "CLASS II"
If UCase(PIPE1) = "CLASS II" And UCase(PIPE2) = 0 Then COMBINED_ADD_TWO_PIPES_class = "CLASS II"
If UCase(PIPE1) = "CLASS II" And UCase(PIPE2) = "" Then COMBINED_ADD_TWO_PIPES_class = "CLASS II"
If UCase(PIPE1) = 0 And UCase(PIPE2) = 0 Then COMBINED_ADD_TWO_PIPES_class = 0
If UCase(PIPE1) = "" And UCase(PIPE2) = "" Then COMBINED_ADD_TWO_PIPES_class = 0
If UCase(PIPE1) <> 0 And UCase(PIPE1) <> "" And UCase(PIPE1) <> "CLASS I" And UCase(PIPE1) <> "CLASS II" And UCase(PIPE1) <> "CLASS III" Then COMBINED_ADD_TWO_PIPES_class = "N/A"
If UCase(PIPE2) <> 0 And UCase(PIPE2) <> "" And UCase(PIPE2) <> "CLASS I" And UCase(PIPE2) <> "CLASS II" And UCase(PIPE2) <> "CLASS III" Then COMBINED_ADD_TWO_PIPES_class = "N/A"
End Function


Function MAXX(a, B)
If Val(a) > Val(B) Then MAXX = a
If Val(a) <= Val(B) Then MAXX = B
End Function
Function MINN(a, B)
If Val(a) <= Val(B) Then MINN = a
If Val(a) > Val(B) Then MINN = B
End Function

Function CO2_PIPES_DISCHARGE(SYSTEM_TYPE, FIRE_TYPE, STORAGE_CAPACITY_OR_DISCHARGE)

If SYSTEM_TYPE = 1 And FIRE_TYPE = 1 Then CO2_PIPES_DISCHARGE = STORAGE_CAPACITY_OR_DISCHARGE / 1
If SYSTEM_TYPE = 1 And FIRE_TYPE = 2 Then CO2_PIPES_DISCHARGE = STORAGE_CAPACITY_OR_DISCHARGE / 7
If SYSTEM_TYPE = 2 Then CO2_PIPES_DISCHARGE = STORAGE_CAPACITY_OR_DISCHARGE

End Function

Function CO2_PIPES_SIZE(DISCHARGE, data)

For i = 1 To 6
If DISCHARGE > data(i, 1) And DISCHARGE <= data(i + 1, 1) Then
CO2_PIPES_SIZE = data(i + 1, 2)
Exit For
End If
Next i

End Function

Function CO2_1(OPENING, volume, total_quantity)
    If OPENING > volume And total_quantity = "N/A" Then
      MsgBox ("The CO2 quantity lost from the wall openings can't be greater than the CO2 quantity related to the enclosure volume. Either this system should be sized as a Local Application System, or the wall openings area should be reduced."), vbCritical, "MAI Fire Fighting Calculations"
       End If
End Function
Function CO2_2(OPENING, volume, total_quantity)
    If OPENING > volume And total_quantity = "N/A" Then
      MsgBox ("The CO2 quantity lost from the wall openings can't be greater than the CO2 quantity related to the enclosure volume. Either this system should be sized as a Local Application System, or the wall openings area should be reduced."), vbCritical, "MAI Fire Fighting Calculations"
       End If
End Function

Function WallHeightAboveHazard(enclosure, height, SYSTEM_TYPE)
If Range("ag35") = 1 Then
If SYSTEM_TYPE = 3 And enclosure = 2 And height < 0.6 And height > 0 Then MsgBox ("To size this system as an Enclosure Defined by Permanent Walls, the top of the permanent wall must be at least 0.6m above the hazard. Otherwise The system should be sized as an Imaginary Enclosure."), vbCritical, "MAI Fire Fighting Calculations"
End If
If Range("ag35") = 2 Then
If SYSTEM_TYPE = 3 And enclosure = 2 And height < 2 And height > 0 Then MsgBox ("To size this system as an Enclosure Defined by Permanent Walls, the top of the permanent wall must be at least 2ft above the hazard. Otherwise The system should be sized as an Imaginary Enclosure."), vbCritical, "MAI Fire Fighting Calculations"
End If
 End Function
Function CO2_STORAGE_TFS_DSF(volume, specific_hazard)

If Range("ag35") = 1 Then
If specific_hazard = 1 And volume > 0 And volume > 57 Then MsgBox ("The selection for Specific Hazard must be changed to be (Spaces greater than 57m3)"), vbCritical, "MAI Fire Fighting Calculations": Exit Function
If specific_hazard = 2 And volume > 0 And volume <= 57 Then MsgBox ("The selection for Specific Hazard must be changed to be (Spaces less than 57m3)"), vbCritical, "MAI Fire Fighting Calculations"
End If

If Range("ag35") = 2 Then
If specific_hazard = 1 And volume > 0 And volume > 2000 Then MsgBox ("The selection for Specific Hazard must be changed to be (Spaces greater than 2000ft3)"), vbCritical, "MAI Fire Fighting Calculations": Exit Function
If specific_hazard = 2 And volume > 0 And volume <= 2000 Then MsgBox ("The selection for Specific Hazard must be changed to be (Spaces less than 2000ft3)"), vbCritical, "MAI Fire Fighting Calculations"
End If

End Function

Function CO2_STORAGE_LAS_A(HIGHT_NOZZLE_LIQUID, HAZARD_AREA)
If Range("ag35") = 1 Then
If HAZARD_AREA > 0 And HIGHT_NOZZLE_LIQUID > 3 Then MsgBox ("The maximum acceptable height or distance from the nozzle to the liquid surface is 3m."), vbCritical, "MAI Fire Fighting Calculations"
End If
If Range("ag35") = 2 Then
If HAZARD_AREA > 0 And HIGHT_NOZZLE_LIQUID > 10 Then MsgBox ("The maximum acceptable height or distance from the nozzle to the liquid surface is 10ft."), vbCritical, "MAI Fire Fighting Calculations"
End If
 End Function





Attribute VB_Name = "Module33"
Attribute VB_Name = "Module37"
Attribute VB_Name = "Module38"

Attribute VB_Name = "Module39"

Sub ser_no_adjusting(first_row, mai, ser_no)
'
' Macro1 Macro
' Macro recorded 21-08-2002 by Mai
'

Application.ScreenUpdating = False
Dim x(1000)
Dim y(1000)
Dim SUN(1000)


no_of_elements = mai

For i = 0 To no_of_elements
x(i) = 0
y(i) = 0

If Right(Cells(i + first_row, 2), 1) <> ")" Then
 SUN(i) = Cells(i + first_row, 2)

Else
If Right(Cells(i + first_row, 2), 1) = ")" Then
SUN(i) = Mid(Cells(i + first_row, 2), 1, WorksheetFunction.Find("(", Cells(i + first_row, 2)) - 2)
x(i) = Mid(Cells(i + first_row, 2), WorksheetFunction.Find("(", Cells(i + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(i + first_row, 2)) - WorksheetFunction.Find("(", Cells(i + first_row, 2)) - 1)
y(i) = Mid(Cells(i + first_row, 2), WorksheetFunction.Find("+", Cells(i + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(i + first_row, 2)) - WorksheetFunction.Find("+", Cells(i + first_row, 2)) - 1)
x(i) = Val(x(i))
y(i) = Val(y(i))
SUN(i) = Val(SUN(i))
End If
End If
 Next i



For i = 0 To ser_no - 1
SUN(i) = Cells(i + first_row, 2)
Next i
SUN(ser_no) = ser_no
For i = ser_no To ser_no + no_of_elements + 1
If x(i) >= ser_no Then x(i) = x(i) + 1
If y(i) >= ser_no Then y(i) = y(i) + 1
If SUN(i) >= ser_no Then SUN(i) = SUN(i) + 1
If x(i) > 0 Or y(i) > 0 Then SUN(i) = SUN(i) & " (" & x(i) & "+" & y(i) & ")"
Next i



For i = 0 To no_of_elements + 1


Cells(i + first_row, 2) = SUN(i)
Next i


End Sub

Sub delete_ser_no_adjusting(first_row, mai, Iser_no, Vser_no)
'
' Macro1 Macro
' Macro recorded 21-08-2002 by Mai
'

Application.ScreenUpdating = False
Dim x(1000)
Dim y(1000)
Dim SUN(1000)


Iser_no = Iser_no - first_row
Vser_no = Vser_no - first_row
no_of_elements = mai - (Iser_no - Vser_no) ^ 2 ^ (1 / 2) - 2

For i = 0 To no_of_elements - 1
x(i) = 0
y(i) = 0

If Right(Cells(i + first_row, 2), 1) <> ")" Then
 SUN(i) = Cells(i + first_row, 2)

Else
If Right(Cells(i + first_row, 2), 1) = ")" Then
SUN(i) = Mid(Cells(i + first_row, 2), 1, WorksheetFunction.Find("(", Cells(i + first_row, 2)) - 2)
x(i) = Mid(Cells(i + first_row, 2), WorksheetFunction.Find("(", Cells(i + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(i + first_row, 2)) - WorksheetFunction.Find("(", Cells(i + first_row, 2)) - 1)
y(i) = Mid(Cells(i + first_row, 2), WorksheetFunction.Find("+", Cells(i + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(i + first_row, 2)) - WorksheetFunction.Find("+", Cells(i + first_row, 2)) - 1)
x(i) = Val(x(i))
y(i) = Val(y(i))
SUN(i) = Val(SUN(i))
End If
End If

 Next i


If Iser_no <= Vser_no Then DEDE = Iser_no
If Vser_no < Iser_no Then DEDE = Vser_no

If Iser_no >= Vser_no Then MHMD = Iser_no
If Vser_no > Iser_no Then MHMD = Vser_no

'For I = 0 To DEDE - 1
'sun(I) = Cells(I + first_row, 2)

'Next I

For i = 0 To no_of_elements - 1

If x(i) = MHMD Then x(i) = x(i) - (Iser_no - Vser_no) ^ 2 ^ (1 / 2)
If x(i) > MHMD Then x(i) = x(i) - (Iser_no - Vser_no) ^ 2 ^ (1 / 2) - 1
If y(i) = MHMD Then y(i) = y(i) - (Iser_no - Vser_no) ^ 2 ^ (1 / 2)
If y(i) > MHMD Then y(i) = y(i) - (Iser_no - Vser_no) ^ 2 ^ (1 / 2) - 1
If SUN(i) = MHMD Then SUN(i) = SUN(i) - (Iser_no - Vser_no) ^ 2 ^ (1 / 2)
If SUN(i) > MHMD Then SUN(i) = SUN(i) - (Iser_no - Vser_no) ^ 2 ^ (1 / 2) - 1

If x(i) > 0 Or y(i) > 0 Then SUN(i) = SUN(i) & " (" & x(i) & "+" & y(i) & ")"

Next i



For i = 0 To no_of_elements - 1


Cells(i + first_row, 2) = SUN(i)

Next i

End Sub
Sub ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Application.ScreenUpdating = False

If Right(Cells(x, 2), 1) = ")" Then
lenx = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
Else
lenx = Cells(x, 2)
End If

If Right(Cells(y, 2), 1) = ")" Then
leny = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
Else
leny = Cells(y, 2)
End If


Cells(first_row + ser_no - 1, 2).Select
ActiveCell.FormulaR1C1 = "=" & ser_no & "&" & """ (""" & "&" & lenx & "&" & """+""" & "&" & leny & "&" & """)"""
Selection.Copy
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False

End Sub

Attribute VB_Name = "Module4"
Sub Macro14()
Attribute Macro14.VB_Description = "Macro recorded 14/10/1995 by MAI"
Attribute Macro14.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro14 Macro
' Macro recorded 14/10/1995 by MAI
'

'
    Columns("C:C").Select
    Selection.NumberFormat = "@"
End Sub
Attribute VB_Name = "Module40"
Sub hwr_pipes_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("H23")
OSA2 = Range("H24")
OSA3 = Range("H25")


  DialogSheets("Dialog_hwr_pipes_DATA").Visible = -1
 DialogSheets("Dialog_hwr_pipes_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_hwr_pipes_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3



Sheets(osa).Select
DialogSheets("Dialog_hwr_pipes_DATA").Show

End Sub

Sub hwr_pipes_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_hwr_pipes_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
  
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  DialogSheets("Dialog_hwr_pipes_DATA").Visible = 0

  Range("H23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("H24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("H25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("d7").Select
    
  ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub hwr_pipes_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_hwr_pipes_DATA").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_hwr_pipe()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
 mai = Range("b7")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio


osa = ActiveSheet.Name
  DialogSheets("Dialog_add_delete_hwr_pipe").Visible = -1
 DialogSheets("Dialog_add_delete_hwr_pipe").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_hwr_pipes_DATA").Show


Sheets(osa).Select
DialogSheets("Dialog_add_delete_hwr_pipe").Show

End Sub
Sub ADD_pipe_hwr_pipe()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
first_row = 29
 mai = Range("b7")
Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

Dim ser_no As String
If mai = 1 Then ser_no = 1: GoTo line2:
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))

If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 9)).Select
 Selection.Insert Shift:=xlDown
 Cells(ser_no + 28, 14).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai

  
Range("a7:b7").Select
Selection.Copy
Cells(28 + mai, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("d7:I7").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("n7").Select
Selection.Copy
Cells(28 + ser_no, 14).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With



    
Range("B7") = Range("B7") + 1
Range("d7").ClearContents
Range("d7").Select

Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 9

End If
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_hwr_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub ADD_pipe_feeding_two_existing_hwr_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

first_row = 29
 mai = Range("b7")

Dim answer As String
If mai < 3 Then MsgBox ("At least two pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
GoTo LINE10:
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

     Dim answer1 As String


line11:
answer1 = UCase(InputBox("Enter the code of the first existing pipe.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie


If answer1 = Cells(x, 3).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the code of the Second existing pipe.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie
If answer2 = Cells(y, 3).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
   
    If answer2 = Empty Then
    GoTo LINE10:
    Else
If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no + 28 <= x Or ser_no + 28 <= y Then MsgBox ("The line of this pipe must be located below the lines of the two existing pipes which are fed by it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28

If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If

If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 9)).Select
 Selection.Insert Shift:=xlDown
 Cells(ser_no + 28, 14).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 9
      Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False
  
    
Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai

  
Range("a7:b7").Select
Selection.Copy
Cells(28 + mai, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("d7:I7").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("n7").Select
Selection.Copy
Cells(28 + ser_no, 14).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
    

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"

        
End If
End If
End If
Cells(28 + ser_no, 4).Select
 Selection.Locked = True
    Selection.FormulaHidden = True

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 9)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Range("B7") = Range("B7") + 1
Range("d7").ClearContents
Range("d7").Select

Application.CutCopyMode = False

ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 9
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_hwr_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub modify_pipe_feeding_two_existing_hwr_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
first_row = 29
 mai = Range("b7")

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

If mai < 4 Then MsgBox ("At least three pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
     
     
     Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be modified.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For j = 29 To elie
If answer = Cells(j, 3).Value Then par = 1: Exit For


Next j
If par = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
   
    If answer = Empty Then GoTo LINE10:
    
    
     Dim answer1 As String
line11:
answer1 = UCase(InputBox("Enter the code of the first existing pipe.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie
If answer1 = Cells(x, 3).Value Then PAR1 = 1: Exit For

Next x
If x = j Then MsgBox ("The pipe can not be fed by itself."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
If PAR1 = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the code of the Second existing pipe.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie
If answer2 = Cells(y, 3).Value Then PAR2 = 1: Exit For

Next y
If y = j Then MsgBox ("The pipe can not be fed by itself."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
If PAR2 = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
   
    If answer2 = Empty Then
    GoTo LINE10:
    Else

If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:

LINE6:
ser_no = j - 28

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"
 Selection.Locked = True
    Selection.FormulaHidden = True
        
End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 9)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 9
Range("d7").Select

LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_hwr_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub DELETE_hwr_pipes()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
   Dim x(1000)
  Dim y(1000)
 
    first_row = 29
     mai = Range("b7")
     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
         
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no pipe to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be deleted.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If answer = Cells(i, 3).Value Then par = 1: Exit For


Next i
If par = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
 
  
    If answer = Empty Then
    GoTo LINE10:
    Else
    
kk = 0
For j = 0 To mai
x(j) = 0
y(j) = 0

If Right(Cells(j + first_row, 2), 1) = ")" Then


x(j) = Mid(Cells(j + first_row, 2), WorksheetFunction.Find("(", Cells(j + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(j + first_row, 2)) - WorksheetFunction.Find("(", Cells(j + first_row, 2)) - 1)
y(j) = Mid(Cells(j + first_row, 2), WorksheetFunction.Find("+", Cells(j + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(j + first_row, 2)) - WorksheetFunction.Find("+", Cells(j + first_row, 2)) - 1)
x(j) = Val(x(j))
y(j) = Val(y(j))
If Right(Cells(i, 2), 1) = ")" Then
SUN = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2)
If Val(SUN) = x(j) Or Val(SUN) = y(j) Then
kk = 1
GoTo line20:
End If
End If
If Cells(i, 2) = x(j) Or Cells(i, 2) = y(j) Then
kk = 1
line20:
Exit For
End If
End If
 
 Next j
 
    If kk = 1 Then


MsgBox ("The pipe No. """) & Cells(j + first_row, 3).Value & (""" must be modified first before deleting this pipe."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE10:
End If

If MsgBox("Are you sure you want to delete pipe No. """ & Cells(i, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
    
    
    
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(i, 9)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
          Cells(i, 14).Select
           Selection.Delete Shift:=xlUp
           Call delete_ser_no_adjusting(first_row, mai, Val(i))
            
line2:
            Range("b7") = Range("b7") - 1
            End If
            End If
        ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 39
    
    Range("d7").Select
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_hwr_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_hwr_pipe_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_add_delete_hwr_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub RESET_HWR_pipe()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If
  ActiveWindow.FreezePanes = False
Range("B7").Select
ActiveCell.FormulaR1C1 = "1"
Range("H23:H25").ClearContents
Range("d7").ClearContents

Range("B29:I1034,n29:n1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
Selection.Interior.ColorIndex = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

 DialogSheets("Dialog_HWR_pipes_DATA").Visible = -1
    Sheets("Dialog_HWR_pipes_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
   
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("HOT WATER RETURN PIPES").Select
    DialogSheets("Dialog_HWR_pipes_DATA").Visible = 0
    Sheets("Dialog_option_hwr_pipes").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("L29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75

Range("d7").Select

ActiveSheet.Protect Password:=qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_HWR_PIPES()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&9&D"
        .CenterFooter = ""
        .RightFooter = "&9Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.69)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 92
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("H23:H27,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 10.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

 Range("h27").Select
     With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
 With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
 
    ActiveSheet.PageSetup.PrintArea = ""
 Rows("8:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B7")
    Range(Rows(29), Rows(250)).Select
    Selection.RowHeight = 22
    Range(Rows(21), Rows(26)).Select
    Selection.RowHeight = 14.25
  Rows("27:27").Select
    Selection.RowHeight = 27
                 
Range(Cells(21, 2), Cells(mai + 27, 9)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
'''ActiveWindow.SelectedSheets.PrintPreview
 ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("8:28").Select
 Selection.EntireRow.Hidden = True

ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("L29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
        Range("d7").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub



Sub option_hwr_pipes()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_network_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 22) = "HEATING NETWORK NO. " Then
SHT_network_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 12) = SHT_network_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$L$3:$L$" & j + 2
Sheets("Dialog_option_hwr_pipes").Visible = -1
Sheets("Dialog_option_hwr_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$L$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("hot water return pipes").Select
  
    DialogSheets("Dialog_option_hwr_pipes").Show

  
End Sub

Sub OPEN_Network_hwr_pipes()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("Dialog_OPTION_hwr_pipes").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No network has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("hot water return pipes").Select: Sheets("Dialog_OPTION_hwr_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("hot water return pipes").Select: Sheets("Dialog_OPTION_hwr_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("hot water return pipes").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("Dialog_OPTION_hwr_pipes").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("hot water return pipes").Visible = 0
    
   
 Sheets("Dialog_option_hwr_pipes").Visible = -1
   Sheets("Dialog_option_hwr_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_option_hwr_pipes").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub SAVE_Network_hwr_pipes()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim network_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

network_name = UCase(Range("H25"))
If Len(network_name) > 9 Then MsgBox ("The number of Network Code characters must be less than 10."), vbCritical, "MAI Fire Fighting Calculations": Call hwr_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If network_name = "" Then MsgBox ("The Network Code has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call hwr_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("HEATING NETWORK NO. " & network_name)

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Network Code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call hwr_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = Network_Name
         
     
  Sheets("hot water return pipes").Select
   Sheets("hot water return pipes").Copy Before:=Sheets(1)
  'Network_Name1 = Range("j27")
   With ActiveCell.Characters(Start:=1, length:=6).Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
  End With
Sheets("hot water return pipes (2)").Select
 Sheets("hot water return pipes (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("C1") = "HEATING NETWORK NO. " & Range("H25")

 ActiveSheet.Shapes("Button 5").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 6").Select
    Selection.OnAction = "Back_to_hwr_pipes"
    Range("A1:K1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("L29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
    Range("d7").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "HEATING NETWORK NO. " & network_name
Sheets("hot water return pipes").Select

Call RESET_HWR_pipe
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio


Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("hot water return pipes").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("Dialog_OPTION_hwr_pipes").Visible = 0
Sheets("List reference").Visible = 0


ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub DELETE_Network_hwr_pipes()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("Dialog_option_hwr_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No network has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("hot water return pipes").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("Dialog_OPTION_hwr_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("hot water return pipes").Select: Sheets("Dialog_OPTION_hwr_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("Dialog_option_hwr_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("hot water return pipes").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_option_hwr_pipes").Visible = 0
   Sheets("List reference").Visible = 0
   
    
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_hwr_pipes_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("hot water return pipes").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_option_hwr_pipes").Visible = 0
Sheets("List reference").Visible = 0
'ActiveWorkbook = PROTECT password:= qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_hwr_pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("hot water return pipes").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("hot water return pipes").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub hwr_pipes_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u33") = 2 Then
Range("b4") = Range("b4") / 1.8
Range("d7") = Range("d7") / 3.28
Range("f7").NumberFormat = "0.00;;"
mai = Range("B7")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 4) = Cells(i + 28, 4) / 3.28
line11:
Cells(i + 28, 6).NumberFormat = "0.00;;"
Next i
End If
LINE10:
Range("u33") = 1
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Sub hwr_pipes_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u33") = 1 Then
Range("b4") = Range("b4") * 1.8
Range("d7") = Range("d7") * 3.28
Range("f7").NumberFormat = "0.0;;"
mai = Range("B7")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 4) = Cells(i + 28, 4) * 3.28
line11:
Cells(i + 28, 6).NumberFormat = "0.0;;"
Next i
End If
LINE10:
Range("u33") = 2
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub





Attribute VB_Name = "Module41"
Sub Macro400()
Attribute Macro400.VB_Description = "Macro recorded 8/10/96 by  "
Attribute Macro400.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro4 Macro
' Macro recorded 8/10/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveWorkbook.SaveAs FileName:=Range("F14"), _
        FileFormat:=xlNormal, Password:=qwe & rty & uio, WriteResPASSWORD:=qwe & rty & uio, _
        ReadOnlyRecommended:=False, CreateBackup:=False
End Sub
Attribute VB_Name = "Module47"
Sub FHC_PUMP_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("o23")
OSA2 = Range("o24")
OSA3 = Range("o25")
OSA4 = Range("o26")


  DialogSheets("Dialog_FHC_PUMP_DATA").Visible = -1
 DialogSheets("Dialog_FHC_PUMP_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_FHC_PUMP_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3
ActiveSheet.Shapes("Edit Box 7").Select
Selection.Characters.Text = OSA4


Sheets(osa).Select
DialogSheets("Dialog_FHC_PUMP_DATA").Show

End Sub

Sub FHC_PUMP_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_FHC_PUMP_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 7").Select
  mai4 = Selection.Characters.Text

     
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
  
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai4) > 26 Then MsgBox ("The number of Pump No. characters must be less than 27."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai4 = "" Then MsgBox ("The Pump No. has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("FHCP_" & mai4, i, 1) = "/" Or Mid("FHCP_" & mai4, i, 1) = "*" Or Mid("FHCP_" & mai4, i, 1) = "\" Or Mid("FHCP_" & mai4, i, 1) = "?" Or Mid("FHCP_" & mai4, i, 1) = "[" Or Mid("FHCP_" & mai4, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the pump No."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("FHCP_" & mai4) = SHTNAME(i) And osa <> "FHCP_" & mai4 Then
MsgBox ("This Pump No. has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "FHCP_" & mai4
 Range("c1") = "FHCP_" & mai4
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "FHCP_" & mai4: Exit For
 
  Next j
  
 Sheets("FHCP_" & mai4).Select
LINE10:


  DialogSheets("Dialog_FHC_PUMP_DATA").Visible = 0

  Range("o23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("o24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("o25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("o26").Select
  ActiveCell.FormulaR1C1 = mai4
  Range("s5:v5").Select
    
LINE1:
  
 Sheets("Dialog_FHC_pump_data").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub FHC_PUMP_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
 Sheets("Dialog_FHC_pump_data").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub ADD_PIPE_IN_HEAD_FOR_FIRE_HOSE_CABINET_PUMP()
'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
   Application.ScreenUpdating = False: Call air
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
   mai = Range("B16")
     Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
 
    If answer = Empty Then
     ActiveSheet.Protect Password:=qwe & rty & uio
    Else
     Dim counter
counter = 31
    Do While counter < mai + 30
            If answer = Cells(counter, 3).Value Then
            MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
            GoTo LINE1
            End If
            counter = counter + 1
    Loop
    
  Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 31 To mai + 30
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 30, 2), Cells(ser_no + 30, 22)).Select
 Selection.Insert Shift:=xlDown
  Range(Cells(ser_no + 30, 29), Cells(ser_no + 30, 30)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 30, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 10
   Selection.Font.Bold = False
    Cells(ser_no + 31, 2).Select
   ActiveCell.FormulaR1C1 = "=R[-1]C+1"
     If ser_no = mai - 1 Then GoTo line3:
    Cells(ser_no + 31, 2).Select
    Selection.Copy
    Range(Cells(ser_no + 32, 2), Cells(mai + 30, 2)).Select
    ActiveSheet.PASTE
    GoTo line3:
line2:
ser_no = mai


 
Range("A16:B16").Select
Selection.Copy
Cells(30 + ser_no * 1, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
line3:

Columns("C:C").Select
    Selection.NumberFormat = "@"
    
   Cells(30 + ser_no * 1, 3).Select
   ActiveCell.FormulaR1C1 = answer
    Range("E16:V16").Select
  Selection.Copy
  Cells(30 + ser_no * 1, 5).Select
  ActiveSheet.PASTE
   Selection.Interior.ColorIndex = xlNone
  Range("ac16:Ad16").Select
  Selection.Copy
  Cells(30 + ser_no * 1, 29).Select
  ActiveSheet.PASTE
            Selection.Interior.ColorIndex = xlNone
        ActiveWindow.LargeScroll ToRight:=1
        Cells(30 + ser_no * 1, 6).Select
 Application.CutCopyMode = False
   Selection.Copy
   Cells(30 + ser_no * 1, 3).Select
    Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
      
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
    End With
      
  Application.CutCopyMode = False
  
  

    Range("D16").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ScrollColumn = 1
   Cells(30 + ser_no * 1, 4).Select
    Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
    Cells(30 + ser_no * 1, 5).Select
    Application.CutCopyMode = False
    Selection.Copy
    Cells(30 + ser_no * 1, 4).Select
    Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
         Selection.NumberFormat = "# ?/?"
       Selection.Locked = False
    Selection.FormulaHidden = False
        With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
    End With
    
       With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$Ag$2:$Ag$15"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The pipe size must be either ""3/4"", ""1"" , ""1 1/4"", ""1 1/2"", ""2"", ""2 1/2"", ""3"", ""3 1/2"", ""4"", ""5"", ""6"", ""8"", ""10"" or ""12"". Any size else is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
   Application.CutCopyMode = False
Selection.Interior.ColorIndex = xlNone
    
Range("s10").Select

ActiveCell.FormulaR1C1 = "=sum(R[+21]C[+2]:R[+1990]C[+2])"
 Range("B16") = Range("B16") + 1
 Range("F16").ClearContents
  Range("H16").ClearContents
   Range("J16:R16").ClearContents
   Range("AH1").Select
    ActiveCell.FormulaR1C1 = "1"
      Range("F16").Select
 ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 7
    Application.CutCopyMode = False
LINE10:
  ActiveSheet.Protect Password:=qwe & rty & uio

End If
End Sub
Sub DELETE_PIPE_IN_HEAD_FOR_FIRE_HOSE_CABINET_PUMP()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
     mai = Range("B16")
     
Dim counter
counter = 31
Do While counter < mai + 30
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no pipe to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter the serial no. of the pipe segment required to be deleted.", "MAI Fire Fighting Calculations"))
 
elie = mai + 30
par = 0
For i = 31 To elie
If Right(Cells(i, 2), 1) <> ")" Then koko = Cells(i, 2).Value
If Right(Cells(i, 2), 1) = ")" Then koko = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2)
If answer = koko Then par = 1: Exit For

Next i
If par = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
 
  
    If answer = Empty Then
GoTo LINE10:
   Else
Dim banswer As String
 banswer = UCase(InputBox("TO serial no.", "MAI Fire Fighting Calculations"))
 

belie = mai + 30
bpar = 0
For V = 31 To belie
If Right(Cells(V, 2), V) <> ")" Then jeny = Cells(V, 2).Value
If Right(Cells(V, 2), 1) = ")" Then jeny = Mid(Cells(V, 2), 1, WorksheetFunction.Find("(", Cells(V, 2)) - 2)
If banswer = jeny Then bpar = 1: Exit For

Next V
AVAL = Cells(V, 2).Value
If bpar = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
If banswer = Empty Then
  
GoTo LINE10:
        
        Else
    If MsgBox("Are you sure you want to delete all pipe segments from """ & Cells(i, 3).Value & """ to """ & Cells(V, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
     
                      
          Range(Cells(i, 2), Cells(V, 22)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
           Range(Cells(i, 29), Cells(V, 30)).Select
           Cells(i, 29).Activate
           Selection.Delete Shift:=xlUp
           If AVAL = Range("B16") - 1 Then GoTo line2
           Cells(i, 2).Select
           If i = mai + 29 Then GoTo line2:
           ActiveCell.FormulaR1C1 = "=R[-1]C+1"
           Cells(i, 2).Select
        Selection.Copy
        Range(Cells(i, 2), Cells(mai + 28 - ((V - i) ^ 2) ^ (1 / 2), 2)).Select
         ActiveSheet.PASTE
line2:
            Range("B16") = Range("B16") - ((V - i) ^ 2) ^ (1 / 2) - 1
            End If
             End If
              End If
    '        Counter = Counter + 1
    'Loop
   Range("S10:T10").Select
   Selection = "=SUM($U$31:$U$2000)"
   
    Range("S5:V5").Select
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 38
LINE10:
     ActiveSheet.Protect Password:=qwe & rty & uio

End Sub


Sub RESET_ALL_HEAD_FOR_FIRE_HOSE_CABINET_PUMP()
'
' RESET_ALL_HEAD_FOR_FIRE_HOSE_CABINET_PUMP Macro
' Macro recorded 6/6/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If
    ActiveWindow.FreezePanes = False
     Range("S5:V5").ClearContents
     Range("S6:T8").ClearContents
     Range("F16").ClearContents
    Range("H16").ClearContents
    Range("J16:R16").ClearContents
     Range("o23:o26").ClearContents
     Range("AH1").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("B16").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("B31: V1150,ac31:ad1034").Select
    Selection.ClearContents
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With
    
    
    DialogSheets("Dialog_FHC_PUMP_DATA").Visible = -1
    Sheets("Dialog_FHC_PUMP_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 7").Select
    Selection.Characters.Text = ""
 
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("FIRE HOSE CABINET PUMP").Select
    DialogSheets("Dialog_FHC_PUMP_DATA").Visible = 0
      Sheets("DIALOG_option_FHC_PUMP").Visible = 0
Sheets("List reference").Visible = 0
    
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 50
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("Z31").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 63
   
     Range("S5:V5").Select
    ActiveSheet.Protect Password:=qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub RESET_DATA_ENTRY_TABLE_HEAD_FOR_FIRE_HOSE_CABINET_PUMP()
'
' RESET_DATA_ENTRY_TABLE_HEAD_FOR_FIRE_HOSE_CABINET_PUMP Macro
' Macro recorded 6/6/1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    Range("F16").ClearContents
    Range("H16").ClearContents
    Range("J16:R16").ClearContents
    Range("AH1").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("F16").Select
    ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1
End Sub

Sub PRINT_fhc_pump()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$30"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&10&D"
        .CenterFooter = ""
        .RightFooter = "&10Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.3)
        .RightMargin = Application.InchesToPoints(0.23)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.25)
        .FooterMargin = Application.InchesToPoints(0.26)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 81
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("o23:o27,C23:C26,p28").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 11.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("p28").Select
     With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
 With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With

 
    ActiveSheet.PageSetup.PrintArea = ""
 Rows("17:30").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B16")
    Range(Rows(31), Rows(250)).Select
    Selection.RowHeight = 16.5
    Range(Rows(23), Rows(27)).Select
    Selection.RowHeight = 15.75
   Rows("28:28").RowHeight = 31
    Range("B4:r11").Select
    Selection.Copy
    Cells(mai + 30, 2).Select
    ActiveSheet.PASTE
    Range("s4:v11").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range(Cells(mai + 30, 19), Cells(mai + 37, 22)).Select
    ActiveSheet.PASTE
    Selection.Copy
    Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        Range("s9:V9").Select
    Selection.Copy
      
     Range(Cells(mai + 35, 19), Cells(mai + 35, 20)).Select
    ActiveSheet.PASTE Link:=True
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
      Range("s10:V10").Select
    Selection.Copy
      
     Range(Cells(mai + 36, 19), Cells(mai + 36, 20)).Select
    ActiveSheet.PASTE Link:=True
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
       Range("s11:V11").Select
    Selection.Copy
        Range(Cells(mai + 37, 19), Cells(mai + 37, 20)).Select
    ActiveSheet.PASTE Link:=True
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
   ''' Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
   Range(Cells(mai + 30, 2), Cells(mai + 37, 22)).Select
    Application.CutCopyMode = False
    Selection.Interior.ColorIndex = xlNone
    Range(Cells(mai + 31, 2), Cells(mai + 37, 22)).Select
    With Selection.Interior
        .ColorIndex = 0
        .Pattern = xlGray8
        .PatternColorIndex = xlAutomatic
    End With
              
Range(Cells(21, 2), Cells(mai + 37, 22)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
  Range(Rows(mai + 31), Rows(mai + 37)).Select
    Selection.RowHeight = 30
''ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
  Range(Rows(mai + 31), Rows(mai + 37)).Select
    Selection.RowHeight = 16.5
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("17:30").Select
 Selection.EntireRow.Hidden = True
 
Range(Cells(mai + 30, 2), Cells(mai + 37, 22)).Select
     Selection.UnMerge
    Selection.ClearContents
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Interior.ColorIndex = xlNone
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 50
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("Z31").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 63
    Range("S5:V5").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub


 

Sub option_FHC_PUMP()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_PUMP_NAME(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 5) = "FHCP_" Then
SHT_PUMP_NAME(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 18) = SHT_PUMP_NAME(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$r$3:$r$" & j + 2
Sheets("DIALOG_option_FHC_PUMP").Visible = -1
Sheets("DIALOG_option_FHC_PUMP").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$r$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("fire hose cabinet pump").Select
  
    DialogSheets("DIALOG_option_FHC_PUMP").Show

  
End Sub

Sub OPEN_pump_FHC_PUMP()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("DIALOG_option_FHC_PUMP").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No pump has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("fire hose cabinet pump").Select: Sheets("DIALOG_option_FHC_PUMP").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
    elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no pump with this No. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("fire hose cabinet pump").Select: Sheets("DIALOG_option_FHC_PUMP").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("fire hose cabinet pump").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("DIALOG_option_FHC_PUMP").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("fire hose cabinet pump").Visible = 0
    
   
 Sheets("DIALOG_option_FHC_PUMP").Visible = -1
   Sheets("DIALOG_option_FHC_PUMP").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_FHC_PUMP").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub SAVE_pump_FHC_PUMP()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim PUMP_NAME As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

PUMP_NAME = UCase(Range("o26"))
If Len(PUMP_NAME) > 26 Then MsgBox ("The number of Pump No. characters must be less than 27."), vbCritical, "MAI Fire Fighting Calculations": Call FHC_PUMP_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If PUMP_NAME = "" Then MsgBox ("The Pump No. has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call FHC_PUMP_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("FHCP_" & PUMP_NAME)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the pump No."), vbCritical, "MAI Fire Fighting Calculations": Call FHC_PUMP_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Pump No. has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call FHC_PUMP_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = PUMP_NAME
         
     
  Sheets("fire hose cabinet pump").Select
   Sheets("fire hose cabinet pump").Copy Before:=Sheets(1)
  'PUMP_NAME1 = Range("j27")
   'With ActiveCell.Characters(Start:=1, length:=6).Font
   '     .Name = "Arial"
   '     .FontStyle = "Regular"
  '      .Size = 12
  '      .Strikethrough = False
  '      .Superscript = False
  '      .Subscript = False
  '      .OutlineFont = False
  '      .Shadow = False
  '      .Underline = xlUnderlineStyleNone
  '      .ColorIndex = xlAutomatic
 ' End With
Sheets("fire hose cabinet pump (2)").Select
 Sheets("fire hose cabinet pump (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("c1") = "FHCP_" & Range("o26")
 
    

 ActiveSheet.Shapes("Button 8").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 9").Select
    Selection.OnAction = "Back_to_FHC_PUMP"
    Range("A1:ac1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 50
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("Z31").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 63
    Range("s5:v5").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "FHCP_" & PUMP_NAME
Sheets("fire hose cabinet pump").Select
Call RESET_ALL_HEAD_FOR_FIRE_HOSE_CABINET_PUMP
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("fire hose cabinet pump").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("DIALOG_option_FHC_PUMP").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub DELETE_pump_FHC_PUMP()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("DIALOG_option_FHC_PUMP").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No pump has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("fire hose cabinet pump").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("DIALOG_option_FHC_PUMP").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no pump with this No. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("fire hose cabinet pump").Select: Sheets("DIALOG_option_FHC_PUMP").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("DIALOG_option_FHC_PUMP").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("fire hose cabinet pump").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_FHC_PUMP").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_FHC_PUMP_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("fire hose cabinet pump").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("DIALOG_option_FHC_PUMP").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_FHC_PUMP()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("fire hose cabinet pump").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("fire hose cabinet pump").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
 
Sub fhc_pump_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("ap33") = 2 Then
Range("s6") = Range("s6") / 15.85
Range("s6").NumberFormat = "0.0;;"
Range("s7") = Range("s7") / 3.28
Range("s8") = Range("s8") / 14.5
Range("s9").NumberFormat = "0.0;;"
Range("F16") = Range("F16") / 15.85
Range("F16").NumberFormat = "0.0;;"
Range("H16") = Range("H16") / 3.28
mai = Range("B16")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 30, 6) = Cells(i + 30, 6) / 15.85
Cells(i + 30, 6).NumberFormat = "0.0;;"
Cells(i + 30, 8) = Cells(i + 30, 8) / 3.28
Next i
End If
LINE10:
Range("ap33") = 1
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Sub fhc_pump_BRITISH()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("ap33") = 1 Then
Range("s6") = Range("s6") * 15.85
Range("s6").NumberFormat = "0;;"
Range("s7") = Range("s7") * 3.28
Range("s8") = Range("s8") * 14.5
Range("s9").NumberFormat = "0;;"
Range("F16") = Range("F16") * 15.85
Range("F16").NumberFormat = "0;;"
Range("H16") = Range("H16") * 3.28
mai = Range("B16")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 30, 6) = Cells(i + 30, 6) * 15.85
Cells(i + 30, 6).NumberFormat = "0;;"
Cells(i + 30, 8) = Cells(i + 30, 8) * 3.28
Next i
End If
LINE10:
Range("ap33") = 2
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Attribute VB_Name = "Module48"
Sub fhc_pipes_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

 mai = Range("b6")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 7).Value)
            Cells(counter13, 7).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio


osa = ActiveSheet.Name
OSA1 = Range("K23")
OSA2 = Range("K24")
OSA3 = Range("K25")



  DialogSheets("Dialog_fhc_pipes_DATA").Visible = -1
 DialogSheets("Dialog_fhc_pipes_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_fhc_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3


Sheets(osa).Select
DialogSheets("Dialog_fhc_pipes_DATA").Show

End Sub

Sub fhc_pipes_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_fhc_pipes_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
       
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai3) > 14 Then MsgBox ("The number of Network code characters must be less than 15."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai3 = "" Then MsgBox ("The Network code has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("FHCP NETWORK NO. " & mai3, i, 1) = "/" Or Mid("FHCP NETWORK NO. " & mai3, i, 1) = "*" Or Mid("FHCP NETWORK NO. " & mai3, i, 1) = "\" Or Mid("FHCP NETWORK NO. " & mai3, i, 1) = "?" Or Mid("FHCP NETWORK NO. " & mai3, i, 1) = "[" Or Mid("FHCP NETWORK NO. " & mai3, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Network Code"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("FHCP NETWORK NO. " & mai3) = SHTNAME(i) And osa <> "FHCP NETWORK NO. " & mai3 Then
MsgBox ("This Network Code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "FHCP NETWORK NO. " & mai3
 Range("c1") = "FHCP NETWORK NO. " & mai3
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "FHCP NETWORK NO. " & mai3: Exit For
 
  Next j
  
 Sheets("FHCP NETWORK NO. " & mai3).Select
LINE10:
  
  DialogSheets("Dialog_fhc_pipes_DATA").Visible = 0

  Range("K23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("K24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("K25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("d6").Select
  
LINE1:
  
 DialogSheets("Dialog_fhc_pipes_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
    
    
  ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub fhc_pipes_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_fhc_pipes_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub add_delete_fhc_pipe()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
 mai = Range("b6")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
 mai = Range("b6")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 7).Value)
            Cells(counter13, 7).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio



osa = ActiveSheet.Name
  DialogSheets("Dialog_add_delete_fhc_pipe").Visible = -1
 DialogSheets("Dialog_add_delete_fhc_pipe").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_fhc_pipes_DATA").Show


Sheets(osa).Select
DialogSheets("Dialog_add_delete_fhc_pipe").Show

End Sub
Sub ADD_pipe_fhc_pipe()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

first_row = 29
 mai = Range("b6")

 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 7).Value)
            Cells(counter13, 7).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop



If Range("d6") > 0 And Range("G6").Value = 0 And Range("H6").Value = 0 Then MsgBox ("Neither FHC class nor the distance from the furthest outlet has been entered for this pipe. Please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("d6") > 0 And Range("G6").Value = 0 Then MsgBox ("No FHC class has been selected for this pipe. Please select it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("d6") > 0 And Range("H6").Value = 0 Then MsgBox ("The distance from the furthest outlet has not been entered for this pipe. Please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub

Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

Dim ser_no As String
If mai = 1 Then ser_no = 1: GoTo line2:
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))

If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 13)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 28, 20), Cells(ser_no + 28, 23)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
  Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai


  
Range("a6:b6").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("E6:f6").Select
Selection.Copy
Cells(28 + ser_no, 5).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("J6:M6").Select
Selection.Copy
Cells(28 + ser_no, 10).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("T6:W6").Select
Selection.Copy
Cells(28 + ser_no, 20).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Range("G6").Select
Selection.Copy
Cells(28 + ser_no, 7).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
       False, Transpose:=False
       
Range("H6:I6").Select
Selection.Copy
Cells(28 + ser_no, 8).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
       
Range("d6").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 7).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
 Selection.Font.Bold = False
 With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    
   With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$AB$2:$AB$4"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The fire hose cabinet class must be either ""CLASS I"", ""CLASS II"" or ""CLASS III"". Any other class is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
    
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With

Range("X29").Select
Selection.Copy
Cells(28 + ser_no, 24).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

 
    
Range("B6") = Range("B6") + 1
Range("d6").ClearContents
Range("e6").ClearContents
Range("H6").ClearContents
Range("d6").Select
Range("AC1").Select
ActiveCell.FormulaR1C1 = "1"
     
Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 9

End If
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_fhc_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub ADD_pipe_feeding_two_existing_fhc_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

first_row = 29
 mai = Range("b6")

Dim answer As String
If mai < 3 Then MsgBox ("At least two pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
GoTo LINE10:
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

     Dim answer1 As String


line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
   
    If answer2 = Empty Then
    GoTo LINE10:
    Else
If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no + 28 <= x Or ser_no + 28 <= y Then MsgBox ("The line of this pipe must be located below the lines of the two existing pipes which are fed by it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28

If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If

If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 13)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 28, 20), Cells(ser_no + 28, 23)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
  Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai


  
Range("a6:b6").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("E6:f6").Select
Selection.Copy
Cells(28 + ser_no, 5).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("J6:M6").Select
Selection.Copy
Cells(28 + ser_no, 10).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("T6:W6").Select
Selection.Copy
Cells(28 + ser_no, 20).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Range("G6").Select
Selection.Copy
Cells(28 + ser_no, 7).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
       False, Transpose:=False
       
Range("H6:I6").Select
Selection.Copy
Cells(28 + ser_no, 8).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
       
Range("d6").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 7).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
 Selection.Font.Bold = False
 With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With

Range("X29").Select
Selection.Copy
Cells(28 + ser_no, 24).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"
Selection.Copy
Cells(28 + ser_no, 5).Select
Selection.PasteSpecial PASTE:=xlFormulas, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
Range(Cells(28 + ser_no, 4), Cells(28 + ser_no, 5)).Select
 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(28 + ser_no, 7).Select
With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With
ActiveCell.FormulaR1C1 = "=fhc_ADD_TWO_PIPES_class(R[" & x - 28 - ser_no & "]C, R[" & y - 28 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
        
Cells(28 + ser_no, 8).Select

ActiveCell.FormulaR1C1 = "=fhc_ADD_TWO_PIPES_max_distance(RC[-1], R[" & x - 28 - ser_no & "]C[-1], R[" & y - 28 - ser_no & "]C[-1],R[" & x - 28 - ser_no & "]C, R[" & y - 28 - ser_no & "]C)"

 Selection.Locked = True
    Selection.FormulaHidden = True
    


End If
End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 13)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Range("B6") = Range("B6") + 1
Range("d6").ClearContents
Range("e6").ClearContents
Range("H6").ClearContents
Range("d6").Select
Range("AC1").Select
ActiveCell.FormulaR1C1 = "1"


Application.CutCopyMode = False

ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 9
LINE10:

ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_fhc_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub modify_pipe_feeding_two_existing_fhc_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
first_row = 29
 mai = Range("b6")

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

If mai < 4 Then MsgBox ("At least three pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
     
     
     Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be modified.", "MAI Fire Fighting Calculations"))

elie = mai + 28
par = 0
For j = 29 To elie
If answer = Cells(j, 3).Value Then par = 1: Exit For


Next j
If Right(Cells(j, 2), 1) = ")" Then s = Mid(Cells(j, 2), 1, WorksheetFunction.Find("(", Cells(j, 2)) - 2) Else s = Cells(j, 2).Value
If par = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
If Cells(j, 2).Value < 3 Then MsgBox ("At least two pipe segments shall be existing above the pipe segment required to be modified."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:

   
    If answer = Empty Then GoTo LINE10:
    
    
     Dim answer1 As String
line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
elie = mai + 28
PAR1 = 0
For x = 29 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
If answer1 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
If answer2 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
elie = mai + 28
PAR2 = 0
For y = 29 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
If answer2 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    If answer2 = Empty Then
    GoTo LINE10:
    Else

If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:

LINE6:
ser_no = j - 28

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"
Selection.Copy
Cells(28 + ser_no, 5).Select
Selection.PasteSpecial PASTE:=xlFormulas, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
Range(Cells(28 + ser_no, 4), Cells(28 + ser_no, 5)).Select
 Selection.Locked = True
    Selection.FormulaHidden = True
        
Cells(28 + ser_no, 8).Select

ActiveCell.FormulaR1C1 = "=fhc_ADD_TWO_PIPES_max_distance(RC[-1], R[" & x - 28 - ser_no & "]C[-1], R[" & y - 28 - ser_no & "]C[-1],R[" & x - 28 - ser_no & "]C, R[" & y - 28 - ser_no & "]C)"

 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(28 + ser_no, 7).Select


With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

ActiveCell.FormulaR1C1 = "=fhc_ADD_TWO_PIPES_class(R[" & x - 28 - ser_no & "]C, R[" & y - 28 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
        
End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 13)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 9
Range("d6").Select

LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_fhc_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub DELETE_FHC_pipes()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    Dim x(1000)
Dim y(1000)

first_row = 29
     mai = Range("B6")
     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     


 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 7).Value)
            Cells(counter13, 7).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop


     Dim answer As String
If mai = 1 Then MsgBox ("There is no pipe to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Delete the pipe segments from serial no.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If Right(Cells(i, 2), 1) <> ")" Then koko = Cells(i, 2).Value
If Right(Cells(i, 2), 1) = ")" Then koko = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2)
If answer = koko Then par = 1: Exit For

Next i

If par = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer = Empty Then
  
    
  GoTo LINE10:
   Else
Dim banswer As String
 banswer = UCase(InputBox("TO serial no.", "MAI Fire Fighting Calculations"))
 

belie = mai + 28
bpar = 0
For V = 29 To belie
If Right(Cells(V, 2), V) <> ")" Then jeny = Cells(V, 2).Value
If Right(Cells(V, 2), 1) = ")" Then jeny = Mid(Cells(V, 2), 1, WorksheetFunction.Find("(", Cells(V, 2)) - 2)
If banswer = jeny Then bpar = 1: Exit For

Next V

If bpar = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
If banswer = Empty Then
  
GoTo LINE10:
        
        Else
        
kk = 0
If V >= i Then q = V: R = i
If i > V Then q = i: R = V
For j = 0 To mai + first_row - q - 1
x(j) = 0
y(j) = 0


If Right(Cells(mai - j + first_row, 2), 1) = ")" Then


x(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) - 1)
y(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - 1)

x(j) = Val(x(j))
y(j) = Val(y(j))


Dim SUN(1000)
For p = R To q

If Right(Cells(p, 2), 1) = ")" Then
SUN(p) = Mid(Cells(p, 2), 1, WorksheetFunction.Find("(", Cells(p, 2)) - 2)
If Val(SUN(p)) = x(j) Or Val(SUN(p)) = y(j) Then
kk = 1


GoTo line20:
End If
End If

If Cells(p, 2) = x(j) Or Cells(p, 2) = y(j) Then
kk = 1
Exit For
End If
Next p
If kk = 0 Then GoTo line21:
line20:
Exit For
End If

line21:
 Next j
 
 
    If kk = 1 Then


MsgBox ("The pipe code """) & Cells(mai - j + first_row, 3) & (""" must be modified first before deleting this pipe."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE10:
End If

If MsgBox("Are you sure you want to delete all pipe segments from """ & Cells(i, 3).Value & """ to """ & Cells(V, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else

   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(V, 13)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
          Range(Cells(i, 20), Cells(V, 23)).Select
           Cells(i, 20).Activate
           Selection.Delete Shift:=xlUp
            Range("X29").Select
    ActiveCell.FormulaR1C1 = "=FHC_PIPES_NO_CLASS(RC[-20],RC[-12],RC[-17])"
         Call delete_ser_no_adjusting(first_row, mai, Val(i), Val(V))
            
line2:
            Range("b6") = Range("b6") - ((V - i) ^ 2) ^ (1 / 2) - 1
            
           
            End If
            End If
            End If
        ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 38
    
    Range("d6").Select
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_fhc_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_fhc_pipe_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_add_delete_fhc_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub RESET_fhc_pipe()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If
 ActiveWindow.FreezePanes = False
Range("K23:K25").ClearContents
Range("d6").ClearContents
Range("e6").ClearContents
Range("H6").ClearContents
Range("B6").Select
ActiveCell.FormulaR1C1 = "1"
Range("AC1").Select
ActiveCell.FormulaR1C1 = "1"
Range("B29:M1034,T29:W1034,X30:X1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
Selection.Interior.ColorIndex = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

    DialogSheets("Dialog_fhc_pipes_DATA").Visible = -1
    Sheets("Dialog_fhc_pipes_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
  
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("Fire Hose Cabinet PIPing Sizing").Select
    DialogSheets("Dialog_fhc_pipes_DATA").Visible = 0
    Sheets("DIALOG_option_fhc_pipes").Visible = 0
   Sheets("List reference").Visible = 0
 '
 ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("R29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
Range("d6").Select
ActiveSheet.Protect Password:=qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_FHC_PIPES()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 mai = Range("b6")

 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 7).Value)
            Cells(counter13, 7).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop


  
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&9&D"
        .CenterFooter = ""
        .RightFooter = "&9Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 84
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("K23:K25,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 10.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("7:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B6")
    Range(Rows(29), Rows(250)).Select
    Selection.RowHeight = 20
    Range(Rows(21), Rows(27)).Select
    Selection.RowHeight = 14.25
                 
Range(Cells(21, 2), Cells(mai + 27, 10)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
''ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("7:28").Select
Selection.EntireRow.Hidden = True

ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("R29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
        Range("d6").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_fhc_pipes()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

 mai = Range("b6")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 7).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 7).Value)
            Cells(counter13, 7).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio



Dim SHT_network_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 17) = "FHCP NETWORK NO. " Then
SHT_network_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 19) = SHT_network_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$s$3:$s$" & j + 2
Sheets("DIALOG_option_fhc_pipes").Visible = -1
Sheets("DIALOG_option_fhc_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$s$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("Fire Hose Cabinet Piping Sizing").Select
  
    DialogSheets("DIALOG_option_fhc_pipes").Show

  
End Sub

Sub open_network_fhc_pipes()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("DIALOG_option_fhc_pipes").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No network has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("Fire Hose Cabinet Piping Sizing").Select: Sheets("DIALOG_option_fhc_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
   elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("Fire Hose Cabinet Piping Sizing").Select: Sheets("DIALOG_option_fhc_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
     
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("Fire Hose Cabinet Piping Sizing").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("DIALOG_option_fhc_pipes").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("Fire Hose Cabinet Piping Sizing").Visible = 0
    
   
 Sheets("DIALOG_option_fhc_pipes").Visible = -1
   Sheets("DIALOG_option_fhc_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_fhc_pipes").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_network_fhc_pipes()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim network_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

network_name = UCase(Range("K25"))
If Len(network_name) > 14 Then MsgBox ("The number of Network Code characters must be less than 15."), vbCritical, "MAI Fire Fighting Calculations": Call fhc_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If network_name = "" Then MsgBox ("The Network Code has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call fhc_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("FHCP NETWORK NO. " & network_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the network code."), vbCritical, "MAI Fire Fighting Calculations": Call fhc_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Network Code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call fhc_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = network_name
         
     
  Sheets("Fire Hose Cabinet Piping Sizing").Select
   Sheets("Fire Hose Cabinet Piping Sizing").Copy Before:=Sheets(1)
  'network_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
  '      .FontStyle = "Regular"
  '      .Size = 12
   '     .Strikethrough = False
  '      .Superscript = False
   '     .Subscript = False
   '     .OutlineFont = False
   '     .Shadow = False
  '      .Underline = xlUnderlineStyleNone
   '     .ColorIndex = xlAutomatic
 ' End With
Sheets("Fire Hose Cabinet Piping Si (2)").Select
 Sheets("Fire Hose Cabinet Piping Si (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("c1") = "FHCP Network NO. " & Range("K25")

 ActiveSheet.Shapes("Button 4").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 5").Select
    Selection.OnAction = "Back_to_fhc_pipes"
    Range("A1:Q1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
    Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
mai = Range("B6")
Dim counter1
counter1 = 29
Do While counter1 < mai + 28
            prop = UCase(Cells(counter1, 7).Value)
            Cells(counter1, 7).Value = prop
            counter1 = counter1 + 1
Loop


ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("R29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
 Range("d6").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "FHCP NETWORK NO. " & network_name
Sheets("Fire Hose Cabinet Piping Sizing").Select

Call RESET_fhc_pipe
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("Fire Hose Cabinet Piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("DIALOG_option_fhc_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_network_fhc_pipes()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("DIALOG_option_fhc_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No network has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("Fire Hose Cabinet Piping Sizing").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("DIALOG_option_fhc_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("Fire Hose Cabinet Piping Sizing").Select: Sheets("DIALOG_option_fhc_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("DIALOG_option_fhc_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("Fire Hose Cabinet Piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_fhc_pipes").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub option_fhc_pipes_CANCEL()

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("Fire Hose Cabinet Piping Sizing").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("DIALOG_option_fhc_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_fhc_pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Fire Hose Cabinet Piping Sizing").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Fire Hose Cabinet Piping Sizing").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub fhc_pipes_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("af31") = 2 Then
Range("e6") = Range("e6") / 15.85
Range("h6") = Range("h6") / 3.28
Range("e6").NumberFormat = "0.0;;"
Range("j6").NumberFormat = "0.0;;"
mai = Range("B6")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 5) = Cells(i + 28, 5) / 15.85
Cells(i + 28, 8) = Cells(i + 28, 8) / 3.28
line11:
Cells(i + 28, 5).NumberFormat = "0.0;;"
Cells(i + 28, 10).NumberFormat = "0.0;;"
Next i
End If
LINE10:
Range("af31") = 1
Range("d6").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Sub fhc_pipes_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("af31") = 1 Then
Range("e6") = Range("e6") * 15.85
Range("h6") = Range("h6") * 3.28
Range("e6").NumberFormat = "0;;"
Range("j6").NumberFormat = "0;;"
mai = Range("B6")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 5) = Cells(i + 28, 5) * 15.85
Cells(i + 28, 8) = Cells(i + 28, 8) * 3.28
line11:
Cells(i + 28, 5).NumberFormat = "0;;"
Cells(i + 28, 10).NumberFormat = "0;;"
Next i
End If
LINE10:
Range("af31") = 2
Range("d6").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Attribute VB_Name = "Module49"
Sub sprinkler_pipes_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

 mai = Range("b12")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 5).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE102:
End If

            prop = UCase(Cells(counter13, 5).Value)
            Cells(counter13, 5).Value = prop
LINE102:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio

osa = ActiveSheet.Name
OSA1 = Range("I23")
OSA2 = Range("I24")
OSA3 = Range("I25")



  Sheets("Dialog_sprinkler_pipes_DATA").Visible = -1
 Sheets("Dialog_sprinkler_pipes_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'Sheets("Dialog_sprinkler_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3

Sheets(osa).Select
Sheets("Dialog_sprinkler_pipes_DATA").Show

End Sub

Sub sprinkler_pipes_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_sprinkler_pipes_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
 
     
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai3) > 14 Then MsgBox ("The number of Network code characters must be less than 15."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai3 = "" Then MsgBox ("The Network code has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("SPR. NETWORK NO. " & mai3, i, 1) = "/" Or Mid("SPR. NETWORK NO. " & mai3, i, 1) = "*" Or Mid("SPR. NETWORK NO. " & mai3, i, 1) = "\" Or Mid("SPR. NETWORK NO. " & mai3, i, 1) = "?" Or Mid("SPR. NETWORK NO. " & mai3, i, 1) = "[" Or Mid("SPR. NETWORK NO. " & mai3, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Network code"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("SPR. NETWORK NO. " & mai3) = SHTNAME(i) And osa <> "SPR. NETWORK NO. " & mai3 Then
MsgBox ("This Network code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "SPR. NETWORK NO. " & mai3
 Range("c1") = "SPR. NETWORK NO. " & mai3
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "SPR. NETWORK NO. " & mai3: Exit For
 
  Next j
  
 Sheets("SPR. NETWORK NO. " & mai3).Select
LINE10:
  Sheets("Dialog_sprinkler_pipes_DATA").Visible = 0

  Range("I23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("I24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("I25").Select
  ActiveCell.FormulaR1C1 = mai3
  
  Range("d12").Select
  
LINE1:
  
Sheets("Dialog_sprinkler_pipes_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
      
   ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub sprinkler_pipes_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
Sheets("Dialog_sprinkler_pipes_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub add_delete_sprinkler_pipe()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
 mai = Range("b12")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 5).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE100:
End If

            prop = UCase(Cells(counter13, 5).Value)
            Cells(counter13, 5).Value = prop
LINE100:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio


osa = ActiveSheet.Name
  Sheets("Dialog_add_delete_sprink_pipe").Visible = -1
 Sheets("Dialog_add_delete_sprink_pipe").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'Sheets("Dialog_sprink_pipes_DATA").Show


Sheets(osa).Select
Sheets("Dialog_add_delete_sprink_pipe").Show

End Sub
Sub ADD_pipe_sprinkler_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio


If Range("E12").Value = 0 And Range("D12").Value >= 1 Then MsgBox ("No hazard occupancy has been selected for this pipe. Please select a hazard."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
first_row = 29
mai = Range("B12")
Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop


Dim ser_no As String
If mai = 1 Then ser_no = 1: GoTo line2:
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))

If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 10)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 28, 19), Cells(ser_no + 28, 22)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai

  
Range("a12:b12").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("f12:j12").Select
Selection.Copy
Cells(28 + ser_no, 6).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("S12:V12").Select
Selection.Copy
Cells(28 + ser_no, 19).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(28 + ser_no, 8).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False

Cells(28 + ser_no, 8).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 5).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
      
        With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$Y$6:$Y$8"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The occupancy hazard must be either ""EXTRA"", ""ORDINARY"" or ""LIGHT"". Any other hazard is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
     
      
Application.CutCopyMode = False

Cells(28 + ser_no, 3).Select
 Selection.Font.Bold = True
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
Range("e12").Select
Selection.Copy
Cells(28 + ser_no, 5).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
False, Transpose:=False


Range("d12").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Range("W29").Select
Selection.Copy
Cells(28 + ser_no, 23).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
    
    
Range("B12") = Range("B12") + 1
Range("d12,f12,h12").ClearContents
Range("Z5").Select
ActiveCell.FormulaR1C1 = "1"
Range("d12").Select
     
Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 6

End If
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_add_delete_sprink_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub ADD_pipe_feeding_two_existing_sprinkler_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

first_row = 29
 mai = Range("b12")

Dim answer As String
If mai < 3 Then MsgBox ("At least two pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
GoTo LINE10:
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

     Dim answer1 As String


line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
   
    If answer2 = Empty Then
    GoTo LINE10:
    Else
If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no + 28 <= x Or ser_no + 28 <= y Then MsgBox ("The line of this pipe must be located below the lines of the two existing pipes which are fed by it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28

If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If

If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 10)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 28, 19), Cells(ser_no + 28, 22)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai

  
Range("a12:b12").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("f12:j12").Select
Selection.Copy
Cells(28 + ser_no, 6).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("S12:V12").Select
Selection.Copy
Cells(28 + ser_no, 19).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(28 + ser_no, 8).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False

Cells(28 + ser_no, 8).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 5).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False

Cells(28 + ser_no, 3).Select
 Selection.Font.Bold = True
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
Range("e12").Select
Selection.Copy
Cells(28 + ser_no, 5).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
False, Transpose:=False


Range("d12").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Range("W29").Select
Selection.Copy
Cells(28 + ser_no, 23).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"
 Selection.Locked = True
    Selection.FormulaHidden = True

Cells(28 + ser_no, 5).Select
With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With
ActiveCell.FormulaR1C1 = "=spr_ADD_TWO_PIPES_hazard(R[" & x - 28 - ser_no & "]C, R[" & y - 28 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(28 + ser_no, 6).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 28 - ser_no & "]C,R[" & y - 28 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(28 + ser_no, 8).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 28 - ser_no & "]C,R[" & y - 28 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    

End If
End If
End If
  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 10)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Range("B12") = Range("B12") + 1
Range("d12,f12,h12").ClearContents
Range("Z5").Select
ActiveCell.FormulaR1C1 = "1"
Range("d12").Select
  

Application.CutCopyMode = False

ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 6
LINE10:

ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_add_delete_sprink_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub modify_pipe_feeding_two_existing_sprinkler_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
first_row = 29
 mai = Range("b12")

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

If mai < 4 Then MsgBox ("At least three pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
     
     
     Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be modified.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For j = 29 To elie
If answer = Cells(j, 3).Value Then par = 1: Exit For


Next j
If Right(Cells(j, 2), 1) = ")" Then s = Mid(Cells(j, 2), 1, WorksheetFunction.Find("(", Cells(j, 2)) - 2) Else s = Cells(j, 2).Value
If par = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
If Cells(j, 2).Value < 3 Then MsgBox ("At least two pipe segments shall be existing above the pipe segment required to be modified."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
   
    If answer = Empty Then GoTo LINE10:
    
    
     Dim answer1 As String
line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
If answer1 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
If answer2 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer2 = Empty Then
    GoTo LINE10:
    Else

If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:

LINE6:
ser_no = j - 28

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"
 Selection.Locked = True
    Selection.FormulaHidden = True

Cells(28 + ser_no, 5).Select

With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

ActiveCell.FormulaR1C1 = "=spr_ADD_TWO_PIPES_hazard(R[" & x - 28 - ser_no & "]C, R[" & y - 28 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(28 + ser_no, 6).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 28 - ser_no & "]C,R[" & y - 28 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(28 + ser_no, 8).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 28 - ser_no & "]C,R[" & y - 28 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
        
End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 10)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 6
Range("d12").Select

LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_add_delete_sprink_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub DELETE_sprinkler_pipes()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
  Dim x(1000)
Dim y(1000)
first_row = 29
  mai = Range("b12")

 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 5).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE102:
End If

            prop = UCase(Cells(counter13, 5).Value)
            Cells(counter13, 5).Value = prop
LINE102:

            counter13 = counter13 + 1
Loop

     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     

     Dim answer As String
If mai = 1 Then MsgBox ("There is no pipe to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Delete the pipe segments from serial no.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If Right(Cells(i, 2), 1) <> ")" Then koko = Cells(i, 2).Value
If Right(Cells(i, 2), 1) = ")" Then koko = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2)
If answer = koko Then par = 1: Exit For

Next i

If par = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer = Empty Then
  
    
  GoTo LINE10:
   Else
Dim banswer As String
 banswer = UCase(InputBox("TO serial no.", "MAI Fire Fighting Calculations"))
 

belie = mai + 28
bpar = 0
For V = 29 To belie
If Right(Cells(V, 2), V) <> ")" Then jeny = Cells(V, 2).Value
If Right(Cells(V, 2), 1) = ")" Then jeny = Mid(Cells(V, 2), 1, WorksheetFunction.Find("(", Cells(V, 2)) - 2)
If banswer = jeny Then bpar = 1: Exit For

Next V

If bpar = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
If banswer = Empty Then
  
GoTo LINE10:
        
        Else
        
        
kk = 0
If V >= i Then q = V: R = i
If i > V Then q = i: R = V
For j = 0 To mai + first_row - q - 1
x(j) = 0
y(j) = 0

If Right(Cells(mai - j + first_row, 2), 1) = ")" Then


x(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) - 1)
y(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - 1)
x(j) = Val(x(j))
y(j) = Val(y(j))

Dim SUN(1000)
For p = R To q

If Right(Cells(p, 2), 1) = ")" Then
SUN(p) = Mid(Cells(p, 2), 1, WorksheetFunction.Find("(", Cells(p, 2)) - 2)
If Val(SUN(p)) = x(j) Or Val(SUN(p)) = y(j) Then
kk = 1
GoTo line20:
End If
End If

If Cells(p, 2) = x(j) Or Cells(p, 2) = y(j) Then
kk = 1
Exit For
End If
Next p
If kk = 0 Then GoTo line21:
line20:
Exit For
End If

line21:
 Next j
 
 
    If kk = 1 Then


MsgBox ("The pipe code """) & Cells(mai - j + first_row, 3) & (""" must be modified first before deleting this pipe."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE10:
End If

If MsgBox("Are you sure you want to delete all pipe segments from """ & Cells(i, 3).Value & """ to """ & Cells(V, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(V, 10)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
          Range(Cells(i, 19), Cells(V, 22)).Select
           Cells(i, 19).Activate
           Selection.Delete Shift:=xlUp
           Range("W29").Select
    ActiveCell.FormulaR1C1 = "=SPR_PIPES_NO_HAZARD_SELECTED(RC[-18],RC[-19],RC[-14])"
           Call delete_ser_no_adjusting(first_row, mai, Val(i), Val(V))
            
line2:
            Range("b12") = Range("b12") - ((V - i) ^ 2) ^ (1 / 2) - 1
            
           End If
            End If
            End If
        ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 36
    
    Range("d12").Select
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("Dialog_add_delete_SPRINK_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_sprinkler_pipe_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
Sheets("Dialog_add_delete_sprink_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub RESET_sprinkler_pipes()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If

  ActiveWindow.FreezePanes = False
Range("B12").Select
ActiveCell.FormulaR1C1 = "1"
Range("Z5").Select
ActiveCell.FormulaR1C1 = "1"
Range("I23:I25").ClearContents
Range("d12,f12").ClearContents
Range("B29:J1034,S29:V1034,W30:W1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
Selection.Interior.ColorIndex = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

    Sheets("Dialog_sprinkler_pipes_DATA").Visible = -1
    Sheets("Dialog_sprinkler_pipes_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
    
   
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("Sprinklers PIPing Sizing").Select
    Sheets("Dialog_sprinkler_pipes_DATA").Visible = 0
    Sheets("DIALOG_option_sprinkler_pipes").Visible = 0
Sheets("List reference").Visible = 0
    
ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("O29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
Range("d12").Select
ActiveSheet.Protect Password:=qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub PRINT_Sprinkler_PIPES()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
 mai = Range("b12")

 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 5).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE102:
End If

            prop = UCase(Cells(counter13, 5).Value)
            Cells(counter13, 5).Value = prop
LINE102:

            counter13 = counter13 + 1
Loop

  
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&10&D"
        .CenterFooter = ""
        .RightFooter = "&10Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.75)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 89
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("I23:I26,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("13:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B12")
    Range(Rows(29), Rows(250)).RowHeight = 20
    Range(Rows(21), Rows(27)).RowHeight = 15
 
                 
Range(Cells(21, 2), Cells(mai + 27, 11)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("13:28").Select
Selection.EntireRow.Hidden = True

ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("O29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
        Range("d12").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_sprinkler_pipes()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

 mai = Range("b12")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter13
counter13 = 29
Do While counter13 < mai + 28
Cells(counter13, 5).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE102:
End If

            prop = UCase(Cells(counter13, 5).Value)
            Cells(counter13, 5).Value = prop
LINE102:

            counter13 = counter13 + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio


Dim SHT_network_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 17) = "SPR. NETWORK NO. " Then
SHT_network_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 20) = SHT_network_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$t$3:$t$" & j + 2
Sheets("DIALOG_option_sprinkler_pipes").Visible = -1
Sheets("DIALOG_option_sprinkler_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$t$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("sprinklers piping Sizing").Select
  
    Sheets("DIALOG_option_sprinkler_pipes").Show

  
End Sub

Sub open_network_sprinkler_pipes()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("DIALOG_option_sprinkler_pipes").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No network has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("sprinklers piping Sizing").Select: Sheets("DIALOG_option_sprinkler_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("sprinklers piping Sizing").Select: Sheets("DIALOG_option_sprinkler_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("sprinklers piping Sizing").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("DIALOG_option_sprinkler_pipes").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("sprinklers piping Sizing").Visible = 0
    
   
 Sheets("DIALOG_option_sprinkler_pipes").Visible = -1
   Sheets("DIALOG_option_sprinkler_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_sprinkler_pipes").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_network_sprinkler_pipes()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim network_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

network_name = UCase(Range("I25"))
If Len(network_name) > 14 Then MsgBox ("The number of Network Code characters must be less than 15."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If network_name = "" Then MsgBox ("The Network Code has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("SPR. NETWORK NO. " & network_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the network code."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Network Code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = network_name
         
     
  Sheets("sprinklers piping Sizing").Select
   Sheets("sprinklers piping Sizing").Copy Before:=Sheets(1)
  'network_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
  '      .FontStyle = "Regular"
 '       .Size = 12
  '      .Strikethrough = False
  '      .Superscript = False
   '     .Subscript = False
   '     .OutlineFont = False
    '    .Shadow = False
    '    .Underline = xlUnderlineStyleNone
    '    .ColorIndex = xlAutomatic
 ' End With
Sheets("sprinklers piping Sizing (2)").Select
 Sheets("sprinklers piping Sizing (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("c1") = "Spr. Network NO. " & Range("I25")

 ActiveSheet.Shapes("Button 7").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 8").Select
    Selection.OnAction = "Back_to_sprinkler_pipes"
    Range("A1:Q1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
 Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
mai = Range("B12")
Dim counter4
counter4 = 29
Do While counter4 < mai + 28
            prop = UCase(Cells(counter4, 5).Value)
            Cells(counter4, 5).Value = prop
            counter4 = counter4 + 1
Loop

ActiveWindow.FreezePanes = False
ActiveWindow.Zoom = 65
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("O29").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 75
    Range("d12").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "SPR. NETWORK NO. " & network_name
Sheets("sprinklers piping Sizing").Select

Call RESET_sprinkler_pipes
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("sprinklers piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("DIALOG_option_sprinkler_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_network_sprinkler_pipes()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("DIALOG_option_sprinkler_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No network has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("sprinklers piping Sizing").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("DIALOG_option_sprinkler_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  
 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("sprinklers piping Sizing").Select: Sheets("DIALOG_option_sprinkler_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("DIALOG_option_sprinkler_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("sprinklers piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_sprinkler_pipes").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub option_sprinkler_pipes_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("sprinklers piping Sizing").Select
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_sprinkler_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_sprinkler_pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("sprinklers piping Sizing").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("sprinklers piping Sizing").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub



Sub sprinkler_pipes_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("ai33") = 2 Then
Range("f12") = Range("f12") / 3.28
mai = Range("B12")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 6).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 6) = Cells(i + 28, 6) / 3.28
line11:
Next i
End If
LINE10:
Range("ai33") = 1
Range("d12").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub

Sub sprinkler_pipes_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("ai33") = 1 Then
Range("f12") = Range("f12") * 3.28
mai = Range("B12")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 6).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 6) = Cells(i + 28, 6) * 3.28
line11:
Next i
End If
LINE10:
Range("ai33") = 2
Range("d12").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Attribute VB_Name = "Module5"
Sub UNPROTECT_SHEET()
'
' UNPROTECT Macro
' Macro recorded 7/7/1995 by Mai
'
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'
End Sub


Sub PROTECT_SHEET()
Attribute PROTECT_SHEET.VB_ProcData.VB_Invoke_Func = "i\n14"
'
' UNPROTECT Macro
' Macro recorded 7/7/1995 by Mai
'
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Attribute VB_Name = "Module50"
Sub combined_pipes_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

mai = Range("B18")
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop

ActiveSheet.Protect Password:=qwe & rty & uio
Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop

osa = ActiveSheet.Name
OSA1 = Range("N23")
OSA2 = Range("N24")
OSA3 = Range("N25")

  DialogSheets("Dialog_combined_pipes_DATA").Visible = -1
 DialogSheets("Dialog_combined_pipes_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_combined_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3

Sheets(osa).Select
DialogSheets("Dialog_combined_pipes_DATA").Show

End Sub

Sub combined_pipes_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_combined_pipes_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
 
     
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai3) > 13 Then MsgBox ("The number of Network code characters must be less than 14."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai3 = "" Then MsgBox ("The Network code has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("COMB. NETWORK NO. " & mai3, i, 1) = "/" Or Mid("COMB. NETWORK NO. " & mai3, i, 1) = "*" Or Mid("COMB. NETWORK NO. " & mai3, i, 1) = "\" Or Mid("COMB. NETWORK NO. " & mai3, i, 1) = "?" Or Mid("COMB. NETWORK NO. " & mai3, i, 1) = "[" Or Mid("COMB. NETWORK NO. " & mai3, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Network code"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("COMB. NETWORK NO. " & mai3) = SHTNAME(i) And osa <> "COMB. NETWORK NO. " & mai3 Then
MsgBox ("This Network code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "COMB. NETWORK NO. " & mai3
 Range("c1") = "COMB. NETWORK NO. " & mai3
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "COMB. NETWORK NO. " & mai3: Exit For
 
  Next j
  
 Sheets("COMB. NETWORK NO. " & mai3).Select
LINE10:
  
  DialogSheets("Dialog_combined_pipes_DATA").Visible = 0

  Range("N23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("N24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("N25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("d18").Select
LINE1:
  
 DialogSheets("Dialog_combined_pipes_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
      
 ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub combined_pipes_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_combined_pipes_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub add_delete_combined_pipe()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
 mai = Range("b18")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Dim counter
counter = 30
Do While counter < mai + 29
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop
Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop

 ActiveSheet.Protect Password:=qwe & rty & uio


osa = ActiveSheet.Name
  DialogSheets("Dialog_add_delete_combined_pipe").Visible = -1
 DialogSheets("Dialog_add_delete_combined_pipe").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_combined_pipes_DATA").Show


Sheets(osa).Select
DialogSheets("Dialog_add_delete_combined_pipe").Show

End Sub
Sub ADD_pipe_combined_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
first_row = 30
mai = Range("B18")
 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop

Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop

If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value = 0 And Range("X18").Value = 0 And Range("AA18").Value = 0 Then MsgBox ("The sprinkler occupancy hazard, class of fire hose cabinet, type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value = 0 And Range("X18").Value = 0 And Range("AA18").Value = 0 Then MsgBox ("The class of fire hose cabinet, type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value <> 0 And Range("X18").Value = 0 And Range("AA18").Value = 0 Then MsgBox ("The sprinkler occupancy hazard, type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value = 0 And Range("X18").Value <> 0 And Range("AA18").Value = 0 Then MsgBox ("The sprinkler occupancy hazard, class of fire hose cabinet and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value = 0 And Range("X18").Value = 0 And Range("AA18").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard, class of fire hose cabinet and type of pipe have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value <> 0 And Range("X18").Value = 0 And Range("AA18").Value = 0 Then MsgBox ("The type of pipe and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value = 0 And Range("X18").Value <> 0 And Range("AA18").Value = 0 Then MsgBox ("The class of fire hose cabinet and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value = 0 And Range("X18").Value = 0 And Range("AA18").Value <> 0 Then MsgBox ("The class of fire hose cabinet and type of pipe have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value <> 0 And Range("X18").Value <> 0 And Range("AA18").Value = 0 Then MsgBox ("The sprinkler occupancy hazard and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value <> 0 And Range("X18").Value = 0 And Range("AA18").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard and type of pipe have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value = 0 And Range("X18").Value <> 0 And Range("AA18").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard and class of fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value = 0 And Range("W18").Value <> 0 And Range("X18").Value <> 0 And Range("AA18").Value <> 0 Then MsgBox ("The sprinkler occupancy hazard has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value = 0 And Range("X18").Value <> 0 And Range("AA18").Value <> 0 Then MsgBox ("The class of fire hose cabinet has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value <> 0 And Range("X18").Value = 0 And Range("AA18").Value <> 0 Then MsgBox ("The type of pipe has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("E18").Value >= 1 And Range("E18").Value < 100000 And Range("V18").Value <> 0 And Range("W18").Value <> 0 And Range("X18").Value <> 0 And Range("AA18").Value = 0 Then MsgBox ("The distance from the most remote fire hose cabinet has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub

If Range("D18").Value >= 1 And Range("D18").Value < 100000 And Range("v18").Value = 0 Then MsgBox ("The sprinkler occupancy hazard has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub


If Range("e18").Value >= 1 And Range("e18").Value < 100000 And Range("w18").Value = 0 And Range("aa18").Value = 0 Then MsgBox ("The class of fire hose cabinet and the distance from the most remote fire hose cabinet have not been entered. please enter them."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("e18").Value >= 1 And Range("e18").Value < 100000 And Range("w18").Value <> 0 And Range("aa18").Value = 0 Then MsgBox ("The distance from the most remote fire hose cabinet has not been entered. please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
If Range("e18").Value >= 1 And Range("e18").Value < 100000 And Range("w18").Value = 0 And Range("aa18").Value <> 0 Then MsgBox ("The class of fire hose cabinet has not been entered for this pipe. Please enter it."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub

Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 30
Do While counter < mai + 29
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop


Dim ser_no As String
If mai = 1 Then ser_no = 1: GoTo line2:
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))

If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 30 To mai + 29
If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 29, 2), Cells(ser_no + 29, 19)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 29, 22), Cells(ser_no + 29, 29)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 29, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 11
     Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai
  
Range("a18:b18").Select
Selection.Copy
Cells(29 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(29 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer

Range("f18:G18").Select
Selection.Copy
Cells(29 + ser_no, 6).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Range("K18:S18").Select
Selection.Copy
Cells(29 + ser_no, 11).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Range("V18:AC18").Select
Selection.Copy
Cells(29 + ser_no, 22).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
      
Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 8).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Selection.Font.Bold = False

Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 9).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Selection.Font.Bold = False

Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 10).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Selection.Font.Bold = False
With Selection.Font
        .Size = 10
End With
      
Application.CutCopyMode = False
Cells(29 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
Range("h18").Select
Selection.Copy
Cells(29 + ser_no, 8).Select

Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
         With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$AD$4:$AD$7"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The occupancy hazard must be either ""EXTRA"", ""ORDINARY"" or ""LIGHT"". Any other hazard is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
            
        
Range("I18").Select
Selection.Copy
Cells(29 + ser_no, 9).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
    With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$AA$1:$AA$4"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The fire hose cabinet class must be either ""CLASS I"", ""CLASS II"" or ""CLASS III"". Any other class is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
        
Range("j18").Select
Selection.Copy
Cells(29 + ser_no, 10).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
                With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$X$1:$X$3"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The pipe type must be either ""HORIZONTAL"" or ""RISER"". Any other type is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
        
Range("d18:e18").Select
Selection.Copy
Cells(29 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
        
 Range("Ad30:AF30").Select
Selection.Copy
Cells(29 + ser_no, 30).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
        
 
Range("B18") = Range("B18") + 1
Range("d18:f18,K18,M18:N18").ClearContents
Range("Y1").Select
ActiveCell.FormulaR1C1 = "1"
Range("AB1").Select
ActiveCell.FormulaR1C1 = "1"
Range("AE4").Select
ActiveCell.FormulaR1C1 = "1"

Range("d18").Select
     
Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 7

End If
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_combined_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub ADD_pipe_feeding_two_existing_combined_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

first_row = 30
 mai = Range("b18")

Dim answer As String
If mai < 3 Then MsgBox ("At least two pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
GoTo LINE10:
Else
Dim counter
counter = 30
Do While counter < mai + 29
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

     Dim answer1 As String


line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 29
PAR1 = 0
For x = 30 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 29
PAR2 = 0
For y = 30 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
    If answer2 = Empty Then
    GoTo LINE10:
    Else
If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:


Call combined_pipe_Type

aanswer = Cells(mai + 29, 10).Value
'    Dim answer3 As String
'line13:
'answer3 = UCase(InputBox("Enter the pipe type ""HORIZONTAL"" or ""RISER"".", "MAI Fire Fighting Calculations", "HORIZONTAL"))
'par3 = 0
'If answer3 = "HORIZONTAL" Or answer3 = "RISER" Then par3 = 1
'If par3 = 0 Then MsgBox ("The pipe type must be either ""HORIZONTAL"" or ""RISER"". Any type else is not accepted."), vbCritical, "MAI Fire Fighting Calculations": GoTo line13:
   
'    If answer3 = Empty Then
'    GoTo line10:
'    Else

Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then Cells(29 + mai, 10).Select: ActiveCell.FormulaR1C1 = "": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE10:
If ser_no + 29 <= x Or ser_no + 29 <= y Then MsgBox ("The line of this pipe must be located below the lines of the two existing pipes which are fed by it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
If ser_no = mai Then GoTo line2:
par = 0
For i = 30 To mai + 29

If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If

If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 29, 2), Cells(ser_no + 29, 19)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 29, 22), Cells(ser_no + 29, 29)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 29, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 11
     Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai
  
Range("a18:b18").Select
Selection.Copy
Cells(29 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(29 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer

Range("f18:G18").Select
Selection.Copy
Cells(29 + ser_no, 6).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Range("K18:S18").Select
Selection.Copy
Cells(29 + ser_no, 11).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Range("V18:AC18").Select
Selection.Copy
Cells(29 + ser_no, 22).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone


Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
      
Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 8).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Selection.Font.Bold = False

Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 9).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Selection.Font.Bold = False

Cells(29 + ser_no, 13).Select
Application.CutCopyMode = False
Selection.Copy
Cells(29 + ser_no, 10).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Selection.Font.Bold = False

          With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$X$1:$X$3"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The pipe type must be either ""HORIZONTAL"" or ""RISER"". Any other type is not accepted."
       .ShowInput = True
       .ShowError = True
    End With

With Selection.Font
        .Size = 10
End With
      
Application.CutCopyMode = False
Cells(29 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
Range("h18").Select
Selection.Copy
Cells(29 + ser_no, 8).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
Range("I18").Select
Selection.Copy
Cells(29 + ser_no, 9).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
Range("j18").Select
Selection.Copy
Cells(29 + ser_no, 10).Select
Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
Range("d18:e18").Select
Selection.Copy
Cells(29 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
        
 Range("Ad30:AF30").Select
Selection.Copy
Cells(29 + ser_no, 30).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
        


Cells(29 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 29 - ser_no & "]C+R[" & y - 29 - ser_no & "]C"
Selection.Copy
Range(Cells(29 + ser_no, 5), Cells(29 + ser_no, 6)).Select
Selection.PasteSpecial PASTE:=xlFormulas, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
Range(Cells(29 + ser_no, 4), Cells(29 + ser_no, 6)).Select
 Selection.Locked = True
    Selection.FormulaHidden = True

Cells(29 + ser_no, 8).Select
With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

ActiveCell.FormulaR1C1 = "=COMBINED_ADD_TWO_PIPES_hazard(R[" & x - 29 - ser_no & "]C, R[" & y - 29 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 9).Select
With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

ActiveCell.FormulaR1C1 = "=COMBINED_ADD_TWO_PIPES_class(R[" & x - 29 - ser_no & "]C, R[" & y - 29 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 10).Select

          With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$X$1:$X$3"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The pipe type must be either ""HORIZONTAL"" or ""RISER"". Any other type is not accepted."
       .ShowInput = True
       .ShowError = True
    End With

ActiveCell.FormulaR1C1 = aanswer
If mai <> ser_no Then Cells(30 + mai, 10).ClearContents
    
Cells(29 + ser_no, 11).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 29 - ser_no & "]C,R[" & y - 29 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    
    
Cells(29 + ser_no, 13).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 29 - ser_no & "]C,R[" & y - 29 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 14).Select

ActiveCell.FormulaR1C1 = "=COMBINED_ADD_TWO_PIPES_max_distance(R[" & x - 29 - ser_no & "]C[-9],R[" & y - 29 - ser_no & "]C[-9],RC[-5], R[" & x - 29 - ser_no & "]C[-5], R[" & y - 29 - ser_no & "]C[-5],R[" & x - 29 - ser_no & "]C, R[" & y - 29 - ser_no & "]C)"

 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 18).Select
ActiveCell.FormulaR1C1 = "=IF(RC[11]=0,0,IF(OR(R[" & x - 29 - ser_no & "]C=""N/A"",R[" & y - 29 - ser_no & "]C=""N/A""),""N/A"", max(R[" & x - 29 - ser_no & "]C,R[" & y - 29 - ser_no & "]C,RC[11])))"
 Selection.Locked = True
    Selection.FormulaHidden = True

End If
End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(29 + ser_no, 2), Cells(29 + ser_no, 19)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

 
Range("B18") = Range("B18") + 1
Range("d18:f18,K18,M18:N18").ClearContents
Range("Y1").Select
ActiveCell.FormulaR1C1 = "1"
Range("AB1").Select
ActiveCell.FormulaR1C1 = "1"
Range("AE4").Select
ActiveCell.FormulaR1C1 = "1"

Range("d18").Select
  

Application.CutCopyMode = False

ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 7
LINE10:
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: DialogSheets("Dialog_Select_combined_fire_pip").Visible = 0: DialogSheets("Dialog_add_delete_combined_pipe").Visible = 0
 Range("D18").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'DialogSheets("Dialog_add_delete_combined_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub modify_pipe_feeding_two_existing_COMBINED_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
first_row = 30
 mai = Range("b18")

Dim counter
counter = 30
Do While counter < mai + 29
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

If mai < 4 Then MsgBox ("At least three pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
     
     
     Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be modified.", "MAI Fire Fighting Calculations"))
 
elie = mai + 29
par = 0
For j = 30 To elie
If answer = Cells(j, 3).Value Then par = 1: Exit For


Next j
If Right(Cells(j, 2), 1) = ")" Then s = Mid(Cells(j, 2), 1, WorksheetFunction.Find("(", Cells(j, 2)) - 2) Else s = Cells(j, 2).Value
If par = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:

If Cells(j, 2).Value < 3 Then MsgBox ("At least two pipe segments shall be existing above the pipe segment required to be modified."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
   
    If answer = Empty Then GoTo LINE10:
    
    
     Dim answer1 As String
line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 29
PAR1 = 0
For x = 30 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
If answer1 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 29
PAR2 = 0
For y = 30 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
If answer2 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer2 = Empty Then
    GoTo LINE10:
    Else

If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:


Dim aanswer As String
aanswer = ""
Range("b18") = Range("b18") - 1
Call combined_pipe_Type
aanswer = Cells(28 + mai, 10).Value
Range("b18") = Range("b18") + 1
'    Dim answer3 As String
'line13:
'answer3 = UCase(InputBox("Enter the pipe type ""HORIZONTAL"" or ""RISER"".", "MAI Fire Fighting Calculations", "HORIZONTAL"))
 

'par3 = 0
'If answer3 = "HORIZONTAL" Or answer3 = "RISER" Then par3 = 1

'If par3 = 0 Then MsgBox ("The pipe type must be either ""HORIZONTAL"" or ""RISER"". Any type else is not accepted."), vbCritical, "MAI Fire Fighting Calculations": GoTo line13:
   
 '   If answer3 = Empty Then
 '   GoTo line10:
 '   Else

LINE6:
ser_no = j - 29

Cells(29 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 29 - ser_no & "]C+R[" & y - 29 - ser_no & "]C"
Selection.Copy
Range(Cells(29 + ser_no, 5), Cells(29 + ser_no, 6)).Select
Selection.PasteSpecial PASTE:=xlFormulas, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
Range(Cells(29 + ser_no, 4), Cells(29 + ser_no, 6)).Select
 Selection.Locked = True
    Selection.FormulaHidden = True

Cells(29 + ser_no, 8).Select

With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

ActiveCell.FormulaR1C1 = "=COMBINED_ADD_TWO_PIPES_hazard(R[" & x - 29 - ser_no & "]C, R[" & y - 29 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 9).Select

With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

ActiveCell.FormulaR1C1 = "=COMBINED_ADD_TWO_PIPES_class(R[" & x - 29 - ser_no & "]C, R[" & y - 29 - ser_no & "]C)"
  Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 10).Select
ActiveCell.FormulaR1C1 = aanswer
    
  
Cells(29 + ser_no, 11).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 29 - ser_no & "]C,R[" & y - 29 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    
    
Cells(29 + ser_no, 13).Select
ActiveCell.FormulaR1C1 = "= max(R[" & x - 29 - ser_no & "]C,R[" & y - 29 - ser_no & "]C)"
 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 14).Select

ActiveCell.FormulaR1C1 = "=COMBINED_ADD_TWO_PIPES_max_distance(R[" & x - 29 - ser_no & "]C[-9],R[" & y - 29 - ser_no & "]C[-9],RC[-5], R[" & x - 29 - ser_no & "]C[-5], R[" & y - 29 - ser_no & "]C[-5],R[" & x - 29 - ser_no & "]C, R[" & y - 29 - ser_no & "]C)"

 Selection.Locked = True
    Selection.FormulaHidden = True
    
Cells(29 + ser_no, 18).Select
ActiveCell.FormulaR1C1 = "=IF(RC[11]=0,0,IF(OR(R[" & x - 29 - ser_no & "]C=""N/A"",R[" & y - 29 - ser_no & "]C=""N/A""),""N/A"", max(R[" & x - 29 - ser_no & "]C,R[" & y - 29 - ser_no & "]C,RC[11])))"
 Selection.Locked = True
    Selection.FormulaHidden = True

End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(29 + ser_no, 2), Cells(29 + ser_no, 19)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Range("d18").Select
  

Application.CutCopyMode = False

ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 7
LINE10:
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: DialogSheets("Dialog_Select_combined_fire_pip").Visible = 0: DialogSheets("Dialog_add_delete_combined_pipe").Visible = 0
 Range("D18").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'DialogSheets("Dialog_add_delete_combined_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub DELETE_combined_pipes()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
      Dim x(1000)
Dim y(1000)
first_row = 30
     mai = Range("b18")
     
Dim counter
counter = 30
Do While counter < mai + 29
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     
 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop


Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no pipe to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Delete the pipe segments from serial no.", "MAI Fire Fighting Calculations"))
 
elie = mai + 29
par = 0
For i = 30 To elie
If Right(Cells(i, 2), 1) <> ")" Then koko = Cells(i, 2).Value
If Right(Cells(i, 2), 1) = ")" Then koko = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2)
If answer = koko Then par = 1: Exit For

Next i

If par = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer = Empty Then
  
    
  GoTo LINE10:
   Else
Dim banswer As String
 banswer = UCase(InputBox("TO serial no.", "MAI Fire Fighting Calculations"))
 

belie = mai + 29
bpar = 0
For V = 30 To belie
If Right(Cells(V, 2), V) <> ")" Then jeny = Cells(V, 2).Value
If Right(Cells(V, 2), 1) = ")" Then jeny = Mid(Cells(V, 2), 1, WorksheetFunction.Find("(", Cells(V, 2)) - 2)
If banswer = jeny Then bpar = 1: Exit For

Next V

If bpar = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
If banswer = Empty Then
  
GoTo LINE10:
        
        Else
        
        
kk = 0
If V >= i Then q = V: R = i
If i > V Then q = i: R = V
For j = 0 To mai + first_row - q - 1
x(j) = 0
y(j) = 0

If Right(Cells(mai - j + first_row, 2), 1) = ")" Then


x(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) - 1)
y(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - 1)
x(j) = Val(x(j))
y(j) = Val(y(j))

Dim SUN(1000)
For p = R To q

If Right(Cells(p, 2), 1) = ")" Then
SUN(p) = Mid(Cells(p, 2), 1, WorksheetFunction.Find("(", Cells(p, 2)) - 2)
If Val(SUN(p)) = x(j) Or Val(SUN(p)) = y(j) Then
kk = 1
GoTo line20:
End If
End If

If Cells(p, 2) = x(j) Or Cells(p, 2) = y(j) Then
kk = 1
Exit For
End If
Next p
If kk = 0 Then GoTo line21:
line20:
Exit For
End If

line21:
 Next j
 
 
    If kk = 1 Then


MsgBox ("The pipe code """) & Cells(mai - j + first_row, 3) & (""" must be modified first before deleting this pipe."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE10:
End If

If MsgBox("Are you sure you want to delete all pipe segments from """ & Cells(i, 3).Value & """ to """ & Cells(V, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(V, 19)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
          Range(Cells(i, 22), Cells(V, 29)).Select
           Cells(i, 22).Activate
           Selection.Delete Shift:=xlUp
            Range("AD30").Select
    ActiveCell.FormulaR1C1 = "=SPR_PIPES_NO_HAZARD_SELECTED(RC[-22],RC[-26],RC[-12])"
   
    Range("AE30").Select
    ActiveCell.FormulaR1C1 = "=FHC_PIPES_NO_CLASS(RC[-26],RC[-13],RC[-22])"
        Range("AF30").Select
       ActiveCell.FormulaR1C1 = "=COMBINED_PIPES_NO_PIPE_TYPE(RC[-28],RC[-27],RC[-14],RC[-22])"
           Call delete_ser_no_adjusting(first_row, mai, Val(i), Val(V))
            
line2:
            Range("b18") = Range("b18") - ((V - i) ^ 2) ^ (1 / 2) - 1
            End If
             End If
            End If
        ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 37
    
    Range("d18").Select
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_SPRINK_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_combined_pipe_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_add_delete_combined_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub RESET_combined_pipes()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If

  ActiveWindow.FreezePanes = False
Range("B18").Select
ActiveCell.FormulaR1C1 = "1"
Range("Y1").Select
ActiveCell.FormulaR1C1 = "1"
Range("AB1").Select
ActiveCell.FormulaR1C1 = "1"
Range("AE4").Select
ActiveCell.FormulaR1C1 = "1"
Range("N23:N25").ClearContents
Range("d18:f18,K18,M18:N18").ClearContents
Range("B30:S1034,V30:AC1034,AD31:AF1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
Selection.Interior.ColorIndex = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

    DialogSheets("Dialog_combined_pipes_DATA").Visible = -1
    Sheets("Dialog_combined_pipes_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
  
        ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("combined system PIPing Sizing").Select
    DialogSheets("Dialog_combined_pipes_DATA").Visible = 0
    Sheets("DIALOG_option_combined_pipes").Visible = 0
Sheets("List reference").Visible = 0
    
       ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("U30").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 65

Range("d18").Select
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.SmallScroll ToRight:=-6
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_combined_PIPES()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  
mai = Range("B18")

 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop

Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop
  
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$29"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&14&D"
        .CenterFooter = ""
        .RightFooter = "&14Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.75)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 61
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("N23:N26,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 15
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("19:29").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B18")
    Range(Rows(30), Rows(250)).RowHeight = 25
    Range(Rows(21), Rows(26)).RowHeight = 18.75
  Range(Rows(27), Rows(28)).RowHeight = 9
                 
Range(Cells(21, 2), Cells(mai + 28, 19)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("19:29").EntireRow.Hidden = True

      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("U30").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 65
        Range("d18").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub


Sub option_combined_pipes()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

mai = Range("B18")
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 Dim counter5
counter5 = 30
Do While counter5 < mai + 29
Cells(counter5, 8).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE103:
End If

            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
LINE103:

            counter5 = counter5 + 1
Loop

 Dim counter6
counter6 = 30
Do While counter6 < mai + 29
Cells(counter6, 9).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then
GoTo LINE104:
End If

            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
LINE104:

            counter6 = counter6 + 1
Loop

ActiveSheet.Protect Password:=qwe & rty & uio

Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop


Dim SHT_network_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 18) = "COMB. NETWORK NO. " Then
SHT_network_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 21) = SHT_network_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$u$3:$u$" & j + 2
Sheets("DIALOG_option_combined_pipes").Visible = -1
Sheets("DIALOG_option_combined_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$u$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("combined system piping Sizing").Select
  
    DialogSheets("DIALOG_option_combined_pipes").Show

  
End Sub

Sub open_network_combined_pipes()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("DIALOG_option_combined_pipes").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No network has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("combined system piping Sizing").Select: Sheets("DIALOG_option_combined_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
  
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("combined system piping Sizing").Select: Sheets("DIALOG_option_combined_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("combined system piping Sizing").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("DIALOG_option_combined_pipes").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("combined system piping Sizing").Visible = 0
    
   
 Sheets("DIALOG_option_combined_pipes").Visible = -1
   Sheets("DIALOG_option_combined_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_combined_pipes").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_network_combined_pipes()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim network_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

network_name = UCase(Range("N25"))
If Len(network_name) > 13 Then MsgBox ("The number of Network Code characters must be less than 14."), vbCritical, "MAI Fire Fighting Calculations": Call combined_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If network_name = "" Then MsgBox ("The Network Code has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call combined_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("COMB. NETWORK NO. " & network_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the network code."), vbCritical, "MAI Fire Fighting Calculations": Call combined_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Network Code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call combined_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("N27").Select
'ActiveCell.FormulaR1C1 = network_name
         
     
  Sheets("combined system piping Sizing").Select
   Sheets("combined system piping Sizing").Copy Before:=Sheets(1)
  'network_name1 = Range("N27")
 '  With ActiveCell.Characters(Start:=1, length:=6).Font
   '     .Name = "Arial"
  '      .FontStyle = "Regular"
  '      .Size = 12
  '      .Strikethrough = False
  '      .Superscript = False
  '      .Subscript = False
   '     .OutlineFont = False
   '     .Shadow = False
    '    .Underline = xlUnderlineStyleNone
    '    .ColorIndex = xlAutomatic
 ' End With
Sheets("combined system piping Sizi (2)").Select
 Sheets("combined system piping Sizi (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("c1") = "Comb. Network NO. " & Range("N25")

 ActiveSheet.Shapes("Button 6").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 7").Select
    Selection.OnAction = "Back_to_combined_pipes"
    Range("A1:t1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
    Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
mai = Range("B18")
Dim counter5
counter5 = 30
Do While counter5 < mai + 29
            prop = UCase(Cells(counter5, 8).Value)
            Cells(counter5, 8).Value = prop
            counter5 = counter5 + 1
Loop

Dim counter6
counter6 = 30
Do While counter6 < mai + 29
            prop = UCase(Cells(counter6, 9).Value)
            Cells(counter6, 9).Value = prop
            counter6 = counter6 + 1
Loop

Dim counter7
counter7 = 30
Do While counter7 < mai + 29
            prop = UCase(Cells(counter7, 10).Value)
            Cells(counter7, 10).Value = prop
            counter7 = counter7 + 1
Loop
      
      
      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("U30").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 65
    Range("d18").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "COMB. NETWORK NO. " & network_name
Sheets("combined system piping Sizing").Select

Call RESET_combined_pipes
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio


Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("combined system piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("DIALOG_option_combined_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_network_combined_pipes()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("DIALOG_option_combined_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No network has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("combined system piping Sizing").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("DIALOG_option_combined_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no network with this code. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("combined system piping Sizing").Select: Sheets("DIALOG_option_combined_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("DIALOG_option_combined_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("combined system piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_combined_pipes").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_combined_pipes_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("combined system piping Sizing").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("DIALOG_option_combined_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub combined_pipe_Type()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Sheets("Dialog_Select_combined_fire_pip").Visible = -1
Sheets("Dialog_Select_combined_fire_pip").Select

    Sheets("combined system piping Sizing").Select
  
    DialogSheets("Dialog_Select_combined_fire_pip").Show
   ActiveWorkbook.Protect Password:=qwe & rty & uio
  
End Sub

Sub Horizontal_combined_pipe_Type()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False
Sheets("combined system piping Sizing").Select
ser_no = Range("b18")
Cells(29 + ser_no, 10).Select
ActiveCell.FormulaR1C1 = "HORIZONTAL"

End Sub
Sub Riser_combined_pipe_Type()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False
Sheets("combined system piping Sizing").Select
ser_no = Range("b18")
Cells(29 + ser_no, 10).Select
ActiveCell.FormulaR1C1 = "RISER"

End Sub
Sub Back_to_combined_pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("combined system piping Sizing").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("combined system piping Sizing").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub combined_pipes_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("al33") = 2 Then
Range("f18") = Range("f18") / 15.85
Range("k18") = Range("k18") / 3.28
Range("n18") = Range("n18") / 3.28
Range("f18").NumberFormat = "0.0;;"
Range("p18").NumberFormat = "0.0;;"
mai = Range("B18")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 29, 6).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 29, 6) = Cells(i + 29, 6) / 15.85
Cells(i + 29, 11) = Cells(i + 29, 11) / 3.28
Cells(i + 29, 14) = Cells(i + 29, 14) / 3.28
line11:
Cells(i + 29, 6).NumberFormat = "0.0;;"
Cells(i + 29, 16).NumberFormat = "0.0;;"
Next i
End If
LINE10:
Range("al33") = 1
Range("d18").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub

Sub combined_pipes_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("al33") = 1 Then
Range("f18") = Range("f18") * 15.85
Range("k18") = Range("k18") * 3.28
Range("n18") = Range("n18") * 3.28
Range("f18").NumberFormat = "0;;"
Range("p18").NumberFormat = "0;;"
mai = Range("B18")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 29, 6).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 29, 6) = Cells(i + 29, 6) * 15.85
Cells(i + 29, 11) = Cells(i + 29, 11) * 3.28
Cells(i + 29, 14) = Cells(i + 29, 14) * 3.28
line11:
Cells(i + 29, 6).NumberFormat = "0;;"
Cells(i + 29, 16).NumberFormat = "0;;"
Next i
End If
LINE10:
Range("al33") = 2
Range("d18").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub



Attribute VB_Name = "Module51"
Sub Macro200()
Attribute Macro200.VB_Description = "Macro recorded 8/15/96 by  "
Attribute Macro200.VB_ProcData.VB_Invoke_Func = "m\n14"
'
' Macro2 Macro
' Macro recorded 8/15/96 by
'
' Keyboard Shortcut: Ctrl+m
Application.ScreenUpdating = False: Call air
    Rows("6:15").Select
    Selection.Copy
    Range("A16").Select
    ActiveSheet.Spinners.Add(173.4, 162, 15, 12).Select
    ActiveSheet.Spinners.Add(173.4, 177, 15, 12).Select
    ActiveSheet.Spinners.Add(173.4, 192, 15, 12).Select
    ActiveSheet.Spinners.Add(173.4, 207, 15, 12).Select
    ActiveSheet.Spinners.Add(173.4, 237, 15, 12).Select
    ActiveSheet.Spinners.Add(173.4, 252, 15, 12).Select
    ActiveSheet.Spinners.Add(226.2, 132, 15, 12).Select
    ActiveSheet.Spinners.Add(274.2, 132, 15, 12).Select
    ActiveSheet.Spinners.Add(322.2, 132, 15, 12).Select
    ActiveSheet.PASTE
End Sub
Sub Macro500()
Attribute Macro500.VB_Description = "Macro recorded 8/15/96 by  "
Attribute Macro500.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro5 Macro
' Macro recorded 8/15/96 by
'

Application.ScreenUpdating = False: Call air
    Rows("6:15").Select
    Selection.Copy
End Sub
Sub Macro600()
Attribute Macro600.VB_Description = "Macro recorded 8/15/96 by  "
Attribute Macro600.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
' Macro recorded 8/15/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.Buttons.Add(49.2, 10.2, 63.6, 18).Select
    ActiveSheet.PASTE
End Sub
Sub Macro7()
Attribute Macro7.VB_Description = "Macro recorded 8/15/96 by  "
Attribute Macro7.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro7 Macro
' Macro recorded 8/15/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.PASTE
End Sub
Sub Macro8()
Attribute Macro8.VB_Description = "Macro recorded 8/15/96 by  "
Attribute Macro8.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro8 Macro
' Macro recorded 8/15/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.PASTE
    Selection.Interior.ColorIndex = 2
    Selection.Font.ColorIndex = 0
End Sub
Sub Macro10()
Attribute Macro10.VB_Description = "Macro recorded 8/15/96 by  "
Attribute Macro10.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro10 Macro
' Macro recorded 8/15/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.PASTE
    Application.CutCopyMode = False
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    Selection.Locked = False
    Selection.FormulaHidden = False
    Selection.Interior.ColorIndex = 2
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:=qwe & rty & uio
    ActiveWindow.SmallScroll Down:=-10
    Range("B6").Select
End Sub
Sub PASTE()
Attribute PASTE.VB_Description = "Macro recorded 8/15/96 by  "
Attribute PASTE.VB_ProcData.VB_Invoke_Func = " \n14"
'
' PASTE Macro
' Macro recorded 8/15/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.PASTE
    Selection.Interior.ColorIndex = 2
    Selection.Font.ColorIndex = 0
    ActiveWindow.SmallScroll Down:=-8
    Range("B6").Select
End Sub
Attribute VB_Name = "Module52"
Sub co2_pipes_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("i23")
OSA2 = Range("i24")
OSA3 = Range("i25")


  DialogSheets("Dialog_co2_pipes_DATA").Visible = -1
 DialogSheets("Dialog_co2_pipes_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3


Sheets(osa).Select
DialogSheets("Dialog_co2_pipes_DATA").Show

End Sub

Sub co2_pipes_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_co2_pipes_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
 
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai3) > 15 Then MsgBox ("The number of Network code characters must be less than 16."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai3 = "" Then MsgBox ("The Network code has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("CO2 PIPING IN " & mai3, i, 1) = "/" Or Mid("CO2 PIPING IN " & mai3, i, 1) = "*" Or Mid("CO2 PIPING IN " & mai3, i, 1) = "\" Or Mid("CO2 PIPING IN " & mai3, i, 1) = "?" Or Mid("CO2 PIPING IN " & mai3, i, 1) = "[" Or Mid("CO2 PIPING IN " & mai3, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Network code"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("CO2 PIPING IN " & mai3) = SHTNAME(i) And osa <> "CO2 PIPING IN " & mai3 Then
MsgBox ("This Network code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "CO2 PIPING IN " & mai3
 Range("c2") = "CO2 PIPING IN " & mai3
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "CO2 PIPING IN " & mai3: Exit For
 
  Next j
  
 Sheets("CO2 PIPING IN " & mai3).Select
LINE10:
  
  DialogSheets("Dialog_co2_pipes_DATA").Visible = 0

  Range("i23").Select
  ActiveCell.FormulaR1C1 = mai1
  Range("i24").Select
  ActiveCell.FormulaR1C1 = mai2
  Range("i25").Select
  ActiveCell.FormulaR1C1 = mai3
 Range("d11").Select
LINE1:
  
 DialogSheets("Dialog_co2_pipes_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
  
 ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub co2_pipes_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_co2_pipes_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_co2_pipe()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
 mai = Range("b11")
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
 ActiveSheet.Protect Password:=qwe & rty & uio


osa = ActiveSheet.Name
  DialogSheets("Dialog_add_delete_co2_pipe").Visible = -1
 DialogSheets("Dialog_add_delete_co2_pipe").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipes_DATA").Show


Sheets(osa).Select
DialogSheets("Dialog_add_delete_co2_pipe").Show

End Sub
Sub ADD_pipe_co2_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
first_row = 29
mai = Range("B11")
Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop


Dim ser_no As String
If mai = 1 Then ser_no = 1: GoTo line2:
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))

If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 7)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 28, 14), Cells(ser_no + 28, 15)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai

  
Range("a11:b11").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer

Range("d11:g11").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("N11:O11").Select
Selection.Copy
Cells(28 + ser_no, 14).Select
ActiveSheet.PASTE

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With

    
Range("B11") = Range("B11") + 1
Range("d11").ClearContents
Range("d11").Select
     
Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 8

End If
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_co2_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub ADD_pipe_feeding_two_existing_co2_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

first_row = 29
 mai = Range("b11")

Dim answer As String
If mai < 3 Then MsgBox ("At least two pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be added.", "MAI Fire Fighting Calculations"))
If answer = Empty Then
GoTo LINE10:
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This pipe code has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop

     Dim answer1 As String


line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
    If answer2 = Empty Then
    GoTo LINE10:
    Else
If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the pipe code location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no + 28 <= x Or ser_no + 28 <= y Then MsgBox ("The line of this pipe must be located below the lines of the two existing pipes which are fed by it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28

If Right(Cells(i, 2), 1) = ")" Then
If ser_no = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2) Then par = 1
End If

If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 7)).Select
 Selection.Insert Shift:=xlDown
 Range(Cells(ser_no + 28, 14), Cells(ser_no + 28, 15)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 9
    Selection.HorizontalAlignment = xlLeft
   Selection.Font.Bold = False

   Call ser_no_adjusting(first_row, mai, Val(ser_no))

If ser_no = mai - 1 Then GoTo line3:
GoTo line3:
line2:
ser_no = mai

  
Range("a11:b11").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer

Range("d11:g11").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone
Range("N11:O11").Select
Selection.Copy
Cells(28 + ser_no, 14).Select
ActiveSheet.PASTE

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"

        
End If
End If
End If
Cells(28 + ser_no, 4).Select
 Selection.Locked = True
    Selection.FormulaHidden = True

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 7)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Range("B11") = Range("B11") + 1
Range("d11").ClearContents
Range("d11").Select

Application.CutCopyMode = False

ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 8
LINE10:

ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_co2_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub modify_pipe_feeding_two_existing_co2_pipes()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
first_row = 29
 mai = Range("b11")

Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop

If mai < 4 Then MsgBox ("At least three pipes must be saved to apply this function."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
     
     
     Dim answer As String
LINE1:
answer = UCase(InputBox("Enter pipe code that required to be modified.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For j = 29 To elie
If answer = Cells(j, 3).Value Then par = 1: Exit For


Next j
If Right(Cells(j, 2), 1) = ")" Then s = Mid(Cells(j, 2), 1, WorksheetFunction.Find("(", Cells(j, 2)) - 2) Else s = Cells(j, 2).Value
If par = 0 Then MsgBox ("This pipe code is not existing."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:

If Cells(j, 2).Value < 3 Then MsgBox ("At least two pipe segments shall be existing above the pipe segment required to be modified."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
   
    If answer = Empty Then GoTo LINE10:
    
    
     Dim answer1 As String
line11:
answer1 = UCase(InputBox("Enter the serial no. of the first existing pipe segment.", "MAI Fire Fighting Calculations"))
 
 
elie = mai + 28
PAR1 = 0
For x = 29 To elie

If Right(Cells(x, 2), 1) = ")" Then

SUN1 = Mid(Cells(x, 2), 1, WorksheetFunction.Find("(", Cells(x, 2)) - 2)
If answer1 = SUN1 Then PAR1 = 1: Exit For
End If
If answer1 = Cells(x, 2).Value Then PAR1 = 1: Exit For

Next x
If PAR1 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line11:
If answer1 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
   
    If answer1 = Empty Then
    GoTo LINE10:
    Else

     Dim answer2 As String
line12:
answer2 = UCase(InputBox("Enter the serial no. of the second existing pipe segment.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
PAR2 = 0
For y = 29 To elie

If Right(Cells(y, 2), 1) = ")" Then

SUN2 = Mid(Cells(y, 2), 1, WorksheetFunction.Find("(", Cells(y, 2)) - 2)
If answer2 = SUN2 Then PAR2 = 1: Exit For
End If

If answer2 = Cells(y, 2).Value Then PAR2 = 1: Exit For

Next y
If PAR2 = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:
If answer2 >= s Then MsgBox ("Any pipe segment must be located above the line of the pipe feeding it."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer2 = Empty Then
    GoTo LINE10:
    Else

If y = x Then MsgBox ("The two pipes which are fed by one pipe must be different pipes."), vbCritical, "MAI Fire Fighting Calculations": GoTo line12:

LINE6:
ser_no = j - 28

Cells(28 + ser_no, 4).Select
ActiveCell.FormulaR1C1 = "=R[" & x - 28 - ser_no & "]C+R[" & y - 28 - ser_no & "]C"
 Selection.Locked = True
    Selection.FormulaHidden = True
        
End If
End If

  
Call ser_no_adding_modifying_two_pipes(first_row, ser_no, x, y)

Range(Cells(28 + ser_no, 2), Cells(28 + ser_no, 7)).Select

 With Selection.Interior
        .ColorIndex = 35
        .Pattern = xlSolid
    End With

Application.CutCopyMode = False
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 8
Range("d11").Select

LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_co2_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub DELETE_co2_pipes()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    Dim x(1000)
Dim y(1000)
first_row = 29
     mai = Range("b11")
     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no pipe to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Delete the pipe segments from serial no.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If Right(Cells(i, 2), 1) <> ")" Then koko = Cells(i, 2).Value
If Right(Cells(i, 2), 1) = ")" Then koko = Mid(Cells(i, 2), 1, WorksheetFunction.Find("(", Cells(i, 2)) - 2)
If answer = koko Then par = 1: Exit For

Next i

If par = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
    If answer = Empty Then
  
    
  GoTo LINE10:
   Else
Dim banswer As String
 banswer = UCase(InputBox("TO serial no.", "MAI Fire Fighting Calculations"))
 

belie = mai + 28
bpar = 0
For V = 29 To belie
If Right(Cells(V, 2), V) <> ")" Then jeny = Cells(V, 2).Value
If Right(Cells(V, 2), 1) = ")" Then jeny = Mid(Cells(V, 2), 1, WorksheetFunction.Find("(", Cells(V, 2)) - 2)
If banswer = jeny Then bpar = 1: Exit For

Next V

If bpar = 0 Then MsgBox ("The serial No. must be a number between 1 and " & mai - 1 & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
    
If banswer = Empty Then
  
GoTo LINE10:
        
        Else
        
        
kk = 0
If V >= i Then q = V: R = i
If i > V Then q = i: R = V
For j = 0 To mai + first_row - q - 1
x(j) = 0
y(j) = 0

If Right(Cells(mai - j + first_row, 2), 1) = ")" Then


x(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("(", Cells(mai - j + first_row, 2)) - 1)
y(j) = Mid(Cells(mai - j + first_row, 2), WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) + 1, WorksheetFunction.Find(")", Cells(mai - j + first_row, 2)) - WorksheetFunction.Find("+", Cells(mai - j + first_row, 2)) - 1)
x(j) = Val(x(j))
y(j) = Val(y(j))

Dim SUN(1000)
For p = R To q

If Right(Cells(p, 2), 1) = ")" Then
SUN(p) = Mid(Cells(p, 2), 1, WorksheetFunction.Find("(", Cells(p, 2)) - 2)
If Val(SUN(p)) = x(j) Or Val(SUN(p)) = y(j) Then
kk = 1
GoTo line20:
End If
End If

If Cells(p, 2) = x(j) Or Cells(p, 2) = y(j) Then
kk = 1
Exit For
End If
Next p
If kk = 0 Then GoTo line21:
line20:
Exit For
End If

line21:
 Next j
 
    If kk = 1 Then


MsgBox ("The pipe code """) & Cells(mai - j + first_row, 3) & (""" must be modified first before deleting this pipe."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE10:
End If

If MsgBox("Are you sure you want to delete all pipe segments from """ & Cells(i, 3).Value & """ to """ & Cells(V, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(V, 7)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
          Range(Cells(i, 14), Cells(V, 15)).Select
           Cells(i, 14).Activate
           Selection.Delete Shift:=xlUp
          Call delete_ser_no_adjusting(first_row, mai, Val(i), Val(V))
            
line2:
            Range("b11") = Range("b11") - ((V - i) ^ 2) ^ (1 / 2) - 1
            End If
            End If
            End If
        ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 38
    
    Range("d11").Select
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("Dialog_add_delete_co2_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub add_delete_co2_pipe_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_add_delete_co2_pipe").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub RESET_co2_pipes()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If

  ActiveWindow.FreezePanes = False
Range("B11").Select
ActiveCell.FormulaR1C1 = "1"
Range("i23:i25").ClearContents
Range("d11").ClearContents
Range("B29:g1034,N29:O1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
Selection.Interior.ColorIndex = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    DialogSheets("Dialog_co2_pipes_DATA").Visible = -1
    Sheets("Dialog_co2_pipes_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
    
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("co2 system PIPing Sizing").Select
    DialogSheets("Dialog_co2_pipes_DATA").Visible = 0
    Sheets("DIALOG_option_co2_pipes").Visible = 0
   Sheets("List reference").Visible = 0
      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("L29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
Range("d11").Select
ActiveSheet.Protect Password:=qwe & rty & uio

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_co2_PIPES()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&10&D"
        .CenterFooter = ""
        .RightFooter = "&10Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 89
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("i23:i27,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

Range("i27").Select
     With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("12:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B11")
    Range(Rows(29), Rows(250)).RowHeight = 20
    Range(Rows(21), Rows(26)).RowHeight = 15
    Rows("27:27").RowHeight = 30
                     
Range(Cells(21, 2), Cells(mai + 27, 10)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
ActiveWindow.SelectedSheets.PrintPreview
'ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("12:28").Select
Selection.EntireRow.Hidden = True

      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("L29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75

        Range("d11").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_co2_pipes()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_Area_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 14) = "CO2 PIPING IN " Then
SHT_Area_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 22) = SHT_Area_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$v$3:$v$" & j + 2
Sheets("DIALOG_option_co2_pipes").Visible = -1
Sheets("DIALOG_option_co2_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$v$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("co2 system piping Sizing").Select
  
    DialogSheets("DIALOG_option_co2_pipes").Show

  
End Sub

Sub open_Area_co2_pipes()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("DIALOG_option_co2_pipes").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No area has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 system piping Sizing").Select: Sheets("DIALOG_option_co2_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 system piping Sizing").Select: Sheets("DIALOG_option_co2_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("co2 system piping Sizing").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("DIALOG_option_co2_pipes").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("co2 system piping Sizing").Visible = 0
    
   
 Sheets("DIALOG_option_co2_pipes").Visible = -1
   Sheets("DIALOG_option_co2_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_co2_pipes").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_Area_co2_pipes()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Dim Area_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

Area_name = UCase(Range("i25"))
If Len(Area_name) > 15 Then MsgBox ("The number of Area Name characters must be less than 16."), vbCritical, "MAI Fire Fighting Calculations": Call co2_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If Area_name = "" Then MsgBox ("The Area Name has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call co2_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("CO2 PIPING IN " & Area_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the network code."), vbCritical, "MAI Fire Fighting Calculations": Call co2_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Area Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call co2_pipes_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = Area_name
         
     
  Sheets("co2 system piping Sizing").Select
   Sheets("co2 system piping Sizing").Copy Before:=Sheets(1)
  'Area_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
   '     .FontStyle = "Regular"
  '      .Size = 12
  '      .Strikethrough = False
  '      .Superscript = False
  '      .Subscript = False
  '      .OutlineFont = False
  '      .Shadow = False
  '      .Underline = xlUnderlineStyleNone
  '      .ColorIndex = xlAutomatic
'  End With
Sheets("co2 system piping Sizing (2)").Select
 Sheets("co2 system piping Sizing (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("c2") = "CO2 Piping in " & Range("i25")

 ActiveSheet.Shapes("Button 8").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 9").Select
    Selection.OnAction = "Back_to_co2_pipes"
    Range("A1:k2").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
    Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("L29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
    Range("d11").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "CO2 PIPING IN " & Area_name
Sheets("co2 system piping Sizing").Select

Call RESET_co2_pipes
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio


Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("co2 system piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("DIALOG_option_co2_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_Area_co2_pipes()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("DIALOG_option_co2_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No area has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 system piping Sizing").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("DIALOG_option_co2_pipes").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  
elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 system piping Sizing").Select: Sheets("DIALOG_option_co2_pipes").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("DIALOG_option_co2_pipes").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("co2 system piping Sizing").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_co2_pipes").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_co2_pipes_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("co2 system piping Sizing").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("DIALOG_option_co2_pipes").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_co2_pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("co2 system piping Sizing").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("co2 system piping Sizing").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub co2_pipes_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u32") = 2 Then
Range("d11") = Range("d11") / 2.2
mai = Range("B11")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 4) = Cells(i + 28, 4) / 2.2
line11:
Next i
End If
LINE10:
Range("u32") = 1
Range("d11").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Sub co2_pipes_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u32") = 1 Then
Range("d11") = Range("d11") * 2.2
mai = Range("B11")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4).Select
If Left(ActiveCell.FormulaR1C1, 1) = "=" Then GoTo line11:
Cells(i + 28, 4) = Cells(i + 28, 4) * 2.2
line11:
Next i
End If
LINE10:
Range("u32") = 2
Range("d11").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub





Attribute VB_Name = "Module53"
Sub sprinkler_distribut_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("I23")


  DialogSheets("Dialog_sprinkler_distribut_DATA").Visible = -1
 DialogSheets("Dialog_sprinkler_distribut_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1

Sheets(osa).Select
DialogSheets("Dialog_sprinkler_distribut_DATA").Show

End Sub

Sub sprinkler_distribut_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_sprinkler_distribut_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  
  
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai1) > 14 Then MsgBox ("The number of Area Group Name characters must be less than 15."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai1 = "" Then MsgBox ("The Area Group Name has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("SPR. DISTRIB. IN " & mai1, i, 1) = "/" Or Mid("SPR. DISTRIB. IN " & mai1, i, 1) = "*" Or Mid("SPR. DISTRIB. IN " & mai1, i, 1) = "\" Or Mid("SPR. DISTRIB. IN " & mai1, i, 1) = "?" Or Mid("SPR. DISTRIB. IN " & mai1, i, 1) = "[" Or Mid("SPR. DISTRIB. IN " & mai1, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Group Name"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("SPR. DISTRIB. IN " & mai1) = SHTNAME(i) And osa <> "SPR. DISTRIB. IN " & mai1 Then
MsgBox ("This Area Group Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "SPR. DISTRIB. IN " & mai1
 Range("b1") = "          SPR. DISTRIB. IN " & mai1
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "SPR. DISTRIB. IN " & mai1: Exit For
 
  Next j
  
 Sheets("SPR. DISTRIB. IN " & mai1).Select
LINE10:
  
  DialogSheets("Dialog_sprinkler_distribut_DATA").Visible = 0

  Range("I23").Select
  ActiveCell.FormulaR1C1 = mai1
  
LINE1:
  
 DialogSheets("Dialog_sprinkler_distribut_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
  
  ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub sprinkler_distribut_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_sprinkler_distribut_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub ADD_Area_sprinkler_distribut()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
mai = Range("B9")
Dim answer As String
LINE1:
answer = UCase(InputBox("Enter area name", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This area name has been previously entered. Make sure that it is not repeated."), vbCritical, "MAI Fire Fighting Calculations"
'GoTo LINE1
End If
counter = counter + 1
Loop


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the area name location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:

If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 11)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 10
   Selection.Font.Bold = False
    Cells(ser_no + 29, 2).Select
  
    ActiveCell.FormulaR1C1 = "=R[-1]C+1"

     If ser_no = mai - 1 Then GoTo line3:
    Cells(ser_no + 29, 2).Select
    Selection.Copy
    Range(Cells(ser_no + 30, 2), Cells(mai + 28, 2)).Select
    ActiveSheet.PASTE
    GoTo line3:
line2:
ser_no = mai

  
Range("a9:b9").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer



Range("d9:k9").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
 
    Range("f9").Select
Selection.Copy
Cells(28 + ser_no, 6).Select
    Selection.PasteSpecial PASTE:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
With Selection.Validation
       .Delete
       .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$V$1:$V$7"
      .IgnoreBlank = True
       .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "MAI Fire Fighting Calculations"
       .InputMessage = ""
        .ErrorMessage = "The hazard classification must be either ""Light"", ""Ordinary"", ""Ordinary (Group-1)"", ""Ordinary (Group-2)"", ""Extra"", ""Extra (Group-1)"" or ""Extra (Group-2)"". Any other classification is not accepted."
       .ShowInput = True
       .ShowError = True
    End With
    
 Selection.Locked = False
    Selection.FormulaHidden = False

Range("B9") = Range("B9") + 1
Range("d9").ClearContents
Range("d9").Select
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 5
Application.CutCopyMode = False
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio

End If
End Sub
Sub DELETE_area_sprinkler_distribut()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
     mai = Range("b9")
     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no area to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter area name that required to be deleted.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If answer = Cells(i, 3).Value Then par = 1: Exit For


Next i
If par = 0 Then MsgBox ("This area name is not existing."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
 
  
    If answer = Empty Then
     ActiveSheet.Protect Password:=qwe & rty & uio
    Else
    If MsgBox("Are you sure you want to delete """ & Cells(i, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(i, 11)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
         
           Cells(i, 2).Select
           If i = mai + 27 Then GoTo line2:
           If i = 29 And Range("b9") = 3 Then
           ActiveCell.FormulaR1C1 = "1"
           GoTo line2:
           End If
           
            If i = 29 And Range("b9") > 3 Then
           ActiveCell.FormulaR1C1 = "1"
            Cells(i + 1, 2).Select
            ActiveCell.FormulaR1C1 = "=R[-1]C+1"
            Selection.Copy
            Range(Cells(i + 1, 2), Cells(mai + 26, 2)).Select
            ActiveSheet.PASTE
           GoTo line2:
           End If
           
           ActiveCell.FormulaR1C1 = "=R[-1]C+1"
           Cells(i, 2).Select
           Selection.Copy
           Range(Cells(i, 2), Cells(mai + 26, 2)).Select
           ActiveSheet.PASTE
line2:
            Range("b9") = Range("b9") - 1
            End If
             End If
           
    
    Range("d9").Select
    ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 34
LINE10:
     ActiveSheet.Protect Password:=qwe & rty & uio

End Sub
Sub RESET_sprinkler_distribut()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If
ActiveWindow.FreezePanes = False
Range("B9").Select
ActiveCell.FormulaR1C1 = "1"
Range("I23").ClearContents
Range("d9").ClearContents
Range("B29:k1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With

    DialogSheets("Dialog_sprinkler_distribut_DATA").Visible = -1
    Sheets("Dialog_sprinkler_distribut_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    
    ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("fire sprinklers distribution").Select
    DialogSheets("Dialog_sprinkler_distribut_DATA").Visible = 0
     Sheets("dialog_optn_sprinkler_distribut").Visible = 0
Sheets("List reference").Visible = 0
    

      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("M29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 72

Range("d9").Select
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.SmallScroll ToRight:=-6
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_sprinkler_distribut()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&14&D"
        .CenterFooter = ""
        .RightFooter = "&14Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 65
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("I23,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 15
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("10:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B9")
    Range(Rows(29), Rows(250)).RowHeight = 25
    Range(Rows(21), Rows(27)).RowHeight = 20
                     
Range(Cells(21, 2), Cells(mai + 27, 11)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("10:28").Select
Selection.EntireRow.Hidden = True

      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("M29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 72
        Range("d9").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub


Sub option_sprinkler_distribut()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_Area_GROUP_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 17) = "SPR. DISTRIB. IN " Then
SHT_Area_GROUP_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 23) = SHT_Area_GROUP_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$W$3:$W$" & j + 2
Sheets("dialog_optn_sprinkler_distribut").Visible = -1
Sheets("dialog_optn_sprinkler_distribut").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$W$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
  
    DialogSheets("dialog_optn_sprinkler_distribut").Show

  
End Sub

Sub open_Area_GROUP_sprinkler_distribut()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("dialog_optn_sprinkler_distribut").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No area group has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FIRE SPRINKLERS DISTRIBUTION").Select: Sheets("dialog_optn_sprinkler_distribut").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area group with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FIRE SPRINKLERS DISTRIBUTION").Select: Sheets("dialog_optn_sprinkler_distribut").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("dialog_optn_sprinkler_distribut").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("FIRE SPRINKLERS DISTRIBUTION").Visible = 0
    
   
 Sheets("dialog_optn_sprinkler_distribut").Visible = -1
   Sheets("dialog_optn_sprinkler_distribut").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_optn_sprinkler_distribut").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub save_Area_GROUP_sprinkler_distribut()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim Area_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

Area_name = UCase(Range("i23"))
If Len(Area_name) > 14 Then MsgBox ("The number of Area Group Name characters must be less than 15."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_distribut_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If Area_name = "" Then MsgBox ("The Area Group Name has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_distribut_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("SPR. DISTRIB. IN " & Area_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Group Name."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_distribut_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Area Group Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call sprinkler_distribut_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = Area_name
         
     
  Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
   Sheets("FIRE SPRINKLERS DISTRIBUTION").Copy Before:=Sheets(1)
  'Area_name1 = Range("j27")
 '  With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
 '       .FontStyle = "Regular"
  '      .Size = 12
  '      .Strikethrough = False
  '      .Superscript = False
   '     .Subscript = False
  '      .OutlineFont = False
  '      .Shadow = False
   '     .Underline = xlUnderlineStyleNone
   '     .ColorIndex = xlAutomatic
' End With
Sheets("FIRE SPRINKLERS DISTRIBUTIO (2)").Select
 Sheets("FIRE SPRINKLERS DISTRIBUTIO (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("B1") = "          Spr. Distrib. in " & Range("i23")

 ActiveSheet.Shapes("Button 5").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 6").Select
    Selection.OnAction = "Back_to_sprinkler_distribut"
    Range("A1:o1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6

      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("M29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 72

    Range("d9").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "SPR. DISTRIB. IN " & Area_name
Sheets("FIRE SPRINKLERS DISTRIBUTION").Select

Call RESET_sprinkler_distribut
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("dialog_optn_sprinkler_distribut").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_Area_GROUP_sprinkler_distribut()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("dialog_optn_sprinkler_distribut").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No area group has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FIRE SPRINKLERS DISTRIBUTION").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("dialog_optn_sprinkler_distribut").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

  
 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area group with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FIRE SPRINKLERS DISTRIBUTION").Select: Sheets("dialog_optn_sprinkler_distribut").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("dialog_optn_sprinkler_distribut").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_optn_sprinkler_distribut").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_sprinkler_distribut_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("dialog_optn_sprinkler_distribut").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_sprinkler_distribut()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("FIRE SPRINKLERS DISTRIBUTION").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("FIRE SPRINKLERS DISTRIBUTION").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub SPRINKLER_DISTRIBUT_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("aA5") = 2 Then
Range("D9") = Range("D9") / 3.28 ^ 2
mai = Range("B9")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4) = Cells(i + 28, 4) / 3.28 ^ 2
Next i
End If
LINE10:
Range("aA5") = 1
Range("d9").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub

Sub SPRINKLER_DISTRIBUT_BRITISH()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("aA5") = 1 Then
Range("D9") = Range("D9") * 3.28 ^ 2
mai = Range("B9")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4) = Cells(i + 28, 4) * 3.28 ^ 2
Next i
End If
LINE10:
Range("aA5") = 2
Range("d9").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Attribute VB_Name = "Module54"
Sub fm_200_nozzles_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("h23")


  DialogSheets("Dialog_fm_200_nozzles_DATA").Visible = -1
 DialogSheets("Dialog_fm_200_nozzles_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1

Sheets(osa).Select
DialogSheets("Dialog_fm_200_nozzles_DATA").Show

End Sub

Sub fm_200_nozzles_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_fm_200_nozzles_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  
  
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai1) > 13 Then MsgBox ("The number of Area Group Name characters must be less than 14."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai1 = "" Then MsgBox ("The Area Group Name has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("FM-200 NOZZLES IN " & mai1, i, 1) = "/" Or Mid("FM-200 NOZZLES IN " & mai1, i, 1) = "*" Or Mid("FM-200 NOZZLES IN " & mai1, i, 1) = "\" Or Mid("FM-200 NOZZLES IN " & mai1, i, 1) = "?" Or Mid("FM-200 NOZZLES IN " & mai1, i, 1) = "[" Or Mid("FM-200 NOZZLES IN " & mai1, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Group Name"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("FM-200 NOZZLES IN " & mai1) = SHTNAME(i) And osa <> "FM-200 NOZZLES IN " & mai1 Then
MsgBox ("This Area Group Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "FM-200 NOZZLES IN " & mai1
 Range("b1") = "         FM-200 NOZZLES IN " & mai1
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "FM-200 NOZZLES IN " & mai1: Exit For
 
  Next j
  
 Sheets("FM-200 NOZZLES IN " & mai1).Select
LINE10:
  
  DialogSheets("Dialog_fm_200_nozzles_DATA").Visible = 0

  Range("h23").Select
  ActiveCell.FormulaR1C1 = mai1
  
LINE1:
  
 DialogSheets("Dialog_fm_200_nozzles_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
  
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub fm_200_nozzles_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_fm_200_nozzles_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub ADD_area_fm_200_nozzles()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
mai = Range("B7")
Dim answer As String
LINE1:
answer = UCase(InputBox("Enter area name", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This area name has been previously entered. Make sure that it is not repeated."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the area name location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 8)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 11
   Selection.Font.Bold = False
    Cells(ser_no + 29, 2).Select
  
    ActiveCell.FormulaR1C1 = "=R[-1]C+1"

     If ser_no = mai - 1 Then GoTo line3:
    Cells(ser_no + 29, 2).Select
    Selection.Copy
    Range(Cells(ser_no + 30, 2), Cells(mai + 28, 2)).Select
    ActiveSheet.PASTE
    GoTo line3:
line2:
ser_no = mai

  
Range("a7:b7").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("d7:h7").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
 

    
Range("B7") = Range("B7") + 1
Range("d7").ClearContents
Range("d7").Select
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 10
     
Application.CutCopyMode = False
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio

End If
End Sub
Sub DELETE_area_fm_200_nozzles()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
     mai = Range("b7")
     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no area to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter area name that required to be deleted.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If answer = Cells(i, 3).Value Then par = 1: Exit For


Next i
If par = 0 Then MsgBox ("This area name is not existing."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
 
  
    If answer = Empty Then
     ActiveSheet.Protect Password:=qwe & rty & uio
    Else
    If MsgBox("Are you sure you want to delete """ & Cells(i, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(i, 8)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
         
           Cells(i, 2).Select
           If i = mai + 27 Then GoTo line2:
           If i = 29 And Range("b7") = 3 Then
           ActiveCell.FormulaR1C1 = "1"
           GoTo line2:
           End If
           
            If i = 29 And Range("b7") > 3 Then
           ActiveCell.FormulaR1C1 = "1"
            Cells(i + 1, 2).Select
            ActiveCell.FormulaR1C1 = "=R[-1]C+1"
            Selection.Copy
            Range(Cells(i + 1, 2), Cells(mai + 26, 2)).Select
            ActiveSheet.PASTE
           GoTo line2:
           End If
           
           ActiveCell.FormulaR1C1 = "=R[-1]C+1"
           Cells(i, 2).Select
           Selection.Copy
           Range(Cells(i, 2), Cells(mai + 26, 2)).Select
           ActiveSheet.PASTE
line2:
            Range("b7") = Range("b7") - 1
            End If
             End If
                      
   
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 39
    Range("d7").Select
LINE10:
     ActiveSheet.Protect Password:=qwe & rty & uio

End Sub
Sub RESET_fm_200_nozzles()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If
 ActiveWindow.FreezePanes = False
Range("B7").Select
ActiveCell.FormulaR1C1 = "1"
Range("h23").ClearContents
Range("d7").ClearContents
Range("B29:h1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    DialogSheets("Dialog_fm_200_nozzles_DATA").Visible = -1
    Sheets("Dialog_fm_200_nozzles_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
       ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("fm-200 nozzles distribution").Select
    DialogSheets("Dialog_fm_200_nozzles_DATA").Visible = 0
    Sheets("dialog_option_fm_200_nozzles").Visible = 0
Sheets("List reference").Visible = 0
    
     ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.SmallScroll ToRight:=-6
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_FM_200_nozzles()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&10&D"
        .CenterFooter = ""
        .RightFooter = "&10Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 81
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("h23,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 11.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("8:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B7")
    Range(Rows(29), Rows(250)).RowHeight = 20
    Range(Rows(21), Rows(27)).RowHeight = 15
                     
Range(Cells(21, 2), Cells(mai + 27, 8)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("8:28").Select
Selection.EntireRow.Hidden = True


      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75

        Range("d7").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_fm_200_nozzles()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_Area_GROUP_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 18) = "FM-200 NOZZLES IN " Then
SHT_Area_GROUP_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 24) = SHT_Area_GROUP_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$x$3:$x$" & j + 2
Sheets("dialog_option_fm_200_nozzles").Visible = -1
Sheets("dialog_option_fm_200_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$x$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("FM-200 NOZZLES DISTRIBUTION").Select
  
    DialogSheets("dialog_option_fm_200_nozzles").Show

  
End Sub

Sub open_Area_GROUP_fm_200_nozzles()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("dialog_option_fm_200_nozzles").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No area group has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 NOZZLES DISTRIBUTION").Select: Sheets("dialog_option_fm_200_nozzles").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area group with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 NOZZLES DISTRIBUTION").Select: Sheets("dialog_option_fm_200_nozzles").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("FM-200 NOZZLES DISTRIBUTION").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("dialog_option_fm_200_nozzles").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("FM-200 NOZZLES DISTRIBUTION").Visible = 0
    
   
 Sheets("dialog_option_fm_200_nozzles").Visible = -1
   Sheets("dialog_option_fm_200_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_option_fm_200_nozzles").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_Area_GROUP_fm_200_nozzles()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Dim Area_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

Area_name = UCase(Range("h23"))
If Len(Area_name) > 13 Then MsgBox ("The number of Area Group Name characters must be less than 14."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If Area_name = "" Then MsgBox ("The Area Group Name has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("FM-200 NOZZLES IN " & Area_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Group Name."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Area Group Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = Area_name
         
     
  Sheets("FM-200 NOZZLES DISTRIBUTION").Select
   Sheets("FM-200 NOZZLES DISTRIBUTION").Copy Before:=Sheets(1)
  'Area_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
  '      .FontStyle = "Regular"
   '     .Size = 12
  '      .Strikethrough = False
 '       .Superscript = False
  '      .Subscript = False
  '      .OutlineFont = False
  '      .Shadow = False
  '      .Underline = xlUnderlineStyleNone
  '      .ColorIndex = xlAutomatic
 ' End With
Sheets("FM-200 NOZZLES DISTRIBUTION (2)").Select
 Sheets("FM-200 NOZZLES DISTRIBUTION (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("B1") = "         FM-200 Nozzles Distribution in " & Range("h23")

 ActiveSheet.Shapes("Button 4").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 5").Select
    Selection.OnAction = "Back_to_fm_200_nozzles"
    Range("A1:n1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
    Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
     ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
    Range("d7").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "FM-200 NOZZLES IN " & Area_name
Sheets("FM-200 NOZZLES DISTRIBUTION").Select

Call RESET_fm_200_nozzles
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("FM-200 NOZZLES DISTRIBUTION").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("dialog_option_fm_200_nozzles").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_Area_GROUP_fm_200_nozzles()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("dialog_option_fm_200_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No area group has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 NOZZLES DISTRIBUTION").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("dialog_option_fm_200_nozzles").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area group with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 NOZZLES DISTRIBUTION").Select: Sheets("dialog_option_fm_200_nozzles").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("dialog_option_fm_200_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("FM-200 NOZZLES DISTRIBUTION").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_option_fm_200_nozzles").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_fm_200_nozzles_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("FM-200 NOZZLES DISTRIBUTION").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("dialog_option_fm_200_nozzles").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_fm_200_nozzles()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("FM-200 NOZZLES DISTRIBUTION").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("FM-200 NOZZLES DISTRIBUTION").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub FM_200_NOZZLES_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u31") = 2 Then
Range("d7") = Range("d7") / 2.2
mai = Range("B7")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4) = Cells(i + 28, 4) / 2.2
Next i
End If
LINE10:
Range("u31") = 1
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Sub FM_200_NOZZLES_BRITISH()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u31") = 1 Then
Range("d7") = Range("d7") * 2.2
mai = Range("B7")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4) = Cells(i + 28, 4) * 2.2
Next i
End If
LINE10:
Range("u31") = 2
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Attribute VB_Name = "Module55"
Sub fm_200_storage_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("j23")
OSA2 = Range("j24")
OSA3 = Range("j25")


  DialogSheets("Dialog_fm_200_storage_DATA").Visible = -1
 DialogSheets("Dialog_fm_200_storage_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3

Sheets(osa).Select
DialogSheets("Dialog_fm_200_storage_DATA").Show

End Sub

Sub fm_200_storage_data_OK()
: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name

  Sheets("Dialog_fm_200_storage_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
    
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai3) > 18 Then MsgBox ("The number of Area Name characters must be less than 19."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai3 = "" Then MsgBox ("The Area Name has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("FM-200_SC IN " & mai3, i, 1) = "/" Or Mid("FM-200_SC IN " & mai3, i, 1) = "*" Or Mid("FM-200_SC IN " & mai3, i, 1) = "\" Or Mid("FM-200_SC IN " & mai3, i, 1) = "?" Or Mid("FM-200_SC IN " & mai3, i, 1) = "[" Or Mid("FM-200_SC IN " & mai3, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Name"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("FM-200_SC IN " & mai3) = SHTNAME(i) And osa <> "FM-200_SC IN " & mai3 Then
MsgBox ("This Area Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "FM-200_SC IN " & mai3
 Range("b1") = "         FM-200_SC IN " & mai3
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "FM-200_SC IN " & mai3: Exit For
 
  Next j
  
 Sheets("FM-200_SC IN " & mai3).Select
LINE10:
  
  DialogSheets("Dialog_fm_200_storage_DATA").Visible = 0

  Range("j23").Select
  ActiveCell.FormulaR1C1 = mai1
   Range("j24").Select
  ActiveCell.FormulaR1C1 = mai2
   Range("j25").Select
  ActiveCell.FormulaR1C1 = mai3
  Range("b29").Select
  
LINE1:
  
DialogSheets("Dialog_fm_200_storage_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
      
   ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub fm_200_storage_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets(osa).Select
DialogSheets("Dialog_fm_200_storage_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub



Sub PRINT_FM_200_Storage()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.PageSetup.PrintArea = "$B$21:$L$29"
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&8&D"
        .CenterFooter = ""
        .RightFooter = "&8Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.75)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 100
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("j23:j25,k26,l27,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
        With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 9.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("l27").Select
     With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
 
    
    Range("B29:h29,i28:l29").Select
    Range("i28").Activate
    Selection.Interior.ColorIndex = xlNone
    
 Rows("10:27").Select
 Selection.EntireRow.Hidden = False
 Range(Rows(21), Rows(26)).RowHeight = 12.75
  Rows("27:27").RowHeight = 23.5
 ' ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
 ActiveSheet.PageSetup.PrintArea = ""
Rows("10:27").Select
Selection.EntireRow.Hidden = True

Range("B29:c29").Select
    Range("B29").Activate
    With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
    End With
    Range("d29:h29").Select
    Range("d29").Activate
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    Range("i28:l29").Select
    Range("i28").Activate
    With Selection.Interior
        .ColorIndex = 50
        .Pattern = xlSolid
    End With
     ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N40").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
        Range("b29").Select
           ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_fm_200_storage()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_Enclosure_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 13) = "FM-200_SC IN " Then
SHT_Enclosure_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 25) = SHT_Enclosure_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$Y$3:$Y$" & j + 2
Sheets("dialog_option_fm_200_storage").Visible = -1
Sheets("dialog_option_fm_200_storage").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$Y$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
  
    DialogSheets("dialog_option_fm_200_storage").Show

  
End Sub

Sub open_Enclosure_fm_200_storage()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("dialog_option_fm_200_storage").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No enclosure has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select: Sheets("dialog_option_fm_200_storage").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select: Sheets("dialog_option_fm_200_storage").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("dialog_option_fm_200_storage").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("FM-200 SYSTEM STORAGE CAPACITY").Visible = 0
    
   
 Sheets("dialog_option_fm_200_storage").Visible = -1
   Sheets("dialog_option_fm_200_storage").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_option_fm_200_storage").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_Enclosure_fm_200_storage()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim eNCLOSURE_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

eNCLOSURE_name = UCase(Range("J25"))
If Len(eNCLOSURE_name) > 18 Then MsgBox ("The number of Area Name characters must be less than 19."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_storage_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If eNCLOSURE_name = "" Then MsgBox ("The Area Name has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_storage_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("FM-200_SC IN " & eNCLOSURE_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Name."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_storage_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Area Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call fm_200_storage_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = eNCLOSURE_name
         
     
  Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
   Sheets("FM-200 SYSTEM STORAGE CAPACITY").Copy Before:=Sheets(1)
  'eNCLOSURE_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
   '     .FontStyle = "Regular"
  '      .Size = 12
  '      .Strikethrough = False
  '      .Superscript = False
   '     .Subscript = False
   '     .OutlineFont = False
   '     .Shadow = False
   '     .Underline = xlUnderlineStyleNone
  '      .ColorIndex = xlAutomatic
'  End With
Sheets("FM-200 SYSTEM STORAGE CAPAC (2)").Select
 Sheets("FM-200 SYSTEM STORAGE CAPAC (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("B1") = "         FM-200 System Storage Capacity in " & Range("J25")

 ActiveSheet.Shapes("Button 5").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 6").Select
    Selection.OnAction = "Back_to_fm_200_storage"
    Range("A1:M1").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
 Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
   ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 65
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N40").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
    Range("B29").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "FM-200_SC IN " & eNCLOSURE_name
Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select

ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("J23:J25").ClearContents
Range("B29").ClearContents


    DialogSheets("Dialog_fm_200_storage_DATA").Visible = -1
    Sheets("Dialog_fm_200_storage_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
    
       ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
    DialogSheets("Dialog_fm_200_storage_DATA").Visible = 0
    Sheets("dialog_option_fm_200_storage").Visible = 0
Sheets("List reference").Visible = 0
    
 '   Range("AQ31:AS1377").Select
 '   Selection.Borders(xlDiagonalDown).LineStyle = xlNone
  '  Selection.Borders(xlDiagonalUp).LineStyle = xlNone
  '  Selection.Borders(xlEdgeLeft).LineStyle = xlNone
  '  With Selection.Borders(xlEdgeTop)
  '      .LineStyle = xlContinuous
  '      .Weight = xlMedium
  '      .ColorIndex = xlAutomatic
  '  End With
  '  Selection.Borders(xlEdgeBottom).LineStyle = xlNone
  '  Selection.Borders(xlEdgeRight).LineStyle = xlNone
   ' Selection.Borders(xlInsideVertical).LineStyle = xlNone
  '  Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
  '  ActiveWindow.ScrollColumn = 1
  '  ActiveWindow.ScrollRow = 2
   ActiveWindow.Zoom = 75
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
     
Range("B29").Select
ActiveSheet.Protect Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("dialog_option_fm_200_storage").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_Enclosure_fm_200_storage()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("dialog_option_fm_200_storage").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No enclosure has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("dialog_option_fm_200_storage").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select: Sheets("dialog_option_fm_200_storage").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("dialog_option_fm_200_storage").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_option_fm_200_storage").Visible = 0
   Sheets("List reference").Visible = 0
   
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_fm_200_storage_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("dialog_option_fm_200_storage").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_fm_200_storage()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("FM-200 SYSTEM STORAGE CAPACITY").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("FM-200 SYSTEM STORAGE CAPACITY").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub FM_200_storage_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("t4") = 2 Then
Range("b29") = Range("b29") / 3.28 ^ 3
End If
Range("t4") = 1
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub

Sub FM_200_storage_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("t4") = 1 Then
Range("b29") = Range("b29") * 3.28 ^ 3
End If
Range("t4") = 2
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub

Attribute VB_Name = "Module56"
Attribute VB_Name = "Module57"
Attribute VB_Name = "Module58"
Sub References_open()
Attribute References_open.VB_Description = "Macro recorded 08-08-1996 by Mai"
Attribute References_open.VB_ProcData.VB_Invoke_Func = " \n14"
'
' References_open Macro
' Macro recorded 08-08-1996 by Mai
'
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
References.Visible = -1
References.Select
M_T1.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
'
End Sub
Sub references_back()

Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 80
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("f4").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
 M_T1.Visible = -1
M_T1.Select
References.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub


Sub PRINT_References()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveWindow.FreezePanes = False
  ActiveSheet.PageSetup.PrintArea = "$B$1:$c$15"
    With ActiveSheet.PageSetup
        .PrintTitleRows = ""
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = "&""Arial,Bold Italic""&9MAI&""Arial,Regular"" FIRE FIGHTING CALCULATIONS"
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&9&D"
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.3)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = True
        .Zoom = 110
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
    

              
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
ActiveSheet.PageSetup.PrintArea = ""
     ActiveWindow.Zoom = 80
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("F4").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 100
    ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub


Attribute VB_Name = "Module6"
Attribute VB_Name = "Module60"
Sub mmmm()
Attribute mmmm.VB_Description = "Macro recorded 26-07-1996 by Mai"
Attribute mmmm.VB_ProcData.VB_Invoke_Func = " \n14"
'
' mmmm Macro
' Macro recorded 26-07-1996 by Mai
'

'
    Selection.Locked = False
    Selection.FormulaHidden = False
End Sub
Sub mmmmm()
Attribute mmmmm.VB_Description = "Macro recorded 26-07-1996 by Mai"
Attribute mmmmm.VB_ProcData.VB_Invoke_Func = " \n14"
'
' mmmmm Macro
' Macro recorded 26-07-1996 by Mai
'

'
    Range("E31").Select
    Selection.ClearComments
End Sub
Attribute VB_Name = "Module61"
Sub BRESET()
Attribute BRESET.VB_Description = "Macro recorded 8/18/96 by  "
Attribute BRESET.VB_ProcData.VB_Invoke_Func = " \n14"
'
' BRESET Macro
' Macro recorded 8/18/96 by
'

Application.ScreenUpdating = False: Call air
    Range("C3").Select
    ActiveCell.FormulaR1C1 = "55"
    Range("C4").Select
    ActiveCell.FormulaR1C1 = "11"
    Range("D9:D28").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=13
    Range("C28").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=8
    Range("C36:E36").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-21
End Sub
Sub FPASTE()
Attribute FPASTE.VB_Description = "Macro recorded 8/18/96 by  "
Attribute FPASTE.VB_ProcData.VB_Invoke_Func = " \n14"
'
' FPASTE Macro
' Macro recorded 8/18/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.PASTE
    Application.CutCopyMode = False
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    Selection.Interior.ColorIndex = 2
    ActiveWindow.SmallScroll Down:=-5
    Range("B6").Select
    ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Sub FRESET()
Attribute FRESET.VB_Description = "Macro recorded 8/18/96 by  "
Attribute FRESET.VB_ProcData.VB_Invoke_Func = " \n14"
'
' FRESET Macro
' Macro recorded 8/18/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveWindow.SmallScroll Down:=10
    Rows("22:1000").Select
    Selection.Delete Shift:=xlUp
    Selection.Locked = False
    Selection.FormulaHidden = False
    ActiveSheet.PageSetup.PrintArea = "$A$18:$Q$1000"
    ActiveWindow.SmallScroll Down:=-13
    Range("B6").Select
    ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Sub TEST()
Attribute TEST.VB_Description = "Macro recorded 8/18/96 by  "
Attribute TEST.VB_ProcData.VB_Invoke_Func = " \n14"
'
' TEST Macro
' Macro recorded 8/18/96 by
'

Application.ScreenUpdating = False: Call air
    ActiveWindow.SmallScroll Down:=11
    Range("A18:Q1094").Select
    ActiveSheet.PageSetup.PrintArea = "$A$18:$Q$1094"
End Sub
Attribute VB_Name = "Module62"
Sub Back_to_booster_pump_set()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("booster pump set").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("booster pump set").Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub Back_to_Fire Fighting()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Fire Fighting.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Fire Fighting.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire Fighting_Equipment()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_EQ.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_EQ.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire Fighting_Pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_PS.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_PS.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Drainage_Pits()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_DRNG_PT.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_DRNG_PT.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire_fighting_Equipment()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_EQ.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_EQ.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire_fighting_pipes()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_PS.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_PS.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire_fighting_outlets()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_OUTLETS.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_OUTLETS.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire_fighting_STORAGE_CAPACITIES()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_SC.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_SC.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire_fighting_cO2_TOTAL_FLOODING_SYSTEMS()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_CO2_TFS.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_CO2_TFS.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_Fire_fighting_cO2_LOCAL_APPLICATION_SYSTEMS()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_CO2_LAS.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
MSH_F_CO2_LAS.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub Back_to_HVAC()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
HVAC.Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
HVAC.Select

'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Attribute VB_Name = "Module63"
Attribute VB_Name = "Module64"
Sub Macro18()
Attribute Macro18.VB_Description = "Macro recorded 7/27/1995 by Mai"
Attribute Macro18.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro18 Macro
' Macro recorded 7/27/1995 by Mai
'

'
    Selection.Locked = False
    Selection.FormulaHidden = False
End Sub
Attribute VB_Name = "Module65"
Attribute VB_Name = "Module66"
Attribute VB_Name = "Module67"
Attribute VB_Name = "Module68"
Attribute VB_Name = "Module69"

   


Sub CHANGE_ALL_SHEETS()
'
' MMM Macro
' Macro recorded 7/30/1995 by Mai
'
Application.ScreenUpdating = False: Call air

ActiveWorkbook.UNPROTECT


  Sheets("List reference").Visible = -1
 Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  mai = Application.WorksheetFunction.CountA(Columns(131)) - 1

For i = 1 To mai
MAJ = Cells(i + 1, 131)
Sheets(MAJ).Visible = -1
Sheets(MAJ).Select
'DEDE = Selection.Name
Cells.Select
    ActiveSheet.UNPROTECT
    Selection.FormulaHidden = True
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
'Range(DEDE).Select
Sheets(MAJ).Visible = 0
Next i

  Sheets("MECHANICAL").Select
  Sheets("list Reference").Visible = 0

ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Attribute VB_Name = "Module7"
Sub FPRESET()
Attribute FPRESET.VB_Description = "Macro recorded 2/15/01 by MAI"
Attribute FPRESET.VB_ProcData.VB_Invoke_Func = " \n14"
'
' FPRESET Macro
' Macro recorded 2/15/01 by MAI
'

Application.ScreenUpdating = False: Call air
    Range("N7:P10").Select
    Selection.ClearContents
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 7
    Range("N11").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("C20:W20").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 7
End Sub
Attribute VB_Name = "Module70"
Sub PIPULATOR_STANDARD()
'
' PIPULATOR_STANDARD Macro
' Macro recorded 7/31/1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

If Range("AR2") = 1 Then
Range("D11").NumberFormat = "0.00;;"
Range("F11").NumberFormat = "0.0;;"
Range("H11").NumberFormat = "0;;"
Range("J11").NumberFormat = "# ?/?;;"
End If

If Range("AR2") = 2 Then
Range("D11").NumberFormat = "0.0;;"
Range("F11").NumberFormat = "0.0;;"
Range("H11").NumberFormat = "0.0;;"
Range("J11").NumberFormat = "# ?/?;;"
End If

 Range("F10:G10").Select
  ActiveCell.FormulaR1C1 = "Velocity"
   Selection.Font.Bold = False
   
    Range("F11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[3]=""N/A"",""N/A"",IF(RC[-2]=0,"""",R[8]C[42]))"
       With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
    Selection.Locked = True
    Selection.Font.Bold = False
    
     Range("G11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[37]=1,""m/s"",IF(R[-9]C[37]=2,""Ft/s"")))"
       With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
     Selection.Font.Bold = False
      
     
Range("H10:I10").Select
  ActiveCell.FormulaR1C1 = "Friction Losses"
   Selection.Font.Bold = False
   Selection.Font.Size = 12
   
    Range("H11").Select
     ActiveCell.FormulaR1C1 = "=IF(RC[-4]=0,"""",IF(AND(RC[-4]>0,R[1]C[40]=0),""N/A"",R[17]C[40]))"
     Selection.Font.Bold = False
     Selection.Font.Size = 12
    
     Range("I11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[35]=1,""Pa/m"",IF(R[-9]C[35]=2,""Psi/100Ft"")))"
  Selection.Font.Bold = False
     Selection.Font.Size = 12
     
Range("J10:K10").Select
  ActiveCell.FormulaR1C1 = "Pipe Diameter"
     
    Range("J11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-6]=0,"""",IF(R[25]C[34]=0,""N/A"",R[25]C[34]))"
 
    
     Range("k11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[33]=1,""Inch"",IF(R[-9]C[33]=2,""Inch"")))"

Range("j13:k14").Select
    Selection.Copy
    ActiveWindow.SmallScroll Down:=-36
    Range("F13:G13").Select
    ActiveSheet.PASTE

Range("D11").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Sub PIPULATOR_equal_frication()
'
' PIPULATOR_STANDARD Macro
' Macro recorded 7/31/1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

If Range("AR2") = 1 Then
Range("D11").NumberFormat = "0.00;;"
Range("F11").NumberFormat = "0;;"
Range("H11").NumberFormat = "0.0;;"
Range("J11").NumberFormat = "# ?/?;;"
End If

If Range("AR2") = 2 Then
Range("D11").NumberFormat = "0.0;;"
Range("F11").NumberFormat = "0.0;;"
Range("H11").NumberFormat = "0.0;;"
Range("J11").NumberFormat = "# ?/?;;"
End If



Range("F10:G10").Select
  ActiveCell.FormulaR1C1 = "Design Friction Losses"
   Selection.Font.Bold = True

    Range("F11").Select
    Selection.ClearContents
    With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
    Selection.Locked = False
    Selection.Font.Bold = True
  
    Range("G11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[37]=1,""Pa/m"",IF(R[-9]C[37]=2,""Psi/100Ft"")))"
       With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
     Selection.Font.Bold = True
     
Range("H10:I10").Select
  ActiveCell.FormulaR1C1 = "Velocity"
   Selection.Font.Bold = False
   Selection.Font.Size = 12
   
    Range("H11").Select
      ActiveCell.FormulaR1C1 = "=IF(RC[-4]=0,"""",IF(AND(RC[-4]>0,RC[-2]=0),"""",IF(AND(RC[-4]>0,R[1]C[43]=0),""N/A"",R[8]C[43])))"
     Selection.Font.Bold = False
     Selection.Font.Size = 12
    
     Range("I11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[35]=1,""m/s"",IF(R[-9]C[35]=2,""Ft/s"")))"
  Selection.Font.Bold = False
     Selection.Font.Size = 12
  
Range("J10:K10").Select
  ActiveCell.FormulaR1C1 = "Pipe Diameter"
     
    Range("J11").Select
 ActiveCell.FormulaR1C1 = "=IF(RC[-6]=0,"""",IF(AND(RC[-6]>0,RC[-4]=0),"""",IF(R[28]C[34]=0,""N/A"",R[28]C[34])))"
 
    
     Range("k11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[33]=1,""Inch"",IF(R[-9]C[33]=2,""Inch"")))"

Range("F55:G56").Select
    Selection.Copy
    ActiveWindow.SmallScroll Down:=-36
    Range("F13:G13").Select
    ActiveSheet.PASTE

Range("D11").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Sub PIPULATOR_equal_velocity()
'
' PIPULATOR_STANDARD Macro
' Macro recorded 7/31/1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
If Range("AR2") = 1 Then
Range("D11").NumberFormat = "0.00;;"
Range("F11").NumberFormat = "0.0;;"
Range("H11").NumberFormat = "0;;"
Range("J11").NumberFormat = "# ?/?;;"
End If

If Range("AR2") = 2 Then
Range("D11").NumberFormat = "0.0;;"
Range("F11").NumberFormat = "0.0;;"
Range("H11").NumberFormat = "0.0;;"
Range("J11").NumberFormat = "# ?/?;;"
End If
    
    Range("F10:G10").Select
  ActiveCell.FormulaR1C1 = "Design Velocity"
   Selection.Font.Bold = True
   
    Range("F11").Select
    Selection.ClearContents
       With Selection.Interior
       .ColorIndex = 48
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
    Selection.Locked = False
    Selection.Font.Bold = True
   
    Range("G11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[37]=1,""m/s"",IF(R[-9]C[37]=2,""Ft/s"")))"
       With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
     Selection.Font.Bold = True
  
Range("H10:I10").Select
  ActiveCell.FormulaR1C1 = "Friction Losses"
   Selection.Font.Bold = False
   Selection.Font.Size = 12
   
    Range("H11").Select
  ActiveCell.FormulaR1C1 = "=IF(RC[-4]=0,"""",IF(AND(RC[-4]>0,RC[-2]=0),"""",IF(AND(RC[-4]>0,R[1]C[46]=0),""N/A"",R[17]C[46])))"
     Selection.Font.Bold = False
     Selection.Font.Size = 12
    
     Range("I11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[35]=1,""Pa/m"",IF(R[-9]C[35]=2,""Psi/100Ft"")))"
  Selection.Font.Bold = False
     Selection.Font.Size = 12
     
Range("J10:K10").Select
  ActiveCell.FormulaR1C1 = "Pipe Diameter"
     
    Range("J11").Select
ActiveCell.FormulaR1C1 = "=IF(RC[-6]=0,"""",IF(AND(RC[-6]>0,RC[-4]=0),"""",IF(R[31]C[34]=0,""N/A"",R[31]C[34])))"
  Selection.NumberFormat = "# ?/?;;"
    
     Range("k11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[33]=1,""Inch"",IF(R[-9]C[33]=2,""Inch"")))"

Range("F59:G60").Select
    Selection.Copy
    ActiveWindow.SmallScroll Down:=-36
    Range("F13:G13").Select
    ActiveSheet.PASTE

Range("D11").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Sub PIPULATOR_dynamic_data()
'
' PIPULATOR_STANDARD Macro
' Macro recorded 7/31/1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio

If Range("AR2") = 1 Then
Range("D11").NumberFormat = "0.00;;"
Range("F11").NumberFormat = "# ?/?;;"
Range("H11").NumberFormat = "0.0;;"
Range("J11").NumberFormat = "0;;"
End If

If Range("AR2") = 2 Then
Range("D11").NumberFormat = "0.0;;"
Range("F11").NumberFormat = "# ?/?;;"
Range("H11").NumberFormat = "0.0;;"
Range("J11").NumberFormat = "0.0;;"
End If

 Range("F10:G10").Select
  ActiveCell.FormulaR1C1 = "Pipe Diameter"
   Selection.Font.Bold = True

    Range("F11").Select
    Selection.ClearContents
       With Selection.Interior
         .ColorIndex = 48
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
    Selection.Locked = False
    Selection.Font.Bold = True
  
    Range("G11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[37]=1,""Inch"",IF(R[-9]C[37]=2,""Inch"")))"
       With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
    End With
     Selection.Font.Bold = True
     
Range("H10:I10").Select
  ActiveCell.FormulaR1C1 = "Velocity"
   Selection.Font.Bold = True
   Selection.Font.Size = 14
   
    Range("H11").Select
  ActiveCell.FormulaR1C1 = "=IF(RC[-4]=0,"""",IF(AND(RC[-4]>0,RC[-2]=0),"""",IF(AND(RC[-4]>0,R[1]C[49]=0),""N/A"",R[8]C[49])))"
    Selection.Font.Bold = True
   Selection.Font.Size = 14
    
     Range("I11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[35]=1,""m/s"",IF(R[-9]C[35]=2,""Ft/s"")))"
  Selection.Font.Bold = True
   Selection.Font.Size = 14
   
Range("J10:K10").Select
  ActiveCell.FormulaR1C1 = "Friction Losses"
     
    Range("J11").Select
 ActiveCell.FormulaR1C1 = "=IF(RC[-6]=0,"""",IF(AND(RC[-6]>0,RC[-4]=0),"""",IF(AND(RC[-6]>0,R[1]C[47]=0),""N/A"",R[17]C[47])))"
     Selection.NumberFormat = "0.00;;"
    
     Range("k11").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=""N/A"","""",IF(R[-9]C[33]=1,""Pa/m"",IF(R[-9]C[33]=2,""Psi/100Ft"")))"

Range("j13:k14").Select
    Selection.Copy
    ActiveWindow.SmallScroll Down:=-36
    Range("F13:G13").Select
    ActiveSheet.PASTE

Range("D11").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Attribute VB_Name = "Module71"
Sub etreset()
Attribute etreset.VB_Description = "Macro recorded 8/22/96 by  "
Attribute etreset.VB_ProcData.VB_Invoke_Func = " \n14"
'
' etreset Macro
' Macro recorded 8/22/96 by
'

Application.ScreenUpdating = False: Call air
    Range("G4").Select
    Selection.ClearContents
    Range("G7:G9").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=16
    Range("C18:C31").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-16
    Range("G4").Select
End Sub
Attribute VB_Name = "Module72"
Sub CO2_SC_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("J23")
OSA2 = Range("J24")
OSA3 = Range("J25")

  DialogSheets("Dialog_CO2_SC_DATA").Visible = -1
 DialogSheets("Dialog_CO2_SC_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = OSA2
ActiveSheet.Shapes("Edit Box 6").Select
Selection.Characters.Text = OSA3

Sheets(osa).Select
DialogSheets("Dialog_CO2_SC_DATA").Show

End Sub

Sub CO2_SC_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_CO2_SC_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 5").Select
  mai2 = Selection.Characters.Text
  ActiveSheet.Shapes("Edit Box 6").Select
  mai3 = Selection.Characters.Text
  
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai3) > 21 Then MsgBox ("The number of Area Name characters must be less than 22."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai3 = "" Then MsgBox ("The Area Name has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("CO2_SC IN " & mai3, i, 1) = "/" Or Mid("CO2_SC IN " & mai3, i, 1) = "*" Or Mid("CO2_SC IN " & mai3, i, 1) = "\" Or Mid("CO2_SC IN " & mai3, i, 1) = "?" Or Mid("CO2_SC IN " & mai3, i, 1) = "[" Or Mid("CO2_SC IN " & mai3, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Name"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("CO2_SC IN " & mai3) = SHTNAME(i) And osa <> "CO2_SC IN " & mai3 Then
MsgBox ("This Area Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "CO2_SC IN " & mai3
 Range("b2") = "           CO2_SC IN " & mai3
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "CO2_SC IN " & mai3: Exit For
 
  Next j
  
 Sheets("CO2_SC IN " & mai3).Select
LINE10:
  
  DialogSheets("Dialog_CO2_SC_DATA").Visible = 0

  Range("J23").Select
  ActiveCell.FormulaR1C1 = mai1
   Range("J24").Select
  ActiveCell.FormulaR1C1 = mai2
   Range("J25").Select
  ActiveCell.FormulaR1C1 = mai3

If Range("c4") = 1 Then Range("b31").Select
 If Range("c4") = 2 Then Range("b44").Select
 If Range("c4") = 3 Then Range("b57").Select
 If Range("c4") = 4 Then Range("b70").Select
 
LINE1:
  
DialogSheets("Dialog_CO2_SC_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
   
 ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub CO2_SC_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_CO2_SC_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub reset_co2_sc()

Application.ScreenUpdating = False: Call air
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If


Range("b31,d31,f31,h31,j31").ClearContents
Range("b44,d44,f44,h44").ClearContents
Range("j44:k44").ClearContents
Range("b57,d57,f57,h57,j57,l57").ClearContents
Range("b70,d70,f70").ClearContents
Range("J23:J25").ClearContents
    DialogSheets("Dialog_CO2_SC_DATA").Visible = -1
    Sheets("Dialog_CO2_SC_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 5").Select
    Selection.Characters.Text = ""
    ActiveSheet.Shapes("Edit Box 6").Select
    Selection.Characters.Text = ""
     ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("co2 storage capacity").Select
    DialogSheets("Dialog_CO2_SC_DATA").Visible = 0
    Sheets("DIALOG_option_co2_sc").Visible = 0
Sheets("List reference").Visible = 0
    
    ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 50
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("Q84").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 55
    
 If Range("c4") = 1 Then Range("b31").Select
 If Range("c4") = 2 Then Range("b44").Select
 If Range("c4") = 3 Then Range("b57").Select
 If Range("c4") = 4 Then Range("b70").Select
 
 
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_co2_sc()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.PageSetup.PrintArea = "$B$21:$M$78"
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&11&D"
        .CenterFooter = ""
        .RightFooter = "&11Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.3)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("J23:J28,K27,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
        With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
        
      Range("B29:M78").Select
    Range("B29").Activate
    Selection.Interior.ColorIndex = xlNone
    
     Range("B30:K30,B34:K34,B38:e38").Select
    Range("B30").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
     Range("B43:L43,B47:I47,B51:E51").Select
    Range("B43").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
        Range("B56:M56,B60:E60,B64:E64").Select
    Range("B56").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
     
        Range("B69:G69,B73:H73,B77:E77").Select
    Range("B69").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
 Rows("15:28").Select
 Selection.EntireRow.Hidden = False
 Range(Rows(21), Rows(28)).RowHeight = 16.5
  
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
 ActiveSheet.PageSetup.PrintArea = ""
Rows("15:28").Select
Selection.EntireRow.Hidden = True

Range("B29:M78").Select
    Range("B29").Activate
    With Selection.Interior
        .ColorIndex = 50
        .Pattern = xlSolid
    End With


Range("B31:K31,B44:L44,B57:M57,B70:G70").Select
    Range("B31").Activate
    With Selection.Interior
        .ColorIndex = 48
        .Pattern = xlSolid
    End With
    
      Range("B30:K30,B34:K35,B38:e39").Select
    Range("B30").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
     Range("B43:L43,B47:I48,B51:E52").Select
    Range("B43").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
    Range("B56:M56,B60:E61,B64:E65").Select
    Range("B56").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
  Range("B69:G69,B73:H74,B77:E78").Select
    Range("B69").Activate
     With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    
      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 50
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("Q84").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 55
    
 If Range("c4") = 1 Then Range("b31").Select
 If Range("c4") = 2 Then Range("b44").Select
 If Range("c4") = 3 Then Range("b57").Select
 If Range("c4") = 4 Then Range("b70").Select
 
 ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_co2_sc()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_Enclosure_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 10) = "CO2_SC IN " Then
SHT_Enclosure_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 37) = SHT_Enclosure_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$AK$3:$AK$" & j + 2
Sheets("DIALOG_option_co2_sc").Visible = -1
Sheets("DIALOG_option_co2_sc").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$AK$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("co2 storage capacity").Select
  
    DialogSheets("DIALOG_option_co2_sc").Show

  
End Sub

Sub open_Enclosure_co2_sc()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("DIALOG_option_co2_sc").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No enclosure has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 storage capacity").Select: Sheets("DIALOG_option_co2_sc").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 storage capacity").Select: Sheets("DIALOG_option_co2_sc").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  

   
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("co2 storage capacity").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("DIALOG_option_co2_sc").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("co2 storage capacity").Visible = 0
    
   
 Sheets("DIALOG_option_co2_sc").Visible = -1
   Sheets("DIALOG_option_co2_sc").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_co2_sc").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_Enclosure_co2_sc()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Dim eNCLOSURE_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

eNCLOSURE_name = UCase(Range("J25"))
If Len(eNCLOSURE_name) > 21 Then MsgBox ("The number of Area Name characters must be less than 22."), vbCritical, "MAI Fire Fighting Calculations": Call CO2_SC_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If eNCLOSURE_name = "" Then MsgBox ("The Area Name has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call CO2_SC_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("CO2_SC IN " & eNCLOSURE_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Name."), vbCritical, "MAI Fire Fighting Calculations": Call CO2_SC_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Area Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call CO2_SC_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = eNCLOSURE_name
         
     
  Sheets("co2 storage capacity").Select
   Sheets("co2 storage capacity").Copy Before:=Sheets(1)
  'eNCLOSURE_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
  '      .FontStyle = "Regular"
  '      .Size = 12
   '     .Strikethrough = False
  '      .Superscript = False
   '     .Subscript = False
  '      .OutlineFont = False
   '     .Shadow = False
   '     .Underline = xlUnderlineStyleNone
  '      .ColorIndex = xlAutomatic
  'End With
Sheets("co2 storage capacity (2)").Select
 Sheets("co2 storage capacity (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("B2") = "           CO2 System Storage Capacity in " & Range("J25")

 ActiveSheet.Shapes("Button 5").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 6").Select
    Selection.OnAction = "Back_to_co2_sc"
     ActiveSheet.Shapes.Range(Array("Option Button 7", "Option Button 8", _
        "Option Button 9", "Option Button 10" _
    , "Group Box 11")).Select
       Selection.Delete
    Range("C4").Select
    Selection.Locked = True
    Selection.FormulaHidden = True
    Range("B5").Select
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Arial"
        .Size = 20
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .Underline = xlUnderlineStyleSingle
    End With
   Range("b5").Value = Range("j26")
    
    Range("A1:Y2").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
    Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
    ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 50
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("Q84").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 55
    
 If Range("c4") = 1 Then Range("b31").Select
 If Range("c4") = 2 Then Range("b44").Select
 If Range("c4") = 3 Then Range("b57").Select
 If Range("c4") = 4 Then Range("b70").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "CO2_SC IN " & eNCLOSURE_name
Sheets("co2 storage capacity").Select

Call reset_co2_sc
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("co2 storage capacity").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("DIALOG_option_co2_sc").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_Enclosure_co2_sc()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("DIALOG_option_co2_sc").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No enclosure has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 storage capacity").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("DIALOG_option_co2_sc").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("co2 storage capacity").Select: Sheets("DIALOG_option_co2_sc").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("DIALOG_option_co2_sc").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("co2 storage capacity").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("DIALOG_option_co2_sc").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub option_CO2_SC_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("co2 storage capacity").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("DIALOG_option_co2_sc").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_co2_sc()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("co2 storage capacity").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("co2 storage capacity").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub CO2_Sc_TFS_SF()

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("j3").Select
ActiveCell.FormulaR1C1 = "Flammable Fuel Included in The Enclosure"
  
  ActiveSheet.Shapes("Drop Down 2").Select
    With Selection
        .ListFillRange = "$AY$9:$AY$49"
        .LinkedCell = "$AX$9"
        .DropDownLines = 8
        .Display3DShading = True
    End With
  

Rows("8:14").EntireRow.Hidden = True
Rows("42:78").EntireRow.Hidden = True
Rows("7:7").EntireRow.Hidden = False
Rows("29:39").EntireRow.Hidden = False
Range("j26").Select
ActiveCell.FormulaR1C1 = "Total Flooding System (Surface Fire)"
Range("i27").Select
ActiveCell.FormulaR1C1 = "Flamable Fuel Included:"
Range("J27").ClearContents
Range("k27").Select
 ActiveCell.FormulaR1C1 = "=PROPER(INDEX(R[-18]C[40]:R[22]C[40],R[-18]C[39]))"
Range("b31").Select
ActiveSheet.Protect Password:=qwe & rty & uio

End Sub

Sub CO2_Sc_TFS_DSF()

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("j3").Select
ActiveCell.FormulaR1C1 = "Specific Hazard"

 ActiveSheet.Shapes("Drop Down 2").Select
    With Selection
        .ListFillRange = "$ci$9:$ci$12"
        .LinkedCell = "$ce$9"
        .DropDownLines = 5
        .Display3DShading = True
    End With
    
  
    Rows("7:7").EntireRow.Hidden = True
    Rows("10:14").EntireRow.Hidden = True
    Rows("29:41").EntireRow.Hidden = True
    Rows("53:78").EntireRow.Hidden = True
    Rows("8:9").EntireRow.Hidden = False
    Rows("42:52").EntireRow.Hidden = False
    Range("j26").Select
ActiveCell.FormulaR1C1 = "Total Flooding System (Deep Seated Fire)"
Range("i27").Select
Range("K27").ClearContents
ActiveCell.FormulaR1C1 = "Specific Hazard:"
Range("J27").Select
ActiveCell.FormulaR1C1 = "=INDEX(R[-18]C[77]:R[-15]C[77],R[-18]C[73])"
Range("b44").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub

Sub CO2_Sc_las_v()

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("j3").Select
ActiveCell.FormulaR1C1 = "Enclosure Type"

 ActiveSheet.Shapes("Drop Down 2").Select
    With Selection
        .ListFillRange = "$dc$4:$dc$5"
        .LinkedCell = "$dd$4"
        .DropDownLines = 2
        .Display3DShading = True
    End With
    
    
    Rows("7:9").EntireRow.Hidden = True
    Rows("12:14").EntireRow.Hidden = True
    Rows("29:54").EntireRow.Hidden = True
    Rows("66:78").EntireRow.Hidden = True
    Rows("10:11").EntireRow.Hidden = False
    Rows("55:65").EntireRow.Hidden = False
    Range("j26").Select
ActiveCell.FormulaR1C1 = "Local Application System (Volume Method)"
Range("i27").Select
ActiveCell.FormulaR1C1 = "Enclosure Type:"
Range("K27").ClearContents
Range("J27").Select
 ActiveCell.FormulaR1C1 = "=PROPER(INDEX(R[-23]C[97]:R[-22]C[97],R[-23]C[98]))"
Range("b57").Select
ActiveSheet.Protect Password:=qwe & rty & uio
End Sub

Sub CO2_Sc_las_a()

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("j3").Select
ActiveCell.FormulaR1C1 = "Nozzles Type"

ActiveSheet.Shapes("Drop Down 2").Select
    With Selection
        .ListFillRange = "$dm$4:$dm$6"
        .LinkedCell = "$dn$4"
        .DropDownLines = 3
        .Display3DShading = True
    End With
    
   
    Rows("7:9").EntireRow.Hidden = True
    Rows("10:11").EntireRow.Hidden = True
    Rows("29:67").EntireRow.Hidden = True
     Rows("12:14").EntireRow.Hidden = False
    Rows("68:78").EntireRow.Hidden = False
        Range("j26").Select
ActiveCell.FormulaR1C1 = "Local Application System (Area Method)"
Range("i27").Select
ActiveCell.FormulaR1C1 = "Nozzles Type:"
Range("K27").ClearContents
Range("J27").Select
ActiveCell.FormulaR1C1 = "=PROPER(INDEX(R[-23]C[107]:R[-21]C[107],R[-23]C[108]))"
Range("b70").Select
ActiveSheet.Protect Password:=qwe & rty & uio

End Sub

Sub co2_storage_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("ah5").ClearContents
Range("bu7").ClearContents
Range("du4").ClearContents
If Range("ah35") = 2 Then


Range("d31") = Range("d31") / 3.28083989501312 ^ 2
Range("f31") = Range("f31") / 3.28083989501312
Range("b31") = Range("b31") / 3.28083989501312 ^ 3
If Range("h31") = 0 Then GoTo LINE10:
Range("h31") = (Range("h31") - 32) / 1.8
LINE10:
Range("j31") = Range("j31") / 2.119


Range("d44") = Range("d44") / 3.28083989501312 ^ 2
Range("f44") = Range("f44") / 3.28083989501312
Range("b44") = Range("b44") / 3.28083989501312 ^ 3
If Range("h44") = 0 Then GoTo line11:
Range("h44") = (Range("h44") - 32) / 1.8
line11:
Range("j44") = Range("j44") / 2.119

Range("b57") = Range("b57") / 3.28083989501312
Range("d57") = Range("d57") / 3.28083989501312
Range("f57") = Range("f57") / 3.28083989501312
Range("j57") = Range("j57") / 3.28083989501312
If Range("dd4") = 1 Then
Range("h57") = Range("h57") / 3.28083989501312
End If
If Range("dd4") = 2 Then
Range("h57") = Range("h57") / 3.28083989501312 ^ 2
End If

Range("b70") = Range("b70") / 3.28083989501312 ^ 2
Range("d70") = Range("d70") / 3.28083989501312

End If
Range("ah35") = 1
Range("ah5").Formula = "=IF(OR(R[30]C[-26]="""",R[30]C[-24]=""""),0,CO2_1(R[30]C[-24],R[30]C[-26],R[34]C[-32]))"
Range("bu7").Formula = "=IF(OR(R[41]C[-65]="""",R[41]C[-67]=""""),0,CO2_2(R[41]C[-65],R[41]C[-67],R[45]C[-71]))"
Range("du4").Formula = "=CO2_STORAGE_LAS_A(R[66]C[-121],R[66]C[-123])"
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub

Sub co2_storage_british()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("ah5").ClearContents
Range("bu7").ClearContents
Range("du4").ClearContents
If Range("ah35") = 1 Then


Range("d31") = Range("d31") * 3.28083989501312 ^ 2
Range("f31") = Range("f31") * 3.28083989501312
Range("b31") = Range("b31") * 3.28083989501312 ^ 3
If Range("h31") = 0 Then GoTo LINE10:
Range("h31") = Range("h31") * 1.8 + 32
LINE10:
Range("j31") = Range("j31") * 2.119


Range("d44") = Range("d44") * 3.28083989501312 ^ 2
Range("f44") = Range("f44") * 3.28083989501312
Range("b44") = Range("b44") * 3.28083989501312 ^ 3
If Range("h44") = 0 Then GoTo line11:
Range("h44") = Range("h44") * 1.8 + 32
line11:
Range("j44") = Range("j44") * 2.119

Range("b57") = Range("b57") * 3.28083989501312
Range("d57") = Range("d57") * 3.28083989501312
Range("f57") = Range("f57") * 3.28083989501312
Range("j57") = Range("j57") * 3.28083989501312
If Range("dd4") = 1 Then
Range("h57") = Range("h57") * 3.28083989501312
End If
If Range("dd4") = 2 Then
Range("h57") = Range("h57") * 3.28083989501312 ^ 2
End If

Range("b70") = Range("b70") * 3.28083989501312 ^ 2
Range("d70") = Range("d70") * 3.28083989501312

End If
Range("ah35") = 2
Range("ah5").Formula = "=IF(OR(R[30]C[-26]="""",R[30]C[-24]=""""),0,CO2_1(R[30]C[-24],R[30]C[-26],R[34]C[-32]))"
Range("bu7").Formula = "=IF(OR(R[41]C[-65]="""",R[41]C[-67]=""""),0,CO2_2(R[41]C[-65],R[41]C[-67],R[45]C[-71]))"
Range("du4").Formula = "=CO2_STORAGE_LAS_A(R[66]C[-121],R[66]C[-123])"
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub


Attribute VB_Name = "Module73"
Attribute VB_Name = "Module74"
Attribute VB_Name = "Module75"
Attribute VB_Name = "Module76"
Sub MAI_QUIT()
Application.ScreenUpdating = False: Call air

ActiveWorkbook.Close
End Sub
Sub back_to_MAI()
'
' References_open Macro
' Macro recorded 08-08-1996 by Mai
'
Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
ActiveWindow.FreezePanes = False

M_T1.Visible = -1
ActiveSheet.Visible = 0
M_T1.Select
ActiveWindow.Zoom = 50
ActiveWindow.ScrollColumn = 1
ActiveWindow.ScrollRow = 1
ActiveWindow.FreezePanes = False
Range("x40").Select
ActiveWindow.FreezePanes = True
ActiveWindow.Zoom = 100
ActiveWorkbook.Protect Password:=qwe & rty & uio
'
End Sub



Sub about_MAI_OPEN()

Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 80
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("Q24").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
ABOUT_MAI.Visible = -1
ABOUT_MAI.Select
M_T1.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Sub about_MAI_back()

Application.ScreenUpdating = False: Call air
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
ActiveWindow.FreezePanes = False
 ActiveWindow.Zoom = 80
 ActiveWindow.ScrollRow = 1
 ActiveWindow.ScrollColumn = 1
 Range("f4").Select
 ActiveWindow.FreezePanes = True
 ActiveWindow.Zoom = 100
M_T1.Visible = -1
M_T1.Select
ABOUT_MAI.Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Sub about_MAI_dialog()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio


DialogSheets("dialog_About_MAI").Visible = -1
 DialogSheets("dialog_About_MAI").Select

DialogSheets("dialog_About_MAI").Show

End Sub

Sub about_MAI_ok()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
M_T1.Select
DialogSheets("dialog_About_MAI").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub
Sub about_MAI_cancel()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

M_T1.Select
DialogSheets("dialog_About_MAI").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio
End Sub

Attribute VB_Name = "Module78"
Attribute VB_Name = "Module79"
Attribute VB_Name = "Module8"
Sub UNPROTECT()
Attribute UNPROTECT.VB_Description = "Macro recorded 15-07-1996 by Mai"
Attribute UNPROTECT.VB_ProcData.VB_Invoke_Func = "l\n14"
'
' UNPROTECT Macro
' Macro recorded 15-07-1996 by Mai
'
ActiveSheet.UNPROTECT
ActiveWorkbook.UNPROTECT

'
End Sub
Attribute VB_Name = "Module81"
Sub RESETPSH()
Attribute RESETPSH.VB_Description = "Macro recorded 3/13/01 by  "
Attribute RESETPSH.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RESETPSH Macro
' Macro recorded 3/13/01 by
'

Application.ScreenUpdating = False: Call air
    Range("C5").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C7").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C9").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C11").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C13").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C15").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C17").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C19").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C21").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C23").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C25").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C27").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C29").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C31").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C33").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C35").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C37").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C39").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C41").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C43").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C45").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C47").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C49").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C51").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C53").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C55").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C57").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C59").Select
    ActiveCell.FormulaR1C1 = ""
    Range("C61").Select
    ActiveWindow.ScrollRow = 1
    Range("O5:O60").Select
    Selection.ClearContents
    Range("A5:A60").Select
    Selection.ClearContents
    Range( _
        "E5:N5,E7:N7,E9:N9,E11:N11,E13:N13,E15:N15,E17:N17,E19:N19,E21:N21,E23:N23,E25:N25,E27:N27,E29:N29,E31:N31,E33:N33,E35:N35,E37:N37,E39:N39,E41:N41,E43:N43,E45:N45,E47:N47,E49:N49,E51:N51,E53:N53,E55:N55,E57:N57,E59:N59" _
        ).Select
    Range("E59").Activate
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-49
    Range("C5").Select
End Sub
Attribute VB_Name = "Module83"
Attribute VB_Name = "Module84"
Attribute VB_Name = "Module85"
Attribute VB_Name = "Module86"
Attribute VB_Name = "Module87"
Attribute VB_Name = "Module88"
Sub co2_nozzles_data()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
osa = ActiveSheet.Name
OSA1 = Range("i23")


  DialogSheets("Dialog_co2_nozzles_DATA").Visible = -1
 DialogSheets("Dialog_co2_nozzles_DATA").Select
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 'DialogSheets("Dialog_co2_pipe_DATA").Show
ActiveSheet.Shapes("Edit Box 4").Select
Selection.Characters.Text = OSA1

Sheets(osa).Select
DialogSheets("Dialog_co2_nozzles_DATA").Show

End Sub

Sub co2_nozzles_data_OK()

Application.ScreenUpdating = False: Call air
osa = ActiveSheet.Name

  Sheets("Dialog_co2_nozzles_DATA").Select
  ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  
  ActiveSheet.Shapes("Edit Box 4").Select
  mai1 = Selection.Characters.Text
  
  
 
  ActiveSheet.Protect Password:=qwe & rty & uio
  Sheets(osa).Select
  
   ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 If Range("A1") <> "1" Then GoTo LINE10:
 If Len(mai1) > 16 Then MsgBox ("The number of Area Group Name characters must be less than 17."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If mai1 = "" Then MsgBox ("The Area Group Name has not been entered. Please enter it first, and then press ok."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
 ee = 0
 For i = 1 To 32
If Mid("CO2 NOZZLES IN " & mai1, i, 1) = "/" Or Mid("CO2 NOZZLES IN " & mai1, i, 1) = "*" Or Mid("CO2 NOZZLES IN " & mai1, i, 1) = "\" Or Mid("CO2 NOZZLES IN " & mai1, i, 1) = "?" Or Mid("CO2 NOZZLES IN " & mai1, i, 1) = "[" Or Mid("CO2 NOZZLES IN " & mai1, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Group Name"), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i
   osamai = Sheets.Count
    For i = 1 To osamai
    Dim SHTNAME(1000)
    SHTNAME(i) = UCase(Sheets(i).Name)
    If UCase("CO2 NOZZLES IN " & mai1) = SHTNAME(i) And osa <> "CO2 NOZZLES IN " & mai1 Then
MsgBox ("This Area Group Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   Exit For
   End If
    Next i
      
        
 Sheets(osa).Name = "CO2 NOZZLES IN " & mai1
 Range("b2") = "         CO2 NOZZLES IN " & mai1
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
hamadadede = Application.WorksheetFunction.CountA(Columns(131))
For j = 1 To hamadadede
  If UCase(osa) = UCase(Cells(j, 131)) Then Cells(j, 131) = "CO2 NOZZLES IN " & mai1: Exit For
 
  Next j
  
 Sheets("CO2 NOZZLES IN " & mai1).Select
LINE10:
  
  DialogSheets("Dialog_co2_nozzles_DATA").Visible = 0

  Range("i23").Select
  ActiveCell.FormulaR1C1 = mai1
  
LINE1:
  
DialogSheets("Dialog_co2_nozzles_DATA").Visible = 0
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
  
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub co2_nozzles_data_CANCEL()

osa = ActiveSheet.Name
Application.ScreenUpdating = False: Call air
Sheets(osa).Select
DialogSheets("Dialog_co2_nozzles_DATA").Visible = 0
ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub ADD_area_co2_nozzles()

'
' Macro9999 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
mai = Range("B7")
Dim answer As String
LINE1:
answer = UCase(InputBox("Enter area name", "MAI Fire Fighting Calculations"))
If answer = Empty Then
ActiveSheet.Protect Password:=qwe & rty & uio
Else
Dim counter
counter = 29
Do While counter < mai + 28
If answer = Cells(counter, 3).Value Then
MsgBox ("This area name has been previously entered. Make sure that it is not repeated."), vbCritical, "MAI Fire Fighting Calculations"
GoTo LINE1
End If
counter = counter + 1
Loop


Dim ser_no As String
LINE6:
ser_no = (InputBox("Enter the serial No. that will determine the area name location.", "MAI Fire Fighting Calculations", mai))
If ser_no = Empty Then GoTo LINE10:
If ser_no = mai Then GoTo line2:
par = 0
For i = 29 To mai + 28
If ser_no = Cells(i, 2).Value Then par = 1
Next i
If ser_no = mai Then par = 1
If par = 0 Then GoTo line4:
If par = 1 Then GoTo line7:
line4:
MsgBox ("The serial No. must be a number between 1 and " & mai & "."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE6:
line7:
 Range(Cells(ser_no + 28, 2), Cells(ser_no + 28, 10)).Select
 Selection.Insert Shift:=xlDown
    Cells(ser_no + 28, 2).Select
   ActiveCell.FormulaR1C1 = ser_no
   Selection.Interior.ColorIndex = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
   Selection.Font.Size = 11
   Selection.Font.Bold = False
    Cells(ser_no + 29, 2).Select
  
    ActiveCell.FormulaR1C1 = "=R[-1]C+1"

     If ser_no = mai - 1 Then GoTo line3:
    Cells(ser_no + 29, 2).Select
    Selection.Copy
    Range(Cells(ser_no + 30, 2), Cells(mai + 28, 2)).Select
    ActiveSheet.PASTE
    GoTo line3:
line2:
ser_no = mai

  
Range("a7:b7").Select
Selection.Copy
Cells(28 + ser_no, 1).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

line3:
Cells(28 + ser_no, 3).Select
ActiveCell.FormulaR1C1 = answer


Range("d7:j7").Select
Selection.Copy
Cells(28 + ser_no, 4).Select
ActiveSheet.PASTE
Selection.Interior.ColorIndex = xlNone

Cells(28 + ser_no, 4).Select
Application.CutCopyMode = False
Selection.Copy
Cells(28 + ser_no, 3).Select
Selection.PasteSpecial PASTE:=xlFormats, Operation:=xlNone, SkipBlanks:= _
      False, Transpose:=False
Application.CutCopyMode = False
Cells(28 + ser_no, 3).Select
Selection.NumberFormat = "@"
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .MergeCells = False
End With
With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
End With
 

    
Range("B7") = Range("B7") + 1
Range("d7").ClearContents
Range("f7").ClearContents
Range("d7").Select
ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=ser_no - 7
     
Application.CutCopyMode = False
LINE10:
ActiveSheet.Protect Password:=qwe & rty & uio

End If
End Sub
Sub DELETE_area_co2_nozzles()
'
' MMM Macro
' Macro recorded 7/27/1995 by Mai
'

Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
     mai = Range("b7")
     
Dim counter
counter = 29
Do While counter < mai + 28
            prop = UCase(Cells(counter, 3).Value)
            Cells(counter, 3).Value = prop
            counter = counter + 1
Loop
     
     Dim answer As String
If mai = 1 Then MsgBox ("There is no area to be deleted."), vbCritical, "MAI Fire Fighting Calculations": GoTo LINE10:
LINE1:
answer = UCase(InputBox("Enter area name that required to be deleted.", "MAI Fire Fighting Calculations"))
 
elie = mai + 28
par = 0
For i = 29 To elie
If answer = Cells(i, 3).Value Then par = 1: Exit For


Next i
If par = 0 Then MsgBox ("This area name is not existing."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Exit Sub
 
  
    If answer = Empty Then
     ActiveSheet.Protect Password:=qwe & rty & uio
    Else
    If MsgBox("Are you sure you want to delete """ & Cells(i, 3).Value & """?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
Else
   '  Dim Counter
'Counter = 29
'    Do While Counter < MAI + 28
 '          If answer = Cells(Counter, 3).Value Then
                      
          Range(Cells(i, 2), Cells(i, 10)).Select
           Cells(i, 2).Activate
           Selection.Delete Shift:=xlUp
         
           Cells(i, 2).Select
           If i = mai + 27 Then GoTo line2:
           If i = 29 And Range("b7") = 3 Then
           ActiveCell.FormulaR1C1 = "1"
           GoTo line2:
           End If
           
            If i = 29 And Range("b7") > 3 Then
           ActiveCell.FormulaR1C1 = "1"
            Cells(i + 1, 2).Select
            ActiveCell.FormulaR1C1 = "=R[-1]C+1"
            Selection.Copy
            Range(Cells(i + 1, 2), Cells(mai + 26, 2)).Select
            ActiveSheet.PASTE
           GoTo line2:
           End If
           
           ActiveCell.FormulaR1C1 = "=R[-1]C+1"
           Cells(i, 2).Select
           Selection.Copy
           Range(Cells(i, 2), Cells(mai + 26, 2)).Select
           ActiveSheet.PASTE
line2:
            Range("b7") = Range("b7") - 1
            End If
             End If
                      
    
    Range("d7").Select
 ActiveWindow.ScrollRow = 1: ActiveWindow.SmallScroll Down:=i - 36
LINE10:
     ActiveSheet.Protect Password:=qwe & rty & uio

End Sub
Sub RESET_co2_nozzles()

'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If MsgBox("Are you sure you want to reset all saved information in this calculation sheet?", vbYesNo, "MAI Fire Fighting Calculations") = vbNo Then
GoTo LINE10:
End If
 ActiveWindow.FreezePanes = False
Range("B7").Select
ActiveCell.FormulaR1C1 = "1"
Range("i23").ClearContents
Range("d7").ClearContents
Range("f7").ClearContents
Range("B29:j1034").Select
Selection.ClearContents
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
Selection.Borders(xlEdgeLeft).LineStyle = xlNone
With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
End With
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlEdgeRight).LineStyle = xlNone
Selection.Borders(xlInsideVertical).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

    DialogSheets("Dialog_co2_nozzles_DATA").Visible = -1
    Sheets("Dialog_co2_nozzles_DATA").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 4").Select
    Selection.Characters.Text = ""
       ActiveSheet.Protect Password:=qwe & rty & uio
LINE10:
    Sheets("CO2 nozzles distribution").Select
    DialogSheets("Dialog_co2_nozzles_DATA").Visible = 0
    Sheets("dialog_option_co2_nozzles").Visible = 0
Sheets("List reference").Visible = 0
    
     ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWindow.SmallScroll ToRight:=-6
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub PRINT_co2_nozzles()
'
' PRINT_BOOSTER_PUMP_SET_HEAD Macro
' Macro recorded 10-06-1995 by Mai
'


Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  ActiveWindow.FreezePanes = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$21:$28"
        .PrintTitleColumns = ""
    End With
        With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = "&10&D"
        .CenterFooter = ""
        .RightFooter = "&10Page &P of &N"
        .LeftMargin = Application.InchesToPoints(0.8)
        .RightMargin = Application.InchesToPoints(0.2)
        .TopMargin = Application.InchesToPoints(0.5)
        .BottomMargin = Application.InchesToPoints(0.8)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.2)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperLetter
        '.PrintQuality = 600
        .Draft = False
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 81
        .FitToPagesWide = 1
        .FitToPagesTall = 1
    End With
     Range("i23,C23:C26").Select
    Range("C23").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 11.5
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


 
   ActiveSheet.PageSetup.PrintArea = ""
 Rows("8:28").Select
 Selection.EntireRow.Hidden = False
    mai = Range("B7")
    Range(Rows(29), Rows(250)).RowHeight = 20
    Range(Rows(21), Rows(27)).RowHeight = 15
                     
Range(Cells(21, 2), Cells(mai + 27, 10)).Select
ActiveSheet.PageSetup.PrintArea = _
 ActiveCell.CurrentRegion.Address
'ActiveWindow.SelectedSheets.PrintPreview
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
   ActiveSheet.PageSetup.PrintArea = ""
  Rows("8:28").Select
Selection.EntireRow.Hidden = True


      ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75

        Range("d7").Select
       ActiveSheet.Protect Password:=qwe & rty & uio
  End Sub

Sub option_co2_nozzles()
'
' Macro12 Macro
' Macro recorded 06-07-2002 by Mai
'

Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
'DAREEN = Range("J27")
Dim SHT_Area_GROUP_name(200)
may = Sheets.Count

j = 1
For i = 1 To may
If Left(Sheets(i).Name, 15) = "CO2 NOZZLES IN " Then
SHT_Area_GROUP_name(j) = Sheets(i).Name
j = j + 1
End If

Next i

For i = 1 To j
Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Cells(i + 2, 26) = SHT_Area_GROUP_name(i)
Next i

'List refeerence'!$B$3:$B$6
LST_NAME = "'List reference'!$z$3:$z$" & j + 2
Sheets("dialog_option_co2_nozzles").Visible = -1
Sheets("dialog_option_co2_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
'ActiveSheet.Shapes("Edit Box 16").Select
   'Selection.Characters.Text = DAREEN

    ActiveSheet.Shapes("List Box 6").Select
    With Selection
        .ListFillRange = LST_NAME
        .LinkedCell = "'List reference'!$z$2"
        .MultiSelect = xlNone
    End With
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets("CO2 NOZZLES DISTRIBUTION").Select
  
    DialogSheets("dialog_option_co2_nozzles").Show

  
End Sub

Sub open_Area_GROUP_co2_nozzles()
'
' Macro13 Macro
' Macro recorded 06-07-2002 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
    Sheets("dialog_option_co2_nozzles").Select
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   If may = "" Then MsgBox ("No area group has been selected to be opened."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("CO2 NOZZLES DISTRIBUTION").Select: Sheets("dialog_option_co2_nozzles").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub
   
elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area group with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("CO2 NOZZLES DISTRIBUTION").Select: Sheets("dialog_option_co2_nozzles").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("CO2 NOZZLES DISTRIBUTION").Select
   ActiveSheet.Protect Password:=qwe & rty & uio
   Sheets("dialog_option_co2_nozzles").Visible = 0
   Sheets("LIST REFERENCE").Visible = 0
   If Sheets(may).Visible = 0 Then Sheets(may).Visible = -1
    Sheets(may).Select
    Sheets("CO2 NOZZLES DISTRIBUTION").Visible = 0
    
   
 Sheets("dialog_option_co2_nozzles").Visible = -1
   Sheets("dialog_option_co2_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_option_co2_nozzles").Visible = 0
   Sheets("List reference").Visible = 0
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Sub save_Area_GROUP_co2_nozzles()
'
' M Macro
' Macro recorded 11-06-1995 by Mai
'

'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Dim Area_name As String
Dim SHTNAME(1000)

    osa = Sheets.Count
    For i = 1 To osa
    SHTNAME(i) = UCase(Sheets(i).Name)
    Next i
  

Area_name = UCase(Range("i23"))
If Len(Area_name) > 16 Then MsgBox ("The number of Area Group Name characters must be less than 17."), vbCritical, "MAI Fire Fighting Calculations": Call co2_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
If Area_name = "" Then MsgBox ("The Area Group Name has not been entered. Please enter it first, and then save."), vbCritical, "MAI Fire Fighting Calculations": Call co2_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1

new_sheet_name = UCase("CO2 NOZZLES IN " & Area_name)

 ee = 0
 For i = 1 To 32
If Mid(new_sheet_name, i, 1) = "/" Or Mid(new_sheet_name, i, 1) = "*" Or Mid(new_sheet_name, i, 1) = "\" Or Mid(new_sheet_name, i, 1) = "?" Or Mid(new_sheet_name, i, 1) = "[" Or Mid(new_sheet_name, i, 1) = "]" Then ee = 1
If ee = 1 Then MsgBox ("It is not allowed to use ""/"", ""*"", ""\"", ""?"", ""["" or ""]"" in the Area Group Name."), vbCritical, "MAI Fire Fighting Calculations": Call co2_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   If ee = 0 Then GoTo line222
    Exit For
line222:
    Next i

  For i = 1 To osa
If new_sheet_name = SHTNAME(i) Then
MsgBox ("This Area Group Name has been previously used. Use another one."), vbCritical, "MAI Fire Fighting Calculations": Call co2_nozzles_data: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: GoTo LINE1
   
    Exit For
    End If
    Next i


     
'Range("j27").Select
'ActiveCell.FormulaR1C1 = Area_name
         
     
  Sheets("CO2 NOZZLES DISTRIBUTION").Select
   Sheets("CO2 NOZZLES DISTRIBUTION").Copy Before:=Sheets(1)
  'Area_name1 = Range("j27")
  ' With ActiveCell.Characters(Start:=1, length:=6).Font
  '      .Name = "Arial"
   '     .FontStyle = "Regular"
   '     .Size = 12
   '     .Strikethrough = False
   '     .Superscript = False
   '     .Subscript = False
   '     .OutlineFont = False
   '     .Shadow = False
   '     .Underline = xlUnderlineStyleNone
    '    .ColorIndex = xlAutomatic
'  End With
Sheets("CO2 NOZZLES DISTRIBUTION (2)").Select
 Sheets("CO2 NOZZLES DISTRIBUTION (2)").Name = new_sheet_name
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
Range("B2") = "         CO2 Nozzles Distribution in " & Range("i23")

 ActiveSheet.Shapes("Button 7").Select
 Selection.Delete
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Button 8").Select
    Selection.OnAction = "Back_to_co2_nozzles"
    Range("A1:n2").Select
    Selection.Interior.ColorIndex = 6
    Selection.Font.ColorIndex = 51
    
 Range("A1").Select
 ActiveCell.FormulaR1C1 = "1"
    Selection.Font.ColorIndex = 6
    
     ActiveWindow.FreezePanes = False
      ActiveWindow.Zoom = 60
ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollRow = 1
    Range("N29").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.Zoom = 75
    Range("d7").Select
 
ActiveSheet.Protect Password:=qwe & rty & uio


Sheets("List reference").Visible = -1
Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
osa = Application.WorksheetFunction.CountA(Columns(131))
Cells(osa + 1, 131) = "CO2 NOZZLES IN " & Area_name
Sheets("CO2 NOZZLES DISTRIBUTION").Select

Call RESET_co2_nozzles
ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio

Sheets(new_sheet_name).Visible = 0
LINE1:
 Sheets("CO2 NOZZLES DISTRIBUTION").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("dialog_option_co2_nozzles").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Sub delete_Area_GROUP_co2_nozzles()
'
' Macro14 Macro
' Macro recorded 06-07-2002 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio
Sheets("dialog_option_co2_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    ActiveSheet.Shapes("Edit Box 5").Select
   may = Selection.Characters.Text
   
 If may = "" Then MsgBox ("No area group has been selected to be deleted."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("CO2 NOZZLES DISTRIBUTION").Select: ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("dialog_option_co2_nozzles").Visible = 0: Sheets("LIST REFERENCE").Visible = 0: Exit Sub

 elie = Sheets.Count
par = 0
For i = 1 To elie
If may = Sheets(i).Name Then par = 1
Next i
If par = 0 Then MsgBox ("There is no area group with this name. Please reselect."), vbCritical, "MAI Fire Fighting Calculations": ActiveSheet.Protect Password:=qwe & rty & uio: Sheets("CO2 NOZZLES DISTRIBUTION").Select: Sheets("dialog_option_co2_nozzles").Visible = 0:     Sheets("LIST REFERENCE").Visible = 0: Exit Sub
  
  
  ActiveSheet.Protect Password:=qwe & rty & uio
    Sheets(may).Delete
   
   Sheets("List reference").Select: ActiveSheet.UNPROTECT Password:=qwe & rty & uio
  hANI = Application.WorksheetFunction.CountA(Columns(131)) - 1
 ''Sheets("MECHANICAL").Select
For i = 1 To hANI
MAJ = Cells(i + 1, 131)
If MAJ = may Then
 Cells(i + 1, 131).Select
    Selection.Delete Shift:=xlUp
    End If
Next i
Sheets("dialog_option_co2_nozzles").Select
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
ActiveSheet.Shapes("Edit Box 5").Select
Selection.Characters.Text = ""
 ActiveSheet.Protect Password:=qwe & rty & uio
 Sheets("CO2 NOZZLES DISTRIBUTION").Select
 ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("dialog_option_co2_nozzles").Visible = 0
   Sheets("List reference").Visible = 0
   
    
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub option_co2_nozzles_CANCEL()

Application.ScreenUpdating = False: Call air
Sheets("CO2 NOZZLES DISTRIBUTION").Select
ActiveSheet.Protect Password:=qwe & rty & uio
DialogSheets("dialog_option_co2_nozzles").Visible = 0
Sheets("List reference").Visible = 0
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub Back_to_co2_nozzles()
'
' Back_to_Main_Menu Macro
' Macro recorded 7/5/1995 by Mai
'
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("CO2 NOZZLES DISTRIBUTION").Visible = -1
ActiveSheet.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
Sheets("CO2 NOZZLES DISTRIBUTION").Select
'
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Sub co2_NOZZLES_SI()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u31") = 2 Then
Range("d7") = Range("d7") / 3.28
Range("f7") = Range("f7") / 3.28
mai = Range("B7")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4) = Cells(i + 28, 4) / 3.28
Cells(i + 28, 6) = Cells(i + 28, 6) / 3.28
Next i
End If
LINE10:
Range("u31") = 1
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub
Sub co2_NOZZLES_BRITISH()
'
' BOOSTER_DISCH_SI Macro
' Macro recorded 9/1/2002 by Mai

Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("u31") = 1 Then
Range("d7") = Range("d7") * 3.28
Range("f7") = Range("f7") * 3.28
mai = Range("B7")
If mai = 1 Then GoTo LINE10:
For i = 1 To mai - 1
Cells(i + 28, 4) = Cells(i + 28, 4) * 3.28
Cells(i + 28, 6) = Cells(i + 28, 6) * 3.28
Next i
End If
LINE10:
Range("u31") = 2
Range("d7").Select
ActiveSheet.Protect Password:=qwe & rty & uio
'
End Sub


Attribute VB_Name = "Module9"
Sub Macro16()
Attribute Macro16.VB_Description = "Macro recorded 21/09/2004 by Mohamed"
Attribute Macro16.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro16 Macro
' Macro recorded 21/09/2004 by Mohamed
'

'
    Sheets("DFGDFG").Select
    Sheets("DFGDFG").Name = "GRE"
    Range("D36").Select
End Sub
Attribute VB_Name = "Module90"
Sub st()
Attribute st.VB_Description = "Macro recorded 9/12/2002 by user"
Attribute st.VB_ProcData.VB_Invoke_Func = " \n14"
'
' st Macro
' Macro recorded 9/12/2002 by user
'

'
    Range("H38").Select
    Selection.Copy
    Range("I38").Select
    Application.CutCopyMode = False
End Sub
Attribute VB_Name = "Module9111"
Sub Macro9()
Attribute Macro9.VB_Description = "Macro recorded 18/04/99 by wissam sweissy"
Attribute Macro9.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro9 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
   Application.ScreenUpdating = False: Call air
    ActiveSheet.UNPROTECT Password:=qwe & rty & uio
    Range("A6:Q15").Select
    Selection.Copy
    
    mai = Range("B6")
    Cells(12 + mai * 10, 1).Select
    
    ActiveSheet.PASTE
    Selection.Interior.ColorIndex = xlNone
    
    
    Range("B6") = Range("B6") + 1
    Range("C6:C15").ClearContents
    Range("E6:E15").ClearContents
    Range("F6").ClearContents
     Range("G6").ClearContents
     Range("H6").ClearContents
     Range("E13") = 25
     Range("E14") = 25
     Range("C6").Select
     
    Application.CutCopyMode = False
    ActiveSheet.Protect Password:=qwe & rty & uio
End Sub
Sub Macro90()
'
' Macro9 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

Application.ScreenUpdating = False: Call air
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 
 
    Range("C6:C15").ClearContents
    Range("E6:E15").ClearContents
    Range("F6").ClearContents
     Range("G6").ClearContents
     Range("H6").ClearContents
     Range("C6").Select
     
     
     
   Range("A22:Q400").Clear
   Range("B6") = 1
   Range("E13") = 25
   Range("E14") = 25
   Range("C6").Select
  
  
   ActiveSheet.Protect Password:=qwe & rty & uio
End Sub

Sub Macro900()
'
' Macro9 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

Application.ScreenUpdating = False: Call air
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 
 
    Range("C6:C15").ClearContents
    Range("E6:E15").ClearContents
    Range("F6").ClearContents
     Range("G6").ClearContents
     Range("H6").ClearContents
     Range("E13") = 25
     Range("E14") = 25
     
     
  
   
  Range("C6").Select
  
  
   ActiveSheet.Protect Password:=qwe & rty & uio
End Sub




Sub Macro9000()
'
' Macro9 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

Application.ScreenUpdating = False: Call air
 ActiveSheet.UNPROTECT Password:=qwe & rty & uio
 K = 0
 For i = 22 To 612 Step 10
  
    Cells(5 + K, 34) = "=B" & i
    Cells(5 + K, 35) = "=C" & i
   K = K + 1
    Next i
  
  
   
End Sub

Sub Macro90000()
'
' Macro9 Macro
' Macro recorded 18/04/99 by wissam sweissy
'

'
Application.ScreenUpdating = False: Call air
osa = Range("AG5")
Cells(12 + osa * 10, 2).Select
  
  
   
End Sub

Attribute VB_Name = "References"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SH_F_C02N"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_C02N_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_OUTLETS.Visible = xlSheetVisible
MSH_F_OUTLETS.Select
SH_F_C02N.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_C02P"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CB_F_C02P_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_PS.Visible = xlSheetVisible
MSH_F_PS.Select
SH_F_C02P.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_CO2_sc"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CB_F_CO2_SF_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_CO2_TFS.Visible = xlSheetVisible
MSH_F_CO2_TFS.Select
SH_F_CO2_SF.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Attribute VB_Name = "SH_F_CSP"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CB_F_CSP_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_PS.Visible = xlSheetVisible
MSH_F_PS.Select
SH_F_CSP.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_FM200N"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CB_F_FM200N_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_OUTLETS.Visible = xlSheetVisible
MSH_F_OUTLETS.Select
SH_F_FM200N.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_FM200SC"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FM200SC_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_SC.Visible = xlSheetVisible
MSH_F_SC.Select
SH_F_FM200SC.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub

Attribute VB_Name = "SH_F_FPFHCS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FPFHCS_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_EQ.Visible = xlSheetVisible
MSH_F_EQ.Select
SH_F_FPFHCS.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_FSD"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FSD_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_OUTLETS.Visible = xlSheetVisible
MSH_F_OUTLETS.Select
SH_F_FSD.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_JP"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CB_F_JP_H_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

SMSH_F_JP.Visible = xlSheetVisible
SMSH_F_JP.Select
SH_F_JP_H.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_F_SP"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_SP_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_PS.Visible = xlSheetVisible
MSH_F_PS.Select
SH_F_SP.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SH_PIPULATOR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OB_PIPULATOR_SI_UNITS, 29, 1, MSForms, OptionButton"
Attribute VB_Control = "OB_PIPULATOR_BRITISH_UNITS, 30, 2, MSForms, OptionButton"


Private Sub CB_PIPULATOR_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

GENERAL.Visible = xlSheetVisible
GENERAL.Select
SH_PIPULATOR.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub


Private Sub OB_PIPULATOR_SI_UNITS_Click()
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("A2") = 1 And Range("AR2") = 2 Then
Range("D11") = Range("D11") / 15.85
Range("D11").Select
Selection.NumberFormat = "0.00;;"
Range("F11").Select
Selection.NumberFormat = "0.0"
Range("H11").Select
Selection.NumberFormat = "0"
Range("AR2").Value = 1
End If

If Range("A2") = 2 And Range("AR2") = 2 Then
Range("D11") = Range("D11") / 15.85
Range("F11") = Range("F11") * 400 / 1.8
Range("D11").Select
Selection.NumberFormat = "0.00;;"
Range("F11").Select
Selection.NumberFormat = "0;;"
Range("H11").Select
Selection.NumberFormat = "0.0"
Range("AR2").Value = 1
End If

If Range("A2") = 3 And Range("AR2") = 2 Then
Range("D11") = Range("D11") / 15.85
Range("F11") = Range("F11") / 3.28
Range("D11").Select
Selection.NumberFormat = "0.00;;"
Range("F11").Select
Selection.NumberFormat = "0.0;;"
Range("H11").Select
Selection.NumberFormat = "0"
Range("AR2").Value = 1
End If

If Range("A2") = 4 And Range("AR2") = 2 Then
Range("D11") = Range("D11") / 15.85
Range("D11").Select
Selection.NumberFormat = "0.00;;"
Range("F11").Select
Selection.NumberFormat = "# ?/?;;"
Range("H11").Select
Selection.NumberFormat = "0.0"
Range("J11").Select
Selection.NumberFormat = "0"
Range("AR2").Value = 1
End If
Range("D11").Select
ActiveSheet.Protect Password:=qwe & rty & uio

End Sub

Private Sub OB_PIPULATOR_BRITISH_UNITS_Click()
Application.ScreenUpdating = False: Call air
ActiveSheet.UNPROTECT Password:=qwe & rty & uio
If Range("A2") = 1 And Range("AR2") = 1 Then
Range("D11") = Range("D11") * 15.85
Range("D11").Select
Selection.NumberFormat = "0.0;;"
Range("F11").Select
Selection.NumberFormat = "0.0"
Range("H11").Select
Selection.NumberFormat = "0.0"
Range("AR2").Value = 2
End If

If Range("A2") = 2 And Range("AR2") = 1 Then
Range("D11") = Range("D11") * 15.85
Range("F11") = Range("F11") / 400 * 1.8
Range("D11").Select
Selection.NumberFormat = "0.0;;"
Range("F11").Select
Selection.NumberFormat = "0.0;;"
Range("H11").Select
Selection.NumberFormat = "0.0"
Range("AR2").Value = 2
End If

If Range("A2") = 3 And Range("AR2") = 1 Then
Range("D11") = Range("D11") * 15.85
Range("F11") = Range("F11") * 3.28
Range("D11").Select
Selection.NumberFormat = "0.0;;"
Range("F11").Select
Selection.NumberFormat = "0.0;;"
Range("H11").Select
Selection.NumberFormat = "0.0"
Range("AR2").Value = 2
End If

If Range("A2") = 4 And Range("AR2") = 1 Then
Range("D11") = Range("D11") * 15.85
Range("D11").Select
Selection.NumberFormat = "0.0;;"
Range("F11").Select
Selection.NumberFormat = "# ?/?;;"
Range("H11").Select
Selection.NumberFormat = "0.0"
Range("J11").Select
Selection.NumberFormat = "0.0"
Range("AR2").Value = 2
End If
Range("D11").Select
ActiveSheet.Protect Password:=qwe & rty & uio


End Sub

Attribute VB_Name = "SH_units"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FPCS_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_EQ.Visible = xlSheetVisible
MSH_F_EQ.Select
SMSH_F_FPCS.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SMSH_F_FPCS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FPCS_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_EQ.Visible = xlSheetVisible
MSH_F_EQ.Select
SMSH_F_FPCS.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "SMSH_F_FPSS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FPSS_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_EQ.Visible = xlSheetVisible
MSH_F_EQ.Select
SMSH_F_FPSS.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "Sh_F_FHCP"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CB_F_FHCP_BK_Click()
Application.ScreenUpdating = False: Call air: ActiveWorkbook.UNPROTECT Password:=qwe & rty & uio: ActiveSheet.Protect Password:=qwe & rty & uio

MSH_F_PS.Visible = xlSheetVisible
MSH_F_PS.Select
Sh_F_FHCP.Visible = 0: ActiveSheet.Protect Password:=qwe & rty & uio
ActiveWorkbook.Protect Password:=qwe & rty & uio: End Sub
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{6F52599A-077F-4A31-A816-5417044E777C}{8CC72952-D5BA-4B78-BA4D-DE0729CC9609}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{498FCFFC-07E5-41D6-B946-1084E6C4679F}{DFDEB182-7A77-4855-9C56-671B7042D204}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

' InQuest injected base64 decoded content
' "w+y
' -y+ZrD
' )^J)

INQUEST-PP=macro
