Attribute VB_Name = "Module_Check"
Option Explicit

Private Type T_DataFile
    ShortFileName As String
    Check As Boolean
End Type

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
Function CheckFile(V_I3 As Integer) As Boolean
Dim V_DataFile As T_DataFile                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I1 As Integer                               '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer                               '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_Coordinate As T_Coordinate         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_FindSheetName As String             '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_FindSheetNameInModel As String  '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'begin
    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ..."
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    V_DataFile.ShortFileName = ActiveWorkbook.Name
    '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    V_DataFile.Check = True

    '* |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    For V_I1 = 1 To V_FormNumber

        '** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| **
        With V_DataSheets(V_I1)
            '|-> |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_FindSheetName = Module_PrepearingName.GetSheetNameOnCode(ActiveWorkbook.Name, .Code, .AddressOfCodeOfForm.Row, .AddressOfCodeOfForm.Column)
            '|-> |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_FindSheetNameInModel = Module_PrepearingName.GetSheetNameOnCode(V_ModelsBookName, .Code, .AddressOfCodeOfForm.Row, .AddressOfCodeOfForm.Column)

            '*** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ***
            If V_FindSheetName <> "" _
                Then
                    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                    If Not (Module_Check.CheckTables(ActiveWorkbook.Name, V_FindSheetName, V_FindSheetNameInModel, V_I1)) _
                        Then
                            V_DataFile.Check = False
                    End If

                    '**** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                    For V_I2 = 1 To .TablesCount
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        V_Coordinate.Row = .Tables(V_I2).TopLeft.Row - 1
                        V_Coordinate.Column = .Tables(V_I2).TopLeft.Column - .Tables(V_I2).dS

                        '***** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                        Do While V_Coordinate.Column <= .Tables(V_I2).BottomRight.Column

                            '****** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ******
                            If Workbooks(V_DataFile.ShortFileName).Worksheets(V_FindSheetName).Cells(V_Coordinate.Row, V_Coordinate.Column).Value <> Workbooks(V_ModelsBookName).Worksheets(V_FindSheetNameInModel).Cells(V_Coordinate.Row, V_Coordinate.Column).Value _
                                Then
                                '|fffd||fffd|
                                    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_DataFile.Check = False
                                    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_DataFile.ShortFileName & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_FindSheetName & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(V_Coordinate.Row, V_Coordinate.Column).Address & "."
                            End If
                            '****** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ******

                            V_Coordinate.Column = V_Coordinate.Column + 1
                        Loop
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        V_Coordinate.Row = .Tables(V_I2).TopLeft.Row - 1
                        V_Coordinate.Column = .Tables(V_I2).TopLeft.Column - .Tables(V_I2).dS

                        '***** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                        Do While V_Coordinate.Row <= .Tables(V_I2).BottomRight.Row

                            '****** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ******
                            If Workbooks(V_DataFile.ShortFileName).Worksheets(V_FindSheetName).Cells(V_Coordinate.Row, V_Coordinate.Column).Value <> Workbooks(V_ModelsBookName).Worksheets(V_FindSheetNameInModel).Cells(V_Coordinate.Row, V_Coordinate.Column).Value _
                                Then
                                '|fffd||fffd|
                                    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_DataFile.Check = False
                                    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_DataFile.ShortFileName & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_FindSheetName & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(V_Coordinate.Row, V_Coordinate.Column).Address & "."
                            End If
                            '****** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ******

                            V_Coordinate.Row = V_Coordinate.Row + 1
                        Loop
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                        '***** |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                        If V_DataFile.Check _
                            Then
                            '|fffd||fffd|
                                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                .Tables(V_I2).UniteText(V_I3) = Module_PrepearingName.NameForConsolidation(ActiveWorkbook.FullName, V_DataFile.ShortFileName, V_FindSheetName, Cells(.Tables(V_I2).TopLeft.Row, .Tables(V_I2).TopLeft.Column).Address(ReferenceStyle:=xlR1C1), Cells(.Tables(V_I2).BottomRight.Row, .Tables(V_I2).BottomRight.Column).Address(ReferenceStyle:=xlR1C1))
                        End If
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                    Next V_I2
                    '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****

                    If (V_DataFile.Check) And Not (Module_Exclusion.ForSheet(V_DataFile.ShortFileName, V_FindSheetName, .Code)) _
                        Then
                        '|fffd||fffd|
                            V_DataFile.Check = False
                    End If

                Else
                '|fffd||fffd||fffd||fffd||fffd|
                    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                    Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_DataFile.ShortFileName & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & .Code & " |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & Cells(.AddressOfCodeOfForm.Row, .AddressOfCodeOfForm.Column).Address & "."
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    V_DataFile.Check = False
            End If
            '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***

        End With
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| **

        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Module_ProgressWindow.ChangeProgressBar
    Next V_I1
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *

    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    If V_DataFile.Check _
        Then
        '|fffd||fffd|
            '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|
            CheckFile = True
        Else
        '|fffd||fffd||fffd||fffd||fffd|
            If (V_Key.AnalisInitialize) And (V_Key.AnalisCheck) _
                Then
                    Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!!! |fffd||fffd||fffd||fffd||fffd| " & ActiveWorkbook.Name & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!!!" & _
                                " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
                    V_Key.AnalisCheck = False
                Else
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                    Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!!! |fffd||fffd||fffd||fffd||fffd| " & ActiveWorkbook.Name & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!!!"
            End If
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
            CheckFile = False
    End If
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *

End Function

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| _
|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Function CheckTables(V_LocalBookName As String, V_LocalSheetName As String, V_ModelSheetName As String, V_LocalArrayIndex As Integer) As Boolean
Dim V_Ranges As Range  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_Range As Range    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_I1 As Integer       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_LocalKey As Boolean   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    V_LocalKey = True

    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    With V_DataSheets(V_LocalArrayIndex)

        '** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
        For V_I1 = 1 To .TablesCount

            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Set V_Ranges = Workbooks(V_ModelsBookName).Worksheets(V_ModelSheetName).Range(Cells(.Tables(V_I1).TopLeft.Row, .Tables(V_I1).TopLeft.Column).Address, Cells(.Tables(V_I1).BottomRight.Row, .Tables(V_I1).BottomRight.Column).Address)

            '*** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
            For Each V_Range In V_Ranges

                '**** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                If V_Range.Locked _
                    Then
                    '|fffd||fffd|

                        '***** |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| *****
                        If (Left$(V_Range.Formula, 1) = "=") And (Left$(Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Formula, 1) <> "=") _
                            Then
                            '|fffd||fffd|
                                V_LocalKey = False
                                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalBookName & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalSheetName _
                                & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & V_Range.Address & "."
                        End If
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                        '***** |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| *****
                        If (Left$(V_Range.Formula, 1) = "=") And (Left$(Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Formula, 1) = "=") And (V_Range.Formula <> Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Formula) _
                            Then
                            '|fffd||fffd|
                                V_LocalKey = False
                                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalBookName & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalSheetName _
                                & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & V_Range.Address & "."
                        End If
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                        '***** |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *****
                        If ((V_Range.Value = "x") Or (V_Range.Value = "X") Or (V_Range.Value = "|fffd|") Or (V_Range.Value = "|fffd|")) _
                            And (Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Value <> "X") And _
                            (Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Value <> "x") And _
                            (Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Value <> "|fffd|") And _
                            (Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Value <> "|fffd|") _
                            Then
                            '|fffd||fffd|
                                V_LocalKey = False
                                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalBookName & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalSheetName _
                                & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & V_Range.Address & "."
                        End If
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                    Else
                    '|fffd||fffd||fffd||fffd||fffd|
                        '***** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                        If TypeName(Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Value) <> "Double" And _
                           Workbooks(V_LocalBookName).Worksheets(V_LocalSheetName).Range(V_Range.Address).Value <> "" _
                            Then
                            '|fffd||fffd|
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                V_LocalKey = False
                                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalBookName & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_LocalSheetName _
                                & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|). |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & V_Range.Address & "."
                        End If
                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****

                End If
                '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****

            Next V_Range
            '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***

        Next V_I1
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **

    End With
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *

    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    If V_LocalKey _
        Then
        '|fffd||fffd|
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            CheckTables = True
        Else
        '|fffd||fffd||fffd||fffd||fffd|
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            CheckTables = False
    End If
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *

End Function
Attribute VB_Name = "Module_ConstantsAndVariables"
Option Explicit

Private Type T_Keys
    AnalisInitialize As Boolean
    AnalisCheck As Boolean
    Check As Boolean
End Type

Public Type T_Coordinate
   Row As Long
   Column As Long
End Type

Private Type T_Object
    CodeOfFinans As Integer
    CodeOfRegion As String
    Name As String
    LocalCode As String
    Address As T_Coordinate
End Type

Private Type T_Table
    dS As Integer
    TopLeft As T_Coordinate
    BottomRight As T_Coordinate
    UniteText() As String
End Type

Private Type T_TableForAnalis
    dS As Integer
    TopLeft As T_Coordinate
    BottomRight As T_Coordinate
End Type

Private Type T_DataSheet
    AddressOfCodeOfForm As T_Coordinate
    AddressOfCodeOfObject As T_Coordinate
    Code As String
    TablesCount As Integer
    Tables() As T_Table
End Type

Private Type T_DataSheetForAnalis
    AddressOfCodeOfForm As T_Coordinate
    AddressOfCodeOfObject As T_Coordinate
    Code As String
    TablesCount As Integer
    Tables() As T_TableForAnalis
End Type

Private Type T_Work
    Book As String
    SheetFrom As String
    SheetTo As String
    CoorFrom As T_Coordinate
    CoorTo As T_Coordinate
    OffsetTo As T_Coordinate
    Variant As Single
    Methodic As String
    ObjectName As String
    ObjectCode As String
End Type

Public Const C_SettingsSheetName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const C_SettingsAnalisSheetName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const C_MethodicsSheetName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const C_OpenSheetName = "|fffd||fffd||fffd||fffd||fffd|_N7"
Public Const C_ParameterSheetName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const C_ErrorSheetName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const C_1kv = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_1|fffd||fffd|"
Public Const C_2kv = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_2|fffd||fffd|"
Public Const C_3kv = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_3|fffd||fffd|"
Public Const C_4kv = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_4|fffd||fffd|"
Public V_FormNumber As Integer              '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Public V_DataSheets() As T_DataSheet     '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Public V_DataSheetsForAnalis() As T_DataSheetForAnalis  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_ObjectName As String                                           '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_ObjectCode As String                                           '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_FilesWithError As Long                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_CurrentBookName As String                                     '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Public V_ModelsBookName As String                                       '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_Key As T_Keys                                                          '|fffd||fffd||fffd||fffd||fffd|
Public V_BookForAnalisNumber As Integer                              '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_Work As T_Work                       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public V_FileNumber As Integer              '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Public V_Objects() As T_Object              '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute VB_Name = "Module_Exclusion"
Option Explicit


Sub Initialize()
    
End Sub

Function ForSheet(V_FileName As String, V_SheetName As String, V_CodeOfTable As String) As Boolean
    


    ForSheet = True
    Select Case V_CodeOfTable
    End Select
    
End Function

Sub ForSvod(V_FileName As String, V_SheetName As String, V_CodeOfTable As String)
    
    Select Case V_CodeOfTable
    End Select
End Sub
Attribute VB_Name = "Module_Files"
Option Explicit

Function OpenFilesForWork() As Boolean
Dim V_FilesForOpen As Variant                                          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_FileName As Variant                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I1 As Integer
Dim V_I2 As Integer
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    V_FilesForOpen = Application.GetOpenFilename("|fffd||fffd||fffd||fffd||fffd| Excel (*.xls), *.xls", , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", , True)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    If TypeName(V_FilesForOpen) <> "Boolean" _
        Then
        '|fffd||fffd|
            
            '** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
            V_FileNumber = 0
            For Each V_FileName In V_FilesForOpen
                V_FileNumber = V_FileNumber + 1
            Next
            '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **

'+++++++++++++++++++++++++++++++++
'            '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'            Module_PrepearingData.InitializingAnalisis (V_BookForAnalisNumber)
'+++++++++++++++++++++++++++++++++
            V_Key.AnalisCheck = False
            V_Key.AnalisInitialize = False
            
            If V_Key.AnalisInitialize _
                Then
                    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    Module_ProgressWindow.InitializeProgressBar V_FormNumber * 2 + V_FileNumber * (V_FormNumber + V_BookForAnalisNumber + 1) + V_FormNumber * (V_FileNumber + 1) + V_BookForAnalisNumber * 2
                Else
                    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    Module_ProgressWindow.InitializeProgressBar V_FormNumber * 2 + V_FileNumber * (V_FormNumber + 1) + V_FormNumber * (V_FileNumber + 1)
            End If
            '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            Module_PrepearingData.GetTablesData (V_FormNumber)
            
            '** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
            For V_I1 = 1 To V_FormNumber
                For V_I2 = 1 To V_DataSheets(V_I1).TablesCount
                    ReDim V_DataSheets(V_I1).Tables(V_I2).UniteText(1 To V_FileNumber)
                Next V_I2
                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Module_ProgressWindow.ChangeProgressBar
            Next V_I1
            '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
                                    
            '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_I1 = 1
            V_FilesWithError = 0
            '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
            
            '** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
            For Each V_FileName In V_FilesForOpen
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Application.ScreenUpdating = False
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Workbooks.Open V_FileName, False, True
                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd| " & ActiveWorkbook.Name & " |fffd||fffd||fffd||fffd||fffd||fffd|..."
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
                ActiveWorkbook.Unprotect
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Application.ScreenUpdating = False
                
                '*** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
                If Module_Check.CheckFile(V_I1) _
                   Then
                   '|fffd||fffd|
                       
                        '**** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ****
                        If V_Key.AnalisInitialize _
                            Then
                            '|fffd||fffd|
                               '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                               Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ..."
                               '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                               Module_PrepearingData.GetAnalis ActiveWorkbook.Name
                                
                                '***** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                                If V_Key.AnalisCheck _
                                    Then
                                    '|fffd||fffd|
                                        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                        Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
                                End If
                                '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ******
                       
                       End If
                       '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                       
                   Else
                   '|fffd||fffd||fffd||fffd||fffd|
                       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                       V_FilesWithError = V_FilesWithError + 1
                       
                End If
                '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
                
                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd| " & ActiveWorkbook.Name & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Module_ProgressWindow.PrintString " "
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Workbooks(ActiveWorkbook.Name).Close False
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Application.ScreenUpdating = False
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_I1 = V_I1 + 1
                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Module_ProgressWindow.ChangeProgressBar
            Next
            '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            OpenFilesForWork = True
        Else
        '|fffd||fffd||fffd||fffd||fffd|
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            OpenFilesForWork = False
    End If
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
End Function
Attribute VB_Name = "Module_PrepearingData"
Option Explicit

Private Type T_Object
    CodeOfFinans As Integer
    CodeOfRegion As String
    Name As String
    LocalCode As String
    Address As T_Coordinate
End Type

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub GetTablesData(V_FormNumberLocal As Integer)
Dim V_Coordinate As T_Coordinate    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_I1 As Integer                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer                          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ReDim V_DataSheets(1 To V_FormNumberLocal)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    V_Coordinate.Row = 1
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    For V_I1 = 1 To V_FormNumberLocal
        
        '** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
        With V_Coordinate
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            .Row = .Row + 1
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheets(V_I1).Code = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, 1).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheets(V_I1).AddressOfCodeOfForm.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, 7).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheets(V_I1).AddressOfCodeOfForm.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, 8).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_DataSheets(V_I1).AddressOfCodeOfObject.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, 5).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_DataSheets(V_I1).AddressOfCodeOfObject.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, 6).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Coordinate.Column = 4 + Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, 4).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheets(V_I1).TablesCount = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, .Column).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ReDim V_DataSheets(V_I1).Tables(1 To V_DataSheets(V_I1).TablesCount)
            
            '*** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
            For V_I2 = 1 To V_DataSheets(V_I1).TablesCount
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheets(V_I1).Tables(V_I2).dS = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 1).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheets(V_I1).Tables(V_I2).TopLeft.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 2).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheets(V_I1).Tables(V_I2).TopLeft.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 3).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheets(V_I1).Tables(V_I2).BottomRight.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 4).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheets(V_I1).Tables(V_I2).BottomRight.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 5).Value
            Next V_I2
            '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
        
        End With
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
        
        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Module_ProgressWindow.ChangeProgressBar
    Next V_I1
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub GetTablesDataForAnalis(V_FormNumberLocal As Integer)
Dim V_Coordinate As T_Coordinate    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_I1 As Integer                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer                          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ReDim V_DataSheetsForAnalis(1 To V_FormNumberLocal)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    V_Coordinate.Row = 1
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    For V_I1 = 1 To V_FormNumberLocal
        
        '** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
        With V_Coordinate
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            .Row = .Row + 1
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheetsForAnalis(V_I1).Code = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, 1).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheetsForAnalis(V_I1).AddressOfCodeOfForm.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, 7).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheetsForAnalis(V_I1).AddressOfCodeOfForm.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, 8).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_DataSheetsForAnalis(V_I1).AddressOfCodeOfObject.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, 5).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_DataSheetsForAnalis(V_I1).AddressOfCodeOfObject.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, 6).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Coordinate.Column = 4 + Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, 4).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
            V_DataSheetsForAnalis(V_I1).TablesCount = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, .Column).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ReDim V_DataSheetsForAnalis(V_I1).Tables(1 To V_DataSheetsForAnalis(V_I1).TablesCount)
            
            '*** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
            For V_I2 = 1 To V_DataSheetsForAnalis(V_I1).TablesCount
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheetsForAnalis(V_I1).Tables(V_I2).dS = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 1).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheetsForAnalis(V_I1).Tables(V_I2).TopLeft.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 2).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheetsForAnalis(V_I1).Tables(V_I2).TopLeft.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 3).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheetsForAnalis(V_I1).Tables(V_I2).BottomRight.Column = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 4).Value
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_DataSheetsForAnalis(V_I1).Tables(V_I2).BottomRight.Row = Workbooks(V_ModelsBookName).Worksheets(C_SettingsAnalisSheetName).Cells(.Row, .Column).Offset(0, (V_I2 - 1) * 5 + 5).Value
            Next V_I2
            '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
        
        End With
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
        
        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Module_ProgressWindow.ChangeProgressBar
    Next V_I1
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub InitializingAnalisis(V_BookForAnalisNumberLocal As Integer)
Dim V_BookPath As String        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I1 As Integer                 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer                 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I3 As Integer                 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|?", vbYesNo + vbQuestion) = vbYes _
        Then
            V_Key.AnalisInitialize = True
            V_Key.AnalisCheck = True
        Else
            V_Key.AnalisInitialize = False
            V_Key.AnalisCheck = False
    End If
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    If V_Key.AnalisInitialize _
        Then
        '|fffd||fffd|
            '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
            On Error GoTo E_MethodicsSheet
            '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Workbooks(V_ModelsBookName).Sheets(C_MethodicsSheetName).Visible = True
            '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            On Error GoTo 0
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ReDim V_Objects(0 To V_FileNumber)
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Workbooks(V_ModelsBookName).Activate
            Worksheets(C_MethodicsSheetName).Select
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            V_BookPath = ActiveWorkbook.Path
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            FileSystem.ChDir V_BookPath
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Work.CoorTo.Column = Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B2").Value
            V_Work.CoorTo.Row = Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B1").Value
            
            '** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
            For V_I1 = 1 To V_BookForAnalisNumberLocal
                '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
                On Error GoTo E_Open
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                Workbooks.Open Cells(2, V_I1).Value
                '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                On Error GoTo 0
                
                '*** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| ***
                For V_I2 = 1 To ActiveWorkbook.Sheets.Count
                    V_I3 = 1
                    
                    '**** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ****
                    Do While ActiveWorkbook.Worksheets(V_I2).Cells(V_Work.CoorTo.Row - V_I3, V_Work.CoorTo.Column).Value = ""
                        ActiveWorkbook.Worksheets(V_I2).Cells(V_Work.CoorTo.Row - V_I3, V_Work.CoorTo.Column).EntireRow.Hidden = True
                        V_I3 = V_I3 + 1
                    Loop
                    '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ****
                    
                Next V_I2
                '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| ***
                
                Workbooks(V_ModelsBookName).Activate
            Next V_I1
            '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Work.CoorTo.Row = V_Work.CoorTo.Row + 1
            V_Work.CoorTo.Column = V_Work.CoorTo.Column - 1
    End If
    '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
    
    Exit Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
E_MethodicsSheet:
        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| """ & C_MethodicsSheetName & """. " & _
                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        V_Key.AnalisInitialize = False
        V_Key.AnalisCheck = False
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Exit Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
E_Open:
        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & Cells(2, V_I1).Value & " |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. " & _
                    "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. " & _
                    "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        V_Key.AnalisInitialize = False
        V_Key.AnalisCheck = False
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Resume Next
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub GetAnalis(V_FileName As String, Optional V_LocalObjectName As String)
Dim V_I1 As Byte                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Byte                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_Sign As String                      '|fffd||fffd||fffd||fffd|
Dim V_SignPosition As Integer        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_Coordinate As T_Coordinate '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    On Error Resume Next
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    With V_DataSheets(1)
        V_Work.ObjectCode = Workbooks(V_FileName).Worksheets(Module_PrepearingName.GetSheetNameOnCode(V_FileName, .Code, .AddressOfCodeOfForm.Row, .AddressOfCodeOfForm.Column)).Cells(.AddressOfCodeOfObject.Row, .AddressOfCodeOfObject.Column).Value
    End With
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    On Error GoTo 0
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    If (V_Work.ObjectCode <> "") And (V_Key.AnalisCheck) _
        Then
            '|fffd||fffd|
            
            '** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
            With V_Objects(V_Work.CoorTo.Row - Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B1").Value)
                .LocalCode = V_Work.ObjectCode
                .Address.Column = V_Work.CoorTo.Column
                .Address.Row = V_Work.CoorTo.Row
                Module_PrepearingName.GetCodeAndName .LocalCode, .Name, .CodeOfFinans, .CodeOfRegion
                V_Work.ObjectName = .Name
            End With
            '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
            
            If V_LocalObjectName <> "" _
                Then
                    V_Work.ObjectName = V_LocalObjectName
            End If
            
            '** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
            For V_I1 = 1 To V_BookForAnalisNumber
                
                '*** |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
                With V_Coordinate
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (1,V_I1)
                    .Column = V_I1
                    .Row = 2
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    V_Work.Book = Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    .Row = .Row + 1
                    
                    '**** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                    Do While (Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value <> "") And (TypeName(Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value) <> "Double")
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        V_Work.Methodic = Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        If InStr(V_Work.Methodic, "=") = 0 _
                            Then
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                V_Work.SheetTo = Left$(V_Work.Methodic, 6)
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                On Error GoTo E_SheetTo
                                Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).NumberFormat = "@"
                                Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Value = V_Work.ObjectCode
                                Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column - 1).Value = V_Work.ObjectName
                                On Error GoTo 0
                            Else
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                '0901001,1=|fffd|020100[10,4]; -> 1=|fffd|020100[10,4];
                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                V_Work.OffsetTo.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "=") - 1))
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                '1=|fffd|020100[10,4]; -> |fffd|020100[10,4];
                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, "="))
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                If (InStr(V_Work.Methodic, "+") = 0) And (InStr(V_Work.Methodic, "-") = 0) And (InStr(V_Work.Methodic, "*") = 0) And (InStr(V_Work.Methodic, "/") = 0) _
                                    Then
                                    '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                        If InStr(V_Work.Methodic, "|fffd|") <> 0 _
                                            Then
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_I2 = 1
                                                V_Work.SheetFrom = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "|fffd|") + 1, 6)
                                                Do While (V_DataSheets(V_I2).Code <> V_Work.SheetFrom) And (V_I2 < V_FormNumber)
                                                    V_I2 = V_I2 + 1
                                                Loop
                                                If V_DataSheets(V_I2).Code = V_Work.SheetFrom _
                                                    Then
                                                        V_Work.SheetFrom = Module_PrepearingName.GetSheetNameOnCode(V_FileName, V_Work.SheetFrom, V_DataSheets(V_I2).AddressOfCodeOfForm.Row, V_DataSheets(V_I2).AddressOfCodeOfForm.Column)
                                                    Else
                                                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Excel |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical + vbOKOnly + vbSystemModal, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                                                        Application.Quit
                                                End If
                                                '|fffd|020100[10,4]; -> 10,4];
                                                V_Work.Methodic = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "[") + 1)
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.CoorFrom.Row = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, ",") - 1))
                                                '10,4]; -> 4];
                                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.CoorFrom.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "]") - 1))
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                                Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Value = Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                            Else
                                                '10,4; -> 4;
                                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.CoorFrom.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, ";") - 1))
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                                Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Value = Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                        End If
                                    Else
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                        If Left$(V_Work.Methodic, 1) = "|fffd|" _
                                            Then
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_I2 = 1
                                                V_Work.SheetFrom = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "|fffd|") + 1, 6)
                                                Do While (V_DataSheets(V_I2).Code <> V_Work.SheetFrom) And (V_I2 < V_FormNumber)
                                                    V_I2 = V_I2 + 1
                                                Loop
                                                If V_DataSheets(V_I2).Code = V_Work.SheetFrom _
                                                    Then
                                                        V_Work.SheetFrom = Module_PrepearingName.GetSheetNameOnCode(V_FileName, V_Work.SheetFrom, V_DataSheets(V_I2).AddressOfCodeOfForm.Row, V_DataSheets(V_I2).AddressOfCodeOfForm.Column)
                                                    Else
                                                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Excel |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical + vbOKOnly + vbSystemModal, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                                                        Application.Quit
                                                End If
                                                '|fffd|020100[10,4]+...; -> 10,4]+...;
                                                V_Work.Methodic = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "[") + 1)
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.CoorFrom.Row = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, ",") - 1))
                                                '10,4]+...; -> 4]+...;
                                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.CoorFrom.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "]") - 1))
                                                '4]+...; -> +...;
                                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, "]"))
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.Variant = Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                            Else
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                                V_I2 = 1
                                                '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_SignPosition = 0
                                                
                                                '***** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| *****
                                                Do While (V_I2 <= Len(V_Work.Methodic)) And (V_SignPosition = 0)
                                                    If InStr("+-*/", Mid$(V_Work.Methodic, V_I2, 1)) <> 0 _
                                                        Then
                                                            V_SignPosition = V_I2
                                                    End If
                                                    V_I2 = V_I2 + 1
                                                Loop
                                                '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| *****
                                                
                                                '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                                If InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") <> 0 _
                                                    Then
                                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                        V_Work.CoorFrom.Column = CLng(Mid$(V_Work.Methodic, InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") + 1, V_SignPosition - InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") - 1))
                                                        '10,4+...; -> +...;
                                                        V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_SignPosition + 1)
                                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                        V_Work.Variant = Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                    Else
                                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                        V_Work.Variant = Left$(V_Work.Methodic, V_SignPosition - 1)
                                                        '4+...; -> +...;
                                                        V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_SignPosition + 1)
                                                End If
                                        End If
                                        
                                        '***** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                                        Do While Len(V_Work.Methodic) > 1
                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                            V_Sign = Left$(V_Work.Methodic, 1)
                                            '+...; -> ...;
                                            V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - 1)
                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                                            If Left$(V_Work.Methodic, 1) = "|fffd|" _
                                                Then
                                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                    V_Work.SheetFrom = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "|fffd|"), 6)
                                                    V_I2 = 1
                                                    Do While (V_DataSheets(V_I2).Code <> V_Work.SheetFrom) And (V_I2 < V_FormNumber)
                                                        V_I2 = V_I2 + 1
                                                    Loop
                                                    If V_DataSheets(V_I2).Code = V_Work.SheetFrom _
                                                        Then
                                                            V_Work.SheetFrom = Module_PrepearingName.GetSheetNameOnCode(V_FileName, V_Work.SheetFrom, V_DataSheets(V_I2).AddressOfCodeOfForm.Row, V_DataSheets(V_I2).AddressOfCodeOfForm.Column)
                                                        Else
                                                            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Excel |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical + vbOKOnly + vbSystemModal, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                                                            Application.Quit
                                                    End If
                                                    '|fffd|020100[10,4]+...; -> 10,4]+...;
                                                    V_Work.Methodic = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "[") + 1)
                                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                    V_Work.CoorFrom.Row = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, ",") - 1))
                                                    '10,4]+...; -> 4]+...;
                                                    V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                    V_Work.CoorFrom.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "]") - 1))
                                                    '4]+...; -> +...;
                                                    V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, "]"))
                                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                    Select Case V_Sign
                                                        Case "+"
                                                            V_Work.Variant = V_Work.Variant + Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                                        Case "-"
                                                            V_Work.Variant = V_Work.Variant - Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                                        Case "*"
                                                            V_Work.Variant = V_Work.Variant * Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                                        Case "/"
                                                            If Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value <> 0 _
                                                               Then
                                                                  V_Work.Variant = V_Work.Variant / Workbooks(V_FileName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                                               Else
                                                                  V_Work.Variant = 0
                                                            End If
                                                    End Select
                                                Else
                                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                                    V_I2 = 1
                                                    '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                    V_SignPosition = 0
                                                    
                                                    '****** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ******
                                                    Do While (V_I2 <= Len(V_Work.Methodic)) And (V_SignPosition = 0)
                                                        If InStr("+-*/;", Mid$(V_Work.Methodic, V_I2, 1)) <> 0 _
                                                            Then
                                                                V_SignPosition = V_I2
                                                        End If
                                                        V_I2 = V_I2 + 1
                                                    Loop
                                                    '****** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ******
                                                    
                                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                                    If InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") <> 0 _
                                                        Then
                                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                            V_Work.CoorFrom.Column = CLng(Mid$(V_Work.Methodic, InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") + 1, V_SignPosition - InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") - 1))
                                                            '10,4+...; -> +...;
                                                            V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_SignPosition + 1)
                                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                            Select Case V_Sign
                                                                Case "+"
                                                                    V_Work.Variant = V_Work.Variant + Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                                Case "-"
                                                                    V_Work.Variant = V_Work.Variant - Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                                Case "*"
                                                                    V_Work.Variant = V_Work.Variant * Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                                Case "/"
                                                                  If Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value <> 0 _
                                                                     Then
                                                                        V_Work.Variant = V_Work.Variant / Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                                     Else
                                                                        V_Work.Variant = 0
                                                                  End If
                                                            End Select
                                                        Else
                                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                            Select Case V_Sign
                                                                Case "+"
                                                                    V_Work.Variant = V_Work.Variant + Left$(V_Work.Methodic, V_SignPosition - 1)
                                                                Case "-"
                                                                    V_Work.Variant = V_Work.Variant - Left$(V_Work.Methodic, V_SignPosition - 1)
                                                                Case "*"
                                                                    V_Work.Variant = V_Work.Variant * Left$(V_Work.Methodic, V_SignPosition - 1)
                                                                Case "/"
                                                                     If Left$(V_Work.Methodic, V_SignPosition - 1) <> 0 _
                                                                        Then
                                                                           V_Work.Variant = V_Work.Variant / Left$(V_Work.Methodic, V_SignPosition - 1)
                                                                        Else
                                                                           V_Work.Variant = 0
                                                                     End If
                                                            End Select
                                                            '4+...; -> +...;
                                                            V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_I2 + 1)
                                                    End If
                                            End If
                                        Loop
                                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                                        
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                        Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Value = V_Work.Variant
                                End If
                        End If
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        .Row = .Row + 1
                    Loop
                    '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                
                End With
                '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
                
                '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Module_ProgressWindow.ChangeProgressBar
            Next V_I1
            '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
        Else
            If V_Work.ObjectCode = "" _
                Then
                    Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & V_FileName & ". |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." & _
                                " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
                    V_Key.AnalisCheck = False
            End If
    End If
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    V_Work.CoorTo.Row = V_Work.CoorTo.Row + 1
    Exit Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
E_SheetTo:
        Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & V_Work.Book & " |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| """ & V_Work.SheetTo & """. " & _
                    " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.  |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
        V_Key.AnalisCheck = False
        Exit Sub
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub SortAndSumAnalis(V_WorkBookName As String, V_BookColumnIndex As Long)
Dim V_I1 As Integer                                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer                                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_I3 As Integer                                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_CodeOfRegion As String                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_V As T_Object                                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_Coordinate As T_Coordinate                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_ObjectsLocal() As T_Object                '|fffd||fffd||fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ReDim V_ObjectsLocal(0 To V_FileNumber)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    V_ObjectsLocal = V_Objects
    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    For V_I1 = 1 To V_FileNumber
        For V_I2 = 1 To V_FileNumber - 1
            If V_ObjectsLocal(V_I2).CodeOfFinans > V_ObjectsLocal(V_I2 + 1).CodeOfFinans _
                Then
                    V_V.Address = V_ObjectsLocal(V_I2).Address
                    V_ObjectsLocal(V_I2).Address = V_ObjectsLocal(V_I2 + 1).Address
                    V_ObjectsLocal(V_I2 + 1).Address = V_V.Address
                    V_V.CodeOfFinans = V_ObjectsLocal(V_I2).CodeOfFinans
                    V_ObjectsLocal(V_I2).CodeOfFinans = V_ObjectsLocal(V_I2 + 1).CodeOfFinans
                    V_ObjectsLocal(V_I2 + 1).CodeOfFinans = V_V.CodeOfFinans
                    V_V.CodeOfRegion = V_ObjectsLocal(V_I2).CodeOfRegion
                    V_ObjectsLocal(V_I2).CodeOfRegion = V_ObjectsLocal(V_I2 + 1).CodeOfRegion
                    V_ObjectsLocal(V_I2 + 1).CodeOfRegion = V_V.CodeOfRegion
                    V_V.LocalCode = V_ObjectsLocal(V_I2).LocalCode
                    V_ObjectsLocal(V_I2).LocalCode = V_ObjectsLocal(V_I2 + 1).LocalCode
                    V_ObjectsLocal(V_I2 + 1).LocalCode = V_V.LocalCode
                    V_V.Name = V_ObjectsLocal(V_I2).Name
                    V_ObjectsLocal(V_I2).Name = V_ObjectsLocal(V_I2 + 1).Name
                    V_ObjectsLocal(V_I2 + 1).Name = V_V.Name
            End If
        Next V_I2
    Next V_I1
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    V_Coordinate.Row = Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B1").Value
    V_Coordinate.Column = Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B2").Value
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Workbooks(V_WorkBookName).Activate
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Sheets.Select
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Sheets(1).Activate
    
    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    For V_I1 = 1 To V_FileNumber
        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If V_ObjectsLocal(V_I1).Address.Row <> V_Coordinate.Row + V_I1 _
            Then
            '|fffd||fffd|
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Cells(V_Coordinate.Row + V_I1, 1).EntireRow.Select
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
                Selection.Cut
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Cells(V_ObjectsLocal(V_I1).Address.Row, 1).EntireRow.Select
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Selection.Insert Shift:=xlDown
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Cells(V_ObjectsLocal(V_I1).Address.Row, 1).EntireRow.Select
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
                Selection.Cut
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Cells(V_Coordinate.Row + V_I1, 1).EntireRow.Select
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Selection.Insert Shift:=xlDown
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_V.Address = V_ObjectsLocal(V_I1).Address
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                V_ObjectsLocal(V_I1).Address.Row = V_Coordinate.Row + V_I1
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                V_I2 = V_FileNumber
                
                '** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
                Do While V_ObjectsLocal(V_I2).Address.Row <> V_Coordinate.Row + V_I1
                    V_I2 = V_I2 - 1
                Loop
                '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                V_ObjectsLocal(V_I2).Address = V_V.Address
        End If
    Next V_I1
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    V_CodeOfRegion = ""
    V_I2 = 0
    V_Coordinate.Row = 0
    
    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    For V_I1 = 1 To V_FileNumber
        '** |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| **
        If V_CodeOfRegion <> V_ObjectsLocal(V_I1).CodeOfRegion _
            Then
                
                '*** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ***
                If V_Coordinate.Row <> 0 _
                    Then
                    '|fffd||fffd|
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        V_Work.CoorTo.Column = Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B2").Value - 1
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        V_Work.CoorTo.Row = V_Coordinate.Row
                        '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Module_PrepearingData.GetAnalisForRegion V_BookColumnIndex, V_CodeOfRegion, V_ObjectsLocal(V_I1).Address.Row + V_I2 - 1
                End If
                '***  |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_CodeOfRegion = V_ObjectsLocal(V_I1).CodeOfRegion
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Cells(V_ObjectsLocal(V_I1).Address.Row + V_I2, 1).EntireRow.Select
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                Selection.Insert Shift:=xlDown
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_Coordinate.Row = V_ObjectsLocal(V_I1).Address.Row + V_I2
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                V_I2 = V_I2 + 1
        End If
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
        
    Next V_I1
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *
    If V_Coordinate.Row <> 0 _
        Then
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Work.CoorTo.Column = Workbooks(V_ModelsBookName).Sheets(C_ParameterSheetName).Range("B2").Value - 1
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Work.CoorTo.Row = V_Coordinate.Row
            '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Module_PrepearingData.GetAnalisForRegion V_BookColumnIndex, V_CodeOfRegion, V_ObjectsLocal(V_FileNumber).Address.Row + V_I2
    End If
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Workbooks(V_ModelsBookName).Activate
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Function GetFormNumber() As Long
Dim V_Coordinate As T_Coordinate
'begin
    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    With V_Coordinate
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        V_Coordinate.Row = 2
        V_Coordinate.Column = 1
        
        '** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| **
        Do While Workbooks(V_ModelsBookName).Sheets(C_SettingsSheetName).Cells(.Row, .Column).Value <> ""
            V_Coordinate.Row = V_Coordinate.Row + 1
        Loop
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| **
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        GetFormNumber = V_Coordinate.Row - 2
    End With
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
End Function

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Function GetAnalisisBookNumber()
Dim V_Coordinate As T_Coordinate
'begin
    '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    With V_Coordinate
        '* |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
        V_Coordinate.Row = 2
        V_Coordinate.Column = 1
        
        '** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| **
        Do While Workbooks(V_ModelsBookName).Sheets(C_MethodicsSheetName).Cells(.Row, .Column).Value <> ""
            V_Coordinate.Column = V_Coordinate.Column + 1
        Loop
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| **
         
         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         GetAnalisisBookNumber = V_Coordinate.Column - 1
    End With
    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
End Function

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub GetAnalisForRegion(V_BookForAnalisColumnIndex As Long, V_RegionCode As String, V_RegionEnd As Long)
Dim V_I1 As Byte                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Byte                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_Sign As String                      '|fffd||fffd||fffd||fffd|
Dim V_SignPosition As Integer        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_Coordinate As T_Coordinate '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    On Error Resume Next
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    V_Work.ObjectCode = V_RegionCode
    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    V_Work.ObjectName = Module_PrepearingName.GetRegionName(V_RegionCode)
    With V_Coordinate
        .Column = V_BookForAnalisColumnIndex
        .Row = 2
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        V_Work.Book = Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .Row = .Row + 1
        '*** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
        Do While (Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value <> "") And (TypeName(Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value) <> "Double")
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            V_Work.Methodic = Workbooks(V_ModelsBookName).Worksheets(C_MethodicsSheetName).Cells(.Row, .Column).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
            If InStr(V_Work.Methodic, "=") = 0 _
                Then
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    V_Work.SheetTo = Left$(V_Work.Methodic, 6)
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    On Error GoTo E_SheetTo
                    Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).NumberFormat = "@"
                    Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Value = V_Work.ObjectCode
                    Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column - 1).Value = V_Work.ObjectName
                    On Error GoTo 0
                Else
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    '0901001,1=|fffd|020100[10,4]; -> 1=|fffd|020100[10,4];
                    V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    V_Work.OffsetTo.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "=") - 1))
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                    '1=|fffd|020100[10,4]; -> |fffd|020100[10,4];
                    V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, "="))
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    If (InStr(V_Work.Methodic, "+") = 0) And (InStr(V_Work.Methodic, "-") = 0) And (InStr(V_Work.Methodic, "*") = 0) And (InStr(V_Work.Methodic, "/") = 0) _
                        Then
                        '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Value = "=SUM(" & Cells(V_Work.CoorTo.Row + 1, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Address(False, False) & ":" & Cells(V_RegionEnd, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Address(False, False) & ")"
                        Else
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            If Left$(V_Work.Methodic, 1) = "|fffd|" _
                                Then
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_I2 = 1
                                    V_Work.SheetFrom = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "|fffd|") + 1, 6)
                                    Do While (V_DataSheets(V_I2).Code <> V_Work.SheetFrom) And (V_I2 < V_FormNumber)
                                        V_I2 = V_I2 + 1
                                    Loop
                                    If V_DataSheets(V_I2).Code = V_Work.SheetFrom _
                                        Then
                                            V_Work.SheetFrom = Module_PrepearingName.GetSheetNameOnCode(V_ModelsBookName, V_Work.SheetFrom, V_DataSheets(V_I2).AddressOfCodeOfForm.Row, V_DataSheets(V_I2).AddressOfCodeOfForm.Column)
                                        Else
                                            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Excel |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical + vbOKOnly + vbSystemModal, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                                            Application.Quit
                                    End If
                                    '|fffd|020100[10,4]+...; -> 10,4]+...;
                                    V_Work.Methodic = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "[") + 1)
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_Work.CoorFrom.Row = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, ",") - 1))
                                    '10,4]+...; -> 4]+...;
                                    V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_Work.CoorFrom.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "]") - 1))
                                    '4]+...; -> +...;
                                    V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, "]"))
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_Work.Variant = Workbooks(V_ModelsBookName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                Else
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                    V_I2 = 1
                                    '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    V_SignPosition = 0
                                    '**** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ****
                                    Do While (V_I2 <= Len(V_Work.Methodic)) And (V_SignPosition = 0)
                                        If InStr("+-*/", Mid$(V_Work.Methodic, V_I2, 1)) <> 0 _
                                            Then
                                                V_SignPosition = V_I2
                                        End If
                                        V_I2 = V_I2 + 1
                                    Loop
                                    '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ****
                                    
                                    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                    If InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") <> 0 _
                                        Then
                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                            V_Work.CoorFrom.Column = CLng(Mid$(V_Work.Methodic, InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") + 1, V_SignPosition - InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") - 1))
                                            '10,4+...; -> +...;
                                            V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_SignPosition + 1)
                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                            V_Work.Variant = Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                        Else
                                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                            V_Work.Variant = Left$(V_Work.Methodic, V_SignPosition - 1)
                                            '4+...; -> +...;
                                            V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_SignPosition + 1)
                                    End If
                            End If
                            
                            '**** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                            Do While Len(V_Work.Methodic) > 1
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                V_Sign = Left$(V_Work.Methodic, 1)
                                '+...; -> ...;
                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - 1)
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                                If Left$(V_Work.Methodic, 1) = "|fffd|" _
                                    Then
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                        V_Work.SheetFrom = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "|fffd|"), 6)
                                        V_I2 = 1
                                        Do While (V_DataSheets(V_I2).Code <> V_Work.SheetFrom) And (V_I2 < V_FormNumber)
                                            V_I2 = V_I2 + 1
                                        Loop
                                        If V_DataSheets(V_I2).Code = V_Work.SheetFrom _
                                            Then
                                                V_Work.SheetFrom = Module_PrepearingName.GetSheetNameOnCode(V_ModelsBookName, V_Work.SheetFrom, V_DataSheets(V_I2).AddressOfCodeOfForm.Row, V_DataSheets(V_I2).AddressOfCodeOfForm.Column)
                                            Else
                                                MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Excel |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical + vbOKOnly + vbSystemModal, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                                                Application.Quit
                                        End If
                                        '|fffd|020100[10,4]+...; -> 10,4]+...;
                                        V_Work.Methodic = Mid$(V_Work.Methodic, InStr(V_Work.Methodic, "[") + 1)
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                        V_Work.CoorFrom.Row = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, ",") - 1))
                                        '10,4]+...; -> 4]+...;
                                        V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, ","))
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                        V_Work.CoorFrom.Column = CLng(Left$(V_Work.Methodic, InStr(V_Work.Methodic, "]") - 1))
                                        '4]+...; -> +...;
                                        V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - InStr(V_Work.Methodic, "]"))
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                        Select Case V_Sign
                                            Case "+"
                                                V_Work.Variant = V_Work.Variant + Workbooks(V_ModelsBookName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                            Case "-"
                                                V_Work.Variant = V_Work.Variant - Workbooks(V_ModelsBookName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                            Case "*"
                                                V_Work.Variant = V_Work.Variant * Workbooks(V_ModelsBookName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                            Case "/"
                                                If Workbooks(V_ModelsBookName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value <> 0 _
                                                   Then
                                                      V_Work.Variant = V_Work.Variant / Workbooks(V_ModelsBookName).Worksheets(V_Work.SheetFrom).Cells(V_Work.CoorFrom.Row, V_Work.CoorFrom.Column).Value
                                                   Else
                                                      V_Work.Variant = 0
                                                End If
                                        End Select
                                    Else
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                        V_I2 = 1
                                        '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                        V_SignPosition = 0
                                        
                                        '***** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| *****
                                        Do While (V_I2 <= Len(V_Work.Methodic)) And (V_SignPosition = 0)
                                            If InStr("+-*/;", Mid$(V_Work.Methodic, V_I2, 1)) <> 0 _
                                                Then
                                                    V_SignPosition = V_I2
                                            End If
                                            V_I2 = V_I2 + 1
                                        Loop
                                        '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| *****
                                        
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                        If InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") <> 0 _
                                            Then
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                V_Work.CoorFrom.Column = CLng(Mid$(V_Work.Methodic, InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") + 1, V_SignPosition - InStr(Left$(V_Work.Methodic, V_SignPosition - 1), ",") - 1))
                                                '10,4+...; -> +...;
                                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_SignPosition + 1)
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                Select Case V_Sign
                                                    Case "+"
                                                        V_Work.Variant = V_Work.Variant + Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                    Case "-"
                                                        V_Work.Variant = V_Work.Variant - Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                    Case "*"
                                                        V_Work.Variant = V_Work.Variant * Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                    Case "/"
                                                      If Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value <> 0 _
                                                         Then
                                                            V_Work.Variant = V_Work.Variant / Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.CoorFrom.Column).Value
                                                         Else
                                                            V_Work.Variant = 0
                                                      End If
                                                End Select
                                            Else
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                Select Case V_Sign
                                                    Case "+"
                                                        V_Work.Variant = V_Work.Variant + Left$(V_Work.Methodic, V_SignPosition - 1)
                                                    Case "-"
                                                        V_Work.Variant = V_Work.Variant - Left$(V_Work.Methodic, V_SignPosition - 1)
                                                    Case "*"
                                                        V_Work.Variant = V_Work.Variant * Left$(V_Work.Methodic, V_SignPosition - 1)
                                                    Case "/"
                                                         If Left$(V_Work.Methodic, V_SignPosition - 1) <> 0 _
                                                            Then
                                                               V_Work.Variant = V_Work.Variant / Left$(V_Work.Methodic, V_SignPosition - 1)
                                                            Else
                                                               V_Work.Variant = 0
                                                         End If
                                                End Select
                                                '4+...; -> +...;
                                                V_Work.Methodic = Right$(V_Work.Methodic, Len(V_Work.Methodic) - V_I2 + 1)
                                        End If
                                End If
                            Loop
                            '**** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ****
                            
                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                            Workbooks(V_Work.Book).Worksheets(V_Work.SheetTo).Cells(V_Work.CoorTo.Row, V_Work.CoorTo.Column).Offset(0, V_Work.OffsetTo.Column).Value = V_Work.Variant
                    End If
            End If
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            .Row = .Row + 1
        Loop
        '*** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ***
    
    End With
    '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| **
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    V_Work.CoorTo.Row = V_Work.CoorTo.Row + 1
    
    Exit Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
E_SheetTo:
        Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & V_Work.Book & " |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| """ & V_Work.SheetTo & """. " & _
                    " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.  |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
        V_Key.AnalisCheck = False
        Exit Sub
End Sub


Attribute VB_Name = "Module_PrepearingName"
Option Explicit

Function NameForConsolidation(V_FullName As String, V_ShortName As String, V_SheetName As String, V_TopLeft As String, V_BottomRight As String) As String
'begin
    NameForConsolidation = "'" & Left$(V_FullName, Len(V_FullName) - Len(V_ShortName)) & "[" & V_ShortName & "]" & V_SheetName & "'!" & _
                                            V_TopLeft & ":" & V_BottomRight
End Function

Sub GetCodeAndName(V_LocalCode As String, V_Name As String, Optional V_CodeOfFinance As Integer, Optional V_CodeOfRegion As String)
'Sub GetCodeAndName(V_LocalCode As String, V_Name, Optional V_CodeOfFinance, Optional V_CodeOfRegion)
Dim V_Coordinate As T_Coordinate
'begin
    '* |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
    With V_Coordinate
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .Column = 2
        .Row = 2
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        On Error GoTo E_Dictionary
        
        '** |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| **
        Do While (Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(.Row, .Column).Value <> V_LocalCode) And (Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(.Row, .Column).Value <> "")
            .Row = .Row + 1
        Loop
        '** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| **
        
        '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        On Error GoTo 0
        
        If Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(.Row, .Column).Value = V_LocalCode _
            Then
                V_CodeOfFinance = CInt(Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(.Row, 5).Value)
                V_CodeOfRegion = Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(.Row, 3).Value
                V_Name = Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(.Row, 6).Value
            Else
                V_CodeOfFinance = 0
                V_CodeOfRegion = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
                V_Name = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
        End If
    End With
    '*|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *

Exit Sub
E_Dictionary:
    V_CodeOfFinance = 0
    V_CodeOfRegion = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|""."
    V_Name = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|""."
End Sub

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
Function GetRegionName(V_CodeOfRegion As String) As String
Dim V_Coordinate As T_Coordinate
'begin
    With V_Coordinate
        .Column = 1
        .Row = 2
        On Error GoTo E_Dictionary
        Do While (Workbooks(V_ModelsBookName).Sheets("EK_RN").Cells(.Row, .Column).Value <> V_CodeOfRegion) And (Workbooks(V_ModelsBookName).Sheets("EK_RN").Cells(.Row, .Column).Value <> "")
            .Row = .Row + 1
        Loop
        On Error GoTo 0
        If Workbooks(V_ModelsBookName).Sheets("EK_RN").Cells(.Row, .Column).Value = V_CodeOfRegion _
            Then
                GetRegionName = Workbooks(V_ModelsBookName).Sheets("EK_RN").Cells(.Row, 2).Value
            Else
                GetRegionName = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
        End If
    End With
Exit Function
E_Dictionary:
    GetRegionName = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""EK_RN""."
End Function

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| V_BookName |fffd| |fffd||fffd||fffd||fffd||fffd| V_SheetsCode |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| V_RowOfFormCode, V_ColumnOfFormCode
Function GetSheetNameOnCode(V_BookName As String, V_SheetsCode As String, V_RowOfFormCode As Long, V_ColumnOfFormCode As Long) As String
Dim V_I1 As Long
'begin
    V_I1 = 1
    Do While (Workbooks(V_BookName).Sheets(V_I1).Cells(V_RowOfFormCode, V_ColumnOfFormCode).Value <> V_SheetsCode) And (V_I1 < Workbooks(V_BookName).Sheets.Count)
        V_I1 = V_I1 + 1
    Loop
    If Workbooks(V_BookName).Sheets(V_I1).Cells(V_RowOfFormCode, V_ColumnOfFormCode).Value = V_SheetsCode _
        Then
            GetSheetNameOnCode = Workbooks(V_BookName).Sheets(V_I1).Name
        Else
            GetSheetNameOnCode = ""
    End If
End Function

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| V_BookName |fffd| |fffd||fffd||fffd||fffd||fffd| V_SheetsCode |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| V_RowOfCode, V_ColumnOfCode
Function GetObjectCode(V_BookName As String, V_SheetsName As String, V_RowOfCode As Long, V_ColumnOfCode As Long) As String
'begin
    GetObjectCode = Workbooks(V_BookName).Sheets(V_SheetsName).Cells(V_RowOfCode, V_ColumnOfCode).Value
End Function
Attribute VB_Name = "Module_ProgressWindow"
Option Explicit

Sub PrintErrorString(V_S1 As String)
Dim V_SheetNameLocal As String              '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_CurrentBookNameLocal As String    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    V_CurrentBookNameLocal = ActiveWorkbook.Name
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Workbooks(V_ModelsBookName).Activate
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    V_SheetNameLocal = ActiveSheet.Name
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets(C_ErrorSheetName).Select
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveCell.Value = V_S1
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveCell.WrapText = True
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    ActiveCell.Offset(1, 0).Select
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Worksheets(V_SheetNameLocal).Select
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Workbooks(V_CurrentBookNameLocal).Activate
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.TextBox_MessageWindow.Value = UserForm_ProgressWindow.TextBox_MessageWindow.Value + V_S1 + Chr(13)
'
'    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'    Module_ProgressWindow.Reload
    
End Sub

Sub PrintString(V_S1 As String)
'begin
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.TextBox_MessageWindow.Value = UserForm_ProgressWindow.TextBox_MessageWindow.Value + V_S1 + Chr(13)
'
'    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'    Module_ProgressWindow.Reload
'
End Sub

Sub Initialize()
'begin
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'    Load UserForm_ProgressWindow
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.ProgressBar_Process.Min = 0
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.ProgressBar_Process.Value = UserForm_ProgressWindow.ProgressBar_Process.Min
'    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
'    UserForm_ProgressWindow.CommandButton_OK.Enabled = False
'
'    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." & Chr(13)
'
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.Show
End Sub

Sub InitializeProgressBar(V_NumberOfRepeating As Long)
'begin
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.ProgressBar_Process.Max = V_NumberOfRepeating
End Sub

Sub ChangeProgressBar()
'begin
'
'    '* |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
'    If UserForm_ProgressWindow.ProgressBar_Process.Value + 1 <= UserForm_ProgressWindow.ProgressBar_Process.Max _
'        Then
'        '|fffd||fffd|
'            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            UserForm_ProgressWindow.ProgressBar_Process.Value = UserForm_ProgressWindow.ProgressBar_Process.Value + 1
'        Else
'        '|fffd||fffd||fffd||fffd||fffd|
'            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            UserForm_ProgressWindow.ProgressBar_Process.Value = UserForm_ProgressWindow.ProgressBar_Process.Min
'    End If
'    '* |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| *
'
End Sub

Sub PrepeareForClose()
'begin
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    UserForm_ProgressWindow.ProgressBar_Process.Value = UserForm_ProgressWindow.ProgressBar_Process.Max
'
'    '|-> |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
'
'    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
'    UserForm_ProgressWindow.CommandButton_OK.Enabled = True
End Sub

Sub Reload()
'begin
'Dim V_ProgressBarMax As Long
'Dim V_ProgressBarMin As Long
'Dim V_ProgressBarValue As Long
'Dim V_MessageWindowValue As String
''begin
'    V_ProgressBarMin = UserForm_ProgressWindow.ProgressBar_Process.Min
'    V_ProgressBarMax = UserForm_ProgressWindow.ProgressBar_Process.Max
'    V_ProgressBarValue = UserForm_ProgressWindow.ProgressBar_Process.Value
'    V_MessageWindowValue = UserForm_ProgressWindow.TextBox_MessageWindow.Value
'    Unload UserForm_ProgressWindow
'    Load UserForm_ProgressWindow
'    UserForm_ProgressWindow.ProgressBar_Process.Min = V_ProgressBarMin
'    UserForm_ProgressWindow.ProgressBar_Process.Max = V_ProgressBarMax
'    UserForm_ProgressWindow.ProgressBar_Process.Value = V_ProgressBarValue
'    UserForm_ProgressWindow.TextBox_MessageWindow.Value = V_MessageWindowValue
'    UserForm_ProgressWindow.Show
'    UserForm_ProgressWindow.Repaint
End Sub
Attribute VB_Name = "Module_Sheets"
Option Explicit

Public Sub ProtectSheetsIn(V_BookName As String)
Dim V_I1 As Integer     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    Workbooks(V_BookName).Protect Structure:=True, Windows:=False
    For V_I1 = 1 To Workbooks(V_BookName).Sheets.Count
        If Workbooks(V_BookName).Sheets(V_I1).Cells(1, 1).Value <> "*" _
            Then
                Workbooks(V_BookName).Worksheets(V_I1).Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
        End If
    Next V_I1
End Sub

Public Sub UnprotectSheetsIn(V_BookName As String)
Dim V_I1 As Integer     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    Workbooks(V_BookName).Unprotect
    For V_I1 = 1 To Workbooks(V_BookName).Sheets.Count
        Workbooks(V_BookName).Worksheets(V_I1).Unprotect
    Next V_I1
End Sub

Public Sub ShowAllSheets()
Dim V_I1 As Integer     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    ActiveWorkbook.Unprotect
    For V_I1 = 1 To ActiveWorkbook.Sheets.Count
        Worksheets(V_I1).Visible = True
    Next V_I1
End Sub

Public Sub ProtectSheets()
Dim V_I1 As Integer     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    ActiveWorkbook.Protect Structure:=True, Windows:=False
    For V_I1 = 1 To ActiveWorkbook.Sheets.Count
        If ActiveWorkbook.Sheets(V_I1).Cells(1, 1).Value <> "*" _
        Then
            Worksheets(V_I1).Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
        End If
    Next V_I1
End Sub

Public Sub UnprotectSheets()
Dim V_I1 As Integer     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    ActiveWorkbook.Unprotect
    For V_I1 = 1 To ActiveWorkbook.Sheets.Count
        Worksheets(V_I1).Unprotect
    Next V_I1
End Sub

Attribute VB_Name = "Module_Start"
Option Explicit

Sub StartWork()
Dim V_I1 As Long             '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer             '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I3 As Integer             '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_Range                         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_Ranges                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_Sourses() As String     '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim V_BookPath As String      '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
'begin
    
    V_ObjectName = Worksheets(C_OpenSheetName).Range("A8").Value
    V_ObjectCode = Worksheets(C_OpenSheetName).Range("C1").Value
    
    If V_ObjectName <> "" _
        Then
           
           
           Module_Exclusion.Initialize
           
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
           V_CurrentBookName = ActiveWorkbook.Name
           
'           Workbooks.Open V_ModelsBookName, False, False
           
           V_ModelsBookName = ActiveWorkbook.Name
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           Application.ScreenUpdating = False
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           Module_Sheets.UnprotectSheetsIn (V_ModelsBookName)
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
           V_FormNumber = Module_PrepearingData.GetFormNumber
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           V_BookForAnalisNumber = Module_PrepearingData.GetAnalisisBookNumber
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           On Error GoTo E_ErrorSheet
           Workbooks(V_ModelsBookName).Worksheets(C_ErrorSheetName).Cells.Clear
           On Error GoTo 0
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|1
           Workbooks(V_ModelsBookName).Worksheets(C_ErrorSheetName).Select
           Cells(1, 1).Select
           On Error GoTo E_SettingSheet
           '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           Workbooks(V_ModelsBookName).Sheets(C_SettingsSheetName).Visible = True
'           On Error GoTo E_DictionarySheet
'           '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'           Workbooks(V_ModelsBookName).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
'           On Error GoTo E_EK_RNSheet
'           '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'           Workbooks(V_ModelsBookName).Sheets("EK_RN").Visible = True
           On Error GoTo 0
        
           Module_ProgressWindow.Initialize
               
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           Application.ScreenUpdating = False
           
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           If Module_Files.OpenFilesForWork _
               Then
                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                   Workbooks(V_ModelsBookName).Activate
                   '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                   If V_FilesWithError <> 0 _
                       Then
                       '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                           Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & V_FileNumber & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & _
                                                                                           V_FilesWithError & "." & Chr(13) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!!!"
                           Worksheets(C_ErrorSheetName).Select
                       Else
                       '|fffd||fffd||fffd||fffd||fffd|
                                               
                           '***** |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                               Application.ScreenUpdating = False
                               '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                               If V_Key.AnalisInitialize _
                                   Then
                                       If V_Key.AnalisCheck _
                                           Then
                                               '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                   Module_ProgressWindow.PrintString "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." & Chr(13) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|."
                                               Else
                                               '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                   Module_ProgressWindow.PrintErrorString "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. " & Chr(13) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|."
                                       End If
                                   Else
                                       Module_ProgressWindow.PrintString "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." & Chr(13) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|."
                               End If
                               '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                               For V_I1 = 1 To V_FormNumber
                                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                   Worksheets(Module_PrepearingName.GetSheetNameOnCode(V_ModelsBookName, V_DataSheets(V_I1).Code, V_DataSheets(V_I1).AddressOfCodeOfForm.Row, V_DataSheets(V_I1).AddressOfCodeOfForm.Column)).Select
                                   ' Cells(V_DataSheets(V_I1).AddressOfCodeOfObject.Row, V_DataSheets(V_I1).AddressOfCodeOfObject.Column).Value = V_ObjectCode
                                   '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                                   For V_I2 = 1 To V_DataSheets(V_I1).TablesCount
                                       ReDim V_Sourses(1 To V_FileNumber)
                                       '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                       For V_I3 = 1 To V_FileNumber
                                           V_Sourses(V_I3) = V_DataSheets(V_I1).Tables(V_I2).UniteText(V_I3)
                                           Module_ProgressWindow.ChangeProgressBar
                                       Next V_I3
                                       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                       Range(Cells(V_DataSheets(V_I1).Tables(V_I2).TopLeft.Row, V_DataSheets(V_I1).Tables(V_I2).TopLeft.Column), Cells(V_DataSheets(V_I1).Tables(V_I2).BottomRight.Row, V_DataSheets(V_I1).Tables(V_I2).BottomRight.Column)).Select
                                       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                       Selection.Consolidate Sources:=Array(V_Sourses), Function:=xlSum
                                       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                       Set V_Ranges = Range(Cells(V_DataSheets(V_I1).Tables(V_I2).TopLeft.Row, V_DataSheets(V_I1).Tables(V_I2).TopLeft.Column), Cells(V_DataSheets(V_I1).Tables(V_I2).BottomRight.Row, V_DataSheets(V_I1).Tables(V_I2).BottomRight.Column))
                                       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                       For Each V_Range In V_Ranges
                                           V_Range.Select
                                           If Selection.Locked _
                                               Then
                                                   If Left$(ActiveCell.Formula, 1) <> "=" _
                                                       Then
                                                           ActiveCell.Value = "|fffd|"
                                                        Else
                                                            ActiveCell.Formula = ActiveCell.Formula
                                                   End If
                                           End If
                                       Next
                                   Next V_I2
                                   
                                   Module_Exclusion.ForSvod V_ModelsBookName, ActiveSheet.Name, V_DataSheets(V_I1).Code
                               
                                   Module_ProgressWindow.ChangeProgressBar
                               Next V_I1
                           '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| *****
                           
                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                           Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & V_FileNumber & "."
                   End If
                           
                   '***** |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *****
                   
                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'+++++++++++++++++++++
'                   V_BookPath = Workbooks(V_CurrentBookName).Sheets("Settings").Cells(2, 2).Value
'+++++++++++++++++++++
                   
                   V_BookPath = Workbooks(V_CurrentBookName).Path
                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                   FileSystem.ChDir V_BookPath
                   '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                   If V_Key.AnalisCheck _
                       Then
                       '|fffd||fffd|
                           Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|..."
                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                           V_Work.CoorTo.Column = Sheets(C_ParameterSheetName).Range("B2").Value - 1
                           V_Work.CoorTo.Row = Sheets(C_ParameterSheetName).Range("B1").Value
                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                           Module_PrepearingData.GetAnalis V_ModelsBookName, V_ObjectName
                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                           For V_I1 = 1 To V_BookForAnalisNumber
                               Module_PrepearingData.SortAndSumAnalis Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value, V_I1
                               On Error Resume Next
                               FileSystem.Kill Left$(Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value, Len(Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value) - 4) & "_" & Left$(V_ObjectName, 20) & ".xls"
                               On Error GoTo 0
                               Workbooks(Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value).SaveAs Left$(Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value, Len(Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value) - 4) & "_" & Left$(V_ObjectName, 20) & ".xls"
                               Module_ProgressWindow.ChangeProgressBar
                           Next V_I1
                       Else
                       '|fffd||fffd||fffd||fffd||fffd|
                           If V_Key.AnalisInitialize _
                               Then
                                   '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
                                   For V_I1 = 1 To V_BookForAnalisNumber
                                       On Error Resume Next
                                       Workbooks(Worksheets(C_MethodicsSheetName).Cells(2, V_I1).Value).Close SaveChanges:=False
                                       On Error GoTo 0
                                       Module_ProgressWindow.ChangeProgressBar
                                   Next V_I1
                           End If
                   End If
                   '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,
                   If V_FilesWithError = 0 _
                       Then
                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                           On Error Resume Next
                           FileSystem.Kill Left(V_ModelsBookName, Len(V_ModelsBookName) - 4) & "_" & Left$(V_ObjectName, 20) & ".xls"
                           On Error GoTo 0
                           ActiveWorkbook.SaveAs Left(V_ModelsBookName, Len(V_ModelsBookName) - 4) & "_" & Left$(V_ObjectName, 20) & ".xls"
                           Module_ProgressWindow.PrintString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
                   End If
                   V_ModelsBookName = ActiveWorkbook.Name
                   '***** |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| *****
           End If
           
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           Worksheets(C_ErrorSheetName).Select
           On Error Resume Next
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           Sheets(C_SettingsSheetName).Visible = False
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           Sheets(C_SettingsAnalisSheetName).Visible = False
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           Sheets(C_MethodicsSheetName).Visible = False
           On Error Resume Next
           Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| DOS").Visible = False
           Sheets(C_ParameterSheetName).Visible = False
           Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
           Sheets("EK_RN").Visible = False
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
           Module_Sheets.ProtectSheetsIn (V_ModelsBookName)
           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
           Application.ScreenUpdating = True
           
           Module_ProgressWindow.PrepeareForClose
        Else
            MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|.", vbApplicationModal + vbCritical + vbOKOnly, "|fffd||fffd||fffd||fffd||fffd||fffd|!"
            Sheets(C_OpenSheetName).Select
            Range("A8").Select
    End If
    Exit Sub
    

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
E_SettingSheet:
        Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| """ & C_SettingsSheetName & """. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " & _
                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
        Workbooks(V_CurrentBookName).Close False
        Exit Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
E_ErrorSheet:
    Worksheets(C_ErrorSheetName).Add
    Resume

E_DictionarySheet:
        Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " & _
                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
        Workbooks(V_CurrentBookName).Close False
        Exit Sub
    
E_EK_RNSheet:
        Module_ProgressWindow.PrintErrorString "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""EK_RN"". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " & _
                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
        Workbooks(V_CurrentBookName).Close False
        Exit Sub

End Sub
Attribute VB_Name = "Module_Transform"
Option Explicit

Function TransformMethodics(V_String As String) As String
Dim V_Coordinate As T_Coordinate
Dim V_I1 As Integer                                 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_I2 As Integer                                 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim V_AddressFrom As T_Coordinate
Dim V_SheetFrom As String
Dim V_NewString As String
Dim V_Timer As Date
Dim V_FindSheetName As String
'begin
    Application.ScreenUpdating = False
    V_ModelsBookName = ActiveWorkbook.Name
    V_FormNumber = Module_PrepearingData.GetFormNumber
    V_Timer = Now()
    V_NewString = ""
    If InStr(V_String, "[") = 0 _
        Then
            TransformMethodics = V_String
        Else
            On Error GoTo E_GetData
            If V_DataSheetsForAnalis(1).Code _
                Then
            End If
            On Error GoTo 0
            Do While InStr(V_String, "]") <> 0
                V_SheetFrom = Mid$(V_String, InStr(V_String, "[") - 6, 6)
                V_NewString = V_NewString + Left$(V_String, InStr(V_String, "["))
                V_String = Right$(V_String, Len(V_String) - InStr(V_String, "["))
                V_AddressFrom.Row = CLng(Left$(V_String, InStr(V_String, ",") - 1))
                V_String = Right$(V_String, Len(V_String) - InStr(V_String, ","))
                V_AddressFrom.Column = CLng(Left$(V_String, InStr(V_String, "]") - 1))
                V_String = Right$(V_String, Len(V_String) - InStr(V_String, "]"))
                V_I1 = 1
                Do While (V_DataSheetsForAnalis(V_I1).Code <> V_SheetFrom) And (V_I1 <= V_FormNumber)
                    V_I1 = V_I1 + 1
                Loop
                With V_DataSheetsForAnalis(V_I1)
                    If .Code = V_SheetFrom _
                        Then
                            V_FindSheetName = Module_PrepearingName.GetSheetNameOnCode(V_ModelsBookName, .Code, .AddressOfCodeOfForm.Row, .AddressOfCodeOfForm.Column)
                            V_Key.Check = False
                            V_I2 = 1
                            Do While (Not V_Key.Check) And (V_I2 <= .TablesCount)
                                If Now() - V_Timer > 0.001 _
                                    Then
                                        TransformMethodics = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                                        Exit Function
                                End If
                                V_Coordinate.Row = .Tables(V_I2).TopLeft.Row - 1
                                V_Coordinate.Column = .Tables(V_I2).TopLeft.Column - .Tables(V_I2).dS
                                Do While (V_Coordinate.Row <= .Tables(V_I2).BottomRight.Row) And (Worksheets(V_FindSheetName).Cells(V_Coordinate.Row, V_Coordinate.Column).Value <> V_AddressFrom.Row)
                                    V_Coordinate.Row = V_Coordinate.Row + 1
                                Loop
                                If Worksheets(V_FindSheetName).Cells(V_Coordinate.Row, V_Coordinate.Column).Value = V_AddressFrom.Row _
                                    Then
                                        Do While (V_Coordinate.Column <= .Tables(V_I2).BottomRight.Column) And (Worksheets(V_FindSheetName).Cells(.Tables(V_I2).TopLeft.Row - 1, V_Coordinate.Column).Value <> V_AddressFrom.Column)
                                            V_Coordinate.Column = V_Coordinate.Column + 1
                                        Loop
                                        If Worksheets(V_FindSheetName).Cells(.Tables(V_I2).TopLeft.Row - 1, V_Coordinate.Column).Value = V_AddressFrom.Column _
                                            Then
                                                V_NewString = V_NewString & CStr(V_Coordinate.Row) & "," & CStr(V_Coordinate.Column) & "]"
                                                V_Key.Check = True
                                            Else
                                                V_NewString = V_NewString & "|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|" & "]"
                                                V_Key.Check = True
                                        End If
                                End If
                                V_I2 = V_I2 + 1
                            Loop
                            If (V_I2 > .TablesCount) And Not (V_Key.Check) _
                                Then
                                    V_NewString = V_NewString & "|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|" & "]"
                            End If
                        Else
                            V_NewString = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & V_SheetFrom & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                End With
            Loop
            TransformMethodics = V_NewString & ";"
    End If
    Exit Function
E_GetData:
    Module_PrepearingData.GetTablesDataForAnalis (V_FormNumber)
Resume Next
End Function
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

    StartWork

End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True














Attribute VB_Name = "|fffd||fffd||fffd||fffd|28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|76"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True







Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
For i = Sheets.Count To 1 Step -1
    Sheets(i).Protect
Next i
End Sub


INQUEST-PP=macro
