Attribute VB_Name = "ModReg"
Public Declare Function RegOpenKey Lib "advapi32.dll" Alias "RegOpenKeyA" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long
Public Declare Function RegQueryValueEx Lib "advapi32.dll" Alias "RegQueryValueExA" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.

Public Function GetRegistrValue() As String
Dim lReturn As Long
Dim shKey As String, sSubKey As String, hKey As Long
Dim hSubKeyHandle As Long
Dim sValue As String
Dim sPar As String
Dim strSetting As String
Dim lngDataLen As Long

hKey = &H80000002   'Case "HKEY_LOCAL_MACHINE"
sSubKey = "SOFTWARE\Rassvet\Aksiok\Vfp9\VSvod"
sPar = "ProgramXls"
    
lReturn = RegOpenKey(hKey, sSubKey, hSubKeyHandle)
If lReturn <> 0 Then Exit Function
strSetting = Space(255)
lngDataLen = Len(strSetting)
lReturn = RegQueryValueEx(hSubKeyHandle, sPar, ByVal 0, REG_EXPAND_SZ, ByVal strSetting, lngDataLen)
If strSetting = Space(255) Then GetRegistrValue = "": Exit Function     '"C:\Aksiok\Prg\VSvod\Xlt\"
If lngDataLen > 1 Then sValue = Left(strSetting, lngDataLen - 1)
GetRegistrValue = sValue
End Function


Attribute VB_Name = "frmAddRow"
Attribute VB_Base = "0{8B4D6F6F-1DE9-4980-B84D-9DCB5557B02A}{74B6E426-4C5D-4D45-B81C-40FF47D92D89}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False









Option Explicit
''''''''''''''''''''''''''''''''''''''''''''
'**** Version 28.07.2005 *******************
''''''''''''''''''''''''''''''''''''''''''''


Public ObjectName As String
Public IsUnload As Boolean


Public Property Set ObjectDataSprav(NewObject As Object)
        
    Dim objData As Object
    Dim i As Long
    Dim ctl As Control
    Dim obj As Object
    Dim objCol As Object
    Dim iLblLeft As Long
    Dim iLblWidth As Integer
    Dim cKodR, cNameR, cDataR As String
    Dim lEmpty As Boolean
    Dim iVal As Long
    
    On Error GoTo errHandler
    
    Me.IsUnload = False
    
    iLblLeft = 5
    iLblWidth = 65
'    cKod = "Kod_"
'    cName = "Name_"
'    cData = "Data_"
    
    Set objData = NewObject
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    For Each ctl In Me.Controls
        If TypeName(ctl) <> "CommandButton" Then
            ctl.Visible = False
        End If
    Next ctl
    
    With objData
        Me.Caption = .cName
        Me.Height = .iHeight
        Me.Width = .iWidth
        
        With .SpravCollection
            If .Count > 0 Then
                For i = 1 To .Count
                    With .Item(Val(i))
                        cDataR = cData & .cSprav
                        cKodR = cKod & .cSprav
                        cNameR = cName & .cSprav
                        
                        Select Case .cControl
                            Case "cmbBSR"
                                lblBSR.Visible = True
                                lblBSR.Caption = Trim(.cName)
                                lblBSR.Height = .iLblHeight
                                lblBSR.Width = .iLblWidth
                                lblBSR.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblBSR.Top = .iTop
                                cmbBSR.Visible = True
                                cmbBSR.Tag = Trim(.cSprav)
                                cmbBSR.Height = .iHeight
                                cmbBSR.Width = .iWidth
                                cmbBSR.Left = Me.Width - .iWidth - iLblLeft
                                cmbBSR.Top = .iTop
                                cmbBSR.RowSource = cDataR
                                cmbBSR.ColumnCount = .iColCount
                                cmbBSR.ColumnWidths = .cColWidths
                                
                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                lEmpty = EmptySpr(cDataR)
                                If lEmpty = True Then
                                    cmbBSR.Enabled = False
                                Else
                                    cmbBSR.Enabled = True
                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        cmbBSR.ListIndex = 0
                                    Else
                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
                                        cmbBSR.ListIndex = iVal
                                    End If
                                End If
                            Case "cmbEI"
                                lblEI.Visible = True
                                lblEI.Caption = Trim(.cName)
                                lblEI.Height = .iLblHeight
                                lblEI.Width = .iLblWidth
                                lblEI.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblEI.Top = .iTop
                                cmbEI.Visible = True
                                cmbEI.Tag = Trim(.cSprav)
                                cmbEI.Height = .iHeight
                                cmbEI.Width = .iWidth
                                cmbEI.Left = Me.Width - .iWidth - iLblLeft
                                cmbEI.Top = .iTop
                                cmbEI.RowSource = cDataR
                                cmbEI.ColumnCount = .iColCount
                                cmbEI.ColumnWidths = .cColWidths
                                
                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                lEmpty = EmptySpr(cDataR)
                                If lEmpty = True Then
                                    cmbEI.Enabled = False
                                Else
                                    cmbEI.Enabled = True
                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        cmbEI.ListIndex = 0
                                    Else
                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
                                        cmbEI.ListIndex = iVal
                                    End If
                                End If
                            Case "listORG"
                                lblORG.Visible = True
                                lblORG.Caption = Trim(.cName)
                                lblORG.Height = .iLblHeight
                                lblORG.Width = .iLblWidth
                                lblORG.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblORG.Top = .iTop
                                listORG.Visible = True
                                listORG.Tag = Trim(.cSprav)
                                listORG.Height = .iHeight
                                listORG.Width = .iWidth
                                listORG.Left = Me.Width - .iWidth - iLblLeft
                                listORG.Top = .iTop
                                listORG.RowSource = cDataR
                                listORG.ColumnCount = .iColCount
                                listORG.ColumnWidths = .cColWidths
                                
                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                lEmpty = EmptySpr(cDataR)
                                If lEmpty = True Then
                                    listORG.Enabled = False
                                Else
                                    listORG.Enabled = True
                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listORG.ListIndex = 0
                                    Else
                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
                                        listORG.ListIndex = iVal
                                    End If
                                End If
                            Case "listFKR"
                                lblFKR.Visible = True
                                lblFKR.Caption = Trim(.cName)
                                lblFKR.Height = .iLblHeight
                                lblFKR.Width = .iLblWidth
                                lblFKR.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblFKR.Top = .iTop
                                listFKR.Visible = True
                                listFKR.Tag = Trim(.cSprav)
                                listFKR.Height = .iHeight
                                listFKR.Width = .iWidth
                                listFKR.Left = Me.Width - .iWidth - iLblLeft
                                listFKR.Top = .iTop
                                listFKR.RowSource = cDataR
                                listFKR.ColumnCount = .iColCount
                                listFKR.ColumnWidths = .cColWidths
                                
'                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                                lEmpty = EmptySpr(cDataR)
'                                If lEmpty = True Then
'                                    listFKR.Enabled = False
'                                Else
'                                    listFKR.Enabled = True
'                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listFKR.ListIndex = 0
'                                    Else
'                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
'                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
'                                        listFKR.ListIndex = iVal
'                                    End If
'                                End If
                             Case "listPLS"
                                lblPLS.Visible = True
                                lblPLS.Caption = Trim(.cName)
                                lblPLS.Height = .iLblHeight
                                lblPLS.Width = .iLblWidth
                                lblPLS.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblPLS.Top = .iTop
                                listPLS.Visible = True
                                listPLS.Tag = Trim(.cSprav)
                                listPLS.Height = .iHeight
                                listPLS.Width = .iWidth
                                listPLS.Left = Me.Width - .iWidth - iLblLeft
                                listPLS.Top = .iTop
                                listPLS.RowSource = cDataR
                                listPLS.ColumnCount = .iColCount
                                listPLS.ColumnWidths = .cColWidths
                                
'                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                                lEmpty = EmptySpr(cDataR)
'                                If lEmpty = True Then
'                                    listPLS.Enabled = False
'                                Else
'                                    listPLS.Enabled = True
'                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listPLS.ListIndex = 0
'                                    Else
'                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
'                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
'                                        listPLS.ListIndex = iVal
'                                    End If
'                                End If
                            Case "listSGU"
                                lblSGU.Visible = True
                                lblSGU.Caption = Trim(.cName)
                                lblSGU.Height = .iLblHeight
                                lblSGU.Width = .iLblWidth
                                lblSGU.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblSGU.Top = .iTop
                                listSGU.Visible = True
                                listSGU.Tag = Trim(.cSprav)
                                listSGU.Height = .iHeight
                                listSGU.Width = .iWidth
                                listSGU.Left = Me.Width - .iWidth - iLblLeft
                                listSGU.Top = .iTop
                                listSGU.RowSource = cDataR
                                listSGU.ColumnCount = .iColCount
                                listSGU.ColumnWidths = .cColWidths
                                
'                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                                lEmpty = EmptySpr(cDataR)
'                                If lEmpty = True Then
'                                    listSGU.Enabled = False
'                                Else
'                                    listSGU.Enabled = True
'                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listSGU.ListIndex = 0
'                                    Else
'                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
'                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
'                                        listSGU.ListIndex = iVal
'                                    End If
'                                End If
                             Case "listKLD"
                                lblKLD.Visible = True
                                lblKLD.Caption = Trim(.cName)
                                lblKLD.Height = .iLblHeight
                                lblKLD.Width = .iLblWidth
                                lblKLD.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblKLD.Top = .iTop
                                listKLD.Visible = True
                                listKLD.Tag = Trim(.cSprav)
                                listKLD.Height = .iHeight
                                listKLD.Width = .iWidth
                                listKLD.Left = Me.Width - .iWidth - iLblLeft
                                listKLD.Top = .iTop
                                listKLD.RowSource = cDataR
                                listKLD.ColumnCount = .iColCount
                                listKLD.ColumnWidths = .cColWidths
                                
'                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                                lEmpty = EmptySpr(cDataR)
'                                If lEmpty = True Then
'                                    listKLD.Enabled = False
'                                Else
'                                    listKLD.Enabled = True
'                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listKLD.ListIndex = 0
'                                    Else
'                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
'                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
'                                        listKLD.ListIndex = iVal
'                                    End If
'                                End If
                             Case "listIFR"
                                lblIFR.Visible = True
                                lblIFR.Caption = Trim(.cName)
                                lblIFR.Height = .iLblHeight
                                lblIFR.Width = .iLblWidth
                                lblIFR.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblIFR.Top = .iTop
                                listIFR.Visible = True
                                listIFR.Tag = Trim(.cSprav)
                                listIFR.Height = .iHeight
                                listIFR.Width = .iWidth
                                listIFR.Left = Me.Width - .iWidth - iLblLeft
                                listIFR.Top = .iTop
                                listIFR.RowSource = cDataR
                                listIFR.ColumnCount = .iColCount
                                listIFR.ColumnWidths = .cColWidths
                                
'                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                                lEmpty = EmptySpr(cDataR)
'                                If lEmpty = True Then
'                                    listIFR.Enabled = False
'                                Else
'                                    listIFR.Enabled = True
'                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listIFR.ListIndex = 0
'                                    Else
'                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
'                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
'                                        listIFR.ListIndex = iVal
'                                    End If
'                                End If
                            Case "listIFV"
                                lblIFV.Visible = True
                                lblIFV.Caption = Trim(.cName)
                                lblIFV.Height = .iLblHeight
                                lblIFV.Width = .iLblWidth
                                lblIFV.Left = Me.Width - .iWidth - .iLblWidth - iLblLeft
                                lblIFV.Top = .iTop
                                listIFV.Visible = True
                                listIFV.Tag = Trim(.cSprav)
                                listIFV.Height = .iHeight
                                listIFV.Width = .iWidth
                                listIFV.Left = Me.Width - .iWidth - iLblLeft
                                listIFV.Top = .iTop
                                listIFV.RowSource = cDataR
                                listIFV.ColumnCount = .iColCount
                                listIFV.ColumnWidths = .cColWidths
                                
'                                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                                lEmpty = EmptySpr(cDataR)
'                                If lEmpty = True Then
'                                    listIFV.Enabled = False
'                                Else
'                                    listIFV.Enabled = True
'                                    If Len(Trim(Application.Range(cKodR).Value)) = 0 Then
                                        listIFV.ListIndex = 0
'                                    Else
'                                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range(cKodR).Value |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cDataR
'                                        iVal = FoundIndex(cDataR, Trim(Range(cKodR).Value))
'                                        listIFV.ListIndex = iVal
'                                    End If
'                                End If
                             Case "optD"
                                optD.Visible = True
                                optD.Height = .iHeight
                                optD.Width = .iWidth
                                optD.Left = .iLeft
                                optD.Top = .iTop
                                optD.Tag = .cControl
                              Case "optR"
                                optR.Visible = True
                                optR.Height = .iHeight
                                optR.Width = .iWidth
                                optR.Left = .iLeft
                                optR.Top = .iTop
                                optR.Tag = .cControl
                              Case "optFR"
                                optFR.Visible = True
                                optFR.Height = .iHeight
                                optFR.Width = .iWidth
                                optFR.Left = .iLeft
                                optFR.Top = .iTop
                                optFR.Tag = .cControl
                              Case "optFV"
                                optFV.Visible = True
                                optFV.Height = .iHeight
                                optFV.Width = .iWidth
                                optFV.Left = .iLeft
                                optFV.Top = .iTop
                                optFV.Tag = .cControl
                            Case "butOK"
                                butOK.Visible = True
'                                butOK.Height = .iHeight
'                                butOK.Width = .iWidth
                                butOK.Left = Me.Width - butOK.Width - butCancel.Width - iLblLeft * 2
                                butOK.Top = Me.Height - butOK.Height * 1.5 - iLblLeft * 2
                            Case "butCancel"
                                butCancel.Visible = True
'                                butCancel.Height = .iHeight
'                                butCancel.Width = .iWidth
                                butCancel.Left = Me.Width - butCancel.Width - iLblLeft
                                butCancel.Top = Me.Height - butCancel.Height * 1.5 - iLblLeft * 2
                       End Select
                    End With
                Next i
            End If
        End With
    End With
    
    Exit Property
    
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (ObjectDataSprav)"
    Resume Next

End Property
Private Sub butCancel_Click()
    Set colValues = New Collection
'   Unload Me
    Me.Hide
End Sub

Private Sub butOK_Click()
    Dim ctl As Control
    Dim i As Long
    Dim cVal As String
    Dim iMax As Integer
    
    On Error GoTo errHandler
    
'    If Not (colValues Is Nothing) Then
'        For i = 1 To colValues.Count
'            colValues.Remove (Val(i))
'        Next i
'    End If
    Set colValues = New Collection
    
    For Each ctl In Me.Controls
        If TypeName(ctl) = "ComboBox" Or TypeName(ctl) = "ListBox" Then
            If ctl.Visible = True Then   ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                iMax = Me.Controls(ctl.Name).ColumnCount
                For i = 1 To iMax
                    If Me.Controls(ctl.Name).Enabled = True Then
                        Me.Controls(ctl.Name).BoundColumn = i
                        cVal = Me.Controls(ctl.Name).Value
                    Else
                        cVal = ""
                    End If
                    Select Case i
                        Case 1
                            colValues.Add Item:=cVal, key:="Kod_" & ctl.Tag
                        Case 2
                            colValues.Add Item:=cVal, key:="Name_" & ctl.Tag
                        Case 3
                            colValues.Add Item:=cVal, key:="Col3_" & ctl.Tag
                    End Select
                Next i
            End If
        End If
        
        If TypeName(ctl) = "OptionButton" Then
            If ctl.Visible = True Then   ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                colValues.Add Item:=Me.Controls(ctl.Name).Value, key:=ctl.Tag
            End If
        End If
    Next ctl
    
    Me.Hide
    
    Exit Sub
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (cmdOK_Click)"
    Resume Next
End Sub

Private Sub optFR_Click()

    Me.listKLD.Enabled = False
    Me.listFKR.Enabled = False
    Me.listSGU.Enabled = False
    Me.listIFR.Enabled = True
    Me.listIFV.Enabled = False
    Me.listKLD.ListIndex = -1
    Me.listFKR.ListIndex = -1
    Me.listSGU.ListIndex = -1
    Me.listIFR.ListIndex = 0
    Me.listIFV.ListIndex = -1
    Me.Repaint
    
End Sub

Private Sub optFV_Click()

    Me.listKLD.Enabled = False
    Me.listFKR.Enabled = False
    Me.listSGU.Enabled = False
    Me.listIFR.Enabled = False
    Me.listIFV.Enabled = True
    Me.listKLD.ListIndex = -1
    Me.listFKR.ListIndex = -1
    Me.listSGU.ListIndex = -1
    Me.listIFR.ListIndex = -1
    Me.listIFV.ListIndex = 0
    Me.Repaint

End Sub

Private Sub UserForm_Activate()

    If Me.ObjectName = "KBK129" Then
        Me.optD.Value = True
        Me.listKLD.Enabled = True
        Me.listFKR.Enabled = False
        Me.listSGU.Enabled = False
        Me.listIFR.Enabled = False
        Me.listIFV.Enabled = False
        Me.listKLD.ListIndex = 0
        Me.listFKR.ListIndex = -1
        Me.listSGU.ListIndex = -1
        Me.listIFR.ListIndex = -1
        Me.listIFV.ListIndex = -1
    End If

End Sub

Private Sub optD_Click()
    Me.listKLD.Enabled = True
    Me.listFKR.Enabled = False
    Me.listSGU.Enabled = False
    Me.listIFR.Enabled = False
    Me.listIFV.Enabled = False
    Me.listKLD.ListIndex = 0
    Me.listFKR.ListIndex = -1
    Me.listSGU.ListIndex = -1
    Me.listIFR.ListIndex = -1
    Me.listIFV.ListIndex = -1
    Me.Repaint
    
End Sub

Private Sub optR_Click()
    Me.listKLD.Enabled = False
    Me.listFKR.Enabled = True
    Me.listSGU.Enabled = True
    Me.listIFR.Enabled = False
    Me.listIFV.Enabled = False
    Me.listKLD.ListIndex = -1
    Me.listFKR.ListIndex = 0
    Me.listSGU.ListIndex = 0
    Me.listIFR.ListIndex = -1
    Me.listIFV.ListIndex = -1
    Me.Repaint
    
End Sub

Private Sub UserForm_Initialize()
    Me.IsUnload = False
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If Me.IsUnload = True Then
        Cancel = 0
    Else
        Cancel = 1
        Set colValues = New Collection
        Me.Hide
    End If
End Sub
Attribute VB_Name = "mdActualForma"
Public Function InsertRangeToSheet() As Long
Dim nRowsSpr1 As Long
Dim nRowsSpr2 As Long
Dim i As Long
Dim n As Long
Dim k As Long
Dim m As Long
Dim j As Long
Dim y As Long
Dim nNoNullSpr1 As Long
Dim nNoNullSpr2 As Long
Dim iVar As Integer

' nColR |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| sNameRange ("Data_Sheet1")
Dim nColR As Long
For iVar = 1 To 3
        Select Case iVar
            Case 1
                sNameRange = "Data_Sheet1"
                sNameSpr = "KLD"
                sNameSpr1 = "Data_KLD"
                Application.Sheets(1).Activate
'            Case 2
'                sNameRange = "Data_Sheet2"
'                sNameSpr = "FKR"
'                sNameSpr1 = "Data_FKR"
             Case 2
                sNameRange = "Data_Sheet3"
                sNameSpr = "IFR"
                sNameSpr1 = "Data_IFR"
                Application.Sheets(3).Activate
            Case 3
                sNameRange = "Data_Sheet4"
                sNameSpr = "IFV"
                sNameSpr1 = "Data_IFV"
                Application.Sheets(3).Activate
       End Select
        
    Dim lngCount As Long
        lngCount = 0
    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "KLD" |fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        If Not IsEmpty(Range(sNameSpr1).Cells(1, 1)) Then ' And IsEmpty(Range(sNameSpr1).Cells(2, 1))
    '            InsertRangeToSheet = -5
    '            Exit Function
            
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| sNameSpr1
            nRowsSpr1 = Range(sNameSpr1).Rows.Count
            nNoNullSpr1 = 0
            For j = 1 To nRowsSpr1
                    If Len(Trim(Range(sNameSpr1).Cells(j, 1))) <> 0 Then
                        nNoNullSpr1 = nNoNullSpr1 + 1
                    End If
            Next j
            
        '    nRowsSpr3 = Range(sNameSpr3).Rows.Count
            m = nNoNullSpr1 ' * nNoNullSpr2 '* nRowsSpr3
            
        '   |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| "KLD" |fffd||fffd||fffd||fffd||fffd||fffd| 60000, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            If m >= 60000 Then
                InsertRangeToSheet = -4
                Exit Function
            End If
            
            Debug.Print "1=", Time
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| sNameRange |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            For i = 1 To m - 2
                Range(sNameRange).Cells(i + 1, 1).EntireRow.Insert Shift:=xlShiftDown
                
            Next
            
            Debug.Print "1=", Timer
            
            Debug.Print "1=", Timer
 '           Range(sNameRange).Cells(lngCount + 1, 1).EntireRow.Delete
        ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "Data_BSR"
        ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "Data_Sheet1"
        
        ' "1,0,0" - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"BSR" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'          l = objSvod.InsertSprToSheet(ActiveWorkbook, sNameRange, sNameSpr, "3,0,0")
           l = objSvod.InsertSprToSheet(ActiveWorkbook, sNameRange, sNameSpr, "3,1,0")
            Debug.Print "1=", Timer
            
            
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| sNameRange ("Data_Sheet1") |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| sNameSpr ("RPS")
        ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| nColR(=2) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "Data_Sheet1" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "RPS"|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "a"
            nColR = Range(sNameRange).Columns.Count
            For i = 4 To nColR
                objSvod.AddNewNames ActiveWorkbook, sNameSpr, 1, sNameRange, i, Chr(93 + i)
            Next
            Debug.Print "1=", Timer
            
            
          '  |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "Data_Sheet1" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 8
           objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 8
        Select Case iVar
            Case 1
                objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 8
                objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 9
            Case 2
                 objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 8
                objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 9
           Case 3
                 objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 8
                objSvod.AutoFillColumn ActiveWorkbook, sNameRange, 9
      End Select
           
            
        End If
 
    Next iVar

    InsertRangeToSheet = -1

End Function

Public Function SheetVarForm()

    Dim sprNameRange As String
    Dim MyRange As String
    Dim ColBegin As Long
    Dim vR As Range
    
    
    sprNameRange = "Data_Spr1"
    MyRange = "Data_Sheet2"
    ColBegin = 3

'    Application.ScreenUpdating = False

'    SheetVarForm = InsertRangeToSheet()
'    If SheetVarForm = -1 Then
      'vR = 5 / 0
        On Error Resume Next
        Set vR = ActiveWorkbook.Application.Range(sprNameRange)
    '
        If Not (vR Is Nothing) Then
            ''SheetVarForm = AddRowsFromRange(sprNameRange, MyRange, ColBegin)
            SheetVarForm = fRasstMain

            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'            SheetVarForm = HiddenRows()
            Application.Sheets(1).Activate
        Else
            SheetVarForm = 0    ' |fffd||fffd||fffd||fffd||fffd||fffd|
        End If
'    End If
    
'    Application.ScreenUpdating = True

End Function

Public Function HiddenRows() As Long
    Dim iVar As Integer
    Dim bHidden As Boolean

    On Error GoTo errHandler
    
    bHidden = False
    For iVar = 1 To 3
        Select Case iVar
            Case 1
                sNameRange = "Data_Sheet1"
                Application.Sheets(1).Activate
             Case 2
                sNameRange = "Data_Sheet3"
                Application.Sheets(3).Activate
            Case 3
                sNameRange = "Data_Sheet4"
                Application.Sheets(3).Activate
       End Select
       
   'MsgBox Range(sNameRange).Count
       If Range(sNameRange).Rows.Count = 2 Then
   'MsgBox Range(sNameRange).Cells(1, 3).Value
            If Len(Trim(Range(sNameRange).Cells(1, 3).Value)) = 0 Then
                Range(sNameRange).Select
                Selection.EntireRow.Hidden = True
                Select Case iVar
                    Case 1
                        Application.ActiveSheet.cmdVisibleNullStr1.Enabled = False
   'MsgBox "Application.ActiveSheet.cmdVisibleNullStr1.Enabled = False"
                    Case 2
                        bHidden = True
                    Case 3
                        If bHidden Then
'                            Application.ActiveSheet.cmdVisibleNullStr3.Enabled = False
                        End If
                End Select
            End If
       End If
       
    Next iVar
    
    HiddenRows = -1
    
    Exit Function
    
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (HiddenRows)"
    HiddenRows = -9
    
End Function


Public Function AddRowsFromRange(ByVal sprNameRange As String, ByVal MyRange As String, ByVal ColBegin As Long) As Long
' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| Range("Data_Sheet1") |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| sprNameRange
    Dim nrows As Integer
    Dim i As Integer
    Dim j As Integer
    Dim n As Integer
    Dim kod As String
    Dim nRowsSpr As Integer
    Dim lNameCell As Integer
    Dim nColRange As Integer
    Dim sTemp As String
    Dim sSheet As String
    Dim nCountRange As Integer
    Dim sOldKod  As String
    Dim nRowRange As Integer
    Dim cNameCells, cValue As String
    Dim bYes As Boolean
    Dim bYesData As Boolean
'SprVavue = "345"
'
On Error GoTo errHandler

''   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Application.Sheets(2).Activate
    sSheet = Application.ActiveSheet.Name
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| sNameSpr2
    nRowsSpr = Range(sprNameRange).Rows.Count
    
        lNameCell = Len(Trim(Range(sprNameRange).Cells(1, 1)))
        nColRange = Range(MyRange).Columns.Count

    If Len(Trim(Range(sprNameRange).Cells(1, 1))) <> 0 Then
        sOldKod = ""
        For i = 1 To nRowsSpr
        
            bYesData = False
            ''lNameCell = Len(Trim(Range(sprNameRange).Cells(i, 1)))
            kod = Mid(Range(sprNameRange).Cells(i, 1), 3, lNameCell - 3)
            
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            Dim KodSpr As String, k As Integer
            KodSpr = Right(kod, 3)
            For k = 1 To Range("Data_SGU").Rows.Count
                If Range("Data_SGU").Cells(k, 1).Value = KodSpr Then
 '                    Range(MyRange).Cells(nCountRange, 1).Value = Range("Data_SGU").Cells(k, 2).Value
                     bYesData = True
                     Exit For
                End If
            Next
            
            If bYesData Then
            
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| "Data_Cells"
                cNameCells = "ss" & kod
                nRowRange = Range("Data_Cells").Rows.Count
                bYes = False
                For j = 1 To nRowRange - 1
                    cValue = Trim(Range("Data_Cells").Cells(j, 1).Value)
                    If Left(cValue, Len(cValue) - 1) = cNameCells Then
                        bYes = True
                        Exit For
                    End If
                Next j
                
                If kod <> sOldKod And bYes = False Then
                    If Not (Trim(kod) = "") Then
                        sOldKod = kod
                        nCountRange = Range(MyRange).Rows.Count
                    
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Range(MyRange).Cells(nCountRange, 1).EntireRow.Insert Shift:=xlShiftDown
                        Range(MyRange).Cells(nCountRange, ColBegin).Value = kod
                        n = 0
                        For j = ColBegin + 1 To nColRange
                            Range(MyRange).Cells(nCountRange, j).Select
                            
                            ' ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                            Set tRange = Application.Selection
                            
                             ActiveWorkbook.Names.Add Name:="ss" & kod & Chr(97 + n), RefersToR1C1:="=" & sSheet & "!R" & Selection.Row & "C" & Selection.Column
                             
            '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
            '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| Data_Cells
    '                        nRowRange = Range("Data_Cells").Rows.Count
                            Range("Data_Cells").Cells(nRowRange, 1).EntireRow.Insert Shift:=xlShiftDown
                            Range("Data_Cells").Cells(nRowRange, 1).Value = "ss" & kod & Chr(97 + n)
                            Range("Data_Cells").Cells(nRowRange, 2).Value = "F"
                            Range("Data_Cells").Cells(nRowRange, 3).Value = "2"
                            n = n + 1
                            
                        Next j
                        
                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Range(MyRange).Cells(nCountRange, 9).FormulaR1C1 = "=SUM(RC[-3]:RC[-1])"
                        Range(MyRange).Cells(nCountRange, 10).FormulaR1C1 = "=SUM(RC[-6]-RC[-1])"
                        Range(MyRange).Cells(nCountRange, 11).FormulaR1C1 = "=SUM(RC[-6]-RC[-2])"
                        
    '                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    '                    Dim KodSpr As String, k As Integer
    '                    KodSpr = Left(kod, 17)
    '                    For k = 1 To Range("Data_FKR").Rows.Count
    '                        If Range("Data_FKR").Cells(k, 1).Value = KodSpr Then
                                 Range(MyRange).Cells(nCountRange, 1).Value = Range("Data_SGU").Cells(k, 2).Value
    '                             Exit For
    '                        End If
    '                    Next
                    End If
                  End If
              End If
          Next i
              
    End If
          
    AddRowsFromRange = -1
          
    Exit Function
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (AddRowsFromRange)"
    AddRowsFromRange = -8
End Function




Attribute VB_Name = "mdLib"
''''''''''''''''''''''''''''''''''''''''''''
'**** Version 28.07.2005 *******************
''''''''''''''''''''''''''''''''''''''''''''
Option Explicit

Public objSvod As Object
Public objSprForms As Object
Public Const RangeRek As String = "Data_Cells"
Public strNameCell As String
Public colValues As Collection
Public FormSpr As Object
Public Const cKod = "Kod_"
Public Const cName = "Name_"
Public Const cData = "Data_"


Public Function IsSvod() As Boolean
    IsSvod = True
End Function
Public Sub RemoveNamesSS()
    Dim i As Long
    
    With ActiveWorkbook.Names
        For i = .Count To 1 Step -1
            If Left$(.Item(i).Name, 2) = "ss" Then
                .Item(i).Delete
            End If
        Next
    End With
End Sub


Public Sub ConstForm()
Attribute ConstForm.VB_Description = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 17.05.2004 (nekrasova)"
Attribute ConstForm.VB_ProcData.VB_Invoke_Func = " \n14"
    Dim tRange As Range
    Dim strTemp As String
    Dim strSheet As String
    Dim i As Long
    Dim j, n As Long
    
'
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 02.06.2004 |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (BALANS)
'
'   |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|:
'               1. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'               2. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'
'   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "ss"+|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|+"|fffd|"..."|fffd|"
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'

' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Set tRange = Application.Selection
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    strSheet = Application.ActiveSheet.Name
'
'   tRange.Rows.Count- |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'   tRange.Columns.Count |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
    For i = 1 To tRange.Rows.Count
        For j = 2 To tRange.Columns.Count
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| "ss"+|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|+"a"
            strTemp = Mid$(tRange.Cells(i, j).Address, 2, 1)
            Range(strTemp & (i + tRange.Row - 1) & ":" & strTemp & (i + tRange.Row - 1)).Select
            ActiveWorkbook.Names.Add Name:="ss" & tRange.Cells(i, 1) & Chr(95 + j), RefersToR1C1:="=" & strSheet & "!R" & Selection.Row & "C" & Selection.Column
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
                   n = Range("Data_Cells").Rows.Count
                   Range("Data_Cells").Cells(n, 1).EntireRow.Insert Shift:=xlShiftDown
                   Range("Data_Cells").Cells(n, 1).Value = "ss" & tRange.Cells(i, 1) & Chr(95 + j)
                   Range("Data_Cells").Cells(n, 2).Value = "F"
         Next
    Next
    
    
'    Range("G3:G4").Select
'    ActiveWorkbook.Names.Add Name:="ss0630a", RefersToR1C1:="=|fffd||fffd||fffd||fffd|2!R3C7"
End Sub
Public Function VarForm() As Long
'' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 15.07.2005

'    Dim sNameRange As String, sNameSpr As String
'    Dim vR As Range
'  vR = 5 / 0
'    sNameRange = "Data_Sheet1"
'    On Error Resume Next
'    Set vR = ActiveWorkbook.Application.Range(sNameRange)
'
'     If vR Is Nothing Then
'        VarForm = -1
'     Else
'        VarForm = InsertRangeToSheet(sNameRange)
'     End If
     VarForm = SheetVarForm()

     SetFormula
'    Application.Calculate
End Function
     
Private Sub SetFormula()
    Range("Naim_STOPdata").FormulaLocal = "=SetStrData(A1;Kod_STOPdata)"
    Range("Naim_STOPdata").Calculate
    
    Range("Naim_MODdata").FormulaLocal = "=SetStrData(A2;Kod_MODdata)"
    Range("Naim_MODdata").Calculate
'    ActiveCell.FormulaLocal = "=SetStrData(B5;Kod_STOPdata)"
End Sub

Public Sub ChangeFormatCells(ByVal NameRange As String, ByVal SpravEI As Integer, ByVal Col As Integer)
 '
    Dim nrows, i As Integer
    Dim strFormat As String
    Dim strNameCell As String
    Dim strNameList As String
    
    Application.ScreenUpdating = False
  
      Select Case Col
          Case 0
            strFormat = "0"
          Case 1
            strFormat = "0.0"
          Case 2
            strFormat = "0.00"
          Case 3
           strFormat = "0.000"
          Case 4
           strFormat = "0.0000"
     End Select
'   nrows - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Data_Cells
    nrows = Range(NameRange).Rows.Count
'
    For i = 1 To nrows
        strNameCell = Range(NameRange).Cells(i, 1)
        If Range(NameRange).Cells(i, 5) = SpravEI And _
           Left(Range(NameRange).Cells(i, 1).Value, 2) = "ss" Then
           If Range(NameRange).Cells(i, 3) <> Col Then
             Range(NameRange).Cells(i, 3) = Col
              strNameList = ActiveSheet.Name
              Sheets(Range(strNameCell).Worksheet.Name).Select
              Range(strNameCell).Select
              Selection.NumberFormat = strFormat
'              Range(strNameCell) = Round(Range(strNameCell))
'                Call RoundCells(strNameCell)
              Sheets(strNameList).Activate
           End If
           
       End If
    Next i
        Range("Name_OTD").Activate
        Application.ScreenUpdating = True
End Sub



Public Function SetStrData(ByVal sVoise As Range, ByVal sNameRange As Range) As String

'    Dim objSvod As Object
'    Set objSvod = CreateObject("rasExRng.clsWork")
    If Application.ScreenUpdating Then
        SetStrData = objSvod.setdataname(CStr(sVoise), CDate(sNameRange))
    End If
'    Set objSvod = Nothing

End Function
 Public Sub ProtectXlt()
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Dim Sheet As Object
    
'    On Error Resume Next
    Application.ScreenUpdating = False
    
    For Each Sheet In Worksheets
        If Sheet.ProtectContents = False Then
            If Val(Application.Version) > 9 Then
                Sheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
                , AllowFormattingColumns:=True, AllowFormattingRows:=True, password:=objSvod.PasswordName
            Else
                Sheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, password:=objSvod.PasswordName
            End If
        End If
    Next Sheet
    
   If ActiveWorkbook.ProtectStructure = False Then
        ActiveWorkbook.Protect Structure:=True, Windows:=False, password:=objSvod.PasswordName
    End If
    
    Application.ScreenUpdating = True

End Sub
 Public Sub UnProtectXlt()
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Dim Sheet As Worksheet
    
    On Error Resume Next
    Application.ScreenUpdating = False
    
    ActiveWorkbook.Unprotect password:=objSvod.PasswordName
    
    For Each Sheet In Worksheets
        If Sheet.ProtectContents = True Then
            Sheet.Unprotect password:=objSvod.PasswordName
        End If
    Next Sheet
    
    Application.ScreenUpdating = True
    
End Sub
                               
Public Function OpenWorkbook() As Long

    On Error GoTo errHandler
    
    Set objSvod = CreateObject("rasExRng.clsWork")
    Set objSprForms = CreateObject("rasDS.DataSpravs")
    If objSprForms.iCodeError <> 0 Then
       MsgBox (objSprForms.cErrorTextMessage)
    End If
     
     Set FormSpr = New frmAddRow
     Load FormSpr
    
    If objSvod Is Nothing Or objSprForms.iCodeError <> 0 Then
        OpenWorkbook = 0    ' |fffd||fffd||fffd||fffd||fffd||fffd| OpenWorkbook
    Else
        OpenWorkbook = -1   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
    Exit Function
    
errHandler:
    OpenWorkbook = Err.Number
'    Application.Calculate
End Function
Public Sub CloseWorkbook()

    FormSpr.IsUnload = True
    Unload FormSpr
    Set objSvod = Nothing
    Set objSprForms = Nothing
    
End Sub
Public Function EmptySpr(ByVal NameSpr As String) As Boolean
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| True, |fffd||fffd||fffd||fffd| NameSpr |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| False

    If Range(NameSpr).Rows.Count <= 2 Then
        If IsEmpty(Range(NameSpr).Cells(1, 1)) Then
            EmptySpr = True
        Else
            EmptySpr = False
        End If
    Else
        EmptySpr = False
    End If
    
End Function
Public Function FoundIndex(ByVal NameSpr As String, ByVal cVal As String) As Long
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| cVal |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| NameSpr,
'   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0

    Dim i As Long
    
    FoundIndex = 0
    For i = 1 To Range(NameSpr).Rows.Count
        If Trim(Range(NameSpr).Cells(i, 1).Value) = cVal Then
            FoundIndex = i - 1
            Exit For
        End If
    Next i
    
End Function

Public Sub IzmenEI(ByVal Old_izm As String, ByVal New_izm As String, ByVal sCol As String)

'
'  382 - |fffd||fffd||fffd||fffd||fffd|
'  383 - |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'  384 - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'  385 - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Select Case Old_izm
                Case 383  '  - |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    Select Case New_izm
                        Case 382  '  - |fffd||fffd||fffd||fffd||fffd|
                            Call RoundCells("1", sCol)
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                        Case 384, 385
                            Call RoundCells("1000", sCol)
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                    Case Else
                    End Select
                Case 382
                    Select Case New_izm
                        Case 383
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                        Case 384, 385
                            Call RoundCells("1000", sCol)
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                    Case Else
                    End Select
                Case 384
                    Select Case New_izm
                        Case 382, 383, 385
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                    Case Else
                    End Select
                 Case 385
                    Select Case New_izm
                        Case 384
                            Call RoundCells("1", sCol)
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                        Case 383, 382
                            Call ChangeFormatCells(RangeRek, "0", sCol)
                    Case Else
                    End Select
               Case Else
            End Select
   

End Sub
Public Sub RoundCells(ByVal sDel As String, ByVal sCol As String)
Dim Msg, Response, MyString, Style

    Dim nrows, i As Integer
    Dim strFormat As String
    Dim sNameCell As String
    Dim strNameList As String
    
'   nrows - |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Data_Cells
    nrows = Range(RangeRek).Rows.Count

    Application.ScreenUpdating = False
  
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ?"
    Style = vbYesNo + vbCritical + vbDefaultButton2

     Response = MsgBox(Msg, Style)
        If Response = vbYes Then
            MyString = "Yes"
    For i = 1 To nrows
            sNameCell = Range(RangeRek).Cells(i, 1)
        If Left(Range(RangeRek).Cells(i, 1).Value, 2) = "ss" Then
              strNameList = ActiveSheet.Name
              Sheets(Range(sNameCell).Worksheet.Name).Select
              Range(sNameCell).Select
'
            If Left((Range(sNameCell).FormulaR1C1), 1) <> "=" Then
                  Range(sNameCell) = Round(Range(sNameCell) / sDel, sCol)
            End If
'
        End If
    Next i

        Else
            MyString = "No"
        End If
'
        Application.ScreenUpdating = True

End Sub


Public Sub VisibleNullStr(ByVal IsVisible As Boolean, _
                            ByRef objRange As Range, _
                            Optional ByVal lngColBeg As Long, _
                            Optional ByVal lngColEnd As Long)
                            
' |fffd| |fffd||fffd|.|fffd||fffd||fffd|. objRange |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| lngColBeg |fffd||fffd| lngColEnd

    Dim i As Long
    Dim j As Long
    
    Application.ScreenUpdating = False
   
    On Error GoTo errHandler
    
    With objRange
        If IsVisible Then
            For i = 1 To .Rows.Count
                Rows(i + .Row - 1).EntireRow.Hidden = False
'                Selection.
            Next
        Else
            For i = 1 To .Rows.Count
                For j = lngColBeg To lngColEnd
                    If .Cells(i, j) <> 0 Then
                        Exit For
                    End If
                Next
                If j > lngColEnd Then
                    Rows(i + .Row - 1).EntireRow.Hidden = True
              End If
            Next
        End If
    End With
    
    Exit Sub
    
errHandler:
    MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & _
            "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & Err.Number, vbOKOnly + vbCritical, "|fffd||fffd||fffd||fffd||fffd||fffd|"
            
        Application.ScreenUpdating = True
End Sub

Public Sub AddRekv(ByVal ObjRekvs As Object)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Dim i As Long
    Dim sSprav As String
    Dim cKodR, cNameR, cCol3R As String
    Dim Old_EI, New_EI As String
    
    On Error GoTo errHandler
    
    Old_EI = Application.Range("Kod_EI").Cells(1, 1)
    
'    Set FormSpr = New frmAddRow
'    Load FormSpr
    Set FormSpr.ObjectDataSprav = ObjRekvs
    FormSpr.Repaint

    FormSpr.Show
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If colValues.Count <> 0 Then
       With ObjRekvs.SpravCollection
           If .Count > 0 Then
               For i = 1 To .Count
                   With .Item(Val(i))
                       If Not (.cControl Like "but*") Then
                           cKodR = cKod & .cSprav
                           cNameR = cName & .cSprav
                           Range(cKodR).Value = colValues.Item(cKodR)
                           Range(cNameR).Value = colValues.Item(cNameR)
                        End If
                        If .cSprav = "EI" Then
                            New_EI = Application.Range("Kod_EI").Cells(1, 1)
                            Call IzmenEI(Old_EI, New_EI, colValues.Item("Col3_EI"))
                        End If
                  End With
               Next i
           End If
       End With
     
    End If
 
    Exit Sub
    
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (AddRekv)"
    Resume Next

End Sub

Public Sub AddRow(ByVal ObjRekvs As Object)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Dim i As Long
    Dim sSprav As String
    Dim cKodR, cNameR, cCol3R As String
    Dim Old_EI, New_EI As String
    
    On Error GoTo errHandler
    
    
'    Set FormSpr = New frmAddRow
'    Load FormSpr
    Set FormSpr.ObjectDataSprav = ObjRekvs
    
    FormSpr.Show
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If colValues.Count <> 0 Then
       With ObjRekvs.SpravCollection
           If .Count > 0 Then
               For i = 1 To .Count
                   With .Item(Val(i))
                       If Not (.cControl Like "but*") Then
                           cKodR = cKod & .cSprav
                           cNameR = cName & .cSprav
                           Range(cKodR).Value = colValues.Item(cKodR)
                           Range(cNameR).Value = colValues.Item(cNameR)
                        End If
                  End With
               Next i
           End If
       End With
     
    End If
 
    Exit Sub
    
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (AddRekv)"
    Resume Next

End Sub

Public Sub AddRowToRange(ByVal KodRow As String, ByVal MyRange As String, ByVal ColBegin As Long)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| MyRange
' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ColBegin |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| KodRow
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "Data_Cells"

    Dim nrows As Integer
    Dim kod As String
    Dim sSheet As String
    Dim nColRange, nCountRange As Long
    Dim i As Long
    Dim j As Long
    Dim nRowRange As Integer
   
    On Error GoTo errHandler
    
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    sSheet = Application.ActiveSheet.Name
    
'   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| MyRange
    nColRange = Range(MyRange).Columns.Count
    nCountRange = Range(MyRange).Rows.Count
    
 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| MyRange
    For i = 1 To nCountRange
        If KodRow = Trim(Range(MyRange).Cells(i, ColBegin).Value) Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & KodRow & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Exit Sub
        End If
    Next i
     
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Range(MyRange).Cells(nCountRange, 1).EntireRow.Insert Shift:=xlShiftDown
    Range(MyRange).Cells(nCountRange, ColBegin).Value = KodRow
    i = 0
    For j = ColBegin + 1 To nColRange
       Range(MyRange).Cells(nCountRange, j).Select
       ActiveWorkbook.Names.Add Name:="ss" & KodRow & Chr(97 + i), RefersToR1C1:="=" & sSheet & "!R" & Selection.Row & "C" & Selection.Column
         
'    '  |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| MyRange |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| j
'       objSvod.AutoFillColumn ActiveWorkbook, MyRange, j
                     
    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| Data_Cells
        nRowRange = Range("Data_Cells").Rows.Count
        Range("Data_Cells").Cells(nRowRange, 1).EntireRow.Insert Shift:=xlShiftDown
        Range("Data_Cells").Cells(nRowRange, 1).Value = "ss" & KodRow & Chr(97 + i)
        Range("Data_Cells").Cells(nRowRange, 2).Value = "F"
        Range("Data_Cells").Cells(nRowRange, 3).Value = "2"
        i = i + 1
    Next j
    
    Range(MyRange).Cells(nCountRange, ColBegin + 1).Select
    
    Exit Sub
    
errHandler:
    MsgBox Err.Number & " - " & Err.Description & ". (AddRowToRange)"
    Resume Next

End Sub
Attribute VB_Name = "ntanina1"
Public objExcel As New Excel.Application

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Public Sub ConstForm_to_ZZ()
    Dim tRange As Range
    Dim rgResult As Range
    Dim strTemp As String
    Dim strName As String
    Dim i, j, n, cCellNum As Long
    Dim f, s, fLetter, sLetter As Byte
    Dim iAnswer As Byte
    
    iAnswer = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|?", vbInformation + vbYesNo)
    
    Set tRange = Application.Selection          ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    For i = 1 To tRange.Rows.Count
        fLetter = 97
        sLetter = 97
        cCellNum = 2
        
        For j = 2 To tRange.Columns.Count
            If Len(Trim(tRange.Cells(i, 1))) > 0 Then
                ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                If ((iAnswer = 6) Or (iAnswer = 7 And tRange.Cells(i, j).Value <> "0")) Then
                
                    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| "ss"+|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|+"a"
                    strTemp = Mid(tRange.Cells(i, j).Address, 2, InStrRev(tRange.Cells(i, j).Address, "$") - 2)
                    Range(strTemp & (i + tRange.Row - 1) & ":" & strTemp & (i + tRange.Row - 1)).Select

                    If cCellNum <= 27 Then
                        strName = "ss" & tRange.Cells(i, 1) & Chr(95 + cCellNum)
                        cCellNum = cCellNum + 1
                    Else
                        For f = fLetter To 122
                            For s = sLetter To 122
                                strName = "ss" & tRange.Cells(i, 1) & Chr(f) & Chr(s)
                                sLetter = s + 1
                                Exit For
                            Next s
                            
                            If sLetter = 123 Then
                                fLetter = f + 1
                                sLetter = 97
                            End If
                            
                            Exit For
                        Next f
                    End If
                End If

                If ActiveCell.Text <> "X" And ActiveCell.Text <> "|fffd|" Then
                    ActiveWorkbook.Names.Add Name:=strName, RefersTo:="=" & ActiveSheet.Name & "!" & ActiveCell.Address()

                    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Data_Cells
                    Set rgResult = Range("Data_Cells").Find(strName, , xlValues)
                    If rgResult Is Nothing Then
                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
                        n = Range("Data_Cells").Rows.Count
                        Range("Data_Cells").Cells(n, 1).EntireRow.Insert Shift:=xlShiftDown
                        Range("Data_Cells").Cells(n, 1).Value = strName
                        '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Range("Data_Cells").Cells(n, 2).Value = IIf(ActiveCell.NumberFormat = "@", "C", "F")
                        '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        If (InStrRev(ActiveCell.NumberFormat, ".") > 0) Then
                                Range("Data_Cells").Cells(n, 3).Value = Len(Mid(ActiveCell.NumberFormat, InStrRev(ActiveCell.NumberFormat, ".") + 1))
                        Else
                                If ActiveCell.NumberFormat <> "@" And ActiveCell.NumberFormat <> "General" Then Range("Data_Cells").Cells(n, 3).Value = 0
                        End If
                    End If
                
                End If
            End If
         Next
    Next
End Sub

'---------------------------------------------------
'               |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'---------------------------------------------------
Function RangeName(objRange As Range) As String
    Dim i As Long
    
    For i = 1 To ActiveWorkbook.Names.Count
        If objRange.Name = ActiveWorkbook.Names(i).RefersTo Then
            RangeName = ActiveWorkbook.Names(i).Name
            Exit Function
        End If
    Next
End Function

'---------------------------------------------------
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|,
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Data_Cells
'
' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!!!
'
'---------------------------------------------------
Public Sub CheckFormatInArea()
    Dim tRange As Range
    Dim i As Long
    Dim j As Long
    Dim CellTyp As String
    Dim CellCount As Integer
    
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Set tRange = Application.Selection
    
    For i = 1 To tRange.Rows.Count
        For j = 1 To tRange.Columns.Count
            tRange.Cells(i, j).Select
            CellTyp = ""
            CellCount = -1
                       
            Set rgResult = Range("Data_Cells").Find(RangeName(ActiveCell), , xlValues)
            If Not rgResult Is Nothing Then
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                CellTyp = IIf(ActiveCell.NumberFormat = "@", "C", "F")
                
                '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                If (InStrRev(ActiveCell.NumberFormat, ".") > 0) Then
                     CellCount = Len(Mid(ActiveCell.NumberFormat, InStrRev(ActiveCell.NumberFormat, ".") + 1))
                Else
                     If ActiveCell.NumberFormat <> "@" And ActiveCell.NumberFormat <> "General" Then CellCount = 0
                End If
                
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                If CellTyp <> Range("Data_Cells").Cells(rgResult.Row, 2).Value Then
                    Range("Data_Cells").Cells(rgResult.Row, 2).Value = CellTyp
                End If
                If CellTyp = "F" And CellCount <> -1 Then Range("Data_Cells").Cells(rgResult.Row, 3).Value = CellCount
            End If
            
        Next j
    Next i
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ("ss" + |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|),
'|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Public Sub ConstFormAdvance()
    Dim tRange As Range
    Dim rgResult As Range
    Dim strTemp As String
    Dim strSheet As String
    Dim strName As String
    Dim i As Long
    Dim j, n As Long
    Dim iAnswer As Byte
    
    iAnswer = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|?", vbInformation + vbYesNo)

    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Set tRange = Application.Selection
    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    strSheet = Application.ActiveSheet.Name
    
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 3 To tRange.Rows.Count
    'For i = 2 To tRange.Rows.Count  ' |fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd|
        For j = 2 To tRange.Columns.Count
            If Len(Trim(tRange.Cells(i, 1))) > 0 And Len(Trim(tRange.Cells(1, j))) > 0 And (iAnswer = 7 And tRange.Cells(i, j).Value <> "0") Then
            
                '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| "ss"+|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                strTemp = Mid(tRange.Cells(i, j).Address, 2, InStrRev(tRange.Cells(i, j).Address, "$") - 2)
                Range(strTemp & (i + tRange.Row - 1) & ":" & strTemp & (i + tRange.Row - 1)).Select
                
                'strName = "ss" & tRange.Cells(i, 1) & tRange.Cells(1, 1) & tRange.Cells(1, j)
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
                'ss 48813 050 010 9060012 0 a
                'strName = "ss" & tRange.Cells(i, 1) & tRange.Cells(1, 1) & tRange.Cells(1, j) & tRange.Cells(2, 1) & tRange.Cells(2, 2) & "a"
                
                '|fffd||fffd| |fffd| |fffd||fffd|:
                'ss 48813 060 998 0000000 0 b
                strName = "ss" & tRange.Cells(i, 1) & tRange.Cells(1, 1) & tRange.Cells(1, j) & tRange.Cells(2, 1) & tRange.Cells(2, 2) & "c"
                
                '|fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd|:
                'ss 02 0076 48813 o
                'strName = "ss" & tRange.Cells(1, 1) & tRange.Cells(i, 1) & tRange.Cells(1, j)
                
                ActiveWorkbook.Names.Add Name:=strName, RefersTo:="=" & ActiveSheet.Name & "!" & ActiveCell.Address()

                '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Data_Cells
                Set rgResult = Range("Data_Cells").Find(strName, , xlValues)
                If rgResult Is Nothing Then
                       '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
                    n = Range("Data_Cells").Rows.Count
                    Range("Data_Cells").Cells(n, 1).EntireRow.Insert Shift:=xlShiftDown
                    Range("Data_Cells").Cells(n, 1).Value = strName
                    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    Range("Data_Cells").Cells(n, 2).Value = IIf(ActiveCell.NumberFormat = "@", "C", "F")
                    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                    If (InStrRev(ActiveCell.NumberFormat, ".") > 0) Then
                            Range("Data_Cells").Cells(n, 3).Value = Len(Mid(ActiveCell.NumberFormat, InStrRev(ActiveCell.NumberFormat, ".") + 1))
                    Else
                            If ActiveCell.NumberFormat <> "@" And ActiveCell.NumberFormat <> "General" Then Range("Data_Cells").Cells(n, 3).Value = 0
                    End If
                'Else
                '    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & strName & " |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| Data_Cells"
                End If
            End If
        Next
    Next
    
    'Application.ScreenUpdating = True
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ("ss" + |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|),

Public Sub SetForlumaAdvance()
    Dim tRange As Range
    Dim strTemp As String
    Dim strName, strNameAddr As String
    Dim i As Long
    Dim j As Long
    Dim iAnswer As Byte
    
    iAnswer = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|?", vbInformation + vbYesNo)

    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Set tRange = Application.Selection
    
    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 2 To tRange.Rows.Count
        For j = 2 To tRange.Columns.Count
            If Len(Trim(tRange.Cells(i, 1))) > 0 And Len(Trim(tRange.Cells(1, j))) > 0 And (iAnswer = 7 And tRange.Cells(i, j).Value <> "0") Then
            
                '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                strTemp = Mid(tRange.Cells(i, j).Address, 2, InStrRev(tRange.Cells(i, j).Address, "$") - 2)
                Range(strTemp & (i + tRange.Row - 1) & ":" & strTemp & (i + tRange.Row - 1)).Select

                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                '|fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd|:
                strName = "ss" & tRange.Cells(1, 1) & tRange.Cells(i, 1) & tRange.Cells(1, j)
                strNameAddr = ActiveWorkbook.Names.Item(strName).RefersToLocal
                
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                ActiveCell.FormulaLocal = "=" & Mid(strNameAddr, InStr(strNameAddr, "!") + 1)
            End If
        Next
    Next
End Sub

'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
Public Sub MergeStrHeight(tRange As Range, Optional ByVal bOn As Boolean = False)
    
    Dim CurrentRowHeight As Single, MergedCellRgWidth As Single
    Dim CurrCell As Range
    Dim ActiveCellWidth As Single, PossNewRowHeight As Single
    Dim blnFlagProtect As Boolean

    On Error Resume Next
    
    With tRange
        If .WrapText = True Then
            If bOn Then Application.ScreenUpdating = False
            CurrentRowHeight = .RowHeight
            ActiveCellWidth = .ColumnWidth
            
            Application.Worksheets(tRange.Worksheet.Name).Activate
            .Select
            For Each CurrCell In Selection
                MergedCellRgWidth = CurrCell.ColumnWidth + MergedCellRgWidth
            Next
            
            If Application.ActiveSheet.ProtectContents Then
                UnProtectXlt
                blnFlagProtect = True
            Else
                blnFlagProtect = False
            End If
            
            .MergeCells = False
            .Cells(1).ColumnWidth = MergedCellRgWidth
            .EntireRow.AutoFit
            PossNewRowHeight = .RowHeight
            .Cells(1).ColumnWidth = ActiveCellWidth
            Selection.MergeCells = True
            .RowHeight = IIf(CurrentRowHeight > PossNewRowHeight, CurrentRowHeight, PossNewRowHeight)
            
            If blnFlagProtect Then
                ProtectXlt
                blnFlagProtect = False
            End If
            
            If bOn Then Application.ScreenUpdating = True
        End If
    End With
    
'errHandler:
'    MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & _
'            "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " & Err.Number, vbOKOnly + vbCritical, "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

'
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'
Public Sub ReplaceFields()
    Dim tRange As Range
    Dim strSheet As String
    Dim i, iRowNum, iColNum As Integer
    Dim BorderPart As Variant
    Dim b As Variant
    
    BorderPart = Array(xlEdgeLeft, xlEdgeTop, xlEdgeBottom, xlEdgeRight)

    '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Set tRange = Application.Selection
    strSheet = Application.ActiveSheet.Name
    
    If tRange.Rows.Count = 0 Then MsgBox "rows 0"
    If tRange.Columns.Count = 0 Then MsgBox "columns 0"
    
    objExcel.Workbooks.Add
    iRowNum = 10
    iColNum = 3
    i = 0

    objExcel.Cells(iRowNum, iColNum).Select
    
    For Each tRange In Selection
        If Trim(tRange.Value) <> "" Then
            i = i + 1
            objExcel.ActiveCell(1, i) = tRange.Value
        End If
    Next
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    With objExcel.Sheets(1)
        .Range(.Cells(iRowNum, iColNum), .Cells(iRowNum, (iColNum + i - 1))).Select
    End With
    
    
    With objExcel.Selection
        .NumberFormat = "@"
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Font.Size = 8
    End With
    
    With objExcel.Selection.Borders
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    
    For Each b In BorderPart
        With objExcel.Selection.Borders(b)
            .LineStyle = xlContinuous
            .Weight = xlMedium
            .ColorIndex = xlAutomatic
        End With
    Next
    
    objExcel.Visible = True
    Set objExcel = Nothing
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
End Sub

'
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. (|fffd||fffd||fffd||fffd||fffd||fffd|, 2014 |fffd|)
'
Public Sub DeleteNamesInSelectionRange()
Attribute DeleteNamesInSelectionRange.VB_ProcData.VB_Invoke_Func = "d\n14"
    Dim i, j, n As Long
    Dim strSheet  As String
    Dim tRange As Range
    'Dim strAddr, strName As String
    Dim strName As String
    
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Set tRange = Application.Selection
    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    strSheet = Application.ActiveSheet.Name
    
    For i = 1 To tRange.Rows.Count
        For j = 1 To tRange.Columns.Count
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| "ss"+|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            strTemp = Mid(tRange.Cells(i, j).Address, 2, InStrRev(tRange.Cells(i, j).Address, "$") - 2)
            Range(strTemp & (i + tRange.Row - 1) & ":" & strTemp & (i + tRange.Row - 1)).Select
            
            'strAddr = ActiveCell.Name  'return "=|fffd||fffd||fffd||fffd|1!$Z$34"  // ActiveCell.Address '$R$271
            strName = NameOfActiveCell  'return "ss40093A0003j"
            
            If Not IsEmpty(strName) Then
                With ActiveWorkbook.Names
                    For n = 1 To .Count - 1
                        'If strAddr = .Item(n).RefersTo Then
                        If strName = .Item(n).Name Then
                            'strName = .Item(n).Name
                            
                            Set rgResult = Range("Data_Cells").Find(strName, , xlValues)
                            If Not rgResult Is Nothing Then
                                rgResult.EntireRow.Delete       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                            End If
                            .Item(n).Delete                     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                            Exit For
                        End If
                    Next n
                End With
            End If
        Next j
    Next i
    'MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Data_Cells)."
End Sub

 ' Function NameOfActiveCell
 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 ' Note: |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Empty.

Public Function NameOfActiveCell() As Variant
    On Error GoTo errHandle
    NameOfActiveCell = ActiveCell.Name.Name
    Exit Function
errHandle:
    NameOfActiveCell = Empty
End Function


'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ("ss" + |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|),
'|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Sub ConstFormWithoutLetter()
    Dim tRange As Range
    Dim rgResult As Range
    Dim strTemp As String
    Dim strSheet As String
    Dim strName As String
    Dim i As Long
    Dim j, n As Long
    Dim iAnswer As Byte
    
    'iAnswer = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|?", vbInformation + vbYesNo)
    iAnswer = 7 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    Set tRange = Application.Selection      ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    strSheet = Application.ActiveSheet.Name '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    '|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 2 To tRange.Rows.Count
        For j = 2 To tRange.Columns.Count
            If Len(Trim(tRange.Cells(i, 1))) > 0 And Len(Trim(tRange.Cells(1, j))) > 0 And ((iAnswer = 6) Or (iAnswer = 7 And tRange.Cells(i, j).Value <> "0")) Then
                '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| "ss"+|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                strTemp = Mid(tRange.Cells(i, j).Address, 2, InStrRev(tRange.Cells(i, j).Address, "$") - 2)
                Range(strTemp & (i + tRange.Row - 1) & ":" & strTemp & (i + tRange.Row - 1)).Select
                
                strName = "ss" & tRange.Cells(i, 1) & tRange.Cells(1, j) & tRange.Cells(1, 1)
                ActiveWorkbook.Names.Add Name:=strName, RefersTo:="=" & ActiveSheet.Name & "!" & ActiveCell.Address()

                '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Data_Cells
                Set rgResult = Range("Data_Cells").Find(strName, , xlValues)
                If rgResult Is Nothing Then
                       '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
                    n = Range("Data_Cells").Rows.Count
                    Range("Data_Cells").Cells(n, 1).EntireRow.Insert Shift:=xlShiftDown
                    Range("Data_Cells").Cells(n, 1).Value = strName
                    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    Range("Data_Cells").Cells(n, 2).Value = IIf(ActiveCell.NumberFormat = "@", "C", "F")
                    '   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                    If (InStrRev(ActiveCell.NumberFormat, ".") > 0) Then
                            Range("Data_Cells").Cells(n, 3).Value = Len(Mid(ActiveCell.NumberFormat, InStrRev(ActiveCell.NumberFormat, ".") + 1))
                    Else
                            If ActiveCell.NumberFormat <> "@" And ActiveCell.NumberFormat <> "General" Then Range("Data_Cells").Cells(n, 3).Value = 0
                    End If
                'Else
                '    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & strName & " |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| Data_Cells"
                End If
            End If
        Next
    Next
    
    'Application.ScreenUpdating = True
End Sub

'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| "ss...", |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'
Public Sub RemoveNamesSS_inList()
    Dim i As Long
    Dim strSheet As String
    Dim rgResult As Range
    
    strSheet = Application.ActiveSheet.Name
    
    For Each n In Application.ActiveWorkbook.Names
        If Left$(n.Name, 2) = "ss" Then
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
            If InStr(1, n.RefersTo, strSheet) <> 0 Then
                Set rgResult = Range("Data_Cells").Find(n.Name, , xlValues)
                If Not rgResult Is Nothing Then
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                    rgResult.EntireRow.Delete
                End If
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                n.Delete
            End If
        End If
    Next n
End Sub

Sub CopyFormula()
Attribute CopyFormula.VB_ProcData.VB_Invoke_Func = "q\n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'

    rownum = ActiveCell.Row

    Selection.AutoFill Destination:=Range("F" & rownum & ":KP" & rownum), Type:=xlFillDefault
    Range("F" & rownum & ":KP" & rownum).Select
End Sub

Sub CheckCellNamesInList()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'
    Dim k As Integer
    Dim doCheck As Boolean
    
    k = 1
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| log-|fffd||fffd||fffd||fffd||fffd|
    ActiveWorkbook.Sheets.Add After:=Sheets(Sheets.Count): ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    With ActiveWorkbook.Names
        For n = 1 To .Count - 1
            strName = .Item(n).Name
            doCheck = True
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| Data_
            If InStr(strName, "Data_") > 0 Then doCheck = False
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| Print_ (Print_Area, Print_Titles)
            If InStr(strName, "Print_") > 0 Then doCheck = False
                        
            If doCheck Then
                Set rgResult = Range("Data_Cells").Find(strName, , xlValues)
                If rgResult Is Nothing Then

                    ActiveCell(k, 1) = strName
                    ActiveCell(k, 2) = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Data_Cells"
                    k = k + 1
                End If
            End If
        Next n
    End With
    
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
On Error Resume Next
s = GetRegistrValue & "lnc2.xla"
Application.VBE.ActiveVBProject.References.AddFromFile s
Application.Run "lnc2.xla!fOpen"
Application.Run "lnc2.xla!cmdBarsShow"
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Dim i As Long
    
    With Application.VBE.ActiveVBProject.References
        For i = .Count To 1 Step -1
            If Right$(.Item(i).Name, 4) = "lnc2" Then
                Application.DisplayAlerts = True
                .Remove .Item(i)
                Exit For
            End If
        Next
    End With
End Sub

Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    On Error Resume Next
    
    Dim strName As String
    Dim strNameRange As String
    Dim i As Long
    Dim kodRekv As String
    Dim kodFKR As String
    
    Static blnChange As Boolean

    If blnChange Then
        blnChange = False
        Exit Sub
    End If
    strName = Target.Name
    If Len(strName) > 0 Then
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        strNameRange = Application.Names(, , CStr(strName)).Name
        If Len(strNameRange) > 0 Then
            With Range("Data_Cells")
                For i = 1 To .Rows.Count
                    If .Cells(i, 1) = strNameRange Then
                        If .Cells(i, 2) = "F" Then
                            If (Len(CStr(CCur(Target) - Int(CCur(Target)))) - 2) > .Cells(i, 3) Then
                                MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & .Cells(i, 3) & " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ", vbOKOnly + vbCritical, "|fffd||fffd||fffd||fffd||fffd||fffd|"
                            End If
                            blnChange = True
                            Target = Round(Target, .Cells(i, 3))
'                            Target.Activate
'                            Beep
                        End If
                        Exit For
                    End If
                Next
            End With
        End If
        
        ''
    
    End If
End Sub

Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)
    Dim lcNameCell As String

    On Error Resume Next

'    lcNameCell = Target.Name
'    If Len(lcNameCell) > 0 Then
    If IsObject(goSvod) Then
        fStartFox
    End If
'     Else
'         fInitGrid
'     End If
End Sub






INQUEST-PP=macro
