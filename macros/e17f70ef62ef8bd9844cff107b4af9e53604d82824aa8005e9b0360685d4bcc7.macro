Attribute VB_Name = "Blattschutz"
Option Explicit
Option Private Module ' Damit wird es nicht im Makrodialogfenster angezeigt

' ####################################################################
' Wenn das Blatt gesch|fffd|tzt ist wird er aufgehoben und anders herum!
' ####################################################################
Sub Blattschutz_on_off()

On Error GoTo ErrorHandler

 Dim Blatt As Worksheet
 Dim Pw As String

 Pw = Range("Einstellungen!N1").Value + "#123"

'Blattschutz aufheben
If ActiveSheet.ProtectContents = True Then
    For Each Blatt In Worksheets
        Blatt.Unprotect Pw
    Next Blatt
    ActiveWorkbook.Unprotect (Pw)
Else
    For Each Blatt In Worksheets
        Blatt.Protect Pw
    Next Blatt
    ActiveWorkbook.Protect (Pw), Structure:=True, Windows:=False
End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Blattschutz )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"

End Sub

Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' #################################################################################
' Beim |fffd|ffnner der Datei
' #################################################################################
Private Sub Workbook_Open()

' Neues Passwort setzen!
Application.Wait (Time + TimeValue("00:00:02"))
If ThisWorkbook.ReadOnly = True Then Exit Sub ' Wenn Datei schreibgesch|fffd|tzt, dann einfach abbrechen, macht das Updaten schneller
Dim PwL|fffd|nge As String, Pw As String
' Wenn Einstellungen warum auch immer beim Start sichtbar sein sollte
If Worksheets("Einstellungen").Visible <> xlVeryHidden Then Call Fehler

' Bearbeitung schneller machen
With Application
    .ScreenUpdating = False
    .Calculation = xlCalculationManual
    .EnableEvents = False
End With

' Blattschutz entfernen
ActiveWorkbook.Unprotect (Range("Einstellungen!N1").Value + "#123")
Worksheets("Auswertungen").Unprotect Range("Einstellungen!N1").Value + "#123"
Worksheets("Eintragungen").Unprotect Range("Einstellungen!N1").Value + "#123"
Worksheets("Einstellungen").Unprotect Range("Einstellungen!N1").Value + "#123"
' --------------------------

Worksheets("Einstellungen").Visible = True

' Schreibt wenn vorhanden die Nachricht auf der "Auswertungen"
Call WichtigeNachricht

Worksheets("Auswertungen").Select

' Pr|fffd|ft ob eine erneute Update|fffd|berpr|fffd|fung gestartet werden soll
If Date >= Range("Einstellungen!I11").Value Then Call Upgradepr|fffd|fung
' --------------------------

' Einstellungen verbergen!
If Worksheets("Einstellungen").Visible <> xlVeryHidden Then Worksheets("Einstellungen").Visible = xlVeryHidden
' --------------------------

' Neues Passwort generieren
PwL|fffd|nge = 17
Pw = PasswordGenerator(PwL|fffd|nge)
Range("Einstellungen!N1") = Pw ' Speichern des Passworts
' --------------------------

Call Blattschutz_on_off ' Blattschutz setzen

With Application
    .EnableEvents = True
    .Calculation = xlCalculationAutomatic
    .ScreenUpdating = True
End With

' Fehler aufgrund der Operatoren (KOMMA, PUNKT, vom System |fffd|bernehmen)
If Application.ThousandsSeparator <> "." Or Application.DecimalSeparator <> "," Then
    If MsgBox("Es wurde ein Konflikt festgestellt, welches zu Fehler f|fffd|hrt:" & Chr(13) & Chr(13) & _
    "Eingestellt auf Ihren System:" & Chr(13) & _
    "Dezimaltrennzeichen:  " & Application.DecimalSeparator & "   ben|fffd|tigt: KOMMA" & Chr(13) & _
    "Tausendertrennzeichen:  " & Application.ThousandsSeparator & "   ben|fffd|tigt: PUNKT" & Chr(13) & Chr(13) & _
    "Soll die Einstellung korrigiert werden?" & Chr(13) & Chr(13) & _
    "Manuell geht es hier: Datei > Option > Erweitert", vbYesNo + vbInformation, "Das kann zu schwierigkeiten f|fffd|hren!") = vbYes Then
        With Application
            .UseSystemSeparators = False
            .ThousandsSeparator = "."
            .DecimalSeparator = ","
        End With
    End If
End If


' Wenn Einstellungen fehlen soll die UserForm geladen werden
If Range("Auswertungen!G1").Text = "Einstellungen fehlen!" Then
    Worksheets("Auswertungen").Select
    Call UserForm_Einstellungen

End If

ThisWorkbook.Saved = True ' Wurde ja noch nichts ge|fffd|ndert!

End Sub






Attribute VB_Name = "Funktionen"
Option Explicit
Option Private Module ' Damit wird es nicht im Makrodialogfenster angezeigt
Public Zwischenablage As New DataObject

#If Win64 Then
    Public Flg As LongPtr
    Public Declare PtrSafe Function InternetGetConnectedState _
            Lib "wininet.dll" (lpdwFlags As LongPtr, _
            ByVal dwReserved As Long) As Boolean
#Else
    Public Flg As Long
    Public Declare Function InternetGetConnectedState _
            Lib "wininet.dll" (lpdwFlags As Long, _
            ByVal dwReserved As Long) As Boolean
#End If

Private Const INTERNET_CONNECTION_MODEM As Long = &H1
Private Const INTERNET_CONNECTION_LAN As Long = &H2
Private Const INTERNET_CONNECTION_PROXY As Long = &H4
Private Const INTERNET_CONNECTION_OFFLINE As Long = &H20

' #################################################################################
' Liest die Zwischenablage aus
' #################################################################################
Public Function HoleTextVonZwischenablage() As String
    
    On Error Resume Next ' Brutal um falsche Formate abzuw|fffd|rgen, gibt dann einen Leerstring
    Zwischenablage.GetFromClipboard
    
End Function

' #################################################################################
' Generiert ein neues Passwort
' #################################################################################
Public Function PasswordGenerator(ByVal lngLength As Long) As String
' Description: Generate a random password of 'user input' length
' Parameters : lngLength - the length of the password to be
' generated
' Returns : String - Randomly generated password
' Created : 08/21/1999 Andrew Ells-O'Brien
'(andrew@ellsobrien@msn.com)

On Error GoTo Err_Proc
Dim iChr As Integer
Dim c As Long
Dim strResult As String
Dim iAsc As String
Randomize Timer
For c = 1 To lngLength
' Randomly decide what set of ASCII chars we will use
iAsc = Int(3 * Rnd + 1)
'Randomly pick a char from the random set
Select Case iAsc
Case 1
iChr = Int((Asc("Z") - Asc("A") + 1) * Rnd + Asc("A"))
Case 2
iChr = Int((Asc("z") - Asc("a") + 1) * Rnd + Asc("a"))
Case 3
iChr = Int((Asc("9") - Asc("0") + 1) * Rnd + Asc("0"))
Case Else
Err.Raise 20000, , "PasswordGenerator has a problem."
End Select
strResult = strResult & Chr(iChr)
Next c
PasswordGenerator = strResult
Exit_Proc:
Exit Function
Err_Proc:
MsgBox Err.Number & ": " & Err.Description, _
vbOKOnly + vbCritical
PasswordGenerator = vbNullString
Resume Exit_Proc
End Function

' #######################################################################
' |fffd|berpr|fffd|ft ob Teil des String ein Buchstabe ist
' wird ben|fffd|tigt um bei Expedition die vorderen Leerzeichen zu entfernen!
' #######################################################################
Public Function IsCharacter(ByVal Zch As String) As Boolean
  ' Buchstaben:
  ' Findet heraus ob Gro|fffd|- / Kleinschreibung unterschieden wird
  IsCharacter = (Asc(UCase$(Zch)) <> Asc(LCase$(Zch)))
End Function


' ######################################################################################################
' Internet erreichbar?
' Quelle = https://stackoverflow.com/questions/35222503/check-internet-connection-from-excel-vba?rq=1
' ######################################################################################################
Function IsInternetConnected() As Boolean
    Dim R As Long

    R = InternetGetConnectedState(Flg, 0&)

    If Flg >= INTERNET_CONNECTION_OFFLINE Then
        Debug.Print "INTERNET_CONNECTION_OFFLINE"
    End If

    If CBool(R) Then
        IsInternetConnected = True
    Else
        IsInternetConnected = False
    End If
End Function


Attribute VB_Name = "Makros"
Option Explicit
Option Private Module ' Damit wird es nicht im Makrodialogfenster angezeigt

' #####################################################################
' Public ist alles um Verluste bei Piraten oder Aliens zu |fffd|bertragen
' #####################################################################
Public KT, GT, Spio, LJ, SJ, Xer, SS, SXer, Bomber, Zerri, Reaper, Pathfinder, Upgrade, ExpoOderLogbuch, Zeit As Integer
Public Verloren_Expedition, Verloren_Event, Verloren_Uhrzeit, Verloren_Groesse, Nein, Expedition, Einlesen, Logbuchnachtrag As String
Public Verloren_Datum, Startzeit2, Endzeit2 As Date
Public IsConnected, Connect As Boolean

Sub UserForm_Einstellungen()
' L|fffd|dt die Userform (Einstellungen)
Anfang:
    Load UF_Einstellungen
    UF_Einstellungen.Show
    ' Wird beim Beenden der Userform ausgef|fffd|hrt
    If Range("Auswertungen!G1").Text = "Einstellungen fehlen!" And Worksheets("Einstellungen").Visible = xlVeryHidden Then GoTo Anfang
End Sub

Sub UserForm_ExpoEinlesen()

    Einlesen = "Nein" ' Wenn Rang aufgestiegen bleibt er auf der Seite Eintragungen
    
    Load UF_Einlesen
    UF_Einlesen.Show

End Sub

Sub UserForm_ExpoEinlesen2() ' Beim starten aus Auswertungen

    Einlesen = "Ja" ' Wenn Rang aufgestiegen geht er auf die Seite Auswertungen
    
    Load UF_Einlesen
    UF_Einlesen.Show

End Sub

Sub UserForm_Expeditionen()

    Load UF_Expeditionen
    UF_Expeditionen.Show

End Sub

Sub UserForm_Gr|fffd||fffd|ter_Schiffsfund()

    Load UF_groesster_Schiffsfund
    UF_groesster_Schiffsfund.Show

End Sub


Sub L|fffd|schen()

' L|fffd|scht alle eingegebenen Daten in Eintragungen
Dim MaxSpalte, i As Integer

If Upgrade = 1 Then GoTo Weiter ' Wenn Aufruf durch Einstellungen > Upgrade > Eintragungen

    If MsgBox("Wollen Sie wirklich alle Daten unwiderruflich l|fffd|schen?", vbYesNo, "Alle Eintr|fffd|ge l|fffd|schen?") = vbNo Then
        MsgBox "Vorgang wurde abgebrochen!", vbInformation, "Information"
    Else
Weiter:
        Upgrade = 0
        Application.ScreenUpdating = False
        ' Passwort aufheben
        Call Blattschutz_on_off ' Blattschutz aufheben
        
        Worksheets("Einstellungen").Visible = True
        ' L|fffd|scht alles auf der Seite Einstellungen
        MaxSpalte = Sheets("Einstellungen").Range("AQ1000000").End(xlUp).Row
        If MaxSpalte < 59 Then MaxSpalte = 59
        Range(Worksheets("Einstellungen").Cells(59, 43), Worksheets("Einstellungen").Cells(MaxSpalte, 81)).ClearContents
        ' l|fffd|scht die leeren Zeilen
        Sheets("Einstellungen").Rows(112 & ":" & 1000000).Delete
        ' Urkunden Daten l|fffd|schen
        Range("Einstellungen!B41:B53").Value = ""
        
        For i = 4 To 39 Step 5
            Range(Worksheets("Einstellungen").Cells(79, i), Worksheets("Einstellungen").Cells(111, i)).ClearContents
        Next
        
        ' L|fffd|scht alles auf der Seite Eintragungen
        MaxSpalte = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row
        If MaxSpalte < 59 Then MaxSpalte = MaxSpalte + 53
        Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 44)).ClearContents
        Range(Worksheets("Eintragungen").Cells(59, 1), Worksheets("Eintragungen").Cells(MaxSpalte + 53, 54)).ClearContents
        
        With Range(Worksheets("Eintragungen").Cells(59, 1), Worksheets("Eintragungen").Cells(MaxSpalte + 53, 54))
            .Borders(xlDiagonalDown).LineStyle = xlNone
            .Borders(xlDiagonalUp).LineStyle = xlNone
            .Borders(xlEdgeLeft).LineStyle = xlNone
            .Borders(xlEdgeTop).LineStyle = xlNone
            .Borders(xlEdgeBottom).LineStyle = xlNone
            .Borders(xlEdgeRight).LineStyle = xlNone
            .Borders(xlInsideVertical).LineStyle = xlNone
            .Borders(xlInsideHorizontal).LineStyle = xlNone
        End With
        
        With Range(Worksheets("Eintragungen").Cells(59, 1), Worksheets("Eintragungen").Cells(MaxSpalte + 53, 54)).Interior
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        
        With Range(Worksheets("Eintragungen").Cells(59, 1), Worksheets("Eintragungen").Cells(MaxSpalte + 53, 54)).Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlGreaterEqual
            .IgnoreBlank = True
            .InCellDropdown = True
            .InputTitle = ""
            .ErrorTitle = ""
            .InputMessage = ""
            .ErrorMessage = ""
            .ShowInput = False
            .ShowError = False
    End With
    
    ' l|fffd|scht die leeren Zeilen
        Worksheets("Eintragungen").Rows(59 & ":" & 1000000).Delete
        
        
' Bedingte Formatierung
Cells.FormatConditions.Delete
MaxSpalte = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row + 51

' OBERSTE ZEILE ROT, wenn irgendwo Fehler
    With Range("A7")
        .FormatConditions.Add Type:=xlExpression, Formula1:="=SUCHEN("" FEHLER"";$AS$1;1)"
        .FormatConditions(Range("A7").FormatConditions.Count).SetFirstPriority
        With Range("A7").FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 255
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Jeder 2 Zeile wird Orange
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=ISTGERADE(ZEILE())"
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent6
            .TintAndShade = 0.399945066682943
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Zeile f|fffd|r den n|fffd|chsten Eintrag wird Blau
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=UND($AZ7=""OK"";$A8="""")"
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent1
            .TintAndShade = 0.599963377788629
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Bei falscher Eingabe wird die Zeile Rot
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=$AZ8=""FEHLER"""
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 255
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With

    
Call Formeln ' alle Formeln erneuern, weil durch das L|fffd|schen von Zeilen wird diese gemindert


' Passwort setzen
Call Blattschutz_on_off ' Blattschutz setzen

     Application.ScreenUpdating = True
        
    MsgBox "Eintr|fffd|ge erfolgreich gel|fffd|scht!", vbInformation, "Information"
    
End If
    
End Sub

Sub Formeln()
' -----------------------------------------------------------------------------------------------
' -----------------------------------------------------------------------------------------------
' Weil die leeren Zellen Einfluss auf die Formeln haben m|fffd|ssen diese neu gesetzt werden
' Anzahl, Art der Ereignisse
    Worksheets("Auswertungen").Range("A3").FormulaR1C1 = "=COUNTIF(Eintragungen!R[5]C[51]:R[1000000]C[51],""OK"")"
    Worksheets("Auswertungen").Range("A10").FormulaR1C1 = "=IF(R[-7]C<>0,IF(Einstellungen!R16C9=FALSE,COUNTIF(Eintragungen!R[-2]C[42]:R[1000000]C[42],"">0""),COUNTIF(Eintragungen!R[-2]C[42]:R[1000000]C[42],"">0"")&"" ( ""&TEXT(100/R3C1*COUNTIF(Eintragungen!R[-2]C[42]:R[1000000]C[42],"">0""),""[>9,94]00,0;___00,0"")&"" %)""),0)"
    Worksheets("Auswertungen").Range("A11").FormulaR1C1 = "=IF(R[-8]C<>0,IF(Einstellungen!R16C9=FALSE,COUNTIF(Eintragungen!R[-3]C[39]:R[1000000]C[39],"">0""),COUNTIF(Eintragungen!R[-3]C[39]:R[1000000]C[39],"">0"")&"" ( ""&TEXT(100/R3C1*COUNTIF(Eintragungen!R[-3]C[39]:R[1000000]C[39],"">0""),""[>9,94]00,0;___00,0"")&"" %)""),0)"
    Worksheets("Auswertungen").Range("A12").FormulaR1C1 = "=IF(R[-9]C<>0,IF(Einstellungen!R16C9=FALSE,COUNTIF(Eintragungen!R[-4]C[40]:R[1000000]C[40],"">0""),COUNTIF(Eintragungen!R[-4]C[40]:R[1000000]C[40],"">0"")&"" ( ""&TEXT(100/R3C1*COUNTIF(Eintragungen!R[-4]C[40]:R[1000000]C[40],"">0""),""[>9,94]00,0;___00,0"")&"" %)""),0)"
    Worksheets("Auswertungen").Range("A13").FormulaR1C1 = "=IF(R[-10]C<>0,IF(Einstellungen!R16C9=FALSE,COUNTIF(Eintragungen!R[-5]C[41]:R[1000000]C[41],"">0""),COUNTIF(Eintragungen!R[-5]C[41]:R[1000000]C[41],"">0"")&"" ( ""&TEXT(100/R3C1*COUNTIF(Eintragungen!R[-5]C[41]:R[1000000]C[41],"">0""),""[>9,94]00,0;___00,0"")&"" %)""),0)"
    Worksheets("Auswertungen").Range("A14").FormulaR1C1 = "=IF(R[-11]C<>0,IF(Einstellungen!R16C9=FALSE,IF(LARGE(Eintragungen!R8C54:R1000000C54,1)=0,0,LARGE(Eintragungen!R8C54:R1000000C54,1)),IF(LARGE(Eintragungen!R8C54:R1000000C54,1)=0,0,LARGE(Eintragungen!R8C54:R1000000C54,1))&"" ( ""&TEXT(100/R3C1*IF(LARGE(Eintragungen!R8C54:R1000000C54,1)=0,0,LARGE(Eintragungen!R8C54:R1000000C54,1)),""[>9,94]00,0;___00,0"")&"" %)""),0)"
' Expeditions pro Tag
    Worksheets("Auswertungen").Range("D3").FormulaR1C1 = "=ROUNDDOWN(IF(ISERROR(RC[-3]/LARGE(Eintragungen!R8C54:R1000000C54,1)),0,IF(Einstellungen!R2C8=1,RC[-3]/Einstellungen!R4C8,RC[-3]/Einstellungen!R4C8)),0)"
' Max Funde
    Worksheets("Auswertungen").Range("B24").FormulaR1C1 = "=IF(ISERROR(LARGE(Einstellungen!R7C78:Einstellungen!R1000000C78,1)),0,LARGE(Einstellungen!R7C78:Einstellungen!R1000000C78,1))"
    Worksheets("Auswertungen").Range("B25").FormulaR1C1 = "=IF(ISERROR(LARGE(Einstellungen!R7C79:Einstellungen!R1000000C79,1)),0,LARGE(Einstellungen!R7C79:Einstellungen!R1000000C79,1))"
    Worksheets("Auswertungen").Range("B26").FormulaR1C1 = "=IF(ISERROR(LARGE(Einstellungen!R7C80:Einstellungen!R1000000C80,1)),0,LARGE(Einstellungen!R7C80:Einstellungen!R1000000C80,1))"
    Worksheets("Auswertungen").Range("B27").FormulaR1C1 = "=IF(ISERROR(LARGE(Einstellungen!R7C81:Einstellungen!R1000000C81,1)),0,LARGE(Einstellungen!R7C81:Einstellungen!R1000000C81,1))"
    Worksheets("Auswertungen").Range("B28").FormulaArray = "=MAX(Einstellungen!R[-20]C[43]:R[1000000]C[43]+Einstellungen!R[-20]C[44]:R[1000000]C[44])"
' Gr|fffd||fffd|te Schifffunde
    Worksheets("Auswertungen").Range("E25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("F25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("H25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("I25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("J25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("K25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("L25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("M25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("N25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("O25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[19]:R1000000C[19],1)),0,LARGE(Eintragungen!R8C[19]:R1000000C[19],1))"
    Worksheets("Auswertungen").Range("P25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[21]:R1000000C[21],1)),0,LARGE(Eintragungen!R8C[21]:R1000000C[21],1))"
    Worksheets("Auswertungen").Range("Q25").FormulaR1C1 = "=IF(ISERROR(LARGE(Eintragungen!R8C[21]:R1000000C[21],1)),0,LARGE(Eintragungen!R8C[21]:R1000000C[21],1))"
    
' Gr|fffd||fffd|te Schiffverluste
    Worksheets("Auswertungen").Range("E28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("F28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("G28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("H28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("I28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("J28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("K28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("L28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("M28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("N28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("O28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1)))),0,IF(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[19]:R1000000C[19],1)),0,SMALL(Eintragungen!R8C[19]:R1000000C[19],1))))"
    Worksheets("Auswertungen").Range("P28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)),0,SMALL(Eintragungen!R8C[21]:R1000000C[21],1)))),0,IF(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)),0,SMALL(Eintragungen!R8C[21]:R1000000C[21],1))))"
    Worksheets("Auswertungen").Range("Q28").FormulaR1C1 = "=IF(ISERROR(IF(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)),0,SMALL(Eintragungen!R8C[21]:R1000000C[21],1)))),0,IF(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)>=0,0,IF(ISERROR(SMALL(Eintragungen!R8C[21]:R1000000C[21],1)),0,SMALL(Eintragungen!R8C[21]:R1000000C[21],1))))"
' Gesamt gefundene Rohstoffe
    Worksheets("Auswertungen").Range("B33").FormulaR1C1 = "=SUM(Eintragungen!R8C40:R1000000C40)"
    Worksheets("Auswertungen").Range("B34").FormulaR1C1 = "=SUM(Eintragungen!R8C41:R1000000C41)"
    Worksheets("Auswertungen").Range("B35").FormulaR1C1 = "=SUM(Eintragungen!R8C42:R1000000C42)"
    Worksheets("Auswertungen").Range("B37").FormulaR1C1 = "=SUM(Eintragungen!R8C43:R1000000C43)"
' Gefundene Schiffe
    Worksheets("Auswertungen").Range("D34:E34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C24:R1000000C34,"">0"",Eintragungen!R8C24:R1000000C34)"
    Worksheets("Auswertungen").Range("F34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("G34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("I34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("J34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("K34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("L34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("M34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("N34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("O34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("P34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],"">0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("Q34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[20]:R1000000C[20],"">0"",Eintragungen!R8C[20]:R1000000C[20])"
    Worksheets("Auswertungen").Range("R34").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[20]:R1000000C[20],"">0"",Eintragungen!R8C[20]:R1000000C[20])"
' Verlorene Schiffe
    Worksheets("Auswertungen").Range("D37:E37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C24:R1000000C34,""<0"",Eintragungen!R8C24:R1000000C34)"
    Worksheets("Auswertungen").Range("F37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("G37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("H37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("I37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("J37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("K37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("L37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("M37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("N37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("O37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("P37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[18]:R1000000C[18],""<0"",Eintragungen!R8C[18]:R1000000C[18])"
    Worksheets("Auswertungen").Range("Q37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[20]:R1000000C[20],"">0"",Eintragungen!R8C[20]:R1000000C[20])"
    Worksheets("Auswertungen").Range("R37").FormulaR1C1 = "=SUMIF(Eintragungen!R8C[20]:R1000000C[20],"">0"",Eintragungen!R8C[20]:R1000000C[20])"
' Gesamtbilanz
    Worksheets("Auswertungen").Range("O4:P4").FormulaR1C1 = "=(SUMIF(Einstellungen!R8C45:R1000000C45,"">0"",Einstellungen!R8C45:R1000000C45)/100*VLOOKUP(Einstellungen!R2C2,Einstellungen!R4C1:R5C2,2,FALSE)+SUM(Einstellungen!R7C4:R16C4))+R33C2+SUMIF(Einstellungen!R8C45:R1000000C45,""<0"",Einstellungen!R8C45:R1000000C45)"
    Worksheets("Auswertungen").Range("O6:P6").FormulaR1C1 = "=(SUMIF(Einstellungen!R8C46:R1000000C46,"">0"",Einstellungen!R8C46:R1000000C46)/100*VLOOKUP(Einstellungen!R2C2,Einstellungen!R4C1:R5C2,2,FALSE)+SUM(Einstellungen!R7C5:R16C5))+R34C2+SUMIF(Einstellungen!R8C46:R1000000C46,""<0"",Einstellungen!R8C46:R1000000C46)"
    Worksheets("Auswertungen").Range("O8:P8").FormulaR1C1 = "=(SUMIF(Einstellungen!R8C47:R1000000C47,"">0"",Einstellungen!R8C47:R1000000C47)/100*VLOOKUP(Einstellungen!R2C2,Einstellungen!R4C1:R5C2,2,FALSE)+SUM(Einstellungen!R7C6:R16C6))+R35C2+SUMIF(Einstellungen!R8C47:R1000000C47,""<0"",Einstellungen!R8C47:R1000000C47)-R9C18"
' Flottenbilanz
    Worksheets("Auswertungen").Range("R5:S5").FormulaR1C1 = "=SUMIF(Einstellungen!R8C45:R1000000C47,"">0"",Einstellungen!R8C45:R1000000C47)"
    Worksheets("Auswertungen").Range("R7:S7").FormulaR1C1 = "=SUMIF(Einstellungen!R8C45:R1000000C47,""<0"",Einstellungen!R8C45:R1000000C47)"
    Worksheets("Auswertungen").Range("R9:S9").FormulaR1C1 = "=IF(SUM(Eintragungen!R8C3:R1000000C13)=0,0,SUM(Einstellungen!R8C43:R1000000C43))"
' Schiffsbilanz
    Worksheets("Auswertungen").Range("U3").FormulaR1C1 = "=SUM(Eintragungen!R8C24:R1000000C24)"
    Worksheets("Auswertungen").Range("U4").FormulaR1C1 = "=SUM(Eintragungen!R8C25:R1000000C25)"
    Worksheets("Auswertungen").Range("U5").FormulaR1C1 = "=SUM(Eintragungen!R8C26:R1000000C26)"
    Worksheets("Auswertungen").Range("U6").FormulaR1C1 = "=SUM(Eintragungen!R8C27:R1000000C27)"
    Worksheets("Auswertungen").Range("U7").FormulaR1C1 = "=SUM(Eintragungen!R8C28:R1000000C28)"
    Worksheets("Auswertungen").Range("U8").FormulaR1C1 = "=SUM(Eintragungen!R8C29:R1000000C29)"
    Worksheets("Auswertungen").Range("U9").FormulaR1C1 = "=SUM(Eintragungen!R8C30:R1000000C30)"
    Worksheets("Auswertungen").Range("U10").FormulaR1C1 = "=SUM(Eintragungen!R8C31:R1000000C31)"
    Worksheets("Auswertungen").Range("U11").FormulaR1C1 = "=SUM(Eintragungen!R8C32:R1000000C32)"
    Worksheets("Auswertungen").Range("U12").FormulaR1C1 = "=SUM(Eintragungen!R8C33:R1000000C33)"
    Worksheets("Auswertungen").Range("U13").FormulaR1C1 = "=SUM(Eintragungen!R8C34:R1000000C34)"
    
' Sonstige Ereignisse
    Worksheets("Eintragungen").Range("Q5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("R5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("S5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("T5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("U5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("V5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("W5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
    Worksheets("Eintragungen").Range("X5").FormulaR1C1 = "=COUNTIF(R8C:R1000000C,""x"")"
' Items Event
    Worksheets("Eintragungen").Range("AR6").FormulaR1C1 = "=COUNTIF(R[2]C:R[1000000]C,""*Item*"")"
' Fehlerstatus
    Worksheets("Eintragungen").Range("AS1:AZ1").FormulaR1C1 = "=CONCATENATE(""Fehlerstatus:   "",IF(AND(Auswertungen!R1C7<>""Einstellungen fehlen!"",ISERROR(VLOOKUP(""FEHLER"",R[7]C[7]:R[1000000]C[7],1,FALSE))),""OK"",""FEHLER""))"
    Worksheets("Eintragungen").Range("AS3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Kein oder mehrere Ereignisse ausgew|fffd|hlt !!!"")"
    Worksheets("Eintragungen").Range("AS7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AS8").FormulaR1C1 = "=IF(AND(SUM(RC[-44]:RC[-30])=0,RC[-28]="""",RC[-27]="""",RC[-26]="""",RC[-25]="""",RC[-24]="""",RC[-23]="""",RC[-22]="""",RC[-21]=""""),""OK"",IF(COUNTIF(RC[-28]:RC[-21],"""")=7,""OK"",""FEHLER""))"
    Worksheets("Eintragungen").Range("AT3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Kein Datum oder Anzahl der versendeten Flotte fehlt !!!"")"
    Worksheets("Eintragungen").Range("AT7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AT8").FormulaR1C1 = "=IF(AND(SUM(RC[-45]:RC[-31])=0,SUM(RC[-20]:RC[-8],RC[-6]:RC[-3])<>0),""FEHLER"",IF(AND(SUM(RC[-45]:RC[-31])=0,RC[-28]="""",RC[-27]="""",RC[-26]="""",RC[-25]="""",RC[-24]="""",RC[-23]=""""),""OK"",IF(AND(RC[-45]<>"""",SUM(RC[-43]:RC[-31])>0),""OK"",""FEHLER"")))"
    Worksheets("Eintragungen").Range("AU3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Ereignis Erfolg: Schifffund oder Rohstofffund wurde nicht eingetragen !!!"")"
    Worksheets("Eintragungen").Range("AU7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AU8").FormulaR1C1 = "=IF(RC[-30]="""",""OK"",IF(AND(SUM(Einstellungen!RC[-2]:RC)<>0,SUM(RC[-7]:RC[-4])<>0,(RC[-3]="""")),""FEHLER"",IF(AND(RC[-30]<>"""",OR(SUM(Einstellungen!RC[-2]:RC)>0,SUM(RC[-7]:RC[-4])>0,(RC[-3]<>""""))),""OK"",""FEHLER"")))"
    Worksheets("Eintragungen").Range("AV3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Bei Ereignissen wie: Nichts , Verfr|fffd|hung , Versp|fffd|tung sowie H|fffd|ndler kann man keine Flotten verlieren, gewinnen oder Rohstoffe finden !!!"")"
    Worksheets("Eintragungen").Range("AV7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AV8").FormulaR1C1 = "=IF(AND(RC[-30]="""",RC[-27]="""",RC[-26]="""",RC[-25]=""""),""OK"",IF(AND(OR(RC[-30]<>"""",RC[-27]<>"""",RC[-26]<>"""",RC[-25]<>""""),SUM(Einstellungen!RC[-3]:RC[-1],RC[-8]:RC[-5])=0),""OK"",""FEHLER""))"
    Worksheets("Eintragungen").Range("AW3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Bei Piraten- oder Alienangriffen kann man keine Rohstoffe oder Flotten finden, maximal verlieren !!!"")"
    Worksheets("Eintragungen").Range("AW7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AW8").FormulaR1C1 = "=IF(AND(RC[-30]="""",RC[-29]=""""),""OK"",IF(AND(OR(RC[-30]<>"""",RC[-29]<>""""),SUM(Einstellungen!RC[-4]:RC[-2])<=0,RC[-9]="""",RC[-8]="""",RC[-7]="""",RC[-6]=""""),""OK"",""FEHLER""))"
    Worksheets("Eintragungen").Range("AX3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Verluste bei Totalausfall fehlerhaft !!!"")"
    Worksheets("Eintragungen").Range("AX7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AX8").FormulaR1C1 = "=IF(RC[-26]="""",""OK"",IF(OR(RC[-24]>0,RC[-23]>0,RC[-22]>0,RC[-21]>0,RC[-20]>0,RC[-19]>0,RC[-18]>0,RC[-17]>0,RC[-16]>0,RC[-15]>0,RC[-14]>0,RC[-13]>0,RC[-12]>0),""Fehler"",IF(SUM(RC[-47]:RC[-35])=(SUM(RC[-24]:RC[-12])*-1),""OK"",""FEHLER"")))"
    Worksheets("Eintragungen").Range("AY3").FormulaR1C1 = "=IF(R[4]C=0,"""",""          !!! Pro Expedition kann nur eine Rohstoffart gefunden werden !!!"")"
    Worksheets("Eintragungen").Range("AY7").FormulaR1C1 = "=COUNTIF(R[1]C:R[1000000]C,""Fehler"")"
    Worksheets("Eintragungen").Range("AY8").FormulaR1C1 = "=IF(RC[-34]="""",""OK"",IF(OR(RC[-11]=SUM(RC[-11]:RC[-8]),RC[-10]=SUM(RC[-11]:RC[-8]),RC[-9]=SUM(RC[-11]:RC[-8]),RC[-8]=SUM(RC[-11]:RC[-8])),""OK"",""FEHLER""))"
    Worksheets("Eintragungen").Range("AZ8").FormulaR1C1 = "=IF(ISERROR(SUM(RC[-7]:RC[-1])),""FEHLER"",IF(AND(SUM(RC[-51]:RC[-37],Einstellungen!RC[-7]:RC[-5],RC[-12]:RC[-9])=0,COUNTIF(RC[-35]:RC[-28],""x"")=0),"""",IF(COUNTIF(RC[-7]:RC[-1],""OK"")=7,""OK"",""FEHLER"")))"
    Worksheets("Eintragungen").Range("BA8").FormulaR1C1 = "=IF(RC[-52]<>"""",1,0)"
    Worksheets("Eintragungen").Range("BA9").FormulaR1C1 = "=IF(OR(R[-1]C[-48]="""",RC[-48]=""""),"""",IF(AND(RC[-48]<>"""",R[-1]C[-48]=RC[-48]),R[-1]C,R[-1]C+1))"
    Worksheets("Eintragungen").Range("BB8").FormulaR1C1 = "=IF(SUM(RC[-28]:RC[-16])>0,1,0)"
    Worksheets("Eintragungen").Range("BB9").FormulaR1C1 = "=IF(RC[-49]="""","""",IF(SUM(RC[-26]:RC[-16])>0,R[-1]C+1,R[-1]C))"
    
    ' Einstellungen
    Worksheets("Einstellungen").Range("H4").FormulaR1C1 = "=IF(R2C8=1,LARGE(Eintragungen!R8C53:R1000000C53,1),LARGE(Eintragungen!R8C1:R1000000C1,1)-SMALL(Eintragungen!R8C1:R1000000C1,1)+1)"
    Worksheets("Einstellungen").Visible = xlVeryHidden
    
' -----------------------------------------------------------------------------------------------
' -----------------------------------------------------------------------------------------------

End Sub

Sub Upgradepr|fffd|fung()
Dim Manuell, V1, V2, Version, UniListe As String
On Error GoTo Fehler

Application.ScreenUpdating = False

Manuell = "Nein"

' Wird nur genutzt wenn manuell angesto|fffd|en wird
If ActiveSheet.ProtectContents = True Then
    Manuell = "Ja"
    Call Blattschutz_on_off
End If
' ---------------------------

ThisWorkbook.Worksheets("Einstellungen").Visible = True
Worksheets("Einstellungen").Select

    ' L|fffd|dt die aktuelle Versionsnummer herunter
    With ActiveSheet.QueryTables.Add(Connection:="URL;http://basisa.lima-city.de/download/Expeditionsversion.txt", Destination:=Sheets("Einstellungen").Range("$I$9")) 'Text Datei im Inet mit der Version
        .Name = "version"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With

    Columns("H:H").EntireColumn.AutoFit
    Columns("I:I").EntireColumn.AutoFit
    
    ' L|fffd|dt das aktuelle Datum der Universumliste herunter
    With ActiveSheet.QueryTables.Add(Connection:="URL;http://basisa.lima-city.de/download/Universumliste.txt", Destination:=Sheets("Einstellungen").Range("$AB$57")) 'Text Datei im Inet mit der Version
        .Name = "Datum"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With

    Columns("AB:AB").EntireColumn.AutoFit
    

' -----------------------------

    
    Sheets("Einstellungen").Range("I10").Value = Date ' Datum der Pr|fffd|fung eintragen


' ---------------------------

' Was passiert wenn eine neue Version da ist"
' Leerzeichen und die Punkte der Versionen entfernen zum besseren Vergleich!
V1 = ThisWorkbook.Sheets("Einstellungen").Range("I8").Value ' Version der Datei
V1 = Replace(V1, " ", "")
V1 = Replace(V1, ".", "")

V2 = ThisWorkbook.Sheets("Einstellungen").Range("I9").Value ' Version im Internet
V2 = Replace(V2, " ", "")
V2 = Replace(V2, ".", "")

' Wenn Dateiversion unterschiedlich Meldung machen!
If V1 <> V2 Then
        If MsgBox("Es ist eine neue Version verf|fffd|gbar!!" & Chr(13) & Chr(13) & _
        "Ihre Version: " & Chr(13) & Range("Einstellungen!I8") & Chr(13) & Chr(13) & _
        "Neue Version: " & Chr(13) & Range("Einstellungen!I9") & Chr(13) & Chr(13) & Chr(13) & _
        "Wollen Sie zur Webseite?", vbYesNo + vbInformation, "Update|fffd|berpr|fffd|fung") = vbYes Then
            ThisWorkbook.FollowHyperlink Address:="http://basisa.lima-city.de/index.php/de/downloads", NewWindow:=True 'Download Link ( ExpeditionsrechnerNEU.xlsm )
            GoTo Ende
        Else
            Version = " neue verf|fffd|gbar!"
        End If
Else
        Version = " ist aktuell!"
End If

        ' Wenn neue Universumliste, dann l|fffd|sche die Alte und lade Neue!
If CDate(Sheets("Einstellungen").Range("AB57").Value) > CDate(Sheets("Einstellungen").Range("AB56").Value) Then
        Sheets("Einstellungen").Range("X8:AB55").Clear
        
      With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _
        "OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=Universumliste;Extended Properties=""""" _
        , Destination:=ThisWorkbook.Sheets("Einstellungen").Range("$X$8")).QueryTable
        .CommandType = xlCmdSql
        .CommandText = Array("SELECT * FROM [Universumliste]")
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .PreserveColumnInfo = False
        .ListObject.DisplayName = "Universumliste"
        .Refresh BackgroundQuery:=False
    End With
    Sheets("Einstellungen").Range("X8:AB55").ListObject.QueryTable.Refresh BackgroundQuery:=False
    'Sheets("Einstellungen").Application.CommandBars("Workbook Queries").Visible = False ' funktioniert aus welchem Grund nicht immer
        
    ' Neue Liste formatieren (wei|fffd| und mit Rahmen)
    Range("X8:AB55").Select
    ActiveSheet.ListObjects("Universumliste").TableStyle = ""
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    ThisWorkbook.Sheets("Einstellungen").ListObjects("Universumliste").ShowAutoFilter = False ' AutoFilter aus schalten
                
    ' Datum in "Einstellungen AB56" |fffd|ndern
    ThisWorkbook.Sheets("Einstellungen").Range("AB56").Value = ThisWorkbook.Sheets("Einstellungen").Range("AB57").Value
    
    UniListe = " wurde erneuert!"
    
    Else
    
    UniListe = " ist aktuell!"

End If

MsgBox "Update|fffd|berpr|fffd|fung durchgef|fffd|hrt!" & Chr(13) & _
       "*************************************" & Chr(13) & Chr(13) & _
       "Expeditionstool : " & Version & Chr(13) & Chr(13) & _
       "Universumliste   : " & UniListe, vbOKOnly + vbInformation, "Update|fffd|berpr|fffd|fung"

Ende:

' L|fffd|scht alle Verbindungen!
Call VerbLoeschen

'L|fffd|scht alle Namen aus dem Namensmanager
     Dim objName As Name
     For Each objName In ActiveWorkbook.Names
        If LCase(Left(objName.Name, 6)) <> "_xlfn." Then objName.Delete
     Next

Worksheets("Auswertungen").Select
Worksheets("Einstellungen").Visible = xlVeryHidden
Application.ScreenUpdating = True

' Wird nur genutz wenn manuell angesto|fffd|en wird
If Manuell = "Ja" And ActiveSheet.ProtectContents = False Then
    Call Blattschutz_on_off
End If

Exit Sub

Fehler:
On Error Resume Next

Application.ScreenUpdating = False
ThisWorkbook.Worksheets("Einstellungen").Visible = True
Worksheets("Einstellungen").Select

' Um Fehler wegen Unisversum gibt es nicht vorzubeugen, automatisch U1 in Liste eintragen!
ThisWorkbook.Sheets("Einstellungen").Range("X9").Value = 1
ThisWorkbook.Sheets("Einstellungen").Range("Y9").Value = 9
ThisWorkbook.Sheets("Einstellungen").Range("Z9").Value = 499
ThisWorkbook.Sheets("Einstellungen").Range("AA9").Value = 1
ThisWorkbook.Sheets("Einstellungen").Range("AB9").Value = 1
ThisWorkbook.Sheets("Einstellungen").Range("S2").Value = 1

Worksheets("Auswertungen").Select
ThisWorkbook.Worksheets("Einstellungen").Visible = xlSheetVeryHidden

If Manuell = "Ja" And ActiveSheet.ProtectContents = False Then
    Call Blattschutz_on_off
End If

On Error GoTo 0

MsgBox "Es ist ein Fehler bei der |fffd|berpr|fffd|fung auf Updates aufgetaucht!" & Chr(13) & Chr(13) & _
"M|fffd|glicherweise sind Sie nicht mit dem Internet verbunden!" & Chr(13) & _
"Oder die Webseite kann momentan nicht erreicht werden!", vbOKOnly + vbCritical, "Update|fffd|berpr|fffd|fung fehlgeschlagen"

End Sub

Sub WichtigeNachricht()
On Error GoTo Weiter ' Wenn zum Beispiel kein Internet vorhanden ist!

'Application.ScreenUpdating = False

If IsInternetConnected Then
'If Ping("8.8.8.8") Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

'ActiveWorkbook.Unprotect Range("Einstellungen!N1").Value + "#123"
' ---------------------------

'ThisWorkbook.Worksheets("Einstellungen").Visible = True
Worksheets("Einstellungen").Select

' L|fffd|dt herunter ob die Information angezeigt werden soll oder nicht ( "Ja" oder "Nein" )
    With ActiveSheet.QueryTables.Add(Connection:="URL;http://basisa.lima-city.de/download/Expeditionsnachrichtjanein.txt", Destination:=Sheets("Einstellungen").Range("$H$13")) 'Text Datei im Inet der Information
        .Name = "version"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With


    ' L|fffd|dt die aktuelle Nachricht herunter
If Sheets("Einstellungen").Range("$H$13").Value = "Ja " Then
    With ActiveSheet.QueryTables.Add(Connection:="URL;http://basisa.lima-city.de/download/Expeditionsnachricht.txt", Destination:=Sheets("Einstellungen").Range("$I$13")) 'Text Datei im Inet der Information
        .Name = "version"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
End If


' Bei Fehler hierher, wenn die Nachricht nicht angezeigt wird ist das kein Problem!
Weiter:

' L|fffd|scht alle Verbindungen!
Call VerbLoeschen

Else

End If

'Worksheets("Auswertungen").Select
'Worksheets("Einstellungen").Visible = xlVeryHidden

'Application.ScreenUpdating = True

End Sub

Sub VerbLoeschen()

Dim cn
Dim qt As QueryTable
Dim lo As ListObject
Dim ws As Worksheet
For Each ws In ThisWorkbook.Worksheets
    For Each qt In ws.QueryTables
        qt.Delete
    Next qt
    On Error Resume Next 'Ignore error if there's no query in table.
    For Each lo In ws.ListObjects
        lo.QueryTable.Delete
    Next lo
    On Error GoTo 0
Next ws

End Sub

' Wenn ein Fehler auftauchen sollte, damit alles gesperrt bleibt und nichts sichtbar wird!
Sub Fehler()

ThisWorkbook.Sheets("Auswertungen").Select

Application.ScreenUpdating = False

' Blattschutz entfernen
    ActiveWorkbook.Unprotect (Range("Einstellungen!N1").Value + "#123")
    Worksheets("Auswertungen").Unprotect Range("Einstellungen!N1").Value + "#123"
    Worksheets("Eintragungen").Unprotect Range("Einstellungen!N1").Value + "#123"
    Worksheets("Einstellungen").Unprotect Range("Einstellungen!N1").Value + "#123"
    
    Worksheets("Einstellungen").Visible = xlVeryHidden
    
' Blattschutz hinzuf|fffd|gen
    
    Worksheets("Auswertungen").Protect Range("Einstellungen!N1").Value + "#123"
    Worksheets("Eintragungen").Protect Range("Einstellungen!N1").Value + "#123"
    Worksheets("Einstellungen").Protect Range("Einstellungen!N1").Value + "#123"
    ActiveWorkbook.Protect (Range("Einstellungen!N1").Value + "#123")
    
Application.ScreenUpdating = True
    



      

End Sub







Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' #################################################################################
' Wenn die Sheet gew|fffd|hlt wird, springe zu A1
' #################################################################################
Private Sub Worksheet_Activate()
' Wenn der Reiter "Auswertungen" Aktiviert wird springt er in die Zelle "A1"

    Range("Auswertungen!A1").Select

End Sub

' #################################################################################
' Um sich den Fortschritt im Archievments anzeigen zu lassen
' #################################################################################
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

    If ActiveCell.Address = "$V$3" Then
        If Sheets("Einstellungen").Range("B76").Value = 0 Then Exit Sub
        Cancel = True
        Load UF_Archievments
        UF_Archievments.Show
    End If

End Sub

Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

' #################################################################################
' Wenn die Sheet gew|fffd|hlt wird, springe zur letzten Zeile
' #################################################################################
Private Sub Worksheet_Activate()
Dim MaxSpalte As String
Dim i As Integer

' ############################ WICHTIG !!! #######################################################
    On Error GoTo Ende 'Es kommt sonst zum Fehler beim Upgrade ( Wiederherstellung )
' ############################ WICHTIG !!! #######################################################

' Wenn der Reiter "Eintragungen" Aktiviert wird springt er in die letzt Zeile
    MaxSpalte = Range("A1000000").End(xlUp).Row
    Cells(MaxSpalte + 1, 1).Select
' -----------------------------------


' #############################################################
' F|fffd|r diejenigen die noch was manuel eintragen!
' wenn weniger als 30 freie Zeilen, dann mache wieder 51 frei

    If Range("AS1000000").End(xlUp).Row - MaxSpalte < 30 Then
    i = 51 - (Range("AS1000000").End(xlUp).Row - MaxSpalte) 'so viele Zeilen werden wieder ben|fffd|tigt

    ' Damit es schneller geht
    With Application
        .ScreenUpdating = False
        .Calculation = xlCalculationManual
        .EnableEvents = False
    End With

    ' Passwort aufheben
    Call Blattschutz_on_off ' Blattschutz entfernen

    ' Kopiert auf Eintragungen einen nach unten
    MaxSpalte = Worksheets("Eintragungen").Range("AS1000000").End(xlUp).Row
    Worksheets("Eintragungen").Rows(MaxSpalte & ":" & MaxSpalte).Copy _
    Worksheets("Eintragungen").Rows(MaxSpalte + 1 & ":" & MaxSpalte + i)
    Application.CutCopyMode = False

    ' Kopiert auf den Einstellungen die Flotte ( Blau 1x mal nach unten )
    Worksheets("Einstellungen").Visible = True
    MaxSpalte = Worksheets("Einstellungen").Range("AQ1000000").End(xlUp).Row
    Worksheets("Einstellungen").Range(Worksheets("Einstellungen").Cells(MaxSpalte, 43), Worksheets("Einstellungen").Cells(MaxSpalte, 81)).Copy
    Worksheets("Einstellungen").Range(Worksheets("Einstellungen").Cells(MaxSpalte + 1, 43), Worksheets("Einstellungen").Cells(MaxSpalte + i, 43)).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Worksheets("Einstellungen").Visible = xlSheetVeryHidden

    ' Passwort setzen
    Call Blattschutz_on_off ' Blattschutz entfernen

    With Application
        .EnableEvents = True
        .Calculation = xlCalculationAutomatic
        .ScreenUpdating = True
    End With

    End If


Ende:
End Sub
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "UF_Adminbereich"
Attribute VB_Base = "0{85B5AEA5-4D0F-4761-BFD5-362DAF99B87A}{81A32E02-958C-404A-A8C6-1FB7F408F2C6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub B_Enter_Click()
' Damit man in den Einstellungen kommen kann!

If Me.T_Benutzername = "Basisa" And Me.T_Passwort = "Meister" Then
    
    Call Blattschutz_on_off ' Blattschutz aufheben
    
    Worksheets("Einstellungen").Visible = True ' Einstellungen sichtbar machen
    
    Unload Me

    Worksheets("Einstellungen").Select
    Range("Einstellungen!A1").Select
Else
    Unload Me
    Call UserForm_Einstellungen
End If

End Sub

Attribute VB_Name = "UF_Archievments"
Attribute VB_Base = "0{0A59C932-9CB0-49CD-B259-5D7DD1F57FF0}{18220406-8CD2-4665-B99F-C3E448A42B23}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Activate()

' Expeditionen
If Range("Einstellungen!B21").Value = "Ja" Then Me.I_Expedition_B.Visible = True
If Range("Einstellungen!C21").Value = "Ja" Then Me.I_Expedition_S.Visible = True
If Range("Einstellungen!D21").Value = "Ja" Then Me.I_Expedition_G.Visible = True

' Nichts
If Range("Einstellungen!B22").Value = "Ja" Then Me.I_Nichts_B.Visible = True
If Range("Einstellungen!C22").Value = "Ja" Then Me.I_Nichts_S.Visible = True
If Range("Einstellungen!D22").Value = "Ja" Then Me.I_Nichts_G.Visible = True

' zeitliche Verz|fffd|gerung
If Range("Einstellungen!B23").Value = "Ja" Then Me.I_zeitliche_Verz|fffd|gerung_B.Visible = True
If Range("Einstellungen!C23").Value = "Ja" Then Me.I_zeitliche_Verz|fffd|gerung_S.Visible = True
If Range("Einstellungen!D23").Value = "Ja" Then Me.I_zeitliche_Verz|fffd|gerung_G.Visible = True

' Piraten
If Range("Einstellungen!B24").Value = "Ja" Then Me.I_Piraten_B.Visible = True
If Range("Einstellungen!C24").Value = "Ja" Then Me.I_Piraten_S.Visible = True
If Range("Einstellungen!D24").Value = "Ja" Then Me.I_Piraten_G.Visible = True

' Aliens
If Range("Einstellungen!B25").Value = "Ja" Then Me.I_Aliens_B.Visible = True
If Range("Einstellungen!C25").Value = "Ja" Then Me.I_Aliens_S.Visible = True
If Range("Einstellungen!D25").Value = "Ja" Then Me.I_Aliens_G.Visible = True

' Totalverluste
If Range("Einstellungen!B26").Value = "Ja" Then Me.I_Totalverluste_B.Visible = True
If Range("Einstellungen!C26").Value = "Ja" Then Me.I_Totalverluste_S.Visible = True
If Range("Einstellungen!D26").Value = "Ja" Then Me.I_Totalverluste_G.Visible = True

' Ressourcenfunde
If Range("Einstellungen!B27").Value = "Ja" Then Me.I_ResFunde_B.Visible = True
If Range("Einstellungen!C27").Value = "Ja" Then Me.I_ResFunde_S.Visible = True
If Range("Einstellungen!D27").Value = "Ja" Then Me.I_ResFunde_G.Visible = True

' Ressourcenmenge
If Range("Einstellungen!B28").Value = "Ja" Then Me.I_ResMenge_B.Visible = True
If Range("Einstellungen!C28").Value = "Ja" Then Me.I_ResMenge_S.Visible = True
If Range("Einstellungen!D28").Value = "Ja" Then Me.I_ResMenge_G.Visible = True

' Dunkle Materie
If Range("Einstellungen!B29").Value = "Ja" Then Me.I_DM_B.Visible = True
If Range("Einstellungen!C29").Value = "Ja" Then Me.I_DM_S.Visible = True
If Range("Einstellungen!D29").Value = "Ja" Then Me.I_DM_G.Visible = True

' Flottenfund
If Range("Einstellungen!B30").Value = "Ja" Then Me.I_Flottenfund_B.Visible = True
If Range("Einstellungen!C30").Value = "Ja" Then Me.I_Flottenfund_S.Visible = True
If Range("Einstellungen!D30").Value = "Ja" Then Me.I_Flottenfund_G.Visible = True

' Items
If Range("Einstellungen!B31").Value = "Ja" Then Me.I_Items_B.Visible = True
If Range("Einstellungen!C31").Value = "Ja" Then Me.I_Items_S.Visible = True
If Range("Einstellungen!D31").Value = "Ja" Then Me.I_Items_G.Visible = True

' Verluste
If Range("Einstellungen!B32").Value = "Ja" Then Me.I_Verluste_B.Visible = True
If Range("Einstellungen!C32").Value = "Ja" Then Me.I_Verluste_S.Visible = True
If Range("Einstellungen!D32").Value = "Ja" Then Me.I_Verluste_G.Visible = True

' Spritschleuder
If Range("Einstellungen!B33").Value = "Ja" Then Me.I_Sprit_B.Visible = True
If Range("Einstellungen!C33").Value = "Ja" Then Me.I_Sprit_S.Visible = True
If Range("Einstellungen!D33").Value = "Ja" Then Me.I_Sprit_G.Visible = True

' Fundgr|fffd||fffd|en
If Range("Einstellungen!B34").Value = "Ja" Then Me.I_Fundgr|fffd|ssen_B.Visible = True
If Range("Einstellungen!C34").Value = "Ja" Then Me.I_Fundgr|fffd|ssen_S.Visible = True
If Range("Einstellungen!D34").Value = "Ja" Then Me.I_Fundgr|fffd|ssen_G.Visible = True

' H|fffd|ndler
If Range("Einstellungen!B35").Value = "Ja" Then Me.I_H|fffd|ndler_B.Visible = True
If Range("Einstellungen!C35").Value = "Ja" Then Me.I_H|fffd|ndler_S.Visible = True
If Range("Einstellungen!D35").Value = "Ja" Then Me.I_H|fffd|ndler_G.Visible = True

End Sub
Attribute VB_Name = "UF_Einlesen"
Attribute VB_Base = "0{C89E077E-B427-4F46-8408-9E5CE856899C}{2B35024E-FE10-448A-A652-D22F1C2B84BA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Activate()

If Range("Einstellungen!O12") = True Then

        Me.L_empfohleneFlotte.Caption = "-> automatische Eintragung immer mit 0 Verlusten!"
        Me.L_empfohleneFlotte.ForeColor = &HFF&

'    If Range("Einstellungen!N35") = True Or Range("Einstellungen!O35") = True Then
'        Me.L_empfohleneFlotte.Caption = "Sie verwenden die empfohlene Flotte!"
'        Me.L_empfohleneFlotte.ForeColor = &HC000&
'    Else
'        Me.L_empfohleneFlotte.Caption = "Sie verwenden nicht die empfohlene Flotte!"
'        Me.L_empfohleneFlotte.ForeColor = &HFF&
'    End If

End If


End Sub


' ###################################################
' Einf|fffd|gen aus der Zwischenablage per Button
' ###################################################
Private Sub CB_Einf|fffd|gen_Click()
On Error GoTo ErrorHandler

    Call HoleTextVonZwischenablage
    
    Me.TB_Einlesen.Value = Zwischenablage.GetText
    
    Exit Sub
    
ErrorHandler:
    MsgBox "Es ist nichts in der Zwischenablage!", vbOKOnly + vbExclamation, "hmmmmm..."
    
End Sub

' ###################################################
' Expeditionen per OGame Nachrichten einlesen
' ###################################################
Private Sub CB_Einlesen_Click()
On Error GoTo ErrorHandler

Dim Rang, Nachricht As String
Dim i2, AnzahlExpos, Pokale, Gold, Silber, Bronze, ErgebnisOK, ErgebnisVorhanden, ErgebnisUeberladen, ErgebnisFehler As Integer
Dim MaxSpalte, MaxSpaltePr|fffd|fung, i, x, s, WAS, Eingelesen, Anfang, Anfang2, AnfangLogbuch, Ende, Flotte As String
Dim ExpoAnfang, ExpoEnde, Suche, ITEMFund, Uhrzeit, Fortschritt, Belastung As String
Dim Flottenanzahl, DatumPos, UhrzeitPos, Logbuch As Integer
Dim Zahl As Long
Dim Datum As Date
Dim Startzeit, Endzeit As Date

Zeit = 0
Startzeit = Now

ErgebnisOK = 0
ErgebnisVorhanden = 0
ErgebnisUeberladen = 0
ErgebnisFehler = 0

' Wenn fertig und man klickt auf diesen Button, UserForm schlie|fffd|en
If Me.CB_Einlesen.Caption = "100 %  ( hier klicken um Fenster zu schlie|fffd|en! )" Then
    Unload Me
    Exit Sub
End If

' Das einlesen schneller machen
With Application
    .ScreenUpdating = False
    .Calculation = xlCalculationManual
    .EnableEvents = False
End With

' Neue Anzeigen
Me.CB_Einf|fffd|gen.Caption = "wird eingetragen"
Me.CB_Einf|fffd|gen.Enabled = False
Me.Label_Besipiel.Visible = False
Me.I_Information.Visible = False
Me.L_empfohleneFlotte.Visible = False

' Damit bei dem Einlesen mit gleicher Uhrzeit und Datum kein Fehler kommt!
MaxSpaltePr|fffd|fung = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row

' Passwort aufheben
Call Blattschutz_on_off ' Blattschutz entfernen
 
    ' Speichert den aktuellen Archievment Rang, damit man danach sieht ob er sich ge|fffd|ndert hat!
    Rang = Worksheets("Auswertungen").Range("W13").Value
    ' Speichert die Anzahl der Pokale
    Gold = Worksheets("Auswertungen").Range("X8").Value
    Silber = Worksheets("Auswertungen").Range("X9").Value
    Bronze = Worksheets("Auswertungen").Range("X10").Value
    Pokale = Gold + Silber + Bronze

    ' Speichert das kopierte in eine Variable
    Eingelesen = Me.TB_Einlesen
  
    ' Wie viele Expeditionen sind es?
    AnzahlExpos = UBound(Split(Eingelesen, "Von: Flottenkommando"))
        
    ' Wenn keine Expedition dann abbruch
    If AnzahlExpos = -1 Then Exit Sub
    
    ' Zeigt an, dass etwas gemacht wird
    Fortschritt = "Es werden " & AnzahlExpos & " Expeditionen eingetragen, bitte warten!" & Chr(13) & _
                  "--------------------------------------------------------------------" & Chr(13)
    
    Me.TB_Einlesen.Value = Fortschritt
        
    ' F|fffd|rbt die ProgessBar gr|fffd|n
    Me.I_Bar_Col.Width = 0
    Me.I_Bar_Col.BackColor = &HC0FFC0
    
' Ist die Schleife f|fffd|r die Anzahl der Expeditionsnachrichten die eingef|fffd|t wurden
' -----------------------------------------------
    For i = 1 To AnzahlExpos

Anfang:
    
    ' L|fffd|scht erst die alten Expos- und Logbuchnachrichten
    Expedition = ""
    Logbuchnachtrag = ""
    Belastung = ""

    ' Progressbar erneuern
    Me.CB_Einlesen.Caption = Format(100 / AnzahlExpos * (i - 1), "0.0") & " %" ' Fortschritt in %
    Me.I_Bar_Col.Width = 342 / AnzahlExpos * (i - 1)    ' Fortschritt mit gr|fffd|nen Balken
    Me.TB_Einlesen.SetFocus
    Me.TB_Einlesen.SelStart = Len(Me.TB_Einlesen.Text)
    Me.TB_Einlesen.Value = Fortschritt
    UF_Einlesen.Repaint ' L|fffd|dt die UF neu damit man das auch sieht
    
    If i > AnzahlExpos Then GoTo Fertig
    
    Fortschritt = Fortschritt & Chr(13) & "-> " & Format(i, "00") ' n|fffd|chste eingelesen Expedition anzeigen
    Me.TB_Einlesen.SetFocus
    Me.TB_Einlesen.SelStart = Len(Me.TB_Einlesen.Text)
    UF_Einlesen.Repaint ' L|fffd|dt die UF neu damit man das auch sieht
    
    WAS = "" ' Muss beim erneuten durchlaufen geleert werden, damit er nicht das voherige Ereignis nimmt
      
    ' Sucht den Anfang einer Expedition
    Anfang = InStr(Anfang + 1, Eingelesen, "Von: Flottenkommando")
    Anfang2 = InStr(Anfang - 50, Eingelesen, "]")
    If Anfang = 0 Then Exit For
    
    ' Sucht das Ende der Expedition
    Logbuch = 0
    Ende = InStr(Anfang + 1, Eingelesen, "Mehr Details")                    ' Sucht erst einmal das Ende der Expedition
    
    ' Datum finden
    ' Sucht das 3 ":"
    DatumPos = InStr(Anfang2 + 1, Eingelesen, ".") - 2
    Datum = Mid(Eingelesen, DatumPos, 10)
    
    ' Uhrzeit finden
    ' Sucht das 3 ":"
    UhrzeitPos = InStr(Anfang2 + 1, Eingelesen, ":") - 2
    Uhrzeit = Mid(Eingelesen, UhrzeitPos, 8)
    
    ' Pr|fffd|ft ob es diese Expedition schon eingetragen wurde
    For i2 = MaxSpaltePr|fffd|fung To 8 Step -1
        If CStr(Worksheets("Eintragungen").Cells(i2, 1).Value) & CStr(Format(Worksheets("Eintragungen").Cells(i2, 2).Value, "hh:mm:ss")) = CStr(Datum) & CStr(Uhrzeit) Then
            Fortschritt = Fortschritt & "   :   ### " & " > Datum: " & Datum & "  >>  " & Uhrzeit & " Uhr    >  schon vorhanden!"
            ErgebnisVorhanden = ErgebnisVorhanden + 1
            i = i + 1
            GoTo Anfang
        End If
        If Datum > CDate(Worksheets("Eintragungen").Cells(i2, 1).Value) Then Exit For
    Next
  
    ' Kopiert auf Eintragungen einen nach unten
    MaxSpalte = Worksheets("Eintragungen").Range("AS1000000").End(xlUp).Row
    Worksheets("Eintragungen").Rows(MaxSpalte & ":" & MaxSpalte).Copy _
    Worksheets("Eintragungen").Rows(MaxSpalte + 1 & ":" & MaxSpalte + 1)
    Application.CutCopyMode = False

    ' Kopiert auf den Einstellungen die Flotte ( Blau 1x mal nach unten )
    Worksheets("Einstellungen").Visible = True
    MaxSpalte = Worksheets("Einstellungen").Range("AQ1000000").End(xlUp).Row
    Worksheets("Einstellungen").Range(Worksheets("Einstellungen").Cells(MaxSpalte, 43), Worksheets("Einstellungen").Cells(MaxSpalte, 81)).Copy
    Worksheets("Einstellungen").Cells(MaxSpalte + 1, 43).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Worksheets("Einstellungen").Visible = xlSheetVeryHidden
        
    ' Wohin soll gespeichert werden?
    MaxSpalte = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row + 1
    
    ' Speichert das Datum und die Uhrzeit
    Worksheets("Eintragungen").Cells(MaxSpalte, 1).Value = Datum
    Worksheets("Eintragungen").Cells(MaxSpalte, 2).Value = Uhrzeit
    Worksheets("Eintragungen").Cells(MaxSpalte, 2).NumberFormat = "hh:mm U\hr"
    
    ' Speichert die Standartflotte
    Worksheets("Eintragungen").Cells(MaxSpalte, 3).Value = Worksheets("Einstellungen").Range("M35").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 4).Value = Worksheets("Einstellungen").Range("M36").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 5).Value = 0
    Worksheets("Eintragungen").Cells(MaxSpalte, 6).Value = Worksheets("Einstellungen").Range("M37").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 7).Value = Worksheets("Einstellungen").Range("M38").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 8).Value = Worksheets("Einstellungen").Range("M39").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 9).Value = Worksheets("Einstellungen").Range("M40").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 10).Value = Worksheets("Einstellungen").Range("M41").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 11).Value = Worksheets("Einstellungen").Range("M42").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 12).Value = Worksheets("Einstellungen").Range("M43").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 13).Value = Worksheets("Einstellungen").Range("M44").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 14).Value = Worksheets("Einstellungen").Range("M45").Value
    Worksheets("Eintragungen").Cells(MaxSpalte, 15).Value = Worksheets("Einstellungen").Range("M46").Value
    
    ' Ereignisse wieder auf Standart setzen
    Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)).NumberFormat = ""
    ' Formatiert, damit die "0" nicht sichtbar ist
    Range(Worksheets("Eintragungen").Cells(8, 3), Worksheets("Eintragungen").Cells(MaxSpalte, 15)).NumberFormat = "#,##0 ;;"
    Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)).NumberFormat = "#,##0;[Red]#,##0;;"
      
    ' Extrahiert die einzelnen Expeditionen
    If Ende <> 0 Then
        Expedition = Mid(Eingelesen, Anfang + 20, Ende - 22 - Anfang)
    Else
        Expedition = Mid(Eingelesen, Anfang + 20)
    End If
    
    ' Extrahiert Logbucheintr|fffd|ge wenn vorhanden
    If InStr(1, Expedition, "Logbuchnachtrag") Then Logbuch = 1
        If Logbuch = 1 Then
            If Worksheets("Eintragungen").Cells(MaxSpalte, 6).Value = 0 Then Worksheets("Eintragungen").Cells(MaxSpalte, 6).Value = 1 ' Wenn keine Spio standart dabei!
            AnfangLogbuch = InStr(1, Expedition, "Logbuchnachtrag") + 45
            Logbuchnachtrag = Mid(Expedition, AnfangLogbuch)
            ' Logbuch aus der reinen Expeditionsnachricht entfernen!
            Expedition = Mid(Expedition, 1, InStr(1, Expedition, "Logbuchnachtrag") - 1)

            ' Wurden viele Expeditionen in diesen Sonnensystem geflogen?
            For s = 1 To 4
                If s = 4 Then
                        ExpoOderLogbuch = 2
                        Load UF_UnbekannteExpedition
                        UF_UnbekannteExpedition.Show
                        GoTo Suchen
                End If
                ' P|fffd|rfen ob Logbuchnachtrag schon bekannt
                For x = 63 To 66
                    If Worksheets("Einstellungen").Cells(x, s).Text = "|" Then Exit For
                    ' Wenn Eintrag vorhanden, kann abgebrochen werden
                    If InStr(1, Logbuchnachtrag, Left(Worksheets("Einstellungen").Cells(x, s).Text, 65)) <> 0 Then
                        GoTo Suchen
                    End If
                Next
            Next
Suchen:
        ' Zu viel los im System!
        If s = 2 And ExpoOderLogbuch = 0 Then
            ErgebnisUeberladen = ErgebnisUeberladen + 1
            Belastung = " > Belastung mittel auf " & Mid(Eingelesen, InStrRev(Eingelesen, "[", Anfang) + 1, InStrRev(Eingelesen, "]", Anfang) - InStrRev(Eingelesen, "[", Anfang) - 1) & " | " & Datum & " >> " & Uhrzeit & " Uhr"
        End If
        If s = 3 And ExpoOderLogbuch = 0 Then
            Belastung = " > Belastung hoch  auf " & Mid(Eingelesen, InStrRev(Eingelesen, "[", Anfang) + 1, InStrRev(Eingelesen, "]", Anfang) - InStrRev(Eingelesen, "[", Anfang) - 1) & " | " & Datum & " >> " & Uhrzeit & " Uhr"
            ErgebnisUeberladen = ErgebnisUeberladen + 1
        End If
        End If
        


' Entfernt erst einmal bei Expedition die vorderen Leerzeichen!
For s = 1 To 30
    If IsCharacter(Mid(Expedition, s, 1)) Then
        Expedition = Mid(Expedition, s)
        Exit For
    End If
Next

    ' Sucht was passier ist ***************************************************************************
    For s = 1 To 36 Step 5
        For x = 79 To 111 ' UNTERSUCHT NUR DIE ERSTEN 65 ZEICHEN, DA BEI ZEILENUMBRUCH NICHTS GEFUNDEN WIRD!
            ' If s = 26 And x = 79 Then MsgBox Expedition & Chr(13) & Chr(13) & Sheets("Einstellungen").Cells(x, s + 1).Text & Chr(13) & Chr(13) & InStr(1, Expedition, Sheets("Einstellungen").Cells(x, s + 1).Text, vbTextCompare)
            If Worksheets("Einstellungen").Cells(x, s + 2).Value = "" Then GoTo zur|fffd|ck
            If Worksheets("Einstellungen").Cells(x, s + 1).Value = "" Then GoTo Weiter
            'MsgBox Expedition
            'MsgBox Left(Worksheets("Einstellungen").Cells(x, s + 1).Text, 65)
            
            If InStr(1, Expedition, Left(Worksheets("Einstellungen").Cells(x, s + 1).Text, 65)) <> 0 Then
                WAS = Worksheets("Einstellungen").Cells(x, s).Text
                GoTo Eintragen
zur|fffd|ck:
                Exit For
            End If
Weiter:
        Next x ' Anzahl der Spalte
        
        If s = 36 And Worksheets("Einstellungen").Cells(x, s + 2).Value = "" Then ' ############# HIER |fffd|NDERN WENN WAS DAZU KAM UNBEKANNTE NACHRICHT
            ExpoOderLogbuch = 1
            Load UF_UnbekannteExpedition
            UF_UnbekannteExpedition.Show
        End If
        
        If WAS <> "" Then Exit For ' Damit er nicht weitersucht wenn er schon was gefunden hatte!
    
    Next s ' Anzahl der Reihe
    
    ' Pr|fffd|ft ob in auf Eintragungen ein Fehler erkannt wurde
    Application.Calculation = xlCalculationAutomatic
    If Worksheets("Eintragungen").Cells(MaxSpalte, 52).Value = "OK" Then
        ' Tr|fffd|gt den Fortscchritt ein, Fehler oder OK
        Fortschritt = Fortschritt & "   :   [OK] " & Belastung
        ErgebnisOK = ErgebnisOK + 1
    Else
        Fortschritt = Fortschritt & "   :   [Fehler] > Bitte |fffd|berpr|fffd|fe diese Eintragung, sie sollte rot markiert sein!"
        ErgebnisFehler = ErgebnisFehler + 1
    End If
    Application.Calculation = xlCalculationManual
    
    ' Fortschritt Anzeigen (wenn nicht hier, wird bei einer Expo oder die letzte erst zu sp|fffd|t angezeigt!
    Me.TB_Einlesen.Value = Fortschritt
    Me.TB_Einlesen.SetFocus
    Me.TB_Einlesen.SelStart = Len(Me.TB_Einlesen.Text)
    UF_Einlesen.Repaint ' L|fffd|dt die UF neu damit man das auch sieht
    
    
Next i ' Anzahl der Expeditonsnachricht

Fertig:

' Macht die gr|fffd|ne Anzeige voll und zeigt 99,9 % (formatiere) an, der Rest ist das Formatieren
Me.I_Bar_Col.Width = 342
Me.CB_Einlesen.Caption = "99,9 % (Expeditionen sortieren und formatieren)"
UF_Einlesen.Repaint ' L|fffd|dt die UF neu damit man das auch sieht

' Sortiert ALLE Expeditionen nach Datum und Uhrzeit, |fffd|lteste ganz unten
MaxSpalte = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row

    ' Uhrzeit
    ' Muss vorher auf hh:mm:ss formatiert werden, sonst geht es nicht richtig
    Worksheets("Eintragungen").Sort.SortFields.Clear
    Worksheets("Eintragungen").Sort.SortFields.Add Key:=Range(Cells(8, 2), Cells(MaxSpalte, 2)), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With Worksheets("Eintragungen").Sort
        .SetRange Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 44))
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ' Formatiert es wieder richtig

    ' Datum
    Worksheets("Eintragungen").Sort.SortFields.Clear
    Worksheets("Eintragungen").Sort.SortFields.Add Key:=Range(Cells(8, 1), Cells(MaxSpalte, 1)), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With Worksheets("Eintragungen").Sort
        .SetRange Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 44))
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
' +++++++++++++++++++++++++++++++++++++++++++++++++++
' Bedingte Formatierung Erstellen
Worksheets("Eintragungen").Cells.FormatConditions.Delete
MaxSpalte = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row + 51

' OBERSTE ZEILE ROT, wenn irgendwo Fehler
    With Range("A7")
        .FormatConditions.Add Type:=xlExpression, Formula1:="=SUCHEN("" FEHLER"";$AS$1;1)"
        .FormatConditions(Range("A7").FormatConditions.Count).SetFirstPriority
        With Range("A7").FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 255
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Jeder 2 Zeile wird Orange
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=ISTGERADE(ZEILE())"
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent6
            .TintAndShade = 0.399945066682943
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Zeile f|fffd|r den n|fffd|chsten Eintrag wird Blau
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=UND($AZ7=""OK"";$A8="""")"
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent1
            .TintAndShade = 0.599963377788629
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Bei falscher Eingabe wird die Zeile Rot
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=$AZ8=""FEHLER"""
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 255
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With

    
' Auswertung schreiben und Umbenennungen!
Endzeit = Now
Fortschritt = Fortschritt & Chr(13) & Chr(13) & "---------------------------------------------------------------------------------------------" & Chr(13) & Chr(13) & _
              "Zusammenfassung: " & AnzahlExpos & " Expeditionen wurden eingelesen!" & Chr(13) & _
              "**********************************************" & Chr(13) & _
              "Dauer der Eintragungen    :  " & Round(((Endzeit - Startzeit) * 86400), 0) - Zeit & " Sekunden" & Chr(13) & Chr(13) & _
              "Fehler aufgetreten            :  " & ErgebnisFehler & Chr(13) & Chr(13) & _
              "Expeditionen eingetragen :  " & ErgebnisOK & "  davon " & ErgebnisUeberladen & " Koordinaten zu oft angeflogen!" & Chr(13) & Chr(13) & _
              "Vorhandene Nachrichten   :  " & ErgebnisVorhanden
              
Me.TB_Einlesen.Value = Fortschritt
UF_Einlesen.Repaint ' L|fffd|dt die UF neu damit man das auch sieht


Me.Label_Besipiel.Caption = "Zusammenfassung siehe unten!"
Me.Label_Besipiel.Visible = True
Me.CB_Einf|fffd|gen.Visible = False
Me.CB_Einlesen.Caption = "100 %  ( hier klicken um Fenster zu schlie|fffd|en! )"
'Me.TB_Einlesen.SetFocus
Me.TB_Einlesen.SelStart = Len(Me.TB_Einlesen.Text)
UF_Einlesen.Repaint ' L|fffd|dt die UF neu damit man das auch sieht

' +++++++++++++++++++++++++++++++++++++++++++++++++++

Call Blattschutz_on_off ' Blattschutz setzen

With Application
    .EnableEvents = True
    .Calculation = xlCalculationAutomatic
    .ScreenUpdating = True
End With

' Pr|fffd|ft ob man einen neuen Pokal erhalten hat!
    If Pokale <> Worksheets("Auswertungen").Range("X8").Value + Worksheets("Auswertungen").Range("X9").Value + Worksheets("Auswertungen").Range("X10").Value Then
        If Worksheets("Auswertungen").Range("X8").Value + Worksheets("Auswertungen").Range("X9").Value + Worksheets("Auswertungen").Range("X10").Value - Pokale > 1 Then
            Nachricht = "Pokale erhalten" & Chr(13) & Chr(13)
        Else
            Nachricht = "Pokal erhalten!" & Chr(13) & Chr(13)
        End If
        
        If Gold <> Worksheets("Auswertungen").Range("X8").Value Then Nachricht = Nachricht & Worksheets("Auswertungen").Range("X8").Value - Gold & " mal <<Gold>> erhalten!"
        If Silber <> Worksheets("Auswertungen").Range("X9").Value Then Nachricht = Nachricht & Chr(13) & Worksheets("Auswertungen").Range("X9").Value - Silber & " mal <<Silber>> erhalten!"
        If Bronze <> Worksheets("Auswertungen").Range("X10").Value Then Nachricht = Nachricht & Chr(13) & Worksheets("Auswertungen").Range("X10").Value - Bronze & " mal <<Bronze>> erhalten!"

' Pr|fffd|ft ob man im Archievment Rang gestiegen ist!
        If Rang <> Worksheets("Auswertungen").Range("W13").Value Then Nachricht = Nachricht & Chr(13) & Chr(13) & Chr(13) & "Ihr neuer Rang:  " & Worksheets("Auswertungen").Range("W13").Value
            
            MsgBox Nachricht, vbOKOnly + vbInformation, "Herzlichen Gl|fffd|ckwunsch"
        
' Wenn 100 % erreicht wurde, Urkunde erstellen und anzeigen
        If Worksheets("Einstellungen").Range("F20").Value = 100 And Worksheets("Einstellungen").Range("B41").Value = "" Then Call Urkunde_Erstellen
        
    End If
        
    
Exit Sub

Eintragen:
    
    If WAS = "RES" Then GoTo RES
    If WAS = "DM" Then GoTo DM
    If WAS = "ITEMS" Then GoTo ITEMS
    If WAS = "H|fffd|ndler" Then GoTo H|fffd|ndler
    If WAS = "Nichts" Then GoTo Nichts
    If WAS = "Versp|fffd|tung" Then GoTo Versp|fffd|tung
    If WAS = "Verfr|fffd|hung" Then GoTo Verfr|fffd|hung
    If WAS = "Piraten" Then GoTo Piraten
    If WAS = "Aliens" Then GoTo Aliens
    If WAS = "Fleet" Then GoTo Fleet
    If WAS = "Totalverlust" Then GoTo Totalverlust

GoTo zur|fffd|ck

' ########################
' Eintragungen
' ########################
RES:
' **********************************************************************
Suche = "Es wurde Metall"
If Worksheets("Einstellungen").Cells(x, 2).Text = Suche Then
    ExpoAnfang = InStr(1, Expedition, Suche)
    ExpoEnde = InStr(1, Expedition, "erbeutet")
    ' Macht bei Erfolg ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 17).Value = "x"
    ' Schreibt den Funde hinein
    Zahl = Mid(Expedition, ExpoAnfang + 16, ExpoEnde - 16 - ExpoAnfang)
    Worksheets("Eintragungen").Cells(MaxSpalte, 40).Value = Zahl
    ' Eintragen wie oft es schon passiert ist ( Normal, Gro|fffd| oder Riesig )
    If Zahl > Worksheets("Einstellungen").Range("AF36").Value Then
        Worksheets("Einstellungen").Cells(x + 2, s + 3).Value = Worksheets("Einstellungen").Cells(x + 2, s + 3).Value + 1
    ElseIf Zahl > Worksheets("Einstellungen").Range("AF37").Value Then
        Worksheets("Einstellungen").Cells(x + 1, s + 3).Value = Worksheets("Einstellungen").Cells(x + 1, s + 3).Value + 1
    Else
        Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    End If
    GoTo zur|fffd|ck
End If

Suche = "Es wurde Kristall"
If Worksheets("Einstellungen").Cells(x, 2).Text = Suche Then
    ExpoAnfang = InStr(1, Expedition, Suche)
    ExpoEnde = InStr(1, Expedition, "erbeutet")
    ' Macht bei Erfolg ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 17).Value = "x"
    ' Schreibt den Funde hinein
    Zahl = Mid(Expedition, ExpoAnfang + 18, ExpoEnde - 18 - ExpoAnfang)
    Worksheets("Eintragungen").Cells(MaxSpalte, 41).Value = Zahl
    ' Eintragen wie oft es schon passiert ist ( Normal, Gro|fffd| oder Riesig )
    If Zahl > Worksheets("Einstellungen").Range("AH36").Value Then
        Worksheets("Einstellungen").Cells(x + 2, s + 3).Value = Worksheets("Einstellungen").Cells(x + 2, s + 3).Value + 1
    ElseIf Zahl > Worksheets("Einstellungen").Range("AH37").Value Then
        Worksheets("Einstellungen").Cells(x + 1, s + 3).Value = Worksheets("Einstellungen").Cells(x + 1, s + 3).Value + 1
    Else
        Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    End If
    GoTo zur|fffd|ck
End If

Suche = "Es wurde Deuterium"
If Worksheets("Einstellungen").Cells(x, 2).Text = Suche Then
    ExpoAnfang = InStr(1, Expedition, Suche)
    ExpoEnde = InStr(1, Expedition, "erbeutet")
    ' Macht bei Erfolg ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 17).Value = "x"
    ' Schreibt den Funde hinein
    Zahl = Mid(Expedition, ExpoAnfang + 19, ExpoEnde - 19 - ExpoAnfang)
    Worksheets("Eintragungen").Cells(MaxSpalte, 42).Value = Zahl
    ' Eintragen wie oft es schon passiert ist ( Normal, Gro|fffd| oder Riesig )
    If Zahl > Worksheets("Einstellungen").Range("AJ36").Value Then
        Worksheets("Einstellungen").Cells(x + 2, s + 3).Value = Worksheets("Einstellungen").Cells(x + 2, s + 3).Value + 1
    ElseIf Zahl > Worksheets("Einstellungen").Range("AJ37").Value Then
        Worksheets("Einstellungen").Cells(x + 1, s + 3).Value = Worksheets("Einstellungen").Cells(x + 1, s + 3).Value + 1
    Else
        Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    End If
    GoTo zur|fffd|ck
End If

DM:
' **********************************************************************
Suche = "Es wurde Dunkle Materie"
    ExpoAnfang = InStr(1, Expedition, Suche)
    ExpoEnde = InStr(1, Expedition, "erbeutet")
    ' Macht bei Erfolg ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 17).Value = "x"
    ' Schreibt den Funde hinein
    Zahl = Mid(Expedition, ExpoAnfang + 24, ExpoEnde - 24 - ExpoAnfang)
    Worksheets("Eintragungen").Cells(MaxSpalte, 43).Value = Zahl
    ' Eintragen wie oft es schon passiert ist ( Normal, Gro|fffd| oder Riesig )
    If Zahl >= Worksheets("Einstellungen").Range("AM36").Value * 2 Then ' Bei OGame Event 9x DM
        Zahl = Zahl / 9
        Worksheets("Eintragungen").Cells(MaxSpalte, 44).Value = "OGame Event ( 9x DM )" ' Tr|fffd|gt die Bemerkung ein
    End If
    If Zahl >= Worksheets("Einstellungen").Range("AM36").Value Then
        Worksheets("Einstellungen").Cells(x + 2, s + 3).Value = Worksheets("Einstellungen").Cells(x + 2, s + 3).Value + 1
    ElseIf Zahl >= Worksheets("Einstellungen").Range("AM37").Value Then
        Worksheets("Einstellungen").Cells(x + 1, s + 3).Value = Worksheets("Einstellungen").Cells(x + 1, s + 3).Value + 1
    Else
        Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    End If
    GoTo zur|fffd|ck
    
ITEMS:
' **********************************************************************
Suche = "ITEMS"
    ExpoAnfang = InStr(1, Expedition, Suche)
    ExpoEnde = InStr(1, Expedition, "erbeutet")
    ' Macht bei Erfolg ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 17).Value = "x"
    ' Tr|fffd|gt die Bemerkung ein
    Worksheets("Eintragungen").Cells(MaxSpalte, 44).Value = "OGame Event ( Item: " & Worksheets("Einstellungen").Cells(x, s + 1).Value & " )"
    ' Eintragen wie oft es schon passiert ist
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    
    GoTo zur|fffd|ck
    
H|fffd|ndler:
' **********************************************************************
    ' Macht bei H|fffd|ndler ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 23).Value = "x"
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    GoTo zur|fffd|ck
    
Nichts:
' **********************************************************************
    ' Macht bei Nichts ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 18).Value = "x"
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    GoTo zur|fffd|ck
    
Versp|fffd|tung:
' **********************************************************************
    ' Macht bei Verz|fffd|gerung ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 21).Value = "x"
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    GoTo zur|fffd|ck
        
Verfr|fffd|hung:
' **********************************************************************
    ' Macht bei Verfr|fffd|hung ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 22).Value = "x"
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    GoTo zur|fffd|ck

Piraten:
' **********************************************************************
    ' Macht bei Piraten ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 19).Value = "x"
    Verloren_Expedition = Expedition
    Verloren_Event = "Piraten"
    Verloren_Datum = Datum
    Verloren_Uhrzeit = Uhrzeit
    Verloren_Groesse = Worksheets("Einstellungen").Cells(x, s + 2)
    
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    
    Load UF_Verloren
    UF_Verloren.Show
    
    If Nein = "Nein" Then GoTo zur|fffd|ck
    
    If KT <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 26).Value = "-" & KT
    If GT <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 27).Value = "-" & GT
    If Spio <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 29).Value = "-" & Spio
    If LJ <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 30).Value = "-" & LJ
    If SJ <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 31).Value = "-" & SJ
    If Xer <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 32).Value = "-" & Xer
    If SS <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 33).Value = "-" & SS
    If SXer <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 34).Value = "-" & SXer
    If Bomber <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 35).Value = "-" & Bomber
    If Zerri <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 36).Value = "-" & Zerri
    If Reaper <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 37).Value = "-" & Reaper
    If Pathfinder <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 38).Value = "-" & Pathfinder
      
    GoTo zur|fffd|ck
    
Aliens:
' **********************************************************************
    ' Macht bei Aliens ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 20).Value = "x"
    Verloren_Expedition = Expedition
    Verloren_Event = "Aliens"
    Verloren_Datum = Datum
    Verloren_Uhrzeit = Uhrzeit
    Verloren_Groesse = Worksheets("Einstellungen").Cells(x, s + 2)
    
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    
    Load UF_Verloren
    UF_Verloren.Show
    
    If Nein = "Nein" Then GoTo zur|fffd|ck
    
    If KT <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 26).Value = "-" & KT
    If GT <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 27).Value = "-" & GT
    If Spio <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 29).Value = "-" & Spio
    If LJ <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 30).Value = "-" & LJ
    If SJ <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 31).Value = "-" & SJ
    If Xer <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 32).Value = "-" & Xer
    If SS <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 33).Value = "-" & SS
    If SXer <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 34).Value = "-" & SXer
    If Bomber <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 35).Value = "-" & Bomber
    If Zerri <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 36).Value = "-" & Zerri
    If Reaper <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 37).Value = "-" & Reaper
    If Pathfinder <> "0" Then Worksheets("Eintragungen").Cells(MaxSpalte, 38).Value = "-" & Pathfinder
    
    GoTo zur|fffd|ck
    
Fleet:
' **********************************************************************
    ' Macht bei Erfolg ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 17).Value = "x"
    ' Wenn "Techniker" eintritt, also keine Flotte beim Flottenfund auftritt)
    If x = 92 Or x = 93 Then
        Worksheets("Eintragungen").Cells(MaxSpalte, 44).Value = "Flottenfund ohne sichtbares Ergebnis"
        x = 91
    End If
    ' Sucht wieviel von welcher Flotte gefunden wurde
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Kleiner Transporter")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 21, 1)
        If IsNumeric(Mid(Expedition, Flotte + 22, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 22, 1)
        If IsNumeric(Mid(Expedition, Flotte + 23, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 23, 1)
        If IsNumeric(Mid(Expedition, Flotte + 24, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 24, 1)
        If IsNumeric(Mid(Expedition, Flotte + 25, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 25, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 26).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Gro|fffd|er Transporter")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 20, 1)
        If IsNumeric(Mid(Expedition, Flotte + 21, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 21, 1)
        If IsNumeric(Mid(Expedition, Flotte + 22, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 22, 1)
        If IsNumeric(Mid(Expedition, Flotte + 23, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 23, 1)
        If IsNumeric(Mid(Expedition, Flotte + 24, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 24, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 27).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Spionagesonde")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 15, 1)
        If IsNumeric(Mid(Expedition, Flotte + 16, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 16, 1)
        If IsNumeric(Mid(Expedition, Flotte + 17, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 17, 1)
        If IsNumeric(Mid(Expedition, Flotte + 18, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 18, 1)
        If IsNumeric(Mid(Expedition, Flotte + 19, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 19, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 29).Value = Flottenanzahl
    End If
        
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Leichter J|fffd|ger")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 16, 1)
        If IsNumeric(Mid(Expedition, Flotte + 17, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 17, 1)
        If IsNumeric(Mid(Expedition, Flotte + 18, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 18, 1)
        If IsNumeric(Mid(Expedition, Flotte + 19, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 19, 1)
        If IsNumeric(Mid(Expedition, Flotte + 20, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 20, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 30).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Schwerer J|fffd|ger")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 16, 1)
        If IsNumeric(Mid(Expedition, Flotte + 17, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 17, 1)
        If IsNumeric(Mid(Expedition, Flotte + 18, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 18, 1)
        If IsNumeric(Mid(Expedition, Flotte + 19, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 19, 1)
        If IsNumeric(Mid(Expedition, Flotte + 20, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 20, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 31).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Kreuzer")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 9, 1)
        If IsNumeric(Mid(Expedition, Flotte + 10, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 10, 1)
        If IsNumeric(Mid(Expedition, Flotte + 11, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 11, 1)
        If IsNumeric(Mid(Expedition, Flotte + 12, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 12, 1)
        If IsNumeric(Mid(Expedition, Flotte + 13, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 13, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 32).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Schlachtschiff")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 16, 1)
        If IsNumeric(Mid(Expedition, Flotte + 17, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 17, 1)
        If IsNumeric(Mid(Expedition, Flotte + 18, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 18, 1)
        If IsNumeric(Mid(Expedition, Flotte + 19, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 19, 1)
        If IsNumeric(Mid(Expedition, Flotte + 20, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 20, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 33).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Schlachtkreuzer")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 17, 1)
        If IsNumeric(Mid(Expedition, Flotte + 18, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 18, 1)
        If IsNumeric(Mid(Expedition, Flotte + 19, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 19, 1)
        If IsNumeric(Mid(Expedition, Flotte + 20, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 20, 1)
        If IsNumeric(Mid(Expedition, Flotte + 21, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 21, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 34).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Bomber")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 8, 1)
        If IsNumeric(Mid(Expedition, Flotte + 9, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 9, 1)
        If IsNumeric(Mid(Expedition, Flotte + 10, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 10, 1)
        If IsNumeric(Mid(Expedition, Flotte + 11, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 11, 1)
        If IsNumeric(Mid(Expedition, Flotte + 12, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 12, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 35).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Zerst|fffd|rer")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 11, 1)
        If IsNumeric(Mid(Expedition, Flotte + 12, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 12, 1)
        If IsNumeric(Mid(Expedition, Flotte + 13, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 13, 1)
        If IsNumeric(Mid(Expedition, Flotte + 14, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 14, 1)
        If IsNumeric(Mid(Expedition, Flotte + 15, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 15, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 36).Value = Flottenanzahl
    End If
    
    Flotte = "0"
    Flotte = InStr(1, Expedition, "Reaper")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 8, 1)
        If IsNumeric(Mid(Expedition, Flotte + 9, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 9, 1)
        If IsNumeric(Mid(Expedition, Flotte + 10, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 10, 1)
        If IsNumeric(Mid(Expedition, Flotte + 11, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 11, 1)
        If IsNumeric(Mid(Expedition, Flotte + 12, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 12, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 37).Value = Flottenanzahl
    End If
    
        Flotte = "0"
    Flotte = InStr(1, Expedition, "Pathfinder")
    If Flotte <> "0" Then
        Flottenanzahl = Mid(Expedition, Flotte + 12, 1)
        If IsNumeric(Mid(Expedition, Flotte + 13, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 13, 1)
        If IsNumeric(Mid(Expedition, Flotte + 14, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 14, 1)
        If IsNumeric(Mid(Expedition, Flotte + 15, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 15, 1)
        If IsNumeric(Mid(Expedition, Flotte + 16, 1)) Then Flottenanzahl = Flottenanzahl & Mid(Expedition, Flotte + 16, 1)
        Worksheets("Eintragungen").Cells(MaxSpalte, 38).Value = Flottenanzahl
    End If
    
    
    ' Tr|fffd|gt ein ob es ein normaler, gro|fffd|er oder riesiger Fund war
    ' Zellen Berechnen, sonst immer 0
    With Worksheets("Einstellungen")
        .Cells(MaxSpalte, 45).Calculate
        .Cells(MaxSpalte, 46).Calculate
        .Cells(MaxSpalte, 47).Calculate
    End With
                
    Zahl = Worksheets("Einstellungen").Cells(MaxSpalte, 45).Value + Worksheets("Einstellungen").Cells(MaxSpalte, 46).Value + Worksheets("Einstellungen").Cells(MaxSpalte, 47).Value ' Rechnet die Units zusammen
    ' Tr|fffd|gt ein
    If Zahl > Worksheets("Einstellungen").Range("AL36").Value Then
        Worksheets("Einstellungen").Cells(x + 2, s + 3).Value = Worksheets("Einstellungen").Cells(x + 2, s + 3).Value + 1
    ElseIf Zahl > Worksheets("Einstellungen").Range("AL37").Value Then
        Worksheets("Einstellungen").Cells(x + 1, s + 3).Value = Worksheets("Einstellungen").Cells(x + 1, s + 3).Value + 1
    Else
        Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    End If
        
    GoTo zur|fffd|ck
    
Totalverlust:
' **********************************************************************
    ' Macht bei Totalverlust ein "x"
    Worksheets("Eintragungen").Cells(MaxSpalte, 24).Value = "x"
    
    Worksheets("Eintragungen").Cells(MaxSpalte, 26).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 3).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 27).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 4).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 28).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 5).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 29).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 6).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 30).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 7).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 31).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 8).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 32).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 9).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 33).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 10).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 34).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 11).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 35).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 12).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 36).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 13).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 37).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 14).Value * -1
    Worksheets("Eintragungen").Cells(MaxSpalte, 38).Value = Worksheets("Eintragungen").Cells(MaxSpalte, 15).Value * -1
    
    Worksheets("Einstellungen").Cells(x, s + 3).Value = Worksheets("Einstellungen").Cells(x, s + 3).Value + 1
    
    GoTo zur|fffd|ck

Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Expo einlesen )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
        

End Sub

Private Sub I_Information_Click()

    Load UF_Einlesen_Erkl|fffd|rung
    UF_Einlesen_Erkl|fffd|rung.Show

End Sub

Attribute VB_Name = "UF_Einlesen_Erkl|fffd|rung"
Attribute VB_Base = "0{CF7FD4A8-3B62-4072-82B0-7470432F3C44}{0CB8F7E4-EA04-4C78-886E-63803844BFD6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Attribute VB_Name = "UF_Einstellungen"
Attribute VB_Base = "0{2DEF7CE1-DA3E-4A11-844C-AB4998532FB4}{A59C0957-04D8-4865-9C5F-A7EE43BA1907}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub C_Klasse_Click()
    
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
    
    If Me.C_Klasse.Caption = "keine" Then
        Me.C_Klasse.Caption = "Kollektor"
    ElseIf Me.C_Klasse.Caption = "Kollektor" Then
        Me.C_Klasse.Caption = "Admiral"
    ElseIf Me.C_Klasse.Caption = "Admiral" Then
        Me.C_Klasse.Caption = "Entdecker"
    ElseIf Me.C_Klasse.Caption = "Entdecker" Then
        Me.C_Klasse.Caption = "keine"
    End If
   
    Sheets("Einstellungen").Range("V5").Value = Me.C_Klasse.Caption ' Zwischenspeicher
    Sheets("Einstellungen").Range("U5").Value = "Nein" ' Expeditionskosten d|fffd|rfen neu geladen werden!
    
End Sub

Private Sub I_Information_2_Click()

    MsgBox "Beachten Sie!" & Chr(13) & _
           "**************" & Chr(13) & Chr(13) & _
           "Es werden nur Verluste gegen Piraten/ Aliens eingetragen, wenn Sie mit der empfohlenen Flotte fliegen." & Chr(13) & Chr(13) & _
           "Diese entnehmen Sie bitte dem Infosymbol auf der Seite <Grundeinstellungen>!" & Chr(13) & Chr(13) & _
           "Bei Abweichungen der Verluste k|fffd|nnen Sie diese manuell |fffd|ber <Eintragungen> |fffd|ndern.", vbOKOnly + vbInformation, "Information"

End Sub

' ******************************************************************************
' Beim |fffd|ffnen der USERFORM
' ******************************************************************************

Private Sub UserForm_Activate()
Dim i As Integer ' f|fffd|r die Schleife um die Universen einzutragen
On Error GoTo ErrorHandler

' |fffd|berschrift mit aktueller Versionnummer!
UF_Einstellungen.Caption = "Einstellungen - Expeditionsrechner ( Version " & Range("Einstellungen!I8").Value & " )"
' ----------------------------------

' Wenn Urkunde schon freigeschalten wurde
If Range("Einstellungen!B41").Value <> "" Then Me.Multi_Einstellungen2(4).Visible = True

' Einlesen der Gespeicherten Werte!
' Zwischenspeicher f|fffd|llen ( Da die Checkboxen direkt mit dem Zwischenspeicher reagieren )
Range("Einstellungen!T5").Value = Range("Einstellungen!M5").Value  ' Astrophysik
Range("Einstellungen!V5").Value = Range("Einstellungen!O4").Value  ' Klasse-Entdecker
Range("Einstellungen!U6").Value = Range("Einstellungen!M15").Value ' Handelskurs
Range("Einstellungen!U7").Value = Range("Einstellungen!I16").Value ' Auswertung in %
Range("Einstellungen!T8").Value = Range("Einstellungen!N12").Value ' Admiral
Range("Einstellungen!V8").Value = Range("Einstellungen!O12").Value ' Automatisches Eintragen
Range("Einstellungen!U9").Value = Range("Einstellungen!H2").Value  ' Berechnung der Expotage
' Flottenverkauf Zwischenspeicher
Range("Einstellungen!U10").Value = Range("Einstellungen!B2").Value ' Verkauf ja oder nein
Range("Einstellungen!T11").Value = Range("Einstellungen!B7").Value ' KT
Range("Einstellungen!T12").Value = Range("Einstellungen!B8").Value ' GT
Range("Einstellungen!T13").Value = Range("Einstellungen!B9").Value ' Spio
Range("Einstellungen!T14").Value = Range("Einstellungen!B10").Value ' LJ
Range("Einstellungen!T15").Value = Range("Einstellungen!B11").Value ' SJ
Range("Einstellungen!T16").Value = Range("Einstellungen!B12").Value ' Xer
Range("Einstellungen!T17").Value = Range("Einstellungen!B13").Value ' SS
Range("Einstellungen!T18").Value = Range("Einstellungen!B14").Value ' Sxer
Range("Einstellungen!T19").Value = Range("Einstellungen!B15").Value ' BB
Range("Einstellungen!T20").Value = Range("Einstellungen!B16").Value ' Zerri
Range("Einstellungen!T21").Value = Range("Einstellungen!B17").Value ' Reaper
Range("Einstellungen!T22").Value = Range("Einstellungen!B18").Value ' Pathfinder

' ##################################
' in Grundeinstellungen
' ##################################
For i = 9 To 55
    If ThisWorkbook.Sheets("Einstellungen").Cells(i, 24).Value <> "" Then C_Universum.AddItem (ThisWorkbook.Sheets("Einstellungen").Cells(i, 24).Value) Else Exit For
Next

' Wenn Universum nicht mehr gibt, w|fffd|hle Uni 1
    If IsError(Range("Einstellungen!N3").Value) Then
        Range("Einstellungen!M3").Value = 1
        MsgBox "Dein Universum gibt es nicht mehr, es wurde Universum 1 gew|fffd|hlt!", vbInformation + vbOKOnly, "Information"
    End If

Me.C_Universum.Value = Range("Einstellungen!M3").Value
Me.C_Platz1.Value = Range("Einstellungen!AC23").Value
Me.L_Uni_Speed.Caption = Range("Einstellungen!T2").Value
Me.L_Uni_DeuVerbrauch.Caption = Range("Einstellungen!U2").Value
Me.E_Astrophysik.Value = Range("Einstellungen!M5").Value
Me.E_Verbrennungstriebwerk.Value = Range("Einstellungen!M6").Value
Me.E_Impulstriebwerk.Value = Range("Einstellungen!M7").Value
Me.E_Hyperraumantrieb.Value = Range("Einstellungen!M8").Value
' Klass Button das Caption zuweisen
Me.C_Klasse.Caption = Range("Einstellungen!O4").Value
If Me.C_Klasse.Caption = "" Then Me.C_Klasse.Caption = "keine"
' CheckBox das Gespeicherte Caption zuweisen
If Range("Einstellungen!M15").Text Like "WAHR" Then Me.C_Handelskurs.Caption = "Aktiviert" Else Me.C_Handelskurs.Caption = "Deaktiviert"
Me.E_Metall.Value = Range("Einstellungen!L16").Value
Me.E_Kristall.Value = Range("Einstellungen!L17").Value
Me.E_Deuterium.Value = Range("Einstellungen!L18").Value
If Me.C_Handelskurs.Value = True Then
    Me.E_Metall.Enabled = True
    Me.E_Kristall.Enabled = True
    Me.E_Deuterium.Enabled = True
Else
    Me.E_Metall.Enabled = False
    Me.E_Kristall.Enabled = False
    Me.E_Deuterium.Enabled = False
End If

If Me.C_Prozente_anzeigen.Value = True Then
    Me.C_Prozente_anzeigen.Caption = "mit Prozenten anzeigen?    ( Ja )"
Else
    Me.C_Prozente_anzeigen.Caption = "mit Prozenten anzeigen?    ( Nein )"
End If

' ##################################
' Expedition
' ##################################
' Bef|fffd|llen der C_Speed ( Durschnittliche Geschwindigkeit der Expediton )
With Me.C_Speed
.AddItem "100%"
.AddItem "90%"
.AddItem "80%"
.AddItem "70%"
.AddItem "60%"
.AddItem "50%"
.AddItem "40%"
.AddItem "30%"
.AddItem "20%"
.AddItem "10%"
End With

Me.E_Haltezeit.Value = Range("Einstellungen!M12").Value ' Haltezeit
Me.C_Speed.Value = Range("Einstellungen!M13").Value * 100 & "%" ' Geschwindigkeit
If Range("Einstellungen!N12").Text Like "WAHR" Then Me.C_Admiral.Caption = "Aktiviert" Else Me.C_Admiral.Caption = "Deaktiviert" ' Admiral
' Automatische Eintragung
If Range("Einstellungen!O12").Text Like "WAHR" Then
    Me.C_AutoEintragung.Caption = "Aktiviert"
    Me.I_Information_2.Visible = True
Else
    Me.C_AutoEintragung.Caption = "Deaktiviert"
    Me.I_Information_2.Visible = False
End If

' CheckBox auf Falsch setzen wenn "0" oder NICHTS drin steht! Oder auf Ja, wenn etwas drin steht, aber noch Falsch ist
Call Blattschutz_on_off ' Blattschutz entfernen

If Range("Einstellungen!M35").Value = "0" Or Range("Einstellungen!M35").Value = "" Then Range("Einstellungen!L35").Value = False
If Range("Einstellungen!M36").Value = "0" Or Range("Einstellungen!M36").Value = "" Then Range("Einstellungen!L36").Value = False
If Range("Einstellungen!M37").Value = "0" Or Range("Einstellungen!M37").Value = "" Then Range("Einstellungen!L37").Value = False
If Range("Einstellungen!M38").Value = "0" Or Range("Einstellungen!M38").Value = "" Then Range("Einstellungen!L38").Value = False
If Range("Einstellungen!M39").Value = "0" Or Range("Einstellungen!M39").Value = "" Then Range("Einstellungen!L39").Value = False
If Range("Einstellungen!M40").Value = "0" Or Range("Einstellungen!M40").Value = "" Then Range("Einstellungen!L40").Value = False
If Range("Einstellungen!M41").Value = "0" Or Range("Einstellungen!M41").Value = "" Then Range("Einstellungen!L41").Value = False
If Range("Einstellungen!M42").Value = "0" Or Range("Einstellungen!M42").Value = "" Then Range("Einstellungen!L42").Value = False
If Range("Einstellungen!M43").Value = "0" Or Range("Einstellungen!M43").Value = "" Then Range("Einstellungen!L43").Value = False
If Range("Einstellungen!M44").Value = "0" Or Range("Einstellungen!M44").Value = "" Then Range("Einstellungen!L44").Value = False
If Range("Einstellungen!M45").Value = "0" Or Range("Einstellungen!M45").Value = "" Then Range("Einstellungen!L45").Value = False
If Range("Einstellungen!M46").Value = "0" Or Range("Einstellungen!M46").Value = "" Then Range("Einstellungen!L46").Value = False

If Range("Einstellungen!M35").Value <> "0" And Range("Einstellungen!L35").Value = False Then Range("Einstellungen!L35").Value = True
If Range("Einstellungen!M36").Value <> "0" And Range("Einstellungen!L36").Value = False Then Range("Einstellungen!L36").Value = True
If Range("Einstellungen!M37").Value <> "0" And Range("Einstellungen!L37").Value = False Then Range("Einstellungen!L37").Value = True
If Range("Einstellungen!M38").Value <> "0" And Range("Einstellungen!L38").Value = False Then Range("Einstellungen!L38").Value = True
If Range("Einstellungen!M39").Value <> "0" And Range("Einstellungen!L39").Value = False Then Range("Einstellungen!L39").Value = True
If Range("Einstellungen!M40").Value <> "0" And Range("Einstellungen!L40").Value = False Then Range("Einstellungen!L40").Value = True
If Range("Einstellungen!M41").Value <> "0" And Range("Einstellungen!L41").Value = False Then Range("Einstellungen!L41").Value = True
If Range("Einstellungen!M42").Value <> "0" And Range("Einstellungen!L42").Value = False Then Range("Einstellungen!L42").Value = True
If Range("Einstellungen!M43").Value <> "0" And Range("Einstellungen!L43").Value = False Then Range("Einstellungen!L43").Value = True
If Range("Einstellungen!M44").Value <> "0" And Range("Einstellungen!L44").Value = False Then Range("Einstellungen!L44").Value = True
If Range("Einstellungen!M45").Value <> "0" And Range("Einstellungen!L45").Value = False Then Range("Einstellungen!L45").Value = True
If Range("Einstellungen!M46").Value <> "0" And Range("Einstellungen!L46").Value = False Then Range("Einstellungen!L46").Value = True

Call Blattschutz_on_off ' Blattschutz setzen
' -------------------------------------

' Bef|fffd|llt die Anzahl der jeweiligen Schiffe die auf eine Expedition mitgenommen werden und macht das K|fffd|stchen wieder wei|fffd| und beschreibbar
If Range("Einstellungen!L35").Value = True Then
    Me.TB_Expoflotte_KT.Enabled = True
    Me.TB_Expoflotte_KT.BackColor = "&H80000005"
    Me.TB_Expoflotte_KT.Value = Range("Einstellungen!M35").Value
End If
If Range("Einstellungen!L36").Value = True Then
    Me.TB_Expoflotte_GT.Enabled = True
    Me.TB_Expoflotte_GT.BackColor = "&H80000005"
    Me.TB_Expoflotte_GT.Value = Range("Einstellungen!M36").Value
End If
If Range("Einstellungen!L37").Value = True Then
    Me.TB_Expoflotte_Spio.Enabled = True
    Me.TB_Expoflotte_Spio.BackColor = "&H80000005"
    Me.TB_Expoflotte_Spio.Value = Range("Einstellungen!M37").Value
End If
If Range("Einstellungen!L38").Value = True Then
    Me.TB_Expoflotte_LJ.Enabled = True
    Me.TB_Expoflotte_LJ.BackColor = "&H80000005"
    Me.TB_Expoflotte_LJ.Value = Range("Einstellungen!M38").Value
End If
If Range("Einstellungen!L39").Value = True Then
    Me.TB_Expoflotte_SJ.Enabled = True
    Me.TB_Expoflotte_SJ.BackColor = "&H80000005"
    Me.TB_Expoflotte_SJ.Value = Range("Einstellungen!M39").Value
End If
If Range("Einstellungen!L40").Value = True Then
    Me.TB_Expoflotte_Xer.Enabled = True
    Me.TB_Expoflotte_Xer.BackColor = "&H80000005"
    Me.TB_Expoflotte_Xer.Value = Range("Einstellungen!M40").Value
End If
If Range("Einstellungen!L41").Value = True Then
    Me.TB_Expoflotte_SS.Enabled = True
    Me.TB_Expoflotte_SS.BackColor = "&H80000005"
    Me.TB_Expoflotte_SS.Value = Range("Einstellungen!M41").Value
End If
If Range("Einstellungen!L42").Value = True Then
    Me.TB_Expoflotte_SXer.Enabled = True
    Me.TB_Expoflotte_SXer.BackColor = "&H80000005"
    Me.TB_Expoflotte_SXer.Value = Range("Einstellungen!M42").Value
End If
If Range("Einstellungen!L43").Value = True Then
    Me.TB_Expoflotte_Bomber.Enabled = True
    Me.TB_Expoflotte_Bomber.BackColor = "&H80000005"
    Me.TB_Expoflotte_Bomber.Value = Range("Einstellungen!M43").Value
End If
If Range("Einstellungen!L44").Value = True Then
    Me.TB_Expoflotte_Zerri.Enabled = True
    Me.TB_Expoflotte_Zerri.BackColor = "&H80000005"
    Me.TB_Expoflotte_Zerri.Value = Range("Einstellungen!M44").Value
End If
If Range("Einstellungen!L45").Value = True Then
    Me.TB_Expoflotte_Reaper.Enabled = True
    Me.TB_Expoflotte_Reaper.BackColor = "&H80000005"
    Me.TB_Expoflotte_Reaper.Value = Range("Einstellungen!M45").Value
End If
If Range("Einstellungen!L46").Value = True Then
    Me.TB_Expoflotte_Pathfinder.Enabled = True
    Me.TB_Expoflotte_Pathfinder.BackColor = "&H80000005"
    Me.TB_Expoflotte_Pathfinder.Value = Range("Einstellungen!M46").Value
End If
' ------------------------------------------
' ##################################
' Expeditionskosten
' ##################################
' Beim Starten das MUSS GESPEICHERT WERDEN & EXPOKOSTEN GELADEN auf "Nein"
Range("Einstellungen!L1").Value = "Nein" ' Wenn die Userform geladen wird
Range("Einstellungen!U5").Value = "Nein" ' Ob bei Einstellung der Reiter "Exposkosten" aktiviert wurde
Range("Einstellungen!V7").Value = "Nein" ' Auswertung in % anzeigen

' ##################################
' in Expeditionstage
' ##################################
If Range("Einstellungen!H2").Value Like "1" Then Me.O_Expeditionstage.Value = "True" Else Me.O_Kalendertage.Value = "True"

' ##################################
' in Flottenverkauf
' ##################################
If Range("Einstellungen!B2").Value Like "1" Then Me.O_Flottenverkauf_Ja.Value = "True" Else Me.O_Flottenverkauf_Nein.Value = "True"

' ##################################
' Wenn weder Einstellungen noch Eintragungen existieren
' ##################################
If Range("Auswertungen!G1").Text = "Einstellungen fehlen!" And Range("Auswertungen!A3").Value = 0 Then
    Multi_Einstellungen.Value = 5   ' Wechselt zu Sonstiges
    Multi_Einstellungen2.Value = 3  ' Wechselt zu Upgrade ( Wiederherstellen )
End If

'Anzeige wann n|fffd|chste Update|fffd|berpr|fffd|fung und Datum der Universumliste
Me.L_Version.Caption = Range("Einstellungen!I8").Text
Me.L_Version_Universum.Caption = Range("Einstellungen!AB56").Text & Chr(13) & "n|fffd|chste Updatepr|fffd|fung am: " + Range("Einstellungen!I11").Text + " oder Klick!"
Range("Einstellungen!L1").Value = "Nein" ' Muss Gespeichert werden? NEIN da noch keine |fffd|nderungen

Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Einstellungen )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"


End Sub

' ******************************************************************************
' ANFANG GRUNDEINSTELLUNGEN
' ******************************************************************************

Private Sub C_Universum_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
    Range("Einstellungen!S2").Value = Me.C_Universum.Value
    Me.L_Uni_Speed.Caption = Range("Einstellungen!T2").Value
    Me.L_Uni_DeuVerbrauch.Caption = Range("Einstellungen!U2").Value
End Sub

' ###############################################################################
' Hier ist das "i" zum anklicken, welches die Useform "Information" startet!
Private Sub I_Information_Click()
    Load UF_Informationen
    UF_Informationen.Show
End Sub
' ###############################################################################

Private Sub C_Platz1_Change()
Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
End Sub

Private Sub E_Astrophysik_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
    Range("Einstellungen!U5").Value = "Nein" ' Expeditionskosten d|fffd|rfen neu geladen werden!

    If Me.E_Astrophysik.Value = "" Then GoTo Ende Else
    
    If Not IsNumeric(Me.E_Astrophysik.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Astrophysik - Fehler"
        Me.E_Astrophysik.Value = ""
    ElseIf Val(Me.E_Astrophysik.Text) > 25 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 0 bis 25 eingegeben werden!", vbInformation, "Astrophysik"
        Me.E_Astrophysik.Value = "25"
            
Ende:
    End If
  
End Sub

Private Sub E_Verbrennungstriebwerk_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Verbrennungstriebwerk = "" Then GoTo Ende Else
  
    If Not IsNumeric(Me.E_Verbrennungstriebwerk.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Verbrennungstriebwerk - Fehler"
        Me.E_Verbrennungstriebwerk.Value = ""
    ElseIf Val(Me.E_Verbrennungstriebwerk.Text) > 30 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 0 bis 30 eingegeben werden!", vbInformation, "Verbrennungstriebwerk"
        Me.E_Verbrennungstriebwerk.Value = "30"
Ende:
    End If
    
End Sub

Private Sub E_Impulstriebwerk_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Impulstriebwerk = "" Then GoTo Ende Else
    
    If Not IsNumeric(Me.E_Impulstriebwerk.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Impulstriebwerk - Fehler"
        Me.E_Impulstriebwerk.Value = ""
    ElseIf Val(Me.E_Impulstriebwerk.Text) > 25 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 0 bis 25 eingegeben werden!", vbInformation, "Impulstriebwerk"
        Me.E_Impulstriebwerk.Value = "25"
        
Ende:
    End If
    
  End Sub

Private Sub E_Hyperraumantrieb_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Hyperraumantrieb = "" Then GoTo Ende Else
    
    If Not IsNumeric(Me.E_Hyperraumantrieb.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Hyperraumantrieb - Fehler"
        Me.E_Hyperraumantrieb.Value = ""
    ElseIf Val(Me.E_Hyperraumantrieb.Text) > 20 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 0 bis 20 eingegeben werden!", vbInformation, "Hyperraumantrieb"
        Me.E_Hyperraumantrieb.Value = "20"
        
Ende:
    End If
        
  End Sub

Private Sub C_Handelskurs_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
    
    If Me.C_Handelskurs.Caption = "Aktiviert" Then
        Me.C_Handelskurs.Caption = "Deaktiviert"
        Me.E_Metall.Enabled = False
        Me.E_Kristall.Enabled = False
        Me.E_Deuterium.Enabled = False
    Else
        Me.C_Handelskurs.Caption = "Aktiviert"
        Me.E_Metall.Enabled = True
        Me.E_Kristall.Enabled = True
        Me.E_Deuterium.Enabled = True
    End If
    
End Sub

Private Sub E_Metall_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Metall = "" Then GoTo Ende Else
    
    If Not IsNumeric(Me.E_Metall.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Metall - Fehler"
        Me.E_Metall.Value = ""
    ElseIf Val(Me.E_Metall.Text) > 5 Or Val(Me.E_Metall.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 5 eingegeben werden!", vbInformation, "Metall"
        Me.E_Metall.Value = "2"
Ende:
    End If
      
End Sub
Private Sub E_Kristall_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Kristall = "" Then GoTo Ende Else
    
    If Not IsNumeric(Me.E_Kristall.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Metall - Fehler"
        Me.E_Kristall.Value = ""
    ElseIf Val(Me.E_Kristall.Text) > 5 Or Val(Me.E_Kristall.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 5 eingegeben werden!", vbInformation, "Metall"
        Me.E_Kristall.Value = "1"
Ende:
    End If
  
End Sub

Private Sub E_Deuterium_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Deuterium = "" Then GoTo Ende Else
    
    If Not IsNumeric(Me.E_Deuterium.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Metall - Fehler"
        Me.E_Deuterium.Value = ""
    ElseIf Val(Me.E_Deuterium.Text) > 5 Or Val(Me.E_Deuterium.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 5 eingegeben werden!", vbInformation, "Metall"
        Me.E_Deuterium.Value = "1"
Ende:
    End If
    
End Sub

Private Sub C_Prozente_anzeigen_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    Range("Einstellungen!V7").Value = "Ja" ' Wurde ver|fffd|ndert, damit er erst beim speichern das Format der Zellen |fffd|ndert
    
    If Me.C_Prozente_anzeigen.Value = True Then
        Me.C_Prozente_anzeigen.Caption = "mit Prozenten anzeigen?    ( JA )"
    Else
        Me.C_Prozente_anzeigen.Caption = "mit Prozenten anzeigen?    ( NEIN )"
    End If

End Sub

' ******************************************************************************
' ENDE GRUNDEINSTELLUNGEN
' ******************************************************************************

' ******************************************************************************
' ANFANG EXPEDITIONSEINSTELLUNGEN
' ******************************************************************************
Private Sub E_Haltezeit_Change()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Haltezeit = "" Then GoTo Ende Else
        If Not IsNumeric(Me.E_Haltezeit.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Haltezeit - Fehler"
        Me.E_Haltezeit.Value = ""
    ElseIf Val(Me.E_Haltezeit.Text) > Val(Me.E_Astrophysik.Text) Or Val(Me.E_Haltezeit.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Me.E_Astrophysik.Value & " eingegeben werden!", vbInformation, "Haltezeit"
        Me.E_Haltezeit.Value = "1"
Ende:
    End If

End Sub

Private Sub C_Speed_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub C_Admiral_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
    
    If Me.C_Admiral.Caption = "Aktiviert" Then
        Me.C_Admiral.Caption = "Deaktiviert"
    Else
        Me.C_Admiral.Caption = "Aktiviert"
    End If
        
    Sheets("Einstellungen").Range("U5").Value = "Nein" ' Expeditionskosten d|fffd|rfen neu geladen werden!
    
End Sub

Private Sub C_AutoEintragung_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?
    
    If Me.C_AutoEintragung.Caption = "Aktiviert" Then
        Me.C_AutoEintragung.Caption = "Deaktiviert"
        Me.I_Information_2.Visible = False
    Else
        Me.C_AutoEintragung.Caption = "Aktiviert"
        Me.I_Information_2.Visible = True
    End If
      
End Sub

' Die einzelnen Flotten
Private Sub TB_Expoflotte_KT_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_Bomber_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_GT_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_LJ_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_SJ_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_Spio_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_SS_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_SXer_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_Xer_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_Zerri_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_Reaper_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

Private Sub TB_Expoflotte_Pathfinder_Change()

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

End Sub

' ******************************************************************************
' EXPEDITIONSTAGE
' ******************************************************************************

Private Sub O_Expeditionstage_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    Range("Einstellungen!U9").Value = 1

End Sub

Private Sub O_Kalendertage_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    Range("Einstellungen!U9").Value = 2

End Sub


' Standartflotte w|fffd|hlen
Private Sub C_Expoflotte_KT_Click()

    If Me.C_Expoflotte_KT.Value = True Then
        Me.TB_Expoflotte_KT.Enabled = True
        Me.TB_Expoflotte_KT.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_KT.Value = "0"
        Me.TB_Expoflotte_KT.Enabled = False
        Me.TB_Expoflotte_KT.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_GT_Click()

    If Me.C_Expoflotte_GT.Value = True Then
        Me.TB_Expoflotte_GT.Enabled = True
        Me.TB_Expoflotte_GT.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_GT.Value = "0"
        Me.TB_Expoflotte_GT.Enabled = False
        Me.TB_Expoflotte_GT.BackColor = "&H00E0E0E0"
    End If
    
End Sub

Private Sub C_Expoflotte_Spio_Click()

    If Me.C_Expoflotte_Spio.Value = True Then
        Me.TB_Expoflotte_Spio.Enabled = True
        Me.TB_Expoflotte_Spio.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_Spio.Value = "0"
        Me.TB_Expoflotte_Spio.Enabled = False
        Me.TB_Expoflotte_Spio.BackColor = "&H00E0E0E0"
    End If
 
End Sub

Private Sub C_Expoflotte_LJ_Click()

    If Me.C_Expoflotte_LJ.Value = True Then
        Me.TB_Expoflotte_LJ.Enabled = True
        Me.TB_Expoflotte_LJ.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_LJ.Value = "0"
        Me.TB_Expoflotte_LJ.Enabled = False
        Me.TB_Expoflotte_LJ.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_SJ_Click()

    If Me.C_Expoflotte_SJ.Value = True Then
        Me.TB_Expoflotte_SJ.Enabled = True
        Me.TB_Expoflotte_SJ.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_SJ.Value = "0"
        Me.TB_Expoflotte_SJ.Enabled = False
        Me.TB_Expoflotte_SJ.BackColor = "&H00E0E0E0"
    End If
    
End Sub

Private Sub C_Expoflotte_Xer_Click()
    
    If Me.C_Expoflotte_Xer.Value = True Then
        Me.TB_Expoflotte_Xer.Enabled = True
        Me.TB_Expoflotte_Xer.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_Xer.Value = "0"
        Me.TB_Expoflotte_Xer.Enabled = False
        Me.TB_Expoflotte_Xer.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_SS_Click()

    If Me.C_Expoflotte_SS.Value = True Then
        Me.TB_Expoflotte_SS.Enabled = True
        Me.TB_Expoflotte_SS.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_SS.Value = "0"
        Me.TB_Expoflotte_SS.Enabled = False
        Me.TB_Expoflotte_SS.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_SXer_Click()

    If Me.C_Expoflotte_SXer.Value = True Then
        Me.TB_Expoflotte_SXer.Enabled = True
        Me.TB_Expoflotte_SXer.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_SXer.Value = "0"
        Me.TB_Expoflotte_SXer.Enabled = False
        Me.TB_Expoflotte_SXer.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_Bomber_Click()

    If Me.C_Expoflotte_Bomber.Value = True Then
        Me.TB_Expoflotte_Bomber.Enabled = True
        Me.TB_Expoflotte_Bomber.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_Bomber.Value = "0"
        Me.TB_Expoflotte_Bomber.Enabled = False
        Me.TB_Expoflotte_Bomber.BackColor = "&H00E0E0E0"
    End If
    
End Sub

Private Sub C_Expoflotte_Zerri_Click()

    If Me.C_Expoflotte_Zerri.Value = True Then
        Me.TB_Expoflotte_Zerri.Enabled = True
        Me.TB_Expoflotte_Zerri.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_Zerri.Value = "0"
        Me.TB_Expoflotte_Zerri.Enabled = False
        Me.TB_Expoflotte_Zerri.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_Reaper_Click()

    If Me.C_Expoflotte_Reaper.Value = True Then
        Me.TB_Expoflotte_Reaper.Enabled = True
        Me.TB_Expoflotte_Reaper.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_Reaper.Value = "0"
        Me.TB_Expoflotte_Reaper.Enabled = False
        Me.TB_Expoflotte_Reaper.BackColor = "&H00E0E0E0"
    End If
        
End Sub

Private Sub C_Expoflotte_Pathfinder_Click()

    If Me.C_Expoflotte_Pathfinder.Value = True Then
        Me.TB_Expoflotte_Pathfinder.Enabled = True
        Me.TB_Expoflotte_Pathfinder.BackColor = "&H80000005"
    Else
        Me.TB_Expoflotte_Pathfinder.Value = "0"
        Me.TB_Expoflotte_Pathfinder.Enabled = False
        Me.TB_Expoflotte_Pathfinder.BackColor = "&H00E0E0E0"
    End If
        
End Sub

' ******************************************************************************
' ANFANG FLOTTENVERKAUF
' ******************************************************************************

Private Sub O_Flottenverkauf_Ja_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    Range("Einstellungen!U10").Value = 1
    If Range("Einstellungen!U10").Value Like "1" Then
        'Zivile Schiffe
        Me.C_KT.Enabled = True
        Me.C_GT.Enabled = True
        Me.C_Spio.Enabled = True
        Me.C_LJ.Enabled = True
        Me.C_SJ.Enabled = True
        Me.C_Xer.Enabled = True
        Me.C_SS.Enabled = True
        Me.C_SXer.Enabled = True
        Me.C_Bomber.Enabled = True
        Me.C_Zerri.Enabled = True
        Me.C_Reaper.Enabled = True
        Me.C_Pathfinder.Enabled = True
    End If

End Sub

Private Sub O_Flottenverkauf_Nein_Click()
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    Range("Einstellungen!U10").Value = 2
    If Range("Einstellungen!U10").Value Like "2" Then
        'Zivile Schiffe
        Me.C_KT.Enabled = False
        Me.C_GT.Enabled = False
        Me.C_Spio.Enabled = False
        Me.C_LJ.Enabled = False
        Me.C_SJ.Enabled = False
        Me.C_Xer.Enabled = False
        Me.C_SS.Enabled = False
        Me.C_SXer.Enabled = False
        Me.C_Bomber.Enabled = False
        Me.C_Zerri.Enabled = False
        Me.C_Reaper.Enabled = False
        Me.C_Pathfinder.Enabled = False
    End If

End Sub

' ######################################################################
' Einstellungen :: Expeditionskosten
' ######################################################################
' Wenn Keine Expedition gemacht werden kann dann GRAU und NICHT ANW|fffd|HLBAR
Private Sub Multi_Einstellungen_Click(ByVal Index As Long)
    If Me.Multi_Einstellungen.Value = "2" Then
            If Range("Einstellungen!U5").Value = "Ja" Then Exit Sub

            ' Astrophysik zwischenspeicher erneuern mit was gerade in Me.E_Astrophysik steht, nicht das Werkeinstellung sind, auf 21 ge|fffd|ndert wurde und nur 1 Slot angezeigt wird!
            Range("Einstellungen!T5") = Me.E_Astrophysik.Value
            ' Einlesen der Werte
            ' Galaxie
            Me.E_Galaxie1.Value = Range("Einstellungen!L24").Value
            Me.E_Galaxie2.Value = Range("Einstellungen!L25").Value
            Me.E_Galaxie3.Value = Range("Einstellungen!L26").Value
            Me.E_Galaxie4.Value = Range("Einstellungen!L27").Value
            Me.E_Galaxie5.Value = Range("Einstellungen!L28").Value
            Me.E_Galaxie6.Value = Range("Einstellungen!L29").Value
            Me.E_Galaxie7.Value = Range("Einstellungen!L30").Value
            Me.E_Galaxie8.Value = Range("Einstellungen!L31").Value
            ' System
            Me.E_System1.Value = Range("Einstellungen!M24").Value
            Me.E_System2.Value = Range("Einstellungen!M25").Value
            Me.E_System3.Value = Range("Einstellungen!M26").Value
            Me.E_System4.Value = Range("Einstellungen!M27").Value
            Me.E_System5.Value = Range("Einstellungen!M28").Value
            Me.E_System6.Value = Range("Einstellungen!M29").Value
            Me.E_System7.Value = Range("Einstellungen!M30").Value
            Me.E_System8.Value = Range("Einstellungen!M31").Value
            ' Position
            Me.E_Position1.Value = Range("Einstellungen!N24").Value
            Me.E_Position2.Value = Range("Einstellungen!N25").Value
            Me.E_Position3.Value = Range("Einstellungen!N26").Value
            Me.E_Position4.Value = Range("Einstellungen!N27").Value
            Me.E_Position5.Value = Range("Einstellungen!N28").Value
            Me.E_Position6.Value = Range("Einstellungen!N29").Value
            Me.E_Position7.Value = Range("Einstellungen!N30").Value
            Me.E_Position8.Value = Range("Einstellungen!N31").Value

            ' ExpoSlot
            Me.E_Expo1.Value = Range("Einstellungen!K24").Value
            Me.E_Expo2.Value = Range("Einstellungen!K25").Value
            Me.E_Expo3.Value = Range("Einstellungen!K26").Value
            Me.E_Expo4.Value = Range("Einstellungen!K27").Value
            Me.E_Expo5.Value = Range("Einstellungen!K28").Value
            Me.E_Expo6.Value = Range("Einstellungen!K29").Value
            Me.E_Expo7.Value = Range("Einstellungen!K30").Value
            Me.E_Expo8.Value = Range("Einstellungen!K31").Value
            ' Nach
            Me.E_Nach1.Value = Range("Einstellungen!O24").Value
            Me.E_Nach2.Value = Range("Einstellungen!O25").Value
            Me.E_Nach3.Value = Range("Einstellungen!O26").Value
            Me.E_Nach4.Value = Range("Einstellungen!O27").Value
            Me.E_Nach5.Value = Range("Einstellungen!O28").Value
            Me.E_Nach6.Value = Range("Einstellungen!O29").Value
            Me.E_Nach7.Value = Range("Einstellungen!O30").Value
            Me.E_Nach8.Value = Range("Einstellungen!O31").Value

            ' Momentane Expeditionen
            Me.E_MomentaneExpeditionen.Value = Range("Einstellungen!K32").Value
            ' Durschnuttliche Entfernung
            Me.E_DurschnittlicheEntfernung.Value = "Durchschnittliche Entfernung = " & Range("Einstellungen!AD9").Text

            ' Anzeige der nicht ben|fffd|tigten Daten
            If Range("Einstellungen!K25").Value <> "2" Then
                Me.E_Galaxie2.Value = ""
                Me.E_Galaxie3.Value = ""
                Me.E_Galaxie4.Value = ""
                Me.E_Galaxie5.Value = ""
                Me.E_Galaxie6.Value = ""
                Me.E_Galaxie7.Value = ""
                Me.E_Galaxie8.Value = ""
                Me.E_System2.Value = ""
                Me.E_System3.Value = ""
                Me.E_System4.Value = ""
                Me.E_System5.Value = ""
                Me.E_System6.Value = ""
                Me.E_System7.Value = ""
                Me.E_System8.Value = ""
                Me.E_Position2.Value = ""
                Me.E_Position3.Value = ""
                Me.E_Position4.Value = ""
                Me.E_Position5.Value = ""
                Me.E_Position6.Value = ""
                Me.E_Position7.Value = ""
                Me.E_Position8.Value = ""

            ElseIf Range("Einstellungen!K26").Value <> "3" Then
                Me.E_Galaxie3.Value = ""
                Me.E_Galaxie4.Value = ""
                Me.E_Galaxie5.Value = ""
                Me.E_Galaxie6.Value = ""
                Me.E_Galaxie7.Value = ""
                Me.E_Galaxie8.Value = ""
                Me.E_System3.Value = ""
                Me.E_System4.Value = ""
                Me.E_System5.Value = ""
                Me.E_System6.Value = ""
                Me.E_System7.Value = ""
                Me.E_System8.Value = ""
                Me.E_Position3.Value = ""
                Me.E_Position4.Value = ""
                Me.E_Position5.Value = ""
                Me.E_Position6.Value = ""
                Me.E_Position7.Value = ""
                Me.E_Position8.Value = ""

            ElseIf Range("Einstellungen!K27").Value <> "4" Then
                Me.E_Galaxie4.Value = ""
                Me.E_Galaxie5.Value = ""
                Me.E_Galaxie6.Value = ""
                Me.E_Galaxie7.Value = ""
                Me.E_Galaxie8.Value = ""
                Me.E_System4.Value = ""
                Me.E_System5.Value = ""
                Me.E_System6.Value = ""
                Me.E_System7.Value = ""
                Me.E_System8.Value = ""
                Me.E_Position4.Value = ""
                Me.E_Position5.Value = ""
                Me.E_Position6.Value = ""
                Me.E_Position7.Value = ""
                Me.E_Position8.Value = ""

            ElseIf Range("Einstellungen!K28").Value <> "5" Then
                Me.E_Galaxie5.Value = ""
                Me.E_Galaxie6.Value = ""
                Me.E_Galaxie7.Value = ""
                Me.E_Galaxie8.Value = ""
                Me.E_System5.Value = ""
                Me.E_System6.Value = ""
                Me.E_System7.Value = ""
                Me.E_System8.Value = ""
                Me.E_Position5.Value = ""
                Me.E_Position6.Value = ""
                Me.E_Position7.Value = ""
                Me.E_Position8.Value = ""
            ElseIf Range("Einstellungen!K29").Value <> "6" Then
                Me.E_Galaxie6.Value = ""
                Me.E_Galaxie7.Value = ""
                Me.E_Galaxie8.Value = ""
                Me.E_System6.Value = ""
                Me.E_System7.Value = ""
                Me.E_System8.Value = ""
                Me.E_Position6.Value = ""
                Me.E_Position7.Value = ""
                Me.E_Position8.Value = ""
            ElseIf Range("Einstellungen!K29").Value <> "7" Then
                Me.E_Galaxie7.Value = ""
                Me.E_Galaxie8.Value = ""
                Me.E_System7.Value = ""
                Me.E_System8.Value = ""
                Me.E_Position7.Value = ""
                Me.E_Position8.Value = ""
            End If


            ' Slot 1
            If Me.E_Expo1.Value = 1 Then
                Me.E_Galaxie1.Enabled = "True"
                Me.E_Galaxie1.BackColor = "&H80000005"
                Me.E_System1.Enabled = "True"
                Me.E_System1.BackColor = "&H80000005"
                Me.E_Position1.Enabled = "True"
                Me.E_Position1.BackColor = "&H80000005"
            Else
                Me.E_Galaxie1.Enabled = "False"
                Me.E_Galaxie1.BackColor = "&H00E0E0E0"
                Me.E_System1.Enabled = "False"
                Me.E_System1.BackColor = "&H00E0E0E0"
                Me.E_Position1.Enabled = "False"
                Me.E_Position1.BackColor = "&H00E0E0E0"
            End If
            
            ' Slot 2
            If Me.E_Expo2.Value = 2 Then
                Me.E_Galaxie2.Enabled = "True"
                Me.E_Galaxie2.BackColor = "&H80000005"
                Me.E_System2.Enabled = "True"
                Me.E_System2.BackColor = "&H80000005"
                Me.E_Position2.Enabled = "True"
                Me.E_Position2.BackColor = "&H80000005"
            Else
                Me.E_Galaxie2.Enabled = "False"
                Me.E_Galaxie2.BackColor = "&H00E0E0E0"
                Me.E_System2.Enabled = "False"
                Me.E_System2.BackColor = "&H00E0E0E0"
                Me.E_Position2.Enabled = "False"
                Me.E_Position2.BackColor = "&H00E0E0E0"
            End If

            ' Slot 3
            If Me.E_Expo3.Value = 3 Then
                Me.E_Galaxie3.Enabled = "True"
                Me.E_Galaxie3.BackColor = "&H80000005"
                Me.E_System3.Enabled = "True"
                Me.E_System3.BackColor = "&H80000005"
                Me.E_Position3.Enabled = "True"
                Me.E_Position3.BackColor = "&H80000005"
            Else
                Me.E_Galaxie3.Enabled = "False"
                Me.E_Galaxie3.BackColor = "&H00E0E0E0"
                Me.E_System3.Enabled = "False"
                Me.E_System3.BackColor = "&H00E0E0E0"
                Me.E_Position3.Enabled = "False"
                Me.E_Position3.BackColor = "&H00E0E0E0"
            End If

            ' Slot 4
            If Me.E_Expo4.Value = 4 Then
                Me.E_Galaxie4.Enabled = "True"
                Me.E_Galaxie4.BackColor = "&H80000005"
                Me.E_System4.Enabled = "True"
                Me.E_System4.BackColor = "&H80000005"
                Me.E_Position4.Enabled = "True"
                Me.E_Position4.BackColor = "&H80000005"
            Else
                Me.E_Galaxie4.Enabled = "False"
                Me.E_Galaxie4.BackColor = "&H00E0E0E0"
                Me.E_System4.Enabled = "False"
                Me.E_System4.BackColor = "&H00E0E0E0"
                Me.E_Position4.Enabled = "False"
                Me.E_Position4.BackColor = "&H00E0E0E0"
            End If

            ' Slot 5
            If Me.E_Expo5.Value = 5 Then
                Me.E_Galaxie5.Enabled = "True"
                Me.E_Galaxie5.BackColor = "&H80000005"
                Me.E_System5.Enabled = "True"
                Me.E_System5.BackColor = "&H80000005"
                Me.E_Position5.Enabled = "True"
                Me.E_Position5.BackColor = "&H80000005"
            Else
                Me.E_Galaxie5.Enabled = "False"
                Me.E_Galaxie5.BackColor = "&H00E0E0E0"
                Me.E_System5.Enabled = "False"
                Me.E_System5.BackColor = "&H00E0E0E0"
                Me.E_Position5.Enabled = "False"
                Me.E_Position5.BackColor = "&H00E0E0E0"
            End If

            ' Slot 6
            If Me.E_Expo6.Value = 6 Then
                Me.E_Galaxie6.Enabled = "True"
                Me.E_Galaxie6.BackColor = "&H80000005"
                Me.E_System6.Enabled = "True"
                Me.E_System6.BackColor = "&H80000005"
                Me.E_Position6.Enabled = "True"
                Me.E_Position6.BackColor = "&H80000005"
            Else
                Me.E_Galaxie6.Enabled = "False"
                Me.E_Galaxie6.BackColor = "&H00E0E0E0"
                Me.E_System6.Enabled = "False"
                Me.E_System6.BackColor = "&H00E0E0E0"
                Me.E_Position6.Enabled = "False"
                Me.E_Position6.BackColor = "&H00E0E0E0"
            End If
            
            ' Slot 7
            If Me.E_Expo7.Value = 7 Then
                Me.E_Galaxie7.Enabled = "True"
                Me.E_Galaxie7.BackColor = "&H80000005"
                Me.E_System7.Enabled = "True"
                Me.E_System7.BackColor = "&H80000005"
                Me.E_Position7.Enabled = "True"
                Me.E_Position7.BackColor = "&H80000005"
            Else
                Me.E_Galaxie7.Enabled = "False"
                Me.E_Galaxie7.BackColor = "&H00E0E0E0"
                Me.E_System7.Enabled = "False"
                Me.E_System7.BackColor = "&H00E0E0E0"
                Me.E_Position7.Enabled = "False"
                Me.E_Position7.BackColor = "&H00E0E0E0"
            End If
                        
            ' Slot 8
            If Me.E_Expo8.Value = 8 Then
                Me.E_Galaxie8.Enabled = "True"
                Me.E_Galaxie8.BackColor = "&H80000005"
                Me.E_System8.Enabled = "True"
                Me.E_System8.BackColor = "&H80000005"
                Me.E_Position8.Enabled = "True"
                Me.E_Position8.BackColor = "&H80000005"
            Else
                Me.E_Galaxie8.Enabled = "False"
                Me.E_Galaxie8.BackColor = "&H00E0E0E0"
                Me.E_System8.Enabled = "False"
                Me.E_System8.BackColor = "&H00E0E0E0"
                Me.E_Position8.Enabled = "False"
                Me.E_Position8.BackColor = "&H00E0E0E0"
            End If

            Range("Einstellungen!U5").Value = "Ja"

    End If

End Sub

' ######################################################################
' Einstellungen :: Expeditionskosten :: Galaxie
' ######################################################################

Private Sub E_Galaxie1_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Galaxie1 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Galaxie1.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Galaxie - Fehler"
        Me.E_Galaxie1.Value = ""
    ElseIf Val(Me.E_Galaxie1.Text) > Range("Einstellungen!T3").Value Or Val(Me.E_Galaxie1.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T3").Value & " eingegeben werden!", vbInformation, "Galaxie"
        Me.E_Galaxie1.Value = "1"
    End If

End Sub

Private Sub E_Galaxie2_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Galaxie2 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Galaxie2.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Galaxie - Fehler"
        Me.E_Galaxie2.Value = ""
    ElseIf Val(Me.E_Galaxie2.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_Galaxie2.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "Galaxie"
        Me.E_Galaxie2.Value = "1"
    End If
  
End Sub

Private Sub E_Galaxie3_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden
    
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Galaxie3 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Galaxie3.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Galaxie - Fehler"
        Me.E_Galaxie3.Value = ""
    ElseIf Val(Me.E_Galaxie3.Text) > Range("Einstellungen!T3").Value Or Val(Me.E_Galaxie3.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T3").Value & " eingegeben werden!", vbInformation, "Galaxie"
        Me.E_Galaxie3.Value = "1"
    End If
  
End Sub

Private Sub E_Galaxie4_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden
    
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Galaxie4 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Galaxie4.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Galaxie - Fehler"
        Me.E_Galaxie4.Value = ""
    ElseIf Val(Me.E_Galaxie4.Text) > Range("Einstellungen!T3").Value Or Val(Me.E_Galaxie4.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T3").Value & " eingegeben werden!", vbInformation, "Galaxie"
        Me.E_Galaxie4.Value = "1"
    End If
  
End Sub

Private Sub E_Galaxie5_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Galaxie5 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Galaxie5.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Galaxie - Fehler"
        Me.E_Galaxie5.Value = ""
    ElseIf Val(Me.E_Galaxie5.Text) > Range("Einstellungen!T3").Value Or Val(Me.E_Galaxie5.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T3").Value & " eingegeben werden!", vbInformation, "Galaxie"
        Me.E_Galaxie5.Value = "1"
    End If
  
End Sub
Private Sub E_Galaxie6_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Galaxie6 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Galaxie6.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Galaxie - Fehler"
        Me.E_Galaxie6.Value = ""
    ElseIf Val(Me.E_Galaxie6.Text) > Range("Einstellungen!T3").Value Or Val(Me.E_Galaxie6.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T3").Value & " eingegeben werden!", vbInformation, "Galaxie"
        Me.E_Galaxie6.Value = "1"
    End If

End Sub

' ######################################################################
' Einstellungen :: Expeditionskosten :: System
' ######################################################################

Private Sub E_System1_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_System1 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_System1.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "System - Fehler"
        Me.E_System1.Value = ""
    ElseIf Val(Me.E_System1.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_System1.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "System"
        Me.E_System1.Value = "1"
    End If
  
End Sub

Private Sub E_System2_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_System2 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_System2.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "System - Fehler"
        Me.E_System2.Value = ""
    ElseIf Val(Me.E_System2.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_System2.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "System"
        Me.E_System2.Value = "1"
    End If

End Sub

Private Sub E_System3_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden
    
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_System3 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_System3.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "System - Fehler"
        Me.E_System3.Value = ""
    ElseIf Val(Me.E_System3.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_System3.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "System"
        Me.E_System3.Value = "1"
    End If
  
End Sub

Private Sub E_System4_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_System4 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_System4.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "System - Fehler"
        Me.E_System4.Value = ""
    ElseIf Val(Me.E_System4.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_System4.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "System"
        Me.E_System4.Value = "1"
    End If
  
End Sub

Private Sub E_System5_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_System5 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_System5.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "System - Fehler"
        Me.E_System5.Value = ""
    ElseIf Val(Me.E_System5.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_System5.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "System"
        Me.E_System5.Value = "1"
    End If
  
End Sub
Private Sub E_System6_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_System6 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_System6.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "System - Fehler"
        Me.E_System6.Value = ""
    ElseIf Val(Me.E_System6.Text) > Range("Einstellungen!T4").Value Or Val(Me.E_System6.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis " & Range("Einstellungen!T4").Value & " eingegeben werden!", vbInformation, "System"
        Me.E_System6.Value = "1"
    End If
  
End Sub

' ######################################################################
' Einstellungen :: Expeditionskosten :: Position
' ######################################################################

Private Sub E_Position1_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Position1 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Position1.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Position - Fehler"
        Me.E_Position1.Value = ""
    ElseIf Val(Me.E_Position1.Text) > 15 Or Val(Me.E_Position1.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 15 eingegeben werden!", vbInformation, "Position"
        Me.E_Position1.Value = "1"
    End If

End Sub

Private Sub E_Position2_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Position2 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Position2.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Position - Fehler"
        Me.E_Position2.Value = ""
    ElseIf Val(Me.E_Position2.Text) > 15 Or Val(Me.E_Position2.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 15 eingegeben werden!", vbInformation, "Position"
        Me.E_Position2.Value = "1"
    End If
  
End Sub

Private Sub E_Position3_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Position3 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Position3.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Position - Fehler"
        Me.E_Position3.Value = ""
    ElseIf Val(Me.E_Position3.Text) > 15 Or Val(Me.E_Position3.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 15 eingegeben werden!", vbInformation, "Position"
        Me.E_Position3.Value = "1"
    End If
  
End Sub

Private Sub E_Position4_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Position4 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Position4.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Position - Fehler"
        Me.E_Position4.Value = ""
    ElseIf Val(Me.E_Position4.Text) > 15 Or Val(Me.E_Position4.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 15 eingegeben werden!", vbInformation, "Position"
        Me.E_Position4.Value = "1"
    End If
  
End Sub

Private Sub E_Position5_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden

    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Position5 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Position5.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Position - Fehler"
        Me.E_Position5.Value = ""
    ElseIf Val(Me.E_Position5.Text) > 15 Or Val(Me.E_Position5.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 15 eingegeben werden!", vbInformation, "Position"
        Me.E_Position5.Value = "1"
    End If
  
End Sub

Private Sub E_Position6_Change()
    If Range("Einstellungen!U5").Value = "Nein" Then Exit Sub ' Beim ersten Laden der Einstellungen MUSS NICHT gespeichert werden
    
    Range("Einstellungen!L1").Value = "Ja" ' Muss Gespeichert werden?

    If Me.E_Position6 = "" Then
        Exit Sub
    ElseIf Not IsNumeric(Me.E_Position6.Value) Then
        MsgBox "Es d|fffd|rfen nur Zahlen eingegeben werden!", vbInformation, "Position - Fehler"
        Me.E_Position6.Value = ""
    ElseIf Val(Me.E_Position6.Text) > 15 Or Val(Me.E_Position6.Text) = 0 Then
        MsgBox "Es d|fffd|rfen nur Zahlen von 1 bis 15 eingegeben werden!", vbInformation, "Position"
        Me.E_Position6.Value = "1"
    End If
  
End Sub

' ******************************************************************************
' Die Buttons ( Speichern, Beenden, Werksteinstellungen und Upgrade)
' ******************************************************************************

Private Sub B_Speichern_Click()
On Error GoTo ErrorHandler ' Wenn "Einstellungen fehlen!", und beim Speichern auf NEIN geklickt wird kommt sonst ein Fehler! ??????????

    ' Bei fehlenden Einstellungen Funktioniert er wie der Speicher Button
    If Range("Auswertungen!G1").Text = "Einstellungen fehlen!" Then
        Application.DisplayAlerts = False
        ThisWorkbook.Save
        Application.DisplayAlerts = True
    End If

    ' von Grundeinstellungen
    Range("Einstellungen!M3").Value = Me.C_Universum.Value ' ComboBox Universum
    Range("Einstellungen!AC23").Value = Me.C_Platz1.Value ' ComboBox Punkte Platz 1
    If Me.E_Astrophysik.Value = "" Or Me.E_Astrophysik.Value = 0 Then Range("Einstellungen!M5").Value = 1 Else Range("Einstellungen!M5").Value = Me.E_Astrophysik.Value
    If Me.E_Verbrennungstriebwerk.Value = "" Or Me.E_Verbrennungstriebwerk.Value = 0 Then Range("Einstellungen!M6").Value = 1 Else Range("Einstellungen!M6").Value = Me.E_Verbrennungstriebwerk.Value
    If Me.E_Impulstriebwerk.Value = "" Or Me.E_Impulstriebwerk.Value = 0 Then Range("Einstellungen!M7").Value = 1 Else Range("Einstellungen!M7").Value = Me.E_Impulstriebwerk.Value
    If Me.E_Hyperraumantrieb.Value = "" Or Me.E_Hyperraumantrieb.Value = 0 Then Range("Einstellungen!M8").Value = 1 Else Range("Einstellungen!M8").Value = Me.E_Hyperraumantrieb.Value
    If Me.E_Metall.Value = "" Or Me.E_Metall.Value = 0 Then Range("Einstellungen!L16").Value = 2 Else Range("Einstellungen!L16").Value = Me.E_Metall.Value
    If Me.E_Kristall.Value = "" Or Me.E_Kristall.Value = 0 Then Range("Einstellungen!L17").Value = 1 Else Range("Einstellungen!L17").Value = Me.E_Kristall.Value
    If Me.E_Deuterium.Value = "" Or Me.E_Deuterium.Value = 0 Then Range("Einstellungen!L18").Value = 1 Else Range("Einstellungen!L18").Value = Me.E_Deuterium.Value
    Range("Einstellungen!O4").Value = Me.C_Klasse.Caption
    Range("Einstellungen!M15").Value = Me.C_Handelskurs.Value

' Auswertung in % anzeigen
' ------------------------------------------------------
    If Range("Einstellungen!V7").Value = "Ja" Then

        Application.ScreenUpdating = False

        Call Blattschutz_on_off

        If Me.C_Prozente_anzeigen.Value = True Then
            Range("A3").NumberFormat = "#,##0 ""( 100 % )"""
        Else
            Range("A3").NumberFormat = "#,##0"
        End If

        Call Blattschutz_on_off

        Application.ScreenUpdating = True
    
        Range("Einstellungen!I16").Value = Me.C_Prozente_anzeigen.Value
    
    End If
' ------------------------------------------------------

' Expeditionseinstellungen
If Me.E_Haltezeit.Value = "" Or Me.E_Haltezeit.Value = 0 Then Range("Einstellungen!M12").Value = 1 Else Range("Einstellungen!M12").Value = Me.E_Haltezeit.Value
Range("Einstellungen!M13").Value = Me.C_Speed.Value ' ComboBox
Range("Einstellungen!N12").Value = Me.C_Admiral.Value
Range("Einstellungen!O12").Value = Me.C_AutoEintragung.Value
Range("Einstellungen!M35").Value = Me.TB_Expoflotte_KT.Value
Range("Einstellungen!M36").Value = Me.TB_Expoflotte_GT.Value
Range("Einstellungen!M37").Value = Me.TB_Expoflotte_Spio.Value
Range("Einstellungen!M38").Value = Me.TB_Expoflotte_LJ.Value
Range("Einstellungen!M39").Value = Me.TB_Expoflotte_SJ.Value
Range("Einstellungen!M40").Value = Me.TB_Expoflotte_Xer.Value
Range("Einstellungen!M41").Value = Me.TB_Expoflotte_SS.Value
Range("Einstellungen!M42").Value = Me.TB_Expoflotte_SXer.Value
Range("Einstellungen!M43").Value = Me.TB_Expoflotte_Bomber.Value
Range("Einstellungen!M44").Value = Me.TB_Expoflotte_Zerri.Value
Range("Einstellungen!M45").Value = Me.TB_Expoflotte_Reaper.Value
Range("Einstellungen!M46").Value = Me.TB_Expoflotte_Pathfinder.Value

' Expeditionkosten werden nur Gespeichert wenn die Daten 1x Abgerufen!
If Range("Einstellungen!U5").Value = "Ja" Then
Range("Einstellungen!L24").Value = Me.E_Galaxie1.Value
Range("Einstellungen!L25").Value = Me.E_Galaxie2.Value
Range("Einstellungen!L26").Value = Me.E_Galaxie3.Value
Range("Einstellungen!L27").Value = Me.E_Galaxie4.Value
Range("Einstellungen!L28").Value = Me.E_Galaxie5.Value
Range("Einstellungen!L29").Value = Me.E_Galaxie6.Value
Range("Einstellungen!M24").Value = Me.E_System1.Value
Range("Einstellungen!M25").Value = Me.E_System2.Value
Range("Einstellungen!M26").Value = Me.E_System3.Value
Range("Einstellungen!M27").Value = Me.E_System4.Value
Range("Einstellungen!M28").Value = Me.E_System5.Value
Range("Einstellungen!M29").Value = Me.E_System6.Value
Range("Einstellungen!N24").Value = Me.E_Position1.Value
Range("Einstellungen!N25").Value = Me.E_Position2.Value
Range("Einstellungen!N26").Value = Me.E_Position3.Value
Range("Einstellungen!N27").Value = Me.E_Position4.Value
Range("Einstellungen!N28").Value = Me.E_Position5.Value
Range("Einstellungen!N29").Value = Me.E_Position6.Value
End If

' Expeditionstage
Range("Einstellungen!H2").Value = Range("Einstellungen!U9").Value

' Flottenverkauf
Range("Einstellungen!B2").Value = Range("Einstellungen!U10").Value ' Verkauf ja oder nein
Range("Einstellungen!B7").Value = Range("Einstellungen!T11").Value ' KT
Range("Einstellungen!B8").Value = Range("Einstellungen!T12").Value ' GT
Range("Einstellungen!B9").Value = Range("Einstellungen!T13").Value ' Spio
Range("Einstellungen!B10").Value = Range("Einstellungen!T14").Value ' LJ
Range("Einstellungen!B11").Value = Range("Einstellungen!T15").Value ' SJ
Range("Einstellungen!B12").Value = Range("Einstellungen!T16").Value ' Xer
Range("Einstellungen!B13").Value = Range("Einstellungen!T17").Value ' SS
Range("Einstellungen!B14").Value = Range("Einstellungen!T18").Value ' Sxer
Range("Einstellungen!B15").Value = Range("Einstellungen!T19").Value ' BB
Range("Einstellungen!B16").Value = Range("Einstellungen!T20").Value ' Zerri
Range("Einstellungen!B17").Value = Range("Einstellungen!T21").Value ' Reaper
Range("Einstellungen!B18").Value = Range("Einstellungen!T22").Value ' Pathfinder

' Wenn Gespeichert wurde, MUSS SPEICHERN ( Variable ) auf Nein
Range("Einstellungen!L1").Value = "Nein"

MsgBox "Daten gespeichert!", vbOKOnly + vbInformation, "Speicherung"
Unload Me
Call UserForm_Einstellungen

Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Speichern )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"

End Sub

Private Sub C_Eintragung_Click()

    If Worksheets("Auswertungen").Range("A3").Value <> 0 And Me.C_Eintragung.Value = True Then
        If MsgBox("Es sind schon Daten vorhanden, sollen diese vorher gel|fffd|scht werden?", vbYesNo + vbExclamation, "alte Daten l|fffd|schen?") = vbNo Then
            Me.C_Eintragung.Value = False
        Else
            Upgrade = 1
            Call L|fffd|schen
        End If
    End If

End Sub

' ****************************************************************************************
' BEENDEN :: |fffd|berpr|fffd|fen ob |fffd|nderungen vorgenommen wurden die Gespeichert werden m|fffd|ssten?
' ****************************************************************************************
' Dazu wird bei relvanten Teilen in das Feld "L1" Ja oder NEIN hineingeschrieben!

Private Sub B_Beenden_Click()
On Error GoTo ErrorHandler

' Wenn Einstellungen fehlen soll die Arbeitsmappe geschlossen werden
                If Range("Auswertungen!G1").Text = "Einstellungen fehlen!" Then GoTo Out ' Damit nicht alles Doppelt stehen muss!

' Abfrage bei |fffd|nderung, ob wirklich nicht gespeichert werden soll!
    If Range("Einstellungen!L1").Text Like "Ja" Then
        If MsgBox("Sind Sie sicher das Sie die ge|fffd|nderten Daten verwerfen m|fffd|chten?", vbYesNo, "Wirklich fortfahren?") = vbYes Then
            Unload Me
        Else
            Exit Sub
        End If
     End If
     
Unload Me

Exit Sub

' Wenn Einstellungen fehlen soll die Arbeitsmappe geschlossen werden
Out:
If MsgBox("Es fehlen Einstellungen!" & Chr(13) & Chr(13) & "Soll Excel geschlossen werden?", vbYesNo + vbQuestion, "Einstellungen fehlen") = vbNo Then
        Exit Sub
    Else
        ThisWorkbook.Saved = True
        Application.Quit
End If

Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Beenden )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
        
End Sub

' ******************************************************************************
' WERKSEINSTELLUNG
' ******************************************************************************

Private Sub B_Werkseinstellung_Click()
On Error GoTo ErrorHandler

Application.ScreenUpdating = False
Call Blattschutz_on_off

    If MsgBox("Alle Einstellungen auf Standart zur|fffd|cksetzen?", vbYesNo + vbInformation, "Werkseinstellung Seite 1 von 2") = vbYes Then
        Range("Einstellungen!B2").Value = 2 ' Nicht Verkaufen der Flotte
        Range("Einstellungen!B7:B18").Value = "TRUE"
        Range("Einstellungen!B8, Einstellungen!B10").Value = "FALSE"
        Range("Einstellungen!H2").Value = 1 ' Expeditionstage oder Kalendertage
        Range("Einstellungen!M3").Value = 1 ' Universum
        Range("Einstellungen!AC23").Value = Range("Einstellungen!AC33").Value ' Punkte Platz 1
        Range("Einstellungen!M5").Value = 1 ' Astrophysik
        Range("Einstellungen!M6").Value = 1 ' Verbrennungstriebwerk
        Range("Einstellungen!M7").Value = 1 ' Impulstriebwerk
        Range("Einstellungen!M8").Value = 1 ' Hyperraumantrieb
        Range("Einstellungen!O4").Value = "keine" ' Klasse
        Range("Einstellungen!O5").Value = 16 ' Waffentechnik
        Range("Einstellungen!O6").Value = 16 ' Schildtechnik
        Range("Einstellungen!O7").Value = 16 ' Raumschiffpanzerung
        Range("Einstellungen!M12").Value = 1 ' Haltezeit
        Range("Einstellungen!M13").Value = "100%" ' Expeditionsgeschwindigkeit
        Range("Einstellungen!M15").Value = "FALSE" ' Handleskurs
        Range("Einstellungen!L16").Value = 2 ' Handelskurs Metall
        Range("Einstellungen!L17").Value = 1 ' Handelskurs Kristall
        Range("Einstellungen!L18").Value = 1 ' Handelskurs Deuterium
        Range("Einstellungen!I16").Value = "FALSE" ' Prozente auf Auswertungen anzeigen
        Range("Auswertungen!A3").NumberFormat = "#,##0"
        Range("Einstellungen!L24:Einstellungen!N31").Value = "" ' L|fffd|sche Galaxie, System, Position
        'Standartflotte der Expedition
        Range("Einstellungen!L35").Value = "FALSE"   ' Kleine Transporter
        Range("Einstellungen!M35").Value = 0
        Range("Einstellungen!L36").Value = "TRUE"    ' Gro|fffd|er Transporter
        Range("Einstellungen!M36").Value = 408
        Range("Einstellungen!L37").Value = "FALSE"   ' Spionagesonde
        Range("Einstellungen!M37").Value = 0
        Range("Einstellungen!L38").Value = "FALSE"   ' Leichte J|fffd|ger
        Range("Einstellungen!M38").Value = 0
        Range("Einstellungen!L39").Value = "FALSE"   ' Schwere J|fffd|ger
        Range("Einstellungen!M39").Value = 0
        Range("Einstellungen!L40").Value = "FALSE"   ' Kreuzer
        Range("Einstellungen!M40").Value = 0
        Range("Einstellungen!L41").Value = "FALSE"   ' Schlachtschiff
        Range("Einstellungen!M41").Value = 0
        Range("Einstellungen!L42").Value = "FALSE"   ' Schlachtkreuzer
        Range("Einstellungen!M42").Value = 0
        Range("Einstellungen!L43").Value = "FALSE"   ' Bomber
        Range("Einstellungen!M43").Value = 0
        Range("Einstellungen!L44").Value = "TRUE"    ' Zerst|fffd|rer
        Range("Einstellungen!M44").Value = 1
        Range("Einstellungen!L45").Value = "FALSE"    ' Reaper
        Range("Einstellungen!M45").Value = 0
        Range("Einstellungen!L46").Value = "FALSE"    ' Pathfinder
        Range("Einstellungen!M46").Value = 0
        ' Admiral?
        Range("Einstellungen!N12").Value = "FALSE"
        ' Auto Eintragung?
        Range("Einstellungen!O12").Value = "FALSE"
        
        Call Formeln ' alle Formeln erneuern, da beim l|fffd|schen von Zeilen diese gemindert werden
                
        MsgBox "Einstellungen erfolgreich zur|fffd|ckgesetzt!", vbInformation, "Information"
        
    End If
               
        Call Blattschutz_on_off
               
    If MsgBox("Alle Eintragungen l|fffd|schen?", vbYesNo + vbInformation, "Werkseinstellung Seite 2 von 2") = vbYes Then
        Call L|fffd|schen
    End If
    
    Application.ScreenUpdating = True
    
    Unload Me
    Call UserForm_Einstellungen
    
Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Werkseinstellung )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
        
End Sub

' ******************************************************************************
' Upgrade ( Wiederherstellung )
' ******************************************************************************
Private Sub B_UpgradeHilfeLos_Click()
On Error GoTo ErrorHandler

Dim NeueDateipfad  As Variant
Dim NeueDatei As String
Dim Datei As Workbook
Dim MaxSpalte, i As Integer
Dim Einstellung As Boolean
Dim Eintragung As Boolean

'Speichern was Kopiert werden soll
Einstellung = Me.C_Einstellung.Value
Eintragung = Me.C_Eintragung.Value

' Wenn nichts ausgew|fffd|hlt wurde
If Einstellung = False And Eintragung = False Then
    MsgBox "Sie haben keine Auswahl getroffen!", vbOKOnly + vbInformation, "Es ist ein Fehler aufgetreten!"
    Exit Sub
End If

' Anfang des Upgrades
Unload UF_Einstellungen
MsgBox "Bitte w|fffd|hlen Sie die Datei aus, welche Ihre Daten enth|fffd|lt!", vbInformation, "Upgrade ( Wiederherstellung )"
   NeueDateipfad = Application.GetOpenFilename(FileFilter:="Microsoft Excel-Dateien (*.xlsm), *.xlsm", Title:="Alten Expeditionsrechner w|fffd|hlen!") ' Datei ausw|fffd|hlen
   If NeueDateipfad = False Then MsgBox "Der Upgrade vorgang wurde abgebrochen!", vbInformation, "Information": Exit Sub ' bei Abbruch
    
NeueDatei = Dir(NeueDateipfad, vbDirectory) ' Aus dem Dateipfad auslesen wie die Datei hei|fffd|t um zu pr|fffd|fen ob Quelle und Ziel gleich sind!
    
    If NeueDatei = ThisWorkbook.Name Then ' Wenn die Namen von Quell und Ziel gleich sind gibt es sonst ein Fehler!
            NeueDatei = Left(NeueDatei, Len(NeueDatei) - 5) ' Schneidet die Endung .xlsm weg!
            MsgBox "Beide Dateien haben den selben Namen:" & vbNewLine & vbNewLine & NeueDatei & vbNewLine & vbNewLine & _
                   "Bitte |fffd|ndern Sie einen und versuchen Sie es erneut!", vbExclamation, "Leider Funktioniert es so nicht!"
            Exit Sub
    End If
    
    Call Blattschutz_on_off ' Blattschutz entfernen
   
   Set Datei = Workbooks.Open(NeueDateipfad, ReadOnly:=True) ' Datei |fffd|ffnen
   
   ThisWorkbook.Activate
   Application.ScreenUpdating = False


'Einstellungen Wiederherstellen ( wenn ausgew|fffd|hlt )
If Einstellung = True Then
   Datei.Worksheets("Einstellungen").Range("B2").Copy                                                                                 'H|fffd|ndler verkaufen?
   ThisWorkbook.Worksheets("Einstellungen").Range("B2").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("B7:B18").Copy                                                                             'KT, GT etc.
   ThisWorkbook.Worksheets("Einstellungen").Range("B7:B16").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("H2").Copy                                                                                 'Expedition pro Tag
   ThisWorkbook.Worksheets("Einstellungen").Range("H2").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("M3").Copy                                                                                 'Universum
   ThisWorkbook.Worksheets("Einstellungen").Range("M3").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("M5:M8").Copy                                                                              'Forschungsstufen
   ThisWorkbook.Worksheets("Einstellungen").Range("M5:M8").PasteSpecial Paste:=xlPasteValues
   
   
   If Datei.Worksheets("Einstellungen").Range("N4").Value = "Klasse? >" Then                                ' Wenn noch alte Datei, also ohne Klasse
   Datei.Worksheets("Einstellungen").Range("O4").Copy                                                                                 'Klasse
   ThisWorkbook.Worksheets("Einstellungen").Range("O4").PasteSpecial Paste:=xlPasteValues
   End If
   
   'Prozente auf Auswertungen anzeigen
   If Datei.Worksheets("Einstellungen").Range("I16").Value = "" Then
        ThisWorkbook.Worksheets("Einstellungen").Range("I16").Value = "FALSE"
   Else
        Datei.Worksheets("Einstellungen").Range("I16").Copy
        ThisWorkbook.Worksheets("Einstellungen").Range("I16").PasteSpecial Paste:=xlPasteValues
   End If
   '----------------------------------
   Datei.Worksheets("Einstellungen").Range("M12:M13").Copy                                              'Expeditionseinstellungen
   ThisWorkbook.Worksheets("Einstellungen").Range("M12:M13").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("N12").Copy                                                  'Admiral aktiv?
   ThisWorkbook.Worksheets("Einstellungen").Range("N12").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("O12").Copy                                                  'Automatische Eintragung aktiv?
   ThisWorkbook.Worksheets("Einstellungen").Range("O12").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("L16:M16").Copy                                              'Handelskurs Metall
   ThisWorkbook.Worksheets("Einstellungen").Range("L16:M16").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("L17:M17").Copy                                              'Handelskurs Kristall
   ThisWorkbook.Worksheets("Einstellungen").Range("L17:M17").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("L18:M18").Copy                                              'Handelskurs Deuterium
   ThisWorkbook.Worksheets("Einstellungen").Range("L18:M18").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("L24:N28").Copy                                              'Expeditionskosten
   ThisWorkbook.Worksheets("Einstellungen").Range("L24:N28").PasteSpecial Paste:=xlPasteValues
   
   Datei.Worksheets("Einstellungen").Range("AC23:AD23").Copy                                            'Platz 1
   ThisWorkbook.Worksheets("Einstellungen").Range("AC23:AD23").PasteSpecial Paste:=xlPasteValues
End If

' Eintragungen Wiederherstellen ( wenn ausgew|fffd|hlt )
If Eintragung = True Then
    MaxSpalte = Datei.Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row
    
' Urkunden Daten
Datei.Worksheets("Einstellungen").Range("Einstellungen!B41:B53").Copy
ThisWorkbook.Worksheets("Einstellungen").Range("Einstellungen!B41:B53").PasteSpecial Paste:=xlPasteValues

' Kopiert die Spalten runter "Eintragungen"
    ThisWorkbook.Worksheets("Eintragungen").Rows("58:58").Copy ThisWorkbook.Worksheets("Eintragungen").Rows("59:" & MaxSpalte + 51)
    
' Kopiert die Spalten runter "Einstellungen"
    ThisWorkbook.Worksheets("Einstellungen").Visible = True
    Range(ThisWorkbook.Worksheets("Einstellungen").Cells(58, 43), ThisWorkbook.Worksheets("Einstellungen").Cells(58, 81)).Copy
    Range(ThisWorkbook.Worksheets("Einstellungen").Cells(59, 43), ThisWorkbook.Worksheets("Einstellungen").Cells(MaxSpalte + 51, 81)).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    
    ThisWorkbook.Worksheets("Einstellungen").Visible = xlSheetVeryHidden
     
' Anzahl der Expeditionen |fffd|bernehmen
    Datei.Worksheets("Einstellungen").Range("D79:D111").Copy                                        'Expedition | RES, DM und Fleet
    ThisWorkbook.Worksheets("Einstellungen").Range("D79:D93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("I79:I111").Copy                                        'Expedition | Nichts
    ThisWorkbook.Worksheets("Einstellungen").Range("I79:I93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("N79:N111").Copy                                        'Expedition | Versp|fffd|tung
    ThisWorkbook.Worksheets("Einstellungen").Range("N79:N93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("S79:S111").Copy                                        'Expedition | Verf|fffd|hung
    ThisWorkbook.Worksheets("Einstellungen").Range("S79:S93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("X79:X111").Copy                                        'Expedition | H|fffd|ndler
    ThisWorkbook.Worksheets("Einstellungen").Range("X79:X93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("AC79:AC111").Copy                                      'Expedition | Piraten
    ThisWorkbook.Worksheets("Einstellungen").Range("AC79:AC93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("AH79:AH111").Copy                                      'Expedition | Aliens
    ThisWorkbook.Worksheets("Einstellungen").Range("AH79:AH93").PasteSpecial Paste:=xlPasteValues
    
    Datei.Worksheets("Einstellungen").Range("AM79:AM111").Copy                                      'Expedition | Totalverlust
    ThisWorkbook.Worksheets("Einstellungen").Range("AM79:AM93").PasteSpecial Paste:=xlPasteValues
    
' Eintragungen werden kopiert
    ' Datei.Worksheets("Eintragungen").Activate
    If Datei.Worksheets("Einstellungen").Range("N4").Value = "Klasse? >" Then ' wenn noch keine Klasse in der alten Version
        Range(Datei.Worksheets("Eintragungen").Cells(8, 1), Datei.Worksheets("Eintragungen").Cells(MaxSpalte, 44)).Copy
        ThisWorkbook.Worksheets("Eintragungen").Range("A8").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Else
    ' bis Zerst|fffd|rer
        Range(Datei.Worksheets("Eintragungen").Cells(8, 1), Datei.Worksheets("Eintragungen").Cells(MaxSpalte, 13)).Copy
        ThisWorkbook.Worksheets("Eintragungen").Range("A8").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    ' ab erste Graue Unterbrechung bis Zerst|fffd|rer
        Range(Datei.Worksheets("Eintragungen").Cells(8, 14), Datei.Worksheets("Eintragungen").Cells(MaxSpalte, 34)).Copy
        ThisWorkbook.Worksheets("Eintragungen").Range("P8").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    ' der Rest
        Range(Datei.Worksheets("Eintragungen").Cells(8, 35), Datei.Worksheets("Eintragungen").Cells(MaxSpalte, 40)).Copy
        ThisWorkbook.Worksheets("Eintragungen").Range("AM8").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End If
    
End If
 
   Application.CutCopyMode = False       ' Zwischenablage leeren
   Datei.Saved = True                    ' Ohne Zwischenfrage Schlie|fffd|en
   Datei.Close                           ' Datei schlie|fffd|en
   
' Prozente auf Auswertungen anzeigen oder nicht?
If Range("Einstellungen!I16").Value = True Then
            ThisWorkbook.Worksheets("Auswertungen").Range("A3").NumberFormat = "#,##0 ""( 100 % )"""
        Else
            ThisWorkbook.Worksheets("Auswertungen").Range("A3").NumberFormat = "#,##0"
        End If

If Me.C_Eintragung.Value = True Then ' Sonst wird die Formatierung auf Auswertungen gesetzt!

' Bedingte Formatierung
Cells.FormatConditions.Delete
MaxSpalte = ThisWorkbook.Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row + 51

' Bedingte Formatierung Erstellen
Cells.FormatConditions.Delete
MaxSpalte = ThisWorkbook.Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row + 52

' Bedingte Formatierung
Cells.FormatConditions.Delete
MaxSpalte = Worksheets("Eintragungen").Range("A1000000").End(xlUp).Row + 51

' OBERSTE ZEILE ROT, wenn irgendwo Fehler
    With Range("A7")
        .FormatConditions.Add Type:=xlExpression, Formula1:="=SUCHEN("" FEHLER"";$AS$1;1)"
        .FormatConditions(Range("A7").FormatConditions.Count).SetFirstPriority
        With Range("A7").FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 255
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Jeder 2 Zeile wird Orange
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=ISTGERADE(ZEILE())"
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent6
            .TintAndShade = 0.399945066682943
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Zeile f|fffd|r den n|fffd|chsten Eintrag wird Blau
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=UND($AZ7=""OK"";$A8="""")"
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent1
            .TintAndShade = 0.599963377788629
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
' Bei falscher Eingabe wird die Zeile Rot
    With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15)))
        .FormatConditions.Add Type:=xlExpression, Formula1:="=$AZ8=""FEHLER"""
        .FormatConditions(Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions.Count).SetFirstPriority
        With Union(Range(Worksheets("Eintragungen").Cells(8, 26), Worksheets("Eintragungen").Cells(MaxSpalte, 38)), Range(Worksheets("Eintragungen").Cells(8, 17), Worksheets("Eintragungen").Cells(MaxSpalte, 24)), Range(Worksheets("Eintragungen").Cells(8, 40), Worksheets("Eintragungen").Cells(MaxSpalte, 44)), Range(Worksheets("Eintragungen").Cells(8, 1), Worksheets("Eintragungen").Cells(MaxSpalte, 15))).FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 255
            .TintAndShade = 0
        End With
        .FormatConditions(1).StopIfTrue = False
    End With
    
''ALT ----> OBERSTE ZEILE ROT, wenn irgendwo Fehler
'' ++++++++++++++++++++++++++++++++++++++++++++++++++
'    With ThisWorkbook.Worksheets("Eintragungen").Range("A7")
'        .FormatConditions.Add Type:=xlExpression, Formula1:="=SUCHEN("" FEHLER"";$AS$1;1)"
'        .FormatConditions(ThisWorkbook.Worksheets("Eintragungen").Range("A7").FormatConditions.Count).SetFirstPriority
'    With ThisWorkbook.Worksheets("Eintragungen").Range("A7").FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 255
'        .TintAndShade = 0
'    End With
'        .FormatConditions(1).StopIfTrue = False
'    End With
'' Jeder 2 Zeile wird Orange
'    With Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13)))
'    .FormatConditions.Add Type:=xlExpression, Formula1:="=ISTGERADE(ZEILE())"
'    .FormatConditions(Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13))).FormatConditions.Count).SetFirstPriority
'    With Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13))).FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .ThemeColor = xlThemeColorAccent6
'        .TintAndShade = 0.399945066682943
'    End With
'    .FormatConditions(1).StopIfTrue = False
'    End With
'
'' Zeile f|fffd|r den n|fffd|chsten Eintrag wird Blau
'    With Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13)))
'    .FormatConditions.Add Type:=xlExpression, Formula1:="=UND($AV7=""OK"";$A8="""")"
'    .FormatConditions(Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13))).FormatConditions.Count).SetFirstPriority
'    With Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13))).FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .ThemeColor = xlThemeColorAccent1
'        .TintAndShade = 0.599963377788629
'    End With
'    .FormatConditions(1).StopIfTrue = False
'    End With
'
'' Bei falscher Eingabe wird die Zeile Rot
'    With Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13)))
'    .FormatConditions.Add Type:=xlExpression, Formula1:="=$AV8=""FEHLER"""
'    .FormatConditions(Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13))).FormatConditions.Count).SetFirstPriority
'    With Union(Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 24), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 34)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 15), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 22)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 36), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 40)), _
'    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 13))).FormatConditions(1).Interior
'        .PatternColorIndex = xlAutomatic
'        .Color = 255
'        .TintAndShade = 0
'    End With
'    .FormatConditions(1).StopIfTrue = False
'    End With
    
' Datum formatieren
    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 1)).NumberFormat = "DD.MM.YYYY"
' Uhrzeit formatieren
    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 2), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 2)).NumberFormat = "hh:mm U\hr"
' Ereignisse wieder auf Standard Formatierung setzen
    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 17), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 24)).NumberFormat = ""
' Formatiert, damit die "0" nicht sichtbar ist
    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 3), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 15)).NumberFormat = "#,##0 ;;"
    Range(ThisWorkbook.Worksheets("Eintragungen").Cells(8, 26), ThisWorkbook.Worksheets("Eintragungen").Cells(MaxSpalte, 38)).NumberFormat = "#,##0;[Red]#,##0;;"
    
End If

Call Blattschutz_on_off ' Blattschutz setzen
   
   
   Application.ScreenUpdating = True

Worksheets("Auswertungen").Select
MsgBox "Die Daten wurden erfolgreich |fffd|bertragen!", vbInformation, "Erfolgreiche |fffd|bertragung"

ThisWorkbook.Saved = False
   
Call UserForm_Einstellungen
   
Exit Sub

ErrorHandler:

   Application.CutCopyMode = False       ' Zwischenablage leeren
   Datei.Saved = True                    ' Ohne Zwischenfrage Schlie|fffd|en
   Datei.Close                           ' Datei schlie|fffd|en

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Wiederherstellen )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"

End Sub

' ******************************************************************************
' Damit man nicht um die Abfrage herum kommt ob |fffd|nderungen erfolgt sind!
' ******************************************************************************

' Damit man in der Userform nicht auf das "Rote Kreuz" klicken kann!
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
  
  If CloseMode = False Then
    MsgBox "Bitte nutzen Sie den Button <Beenden> !", vbOKOnly + vbExclamation, "Bitte so nicht..."
    Cancel = True
  End If
End Sub

' ******************************************************************************
' IMPRESSUM > Hyperlinks und sofort auf Updates Pr|fffd|fen
' ******************************************************************************

Private Sub L_Version_Click()
'Sofort auf Update Pr|fffd|fen
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

Call Upgradepr|fffd|fung

    Unload Me
    Load UF_Einstellungen
    UF_Einstellungen.Show

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Impressum - Version )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
End Sub

Private Sub L_Version_Universum_Click()
'Sofort auf Update Pr|fffd|fen
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

Call Upgradepr|fffd|fung

    Unload Me
    Load UF_Einstellungen
    UF_Einstellungen.Show

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Impressum - Version )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
End Sub

Private Sub L_Lizens_Click()
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

 ThisWorkbook.FollowHyperlink Address:="https://de.m.wikipedia.org/wiki/Donationware", NewWindow:=True

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Impressum - Lizens )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
End Sub

Private Sub L_Impressum_Click()
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

 ThisWorkbook.FollowHyperlink Address:="https://board.de.ogame.gameforge.com/index.php/Thread/195183-Expeditionstool/", NewWindow:=True

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Lob und Kritik )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
        
End Sub

Private Sub L_Email_Click()
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

 ThisWorkbook.FollowHyperlink Address:="http://basisa.lima-city.de/index.php/de/kontakt/kontakformular", NewWindow:=True

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( E-Mail )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
        
End Sub

' ******************************************************************************
' Changelogs > Hyperlinks' ******************************************************************************

Private Sub CB_Changelog_Click()
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

 ThisWorkbook.FollowHyperlink Address:="http://basisa.lima-city.de/index.php/de/downloads/expeditionstool/changelog-expeditionstool", NewWindow:=True

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Changelog - Link )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"

End Sub

' ******************************************************************************
' L|fffd|dt die Urkunde erneut bei bedarf aus EINSTELLUNG > Sonstiges > Urkunde
' ******************************************************************************
Private Sub CB_Urkunde_Click()

    Load UF_Urkunde
    UF_Urkunde.Show
    
End Sub

' ******************************************************************************
' Mein kleines Hintert|fffd|rchen
' ******************************************************************************

Private Sub I_Versteckt_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

Unload Me

Load UF_Adminbereich
UF_Adminbereich.Show

End Sub


Attribute VB_Name = "UF_Expeditionen"
Attribute VB_Base = "0{91986C3C-4208-457D-8CED-D662309462D3}{D5EA7D01-6E52-4F56-86E3-A5D1E1DE5591}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

' ##################################################
' Liest alles ein wenn UserForm sich |fffd|ffnet
' ##################################################

Private Sub UserForm_Activate()
On Error GoTo ErrorHandler

Dim Summe As Single
Dim Anzahl As Integer

' ############################
' Flottenfund
' ############################

Summe = Worksheets("Einstellungen").Range("D91").Value + Worksheets("Einstellungen").Range("D92").Value + Worksheets("Einstellungen").Range("D93").Value

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(0).Enabled = True
Me.MultiPage_Expeditionen.Pages(0).Caption = "Flottenfund (" & Summe & ")"

Me.L_Flottenfund_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D91").Value
Me.L_Flottenfund_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D92").Value
Me.L_Flottenfund_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D93").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Flottenfund_Anzahl_Normal.Caption = "" Then Me.L_Flottenfund_Anzahl_Normal.Caption = "0"
If Me.L_Flottenfund_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Flottenfund_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Flottenfund_Anzahl_Riesig.Caption = "" Then Me.L_Flottenfund_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Flottenfund_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Flottenfund_Anzahl_Normal.Caption, "0.0")
    Me.L_Flottenfund_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Flottenfund_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Flottenfund_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Flottenfund_Anzahl_Riesig.Caption, "0.0")
End If

' ############################
' Ressourcen
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!D79:Einstellungen!D90").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(1).Enabled = True
Me.MultiPage_Expeditionen.Pages(1).Caption = "Ressourcen (" & Summe & ")"

' METALL ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D79:Einstellungen!D81").Value)

Me.L_RES_Metall_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D79").Value
Me.L_RES_Metall_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D80").Value
Me.L_RES_Metall_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D81").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_RES_Metall_Anzahl_Normal.Caption = "" Then Me.L_RES_Metall_Anzahl_Normal.Caption = "0"
If Me.L_RES_Metall_Anzahl_Gro|fffd|.Caption = "" Then Me.L_RES_Metall_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_RES_Metall_Anzahl_Riesig.Caption = "" Then Me.L_RES_Metall_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_RES_Metall_Prozent_Normal.Caption = Format(100 / Summe * Me.L_RES_Metall_Anzahl_Normal.Caption, "0.0")
    Me.L_RES_Metall_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_RES_Metall_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_RES_Metall_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_RES_Metall_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' Kristall ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D82:Einstellungen!D84").Value)

Me.L_RES_Kristall_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D82").Value
Me.L_RES_Kristall_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D83").Value
Me.L_RES_Kristall_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D84").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_RES_Kristall_Anzahl_Normal.Caption = "" Then Me.L_RES_Kristall_Anzahl_Normal.Caption = "0"
If Me.L_RES_Kristall_Anzahl_Gro|fffd|.Caption = "" Then Me.L_RES_Kristall_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_RES_Kristall_Anzahl_Riesig.Caption = "" Then Me.L_RES_Kristall_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_RES_Kristall_Prozent_Normal.Caption = Format(100 / Summe * Me.L_RES_Kristall_Anzahl_Normal.Caption, "0.0")
    Me.L_RES_Kristall_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_RES_Kristall_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_RES_Kristall_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_RES_Kristall_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' Deuterium ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D85:Einstellungen!D87").Value)

Me.L_RES_Deuterium_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D85").Value
Me.L_RES_Deuterium_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D86").Value
Me.L_RES_Deuterium_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D87").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_RES_Deuterium_Anzahl_Normal.Caption = "" Then Me.L_RES_Deuterium_Anzahl_Normal.Caption = "0"
If Me.L_RES_Deuterium_Anzahl_Gro|fffd|.Caption = "" Then Me.L_RES_Deuterium_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_RES_Deuterium_Anzahl_Riesig.Caption = "" Then Me.L_RES_Deuterium_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_RES_Deuterium_Prozent_Normal.Caption = Format(100 / Summe * Me.L_RES_Deuterium_Anzahl_Normal.Caption, "0.0")
    Me.L_RES_Deuterium_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_RES_Deuterium_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_RES_Deuterium_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_RES_Deuterium_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' Dunkle Materie ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D88:Einstellungen!D90").Value)

Me.L_RES_DM_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D88").Value
Me.L_RES_DM_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D89").Value
Me.L_RES_DM_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D90").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_RES_DM_Anzahl_Normal.Caption = "" Then Me.L_RES_DM_Anzahl_Normal.Caption = "0"
If Me.L_RES_DM_Anzahl_Gro|fffd|.Caption = "" Then Me.L_RES_DM_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_RES_DM_Anzahl_Riesig.Caption = "" Then Me.L_RES_DM_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_RES_DM_Prozent_Normal.Caption = Format(100 / Summe * Me.L_RES_DM_Anzahl_Normal.Caption, "0.0")
    Me.L_RES_DM_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_RES_DM_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_RES_DM_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_RES_DM_Anzahl_Riesig.Caption, "0.0")
End If

' ############################
' Items
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!D94:Einstellungen!D111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(2).Enabled = True
Me.MultiPage_Expeditionen.Pages(2).Caption = "Items (" & Summe & ")"

' METALL-Booster ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D94:Einstellungen!D96").Value)

Me.L_Metallbooster_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D94").Value
Me.L_Metallbooster_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D95").Value
Me.L_Metallbooster_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D96").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Metallbooster_Anzahl_Normal.Caption = "" Then Me.L_Metallbooster_Anzahl_Normal.Caption = "0"
If Me.L_Metallbooster_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Metallbooster_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Metallbooster_Anzahl_Riesig.Caption = "" Then Me.L_Metallbooster_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Metallbooster_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Metallbooster_Anzahl_Normal.Caption, "0.0")
    Me.L_Metallbooster_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Metallbooster_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Metallbooster_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Metallbooster_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' KRISTALL-Booster ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D97:Einstellungen!D99").Value)

Me.L_Kristallbooster_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D97").Value
Me.L_Kristallbooster_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D98").Value
Me.L_Kristallbooster_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D99").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Kristallbooster_Anzahl_Normal.Caption = "" Then Me.L_Kristallbooster_Anzahl_Normal.Caption = "0"
If Me.L_Kristallbooster_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Kristallbooster_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Kristallbooster_Anzahl_Riesig.Caption = "" Then Me.L_Kristallbooster_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Kristallbooster_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Kristallbooster_Anzahl_Normal.Caption, "0.0")
    Me.L_Kristallbooster_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Kristallbooster_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Kristallbooster_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Kristallbooster_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' DEUTERIUM-Booster ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D100:Einstellungen!D102").Value)

Me.L_Deuteriumbooster_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D100").Value
Me.L_Deuteriumbooster_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D101").Value
Me.L_Deuteriumbooster_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D102").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Deuteriumbooster_Anzahl_Normal.Caption = "" Then Me.L_Deuteriumbooster_Anzahl_Normal.Caption = "0"
If Me.L_Deuteriumbooster_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Deuteriumbooster_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Deuteriumbooster_Anzahl_Riesig.Caption = "" Then Me.L_Deuteriumbooster_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Deuteriumbooster_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Deuteriumbooster_Anzahl_Normal.Caption, "0.0")
    Me.L_Deuteriumbooster_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Deuteriumbooster_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Deuteriumbooster_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Deuteriumbooster_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' KRAKEN ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D103:Einstellungen!D105").Value)

Me.L_Kraken_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D103").Value
Me.L_Kraken_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D104").Value
Me.L_Kraken_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D105").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Kraken_Anzahl_Normal.Caption = "" Then Me.L_Kraken_Anzahl_Normal.Caption = "0"
If Me.L_Kraken_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Kraken_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Kraken_Anzahl_Riesig.Caption = "" Then Me.L_Kraken_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Kraken_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Kraken_Anzahl_Normal.Caption, "0.0")
    Me.L_Kraken_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Kraken_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Kraken_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Kraken_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' DETROID ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D106:Einstellungen!D108").Value)

Me.L_Detroid_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D106").Value
Me.L_Detroid_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D107").Value
Me.L_Detroid_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D108").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Detroid_Anzahl_Normal.Caption = "" Then Me.L_Detroid_Anzahl_Normal.Caption = "0"
If Me.L_Detroid_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Detroid_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Detroid_Anzahl_Riesig.Caption = "" Then Me.L_Detroid_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Detroid_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Detroid_Anzahl_Normal.Caption, "0.0")
    Me.L_Detroid_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Detroid_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Detroid_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Detroid_Anzahl_Riesig.Caption, "0.0")
End If

' --------------------------
' NEWTRON ***
Summe = WorksheetFunction.Sum(Range("Einstellungen!D109:Einstellungen!D111").Value)

Me.L_Newtron_Anzahl_Normal.Caption = Worksheets("Einstellungen").Range("D109").Value
Me.L_Newtron_Anzahl_Gro|fffd|.Caption = Worksheets("Einstellungen").Range("D110").Value
Me.L_Newtron_Anzahl_Riesig.Caption = Worksheets("Einstellungen").Range("D111").Value
' Fehlerbeheben wenn "" drin steht!
If Me.L_Newtron_Anzahl_Normal.Caption = "" Then Me.L_Newtron_Anzahl_Normal.Caption = "0"
If Me.L_Newtron_Anzahl_Gro|fffd|.Caption = "" Then Me.L_Newtron_Anzahl_Gro|fffd|.Caption = "0"
If Me.L_Newtron_Anzahl_Riesig.Caption = "" Then Me.L_Newtron_Anzahl_Riesig.Caption = "0"

If Summe <> "0" Then
    Me.L_Newtron_Prozent_Normal.Caption = Format(100 / Summe * Me.L_Newtron_Anzahl_Normal.Caption, "0.0")
    Me.L_Newtron_Prozent_Gro|fffd|.Caption = Format(100 / Summe * Me.L_Newtron_Anzahl_Gro|fffd|.Caption, "0.0")
    Me.L_Newtron_Prozent_Riesig.Caption = Format(100 / Summe * Me.L_Newtron_Anzahl_Riesig.Caption, "0.0")
End If

' ############################
' Nichts
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!I79:Einstellungen!I111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(3).Enabled = True
Me.MultiPage_Expeditionen.Pages(3).Caption = "Nichts (" & Summe & ")"

' Nummern eintragen
Me.L_Nichts_Anzahl_01.Caption = Worksheets("Einstellungen").Range("I79").Value
If Me.L_Nichts_Anzahl_01.Caption = "" Then Me.L_Nichts_Anzahl_01.Caption = "0"

Me.L_Nichts_Anzahl_02.Caption = Worksheets("Einstellungen").Range("I80").Value
If Me.L_Nichts_Anzahl_02.Caption = "" Then Me.L_Nichts_Anzahl_02.Caption = "0"

Me.L_Nichts_Anzahl_03.Caption = Worksheets("Einstellungen").Range("I81").Value
If Me.L_Nichts_Anzahl_03.Caption = "" Then Me.L_Nichts_Anzahl_03.Caption = "0"

Me.L_Nichts_Anzahl_04.Caption = Worksheets("Einstellungen").Range("I82").Value
If Me.L_Nichts_Anzahl_04.Caption = "" Then Me.L_Nichts_Anzahl_04.Caption = "0"

Me.L_Nichts_Anzahl_05.Caption = Worksheets("Einstellungen").Range("I83").Value
If Me.L_Nichts_Anzahl_05.Caption = "" Then Me.L_Nichts_Anzahl_05.Caption = "0"

Me.L_Nichts_Anzahl_06.Caption = Worksheets("Einstellungen").Range("I84").Value
If Me.L_Nichts_Anzahl_06.Caption = "" Then Me.L_Nichts_Anzahl_06.Caption = "0"

Me.L_Nichts_Anzahl_07.Caption = Worksheets("Einstellungen").Range("I85").Value
If Me.L_Nichts_Anzahl_07.Caption = "" Then Me.L_Nichts_Anzahl_07.Caption = "0"

Me.L_Nichts_Anzahl_08.Caption = Worksheets("Einstellungen").Range("I86").Value
If Me.L_Nichts_Anzahl_08.Caption = "" Then Me.L_Nichts_Anzahl_08.Caption = "0"

Me.L_Nichts_Anzahl_09.Caption = Worksheets("Einstellungen").Range("I87").Value
If Me.L_Nichts_Anzahl_09.Caption = "" Then Me.L_Nichts_Anzahl_09.Caption = "0"

Me.L_Nichts_Anzahl_10.Caption = Worksheets("Einstellungen").Range("I88").Value
If Me.L_Nichts_Anzahl_10.Caption = "" Then Me.L_Nichts_Anzahl_10.Caption = "0"

Me.L_Nichts_Anzahl_11.Caption = Worksheets("Einstellungen").Range("I89").Value
If Me.L_Nichts_Anzahl_11.Caption = "" Then Me.L_Nichts_Anzahl_11.Caption = "0"

Me.L_Nichts_Anzahl_12.Caption = Worksheets("Einstellungen").Range("I90").Value
If Me.L_Nichts_Anzahl_12.Caption = "" Then Me.L_Nichts_Anzahl_12.Caption = "0"

' Text eintragen
Me.L_Nichts_Text_01.Caption = Worksheets("Einstellungen").Range("G79").Value
Me.L_Nichts_Text_02.Caption = Worksheets("Einstellungen").Range("G80").Value
Me.L_Nichts_Text_03.Caption = Worksheets("Einstellungen").Range("G81").Value
Me.L_Nichts_Text_04.Caption = Worksheets("Einstellungen").Range("G82").Value
Me.L_Nichts_Text_05.Caption = Worksheets("Einstellungen").Range("G83").Value
Me.L_Nichts_Text_06.Caption = Worksheets("Einstellungen").Range("G84").Value
Me.L_Nichts_Text_07.Caption = Worksheets("Einstellungen").Range("G85").Value
Me.L_Nichts_Text_08.Caption = Worksheets("Einstellungen").Range("G86").Value
Me.L_Nichts_Text_09.Caption = Worksheets("Einstellungen").Range("G87").Value
Me.L_Nichts_Text_10.Caption = Worksheets("Einstellungen").Range("G88").Value
Me.L_Nichts_Text_11.Caption = Worksheets("Einstellungen").Range("G89").Value
Me.L_Nichts_Text_12.Caption = Worksheets("Einstellungen").Range("G90").Value

' ############################
' Versp|fffd|tung
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!N79:Einstellungen!N111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(4).Enabled = True
Me.MultiPage_Expeditionen.Pages(4).Caption = "Versp|fffd|tung (" & Summe & ")"

' Nummern eintragen
Me.L_Versp|fffd|tung_Anzahl_01.Caption = Worksheets("Einstellungen").Range("N79").Value
If Me.L_Versp|fffd|tung_Anzahl_01.Caption = "" Then Me.L_Versp|fffd|tung_Anzahl_01.Caption = "0"

Me.L_Versp|fffd|tung_Anzahl_02.Caption = Worksheets("Einstellungen").Range("N80").Value
If Me.L_Versp|fffd|tung_Anzahl_02.Caption = "" Then Me.L_Versp|fffd|tung_Anzahl_02.Caption = "0"

Me.L_Versp|fffd|tung_Anzahl_03.Caption = Worksheets("Einstellungen").Range("N81").Value
If Me.L_Versp|fffd|tung_Anzahl_03.Caption = "" Then Me.L_Versp|fffd|tung_Anzahl_03.Caption = "0"

Me.L_Versp|fffd|tung_Anzahl_04.Caption = Worksheets("Einstellungen").Range("N82").Value
If Me.L_Versp|fffd|tung_Anzahl_04.Caption = "" Then Me.L_Versp|fffd|tung_Anzahl_04.Caption = "0"

Me.L_Versp|fffd|tung_Anzahl_05.Caption = Worksheets("Einstellungen").Range("N83").Value
If Me.L_Versp|fffd|tung_Anzahl_05.Caption = "" Then Me.L_Versp|fffd|tung_Anzahl_05.Caption = "0"

Me.L_Versp|fffd|tung_Anzahl_06.Caption = Worksheets("Einstellungen").Range("N84").Value
If Me.L_Versp|fffd|tung_Anzahl_06.Caption = "" Then Me.L_Versp|fffd|tung_Anzahl_06.Caption = "0"

' Text eintragen
Me.L_Versp|fffd|tung_Text_01.Caption = Worksheets("Einstellungen").Range("L79").Value
Me.L_Versp|fffd|tung_Text_02.Caption = Worksheets("Einstellungen").Range("L80").Value
Me.L_Versp|fffd|tung_Text_03.Caption = Worksheets("Einstellungen").Range("L81").Value
Me.L_Versp|fffd|tung_Text_04.Caption = Worksheets("Einstellungen").Range("L82").Value
Me.L_Versp|fffd|tung_Text_05.Caption = Worksheets("Einstellungen").Range("L83").Value
Me.L_Versp|fffd|tung_Text_06.Caption = Worksheets("Einstellungen").Range("L84").Value

' ############################
' Verfr|fffd|hung
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!S79:Einstellungen!S111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(5).Enabled = True
Me.MultiPage_Expeditionen.Pages(5).Caption = "Verfr|fffd|hung (" & Summe & ")"

' Nummern eintragen
Me.L_Verfr|fffd|hung_Anzahl_01.Caption = Worksheets("Einstellungen").Range("S79").Value
If Me.L_Verfr|fffd|hung_Anzahl_01.Caption = "" Then Me.L_Verfr|fffd|hung_Anzahl_01.Caption = "0"

Me.L_Verfr|fffd|hung_Anzahl_02.Caption = Worksheets("Einstellungen").Range("S80").Value
If Me.L_Verfr|fffd|hung_Anzahl_02.Caption = "" Then Me.L_Verfr|fffd|hung_Anzahl_02.Caption = "0"

Me.L_Verfr|fffd|hung_Anzahl_03.Caption = Worksheets("Einstellungen").Range("S81").Value
If Me.L_Verfr|fffd|hung_Anzahl_03.Caption = "" Then Me.L_Verfr|fffd|hung_Anzahl_03.Caption = "0"

' Text eintragen
Me.L_Verfr|fffd|hung_Text_01.Caption = Worksheets("Einstellungen").Range("Q79").Value
Me.L_Verfr|fffd|hung_Text_02.Caption = Worksheets("Einstellungen").Range("Q80").Value
Me.L_Verfr|fffd|hung_Text_03.Caption = Worksheets("Einstellungen").Range("Q81").Value

' ############################
' Pitaten
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!AC79:Einstellungen!AC111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(6).Enabled = True
Me.MultiPage_Expeditionen.Pages(6).Caption = "Piraten (" & Summe & ")"

' Nummern eintragen
Me.L_Piraten_Anzahl_01.Caption = Worksheets("Einstellungen").Range("AC79").Value
If Me.L_Piraten_Anzahl_01.Caption = "" Then Me.L_Piraten_Anzahl_01.Caption = "0"

Me.L_Piraten_Anzahl_02.Caption = Worksheets("Einstellungen").Range("AC80").Value
If Me.L_Piraten_Anzahl_02.Caption = "" Then Me.L_Piraten_Anzahl_02.Caption = "0"

Me.L_Piraten_Anzahl_03.Caption = Worksheets("Einstellungen").Range("AC81").Value
If Me.L_Piraten_Anzahl_03.Caption = "" Then Me.L_Piraten_Anzahl_03.Caption = "0"

Me.L_Piraten_Anzahl_04.Caption = Worksheets("Einstellungen").Range("AC82").Value
If Me.L_Piraten_Anzahl_04.Caption = "" Then Me.L_Piraten_Anzahl_04.Caption = "0"

Me.L_Piraten_Anzahl_05.Caption = Worksheets("Einstellungen").Range("AC83").Value
If Me.L_Piraten_Anzahl_05.Caption = "" Then Me.L_Piraten_Anzahl_05.Caption = "0"

Me.L_Piraten_Anzahl_06.Caption = Worksheets("Einstellungen").Range("AC84").Value
If Me.L_Piraten_Anzahl_06.Caption = "" Then Me.L_Piraten_Anzahl_06.Caption = "0"

Me.L_Piraten_Anzahl_07.Caption = Worksheets("Einstellungen").Range("AC85").Value
If Me.L_Piraten_Anzahl_07.Caption = "" Then Me.L_Piraten_Anzahl_07.Caption = "0"

Me.L_Piraten_Anzahl_08.Caption = Worksheets("Einstellungen").Range("AC86").Value
If Me.L_Piraten_Anzahl_08.Caption = "" Then Me.L_Piraten_Anzahl_08.Caption = "0"

Me.L_Piraten_Anzahl_09.Caption = Worksheets("Einstellungen").Range("AC87").Value
If Me.L_Piraten_Anzahl_09.Caption = "" Then Me.L_Piraten_Anzahl_09.Caption = "0"

' Text eintragen
Me.L_Piraten_Text_01.Caption = Worksheets("Einstellungen").Range("AA79").Value
Me.L_Piraten_Text_02.Caption = Worksheets("Einstellungen").Range("AA80").Value
Me.L_Piraten_Text_03.Caption = Worksheets("Einstellungen").Range("AA81").Value
Me.L_Piraten_Text_04.Caption = Worksheets("Einstellungen").Range("AA82").Value
Me.L_Piraten_Text_05.Caption = Worksheets("Einstellungen").Range("AA83").Value
Me.L_Piraten_Text_06.Caption = Worksheets("Einstellungen").Range("AA84").Value
Me.L_Piraten_Text_07.Caption = Worksheets("Einstellungen").Range("AA85").Value
Me.L_Piraten_Text_08.Caption = Worksheets("Einstellungen").Range("AA86").Value
Me.L_Piraten_Text_09.Caption = Worksheets("Einstellungen").Range("AA87").Value

' Anzeige von normal, oft, selten und unbekannt
    
If Summe <> "0" Then
    ' Normal
    Anzahl = WorksheetFunction.Sum(Range("Einstellungen!AC79:Einstellungen!AC82").Value)
    Me.L_Piraten_Normal.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
    ' Oft
    Anzahl = WorksheetFunction.Sum(Range("Einstellungen!AC83:Einstellungen!AC85").Value)
    Me.L_Piraten_Oft.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
    ' Selten
    Anzahl = WorksheetFunction.Sum(Range("Einstellungen!AC86:Einstellungen!AC87").Value)
    Me.L_Piraten_Selten.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
    ' Unbekannt
'    Anzahl = Worksheets("Einstellungen").Range("AC88").Value
'    Me.L_Piraten_Unbekannt.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
End If

' ############################
' Aliens
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!AH79:Einstellungen!AH111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(7).Enabled = True
Me.MultiPage_Expeditionen.Pages(7).Caption = "Aliens (" & Summe & ")"

' Nummern eintragen
Me.L_Aliens_Anzahl_01.Caption = Worksheets("Einstellungen").Range("AH79").Value
If Me.L_Aliens_Anzahl_01.Caption = "" Then Me.L_Aliens_Anzahl_01.Caption = "0"

Me.L_Aliens_Anzahl_02.Caption = Worksheets("Einstellungen").Range("AH80").Value
If Me.L_Aliens_Anzahl_02.Caption = "" Then Me.L_Aliens_Anzahl_02.Caption = "0"

Me.L_Aliens_Anzahl_03.Caption = Worksheets("Einstellungen").Range("AH81").Value
If Me.L_Aliens_Anzahl_03.Caption = "" Then Me.L_Aliens_Anzahl_03.Caption = "0"

Me.L_Aliens_Anzahl_04.Caption = Worksheets("Einstellungen").Range("AH82").Value
If Me.L_Aliens_Anzahl_04.Caption = "" Then Me.L_Aliens_Anzahl_04.Caption = "0"

Me.L_Aliens_Anzahl_05.Caption = Worksheets("Einstellungen").Range("AH83").Value
If Me.L_Aliens_Anzahl_05.Caption = "" Then Me.L_Aliens_Anzahl_05.Caption = "0"

Me.L_Aliens_Anzahl_06.Caption = Worksheets("Einstellungen").Range("AH84").Value
If Me.L_Aliens_Anzahl_06.Caption = "" Then Me.L_Aliens_Anzahl_06.Caption = "0"

Me.L_Aliens_Anzahl_07.Caption = Worksheets("Einstellungen").Range("AH85").Value
If Me.L_Aliens_Anzahl_07.Caption = "" Then Me.L_Aliens_Anzahl_07.Caption = "0"

Me.L_Aliens_Anzahl_08.Caption = Worksheets("Einstellungen").Range("AH86").Value
If Me.L_Aliens_Anzahl_08.Caption = "" Then Me.L_Aliens_Anzahl_08.Caption = "0"

Me.L_Aliens_Anzahl_09.Caption = Worksheets("Einstellungen").Range("AH87").Value
If Me.L_Aliens_Anzahl_09.Caption = "" Then Me.L_Aliens_Anzahl_09.Caption = "0"

' Text eintragen
Me.L_Aliens_Text_01.Caption = Worksheets("Einstellungen").Range("AF79").Value
Me.L_Aliens_Text_02.Caption = Worksheets("Einstellungen").Range("AF80").Value
Me.L_Aliens_Text_03.Caption = Worksheets("Einstellungen").Range("AF81").Value
Me.L_Aliens_Text_04.Caption = Worksheets("Einstellungen").Range("AF82").Value
Me.L_Aliens_Text_05.Caption = Worksheets("Einstellungen").Range("AF83").Value
Me.L_Aliens_Text_06.Caption = Worksheets("Einstellungen").Range("AF84").Value
Me.L_Aliens_Text_07.Caption = Worksheets("Einstellungen").Range("AF85").Value
Me.L_Aliens_Text_08.Caption = Worksheets("Einstellungen").Range("AF86").Value
Me.L_Aliens_Text_09.Caption = Worksheets("Einstellungen").Range("AF87").Value

' Anzeige von normal, oft, selten und unbekannt
If Summe <> "0" Then
    ' Normal
    Anzahl = WorksheetFunction.Sum(Range("Einstellungen!AH79:Einstellungen!AH80").Value) + Worksheets("Einstellungen").Range("AH83").Value
    Me.L_Aliens_Normal.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
    ' Oft
    Anzahl = Worksheets("Einstellungen").Range("AH81").Value + Worksheets("Einstellungen").Range("AH82").Value + Worksheets("Einstellungen").Range("AH84").Value + Worksheets("Einstellungen").Range("AH86").Value
    Me.L_Aliens_Oft.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
    ' Selten
    Anzahl = Worksheets("Einstellungen").Range("AH85").Value + Worksheets("Einstellungen").Range("AH87").Value
    Me.L_Aliens_Selten.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
    ' Unbekannt
'    Anzahl = Worksheets("Einstellungen").Range("AH82").Value
'    Me.L_Aliens_Unbekannt.Caption = Anzahl & "  ( " & Format(100 / Summe * Anzahl, "0.0") & " % )"
End If

' ############################
' H|fffd|ndler
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!X79:Einstellungen!X111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(8).Enabled = True
Me.MultiPage_Expeditionen.Pages(8).Caption = "H|fffd|ndler (" & Summe & ")"

' Nummern eintragen
Me.L_H|fffd|ndler_Anzahl_01.Caption = Worksheets("Einstellungen").Range("X79").Value
If Me.L_H|fffd|ndler_Anzahl_01.Caption = "" Then Me.L_H|fffd|ndler_Anzahl_01.Caption = "0"

Me.L_H|fffd|ndler_Anzahl_02.Caption = Worksheets("Einstellungen").Range("X80").Value
If Me.L_H|fffd|ndler_Anzahl_02.Caption = "" Then Me.L_H|fffd|ndler_Anzahl_02.Caption = "0"

' Text eintragen
Me.L_H|fffd|ndler_Text_01.Caption = Worksheets("Einstellungen").Range("V79").Value
Me.L_H|fffd|ndler_Text_02.Caption = Worksheets("Einstellungen").Range("V80").Value

' ############################
' Totalverlust
' ############################
Summe = WorksheetFunction.Sum(Range("Einstellungen!AM79:Einstellungen!AM111").Value)

If Summe <> "0" Then Me.MultiPage_Expeditionen.Pages(9).Enabled = True
Me.MultiPage_Expeditionen.Pages(9).Caption = "Totalverlust (" & Summe & ")"

' Nummern eintragen
Me.L_Totalverlust_Anzahl_01.Caption = Worksheets("Einstellungen").Range("AM79").Value
If Me.L_Totalverlust_Anzahl_01.Caption = "" Then Me.L_Totalverlust_Anzahl_01.Caption = "0"

Me.L_Totalverlust_Anzahl_02.Caption = Worksheets("Einstellungen").Range("AM80").Value
If Me.L_Totalverlust_Anzahl_02.Caption = "" Then Me.L_Totalverlust_Anzahl_02.Caption = "0"

Me.L_Totalverlust_Anzahl_03.Caption = Worksheets("Einstellungen").Range("AM81").Value
If Me.L_Totalverlust_Anzahl_03.Caption = "" Then Me.L_Totalverlust_Anzahl_03.Caption = "0"

Me.L_Totalverlust_Anzahl_04.Caption = Worksheets("Einstellungen").Range("AM82").Value
If Me.L_Totalverlust_Anzahl_04.Caption = "" Then Me.L_Totalverlust_Anzahl_04.Caption = "0"

' Text eintragen
Me.L_Totalverlust_Text_01.Caption = Worksheets("Einstellungen").Range("AK79").Value
Me.L_Totalverlust_Text_02.Caption = Worksheets("Einstellungen").Range("AK80").Value
Me.L_Totalverlust_Text_03.Caption = Worksheets("Einstellungen").Range("AK81").Value
Me.L_Totalverlust_Text_04.Caption = Worksheets("Einstellungen").Range("AK82").Value

' Auf die erste Seite springen
Me.MultiPage_Expeditionen.Value = 0

Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Expeditionsanzeige )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"

End Sub
Attribute VB_Name = "UF_Informationen"
Attribute VB_Base = "0{6ADD1563-E22A-4E28-B696-BA5B887B1FFE}{87783E08-88BA-4EA8-8FFC-0BC5647E8537}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit


Attribute VB_Name = "UF_UnbekannteExpedition"
Attribute VB_Base = "0{CADBAB79-990F-499E-A4AB-7EF1BA56F1A6}{88210762-1CB8-4AFB-BDAB-6202D39841D8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

' ##########################################################################
' Wenn eine Expedition oder Logbuchnachtrag nicht erkannt wurde, erscheint diese in der UserForm
' ##########################################################################
Private Sub UserForm_Activate()

    If ExpoOderLogbuch = 1 Then
        Me.TextBox_Nachricht.Value = "Expedition: " & Expedition
    Else
        Me.TextBox_Nachricht.Value = "Logbuchnachtrag: " & Logbuchnachtrag
    End If

End Sub

' ##########################################################################
' Link zum Kontakformular
' ##########################################################################
Private Sub CB_Melden_Click()
On Error GoTo ErrorHandler

If IsInternetConnected Then ' Pr|fffd|fe ob der Rechner mit dem Internet verbunden ist!

    ThisWorkbook.FollowHyperlink Address:="http://basisa.lima-city.de/index.php/de/kontakt/unbekannte-expo", NewWindow:=True 'Download Link ( Kontakformular unbekannte Expeditionsnachricht )

Else

MsgBox "Sie sind momentan nicht mit dem Internet verbunden!", vbOKOnly + vbInformation, "Verbindungscheck!"

End If


Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Unbekannte Expo melden )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
End Sub
Attribute VB_Name = "UF_Urkunde"
Attribute VB_Base = "0{B62D2C6B-14E2-4ADD-8A46-5C66E6F17EB7}{6D032059-2C8B-4E5D-8662-A7F453BCA6BE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

' ####################################################
' Beim |fffd|ffnen der Urkunde
' ####################################################
Private Sub UserForm_Activate()

    ' Datum
    Me.L_Datum.Caption = Range("Einstellungen!B41").Value
    ' Uhrzeit
    Me.L_Uhrzeit.Caption = Format(Range("Einstellungen!B42").Value, "hh:mm") & " Uhr"
    ' Universum
    Me.L_Universum.Caption = Range("Einstellungen!B43").Value
    ' Anzahl der Expeditionen
    Me.L_Anzahl_Expeditionen.Caption = Format(Range("Einstellungen!B44").Value, "0,0")
    ' Tage zwischen 1. und letzter Expedition
    Me.L_Tage_bis_100P.Caption = Format(Range("Einstellungen!B45").Value, "0,0")
    ' Rohstoffe
    Me.L_Rohstoffe.Caption = Format(Range("Einstellungen!B46").Value + Range("Einstellungen!B47").Value, "0,0")
    ' Rohstoffe durch Fund
    Me.L_Rohstoffe_gefunden.Caption = Format(Range("Einstellungen!B46").Value, "0,0")
    ' Rohstoffe von Flotten UNITS
    Me.L_Rohstoffe_Schiffunits.Caption = Format(Range("Einstellungen!B47").Value, "0,0")
    ' Dunkle Materie
    Me.L_Rohstoffe_DM.Caption = Format(Range("Einstellungen!B48").Value, "0,0")
    ' Verluste
    Me.L_Verluste.Caption = Format(Range("Einstellungen!B49").Value + Range("Einstellungen!B50").Value, "0,0")
    ' Deuteriumverbrauch
    Me.L_Verluste_Deuteriumverbrauch.Caption = Format(Range("Einstellungen!B49").Value, "0,0")
    ' Schiffverluste
    Me.L_Verluste_Schiffunits.Caption = Format(Range("Einstellungen!B50").Value, "0,0")
    ' Schiffe
    Me.L_Schiffe.Caption = Format(Range("Einstellungen!B51").Value - Range("Einstellungen!B52").Value, "0,0")
    ' gefundene Schiffe
    Me.L_Schiffe_gefunden.Caption = Format(Range("Einstellungen!B51").Value, "0,0")
    ' verlorerene Schiffe
    Me.L_Schiffe_verloren.Caption = Format(Range("Einstellungen!B52").Value, "0,0")
    ' Urkunden ID
    Me.L_ID.Caption = "IDNr. : " & Range("Einstellungen!B53").Value
      
      
End Sub



' ####################################################
' Drucken der Urkunde
' ####################################################
Private Sub CB_Drucken_Click()

' Fehler wenn noch kein Spielername angegeben wurde!
If Me.TB_Spielername.Value = "bitte hier Ihren Spielernamen eingeben" Then
    MsgBox "Bitte zuerst Ihren Spielernamen unten eingeben!", vbOKOnly + vbInformation, "Bitte beachten"
    Exit Sub
End If

' |fffd|bernimmt den Spielernamen und blendet die TextBox aus
    Me.L_Spielername.Caption = Me.TB_Spielername.Value
    Me.TB_Spielername.Visible = False
    Me.L_Spielername.Visible = True

' Druckt die UserForm
    Me.CB_Drucken.Visible = False
    UF_Urkunde.PrintForm
        
' Ende

    Unload Me
    Load UF_Urkunde
    UF_Urkunde.Show

End Sub

Private Sub TB_Spielername_Enter()

    Me.TB_Spielername.Value = ""

End Sub
Attribute VB_Name = "UF_Verloren"
Attribute VB_Base = "0{84C036E6-3911-4D2F-A799-D797FBDC52D7}{A98B9952-A318-4A13-9241-4ED43C909262}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit


' ##########################################################################
' Bei einen Angriff von Piraten oder Aliens wird man hier gefragt
' ob man Flotte verloren hat, man kann sie direkt eintragen!
' ##########################################################################
Private Sub UserForm_Activate()

    Startzeit2 = Now ' Damit die Zeit in der man pr|fffd|ft ob was verloren wurde nachher bei der Geschwindigkeit der Eintragung herausgerechnet wird.

    Nein = "" ' Wenn "Nein" zu UF_Einlesen |fffd|bertragen wird dann gibt es KEINE Verluste!

    ' Schreibe das Event etc. rechts hin
    Me.TB_Event = Verloren_Event
    Me.TB_Datum_Uhrzeit = Verloren_Datum & " um " & Verloren_Uhrzeit
    Me.TB_Expedition = Verloren_Expedition
    
    ' Blendet nicht mitgenommene Flotten aus!
    If Me.C_Expoflotte_KT.Value = True Then
        Me.TB_Expoflotte_KT.Enabled = True
        Me.TB_Expoflotte_KT.BackColor = "&H80000005"
        Me.C_Expoflotte_KT.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_GT.Value = True Then
        Me.TB_Expoflotte_GT.Enabled = True
        Me.TB_Expoflotte_GT.BackColor = "&H80000005"
        Me.C_Expoflotte_GT.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_Spio.Value = True Or Logbuchnachtrag <> "" Then
        Me.TB_Expoflotte_Spio.Enabled = True
        Me.TB_Expoflotte_Spio.BackColor = "&H80000005"
        Me.C_Expoflotte_Spio.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_LJ.Value = True Then
        Me.TB_Expoflotte_LJ.Enabled = True
        Me.TB_Expoflotte_LJ.BackColor = "&H80000005"
        Me.C_Expoflotte_LJ.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_SJ.Value = True Then
        Me.TB_Expoflotte_SJ.Enabled = True
        Me.TB_Expoflotte_SJ.BackColor = "&H80000005"
        Me.C_Expoflotte_SJ.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_Xer.Value = True Then
        Me.TB_Expoflotte_Xer.Enabled = True
        Me.TB_Expoflotte_Xer.BackColor = "&H80000005"
        Me.C_Expoflotte_Xer.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_SS.Value = True Then
        Me.TB_Expoflotte_SS.Enabled = True
        Me.TB_Expoflotte_SS.BackColor = "&H80000005"
        Me.C_Expoflotte_SS.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_SXer.Value = True Then
        Me.TB_Expoflotte_SXer.Enabled = True
        Me.TB_Expoflotte_SXer.BackColor = "&H80000005"
        Me.C_Expoflotte_SXer.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_Bomber.Value = True Then
        Me.TB_Expoflotte_Bomber.Enabled = True
        Me.TB_Expoflotte_Bomber.BackColor = "&H80000005"
        Me.C_Expoflotte_Bomber.BackColor = "&H80000005"
    End If
    If Me.C_Expoflotte_Zerri.Value = True Then
        Me.TB_Expoflotte_Zerri.Enabled = True
        Me.TB_Expoflotte_Zerri.BackColor = "&H80000005"
        Me.C_Expoflotte_Zerri.BackColor = "&H80000005"
    End If
        If Me.C_Expoflotte_Reaper.Value = True Then
        Me.TB_Expoflotte_Reaper.Enabled = True
        Me.TB_Expoflotte_Reaper.BackColor = "&H80000005"
        Me.C_Expoflotte_Reaper.BackColor = "&H80000005"
    End If
        If Me.C_Expoflotte_Pathfinder.Value = True Then
        Me.TB_Expoflotte_Pathfinder.Enabled = True
        Me.TB_Expoflotte_Pathfinder.BackColor = "&H80000005"
        Me.C_Expoflotte_Pathfinder.BackColor = "&H80000005"
    End If
    
'    ' Automatisches eintragen der Verlusten gegen Alines bzw. Piraten
'    ' Flotte mit Zerri
'    If Range("Einstellungen!N35").Value = True Then
'        If Me.TB_Event.Value = "Aliens" Then
'            If Verloren_Groesse = "Normal" Then Me.TB_Expoflotte_GT.Value = 6
'            If Verloren_Groesse = "Oft" Then Me.TB_Expoflotte_GT.Value = 46
'            If Verloren_Groesse = "Selten" Then Me.TB_Expoflotte_GT.Value = 48
'        End If
'
'        If Me.TB_Event.Value = "Piraten" Then
'            If Verloren_Groesse = "Normal" Then Me.TB_Expoflotte_GT.Value = 0
'            If Verloren_Groesse = "Oft" Then Me.TB_Expoflotte_GT.Value = 0
'            If Verloren_Groesse = "Selten" Then Me.TB_Expoflotte_GT.Value = 11
'        End If
'    End If
'    ' Flotte ohne Zerri
'    If Range("Einstellungen!O35").Value = True Then
'        If Me.TB_Event.Value = "Aliens" Then
'            If Verloren_Groesse = "Normal" Then Me.TB_Expoflotte_GT.Value = 0
'            If Verloren_Groesse = "Oft" Then Me.TB_Expoflotte_GT.Value = 46
'            If Verloren_Groesse = "Selten" Then Me.TB_Expoflotte_GT.Value = 12
'        End If
'
'        If Me.TB_Event.Value = "Piraten" Then
'            If Verloren_Groesse = "Normal" Then Me.TB_Expoflotte_GT.Value = 0
'            If Verloren_Groesse = "Oft" Then Me.TB_Expoflotte_GT.Value = 0
'            If Verloren_Groesse = "Selten" Then Me.TB_Expoflotte_GT.Value = 11
'        End If
'    End If
    
    ' Wenn Automatische Eintragung aktiv ist!
    If ThisWorkbook.Worksheets("Einstellungen").Range("O12").Value = True Then
        Me.CB_Ja.Caption = "los, trag ein... (wie oben angezeigt) in 3"
        Application.Wait (Time + TimeValue("00:00:01"))
        Me.CB_Ja.Caption = "los, trag ein... (wie oben angezeigt) in 2"
        UF_Verloren.Repaint
        Application.Wait (Time + TimeValue("00:00:01"))
        Me.CB_Ja.Caption = "los, trag ein... (wie oben angezeigt) in 1"
        UF_Verloren.Repaint
        Application.Wait (Time + TimeValue("00:00:01"))
        Call CB_Ja_Click
    End If

End Sub

' ##########################################################
' Es kann maximal die mitgenommenen Flotten verloren gehen!

Private Sub TB_Expoflotte_KT_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_KT.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_KT.Value) > CInt(Range("Einstellungen!M35").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_KT.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_KT.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_GT_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_GT.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_GT.Value) > CInt(Range("Einstellungen!M36").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_GT.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_GT.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_Spio_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_Spio.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_Spio.Value) > CInt(Range("Einstellungen!M37").Value) Then
        If CInt(Me.TB_Expoflotte_Spio.Value) = 1 And Logbuchnachtrag <> "" Then Exit Sub 'Wenn automatisch 1 SpioSonde eingetragen wurde
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_Spio.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_Spio.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_LJ_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_LJ.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_LJ.Value) > CInt(Range("Einstellungen!M38").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_LJ.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_LJ.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_SJ_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_SJ.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_SJ.Value) > CInt(Range("Einstellungen!M39").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_SJ.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_SJ.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_Xer_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_Xer.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_Xer.Value) > CInt(Range("Einstellungen!M40").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_Xer.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_Xer.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_SS_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_SS.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_SS.Value) > CInt(Range("Einstellungen!M41").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_SS.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_SS.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_SXer_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_SXer.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_SXer.Value) > CInt(Range("Einstellungen!M42").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_SXer.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_SXer.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_Bomber_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_Bomber.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_Bomber.Value) > CInt(Range("Einstellungen!M43").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_Bomber.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_Bomber.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_Zerri_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_Zerri.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_Zerri.Value) > CInt(Range("Einstellungen!M44").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_Zerri.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_Zerri.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_Reaper_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_Reaper.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_Reaper.Value) > CInt(Range("Einstellungen!M45").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_Reaper.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_Reaper.Value = "0"
    
End Sub

Private Sub TB_Expoflotte_Pathfinder_Change()
On Error GoTo ErrorHandler

    If Me.TB_Expoflotte_Pathfinder.Value = "" Then Exit Sub
    If CInt(Me.TB_Expoflotte_Pathfinder.Value) > CInt(Range("Einstellungen!M46").Value) Then
        MsgBox "Sie k|fffd|nnen nicht mehr verloren haben, als Sie mitgenommen haben!", vbOKOnly + vbCritical, "Fehler"
        Me.TB_Expoflotte_Pathfinder.Value = "0"
    End If
    Exit Sub
       
ErrorHandler:
    Me.TB_Expoflotte_Pathfinder.Value = "0"
    
End Sub

' #####################################
' Bei Klick, die 0 entfernen!

Private Sub TB_Expoflotte_KT_Enter()
    
If Me.TB_Expoflotte_KT.Value = 0 Then Me.TB_Expoflotte_KT.Value = ""
    
End Sub

Private Sub TB_Expoflotte_GT_Enter()

If Me.TB_Expoflotte_GT.Value = 0 Then Me.TB_Expoflotte_GT.Value = ""

End Sub
    
Private Sub TB_Expoflotte_Spio_Enter()

If Me.TB_Expoflotte_Spio.Value = 0 Then Me.TB_Expoflotte_Spio.Value = ""
    
End Sub

Private Sub TB_Expoflotte_LJ_Enter()

If Me.TB_Expoflotte_LJ.Value = 0 Then Me.TB_Expoflotte_LJ.Value = ""
    
End Sub

Private Sub TB_Expoflotte_SJ_Enter()

If Me.TB_Expoflotte_SJ.Value = 0 Then Me.TB_Expoflotte_SJ.Value = ""
    
End Sub

Private Sub TB_Expoflotte_Xer_Enter()

If Me.TB_Expoflotte_Xer.Value = 0 Then Me.TB_Expoflotte_Xer.Value = ""
    
End Sub

Private Sub TB_Expoflotte_SS_Enter()

If Me.TB_Expoflotte_SS.Value = 0 Then Me.TB_Expoflotte_SS.Value = ""
    
End Sub

Private Sub TB_Expoflotte_SXer_Enter()

If Me.TB_Expoflotte_SXer.Value = 0 Then Me.TB_Expoflotte_SXer.Value = ""
    
End Sub

Private Sub TB_Expoflotte_Bomber_Enter()

If Me.TB_Expoflotte_Bomber.Value = 0 Then Me.TB_Expoflotte_Bomber.Value = ""
    
End Sub

Private Sub TB_Expoflotte_Zerri_Enter()

If Me.TB_Expoflotte_Zerri.Value = 0 Then Me.TB_Expoflotte_Zerri.Value = ""

End Sub

Private Sub TB_Expoflotte_Reaper_Enter()

If Me.TB_Expoflotte_Reaper.Value = 0 Then Me.TB_Expoflotte_Reaper.Value = ""

End Sub

Private Sub TB_Expoflotte_Pathfinder_Enter()

If Me.TB_Expoflotte_Pathfinder.Value = 0 Then Me.TB_Expoflotte_Pathfinder.Value = ""

End Sub

' #####################################
' Ja und Nein BUTTONS
' #####################################
Private Sub CB_Ja_Click()
On Error GoTo ErrorHandler

Endzeit2 = Now

Zeit = Zeit + (Round(((Endzeit2 - Startzeit2) * 86400), 0))

' Er tr|fffd|gt die verlorenen Flotten ein

    KT = Me.TB_Expoflotte_KT.Value
    GT = Me.TB_Expoflotte_GT.Value
    Spio = Me.TB_Expoflotte_Spio.Value
    LJ = Me.TB_Expoflotte_LJ.Value
    SJ = Me.TB_Expoflotte_SJ.Value
    Xer = Me.TB_Expoflotte_Xer.Value
    SS = Me.TB_Expoflotte_SS.Value
    SXer = Me.TB_Expoflotte_SXer.Value
    Bomber = Me.TB_Expoflotte_Bomber.Value
    Zerri = Me.TB_Expoflotte_Zerri.Value
    Reaper = Me.TB_Expoflotte_Reaper.Value
    Pathfinder = Me.TB_Expoflotte_Pathfinder.Value
    
' Fehler vorbeugen wenn NICHTS eingetragen wurde!
    If KT = "" Then KT = 0
    If GT = "" Then GT = 0
    If Spio = "" Then Spio = 0
    If LJ = "" Then LJ = 0
    If SJ = "" Then SJ = 0
    If Xer = "" Then Xer = 0
    If SS = "" Then SS = 0
    If SXer = "" Then SXer = 0
    If Bomber = "" Then Bomber = 0
    If Zerri = "" Then Zerri = 0
    If Reaper = "" Then Reaper = 0
    If Pathfinder = "" Then Pathfinder = 0
    
      
    Unload Me
      
Exit Sub

ErrorHandler:

Call Fehler

Unload Me

MsgBox "Es ist ein Fehler aufgetreten! ( Flotte verloren )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
        
End Sub

' ******************************************************************************
' Damit man nicht um die Abfrage herum kommt ob |fffd|nderungen erfolgt sind!
' ******************************************************************************

' Damit man in der Userform nicht auf das "Rote Kreuz" klicken kann!
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
  
  If CloseMode = False Then
    MsgBox "Bitte nutzen Sie den Button <los, trag ein...> !", vbOKOnly + vbExclamation, "Bitte so nicht..."
    Cancel = True
  End If
End Sub
Attribute VB_Name = "UF_groesster_Schiffsfund"
Attribute VB_Base = "0{96DBED7C-1B0D-47E1-8510-37790DB619FB}{1B4848BD-59E6-4A07-8F56-35FD401ACFAB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Public Sprungmarke As Integer

Private Sub UserForm_Activate()
On Error GoTo ErrorHandler

Dim MaxSpalte, i, Units, BesterWert, SpalteBesterWert As Integer

' Wenn noch kein Flottenfund dann sofort unterbrechen!
If Left(Range("Auswertungen!A14").Value, 1) = 0 Then
    Unload Me
    MsgBox "Du hast noch keine Flotte gefunden!", vbOKOnly + vbInformation, "Versuche es weiter..."
    Exit Sub
End If

' Suche die meisten Units
MaxSpalte = Range("Einstellungen!AQ1000000").End(xlUp).Row
BesterWert = 0

For i = 8 To MaxSpalte
    Units = Sheets("Einstellungen").Cells(i, 45).Value + Sheets("Einstellungen").Cells(i, 46).Value
        
    If Units > BesterWert Then
        BesterWert = Units
        SpalteBesterWert = i
        Sprungmarke = i ' Wenn er auf dem Knopf dr|fffd|ckt
    End If
    
Next

' Eintragen der Werte
Me.Label_Datum.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 1).Value    ' Datum
Me.Label_Uhrzeit.Caption = Format(Sheets("Eintragungen").Cells(SpalteBesterWert, 2).Value, "hh:mm  \u\n\d  ss \S\e\k\.")  ' Uhrzeit
If Me.Label_Uhrzeit.Caption = "" Then Me.Label_Uhrzeit.Caption = "nicht angegeben!"
Me.Label_Units.Caption = Format(BesterWert, "##0,0")                                ' Units
If BesterWert > Sheets("Einstellungen").Range("AL32").Value Then                    ' Gr|fffd||fffd|e des Fundes
    Me.Label_Gr|fffd||fffd|e.Caption = "( riesig )"
ElseIf BesterWert > Sheets("Einstellungen").Range("AL33").Value Then
    Me.Label_Gr|fffd||fffd|e.Caption = "( gro|fffd| )"
Else
    Me.Label_Gr|fffd||fffd|e.Caption = "( normal )"
End If
Me.Label_Metall.Caption = Format(Sheets("Einstellungen").Cells(SpalteBesterWert, 45).Value, "##0,0") ' Metall
Me.Label_Kristall.Caption = Format(Sheets("Einstellungen").Cells(SpalteBesterWert, 46).Value, "##0,0") ' Kristall
Me.Label_KT.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 26).Value           ' KT
Me.Label_GT.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 27).Value           ' GT
                                                                                         ' Recycler kann nicht gefunden werden
Me.Label_Spio.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 29).Value         ' Spio
Me.Label_LJ.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 30).Value           ' LJ
Me.Label_SJ.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 31).Value           ' SJ
Me.Label_Xer.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 32).Value          ' Xer
Me.Label_SS.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 33).Value           ' SS
Me.Label_SXer.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 34).Value         ' SXer
Me.Label_Bomber.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 35).Value       ' Bomber
Me.Label_Zerri.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 36).Value        ' Zerri
Me.Label_Reaper.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 37).Value       ' Reaper
Me.Label_Pathfinder.Caption = Sheets("Eintragungen").Cells(SpalteBesterWert, 38).Value   ' Pathfinder

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Gr|fffd||fffd|ter Schiffsfund )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
End Sub

' #################################
' Springe zum besten Fund
' #################################

Private Sub CB_ansehen_Click()
On Error GoTo ErrorHandler

ThisWorkbook.Worksheets("Eintragungen").Select
Rows(Sprungmarke).Select
Unload Me

Exit Sub

ErrorHandler:

Call Fehler

MsgBox "Es ist ein Fehler aufgetreten! ( Gr|fffd||fffd|ter Schiffsfund )" & Chr(13) & Chr(13) & _
        Err.Number & "|" & Err.Description, vbOKOnly + vbCritical, "Fehler"
End Sub
Attribute VB_Name = "Urkunde"
Option Explicit

Sub Urkunde_Erstellen()
Dim MaxZeile As Integer

Application.ScreenUpdating = False

Call Blattschutz_on_off ' Blattschutz aufheben
ThisWorkbook.Worksheets("Einstellungen").Visible = True

MaxZeile = Range("Eintragungen!A1000000").End(xlUp).Row
    
    ' Datum
    Range("Einstellungen!B41").Value = Format(Date, "DD.MM.YYYY")
    ' Urhzeit
    Range("Einstellungen!B42").Value = Format(Now, "hh:mm:ss")
    ' Universum
    Range("Einstellungen!B43").Value = Range("Einstellungen!M3").Value
    ' Anzahl der Expedition
    Range("Einstellungen!B44").Value = Range("Auswertungen!A3").Value
    ' Tage von 1. bis letzter Expedition
    Range("Einstellungen!B45").Value = ThisWorkbook.Worksheets("Eintragungen").Cells(MaxZeile, 1).Value - ThisWorkbook.Worksheets("Eintragungen").Cells(8, 1).Value
    ' Rohstoffe durch Fund
    Range("Einstellungen!B46").Value = Range("Auswertungen!B36").Value
    ' Schiffunits
    Range("Einstellungen!B47").Value = Range("Auswertungen!R11").Value
    ' Dunkle Materie
    Range("Einstellungen!B48").Value = Range("Auswertungen!B37").Value
    ' Deuteriumverbrauch
    Range("Einstellungen!B49").Value = Range("Auswertungen!R9").Value
    ' Schiffverluste Units
    Range("Einstellungen!B50").Value = Range("Auswertungen!R7").Value * -1
    ' gefundene Schiffe
    Range("Einstellungen!B51").Value = Range("Auswertungen!D34").Value
    ' verlorene Schiffe
    Range("Einstellungen!B52").Value = Range("Auswertungen!D37").Value * -1
    ' Urkunden ID
    Range("Einstellungen!B53").Value = Right(Format(Date, "DDDD"), 1) & Int((100000 - 999999 + 1) * Rnd + 999999) & LCase(Left(Format(Date, "DDDD"), 1))

    ' direkt speichern ohne Fragen
    Application.DisplayAlerts = False
    ActiveWorkbook.Save
    Application.DisplayAlerts = True
    
Sheets("Auswertungen").Select
ThisWorkbook.Worksheets("Einstellungen").Visible = xlSheetVeryHidden
Call Blattschutz_on_off ' Blattschutz setzen

Application.ScreenUpdating = True

    ' Urkunde laden
    Load UF_Urkunde
    UF_Urkunde.Show

End Sub

' InQuest injected base64 decoded content
' ^v+b
' ^v+b
' ^v+b
' ^v+b
' ^v+b
' {-zYn
' ^v+b

INQUEST-PP=macro
