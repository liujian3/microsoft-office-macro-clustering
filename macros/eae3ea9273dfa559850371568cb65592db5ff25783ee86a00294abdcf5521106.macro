Attribute VB_Name = "ACCUEIL"
Attribute VB_Base = "0{5DE31EE4-154A-41D9-87DB-87EBBA45694E}{C9E8C64A-1324-4D30-AC15-53E66B72FA26}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Unload Me
LOGEMENT.Show vbModeless
End Sub

Private Sub CommandButton2_Click()
Unload Me
LOCATAIRES.Show vbModeless

End Sub

Private Sub CommandButton3_Click()
Unload Me
CHARGES.Show vbModeless

End Sub

Private Sub CommandButton4_Click()
Unload Me
QUITTANCE.Show vbModeless

End Sub

Private Sub CommandButton5_Click()
Unload Me
IMPOTS.Show vbModeless

End Sub

Private Sub CommandButton6_Click()
Unload Me
PARAM.Show vbModeless
End Sub

Private Sub CommandButton7_Click()
ThisWorkbook.Save
Application.Quit
End Sub

Private Sub CommandButton8_Click()
Unload Me
ECHEANCE.Show vbModeless
End Sub

Private Sub Image1_Click()
ThisWorkbook.FollowHyperlink "https://www.unmecenbaskets.fr"
End Sub

Private Sub Image2_Click()
Unload Me
MDP.Show vbModeless
End Sub



Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub
Attribute VB_Name = "AUTORISATION"
Attribute VB_Base = "0{705BD33E-8C3A-4989-90C2-AFC05BF422DF}{5DF6EC04-0618-4EAC-8CC7-0347CE67B51D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Unload Me
MDP.Show
End Sub

Private Sub CommandButton2_Click()
ThisWorkbook.Save
Application.Quit
End Sub
Attribute VB_Name = "CHARGES"
Attribute VB_Base = "0{FB10C891-C97C-4CE7-8B1B-84823E5DEC53}{7FE0A3EB-0952-4ACA-9837-B554FE7C00AC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton5_Click()
If ComboBox1.Value = "" Or ComboBox2.Value = "" Or ComboBox3.Value = "" Or TextBox1.Value = "" Or TextBox2.Value = "" Or TextBox3.Value = "" Then
MsgBox "Merci de renseigner toutes les informations demand|fffd|es."
Exit Sub
End If

If MsgBox("Cette action va ajouter une charge |fffd| la base de donn|fffd|es. Cette charge ne pourra |fffd|tre ni supprim|fffd|e, ni modifi|fffd|e. Etes-vous s|fffd|r de vouloir continuer ?", vbYesNo + vbQuestion, "Ajout Charge") = vbYes Then

Dim derligne As Long
derligne = Sheets("charges").Range("A65536").End(xlUp).Row + 1

Sheets("charges").Range("B" & derligne).Value = ComboBox3
Sheets("charges").Range("C" & derligne).Value = ComboBox1
Sheets("charges").Range("D" & derligne).Value = ComboBox2
Sheets("charges").Range("E" & derligne).Value = TextBox3
Sheets("charges").Range("F" & derligne).Value = Format(TextBox1.Value, "mm/dd/yyyy")
Sheets("charges").Range("G" & derligne).Value = CDbl(TextBox2.Value)
Sheets("charges").Range("A" & derligne).Value = "=YEAR(RC[5])"


Sheets("charges").Select
Range("A" & derligne & ":G" & derligne).Select
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

Unload Me
MsgBox "Charges ajout|fffd|es |fffd| la base de donn|fffd|es."
CHARGES.Show vbModeless

End If

End Sub

Private Sub CommandButton6_Click()
Unload Me
ACCUEIL.Show vbModeless
End Sub

Private Sub Textbox1_Afterupdate()
TextBox1.Value = Format(TextBox1, "dd/mm/yyyy")

End Sub
Private Sub TextBox1_Change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox1.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox1.Value = TextBox1.Value & "/"
End Sub

Private Sub TextBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890-.,", Chr(KeyAscii)) = 0 Then KeyAscii = 0
 If KeyAscii = 46 Then KeyAscii = 44
End Sub


Private Sub TextBox2_Afterupdate()
TextBox2.Value = Format(TextBox2.Value, "###.00 |fffd|")
End Sub

Private Sub UserForm_Initialize()
 Set ws = Sheets("LOGEMENTS")
    With Me.ComboBox3
  For J = 2 To ws.Range("B" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("B" & J)
  Next J
  End With
  
  Set ws = Sheets("param")
    With Me.ComboBox1
  For J = 1 To ws.Range("J" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("J" & J)
  Next J
  End With
  
    Set ws = Sheets("param")
    With Me.ComboBox2
  For J = 1 To ws.Range("L" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("L" & J)
  Next J
  End With
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub
Attribute VB_Name = "ECHEANCE"
Attribute VB_Base = "0{BDEDF36D-4D14-44BE-BF00-B93BA89C6643}{47C1B8B5-E22D-4F92-A325-A2C3CBE9E200}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
Set ws = Sheets("LOCATAIRES")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox1.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox1.ListIndex + 2
 Me.ComboBox2 = ws.Cells(ligne, "G")
 Me.TextBox9 = ws.Cells(ligne, "N")
End Sub

Private Sub ComboBox2_Change()
Set ws = Sheets("LOGEMENTS")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox2.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox2.ListIndex + 2

 Me.TextBox6 = ws.Cells(ligne, "Q")
 Me.TextBox7 = ws.Cells(ligne, "R")
End Sub

Private Sub CommandButton1_Click()


If ComboBox1.Value = "" Or ComboBox2.Value = "" Or TextBox3.Value = "" Or TextBox4.Value = "" Or TextBox6.Value = "" Or TextBox7.Value = "" Then
MsgBox "Veuillez renseigner toutes les informations afin de valider l'avis d'|fffd|ch|fffd|ance."
Exit Sub
End If
If MsgBox("Cette action va g|fffd|n|fffd|rer l'avis d'|fffd|ch|fffd|ance. Etes-vous s|fffd|r de vouloir continuer ?", vbYesNo + vbQuestion, "G|fffd|n|fffd|ration") = vbYes Then
Sheets("AVIS_ECHEANCE").Select
Sheets("avis_echeance").Range("E13").Value = ComboBox1.Value
Sheets("avis_echeance").Range("C16").Value = Format(TextBox3.Value, "mm/dd/yyyy")
Sheets("avis_echeance").Range("E16").Value = Format(TextBox4.Value, "mm/dd/yyyy")
Sheets("avis_echeance").Range("B20").Value = ComboBox2.Value
Sheets("avis_echeance").Range("F33").Value = CDbl(TextBox6.Value)
Sheets("avis_echeance").Range("F35").Value = CDbl(TextBox7.Value)

Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = TextBox9.Value & "ECHEANCES\"

If fs.FolderExists(nom) Then
Else: fs.CreateFolder nom
End If
Set fs = Nothing


Sheets("avis_echeance").Select

 Dim LaDate As String, Lenom As String, LeRep As String, Livraison As String
    LaDate = Format(Date, "yyyymmdd")
    Lenom = Sheets("avis_echeance").Range("E13").Value
    Livraison = Sheets("avis_echeance").Range("G6").Value & "-" & Sheets("avis_echeance").Range("H6").Value
    LeRep = nom
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=1, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf"
    
    
    
Sheets("avis_echeance").Select
Sheets("avis_echeance").Range("E13").Select
Selection.ClearContents
Sheets("avis_echeance").Range("C16").Select
Selection.ClearContents
Sheets("avis_echeance").Range("E16").Select
Selection.ClearContents
Sheets("avis_echeance").Range("B20").Select
Selection.ClearContents
Sheets("avis_echeance").Range("F33").Select
Selection.ClearContents
Sheets("avis_echeance").Range("F35").Select
Selection.ClearContents
    
    
    
    MsgBox "Avis d'|fffd|ch|fffd|ance g|fffd|n|fffd|r|fffd|."
    
    Unload Me
    ECHEANCE.Show vbModeless
End If


End Sub

Private Sub CommandButton4_Click()
Unload Me
ACCUEIL.Show
End Sub

Private Sub TextBox3_Afterupdate()
TextBox3.Value = Format(TextBox3, "dd/mm/yyyy")

End Sub
Private Sub Textbox3_change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox3.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox3.Value = TextBox3.Value & "/"
End Sub

Private Sub TextBox4_Afterupdate()
TextBox4.Value = Format(TextBox4, "dd/mm/yyyy")

End Sub
Private Sub Textbox4_change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox4.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox4.Value = TextBox4.Value & "/"
End Sub

Private Sub UserForm_Initialize()

Set ws = Sheets("LOGEMENTS")
    With Me.ComboBox2
  For J = 2 To ws.Range("B" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("B" & J)
  Next J
  End With
  
  Set ws = Sheets("LOCATAIRES")
    With Me.ComboBox1
  For J = 2 To ws.Range("A" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("A" & J)
  Next J
  End With

End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub

Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "IMPOTS"
Attribute VB_Base = "0{9FC482C3-611C-4D98-8242-5F116A157F83}{D715319C-E15B-4E99-895B-6710F795CC96}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CheckBox1_Click()
If CheckBox1.Value = True Then
CheckBox2.Value = False
Else
CheckBox2.Value = True
End If

End Sub

Private Sub CheckBox2_Click()
If CheckBox2.Value = True Then
CheckBox1.Value = False
Else
CheckBox1.Value = True
End If

End Sub

Private Sub ComboBox1_Change()
Sheets("RECAP_LOYERS").Range("D11").Value = ComboBox1.Value
End Sub

Private Sub CommandButton5_Click()
If TextBox1.Value = "" Then
MsgBox "Vous devez obligatoirement pr|fffd|ciser une ann|fffd|e d'exercice pour pouvoir g|fffd|n|fffd|rer l'|fffd|tat."
Exit Sub
End If


Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = "IMPOTS"

If fs.FolderExists(ThisWorkbook.Path & "\" & nom & "\") Then
Else: fs.CreateFolder ThisWorkbook.Path & "\" & nom & "\"
End If
Set fs = Nothing


Dim fs9 As Object

Set fs9 = CreateObject("Scripting.FileSystemObject")
Dim annee As String
annee = TextBox1.Value

If fs9.FolderExists(ThisWorkbook.Path & "\" & nom & "\" & annee & "\") Then
Else: fs9.CreateFolder ThisWorkbook.Path & "\" & nom & "\" & annee & "\"
End If
Set fs9 = Nothing


Sheets("RECAP_LOYERS").Select

If ComboBox1.Value <> "" Then
 Dim LaDate As String, Lenom As String, LeRep As String, Livraison As String
    LaDate = TextBox1.Value
    Lenom = ComboBox1.Value
    Livraison = "RECAPITULATIF"
    LeRep = ThisWorkbook.Path & "\" & nom & "\" & annee & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=1, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf"
    
Else

 Dim LaDate2 As String, Lenom2 As String, LeRep2 As String, Livraison2 As String
    LaDate2 = TextBox1.Value
    Lenom2 = "GLOBAL"
    Livraison2 = "RECAPITULATIF"
    LeRep2 = ThisWorkbook.Path & "\" & nom & "\" & annee & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep2 & Livraison2 & "_" & Lenom2 & "_" & LaDate2 & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=1, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep2 & Livraison2 & "_" & Lenom2 & "_" & LaDate2 & ".pdf"

End If

    Sheets("recap_loyers").Range("D11").Select
    Selection.ClearContents
    Sheets("recap_loyers").Range("B9").Select
    Selection.ClearContents
       MsgBox "G|fffd|n|fffd|ration Etat pour l'ann|fffd|e " & LaDate2 & " Termin|fffd|."
       
       
    Unload Me
 
    IMPOTS.Show vbModeless
    
End Sub

Private Sub CommandButton6_Click()
If TextBox1.Value = "" Then
MsgBox "Vous devez renseigner une ann|fffd|e."
Exit Sub
End If


Sheets("charges").Select
Dim derligne As Long
derligne = Sheets("charges").Range("A65536").End(xlUp).Row

Dim annee As Integer
annee = TextBox1.Value
Range("A1").Select

If CheckBox1.Value = True Then

    'Filtre sur l'ann|fffd|e
    ActiveSheet.Range("$A$1:$G" & derligne).AutoFilter Field:=1, Criteria1:=annee
    
        ' Si un logement est s|fffd|lectionn|fffd|, filtre aussi sur le logement
        If ComboBox1.Value <> "" Then
        Dim LOGEMENT As String
        LOGEMENT = ComboBox1.Value
    
        Dim derligne2 As Long
        derligne2 = Sheets("charges").Range("A65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne2).AutoFilter Field:=2, Criteria1:=LOGEMENT
        
        End If
    
       
       
    
        Dim NbrePage As Integer
        NbrePage = ExecuteExcel4Macro("GET.DOCUMENT(50)")
        
    Range("C1").Select
    ActiveWorkbook.Worksheets("CHARGES").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CHARGES").Sort.SortFields.Add Key:=Range("C1"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
       
   
        
Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = "IMPOTS" & "\" & TextBox1.Value

If fs.FolderExists(ThisWorkbook.Path & "\" & nom & "\") Then
Else: fs.CreateFolder ThisWorkbook.Path & "\" & nom & "\"
End If
Set fs = Nothing

Sheets("CHARGES").Select

If ComboBox1.Value <> "" Then
 Dim LaDate As String, Lenom As String, LeRep As String, Livraison As String
    LaDate = TextBox1.Value
    Lenom = ComboBox1.Value
    Livraison = "RECAPITULATIF_CHARGES"
    LeRep = ThisWorkbook.Path & "\" & nom & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=NbrePage, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf"
Else

 Dim LaDate2 As String, Lenom2 As String, LeRep2 As String, Livraison2 As String
    LaDate2 = TextBox1.Value
    Lenom2 = "GLOBAL"
    Livraison2 = "RECAPITULATIF_CHARGES"
    LeRep2 = ThisWorkbook.Path & "\" & nom & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep2 & Livraison2 & "_" & Lenom2 & "_" & LaDate2 & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=NbrePage, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep2 & Livraison2 & "_" & Lenom2 & "_" & LaDate2 & ".pdf"

End If


   Worksheets("charges").ShowAllData

End If


If CheckBox2.Value = True Then

' Etape 1, filtre sur l'ann|fffd|e et le logement

 'Filtre sur l'ann|fffd|e
    ActiveSheet.Range("$A$1:$G" & derligne).AutoFilter Field:=1, Criteria1:=annee
    
        ' Si un logement est s|fffd|lectionn|fffd|, filtre aussi sur le logement
        If ComboBox1.Value <> "" Then
        Dim LOGEMENT2 As String
        LOGEMENT2 = ComboBox1.Value
    
        Dim derligne3 As Long
        derligne3 = Sheets("charges").Range("A65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne3).AutoFilter Field:=2, Criteria1:=LOGEMENT2
        
        End If

' filtre type de charge proprietaire

        Dim derligne4 As Long
        derligne4 = Sheets("charges").Range("a65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne4).AutoFilter Field:=3, Criteria1:="PROPRIETAIRE"
        
        Dim derligne5 As Long
        derligne5 = Sheets("charges").Range("A65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne5).AutoFilter Field:=4, Criteria1:="DEDUCTIBLE"
        
        Dim NbrePage2 As Integer
        NbrePage2 = ExecuteExcel4Macro("GET.DOCUMENT(50)")
        
Set fs2 = CreateObject("Scripting.FileSystemObject")
Dim Nom3 As String
Nom3 = "IMPOTS" & "\" & TextBox1.Value

If fs2.FolderExists(ThisWorkbook.Path & "\" & Nom3 & "\") Then
Else: fs2.CreateFolder ThisWorkbook.Path & "\" & Nom3 & "\"
End If
Set fs2 = Nothing

Sheets("CHARGES").Select


 Dim LaDate3 As String, Lenom3 As String, LeRep3 As String, Livraison3 As String
    LaDate3 = TextBox1.Value
    Lenom3 = ComboBox1.Value
    Livraison3 = "RECAP_CHARGES_PRIORIETAIRE_DEDUCTIBLE"
    LeRep3 = ThisWorkbook.Path & "\" & Nom3 & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep3 & Livraison3 & "_" & Lenom3 & "_" & LaDate3 & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=NbrePage2, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep3 & Livraison3 & "_" & Lenom3 & "_" & LaDate3 & ".pdf"
    
     ActiveSheet.Range("$A$1:$G" & derligne5).AutoFilter Field:=4, Criteria1:="NON DEDUCTIBLE"
     
     Dim NbrePage3 As Integer
        NbrePage3 = ExecuteExcel4Macro("GET.DOCUMENT(50)")
     
 Sheets("CHARGES").Select


 Dim LaDate4 As String, Lenom4 As String, LeRep4 As String, Livraison4 As String
    LaDate4 = TextBox1.Value
    Lenom4 = ComboBox1.Value
    Livraison4 = "RECAP_CHARGES_PRIORIETAIRE_NON_DEDUCTIBLE"
    LeRep4 = ThisWorkbook.Path & "\" & Nom3 & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep4 & Livraison4 & "_" & Lenom4 & "_" & LaDate4 & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=NbrePage3, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep4 & Livraison4 & "_" & Lenom4 & "_" & LaDate4 & ".pdf"
     
     
  Worksheets("charges").ShowAllData
  
   Sheets("CHARGES").Select
  
  'Filtre sur l'ann|fffd|e
    ActiveSheet.Range("$A$1:$G" & derligne).AutoFilter Field:=1, Criteria1:=annee
    
        ' Si un logement est s|fffd|lectionn|fffd|, filtre aussi sur le logement
        If ComboBox1.Value <> "" Then
        Dim LOGEMENT3 As String
        LOGEMENT3 = ComboBox1.Value
    
        Dim derligne6 As Long
        derligne6 = Sheets("charges").Range("A65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne6).AutoFilter Field:=2, Criteria1:=LOGEMENT3
        
        End If
        


' filtre type de charge coproprietaire

 Sheets("CHARGES").Select
        Dim derligne7 As Long
        derligne7 = Sheets("charges").Range("a65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne7).AutoFilter Field:=3, Criteria1:="COPROPRIETE"
        
        Dim derligne8 As Long
        derligne8 = Sheets("charges").Range("A65536").End(xlUp).Row
        ActiveSheet.Range("$A$1:$G" & derligne8).AutoFilter Field:=4, Criteria1:="DEDUCTIBLE"
        
         Sheets("CHARGES").Select
        
        Dim NbrePage4 As Integer
        NbrePage4 = ExecuteExcel4Macro("GET.DOCUMENT(50)")
        
         Sheets("CHARGES").Select
        
        Dim LaDate5 As String, Lenom5 As String, LeRep5 As String, Livraison5 As String
    LaDate5 = TextBox1.Value
    Lenom5 = ComboBox1.Value
    Livraison5 = "RECAP_CHARGES_COPRIORIETE_DEDUCTIBLE"
    LeRep5 = ThisWorkbook.Path & "\" & Nom3 & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep5 & Livraison5 & "_" & Lenom5 & "_" & LaDate5 & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=NbrePage4, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep5 & Livraison5 & "_" & Lenom5 & "_" & LaDate5 & ".pdf"
    
     Sheets("CHARGES").Select
    
     ActiveSheet.Range("$A$1:$G" & derligne8).AutoFilter Field:=4, Criteria1:="NON DEDUCTIBLE"
     
      Sheets("CHARGES").Select
     
      Dim NbrePage5 As Integer
        NbrePage5 = ExecuteExcel4Macro("GET.DOCUMENT(50)")
        
         Sheets("CHARGES").Select
        
        Dim LaDate6 As String, Lenom6 As String, LeRep6 As String, Livraison6 As String
    LaDate6 = TextBox1.Value
    Lenom6 = ComboBox1.Value
    Livraison6 = "RECAP_CHARGES_COPRIORIETE_NON_DEDUCTIBLE"
    LeRep6 = ThisWorkbook.Path & "\" & Nom3 & "\"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep6 & Livraison6 & "_" & Lenom6 & "_" & LaDate6 & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=NbrePage5, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep6 & Livraison6 & "_" & Lenom6 & "_" & LaDate6 & ".pdf"
    
      Worksheets("charges").ShowAllData

    MsgBox "L'ensemble des documents ont |fffd|t|fffd| g|fffd|n|fffd|r|fffd|s."
    
    

End If


 MsgBox "L'ensemble des documents ont |fffd|t|fffd| g|fffd|n|fffd|r|fffd|s."
 


  
End Sub

Private Sub CommandButton7_Click()
Unload Me
ACCUEIL.Show vbModeless
End Sub

Private Sub Image1_Click()
On Error Resume Next

Dim MonDossier As String
MonDossier = ThisWorkbook.Path & "\IMPOTS\"

Shell Environ("WINDIR") & "\explorer.exe " & MonDossier, vbNormalFocus

End Sub

Private Sub TextBox1_Change()
TextBox1.MaxLength = 4
Sheets("RECAP_LOYERS").Range("B9").Value = TextBox1.Value
End Sub

Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890", Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub

Private Sub UserForm_Initialize()
 Set ws = Sheets("LOGEMENTS")
    With Me.ComboBox1
  For J = 2 To ws.Range("B" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("B" & J)
  Next J
  End With
  
  ComboBox1.ControlTipText = "Laissez vide si vous souhaitez un r|fffd|capitulatif de tous les logements. Dans le cas o|fffd| tous les logements ne serait pas sous le m|fffd|me r|fffd|gime, |fffd|ditez alors un r|fffd|capitulatif par logement."
  
  CheckBox1.Value = True
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub
Attribute VB_Name = "LOCATAIRES"
Attribute VB_Base = "0{DE59F34B-6374-4775-BAF4-BB7D52D13C64}{E9E5EC5C-65C0-43FB-9CC2-6BAF79775DE2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
ComboBox1.Text = UCase(ComboBox1)
End Sub
Private Sub Combobox1_afterupdate()
Set ws = Sheets("LOCATAIRES")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox1.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox1.ListIndex + 2
 Me.TextBox1 = ws.Cells(ligne, "B")
 Me.TextBox2 = ws.Cells(ligne, "C")
 Me.TextBox5 = ws.Cells(ligne, "D")
  Me.TextBox9 = ws.Cells(ligne, "E")
 Me.TextBox11 = ws.Cells(ligne, "F")
 Me.ComboBox2 = ws.Cells(ligne, "G")
 Me.ComboBox3 = ws.Cells(ligne, "H")
 Me.TextBox3 = ws.Cells(ligne, "I")
 Me.TextBox4 = ws.Cells(ligne, "J")
 Me.TextBox6 = ws.Cells(ligne, "K")
 Me.TextBox7 = ws.Cells(ligne, "L")
 Me.TextBox8 = ws.Cells(ligne, "M")
 Me.TextBox10 = ws.Cells(ligne, "N")
 
 If TextBox10.Value <> "" Then
 Image1.Visible = True
 Else
 Image1.Visible = False
 End If
 
 
End Sub

Private Sub ComboBox2_Change()
Set ws = Sheets("LOGEMENTS")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox2.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox2.ListIndex + 2
 Me.ComboBox3 = ws.Cells(ligne, "A")
End Sub

Private Sub CommandButton3_Click()
If ComboBox1.Value = "" Then
MsgBox "Affichez d'abord un locataire cr|fffd||fffd| dans la base de donn|fffd|es pour pouvoir le supprimer."
Exit Sub
End If

If MsgBox("Etes-vous sur de vouloir supprimer ce locataire ?", vbYesNo, "Demande de suppression") = vbYes Then

Sheets("LOCATAIRES").Select
For i = Cells(1, 1).CurrentRegion.Rows.Count To 1 Step -1
If Cells(i, 1).Value = ComboBox1.Value Then Cells(i, 1).EntireRow.Delete
Next


    If Application.WorksheetFunction.And(ComboBox1.Value <> "") Then
    MsgBox " Locataire Supprim|fffd| ", vbOKOnly + vbInformation, "Suppression"
    End If
    End If
Unload Me
LOCATAIRES.Show vbModeless
End Sub

Private Sub CommandButton4_Click()
Unload Me
ACCUEIL.Show vbModeless

End Sub

Private Sub CommandButton5_Click()
Dim LOGEMENT As String
LOGEMENT = ComboBox2.Value

If Not IsError(Application.Match(LOGEMENT, Sheets("LOCATAIRES").Range("G:G"), 0)) Then
ligne = Application.Match(LOGEMENT, Sheets("LOCATAIRES").Range("G:G"), 0)

    If Sheets("LOCATAIRES").Range("J" & ligne).Value = "" Then
    Dim occupant As String
    occupant = Sheets("locataires").Range("A" & ligne).Value
    
    MsgBox "Ce logement n'est pas vacant, il est actuellement occup|fffd| par " & occupant & ". Si le logement a |fffd|t|fffd| lib|fffd|r|fffd| vous devez renseigner une date de sortie pour le pr|fffd|c|fffd|dent locataire."
    Exit Sub
    End If
End If

    


Sheets("LOCATAIRES").Select
 Dim L As Integer
 If MsgBox("Confirmez-vous la cr|fffd|ation de ce nouveau locataire ?", vbYesNo, "Demande de confirmation d|fffd|ajout") = vbYes Then
 L = Sheets("LOCATAIRES").Range("a65536").End(xlUp).Row + 1
Range("A" & L).Value = ComboBox1
Range("B" & L).Value = TextBox1
Range("C" & L).Value = TextBox2
Range("D" & L).Value = TextBox5
Range("E" & L).Value = TextBox9
Range("F" & L).Value = TextBox11
Range("G" & L).Value = ComboBox2
Range("H" & L).Value = ComboBox3
Range("I" & L).Value = TextBox3
Range("J" & L).Value = TextBox4
Range("K" & L).Value = TextBox6
Range("L" & L).Value = TextBox7
Range("M" & L).Value = TextBox8


Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = ComboBox3.Value & "-" & ComboBox2.Value

If fs.FolderExists(ThisWorkbook.Path & "\" & nom & "\") Then
Else: fs.CreateFolder ThisWorkbook.Path & "\" & nom & "\"
End If
Set fs = Nothing

Dim fs2 As Object

Set fs2 = CreateObject("Scripting.FileSystemObject")
Dim Nom2 As String
Nom2 = ComboBox1.Value

If fs2.FolderExists(ThisWorkbook.Path & "\" & nom & "\" & Nom2 & "\") Then
Else: fs2.CreateFolder ThisWorkbook.Path & "\" & nom & "\" & Nom2 & "\"
End If
Set fs2 = Nothing



Dim chemin As String
chemin = ThisWorkbook.Path & "\" & nom & "\" & Nom2 & "\"



Range("N" & L).Value = chemin

Unload Me

MsgBox "Le locataire a |fffd|t|fffd| cr|fffd||fffd|, ainsi qu'un dossier |fffd| son nom dans le dossier correspondant |fffd| son logement."

LOCATAIRES.Show vbModeless

End If


End Sub

Private Sub CommandButton6_Click()
Dim LOGEMENT As String
LOGEMENT = ComboBox2.Value

If Not IsError(Application.Match(LOGEMENT, Sheets("LOCATAIRES").Range("G:G"), 0)) Then
ligne2 = Application.Match(LOGEMENT, Sheets("LOCATAIRES").Range("G:G"), 0)

    If Sheets("LOCATAIRES").Range("J" & ligne2).Value = "" And Sheets("LOCATAIRES").Range("A" & ligne2).Value <> ComboBox1.Value Then
    Dim occupant As String
    occupant = Sheets("locataires").Range("A" & ligne2).Value
    
    MsgBox "Ce logement n'est pas vacant, il est actuellement occup|fffd| par " & occupant & ". Si le logement a |fffd|t|fffd| lib|fffd|r|fffd| vous devez renseigner une date de sortie pour le pr|fffd|c|fffd|dent locataire."
    Exit Sub
    End If
End If

'*************************
Sheets("LOCATAIRES").Select

Dim ligne As Long

Set ws = Sheets("LOCATAIRES")
 If MsgBox("Confirmez-vous la modification de ce locataire ?", vbYesNo, "Demande de confirmation de modification") = vbYes Then
 If Me.ComboBox1.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox1.ListIndex + 2

  
 ws.Cells(ligne, "D") = Me.TextBox5
 ws.Cells(ligne, "E") = Me.TextBox9
 ws.Cells(ligne, "F") = Me.TextBox11
 ws.Cells(ligne, "G") = Me.ComboBox2
 ws.Cells(ligne, "H") = Me.ComboBox3
 
 ws.Cells(ligne, "I") = Me.TextBox3
 ws.Cells(ligne, "J") = Me.TextBox4
 
 ws.Cells(ligne, "K") = Me.TextBox6
 ws.Cells(ligne, "L") = Me.TextBox7
 ws.Cells(ligne, "M") = Me.TextBox8
 
MsgBox "Fiche locataire modifi|fffd|e."
Unload Me
LOCATAIRES.Show vbModeless

End If

End Sub

Private Sub Image1_Click()
On Error Resume Next
If TextBox10.Value <> "" Then
Dim MonDossier As String
MonDossier = TextBox10.Value

Shell Environ("WINDIR") & "\explorer.exe " & MonDossier, vbNormalFocus
Else
MsgBox "aucun dossier cr|fffd||fffd|."
End If
End Sub

Private Sub Textbox1_Afterupdate()
TextBox1.Value = Format(TextBox1, "dd/mm/yyyy")

End Sub
Private Sub TextBox1_Change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox1.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox1.Value = TextBox1.Value & "/"
End Sub

Private Sub TextBox2_Change()
TextBox2.Text = UCase(TextBox2)
End Sub

Private Sub TextBox3_Afterupdate()
TextBox3.Value = Format(TextBox3, "dd/mm/yyyy")

End Sub
Private Sub Textbox3_change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox3.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox3.Value = TextBox3.Value & "/"
End Sub


Private Sub TextBox4_Afterupdate()
TextBox4.Value = Format(TextBox4, "dd/mm/yyyy")

End Sub
Private Sub Textbox4_change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox4.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox4.Value = TextBox4.Value & "/"
End Sub

Private Sub TextBox7_Change()
TextBox7.MaxLength = 5
End Sub

Private Sub textbox7_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890", Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox9_Change()
TextBox9.MaxLength = 10
End Sub
Private Sub textbox9_afterupdate()
TextBox9.Value = Format(TextBox9, " 00 00 00 00 00")

End Sub

Private Sub UserForm_Initialize()
Set ws = Sheets("LOGEMENTS")
    With Me.ComboBox2
  For J = 2 To ws.Range("B" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("B" & J)
  Next J
  End With
  
  
  Set ws = Sheets("LOCATAIRES")
    With Me.ComboBox1
  For J = 2 To ws.Range("A" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("A" & J)
  Next J
  End With
  
  Image1.Visible = False
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub
Attribute VB_Name = "LOGEMENT"
Attribute VB_Base = "0{F4DB0F14-CC55-4723-9ED6-E8BB51EBEDD0}{4AC0C701-3DD8-4A42-84EF-277E451FD575}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
ComboBox1.Text = UCase(ComboBox1)
End Sub
Private Sub Combobox1_afterupdate()
Set ws = Sheets("LOGEMENTS")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox1.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox1.ListIndex + 2
 Me.ComboBox3 = ws.Cells(ligne, "A")
 Me.TextBox1 = ws.Cells(ligne, "C")
 Me.TextBox2 = ws.Cells(ligne, "D")
 Me.TextBox3 = ws.Cells(ligne, "E")
 Me.ComboBox2 = ws.Cells(ligne, "F")
 Me.TextBox4 = ws.Cells(ligne, "G")
 Me.TextBox5 = ws.Cells(ligne, "H")
 Me.TextBox6 = ws.Cells(ligne, "Q")
 Me.TextBox7 = ws.Cells(ligne, "R")
 Me.CheckBox1 = ws.Cells(ligne, "I")
 Me.CheckBox4 = ws.Cells(ligne, "J")
 Me.CheckBox2 = ws.Cells(ligne, "K")
 Me.CheckBox5 = ws.Cells(ligne, "L")
 Me.CheckBox3 = ws.Cells(ligne, "M")
 Me.CheckBox6 = ws.Cells(ligne, "P")
 If ws.Cells(ligne, "N").Value = "Oui" Then
 OptionButton1.Value = True
 Else
 OptionButton2.Value = True
 End If
 If ws.Cells(ligne, "O").Value = "Oui" Then
 OptionButton4.Value = True
 Else
 OptionButton3.Value = True
 End If
 Me.TextBox8 = ws.Cells(ligne, "S")
 
If TextBox8.Value <> "" Then
Image1.Visible = True
Else
Image1.Visible = False
End If


End Sub

Private Sub CommandButton1_Click()
If ComboBox3.Value <> "" Then
MsgBox "Ce logement est d|fffd|j|fffd| enregistr|fffd|, cliquez sur modifier si vous avez effectuer des changements sur le logement."
Exit Sub
End If

Sheets("LOGEMENTS").Select
 Dim L As Integer
 If MsgBox("Confirmez-vous l|fffd|insertion de ce nouveau logement ?", vbYesNo, "Demande de confirmation d|fffd|ajout") = vbYes Then
 L = Sheets("LOGEMENTS").Range("a65536").End(xlUp).Row + 1
Range("A" & L).Value = Sheets("param").Range("D1").Value
Range("B" & L).Value = ComboBox1
Range("C" & L).Value = TextBox1
Range("D" & L).Value = TextBox2
Range("E" & L).Value = TextBox3
Range("F" & L).Value = ComboBox2
Range("G" & L).Value = TextBox4
Range("H" & L).Value = TextBox5
Range("I" & L).Value = CheckBox1
Range("J" & L).Value = CheckBox4
Range("K" & L).Value = CheckBox2
Range("L" & L).Value = CheckBox5
Range("M" & L).Value = CheckBox3
If OptionButton1.Value = True Then
Range("N" & L).Value = "Oui"
Else
Range("N" & L).Value = "Non"
End If
If OptionButton4.Value = True Then
Range("O" & L).Value = "Oui"
Else
Range("O" & L).Value = "Non"
End If
Range("Q" & L).Value = TextBox6
Range("R" & L).Value = TextBox7
Range("P" & L).Value = CheckBox6

'ICI INSERTION DU CODE POUR LA CREATION DU DOSSIER
Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = Sheets("param").Range("D1").Value & "-" & ComboBox1.Value

If fs.FolderExists(ThisWorkbook.Path & "\" & nom & "\") Then
Else: fs.CreateFolder ThisWorkbook.Path & "\" & nom & "\"
End If
Set fs = Nothing

Dim chemin As String
chemin = ThisWorkbook.Path & "\" & nom & "\"

Range("S" & L).Value = chemin

'FIN DE LA CREATION DU CODE

Sheets("param").Select
Dim NumLog As Integer
NumLog = Sheets("param").Range("C1").Value
NumLog = NumLog + 1
Sheets("param").Range("C1").Value = NumLog

Unload Me
MsgBox "Logement et dossier cr|fffd||fffd| Cr|fffd||fffd|."
LOGEMENT.Show vbModeless
End If


End Sub



Private Sub CommandButton2_Click()
Sheets("LOGEMENTS").Select

Dim ligne As Long

Set ws = Sheets("LOGEMENTS")
 If MsgBox("Confirmez-vous la modification de ce logement ?", vbYesNo, "Demande de confirmation de modification") = vbYes Then
 If Me.ComboBox1.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox1.ListIndex + 2

  
 ws.Cells(ligne, "C") = Me.TextBox1
 ws.Cells(ligne, "C") = Me.TextBox2
 ws.Cells(ligne, "D") = Me.TextBox3
 ws.Cells(ligne, "E") = Me.TextBox3
 ws.Cells(ligne, "F") = Me.ComboBox2
 ws.Cells(ligne, "G") = Me.TextBox4
 ws.Cells(ligne, "H") = Me.TextBox5
 ws.Cells(ligne, "I") = Me.CheckBox1
 ws.Cells(ligne, "J") = Me.CheckBox4
 ws.Cells(ligne, "K") = Me.CheckBox2
 ws.Cells(ligne, "L") = Me.CheckBox5
 ws.Cells(ligne, "M") = Me.CheckBox3
 If OptionButton1.Value = True Then
 ws.Cells(ligne, "N") = "Oui"
 Else
 ws.Cells(ligne, "N") = "Non"
 End If
 If OptionButton4.Value = True Then
 ws.Cells(ligne, "O") = "Oui"
 Else
 ws.Cells(ligne, "O") = "Non"
 End If
 ws.Cells(ligne, "Q") = Me.TextBox6
 ws.Cells(ligne, "R") = Me.TextBox7
 ws.Cells(ligne, "P") = Me.CheckBox6
 
 MsgBox "Logement Modifi|fffd|."
 Unload Me
 LOGEMENT.Show vbModeless
 
 End If
 

End Sub

Private Sub CommandButton3_Click()
If ComboBox3.Value = "" Then
MsgBox "Affichez d'abord un logement cr|fffd||fffd| dans la base de donn|fffd|es pour pouvoir le supprimer."
Exit Sub
End If

If MsgBox("Etes-vous sur de vouloir supprimer ce logement ?", vbYesNo, "Demande de suppression") = vbYes Then

Sheets("LOGEMENTS").Select
For i = Cells(1, 1).CurrentRegion.Rows.Count To 1 Step -1
If Cells(i, 1).Value = ComboBox3.Value Then Cells(i, 1).EntireRow.Delete
Next


    If Application.WorksheetFunction.And(ComboBox1.Value <> "") Then
    MsgBox " Logement Supprim|fffd| ", vbOKOnly + vbInformation, "Suppression"
    End If
    End If
Unload Me
LOGEMENT.Show vbModeless

End Sub

Private Sub CommandButton4_Click()
Unload Me
ACCUEIL.Show vbModeless

End Sub

Private Sub Image1_Click()
On Error Resume Next
If TextBox8.Value <> "" Then
Dim MonDossier As String
MonDossier = TextBox8.Value

Shell Environ("WINDIR") & "\explorer.exe " & MonDossier, vbNormalFocus
Else
MsgBox "aucun dossier cr|fffd||fffd|."
End If
End Sub

Private Sub TextBox2_Change()
TextBox2.MaxLength = 5
End Sub

Private Sub TextBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890", Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub

Private Sub Textbox3_change()
TextBox3.Text = UCase(TextBox3)

End Sub
Private Sub textbox4_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890", Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub

Private Sub Textbox4_change()
TextBox4.MaxLength = 4
End Sub
Private Sub TextBox4_Afterupdate()
TextBox4.Value = Format(TextBox4, "###0 m|fffd|")

End Sub

Private Sub textbox5_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890", Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub
Private Sub TextBox5_Change()
TextBox5.MaxLength = 3
End Sub

Private Sub TextBox6_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890-.,", Chr(KeyAscii)) = 0 Then KeyAscii = 0
 If KeyAscii = 46 Then KeyAscii = 44
End Sub


Private Sub TextBox6_Afterupdate()
TextBox6.Value = Format(TextBox6.Value, "###.00 |fffd|")
End Sub


Private Sub textbox7_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890-.,", Chr(KeyAscii)) = 0 Then KeyAscii = 0
 If KeyAscii = 46 Then KeyAscii = 44
End Sub


Private Sub TextBox7_Afterupdate()
TextBox7.Value = Format(TextBox7.Value, "###.00 |fffd|")
End Sub



Private Sub UserForm_Initialize()
Set ws = Sheets("param")
    With Me.ComboBox2
  For J = 1 To ws.Range("H" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("H" & J)
  Next J
  End With
  
  Set ws = Sheets("LOGEMENTS")
    With Me.ComboBox1
  For J = 2 To ws.Range("B" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("B" & J)
  Next J
  End With

If TextBox8.Value = "" Then
Image1.Visible = False
End If
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub
Attribute VB_Name = "MDP"
Attribute VB_Base = "0{3B4D5CF6-AF89-4C7C-9269-A9068523BC54}{0B88C4AB-2D14-4B73-9479-4E5280DF6C36}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Dim jour As Integer, mois As Integer, annee As Integer
jour = Sheets("PARAM").Range("A9").Value * 2
mois = Sheets("PARAM").Range("A10").Value * 2 + 3
annee = Sheets("PARAM").Range("A12").Value * 2

Dim motpasse As String
motpasse = "U" & jour & "M" & mois & "E" & annee & "B"



If TextBox1.Value = motpasse Then

Application.Visible = True
Unload Me

Else

MsgBox "Erreur de mot de passe"
TextBox1.Value = ""
End If
End Sub

Private Sub CommandButton2_Click()
Unload Me
ACCUEIL.Show vbModeless
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub
Attribute VB_Name = "Module1"
Option Explicit
'******CONVERTISSEUR DE NOMBRE EN LETTRES**********

'CE CODE EST PROGRAMME PAR DEFAUT POUR UNE UTILISATION EN EUROS************************

'*********
' Devise=0   aucune
'       =1   Euro |fffd|
'       =2   Dollar $
' Langue=0   Fran|fffd|ais
'       =1   Belgique
'       =2   Suisse
'*********
' Conversion limit|fffd|e |fffd| 999 999 999 999 999 ou 9 999 999 999 999,99
' si le nombre contient plus de 2 d|fffd|cimales, il est arrondit |fffd| 2 d|fffd|cimales


'Pour modifier la devise (monnaie), modifier la valeur 1 presente ci-dessous sous la mention Optional Devis As byte = "1"
'Pour modifier la langue, modifier la valeur 0 pr|fffd|sente ci-dessous sous la mention Optional Langue as byte = "0"
Public Function ConvNumberLetter(Nombre As Double, Optional Devise As Byte = 1, _
                                    Optional Langue As Byte = 0) As String
    Dim dblEnt As Variant, byDec As Byte
    Dim bNegatif As Boolean
    Dim strDev As String, strCentimes As String
    
    If Nombre < 0 Then
        bNegatif = True
        Nombre = Abs(Nombre)
    End If
    dblEnt = Int(Nombre)
    byDec = CInt((Nombre - dblEnt) * 100)
    If byDec = 0 Then
        If dblEnt > 999999999999999# Then
            ConvNumberLetter = "#TropGrand"
            Exit Function
        End If
    Else
        If dblEnt > 9999999999999.99 Then
            ConvNumberLetter = "#TropGrand"
            Exit Function
        End If
    End If
    Select Case Devise
        Case 0
            If byDec > 0 Then strDev = " virgule "
        Case 1
            strDev = " Euro"
            If byDec > 0 Then strCentimes = strCentimes & " Centimes"
        Case 2
            strDev = " Dollar"
            If byDec > 0 Then strCentimes = strCentimes & " Centime"
    End Select
    If dblEnt > 1 And Devise <> 0 Then strDev = strDev & "s"
    
        
    ConvNumberLetter = ConvNumEnt(CDbl(dblEnt), Langue) & strDev & " " & _
        ConvNumDizaine(byDec, Langue) & strCentimes
                
End Function

Private Function ConvNumEnt(Nombre As Double, Langue As Byte)
    Dim byNum As Byte, iTmp As Variant, dblReste As Double
    Dim strTmp As String
    
    iTmp = Nombre - (Int(Nombre / 1000) * 1000)
    ConvNumEnt = ConvNumCent(CInt(iTmp), Langue)
    dblReste = Int(Nombre / 1000)
    iTmp = dblReste - (Int(dblReste / 1000) * 1000)
    strTmp = ConvNumCent(CInt(iTmp), Langue)
    Select Case iTmp
        Case 0
        Case 1
            strTmp = "mille "
        Case Else
            strTmp = strTmp & " mille "
    End Select
    ConvNumEnt = strTmp & ConvNumEnt
    dblReste = Int(dblReste / 1000)
    iTmp = dblReste - (Int(dblReste / 1000) * 1000)
    strTmp = ConvNumCent(CInt(iTmp), Langue)
    Select Case iTmp
        Case 0
        Case 1
            strTmp = strTmp & " million "
        Case Else
            strTmp = strTmp & " millions "
    End Select
    ConvNumEnt = strTmp & ConvNumEnt
    dblReste = Int(dblReste / 1000)
    iTmp = dblReste - (Int(dblReste / 1000) * 1000)
    strTmp = ConvNumCent(CInt(iTmp), Langue)
    Select Case iTmp
        Case 0
        Case 1
            strTmp = strTmp & " milliard "
        Case Else
            strTmp = strTmp & " milliards "
    End Select
    ConvNumEnt = strTmp & ConvNumEnt
    dblReste = Int(dblReste / 1000)
    iTmp = dblReste - (Int(dblReste / 1000) * 1000)
    strTmp = ConvNumCent(CInt(iTmp), Langue)
    Select Case iTmp
        Case 0
        Case 1
            strTmp = strTmp & " billion "
        Case Else
            strTmp = strTmp & " billions "
    End Select
    ConvNumEnt = strTmp & ConvNumEnt
    
End Function

Private Function ConvNumDizaine(Nombre As Byte, Langue As Byte) As String
    Dim TabUnit As Variant, TabDiz As Variant
    Dim byUnit As Byte, byDiz As Byte
    Dim strLiaison As String
    
    TabUnit = Array("", "un", "deux", "trois", "quatre", "cinq", "six", "sept", _
        "huit", "neuf", "dix", "onze", "douze", "treize", "quatorze", "quinze", _
        "seize", "dix-sept", "dix-huit", "dix-neuf")
    TabDiz = Array("", "", "vingt", "trente", "quarante", "cinquante", _
        "soixante", "soixante", "quatre-vingt", "quatre-vingt")
    If Langue = 1 Then
        TabDiz(7) = "septante"
        TabDiz(9) = "nonante"
    ElseIf Langue = 2 Then
        TabDiz(7) = "septante"
        TabDiz(8) = "huitante"
        TabDiz(9) = "nonante"
    End If
    byDiz = Int(Nombre / 10)
    byUnit = Nombre - (byDiz * 10)
    strLiaison = "-"
    If byUnit = 1 Then strLiaison = " et "
    Select Case byDiz
        Case 0
            strLiaison = ""
        Case 1
            byUnit = byUnit + 10
            strLiaison = ""
        Case 7
            If Langue = 0 Then byUnit = byUnit + 10
        Case 8
            If Langue <> 2 Then strLiaison = "-"
        Case 9
            If Langue = 0 Then
                byUnit = byUnit + 10
                strLiaison = "-"
            End If
    End Select
    ConvNumDizaine = TabDiz(byDiz)
    If byDiz = 8 And Langue <> 2 And byUnit = 0 Then ConvNumDizaine = ConvNumDizaine & "s"
    If TabUnit(byUnit) <> "" Then
        ConvNumDizaine = ConvNumDizaine & strLiaison & TabUnit(byUnit)
    Else
        ConvNumDizaine = ConvNumDizaine
    End If
End Function

Private Function ConvNumCent(Nombre As Integer, Langue As Byte) As String
    Dim TabUnit As Variant
    Dim byCent As Byte, byReste As Byte
    Dim strReste As String
    
    TabUnit = Array("", "un", "deux", "trois", "quatre", "cinq", "six", "sept", _
        "huit", "neuf", "dix")
    
    byCent = Int(Nombre / 100)
    byReste = Nombre - (byCent * 100)
    strReste = ConvNumDizaine(byReste, Langue)
    Select Case byCent
        Case 0
            ConvNumCent = strReste
        Case 1
            If byReste = 0 Then
                ConvNumCent = "cent"
            Else
                ConvNumCent = "cent " & strReste
            End If
        Case Else
            If byReste = 0 Then
                ConvNumCent = TabUnit(byCent) & " cents"
            Else
                ConvNumCent = TabUnit(byCent) & " cent " & strReste
            End If
    End Select
End Function

 




Attribute VB_Name = "Module2"
Sub testfiltre()
Attribute testfiltre.VB_ProcData.VB_Invoke_Func = " \n14"
'
' testfiltre Macro
'

'


    Range("A1").Select
    ActiveSheet.Range("$A$1:$G$81").AutoFilter Field:=1, Criteria1:="2019"
    
    Range("C1").Select
    ActiveWorkbook.Worksheets("CHARGES").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CHARGES").Sort.SortFields.Add Key:=Range("C1"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        
        

    
    
    Range("D1").Select
    ActiveWorkbook.Worksheets("CHARGES").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CHARGES").Sort.SortFields.Add Key:=Range("D1"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("CHARGES").Sort
        .SetRange Range("A2:K40")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("A1").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    ActiveWindow.SmallScroll Down:=-21
    Range("A1:G1").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Range("A1").Select
End Sub
Sub filtre2()
Attribute filtre2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' filtre2 Macro
'

'
    Range("B33").Select
    ActiveWindow.SmallScroll Down:=18
    ActiveCell.FormulaR1C1 = "CREMEAU ETAGE"
    Range("B33").Select
    Selection.FillDown
    Range("C33").Select
    ActiveWindow.SmallScroll Down:=-33
    ActiveSheet.Range("$A$1:$G$81").AutoFilter Field:=2, Criteria1:= _
        "CREMEAU ETAGE"
End Sub
Sub bordutre()
Attribute bordutre.VB_ProcData.VB_Invoke_Func = " \n14"
'
' bordutre Macro
'

'
    Range("A3:G8").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
End Sub
Sub deflitrer()
Attribute deflitrer.VB_ProcData.VB_Invoke_Func = " \n14"
'
' deflitrer Macro
'

'
    ActiveSheet.Range("$A$1:$G$82").AutoFilter Field:=4
End Sub
Attribute VB_Name = "PARAM"
Attribute VB_Base = "0{76367630-3423-448C-84FB-10512668699A}{CEAD4E0A-42E2-4DDD-B5F0-84F92F51618F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
Sheets("param").Range("C7").Value = ComboBox1.Value
End Sub

Private Sub CommandButton5_Click()
ThisWorkbook.Save

End Sub

Private Sub CommandButton6_Click()
Unload Me
ACCUEIL.Show vbModeless
End Sub

Private Sub Image1_Click()
Unload Me
Application.Visible = True
End Sub

Private Sub TextBox1_Change()
Sheets("param").Range("C3").Value = TextBox1.Value
End Sub

Private Sub TextBox2_Change()
Sheets("param").Range("C5").Value = TextBox2.Value
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub


Private Sub UserForm_Initialize()
TextBox1.Value = Sheets("param").Range("C3").Value
TextBox2.Value = Sheets("param").Range("C5").Value


ComboBox1.ColumnCount = 1
ComboBox1.List() = Array("Premier", "Deuxi|fffd|me", "Troisi|fffd|me", "Quatri|fffd|me", "Cinqui|fffd|me", "Sixi|fffd|me", "Septi|fffd|me", "Huiti|fffd|me", "Neuvi|fffd|me", "Dixi|fffd|me")

ComboBox1.Value = Sheets("param").Range("C7").Value
End Sub
Attribute VB_Name = "QUITTANCE"
Attribute VB_Base = "0{B1576F59-3436-47E1-9F0B-77D48F4657C7}{4F549CDB-E550-4BE4-9A17-2A427A3A247B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Change()
Set ws = Sheets("LOCATAIRES")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox1.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox1.ListIndex + 2
 Me.ComboBox2 = ws.Cells(ligne, "G")
 Me.TextBox9 = ws.Cells(ligne, "N")
End Sub

Private Sub ComboBox2_Change()
Set ws = Sheets("LOGEMENTS")
' Mise |fffd| jour 1er encadr|fffd|
 Dim ligne As Long
 
 
 If Me.ComboBox2.ListIndex = -1 Then Exit Sub
 ligne = Me.ComboBox2.ListIndex + 2

 Me.TextBox6 = ws.Cells(ligne, "Q")
 Me.TextBox7 = ws.Cells(ligne, "R")

End Sub

Private Sub CommandButton1_Click()
If ComboBox1.Value = "" Or ComboBox2.Value = "" Or TextBox3.Value = "" Or TextBox4.Value = "" Or TextBox8.Value = "" Or TextBox6.Value = "" Or TextBox7.Value = "" Then
MsgBox "Veuillez renseigner toutes les informations afin de valider la quittance de loyer."
Exit Sub
End If

If MsgBox("Cette action va g|fffd|n|fffd|rer la quittance de loyer et effectuer l'enregistrement du loyer. Etes-vous s|fffd|r de vouloir continuer ?", vbYesNo + vbQuestion, "G|fffd|n|fffd|ration") = vbYes Then

Sheets("QUITTANCES").Range("D9").Value = ComboBox2.Value
Sheets("QUITTANCES").Range("E17").Value = ComboBox1.Value
Sheets("QUITTANCES").Range("C21").Value = Format(TextBox3.Value, "mm/dd/yyyy")
Sheets("QUITTANCES").Range("E21").Value = Format(TextBox4.Value, "mm/dd/yyyy")
Sheets("QUITTANCES").Range("E27").Value = CDbl(TextBox6.Value)
Sheets("QUITTANCES").Range("E29").Value = CDbl(TextBox7.Value)
Sheets("QUITTANCES").Range("D33").Value = Format(TextBox8.Value, "mm/dd/yyyy")

'ICI INSERER LE CODE POUR LA MISE A JOUR BASE DE DONNEES DES LOYERS PERCUS*****************
Sheets("BDD_LOYERS").Select
Dim derligne As Long
derligne = Sheets("BDD_LOYERS").Range("A65536").End(xlUp).Row + 1
Sheets("BDD_LOYERS").Range("A" & derligne).Value = ComboBox2.Value
Sheets("BDD_LOYERS").Range("B" & derligne).Value = ComboBox1.Value
Sheets("BDD_LOYERS").Range("C" & derligne).Value = Format(TextBox3.Value, "mm/dd/yyyy")
Sheets("BDD_LOYERS").Range("D" & derligne).Value = Format(TextBox4.Value, "mm/dd/yyyy")
Sheets("BDD_LOYERS").Range("E" & derligne).Value = "=MONTH(RC[-2])"
Sheets("BDD_LOYERS").Range("F" & derligne).Value = "=YEAR(RC[-3])"
Sheets("BDD_LOYERS").Range("G" & derligne).Value = Format(TextBox8.Value, "mm/dd/yyyy")
Sheets("BDD_LOYERS").Range("H" & derligne).Value = CDbl(TextBox6.Value)
Sheets("BDD_LOYERS").Range("I" & derligne).Value = CDbl(TextBox7.Value)
Sheets("BDD_LOYERS").Range("J" & derligne).Value = "=RC[-2]+RC[-1]"





'ICI FIN DU CODE POUR LA MISE A JOUR BASE DE DONNEES DES LOYERS PERCUS*********************


Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = TextBox9.Value & "QUITTANCES\"

If fs.FolderExists(nom) Then
Else: fs.CreateFolder nom
End If
Set fs = Nothing


Sheets("QUITTANCES").Select

 Dim LaDate As String, Lenom As String, LeRep As String, Livraison As String
    LaDate = Format(Date, "yyyymmdd")
    Lenom = Sheets("quittances").Range("E17").Value
    Livraison = Sheets("quittances").Range("E6").Value & "-" & Sheets("quittances").Range("H6").Value
    LeRep = nom
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, From:=1, To:=1, OpenAfterPublish:=False
    
    ThisWorkbook.FollowHyperlink LeRep & Livraison & "_" & Lenom & "_" & LaDate & ".pdf"
    
    
    Sheets("quittances").Select
    Sheets("quittances").Range("D9").Select
    Selection.ClearContents
    Sheets("quittances").Range("E17").Select
    Selection.ClearContents
    Sheets("quittances").Range("C21").Select
    Selection.ClearContents
    Sheets("quittances").Range("E21").Select
    Selection.ClearContents
    Sheets("quittances").Range("E27").Select
    Selection.ClearContents
    Sheets("quittances").Range("E29").Select
    Selection.ClearContents
    Sheets("quittances").Range("D33").Select
    Selection.ClearContents
    
    MsgBox "Quittance G|fffd|n|fffd|r|fffd|e."
    
    Unload Me
    QUITTANCE.Show vbModeless
    
    
    End If
    

End Sub

Private Sub CommandButton4_Click()
Unload Me
ACCUEIL.Show vbModeless
End Sub

Private Sub TextBox3_Afterupdate()
TextBox3.Value = Format(TextBox3, "dd/mm/yyyy")

End Sub
Private Sub Textbox3_change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox3.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox3.Value = TextBox3.Value & "/"
End Sub

Private Sub TextBox4_Afterupdate()
TextBox4.Value = Format(TextBox4, "dd/mm/yyyy")

End Sub
Private Sub Textbox4_change()
On Error Resume Next
Dim Valeur As Byte
Valeur = Len(TextBox4.Value)
If Valeur = 2 Or Valeur = 5 Then TextBox4.Value = TextBox4.Value & "/"
End Sub

Private Sub TextBox6_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890-.,", Chr(KeyAscii)) = 0 Then KeyAscii = 0
 If KeyAscii = 46 Then KeyAscii = 44
End Sub


Private Sub TextBox6_Afterupdate()
TextBox6.Value = Format(TextBox6.Value, "###.00 |fffd|")
End Sub
Private Sub textbox7_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
If InStr("1234567890-.,", Chr(KeyAscii)) = 0 Then KeyAscii = 0
 If KeyAscii = 46 Then KeyAscii = 44
End Sub


Private Sub TextBox7_Afterupdate()
TextBox7.Value = Format(TextBox7.Value, "###.00 |fffd|")
End Sub



Private Sub UserForm_Initialize()

Set ws = Sheets("LOGEMENTS")
    With Me.ComboBox2
  For J = 2 To ws.Range("B" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("B" & J)
  Next J
  End With
  
  Set ws = Sheets("LOCATAIRES")
    With Me.ComboBox1
  For J = 2 To ws.Range("A" & Rows.Count).End(xlUp).Row
  .AddItem ws.Range("A" & J)
  Next J
  End With
TextBox8.Value = Format(Now, "dd/mm/yyyy")

End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then
Cancel = True
End If
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub workbook_open()

Application.Visible = False

Dim UT As String
UT = Environ("USERNAME")
Sheets("param").Select
Sheets("PARAM").Range("IU1").Value = UT



If Sheets("PARAM").Range("IV1").Value = "" Then
Sheets("PARAM").Range("IV1").Value = Sheets("param").Range("IU1").Value
End If

If Sheets("param").Range("IV1").Value = Sheets("param").Range("IU1").Value Then

Dim fs As Object

Set fs = CreateObject("Scripting.FileSystemObject")
Dim nom As String
nom = "IMPOTS"

If fs.FolderExists(ThisWorkbook.Path & "\" & nom & "\") Then
Else: fs.CreateFolder ThisWorkbook.Path & "\" & nom & "\"
End If
Set fs = Nothing

Application.Visible = False
ACCUEIL.Show vbModeless

Sheets("recap_loyers").Select
Sheets("recap_loyers").Range("B9").Select
Selection.ClearContents
Sheets("recap_loyers").Range("D11").Select
Selection.ClearContents

Else

AUTORISATION.Show
End If



End Sub


INQUEST-PP=macro
