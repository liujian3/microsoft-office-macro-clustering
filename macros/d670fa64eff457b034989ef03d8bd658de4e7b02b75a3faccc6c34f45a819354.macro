Attribute VB_Name = "H|fffd|rok1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmbFirmy, 1, 0, MSForms, ComboBox"
Attribute VB_Control = "cmbKraj, 2, 1, MSForms, ComboBox"
Attribute VB_Control = "cmbOkres, 3, 2, MSForms, ComboBox"
Attribute VB_Control = "cmbObec, 4, 3, MSForms, ComboBox"
Attribute VB_Control = "cmbKatuz, 5, 4, MSForms, ComboBox"
Attribute VB_Control = "cmbPristroje, 6, 5, MSForms, ComboBox"
Attribute VB_Control = "btn4, 39, 6, MSForms, CommandButton"
Attribute VB_Control = "btnHladatKU, 38, 7, MSForms, CommandButton"
Attribute VB_Control = "btn7, 37, 8, MSForms, CommandButton"
Attribute VB_Control = "btn6, 36, 9, MSForms, CommandButton"
Attribute VB_Control = "btn5, 35, 10, MSForms, CommandButton"
Attribute VB_Control = "btn3, 34, 11, MSForms, CommandButton"
Attribute VB_Control = "chbEmail, 13, 12, MSForms, CheckBox"
Attribute VB_Control = "chbSumyVv, 14, 13, MSForms, CheckBox"
Attribute VB_Control = "chbPrazdne, 15, 14, MSForms, CheckBox"
Attribute VB_Control = "chbVB, 16, 15, MSForms, CheckBox"
Attribute VB_Control = "cmbFPU, 17, 16, MSForms, CommandButton"
Attribute VB_Control = "cmbNastavenia, 18, 17, MSForms, CommandButton"
Attribute VB_Control = "btnExportNastavenia, 19, 18, MSForms, CommandButton"
Attribute VB_Control = "btn2, 33, 19, MSForms, CommandButton"
Attribute VB_Control = "Label1, 21, 20, MSForms, Label"
Attribute VB_Control = "Label2, 22, 21, MSForms, Label"
Attribute VB_Control = "btn1, 32, 22, MSForms, CommandButton"
Attribute VB_Control = "ListVisible, 24, 23, MSForms, ListBox"
Attribute VB_Control = "ListHide, 25, 24, MSForms, ListBox"
Attribute VB_Control = "btnListHide, 26, 25, MSForms, CommandButton"
Attribute VB_Control = "btnListVisible, 27, 26, MSForms, CommandButton"
Attribute VB_Control = "cmbHranice, 28, 27, MSForms, ComboBox"
Attribute VB_Control = "cmbMeral, 29, 28, MSForms, ComboBox"
Attribute VB_Control = "cmbVyhotovil, 30, 29, MSForms, ComboBox"
Attribute VB_Control = "cmbOverovatel, 31, 30, MSForms, ComboBox"
Attribute VB_Control = "cmbGPSmeno, 40, 31, MSForms, ComboBox"
Attribute VB_Control = "cmbDatumVyhotovil, 43, 32, MSForms, CommandButton"
Attribute VB_Control = "cmbDatumOveril, 44, 33, MSForms, CommandButton"
Attribute VB_Control = "cmbDatumPridelene, 50, 34, MSForms, CommandButton"
Attribute VB_Control = "cmbDatumMeral, 48, 35, MSForms, CommandButton"
Attribute VB_Control = "chbG1, 47, 36, MSForms, CheckBox"
Private Sub btn1_Click()
 firmy
End Sub

Private Sub btn2_Click()
 pristroje
End Sub

Private Sub btn3_Click()
 frm_GPS.Show
End Sub

Private Sub btn4_Click()
 hranice
End Sub

Private Sub btn5_Click()
 meral
End Sub

Private Sub btn6_Click()
 vyhotovil
End Sub

Private Sub btn7_Click()
 overovatelia
End Sub

Private Sub cmbDatumMeral_Click()
 Cells(19, 4) = Upravit_Datum(Cells(19, 4).Text)
End Sub

Private Sub cmbDatumPridelene_Click()
 Cells(12, 4) = Upravit_Datum(Cells(12, 4).Text)
End Sub

Private Sub cmbDatumVyhotovil_Click()
 Cells(21, 4) = Upravit_Datum(Cells(21, 4).Text)
End Sub

Private Sub cmbDatumOveril_Click()
 Cells(23, 4) = Upravit_Datum(Cells(23, 4).Text)
End Sub

Private Sub cmbKraj_Click()
Dim i As Integer

With Sheets("KU")
 Sheets("exp_imp").Cells(3, 10) = 0

  For i = 3 To Sheets("exp_imp").Cells(2, 10)
   If .Cells(i, 1) = cmbKraj.Text Then
    If Sheets("exp_imp").Cells(3, 10) = 0 Then Sheets("exp_imp").Cells(3, 10) = i
    If Sheets("exp_imp").Cells(3, 10) <> 0 Then Sheets("exp_imp").Cells(3, 11) = i
   End If
  Next i

End With

With cmbOkres
  .Clear
  .AddItem Sheets("KU").Cells(Sheets("exp_imp").Cells(3, 10), 2)

  For i = Sheets("exp_imp").Cells(3, 10) + 1 To Sheets("exp_imp").Cells(3, 11)
   If Sheets("KU").Cells(i, 2) <> Sheets("KU").Cells(i - 1, 2) Then .AddItem Sheets("KU").Cells(i, 2)
  Next i

  If cmbKraj.Text <> Sheets("exp_imp").Cells(1, 2) Then .ListIndex = 0
  Sheets("exp_imp").Cells(1, 2) = cmbKraj.Text
 
End With

  Sheets("Vstup").Cells(4, 5).Select
End Sub

Private Sub cmbNastavenia_Click()
 firmy
End Sub

Private Sub cmbOkres_Click()
Dim i As Integer

If Sheets("exp_imp").Cells(3, 10) <> 0 Then
  With cmbOkres
   Sheets("exp_imp").Cells(4, 10) = 0

   For i = Sheets("exp_imp").Cells(3, 10) To Sheets("exp_imp").Cells(3, 11)
    If Sheets("KU").Cells(i, 2) = .Text Then
     If Sheets("exp_imp").Cells(4, 10) = 0 Then Sheets("exp_imp").Cells(4, 10) = i
     If Sheets("exp_imp").Cells(4, 10) <> 0 Then Sheets("exp_imp").Cells(4, 11) = i
    End If
   Next i

  End With

  With cmbObec
   .Clear
   .AddItem Sheets("KU").Cells(Sheets("exp_imp").Cells(4, 10), 4)

   For i = Sheets("exp_imp").Cells(4, 10) + 1 To Sheets("exp_imp").Cells(4, 11)
    If Sheets("KU").Cells(i, 4) <> Sheets("KU").Cells(i - 1, 4) Then .AddItem Sheets("KU").Cells(i, 4)
   Next i

   If cmbOkres.Text <> Sheets("exp_imp").Cells(2, 2) Then .ListIndex = 0

   Sheets("exp_imp").Cells(2, 2) = cmbOkres.Text
   Sheets("exp_imp").Cells(3, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(4, 10), 3)
  End With

End If
End Sub

Private Sub cmbObec_Click()
Dim i As Integer

If Sheets("exp_imp").Cells(4, 10) <> 0 Then
  With cmbObec
   Sheets("exp_imp").Cells(5, 10) = 0

   For i = Sheets("exp_imp").Cells(4, 10) To Sheets("exp_imp").Cells(4, 11)
    If Sheets("KU").Cells(i, 4) = .Text Then
     If Sheets("exp_imp").Cells(5, 10) = 0 Then Sheets("exp_imp").Cells(5, 10) = i
     If Sheets("exp_imp").Cells(5, 10) <> 0 Then Sheets("exp_imp").Cells(5, 11) = i
    End If
   Next i

  End With

  With cmbKatuz
   .Clear
   .AddItem Sheets("KU").Cells(Sheets("exp_imp").Cells(5, 10), 6)

   For i = Sheets("exp_imp").Cells(5, 10) + 1 To Sheets("exp_imp").Cells(5, 11)
    If Sheets("KU").Cells(i, 6) <> Sheets("KU").Cells(i - 1, 6) Then .AddItem Sheets("KU").Cells(i, 6)
   Next i

   If cmbObec.Text <> Sheets("exp_imp").Cells(4, 2) Then .ListIndex = 0

   Sheets("exp_imp").Cells(4, 2) = cmbObec.Text

  End With

End If

  Sheets("Vstup").Cells(6, 5).Select

End Sub

Private Sub cmbKatuz_Change()
Dim i As Integer

Sheets("exp_imp").Cells(5, 2) = cmbKatuz.Text

 For i = Sheets("exp_imp").Cells(5, 10) To Sheets("exp_imp").Cells(5, 11)
  If Sheets("KU").Cells(i, 6) = Sheets("exp_imp").Cells(5, 2) Then
   Sheets("exp_imp").Cells(6, 2) = Sheets("KU").Cells(i, 5)
   Sheets("exp_imp").Cells(7, 2) = Sheets("KU").Cells(i, 7)
   Sheets("exp_imp").Cells(12, 2) = Sheets("KU").Cells(i, 8)
  End If
 Next i

 If Sheets("exp_imp").Cells(7, 2) = "" Then Sheets("Vstup").Cells(8, 4) = "Zadaj skratku KU"
 If Sheets("exp_imp").Cells(7, 2) <> "" Then Sheets("Vstup").Cells(8, 4) = Sheets("exp_imp").Cells(7, 2).Text

  Sheets("Vstup").Cells(7, 5).Select
End Sub

Private Sub cmbFirmy_Click()
Dim i As Integer
Dim j As Integer
Dim k As Integer

With Sheets("Nastavenia")
  i = 12
  j = 1
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        If cmbFirmy.Text = .Cells(i, j).Text Then
          For k = 1 To 10
            Sheets("exp_imp").Cells(k + 1, 4) = .Cells(i, k)
          Next k
        End If
    End If
  Loop
End With


With Sheets("Tabulka_GP")
 i = 0
 Do
    i = i + 1
    If .Cells(i, 1) = "Vyhotovil" Then
        Exit Do
    Else
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(2, 4).Text Then
            .Cells(i, 1).Font.Size = 13
            .Cells(i, 1).Font.Bold = True
        End If
  
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(3, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(4, 4).Text & " " & Sheets("exp_imp").Cells(5, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(7, 4).Text & " " & Sheets("exp_imp").Cells(6, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If
    End If
 Loop
End With

Dim vyhotovil As Boolean

With Sheets("Tabulka_GP_VvA")
 i = 0
 vyhotovil = False
 Do
    i = i + 1
    If .Cells(i, 1) = "Vyhotovil" Then
        Exit Do
    Else
       If .Cells(i, 1) = " Vyhotovite|fffd|" Then vyhotovil = True
       If vyhotovil = True Then
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(2, 4).Text Then
            .Cells(i, 1).Font.Size = 13
            .Cells(i, 1).Font.Bold = True
        End If
  
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(3, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(4, 4).Text & " " & Sheets("exp_imp").Cells(5, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(7, 4).Text & " " & Sheets("exp_imp").Cells(6, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If
       End If
    End If
 Loop
End With


With Sheets("Tabulka_GP_VvA_A3")
 i = 0
 vyhotovil = False
 Do
    i = i + 1
    If .Cells(i, 1) = "Vyhotovil" Then
        Exit Do
    Else
       If .Cells(i, 1) = " Vyhotovite|fffd|" Then vyhotovil = True
       If vyhotovil = True Then
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(2, 4).Text Then
            .Cells(i, 1).Font.Size = 13
            .Cells(i, 1).Font.Bold = True
        End If
  
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(3, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(4, 4).Text & " " & Sheets("exp_imp").Cells(5, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(7, 4).Text & " " & Sheets("exp_imp").Cells(6, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If
       End If
    End If
 Loop
End With


With Sheets("Tabulka_Vytycovaci_nacrt")
 i = 0
 Do
    i = i + 1
    If .Cells(i, 1) = "Vyhotovil" Then
        Exit Do
    Else
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(2, 4).Text Then
            .Cells(i, 1).Font.Size = 13
            .Cells(i, 1).Font.Bold = True
        End If
  
        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(3, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(4, 4).Text & " " & Sheets("exp_imp").Cells(5, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If

        If .Cells(i, 1).Text = Sheets("exp_imp").Cells(7, 4).Text & " " & Sheets("exp_imp").Cells(6, 4).Text Then
            .Cells(i, 1).Font.Size = 10
            .Cells(i, 1).Font.Bold = False
        End If
    End If
 Loop
End With

End Sub

Private Sub cmbPristroje_Click()
  Sheets("exp_imp").Cells(1, 6) = cmbPristroje.Text
End Sub

Private Sub cmbGPSmeno_Click()
  Sheets("exp_imp").Cells(2, 6) = cmbGPSmeno.Text
End Sub

Private Sub cmbHranice_Click()
  Sheets("exp_imp").Cells(3, 6) = cmbHranice.Text
End Sub

Private Sub cmbMeral_Click()
  Sheets("exp_imp").Cells(4, 6) = cmbMeral.Text
End Sub

Private Sub cmbVyhotovil_Click()
Dim i As Integer

Sheets("exp_imp").Cells(5, 6) = cmbVyhotovil.Text

With Sheets("Nastavenia")
i = 12
 Do
    i = i + 1
    If .Cells(i, 22) = "" Then
        Exit Do
    Else
        If cmbVyhotovil.Text = .Cells(i, 22).Text Then
            Sheets("exp_imp").Cells(9, 6) = "email:" & .Cells(i, 23)
            Exit Do
        End If
    End If
 Loop
End With
End Sub

Private Sub cmbOverovatel_Click()
Dim i As Integer
Dim j As Integer

With Sheets("Nastavenia")
i = 12
 Do
    i = i + 1
    If .Cells(i, 18) = "" Then
        Exit Do
    Else
        If cmbOverovatel.Text = .Cells(i, 18).Text Then
            For j = 12 To 18
                Sheets("exp_imp").Cells(j - 10, 8) = .Cells(i, j)
            Next j
            Exit Do
        End If
    End If
 Loop
End With
End Sub

Private Sub chbEmail_Click()
    If chbEmail.Value = True Then Sheets("exp_imp").Cells(8, 6) = "ano" Else Sheets("exp_imp").Cells(8, 6) = "nie"
    cmbFirmy_Click
End Sub

Private Sub btnListHide_Click()
    If ListVisible.ListIndex <> -1 Then
        Sheets(ListVisible.Value).Visible = False
        ListyViditelne
    End If
End Sub

Private Sub btnListVisible_Click()
    If ListHide.ListIndex <> -1 Then
        Sheets(ListHide.Value).Visible = True
        ListyViditelne
    End If
End Sub

Private Sub chbG1_Click()
 If chbG1.Value = True Then Sheets("exp_imp").Cells(20, 4) = "Ano" Else Sheets("exp_imp").Cells(20, 4) = "Nie"
End Sub

Private Sub Label1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If Sheets("Vstup").Cells(2, 6) = "Stano" Then
      Sheets("Vstup").Rows("14:18").Select
      Selection.EntireRow.Hidden = False
      Sheets("Vstup").cmbGPSmeno.Top = 291
      Sheets("Vstup").cmbGPSmeno.Visible = True
      Sheets("Vstup").btn3.Top = 291
      Sheets("Vstup").btn3.Visible = True
    End If
End Sub

Private Sub ListHide_Click()
    Dim riadok As Integer
    Dim stlpec As Integer
        riadok = ActiveCell.Row
        stlpec = ActiveCell.Column
        On Error Resume Next
        Cells(11, 6).Select
End Sub

Private Sub ListHide_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim riadok As Integer
Dim stlpec As Integer
    riadok = ActiveCell.Row
    stlpec = ActiveCell.Column
    btnListVisible_Click
    On Error Resume Next
    Cells(11, 6).Select
End Sub

Private Sub ListVisible_Click()
Dim riadok As Integer
Dim stlpec As Integer

If ActiveSheet.Name = "Vstup" Then
 riadok = ActiveCell.Row
 stlpec = ActiveCell.Column
 On Error Resume Next
 Cells(11, 6).Select
End If
End Sub

Private Sub ListVisible_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim riadok As Integer
Dim stlpec As Integer
    riadok = ActiveCell.Row
    stlpec = ActiveCell.Column
    btnListHide_Click
    On Error Resume Next
    Cells(11, 6).Select
End Sub

Private Sub Worksheet_Activate()
ManualneZadanie
    DeAktivaciaMenu
    AktivaciaMenu
    
If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
 Sheets("Vstup").cmbFPU.Caption = "Pripoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF00&
Else
 Sheets("Vstup").cmbFPU.Caption = "Odpoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF&
End If

End Sub

Private Sub Worksheet_Deactivate()
    ManualneZadanie
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
ManualneZadanie
If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
 Sheets("Vstup").cmbFPU.Caption = "Pripoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF00&
Else
 Sheets("Vstup").cmbFPU.Caption = "Odpoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF&
End If

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
ManualneZadanie

If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
 Sheets("Vstup").cmbFPU.Caption = "Pripoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF00&
Else
 Sheets("Vstup").cmbFPU.Caption = "Odpoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF&
End If

End Sub

Private Sub btnExportNastavenia_Click()
    frm_ExpImp.Show
End Sub

Private Sub btnHladatKU_Click()
 frm_Hladat_KU.Show
End Sub

Private Sub cmbFPU_Click()
 frm_FPU_pripojit.Show
End Sub

Attribute VB_Name = "H|fffd|rok10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
Dim i As Integer
Dim j As Integer
Dim je As Integer

With Sheets("Vstup")
       
 i = 12
 j = 1
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbFirmy.Text Then je = 1
  End If
 Loop
 If je = 0 Then Sheets("exp_imp").Cells(2, 4) = ""

 i = 18
 j = 29
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbGPSmeno.Text Then je = 1
  End If
 Loop
 If je = 0 Then Sheets("exp_imp").Cells(2, 6) = ""
    
 i = 12
 j = 18
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbOverovatel.Text Then je = 1
  End If
 Loop
 If je = 0 Then Sheets("exp_imp").Cells(8, 8) = ""
 
 
 i = 12
 j = 25
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbPristroje.Text Then je = 1
  End If
 Loop
 If je = 0 Then .cmbPristroje.Text = Sheets("Nastavenia").Cells(13, j)
    
 
 i = 12
 j = 27
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbHranice.Text Then je = 1
  End If
 Loop
 If je = 0 Then .cmbHranice.Text = Sheets("Nastavenia").Cells(13, j)
 
 i = 12
 j = 20
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbMeral.Text Then je = 1
  End If
 Loop
 If je = 0 Then .cmbMeral.Text = Sheets("Nastavenia").Cells(13, j)
    
 i = 12
 j = 22
 je = 0
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, j) = "" Then
   Exit Do
  Else
   If Sheets("Nastavenia").Cells(i, j) = .cmbVyhotovil.Text Then je = 1
  End If
 Loop
 If je = 0 Then .cmbVyhotovil.Text = Sheets("Nastavenia").Cells(13, j)

End With

NACITANIE_CMB
   Sheets("Nastavenia").Visible = xlSheetVeryHidden
End Sub


Attribute VB_Name = "H|fffd|rok18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btnNacitatVlastnikov, 1, 0, MSForms, CommandButton"
Private Sub btnNacitatVlastnikov_Click()
  Cells(19, 4).Select
  nacitat_z_vv
End Sub

Private Sub Worksheet_Activate()
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
  DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  DeAktivaciaMenu
  AktivaciaMenu
  frmVlastnici.cmbVlozit.Caption = "Vlo|fffd|i|fffd| od bunky " + ActiveCell.Address
End Sub




Attribute VB_Name = "H|fffd|rok2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
  DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  DeAktivaciaMenu
  AktivaciaMenu
End Sub

Attribute VB_Name = "H|fffd|rok20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Deactivate()
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 DeAktivaciaMenu
 AktivaciaMenu
End Sub

Private Sub Worksheet_Activate()
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Attribute VB_Name = "H|fffd|rok21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
  DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  DeAktivaciaMenu
  AktivaciaMenu
End Sub



Attribute VB_Name = "H|fffd|rok24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "vlozitPC, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "cmbUlozit, 2, 1, MSForms, CommandButton"
Private Sub cmbUlozit_Click()
Dim i As Integer
Dim pocet_riadkov As Integer
Dim Poznamky_OD As Integer

pocet_riadkov = pocet_riadkov_List("Prehlad_poznamok")

With Sheets("poznamky_XML")

  For i = 3 To .Cells(1, 1)
   .Cells(i, 1) = ""
   .Cells(i, 2) = ""
   .Cells(i, 3) = ""
   .Cells(i, 4) = ""
  Next i

  For i = 1 To pocet_riadkov
    If Cells(i, 1) = "DS / NS" Then
     Poznamky_OD = i + 1
     Exit For
    End If
  Next i
  
  For i = Poznamky_OD To pocet_riadkov
   If Cells(i, 1) <> "" Then
    .Cells(.Cells(1, 1) + 1, 1).Value = Cells(i, 1).Value
    .Cells(.Cells(1, 1), 2).Value = Cells(i, 2).Value
    .Cells(.Cells(1, 1), 3).Value = Cells(i, 3).Value
    .Cells(.Cells(1, 1), 4).Value = Cells(i, 4).Value
   End If
  Next i

End With

With Sheets("poznamky")

  For i = 3 To .Cells(1, 3)
   .Cells(i, 1) = ""
   .Cells(i, 2) = ""
  Next i

  For i = 1 To pocet_riadkov
    If Cells(i, 12) = "Predvolen|fffd|/Navrhovan|fffd| pozn|fffd|mky:" Then
     Poznamky_OD = i + 1
     Exit For
    End If
  Next i
  
  For i = Poznamky_OD To pocet_riadkov
   If Cells(i, 12) <> "" Or Cells(i, 13) <> "" Then
    .Cells(.Cells(1, 3) + 1, 1).Value = Cells(i, 12).Value
    .Cells(.Cells(1, 3), 2).Value = Cells(i, 13).Value
   End If
  Next i

End With

Sheets(Sheets("exp_imp").Cells(10, 2).Text).Select
Sheets("Prehlad_poznamok").Visible = xlSheetVeryHidden

End Sub

Private Sub vlozitPC_Click()
Dim i As Integer
Dim pocet_riadkov As Integer
Dim Poznamky_OD As Integer

 Sheets("exp_imp").Cells(12, 2) = "Poznamky"
 Sheets(Sheets("exp_imp").Cells(10, 2).Text).Select
 XML False
 Sheets("exp_imp").Cells(12, 2) = ""
 Sheets("Prehlad_poznamok").Select

pocet_riadkov = pocet_riadkov_List("Prehlad_poznamok")

For i = 1 To pocet_riadkov
 If Cells(i, 1) <> "" Or Cells(i, 2) <> "" Or Cells(i, 4) <> "" Then Poznamky_OD = i
Next i
   
With Sheets("XML")
  For i = 2 To .Cells(1, 1)
    Cells(Poznamky_OD + 1, 1).Value = .Cells(i, 1).Value
    Cells(Poznamky_OD + 1, 2).Value = .Cells(i, 2).Value
    Cells(Poznamky_OD + 1, 3).Value = .Cells(i, 3).Value
    Poznamky_OD = Poznamky_OD + 1
  Next i
End With

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "H|fffd|rok27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
  DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  DeAktivaciaMenu
  AktivaciaMenu
End Sub

Attribute VB_Name = "H|fffd|rok29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btnPoznamky, 5, 0, MSForms, CommandButton"
Attribute VB_Control = "cmbVymery, 14, 1, MSForms, CommandButton"
Attribute VB_Control = "cmbLegenda, 7, 2, MSForms, CommandButton"
Attribute VB_Control = "cmbXML, 8, 3, MSForms, CommandButton"
Private Sub cmbVymery_Click()
 Uprava_Sumy
End Sub

Private Sub Worksheet_Activate()
    Nazvy_stlpcov (ActiveSheet.Name)
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
If Sheets("exp_imp").Cells(18, 3) = "ano" Then
 Sheets("exp_imp").Cells(18, 3) = "nie"
 Sheets("exp_imp").Cells(18, 4) = "nie"
 Sheets("poznamky").Cells(5, 21) = ""
 frm_Poznamky.Hide
End If
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 If Sheets("exp_imp").Cells(18, 3) = "ano" Then Poznamky
 DeAktivaciaMenu
 AktivaciaMenu
 If frmVymera.Visible = True Then odpocet_siahy odkial:="HM_odpocet", co:="Vv"
 Odstranit_DP
 Aktualizovat_DP_vo_VV
' Uprava_Sumy
 FPU_vyhladat
End Sub

Private Sub btnPoznamky_Click()
 Poznamky_spustit
End Sub

Private Sub btnVlozitRiadok_Click()
 Vlozit_riadok
End Sub

Private Sub cmbXML_Click()
    XML (True)
End Sub

Private Sub cmbLegenda_Click()
 Legenda False
End Sub



Attribute VB_Name = "H|fffd|rok4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btnPoznamky, 6, 1, MSForms, CommandButton"
Attribute VB_Control = "btnVlozitRiadok, 7, 2, MSForms, CommandButton"
Attribute VB_Control = "cmbLegenda, 8, 3, MSForms, CommandButton"
Attribute VB_Control = "cmbXML, 9, 4, MSForms, CommandButton"
Attribute VB_Control = "cmbVymery, 13, 5, MSForms, CommandButton"
Private Sub cmbVymery_Click()
 Uprava_Sumy
End Sub

Private Sub Worksheet_Activate()
    Nazvy_stlpcov (ActiveSheet.Name)
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
If Sheets("exp_imp").Cells(18, 3) = "ano" Then
 Sheets("exp_imp").Cells(18, 3) = "nie"
 Sheets("exp_imp").Cells(18, 4) = "nie"
 Sheets("poznamky").Cells(5, 21) = ""
 frm_Poznamky.Hide
End If
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 If Sheets("exp_imp").Cells(18, 3) = "ano" Then Poznamky
 DeAktivaciaMenu
 AktivaciaMenu
 If frmVymera.Visible = True Then odpocet_siahy odkial:="HM_odpocet", co:="Vv"
 Odstranit_DP
 Aktualizovat_DP_vo_VV
' Uprava_Sumy
 FPU_vyhladat
End Sub

Private Sub btnPoznamky_Click()
 Poznamky_spustit
End Sub

Private Sub btnVlozitRiadok_Click()
 Vlozit_riadok
End Sub

Private Sub cmbXML_Click()
    XML (True)
End Sub

Private Sub cmbLegenda_Click()
 Legenda False
End Sub



Attribute VB_Name = "H|fffd|rok5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btnPoznamky, 5, 0, MSForms, CommandButton"
Attribute VB_Control = "cmbLegenda, 6, 1, MSForms, CommandButton"
Attribute VB_Control = "cmbXML, 7, 2, MSForms, CommandButton"
Attribute VB_Control = "cmbVymery, 9, 3, MSForms, CommandButton"
Private Sub cmbVymery_Click()
 Uprava_Sumy
End Sub

Private Sub Worksheet_Activate()
    Nazvy_stlpcov (ActiveSheet.Name)
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
If Sheets("exp_imp").Cells(18, 3) = "ano" Then
 Sheets("exp_imp").Cells(18, 3) = "nie"
 Sheets("exp_imp").Cells(18, 4) = "nie"
 Sheets("poznamky").Cells(5, 21) = ""
 frm_Poznamky.Hide
End If
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 If Sheets("exp_imp").Cells(18, 3) = "ano" Then Poznamky
 DeAktivaciaMenu
 AktivaciaMenu
 If frmVymera.Visible = True Then odpocet_siahy odkial:="HM_odpocet", co:="Vv"
 Odstranit_DP
 Aktualizovat_DP_vo_VV
' Uprava_Sumy
 FPU_vyhladat
End Sub

Private Sub btnPoznamky_Click()
 Poznamky_spustit
End Sub

Private Sub btnVlozitRiadok_Click()
 Vlozit_riadok
End Sub

Private Sub cmbXML_Click()
    XML (True)
End Sub

Private Sub cmbLegenda_Click()
 Legenda True
End Sub



Attribute VB_Name = "H|fffd|rok6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btnPoznamky, 6, 0, MSForms, CommandButton"
Attribute VB_Control = "cmbLegenda, 7, 1, MSForms, CommandButton"
Attribute VB_Control = "cmbXML, 8, 2, MSForms, CommandButton"
Attribute VB_Control = "cmbVymery, 14, 4, MSForms, CommandButton"
Private Sub cmbVymery_Click()
 Uprava_Sumy
End Sub

Private Sub Worksheet_Activate()
    Nazvy_stlpcov (ActiveSheet.Name)
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
If Sheets("exp_imp").Cells(18, 3) = "ano" Then
 Sheets("exp_imp").Cells(18, 3) = "nie"
 Sheets("exp_imp").Cells(18, 4) = "nie"
 Sheets("poznamky").Cells(5, 21) = ""
 frm_Poznamky.Hide
End If
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 If Sheets("exp_imp").Cells(18, 3) = "ano" Then Poznamky
 DeAktivaciaMenu
 AktivaciaMenu
 If frmVymera.Visible = True Then odpocet_siahy odkial:="HM_odpocet", co:="Vv"
 Odstranit_DP
 Aktualizovat_DP_vo_VV
' Uprava_Sumy
 FPU_vyhladat
End Sub

Private Sub btnPoznamky_Click()
 Poznamky_spustit
End Sub

Private Sub btnVlozitRiadok_Click()
 Vlozit_riadok
End Sub

Private Sub cmbXML_Click()
    XML (True)
End Sub

Private Sub cmbLegenda_Click()
 Legenda True
End Sub


Attribute VB_Name = "H|fffd|rok7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btnPoznamky, 5, 0, MSForms, CommandButton"
Attribute VB_Control = "btnVlozitRiadok, 6, 1, MSForms, CommandButton"
Attribute VB_Control = "cmbLegenda, 7, 2, MSForms, CommandButton"
Attribute VB_Control = "cmbXML, 8, 3, MSForms, CommandButton"
Attribute VB_Control = "cmbVymery, 10, 4, MSForms, CommandButton"
Private Sub cmbVymery_Click()
 Uprava_Sumy
End Sub

Private Sub Worksheet_Activate()
    Nazvy_stlpcov (ActiveSheet.Name)
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
If Sheets("exp_imp").Cells(18, 3) = "ano" Then
 Sheets("exp_imp").Cells(18, 3) = "nie"
 Sheets("exp_imp").Cells(18, 4) = "nie"
 Sheets("poznamky").Cells(5, 21) = ""
 frm_Poznamky.Hide
End If
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 If Sheets("exp_imp").Cells(18, 3) = "ano" Then Poznamky
 DeAktivaciaMenu
 AktivaciaMenu
 If frmVymera.Visible = True Then odpocet_siahy odkial:="HM_odpocet", co:="Vv"
 Odstranit_DP
 Aktualizovat_DP_vo_VV
' Uprava_Sumy
 FPU_vyhladat
End Sub

Private Sub btnPoznamky_Click()
 Poznamky_spustit
End Sub

Private Sub btnVlozitRiadok_Click()
 Vlozit_riadok
End Sub

Private Sub cmbXML_Click()
    XML (True)
End Sub

Private Sub cmbLegenda_Click()
 Legenda False
End Sub

Attribute VB_Name = "H|fffd|rok8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    DeAktivaciaMenu
    AktivaciaMenu
End Sub

Private Sub Worksheet_Deactivate()
 DeAktivaciaMenu
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 DeAktivaciaMenu
 AktivaciaMenu
End Sub

Attribute VB_Name = "H|fffd|rok9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Deactivate()
 DeAktivaciaMenu
End Sub

Private Sub Workbook_Open()
  
  DeAktivaciaMenu
  Sheets("Vstup").Select
      
 If Sheets("Vstup").Cells(2, 6) = "Stano" Or Sheets("Vstup").Cells(2, 6) = "GeosK" Then
  Sheets("Vstup").Rows("14:18").Select
  Selection.EntireRow.Hidden = False
  Sheets("Vstup").cmbGPSmeno.Top = 291
  Sheets("Vstup").cmbGPSmeno.Left = 152
  Sheets("Vstup").cmbGPSmeno.Visible = True
  Sheets("Vstup").btn3.Top = 291
  Sheets("Vstup").btn3.Left = Sheets("Vstup").btn2.Left
  Sheets("Vstup").btn3.Visible = True
    
  KATUZ_nacitanie
  NACITANIE_CMB
    
  ListyViditelne
    
  Sheets("exp_imp").Cells(18, 3) = "nie"
    
  Sheets("Vstup").Select
    
  Sheets("Vstup").Cells(3, 4).Select
  DeAktivaciaMenu
 Else
  Vitajte.Show
  DeAktivaciaMenu
 End If

End Sub

Attribute VB_Name = "Vitajte"
Attribute VB_Base = "0{CF548D4D-FBD0-435F-9900-EAC5908776DD}{C33BCB90-48FE-4460-ACE9-7570035BF288}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub cmbClose_Click()
 
    If Sheets("Vstup").Cells(2, 6) = "Stano" Then
      Sheets("Vstup").Rows("14:18").Select
      Selection.EntireRow.Hidden = False
      Sheets("Vstup").cmbGPSmeno.Top = 291
      Sheets("Vstup").cmbGPSmeno.Visible = True
      Sheets("Vstup").btn3.Top = 291
      Sheets("Vstup").btn3.Visible = True
    Else
      Sheets("Vstup").cmbGPSmeno.Visible = False
      Sheets("Vstup").cmbGPSmeno.Top = 0
      Sheets("Vstup").btn3.Top = 0
      Sheets("Vstup").btn3.Visible = False
      Sheets("Vstup").Rows("15:16").EntireRow.Hidden = True
    End If
    
    KATUZ_nacitanie
    NACITANIE_CMB
    
    ListyViditelne
    
    Sheets("exp_imp").Cells(18, 3) = "nie"
    
    Sheets("Vstup").Select
    
    Sheets("Vstup").Cells(3, 4).Select
    
    Vitajte.Hide
    
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    
    If Sheets("Vstup").Cells(2, 6) = "Stano" Then
      Sheets("Vstup").Rows("14:18").Select
      Selection.EntireRow.Hidden = False
      Sheets("Vstup").cmbGPSmeno.Top = 291
      Sheets("Vstup").cmbGPSmeno.Visible = True
      Sheets("Vstup").btn3.Top = 291
      Sheets("Vstup").btn3.Visible = True
    Else
      Sheets("Vstup").cmbGPSmeno.Visible = False
      Sheets("Vstup").cmbGPSmeno.Top = 0
      Sheets("Vstup").btn3.Top = 0
      Sheets("Vstup").btn3.Visible = False
      Sheets("Vstup").Rows("15:16").EntireRow.Hidden = True
    End If
    
    KATUZ_nacitanie
    NACITANIE_CMB
    
    ListyViditelne
    
    Sheets("exp_imp").Cells(18, 3) = "nie"
    
    Sheets("Vstup").Select
    
    Sheets("Vstup").Cells(3, 4).Select
    
 Vitajte.Hide
End Sub
Attribute VB_Name = "frmChyby"
Attribute VB_Base = "0{D6EE91F8-841C-4045-B7AA-13615B1C5F3D}{D310BCB4-8397-4475-9BA8-65D6B9250BCD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub ok_chyby_Click()
    frmChyby.Hide
    XML (True)
End Sub

Private Sub UserForm_Activate()
Dim i As Integer

lbChyby.Clear

With Sheets("xml")

 For i = 2 To .Cells(1, 100) + 5
  If .Cells(i, 100) <> "" Then
   lbChyby.AddItem .Cells(i, 99).Text & " - " & .Cells(i, 100).Text
  End If
 Next i

 .Visible = False
End With
      
End Sub


Private Sub lbChyby_Click()
Dim i As Integer

With Sheets("xml")
'' For i = 2 To .Cells(1, 100) + 5
''  If .Cells(i, 99).Text & " - " & .Cells(i, 100) = lbChyby.Text Then Cells(.Cells(i, 101), .Cells(i, 102)).Select
'' Next i
    i = lbChyby.ListIndex + 2
    Cells(.Cells(i, 101), .Cells(i, 102)).Select
End With

End Sub

Private Sub lbChyby_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim i As Integer

With Sheets("xml")
 For i = 2 To .Cells(1, 100) + 5
  If .Cells(i, 99).Text & " - " & .Cells(i, 100) = lbChyby.Text Then
   Cells(.Cells(i, 101), .Cells(i, 102)).Select
   Selection.Interior.ColorIndex = 3
  End If
 Next i
End With

End Sub
Attribute VB_Name = "frmPriklad"
Attribute VB_Base = "0{121F3725-0E24-474C-9629-D79FCAC05675}{D809304E-3711-42FF-A62E-0BA2C5BFC515}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub cmbKoniec_Click()
 frmPriklad.Hide
End Sub

Private Sub UserForm_Activate()
With lbPriklad
    .Clear
    .AddItem " udaje za znakmi /* sa nepisu, to je len popis"
    .AddItem "&GPS    /* Zaciatok ulohy - Body merane metodou GPS"
    .AddItem "2510885001  301909.55 1175889.77  0.00  1"
    .AddItem "2510885002  301975.26 1175889.37  0.00  1"
    .AddItem "..."
    .AddItem "-1    /* Koniec ulohy"
    .AddItem "&11    /* Zaciatok ulohy - Polarna metoda. Rovnako je &12 - Volne stanovisko"
    .AddItem "1425485001 305285.07 1176469.14 S     /* Stanovisko"
    .AddItem "1425485002 305134.11 1176414.45 O    /* Orientacia"
    .AddItem "1425485003 305222.22 1176354.18 O    /* Orientacia"
    .AddItem "1425480001 305758.47 1176322.11       /* Podrobny bod"
    .AddItem "1425480002 305747.67 1176348.56       /* Podrobny bod"
    .AddItem "..."
    .AddItem "-1    /* Koniec ulohy"
    .AddItem "&21    /* Zaciatok ulohy - Priesecnik priamok."
    .AddItem "1425480258"
    .AddItem "1425480259"
    .AddItem "1425480230"
    .AddItem "1425480231"
    .AddItem "1425480432"
    .AddItem "-1    /* Koniec ulohy"
    .AddItem "&03    /* Zaciatok ulohy - Priesecnik priamok."
    .AddItem "1425480234 0.00"
    .AddItem "1425480005 1.25"
    .AddItem "1425480236 1.16"
    .AddItem "-1    /* Koniec ulohy"
    .AddItem "&PROJEKT-OVER    /* Zaciatok ulohy - Projektovane body na priamke"
    .AddItem "1425480115"
    .AddItem "1425480116"
    .AddItem "1425480425"
    .AddItem "-1    /* Koniec ulohy"
End With

With lbPriklad2
    .Clear
    .AddItem "&GPS"
    .AddItem "2510885001  301909.55 1175889.77  0.00  1"
    .AddItem "2510885002  301975.26 1175889.37  0.00  1"
    .AddItem "-1"
    .AddItem "&11"
    .AddItem "1425485001 305285.07 1176469.14 S"
    .AddItem "1425485002 305134.11 1176414.45 O"
    .AddItem "1425485003 305222.22 1176354.18 O"
    .AddItem "1425480001 305758.47 1176322.11"
    .AddItem "1425480002 305747.67 1176348.56"
    .AddItem "-1"
    .AddItem "&21"
    .AddItem "1425480258"
    .AddItem "1425480259"
    .AddItem "1425480230"
    .AddItem "1425480231"
    .AddItem "1425480432"
    .AddItem "-1"
    .AddItem "&03"
    .AddItem "1425480234 0.00"
    .AddItem "1425480005 1.25"
    .AddItem "1425480236 1.16"
    .AddItem "-1"
    .AddItem "&PROJEKT-OVER"
    .AddItem "1425480115"
    .AddItem "1425480116"
    .AddItem "1425480425"
    .AddItem "-1"
End With
End Sub

Private Sub save_Priklad_Click()
Dim retazec As String
Dim i As Integer

retazec = ""
For i = 0 To lbPriklad2.ListCount - 1
    lbPriklad2.ListIndex = i
    If retazec = "" Then retazec = lbPriklad2.Text Else retazec = retazec & vbCrLf & lbPriklad2.Text
Next i
   
   If retazec <> "" Then
     Open Sheets("exp_imp").Cells(8, 1).Text & "_Meracka_priklad.txt" For Output As #1
     Print #1, retazec
     Close #1
     MsgBox "Pr|fffd|klad mera|fffd|ky je ulo|fffd|en|fffd| v adres|fffd|ri, kde s|fffd| ulo|fffd|en|fffd| Tabulky " & vbCrLf & Sheets("exp_imp").Cells(8, 1).Text & "_Meracka_priklad.txt"
   Else
     MsgBox "Nie je |fffd|o ulo|fffd|i|fffd|. :-)"
   End If
   
lbPriklad2.ListIndex = -1
End Sub

Attribute VB_Name = "frmVGI"
Attribute VB_Base = "0{1BD1CB53-BF15-452C-B850-7317BC230BA7}{58162E69-3242-4DD3-B031-FFC6794172B9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Sub doplnenie_odpocet()
Dim i As Integer

lbAll.Clear
lbOdpocet.Clear
With Sheets("XML")
 For i = 2 To .Cells(1, 1)
  If .Cells(i, 1) = "PARCELA_NS" And .Cells(i, 2) = "1" Then
   If .Cells(i, 8) = "odpocet" Then lbOdpocet.AddItem .Cells(i, 3) Else lbAll.AddItem .Cells(i, 3)
  End If
 Next i
End With
End Sub

Private Sub delCKNstxNove_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 31 To 50
  .Columns(i).Clear
 Next i
 For i = 71 To 92
  .Columns(i).Clear
 Next i
 .Cells(1, 71) = 1
 .Cells(1, 72) = "Zoznam bodov z VGImt Dane"
 .Cells(1, 81) = 1
 .Cells(1, 82) = "Kartometricke"
 .Cells(1, 87) = 1
 .Cells(1, 88) = "Projektovane"
 delCKNstxNove.Visible = False
 lblCKNstx.Caption = "nepripojen|fffd|"
 delCKNstx.Visible = False
 lblCKNp.Caption = "nepripojen|fffd|"
 delCKNp.Visible = False
 EditovatSTX.Visible = False
End With
cmbNacitatCKNstx.Enabled = True
cmbNacitatCKNstxNOVE.Enabled = True
ChybyVGI
End Sub

Private Sub lbAll_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim i As Integer

If lbAll.ListIndex <> -1 Then
 With Sheets("XML")
  For i = 2 To .Cells(1, 1)
   If .Cells(i, 1) = "PARCELA_NS" And .Cells(i, 2) = "1" Then
    If .Cells(i, 3) = lbAll.Text Then .Cells(i, 8) = "odpocet"
   End If
  Next i
 End With
 doplnenie_odpocet
End If
End Sub

Private Sub lbOdpocet_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim i As Integer

If lbOdpocet.ListIndex <> -1 Then
 With Sheets("XML")
  For i = 2 To .Cells(1, 1)
   If .Cells(i, 1) = "PARCELA_NS" Then
    If .Cells(i, 3) = lbOdpocet.Text Then .Cells(i, 8) = ""
   End If
  Next i
 End With
 doplnenie_odpocet
End If
End Sub

Private Sub infoOdpocet_Click()
MsgBox "V pravom zozname s|fffd| parcely, ktor|fffd|ch v|fffd|mera bude ur|fffd|en|fffd| odpo|fffd|tom." & vbCrLf & vbCrLf & _
        "V zoznamoch sa parcely pres|fffd|vaj|fffd| dvojklikom. " & vbCrLf & vbCrLf & _
        "Ak vo v|fffd|kaze v|fffd|mer sa nap|fffd|e do bunky za st|fffd|pec ""P|fffd|vodn|fffd| sp|fffd|sob vyu|fffd||fffd|vania... (Vo VvA je to st|fffd|pec U)"" a riadku, kde je parc.|fffd|., p|fffd|smeno x," & vbCrLf & _
        "tak pri vytv|fffd|ran|fffd| zoznamu bude bra|fffd| parcelu ako ur|fffd|en|fffd| odpo|fffd|tom a nebude ju treba odklik|fffd|va|fffd| tu"
End Sub

Private Sub infoMeracka_Click()
    frmPriklad.Show
End Sub

Private Sub UserForm_Activate()
Dim i As Integer
       
doplnenie_odpocet
ChybyVGI
If Sheets("exp_imp").Cells(11, 1) = "VGPm" Then VGPm.Value = True Else VGPmt.Value = True

With Sheets("NacitanieVGI")
 
 If .Cells(2, 1) <> "" Then
  lblCKNm.Caption = Dir(.Cells(2, 1).Text)
  delCKNm.Visible = True
  cmbNacitatCKNm.Enabled = False
 Else
  lblCKNm.Caption = "nepripojen|fffd|"
  delCKNm.Visible = False
  cmbNacitatCKNm.Enabled = True
 End If
 
 If .Cells(2, 11) <> "" Then
  lblCKNt.Caption = Dir(.Cells(2, 11).Text)
  delCKNt.Visible = True
  cmbNacitatCKNt.Enabled = False
 Else
  lblCKNt.Caption = "nepripojen|fffd|"
  delCKNt.Visible = False
  cmbNacitatCKNt.Enabled = True
 End If
 
 If .Cells(2, 21) <> "" Then
  lblEKN.Caption = Dir(.Cells(2, 21).Text)
  delEKN.Visible = True
  cmbNacitatEKN.Enabled = False
 Else
  lblEKN.Caption = "nepripojen|fffd|"
  delEKN.Visible = False
  cmbNacitatEKN.Enabled = True
 End If
 
 If .Cells(2, 31) <> "" Then
  lblCKNp.Caption = Dir(.Cells(2, 31).Text)
  delCKNp.Visible = True
  cmbNacitatCKNp.Enabled = False
  cmbNacitatCKNstxNOVE.Enabled = False
  EditovatSTX.Visible = True
 Else
  lblCKNp.Caption = "nepripojen|fffd|"
  delCKNp.Visible = False
  cmbNacitatCKNp.Enabled = True
  cmbNacitatCKNstxNOVE.Enabled = True
  EditovatSTX.Visible = False
 End If
     
 If .Cells(2, 41) <> "" Then
  lblCKNstx.Caption = Dir(.Cells(2, 41).Text)
''  delCKNstx.Visible = True
  delCKNstxNove.Visible = True
  cmbNacitatCKNstx.Enabled = False
  cmbNacitatCKNstxNOVE.Enabled = False
 Else
  lblCKNstx.Caption = "nepripojen|fffd|"
  delCKNstx.Visible = False
  delCKNstxNove.Visible = False
  cmbNacitatCKNstx.Enabled = True
  cmbNacitatCKNstxNOVE.Enabled = True
 End If
 
 If .Cells(2, 51) <> "" Then
  lblMeracka.Caption = Dir(.Cells(2, 51))
  delMeracka.Visible = True
  cmbNacitatMeracka.Enabled = False
 Else
  lblMeracka.Caption = "nepripojen|fffd|"
  delMeracka.Visible = False
  cmbNacitatMeracka.Enabled = True
 End If
End With

End Sub

Private Sub cmbNacitatCKNm_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer

With Sheets("NacitanieVGI")
 aktualny_popis = lblCKNm.Caption
 lblCKNm.Caption = "moment"
 lblCKNm.ForeColor = &HFF&
 pom_cesta = .Cells(2, 1)
 .Cells(2, 1) = ""
 
 Import_VGI ("CKNm")
 
 If .Cells(2, 1) <> "" Then
  SpracovanieVGI "CKNm"
  cmbNacitatCKNm.Enabled = False
 Else
  .Cells(2, 1) = pom_cesta
 End If
 If .Cells(2, 1) <> "" Then _
          lblCKNm.Caption = Dir(.Cells(2, 1)) Else _
          lblCKNm.Caption = aktualny_popis
        
 lblCKNm.ForeColor = &HFF0000
End With
End Sub

Private Sub delCKNm_Click()
Dim i As Integer
Dim Aktivny_zosit As String

 Aktivny_zosit = ActiveSheet.Name

 With Sheets("NacitanieVGI")
  For i = 1 To 10
   .Columns(i).Clear
  Next i
  For i = 61 To 80
   .Columns(i).Clear
  Next i
  lblCKNm.Caption = "nepripojen|fffd|"
  delCKNm.Visible = False
 End With

 cmbNacitatCKNm.Enabled = True
 ChybyVGI

End Sub

Private Sub cmbNacitatCKNt_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer

With Sheets("NacitanieVGI")
 aktualny_popis = lblCKNt.Caption
 lblCKNt.Caption = "moment"
 lblCKNt.ForeColor = &HFF&
 pom_cesta = .Cells(2, 11)
 .Cells(2, 11) = ""
 
 Import_VGI ("CKNt")
 
 If .Cells(2, 11) <> "" Then
  SpracovanieVGI "CKNt"
  cmbNacitatCKNt.Enabled = False
 Else
  .Cells(2, 11) = pom_cesta
 End If
 If .Cells(2, 11) <> "" Then _
          lblCKNt.Caption = Dir(.Cells(2, 11)) Else _
          lblCKNt.Caption = aktualny_popis
        
 lblCKNt.ForeColor = &HFF0000
End With
End Sub

Private Sub delCKNt_Click()
Dim i As Integer
Dim Aktivny_zosit As String

 Aktivny_zosit = ActiveSheet.Name

 With Sheets("NacitanieVGI")
  For i = 11 To 20
   .Columns(i).Clear
  Next i
  lblCKNt.Caption = "nepripojen|fffd|"
  delCKNt.Visible = False
 End With

 cmbNacitatCKNt.Enabled = True
 ChybyVGI
End Sub

Private Sub cmbNacitatEKN_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer

With Sheets("NacitanieVGI")
 aktualny_popis = lblEKN.Caption
 lblEKN.Caption = "moment"
 lblEKN.ForeColor = &HFF&
 pom_cesta = .Cells(2, 21)
 .Cells(2, 21) = ""
 
 Import_VGI ("EKN")
 
 If .Cells(2, 21) <> "" Then
  SpracovanieVGI "EKN"
  cmbNacitatEKN.Enabled = False
 Else
  .Cells(2, 21) = pom_cesta
 End If
 If .Cells(2, 21) <> "" Then _
          lblEKN.Caption = Dir(.Cells(2, 21)) Else _
          lblEKN.Caption = aktualny_popis
        
 lblEKN.ForeColor = &HFF0000
End With
End Sub

Private Sub delEKN_Click()
Dim i As Integer
Dim Aktivny_zosit As String

 Aktivny_zosit = ActiveSheet.Name

 With Sheets("NacitanieVGI")
  For i = 21 To 30
   .Columns(i).Clear
  Next i
  lblEKN.Caption = "nepripojen|fffd|"
  delEKN.Visible = False
 End With

 cmbNacitatEKN.Enabled = True
 ChybyVGI
End Sub
Private Sub cmbNacitatCKNstxNOVE_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer

With Sheets("NacitanieVGI")
 aktualny_popis = lblCKNp.Caption
 lblCKNp.Caption = "moment"
 lblCKNp.ForeColor = &HFF&
 pom_cesta = .Cells(2, 31)
 .Cells(2, 31) = ""
 
 Import_VGI ("CKNstxNove")
       
 If .Cells(2, 31) <> "" Then cmbNacitatCKNp.Enabled = False Else .Cells(2, 31) = pom_cesta
 If .Cells(2, 31) <> "" Then lblCKNp.Caption = Dir(.Cells(2, 31)) Else lblCKNp.Caption = aktualny_popis
       
 On Error Resume Next
 For i = 4 To .Cells(1, 31)
  .Cells(i, 32) = vyber_prvku(.Cells(i, 31), 1, " ")
  .Cells(i, 33) = vyber_prvku(.Cells(i, 31), 2, " ")
  .Cells(i, 34) = vyber_prvku(.Cells(i, 31), 3, " ")
  .Cells(i, 35) = vyber_prvku(.Cells(i, 31), 5, " ")
  If .Cells(i, 35) = "" Then .Cells(i, 35) = vyber_prvku(.Cells(3, 31), -1, " ")
  If .Cells(i, 35) <> vyber_prvku(.Cells(i, 31), -1, " ") Then .Cells(i, 36) = vyber_prvku(.Cells(i, 31), -1, " ")
 Next i

 Sheets("NacitanieVGI").Columns(31).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(32).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(33).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(34).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(35).EntireColumn.AutoFit

 lblCKNp.ForeColor = &HFF0000
End With


With Sheets("NacitanieVGI")
            
 If .Cells(2, 41) <> "" Then
  On Error Resume Next
  For i = 4 To .Cells(1, 41)
   .Cells(i, 42) = vyber_prvku(.Cells(i, 41), 1, " ")
   .Cells(i, 46) = vyber_prvku(.Cells(i, 41), 2, " ")
   .Cells(i, 47) = vyber_prvku(.Cells(i, 41), 3, " ")
   .Cells(i, 48) = vyber_prvku(.Cells(i, 41), 5, " ")
   If .Cells(i, 48) = "" Then .Cells(i, 48) = vyber_prvku(.Cells(3, 41), -1, " ")
   If .Cells(i, 48) <> vyber_prvku(.Cells(i, 41), -1, " ") Then .Cells(i, 49) = vyber_prvku(.Cells(i, 41), -1, " ")
   
   For j = 4 To .Cells(1, 31)
    If .Cells(i, 42) = .Cells(j, 32) Then
     .Cells(i, 43) = .Cells(j, 33)
     .Cells(i, 44) = .Cells(j, 34)
     .Cells(i, 45) = .Cells(j, 35)
     Exit For
    End If
   Next j
   For j = 2 To .Cells(1, 61)
    If .Cells(i, 42) = .Cells(j, 61) Then
     .Cells(i, 43) = .Cells(j, 62).Value
     .Cells(i, 44) = .Cells(j, 63).Value
     .Cells(i, 45) = .Cells(j, 64).Value
     Exit For
    End If
   Next j
   
'   If frmVGI.VGPmt.Value = True Then
    Dim ZPMZ As Integer
    Dim ZPMZvgi As Integer
    Dim Bod_VGPmt_existuje As Boolean
    ZPMZ = Sheets("vstup").Cells(10, 4)
    ZPMZvgi = Mid(.Cells(i, 42), 3, 4)
    Bod_VGPmt_existuje = False
    
    If ZPMZvgi <> ZPMZ Then
     For j = 2 To .Cells(1, 71)
      If .Cells(i, 42) = .Cells(j, 71) Then Bod_VGPmt_existuje = True
     Next j
     If Bod_VGPmt_existuje = False Then
      .Cells(.Cells(1, 71) + 1, 71) = .Cells(i, 42)
      .Cells(.Cells(1, 71) + 1, 72) = .Cells(i, 43)
      .Cells(.Cells(1, 71) + 1, 73) = .Cells(i, 44)
      .Cells(.Cells(1, 71) + 1, 74) = .Cells(i, 45)
      .Cells(1, 71) = .Cells(1, 71) + 1
     End If
    End If
    
    
    
    If ZPMZvgi = ZPMZ Then
     If .Cells(1, 81) < 1 Then
      .Cells(1, 81) = 1
      .Cells(1, 82) = "Kartometricke"
     End If
     If .Cells(1, 87) < 1 Then
      .Cells(1, 87) = 1
      .Cells(1, 88) = "Projektovane"
     End If
     ''Vybrat Kartometricke
     If .Cells(i, 49) = "K" Then
      .Cells(.Cells(1, 81) + 1, 81) = .Cells(i, 42)
      .Cells(.Cells(1, 81) + 1, 82) = .Cells(i, 43)
      .Cells(.Cells(1, 81) + 1, 83) = .Cells(i, 44)
      .Cells(.Cells(1, 81) + 1, 84) = .Cells(i, 45)
      .Cells(.Cells(1, 81) + 1, 85) = .Cells(i, 49)
      .Cells(1, 81) = .Cells(1, 81) + 1
     End If
     ''Vybrat Projektovane
     If .Cells(i, 49) = "P" Then
      .Cells(.Cells(1, 87) + 1, 87) = .Cells(i, 42)
      .Cells(.Cells(1, 87) + 1, 88) = .Cells(i, 43)
      .Cells(.Cells(1, 87) + 1, 89) = .Cells(i, 44)
      .Cells(.Cells(1, 87) + 1, 90) = .Cells(i, 45)
      .Cells(.Cells(1, 87) + 1, 91) = .Cells(i, 49)
      .Cells(1, 87) = .Cells(1, 87) + 1
     End If
    End If
    
  
  Next i
''  Sheets("NacitanieVGI").Columns(42).EntireColumn.AutoFit
''  Sheets("NacitanieVGI").Columns(43).EntireColumn.AutoFit
''  Sheets("NacitanieVGI").Columns(44).EntireColumn.AutoFit
''  Sheets("NacitanieVGI").Columns(45).EntireColumn.AutoFit
''  Sheets("NacitanieVGI").Columns(46).EntireColumn.AutoFit
''  Sheets("NacitanieVGI").Columns(47).EntireColumn.AutoFit
''  Sheets("NacitanieVGI").Columns(48).EntireColumn.AutoFit
  

  cmbNacitatCKNstx.Enabled = False
  cmbNacitatCKNstxNOVE.Enabled = False
  EditovatSTX.Visible = True
 Else
  .Cells(2, 41) = pom_cesta
 End If
 If .Cells(2, 41) <> "" Then _
          lblCKNstx.Caption = Dir(.Cells(2, 41)) Else _
          lblCKNstx.Caption = aktualny_popis
          
 lblCKNstx.ForeColor = &HFF0000
End With

End Sub

Private Sub cmbNacitatCKNp_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer

With Sheets("NacitanieVGI")
 aktualny_popis = lblCKNp.Caption
 lblCKNp.Caption = "moment"
 lblCKNp.ForeColor = &HFF&
 pom_cesta = .Cells(2, 31)
 .Cells(2, 31) = ""
       
 Import_VGI ("CKNp")
       
 If .Cells(2, 31) <> "" Then cmbNacitatCKNp.Enabled = False Else .Cells(2, 31) = pom_cesta
 If .Cells(2, 31) <> "" Then lblCKNp.Caption = Dir(.Cells(2, 31)) Else lblCKNp.Caption = aktualny_popis
       
 On Error Resume Next
 For i = 4 To .Cells(1, 31)
  .Cells(i, 32) = vyber_prvku(.Cells(i, 31), 1, " ")
  .Cells(i, 33) = vyber_prvku(.Cells(i, 31), 2, " ")
  .Cells(i, 34) = vyber_prvku(.Cells(i, 31), 3, " ")
  .Cells(i, 35) = vyber_prvku(.Cells(i, 31), 5, " ")
  If .Cells(i, 35) = "" Then .Cells(i, 35) = vyber_prvku(.Cells(3, 31), -1, " ")
 Next i

 Sheets("NacitanieVGI").Columns(31).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(32).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(33).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(34).EntireColumn.AutoFit
 Sheets("NacitanieVGI").Columns(35).EntireColumn.AutoFit

 lblCKNp.ForeColor = &HFF0000
End With
End Sub

Private Sub delCKNp_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 31 To 40
  .Columns(i).Clear
 Next i
 lblCKNp.Caption = "nepripojen|fffd|"
 delCKNp.Visible = False
End With
cmbNacitatCKNp.Enabled = True
ChybyVGI
End Sub

Private Sub cmbNacitatCKNstx_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer

With Sheets("NacitanieVGI")
 aktualny_popis = lblCKNstx.Caption
 lblCKNstx.Caption = "moment"
 lblCKNstx.ForeColor = &HFF&
 pom_cesta = .Cells(2, 41)
 .Cells(2, 41) = ""
  
 Import_VGI ("CKNstx")
            
 If .Cells(2, 41) <> "" Then
  On Error Resume Next
  For i = 4 To .Cells(1, 41)
   .Cells(i, 42) = vyber_prvku(.Cells(i, 41), 1, " ")
   .Cells(i, 46) = vyber_prvku(.Cells(i, 41), 2, " ")
   .Cells(i, 47) = vyber_prvku(.Cells(i, 41), 3, " ")
   .Cells(i, 48) = vyber_prvku(.Cells(i, 41), 5, " ")
   If .Cells(i, 48) = "" Then .Cells(i, 48) = vyber_prvku(.Cells(3, 41), -1, " ")
   
   For j = 4 To .Cells(1, 31)
    If .Cells(i, 42) = .Cells(j, 32) Then
     .Cells(i, 43) = .Cells(j, 33)
     .Cells(i, 44) = .Cells(j, 34)
     .Cells(i, 45) = .Cells(j, 35)
     Exit For
    End If
   Next j
   For j = 2 To .Cells(1, 61)
    If .Cells(i, 42) = .Cells(j, 61) Then
     .Cells(i, 43) = .Cells(j, 62).Value
     .Cells(i, 44) = .Cells(j, 63).Value
     .Cells(i, 45) = .Cells(j, 64).Value
     Exit For
    End If
   Next j
   
'   If frmVGI.VGPmt.Value = True Then
    Dim ZPMZ As Integer
    Dim ZPMZvgi As Integer
    Dim Bod_VGPmt_existuje As Boolean
    ZPMZ = Sheets("vstup").Cells(10, 4)
    ZPMZvgi = Mid(.Cells(i, 42), 3, 4)
    Bod_VGPmt_existuje = False
    
    If ZPMZvgi <> ZPMZ Then
     For j = 2 To .Cells(1, 71)
      If .Cells(i, 42) = .Cells(j, 71) Then Bod_VGPmt_existuje = True
     Next j
     If Bod_VGPmt_existuje = False Then
      .Cells(.Cells(1, 71) + 1, 71) = .Cells(i, 42)
      .Cells(.Cells(1, 71) + 1, 72) = .Cells(i, 43)
      .Cells(.Cells(1, 71) + 1, 73) = .Cells(i, 44)
      .Cells(.Cells(1, 71) + 1, 74) = .Cells(i, 45)
      .Cells(1, 71) = .Cells(1, 71) + 1
     End If
    End If
'   End If
   
  Next i
  Sheets("NacitanieVGI").Columns(42).EntireColumn.AutoFit
  Sheets("NacitanieVGI").Columns(43).EntireColumn.AutoFit
  Sheets("NacitanieVGI").Columns(44).EntireColumn.AutoFit
  Sheets("NacitanieVGI").Columns(45).EntireColumn.AutoFit
  Sheets("NacitanieVGI").Columns(46).EntireColumn.AutoFit
  Sheets("NacitanieVGI").Columns(47).EntireColumn.AutoFit
  Sheets("NacitanieVGI").Columns(48).EntireColumn.AutoFit
  

  cmbNacitatCKNstx.Enabled = False
 Else
  .Cells(2, 41) = pom_cesta
 End If
 If .Cells(2, 41) <> "" Then _
          lblCKNstx.Caption = Dir(.Cells(2, 41)) Else _
          lblCKNstx.Caption = aktualny_popis
          
 lblCKNstx.ForeColor = &HFF0000
End With
End Sub

Private Sub delCKNstx_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 41 To 50
  .Columns(i).Clear
 Next i
 lblCKNstx.Caption = "nepripojen|fffd|"
 delCKNstx.Visible = False
End With
cmbNacitatCKNstx.Enabled = True
ChybyVGI
End Sub

Private Sub cmbNacitatMeracka_Click()
Dim pom_cesta As String
Dim aktualny_popis As String
       
With Sheets("NacitanieVGI")
 aktualny_popis = lblMeracka.Caption
 lblMeracka.Caption = "moment"
 lblMeracka.ForeColor = &HFF&
 pom_cesta = .Cells(2, 51)
 
 cmbNacitatMeracku_Click

 If .Cells(2, 51) <> "" Then
  lblMeracka.Caption = Dir(.Cells(2, 51))
  delMeracka.Visible = True
 Else
  lblMeracka.Caption = "nepripojen|fffd|"
  cmbNacitatMeracku.Caption = "Na|fffd||fffd|ta|fffd| mera|fffd|ku"
  delMeracka.Visible = False
 End If

 lblMeracka.ForeColor = &HFF0000
 If .Cells(2, 51) <> "" Then cmbNacitatMeracka.Enabled = False
End With
End Sub

Private Sub delMeracka_Click()
Dim i As Integer
Dim Aktivny_zosit As String

 Aktivny_zosit = ActiveSheet.Name

 With Sheets("NacitanieVGI")
  For i = 51 To 60
   .Columns(i).Clear
  Next i
  lblMeracka.Caption = "nepripojen|fffd|"
  delMeracka.Visible = False
  cmbNacitatMeracku.Caption = "Na|fffd||fffd|ta|fffd| mera|fffd|ku"
 End With
 cmbNacitatMeracka.Enabled = True
End Sub

Private Sub cmbNacitatMeracku_Click()
Dim aktualny_popis As String
Dim pom_cesta As String
Dim i As Integer
Dim j As Integer
Dim Aktivny_zosit As String

Dim deltaY As Double
Dim deltaX As Double
Dim Y1 As Double
Dim X1 As Double
Dim Y2 As Double
Dim X2 As Double
Dim delta As Double
Dim d12 As Double
Dim Fi As Double
Dim Sig12 As Double
Dim meracka As String
Dim index_meracka As Integer

Dim CBexist As Boolean
Dim SuradnicePorovnanie As Boolean
Dim CisloBodu As String

Dim ZPMZ As Integer
  ZPMZ = Sheets("vstup").Cells(10, 4)

With Sheets("NacitanieVGI")
 If cmbNacitatMeracku.Caption = "Na|fffd||fffd|ta|fffd| mera|fffd|ku" Then
  aktualny_popis = cmbNacitatMeracku.Caption
  cmbNacitatMeracku.Caption = "moment"
  pom_cesta = .Cells(2, 51)
  .Cells(2, 51) = ""
  
  Import_VGI ("Meracka")
            
  If .Cells(2, 51) <> "" Then
   On Error Resume Next
   For i = 3 To .Cells(1, 51)
    If .Cells(i, 51) = "&GPS" Then
     meracka = "&GPS"
     index_meracka = i
     .Cells(i, 57) = "GPS"
     .Cells(i, 57).HorizontalAlignment = xlLeft
     .Cells(i, 57).Font.Bold = True
    End If
    If .Cells(i, 51) = "&PROJEKT-OVER" Then
     meracka = "&PROJEKT-OVER"
     index_meracka = i
     .Cells(i, 57) = "Overenie polohy bodov na priamke"
     .Cells(i, 57).HorizontalAlignment = xlLeft
     .Cells(i, 57).Font.Bold = True
    End If
    
    If .Cells(i, 51) = "&11" Or .Cells(i, 51) = "&12" Then
     meracka = "&11"
     index_meracka = i
    End If
    If .Cells(i, 51) = "&03" Then
     meracka = "&03"
     index_meracka = i
     .Cells(i, 57) = "03 - Kon|fffd|truk|fffd|n|fffd| omern|fffd| miery"
     .Cells(i, 57).HorizontalAlignment = xlLeft
     .Cells(i, 57).Font.Bold = True
    End If
    
    If .Cells(i, 51) = "-1" Then
     meracka = "-1"
     Y1 = 0
     X1 = 0
     Y2 = 0
     X2 = 0
    End If
                '' Tu je samotny vypocet
'' GPS
    If meracka = "&GPS" And .Cells(i, 51) <> "&GPS" Then
     .Cells(i, 52) = vyber_prvku(.Cells(i, 51), 1, " ")
     .Cells(i, 53) = vyber_prvku(.Cells(i, 51), 2, " ")
     .Cells(i, 54) = vyber_prvku(.Cells(i, 51), 3, " ")
     Dim ZPMZvgi As Integer
     ZPMZvgi = Mid(.Cells(i, 52), 3, 4)
     If ZPMZvgi <> ZPMZ Then
      Y1 = .Cells(i, 53)
      X1 = .Cells(i, 54)
      For j = 4 To .Cells(1, 41)
       If .Cells(j, 42) = .Cells(i, 52) Then
        Y2 = .Cells(j, 43)
        X2 = .Cells(j, 44)
        Sheets("exp_imp").Cells(9, 1) = Abs((Y2 - Y1) * (Y2 - Y1) + (X2 - X1) * (X2 - X1))
        delta = Round(Sheets("exp_imp").Cells(9, 2), 2)
        If Sheets("exp_imp").Cells(11, 1) = "VGPm" Then
         If delta < 0.24 Then
          .Cells(i, 55) = Sheets("exp_imp").Cells(10, 1) & "p=" & delta & "m  over."
          .Cells(i, 55).Font.Size = 8
         Else
          .Cells(i, 55) = Sheets("exp_imp").Cells(10, 1) & "p=" & delta & "m  neidentick|fffd|"
         End If
        Else
          .Cells(i, 55) = Sheets("exp_imp").Cells(10, 1) & "p=" & delta & "m  over."
          .Cells(i, 55).Font.Size = 8
        End If
         Exit For
       End If
      Next j
      If .Cells(i, 55) = "" Then .Cells(i, 56) = "Bod sa nenach|fffd|dza v zozname s|fffd|radn|fffd|c podkladu"
     End If
      .Cells(i, 57) = .Cells(i, 52)
      .Cells(i, 58) = .Cells(i, 53)
      .Cells(i, 59) = .Cells(i, 54)
      .Cells(i, 60) = .Cells(i, 55)
    End If
'' GPS KONIEC

'' Projektovane - overenie
 ''kontrola existujucich bodov
    
    If meracka = "&PROJEKT-OVER" And .Cells(i, 51) <> "&PROJEKT-OVER" Then
     .Cells(i, 52) = .Cells(i, 51)
     Dim jj As Double
     Dim jjExist As Boolean
     Dim Tpovodne As Integer
     jjExist = False
     
     For jj = 2 To .Cells(1, 41)
      If .Cells(i, 52) = .Cells(jj, 42) Then
       .Cells(i, 53) = .Cells(jj, 43)
       .Cells(i, 54) = .Cells(jj, 44)
       .Cells(i, 55) = .Cells(jj, 45)
       jjExist = True
''       Tpovodne = 0
       If .Cells(i - 1, 51) = "&PROJEKT-OVER" Then
        Y2 = .Cells(i, 53)
        X2 = .Cells(i, 54)
        .Cells(i, 57) = .Cells(i, 52)
          .Cells(i, 57).HorizontalAlignment = xlCenter
          .Cells(i, 57).VerticalAlignment = xlCenter
          .Cells(i, 57).Font.Bold = True
        .Cells(i, 60) = "T=" & .Cells(i, 55)
        Tpovodne = .Cells(i, 55) ''Prvy bod
        
        
          .Cells(i, 60).HorizontalAlignment = xlLeft
          .Cells(i, 60).VerticalAlignment = xlCenter
          .Cells(i, 60).Font.Bold = True
        .Cells(i + 1, 57).Font.Bold = True
        .Cells(i + 1, 58).Font.Bold = True
        .Cells(i + 1, 59).Font.Bold = True
        .Cells(i + 1, 60).Font.Bold = True
       Else
        Y1 = .Cells(i, 53)
        X1 = .Cells(i, 54)
       
        deltaY = Y2 - Y1
        deltaX = X2 - X1
        d12 = Sqr((deltaY * deltaY) + (deltaX * deltaX))
        d12 = Abs(d12)
       
        .Cells(i, 57) = .Cells(i, 52)
          .Cells(i, 57).HorizontalAlignment = xlCenter
          .Cells(i, 57).VerticalAlignment = xlCenter
        .Cells(i, 58).NumberFormat = "0.00"
        .Cells(i, 58) = d12
          .Cells(i, 58).HorizontalAlignment = xlCenter
          .Cells(i, 58).VerticalAlignment = xlCenter
        .Cells(i, 59) = "0.00"
          .Cells(i, 59).NumberFormat = "0.00"
          .Cells(i, 59).HorizontalAlignment = xlCenter
          .Cells(i, 59).VerticalAlignment = xlCenter
        .Cells(i, 60) = "T=" & .Cells(i, 55)
          .Cells(i, 60).HorizontalAlignment = xlLeft
          .Cells(i, 60).VerticalAlignment = xlCenter
        If .Cells(i - 1, 59) = "" Then
         If .Cells(i, 55) > Tpovodne Then Tpovodne = .Cells(i, 55)
        Else
         If .Cells(i, 55) <> Tpovodne Then .Cells(i, 60) = .Cells(i, 60) & "   M|fffd| by|fffd| T= " & Tpovodne
        End If
        ''.Cells(i, 61) = Tpovodne
       End If
    
      End If
     Next jj
     If jjExist = False Then
      .Cells(.Cells(2, 2), 2) = "Bod pou|fffd|it|fffd| pre v|fffd|po|fffd|et overenia projektovan|fffd|ch bodov |fffd|. " & .Cells(i, 52) & " sa nenach|fffd|dza v zozname s|fffd|radn|fffd|c"
      .Cells(2, 2) = .Cells(2, 2) + 1
      ChybyVGI
     End If
    End If
 ''kontrola existujucich bodov KONIEC
    
'' Projektovane overenie KONIEC
                '' Tu je samotny vypocet          koniec
''11ka
    If meracka = "&11" Then
     .Cells(i, 52) = vyber_prvku(.Cells(i, 51), 1, " ")
     .Cells(i, 53) = vyber_prvku(.Cells(i, 51), 2, " ")
     .Cells(i, 54) = vyber_prvku(.Cells(i, 51), 3, " ")
     Y1 = .Cells(i, 53)
     X1 = .Cells(i, 54)
     For j = 4 To .Cells(1, 41)
      ZPMZvgi = Mid(.Cells(i, 52), 3, 4)
      If .Cells(j, 42) = .Cells(i, 52) And ZPMZvgi <> ZPMZ Then
       Y2 = .Cells(j, 43)
       X2 = .Cells(j, 44)
       Sheets("exp_imp").Cells(9, 1) = Abs((Y2 - Y1) * (Y2 - Y1) + (X2 - X1) * (X2 - X1))
       delta = Round(Sheets("exp_imp").Cells(9, 2), 2)
       If Sheets("exp_imp").Cells(11, 1) = "VGPm" Then
        If delta < 0.24 Then
         .Cells(i, 55) = Sheets("exp_imp").Cells(10, 1) & "p=" & delta & "m  over."
        Else
         .Cells(i, 55) = Sheets("exp_imp").Cells(10, 1) & "p=" & delta & "m  neidentick|fffd|"
        End If
       Else
        .Cells(i, 55) = Sheets("exp_imp").Cells(10, 1) & "p=" & delta & "m  over."
       End If
       Exit For
      End If
     Next j
     
     For j = 1 To i - 2
      If .Cells(i, 52) = .Cells(j, 52) And _
         .Cells(i, 53) <> "" And _
         vyber_prvku(.Cells(i, 51), -1, " ") <> "S" And _
         vyber_prvku(.Cells(i, 51), -1, " ") <> "O" Then .Cells(i, 56) = "kontr."
     Next j
     
     Y1 = .Cells(index_meracka + 1, 53)
     X1 = .Cells(index_meracka + 1, 54)
     Y2 = .Cells(i, 53)
     X2 = .Cells(i, 54)
     
     deltaY = Y2 - Y1
     deltaX = X2 - X1
     d12 = Sqr((deltaY * deltaY) + (deltaX * deltaX))
     d12 = Abs(d12)
     
     Fi = Abs(Atn(deltaY / deltaX) * 200 / (4 * Atn(1)))  ''PI = 4 * Atn(1)
     If deltaY > 0 And deltaX > 0 Then Sig12 = Fi
     If deltaY > 0 And deltaX < 0 Then Sig12 = 200 - Fi
     If deltaY < 0 And deltaX < 0 Then Sig12 = 200 + Fi
     If deltaY < 0 And deltaX > 0 Then Sig12 = 400 - Fi
     
     .Cells(i, 57) = .Cells(i, 52)
     .Cells(i, 58) = d12
     .Cells(i, 59) = Sig12
     .Cells(i, 58).NumberFormat = "0.00"
     .Cells(i, 59).NumberFormat = "0.0000"
     .Cells(i, 57).HorizontalAlignment = xlCenter
     .Cells(i, 57).VerticalAlignment = xlCenter
     .Cells(i, 58).HorizontalAlignment = xlCenter
     .Cells(i, 58).VerticalAlignment = xlCenter
     .Cells(i, 59).HorizontalAlignment = xlCenter
     .Cells(i, 59).VerticalAlignment = xlCenter
     
     If i = index_meracka + 2 Then Sig0 = Sig12
     If Sig12 - Sig0 < 0 Then .Cells(i, 59) = Sig12 - Sig0 + 400 Else .Cells(i, 59) = Sig12 - Sig0
     If i = index_meracka Or i = index_meracka + 1 Then
      .Cells(i, 58) = ""
      .Cells(i, 59) = ""
      .Cells(i, 57).Font.Bold = True
     End If
     If i = index_meracka And .Cells(i, 51) = "&11" Then
      .Cells(i, 57) = "11 - Pol|fffd|rna met|fffd|da"
      .Cells(i, 57).HorizontalAlignment = xlLeft
      .Cells(i, 57).VerticalAlignment = xlCenter
     End If
     If i = index_meracka And .Cells(i, 51) = "&12" Then
      .Cells(i, 57) = "11 - Vo|fffd|n|fffd| stanovisko"
      .Cells(i, 57).HorizontalAlignment = xlLeft
      .Cells(i, 57).VerticalAlignment = xlCenter
     End If
     If vyber_prvku(.Cells(i, 51), -1, " ") = "O" Then
      .Cells(i, 57).Font.Bold = True
      .Cells(i, 58).Font.Bold = True
      .Cells(i, 59).Font.Bold = True
     End If
     .Cells(i, 60) = .Cells(i, 55) & " " & .Cells(i, 56)
     

    End If
''11ka KONIEC

''21ka
    If .Cells(i, 51) = "&21" Then
     Dim Kod_kvality As Integer
     Kod_kvality = 0
     meracka = "&21"
     index_meracka = i
     .Cells(i, 57) = "21 - Priese|fffd|n|fffd|k priamok"
     .Cells(i, 57).HorizontalAlignment = xlLeft
     .Cells(i, 57).Font.Bold = True
    End If
    If meracka = "&21" And i <> index_meracka Then
     .Cells(i, 57).HorizontalAlignment = xlCenter
     .Cells(i, 57).VerticalAlignment = xlCenter
     .Cells(i, 57) = .Cells(i, 51)
     For j = 4 To .Cells(1, 71)   'Ak bod nieje medzi meranymi
       If .Cells(j, 71) = .Cells(i, 51) Then
        .Cells(i, 58) = "T=" & .Cells(j, 74)
        If .Cells(j, 74) > Kod_kvality Then Kod_kvality = .Cells(j, 74)
       End If
     Next j
     For j = 4 To .Cells(1, 41)
       If .Cells(j, 42) = .Cells(i, 51) Then
        .Cells(i, 58) = "T=" & .Cells(j, 48)
        If .Cells(j, 48) > Kod_kvality Then Kod_kvality = .Cells(j, 48)
       End If
     Next j
     If i = index_meracka + 4 Then
       .Cells(i, 57).Borders(xlEdgeBottom).LineStyle = xlContinuous
       .Cells(i, 58).Borders(xlEdgeBottom).LineStyle = xlContinuous
     End If
    End If
''21ka KONIEC

''03ka
    If meracka = "&03" And .Cells(i, 51) <> "&03" Then
     .Cells(i, 52) = vyber_prvku(.Cells(i, 51), 1, " ")
     .Cells(i, 53) = vyber_prvku(.Cells(i, 51), 2, " ")
     
     .Cells(i, 57).HorizontalAlignment = xlCenter
     .Cells(i, 57).VerticalAlignment = xlCenter
     .Cells(i, 57) = .Cells(i, 52)
     .Cells(i, 58).HorizontalAlignment = xlCenter
     .Cells(i, 58).VerticalAlignment = xlCenter
     .Cells(i, 58) = .Cells(i, 53)
     .Cells(i, 58).NumberFormat = "0.00"
    End If
''03ka KONIEC
     
     
     

   Next i
   
   Sheets("NacitanieVGI").Columns(52).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(53).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(54).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(55).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(56).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(57).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(58).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(59).EntireColumn.AutoFit
   Sheets("NacitanieVGI").Columns(60).EntireColumn.AutoFit
   
   cmbNacitatMeracku.Enabled = False
  Else
   .Cells(2, 51) = pom_cesta
  End If
  If .Cells(2, 51) <> "" Then
   cmbNacitatMeracku.Caption = "Odstranit meracku"
   cmbNacitatMeracku.Enabled = True
  End If
 Else
  Aktivny_zosit = ActiveSheet.Name
  For i = 51 To 60
   Sheets("NacitanieVGI").Columns(i).Clear
  Next i
  cmbNacitatMeracku.Caption = "Na|fffd||fffd|ta|fffd| mera|fffd|ku"
 End If
End With

End Sub

Private Sub cmbVytvoritTS_Click()
Dim i As Integer
Dim j As Integer
Dim CBpodklad As String
Dim CBpodkladTP As String
Dim Ypodklad As String
Dim Xpodklad As String
Dim TPpodklad As String
Dim Xpodklad1 As String
Dim CBnove As String
Dim Ynove As String
Dim Xnove As String
Dim sur03 As String
Dim pocetGPS As Integer
Dim pocetDB03 As Integer
Dim pocetMerane As Integer
Dim PredchadzajucaUloha As Integer

Dim pocet_riadkov As Integer
pocet_riadkov = pocet_riadkov_List("Technicka_sprava")

On Error GoTo 1
Sheets("Technicka_sprava").Visible = True
Sheets("Technicka_sprava").Select
With Sheets("Technicka_sprava").Range(Sheets("Technicka_sprava").Cells(3, 1), Sheets("Technicka_sprava").Cells(pocet_riadkov, 50))
 .ClearContents
 .Borders(xlDiagonalDown).LineStyle = xlNone
 .Borders(xlDiagonalUp).LineStyle = xlNone
 .Borders(xlEdgeLeft).LineStyle = xlNone
 .Borders(xlEdgeTop).LineStyle = xlNone
 .Borders(xlEdgeBottom).LineStyle = xlNone
 .Borders(xlEdgeRight).LineStyle = xlNone
 .Borders(xlInsideVertical).LineStyle = xlNone
 .Borders(xlInsideHorizontal).LineStyle = xlNone
 .Interior.ColorIndex = xlNone
 .UnMerge
 .WrapText = False
 .NumberFormat = "0"
 .RowHeight = 12.75
 .HorizontalAlignment = xlCenter
 .Font.Bold = False
 .Font.Italic = False
 .Font.Underline = xlUnderlineStyleNone
 .Font.Name = "Arial"
 .Font.Size = 10
 .Font.Strikethrough = False
 .Font.ColorIndex = 0
End With
                                                                'ZMAZAT VSETKO V TS  koniec
With Sheets("nacitanieVGI")
 pocetDB = 7
 pocetGPS = 7
 Dim ZPMZ As Integer
 ZPMZ = Sheets("vstup").Cells(10, 4)
  
'DANE BODY
 For i = 2 To .Cells(1, 71)
  If .Cells(i, 71) <> "" Then
   Sheets("Technicka_sprava").Cells(pocetDB, 1) = .Cells(i, 71)
   Sheets("Technicka_sprava").Cells(pocetDB, 2) = .Cells(i, 72)
   Sheets("Technicka_sprava").Cells(pocetDB, 2).NumberFormat = "0.00"
   Sheets("Technicka_sprava").Cells(pocetDB, 3) = .Cells(i, 73)
   Sheets("Technicka_sprava").Cells(pocetDB, 3).NumberFormat = "0.00"
   Sheets("Technicka_sprava").Cells(pocetDB, 4) = .Cells(i, 74)
   pocetDB = pocetDB + 1
  End If
 Next i
'DANE BODYkoniec
 
PredchadzajucaUloha = pocetDB

''KARTOMETRICKE A PROJEKTOVANE
 Dim PocetKart As Integer
 If .Cells(1, 81) > 1 Then
  PocetKart = PredchadzajucaUloha + 3
  For i = 2 To .Cells(1, 81)
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 1) = .Cells(i, 81)
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 2) = .Cells(i, 82)
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 2).NumberFormat = "0.00"
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 3) = .Cells(i, 83)
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 3).NumberFormat = "0.00"
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 4) = .Cells(i, 84)
   If .Cells(i, 84) <> "2" Then .Cells(i, 86) = "Nespr|fffd|vna trieda presnosti v STX (m|fffd| by|fffd| 2)"
   Sheets("Technicka_sprava").Cells(PocetKart + 2, 5) = .Cells(i, 86)
   PocetKart = PocetKart + 1
  Next i
  PocetKart = PocetKart + 2
 Else
  PocetKart = PredchadzajucaUloha
 End If

 PredchadzajucaUloha = PocetKart
 
''PROJEKTOVANE
 Dim PocetProjekt As Integer
 If .Cells(1, 87) > 1 Then
  PocetProjekt = PredchadzajucaUloha + 3
  For i = 2 To .Cells(1, 87)
   Sheets("Technicka_sprava").Cells(PocetProjekt + 2, 1) = .Cells(i, 87)
   Sheets("Technicka_sprava").Cells(PocetProjekt + 2, 2) = .Cells(i, 88)
   Sheets("Technicka_sprava").Cells(PocetProjekt + 2, 2).NumberFormat = "0.00"
   Sheets("Technicka_sprava").Cells(PocetProjekt + 2, 3) = .Cells(i, 89)
   Sheets("Technicka_sprava").Cells(PocetProjekt + 2, 3).NumberFormat = "0.00"
   Sheets("Technicka_sprava").Cells(PocetProjekt + 2, 4) = "2"
   PocetProjekt = PocetProjekt + 1
  Next i
  PocetProjekt = PocetProjekt + 2
 Else
  PocetProjekt = PredchadzajucaUloha
 End If
 
 PredchadzajucaUloha = PocetProjekt
''KARTOMETRICKE A PROJEKTOVANE koniec


''GPS
 pocetGPS = PredchadzajucaUloha + 23
 If .Cells(1, 81) < 2 And .Cells(1, 87) > 1 Then pocetGPS = pocetGPS - 2
 If .Cells(1, 81) > 1 And .Cells(1, 87) > 1 Then pocetGPS = pocetGPS - 2
 If .Cells(1, 81) > 1 And .Cells(1, 87) < 2 Then pocetGPS = pocetGPS - 2
 
 Dim GPS_zaciatok As Double
 Dim GPS_koniec As Double
 GPS_zaciatok = 0
 GPS_koniec = 0
 For i = 1 To .Cells(1, 51)
  If .Cells(i, 51) = "&GPS" Then GPS_zaciatok = i + 1
  If .Cells(i, 51) = "-1" And GPS_zaciatok <> 0 Then
   GPS_koniec = i - 1
   Exit For
  End If
 Next i
 On Error Resume Next
 For i = GPS_zaciatok To GPS_koniec
    Sheets("Technicka_sprava").Cells(pocetGPS, 1) = .Cells(i, 57)
    Sheets("Technicka_sprava").Cells(pocetGPS, 2) = .Cells(i, 58)
    Sheets("Technicka_sprava").Cells(pocetGPS, 2).NumberFormat = "0.00"
    Sheets("Technicka_sprava").Cells(pocetGPS, 3) = .Cells(i, 59)
    Sheets("Technicka_sprava").Cells(pocetGPS, 3).NumberFormat = "0.00"
    Sheets("Technicka_sprava").Cells(pocetGPS, 5) = .Cells(i, 60)
    Sheets("Technicka_sprava").Cells(pocetGPS, 5).HorizontalAlignment = xlLeft
    pocetGPS = pocetGPS + 1
 Next i
 
'BODY GPS koniec
  
 PredchadzajucaUloha = pocetGPS

''Meracka
 ''pocetMerane = pocetGPS + 6            18.5.2014
 pocetMerane = PredchadzajucaUloha + 6
 For i = 1 + GPS_koniec + 1 To .Cells(1, 51)
  Sheets("Technicka_sprava").Cells(pocetMerane, 1) = .Cells(i, 57)
  Sheets("Technicka_sprava").Cells(pocetMerane, 1).NumberFormat = .Cells(i, 57).NumberFormat
  Sheets("Technicka_sprava").Cells(pocetMerane, 1).Font.Bold = .Cells(i, 57).Font.Bold
  Sheets("Technicka_sprava").Cells(pocetMerane, 1).HorizontalAlignment = .Cells(i, 57).HorizontalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 1).VerticalAlignment = .Cells(i, 57).VerticalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 1).Borders(xlEdgeBottom).LineStyle = .Cells(i, 57).Borders(xlEdgeBottom).LineStyle
  Sheets("Technicka_sprava").Cells(pocetMerane, 2) = .Cells(i, 58)
  Sheets("Technicka_sprava").Cells(pocetMerane, 2).NumberFormat = .Cells(i, 58).NumberFormat
  Sheets("Technicka_sprava").Cells(pocetMerane, 2).Font.Bold = .Cells(i, 58).Font.Bold
  Sheets("Technicka_sprava").Cells(pocetMerane, 2).HorizontalAlignment = .Cells(i, 58).HorizontalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 2).VerticalAlignment = .Cells(i, 58).VerticalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 3) = .Cells(i, 59)
  Sheets("Technicka_sprava").Cells(pocetMerane, 3).NumberFormat = .Cells(i, 59).NumberFormat
  Sheets("Technicka_sprava").Cells(pocetMerane, 3).Font.Bold = .Cells(i, 59).Font.Bold
  Sheets("Technicka_sprava").Cells(pocetMerane, 3).HorizontalAlignment = .Cells(i, 59).HorizontalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 3).VerticalAlignment = .Cells(i, 59).VerticalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 4) = .Cells(i, 60)
  Sheets("Technicka_sprava").Cells(pocetMerane, 4).NumberFormat = .Cells(i, 60).NumberFormat
  Sheets("Technicka_sprava").Cells(pocetMerane, 4).Font.Bold = .Cells(i, 60).Font.Bold
  Sheets("Technicka_sprava").Cells(pocetMerane, 4).HorizontalAlignment = .Cells(i, 60).HorizontalAlignment
  Sheets("Technicka_sprava").Cells(pocetMerane, 4).VerticalAlignment = .Cells(i, 60).VerticalAlignment

  pocetMerane = pocetMerane + 1
  If .Cells(i, 57).HorizontalAlignment = xlLeft And .Cells(i, 57) <> "" Then pocetMerane = pocetMerane + 1
  If .Cells(i, 57) = "21 - Priese|fffd|n|fffd|k priamok" Then
   Sheets("Technicka_sprava").Cells(pocetMerane - 2, 2) = ""
   Sheets("Technicka_sprava").Cells(pocetMerane - 1, 2) = .Cells(i, 58)
   Sheets("Technicka_sprava").Cells(pocetMerane - 1, 2).HorizontalAlignment = xlLeft
   Sheets("Technicka_sprava").Cells(pocetMerane - 1, 2).Font.Size = 8
   Sheets("Technicka_sprava").Cells(pocetMerane - 1, 2).Font.Bold = True
  End If
 Next i
 If Sheets("exp_imp").Cells(11, 1) = "VGPmt" Then
  Sheets("Technicka_sprava").Cells(pocetMerane + 1, 1) = "Stoto|fffd|nenie s mapov|fffd|m podkladom som vykonal z|fffd|kladnou transform|fffd|ciou a n|fffd|sledne lok|fffd|lnou transform|fffd|ciou vyu|fffd|it|fffd|m identick|fffd|ch bodov."
  Sheets("Technicka_sprava").Cells(pocetMerane + 1, 1).HorizontalAlignment = xlLeft
  pocetMerane = pocetMerane + 3
 End If
''Meracka_koniec

 PredchadzajucaUloha = pocetMerane

''95 ka
 Dim pocet95ka As Integer
     ''pocet95ka = pocetMerane + 2    18.5.2014
     pocet95ka = PredchadzajucaUloha + 2
'vytvorit_95ku
 Dim vymeraVGI As String
 Dim vymeraVV As String
 Dim oprava As String
 Dim pouzite_odpocet As String
 Dim ii As Integer
 
 For i = 2 To .Cells(1, 5)
  If vyber_prvku(.Cells(i, 5), 1, " ") = "KLADPAR" Then
   For ii = 0 To 10
    Sheets("Technicka_sprava").Cells(pocet95ka + ii, 1).Font.Bold = False
    Sheets("Technicka_sprava").Cells(pocet95ka + ii, 1).Font.Italic = False
    Sheets("Technicka_sprava").Cells(pocet95ka + ii, 1).HorizontalAlignment = xlLeft
    Sheets("Technicka_sprava").Cells(pocet95ka + ii, 1).Font.Name = "Arial"
    Sheets("Technicka_sprava").Cells(pocet95ka + ii, 1).Font.Size = 10
   Next ii
   Sheets("Technicka_sprava").Cells(pocet95ka, 1) = "95 - V|fffd|po|fffd|et v|fffd|mer parciel"
   Sheets("Technicka_sprava").Cells(pocet95ka, 1).Font.Bold = True
   pocet95ka = pocet95ka + 1
   pouzite_odpocet = "nie"
   For ii = 2 To Sheets("XML").Cells(1, 1)
    If vyber_prvku(.Cells(i, 5), 3, "$") = Sheets("XML").Cells(ii, 3) And Sheets("XML").Cells(ii, 8) = "odpocet" Then pouzite_odpocet = "ano"
   Next ii
   If pouzite_odpocet = "nie" Then
    Sheets("Technicka_sprava").Cells(pocet95ka + 1, 1) = "Parceln|fffd| |fffd||fffd|slo :  " & vyber_prvku(.Cells(i, 5), 3, "$")
    Sheets("Technicka_sprava").Cells(pocet95ka + 2, 1) = "-----------------------------------------------"
    Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1) = vyber_prvku(.Cells(i, 5), -1, "$")
    If Len(vyber_prvku(.Cells(i, 5), -1, "$")) <= 90 Then
     Rows(pocet95ka + 3).RowHeight = 15
     Range(Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1), Sheets("Technicka_sprava").Cells(pocet95ka + 3, 6)).WrapText = False
    Else
     Dim PocetRiadkov95 As Double
     Sheets("exp_imp").Cells(56, 1) = Len(vyber_prvku(.Cells(i, 5), -1, "$")) / 90
     PocetRiadkov95 = Sheets("exp_imp").Cells(57, 1)
     
     Range(Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1), Sheets("Technicka_sprava").Cells(pocet95ka + 3, 6)).Merge
     Range(Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1), Sheets("Technicka_sprava").Cells(pocet95ka + 3, 6)).HorizontalAlignment = xlLeft
     Range(Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1), Sheets("Technicka_sprava").Cells(pocet95ka + 3, 6)).VerticalAlignment = xlCenter
     Range(Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1), Sheets("Technicka_sprava").Cells(pocet95ka + 3, 6)).WrapText = True
     Range(Sheets("Technicka_sprava").Cells(pocet95ka + 3, 1), Sheets("Technicka_sprava").Cells(pocet95ka + 3, 6)).RowHeight = 15 * PocetRiadkov95
    End If
    Sheets("Technicka_sprava").Cells(pocet95ka + 4, 1) = "-----------------------------------------------"
    pocet95ka = pocet95ka + 4
   Else
    Sheets("Technicka_sprava").Cells(pocet95ka + 1, 1) = "Parceln|fffd| |fffd||fffd|slo :  " & vyber_prvku(.Cells(i, 5), 3, "$") & "   - v|fffd|mera ur|fffd|en|fffd| odpo|fffd|tom"
    pocet95ka = pocet95ka + 1
    Sheets("Technicka_sprava").Cells(pocet95ka + 1, 1) = "-----------------------------------------------"
    Sheets("Technicka_sprava").Cells(pocet95ka + 2, 1) = "P|fffd|vodn|fffd| parc.|fffd|. " & vyber_prvku(.Cells(i, 5), 3, "$") & " - parc.|fffd|. ... = ..."
    pocet95ka = pocet95ka + 3
   End If
   vymeraVGI = vyber_prvku(vyber_prvku(.Cells(i, 5), 6, "$"), 1, "_")
   vymeraVV = vyber_prvku(vyber_prvku(.Cells(i, 5), 6, "$"), 2, "_")
   If vymeraVV = "" Then vymeraVV = Sheets("exp_imp").Cells(53, 4)
   Sheets("exp_imp").Cells(53, 3) = vymeraVGI
   If Sheets("exp_imp").Cells(53, 4) <> vymeraVV Then
    oprava = vymeraVV - Sheets("exp_imp").Cells(53, 4)
    If oprava > 0 Then oprava = "+ " & oprava
    If oprava < 0 Then oprava = "- " & Abs(oprava)
    Sheets("Technicka_sprava").Cells(pocet95ka + 1, 1) = "     v|fffd|mera :  " & vymeraVGI & " m2 = " & Sheets("exp_imp").Cells(53, 4) & " m2 " & oprava & " m2 = " & vymeraVV & " m2"
   Else
    Sheets("Technicka_sprava").Cells(pocet95ka + 1, 1) = "     v|fffd|mera :  " & vymeraVGI & " m2 = " & Sheets("exp_imp").Cells(53, 4) & " m2"
   End If
   pocet95ka = pocet95ka + 4
  End If
 Next i
''95ka koniec

'NOVE BODY
 Dim pocetNB As Integer
 pocetNB = pocet95ka + 10
 For i = 4 To .Cells(1, 41)
  If Len(.Cells(i, 42)) > 6 Then
   Dim cZPMZnove As Integer
   cZPMZnove = Mid(.Cells(i, 42), 3, 4)
   
   If Sheets("exp_imp").Cells(11, 1) = "VGPm" And cZPMZnove = ZPMZ Then
    For j = 2 To 5
     Sheets("Technicka_sprava").Cells(pocetNB, j).NumberFormat = "0.00"
    Next j
    Sheets("Technicka_sprava").Cells(pocetNB, 1) = .Cells(i, 42)
    Sheets("Technicka_sprava").Cells(pocetNB, 2) = .Cells(i, 46)
    Sheets("Technicka_sprava").Cells(pocetNB, 3) = .Cells(i, 47)
    Sheets("Technicka_sprava").Cells(pocetNB, 4) = .Cells(i, 48)
    Sheets("Technicka_sprava").Cells(pocetNB, 4).NumberFormat = "0"
    pocetNB = pocetNB + 1
   End If
   If Sheets("exp_imp").Cells(11, 1) = "VGPmt" And .Cells(i, 43) <> "" Then
    For j = 2 To 5
     Sheets("Technicka_sprava").Cells(pocetNB, j).NumberFormat = "0.00"
    Next j
    Sheets("Technicka_sprava").Cells(pocetNB, 1) = .Cells(i, 42)
    Sheets("Technicka_sprava").Cells(pocetNB, 2) = .Cells(i, 46)
    Sheets("Technicka_sprava").Cells(pocetNB, 3) = .Cells(i, 47)
    Sheets("Technicka_sprava").Cells(pocetNB, 4) = .Cells(i, 48)
    Sheets("Technicka_sprava").Cells(pocetNB, 4).NumberFormat = "0"
    pocetNB = pocetNB + 1
   End If
   
  End If
 Next i
 If Sheets("exp_imp").Cells(11, 1) = "VGPm" Then
  Sheets("Technicka_sprava").Cells(pocetNB + 2, 1) = "Presnos|fffd| ur|fffd|enia s|fffd|radn|fffd|c zodpoved|fffd| predpisom."
  Sheets("Technicka_sprava").Cells(pocetNB + 2, 1).HorizontalAlignment = xlLeft
 End If
'NOVE BODY koniec

'NOVE BODY Lokalna transformacia
 If Sheets("exp_imp").Cells(11, 1) = "VGPmt" Then
  Dim pocetNB2 As Integer
  Dim pocetNB3 As Integer
  pocetNB2 = pocetNB + 7
  For i = 4 To .Cells(1, 41)
   If Len(.Cells(i, 42)) > 6 Then
    cZPMZnove = Mid(.Cells(i, 42), 3, 4)
    If cZPMZnove = ZPMZ And .Cells(i, 43) <> "" Then
     For j = 2 To 5
      Sheets("Technicka_sprava").Cells(pocetNB2, j).NumberFormat = "0.00"
     Next j
     Sheets("Technicka_sprava").Cells(pocetNB2, 1) = .Cells(i, 42)
     Sheets("Technicka_sprava").Cells(pocetNB2, 2) = .Cells(i, 43)
     Sheets("Technicka_sprava").Cells(pocetNB2, 3) = .Cells(i, 44)
     Sheets("Technicka_sprava").Cells(pocetNB2, 4) = .Cells(i, 45)
     Sheets("Technicka_sprava").Cells(pocetNB2, 4).NumberFormat = "0"
     pocetNB2 = pocetNB2 + 1
    End If
   End If
  Next i
  Sheets("Technicka_sprava").Cells(pocetNB2 + 2, 1) = "Presnos|fffd| ur|fffd|enia s|fffd|radn|fffd|c zodpoved|fffd| predpisom."
  Sheets("Technicka_sprava").Cells(pocetNB2 + 2, 1).HorizontalAlignment = xlLeft
 End If
'NOVE BODY Lokalna transformacia koniec

End With

''ORAMOVANIA

With Sheets("Technicka_sprava")
'DANE BODY ORAMOVANIE
'Hlavicka
 If pocetDB >= 7 Then
  .Cells(3, 1) = "99 - Dan|fffd| body"
  .Cells(3, 1).HorizontalAlignment = xlLeft
  .Cells(3, 1).Font.Bold = True
  .Cells(5, 2).RowHeight = 16
  .Cells(6, 2).RowHeight = 16
  .Cells(5, 1) = "|fffd||fffd|slo bodu"
  .Cells(5, 2) = "Y"
  .Cells(5, 3) = "X"
  .Range(.Cells(5, 1), .Cells(6, 1)).Merge
  .Range(.Cells(5, 2), .Cells(6, 2)).Merge
  .Range(.Cells(5, 3), .Cells(6, 3)).Merge
  .Cells(5, 4) = "K|fffd|d kvality"
  .Range(.Cells(5, 4), .Cells(6, 4)).Merge
'  .Cells(5, 5) = "Nov|fffd| |fffd||fffd|slo bodu"
'  .Cells(6, 5) = "v JTSK03"
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeLeft).LineStyle = xlDouble
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeLeft).Weight = xlThick
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeTop).LineStyle = xlDouble
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeTop).Weight = xlThick
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeBottom).LineStyle = xlDouble
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeBottom).Weight = xlThick
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeRight).LineStyle = xlDouble
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlEdgeRight).Weight = xlThick
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlInsideVertical).LineStyle = xlContinuous
  .Range(.Cells(5, 1), .Cells(6, 4)).Borders(xlInsideVertical).Weight = xlThin
  On Error Resume Next
  .Range(.Cells(5, 1), .Cells(6, 4)).Interior.ColorIndex = 15
  .Range(.Cells(5, 1), .Cells(6, 4)).Interior.Pattern = xlSolid
  .Range(.Cells(5, 1), .Cells(6, 4)).HorizontalAlignment = xlCenter
  .Range(.Cells(5, 1), .Cells(6, 4)).Font.Bold = False
  .Range(.Cells(5, 1), .Cells(6, 4)).Font.Name = "Arial"
  .Range(.Cells(5, 1), .Cells(6, 4)).Font.Size = 10
  .Range(.Cells(5, 1), .Cells(6, 4)).Font.Strikethrough = False
'hlavicka koniec
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 5)).HorizontalAlignment = xlCenter
  .Range(.Cells(7, 2), .Cells(pocetDB - 1, 3)).NumberFormat = "0.00"
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 5)).Font.Bold = False
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 5)).Font.Italic = False
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 5)).Font.Name = "Arial"
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 5)).Font.Size = 10
        
        
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlEdgeBottom).LineStyle = xlDouble
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlEdgeBottom).Weight = xlThick
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlEdgeLeft).LineStyle = xlDouble
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlEdgeLeft).Weight = xlThick
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlEdgeRight).LineStyle = xlDouble
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlEdgeRight).Weight = xlThick
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlInsideVertical).LineStyle = xlContinuous
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlInsideVertical).Weight = xlThin
  On Error Resume Next
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
  On Error Resume Next
  .Range(.Cells(7, 1), .Cells(pocetDB - 1, 4)).Borders(xlInsideHorizontal).Weight = xlThin
 End If
 
 
PredchadzajucaUloha = pocetDB

''KARTOMETRICKE A PROJEKTOVANE
 If Sheets("NacitanieVGI").Cells(1, 81) > 1 Then
  PocetKart = PredchadzajucaUloha + 2

  .Cells(PocetKart, 1) = "Body ur|fffd|en|fffd| kartometricky"
  .Cells(PocetKart, 1).HorizontalAlignment = xlLeft
  .Cells(PocetKart, 1).Font.Bold = True
  .Cells(PocetKart + 2, 1) = "|fffd|.B."
  .Cells(PocetKart + 2, 2) = "Y"
  .Cells(PocetKart + 2, 3) = "X"
  .Cells(PocetKart + 2, 4) = "K|fffd|d kvality"
  .Cells(PocetKart + 2, 5) = "Pozn|fffd|mka"
  .Cells(PocetKart + 2, 5).RowHeight = 31.5
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Interior.ColorIndex = 15
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Interior.Pattern = xlSolid
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).HorizontalAlignment = xlCenter
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).VerticalAlignment = xlCenter
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Font.Bold = False
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Font.Italic = False
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Font.Name = "Arial"
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Font.Size = 10
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeTop).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeTop).Weight = xlThick
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeBottom).Weight = xlThick
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeLeft).Weight = xlThick
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlEdgeRight).Weight = xlThick
  On Error Resume Next
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
  On Error Resume Next
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlInsideHorizontal).Weight = xlThin
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
  .Range(.Cells(PocetKart + 2, 1), .Cells(PocetKart + 2, 5)).Borders(xlInsideVertical).Weight = xlThin
  ''Body:
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).HorizontalAlignment = xlLeft
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 4)).HorizontalAlignment = xlCenter
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Font.Bold = False
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Font.Italic = False
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Font.Name = "Arial"
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Font.Size = 10
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlEdgeBottom).Weight = xlThick
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlEdgeLeft).Weight = xlThick
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlEdgeRight).Weight = xlThick
  On Error Resume Next
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
  On Error Resume Next
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlInsideHorizontal).Weight = xlThin
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).Borders(xlInsideVertical).Weight = xlThin
  .Range(.Cells(PocetKart + 3, 1), .Cells(PocetKart + 3 + Sheets("NacitanieVGI").Cells(1, 81) - 2, 5)).RowHeight = 15.75

   PocetKart = PocetKart + Sheets("NacitanieVGI").Cells(1, 81)
 Else
  PocetKart = PredchadzajucaUloha
 End If
 
 PredchadzajucaUloha = PocetKart

''PROJEKTOVANE
 If Sheets("NacitanieVGI").Cells(1, 87) > 1 Then
  If Sheets("NacitanieVGI").Cells(1, 81) = 1 Then
   PocetProjekt = PredchadzajucaUloha + 2
  Else
   PocetProjekt = PredchadzajucaUloha + 4
  End If

  .Cells(PocetProjekt, 1) = "Body z projektu"
  .Cells(PocetProjekt, 1).HorizontalAlignment = xlLeft
  .Cells(PocetProjekt, 1).Font.Bold = True
  .Cells(PocetProjekt + 2, 1) = "|fffd|.B."
  .Cells(PocetProjekt + 2, 2) = "Y"
  .Cells(PocetProjekt + 2, 3) = "X"
  .Cells(PocetProjekt + 2, 4) = "K|fffd|d kvality"
  .Cells(PocetProjekt + 2, 5) = "Pozn|fffd|mka"
  .Cells(PocetProjekt + 2, 5).RowHeight = 31.5
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Interior.ColorIndex = 15
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Interior.Pattern = xlSolid
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).HorizontalAlignment = xlCenter
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).VerticalAlignment = xlCenter
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Font.Bold = False
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Font.Italic = False
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Font.Name = "Arial"
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Font.Size = 10
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeTop).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeTop).Weight = xlThick
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeBottom).Weight = xlThick
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeLeft).Weight = xlThick
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlEdgeRight).Weight = xlThick
  On Error Resume Next
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
  On Error Resume Next
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlInsideHorizontal).Weight = xlThin
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
  .Range(.Cells(PocetProjekt + 2, 1), .Cells(PocetProjekt + 2, 5)).Borders(xlInsideVertical).Weight = xlThin
  ''Body:
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).HorizontalAlignment = xlCenter
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Font.Bold = False
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Font.Italic = False
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Font.Name = "Arial"
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Font.Size = 10
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlEdgeBottom).Weight = xlThick
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlEdgeLeft).Weight = xlThick
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlEdgeRight).Weight = xlThick
  On Error Resume Next
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
  On Error Resume Next
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlInsideHorizontal).Weight = xlThin
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).Borders(xlInsideVertical).Weight = xlThin
  .Range(.Cells(PocetProjekt + 3, 1), .Cells(PocetProjekt + 3 + Sheets("NacitanieVGI").Cells(1, 87) - 2, 5)).RowHeight = 15.75

   PocetProjekt = PocetProjekt + Sheets("NacitanieVGI").Cells(1, 87)
 Else
  PocetProjekt = PredchadzajucaUloha
 End If
 
 PredchadzajucaUloha = PocetProjekt
''KARTOMETRICKE A PROJEKTOVANE koniec

'GPS
'hlavicka
Dim poz_GPS As Integer
        
        ''poz_GPS = pocetDB + 6   ''18.5.2014
        poz_GPS = PredchadzajucaUloha + 6
        
        .Cells(poz_GPS + 6, 1) = "Body ur|fffd|en|fffd| met|fffd|dou GPS v S-JTSK"
        
        .Cells(poz_GPS + 8, 1) = "Meran|fffd| body s|fffd| ur|fffd|en|fffd| technol|fffd|giou GNSS, pripojen|fffd|m na SKPOS s vyu|fffd|it|fffd|m"
        .Cells(poz_GPS + 9, 1) = "z|fffd|kladnej transform|fffd|cie (RTS)"
        
        .Range(.Cells(poz_GPS + 6, 1), .Cells(poz_GPS + 9, 1)).HorizontalAlignment = xlLeft
        .Range(.Cells(poz_GPS + 6, 1), .Cells(poz_GPS + 9, 1)).Font.Bold = False
        .Range(.Cells(poz_GPS + 6, 1), .Cells(poz_GPS + 9, 1)).Font.Italic = False
        .Range(.Cells(poz_GPS + 6, 1), .Cells(poz_GPS + 9, 1)).Font.Name = "Arial"
        .Range(.Cells(poz_GPS + 6, 1), .Cells(poz_GPS + 9, 1)).Font.Size = 10
        .Cells(poz_GPS + 6, 1).Font.Bold = True
        .Cells(poz_GPS + 6, 1).Font.Size = 12
        
        .Cells(poz_GPS + 11, 2) = "prihlasovacie meno:"
        .Cells(poz_GPS + 11, 3) = Sheets("vstup").cmbGPSmeno.Text
        .Cells(poz_GPS + 12, 2) = "d|fffd|tum:"
        .Cells(poz_GPS + 12, 3) = Sheets("vstup").Cells(19, 4)
        .Cells(poz_GPS + 12, 3).NumberFormat = "dd.mm.yyyy"
        .Cells(poz_GPS + 13, 2) = "|fffd|as:"
        .Cells(poz_GPS + 13, 3) = Sheets("vstup").Cells(16, 4)
        
        .Range(.Cells(poz_GPS + 11, 2), .Cells(poz_GPS + 13, 2)).HorizontalAlignment = xlRight
        .Range(.Cells(poz_GPS + 11, 2), .Cells(poz_GPS + 13, 2)).Font.Bold = False
        .Range(.Cells(poz_GPS + 11, 2), .Cells(poz_GPS + 13, 2)).Font.Italic = False
        .Range(.Cells(poz_GPS + 11, 2), .Cells(poz_GPS + 13, 2)).Font.Name = "Arial"
        .Range(.Cells(poz_GPS + 11, 2), .Cells(poz_GPS + 13, 2)).Font.Size = 10
        
        .Range(.Cells(poz_GPS + 11, 3), .Cells(poz_GPS + 13, 3)).HorizontalAlignment = xlLeft
        .Range(.Cells(poz_GPS + 11, 3), .Cells(poz_GPS + 13, 3)).Font.Bold = False
        .Range(.Cells(poz_GPS + 11, 3), .Cells(poz_GPS + 13, 3)).Font.Italic = False
        .Range(.Cells(poz_GPS + 11, 3), .Cells(poz_GPS + 13, 3)).Font.Name = "Arial"
        .Range(.Cells(poz_GPS + 11, 3), .Cells(poz_GPS + 13, 3)).Font.Size = 10
        
        
        .Cells(poz_GPS + 15, 1) = "Zoznam s|fffd|radn|fffd|c meran|fffd|ch bodov"
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 15, 5)).Merge
        .Cells(poz_GPS + 16, 1) = "|fffd||fffd|slo bodu"
        .Cells(poz_GPS + 16, 2) = "Y"
        .Cells(poz_GPS + 16, 3) = "X"
        .Cells(poz_GPS + 16, 4) = "H"
        .Cells(poz_GPS + 16, 5) = "pozn|fffd|mka"
        
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Interior.ColorIndex = 15
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Interior.Pattern = xlSolid
        
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).HorizontalAlignment = xlCenter
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Font.Bold = False
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Font.Italic = False
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Font.Name = "Arial"
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Font.Size = 10
        .Cells(poz_GPS + 15, 1).Font.Bold = True
                
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeTop).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeTop).Weight = xlThick
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeBottom).Weight = xlThick
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeLeft).Weight = xlThick
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlEdgeRight).Weight = xlThick
        On Error Resume Next
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
        On Error Resume Next
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlInsideHorizontal).Weight = xlThin
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).Borders(xlInsideVertical).Weight = xlThin
        
        .Range(.Cells(poz_GPS + 15, 1), .Cells(poz_GPS + 16, 5)).RowHeight = 15.75
        
'hlavicka koniec
'pocetGPS

'body
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).HorizontalAlignment = xlCenter
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Font.Bold = False
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Font.Italic = False
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Font.Name = "Arial"
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Font.Size = 10
        .Range(.Cells(poz_GPS + 17, 2), .Cells(pocetGPS - 1, 3)).NumberFormat = "0.00"
        
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlEdgeBottom).Weight = xlThick
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlEdgeLeft).Weight = xlThick
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlEdgeRight).Weight = xlThick
        On Error Resume Next
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
        On Error Resume Next
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlInsideHorizontal).Weight = xlThin
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).Borders(xlInsideVertical).Weight = xlThin
        
        .Range(.Cells(poz_GPS + 17, 1), .Cells(pocetGPS - 1, 5)).RowHeight = 15.75
        
'body koniec
'GPS koniec

'NOVE BODY
'hlavicka

Dim poz_NB As Integer
       
        poz_NB = pocet95ka + 8              'POSUNUTIE TABULKY Novych bodov
        
        If Sheets("exp_imp").Cells(11, 1) = "VGPm" Then
          .Cells(poz_NB - 2, 1) = "Nov|fffd| body"
        Else
          .Cells(poz_NB - 2, 1) = "Nov|fffd| body - po z|fffd|kladnej transform|fffd|cii (vrstva BODY)"
        End If
          .Cells(poz_NB - 2, 1).HorizontalAlignment = xlLeft
          .Cells(poz_NB - 2, 1).Font.Bold = True
        
        .Cells(poz_NB, 1) = "|fffd|.B."
        .Cells(poz_NB, 2) = "Y"
        .Cells(poz_NB, 3) = "X"
        .Cells(poz_NB, 4) = "K|fffd|d kvality"
        .Cells(poz_NB, 5) = "Pozn|fffd|mka"
        
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 1)).Merge
        .Range(.Cells(poz_NB, 2), .Cells(poz_NB + 1, 2)).Merge
        .Range(.Cells(poz_NB, 3), .Cells(poz_NB + 1, 3)).Merge
        .Range(.Cells(poz_NB, 4), .Cells(poz_NB + 1, 4)).Merge
        .Range(.Cells(poz_NB, 4), .Cells(poz_NB + 1, 4)).WrapText = True
        .Range(.Cells(poz_NB, 5), .Cells(poz_NB + 1, 5)).Merge
        
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeTop).LineStyle = xlDouble
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeTop).Weight = xlThick
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeBottom).Weight = xlThick
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeLeft).Weight = xlThick
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlEdgeRight).Weight = xlThick
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlInsideVertical).Weight = xlThin
        On Error Resume Next
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
        On Error Resume Next
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Borders(xlInsideHorizontal).Weight = xlThin
        
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Interior.ColorIndex = 15
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Interior.Pattern = xlSolid
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).HorizontalAlignment = xlCenter
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Font.Bold = False
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Font.Name = "Arial"
        .Range(.Cells(poz_NB, 1), .Cells(poz_NB + 1, 5)).Font.Size = 10

'hlavicka koniec
'body
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).HorizontalAlignment = xlCenter
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Font.Bold = False
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Font.Italic = False
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Font.Name = "Arial"
        .Range(.Cells(poz_NB + 2, 5), .Cells(pocetNB - 1, 5)).Font.Size = 8
        
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlEdgeBottom).Weight = xlThick
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlEdgeLeft).Weight = xlThick
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlEdgeRight).Weight = xlThick
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlInsideVertical).Weight = xlThin
        On Error Resume Next
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
        On Error Resume Next
        .Range(.Cells(poz_NB + 2, 1), .Cells(pocetNB - 1, 5)).Borders(xlInsideHorizontal).Weight = xlThin
        .Range(.Cells(poz_NB, 1), .Cells(pocetNB - 1, 7)).RowHeight = 15.75
                
'NOVE BODY koniec

'NOVE BODY  VGPmt
'hlavicka

If Sheets("exp_imp").Cells(11, 1) = "VGPmt" Then
 Dim poz_NB2 As Integer
       
        poz_NB2 = pocetNB + 5            'POSUNUTIE TABULKY Novych bodov
          .Cells(poz_NB2 - 2, 1) = "Nov|fffd| body - po lok|fffd|lnej transform|fffd|cii"
          .Cells(poz_NB2 - 2, 1).HorizontalAlignment = xlLeft
          .Cells(poz_NB2 - 2, 1).Font.Bold = True
        
        .Cells(poz_NB2, 1) = "|fffd|.B."
        .Cells(poz_NB2, 2) = "Y"
        .Cells(poz_NB2, 3) = "X"
        .Cells(poz_NB2, 4) = "K|fffd|d kvality"
        .Cells(poz_NB2, 5) = "Pozn|fffd|mka"
        
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 1)).Merge
        .Range(.Cells(poz_NB2, 2), .Cells(poz_NB2 + 1, 2)).Merge
        .Range(.Cells(poz_NB2, 3), .Cells(poz_NB2 + 1, 3)).Merge
        .Range(.Cells(poz_NB2, 4), .Cells(poz_NB2 + 1, 4)).Merge
        .Range(.Cells(poz_NB2, 4), .Cells(poz_NB2 + 1, 4)).WrapText = True
        .Range(.Cells(poz_NB2, 5), .Cells(poz_NB2 + 1, 5)).Merge
        
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeTop).LineStyle = xlDouble
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeTop).Weight = xlThick
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeBottom).Weight = xlThick
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeLeft).Weight = xlThick
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlEdgeRight).Weight = xlThick
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlInsideVertical).Weight = xlThin
        On Error Resume Next
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
        On Error Resume Next
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Borders(xlInsideHorizontal).Weight = xlThin
        
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Interior.ColorIndex = 15
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Interior.Pattern = xlSolid
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).HorizontalAlignment = xlCenter
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Font.Bold = False
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Font.Name = "Arial"
        .Range(.Cells(poz_NB2, 1), .Cells(poz_NB2 + 1, 5)).Font.Size = 10

'hlavicka koniec
'body
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).HorizontalAlignment = xlCenter
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Font.Bold = False
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Font.Italic = False
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Font.Name = "Arial"
        .Range(.Cells(poz_NB2 + 2, 5), .Cells(pocetNB2 - 1, 5)).Font.Size = 8
        
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlEdgeBottom).LineStyle = xlDouble
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlEdgeBottom).Weight = xlThick
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlEdgeLeft).LineStyle = xlDouble
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlEdgeLeft).Weight = xlThick
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlEdgeRight).LineStyle = xlDouble
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlEdgeRight).Weight = xlThick
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlInsideVertical).LineStyle = xlContinuous
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlInsideVertical).Weight = xlThin
        On Error Resume Next
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlInsideHorizontal).LineStyle = xlContinuous
        On Error Resume Next
        .Range(.Cells(poz_NB2 + 2, 1), .Cells(pocetNB2 - 1, 5)).Borders(xlInsideHorizontal).Weight = xlThin
        .Range(.Cells(poz_NB2, 1), .Cells(pocetNB2 - 1, 7)).RowHeight = 15.75
                
End If
'NOVE BODY koniec   VGPmt

End With

Sheets("Technicka_sprava").Cells(3, 1).Select
MsgBox "Technick|fffd| spr|fffd|va vytvoren|fffd|"
 
 
Exit Sub
1:

End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
Dim i As Integer

If lblCKNm.Caption = "nepripojen|fffd|" And _
   lblCKNt.Caption = "nepripojen|fffd|" And _
   lblEKN.Caption = "nepripojen|fffd|" And _
   lblCKNp.Caption = "nepripojen|fffd|" And _
   lblCKNstx.Caption = "nepripojen|fffd|" And _
   lblMeracka.Caption = "nepripojen|fffd|" Then
 i = 1
Else
 frmVymazatVGI.odkial.Caption = "VGI"
 frmVymazatVGI.Show
End If
End Sub

Private Sub save_VGI_chyby_Click()
Dim retazec As String
Dim i As Integer

retazec = ""
For i = 0 To lbChyby.ListCount - 1
 lbChyby.ListIndex = i
 If retazec = "" Then retazec = lbChyby.Text Else retazec = retazec & vbCrLf & lbChyby.Text
Next i
   
If retazec <> "" Then
 Open Sheets("exp_imp").Cells(8, 1).Text & "_Chyby_VGI.txt" For Output As #1
 Print #1, retazec
 Close #1
 MsgBox "Z|fffd|znam ch|fffd|b je ulo|fffd|en|fffd| v adres|fffd|ri, kde s|fffd| ulo|fffd|en|fffd| Tabulky " & vbCrLf & Sheets("exp_imp").Cells(8, 1).Text & "_Chyby_VGI.txt"
Else
 MsgBox "Nie je |fffd|o ulo|fffd|i|fffd|. :-)"
End If
   
lbChyby.ListIndex = -1
End Sub

Private Sub save_VGI_VV_chyby_Click()
Dim retazec As String
Dim i As Integer

retazec = ""
For i = 0 To lbChybyVvVGI.ListCount - 1
 lbChybyVvVGI.ListIndex = i
 If retazec = "" Then retazec = lbChybyVvVGI.Text Else retazec = retazec & vbCrLf & lbChybyVvVGI.Text
Next i
   
If retazec <> "" Then
 Open Sheets("exp_imp").Cells(8, 1).Text & "_Chyby_POROVNANIE.txt" For Output As #1
 Print #1, retazec
 Close #1
 MsgBox "Z|fffd|znam ch|fffd|b je ulo|fffd|en|fffd| v adres|fffd|ri, kde s|fffd| ulo|fffd|en|fffd| Tabulky " & vbCrLf & Sheets("exp_imp").Cells(8, 1).Text & "_Chyby_POROVNANIE.txt"
Else
 MsgBox "Nie je |fffd|o ulo|fffd|i|fffd|. :-)"
End If

lbChybyVvVGI.ListIndex = -1
End Sub

Private Sub VGPm_Click()
  Sheets("exp_imp").Cells(11, 1) = "VGPm"
End Sub

Private Sub VGPmt_Click()
  Sheets("exp_imp").Cells(11, 1) = "VGPmt"
End Sub

Private Sub EditovatSTX_Click()
Dim i As Integer
Dim ZPMZ As Integer
Dim ZPMZvgi As Integer

With frmZoznamSuradnic
 .lbKart.Clear
 .lbProjekt.Clear
 
 ZPMZ = Sheets("vstup").Cells(10, 4)
 For i = 4 To Sheets("NacitanieVGI").Cells(1, 41) - 1
  ZPMZvgi = Mid(Sheets("NacitanieVGI").Cells(i, 42), 3, 4)
  If ZPMZ = ZPMZvgi Then
   If Sheets("NacitanieVGI").Cells(i, 49) = "K" Then .lbKart.AddItem Sheets("NacitanieVGI").Cells(i, 42)
   If Sheets("NacitanieVGI").Cells(i, 49) = "P" Then .lbProjekt.AddItem Sheets("NacitanieVGI").Cells(i, 42)
  End If
 Next i
    
 .lbPriklad.AddItem "1152030012  578775.66 1273722.44  0.00  1"
 .lbPriklad.AddItem "1152030013  578777.48 1273722.14  0.00  2   P"
 .lbPriklad.AddItem "1152038001  578660.50 1273849.78  0.00  2   K"
 .Show
End With
End Sub



Attribute VB_Name = "frmVlastnici"
Attribute VB_Base = "0{30AE0FB2-8450-46B6-9949-3ECBF2AD3387}{E8398FA4-F803-4367-BBAD-A2A837CAF58B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub lbPC_Click()
 lbVlastnik.ListIndex = lbPC.ListIndex
End Sub

Private Sub lbVlastnik_Click()
Dim str1 As String
Dim str2 As String

lbPC.ListIndex = lbVlastnik.ListIndex

With Sheets("exp_imp")
 str1 = .Cells(lbVlastnik.ListIndex + 2, 21)
 str2 = .Cells(lbVlastnik.ListIndex + 2, 22)

 MsgBox "vlastn|fffd|k:    " & str1 & vbCrLf & "p.|fffd|.:           " & str2, , "Cel|fffd| v|fffd|pis"
End With
End Sub

Private Sub ponuka_Click()
 lblVv.Caption = ponuka.Text
 Vlozit_vlastnikov
End Sub

Private Sub UserForm_Activate()
Dim i As Integer
ListyViditelne

With Sheets("Vstup")
 For i = 0 To .ListVisible.ListCount - 1
  .ListVisible.ListIndex = i
  If Sheets(.ListVisible.Text).Cells(1, 1) = "V|fffd|KAZ  V|fffd|MER" Then
   lblVv.Caption = .ListVisible.Text
   ponuka.AddItem .ListVisible.Text
  End If
 Next i
End With

If ponuka.ListCount = 0 Then
 ponuka.AddItem "Nie je zobrazen|fffd| |fffd|iadny Vv"
Else
 frmVlastnici.ponuka.ListIndex = 0
 lblVv.Caption = ponuka.Text
 cmbVlozit.Caption = "Vlo|fffd|i|fffd| od bunky " + ActiveCell.Address
 Vlozit_vlastnikov
End If

End Sub

Private Sub cmbVlozit_Click()
Dim i As Integer
Dim riadok As Integer
Dim stlpec As Integer
      
If lbVlastnik.ListCount > 0 Then
 Sheets(lblZz.Caption).Select

 With Sheets("exp_imp")
  For i = 0 To lbVlastnik.ListCount - 1
   If .Cells(i + 2, 22).Value <> "" Then
    If pc_vl.Value = True Then
     Cells(ActiveCell.Row + i, ActiveCell.Column).Value = .Cells(i + 2, 22).Value
     Cells(ActiveCell.Row + i, ActiveCell.Column).WrapText = False
     Cells(ActiveCell.Row + i, ActiveCell.Column + 1).Value = .Cells(i + 2, 21).Value
     Cells(ActiveCell.Row + i, ActiveCell.Column + 1).WrapText = False
    End If
    If vl_pc.Value = True Then
     Cells(ActiveCell.Row + i, ActiveCell.Column) = .Cells(i + 2, 21).Value
     Cells(ActiveCell.Row + i, ActiveCell.Column + 1) = .Cells(i + 2, 22).Value
     Cells(ActiveCell.Row + i, ActiveCell.Column).WrapText = False
     Cells(ActiveCell.Row + i, ActiveCell.Column + 1).WrapText = False
    End If
    If vl__pc.Value = True Then
     Cells(ActiveCell.Row + i, ActiveCell.Column).WrapText = False
     Cells(ActiveCell.Row + i, ActiveCell.Column) = .Cells(i + 2, 21).Value + "  -  " + .Cells(i + 2, 22).Value
    End If
    If pc__vl.Value = True Then
     Cells(ActiveCell.Row + i, ActiveCell.Column) = .Cells(i + 2, 22).Value + "  -  " + .Cells(i + 2, 21).Value
     Cells(ActiveCell.Row + i, ActiveCell.Column).WrapText = False
    End If
   End If
  Next i
  .Columns(19).Clear
  .Columns(20).Clear
  .Columns(21).Clear
  .Columns(22).Clear
 End With
End If

End Sub
Attribute VB_Name = "frmVymazatVGI"
Attribute VB_Base = "0{27BB92D9-0BEF-4550-9188-2968776410E4}{33756D2B-42E9-4E83-8C6E-2442DE86DBB0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Dim nazov_listu_Vv As String
nazov_listu_Vv = ActiveSheet.Name

If odkial.Caption = "VGI" Then
     With Sheets("xml")
     .Visible = True
     .Select
     .UsedRange.Delete
     .Visible = False
     End With
 
     With Sheets("NacitanieVGI")
     .Visible = True
     .Select
     .UsedRange.Delete
     .Visible = False
     End With
End If

Sheets(nazov_listu_Vv).Select

On Error Resume Next
Unload Me

End Sub

Private Sub CommandButton2_Click()
Dim nazov_listu_Vv As String

nazov_listu_Vv = ActiveSheet.Name
Sheets(nazov_listu_Vv).Select
frmVymazatVGI.Hide

End Sub

Attribute VB_Name = "frmVymera"
Attribute VB_Base = "0{3F9E2505-BF9A-4A1A-BDE4-E34F42D1715D}{5E6DB1A7-9D06-44E8-8D99-FD0E5B567E0D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub UserForm_Activate()
    frmVymera.Top = 10
    frmVymera.Left = 10
End Sub

Private Sub VstupHa_Exit(ByVal Cancel As MSForms.ReturnBoolean)
If frmVymera.Caption = "Prevod  Jutro / siaha   na   ha / m2" Then _
    odpocet_siahy odkial:="INE_odpocet", co:="siahy" Else _
    odpocet_siahy odkial:="INE_odpocet", co:="odpocet"
End Sub

Private Sub VstupM2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
If frmVymera.Caption = "Prevod  Jutro / siaha   na   ha / m2" Then _
    odpocet_siahy odkial:="INE_odpocet", co:="siahy" Else _
    odpocet_siahy odkial:="INE_odpocet", co:="odpocet"
End Sub

Private Sub vystupM2_Change()
    If frmVymera.Height = 120 Then
       If vystupM2.Text = "" Then cmbOpravitVoVv.Enabled = False Else cmbOpravitVoVv.Enabled = True
    End If
End Sub

Private Sub cmbOpravitVoVv_Click()
Dim riadok As Integer
Dim stlpec As Integer

    riadok = lbRiadokM2.Caption
    stlpec = lbStlpecM2.Caption
    
    Cells(riadok, stlpec).Value = vystupM2.Text
    Cells(riadok, stlpec - 1).Value = vystupHa.Text
 
    cmbOpravitVoVv.Enabled = False
End Sub

Attribute VB_Name = "frmVyuzivanie"
Attribute VB_Base = "0{5F273E24-2451-43C6-B5F8-2C119D5DC551}{8DF8AFBD-5F92-4DED-A911-1136E622295A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub lbVyuzivanie_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim i As Integer

If DP_pom1.Caption = "Vv_SV" Then
 For i = 3 To 41
  If Sheets("Vyuz_poz").Cells(i, 1).Text + " - " + Sheets("Vyuz_poz").Cells(i, 2).Text = lbVyuzivanie.Text Then
   Cells(ActiveCell.Row, ActiveCell.Column) = Sheets("Vyuz_poz").Cells(i, 1).Text
  End If
 Next i
 frmVyuzivanie.Hide
End If

If DP_pom1.Caption = "Vv_KDS" Then
 For i = 46 To 68
  If Sheets("Vyuz_poz").Cells(i, 1).Text + " - " + Sheets("Vyuz_poz").Cells(i, 2).Text = lbVyuzivanie.Text Then
   Cells(ActiveCell.Row, ActiveCell.Column) = Sheets("Vyuz_poz").Cells(i, 1).Text
  End If
 Next i
 frmVyuzivanie.Hide
End If

End Sub

Private Sub UserForm_Activate()
Dim i As Integer

lbVyuzivanie.Clear

If DP_pom.Caption = "Vv_SV" Then
 For i = 46 To 68
  lbVyuzivanie.AddItem Sheets("Vyuz_poz").Cells(i, 1).Text + " - " + Sheets("Vyuz_poz").Cells(i, 2).Text
 Next i
End If

If (DP_pom.Caption = "NS") Or (DP_pom.Caption = "Vv") Then
 For i = 3 To 41
  lbVyuzivanie.AddItem Sheets("Vyuz_poz").Cells(i, 1).Text + " - " + Sheets("Vyuz_poz").Cells(i, 2).Text
 Next i
End If

End Sub

Attribute VB_Name = "frmZoznamSuradnic"
Attribute VB_Base = "0{97901064-7009-487D-AF35-07453BC66D76}{F635C57B-1D19-4E81-8C27-B13959DE422C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Attribute VB_Name = "frm_ExpImp"
Attribute VB_Base = "0{A9244547-1123-4702-BD02-C9E6F732F8B9}{AD333278-058C-4885-8063-0C071EFEABD9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub btnExport_Click()
Dim i As Integer
Dim j As Integer
Dim retazec As String
retazec = ""

Sheets("xml").Visible = True
Sheets("xml").Select
Sheets("xml").UsedRange.Delete
Sheets("Vstup").Select

Sheets("xml").Cells(1, 1) = "/// Nastavenia"
j = 4
With Sheets("Nastavenia")
 
 Sheets("xml").Cells(2, 1) = "*firmy"
 Sheets("xml").Cells(3, 1) = "/n|fffd|zov;druh|fffd| riadok;ulica;|fffd||fffd|slo;mesto;PS|fffd|;I|fffd|O;DI|fffd|;telef|fffd|n;email"
 i = 12
 Do
  i = i + 1
  If .Cells(i, 1) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 1) & ";" & .Cells(i, 2) & ";" & .Cells(i, 3) & ";" & _
                               .Cells(i, 4) & ";" & .Cells(i, 5) & ";" & .Cells(i, 6) & ";" & _
                               .Cells(i, 7) & ";" & .Cells(i, 8) & ";" & .Cells(i, 9) & ";" & _
                               .Cells(i, 10)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*Meral"
 Sheets("xml").Cells(j + 2, 1) = "/Meral - meno"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 20) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 20)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*Vyhotovil"
 Sheets("xml").Cells(j + 2, 1) = "/Vyhotovil - meno;email"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 22) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 22) & ";" & .Cells(i, 23)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*Autoriza|fffd|ne overil"
 Sheets("xml").Cells(j + 2, 1) = "/I|fffd|O;Meno;Priezvisko;Titul pred;Titul za;|fffd||fffd|slo opr|fffd|vnenia;Zobrazovan|fffd| meno"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 13) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 12) & ";" & .Cells(i, 13) & ";" & .Cells(i, 14) & ";" & .Cells(i, 15) & ";" & _
                               .Cells(i, 16) & ";" & .Cells(i, 17) & ";" & .Cells(i, 18)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*merac|fffd| pr|fffd|stroj"
 Sheets("xml").Cells(j + 2, 1) = "/n|fffd|zov pr|fffd|stroja"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 25) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 25)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*ozna|fffd|enie hran|fffd|c"
 Sheets("xml").Cells(j + 2, 1) = "/Ozna|fffd|enie hran|fffd|c"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 27) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 27)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*GPS parametre"
 Sheets("xml").Cells(j + 2, 1) = "/ozna|fffd|enie prij|fffd|ma|fffd|ov;n|fffd|zov prij|fffd|ma|fffd|a;typ ant|fffd|ny;v|fffd|robn|fffd| |fffd||fffd|slo"
 j = j + 3
 Sheets("xml").Cells(j, 1) = .Cells(12, 30) & ";" & .Cells(13, 30) & ";" & .Cells(14, 30) & ";" & .Cells(15, 30)
 Sheets("xml").Cells(j + 1, 1) = "-1"
 j = j + 1
  
 Sheets("xml").Cells(j + 1, 1) = "*GPS parametre - prihlasovacie |fffd|daje"
 Sheets("xml").Cells(j + 2, 1) = "/GPS prihlasovacie meno"
 j = j + 3
 i = 17
 Do
  i = i + 1
  If .Cells(i, 29) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 29)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*Pozemky"
 Sheets("xml").Cells(j + 2, 1) = "/n|fffd|zov;skratka;|fffd||fffd|slo"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 32) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 32) & ";" & .Cells(i, 33) & ";" & .Cells(i, 34)
   j = j + 1
  End If
 Loop
 
 Sheets("xml").Cells(j + 1, 1) = "*PozemkyPK"
 Sheets("xml").Cells(j + 2, 1) = "/n|fffd|zov;skratka;|fffd||fffd|slo"
 j = j + 3
 i = 12
 Do
  i = i + 1
  If .Cells(i, 35) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = .Cells(i, 35) & ";" & .Cells(i, 36) & ";" & .Cells(i, 37)
   j = j + 1
  End If
 Loop
 
 
 Sheets("xml").Cells(j + 1, 1) = "*Pozn|fffd|mky"
 Sheets("xml").Cells(j + 2, 1) = "/zobrazova|fffd|(skratka);cel|fffd| text"
 j = j + 3
 i = 2
 Do
  i = i + 1
  If Sheets("poznamky").Cells(i, 2) = "" Then
   Sheets("xml").Cells(j, 1) = "-1"
   Exit Do
  Else
   Sheets("xml").Cells(j, 1) = Sheets("poznamky").Cells(i, 1) & ";" & Sheets("poznamky").Cells(i, 2)
   j = j + 1
  End If
 Loop

End With




With Sheets("XML")
''Export sirky stlpcov
 .Cells(j + 1, 1) = "*|fffd||fffd|rky st|fffd|pcov jednotliv|fffd|ch h|fffd|rkov"
 j = j + 1

 Dim PocetListov As Integer
 Dim k As Integer
 Dim l As Integer
 For k = 1 To Sheets.Count
  If Sheets(k).Visible <> xlSheetVeryHidden And Sheets(k).Name <> "Vstup" And Sheets(k).Name <> "XML" Then
   .Cells(j + 1, 1) = "*" & Sheets(k).Name
   .Cells(j + 2, 1) = "/|fffd||fffd|rka st|fffd|pcaA;B;C..."
   j = j + 3
   For l = 1 To 40
    .Cells(j, 1) = .Cells(j, 1) & ";" & Sheets(k).Columns(l).ColumnWidth
   Next l
   j = j + 1
   .Cells(j, 1) = "-1"
  End If
 Next k
 .Cells(j, 1) = "-1"
 j = j + 1
 
 .Cells(j, 1) = "-2"
 j = j + 1

 For i = 1 To j
  If retazec = "" Then retazec = .Cells(1, 1) Else retazec = retazec & vbCrLf & .Cells(i, 1)
 Next i
 
 .Select
 .UsedRange.Delete
 .Visible = False
 Sheets("Vstup").Select
 frm_ExpImp.Hide
 
 If retazec <> "" Then
  Open Cells(1, 1).Worksheet.Parent.Path & "/_Nastavenia.txt" For Output As #1
  Print #1, retazec
  Close #1
  MsgBox "S|fffd|bor s nastaveniami je ulo|fffd|en|fffd| v adres|fffd|ri tabuliek " & vbCrLf & Cells(1, 1).Worksheet.Parent.Path & "/_Nastavenia.txt"
  Else
  MsgBox "Nie je |fffd|o ulo|fffd|i|fffd|. :-)"
 End If
 
End With
 
ListyViditelne

End Sub

Private Sub btnImport_Click()
 Import_Nastavenia
 On Error Resume Next
  frmExpImp.Hide
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "frm_FPU"
Attribute VB_Base = "0{FD63A301-8B85-4E51-8F08-9BC744674AE3}{E8035D18-1D86-4E9B-BA4A-33AA9E101600}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub cmbPridatm_Click()
 Pridat_Do_Vv
End Sub

Private Sub chbPodrzat_Click()
FPU_vyhladat
End Sub

Private Sub chbPridavat_Click()
 chbPridavatm.Value = chbPridavat.Value
End Sub

Private Sub chbPridavatm_Click()
chbPridavat.Value = chbPridavatm.Value
End Sub

Private Sub IMGrozbalit2_Click()
frmVelke.Visible = True
frmMale.Visible = False
IMGzbalit2.Visible = True
IMGrozbalit2.Visible = False

frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value

 frm_FPU.Width = Sheets("exp_imp").Cells(46, 7).Value
 frm_FPU.Height = Sheets("exp_imp").Cells(47, 7).Value
 If Sheets("exp_imp").Cells(46, 7).Text = 780 Then
  frm_FPU.IMGzbalit.Visible = True
  frm_FPU.IMGrozbalit.Visible = False
  frm_FPU.frmInfo.Visible = True
 Else
  frm_FPU.IMGzbalit.Visible = False
  frm_FPU.IMGrozbalit.Visible = True
  frm_FPU.frmInfo.Visible = False
 End If
End Sub

Private Sub IMGzbalit2_Click()
Sheets("exp_imp").Cells(48, 7).Value = frm_FPU.Top
Sheets("exp_imp").Cells(49, 7).Value = frm_FPU.Left
frmVelke.Visible = False
frmMale.Visible = True
frmMale.Top = 6
frmMale.Left = 25
frm_FPU.Top = 0
frm_FPU.Left = 0
frm_FPU.Height = 58
frm_FPU.Width = 675
IMGzbalit2.Visible = False
IMGrozbalit2.Visible = True
End Sub

Private Sub lblKDS_Click()
Dim Udaje As DataObject

 Set Udaje = New DataObject
     Udaje.Clear
     Udaje.SetText Trim(lblKDS.Caption)
     Udaje.PutInClipboard
     lblKDS.ControlTipText = "K|fffd|d druhu stavby je skop|fffd|rovan|fffd| do schr|fffd|nky"

End Sub

Private Sub lblSC_Click()
Dim Udaje As DataObject

 Set Udaje = New DataObject
     Udaje.Clear
     Udaje.SetText Trim(lblSC.Caption)
     Udaje.PutInClipboard
     lblSC.ControlTipText = "S|fffd|pisn|fffd| |fffd||fffd|slo stavby je skop|fffd|rovan|fffd| do schr|fffd|nky"

End Sub

Private Sub lblSCodPC_Click()
Dim Udaje As DataObject

 Set Udaje = New DataObject
     Udaje.Clear
     Udaje.SetText Trim(lblSCodPC.Caption)
     Udaje.PutInClipboard
     lblSCodPC.ControlTipText = "Stavba od p.|fffd|. je skop|fffd|rovan|fffd| do schr|fffd|nky"

End Sub

Private Sub lblSV_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim Udaje As DataObject

 Set Udaje = New DataObject
     Udaje.Clear
     Udaje.SetText Trim(lblSV.Caption)
     Udaje.PutInClipboard
     lblSV.ControlTipText = "Sp|fffd|som vyu|fffd||fffd|vania je skop|fffd|rovan|fffd| do schr|fffd|nky"

End Sub

Private Sub lbVlastnici_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim Udaje As DataObject

 Set Udaje = New DataObject
     Udaje.Clear
     Udaje.SetText Trim(lbVlastnici.Text)
     Udaje.PutInClipboard
 lbVlastnici.ControlTipText = "Vlastn|fffd|k je skop|fffd|rovan|fffd| do schr|fffd|nky"

End Sub

Private Sub UserForm_Activate()
FPU_vyhladat
frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value
lbVlastnici.ControlTipText = "Dvojklikom sa skop|fffd|ruje vlastn|fffd|k do schr|fffd|nky"
lblSV.ControlTipText = ""
lblKDS.ControlTipText = ""
lblSC.ControlTipText = ""
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
 Sheets("exp_imp").Cells(44, 7) = "nie"
 Sheets("exp_imp").Cells(48, 7).Value = frm_FPU.Top
 Sheets("exp_imp").Cells(49, 7).Value = frm_FPU.Left
End Sub
Private Sub cmbPridat_Click()
 Pridat_Do_Vv
End Sub

Private Sub cmbPridat_ClickSTARE()
Dim stlpec_LV As Integer
Dim stlpec_Ha As Integer
Dim stlpec_m2 As Integer
Dim stlpec_DP As Integer

With Sheets("exp_imp")
 stlpec_LV = .Cells(19, 2)
 stlpec_Ha = .Cells(23, 2)
 stlpec_m2 = .Cells(24, 2)
 stlpec_DP = .Cells(25, 2)
 .Cells(57, 4) = lblM2.Caption
End With
  
 Cells(AktivnyRiadok.Caption, stlpec_LV) = lblLV.Caption
 If Sheets("exp_imp").Cells(57, 5) <> 0 Then Cells(AktivnyRiadok.Caption, stlpec_Ha) = Sheets("exp_imp").Cells(57, 5)
 Cells(AktivnyRiadok.Caption, stlpec_m2) = Sheets("exp_imp").Cells(57, 6)
 Cells(AktivnyRiadok.Caption, stlpec_DP) = lblDP.Caption
End Sub

Private Sub IMGrozbalit_Click()
frmInfo.Visible = True
IMGrozbalit.Visible = False
IMGzbalit.Visible = True
frm_FPU.Width = 780
Sheets("exp_imp").Cells(46, 7) = 780
End Sub

Private Sub IMGzbalit_Click()
frmInfo.Visible = False
IMGzbalit.Visible = False
IMGrozbalit.Visible = True
frm_FPU.Width = 551
Sheets("exp_imp").Cells(46, 7) = 551
End Sub


Attribute VB_Name = "frm_FPU_pripojit"
Attribute VB_Base = "0{6E7F571B-C8C2-4EA1-8603-16FD71CFB4F2}{73D9C62F-2B7C-4C2C-BC3F-843D78F00D71}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub cmbOdpojitFPU_Click()
If optFPU.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) <> "nepripojen|fffd|" Then
  FPU_odpojit
  frm_FPU_pripojit.Hide
 Else
  MsgBox "Nie je pripojen|fffd| |fffd|iaden FPU s|fffd|bor."
 End If
End If
If optDBF.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) <> "nepripojen|fffd|" Then
  FPU_odpojit
  frm_FPU_pripojit.Hide
 Else
  MsgBox "Nie s|fffd| pripojen|fffd| |fffd|iadne DBF s|fffd|bory."
 End If
End If
If optCSV.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) <> "nepripojen|fffd|" Then
  FPU_odpojit
  frm_FPU_pripojit.Hide
 Else
  MsgBox "Nie s|fffd| pripojen|fffd| |fffd|iadne CSV s|fffd|bory."
 End If
End If
If optCSV_DBF.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) <> "nepripojen|fffd|" Then
  FPU_odpojit
  frm_FPU_pripojit.Hide
 Else
  MsgBox "Nie s|fffd| pripojen|fffd| |fffd|iadne CSV s|fffd|bory."
 End If
End If
End Sub

Private Sub cmbPripojitFPU_Click()

If optFPU.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
  lblFPUnazov.Caption = "moment"
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then FPU_pripojit "Vv" Else FPU_pripojit "Vstup"
  frm_FPU_pripojit.Hide
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then
   frm_FPU.Width = Sheets("exp_imp").Cells(46, 7).Value
   frm_FPU.Height = Sheets("exp_imp").Cells(47, 7).Value
   frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
   frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value
   frm_FPU.Show
  End If
  Sheets("exp_imp").Cells(16, 7) = ""
 Else
  MsgBox "S|fffd| pripojen|fffd| datab|fffd|zy. Najsk|fffd|r ich dajte odpoji|fffd| a n|fffd|sledne pripojte nov|fffd|."
 End If
End If

If optDBF.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
  lblFPUnazov.Caption = "moment"
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then FPU_pripojit "Vv" Else FPU_pripojit "Vstup"
  frm_FPU_pripojit.Hide
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then
   frm_FPU.Width = Sheets("exp_imp").Cells(46, 7).Value
   frm_FPU.Height = Sheets("exp_imp").Cells(47, 7).Value
   frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
   frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value
   frm_FPU.Show
  End If
  Sheets("exp_imp").Cells(16, 7) = ""
 Else
  MsgBox "S|fffd| pripojen|fffd| datab|fffd|zy. Najsk|fffd|r ich dajte odpoji|fffd| a n|fffd|sledne pripojte nov|fffd|."
 End If
End If

If optCSV.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
  lblFPUnazov.Caption = "moment"
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then FPU_pripojit "Vv" Else FPU_pripojit "Vstup"
  frm_FPU_pripojit.Hide
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then
   frm_FPU.Width = Sheets("exp_imp").Cells(46, 7).Value
   frm_FPU.Height = Sheets("exp_imp").Cells(47, 7).Value
   frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
   frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value
   frm_FPU.Show
  End If
  Sheets("exp_imp").Cells(16, 7) = ""
 Else
  MsgBox "S|fffd| pripojen|fffd| datab|fffd|zy. Najsk|fffd|r ich dajte odpoji|fffd| a n|fffd|sledne pripojte nov|fffd|."
 End If
End If

If optCSV_DBF.Value = True Then
 If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
  lblFPUnazov.Caption = "moment"
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then FPU_pripojit "Vv" Else FPU_pripojit "Vstup"
  frm_FPU_pripojit.Hide
  If Sheets("exp_imp").Cells(16, 7) = "Vv" Then
   frm_FPU.Width = Sheets("exp_imp").Cells(46, 7).Value
   frm_FPU.Height = Sheets("exp_imp").Cells(47, 7).Value
   frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
   frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value
   frm_FPU.Show
  End If
  Sheets("exp_imp").Cells(16, 7) = ""
 Else
  MsgBox "S|fffd| pripojen|fffd| datab|fffd|zy. Najsk|fffd|r ich dajte odpoji|fffd| a n|fffd|sledne pripojte nov|fffd|."
 End If
End If
ListyViditelne
End Sub

Private Sub optDBF_Click()
Sheets("exp_imp").Cells(43, 8) = "DBF"
End Sub

Private Sub optFPU_Click()
 Sheets("exp_imp").Cells(43, 8) = "FPU"
End Sub

Private Sub optCSV_Click()
Sheets("exp_imp").Cells(43, 8) = "CSV"
End Sub

Private Sub optCSV_DBF_Click()
Sheets("exp_imp").Cells(43, 8) = "CSV_DBF"
End Sub

Private Sub UserForm_Activate()
 lblFPUnazov.Caption = Sheets("exp_imp").Cells(43, 7)
   optFPU.Value = False
   optDBF.Value = False
   optCSV.Value = False
   optCSV_DBF.Value = False
   
 If Sheets("exp_imp").Cells(43, 8) = "FPU" Then optFPU.Value = True
 If Sheets("exp_imp").Cells(43, 8) = "DBF" Then optDBF.Value = True
 If Sheets("exp_imp").Cells(43, 8) = "CSV" Then optCSV.Value = True
 If Sheets("exp_imp").Cells(43, 8) = "CSV_DBF" Then optCSV_DBF.Value = True
End Sub
Attribute VB_Name = "frm_GPS"
Attribute VB_Base = "0{A279C4E7-0701-4171-9D99-36769BB767B3}{03292AA2-5509-49B6-B1A9-FED8EE1C02DA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub btnNastaveniaZosit_Click()
 frm_GPS.Hide
 Sheets("Nastavenia").Visible = True
 Sheets("Nastavenia").Select
 Sheets("Nastavenia").Cells(11, 29).Select
End Sub

Private Sub UserForm_Activate()
Dim i As Integer

With Sheets("Nastavenia")
 TextBox1.Text = .Cells(12, 30)
 TextBox2.Text = .Cells(13, 30)
 TextBox3.Text = .Cells(14, 30)
 TextBox4.Text = .Cells(15, 30)
 TextBox5.Text = ""
 ListBox.Clear
 
 i = 17
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 29) = "" Then
   Exit Do
  Else
  ListBox.AddItem Sheets("Nastavenia").Cells(i, 29)
  End If
 Loop
 
End With
End Sub

Private Sub ListBox_Click()
Dim i As Integer
Dim j As Integer

With Sheets("Nastavenia")
If ListBox.ListIndex <> -1 Then
 cmbPridat.Caption = "nov|fffd|"
 cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"

 i = 17
 Do
  i = i + 1
  If .Cells(i, 29) = ListBox.Text Then
   TextBox5.Text = .Cells(i, 29)
   Exit Do
  End If
  If .Cells(i, 29) = "" Then Exit Do
 Loop
End If
End With

End Sub

Private Sub cmbOdstranit_Click()
Dim i As Integer
Dim Vymazat_riadok As Integer

If cmbOdstranit.Caption = "zru|fffd|i|fffd|" Then
 
 TextBox5.Text = ""
 cmbPridat.Caption = "nov|fffd|"
 cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"

Else

 If ListBox.ListIndex <> -1 Then
  With Sheets("nastavenia")
   i = 17
   Do
    i = i + 1
    If .Cells(i, 29) = ListBox.Text Then
     Vymazat_riadok = i
     Exit Do
    End If
   Loop
        
   i = Vymazat_riadok - 1

   Do
    i = i + 1
    If .Cells(i, 29) = "" Then
     Exit Do
    Else
     .Cells(i, 29) = .Cells(i + 1, 29)
    End If
   Loop
    NACITANIE_CMB
   If Sheets("Vstup").cmbGPSmeno.ListCount = 0 Then
    Sheets("Vstup").cmbGPSmeno.Text = ""
    Sheets("exp_imp").Cells(2, 6) = ""
   End If
    
   If Sheets("Vstup").cmbGPSmeno.Text = ListBox.Text Then Sheets("Vstup").cmbGPSmeno.ListIndex = 0

   TextBox5.Text = ""
   ListBox.Clear
 
   i = 17
   Do
    i = i + 1
    If Sheets("Nastavenia").Cells(i, 29) = "" Then
     Exit Do
    Else
    ListBox.AddItem Sheets("Nastavenia").Cells(i, 29)
    End If
   Loop
  End With
 End If
End If

End Sub

Private Sub cmbPridat_Click()
 
If cmbPridat.Caption = "nov|fffd|" Then
 TextBox5.Text = ""
 ListBox.ListIndex = -1
 
 cmbPridat.Caption = "ulo|fffd|i|fffd|"
 cmbOdstranit.Caption = "zru|fffd|i|fffd|"
Else
 Pridat_Novy_Zaznam
End If
 
End Sub

Sub Pridat_Novy_Zaznam()
Dim i As Integer

With Sheets("Nastavenia")
 
  If TextBox5.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox5.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 17
   Do
    i = i + 1
    If .Cells(i, 29) = "" Then
     .Cells(i, 29) = TextBox5.Text
     Sheets("Vstup").cmbGPSmeno.AddItem TextBox5.Text
     Sheets("Vstup").cmbGPSmeno.Text = TextBox5.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
  
End With

End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
With Sheets("Nastavenia")
 .Cells(12, 30) = TextBox1.Text
 .Cells(13, 30) = TextBox2.Text
 .Cells(14, 30) = TextBox3.Text
 .Cells(15, 30) = TextBox4.Text
End With
End Sub
Attribute VB_Name = "frm_Hladat_KU"
Attribute VB_Base = "0{8A0F103E-A8B8-4BF8-85A0-F39E905278E5}{519C6D84-AE68-4F1B-BDB7-A1DBFB96F5DA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub btnHladat_Click()
Dim i As Double
Dim j As Double

tbNajdene.Clear

If tbVstup.Text <> "" Then
 With Sheets("KU")
  i = 1
  j = 0
  Do
   i = i + 1
   If .Cells(i, 1) = "" Then
    lblPocet.Caption = "Po|fffd|et n|fffd|jden|fffd|ch z|fffd|znamov: " & j
    Exit Do
   Else
    If InStr(1, .Cells(i, 6), tbVstup.Text, vbTextCompare) > 0 Then
     tbNajdene.AddItem .Cells(i, 6) & "/" & .Cells(i, 4) & "/" & .Cells(i, 2) & "/" & .Cells(i, 1)
     j = j + 1
    End If
   End If
  Loop
 End With
End If
End Sub

Private Sub btnPridatKU_Click()
Dim i As Integer

If tbNajdene.ListIndex <> -1 Then
 With Sheets("Vstup")
  .cmbKraj.Text = vyber_prvku(tbNajdene, 4, "/")
  .cmbOkres.Text = vyber_prvku(tbNajdene, 3, "/")
  .cmbObec.Text = vyber_prvku(tbNajdene, 2, "/")
  .cmbKatuz.Text = vyber_prvku(tbNajdene, 1, "/")
 End With
End If
tbNajdene.Clear
tbVstup.Text = ""
frm_Hladat_KU.Hide

End Sub

Private Sub tbNajdene_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
 btnPridatKU_Click
End Sub
Attribute VB_Name = "frm_Nastavenia"
Attribute VB_Base = "0{31C357A4-A1A4-4807-BE9F-5CDBC4EBD002}{1E7B025D-FBAD-4EC8-85CB-DD479242C05A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub btnNastaveniaZosit_Click()
 frm_Nastavenia.Hide
 Sheets("Nastavenia").Visible = True
 Sheets("Nastavenia").Select
 Sheets("Nastavenia").Cells(12, 1).Select
End Sub

Private Sub cmbOdstranit_Click()
Dim i As Integer
Dim Vymazat_riadok As Integer

If cmbOdstranit.Caption = "zru|fffd|i|fffd|" Then
 
 TextBox1.Text = ""
 TextBox2.Text = ""
 TextBox3.Text = ""
 TextBox4.Text = ""
 TextBox5.Text = ""
 TextBox6.Text = ""
 TextBox7.Text = ""
 TextBox8.Text = ""
 TextBox9.Text = ""
 TextBox10.Text = ""
 
 cmbPridat.Caption = "nov|fffd|"
 cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"

Else
 
 If ListBox.ListIndex <> -1 Then
  With Sheets("nastavenia")
   
   
   If frm_Nastavenia.Caption = "Nastavenia - firmy" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 1) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 1) = "" Then
      Exit Do
     Else
     .Cells(i, 1) = .Cells(i + 1, 1)
     .Cells(i, 2) = .Cells(i + 1, 2)
     .Cells(i, 3) = .Cells(i + 1, 3)
     .Cells(i, 4) = .Cells(i + 1, 4)
     .Cells(i, 5) = .Cells(i + 1, 5)
     .Cells(i, 6) = .Cells(i + 1, 6)
     .Cells(i, 7) = .Cells(i + 1, 7)
     .Cells(i, 8) = .Cells(i + 1, 8)
     .Cells(i, 9) = .Cells(i + 1, 9)
     .Cells(i, 10) = .Cells(i + 1, 10)
     End If
    Loop
    
    NACITANIE_CMB
    If Sheets("Vstup").cmbFirmy.ListCount = 0 Then
     Sheets("Vstup").cmbFirmy.Text = ""
     Sheets("exp_imp").Cells(2, 4) = ""
     Sheets("exp_imp").Cells(3, 4) = ""
     Sheets("exp_imp").Cells(4, 4) = ""
     Sheets("exp_imp").Cells(5, 4) = ""
     Sheets("exp_imp").Cells(6, 4) = ""
     Sheets("exp_imp").Cells(7, 4) = ""
     Sheets("exp_imp").Cells(8, 4) = ""
     Sheets("exp_imp").Cells(9, 4) = ""
     Sheets("exp_imp").Cells(10, 4) = ""
     Sheets("exp_imp").Cells(11, 4) = ""
     
    End If
    
    If Sheets("Vstup").cmbFirmy.Text = ListBox.Text Then Sheets("Vstup").cmbFirmy.ListIndex = 0
    firmy
      
   End If
   
   
   If frm_Nastavenia.Caption = "Nastavenia - pr|fffd|stroje" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 25) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 25) = "" Then
      Exit Do
     Else
     .Cells(i, 25) = .Cells(i + 1, 25)
     End If
    Loop
    
    NACITANIE_CMB
    If Sheets("Vstup").cmbPristroje.ListCount = 0 Then
     Sheets("Vstup").cmbPristroje.Text = ""
     Sheets("exp_imp").Cells(1, 6) = ""
    End If
    
    If Sheets("Vstup").cmbPristroje.Text = ListBox.Text Then Sheets("Vstup").cmbPristroje.ListIndex = 0
    pristroje
      
   End If
   
   
   If frm_Nastavenia.Caption = "Nastavenia - ozna|fffd|enie hran|fffd|c" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 27) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 27) = "" Then
      Exit Do
     Else
     .Cells(i, 27) = .Cells(i + 1, 27)
     End If
    Loop
    
    NACITANIE_CMB
    If Sheets("Vstup").cmbHranice.ListCount = 0 Then
     Sheets("Vstup").cmbHranice.Text = ""
     Sheets("exp_imp").Cells(3, 6) = ""
    End If
    
    If Sheets("Vstup").cmbHranice.Text = ListBox.Text Then Sheets("Vstup").cmbHranice.ListIndex = 0
    hranice
      
   End If
   
   
   If frm_Nastavenia.Caption = "Nastavenia - meral" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 20) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 20) = "" Then
      Exit Do
     Else
     .Cells(i, 20) = .Cells(i + 1, 20)
     End If
    Loop
    
    NACITANIE_CMB
    If Sheets("Vstup").cmbMeral.ListCount = 0 Then
     Sheets("Vstup").cmbMeral.Text = ""
     Sheets("exp_imp").Cells(4, 6) = ""
    End If
    
    If Sheets("Vstup").cmbMeral.Text = ListBox.Text Then Sheets("Vstup").cmbMeral.ListIndex = 0
    meral
      
   End If
   
  
   If frm_Nastavenia.Caption = "Nastavenia - vyhotovil" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 22) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 22) = "" Then
      Exit Do
     Else
     .Cells(i, 22) = .Cells(i + 1, 22)
     .Cells(i, 23) = .Cells(i + 1, 23)
     End If
    Loop
    
    NACITANIE_CMB
    If Sheets("Vstup").cmbVyhotovil.ListCount = 0 Then
     Sheets("Vstup").cmbVyhotovil.Text = ""
     Sheets("exp_imp").Cells(5, 6) = ""
     Sheets("exp_imp").Cells(9, 6) = ""
     
    End If
    
    If Sheets("Vstup").cmbVyhotovil.Text = ListBox.Text Then Sheets("Vstup").cmbVyhotovil.ListIndex = 0
    vyhotovil
      
   End If
   
   
   If frm_Nastavenia.Caption = "Nastavenia - autoriza|fffd|n|fffd| overovatelia" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 18) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 18) = "" Then
      Exit Do
     Else
     .Cells(i, 12) = .Cells(i + 1, 12)
     .Cells(i, 13) = .Cells(i + 1, 13)
     .Cells(i, 14) = .Cells(i + 1, 14)
     .Cells(i, 15) = .Cells(i + 1, 15)
     .Cells(i, 16) = .Cells(i + 1, 16)
     .Cells(i, 17) = .Cells(i + 1, 17)
     .Cells(i, 18) = .Cells(i + 1, 18)
     End If
    Loop
    
    NACITANIE_CMB
    If Sheets("Vstup").cmbOverovatel.ListCount = 0 Then
     Sheets("Vstup").cmbOverovatel.Text = ""
     Sheets("exp_imp").Cells(2, 8) = ""
     Sheets("exp_imp").Cells(3, 8) = ""
     Sheets("exp_imp").Cells(4, 8) = ""
     Sheets("exp_imp").Cells(5, 8) = ""
     Sheets("exp_imp").Cells(6, 8) = ""
     Sheets("exp_imp").Cells(7, 8) = ""
     Sheets("exp_imp").Cells(8, 8) = ""
    End If
    
    If Sheets("Vstup").cmbOverovatel.Text = ListBox.Text Then Sheets("Vstup").cmbOverovatel.ListIndex = 0
    overovatelia
      
   End If
   
   
   If frm_Nastavenia.Caption = "Nastavenia - druhy pozemkov" And frm_Nastavenia.lblPomLV_PK.Caption = "LV" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 32) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 32) = "" Then
      Exit Do
     Else
     .Cells(i, 32) = .Cells(i + 1, 32)
     .Cells(i, 33) = .Cells(i + 1, 33)
     .Cells(i, 34) = .Cells(i + 1, 34)
     End If
    Loop
    pozemky
    
   End If
   
   ''Pozemky PK
   If frm_Nastavenia.Caption = "Nastavenia - druhy pozemkov" And frm_Nastavenia.lblPomLV_PK.Caption = "PK" Then
    i = 12
    Do
     i = i + 1
     If .Cells(i, 35) = ListBox.Text Then
      Vymazat_riadok = i
      Exit Do
     End If
    Loop
        
    i = Vymazat_riadok - 1

    Do
     i = i + 1
     If .Cells(i, 35) = "" Then
      Exit Do
     Else
     .Cells(i, 35) = .Cells(i + 1, 35)
     .Cells(i, 36) = .Cells(i + 1, 36)
     .Cells(i, 37) = .Cells(i + 1, 37)
     End If
    Loop
    pozemkyPK
    
   End If
  
  End With
 End If

End If

TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F

End Sub

Private Sub cmbPridat_Click()
 
If cmbPridat.Caption = "nov|fffd|" Then
 TextBox1.Text = ""
 TextBox2.Text = ""
 TextBox3.Text = ""
 TextBox4.Text = ""
 TextBox5.Text = ""
 TextBox6.Text = ""
 TextBox7.Text = ""
 TextBox8.Text = ""
 TextBox9.Text = ""
 TextBox10.Text = ""
 ListBox.ListIndex = -1
 
TextBox1.Enabled = True
TextBox1.BackColor = &H80000005
TextBox2.Enabled = True
TextBox2.BackColor = &H80000005
TextBox3.Enabled = True
TextBox3.BackColor = &H80000005
TextBox4.Enabled = True
TextBox4.BackColor = &H80000005
TextBox5.Enabled = True
TextBox5.BackColor = &H80000005
TextBox6.Enabled = True
TextBox6.BackColor = &H80000005
TextBox7.Enabled = True
TextBox7.BackColor = &H80000005
TextBox8.Enabled = True
TextBox8.BackColor = &H80000005
TextBox9.Enabled = True
TextBox9.BackColor = &H80000005
TextBox10.Enabled = True
TextBox10.BackColor = &H80000005
 
 cmbPridat.Caption = "ulo|fffd|i|fffd|"
 cmbOdstranit.Caption = "zru|fffd|i|fffd|"
Else
 Pridat_Novy_Zaznam
End If
 
End Sub

Sub Pridat_Novy_Zaznam()
Dim i As Integer

With Sheets("Nastavenia")
 
 If frm_Nastavenia.Caption = "Nastavenia - firmy" Then
  If TextBox1.Text = "" Or TextBox3.Text = "" Or TextBox4.Text = "" Or TextBox5.Text = "" Or TextBox6.Text = "" Or TextBox7.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 1) = "" Then
     .Cells(i, 1) = TextBox1.Text
     .Cells(i, 2) = TextBox2.Text
     .Cells(i, 3) = TextBox3.Text
     .Cells(i, 4) = TextBox4.Text
     .Cells(i, 5) = TextBox5.Text
     .Cells(i, 6) = TextBox6.Text
     .Cells(i, 7) = TextBox7.Text
     .Cells(i, 8) = TextBox8.Text
     .Cells(i, 9) = TextBox9.Text
     .Cells(i, 10) = TextBox10.Text
     Sheets("Vstup").cmbFirmy.AddItem TextBox1.Text
     Sheets("Vstup").cmbFirmy.Text = TextBox1.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If

 If frm_Nastavenia.Caption = "Nastavenia - pr|fffd|stroje" Then
  If TextBox1.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 25) = "" Then
     .Cells(i, 25) = TextBox1.Text
     Sheets("Vstup").cmbPristroje.AddItem TextBox1.Text
     Sheets("Vstup").cmbPristroje.Text = TextBox1.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If

 If frm_Nastavenia.Caption = "Nastavenia - ozna|fffd|enie hran|fffd|c" Then
  If TextBox1.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 27) = "" Then
     .Cells(i, 27) = TextBox1.Text
     Sheets("Vstup").cmbHranice.AddItem TextBox1.Text
     Sheets("Vstup").cmbHranice.Text = TextBox1.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If

 If frm_Nastavenia.Caption = "Nastavenia - meral" Then
  If TextBox1.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 20) = "" Then
     .Cells(i, 20) = TextBox1.Text
     Sheets("Vstup").cmbMeral.AddItem TextBox1.Text
     Sheets("Vstup").cmbMeral.Text = TextBox1.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - vyhotovil" Then
  If TextBox1.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 22) = "" Then
     .Cells(i, 22) = TextBox1.Text
     .Cells(i, 23) = TextBox2.Text
     Sheets("Vstup").cmbVyhotovil.AddItem TextBox1.Text
     Sheets("Vstup").cmbVyhotovil.Text = TextBox1.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If

 If frm_Nastavenia.Caption = "Nastavenia - autoriza|fffd|n|fffd| overovatelia" Then
  If TextBox2.Text = "" Or TextBox3.Text = "" Or TextBox6.Text = "" Or TextBox7.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox7.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 18) = "" Then
     .Cells(i, 12) = TextBox1.Text
     .Cells(i, 13) = TextBox2.Text
     .Cells(i, 14) = TextBox3.Text
     .Cells(i, 15) = TextBox4.Text
     .Cells(i, 16) = TextBox5.Text
     .Cells(i, 17) = TextBox6.Text
     .Cells(i, 18) = TextBox7.Text
     Sheets("Vstup").cmbOverovatel.AddItem TextBox1.Text
     Sheets("Vstup").cmbOverovatel.Text = TextBox1.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - druhy pozemkov" And frm_Nastavenia.lblPomLV_PK.Caption = "LV" Then
  If TextBox1.Text = "" Or TextBox2.Text = "" Or TextBox3.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 32) = "" Then
     .Cells(i, 32) = TextBox1.Text
     .Cells(i, 33) = TextBox2.Text
     .Cells(i, 34) = TextBox3.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If
 
 ''Pozemky PK
 If frm_Nastavenia.Caption = "Nastavenia - druhy pozemkov" And frm_Nastavenia.lblPomLV_PK.Caption = "PK" Then
  If TextBox1.Text = "" Or TextBox2.Text = "" Or TextBox3.Text = "" Then
   MsgBox "Nevyplnen|fffd| povinn|fffd| polo|fffd|ka"
  Else
   ListBox.AddItem TextBox1.Text
   ListBox.ListIndex = ListBox.ListCount - 1
   i = 12
   Do
    i = i + 1
    If .Cells(i, 35) = "" Then
     .Cells(i, 35) = TextBox1.Text
     .Cells(i, 36) = TextBox2.Text
     .Cells(i, 37) = TextBox3.Text
     Exit Do
    End If
   Loop
   
   cmbPridat.Caption = "nov|fffd|"
   cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
  
  End If
 End If
 
End With

End Sub

Private Sub OptB_autorizacne_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = False
 cmbPK.Visible = False
 overovatelia
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub OptB_firma_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = False
 cmbPK.Visible = False
 firmy
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub OptB_hranice_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = False
 cmbPK.Visible = False
 hranice
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub OptB_meral_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = False
 cmbPK.Visible = False
 meral
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub OptB_pozemky_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = True
 cmbPK.Visible = True
 cmbLV.BackColor = &HFFFF00
 cmbPK.BackColor = &HC0C0C0
 lblPomLV_PK.Caption = "LV"
 pozemky
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub OptB_pristroje_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = False
 cmbPK.Visible = False
 pristroje
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub OptB_vyhotovil_Click()
 cmbPridat.Caption = "nov|fffd|"
 cmbLV.Visible = False
 cmbPK.Visible = False
 vyhotovil
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub ListBox_Click()
Dim i As Integer
Dim j As Integer

With Sheets("Nastavenia")
If ListBox.ListIndex <> -1 Then
 cmbPridat.Caption = "nov|fffd|"
 cmbOdstranit.Caption = "odstr|fffd|ni|fffd|"
 
TextBox1.Enabled = True
TextBox1.BackColor = &H80000005
TextBox2.Enabled = True
TextBox2.BackColor = &H80000005
TextBox3.Enabled = True
TextBox3.BackColor = &H80000005
TextBox4.Enabled = True
TextBox4.BackColor = &H80000005
TextBox5.Enabled = True
TextBox5.BackColor = &H80000005
TextBox6.Enabled = True
TextBox6.BackColor = &H80000005
TextBox7.Enabled = True
TextBox7.BackColor = &H80000005
TextBox8.Enabled = True
TextBox8.BackColor = &H80000005
TextBox9.Enabled = True
TextBox9.BackColor = &H80000005
TextBox10.Enabled = True
TextBox10.BackColor = &H80000005

 If frm_Nastavenia.Caption = "Nastavenia - firmy" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 1) = ListBox.Text Then

    TextBox1.Text = .Cells(i, 1)
    TextBox2.Text = .Cells(i, 2)
    TextBox3.Text = .Cells(i, 3)
    TextBox4.Text = .Cells(i, 4)
    TextBox5.Text = .Cells(i, 5)
    TextBox6.Text = .Cells(i, 6)
    TextBox7.Text = .Cells(i, 7)
    TextBox8.Text = .Cells(i, 8)
    TextBox9.Text = .Cells(i, 9)
    TextBox10.Text = .Cells(i, 10)
    Exit Do
   End If
   If .Cells(i, 1) = "" Then Exit Do
  Loop
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - pr|fffd|stroje" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 25) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 25)
    Exit Do
   End If
   If .Cells(i, 25) = "" Then Exit Do
  Loop
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - ozna|fffd|enie hran|fffd|c" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 27) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 27)
    Exit Do
   End If
   If .Cells(i, 27) = "" Then Exit Do
  Loop
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - meral" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 20) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 20)
    Exit Do
   End If
   If .Cells(i, 20) = "" Then Exit Do
  Loop
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - vyhotovil" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 22) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 22)
    TextBox2.Text = .Cells(i, 23)
    Exit Do
   End If
   If .Cells(i, 22) = "" Then Exit Do
  Loop
 End If
  
 If frm_Nastavenia.Caption = "Nastavenia - autoriza|fffd|n|fffd| overovatelia" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 18) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 12)
    TextBox2.Text = .Cells(i, 13)
    TextBox3.Text = .Cells(i, 14)
    TextBox4.Text = .Cells(i, 15)
    TextBox5.Text = .Cells(i, 16)
    TextBox6.Text = .Cells(i, 17)
    TextBox7.Text = .Cells(i, 18)
    Exit Do
   End If
   If .Cells(i, 18) = "" Then Exit Do
  Loop
 End If
 
 If frm_Nastavenia.Caption = "Nastavenia - druhy pozemkov" And frm_Nastavenia.lblPomLV_PK.Caption = "LV" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 32) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 32)
    TextBox2.Text = .Cells(i, 33)
    TextBox3.Text = .Cells(i, 34)
    Exit Do
   End If
   If .Cells(i, 32) = "" Then Exit Do
  Loop
 End If
 
 ''Pozemky PK
 If frm_Nastavenia.Caption = "Nastavenia - druhy pozemkov" And frm_Nastavenia.lblPomLV_PK.Caption = "PK" Then
  i = 12
  Do
   i = i + 1
   If .Cells(i, 35) = ListBox.Text Then
    TextBox1.Text = .Cells(i, 35)
    TextBox2.Text = .Cells(i, 36)
    TextBox3.Text = .Cells(i, 37)
    Exit Do
   End If
   If .Cells(i, 35) = "" Then Exit Do
  Loop
 End If
 
End If
End With

End Sub

Private Sub UserForm_Activate()
TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End Sub

Private Sub cmbLV_Click()
 cmbLV.BackColor = &HFFFF00
 cmbPK.BackColor = &HC0C0C0
 
If lblPomLV_PK.Caption = "PK" Then
 pozemky
 lblPomLV_PK.Caption = "LV"
 ListBox.ListIndex = -1
 TextBox1.Text = ""
 TextBox2.Text = ""
 TextBox3.Text = ""

TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F

End If

End Sub

Private Sub cmbPK_Click()
 cmbPK.BackColor = &HFFFF00
 cmbLV.BackColor = &HC0C0C0
 
 
If lblPomLV_PK.Caption = "LV" Then
pozemkyPK
lblPomLV_PK.Caption = "PK"
ListBox.ListIndex = -1
TextBox1.Text = ""
TextBox2.Text = ""
TextBox3.Text = ""

TextBox1.Enabled = False
TextBox1.BackColor = &H8000000F
TextBox2.Enabled = False
TextBox2.BackColor = &H8000000F
TextBox3.Enabled = False
TextBox3.BackColor = &H8000000F
TextBox4.Enabled = False
TextBox4.BackColor = &H8000000F
TextBox5.Enabled = False
TextBox5.BackColor = &H8000000F
TextBox6.Enabled = False
TextBox6.BackColor = &H8000000F
TextBox7.Enabled = False
TextBox7.BackColor = &H8000000F
TextBox8.Enabled = False
TextBox8.BackColor = &H8000000F
TextBox9.Enabled = False
TextBox9.BackColor = &H8000000F
TextBox10.Enabled = False
TextBox10.BackColor = &H8000000F
End If
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
  frm_Nastavenia.Hide
  NACITANIE_CMB
End Sub
Attribute VB_Name = "frm_Poznamky"
Attribute VB_Base = "0{94AF2DD8-3D15-408F-A364-80E31FC78428}{31611569-DF02-4291-ACBE-1207C0AA9D67}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub cmbExcel_Click()
Dim i As Integer
Dim pocet_riadkov As Integer
Dim Poznamky_OD As Integer
Dim Poznamky_Predvolene_OD As Integer

Sheets("exp_imp").Cells(10, 2) = ActiveSheet.Name
Poznamky_OD = 0
Poznamky_Predvolene_OD = 0
Sheets("Prehlad_poznamok").Visible = True
pocet_riadkov = pocet_riadkov_List("Prehlad_poznamok")

With Sheets("Prehlad_poznamok")
  .Visible = True
  For i = 1 To pocet_riadkov
    If .Cells(i, 1) = "DS / NS" Then
     Poznamky_OD = i + 1
     Exit For
    End If
  Next i
  For i = 1 To pocet_riadkov
    If .Cells(i, 12) = "Predvolen|fffd|/Navrhovan|fffd| pozn|fffd|mky:" Then
     Poznamky_Predvolene_OD = i + 1
     Exit For
    End If
  Next i
  
  If Poznamky_OD = 0 Then
   MsgBox "Nema|fffd| hlavi|fffd|ky v liste Prehlad_pozn|fffd|mok. Iba vkladaj samotn|fffd| pozn|fffd|mky od riadku 15. Ak si to u|fffd| zmenil a nevie|fffd| ako to opravi|fffd|, po|fffd|li mi mailom Tabulky."
  Else
    For i = Poznamky_OD To pocet_riadkov
     .Cells(i, 1) = ""
     .Cells(i, 2) = ""
     .Cells(i, 3) = ""
     .Cells(i, 4) = ""
    Next i
  End If
  
  For i = 3 To Sheets("poznamky_XML").Cells(1, 1)
    .Cells(Poznamky_OD, 1).Value = Sheets("poznamky_XML").Cells(i, 1).Value
    .Cells(Poznamky_OD, 2).Value = Sheets("poznamky_XML").Cells(i, 2).Value
    .Cells(Poznamky_OD, 3).Value = Sheets("poznamky_XML").Cells(i, 3).Value
    .Cells(Poznamky_OD, 4).Value = Sheets("poznamky_XML").Cells(i, 4).Value
    Poznamky_OD = Poznamky_OD + 1
  Next i
  
  .Select
  .Cells(Poznamky_OD, 1).Select
End With

With Sheets("poznamky")
 For i = Poznamky_Predvolene_OD To pocet_riadkov
  Cells(i, 12) = ""
  Cells(i, 13) = ""
 Next i
 
 For i = 3 To .Cells(1, 3)
  Cells(Poznamky_Predvolene_OD, 12) = .Cells(i, 1)
  Cells(Poznamky_Predvolene_OD, 13) = .Cells(i, 2)
  Poznamky_Predvolene_OD = Poznamky_Predvolene_OD + 1
 Next i
End With

frm_Poznamky.Hide
End Sub

Private Sub lbPredvolenePC_Click()
Dim i As Integer
 i = 2
 With Sheets("poznamky")
 Do
  i = i + 1
  If .Cells(i, 2) = "" Then
   Exit Do
  Else
   .Cells(2, 10) = .Cells(i, 2)
   If .Cells(i, 1) & "   " & .Cells(2, 23) = lbPredvolenePC.Text Then
    tbPridatPoznamkuPC.Text = .Cells(2, 23)
    .Cells(5, 21) = .Cells(2, 10)
    Exit Do
   End If
  End If
 Loop
 End With
End Sub

Private Sub lbPredvolenePC_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
 btnPridatPC_OK
End Sub

Private Sub lbPredvoleneBezPC_Click()
Dim i As Integer
i = 2
With Sheets("poznamky")
 Do
  i = i + 1
  If .Cells(i, 2) = "" Then
   Exit Do
  Else
   If .Cells(i, 1) & "  " & .Cells(i, 2) = lbPredvoleneBezPC.Text Then
    tbPridatPoznamkuBezPC.Text = .Cells(i, 2)
    Exit Do
   End If
  End If
 Loop
End With
End Sub

Private Sub lbPredvoleneBezPC_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
 btnPridatBezPC_OK
End Sub

Private Sub btnPridatBezPCOk_Click()
 btnPridatBezPC_OK
End Sub

Private Sub lbPriradenePoznamkyBezPC_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    btnDelPoznamkuBezPC_Click
End Sub

Private Sub UpravaPredvolenych_all_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
 predvoleneMinus_Click
End Sub

Private Sub UserForm_Activate()
    frm_Poznamky.Width = 680
    Poznamky
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    Sheets("exp_imp").Cells(18, 3) = "nie"
    Sheets("exp_imp").Cells(18, 4) = "nie"
    Sheets("poznamky").Cells(5, 21) = ""
End Sub

Private Sub btnPridatPCOk_Click()
 btnPridatPC_OK
End Sub

Private Sub pgPoznamky_Click(ByVal Index As Long)
If pgPoznamky.Value = 3 Then
 frm_Poznamky.Height = 411
 pgPoznamky.Height = 378
 NacitaniePredvolenychPoznamok_uprava
Else
 frm_Poznamky.Height = 225
 pgPoznamky.Height = 168
End If

NacitaniePredvolenychPoznamok
NacitaniePredvolenychPoznamok_uprava
Aktualizovat_lbPriradenePoznamky
Aktualizovat_lbPriradenePoznamkyPC
Aktualizovat_lbPriradenePoznamkyBezPC
End Sub

Private Sub btnDelPoznamkuPC_Click()
Dim i As Integer
Dim DRN As String

If lbPriradenePoznamkyPC.ListCount > 0 And lbPriradenePoznamkyPC.Text <> "" Then
 If lblStav.Caption = "Doteraj|fffd||fffd| stav" Then DRN = "PARCELA_DS"
 If lblStav.Caption = "Nov|fffd| stav" Then DRN = "PARCELA_NS"
 If lblStav.Caption = "Zmeny" Then DRN = "ZMENY"

 With Sheets("poznamky_XML")
  i = 2
  Do
   i = i + 1
   If .Cells(i, 4) = lbPriradenePoznamkyPC.Text And .Cells(i, 3) = lblPC.Caption And .Cells(i, 2) = lblDRN.Caption And .Cells(i, 1) = DRN Then
    .Rows(i).Delete
    Aktualizovat_lbPriradenePoznamky
    Aktualizovat_lbPriradenePoznamkyPC
    Exit Do
   End If
  Loop
 End With

End If

End Sub

Private Sub btnDelPoznamkuBezPC_Click()
Dim i As Integer

If lbPriradenePoznamkyBezPC.ListCount > 0 And lbPriradenePoznamkyBezPC.Text <> "" Then
 With Sheets("poznamky_XML")
  i = 2
  Do
   i = i + 1
   If .Cells(i, 4) = lbPriradenePoznamkyBezPC.Text And .Cells(i, 1) = "BEZ_PC" Then
    .Rows(i).Delete
    Aktualizovat_lbPriradenePoznamky
    Aktualizovat_lbPriradenePoznamkyBezPC
    Exit Do
   End If
  Loop
 End With

End If

End Sub


Private Sub lbPriradenePoznamkyPC_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    btnDelPoznamkuPC_Click
End Sub

Private Sub btnDelPoznamku_Click()
If lbPriradenePoznamky.ListIndex <> -1 Then
 Sheets("poznamky_XML").Rows(lbPriradenePoznamky.ListIndex + 3).Delete
End If

Aktualizovat_lbPriradenePoznamky
Aktualizovat_lbPriradenePoznamkyPC
  
End Sub

Private Sub lbPriradenePoznamky_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    btnDelPoznamku_Click
End Sub

Private Sub btnPridatVybranu_Click()
  Vlozit_poznamky jednu_viac:="jednu", index_vybranej:=lbPriradenePoznamky.ListIndex + 3
End Sub

Private Sub btnPridatVsetky_Click()
  Vlozit_poznamky jednu_viac:="viac", index_vybranej:=1
End Sub

Private Sub UpravaPredvolenych_all_Click()
Dim i As Integer

With Sheets("poznamky")
 i = 2
 Do
  i = i + 1
  If .Cells(i, 2) = "" Then
   Exit Do
  Else
   If UpravaPredvolenych_all.Text = .Cells(i, 1).Text & "  " & .Cells(i, 2).Text Then
      tbPopis.Text = .Cells(i, 1).Text
      tbText.Text = .Cells(i, 2).Text
   End If
  End If
 Loop
End With

editovatPredvolene.Enabled = True
predvoleneMinus.Enabled = True

End Sub

Private Sub editovatPredvolene_Click()
Dim i As Integer

If UpravaPredvolenych_all.ListIndex <> -1 Then
 With Sheets("poznamky")
  i = 2
  Do
   i = i + 1
   If .Cells(i, 2) = "" Then
    Exit Do
   Else
    If UpravaPredvolenych_all.Text = .Cells(i, 1).Text & "  " & .Cells(i, 2).Text Then
     .Cells(i, 1) = tbPopis.Text
     .Cells(i, 2) = tbText.Text
     Exit Do
    End If
   End If
  Loop
 End With
 
 tbPopis.Text = ""
 tbText.Text = ""
 editovatPredvolene.Enabled = False
 predvoleneMinus.Enabled = False

 NacitaniePredvolenychPoznamok_uprava

End If
End Sub

Private Sub predvolenePlus_Click()
Dim i As Integer

If tbPopis.Text <> "" And tbText.Text <> "" Then
 With Sheets("poznamky")
  .Cells(.Cells(1, 1) + 1, 2) = tbText.Text
  .Cells(.Cells(1, 1) + 1, 1) = tbPopis.Text
 End With
 
 NacitaniePredvolenychPoznamok_uprava
 
 UpravaPredvolenych_all.ListIndex = UpravaPredvolenych_all.ListCount - 1
 tbPopis.Text = ""
 tbText.Text = ""
 
End If
End Sub

Private Sub predvoleneMinus_Click()
Dim i As Integer
Dim zmazat As Integer

zmazat = -1

If UpravaPredvolenych_all.ListIndex <> -1 Then
 With Sheets("poznamky")
  For i = 3 To .Cells(1, 1)
   If UpravaPredvolenych_all.Text = .Cells(i, 1).Text & "  " & .Cells(i, 2).Text Then zmazat = i
  Next i
 
  If zmazat <> -1 Then .Rows(zmazat).Delete
 End With
     
 NacitaniePredvolenychPoznamok_uprava
 
 UpravaPredvolenych_all.ListIndex = -1
 tbPopis.Text = ""
 tbText.Text = ""
 editovatPredvolene.Enabled = False
 predvoleneMinus.Enabled = False

End If
End Sub

Attribute VB_Name = "frm_XML"
Attribute VB_Base = "0{1A4A8F31-20D6-49EE-9923-7183222D7999}{3F777A59-D512-4FE9-BE7D-69D0D06DA2A1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim retazec As String

Private Sub UserForm_Activate()
Dim pocet As Integer

pocet = 0
 frm_XML.Caption = "export XML (" & Sheets("exp_imp").Cells(8, 1).Text & ".xml)"
 cbKodovanie.Clear
 cbKodovanie.AddItem "windows-1250"
 cbKodovanie.AddItem "ISO-8859-1"
 cbKodovanie.AddItem "UTF-8"
 cbKodovanie.ListIndex = 0
 
 lbInfo.Clear
 lbPoznamky.Clear
 lbInfo.ForeColor = &H80000012
 
 tbGPC.Text = Sheets("Vstup").Cells(3, 4)
 tbZPMZ.Text = Sheets("Vstup").Cells(10, 4)
 tbUcel.Text = Sheets("Vstup").Cells(25, 4)
 tbNOK.Text = Sheets("exp_imp").Cells(2, 2)
 tbCOK.Text = Sheets("exp_imp").Cells(3, 2)
 tbNKU.Text = Sheets("exp_imp").Cells(5, 2)
 tbCKU.Text = Sheets("exp_imp").Cells(6, 2)
 
 tbNazov.Text = Sheets("exp_imp").Cells(2, 4)
 tbICO.Text = Sheets("exp_imp").Cells(8, 4)
 
 'tbVyhotovilDatum.Text = Sheets("Vstup").Cells(21, 4)
 tbVyhotovilDatum.Text = Upravit_Datum(Sheets("Vstup").Cells(21, 4).Text)              '20190506
 tbVyhotovilMeno.Text = Sheets("exp_imp").Cells(5, 6)
 
 tbAO_datum.Text = Upravit_Datum(Sheets("Vstup").Cells(23, 4).Text)
 tbAO_meno.Text = Sheets("exp_imp").Cells(3, 8)
 tbAO_priezvisko.Text = Sheets("exp_imp").Cells(4, 8)
 tbAO_opravnenie.Text = Sheets("exp_imp").Cells(7, 8)
 
 If tbGPC.Text = "" Then
    pocet = pocet + 1
    tbGPC.BackColor = &HFF&
 Else
    tbGPC.BackColor = &H80000005
 End If
 
 If tbZPMZ.Text = "" Then
    pocet = pocet + 1
    tbZPMZ.BackColor = &HFF&
 Else
    tbZPMZ.BackColor = &H80000005
 End If
 
 If tbUcel.Text = "" Then
    pocet = pocet + 1
    tbUcel.BackColor = &HFF&
 Else
    tbUcel.BackColor = &H80000005
 End If
 
 If tbNOK.Text = "" Then
    pocet = pocet + 1
    tbNOK.BackColor = &HFF&
 Else
    tbNOK.BackColor = &H80000005
 End If
 
 If tbCOK.Text = "" Then
    pocet = pocet + 1
    tbCOK.BackColor = &HFF&
 Else
    tbCOK.BackColor = &H80000005
 End If
 
 If tbNKU.Text = "" Then
    pocet = pocet + 1
    tbNKU.BackColor = &HFF&
 Else
    tbNKU.BackColor = &H80000005
 End If
 
 If tbCKU.Text = "" Then
    pocet = pocet + 1
    tbCKU.BackColor = &HFF&
 Else
    tbCKU.BackColor = &H80000005
 End If
 
 If tbNazov.Text = "" Then
    pocet = pocet + 1
    tbNazov.BackColor = &HFF&
 Else
    tbNazov.BackColor = &H80000005
 End If
 
 If tbICO.Text = "" Then
    pocet = pocet + 1
    tbICO.BackColor = &HFF&
 Else
    tbICO.BackColor = &H80000005
 End If
 
 If tbVyhotovilDatum.Text = "" Then
    pocet = pocet + 1
    tbVyhotovilDatum.BackColor = &HFF&
 Else
    tbVyhotovilDatum.BackColor = &H80000005
 End If
 
 If tbVyhotovilMeno.Text = "" Then
    pocet = pocet + 1
    tbVyhotovilMeno.BackColor = &HFF&
 Else
    tbVyhotovilMeno.BackColor = &H80000005
 End If
 
 If tbAO_datum.Text = "" Then
    pocet = pocet + 1
    tbAO_datum.BackColor = &HFF&
 Else
    tbAO_datum.BackColor = &H80000005
 End If
 
 If tbAO_meno.Text = "" Then
    pocet = pocet + 1
    tbAO_meno.BackColor = &HFF&
 Else
    tbAO_meno.BackColor = &H80000005
 End If
 
 If tbAO_priezvisko.Text = "" Then
    pocet = pocet + 1
    tbAO_priezvisko.BackColor = &HFF&
 Else
    tbAO_priezvisko.BackColor = &H80000005
 End If
 
 If tbAO_opravnenie.Text = "" Then
    pocet = pocet + 1
    tbAO_opravnenie.BackColor = &HFF&
 Else
    tbAO_opravnenie.BackColor = &H80000005
 End If
 
 If pocet <> 0 Then
      lbInfo.AddItem "Ch|fffd|ba povinn|fffd| polo|fffd|ka"
      lbInfo.ForeColor = &HFF&
 End If
 
 If cmbRuseneStavby.Caption = "ru|fffd|en|fffd| stavby [ 0 ]" Then cmbRuseneStavby.Visible = False Else cmbRuseneStavby.Visible = True
 
 With Sheets("Vstup")
  If Len(.Cells(25, 4).Text) > 250 Then _
   lbInfo.AddItem "|fffd||fffd|el GP m|fffd| viac znakov, ako je dovolen|fffd| - m|fffd||fffd|e ma|fffd| maxim|fffd|lne 250 znakov)"
 
  If Len(.Cells(26, 4).Text) > 500 Then
   lbInfo.AddItem "Pozn|fffd|mka GP m|fffd| viac znakov, ako je dovolen|fffd| - m|fffd||fffd|e ma|fffd| maxim|fffd|lne 500 znakov!"
   tbpoznamka.Text = "vid priloha"
''    If retazec = "" Then retazec = .Cells(26, 3).Text Else retazec = retazec & vbCrLf & .Cells(26, 3).Text
  Else
   tbpoznamka.Text = .Cells(26, 4).Text
  End If
 End With
 
 If lbInfo.ListCount = 0 Then lbInfo.AddItem "V|fffd|etko by malo by|fffd| v poriadku."
 
 pridatPoznamky
 
End Sub

Private Sub pridatPoznamky()
Dim i As Integer
Dim pocet As Integer
Dim riadok As String

pocet = 0
With Sheets("poznamky_XML")
 If .Cells(1, 1) > 2 Then
  For i = 3 To .Cells(1, 1)
   If .Cells(i, 1) = "PARCELA_DS" Then
    lbPoznamky.AddItem "Doteraj|fffd||fffd| stav  p.|fffd|. " & .Cells(i, 3) & " - " & .Cells(i, 4)
    pocet = pocet + 1
   End If
   If .Cells(i, 1) = "DIEL" Then
    lbPoznamky.AddItem "Diel |fffd|." & .Cells(i, 3) & " - " & .Cells(i, 4)
    pocet = pocet + 1
   End If
   If .Cells(i, 1) = "PARCELA_NS" Then
    lbPoznamky.AddItem "Nov|fffd| stav  p.|fffd|. " & .Cells(i, 3) & " - " & .Cells(i, 4)
    pocet = pocet + 1
   End If
  Next i
 End If
 If pocet = 0 Then lbPoznamky.AddItem "|fffd|iadne priraden|fffd| pozn|fffd|mky"
End With

End Sub

Private Sub cmbRuseneStavby_Click()
Dim i As Integer
Dim pocet As Integer
Dim riadok As String
    
riadok = "p.|fffd|. \ s|fffd|pisn|fffd| |fffd||fffd|slo \ sp|fffd|sob vyu|fffd||fffd|vania" & vbCrLf
pocet = 0
With Sheets("XML")
    For i = 2 To .Cells(1, 1)
        If .Cells(i, 1) = "RUSENIE_STAVBY" Then
            riadok = riadok & vbCrLf & .Cells(i, 2) & " \ " & .Cells(i, 3) & " \ " & .Cells(i, 4)
            pocet = pocet + 1
        End If
    Next i
    If pocet <> 0 Then MsgBox riadok, , "ru|fffd|en|fffd| stavby" Else MsgBox "|fffd|iadne ru|fffd|en|fffd| stavby", , "ru|fffd|en|fffd| stavby"
End With
End Sub

Private Sub lbInfo_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If lbInfo.Text <> "V|fffd|etko by malo by|fffd| v poriadku." Then MsgBox lbInfo.Text, vbOKOnly, "Chyby XML"
End Sub

Private Sub lbPoznamky_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If lbPoznamky.Text <> "|fffd|iadne priraden|fffd| pozn|fffd|mky" Then MsgBox lbPoznamky.Text, vbOKOnly, "Pozn|fffd|mka"
End Sub

Private Sub cmbOK_Click()
Dim YesNo As Variant
Dim DefFolder As String
Dim XMLFileName As String
Dim TXTFileName As String
Dim i As Integer
Dim j As Integer
Dim GP_Popis As String
Dim Vyhotovitel As String
Dim Aut_Over As String
Dim zmeny As Boolean
zmeny = False
Dim LV As Boolean
Dim PKV As Boolean
Dim pocet_poznamok As Integer
Dim poznamka As String
Dim stavba As Boolean
Dim rusene_stavby_pocet As Integer
Dim rusene_stavby As Boolean

With Sheets("exp_imp")

 XMLFileName = .Cells(8, 1).Text & ".xml"
 TXTFileName = .Cells(8, 1).Text & ".txt"
 Open XMLFileName For Output As #1
 Print #1, "<?xml version=" & Chr(34) & "1.0" & Chr(34) & " encoding=" & Chr(34) & _
           cbKodovanie.Text & Chr(34) & " standalone=" & Chr(34) & "yes" & Chr(34) & " ?>"
 Print #1, Chr(13)
 Print #1, "<ROOT>"
 
 GP_Popis = Chr(9) & "<GP_POPIS" _
                    & " cku=" & Chr(34) & tbCKU.Text & Chr(34) _
                    & " nku=" & Chr(34) & tbNKU.Text & Chr(34) _
                    & " cok=" & Chr(34) & tbCOK.Text & Chr(34) _
                    & " nok=" & Chr(34) & tbNOK.Text & Chr(34) _
                    & " zpmz=" & Chr(34) & tbZPMZ.Text & Chr(34)
                    
 If Sheets("Vstup").Cells(9, 4) <> "" Then GP_Popis = GP_Popis & " clm=" & Chr(34) & Sheets("Vstup").Cells(9, 4) & Chr(34)
 
 GP_Popis = GP_Popis & " gpc=" & Chr(34) & tbGPC.Text & Chr(34) _
                     & " ucel=" & Chr(34) & tbUcel.Text & Chr(34) _
 
 If .Cells(3, 6) <> "" Then GP_Popis = GP_Popis & " ozn_hranic=" & Chr(34) & .Cells(3, 6) & Chr(34)
 If Sheets("Vstup").Cells(26, 4) <> "" Then GP_Popis = GP_Popis & " poznamka=" & Chr(34) & Sheets("Vstup").Cells(26, 4) & Chr(34)
  
 GP_Popis = GP_Popis & " />"
   
 Print #1, GP_Popis

 Vyhotovitel = Chr(9) & "<VYHOTOVITEL" _
                      & " nazov=" & Chr(34) & tbNazov.Text & Chr(34) _
                      & " ico=" & Chr(34) & tbICO.Text & Chr(34)
 If .Cells(10, 4) <> "" Then Vyhotovitel = Vyhotovitel & " tel=" & Chr(34) & .Cells(10, 4) & Chr(34)
 If .Cells(11, 4) <> "" Then Vyhotovitel = Vyhotovitel & " email=" & Chr(34) & .Cells(11, 4).Value & Chr(34)
 Vyhotovitel = Vyhotovitel & ">"
  
 Print #1, Vyhotovitel
                    
 Print #1, Chr(9) & Chr(9) & "<ADRESA" _
                           & " ulica=" & Chr(34) & .Cells(4, 4) & Chr(34) _
                           & " cislo=" & Chr(34) & .Cells(5, 4) & Chr(34) _
                           & " mesto=" & Chr(34) & .Cells(6, 4) & Chr(34) _
                           & " psc=" & Chr(34) & .Cells(7, 4) & Chr(34) _
                           & " />"
  
 Print #1, Chr(9) & Chr(9) & "<VYHOTOVIL" _
                           & " meno=" & Chr(34) & .Cells(5, 6) & Chr(34) _
                           & " datum=" & Chr(34) & tbVyhotovilDatum.Text & Chr(34) _
                           & " />"
                           'Sheets("Vstup").Cells(21, 4) & Chr(34) - namiesto tbvyhotovil
 Print #1, Chr(9) & "</VYHOTOVITEL>"
  
 Aut_Over = Chr(9) & "<AUT_OVER" _
                   & " datum=" & Chr(34) & tbAO_datum.Text & Chr(34) ' Sheets("Vstup").Cells(23, 4) & Chr(34)
  
 If .Cells(2, 8) <> "" Then Aut_Over = Aut_Over _
                    & " ico=" & Chr(34) & .Cells(2, 8) & Chr(34) _
 
 Aut_Over = Aut_Over _
                    & " meno=" & Chr(34) & .Cells(3, 8) & Chr(34) _
                    & " priezvisko=" & Chr(34) & .Cells(4, 8) & Chr(34)
 If .Cells(5, 8) <> "" Then Aut_Over = Aut_Over _
                    & " titul_pred=" & Chr(34) & .Cells(5, 8) & Chr(34)
 If .Cells(6, 8) <> "" Then Aut_Over = Aut_Over _
                    & " titul_za=" & Chr(34) & .Cells(6, 8) & Chr(34)
 Aut_Over = Aut_Over _
                    & " cislo_opravnenia=" & Chr(34) & .Cells(7, 8) & Chr(34) _
                    & " />"
  
 Print #1, Aut_Over
 
 Print #1, Chr(9) & "<KU" _
                    & " cku=" & Chr(34) & .Cells(6, 2) & Chr(34) _
                    & ">"
End With

With Sheets("XML")
'****************************************************************************************Doterajsi stav
 Print #1, Chr(9) & Chr(9) & "<DS>"
 
 For i = 1 To .Cells(1, 1)
                                        If .Cells(i, 1) = "DIEL" Then zmeny = True    'zistenie ci su diely
  If .Cells(i, 1) = "PARCELA_DS" Then
   LV = False
   PKV = False
   
   If .Cells(i, 4).Text <> "" Then      'Existuje LV
    LV = True
   End If
   If .Cells(i, 5).Text <> "" Then      'Existuje PKV
    PKV = True
   End If
   ''********************************************************************Poznamky DS
   pocet_poznamok = 0
   poznamka = ""
   For j = 3 To Sheets("poznamky_XML").Cells(1, 1)
    If Sheets("poznamky_XML").Cells(j, 1).Text = "PARCELA_DS" Then
     If Sheets("poznamky_XML").Cells(j, 2).Text = .Cells(i, 2).Text Then
      If Sheets("poznamky_XML").Cells(j, 3).Text = .Cells(i, 3).Text Then _
         pocet_poznamok = pocet_poznamok + 1
     End If
    End If
   Next j

   If pocet_poznamok > 1 Then
    For j = 3 To Sheets("poznamky_XML").Cells(1, 1)
     If Sheets("poznamky_XML").Cells(j, 1).Text = "PARCELA_DS" Then
      If Sheets("poznamky_XML").Cells(j, 2).Text = .Cells(i, 2).Text Then
       If Sheets("poznamky_XML").Cells(j, 3).Text = .Cells(i, 3).Text Then
        If retazec = "" Then retazec = Sheets("poznamky_XML").Cells(j, 4).Text Else _
           retazec = retazec & vbCrLf & Sheets("poznamky_XML").Cells(j, 4).Text
       End If
      End If
     End If
    Next j
    poznamka = "vid priloha"
   End If
    
   If pocet_poznamok = 1 Then
    If Len(.Cells(i, 20).Text) > 500 Then
     If retazec = "" Then retazec = .Cells(i, 20).Text Else _
        retazec = retazec & vbCrLf & .Cells(i, 20).Text
        poznamka = "vid priloha"
    End If
    If Len(.Cells(i, 20).Text) <= 500 Then poznamka = .Cells(i, 20).Text
   End If
   ''********************************************************************Poznamky DS - koniec
   If LV = True Then
    If PKV = True Then
     If poznamka <> "" Then                                          'LV + PKV + POZNAMKA
      Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_DS" _
                & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
                & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
                & " clv=" & Chr(34) & .Cells(i, 4) & Chr(34) _
                & " pkv=" & Chr(34) & .Cells(i, 5) & Chr(34) _
                & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
                & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
                & " poznamka=" & Chr(34) & poznamka & Chr(34) _
                & " />"
     Else                                                            'LV + PKV + BEZ POZNAMKY
      Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_DS" _
                & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
                & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
                & " clv=" & Chr(34) & .Cells(i, 4) & Chr(34) _
                & " pkv=" & Chr(34) & .Cells(i, 5) & Chr(34) _
                & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
                & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
                & " />"
     End If
    Else                                                             'LV + BEZ PKV + POZNAMKA
     If poznamka <> "" Then
      Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_DS" _
                & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
                & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
                & " clv=" & Chr(34) & .Cells(i, 4) & Chr(34) _
                & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
                & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
                & " poznamka=" & Chr(34) & poznamka & Chr(34) _
                & " />"
     Else                                                            'LV + BEZ PKV + BEZ POZNAMKY
      Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_DS" _
                & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
                & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
                & " clv=" & Chr(34) & .Cells(i, 4) & Chr(34) _
                & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
                & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
                & " />"
     End If
    End If
   Else
    If poznamka <> "" Then                                          'PKV + POZNAMKA
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_DS" _
               & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
               & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
               & " pkv=" & Chr(34) & .Cells(i, 5) & Chr(34) _
               & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
               & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
               & " poznamka=" & Chr(34) & poznamka & Chr(34) _
               & " />"
    Else                                                            'PKV + BEZ POZNAMKY
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_DS" _
               & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
               & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
               & " pkv=" & Chr(34) & .Cells(i, 5) & Chr(34) _
               & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
               & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
               & " />"
    End If
   End If
  End If
 Next i
 Print #1, Chr(9) & Chr(9) & "</DS>"
'****************************************************************************************Doterajsi stav - koniec

'****************************************************************************************ZMENY / DIELY
 
 If zmeny = True Then
  Print #1, Chr(9) & Chr(9) & "<ZMENY>"
  For i = 1 To .Cells(1, 1)
   If .Cells(i, 1) = "DIEL" Then
   '********************************************************************Poznamky ZMENY
    pocet_poznamok = 0
    poznamka = ""
    For j = 3 To Sheets("poznamky_XML").Cells(1, 1)
     If Sheets("poznamky_XML").Cells(j, 1).Text = "DIEL" Then
       If Sheets("poznamky_XML").Cells(j, 3).Text = .Cells(i, 8).Text Then _
          pocet_poznamok = pocet_poznamok + 1
     End If
    Next j

    If pocet_poznamok > 1 Then
     For j = 3 To Sheets("poznamky_XML").Cells(1, 1)
      If Sheets("poznamky_XML").Cells(j, 1).Text = "DIEL" Then
       If Sheets("poznamky_XML").Cells(j, 3).Text = .Cells(i, 8).Text Then
        If retazec = "" Then retazec = Sheets("poznamky_XML").Cells(j, 4).Text Else _
            retazec = retazec & vbCrLf & Sheets("poznamky_XML").Cells(j, 4).Text
       End If
      End If
     Next j
     poznamka = "vid priloha"
    End If
    
    If pocet_poznamok = 1 Then
     If Len(.Cells(i, 20).Text) > 500 Then
      If retazec = "" Then retazec = .Cells(i, 20).Text Else _
         retazec = retazec & vbCrLf & .Cells(i, 20).Text
         poznamka = "vid priloha"
     End If
     If Len(.Cells(i, 20).Text) <= 500 Then poznamka = .Cells(i, 20).Text
    End If
   '********************************************************************Poznamky ZMENY
    If poznamka <> "" Then
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<DIEL" _
             & " cdi=" & Chr(34) & .Cells(i, 8) & Chr(34) _
             & " ds_cpa=" & Chr(34) & .Cells(i, 9) & Chr(34) _
             & " ds_drn=" & Chr(34) & .Cells(i, 10) & Chr(34) _
             & " ns_cpa=" & Chr(34) & .Cells(i, 11) & Chr(34) _
             & " ns_drn=" & Chr(34) & .Cells(i, 12) & Chr(34) _
             & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
             & " poznamka=" & Chr(34) & poznamka & Chr(34) _
             & " />"
    Else
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<DIEL" _
             & " cdi=" & Chr(34) & .Cells(i, 8) & Chr(34) _
             & " ds_cpa=" & Chr(34) & .Cells(i, 9) & Chr(34) _
             & " ds_drn=" & Chr(34) & .Cells(i, 10) & Chr(34) _
             & " ns_cpa=" & Chr(34) & .Cells(i, 11) & Chr(34) _
             & " ns_drn=" & Chr(34) & .Cells(i, 12) & Chr(34) _
             & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
             & " />"
    End If
   End If
  Next i
  Print #1, Chr(9) & Chr(9) & "</ZMENY>"
 End If
'****************************************************************************************ZMENY / DIELY - koniec

'****************************************************************************************Novy stav
 Print #1, Chr(9) & Chr(9) & "<NS>"
 
 For i = 1 To .Cells(1, 1)
  stavba = False
  rusene_stavby = False
  If .Cells(i, 1) = "PARCELA_NS" Then
   If .Cells(i, 14).Text <> "" Then
    stavba = True
    If .Cells(i, 9).Text = "" Then .Cells(i, 9).Text = "0"
   End If
     
   ''*************************************************************************************Poznamky NS
   pocet_poznamok = 0
   poznamka = ""
   For j = 3 To Sheets("poznamky_XML").Cells(1, 1)
    If Sheets("poznamky_XML").Cells(j, 1).Text = "PARCELA_NS" Then
     If Sheets("poznamky_XML").Cells(j, 2).Text = .Cells(i, 2).Text Then
      If Sheets("poznamky_XML").Cells(j, 3).Text = .Cells(i, 3).Text Then _
         pocet_poznamok = pocet_poznamok + 1
     End If
    End If
   Next j

   If pocet_poznamok > 1 Then
    For j = 3 To Sheets("poznamky_XML").Cells(1, 1)
     If Sheets("poznamky_XML").Cells(j, 1).Text = "PARCELA_NS" Then
      If Sheets("poznamky_XML").Cells(j, 2).Text = .Cells(i, 2).Text Then
       If Sheets("poznamky_XML").Cells(j, 3).Text = .Cells(i, 3).Text Then
        If retazec = "" Then retazec = Sheets("poznamky_XML").Cells(j, 4).Text Else _
           retazec = retazec & vbCrLf & Sheets("poznamky_XML").Cells(j, 4).Text
       End If
      End If
     End If
    Next j
    poznamka = "vid priloha"
   End If
    
   If pocet_poznamok = 1 Then
    If Len(.Cells(i, 20).Text) > 500 Then
     If retazec = "" Then retazec = .Cells(i, 20).Text Else _
        retazec = retazec & vbCrLf & .Cells(i, 20).Text
        poznamka = "vid priloha"
    End If
    If Len(.Cells(i, 20).Text) <= 500 Then poznamka = .Cells(i, 20).Text
   End If
   ''*************************************************************************************Poznamky NS - koniec
   If stavba = True Then
    If poznamka <> "" Then
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_NS" _
               & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
               & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
               & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
               & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
               & " pkk=" & Chr(34) & .Cells(i, 5) & Chr(34) _
               & " poznamka=" & Chr(34) & poznamka & Chr(34) _
               & ">"
    Else
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_NS" _
               & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
               & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
               & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
               & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
               & " pkk=" & Chr(34) & .Cells(i, 5) & Chr(34) _
               & ">"
    End If
    Print #1, Chr(9) & Chr(9) & Chr(9) & Chr(9) & "<STAVBA" _
              & " ds_cpa=" & Chr(34) & .Cells(i, 9) & Chr(34) _
              & " pec=" & Chr(34) & .Cells(i, 14) & Chr(34) _
              & " drs=" & Chr(34) & .Cells(i, 15) & Chr(34) _
              & " />"
    Print #1, Chr(9) & Chr(9) & Chr(9) & "</PARCELA_NS>"
   Else
    If poznamka <> "" Then
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_NS" _
               & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
               & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
               & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
               & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
               & " pkk=" & Chr(34) & .Cells(i, 5) & Chr(34) _
               & " poznamka=" & Chr(34) & poznamka & Chr(34) _
               & " />"
    Else
     Print #1, Chr(9) & Chr(9) & Chr(9) & "<PARCELA_NS" _
               & " drn=" & Chr(34) & .Cells(i, 2) & Chr(34) _
               & " cpa=" & Chr(34) & .Cells(i, 3) & Chr(34) _
               & " vym=" & Chr(34) & .Cells(i, 6) & Chr(34) _
               & " drp=" & Chr(34) & .Cells(i, 7) & Chr(34) _
               & " pkk=" & Chr(34) & .Cells(i, 5) & Chr(34) _
               & " />"
    End If
   End If
   ''*************************************************************************************Poznamky NS - koniec
  End If
  
  If .Cells(i, 1).Text = "RUSENIE_STAVBY" Then
   rusene_stavby = True
   If rusene_stavby_pocet = 0 Then Print #1, Chr(9) & Chr(9) & Chr(9) & "<RUSENE_STAVBY>"
   Print #1, Chr(9) & Chr(9) & Chr(9) & Chr(9) & "<STAVBA" _
             & " ds_cpa=" & Chr(34) & .Cells(i, 2) & Chr(34) _
             & " pec=" & Chr(34) & .Cells(i, 3) & Chr(34) _
             & " drs=" & Chr(34) & .Cells(i, 4) & Chr(34) _
             & " />"
   rusene_stavby_pocet = rusene_stavby_pocet + 1
  End If
 Next i
 If rusene_stavby = True Then Print #1, Chr(9) & Chr(9) & Chr(9) & "</RUSENE_STAVBY>"
 Print #1, Chr(9) & Chr(9) & "</NS>"

End With

Print #1, Chr(9) & "</KU>"
Print #1, "</ROOT>"
Close #1
If Len(Sheets("vstup").Cells(25, 4).Text) < 251 Then
 If retazec <> "" Then
  Open TXTFileName For Output As #2
  Print #2, retazec
  Close #2
 End If
 frm_XML.Hide
 MsgBox "XML bolo vytvoren|fffd| v adres|fffd|ri akt|fffd|vneho zo|fffd|ita. " & Chr(10) & Chr(13), vbOKOnly + vbInformation, "XML koniec"
 Debug.Print XMLFileName & " saved"
Else:
 Sheets("vstup").Select
 Sheets("vstup").Cells(25, 4).Select
 frm_XML.Hide
 MsgBox "Uprav n|fffd|zov GP aby bol maxim|fffd|lne 250 znakov"
End If
 

frm_XML.Hide

End Sub
Attribute VB_Name = "mdl_Druhy_pozemkov"
Sub Aktualizovat_DP_vo_VV()
With Sheets("exp_imp")
  Odstranit_DP
  Druh_pozemku_LV
  Druh_pozemku_PKV
  Druh_pozemku_EKN_PKV_Novy_stav
  
   If ActiveSheet.Cells(ActiveCell.Row, .Cells(31, 2)) <> "" Then
    Priradit_DP_NS_CKN
   End If
   If .Cells(21, 2) <> 0 Then
    If ActiveSheet.Cells(ActiveCell.Row, .Cells(21, 2)) <> "" Then
     Priradit_DP_LV
     Priradit_DP_NS_EKN_PK
    End If
   End If
   If ActiveSheet.Cells(ActiveCell.Row, .Cells(22, 2)) <> "" Then
    Priradit_DP_LV
    Priradit_DP_NS_CKN
   End If
   If ActiveSheet.Cells(ActiveCell.Row, .Cells(20, 2)) <> "" Then
    Priradit_DP_PKV
    Priradit_DP_NS_EKN_PK
   End If
End With
End Sub
Sub Druh_pozemku_LV()
Attribute Druh_pozemku_LV.VB_ProcData.VB_Invoke_Func = " \n14"
    ActiveWorkbook.Names.Add Name:="DP_LV", RefersToR1C1:= _
        "=OFFSET(Nastavenia!R13C33,0,0,COUNTA(Nastavenia!R13C33:Nastavenia!R2000C33),1)"
End Sub

Sub Druh_pozemku_PKV()
    ActiveWorkbook.Names.Add Name:="DP_PKV", RefersToR1C1:= _
        "=OFFSET(Nastavenia!R13C36,0,0,COUNTA(Nastavenia!R13C36:Nastavenia!R2000C36),1)"
End Sub

Sub Druh_pozemku_EKN_PKV_Novy_stav()
    ActiveWorkbook.Names.Add Name:="DP_NS", RefersToR1C1:= _
        "=OFFSET(exp_imp!R61C1,0,0,COUNTA(exp_imp!R61C1:exp_imp!R93C1),1)"
End Sub

Sub Priradit_DP_PKV()
Attribute Priradit_DP_PKV.VB_ProcData.VB_Invoke_Func = " \n14"

      With Cells(ActiveCell.Row, Sheets("exp_imp").Cells(25, 2)).Validation
        .Delete
        On Error Resume Next
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=DP_PKV"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
End Sub

Sub Priradit_DP_LV()

    With Cells(ActiveCell.Row, Sheets("exp_imp").Cells(25, 2)).Validation
        .Delete
        On Error Resume Next
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=DP_LV"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
End Sub

Sub Priradit_DP_NS_EKN_PK()

    With Cells(ActiveCell.Row, Sheets("exp_imp").Cells(34, 2)).Validation
        .Delete
        On Error Resume Next
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=DP_NS"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
End Sub

Sub Priradit_DP_NS_CKN()

    With Cells(ActiveCell.Row, Sheets("exp_imp").Cells(34, 2)).Validation
        .Delete
        On Error Resume Next
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=DP_LV"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
End Sub
Sub Odstranit_DP()
Attribute Odstranit_DP.VB_ProcData.VB_Invoke_Func = " \n14"

      With Cells(ActiveCell.Row, Sheets("exp_imp").Cells(25, 2)).Validation
        .Delete
        On Error Resume Next
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
      With Cells(ActiveCell.Row, Sheets("exp_imp").Cells(34, 2)).Validation
        .Delete
        On Error Resume Next
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
End Sub
Attribute VB_Name = "mdl_FPU"
Dim ChybaDBF As String


''Oprava Latin 2
Option Explicit

#If VBA7 Then
 Private Declare PtrSafe Function MultiByteToWideChar Lib "kernel32" ( _
 ByVal CodePage As Long, _
 ByVal dwFlags As Long, _
 ByVal lpMultiByteStr As LongPtr, _
 ByVal cchMultiByte As Long, _
 ByVal lpWideCharStr As LongPtr, _
 ByVal cchWideChar As Long) As Long
 
 
 Private Declare PtrSafe Function WideCharToMultiByte Lib "kernel32" ( _
 ByVal CodePage As Long, _
 ByVal dwFlags As Long, _
 ByVal lpWideCharStr As LongPtr, _
 ByVal cchWideChar As Long, _
 ByVal lpMultiByteStr As LongPtr, _
 ByVal cchMultiByte As Long, _
 ByVal lpDefaultChar As LongPtr, _
 ByVal lpUsedDefaultChar As Long) As Long
#Else
 Private Declare Function MultiByteToWideChar Lib "kernel32" ( _
 ByVal CodePage As Long, _
 ByVal dwFlags As Long, _
 ByVal lpMultiByteStr As String, _
 ByVal cchMultiByte As Long, _
 ByVal lpWideCharStr As String, _
 ByVal cchWideChar As Long) As Long
 
 Private Declare Function WideCharToMultiByte Lib "kernel32" ( _
 ByVal CodePage As Long, _
 ByVal dwFlags As Long, _
 ByVal lpWideCharStr As String, _
 ByVal cchWideChar As Long, _
 ByVal lpMultiByteStr As String, _
 ByVal cchMultiByte As Long, _
 ByVal lpDefaultChar As String, _
 ByVal lpUsedDefaultChar As Long) As Long
#End If

Private Const MB_PRECOMPOSED = &H1
Private Const MY_CP_WINDOWS As Long = 1250
Private Const MY_CP_ISO_1 As Long = 28591
Private Const MY_CP_ISO_2 As Long = 28592 ' ISO Latin-2
Private Const MY_CP_IBM_852 As Long = 852

Private Function zbCP1ToCP2(sStr As String, lFromCP As Long, Optional lToCP As Long = 0) As String
Dim sStrW As String

    sStrW = String$(2 * Len(sStr), vbNullChar)
    MultiByteToWideChar lFromCP, MB_PRECOMPOSED, sStr, Len(sStr), sStrW, Len(sStr)
    If lToCP = 0 Then
        sStr = StrConv(sStrW, vbFromUnicode)
    Else
        WideCharToMultiByte lToCP, 0&, sStrW, Len(sStr), sStr, Len(sStr), 0&, 0&
    End If

    zbCP1ToCP2 = sStr

End Function

''Oprava Latin 2 - koniec

Sub FPU_zobrazit()
If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
 Sheets("exp_imp").Cells(16, 7) = "Vv"
 frm_FPU_pripojit.Show
'' FPU_pripojit "Vv"
Else
 Sheets("exp_imp").Cells(44, 7) = "ano"
 frm_FPU.Width = Sheets("exp_imp").Cells(46, 7).Value
 frm_FPU.Height = Sheets("exp_imp").Cells(47, 7).Value
 frm_FPU.Top = Sheets("exp_imp").Cells(48, 7).Value
 frm_FPU.Left = Sheets("exp_imp").Cells(49, 7).Value
 If Sheets("exp_imp").Cells(46, 7).Text = 780 Then
  frm_FPU.IMGzbalit.Visible = True
  frm_FPU.IMGrozbalit.Visible = False
  frm_FPU.frmInfo.Visible = True
 Else
  frm_FPU.IMGzbalit.Visible = False
  frm_FPU.IMGrozbalit.Visible = True
  frm_FPU.frmInfo.Visible = False
 End If
 frm_FPU.Show
End If
End Sub

Sub FPU_pripojit(odkial As String)
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_PA").Visible = True
    Sheets("DBF_PA").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_EP").Visible = True
    Sheets("DBF_EP").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_VL").Visible = True
    Sheets("DBF_VL").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_PK").Visible = True
    Sheets("DBF_PK").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_CS").Visible = True
    Sheets("DBF_CS").Select
    Cells.Select
    Cells.Clear
    Sheets(nazov_listu).Select
    ListyViditelne
    If Sheets("exp_imp").Cells(43, 8) = "FPU" Then Import_FPU (odkial)
    If Sheets("exp_imp").Cells(43, 8) = "DBF" Then Import_DBF (odkial)
    If Sheets("exp_imp").Cells(43, 8) = "CSV" Then Import_CSV (odkial)
    If Sheets("exp_imp").Cells(43, 8) = "CSV_DBF" Then Import_CSV_DBF (odkial)
    
    If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
     Sheets("Vstup").cmbFPU.Caption = "Pripoji|fffd| FPU / CSV"
     Sheets("Vstup").cmbFPU.BackColor = &HFF00&
    Else
     Sheets("Vstup").cmbFPU.Caption = "Odpoji|fffd| FPU / CSV"
     Sheets("Vstup").cmbFPU.BackColor = &HFF&
    End If
    
    Sheets(nazov_listu).Select
    
End Sub

Sub FPU_odpojit()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_PA").Visible = True
    Sheets("DBF_PA").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_EP").Visible = True
    Sheets("DBF_EP").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_VL").Visible = True
    Sheets("DBF_VL").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_PK").Visible = True
    Sheets("DBF_PK").Select
    Cells.Select
    Cells.Clear
    Sheets("DBF_CS").Visible = True
    Sheets("DBF_CS").Select
    Cells.Select
    Cells.Clear
    ListyViditelne
    Sheets(nazov_listu).Select

Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|"
Sheets("exp_imp").Cells(19, 7) = ""
Sheets("exp_imp").Cells(19, 9) = ""
Sheets("exp_imp").Cells(20, 7) = ""
Sheets("exp_imp").Cells(20, 9) = ""
Sheets("exp_imp").Cells(21, 7) = ""
Sheets("exp_imp").Cells(22, 7) = ""
Sheets("exp_imp").Cells(23, 7) = ""
Sheets("exp_imp").Cells(26, 7) = ""
Sheets("exp_imp").Cells(27, 7) = ""
Sheets("exp_imp").Cells(28, 7) = ""
Sheets("exp_imp").Cells(29, 7) = ""
Sheets("exp_imp").Cells(30, 7) = ""
Sheets("exp_imp").Cells(31, 7) = ""
Sheets("exp_imp").Cells(32, 7) = ""
Sheets("exp_imp").Cells(34, 7) = ""
Sheets("exp_imp").Cells(35, 7) = ""
Sheets("exp_imp").Cells(36, 7) = ""
Sheets("exp_imp").Cells(37, 7) = ""
Sheets("exp_imp").Cells(38, 7) = ""
Sheets("exp_imp").Cells(41, 7) = ""
Sheets("exp_imp").Cells(42, 7) = ""

If Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|" Then
 Sheets("Vstup").cmbFPU.Caption = "Pripoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF00&
Else
 Sheets("Vstup").cmbFPU.Caption = "Odpoji|fffd| FPU / CSV"
 Sheets("Vstup").cmbFPU.BackColor = &HFF&
End If

If frm_FPU_pripojit.optFPU.Value = True Then MsgBox "FPU odpojen|fffd|."
If frm_FPU_pripojit.optDBF.Value = True Then MsgBox "DBF odpojen|fffd|."
If frm_FPU_pripojit.optCSV.Value = True Then MsgBox "CSV odpojen|fffd|."
If frm_FPU_pripojit.optCSV_DBF.Value = True Then MsgBox "CSV odpojen|fffd|."

End Sub

Sub Import_DBF(odkial As String)
Dim Subor As Variant
Dim objFSO As Object
Dim objFile As Object
Dim i As Double

    Subor = Application.GetOpenFilename(FileFilter:="databaza.dbf,*.dbf", Title:="databaza")
    
        If Subor = False Then
            Exit Sub
        Else
              Set objFSO = CreateObject("Scripting.FileSystemObject")
              Set objFile = objFSO.GetFile(Subor)
              Sheets("exp_imp").Cells(44, 8) = UCase(objFile.Parentfolder)
              Sheets("exp_imp").Cells(45, 8) = Mid(Subor, (Len(Subor) - 11 + 2), 6)
              Sheets("exp_imp").Cells(43, 7) = UCase(objFile.Parentfolder)
              Set objFSO = Nothing
              Set objFile = Nothing
              ChybaDBF = ""
              
              On Error Resume Next
                DBF_pripojit_PA
                If ChybaDBF = True Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_EP
                If ChybaDBF = True Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_VL
                If ChybaDBF = True Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_PK
                If ChybaDBF = True Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_CS
                If ChybaDBF = True Then GoTo VelkeDBF
                
              If odkial = "Vv" Then
               If frm_FPU_pripojit.optDBF.Value = True Then MsgBox "DBF pripojen|fffd|."
               Sheets("exp_imp").Cells(44, 7) = "ano"
               frm_FPU.Show
               'priradit ku
              Else
               For i = 2 To 5000
                If Sheets("KU").Cells(i, 5).Value = Sheets("exp_imp").Cells(45, 8).Value Then
                 Sheets("Vstup").cmbKraj.Text = Sheets("KU").Cells(i, 1)
                 Sheets("Vstup").cmbOkres.Text = Sheets("KU").Cells(i, 2)
                 Sheets("Vstup").cmbObec.Text = Sheets("KU").Cells(i, 4)
                 Sheets("Vstup").cmbKatuz.Text = Sheets("KU").Cells(i, 6)
                 Exit For
                End If
               Next i
               
               If frm_FPU_pripojit.optDBF.Value = True Then _
               MsgBox "DBF pripojen|fffd|." & Chr(10) & Chr(10) & Chr(9) & "Vo v|fffd|kaze v|fffd|mer cez kontextovu ponuku Menu TSGP vyvol|fffd|te okno pre vyh|fffd|ad|fffd|vanie |fffd|dajov k jednotliv|fffd|m parcel|fffd|m."
              End If
        End If
Exit Sub
VelkeDBF:
 Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|"
 MsgBox "Datab|fffd|za " & ChybaDBF & " obsahuje viac riadkov ako TSGP zo|fffd|it." & Chr(10) & Chr(10) & "Sk|fffd|ste ulo|fffd|i|fffd| TSGP ako XLSM (nov|fffd||fffd| form|fffd|t s podporou makier), zavrie|fffd| a znovu otvori|fffd|.", vbOKOnly, "TSGP"
 ChybaDBF = ""
        
        
End Sub

Sub Import_CSV(odkial As String)
Dim Subor As Variant
Dim objFSO As Object
Dim objFile As Object
Dim i As Double

    Subor = Application.GetOpenFilename(FileFilter:="databaza.csv,*.csv", Title:="databaza")
    
        If Subor = False Then
            Exit Sub
        Else
              Set objFSO = CreateObject("Scripting.FileSystemObject")
              Set objFile = objFSO.GetFile(Subor)
              Sheets("exp_imp").Cells(44, 8) = UCase(objFile.Parentfolder)
              Sheets("exp_imp").Cells(45, 8) = Mid(Subor, (Len(Subor) - 11 + 2), 6)
              Sheets("exp_imp").Cells(43, 7) = UCase(objFile.Parentfolder)
              Set objFSO = Nothing
              Set objFile = Nothing
              ChybaDBF = ""
              
              On Error Resume Next
                DBF_pripojit_PA
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_EP
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_VL
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_PK
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                DBF_pripojit_CS
                If ChybaDBF <> "" Then GoTo VelkeDBF
                
              If odkial = "Vv" Then
               If frm_FPU_pripojit.optCSV.Value = True Then MsgBox "CSV pripojen|fffd|."
               Sheets("exp_imp").Cells(44, 7) = "ano"
               frm_FPU.Show
               'priradit ku
              Else
               For i = 2 To 5000
                If Sheets("KU").Cells(i, 5).Value = Sheets("exp_imp").Cells(45, 8).Value Then
                 Sheets("Vstup").cmbKraj.Text = Sheets("KU").Cells(i, 1)
                 Sheets("Vstup").cmbOkres.Text = Sheets("KU").Cells(i, 2)
                 Sheets("Vstup").cmbObec.Text = Sheets("KU").Cells(i, 4)
                 Sheets("Vstup").cmbKatuz.Text = Sheets("KU").Cells(i, 6)
                 Exit For
                End If
               Next i
               
               If frm_FPU_pripojit.optCSV.Value = True Then _
               MsgBox "CSV pripojen|fffd|." & Chr(10) & Chr(10) & Chr(9) & "Vo v|fffd|kaze v|fffd|mer cez kontextovu ponuku Menu TSGP vyvol|fffd|te okno pre vyh|fffd|ad|fffd|vanie |fffd|dajov k jednotliv|fffd|m parcel|fffd|m."
              End If
        End If
Exit Sub
VelkeDBF:
 Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|"
 MsgBox "Datab|fffd|za " & ChybaDBF & " obsahuje viac riadkov ako TSGP zo|fffd|it." & Chr(10) & Chr(10) & "Sk|fffd|ste ulo|fffd|i|fffd| TSGP ako XLSM (nov|fffd||fffd| form|fffd|t s podporou makier), zavrie|fffd| a znovu otvori|fffd|.", vbOKOnly, "TSGP"
 ChybaDBF = ""
         
End Sub

Sub Import_CSV_DBF(odkial As String)
Dim Subor As Variant
Dim objFSO As Object
Dim objFile As Object
Dim i As Double

    Subor = Application.GetOpenFilename(FileFilter:="databaza.csv,*.csv", Title:="databaza")
    
        If Subor = False Then
            Exit Sub
        Else
              Set objFSO = CreateObject("Scripting.FileSystemObject")
              Set objFile = objFSO.GetFile(Subor)
              Sheets("exp_imp").Cells(44, 8) = UCase(objFile.Parentfolder)
              Sheets("exp_imp").Cells(45, 8) = Mid(Subor, (Len(Subor) - 11 + 2 - 4), 6)
              Sheets("exp_imp").Cells(43, 7) = UCase(objFile.Parentfolder)
              Set objFSO = Nothing
              Set objFile = Nothing
              ChybaDBF = ""
                
              On Error Resume Next
                CSV_DBF_pripojit_PA
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                CSV_DBF_pripojit_EP
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                CSV_DBF_pripojit_VL
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                CSV_DBF_pripojit_PK
                If ChybaDBF <> "" Then GoTo VelkeDBF
              On Error Resume Next
                CSV_DBF_pripojit_CS
                If ChybaDBF <> "" Then GoTo VelkeDBF
                
              If odkial = "Vv" Then
               If frm_FPU_pripojit.optCSV.Value = True Then MsgBox "CSV pripojen|fffd|."
               Sheets("exp_imp").Cells(44, 7) = "ano"
               frm_FPU.Show
               'priradit ku
              Else
               For i = 2 To 5000
                If Sheets("KU").Cells(i, 5).Value = Sheets("exp_imp").Cells(45, 8).Value Then
                 Sheets("Vstup").cmbKraj.Text = Sheets("KU").Cells(i, 1)
                 Sheets("Vstup").cmbOkres.Text = Sheets("KU").Cells(i, 2)
                 Sheets("Vstup").cmbObec.Text = Sheets("KU").Cells(i, 4)
                 Sheets("Vstup").cmbKatuz.Text = Sheets("KU").Cells(i, 6)
                 Exit For
                End If
               Next i
               
               If frm_FPU_pripojit.optCSV_DBF.Value = True Then _
               MsgBox "CSV pripojen|fffd|." & Chr(10) & Chr(10) & Chr(9) & "Vo v|fffd|kaze v|fffd|mer cez kontextovu ponuku Menu TSGP vyvol|fffd|te okno pre vyh|fffd|ad|fffd|vanie |fffd|dajov k jednotliv|fffd|m parcel|fffd|m."
              End If
        End If
Exit Sub
VelkeDBF:
 Sheets("exp_imp").Cells(43, 7) = "nepripojen|fffd|"
 MsgBox "Datab|fffd|za " & ChybaDBF & " obsahuje viac riadkov ako TSGP zo|fffd|it." & Chr(10) & Chr(10) & "Sk|fffd|ste ulo|fffd|i|fffd| TSGP ako XLSM (nov|fffd||fffd| form|fffd|t s podporou makier), zavrie|fffd| a znovu otvori|fffd|.", vbOKOnly, "TSGP"
 ChybaDBF = ""
 
End Sub

Sub CSV_DBF_pripojit_PA()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_PA").Visible = True
    Sheets("DBF_PA").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.OpenText FileName:=Sheets("exp_imp").Cells(44, 8) & "\PA" & Sheets("exp_imp").Cells(45, 8) & ".dbf.csv" _
    , DataType:=xlDelimited, Semicolon:=True, Local:=True
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "PA"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_PA").Visible = False
     Exit Sub
    End If
    
    Dim iii As Double
    For iii = 1 To 100000
     Cells(1, iii) = UCase(Cells(1, iii))
     If Cells(1, iii) = "" Then Exit For
    Next iii
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_PA").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 19 To 23
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    For j = 19 To 20
     Sheets("exp_imp").Cells(j, 9) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 19 To 23
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
        If Cells(1, i).Text = .Cells(j, 8) Then
         .Cells(j, 9) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 19 To 23
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze PA nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_PA").Visible = False
End Sub

Sub CSV_DBF_pripojit_EP()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_EP").Visible = True
    Sheets("DBF_EP").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.OpenText FileName:=Sheets("exp_imp").Cells(44, 8) & "\EP" & Sheets("exp_imp").Cells(45, 8) & ".dbf.csv" _
    , DataType:=xlDelimited, Semicolon:=True, Local:=True
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "EP"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_EP").Visible = False
     Exit Sub
    End If
    
    Dim iii As Double
    For iii = 1 To 100000
     Cells(1, iii) = UCase(Cells(1, iii))
     If Cells(1, iii) = "" Then Exit For
    Next iii
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_EP").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 26 To 32
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 26 To 32
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 26 To 32
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze EP nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_EP").Visible = False

End Sub

Sub CSV_DBF_pripojit_VL()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_VL").Visible = True
    Sheets("DBF_VL").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.OpenText FileName:=Sheets("exp_imp").Cells(44, 8) & "\VL" & Sheets("exp_imp").Cells(45, 8) & ".dbf.csv" _
    , DataType:=xlDelimited, Semicolon:=True, Local:=True
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "VL"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_VL").Visible = False
     Exit Sub
    End If
    
    Dim iii As Double
    For iii = 1 To 100000
     Cells(1, iii) = UCase(Cells(1, iii))
     If Cells(1, iii) = "" Then Exit For
    Next iii
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_VL").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 34 To 38
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 34 To 38
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 34 To 38
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze VL nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_VL").Visible = False

End Sub

Sub CSV_DBF_pripojit_PK()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_PK").Visible = True
    Sheets("DBF_PK").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.OpenText FileName:=Sheets("exp_imp").Cells(44, 8) & "\PK" & Sheets("exp_imp").Cells(45, 8) & ".dbf.csv" _
    , DataType:=xlDelimited, Semicolon:=True, Local:=True
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "PK"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_PK").Visible = False
     Exit Sub
    End If
    
    Dim iii As Double
    For iii = 1 To 100000
     Cells(1, iii) = UCase(Cells(1, iii))
     If Cells(1, iii) = "" Then Exit For
    Next iii
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_PK").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 41 To 42
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 41 To 42
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 41 To 42
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    'If existuje = False Then MsgBox "v datab|fffd|ze PK nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    
    Sheets(nazov_listu).Select
    Sheets("DBF_PK").Visible = False
    
End Sub


Sub CSV_DBF_pripojit_CS()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_CS").Visible = True
    Sheets("DBF_CS").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.OpenText FileName:=Sheets("exp_imp").Cells(44, 8) & "\CS" & Sheets("exp_imp").Cells(45, 8) & ".dbf.csv" _
    , DataType:=xlDelimited, Semicolon:=True, Local:=True
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "CS"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_CS").Visible = False
     Exit Sub
    End If
    
    Dim iii As Double
    For iii = 1 To 100000
     Cells(1, iii) = UCase(Cells(1, iii))
     If Cells(1, iii) = "" Then Exit For
    Next iii
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_CS").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 26 To 30
     Sheets("exp_imp").Cells(j, 9) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 26 To 30
        If Cells(1, i).Text = .Cells(j, 8).Text Then
         .Cells(j, 9) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 26 To 30
     If Sheets("exp_imp").Cells(j, 9) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze CS nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_CS").Visible = False
End Sub


Sub DBF_pripojit_PA()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_PA").Visible = True
    Sheets("DBF_PA").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.Open FileName:=Sheets("exp_imp").Cells(44, 8) & "\PA" & Sheets("exp_imp").Cells(45, 8)
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "PA"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_PA").Visible = False
     Exit Sub
    End If
    
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_PA").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 19 To 23
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    For j = 19 To 20
     Sheets("exp_imp").Cells(j, 9) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 19 To 23
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
        If Cells(1, i).Text = .Cells(j, 8) Then
         .Cells(j, 9) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 19 To 23
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze PA nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_PA").Visible = False
End Sub


Sub DBF_pripojit_EP()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_EP").Visible = True
    Sheets("DBF_EP").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.Open FileName:=Sheets("exp_imp").Cells(44, 8) & "\EP" & Sheets("exp_imp").Cells(45, 8)
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "EP"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_EP").Visible = False
     Exit Sub
    End If
    
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_EP").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 26 To 32
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 26 To 32
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 26 To 32
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze EP nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_EP").Visible = False

End Sub

Sub DBF_pripojit_VL()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_VL").Visible = True
    Sheets("DBF_VL").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.Open FileName:=Sheets("exp_imp").Cells(44, 8) & "\VL" & Sheets("exp_imp").Cells(45, 8)
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "VL"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_VL").Visible = False
     Exit Sub
    End If
    
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_VL").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 34 To 38
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 34 To 38
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 34 To 38
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze VL nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_VL").Visible = False

End Sub

Sub DBF_pripojit_PK()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_PK").Visible = True
    Sheets("DBF_PK").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.Open FileName:=Sheets("exp_imp").Cells(44, 8) & "\PK" & Sheets("exp_imp").Cells(45, 8)
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "PK"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_PK").Visible = False
     Exit Sub
    End If
    
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_PK").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 41 To 42
     Sheets("exp_imp").Cells(j, 7) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 41 To 42
        If Cells(1, i).Text = .Cells(j, 6).Text Then
         .Cells(j, 7) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 41 To 42
     If Sheets("exp_imp").Cells(j, 7) = "" Then existuje = False
    Next j
    
'    If existuje = False Then MsgBox "v datab|fffd|ze PK nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    
    Sheets(nazov_listu).Select
    Sheets("DBF_PK").Visible = False
    
End Sub

Sub DBF_pripojit_CS()
Dim nazov_suboru As String
Dim nazov_listu As String
Dim nazov_suboru1 As String
Dim PoslednyRiadokTSGP As Long
Dim PoslednyRiadokDBF As Long

    nazov_suboru = ActiveWorkbook.Name
    nazov_listu = ActiveSheet.Name

    Sheets("DBF_CS").Visible = True
    Sheets("DBF_CS").Select
    Cells.Select
    Cells.Clear
    Cells(Rows.Count, 1).Select
    PoslednyRiadokTSGP = Rows.Count
    Sheets(nazov_listu).Select
    
    Workbooks.Open FileName:=Sheets("exp_imp").Cells(44, 8) & "\CS" & Sheets("exp_imp").Cells(45, 8)
    
    PoslednyRiadokDBF = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
    If PoslednyRiadokDBF >= PoslednyRiadokTSGP Then
     ChybaDBF = "CS"
     nazov_suboru1 = ActiveWorkbook.Name
     Windows(nazov_suboru1).Activate
     Application.DisplayAlerts = False
     ActiveWindow.Close
     Sheets(nazov_listu).Select
     Sheets("DBF_CS").Visible = False
     Exit Sub
    End If
    
    nazov_suboru1 = ActiveWorkbook.Name
    Cells.Select
    Selection.Copy
    Windows(nazov_suboru).Activate
    Sheets("DBF_CS").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    Windows(nazov_suboru1).Activate
    Application.CutCopyMode = False
    Application.DisplayAlerts = False
    ActiveWindow.Close
    
 
 Dim i As Integer
 Dim j As Integer
 Dim existuje As Boolean
    
    For j = 26 To 30
     Sheets("exp_imp").Cells(j, 9) = ""
    Next j
    
    i = 0
    Do
     i = i + 1
     If Cells(1, i) = "" Then
      Exit Do
     Else
      With Sheets("exp_imp")
       For j = 26 To 30
        If Cells(1, i).Text = .Cells(j, 8).Text Then
         .Cells(j, 9) = i
         Exit For
        End If
       Next j
      End With
     End If
    Loop
    
    existuje = True
    For j = 26 To 30
     If Sheets("exp_imp").Cells(j, 9) = "" Then existuje = False
    Next j
    
    If existuje = False Then MsgBox "v datab|fffd|ze CS nies|fffd| v|fffd|etky povinn|fffd| parametre"
    
    Sheets(nazov_listu).Select
    Sheets("DBF_CS").Visible = False
End Sub


Sub Import_FPU(odkial As String)
Dim Subor As Variant
Dim SuborN As String
Dim nazov_suboru As Variant
Dim oddelovac As String
Dim i As Integer
        
Subor = Application.GetOpenFilename(FileFilter:="Datab|fffd|za vo forme FPU  [*.fpu],*.fpu", Title:="Pripoji|fffd| FPU")
           
If Subor = False Then Exit Sub
   
oddelovac = ";"

If oddelovac = vbNullString Then
 Exit Sub
End If
    
Debug.Print "Subor: " & Subor, "oddelovac: " & oddelovac
    
ImportFpuFile FName:=CStr(Subor), Sep:=CStr(oddelovac), odkial:=odkial
        
End Sub


Public Sub ImportFpuFile(FName As String, Sep As String, odkial As String)

Dim RowNdx As Long
RowNdx = 0
Dim ColNdx As Integer
ColNdx = 0
Dim TempVal As Variant
TempVal = 0
Dim WholeLine As String
WholeLine = ""
Dim Pos As Integer
Pos = 0
Dim NextPos As Integer
NextPos = 0
Dim SaveColNdx As Integer
''SaveColNdx = 0
Dim i As Integer
Dim stlpec_i As Integer
stlpec_i = 0
Dim List_pre_udaje As String

Dim j As Integer
Dim cele_parcelne_cislo As String
Dim index_predcislia As Integer
Dim predcislie As String

Dim existuje As String

Dim TempVal2 As String

SaveColNdx = 1
stlpec_i = 1

List_pre_udaje = "DBF_PA"
        
Application.ScreenUpdating = False
On Error GoTo EndMacro:

RowNdx = 1
i = 1
Open FName For Input Access Read As #1

        
While Not EOF(1)
    Line Input #1, WholeLine
    If Right(WholeLine, 1) <> Sep Then
        WholeLine = WholeLine & Sep
    End If
    ColNdx = SaveColNdx
    Pos = 1
    NextPos = InStr(Pos, WholeLine, Sep)
    While NextPos >= 1
     TempVal = Mid(WholeLine, Pos, NextPos - Pos)
     If frm_FPU_pripojit.chbKonverzia.Value = True Then
      ' IBM-852 => WIN 1250
      TempVal2 = TempVal
      TempVal2 = zbCP1ToCP2(TempVal2, MY_CP_IBM_852, MY_CP_WINDOWS)
      TempVal = TempVal2
     End If
     
      If vyber_prvku(LTrim(RTrim(TempVal)), 1, " ") = ".KATASTRALNE_UZEMIE" Then _
        Sheets("exp_imp").Cells(50, 7) = vyber_prvku(LTrim(RTrim(TempVal)), 2, " ")
      
      If LTrim(RTrim(TempVal)) = "..SKUPINA KN-PA" Then
        List_pre_udaje = "DBF_PA"
        ColNdx = 1
        RowNdx = 1
        existuje = "PA"
      End If
      If LTrim(RTrim(TempVal)) = "..SKUPINA KN-EP" Then
        List_pre_udaje = "DBF_EP"
        ColNdx = 1
        RowNdx = 1
        existuje = "EP"
      End If
      If LTrim(RTrim(TempVal)) = "..SKUPINA KN-VL" Then
        List_pre_udaje = "DBF_VL"
        ColNdx = 1
        RowNdx = 1
        existuje = "VL"
      End If
      If LTrim(RTrim(TempVal)) = "..SKUPINA KN-PK" Then
        List_pre_udaje = "DBF_PK"
        ColNdx = 1
        RowNdx = 1
        existuje = "PK"
      End If
      If LTrim(RTrim(TempVal)) = "..SKUPINA KN-CS" Then
        List_pre_udaje = "DBF_CS"
        ColNdx = 1
        RowNdx = 1
        existuje = "CS"
      End If
      
      If vyber_prvku(LTrim(RTrim(TempVal)), 1, " ") = "..POLOZKY" Then TempVal = vyber_prvku(LTrim(RTrim(TempVal)), 2, " ")
      
      If existuje <> "" Then Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = LTrim(RTrim(TempVal))
    
      If existuje = "PA" Then
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CPA" Then
        Sheets("exp_imp").Cells(19, 7) = ColNdx
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CPA"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-VYM" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "VYM"
        Sheets("exp_imp").Cells(20, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-DRP" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "DRP"
        Sheets("exp_imp").Cells(21, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CLV" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CLV"
        Sheets("exp_imp").Cells(22, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-DRV" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "DRV"
        Sheets("exp_imp").Cells(23, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-PKK" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "PKK"
        Sheets("exp_imp").Cells(19, 9) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-UMP" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "UMP"
        Sheets("exp_imp").Cells(20, 9) = ColNdx
       End If
      End If
      
      If existuje = "EP" Then
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CPA" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CPA"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(26, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CPU" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CPU"
        Sheets("exp_imp").Cells(27, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-VYM" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "VYM"
        Sheets("exp_imp").Cells(28, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-DRP" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "DRP"
        Sheets("exp_imp").Cells(29, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CLV" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CLV"
        Sheets("exp_imp").Cells(30, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-DRV" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "DRV"
        Sheets("exp_imp").Cells(31, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-UMP" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "UMP"
        Sheets("exp_imp").Cells(32, 7) = ColNdx
       End If
      End If
      
      If existuje = "VL" Then
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CLV" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CLV"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(34, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-PCS" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "PCS"
        Sheets("exp_imp").Cells(35, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CIT" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CIT"
        Sheets("exp_imp").Cells(36, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-MEN" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "MEN"
        Sheets("exp_imp").Cells(37, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-VLA" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "VLA"
        Sheets("exp_imp").Cells(38, 7) = ColNdx
       End If
      End If
      
      If existuje = "PK" Then
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CPU" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "UMP"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(41, 7) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-NPK" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "NPK"
        Sheets("exp_imp").Cells(42, 7) = ColNdx
       End If
      End If
      If existuje = "CS" Then
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CLV" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CLV"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(26, 9) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-CPA" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "CPA"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(27, 9) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-DRS" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "DRS"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(28, 9) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-PKK" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "PKK"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(29, 9) = ColNdx
       End If
       If Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "KN-PEC" Then
        Sheets(List_pre_udaje).Cells(RowNdx, ColNdx) = "PEC"
        Sheets(List_pre_udaje).Cells(1, 2) = RowNdx - 1
        Sheets("exp_imp").Cells(30, 9) = ColNdx
       End If
      End If
      
      If vyber_prvku(LTrim(RTrim(TempVal)), 1, " ") = "..POCET" Then
       existuje = ""
      End If
      
     Pos = NextPos + 1
     ColNdx = ColNdx + 1
     NextPos = InStr(Pos, WholeLine, Sep)

    Wend
    RowNdx = RowNdx + 1
Wend
       
Dim ii As Integer
Dim pocet_ii As Integer

pocet_ii = Sheets("DBF_PA").Cells(1, 2)
For ii = 1 To pocet_ii
 Sheets("DBF_PA").Rows(1).Delete
Next ii

pocet_ii = Sheets("DBF_EP").Cells(1, 2)
For ii = 1 To pocet_ii
 Sheets("DBF_EP").Rows(1).Delete
Next ii

pocet_ii = Sheets("DBF_VL").Cells(1, 2)
For ii = 1 To pocet_ii
 Sheets("DBF_VL").Rows(1).Delete
Next ii

pocet_ii = Sheets("DBF_PK").Cells(1, 2)
For ii = 1 To pocet_ii
 Sheets("DBF_PK").Rows(1).Delete
Next ii

pocet_ii = Sheets("DBF_CS").Cells(1, 2)
For ii = 1 To pocet_ii
 Sheets("DBF_CS").Rows(1).Delete
Next ii
    
Sheets("exp_imp").Cells(43, 7) = FName
If odkial = "Vv" Then
 If frm_FPU_pripojit.optFPU.Value = True Then MsgBox "FPU pripojen|fffd|."
 If frm_FPU_pripojit.optDBF.Value = True Then MsgBox "DBF pripojen|fffd|."
 Sheets("exp_imp").Cells(44, 7) = "ano"
 frm_FPU.Show
Else

  'priradit ku
  For i = 2 To 5000
   If Sheets("KU").Cells(i, 5).Value = Sheets("exp_imp").Cells(50, 7).Value Then
    Sheets("Vstup").cmbKraj.Text = Sheets("KU").Cells(i, 1)
    Sheets("Vstup").cmbOkres.Text = Sheets("KU").Cells(i, 2)
    Sheets("Vstup").cmbObec.Text = Sheets("KU").Cells(i, 4)
    Sheets("Vstup").cmbKatuz.Text = Sheets("KU").Cells(i, 6)
    Exit For
   End If
  Next i
  
 If frm_FPU_pripojit.optFPU.Value = True Then _
 MsgBox "FPU pripojen|fffd|." & Chr(10) & Chr(10) & Chr(9) & "Vo v|fffd|kaze v|fffd|mer cez kontextovu ponuku Menu TSGP vyvol|fffd|te okno pre vyh|fffd|ad|fffd|vanie |fffd|dajov k jednotliv|fffd|m parcel|fffd|m."
 If frm_FPU_pripojit.optDBF.Value = True Then _
 MsgBox "DBF pripojen|fffd|." & Chr(10) & Chr(10) & Chr(9) & "Vo v|fffd|kaze v|fffd|mer cez kontextovu ponuku Menu TSGP vyvol|fffd|te okno pre vyh|fffd|ad|fffd|vanie |fffd|dajov k jednotliv|fffd|m parcel|fffd|m."
End If
EndMacro:
On Error GoTo 0
Application.ScreenUpdating = True
Close #1

End Sub


''FUNKCIE NA VYHLADAVANIE
Sub FPU_vyhladat()
Dim register As String
Dim riadok As Double
Dim stlpec As Double
Dim operat As String
Dim i As Double
Dim j As Double
Dim ii As Double
Dim jj As Double
Dim k As Integer
Dim DP As Integer
Dim VvPKU As Integer
Dim LV As Integer
Dim Podiel As Double
Dim spoluvlastnici
    
If frm_FPU.chbPodrzat.Value = False Then
 If Sheets("exp_imp").Cells(44, 7) = "ano" Then
  frm_FPU.tbPC.Text = ""
  frm_FPU.tbPCm.Caption = ""
  frm_FPU.cbPKU.Caption = ""
  frm_FPU.lblLV.Caption = ""
  frm_FPU.lblLVm.Caption = ""
  frm_FPU.lblM2.Caption = ""
  frm_FPU.lblM2m.Caption = ""
  frm_FPU.lblDP.Caption = ""
  frm_FPU.lblDPm.Caption = ""
  frm_FPU.lblSV.Caption = ""
  frm_FPU.tbSV.Text = ""
  frm_FPU.tbKDS.Text = ""
  frm_FPU.tbPV.Text = ""
  frm_FPU.lblKDS.Caption = ""
  frm_FPU.lblPodiel.Caption = ""
  frm_FPU.lblPodielPocet.Caption = ""
  frm_FPU.lblUMP.Caption = ""
  frm_FPU.lbVlastnici.Clear
  frm_FPU.lblDRV.Caption = ""
  frm_FPU.lblNeexistuje.Caption = ""
  frm_FPU.lblREGISTER.Caption = ""
  frm_FPU.lblREGISTERm.Caption = ""
  frm_FPU.lblKodDrSt.Visible = False
  frm_FPU.lblKDS.Visible = False
  
  frm_FPU.lblSC.Caption = ""
  frm_FPU.lblSCodPC.Caption = ""
  frm_FPU.slbSupisne.Visible = False
  frm_FPU.lblSC.Visible = False
  frm_FPU.lblSCodPC.Visible = False    ''DOPLENE 20.4.2019
  frm_FPU.slbSCodPC.Visible = False    ''DOPLENE 20.4.2019

  If ActiveCell.Text <> "" Then
   riadok = ActiveCell.Row
   frm_FPU.AktivnyRiadok.Caption = riadok
   With Sheets("exp_imp")
    If .Cells(21, 2) <> 0 Then
     If Cells(riadok, .Cells(21, 2)) <> "" Then
      operat = "KNE"
      frm_FPU.tbPC.Text = Cells(riadok, .Cells(21, 2))
      frm_FPU.tbPCm.Caption = Cells(riadok, .Cells(21, 2))
      stlpec = .Cells(21, 2)
     End If
    End If
    If Cells(riadok, .Cells(22, 2)) <> "" Then
     operat = "KNC"
     frm_FPU.tbPC.Text = Cells(riadok, .Cells(22, 2))
     frm_FPU.tbPCm.Caption = Cells(riadok, .Cells(22, 2))
     stlpec = .Cells(22, 2)
    End If
   End With

   With frm_FPU
    .lblLV.Caption = ""
    .lblLVm.Caption = ""
    
    If operat = "KNC" Then
     If .tbPC.Text <> "" Then
      .lblREGISTER.Caption = "KN-C"
      .lblREGISTERm.Caption = "KN-C"
      .lblNeexistuje.Caption = ""
      i = 1
      j = 0
      Do
       i = i + 1
       If Sheets("DBF_PA").Cells(i, 1) = "" Then
        .lblPocet.Caption = j
        Exit Do
       Else
        If Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(19, 7)) = UpravaPC_do_DBF(.tbPC.Text) Then
         .lblLV.Caption = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(22, 7))
         .lblLVm.Caption = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(22, 7))
         .lblM2.Caption = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(20, 7))
         .lblM2m.Caption = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(20, 7))
         DP = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(21, 7))
         For k = 13 To 100
          If Sheets("nastavenia").Cells(k, 32) = "" Then
           Exit For
          Else
           If Sheets("nastavenia").Cells(k, 34) = DP Then .lblDP.Caption = Sheets("nastavenia").Cells(k, 33)
           If Sheets("nastavenia").Cells(k, 34) = DP Then .lblDPm.Caption = Sheets("nastavenia").Cells(k, 33)
          End If
         Next k
         .lblSV.Caption = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(19, 9))
         For k = 3 To 500
          If Sheets("Vyuz_poz").Cells(k, 1) = "" Then
           Exit For
          Else
           If Sheets("Vyuz_poz").Cells(k, 1).Value = .lblSV.Caption Then
            .tbSV.Text = Sheets("Vyuz_poz").Cells(k, 2).Text
            Exit For
           End If
          End If
         Next k
         ii = 1
         jj = 0
         .lblKodDrSt.Visible = False
         .lblKDS.Visible = False
         .slbSupisne.Visible = False
         .lblSC.Visible = False
         .lblSCodPC.Visible = False
         .slbSCodPC.Visible = False
         Do
          ii = ii + 1
          If Sheets("DBF_CS").Cells(ii, 1) = "" Then
           Exit Do
          Else
           If Sheets("DBF_CS").Cells(ii, Sheets("exp_imp").Cells(27, 9)) = UpravaPC_do_DBF(.tbPC.Text) Then
            .lblSC.Caption = Sheets("DBF_CS").Cells(ii, Sheets("exp_imp").Cells(30, 9))
''            .lblSCodPC.Caption = Sheets("DBF_CS").Cells(ii, Sheets("exp_imp").Cells(27, 9))  ''DOPLENE 20.4.2019
            .lblSCodPC.Caption = UpravaPC_z_DBF(Sheets("DBF_CS").Cells(ii, Sheets("exp_imp").Cells(27, 9)))  ''DOPLENE 20.4.2019
            .lblKDS.Caption = Sheets("DBF_CS").Cells(ii, Sheets("exp_imp").Cells(28, 9))
            .tbKDS.Text = Sheets("DBF_CS").Cells(ii, Sheets("exp_imp").Cells(29, 9))
            .lblKodDrSt.Visible = True
            .lblKDS.Visible = True
            .slbSupisne.Visible = True
            .lblSC.Visible = True
            .lblSCodPC.Visible = True      ''DOPLENE 20.4.2019
            .slbSCodPC.Visible = True      ''DOPLENE 20.4.2019
           End If
          End If
         Loop
         If Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(20, 9)) = 1 Then .lblUMP.Caption = "intravil|fffd|n"
         If Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(20, 9)) = 2 Then .lblUMP.Caption = "extravil|fffd|n"
         If Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(23, 7)) <> 0 Then
          .lblDRV.Caption = Sheets("DBF_PA").Cells(i, Sheets("exp_imp").Cells(23, 7))
          For k = 4 To 100
           If Sheets("Druhy_PV").Cells(k, 1) = "" Then
            Exit For
           Else
            If Sheets("Druhy_PV").Cells(k, 1).Value = .lblDRV.Caption Then
             .tbPV.Text = Sheets("Druhy_PV").Cells(k, 2).Text
             Exit For
            End If
           End If
          Next k
         Else
          .lblDRV.Caption = "0"
         End If
         .lblPKU.Visible = False
         .cbPKU.Visible = False
         .lblSposobVyuz.Visible = True
         .lblSV.Visible = True
         j = j + 1
        End If
       End If
      Loop
     End If
     If .lblPocet.Caption = "0" Then
      .lblNeexistuje.Caption = "Parcela sa nenach|fffd|dza v pripojenej datab|fffd|ze"
      .frmNeexistuje.Visible = True
      .lblLVm.Visible = False
      .lblM2m.Visible = False
      .lblDPm.Visible = False
     Else
      .lblNeexistuje.Caption = ""
      .frmNeexistuje.Visible = False
      .lblLVm.Visible = True
      .lblM2m.Visible = True
      .lblDPm.Visible = True
     End If
    End If
 
    If operat = "KNE" Then
     If .tbPC.Text <> "" Then
      .lblREGISTER.Caption = "KN-E"
      .lblREGISTERm.Caption = "KN-E"
      .lblNeexistuje.Caption = ""
      i = 1
      j = 0
      Do
       i = i + 1
       If Sheets("DBF_EP").Cells(i, 1) = "" Then
        .lblPocet.Caption = j
        Exit Do
       Else
        VvPKU = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(47, 2))
        If Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(26, 7)) = UpravaPC_do_DBF(.tbPC.Text) And Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(27, 7)) = VvPKU Then
         .lblLV.Caption = Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(30, 7))
         .lblLVm.Caption = Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(30, 7))
         .lblM2.Caption = Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(28, 7))
         .lblM2m.Caption = Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(28, 7))
         DP = Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(29, 7))
         For k = 13 To 100
          If Sheets("nastavenia").Cells(k, 32) = "" Then
           Exit For
          Else
           If Sheets("nastavenia").Cells(k, 34) = DP Then .lblDP.Caption = Sheets("nastavenia").Cells(k, 33)
           If Sheets("nastavenia").Cells(k, 34) = DP Then .lblDPm.Caption = Sheets("nastavenia").Cells(k, 33)
          End If
         Next k
         If Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(32, 7)) = 1 Then .lblUMP.Caption = "intravil|fffd|n"
         If Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(32, 7)) = 2 Then .lblUMP.Caption = "extravil|fffd|n"
         If Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(31, 7)) <> 0 Then
          .lblDRV.Caption = Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(31, 7))
          For k = 4 To 100
           If Sheets("Druhy_PV").Cells(k, 1) = "" Then
            Exit For
           Else
            If Sheets("Druhy_PV").Cells(k, 1).Value = .lblDRV.Caption Then
             .tbPV.Text = Sheets("Druhy_PV").Cells(k, 2).Text
             Exit For
            End If
           End If
          Next k
         Else
          .lblDRV.Caption = "0"
         End If
         .lblPKU.Visible = True
         .cbPKU.Visible = True
         .lblSposobVyuz.Visible = False
         .lblSV.Visible = False
         .lblKodDrSt.Visible = False
         .lblKDS.Visible = False
         .slbSupisne.Visible = False
         .lblSC.Visible = False
         .lblSCodPC.Visible = False    ''DOPLENE 20.4.2019
         .slbSCodPC.Visible = False    ''DOPLENE 20.4.2019
         If Sheets("DBF_EP").Cells(i, Sheets("exp_imp").Cells(27, 7)) <> 0 Then
          ii = 1
          Do
           ii = ii + 1
           If Sheets("DBF_PK").Cells(ii, 1) = "" Then
            Exit Do
           Else
            If Sheets("DBF_PK").Cells(ii, Sheets("exp_imp").Cells(41, 7)).Text = VvPKU Then
             .cbPKU.Caption = Sheets("DBF_PK").Cells(ii, Sheets("exp_imp").Cells(42, 7)).Text
             Exit Do
            End If
           End If
          Loop
         Else
          .cbPKU.Caption = ""
         End If
         j = j + 1
        End If
       End If
      Loop
     End If
     If .lblPocet.Caption = 0 Then
      .lblNeexistuje.Caption = "Parcela sa nenach|fffd|dza v pripojenej datab|fffd|ze"
      .frmNeexistuje.Visible = True
     Else
      .lblNeexistuje.Caption = ""
      .frmNeexistuje.Visible = False
     End If
    End If
    
    If frm_FPU.lblLV.Caption <> "" And frm_FPU.lblLV.Caption <> "0" Then
     LV = frm_FPU.lblLV.Caption
     frm_FPU.lbVlastnici.Clear
     Podiel = 0
     spoluvlastnici = 0
     Sheets("exp_imp").Cells(45, 7) = "0"
     ii = 1
     Do
      ii = ii + 1
      If Sheets("DBF_VL").Cells(ii, 1) = "" Then
       frm_FPU.lblPodiel.Caption = Sheets("exp_imp").Cells(45, 7).Text
       frm_FPU.lblPodielPocet.Caption = spoluvlastnici
       Exit Do
      Else
       On Error GoTo ChybaVL
       If Sheets("DBF_VL").Cells(ii, Sheets("exp_imp").Cells(34, 7)).Text = LV Then
        spoluvlastnici = spoluvlastnici + 1
        frm_FPU.lbVlastnici.AddItem Sheets("DBF_VL").Cells(ii, Sheets("exp_imp").Cells(38, 7)).Text
        If Sheets("DBF_VL").Cells(ii, Sheets("exp_imp").Cells(36, 7)).Text <> "0" And Sheets("DBF_VL").Cells(ii, Sheets("exp_imp").Cells(37, 7)).Text <> "0" Then
         Podiel = Sheets("DBF_VL").Cells(ii, Sheets("exp_imp").Cells(36, 7)).Text / Sheets("DBF_VL").Cells(ii, Sheets("exp_imp").Cells(37, 7)).Text
         Sheets("exp_imp").Cells(45, 7) = Sheets("exp_imp").Cells(45, 7) + Podiel
        End If
       End If
      End If
     Loop
    End If
''SEM
    If frm_FPU.chbPridavat.Value = True Then
     Pridat_Do_Vv
    End If
   End With
  End If
 End If
End If

Exit Sub
ChybaVL: MsgBox "S|fffd|bor VL nem|fffd| spr|fffd|vny form|fffd|t"
End Sub


''Pridavat do VV
Sub Pridat_Do_Vv()
Dim stlpec_LV As Integer
Dim stlpec_Ha As Integer
Dim stlpec_m2 As Integer
Dim stlpec_DP As Integer

With Sheets("exp_imp")
 stlpec_LV = .Cells(19, 2)
 stlpec_Ha = .Cells(23, 2)
 stlpec_m2 = .Cells(24, 2)
 stlpec_DP = .Cells(25, 2)
 .Cells(57, 4) = frm_FPU.lblM2.Caption
End With
  
 If frm_FPU.lblLV.Caption <> "0" Then Cells(frm_FPU.AktivnyRiadok.Caption, stlpec_LV) = frm_FPU.lblLV.Caption
 If Sheets("exp_imp").Cells(57, 5) <> 0 Then Cells(frm_FPU.AktivnyRiadok.Caption, stlpec_Ha) = Sheets("exp_imp").Cells(57, 5)
 If Sheets("exp_imp").Cells(57, 5) <> 0 Or Sheets("exp_imp").Cells(57, 6) <> 0 Then Cells(frm_FPU.AktivnyRiadok.Caption, stlpec_m2) = Sheets("exp_imp").Cells(57, 6)
 Cells(frm_FPU.AktivnyRiadok.Caption, stlpec_DP) = frm_FPU.lblDP.Caption
End Sub



Attribute VB_Name = "mdl_Import_Nastaveni"
Dim pocet_riadkov As Integer

Sub Import_Nastavenia()

Dim FileName As Variant
Dim Sep As String
FileName = Application.GetOpenFilename(FileFilter:="Nastavenia (*.txt),*.txt")
If FileName = False Then
 Exit Sub
End If
Sep = ";"

With Sheets("XML")
 .Visible = True
 .Select
 .UsedRange.Delete
 
 ImportTextFile FName:=CStr(FileName), Sep:=CStr(Sep)
        
 Sheets("Vstup").Select
 .Visible = False
End With

pocet_riadkov = pocet_riadkov_List("XML")
Import_Firmy
Import_Meral
Import_Vyhotovil
Import_Autorizacne
Import_Pristroje
Import_Hranice
Import_GPS
Import_GPS_udaje
Import_Pozemky
Import_PozemkyPK
Import_Poznamky
Import_SirkyStlpcov

Sheets("Vstup").Select
frm_ExpImp.Hide

NACITANIE_CMB

End Sub

Public Sub ImportTextFile(FName As String, Sep As String)
Dim RowNdx As Long
Dim ColNdx As Integer
Dim TempVal As Variant
Dim WholeLine As String
Dim Pos As Integer
Dim NextPos As Integer
Dim SaveColNdx As Integer

Application.ScreenUpdating = False
SaveColNdx = 1
RowNdx = 1

Open FName For Input Access Read As #1

While Not EOF(1)
    Line Input #1, WholeLine
    If Right(WholeLine, 1) <> Sep Then
        WholeLine = WholeLine & Sep
    End If
    ColNdx = SaveColNdx
    Pos = 1
    NextPos = InStr(Pos, WholeLine, Sep)
    While NextPos >= 1
        TempVal = Mid(WholeLine, Pos, NextPos - Pos)
        Cells(RowNdx, ColNdx).NumberFormat = "@"
        Cells(RowNdx, ColNdx).Value = TempVal
        Pos = NextPos + 1
        ColNdx = ColNdx + 1
        NextPos = InStr(Pos, WholeLine, Sep)
    Wend
    RowNdx = RowNdx + 1
Wend

EndMacro:
On Error GoTo 0
Application.ScreenUpdating = True
Close #1

End Sub

Sub Import_Firmy()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim jj As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*firmy" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbFirmy.Text = ""
  For i = 2 To 11
   Sheets("exp_imp").Cells(i, 4) = ""
  Next i

  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 1) = "" Then
    Exit Do
   Else
    For jj = 1 To 10
     Sheets("Nastavenia").Cells(i, jj) = ""
    Next jj
   End If
  Loop

  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    For k = 1 To 10
     Sheets("Nastavenia").Cells(j, k) = .Cells(i, k)
    Next k
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_Meral()
Dim i As Integer
Dim j As Integer
Dim k As Integer

With Sheets("XML")
 j = 0
 i = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*Meral" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbMeral.Text = ""
  Sheets("exp_imp").Cells(4, 6) = ""

  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 20) = "" Then
    Exit Do
   Else
     Sheets("Nastavenia").Cells(i, 20) = ""
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("Nastavenia").Cells(j, 20) = .Cells(i, 1)
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_Vyhotovil()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim jj As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*Vyhotovil" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbVyhotovil.Text = ""
  Sheets("exp_imp").Cells(5, 6) = ""
  Sheets("exp_imp").Cells(9, 6) = ""

  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 22) = "" Then
    Exit Do
   Else
    For jj = 22 To 23
     Sheets("Nastavenia").Cells(i, jj) = ""
    Next jj
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("Nastavenia").Cells(j, 22) = .Cells(i, 1)
    Sheets("Nastavenia").Cells(j, 23) = .Cells(i, 2)
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_Autorizacne()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim jj As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*Autoriza|fffd|ne overil" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbOverovatel.Text = ""

  For i = 2 To 8
   Sheets("exp_imp").Cells(i, 8) = ""
  Next i

  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 18) = "" Then
    Exit Do
   Else
    For jj = 12 To 18
     Sheets("Nastavenia").Cells(i, jj) = ""
    Next jj
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    For k = 12 To 18
     Sheets("Nastavenia").Cells(j, k) = .Cells(i, k - 11)
    Next k
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_Pristroje()
Dim i As Integer
Dim j As Integer
Dim k As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*merac|fffd| pr|fffd|stroj" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbPristroje.Text = ""
  Sheets("exp_imp").Cells(1, 6) = ""
  
  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 25) = "" Then
    Exit Do
   Else
     Sheets("Nastavenia").Cells(i, 25) = ""
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("Nastavenia").Cells(j, 25) = .Cells(i, 1)
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_Hranice()
Dim i As Integer
Dim j As Integer
Dim k As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*ozna|fffd|enie hran|fffd|c" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbHranice.Text = ""
  Sheets("exp_imp").Cells(3, 6) = ""

  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 27) = "" Then
    Exit Do
   Else
     Sheets("Nastavenia").Cells(i, 27) = ""
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("Nastavenia").Cells(j, 27) = .Cells(i, 1)
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_GPS()
Dim i As Integer
Dim j As Integer
Dim k As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*GPS parametre" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Nastavenia").Cells(12, 30) = ""
  Sheets("Nastavenia").Cells(13, 30) = ""
  Sheets("Nastavenia").Cells(14, 30) = ""
  Sheets("Nastavenia").Cells(15, 30) = ""
 
  i = j
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("Nastavenia").Cells(12, 30) = .Cells(i, 1)
    Sheets("Nastavenia").Cells(13, 30) = .Cells(i, 2)
    Sheets("Nastavenia").Cells(14, 30) = .Cells(i, 3)
    Sheets("Nastavenia").Cells(15, 30) = .Cells(i, 4)
   End If
  Loop
 End If
End With

End Sub

Sub Import_GPS_udaje()
Dim i As Integer
Dim j As Integer
Dim k As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*GPS parametre - prihlasovacie |fffd|daje" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  Sheets("Vstup").cmbGPSmeno.Text = ""
  Sheets("exp_imp").Cells(2, 6) = ""
  
  i = 17
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 29) = "" Then
    Exit Do
   Else
     Sheets("Nastavenia").Cells(i, 29) = ""
   End If
  Loop
 
  i = j
  j = 18
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("Nastavenia").Cells(j, 29) = .Cells(i, 1)
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_Pozemky()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim jj As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*Pozemky" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 32) = "" Then
    Exit Do
   Else
    For jj = 32 To 34
     Sheets("Nastavenia").Cells(i, jj) = ""
    Next jj
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    For k = 32 To 34
     Sheets("Nastavenia").Cells(j, k) = .Cells(i, k - 31)
    Next k
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_PozemkyPK()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim jj As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*PozemkyPK" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  i = 12
  Do
   i = i + 1
   If Sheets("Nastavenia").Cells(i, 35) = "" Then
    Exit Do
   Else
    For jj = 35 To 37
     Sheets("Nastavenia").Cells(i, jj) = ""
    Next jj
   End If
  Loop
 
  i = j
  j = 13
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    For k = 35 To 37
     Sheets("Nastavenia").Cells(j, k) = .Cells(i, k - 34)
    Next k
    j = j + 1
   End If
  Loop
 End If
End With

End Sub


Sub Import_Poznamky()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim jj As Integer

With Sheets("XML")
 i = 0
 j = 0
 Do
  i = i + 1
  If .Cells(i, 1) = pocet_riadkov Then Exit Do
  If i > pocet_riadkov Then Exit Do
  If .Cells(i, 1) = "*Pozn|fffd|mky" Then
   j = i + 1
   Exit Do
  End If
 Loop

 If j <> 0 Then
  i = 2
  Do
   i = i + 1
   If Sheets("poznamky").Cells(i, 2) = "" Then
    Exit Do
   Else
    For jj = 1 To 2
     Sheets("poznamky").Cells(i, jj) = ""
    Next jj
   End If
  Loop
 
  i = j
  j = 3
  Do
   i = i + 1
   If .Cells(i, 1) = "-1" Then
    Exit Do
   Else
    Sheets("poznamky").Cells(j, 1) = .Cells(i, 1)
    Sheets("poznamky").Cells(j, 2) = .Cells(i, 2)
    j = j + 1
   End If
  Loop
 End If
End With

End Sub

Sub Import_SirkyStlpcov()
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim l As Integer
Dim m As Integer
Dim HodnotaDoub As Double

j = -1

For i = 1 To pocet_riadkov
 If Sheets("XML").Cells(i, 1) = "*|fffd||fffd|rky st|fffd|pcov jednotliv|fffd|ch h|fffd|rkov" Then
  j = i + 1
 End If
Next i

   ''j odtial zacina prehladavanie Sirky stlpcov
   
If j <> -1 Then
 For i = j To pocet_riadkov
  For j = 1 To Sheets.Count
   On Error Resume Next
   If "*" & Sheets(j).Name = Sheets("XML").Cells(i, 1) Then
    For k = 2 To 41
     HodnotaDoub = Sheets("XML").Cells(i + 2, k).Value
     On Error Resume Next
     Sheets(j).Columns(k - 1).ColumnWidth = HodnotaDoub
    Next k
   End If
  Next j
 Next i
End If

End Sub

Attribute VB_Name = "mdl_Katuz"
'Sub KATUZ_nacitanie()

Dim i As Integer

Sub KATUZ_nacitanie()

'********************************************************************Katastralne uzemia"
'Sheets("exp_imp").Cells(2, 10) = pocet_riadkov_List("KU")

'**********************************************************Katastralne uzemia / Kraj"
With Sheets("Vstup").cmbKraj
    .Clear
    .AddItem Sheets("KU").Cells(2, 1)
    For i = 3 To Sheets("exp_imp").Cells(2, 10)
      If Sheets("KU").Cells(i, 1) <> Sheets("KU").Cells(i - 1, 1) Then .AddItem Sheets("KU").Cells(i, 1)
    Next i

    If Sheets("exp_imp").Cells(1, 2) = "" Then Sheets("exp_imp").Cells(1, 2) = Sheets("KU").Cells(2, 1)
    .Text = Sheets("exp_imp").Cells(1, 2)
End With

With Sheets("Vstup").cmbKraj
     Sheets("exp_imp").Cells(3, 10) = 0

     For i = 2 To Sheets("exp_imp").Cells(2, 10)
        If Sheets("KU").Cells(i, 1) = .Text Then
          If Sheets("exp_imp").Cells(3, 10) = 0 Then Sheets("exp_imp").Cells(3, 10) = i
          If Sheets("exp_imp").Cells(3, 10) <> 0 Then Sheets("exp_imp").Cells(3, 11) = i
        End If
     Next i

End With
'koniec****************************************************Katastralne uzemia / Kraj"


If Sheets("exp_imp").Cells(3, 10) = 0 Then
  Sheets("Vstup").cmbKraj.Text = Sheets("KU").Cells(2, 1)
  Sheets("exp_imp").Cells(3, 10) = 2
End If

'*********************************************************Katastralne uzemia / Okres"
With Sheets("Vstup").cmbOkres
     .Clear
     .AddItem Sheets("KU").Cells(Sheets("exp_imp").Cells(3, 10), 2)

    For i = Sheets("exp_imp").Cells(3, 10) + 1 To Sheets("exp_imp").Cells(3, 11)
        If Sheets("KU").Cells(i, 2) <> Sheets("KU").Cells(i - 1, 2) Then .AddItem Sheets("KU").Cells(i, 2)
    Next i

    If Sheets("exp_imp").Cells(2, 2) = "" Then Sheets("exp_imp").Cells(2, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(3, 10), 2)
    .Text = Sheets("exp_imp").Cells(2, 2)
    
    If Sheets("exp_imp").Cells(3, 2) = "" Then Sheets("exp_imp").Cells(3, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(3, 10), 3)

End With

With Sheets("Vstup").cmbOkres
     Sheets("exp_imp").Cells(4, 10) = 0

     For i = Sheets("exp_imp").Cells(3, 10) To Sheets("exp_imp").Cells(3, 11)
        If Sheets("KU").Cells(i, 2) = .Text Then
          If Sheets("exp_imp").Cells(4, 10) = 0 Then Sheets("exp_imp").Cells(4, 10) = i
          If Sheets("exp_imp").Cells(4, 10) <> 0 Then Sheets("exp_imp").Cells(4, 11) = i
        End If
    Next i
 End With
'koniec***************************************************Katastralne uzemia / Okres"

'**********************************************************Katastralne uzemia / Obec"
With Sheets("Vstup").cmbObec
     .Clear
     .AddItem Sheets("KU").Cells(Sheets("exp_imp").Cells(4, 10), 4)

    For i = Sheets("exp_imp").Cells(4, 10) + 1 To Sheets("exp_imp").Cells(4, 11)
        If Sheets("KU").Cells(i, 4) <> Sheets("KU").Cells(i - 1, 4) Then .AddItem Sheets("KU").Cells(i, 4)
    Next i

    If Sheets("exp_imp").Cells(4, 2) = "" Then Sheets("exp_imp").Cells(4, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(4, 10), 4)
    .Text = Sheets("exp_imp").Cells(4, 2)

End With

With Sheets("Vstup").cmbObec
     Sheets("exp_imp").Cells(5, 10) = 0

     For i = Sheets("exp_imp").Cells(4, 10) To Sheets("exp_imp").Cells(4, 11)
        If Sheets("KU").Cells(i, 4) = .Text Then
          If Sheets("exp_imp").Cells(5, 10) = 0 Then Sheets("exp_imp").Cells(5, 10) = i
          If Sheets("exp_imp").Cells(5, 10) <> 0 Then Sheets("exp_imp").Cells(5, 11) = i
        End If
    Next i
 End With
'koniec****************************************************Katastralne uzemia / Obec"

'koniec***************************************************Katastralne uzemia / katuz"
With Sheets("Vstup").cmbKatuz
     .Clear
     .AddItem Sheets("KU").Cells(Sheets("exp_imp").Cells(5, 10), 6)

    For i = Sheets("exp_imp").Cells(5, 10) + 1 To Sheets("exp_imp").Cells(5, 11)
        If Sheets("KU").Cells(i, 6) <> Sheets("KU").Cells(i - 1, 6) Then .AddItem Sheets("KU").Cells(i, 6)
    Next i

    If Sheets("exp_imp").Cells(5, 2) = "" Then Sheets("exp_imp").Cells(5, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(5, 10), 6)
    .Text = Sheets("exp_imp").Cells(5, 2)

    If Sheets("exp_imp").Cells(6, 2) = "" Then Sheets("exp_imp").Cells(6, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(5, 10), 5)
    If Sheets("exp_imp").Cells(7, 2) = "" Then Sheets("exp_imp").Cells(7, 2) = Sheets("KU").Cells(Sheets("exp_imp").Cells(5, 10), 7)
    If Sheets("exp_imp").Cells(7, 2) = "" Then Sheets("Vstup").Cells(8, 4) = "Zadaj skratku KU"
    If Sheets("exp_imp").Cells(7, 2) <> "" Then Sheets("Vstup").Cells(8, 4) = Sheets("exp_imp").Cells(7, 2).Text

End With
'*********************************************************Katastralne uzemia / katuz"
'koniec**************************************************************Katastralne uzemia"

End Sub

Attribute VB_Name = "mdl_Legenda"
Sub Legenda(Stav_pravny As Boolean)

Dim i As Integer
Dim j As Integer
Dim pom As String
Dim Spolu As Integer
Dim je As Integer
Dim pocet_riadkov As Integer
Dim pozicia_Spolu As Integer
Dim nazov_listu As String
Dim pozicia_kodov As Integer
Dim pozicia_cisla As Integer
Dim pozicia_Tabulka As Integer
Dim pozicia_poznamka As Integer
Dim pozicia_DruhPozemku As Integer
Dim pozicia_Diel As Integer

'POZICIA SPOLU
i = 0
Do
 i = i + 1
 On Error GoTo Chyba_Spolu
 
 If Stav_pravny = True Then If Spolu = 2 Then Exit Do
 If Stav_pravny = False Then If Spolu = 1 Then Exit Do
 
 If Cells(i, 1) = "Spolu:" Then
  Spolu = Spolu + 1
  pozicia_Spolu = i
 End If
Loop

nazov_listu = ActiveSheet.Name
pocet_riadkov = pocet_riadkov_List(ActiveSheet.Name)
   
For i = 1 To 6
 For j = 1 To 31
  If Cells(i, j) = Sheets("Vv_vzor").Cells(3, 12) Then pozicia_cisla = j
  If Cells(i, j) = Sheets("Vv_vzor").Cells(5, 15) Then pozicia_kodov = j
  If Cells(i, j) = Sheets("Vv_vzor").Cells(3, 4) Then pozicia_DruhPozemku = j
  If Cells(i, j) = Sheets("Vv_vzor").Cells(3, 7) Then pozicia_Diel = j
 Next j
Next i

For i = 1 To pocet_riadkov
 If Cells(i, 1) = Sheets("exp_imp").Cells(14, 1) Then pozicia_Tabulka = i
Next i

If pozicia_Spolu > 0 Then
 If pozicia_Tabulka > 0 Then pocet_riadkov = pozicia_Tabulka - 1

 For i = pozicia_Spolu + 1 To pocet_riadkov
  If Cells(i, 1) <> "" Then pozicia_poznamka = i
 Next i
 
 If pozicia_poznamka = 0 Then pozicia_poznamka = pozicia_Spolu
 
 Dim SVP(1 To 39) As String
 Dim SVP_cisla(1 To 39) As Integer
 Dim KDS(1 To 23) As String
 Dim KDS_cisla(1 To 23) As Integer
 Dim ii As String
 Dim jj As String
 ii = 1
 jj = 1

 Dim Sposob_vyuzivania_Zaciatok As Integer
 Dim Sposob_vyuzivania_Koniec As Integer
 Dim Kod_druhu_stavby_Zaciatok As Integer
 Dim Kod_druhu_stavby_Koniec As Integer

 With Sheets("Vyuz_poz")
  i = 0
  Do
   i = i + 1
   If .Cells(i, 1) = "Sp|fffd|sob vyu|fffd||fffd|vania pozemku" Then Sposob_vyuzivania_Zaciatok = i + 2
   If .Cells(i, 1) = "K|fffd|D DRUHU STAVBY (BUDOVY)" Then Kod_druhu_stavby_Zaciatok = i + 2
   If .Cells(i, 1) = "" Then
    If Sposob_vyuzivania_Koniec = 0 Then
     Sposob_vyuzivania_Koniec = i - 1
    Else
     If Kod_druhu_stavby_Koniec = 0 And Kod_druhu_stavby_Zaciatok <> 0 Then Kod_druhu_stavby_Koniec = i - 1
    End If
    If Sposob_vyuzivania_Koniec <> 0 And Kod_druhu_stavby_Koniec <> 0 Then Exit Do
   End If
  Loop
 End With
 
 For i = 6 To pozicia_Spolu - 1
  If Cells(i, pozicia_cisla) = "" Then
   If Cells(i, pozicia_kodov) <> "" Then
    If Cells(i - 1, pozicia_cisla) <> "" And Cells(i, pozicia_cisla) = "" Then
     For j = Sposob_vyuzivania_Zaciatok To Sposob_vyuzivania_Koniec
      If Cells(i, pozicia_kodov).Text = Sheets("Vyuz_poz").Cells(j, 1).Text And Sheets("Vyuz_poz").Cells(j, 5) = "" Then
       Sheets("Vyuz_poz").Cells(j, 5) = "je"
       SVP(ii) = " " & Sheets("Vyuz_poz").Cells(j, 1) & " - " & Sheets("Vyuz_poz").Cells(j, 2)
       SVP_cisla(ii) = Sheets("Vyuz_poz").Cells(j, 1)
       ii = ii + 1
      End If
     Next j
    Else:
     For j = Kod_druhu_stavby_Zaciatok To Kod_druhu_stavby_Koniec
      If Cells(i, pozicia_kodov).Text = Sheets("Vyuz_poz").Cells(j, 1).Text And Sheets("Vyuz_poz").Cells(j, 5) = "" Then
       Sheets("Vyuz_poz").Cells(j, 5) = "je"
       KDS(jj) = " " & Sheets("Vyuz_poz").Cells(j, 1) & " - " & Sheets("Vyuz_poz").Cells(j, 2)
       KDS_cisla(jj) = Sheets("Vyuz_poz").Cells(j, 1)
       jj = jj + 1
      End If
     Next j
    End If
   End If
  End If
 Next i

 i = 0
 Dim pocet_prvkov_legenda(2) As Integer
 Do
  i = i + 1
''  On Error GoTo LEGENDA_CHYBA ' pri chybe sa posunie na riadok nazvany LEGENDA_CHYBA
    
  If SVP(i) = "" Then
   pocet_prvkov_legenda(1) = i - 1
   Exit Do
  End If
 Loop

 i = 0
 Do
  i = i + 1
''  On Error GoTo LEGENDA_CHYBA ' pri chybe sa posunie na riadok nazvany LEGENDA_CHYBA
   
  If KDS(i) = "" Then
   pocet_prvkov_legenda(2) = i - 1
   Exit Do
  End If
 Loop

'USPORIADANIE PRVKOV
 If pocet_prvkov_legenda(1) > 0 Then
  For i = 1 To pocet_prvkov_legenda(1) - 1
   For j = i + 1 To pocet_prvkov_legenda(1)
    If SVP_cisla(j) < SVP_cisla(i) Then
     pom = SVP(j)
     SVP(j) = SVP(i)
     SVP(i) = pom
    End If
   Next j
  Next i
 End If
        
 If pocet_prvkov_legenda(2) > 0 Then
  For i = 1 To pocet_prvkov_legenda(2) - 1
   For j = i + 1 To pocet_prvkov_legenda(2)
    If KDS_cisla(j) < KDS_cisla(i) Then
     pom = KDS(j)
     KDS(j) = KDS(i)
     KDS(i) = pom
    End If
   Next j
  Next i
 End If

 If pocet_prvkov_legenda(2) > 0 Then _
        pocet_riadkov = pocet_prvkov_legenda(1) + pocet_prvkov_legenda(2) + 1 Else _
        pocet_riadkov = pocet_prvkov_legenda(1)
                                        
 Sheets("Vyuz_poz").Columns(5).Delete
 
 If pozicia_Tabulka = 0 Or pocet_riadkov < pozicia_Tabulka - pozicia_poznamka - 1 Then
  Dim k As Integer
  If pocet_prvkov_legenda(1) > 0 Then
   Cells(pozicia_poznamka + 2, pozicia_Diel - 1) = "Legenda: k|fffd|d sp|fffd|sobu vyu|fffd||fffd|vania  "
   Cells(pozicia_poznamka + 2, pozicia_Diel - 1).HorizontalAlignment = xlRight
   Cells(pozicia_poznamka + 2, pozicia_Diel - 1).VerticalAlignment = xlTop
   Cells(pozicia_poznamka + 2, pozicia_Diel - 1).Font.Size = 9
   Cells(pozicia_poznamka + 2, pozicia_Diel - 1).Font.Italic = True
   Cells(pozicia_poznamka + 2, pozicia_Diel - 1).Font.Name = "Times New Roman"
   Cells(pozicia_poznamka + 2, 1).Select
   For i = 1 To pocet_prvkov_legenda(1)
    Cells(pozicia_poznamka + 1 + i, pozicia_Diel) = SVP(i)
    
    If Len(SVP(i)) > 99 Then
     Dim PomLen As Double
     If Sheets("exp_imp").Cells(21, 2) <> 0 Then
      Sheets("exp_imp").Cells(56, 1) = Len(SVP(i)) / 132
     Else
      Sheets("exp_imp").Cells(56, 1) = Len(SVP(i)) / 99
     End If
     PomLen = Sheets("exp_imp").Cells(57, 1)
     
     Cells(pozicia_poznamka + 1 + i, pozicia_Diel).RowHeight = PomLen * 14.25

     Range(Cells(pozicia_poznamka + 1 + i, pozicia_Diel), Cells(pozicia_poznamka + 1 + i, Sheets("exp_imp").Cells(36, 2) - 1)).Merge
     Range(Cells(pozicia_poznamka + 1 + i, pozicia_Diel), Cells(pozicia_poznamka + 1 + i, Sheets("exp_imp").Cells(36, 2) - 1)).HorizontalAlignment = xlLeft
     Range(Cells(pozicia_poznamka + 1 + i, pozicia_Diel), Cells(pozicia_poznamka + 1 + i, Sheets("exp_imp").Cells(36, 2) - 1)).VerticalAlignment = xlTop
     Range(Cells(pozicia_poznamka + 1 + i, pozicia_Diel), Cells(pozicia_poznamka + 1 + i, Sheets("exp_imp").Cells(36, 2) - 1)).WrapText = True
     
    Else
     Cells(pozicia_poznamka + 1 + i, pozicia_Diel).RowHeight = 14.25
    End If
    Cells(pozicia_poznamka + 1 + i, pozicia_Diel).HorizontalAlignment = xlLeft
    Cells(pozicia_poznamka + 1 + i, pozicia_Diel).VerticalAlignment = xlTop
    k = pozicia_poznamka + 1 + i + 2
   Next i
  End If
 
  If pocet_prvkov_legenda(2) > 0 Then
   Cells(k, pozicia_Diel - 1) = "k|fffd|d druhu stavby  "
   Cells(k, pozicia_Diel - 1).HorizontalAlignment = xlRight
   Cells(k, pozicia_Diel - 1).VerticalAlignment = xlTop
   Cells(k, pozicia_Diel - 1).Font.Size = 9
   Cells(k, pozicia_Diel - 1).Font.Italic = True
   Cells(k, pozicia_Diel - 1).Font.Name = "Times New Roman"
   For i = 1 To pocet_prvkov_legenda(2)
    Cells(k + i - 1, pozicia_Diel) = KDS(i)
    Cells(k + i - 1, pozicia_Diel).HorizontalAlignment = xlLeft
   Next i
  End If
 Else:
  If pocet_prvkov_legenda(2) > 0 Then _
        pocet_riadkov = pocet_prvkov_legenda(1) + pocet_prvkov_legenda(2) + 2 Else _
        pocet_riadkov = pocet_prvkov_legenda(1) + 1

 If pocet_riadkov < 5 Then MsgBox "Legenda sa nevmesti. S|fffd| potrebn|fffd| " & pocet_riadkov & " pr|fffd|zde riadky (vlo|fffd| e|fffd|te " & Abs(pozicia_Tabulka - pozicia_poznamka - pocet_riadkov - 1) & " r.)", vbOKOnly, "Legenda info" Else _
                            MsgBox "Legenda sa nevmesti. Je potrebn|fffd|ch " & pocet_riadkov & " pr|fffd|zdnych riadkov (vlo|fffd| e|fffd|te " & Abs(pozicia_Tabulka - pozicia_poznamka - pocet_riadkov - 1) & " r.)", vbOKOnly, "Legenda info"

 End If
End If

Exit Sub
LEGENDA_CHYBA: MsgBox "Chyba pri vytvaran|fffd| Legendy. Spoj sa s dod|fffd|vate|fffd|om Tabuliek :-)", vbOKOnly, "Tabulky_GP"
Chyba_Spolu: MsgBox "Ch|fffd|ba ""Spolu:"". AK ho nechce|fffd| ma|fffd| vo V|fffd|kaze v|fffd|mer, tak ho vyma|fffd| a|fffd| po vytvoren|fffd| XML, alebo daj font pisma biely."
End Sub
Attribute VB_Name = "mdl_ListyViditelne"
'Sub ListyViditelne()

Sub ListyViditelne()
Dim i As Integer
Dim j As Integer
Dim meno As String
meno = ""

Sheets("Vstup").ListHide.Clear
Sheets("Vstup").ListVisible.Clear

For i = 1 To Worksheets.Count
 If Worksheets(i).Name <> "upravaPC" And _
    Worksheets(i).Name <> "exp_imp" And _
    Worksheets(i).Name <> "KU" And _
    Worksheets(i).Name <> "Nastavenia" And _
    Worksheets(i).Name <> "poznamky" And _
    Worksheets(i).Name <> "poznamky_XML" And _
    Worksheets(i).Name <> "Prehlad_poznamok" And _
    Worksheets(i).Name <> "Vstup" And _
    Worksheets(i).Name <> "DBF_PA" And _
    Worksheets(i).Name <> "DBF_EP" And _
    Worksheets(i).Name <> "DBF_VL" And _
    Worksheets(i).Name <> "DBF_PK" And _
    Worksheets(i).Name <> "DBF_CS" And _
    Worksheets(i).Name <> "Druhy_PV" And _
    Worksheets(i).Name <> "NacitanieVGI" And _
    Worksheets(i).Name <> "Vv_vzor" And _
    Worksheets(i).Name <> "GPS_RTK" And _
    Worksheets(i).Name <> "Tabulka_GP_GeosK" And _
    Worksheets(i).Name <> "Tabulka_GP_VvA" And _
    Worksheets(i).Name <> "Tabulka_GP_VvA_A3" And _
    Worksheets(i).Name <> "XML" Then
  If Worksheets(i).Visible = True Then
     Sheets("Vstup").ListVisible.AddItem Worksheets(i).Name
  Else:
     Sheets("Vstup").ListHide.AddItem Worksheets(i).Name
  End If
 Else:
  
  If Sheets("Vstup").Cells(2, 6) = "Stano" Then meno = "Stano"
  If Sheets("Vstup").Cells(2, 6) = "GeosK" Then meno = "GeosK"
  
  If meno = "Stano" Then
    If Worksheets(i).Visible = True Then
       Sheets("Vstup").ListVisible.AddItem Worksheets(i).Name
    Else:
       Sheets("Vstup").ListHide.AddItem Worksheets(i).Name
    End If
  End If
  
  If meno = "GeosK" Then
   If Worksheets(i).Name = "Tabulka_GP_GeosK" Then
    If Worksheets(i).Visible = True Then
       Sheets("Vstup").ListVisible.AddItem "Tabulka_GP_GeosK"
    Else:
       Sheets("Vstup").ListHide.AddItem "Tabulka_GP_GeosK"
    End If
   End If
  End If
  
 End If
Next i

For i = 1 To Worksheets.Count
 If Worksheets(i).Name = "upravaPC" Or _
    Worksheets(i).Name = "exp_imp" Or _
    Worksheets(i).Name = "KU" Or _
    Worksheets(i).Name = "Nastavenia" Or _
    Worksheets(i).Name = "poznamky" Or _
    Worksheets(i).Name = "poznamky_XML" Or _
    Worksheets(i).Name = "Prehlad_poznamok" Or _
    Worksheets(i).Name = "DBF_PA" Or _
    Worksheets(i).Name = "DBF_EP" Or _
    Worksheets(i).Name = "DBF_VL" Or _
    Worksheets(i).Name = "DBF_PK" Or _
    Worksheets(i).Name = "DBF_CS" Or _
    Worksheets(i).Name = "Druhy_PV" Or _
    Worksheets(i).Name = "NacitanieVGI" Or _
    Worksheets(i).Name = "Vv_vzor" Or _
    Worksheets(i).Name = "GPS_RTK" And _
    Worksheets(i).Name = "Tabulka_GP_GeosK" And _
    Worksheets(i).Name = "Tabulka_GP_VvA" And _
    Worksheets(i).Name = "Tabulka_GP_VvA_A3" And _
    Worksheets(i).Name = "XML" Then _
    If meno <> "Stano" Then Worksheets(i).Visible = xlSheetVeryHidden
Next i

End Sub



Attribute VB_Name = "mdl_ManualneZadanie"
Sub ManualneZadanie()
Dim i As Integer
Dim je As Integer

''-----------------------------------------------------------------------------Pristroje
With Sheets("nastavenia")

 Sheets("exp_imp").Cells(1, 6) = Sheets("Vstup").cmbPristroje.Text
 je = 0
 i = 12
 Do
  i = i + 1
  If .Cells(i, 25) = "" Then
   Exit Do
  Else
   If .Cells(i, 25).Text = Sheets("Vstup").cmbPristroje.Text Then je = 1
  End If
 Loop
     
 If je = 0 Then .Cells(i, 25) = Sheets("Vstup").cmbPristroje.Text
 
 PRISTROJE_nacitanie
''-----------------------------------------------------------------------------Pristroje


''-----------------------------------------------------------------------------Hranice
 Sheets("exp_imp").Cells(3, 6) = Sheets("Vstup").cmbHranice.Text
 je = 0
 i = 12
 Do
  i = i + 1
  If .Cells(i, 27) = "" Then
   Exit Do
  Else
   If .Cells(i, 27).Text = Sheets("Vstup").cmbHranice.Text Then je = 1
  End If
 Loop
     
 If je = 0 Then .Cells(i, 27) = Sheets("Vstup").cmbHranice.Text
 
 HRANICE_nacitanie
''-----------------------------------------------------------------------------Hranice


''-----------------------------------------------------------------------------Meral
 Sheets("exp_imp").Cells(4, 6) = Sheets("Vstup").cmbMeral.Text
 je = 0
 i = 12
 Do
  i = i + 1
  If .Cells(i, 20) = "" Then
   Exit Do
  Else
   If .Cells(i, 20).Text = Sheets("Vstup").cmbMeral.Text Then je = 1
  End If
 Loop
     
 If je = 0 Then .Cells(i, 20) = Sheets("Vstup").cmbMeral.Text

 MERAL_nacitanie
''-----------------------------------------------------------------------------Meral


''-----------------------------------------------------------------------------Vyhotovil
 Sheets("exp_imp").Cells(5, 6) = Sheets("Vstup").cmbVyhotovil.Text
 je = 0
 i = 12
 Do
  i = i + 1
  If .Cells(i, 22) = "" Then
   Exit Do
  Else
   If .Cells(i, 22).Text = Sheets("Vstup").cmbVyhotovil.Text Then je = 1
  End If
 Loop
     
 If je = 0 Then .Cells(i, 22) = Sheets("Vstup").cmbVyhotovil.Text

 VYHOTOVIL_nacitanie
''-----------------------------------------------------------------------------Vyhotovil


End With
End Sub

Attribute VB_Name = "mdl_Menu"
'Sub AktivaciaMenu1()
'Sub DeAktivaciaMenu1()

Sub AktivaciaMenu()
Dim stlpec_PK As Integer
Dim stlpec_KN_C As Integer
Dim stlpec_diel As Integer
Dim stlpec_NOVY_STAV As Integer
Dim stlpec_KN_E As Integer
Dim stlpec_KN_C2 As Integer

Dim Popup_Hlavne As CommandBar
Dim Popup_Hlavne_Control As CommandBarControl
   
On Error Resume Next
CommandBars("Cell").FindControl(Tag:="Akcia1").Delete
On Error GoTo 0
Set Popup_Hlavne = CommandBars("Cell")
Popup_Hlavne.Controls(1).BeginGroup = True
Set Popup_Hlavne_Control = Popup_Hlavne.Controls.Add(Type:=msoControlPopup, before:=1, Temporary:=True)
With Popup_Hlavne_Control
 .Caption = "<<<   Menu TSGP   >>>"
 .Tag = "PopUp_Hlavne1"
End With

''  FORMAT BUNKY
Dim FormatBunky As CommandBarControl
Set FormatBunky = Popup_Hlavne_Control.Controls.Add(Type:=msoControlPopup, before:=1, Temporary:=True)
With FormatBunky
 .Caption = "Form|fffd|t bunky"
 .BeginGroup = True
 .Tag = "FormatBunky_hlavne"
End With
           
Set FormatBunkyButton5 = FormatBunky.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
With FormatBunkyButton5
 .Caption = "|fffd||fffd|slo na datum v tvare 01.01.2019"
 .Tag = "FormatBunky5"
 .OnAction = "Zmena_formatu5"
End With

Set FormatBunkyButton4 = FormatBunky.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
With FormatBunkyButton4
 .Caption = "|fffd||fffd|slo na 0 desatinn|fffd|ch miest"
 .Tag = "FormatBunky4"
 .OnAction = "Zmena_formatu4"
End With
            
Set FormatBunkyButton3 = FormatBunky.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
With FormatBunkyButton3
 .Caption = "Text"
 .Tag = "FormatBunky3"
 .OnAction = "Zmena_formatu3"
End With
            
Set FormatBunkyButton2 = FormatBunky.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
 With FormatBunkyButton2
 .Caption = "|fffd|tvorcifern|fffd| (doplnen|fffd| o nuly)"
 .Tag = "FormatBunky2"
 .OnAction = "Zmena_formatu2"
End With
            
Set FormatBunkyButton1 = FormatBunky.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
With FormatBunkyButton1
 .Caption = "V|fffd|eobecn|fffd|"
 .Tag = "FormatBunky1"
 .OnAction = "Zmena_formatu1"
End With
''  FORMAT BUNKY   koniec


''SIAHY ODPOCET
If Sheets(ActiveSheet.Name).Cells(1, 1) = Sheets("Vv_vzor").Cells(1, 1) Then
 
 Dim Siahy As CommandBarControl
 Set Siahy = Popup_Hlavne_Control.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
 With Siahy
  .Caption = "Prevod st|fffd|p na metre |fffd|tvorcov|fffd|"
  .Tag = "Siahy"
  .OnAction = "siahy_HM"
 End With

 Set Odpocet = Popup_Hlavne_Control.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
 With Odpocet
  .Caption = "Zistenie zbytkovej v|fffd|mery (odpo|fffd|et)"
  .BeginGroup = True
  .Tag = "Odpocet"
  .OnAction = "odpocet_HM"
 End With
 ''SIAHY ODPOCET koniec

 ''FPU
'' If Sheets("exp_imp").Cells(43, 7) <> "nepripojen|fffd|" Then
  Set FPU = Popup_Hlavne_Control.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
  With FPU
   .Caption = "Otvori|fffd| FPU / CSV"
   .BeginGroup = True
   .Tag = "FPU"
   .OnAction = "FPU_zobrazit"
  End With
'' End If
 ''FPU koniec
 
 ''VGI
 If Sheets("Vstup").Cells(2, 6) = "Stano" Or Sheets("Vstup").Cells(2, 6) = "GeosK" Then
  Set vgi = Popup_Hlavne_Control.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
  With vgi
   .Caption = "Vytvori|fffd| technick|fffd| spr|fffd|vu pomocou VGI a STX"
   .BeginGroup = True
   .Tag = "VGI"
   .OnAction = "VGI_menu"
  End With
 End If
 ''VGI koniec
 
End If

'' Kopia listu
Set Kopia_Listu = Popup_Hlavne_Control.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
With Kopia_Listu
 .Caption = "K|fffd|pia listu"
 .Tag = "KopiaListu"
 .OnAction = "kopia_harku"
End With
'' kopia listu koniec

'' Vlozit riadok
Dim Vlozit_riadok_Control As CommandBarControl
On Error Resume Next
CommandBars("Cell").FindControl(Tag:="VlozitRiadok").Delete
On Error GoTo 0
Set Vlozit_riadok_Control = Popup_Hlavne_Control.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
With Vlozit_riadok_Control
 .Caption = "Vlo|fffd|i|fffd| riadok nad aktu|fffd|lny"
 .Tag = "VlozitRiadok"
 .OnAction = "vlozit_riadok"
End With
'' Vlozit riadok koniec
''*************************************************

If Cells(1, 1) = " Z|fffd|ZNAM  PODROBN|fffd|HO  MERANIA  ZMIEN" Then
 Dim VlozitVlastnikov As CommandBar
  Dim VlozitVlastnikov_Control As CommandBarControl
  On Error Resume Next
  CommandBars("Cell").FindControl(Tag:="VlozitVlastnikov").Delete
  On Error GoTo 0
  Set VlozitVlastnikov = CommandBars("Cell")
  VlozitVlastnikov.Controls(1).BeginGroup = True
  Set VlozitVlastnikov_Control = VlozitVlastnikov.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
  With VlozitVlastnikov_Control
   .Caption = "Na|fffd||fffd|ta|fffd| vlastn|fffd|kov z V|fffd|kazu v|fffd|mer"
   .Tag = "Vlozit_Vlastnikov"
   .OnAction = "nacitat_z_Vv"
  End With
End If
''*************************************************

''Pridat Novy druh pozemku
If ActiveCell.Column = Sheets("exp_imp").Cells(25, 2) And Cells(1, 1).Text = Sheets("Vv_vzor").Cells(1, 1).Text And _
   Cells(ActiveCell.Row, Sheets("exp_imp").Cells(20, 2)) <> "" Then
 Dim PridatPozemok As CommandBar
  Dim PridatPozemok_Control As CommandBarControl
  On Error Resume Next
  CommandBars("Cell").FindControl(Tag:="PridatPozemok").Delete
  On Error GoTo 0
  Set PridatPozemok = CommandBars("Cell")
  PridatPozemok.Controls(1).BeginGroup = True
  Set PridatPozemok_Control = PridatPozemok.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
  With PridatPozemok_Control
   .Caption = "Pridat nov|fffd| druh pozemku"
   .Tag = "PridatPozemok"
   .OnAction = "pozemkyPKmenu"
  End With
End If
''Pridat Novy druh pozemku koniec

''Pridat poznamku
If Cells(1, 1) = Sheets("Vv_vzor").Cells(1, 1) Then
 Dim PridatPoznamku As CommandBar
  Dim PridatPoznamku_Control As CommandBarControl
  On Error Resume Next
  CommandBars("Cell").FindControl(Tag:="PridatPoznamku").Delete
  On Error GoTo 0
  Set PridatPoznamku = CommandBars("Cell")
  PridatPoznamku.Controls(1).BeginGroup = True
  Set PridatPoznamku_Control = PridatPoznamku.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
  With PridatPoznamku_Control
   .Caption = "Pridat pozn|fffd|mku"
   .Tag = "PridatPoznamku"
   .OnAction = "Poznamky_spustit"
  End With
''Pridat poznamku koniec

 If ActiveCell.Column = Sheets("exp_imp").Cells(46, 2) And Cells(1, 1).Text = Sheets("Vv_vzor").Cells(1, 1).Text Then
  Dim PridatSposovVyuzivania As CommandBar
  Dim PridatSposovVyuzivania_Control As CommandBarControl
  On Error Resume Next
  CommandBars("Cell").FindControl(Tag:="PridatSposovVyuzivania").Delete
  On Error GoTo 0
  Set PridatSposovVyuzivania = CommandBars("Cell")
  PridatSposovVyuzivania.Controls(1).BeginGroup = True
  Set PridatSposovVyuzivania_Control = PridatSposovVyuzivania.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
   With PridatSposovVyuzivania_Control
      .Caption = "K|fffd|d druhu stavby"
      .Tag = "PridatSposovVyuzivania"
      .OnAction = "Stavba"
   End With
''*************************************************
  Dim PridatKodDruhuStavby As CommandBar
  Dim PridatKodDruhuStavby_Control As CommandBarControl
   On Error Resume Next
   CommandBars("Cell").FindControl(Tag:="PridatKodDruhuStavby").Delete
   On Error GoTo 0
   Set PridatKodDruhuStavby = CommandBars("Cell")
   PridatKodDruhuStavby.Controls(1).BeginGroup = False
   Set PridatKodDruhuStavby_Control = PridatKodDruhuStavby.Controls.Add(Type:=msoControlButton, before:=1, Temporary:=True)
   With PridatKodDruhuStavby_Control
      .Caption = "Sp|fffd|sob vyu|fffd||fffd|vania"
      .Tag = "PridatKodDruhuStavby"
      .OnAction = "Vyuzivanie"
   End With
''*************************************************
Else
   On Error Resume Next
   CommandBars("Cell").FindControl(Tag:="PridatSposovVyuzivania").Delete
   CommandBars("Cell").FindControl(Tag:="PridatKodDruhuStavby").Delete
   On Error GoTo 0
End If
End If


End Sub
Sub DeAktivaciaMenu()
   
On Error Resume Next
CommandBars("Cell").FindControl(Tag:="PopUp_Hlavne1").Delete
CommandBars("Cell").FindControl(Tag:="FormatBunky_hlavne").Delete
CommandBars("Cell").FindControl(Tag:="Zmena_formatu5").Delete
CommandBars("Cell").FindControl(Tag:="Zmena_formatu4").Delete
CommandBars("Cell").FindControl(Tag:="Zmena_formatu3").Delete
CommandBars("Cell").FindControl(Tag:="Zmena_formatu2").Delete
CommandBars("Cell").FindControl(Tag:="Zmena_formatu1").Delete
CommandBars("Cell").FindControl(Tag:="KopiaListu").Delete
CommandBars("Cell").FindControl(Tag:="VlozitRiadok").Delete
CommandBars("Cell").FindControl(Tag:="Vlozit_Vlastnikov").Delete
CommandBars("Cell").FindControl(Tag:="PridatPoznamku").Delete
CommandBars("Cell").FindControl(Tag:="PridatPozemok").Delete
CommandBars("Cell").FindControl(Tag:="PridatSposovVyuzivania").Delete
CommandBars("Cell").FindControl(Tag:="PridatKodDruhuStavby").Delete
CommandBars("Cell").FindControl(Tag:="Siahy").Delete
CommandBars("Cell").FindControl(Tag:="Odpocet").Delete
CommandBars("Cell").FindControl(Tag:="VGI").Delete
CommandBars("Cell").FindControl(Tag:="FPU").Delete
On Error GoTo 0
   
''    On Error Resume Next
''    Application.CommandBars("Worksheet Menu Bar").Controls(APPNAME).Delete

End Sub

Sub nacitat_z_vv()
    frmVlastnici.lblZz.Caption = ActiveSheet.Name
    Cells(19, 4).Select
    frmVlastnici.Show
End Sub


Attribute VB_Name = "mdl_Nastavenia"
'Sub firmy()
Sub firmy()
Dim i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - firmy"

 .frmText1.Caption = "n|fffd|zov:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = "druh|fffd| riadok(nepovinn|fffd|):"
 .frmText2.Font.Bold = False
 .frmText3.Caption = "ulica:"
 .frmText3.Font.Bold = True
 .frmText4.Caption = "|fffd||fffd|slo:"
 .frmText4.Font.Bold = True
 .frmText5.Caption = "mesto:"
 .frmText5.Font.Bold = True
 .frmText6.Caption = "ps|fffd|:"
 .frmText6.Font.Bold = True
 .frmText7.Caption = "i|fffd|o:"
 .frmText7.Font.Bold = True
 .frmText8.Caption = "di|fffd|:"
 .frmText8.Font.Bold = False
 .frmText9.Caption = "telef|fffd|n:"
 .frmText9.Font.Bold = False
 .frmText10.Caption = "email:"
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = True
 .frmText3.Visible = True
 .frmText4.Visible = True
 .frmText5.Visible = True
 .frmText6.Visible = True
 .frmText7.Visible = True
 .frmText8.Visible = True
 .frmText9.Visible = True
 .frmText10.Visible = True
 
 .TextBox1.Visible = True
 .TextBox2.Visible = True
 .TextBox3.Visible = True
 .TextBox4.Visible = True
 .TextBox5.Visible = True
 .TextBox6.Visible = True
 .TextBox7.Visible = True
 .TextBox8.Visible = True
 .TextBox9.Visible = True
 .TextBox10.Visible = True

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 1) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 1)
  End If
 Loop

 If .OptB_firma.Value = False Then
  .OptB_firma.Value = True
  .Show
 End If

End With
End Sub


Sub pristroje()
Dim i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - pr|fffd|stroje"

 .frmText1.Caption = "pr|fffd|stroj:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = ""
 .frmText2.Font.Bold = False
 .frmText3.Caption = ""
 .frmText3.Font.Bold = False
 .frmText4.Caption = ""
 .frmText4.Font.Bold = False
 .frmText5.Caption = ""
 .frmText5.Font.Bold = False
 .frmText6.Caption = ""
 .frmText6.Font.Bold = False
 .frmText7.Caption = ""
 .frmText7.Font.Bold = False
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = False
 .frmText3.Visible = False
 .frmText4.Visible = False
 .frmText5.Visible = False
 .frmText6.Visible = False
 .frmText7.Visible = False
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = False
 .TextBox3.Visible = False
 .TextBox4.Visible = False
 .TextBox5.Visible = False
 .TextBox6.Visible = False
 .TextBox7.Visible = False
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 25) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 25)
  End If
 Loop

 If .OptB_pristroje.Value = False Then
  .OptB_pristroje.Value = True
  .Show
 End If
 
End With
End Sub

'Sub hranice()
Sub hranice()
Dim i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - ozna|fffd|enie hran|fffd|c"

 .frmText1.Caption = "ozna|fffd|enie hran|fffd|c:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = ""
 .frmText2.Font.Bold = False
 .frmText3.Caption = ""
 .frmText3.Font.Bold = False
 .frmText4.Caption = ""
 .frmText4.Font.Bold = False
 .frmText5.Caption = ""
 .frmText5.Font.Bold = False
 .frmText6.Caption = ""
 .frmText6.Font.Bold = False
 .frmText7.Caption = ""
 .frmText7.Font.Bold = False
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = False
 .frmText3.Visible = False
 .frmText4.Visible = False
 .frmText5.Visible = False
 .frmText6.Visible = False
 .frmText7.Visible = False
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = False
 .TextBox3.Visible = False
 .TextBox4.Visible = False
 .TextBox5.Visible = False
 .TextBox6.Visible = False
 .TextBox7.Visible = False
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 27) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 27)
  End If
 Loop

 If .OptB_hranice.Value = False Then
  .OptB_hranice.Value = True
  .Show
 End If


End With
End Sub

'Sub meral()

Sub meral()
Dim i As Integer


With frm_Nastavenia

 .Caption = "Nastavenia - meral"

 .frmText1.Caption = "meno:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = ""
 .frmText2.Font.Bold = False
 .frmText3.Caption = ""
 .frmText3.Font.Bold = False
 .frmText4.Caption = ""
 .frmText4.Font.Bold = False
 .frmText5.Caption = ""
 .frmText5.Font.Bold = False
 .frmText6.Caption = ""
 .frmText6.Font.Bold = False
 .frmText7.Caption = ""
 .frmText7.Font.Bold = False
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = False
 .frmText3.Visible = False
 .frmText4.Visible = False
 .frmText5.Visible = False
 .frmText6.Visible = False
 .frmText7.Visible = False
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = False
 .TextBox3.Visible = False
 .TextBox4.Visible = False
 .TextBox5.Visible = False
 .TextBox6.Visible = False
 .TextBox7.Visible = False
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 20) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 20)
  End If
 Loop
 
If .OptB_meral.Value = False Then
 .OptB_meral.Value = True
 .Show
End If

End With
End Sub

'Sub vyhotovitel()

Sub vyhotovil()
Dim i As Integer
Dim index_i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - vyhotovil"

 .frmText1.Caption = "meno:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = "email:"
 .frmText2.Font.Bold = False
 .frmText3.Caption = ""
 .frmText3.Font.Bold = False
 .frmText4.Caption = ""
 .frmText4.Font.Bold = False
 .frmText5.Caption = ""
 .frmText5.Font.Bold = False
 .frmText6.Caption = ""
 .frmText6.Font.Bold = False
 .frmText7.Caption = ""
 .frmText7.Font.Bold = False
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = True
 .frmText3.Visible = False
 .frmText4.Visible = False
 .frmText5.Visible = False
 .frmText6.Visible = False
 .frmText7.Visible = False
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = True
 .TextBox3.Visible = False
 .TextBox4.Visible = False
 .TextBox5.Visible = False
 .TextBox6.Visible = False
 .TextBox7.Visible = False
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear
    
 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 22) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 22)
  End If
 Loop
 
 If .OptB_vyhotovil.Value = False Then
  .OptB_vyhotovil.Value = True
  .Show
 End If

End With
End Sub

'Sub Overovatelia()
Sub overovatelia()
Dim i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - autoriza|fffd|n|fffd| overovatelia"
 
 .frmText1.Caption = "i|fffd|o:"
 .frmText1.Font.Bold = False
 .frmText2.Caption = "meno:"
 .frmText2.Font.Bold = True
 .frmText3.Caption = "priezvisko:"
 .frmText3.Font.Bold = True
 .frmText4.Caption = "titul pred:"
 .frmText4.Font.Bold = False
 .frmText5.Caption = "titul za:"
 .frmText5.Font.Bold = False
 .frmText6.Caption = "|fffd||fffd|slo opr|fffd|vnenia:"
 .frmText6.Font.Bold = True
 .frmText7.Caption = "zobrazova|fffd|:"
 .frmText7.Font.Bold = True
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = True
 .frmText3.Visible = True
 .frmText4.Visible = True
 .frmText5.Visible = True
 .frmText6.Visible = True
 .frmText7.Visible = True
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = True
 .TextBox3.Visible = True
 .TextBox4.Visible = True
 .TextBox5.Visible = True
 .TextBox6.Visible = True
 .TextBox7.Visible = True
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 18) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 18)
  End If
 Loop

 If .OptB_autorizacne.Value = False Then
  .OptB_autorizacne.Value = True
  .Show
 End If
End With

End Sub

'Sub pozemky()
Sub pozemky()
Dim i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - druhy pozemkov"

 .frmText1.Caption = "n|fffd|zov:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = "skratka:"
 .frmText2.Font.Bold = True
 .frmText3.Caption = "|fffd||fffd|slo:"
 .frmText3.Font.Bold = True
 .frmText4.Caption = ""
 .frmText4.Font.Bold = False
 .frmText5.Caption = ""
 .frmText5.Font.Bold = False
 .frmText6.Caption = ""
 .frmText6.Font.Bold = False
 .frmText7.Caption = ""
 .frmText7.Font.Bold = False
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = True
 .frmText3.Visible = True
 .frmText4.Visible = False
 .frmText5.Visible = False
 .frmText6.Visible = False
 .frmText7.Visible = False
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = True
 .TextBox3.Visible = True
 .TextBox4.Visible = False
 .TextBox5.Visible = False
 .TextBox6.Visible = False
 .TextBox7.Visible = False
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 32) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 32)
  End If
 Loop
 
 If .OptB_pozemky.Value = False Then
  .OptB_pozemky.Value = True
  .Show
 End If
End With

End Sub

'Sub pozemkyPK()
Sub pozemkyPK()
Dim i As Integer

With frm_Nastavenia

 .Caption = "Nastavenia - druhy pozemkov"

 .frmText1.Caption = "n|fffd|zov:"
 .frmText1.Font.Bold = True
 .frmText2.Caption = "skratka:"
 .frmText2.Font.Bold = True
 .frmText3.Caption = "|fffd||fffd|slo:"
 .frmText3.Font.Bold = True
 .frmText4.Caption = ""
 .frmText4.Font.Bold = False
 .frmText5.Caption = ""
 .frmText5.Font.Bold = False
 .frmText6.Caption = ""
 .frmText6.Font.Bold = False
 .frmText7.Caption = ""
 .frmText7.Font.Bold = False
 .frmText8.Caption = ""
 .frmText8.Font.Bold = False
 .frmText9.Caption = ""
 .frmText9.Font.Bold = False
 .frmText10.Caption = ""
 .frmText10.Font.Bold = False

 .ListBox.Clear
 .TextBox1.Text = ""
 .TextBox2.Text = ""
 .TextBox3.Text = ""
 .TextBox4.Text = ""
 .TextBox5.Text = ""
 .TextBox6.Text = ""
 .TextBox7.Text = ""
 .TextBox8.Text = ""
 .TextBox9.Text = ""
 .TextBox10.Text = ""
 
 .frmText1.Visible = True
 .frmText2.Visible = True
 .frmText3.Visible = True
 .frmText4.Visible = False
 .frmText5.Visible = False
 .frmText6.Visible = False
 .frmText7.Visible = False
 .frmText8.Visible = False
 .frmText9.Visible = False
 .frmText10.Visible = False
 
 .TextBox1.Visible = True
 .TextBox2.Visible = True
 .TextBox3.Visible = True
 .TextBox4.Visible = False
 .TextBox5.Visible = False
 .TextBox6.Visible = False
 .TextBox7.Visible = False
 .TextBox8.Visible = False
 .TextBox9.Visible = False
 .TextBox10.Visible = False

 .ListBox.Clear

 i = 12
 Do
  i = i + 1
  If Sheets("Nastavenia").Cells(i, 35) = "" Then
   Exit Do
  Else
  .ListBox.AddItem Sheets("Nastavenia").Cells(i, 35)
  End If
 Loop
 
 If .OptB_pozemky.Value = False Then
  .OptB_pozemky.Value = True
  .Show
 End If
End With

End Sub


'Sub pozemkyPK pre Menu()
Sub pozemkyPKmenu()
Dim i As Integer

With frm_Nastavenia
 
 If .OptB_pozemky.Value = False Then
  .OptB_pozemky.Value = True
  .cmbPK.BackColor = &HFFFF00
  .cmbLV.BackColor = &HC0C0C0
  .lblPomLV_PK.Caption = "PK"
  pozemkyPK
  .Show
 End If
End With

End Sub

Attribute VB_Name = "mdl_Nazvy_stlpcov"
Sub Nazvy_stlpcov(nazov_listu As String)
Dim i As Integer
Dim PKV As Integer
Dim LV As Integer
Dim PK_d As Integer
Dim KNE_d As Integer
Dim KNC_d As Integer
Dim ha_d As Integer
Dim m2_d As Integer
Dim DP_d As Integer
Dim diel As Integer
Dim k_pc As Integer
Dim k_pc_m2 As Integer
Dim od_pc As Integer
Dim od_pc_m2 As Integer
Dim pc_n As Integer
Dim ha_n As Integer
Dim m2_n As Integer
Dim dp_n As Integer
Dim Vlastnik As Integer
Dim SupisneCislo As Integer
Dim StavbaOd As Integer
Dim PovodneSC As Integer
Dim PovodnySV As Integer
Dim PovodneKatuz As Integer
Dim Doterajsi_stav_OD As Integer
Dim Doterajsi_stav_DO As Integer
Dim Zmeny_OD As Integer
Dim Zmeny_DO As Integer
Dim Novy_stav_OD As Integer
Dim Novy_stav_DO As Integer
Dim Stlpec_kodov As Integer
Dim Stlpec_PKU As Integer

  Sheets("exp_imp").Cells(17, 2) = ""
  Sheets("exp_imp").Cells(18, 2) = ""
  Sheets("exp_imp").Cells(19, 2) = ""
  Sheets("exp_imp").Cells(20, 2) = ""
  Sheets("exp_imp").Cells(21, 2) = ""
  Sheets("exp_imp").Cells(22, 2) = ""
  Sheets("exp_imp").Cells(23, 2) = ""
  Sheets("exp_imp").Cells(24, 2) = ""
  Sheets("exp_imp").Cells(25, 2) = ""
  Sheets("exp_imp").Cells(26, 2) = ""
  Sheets("exp_imp").Cells(27, 2) = ""
  Sheets("exp_imp").Cells(28, 2) = ""
  Sheets("exp_imp").Cells(29, 2) = ""
  Sheets("exp_imp").Cells(30, 2) = ""
  Sheets("exp_imp").Cells(31, 2) = ""
  Sheets("exp_imp").Cells(32, 2) = ""
  Sheets("exp_imp").Cells(33, 2) = ""
  Sheets("exp_imp").Cells(34, 2) = ""
  Sheets("exp_imp").Cells(35, 2) = ""
  Sheets("exp_imp").Cells(36, 2) = ""
  Sheets("exp_imp").Cells(37, 2) = ""
  Sheets("exp_imp").Cells(38, 2) = ""
  Sheets("exp_imp").Cells(39, 2) = ""
  Sheets("exp_imp").Cells(40, 2) = ""
  Sheets("exp_imp").Cells(41, 2) = ""
  Sheets("exp_imp").Cells(42, 2) = ""
  Sheets("exp_imp").Cells(43, 2) = ""
  Sheets("exp_imp").Cells(44, 2) = ""
  Sheets("exp_imp").Cells(45, 2) = ""
  Sheets("exp_imp").Cells(46, 2) = ""
  Sheets("exp_imp").Cells(47, 2) = ""
  

With Sheets(nazov_listu)
i = 0
  Do
    i = i + 1
    On Error Resume Next
    If .Cells(1, i) = Sheets("Vv_vzor").Cells(1, 20) Then
        If .Cells(1, i) = Sheets("Vv_vzor").Cells(1, 20) Then PovodnySV = i
        If .Cells(1, i + 1).Text = Sheets("Vv_vzor").Cells(1, 21) Then PovodneKatuz = i + 1
        Exit Do
    Else
        If .Cells(4, i) = Sheets("Vv_vzor").Cells(4, 1) Or .Cells(4, i) = Sheets("Vv_vzor").Cells(7, 1) Then PKV = i
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 1) Then LV = i
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 2) Then PK_d = i
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(7, 2) Then KNE_d = i
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 3) Or .Cells(5, i) = Sheets("Vv_vzor").Cells(7, 3) Then KNC_d = i
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 5) And m2_d = 0 Then m2_d = i
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 6) And DP_d = 0 Then DP_d = i
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 7) Then diel = i
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 8) Then k_pc = i
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 10) Then od_pc = i
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 9) And m2_d <> 0 Then
            If k_pc_m2 = 0 Then
                k_pc_m2 = i
            Else
                If od_pc_m2 = 0 Then od_pc_m2 = i
            End If
        End If
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 12) Then pc_n = i
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 4) Then
           If ha_d = 0 Then
            ha_d = i
           Else
            If ha_n = 0 Then ha_n = i
           End If
        End If
        
        
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 14) And m2_d <> 0 And k_pc_m2 <> 0 And od_pc_m2 <> 0 And m2_n = 0 Then m2_n = i
        'If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 15) And DP_d <> 0 And dp_n = 0 Then dp_n = i                                                      24.4.2019
        If .Cells(5, i) = Sheets("Vv_vzor").Cells(5, 15) Then
         Stlpec_kodov = i
         dp_n = i
        End If
        If .Cells(3, i) = Sheets("Vv_vzor").Cells(3, 16) Then Vlastnik = i
        If .Cells(1, i) = Sheets("Vv_vzor").Cells(1, 17) Then SupisneCislo = i
        If .Cells(1, i) = Sheets("Vv_vzor").Cells(1, 18) Then StavbaOd = i
        If .Cells(1, i) = Sheets("Vv_vzor").Cells(1, 19) Then PovodneSC = i
        If .Cells(2, i) = Sheets("Vv_vzor").Cells(2, 1) Then Doterajsi_stav_OD = i
        If .Cells(2, i) = Sheets("Vv_vzor").Cells(2, 7) Then
            Doterajsi_stav_DO = i - 1
            Zmeny_OD = i
        End If
        If .Cells(2, i) = Sheets("Vv_vzor").Cells(2, 12) Then
            Zmeny_DO = i - 1
            Novy_stav_OD = i
        End If
        If .Cells(1, i) = Sheets("Vv_vzor").Cells(1, 17) Then Novy_stav_DO = i - 1
        
    End If
  Loop
End With
        
With Sheets("exp_imp")
i = 17
  Do
    i = i + 1
    If .Cells(i, 1) = "" Then
        Exit Do
    Else
        .Cells(i, 2) = ""
    End If
  Loop
  
  .Cells(17, 2) = nazov_listu
  .Cells(18, 2) = PKV
  .Cells(19, 2) = LV
  .Cells(20, 2) = PK_d
  .Cells(21, 2) = KNE_d
  .Cells(22, 2) = KNC_d
  .Cells(23, 2) = ha_d
  .Cells(24, 2) = m2_d
  .Cells(25, 2) = DP_d
  .Cells(26, 2) = diel
  .Cells(27, 2) = k_pc
  .Cells(28, 2) = k_pc_m2
  .Cells(29, 2) = od_pc
  .Cells(30, 2) = od_pc_m2
  .Cells(31, 2) = pc_n
  .Cells(32, 2) = ha_n
  .Cells(33, 2) = m2_n
  .Cells(34, 2) = dp_n
  .Cells(35, 2) = Vlastnik
  .Cells(36, 2) = SupisneCislo
  .Cells(37, 2) = StavbaOd
  .Cells(38, 2) = PovodneSC
  .Cells(39, 2) = PovodnySV
  .Cells(40, 2) = Doterajsi_stav_OD
  .Cells(41, 2) = Doterajsi_stav_DO
  .Cells(42, 2) = Zmeny_OD
  .Cells(43, 2) = Zmeny_DO
  .Cells(44, 2) = Novy_stav_OD
  .Cells(45, 2) = Novy_stav_DO
  .Cells(46, 2) = Stlpec_kodov
  .Cells(47, 2) = PovodneKatuz
Sheets("exp_imp").Cells(19, 4) = Application.ActiveSheet.Cells.SpecialCells(xlLastCell).Row
End With

End Sub
Attribute VB_Name = "mdl_Odpocet"
Sub odpocet_HM()
odpocet_siahy odkial:="HM_odpocet", co:="odpocet"
    
With frmVymera
 .Caption = "Ur|fffd|enie zbytkovej v|fffd|mery pri odpo|fffd|te"
 .lblVstup.Caption = "Vstupn|fffd| v|fffd|mera:"
 .lblVystup.Caption = "vystupn|fffd| v|fffd|mera:"
 .lblHa.Caption = "ha"
 .lblM2.Caption = "m2"
 .cmbOpravitVoVv.Visible = False
 .Height = 95
End With
End Sub

Sub siahy_HM()
odpocet_siahy odkial:="HM_siahy", co:="siahy"
    
With frmVymera
 .Caption = "Prevod  Jutro / siaha   na   ha / m2"
 .lblVstup.Caption = "Jutro / siaha:"
 .lblVystup.Caption = "ha / m2"
 .lblHa.Caption = ""
 .lblM2.Caption = ""
 .cmbOpravitVoVv.Visible = True
 .Height = 120
End With
End Sub

Sub odpocet_siahy(odkial As String, co As String) 'HM - hlavne menu

Dim stlpec_D_ha As Integer
Dim stlpec_N_ha As Integer
Dim stlpec_D_m2 As Integer
Dim stlpec_N_m2 As Integer
Dim i As Integer
Dim j As Integer
Dim VstupnaHA As Double
Dim VstupnaM2 As Double
Dim vystupna As Double

With frmVymera
 If co = "Vv" Then
  If frmVymera.Caption = "Prevod  Jutro / siaha   na   ha / m2" Then co = "siahy" Else co = "odpocet"
 Else
  .Show
  .Top = 10
  .Left = 10
 End If
     
 stlpec_D_ha = Sheets("exp_imp").Cells(23, 2)
 stlpec_D_m2 = Sheets("exp_imp").Cells(24, 2)
 stlpec_N_ha = Sheets("exp_imp").Cells(32, 2)
 stlpec_N_m2 = Sheets("exp_imp").Cells(33, 2)
 
 If odkial = "HM_odpocet" Or odkial = "HM_siahy" Then
  .vstupHa.Text = ""
  .vstupM2.Text = ""
  .vystupHa.Text = ""
  .vystupM2.Text = ""

  If ActiveCell.Column = stlpec_D_ha Or ActiveCell.Column = stlpec_D_m2 Then
   .vstupHa.Text = Cells(ActiveCell.Row, stlpec_D_ha)
   .vstupM2.Text = Cells(ActiveCell.Row, stlpec_D_m2)
   .lbRiadokM2.Caption = ActiveCell.Row
   .lbStlpecM2.Caption = ActiveCell.Column
   .cmbOpravitVoVv.Caption = "Upravi|fffd| vo V|fffd|kaze V|fffd|mer (" & Cells(ActiveCell.Row, ActiveCell.Column).Address & ")"
  End If
 End If
    
 If .vstupHa.Text <> "" Then
  On Error GoTo Chyba_Vstup
  VstupnaHA = .vstupHa.Text
  If .vstupM2.Text = "" Then VstupnaM2 = 0 Else VstupnaM2 = .vstupM2.Text
 Else
  If .vstupM2.Text <> "" Then
   VstupnaHA = 0
   If .vstupM2.Text = "" Then VstupnaM2 = 0 Else VstupnaM2 = .vstupM2.Text
  End If
 End If
        
'SIAHY
 If co = "siahy" Then
 ' (jutro * 1600 + siaha) * 3.5966
  .vystupM2.Text = Round((VstupnaHA * 1600 + VstupnaM2) * 3.59665156225, 0)
  If .vystupM2.Text > 10000 Then
   .vystupHa.Text = Mid(.vystupM2.Text, 1, Len(.vystupM2.Text) - 4)
   .vystupM2.Text = .vystupM2.Text - .vystupHa.Text * 10000
  Else
   .vystupHa.Text = ""
   If .vystupM2.Text = 0 Then .vystupM2.Text = ""
  End If
 End If
    
'ODPOCET
 If co = "odpocet" Then
' do 1 ha   19/20 (95 %)
' nad 1 ha   4/5  (80 %)

  VstupnaHA = VstupnaHA * 10000 + VstupnaM2

  If VstupnaHA <> 0 Then
   If VstupnaHA < 10000 Then
    VstupnaHA = VstupnaHA * 19 / 20
    .vystupM2.Text = Round(VstupnaHA, 1)
   Else
    VstupnaHA = Round(VstupnaHA * 4 / 5, 1)
    VstupnaHA = VstupnaHA / 10000
           
    If Fix(VstupnaHA) <> 0 Then .vystupHa.Text = Fix(VstupnaHA) Else .vystupHa.Text = ""
   
    .vystupM2.Text = (VstupnaHA - Fix(VstupnaHA)) * 10000
   End If
  End If
 End If
 
End With

Exit Sub
Chyba_Vstup: MsgBox "Nespr|fffd|vny form|fffd|t v|fffd|mery", vbOKOnly, "Tabulky_GP"
End Sub


Attribute VB_Name = "mdl_Poznamky"
Sub Poznamky_spustit()
If Sheets("exp_imp").Cells(18, 3) = "nie" Then
    Nazvy_stlpcov (ActiveSheet.Name)
    frm_Poznamky.Show
    frm_Poznamky.Top = 0
    frm_Poznamky.Left = 0
    Sheets("exp_imp").Cells(18, 3) = "ano"
    Sheets("exp_imp").Cells(18, 4) = "ano"
    frm_Poznamky.Height = 225
Else
    Sheets("exp_imp").Cells(18, 4) = "nie"
    Poznamky
End If
End Sub
Sub Poznamky()                                                              ''Tabulky 2013
With frm_Poznamky
 .lblStav.Caption = ""
 .lblPC.Caption = ""
 .lblDRN.Caption = ""
 .lblOperat.Caption = ""
 .lblLV.Caption = ""
 .lblPKV.Caption = ""
If ActiveCell.Row > 5 Then
 If ActiveCell.Column >= Sheets("exp_imp").Cells(40, 2) And ActiveCell.Column <= Sheets("exp_imp").Cells(41, 2) Then
  .lblStav.Caption = "Doteraj|fffd||fffd| stav"
  If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(20, 2)) <> "" Then
   .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(20, 2))
   .lblDRN.Caption = "5"
   .lblOperat.Caption = "PK"
  End If
  If Sheets("exp_imp").Cells(21, 2) <> 0 Then
   If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(21, 2)) <> "" Then
    .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(21, 2))
    .lblDRN.Caption = "2"
    .lblOperat.Caption = "KN-E"
   End If
  End If
  If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(22, 2)) <> "" Then
   .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(22, 2))
   .lblDRN.Caption = "1"
   .lblOperat.Caption = "KN-C"
  End If
  
  .lblPKV.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(18, 2))
  .lblLV.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(19, 2))
  
  If Sheets("exp_imp").Cells(18, 2) = Sheets("exp_imp").Cells(19, 2) Then
   If .lblOperat.Caption = "PK" Then
    .lblLV.Caption = ""
    .lblPKV.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(18, 2))
   Else
    .lblLV.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(19, 2))
    .lblPKV.Caption = ""
   End If
  End If
 End If

 If ActiveCell.Column >= Sheets("exp_imp").Cells(42, 2) And ActiveCell.Column <= Sheets("exp_imp").Cells(43, 2) Then .lblStav.Caption = "Zmeny"
 
 If ActiveCell.Column >= Sheets("exp_imp").Cells(44, 2) And ActiveCell.Column <= Sheets("exp_imp").Cells(45, 2) Then
  .lblStav.Caption = "Nov|fffd| stav"
    
  If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(31, 2)) <> "" Then
   If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(20, 2)) <> "" Then
    .lblDRN.Caption = "5"
    .lblOperat.Caption = "PK"
    .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(20, 2))
   End If
   If Sheets("exp_imp").Cells(21, 2) <> 0 Then
    If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(21, 2)) <> "" Then
     .lblDRN.Caption = "2"
     .lblOperat.Caption = "KN-E"
     .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(21, 2))
    End If
   End If
   If Cells(ActiveCell.Row, Sheets("exp_imp").Cells(22, 2)) <> "" Then
    .lblDRN.Caption = "1"
    .lblOperat.Caption = "KN-C"
    .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(31, 2))
   End If
   If .lblDRN.Caption = "" Then
    .lblDRN.Caption = "1"
    .lblOperat.Caption = "KN-C"
    .lblPC.Caption = Cells(ActiveCell.Row, Sheets("exp_imp").Cells(31, 2))
   End If
  End If
  
  .lblLV.Caption = ""
  .lblPKV.Caption = ""
 End If
    
 If .lblPC.Caption <> "" Then .cp_prazdne.Caption = "1" Else .cp_prazdne.Caption = "0"
 If .lblLV.Caption <> "" And .lblLV.Caption <> "0" Then .cp_prazdne.Caption = .cp_prazdne.Caption & "1" Else .cp_prazdne.Caption = .cp_prazdne.Caption & "0"
 If .lblPKV.Caption <> "" Then .cp_prazdne.Caption = .cp_prazdne.Caption & "1" Else .cp_prazdne.Caption = .cp_prazdne.Caption & "0"

End If

 NacitaniePredvolenychPoznamok

 If Sheets("exp_imp").Cells(18, 4) = "ano" And frm_Poznamky.lblPC.Caption = "" Then frm_Poznamky.pgPoznamky.Value = 1
 Sheets("exp_imp").Cells(18, 4) = "nie"
        
 .tbPridatPoznamkuPC.Text = ""
 Sheets("poznamky").Cells(2, 10) = Sheets("poznamky").Cells(5, 21)
 .tbPridatPoznamkuPC.Text = Sheets("poznamky").Cells(2, 23)
  
 Aktualizovat_lbPriradenePoznamkyPC
 Aktualizovat_lbPriradenePoznamky
 Aktualizovat_lbPriradenePoznamkyBezPC
 
 If .cbAutomaticky.Value = True Then btnPridatPC_OK
End With
 
End Sub

Sub btnPridatPC_OK()
Dim i As Integer
Dim retazec As String
Dim Poznamka_existuje As Boolean

If frm_Poznamky.lblPC.Caption <> "" And frm_Poznamky.tbPridatPoznamkuPC.Text <> "" Then
 With Sheets("poznamky_XML")
 
  If frm_Poznamky.lblStav.Caption = "Doteraj|fffd||fffd| stav" Then retazec = "PARCELA_DS"
  If frm_Poznamky.lblStav.Caption = "Nov|fffd| stav" Then retazec = "PARCELA_NS"
  If frm_Poznamky.lblStav.Caption = "Zmeny" Then retazec = "ZMENY"
  retazec = retazec & ";" & frm_Poznamky.lblDRN.Caption & ";" & frm_Poznamky.lblPC.Caption & ";" & frm_Poznamky.tbPridatPoznamkuPC.Text
   
  Poznamka_existuje = False
  i = 2
  Do
   i = i + 1
   If .Cells(i, 1) = "" Then
    Exit Do
   Else
    If retazec = .Cells(i, 1) & ";" & .Cells(i, 2) & ";" & .Cells(i, 3) & ";" & .Cells(i, 4) Then
      Poznamka_existuje = True
      Exit Do
    End If
   End If
  Loop
  
  If Poznamka_existuje = False Then
   i = 2
   Do
    i = i + 1
    If .Cells(i, 1) = "" Then
     If frm_Poznamky.lblStav.Caption = "Doteraj|fffd||fffd| stav" Then .Cells(i, 1) = "PARCELA_DS"
     If frm_Poznamky.lblStav.Caption = "Nov|fffd| stav" Then .Cells(i, 1) = "PARCELA_NS"
     If frm_Poznamky.lblStav.Caption = "Zmeny" Then .Cells(i, 1) = "ZMENY"
     .Cells(i, 2) = frm_Poznamky.lblDRN.Caption
     .Cells(i, 3) = frm_Poznamky.lblPC.Caption
     .Cells(i, 4) = frm_Poznamky.tbPridatPoznamkuPC.Text
     Exit Do
    End If
   Loop
  End If
 End With
 Aktualizovat_lbPriradenePoznamkyPC
End If

End Sub

Sub btnPridatBezPC_OK()
Dim i As Integer
Dim retazec As String
Dim Poznamka_existuje As Boolean

 With Sheets("poznamky_XML")
                                          
  retazec = "BEZ_PC" & ";" & frm_Poznamky.tbPridatPoznamkuBezPC.Text
   
  Poznamka_existuje = False
  i = 2
  Do
   i = i + 1
   If .Cells(i, 1) = "" Then
    Exit Do
   Else
    If retazec = .Cells(i, 1) & ";" & .Cells(i, 4) Then
     Poznamka_existuje = True
     Exit Do
    End If
   End If
  Loop
  
  If Poznamka_existuje = False Then
   i = 2
   Do
    i = i + 1
    If .Cells(i, 1) = "" Then
     .Cells(i, 1) = "BEZ_PC"
     .Cells(i, 2) = ""
     .Cells(i, 3) = ""
     .Cells(i, 4) = frm_Poznamky.tbPridatPoznamkuBezPC.Text
     Exit Do
    End If
   Loop
  End If
 End With
 Aktualizovat_lbPriradenePoznamkyPC
 Aktualizovat_lbPriradenePoznamkyBezPC

End Sub

Sub NacitaniePredvolenychPoznamok()
Dim i As Integer
      
If frm_Poznamky.lbPredvoleneBezPC.ListCount > 0 Then frm_Poznamky.lbPredvoleneBezPC.Clear
      
If frm_Poznamky.lblPC.Caption <> "" Then
 frm_Poznamky.lbPredvolenePC.Clear
 frm_Poznamky.lbPredvoleneBezPC.Clear
End If

With Sheets("poznamky")
 i = 2
 Do
  i = i + 1
  If .Cells(i, 2) = "" Then
   Exit Do
  Else
   .Cells(2, 10) = .Cells(i, 2)
   .Cells(2, 11).Value = frm_Poznamky.lblPC.Caption
   .Cells(2, 12).Value = frm_Poznamky.lblLV.Caption
   .Cells(2, 13).Value = frm_Poznamky.lblPKV.Caption
  

    If .Cells(2, 14) <> "" Then                                                              ''nacitanie predvolenych BEZ PC
      frm_Poznamky.lbPredvoleneBezPC.AddItem .Cells(i, 1) & "  " & .Cells(2, 14)
    End If
    
   If frm_Poznamky.lblPC.Caption <> "" Then
    If frm_Poznamky.cp_prazdne.Caption = "100" Then
     If .Cells(2, 15).Text <> "" Then
      frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 15).Text
     End If
    End If
   
    If frm_Poznamky.cp_prazdne.Caption = "110" Then
     If .Cells(2, 18).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 18).Text
     If .Cells(2, 15).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 15).Text
    End If

    If frm_Poznamky.cp_prazdne.Caption = "101" Then
     If .Cells(2, 19).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 19).Text
     If .Cells(2, 15).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 15).Text
    End If

    If frm_Poznamky.cp_prazdne.Caption = "111" Then
     If .Cells(2, 21).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 21).Text
     If .Cells(2, 18).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 18).Text
     If .Cells(2, 15).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 15).Text
     If .Cells(2, 19).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 19).Text
    End If

    If frm_Poznamky.cp_prazdne.Caption = "010" Then _
     If .Cells(2, 16).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 16).Text

    If frm_Poznamky.cp_prazdne.Caption = "011" Then
     If .Cells(2, 20).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 20).Text
     If .Cells(2, 16).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 16).Text
    End If

    If frm_Poznamky.cp_prazdne.Caption = "001" Then _
     If .Cells(2, 17).Text <> "" Then _
        frm_Poznamky.lbPredvolenePC.AddItem .Cells(i, 1).Text & "   " & .Cells(2, 17).Text
   End If
  End If
 Loop


End With

End Sub

Sub Aktualizovat_lbPriradenePoznamkyPC()
Dim i As Integer

frm_Poznamky.lbPriradenePoznamkyPC.Clear

If frm_Poznamky.lblPC.Caption <> "" Then
 With Sheets("poznamky_XML")
  i = 2
  Do
   i = i + 1
   If .Cells(i, 1) = "" Then
    Exit Do
   Else
    If .Cells(i, 3) = frm_Poznamky.lblPC.Caption And .Cells(i, 2) = frm_Poznamky.lblDRN.Caption Then
     If frm_Poznamky.lblStav.Caption = "Doteraj|fffd||fffd| stav" And .Cells(i, 1) = "PARCELA_DS" Then _
        frm_Poznamky.lbPriradenePoznamkyPC.AddItem .Cells(i, 4)
     If frm_Poznamky.lblStav.Caption = "Nov|fffd| stav" And .Cells(i, 1) = "PARCELA_NS" Then _
        frm_Poznamky.lbPriradenePoznamkyPC.AddItem .Cells(i, 4)
     If frm_Poznamky.lblStav.Caption = "Zmeny" And .Cells(i, 1) = "ZMENY" Then _
        frm_Poznamky.lbPriradenePoznamkyPC.AddItem .Cells(i, 4)
    End If
   End If
  Loop
 End With
End If
End Sub

Sub Aktualizovat_lbPriradenePoznamkyBezPC()
Dim i As Integer

frm_Poznamky.lbPriradenePoznamkyBezPC.Clear

 With Sheets("poznamky_XML")
  i = 2
  Do
   i = i + 1
   If .Cells(i, 1) = "" Then
    Exit Do
   Else
    If .Cells(i, 1) = "BEZ_PC" Then frm_Poznamky.lbPriradenePoznamkyBezPC.AddItem .Cells(i, 4)
   End If
  Loop
 End With

End Sub

Sub Aktualizovat_lbPriradenePoznamky()
Dim i As Integer
Dim DRN As String

frm_Poznamky.lbPriradenePoznamky.Clear
 
With Sheets("poznamky_XML")
 i = 2
 Do
  i = i + 1
  If .Cells(i, 1) = "" Then
   Exit Do
  Else
   If .Cells(i, 2).Value = "1" Then DRN = "KN-C"
   If .Cells(i, 2).Value = "2" Then DRN = "KN-E"
   If .Cells(i, 2).Value = "3" Then DRN = "PK"
   If .Cells(i, 1).Value = "PARCELA_DS" Then frm_Poznamky.lbPriradenePoznamky.AddItem "Doteraj|fffd||fffd| stav:   " & DRN & " p.|fffd|. " & .Cells(i, 3) & ": " & .Cells(i, 4)
   If .Cells(i, 1).Value = "PARCELA_NS" Then frm_Poznamky.lbPriradenePoznamky.AddItem "Nov|fffd| stav:   " & DRN & " p.|fffd|. " & .Cells(i, 3) & ": " & .Cells(i, 4)
   If .Cells(i, 1).Value = "ZMENY" Then frm_Poznamky.lbPriradenePoznamky.AddItem "Zmeny (diely):   " & DRN & " p.|fffd|. " & .Cells(i, 3) & ": " & .Cells(i, 4)
   If .Cells(i, 1).Value = "BEZ_PC" Then frm_Poznamky.lbPriradenePoznamky.AddItem "Bez priradenia:   " & .Cells(i, 4)
  End If
 Loop
End With
   
End Sub

Sub Vlozit_poznamky(jednu_viac As String, index_vybranej As Integer)

Dim pozicia_Spolu As Integer
Dim pozicia_Rozpiska As Integer
Dim Leg As Integer
Dim LegI As Integer
Dim poz As Integer
Dim i As Integer
Dim j As Integer
Dim nazov_listu As String
Dim pocet_riadkov As Integer
Dim poznamku_od As Integer
Dim bez_rozpisky As Integer
Dim p As Integer
Dim vlozena As String
vlozena = "nie"

nazov_listu = ActiveSheet.Name
pocet_riadkov = pocet_riadkov_List(ActiveSheet.Name)

For i = 1 To pocet_riadkov
  If Cells(i, 1) = "Spolu:" Then pozicia_Spolu = i
Next i

For i = 1 To pocet_riadkov
  If Cells(i, 1) = Sheets("exp_imp").Cells(14, 1).Value Then pozicia_Rozpiska = i
Next i

bez_rozpisky = 0

If pozicia_Rozpiska = 0 Then
   pozicia_Rozpiska = pozicia_Spolu
   bez_rozpisky = 1
End If


For i = 1 To 6
 For j = 1 To 30
  If Cells(i, j) = Sheets("Vv_vzor").Cells(3, 7) Then LegI = j
 Next j
Next i

For p = 3 To Sheets("poznamky_XML").Cells(1, 1)

For i = pozicia_Spolu + 1 To pocet_riadkov

 If pozicia_Rozpiska <> pozicia_Spolu Then _
  If Cells(i, LegI) <> "" And i < pozicia_Rozpiska Then Leg = i
 
 If pozicia_Rozpiska = pozicia_Spolu Then _
  If Cells(i, LegI) <> "" Then Leg = i
Next i


For i = pozicia_Spolu + 1 To pocet_riadkov
    If Cells(i, 1) <> "" And i < pozicia_Rozpiska Then poz = i
    If Cells(i, 1) <> "" And bez_rozpisky = 1 Then poz = i
Next i



If Leg = 0 Then
  If poz = 0 Then poznamku_od = pozicia_Spolu + 2
  If poz <> 0 Then poznamku_od = poz + 1
End If


If Leg > 0 Then
  If poz = 0 Then poznamku_od = Leg + 2
  If poz <> 0 Then
    If poz > Leg Then poznamku_od = poz + 1 Else poznamku_od = Leg + 2
  End If
End If

If poznamku_od >= pozicia_Rozpiska And pozicia_Rozpiska <> pozicia_Spolu Then
 For i = pozicia_Spolu + 1 To pocet_riadkov
  If Cells(i, 1) <> "" Then poz = i
Next i
poznamku_od = poz + 1
End If

If pozicia_Rozpiska = pozicia_Spolu Then pozicia_Rozpiska = poznamku_od

    If jednu_viac = "viac" Then
    
     If Len(Sheets("poznamky_xml").Cells(p, 4).Text) > 130 Then
      Dim PomLen As Double
      If Sheets("exp_imp").Cells(21, 2) <> 0 Then
       Sheets("exp_imp").Cells(56, 1) = Len(Sheets("poznamky_xml").Cells(p, 4).Text) / 212
      Else
       Sheets("exp_imp").Cells(56, 1) = Len(Sheets("poznamky_xml").Cells(p, 4).Text) / 135
      End If
      PomLen = Sheets("exp_imp").Cells(57, 1)
     
      Cells(poznamku_od, 1).RowHeight = PomLen * 14.25
      Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).Merge
      Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).HorizontalAlignment = xlLeft
      Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).VerticalAlignment = xlTop
      Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).WrapText = True
     
     Else
      Cells(poznamku_od, 1).RowHeight = 14.25
     End If
     
     Cells(poznamku_od, 1) = "Pozn|fffd|mka: " & Sheets("poznamky_xml").Cells(p, 4).Text
     Cells(poznamku_od, 1).HorizontalAlignment = xlLeft
     Cells(poznamku_od, 1).VerticalAlignment = xlTop
    
     Cells(poznamku_od, 1).Select
    End If
    
    
    
    If jednu_viac = "jednu" And index_vybranej <> 2 Then
     If vlozena = "nie" Then

      If Len(Sheets("poznamky_xml").Cells(index_vybranej, 4).Text) > 130 Then
       If Sheets("exp_imp").Cells(21, 2) <> 0 Then
        Sheets("exp_imp").Cells(56, 1) = Len(Sheets("poznamky_xml").Cells(index_vybranej, 4).Text) / 212
       Else
        Sheets("exp_imp").Cells(56, 1) = Len(Sheets("poznamky_xml").Cells(index_vybranej, 4).Text) / 135
       End If
       PomLen = Sheets("exp_imp").Cells(57, 1)
     
       Cells(poznamku_od, 1).RowHeight = PomLen * 14.25
       Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).Merge
       Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).HorizontalAlignment = xlLeft
       Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).VerticalAlignment = xlTop
       Range(Cells(poznamku_od, 1), Cells(poznamku_od, Sheets("exp_imp").Cells(36, 2) - 1)).WrapText = True
     
      Else
       Cells(poznamku_od, 1).RowHeight = 14.25
      End If
     
      Cells(poznamku_od, 1) = "Pozn|fffd|mka: " & Sheets("poznamky_xml").Cells(index_vybranej, 4).Text
      Cells(poznamku_od, 1).HorizontalAlignment = xlLeft
      Cells(poznamku_od, 1).VerticalAlignment = xlTop
    
     End If

      vlozena = "ano"
      Cells(poznamku_od, 1).Select
    End If
Next p

    
End Sub

Sub NacitaniePredvolenychPoznamok_uprava()
Dim i As Integer
      
frm_Poznamky.UpravaPredvolenych_all.Clear

If frm_Poznamky.UpravaPredvolenych_all.ListCount > 0 Then frm_Poznamky.UpravaPredvolenych_all.Clear
      
With Sheets("poznamky")
 i = 2
 Do
  i = i + 1
  If .Cells(i, 2) = "" Then
   Exit Do
  Else
   frm_Poznamky.UpravaPredvolenych_all.AddItem .Cells(i, 1) & "  " & .Cells(i, 2)
  End If
 Loop

End With

End Sub

Attribute VB_Name = "mdl_Suma"
Sub Uprava_Sumy()
Dim i As Double
Dim pocet_riadkov As Double
Dim pozicia_spolu_E As Double
Dim pozicia_spolu_C As Double
Dim stlpec_D_ha As Integer
Dim stlpec_D_m2 As Integer
Dim stlpec_N_ha As Integer
Dim stlpec_N_m2 As Integer
Dim pomHA As Double
'If Sheets("Vstup").chbSumyVv.Value = True Then
Dim Otazka As Integer

Otazka = MsgBox("Skuto|fffd|ne upravi|fffd|?   Zru|fffd|ia sa vzorce, odkazy a pod.", vbYesNo + vbQuestion, "TSGP")
If Otazka = vbYes Then
With Sheets("exp_imp")
 stlpec_D_ha = .Cells(23, 2)
 stlpec_D_m2 = .Cells(24, 2)

 stlpec_N_ha = .Cells(32, 2)
 stlpec_N_m2 = .Cells(33, 2)

' i = 1
' Do
' i = i + 1
'  If Cells(i, 1).Borders(xlDiagonalDown).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlDiagonalUp).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlEdgeLeft).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlEdgeTop).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlEdgeBottom).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlEdgeRight).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlInsideVertical).LineStyle = xlNone And _
    Cells(i, 1).Borders(xlInsideHorizontal).LineStyle = xlNone Then
'    pocet_riadkov = i
       
'    Exit Do
'  End If
' Loop
     pocet_riadkov = Sheets("exp_imp").Cells(19, 4)
 i = 1
 Do
  i = i + 1
  If Cells(i, 1) = "Spolu:" Then                                                          '////// Pozicia Spolu - na VV pouzit Pozicia_Spolu
   If pozicia_spolu_E = 0 Then pozicia_spolu_E = i Else pozicia_spolu_C = i
  End If
 
  If i = pocet_riadkov Then Exit Do
 Loop
 
 If pozicia_spolu_C = 0 Then pozicia_spolu_C = pozicia_spolu_E
 
 Dim SumaHA_DS As Double
 Dim SumaM2_DS As Double
 Dim SumaHA_NS As Double
 Dim SumaM2_NS As Double
 Dim Suma_DS As Double
 Dim Suma_NS As Double
 
  SumaHA_DS = 0
  SumaM2_DS = 0
  SumaHA_NS = 0
  SumaM2_NS = 0

 For i = 6 To pocet_riadkov
  If i = pozicia_spolu_C + 1 Then Exit For
  If i <> pozicia_spolu_E And i <> pozicia_spolu_C Then
  
   pomHA = Cells(i, stlpec_D_ha) * 10000 + Cells(i, stlpec_D_m2)
   .Cells(57, 4) = pomHA
   
   If .Cells(57, 5) <> 0 Then Cells(i, stlpec_D_ha) = .Cells(57, 5)
   If .Cells(57, 6) <> 0 Then Cells(i, stlpec_D_m2) = .Cells(57, 6)
   
   pomHA = Cells(i, stlpec_N_ha) * 10000 + Cells(i, stlpec_N_m2)
   .Cells(57, 4) = pomHA
   If .Cells(57, 5) <> 0 Then Cells(i, stlpec_N_ha) = .Cells(57, 5)
   If .Cells(57, 6) <> 0 Then Cells(i, stlpec_N_m2) = .Cells(57, 6)
   
   On Error GoTo ZlyFormat_DS_ha
   SumaHA_DS = SumaHA_DS + Cells(i, stlpec_D_ha)
   On Error GoTo ZlyFormat_DS_m2
   SumaM2_DS = SumaM2_DS + Cells(i, stlpec_D_m2)
   On Error GoTo ZlyFormat_NS_ha
   SumaHA_NS = SumaHA_NS + Cells(i, stlpec_N_ha)
   On Error GoTo ZlyFormat_NS_m2
   SumaM2_NS = SumaM2_NS + Cells(i, stlpec_N_m2)
   Dim pomcislo As Integer
   
   pomcislo = Cells(i, stlpec_D_m2)
   Cells(i, stlpec_D_m2) = ""
   Cells(i, stlpec_D_m2).NumberFormat = "@"
   Cells(i, stlpec_D_m2) = pomcislo
   
   pomcislo = Cells(i, stlpec_N_m2)
   Cells(i, stlpec_N_m2) = ""
   Cells(i, stlpec_N_m2).NumberFormat = "@"
   Cells(i, stlpec_N_m2) = pomcislo
   
   If Cells(i, stlpec_D_ha) <> 0 Then
    Cells(i, stlpec_D_m2).NumberFormat = "0000"
   Else
    Cells(i, stlpec_D_m2).NumberFormat = "General"
   End If
       
   If Cells(i, stlpec_N_ha) <> 0 Then
    If Cells(i, stlpec_N_m2) = 0 Then
     Cells(i, stlpec_N_m2).NumberFormat = "@"
     Cells(i, stlpec_N_m2) = "0000"
    Else
     Cells(i, stlpec_N_m2).NumberFormat = "0000"
    End If
   Else
    Cells(i, stlpec_N_m2).NumberFormat = "General"
   End If

  Else
   Suma_DS = (SumaHA_DS * 10000) + SumaM2_DS
   Suma_NS = (SumaHA_NS * 10000) + SumaM2_NS
   
   .Cells(57, 4) = Suma_DS
   If .Cells(57, 5) <> 0 Then
    Cells(i, stlpec_D_ha) = .Cells(57, 5).Text
    Cells(i, stlpec_D_m2).NumberFormat = "0000"
   Else
    Cells(i, stlpec_D_ha) = ""
    Cells(i, stlpec_D_m2).NumberFormat = "General"
   End If
   If .Cells(57, 6) <> 0 Then
    Cells(i, stlpec_D_m2) = .Cells(57, 6).Text
   Else
    If .Cells(57, 5) <> 0 Then
     Cells(i, stlpec_D_m2).NumberFormat = "@"
     Cells(i, stlpec_D_m2) = "0000"
    Else
     Cells(i, stlpec_D_m2) = ""
    End If
   End If
   
   .Cells(57, 4) = Suma_NS
   If .Cells(57, 5) <> 0 Then
    Cells(i, stlpec_N_ha) = .Cells(57, 5).Text
    Cells(i, stlpec_N_m2).NumberFormat = "0000"
   Else
    Cells(i, stlpec_N_ha) = ""
    Cells(i, stlpec_N_m2).NumberFormat = "General"
   End If
   If .Cells(57, 6).Text <> 0 Then
    Cells(i, stlpec_N_m2) = .Cells(57, 6).Text
   Else
    If .Cells(57, 5) <> 0 Then
     Cells(i, stlpec_N_m2).NumberFormat = "@"
     Cells(i, stlpec_N_m2) = "0000"
    Else
     Cells(i, stlpec_N_m2) = ""
    End If
   End If
''   MsgBox Suma_DS
  '' MsgBox Suma_NS
   
   SumaHA_DS = 0
   SumaM2_DS = 0
   SumaHA_NS = 0
   SumaM2_NS = 0
  End If
  If i = pozicia_Spolu Then Exit For
  If Cells(i, stlpec_D_m2) = 0 And Cells(i, stlpec_D_ha) = 0 Then Cells(i, stlpec_D_m2) = ""
  If Cells(i, stlpec_N_m2) = 0 And Cells(i, stlpec_N_ha) = 0 Then Cells(i, stlpec_N_m2) = ""
 Next i
 
End With
Else
    Exit Sub
End If
'End If

Exit Sub
ZlyFormat_DS_ha:
 MsgBox "V riadku " & i & " je v doteraj|fffd|om stave nespr|fffd|vny form|fffd|t |fffd||fffd|sla, alebo je zadan|fffd| text namiesto |fffd||fffd|sla (ha)."
 Exit Sub
ZlyFormat_DS_m2:
 MsgBox "V riadku " & i & " je v doteraj|fffd|om stave nespr|fffd|vny form|fffd|t |fffd||fffd|sla, alebo je zadan|fffd| text namiesto |fffd||fffd|sla (m2)."
 Exit Sub
ZlyFormat_NS_ha:
 MsgBox "V riadku " & i & " je v novom stave nespr|fffd|vny form|fffd|t |fffd||fffd|sla, alebo je zadan|fffd| text namiesto |fffd||fffd|sla (ha)."
 Exit Sub
ZlyFormat_NS_m2:
 MsgBox "V riadku " & i & " je v novom stave nespr|fffd|vny form|fffd|t |fffd||fffd|sla, alebo je zadan|fffd| text namiesto |fffd||fffd|sla (m2)."
 Exit Sub

End Sub




Attribute VB_Name = "mdl_Uprava_PC"
Function UpravaPC_do_DBF(cele_pc As String) As String      'z 2250/1 urobi 22500010
Dim i As Integer
Dim kmen As String
Dim podlomenie As String
Dim podlomenie2 As String
Dim pouzite As Boolean

    For i = 1 To Len(cele_pc)
        If Mid(cele_pc, i, 1) <> " " Then
            kmen = kmen & Mid(cele_pc, i, 1)
        End If
    Next i

    cele_pc = kmen
    
    kmen = ""
    podlomenie = ""
    pouzite = False
    
    For i = 1 To Len(cele_pc)
        If Mid(cele_pc, i, 1) = "/" Then pouzite = True
    Next i
    
    If pouzite = False Then cele_pc = cele_pc & "/0"
    pouzite = False
    
    For i = 1 To Len(cele_pc)
        If Mid(cele_pc, i, 1) = "/" Then
           pouzite = True
        End If
        If Mid(cele_pc, i, 1) <> "/" Then
            If pouzite = False Then kmen = kmen & Mid(cele_pc, i, 1) Else _
            podlomenie = podlomenie & Mid(cele_pc, i, 1)
        End If
    Next i
    
    
    On Error Resume Next
    UpravaPC_do_DBF = kmen * 10000 + podlomenie * 10
End Function
  
Function UpravaPC_z_DBF(cele_pc As String) As String      'z 22500010 urobi 2250/1  nerobi 2 xp odlomene          644/543  6445430
Dim i As Integer
Dim kmen As String
Dim podlomenie As String

    kmen = ""
    For i = 1 To Len(cele_pc) - 4
        If Mid(cele_pc, i, 1) <> " " Then
            kmen = kmen & Mid(cele_pc, i, 1)
        End If
    Next i
    
    podlomenie = ""
    For i = Len(cele_pc) - 3 To Len(cele_pc) - 1
     If Mid(cele_pc, i, 1) <> " " Then
        If Mid(cele_pc, i, 1) <> 0 Then
            podlomenie = podlomenie & Mid(cele_pc, i, 1)
        End If
        If Mid(cele_pc, i, 1) = 0 And podlomenie <> "" Then
            podlomenie = podlomenie & Mid(cele_pc, i, 1)
        End If
      End If
    Next i
    
    On Error Resume Next
    If podlomenie = "" Then UpravaPC_z_DBF = kmen Else UpravaPC_z_DBF = kmen & "/" & podlomenie
End Function




Attribute VB_Name = "mdl_VGI"
'NEMAM UROBENE, AK SA NACHADZA VIAC TEXTOV RESP. VIAC SYMBOLOV

Dim Kontrolovat_Totozne_Body As Boolean
Dim Vytvarat_95ku As Boolean

Dim OBJ_plus3() As String
Dim pom_n3 As Integer
Dim OBJ_plus4() As String
Dim OBJ_plus5() As String
Dim OBJ_plus6() As String
Dim OBJ_plus95() As String
Dim OBJ_plus2() As String
Dim OBJ_plus9() As String
Dim OBJ_plus7() As String
Dim pom_n9 As Integer

Sub vgi_menu()

XML False
frmVGI.lblVv.Caption = ActiveSheet.Name

End Sub

Sub Import_VGI(odkial As String)
Dim Subor As Variant
Dim SuborN As String
Dim nazov_suboru As Variant
Dim oddelovac As String
Dim i As Integer
    

If odkial = "CKNm" Then _
   Subor = Application.GetOpenFilename(FileFilter:="VGI meran|fffd| (C KN / S-JTSK)  [*.vgi],*.vgi")
If odkial = "CKNt" Then _
   Subor = Application.GetOpenFilename(FileFilter:="VGI transformovan|fffd| (C KN / S-JTSK)  [*.vgi],*.vgi")
If odkial = "EKN" Then _
   Subor = Application.GetOpenFilename(FileFilter:="VGI (E KN)  [*.vgi],*.vgi")
If odkial = "CKNp" Then _
   Subor = Application.GetOpenFilename(FileFilter:="STX z podkladu (C KN p|fffd|vodn|fffd|)  [*.stx],*.stx")
If odkial = "CKNstx" Then _
   Subor = Application.GetOpenFilename(FileFilter:="STX meran|fffd| (C KN meran|fffd|)  [*.stx],*.stx")
If odkial = "Meracka" Then _
   Subor = Application.GetOpenFilename(FileFilter:="s|fffd|bor s mera|fffd|kou,*.*")
If odkial = "CKNstxNove" Then _
   Subor = Application.GetOpenFilename(FileFilter:="STX meran|fffd| (C KN meran|fffd|)  [*.stx],*.stx")
   
If odkial = "CKN03" Then _
   Subor = Application.GetOpenFilename(FileFilter:="VGI (C KN / JTSK03)  [*.vgi],*.vgi")
If odkial = "CKNstx03" Then _
   Subor = Application.GetOpenFilename(FileFilter:="STX meran|fffd| (C KN / JTSK03)  [*.stx],*.stx")
   
If Subor = False Then Exit Sub

oddelovac = "***///***"
If oddelovac = vbNullString Then Exit Sub
    
Debug.Print "Subor: " & Subor, "oddelovac: " & oddelovac
ImportTextFile FName:=CStr(Subor), Sep:=CStr(oddelovac), operat:=CStr(odkial)
   

If Sheets("nacitanieVGI").Cells(2, 1) <> "" Then
 frmVGI.lblCKNm.Caption = Dir(Sheets("nacitanieVGI").Cells(2, 1).Text)
 frmVGI.delCKNm.Visible = True
Else
 frmVGI.lblCKNm.Caption = "nepripojen|fffd|"
 frmVGI.delCKNm.Visible = False
End If
If Sheets("nacitanieVGI").Cells(2, 11) <> "" Then
 frmVGI.lblCKNt.Caption = Dir(Sheets("nacitanieVGI").Cells(2, 11).Text)
 frmVGI.delCKNt.Visible = True
Else
 frmVGI.lblCKNt.Caption = "nepripojen|fffd|"
 frmVGI.delCKNt.Visible = False
End If
If Sheets("nacitanieVGI").Cells(2, 21) <> "" Then
 frmVGI.lblEKN.Caption = Dir(Sheets("nacitanieVGI").Cells(2, 21).Text)
 frmVGI.delEKN.Visible = True
Else
 frmVGI.lblEKN.Caption = "nepripojen|fffd|"
 frmVGI.delEKN.Visible = False
End If
If Sheets("nacitanieVGI").Cells(2, 31) <> "" Then
 frmVGI.lblCKNp.Caption = Dir(Sheets("nacitanieVGI").Cells(2, 31).Text)
 frmVGI.delCKNp.Visible = True
Else
 frmVGI.lblCKNp.Caption = "nepripojen|fffd|"
 frmVGI.delCKNp.Visible = False
End If
If Sheets("nacitanieVGI").Cells(2, 41) <> "" Then
 frmVGI.lblCKNstx.Caption = Dir(Sheets("nacitanieVGI").Cells(2, 41).Text)
' frmVGI.delCKNstx.Visible = True
 frmVGI.delCKNstxNove.Visible = True
Else
 frmVGI.lblCKNstx.Caption = "nepripojen|fffd|"
 frmVGI.delCKNstx.Visible = False
 frmVGI.delCKNstxNove.Visible = False
End If
If Sheets("nacitanieVGI").Cells(2, 51) <> "" Then
 frmVGI.lblMeracka.Caption = Dir(Sheets("nacitanieVGI").Cells(2, 51).Text)
 frmVGI.delMeracka.Visible = True
Else
 frmVGI.lblMeracka.Caption = "nepripojen|fffd|"
 frmVGI.delMeracka.Visible = False
End If

End Sub

Public Sub ImportTextFile(FName As String, Sep As String, operat As String)

Dim RowNdx As Long
    RowNdx = 0
Dim ColNdx As Integer
    ColNdx = 0
Dim TempVal As Variant
    TempVal = 0
Dim WholeLine As String
    WholeLine = ""
Dim Pos As Integer
    Pos = 0
Dim NextPos As Integer
    NextPos = 0
Dim SaveColNdx As Integer
    SaveColNdx = 0
Dim i As Integer
Dim j As Integer
Dim stlpec_i As Integer
    stlpec_i = 0
Dim stlpec_i2 As Integer
    stlpec_i2 = 0
Dim pom As Boolean
    pom = False

Application.ScreenUpdating = False
On Error GoTo EndMacro:

SaveColNdx = 0
RowNdx = 2
i = 2
Open FName For Input Access Read As #1

        
While Not EOF(1)
 Line Input #1, WholeLine
 If Right(WholeLine, 1) <> Sep Then
  WholeLine = WholeLine & Sep
 End If
 ColNdx = SaveColNdx
 Pos = 1
 NextPos = InStr(Pos, WholeLine, Sep)
 While NextPos >= 1
 TempVal = Mid(WholeLine, Pos, NextPos - Pos)
 i = i + 1
  If operat = "CKNm" Then stlpec_i = 1
  If operat = "CKNt" Then stlpec_i = 11
  If operat = "EKN" Then stlpec_i = 21
  If operat = "CKNp" Then stlpec_i = 31
  If operat = "CKNstx" Then stlpec_i = 41
  If operat = "Meracka" Then stlpec_i = 51
  If operat = "CKNstxNove" Then
     stlpec_i = 31
     stlpec_i2 = 41
  End If
 
 If operat = "CKN03" Then stlpec_i = 101
 If operat = "CKNstx03" Then stlpec_i = 21
 
 If pom = False Then Sheets("nacitanieVGI").Columns(stlpec_i).Clear
 
 Sheets("nacitanieVGI").Cells(1, stlpec_i) = i
 If stlpec_i2 <> 0 Then Sheets("nacitanieVGI").Cells(1, stlpec_i2) = i
 
 Sheets("nacitanieVGI").Cells(2, stlpec_i) = FName
 If stlpec_i2 <> 0 Then Sheets("nacitanieVGI").Cells(2, stlpec_i2) = FName
 
 Sheets("nacitanieVGI").Cells(i, stlpec_i) = LTrim(RTrim(TempVal))
 If stlpec_i2 <> 0 Then Sheets("nacitanieVGI").Cells(i, stlpec_i2) = LTrim(RTrim(TempVal))
 
 Pos = NextPos + 1
 ColNdx = ColNdx + 1
 NextPos = InStr(Pos, WholeLine, Sep)
 pom = True

Wend
 RowNdx = RowNdx + 1
Wend

EndMacro:
On Error GoTo 0
Application.ScreenUpdating = True
Close #1

End Sub

Sub SpracovanieVGI(operat_CKN_EKN As String)

Kontrolovat_Totozne_Body = False
Vytvarat_95ku = True                'NEMA VPLYV NA RYCHLOST

Dim indexvgi As Integer
    If operat_CKN_EKN = "CKNm" Then indexvgi = 1
    If operat_CKN_EKN = "CKNt" Then indexvgi = 11
    If operat_CKN_EKN = "EKN" Then indexvgi = 21
    If operat_CKN_EKN = "CKNp" Then indexvgi = 31
    
    If operat_CKN_EKN = "CKN03" Then indexvgi = 101

Dim i As Double
Dim j As Double

Dim pcAtribut As String
Dim pcText As String
Dim symbol As String
Dim operat As String
Dim zaciatokObjektu As Integer
Dim koniecObjektu As Integer


With Sheets("nacitanieVGI")
 .Columns(indexvgi + 3).Clear
 .Columns(indexvgi + 4).Clear
 .Columns(indexvgi + 5).Clear
 .Columns(indexvgi + 6).Clear
 .Columns(indexvgi + 7).Clear
 .Columns(indexvgi + 2).Clear
 .Columns(indexvgi + 1).Clear
 .Cells(1, indexvgi + 1) = "CHYBY"
 .Cells(2, indexvgi + 1) = "3"
 .Columns(indexvgi + 8).Clear
 .Columns(indexvgi + 9).Clear
 .Cells(1, indexvgi + 9) = "CHYBY_Vv_VGI"
 .Cells(2, indexvgi + 9) = "3"
     
 pom_n3 = 1
 pom_n9 = 1
 ReDim OBJ_plus3(.Cells(1, indexvgi))
 ReDim OBJ_plus4(.Cells(1, indexvgi))
 ReDim OBJ_plus5(.Cells(1, indexvgi))
 ReDim OBJ_plus6(.Cells(1, indexvgi))
 ReDim OBJ_plus95(.Cells(1, indexvgi))
 ReDim OBJ_plus2(.Cells(1, indexvgi))
 ReDim OBJ_plus9(.Cells(1, indexvgi))
 ReDim OBJ_plus7(.Cells(1, indexvgi))
     
 For i = 3 To .Cells(1, indexvgi)
  If (vyber_prvku(.Cells(i, indexvgi), 1, " ") = "&O") Then
   
   If vyber_prvku(.Cells(i, indexvgi), 2, " ") = "KLADPAR" And indexvgi = 1 Then operat = "CKNm"
   If vyber_prvku(.Cells(i, indexvgi), 2, " ") = "UOV" Then operat = "EKN"

   pom_n3 = pom_n3 + 1
   OBJ_plus3(pom_n3) = _
                      vyber_prvku(.Cells(i, indexvgi), 2, " ") + " " + _
                      vyber_prvku(.Cells(i, indexvgi), 3, " ") & ";" & i
   If pom_n3 <> 2 Then OBJ_plus3(pom_n3 - 1) = OBJ_plus3(pom_n3 - 1) & ";" & (i - 1)
  End If

  If vyber_prvku(.Cells(i, indexvgi), 1, "K") = "&" Then OBJ_plus3(pom_n3) = OBJ_plus3(pom_n3) & ";" & (i - 1)
 Next i

 ReDim OBJ_plus4(pom_n3)
 
 SpracovanieObjektu indVgi:=indexvgi

 If .Cells(2, indVgi + 1) <> "3" Then
  For i = 3 To .Cells(2, indexvgi + 1) - 1
   frmVGI.lbChyby.AddItem .Cells(i, indexvgi + 1)
  Next i
 End If

 If .Cells(2, indVgi + 9) <> "3" Then
  For i = 3 To .Cells(2, indexvgi + 9) - 1
   frmVGI.lbChybyVvVGI.AddItem .Cells(i, indexvgi + 9)
  Next i
 End If

End With
End Sub

Sub SpracovanieObjektu(indVgi As Integer)
Dim zoznamBodov As String
Dim zoznamBodov_robit As Boolean
    zoznamBodov_robit = False
    If indVgi = 101 Then zoznamBodov_robit = True
Dim pouzite_odpocet As String

Dim ii As Integer
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim pouzity As Boolean
Dim PC_text As String
Dim pouzity_text As Integer
Dim PC_kontrola As String
Dim PC_KK As Integer
Dim PC_atribut As String
Dim PC_atribut_SKUPINA As String
Dim PC_atribut_citatel As String
Dim PC_atribut_menovatel As String
Dim PC_atribut_menovatel_Upraveny As String
Dim PC_atribut_zlomok As String

Dim symbol As String
Dim Pouzity_symbol As Boolean

Dim B As String
Dim C As String
Dim chSur As Boolean

Dim CisloBodu As String
Dim CisloBodu95 As String
Dim je_v_zozname As Boolean
Dim chybne_cislo As Boolean
Dim chybne_suradnice As Boolean

Dim druhy_bod As String
Dim pocet_bod As Integer
Dim bodZaciatok As Integer
Dim bodkoniec As Integer

Dim plocha As Double
Dim plochaSTR As String
Dim Yn1 As Double
Dim Yn2 As Double
Dim Xn As Double

Dim XMLdrn As Integer
Dim nachadza_sa As Boolean
Dim operat As String
Dim plochaVv As String

Dim pocet_symbolov As Integer
pocet_symbolov = 0

With Sheets("nacitanieVGI")
 .Cells(1, indVgi + 4) = 2
 If indVgi = 1 Then
  .Cells(1, 61) = 1
  .Cells(1, 62) = "Zoznam bodov z VGImt"
  .Cells(1, 71) = 1
  .Cells(1, 72) = "Zoznam bodov z VGImt Dane"
  Dim KodKvality As Integer
  Dim KodKvalityBodu  As Integer
  KodKvality = vyber_prvku(.Cells(3, indVgi), -1, " ")
  KodKvalityBodu = KodKvality
 End If

 For i = 2 To pom_n3
  zoznamBodov = ""
  PC_text = ""
  PC_atribut = ""
  PC_atribut_SKUPINA = ""
  PC_atribut_zlomok = ""
  CisloBodu95 = ""
  druhy_bod = ""
  pocet_bod = 0
  Pouzity_symbol = False
  pouzity_text = 0                'pocet textov upravit

  For j = vyber_prvku(OBJ_plus3(i), 2, ";") + 1 To vyber_prvku(OBJ_plus3(i), 3, ";")
   pouzity = False
   If vyber_prvku(.Cells(j, indVgi), 1, " ") = "&T" Then
    pouzity = True
    pouzity_text = True
    PC_text = vyber_prvku(.Cells(j, indVgi), 2, "'")
    
    For k = 4 To 10         'font
     If (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=")) = "F" Then _
        PC_kontrola = (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "="))
    Next k
    If indVgi <> 31 Then
     If (PC_kontrola <> "1") And (indVgi = 1 Or indVgi = 11) Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny font textu C-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Pou|fffd|it|fffd| font:  " & PC_kontrola & " (m|fffd| by|fffd| F=1)" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
     If PC_kontrola <> "2" And indVgi = 21 Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny font textu E-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & Chr(9) & "Pou|fffd|it|fffd| font:  " & PC_kontrola & " (m|fffd| by|fffd| F=2)" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
    End If
            
    For k = 4 To 10         'vyska
     If (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=")) = "H" Then _
            PC_kontrola = (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "="))
    Next k
    If indVgi <> 31 Then
     If (PC_kontrola <> "1.6") And (indVgi = 1 Or indVgi = 11) Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vna v|fffd||fffd|ka textu C-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Pou|fffd|it|fffd| v|fffd||fffd|ka:  " & PC_kontrola & " (m|fffd| by|fffd| H=1.6)" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
     If PC_kontrola <> "1.5" And indVgi = 21 Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vna v|fffd||fffd|ka textu E-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & Chr(9) & "Pou|fffd|it|fffd| v|fffd||fffd|ka:  " & PC_kontrola & " (m|fffd| by|fffd| H=1.5)" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
    End If

    For k = 4 To 10         'def. bod
     If (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=")) = "D" Then _
            PC_kontrola = (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "="))
    Next k
    If indVgi <> 31 Then
     If (PC_kontrola <> "5") And (indVgi = 1 Or indVgi = 11) Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny vz|fffd|a|fffd|n|fffd| bod textu C-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Pou|fffd|it|fffd| vz|fffd|a|fffd|n|fffd| bod:  " & PC_kontrola & " (m|fffd| by|fffd| D=5)" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
     If PC_kontrola <> "1" And indVgi = 21 Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny vz|fffd|a|fffd|n|fffd| bod textu E-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & Chr(9) & "Pou|fffd|it|fffd| vz|fffd|a|fffd|n|fffd| bod:  " & PC_kontrola & " (m|fffd| by|fffd| D=1)" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
    End If

    kk = 0
    For k = 4 To 10         'KK
     If (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=")) = "K" Then
      PC_kontrola = (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "="))
      kk = kk + 1
     End If
    Next k
    If indVgi <> 31 Then
     If kk <> 0 Then
      If (PC_kontrola <> "1") And (indVgi = 1 Or indVgi = 11) Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny kresliaci k|fffd||fffd||fffd| textu C-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Pou|fffd|it|fffd| kresliaci k|fffd||fffd||fffd|:  " & PC_kontrola & " (m|fffd| by|fffd| K=1)" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
      If PC_kontrola <> "1" And indVgi = 21 Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny kresliaci k|fffd||fffd||fffd| textu E-KN parcely" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & Chr(9) & "Pou|fffd|it|fffd| kresliaci k|fffd||fffd||fffd|:  " & PC_kontrola & " (m|fffd| by|fffd| K=1)" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
     Else
      If indVgi = 1 Or indVgi = 11 Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_text C-KN parcely neobsahuje kresliaci k|fffd||fffd||fffd|" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Kresliaci k|fffd||fffd||fffd| m|fffd| by|fffd| K=1" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
      If indVgi = 21 Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_text E-KN parcely neobsahuje kresliaci k|fffd||fffd||fffd|" & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & Chr(9) & "Kresliaci k|fffd||fffd||fffd| m|fffd| by|fffd| K=1" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
     End If
    End If
   End If
    
   If vyber_prvku(.Cells(j, indVgi), 1, " ") = "&A" Then
    pouzity = True
    PC_atribut = vyber_prvku(vyber_prvku(.Cells(j, indVgi), 2, " "), 2, "=")
    PC_atribut_SKUPINA = vyber_prvku(vyber_prvku(.Cells(j, indVgi), 2, " "), 1, "=")
   End If
   PC_atribut_citatel = vyber_prvku(PC_atribut, 1, ".")
   PC_atribut_menovatel = vyber_prvku(PC_atribut, 2, ".")
    
   PC_atribut_menovatel_Upraveny = ""
   For k = 1 To Len(PC_atribut_menovatel)
    If Mid(PC_atribut_menovatel, k, 1) = "0" And PC_atribut_menovatel_Upraveny = "" Then
     PC_atribut_menovatel_Upraveny = ""
    Else
     PC_atribut_menovatel_Upraveny = PC_atribut_menovatel_Upraveny & Mid(PC_atribut_menovatel, k, 1)
    End If
   Next k

   PC_atribut_menovatel = PC_atribut_menovatel_Upraveny

   If PC_atribut_menovatel = "" Then
    PC_atribut_zlomok = PC_atribut_citatel
   Else
    PC_atribut_zlomok = PC_atribut_citatel & "/" & PC_atribut_menovatel
   End If
    
   pouzite_odpocet = "nie"
   For ii = 2 To Sheets("XML").Cells(1, 1)
    If Sheets("XML").Cells(ii, 1) = "PARCELA_NS" Then
     If PC_atribut_zlomok = Sheets("XML").Cells(ii, 3) And Sheets("XML").Cells(ii, 8) = "odpocet" Then pouzite_odpocet = "ano"
    End If
   Next ii
   If pouzite_odpocet = "ano" Then Vytvarat_95ku = False Else Vytvarat_95ku = True
                    
   For k = 4 To 10
    If indVgi = 1 And vyber_prvku(OBJ_plus3(i), 1, " ") = "HRPAR" Then
     pouzity = False
    Else
     If (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=")) = "S" Then
      pouzity = True
      Pouzity_symbol = True
      If symbol = "-1" Then
       symbol = (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "="))
       pocet_symbolov = 1
      Else
       symbol = symbol & "_" & (vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "="))                   ''doplnenie pre davanie 2 symbolov
       pocet_symbolov = pocet_symbolov + 1
      End If
      If indVgi = 101 And PC_atribut <> "" Then pouzity = True
      If indVgi = 101 And PC_atribut = "" Then pouzity = False
     End If
    End If
   Next k
    
   If vyber_prvku(.Cells(j, indVgi), 1, " ") = "&T" Then pouzity = True
   If Pouzity_symbol = False Then symbol = "-1"
    

'BODY

   If pouzity = False And j <> vyber_prvku(OBJ_plus3(i), 2, ";") Then
    pocet_bod = pocet_bod + 1

    If indVgi = 31 Then Kontrolovat_Totozne_Body = False
 
    If (indVgi = 101 Or vyber_prvku(OBJ_plus3(i), 1, " ") = "ZAPPAR" Or vyber_prvku(OBJ_plus3(i), 1, " ") = "KLADPAR" Or vyber_prvku(OBJ_plus3(i), 1, " ") = "HRPAR") And (Kontrolovat_Totozne_Body = True Or Vytvarat_95ku = True) Then
     C = ""
     chSur = False
     KodKvalityBodu = KodKvality
     For k = 1 To Len(.Cells(j, indVgi))
      If vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=") = "B" Then _
         B = vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "=")
      If vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=") = "C" Then _
         C = vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "=")
      If vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 1, "=") = "T" Then _
         KodKvalityBodu = vyber_prvku(vyber_prvku(.Cells(j, indVgi), k, " "), 2, "=")
     Next k
     If C = "" Then B = ""
     If B = "" And C <> "" Then CisloBodu = "*-" & C
     If B = "" And C = "" Then CisloBodu = "*"
     If B <> "" And C <> "" Then CisloBodu = B & "-" & C

     If indVgi = 31 And CisloBodu <> "*" And B <> "" Then _
     CisloBodu = B * 10000 + C
             
     Dim cislobodu03 As String
     Dim ij As Integer

     cislobodu03 = C
     For ij = 1 To 5
      If Len(cislobodu03) < 4 Then cislobodu03 = "0" & cislobodu03
     Next ij
     If B <> "" Then cislobodu03 = B * 10000 + cislobodu03
             
     Dim VGImer As String
     If indVgi = 101 Then VGImer = "  / JTSK03" Else VGImer = Chr(9)
     
     If indVgi <> 31 And indVgi <> 11 Then
      If C = "" And B = "" Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ Bod bez |fffd||fffd|sla " & VGImer & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Bod bez |fffd||fffd|sla bodu" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "riadok " & j - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
      If B = "" And C <> "" Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ bod bez pred|fffd||fffd|slia " & VGImer & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Bod |fffd|. " & C & " sa nach|fffd|dza bez pred|fffd||fffd|slia" & Chr(9) & Chr(9) & Chr(9) & "riadok " & j - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
      If Len(B) <> 6 And chybne_cislo = False And B <> "" Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ Nespr|fffd|vne pred|fffd||fffd|slie bodu " & VGImer & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Bod |fffd|. " & CisloBodu & " m|fffd| nespr|fffd|vnu d|fffd|ku pred|fffd||fffd|slia" & Chr(9) & Chr(9) & "riadok " & j - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
      If Len(C) > 4 And chybne_cislo = False Then
       .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ Nespr|fffd|vne |fffd||fffd|slo bodu " & Chr(9) & VGImer & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Bod |fffd|. " & CisloBodu & " m|fffd| nespr|fffd|vnu d|fffd|ku |fffd||fffd|sla" & Chr(9) & Chr(9) & "riadok " & j - 2
       .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
      End If
     End If
    End If
 
    CisloBodu = cislobodu03

'/*************************************************************************************************************************
    
    zoznamBodov = vyber_prvku(vyber_prvku(.Cells(j, indVgi), 1, "."), -1, " ") & _
                             "," & vyber_prvku(vyber_prvku(.Cells(j, indVgi), 2, "."), 1, " ") _
                             & " " & _
                             vyber_prvku(vyber_prvku(.Cells(j, indVgi), 2, "."), -1, " ") & _
                             "," & vyber_prvku(vyber_prvku(.Cells(j, indVgi), 3, "."), 1, " ") & " " & CisloBodu & " " & KodKvalityBodu
    
   If pouzite_odpocet = "nie" Then
    Dim CisloBodu_VGPmt As String
    Dim i_VGPmt As Double
    Dim Bod_VGPmt_existuje As Boolean
    Dim Bod_VGPmtD_existuje As Boolean
    Dim ZPMZ As Integer
    Dim ZPMZvgi As Integer
    
    ZPMZ = Sheets("vstup").Cells(10, 4)
    If indVgi = 1 And frmVGI.VGPmt.Value = True Then
     CisloBodu_VGPmt = vyber_prvku(zoznamBodov, 3, " ")
     ZPMZvgi = Mid(CisloBodu_VGPmt, 3, 4)
     If ZPMZvgi = ZPMZ Then
      Bod_VGPmt_existuje = False
      For i_VGPmt = 2 To .Cells(1, 61) + 1
       If CisloBodu_VGPmt = .Cells(i_VGPmt, 61) Then Bod_VGPmt_existuje = True
      Next i_VGPmt
      If Bod_VGPmt_existuje = False Then
       .Cells(.Cells(1, 61) + 1, 61) = vyber_prvku(zoznamBodov, 3, " ")
       .Cells(.Cells(1, 61) + 1, 62) = vyber_prvku(zoznamBodov, 1, " ")
       .Cells(.Cells(1, 61) + 1, 63) = vyber_prvku(zoznamBodov, 2, " ")
       .Cells(.Cells(1, 61) + 1, 64) = vyber_prvku(zoznamBodov, 4, " ")
       .Cells(1, 61) = .Cells(1, 61) + 1
      End If
     Else
      Bod_VGPmtD_existuje = False
      For i_VGPmt = 2 To .Cells(1, 71) + 1
       If CisloBodu_VGPmt = .Cells(i_VGPmt, 71) Then Bod_VGPmtD_existuje = True
      Next i_VGPmt
      If Bod_VGPmtD_existuje = False Then
       .Cells(.Cells(1, 71) + 1, 71) = vyber_prvku(zoznamBodov, 3, " ")
       .Cells(.Cells(1, 71) + 1, 72) = vyber_prvku(zoznamBodov, 1, " ")
       .Cells(.Cells(1, 71) + 1, 73) = vyber_prvku(zoznamBodov, 2, " ")
       .Cells(.Cells(1, 71) + 1, 74) = vyber_prvku(zoznamBodov, 4, " ")
       .Cells(1, 71) = .Cells(1, 71) + 1
      End If
     End If
     
    End If
   End If
    If indVgi = 31 Then _
      zoznamBodov = CisloBodu & " " & vyber_prvku(vyber_prvku(.Cells(j, indVgi), 1, "."), -1, " ") & _
                               "." & vyber_prvku(vyber_prvku(.Cells(j, indVgi), 2, "."), 1, " ") _
                               & " " & _
                             vyber_prvku(vyber_prvku(.Cells(j, indVgi), 2, "."), -1, " ") & _
                             "." & vyber_prvku(vyber_prvku(.Cells(j, indVgi), 3, "."), 1, " ") & " " & CisloBodu
    If pocet_bod = 2 Then druhy_bod = zoznamBodov
    If pocet_bod = 1 Then bodZaciatok = j
    .Cells(j, indVgi + 2) = zoznamBodov
    .Cells(j, indVgi + 8) = KodKvality
    .Cells(j + 1, indVgi + 2) = druhy_bod
    bodkoniec = j + 1

    If Vytvarat_95ku = True And vyber_prvku(OBJ_plus3(i), 1, " ") = "KLADPAR" Then
     If CisloBodu95 = "" Then CisloBodu95 = CisloBodu Else CisloBodu95 = CisloBodu95 & ", " & CisloBodu
    End If

'If Vytvarat_95ku = True Then
    If zoznamBodov_robit = True Then
            'ZOZNAM SURADNIC
     If (indVgi = 101 Or vyber_prvku(OBJ_plus3(i), 1, " ") = "ZAPPAR" Or vyber_prvku(OBJ_plus3(i), 1, " ") = "KLADPAR" Or vyber_prvku(OBJ_plus3(i), 1, " ") = "HRPAR") And Kontrolovat_Totozne_Body = True Then
      je_v_zozname = False
      chybne_cislo = False
      chybne_suradnice = False
      For k = 1 To pom_n9
       If OBJ_plus9(k) = zoznamBodov Then je_v_zozname = True
       If je_v_zozname = False Then
        If vyber_prvku(zoznamBodov, 3, " ") = "*" Then
         chybne_cislo = True
        Else
         If vyber_prvku(OBJ_plus9(k), 3, " ") = vyber_prvku(zoznamBodov, 3, " ") Then
          If vyber_prvku(OBJ_plus9(k), 2, " ") <> vyber_prvku(zoznamBodov, 2, " ") Or vyber_prvku(OBJ_plus9(k), 1, " ") <> vyber_prvku(zoznamBodov, 1, " ") Then
           .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ Toto|fffd|n|fffd| body s r|fffd|znymi s|fffd|radnicami " & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Bod |fffd|. " & vyber_prvku(zoznamBodov, 3, " ") & " sa nach|fffd|dza viackr|fffd|t" & Chr(9) & Chr(9) & "riadok " & j - 2
           .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
          End If
         End If
         If vyber_prvku(OBJ_plus9(k), 2, " ") = vyber_prvku(zoznamBodov, 2, " ") And vyber_prvku(OBJ_plus9(k), 1, " ") = vyber_prvku(zoznamBodov, 1, " ") Then
          .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ Toto|fffd|n|fffd| body s r|fffd|znym |fffd||fffd|slom " & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Bod |fffd|. " & vyber_prvku(zoznamBodov, 3, " ") & " sa nach|fffd|dza s r|fffd|znym |fffd|islom" & Chr(9) & Chr(9) & "riadok " & j - 3
          .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
         End If
        End If
       End If
      Next k

      If je_v_zozname = False Then
       OBJ_plus9(pom_n9 + 1) = zoznamBodov
       pom_n9 = pom_n9 + 1
      End If
     End If
    End If
   End If
'BODY koniec
  Next j
  
  OBJ_plus4(i) = PC_text
  OBJ_plus5(i) = PC_atribut_zlomok
  OBJ_plus6(i) = PC_atribut_SKUPINA
  OBJ_plus2(i) = zoznamBodov
  OBJ_plus2(i + 1) = druhy_bod
  OBJ_plus95(i) = CisloBodu95
  OBJ_plus7(i) = symbol

  If indVgi <> 31 And indVgi <> 101 Then
   If vyber_prvku(OBJ_plus3(i), 1, " ") = "KLADPAR" Or vyber_prvku(OBJ_plus3(i), 1, " ") = "UOV" Then
    plocha = 0
    For j = bodZaciatok + 1 To bodkoniec - 1
     Yn1 = vyber_prvku(.Cells(j - 1, indVgi + 2), 1, " ")
     Yn2 = vyber_prvku(.Cells(j + 1, indVgi + 2), 1, " ")
     Xn = vyber_prvku(.Cells(j, indVgi + 2), 2, " ")
     plocha = plocha + (Xn * (Yn2 - Yn1))
    Next j
    plocha = Abs(plocha / 2)
    .Cells(1, 3) = plocha
    .Cells(1, 3).NumberFormat = "#,##0.00"
    plochaSTR = .Cells(1, 3).Text
    .Cells(53, 1).NumberFormat = "#,##0.00"
    Sheets("exp_imp").Cells(53, 1) = plochaSTR
    .Cells(bodZaciatok, indVgi + 3) = .Cells(1, 3).Text
    .Cells(1, 3) = ""
   Else
    plocha = -1
    plochaSTR = -1
   End If
  End If

  If OBJ_plus6(i) = "" Then OBJ_plus6(i) = "-1"
  If OBJ_plus5(i) = "" Then OBJ_plus5(i) = "-1"
  If OBJ_plus4(i) = "" Then OBJ_plus4(i) = "-1"
  If OBJ_plus95(i) = "" Then OBJ_plus95(i) = "-1"

  If indVgi = 1 Or indVgi = 11 Then    'PREVERIT
   XMLdrn = 1
   operat = "KN-C"
  End If
  If indVgi = 21 Then
   XMLdrn = 2
   operat = "KN-E"
  End If
    
  If indVgi <> 31 And indVgi <> 101 Then
   If vyber_prvku(OBJ_plus3(i), 1, " ") = "KLADPAR" Or vyber_prvku(OBJ_plus3(i), 1, " ") = "UOV" Then
    If pouzity_text = 0 Then
     If indVgi = 1 Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_ch|fffd|ba text C-KN parcely" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Neexistuje text parceln|fffd|ho |fffd||fffd|sla" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
     If indVgi = 21 Then
      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_ch|fffd|ba text E-KN parcely" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & Chr(9) & "Neexistuje text parceln|fffd|ho |fffd||fffd|sla" & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
     End If
    End If

'pouzity_symbol
    If Pouzity_symbol = False And indVgi = 1 Then
     .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_ch|fffd|ba symbol C-KN parcely" & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Neexistuje symbol v objekte" & Chr(9) & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
     .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
    End If

    nachadza_sa = False
    For j = 2 To Sheets("XML").Cells(1, 1)
     If Sheets("XML").Cells(j, 1) = "PARCELA_NS" Then
      If Sheets("XML").Cells(j, 2) = XMLdrn And Sheets("XML").Cells(j, 3) = OBJ_plus5(i) Then
       Sheets("XML").Cells(j, 7) = "POUZITA"
       ''RIESIM SYMBOL
       Dim Dovoleny_symbol As String
       Dim Dovoleny_symbol_Cyklus As String
       Dim Pocet_Dovolenych As Integer
       Dim Pouzity_symbol2 As String
       Dim l As Integer
       If Pouzity_symbol = True Then
        Sheets("XML").Cells(j, 10) = symbol
        Sheets("XML").Cells(1, 11) = "Pocet symbolov"
        Sheets("XML").Cells(j, 11) = pocet_symbolov
        Pocet_Dovolenych = 0
        Dovoleny_symbol_Cyklus = "false"
        For k = 1 To Len(Sheets("XML").Cells(j, 16))
         If vyber_prvku(Sheets("XML").Cells(j, 16), k, ",") <> "" Then Pocet_Dovolenych = Pocet_Dovolenych + 1
        Next k
        For k = 1 To pocet_symbolov
         Pouzity_symbol2 = vyber_prvku(symbol, k, "_")
         Dovoleny_symbol = ""
         
         For l = 1 To Pocet_Dovolenych
          Dovoleny_symbol = vyber_prvku(Sheets("XML").Cells(j, 16), l, ",")
          If Dovoleny_symbol = Pouzity_symbol2 Then Dovoleny_symbol_Cyklus = True
         Next l
         
         If Dovoleny_symbol_Cyklus = "false" And Pouzity_symbol2 <> "489" Then
          If Pocet_Dovolenych = 1 Then _
                      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny symbol C-KN parcely" _
                                                                        & Chr(9) & Chr(9) & Chr(9) & _
                                                                        "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") _
                                                                        & Chr(9) & "Pou|fffd|it|fffd| symbol " & _
                                            Pouzity_symbol2 & ".   Pre dan|fffd| sp|fffd|sob vyu|fffd||fffd|vania je povolen|fffd| symbol " & Sheets("XML").Cells(j, 16) _
                                            & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2 _
                      Else _
                      .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_nespr|fffd|vny symbol C-KN parcely" _
                                                                        & Chr(9) & Chr(9) & Chr(9) & _
                                                                        "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") _
                                                                        & Chr(9) & "Pou|fffd|it|fffd| symbol " & _
                                            Pouzity_symbol2 & ".   Pre dan|fffd| sp|fffd|sob vyu|fffd||fffd|vania s|fffd| povolen|fffd| symboly " & Sheets("XML").Cells(j, 16) _
                                            & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
                                            
                      .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
         End If
        Next k
       End If
      
       plochaVv = Sheets("XML").Cells(j, 6)
       plocha = Sheets("exp_imp").Cells(53, 2)
       If XMLdrn = 1 Or frmVGI.NekontrolovatVymeryEKN.Value = True Then
        If plocha <> plochaVv And indVgi <> 11 Then
         Sheets("exp_imp").Cells(53, 5) = Sheets("exp_imp").Cells(53, 1) - plochaVv
         .Cells(.Cells(2, indVgi + 9), indVgi + 9) = "Parcela |fffd||fffd|slo " & OBJ_plus5(i) & _
                 " (" & operat & ") - rozdiel vo v|fffd|mere:  " & Abs(plocha - plochaVv) & " m2 /" & Sheets("exp_imp").Cells(53, 5).Text & " m2/     (vo VGI: " & plochaSTR & " m2, vo Vv: " & plochaVv & "m2)"
         .Cells(.Cells(2, indVgi + 9), indVgi + 8) = "ch101;" & Sheets("XML").Cells(j, 4)
         .Cells(2, indVgi + 9) = .Cells(2, indVgi + 9) + 1
        End If
       End If
       plochaSTR = plochaSTR & "_" & Sheets("XML").Cells(j, 6)
       nachadza_sa = True
      End If
     End If
    Next j

    If OBJ_plus5(i) = "0" Then nachadza_sa = True
    If nachadza_sa = False Then
     .Cells(.Cells(2, indVgi + 9), indVgi + 9) = "Parcela |fffd||fffd|slo " & OBJ_plus5(i) & " (" & operat & ") sa nach|fffd|dza vo VGI a nenach|fffd|dza vo V|fffd|kaze v|fffd|mer"
     .Cells(2, indVgi + 9) = .Cells(2, indVgi + 9) + 1
    End If
   End If
  End If

  If indVgi <> 31 And indVgi <> 101 Then
   .Cells(.Cells(1, indVgi + 4), indVgi + 4) = OBJ_plus3(i) & "$" & OBJ_plus6(i) & "$" & OBJ_plus5(i) & "$" & OBJ_plus4(i) & "$" & OBJ_plus7(i) & "$" & plochaSTR & "$" & OBJ_plus95(i)
   .Cells(1, indVgi + 4) = .Cells(1, indVgi + 4) + 1
  End If

  If indVgi <> 31 And indVgi <> 101 Then
   If PC_text <> "" And PC_atribut <> "" Then
    If PC_atribut_zlomok <> PC_text Then
     .Cells(.Cells(2, indVgi + 1), indVgi + 1) = "OBJ_Nes|fffd|lad Textu a Atrib|fffd|tu" & Chr(9) & Chr(9) & Chr(9) & "objekt:" & Chr(9) & vyber_prvku(OBJ_plus3(i), 1, ";") & Chr(9) & "Atrib|fffd|t:  " & PC_atribut & "        Text:  " & PC_text & Chr(9) & Chr(9) & Chr(9) & "riadok " & vyber_prvku(OBJ_plus3(i), 2, ";") - 2
     .Cells(2, indVgi + 1) = .Cells(2, indVgi + 1) + 1
    End If
   End If
  End If
 Next i

 For i = 2 To Sheets("XML").Cells(1, 1)
  If Sheets("XML").Cells(i, 1) = "PARCELA_NS" Then
   If Sheets("XML").Cells(i, 6) = "0" And (Sheets("XML").Cells(i, 2) = "2" Or Sheets("XML").Cells(i, 2) = "5") Then _
     Sheets("XML").Cells(i, 7) = "POUZITA"
   If Sheets("XML").Cells(i, 6) = "" And (Sheets("XML").Cells(i, 2) = "2" Or Sheets("XML").Cells(i, 2) = "5") Then _
     Sheets("XML").Cells(i, 7) = "POUZITA"
   If indVgi <> 31 And indVgi <> 101 Then
    If Sheets("XML").Cells(i, 7) <> "POUZITA" And Sheets("XML").Cells(i, 2) = XMLdrn Then
     .Cells(.Cells(2, indVgi + 9), indVgi + 9) = "Parcela |fffd||fffd|slo " & Sheets("XML").Cells(i, 3) & " (" & operat & ") sa nach|fffd|dza vo V|fffd|kaze v|fffd|mer a nenach|fffd|dza vo VGI"
     .Cells(.Cells(2, indVgi + 9), indVgi + 8) = "ch102;" & Sheets("XML").Cells(i, 4)
     .Cells(2, indVgi + 9) = .Cells(2, indVgi + 9) + 1
    End If
   End If
  End If
 Next i

 For i = 2 To pom_n9
  .Cells(i, indVgi + 27) = OBJ_plus9(i)
 Next i
 .Cells(1, indVgi + 27) = pom_n9
End With
End Sub

' nekontroluje spravnost bodov
Sub SpracovanieVGI_03()
indVgi = 101

Dim i As Integer
Dim k As Integer
Dim B As String
Dim C As String
Dim CisloBodu As String
Dim cislobodu03 As String
Dim ij As Integer
Dim zoznamBodov As String

With Sheets("nacitanieVGI")
 For i = 3 To .Cells(1, 101)
  If vyber_prvku(.Cells(i, indVgi), 1, " ") <> "&V" And vyber_prvku(.Cells(i, indVgi), 1, " ") <> "&R" And vyber_prvku(.Cells(i, indVgi), 1, " ") <> "&O" And vyber_prvku(.Cells(i, indVgi), 1, " ") <> "&K" Then
   C = ""
   For k = 1 To Len(.Cells(i, indVgi))
    If vyber_prvku(vyber_prvku(.Cells(i, indVgi), k, " "), 1, "=") = "B" Then _
                B = vyber_prvku(vyber_prvku(.Cells(i, indVgi), k, " "), 2, "=")
    If vyber_prvku(vyber_prvku(.Cells(i, indVgi), k, " "), 1, "=") = "C" Then _
                C = vyber_prvku(vyber_prvku(.Cells(i, indVgi), k, " "), 2, "=")
   Next k
   If C = "" Then B = ""
   If B = "" And C <> "" Then CisloBodu = "*-" & C
   If B = "" And C = "" Then CisloBodu = "*"
   If B <> "" And C <> "" Then CisloBodu = B & "-" & C

   cislobodu03 = C
   For ij = 1 To 5
    If Len(cislobodu03) < 4 Then cislobodu03 = "0" & cislobodu03
   Next ij
   
   On Error Resume Next
   cislobodu03 = B * 10000 + cislobodu03
   CisloBodu = cislobodu03

'/*************************************************************************************************************************
   zoznamBodov = vyber_prvku(vyber_prvku(.Cells(i, indVgi), 1, "."), -1, " ") & _
                             "," & vyber_prvku(vyber_prvku(.Cells(i, indVgi), 2, "."), 1, " ") _
                             & " " & _
                             vyber_prvku(vyber_prvku(.Cells(i, indVgi), 2, "."), -1, " ") & _
                             "," & vyber_prvku(vyber_prvku(.Cells(i, indVgi), 3, "."), 1, " ") & " " & CisloBodu
                             
   
   .Cells(i, indVgi + 2) = vyber_prvku(zoznamBodov, 3, " ")
   .Cells(i, indVgi + 3) = vyber_prvku(zoznamBodov, 1, " ")
   .Cells(i, indVgi + 4) = vyber_prvku(zoznamBodov, 2, " ")
    
   .Columns(103).EntireColumn.AutoFit
   .Columns(104).EntireColumn.AutoFit
   .Columns(105).EntireColumn.AutoFit
  End If
 Next i
End With
End Sub

Sub ChybyVGI()
frmVGI.lbChyby.Clear
frmVGI.lbChybyVvVGI.Clear

With Sheets("NacitanieVGI")
 If .Cells(2, 2) <> 3 And .Cells(2, 2) <> "" Then
  For i = 3 To .Cells(2, 2) - 1
   frmVGI.lbChyby.AddItem .Cells(i, 2)
  Next i
 End If
 If .Cells(2, 10) <> 3 And .Cells(2, 10) <> "" Then
  For i = 3 To .Cells(2, 10) - 1
   frmVGI.lbChybyVvVGI.AddItem .Cells(i, 10)
  Next i
 End If
 If .Cells(2, 12) <> 3 And .Cells(2, 12) <> "" Then
  For i = 3 To .Cells(2, 12) - 1
   frmVGI.lbChyby.AddItem .Cells(i, 12)
  Next i
 End If
 If .Cells(2, 20) <> 3 And .Cells(2, 20) <> "" Then
  For i = 3 To .Cells(2, 20) - 1
   frmVGI.lbChybyVvVGI.AddItem .Cells(i, 20)
  Next i
 End If
 If .Cells(2, 22) <> 3 And .Cells(2, 22) <> "" Then
  For i = 3 To .Cells(2, 22) - 1
   frmVGI.lbChyby.AddItem .Cells(i, 22)
  Next i
 End If
 If .Cells(2, 30) <> 3 And .Cells(2, 30) <> "" Then
  For i = 3 To .Cells(2, 30) - 1
   frmVGI.lbChybyVvVGI.AddItem .Cells(i, 30)
  Next i
 End If
 If .Cells(2, 32) <> 3 And .Cells(2, 32) <> "" Then
  For i = 3 To .Cells(2, 32) - 1
   frmVGI.lbChyby.AddItem .Cells(i, 32)
  Next i
 End If
 
 If .Cells(2, 102) <> 3 And .Cells(2, 102) <> "" Then
  For i = 3 To .Cells(2, 102) - 1
   frmVGI.lbChyby.AddItem .Cells(i, 102)
  Next i
 End If
 If .Cells(2, 210) <> 3 And .Cells(2, 210) <> "" Then
  For i = 3 To .Cells(2, 210) - 1
   frmVGI.lbChybyVvVGI.AddItem .Cells(i, 210)
  Next i
 End If
 If .Cells(2, 110) <> 3 And .Cells(2, 110) <> "" Then
  For i = 3 To .Cells(2, 110) - 1
   frmVGI.lbChybyVvVGI.AddItem .Cells(i, 110)
  Next i
 End If
End With

End Sub

Sub delCKNmClick()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 1 To 10
  .Columns(i).Clear
 Next i
 For i = 61 To 80
  .Columns(i).Clear
 Next i
 frmVGI.lblCKNm.Caption = "nepripojen|fffd|"
 frmVGI.delCKNm.Visible = False
End With

frmVGI.cmbNacitatCKNm.Enabled = True
ChybyVGI

End Sub

Sub delCKNtClick()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 11 To 20
  .Columns(i).Clear
 Next i
 frmVGI.lblCKNt.Caption = "nepripojen|fffd|"
 frmVGI.delCKNt.Visible = False
End With

frmVGI.cmbNacitatCKNt.Enabled = True
ChybyVGI

End Sub

Private Sub delEKN_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 21 To 30
  Sheets("NacitanieVGI").Columns(i).Clear
 Next i
 frmVGI.lblEKN.Caption = "nepripojen|fffd|"
 frmVGI.delEKN.Visible = False
End With

frmVGI.cmbNacitatEKN.Enabled = True
ChybyVGI

End Sub

Private Sub delCKNp_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 31 To 40
  .Columns(i).Clear
 Next i
 frmVGI.lblCKNp.Caption = "nepripojen|fffd|"
 frmVGI.delCKNp.Visible = False
End With

frmVGI.cmbNacitatCKNp.Enabled = True
ChybyVGI

End Sub


Private Sub delCKNstx_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 41 To 50
  .Columns(i).Clear
 Next i
 frmVGI.lblCKNstx.Caption = "nepripojen|fffd|"
 frmVGI.delCKNstx.Visible = False
 frmVGI.delCKNstxNove.Visible = False
End With

frmVGI.cmbNacitatCKNstx.Enabled = True
frmVGI.cmbNacitatCKNstxNOVE.Enabled = True
ChybyVGI

End Sub




Private Sub delCKN03_Click()
Dim i As Integer
Dim Aktivny_zosit As String

Aktivny_zosit = ActiveSheet.Name

With Sheets("NacitanieVGI")
 For i = 101 To 110
  .Columns(i).Clear
 Next i
 frmVGI.lblCKN03.Caption = "nepripojen|fffd|"
 frmVGI.delCKN03.Visible = False
End With

frmVGI.cmbNacitatCKN03.Enabled = True
ChybyVGI

End Sub






Attribute VB_Name = "mdl_VlozitVlastikov"
Sub Vlozit_vlastnikov()
Dim i As Integer
Dim j As Integer
Dim nazov_listu_Zz As String

Dim nazov_listu_Vv As String
Dim stlpec_N_cp As Integer
Dim stlpec_N_dp As Integer
Dim Vlastnik As String

If frmVlastnici.lblVv.Caption <> "Nie je zobrazen|fffd| |fffd|iadny Vv" Then
 With Sheets("exp_imp")
  .Columns(19).Clear
  .Columns(20).Clear
  .Columns(21).Clear
  .Columns(22).Clear
 End With

 frmVlastnici.lbVlastnik.Clear
 frmVlastnici.lbPC.Clear

 nazov_listu_Zz = frmVlastnici.lblZz.Caption
 nazov_listu_Vv = frmVlastnici.lblVv.Caption

 With Sheets(nazov_listu_Vv)
  For i = 1 To 31
   For j = 1 To 5
    If .Cells(j, i) = Sheets("VvA").Cells(3, 12) Then stlpec_N_cp = i
    If .Cells(j, i) = Sheets("VvA").Cells(5, 15) Then stlpec_N_dp = i
    If .Cells(j, i) = Sheets("VvA").Cells(3, 16) Then stlpec_Vlastnik = i
   Next j
  Next i
  
  Vlastnik = ""
  For i = 6 To pocet_riadkov_List(nazov_listu_Vv)
   If .Cells(i, stlpec_Vlastnik) <> "" And .Cells(i, stlpec_N_cp) <> "" And Mid(.Cells(i, stlpec_N_cp), 1, 1) <> "(" Then
    Vlastnik = .Cells(i, stlpec_Vlastnik)
    j = i
    Do
     j = j + 1
     If .Cells(j, stlpec_N_cp) = "" And .Cells(j, stlpec_Vlastnik) <> "" Then Vlastnik = Vlastnik & ", " & .Cells(j, stlpec_Vlastnik) Else _
         Exit Do
    Loop
    
    Sheets("exp_imp").Cells(Sheets("exp_imp").Cells(1, 18), 20) = Vlastnik
    Sheets("exp_imp").Cells(Sheets("exp_imp").Cells(1, 18), 19) = .Cells(i, stlpec_N_cp)
   End If
  Next i
 End With

 With Sheets("exp_imp")
  For i = 2 To .Cells(1, 18)
   If .Cells(i, 20) = "detto" Or .Cells(i, 20) = "Detto" Then .Cells(i, 20) = .Cells(i - 1, 20)
  Next i
      
  Dim existuje As String
  Dim existuje_i As Integer
 
  For i = 2 To .Cells(1, 18)
   existuje = "nie"
   For j = 2 To .Cells(3, 18)
    If .Cells(i, 20) <> "" Then
     If .Cells(i, 20) = .Cells(j, 21) Then
      existuje = "ano"
      existuje_i = j
     End If
    End If
   Next j

   If .Cells(i, 20) <> "ako v stave pr|fffd|vnom" And .Cells(i, 20) <> "ako v stave pr|fffd|vnom." And .Cells(i, 20) <> "Ako v stave pr|fffd|vnom" And _
      .Cells(i, 20) <> "Ako v stave pr|fffd|vnom." Then
    If existuje = "nie" Then
     .Cells(.Cells(3, 18), 22) = .Cells(i, 19)
     .Cells(.Cells(3, 18), 21) = .Cells(i, 20)
    Else
     .Cells(existuje_i, 22) = .Cells(existuje_i, 22) & ", " & .Cells(i, 19)
    End If
   End If
  Next i
      
  Sheets(nazov_listu_Zz).Select
  For i = 2 To .Cells(3, 18)
   frmVlastnici.lbVlastnik.AddItem .Cells(i, 21)
   frmVlastnici.lbPC.AddItem .Cells(i, 22)
  Next i
  
 End With
End If
End Sub
Attribute VB_Name = "mdl_Vyuzivanie_Stavba"
'Sub Vyuzivanie()
'Sub stavba()

Sub Vyuzivanie()
  frmVyuzivanie.DP_pom.Caption = "Vv"
  frmVyuzivanie.DP_pom1.Caption = "Vv_SV"
  frmVyuzivanie.Show
End Sub

Sub stavba()
  frmVyuzivanie.DP_pom.Caption = "Vv_SV"
  frmVyuzivanie.DP_pom1.Caption = "Vv_KDS"
  frmVyuzivanie.Show
End Sub

Attribute VB_Name = "mdl_XML"
'Sub XML()

Sub XML(ZobrazitOkno As String)
Dim i As Integer
Dim j As Integer
Dim jj As Integer
Dim k As Integer
Dim nazov_listu_Vv As String
Dim stlpec_rusenieSC As Integer
Dim stlpec_rusenieSV As Integer
Dim pocet_riadkov As Integer
Dim pocet_poznamok As Integer
Dim pozicia_spolu_E As Integer
Dim pozicia_spolu_C As Integer
Dim pozicia_Spolu As Integer

Dim stlpec_PKV As Integer
 Dim stlpec_LV As Integer
 Dim stlpec_PK As Integer
 Dim stlpec_KN_E As Integer
 Dim stlpec_KN_C As Integer
 Dim stlpec_D_ha As Integer
 Dim stlpec_D_m2 As Integer
 Dim stlpec_D_DP As Integer
  Dim DRN As String
  Dim cpa As String
  Dim clv As String
  Dim PKV As String
  Dim vym As String
  Dim drp As String
  Dim Na_LV As Integer
 Dim stlpec_diel As Integer
 Dim stlpec_K As Integer
 Dim stlpec_K_m2 As Integer
 Dim stlpec_OD_m2 As Integer
 Dim stlpec_OD As Integer
 Dim stlpec_Diel_Exist As Integer
  Dim cdi As String
  Dim ds_cpa As String
  Dim ds_drn As String
  Dim ns_cpa As String
  Dim ns_drn As String
 Dim stlpec_N_ha As Integer
 Dim stlpec_N_m2 As Integer
 Dim stlpec_N_cp As Integer
 Dim stlpec_N_dp As Integer
 Dim stlpec_Supisne_Cislo As Integer
 Dim stlpec_Stavba_Od As Integer
 Dim Stlpec_PKU As Integer
 Dim ds_cpa_NS As String
  Dim drs As String
  Dim pec As String
  Dim drsR As String
  Dim pecR As String
  Dim ds_cpaR As String
  Dim ds_cpa_Pre_Diel As String
   Dim Davat As String
   
   Dim Suma_DS_ha As Double
   Dim Suma_NS_ha As Double
   Dim Suma_DS_CKN_ha As Double
   Dim Suma_NS_CKN_ha As Double
   
Nazvy_stlpcov (ActiveSheet.Name)
nazov_listu_Vv = ActiveSheet.Name
   
With Sheets("exp_imp")
 stlpec_PKV = .Cells(18, 2)
 stlpec_LV = .Cells(19, 2)
 stlpec_PK = .Cells(20, 2)
 stlpec_KN_E = .Cells(21, 2)
 stlpec_KN_C = .Cells(22, 2)
 stlpec_D_ha = .Cells(23, 2)
 stlpec_D_m2 = .Cells(24, 2)
 stlpec_D_DP = .Cells(25, 2)
 
 stlpec_diel = .Cells(26, 2)
 stlpec_K = .Cells(27, 2)
 stlpec_K_m2 = .Cells(28, 2)
 stlpec_OD = .Cells(29, 2)
 stlpec_OD_m2 = .Cells(30, 2)
 If Sheets("vstup").chbVB.Value = True Then
  stlpec_diel = .Cells(26, 2)
  stlpec_K = .Cells(29, 2)
  stlpec_K_m2 = .Cells(30, 2)
 End If
 
 stlpec_N_cp = .Cells(31, 2)
 stlpec_N_ha = .Cells(32, 2)
 stlpec_N_m2 = .Cells(33, 2)
 stlpec_N_dp = .Cells(34, 2)
 stlpec_Supisne_Cislo = .Cells(36, 2)
 stlpec_Stavba_Od = .Cells(37, 2)
 Stlpec_PKU = .Cells(47, 2)
End With

With Sheets("exp_imp")                                                                      '////// indexy stlpcov
 stlpec_rusenieSC = .Cells(38, 2)
 stlpec_rusenieSV = .Cells(39, 2)
 For i = 14 To 17                                ''zmazanie info o ruseni stavby z listu exp_imp
  .Columns(i).Clear
  .Columns(i).Interior.ColorIndex = 6
 Next i
End With

With Sheets("xml")
 .Visible = True
 .Select
 .UsedRange.Delete
End With
 
Sheets(nazov_listu_Vv).Select
pocet_riadkov = pocet_riadkov_List(nazov_listu_Vv)


i = 1
Do
 i = i + 1
 If Cells(i, 1) = Sheets("exp_imp").Cells(14, 1) Then                                    '////// pocet riadkov po rozpisku
  pocet_riadkov = i - 1
  Exit Do
 End If
 If i = pocet_riadkov Then Exit Do
 If Cells(i, 1) = "Spolu:" Then                                                          '////// Pozicia Spolu - na VV pouzit Pozicia_Spolu
  If pozicia_spolu_E = 0 Then pozicia_spolu_E = i Else pozicia_spolu_C = i
                                                                                          
                                                                                            '////// Doplnit SPOLU na 4 miesta m2
  If Cells(i, stlpec_D_ha) <> 0 Then Cells(i, stlpec_D_m2).NumberFormat = "0000" Else _
     Cells(i, stlpec_D_m2).NumberFormat = "General"      ''ZMENENE z @
  If Cells(i, stlpec_N_ha) <> 0 Then Cells(i, stlpec_N_m2).NumberFormat = "0000" Else _
     Cells(i, stlpec_N_m2).NumberFormat = "General"      ''ZMENENE z @
     
 End If
Loop

If pozicia_spolu_C > pozicia_spolu_E Then pozicia_Spolu = pozicia_spolu_C Else pozicia_Spolu = pozicia_spolu_E
If pozicia_Spolu = 0 Then GoTo Chyba_Spolu
    

If Sheets("vstup").chbPrazdne.Value = True Then                                           '////// odstranit prazdne bunky - nemusi fungovat
 For i = 6 To pocet_riadkov
  For j = 1 To Sheets("exp_imp").Cells(35, 2)
   On Error GoTo NefungujeLTrim
   If Cells(i, 1) <> "Spolu:" Then Cells(i, j) = LTrim(RTrim(Cells(i, j)))
  Next j
 Next i
End If

i = 5
Do
 i = i + 1
 If i = pozicia_Spolu Then
  Exit Do
 Else
  Cells(i, 1).Select
                                                           '********************************************************************Doterajsi stav
                     '************************************************************************************************zaciatok vyhodnotenia DS
  Dim pom_EKN As Integer
  pom_EKN = 0
  If stlpec_KN_E = 0 Then
   pom_EKN = 1
   stlpec_KN_E = stlpec_PK
  End If
  
  If Cells(i, stlpec_D_DP) <> "" Or _
  Cells(i, stlpec_PKV) <> "" Or _
  Cells(i, stlpec_LV) <> "" Or _
  Cells(i, stlpec_PK) <> "" Or _
  Cells(i, stlpec_KN_E) <> "" Or _
  Cells(i, stlpec_KN_C) <> "" Or _
  Cells(i, stlpec_D_ha) <> "" Or _
  Cells(i, stlpec_D_m2) <> "" Then
   If i <> pozicia_spolu_E And i <> pozicia_spolu_C Then
    
''    If pom_EKN = 1 Then stlpec_KN_E = 0
   stlpec_KN_E = Sheets("exp_imp").Cells(21, 2)
    
    DRN = ""
    cpa = ""
    clv = ""
    PKV = ""
    vym = ""
    drp = ""
      
    If Cells(i, stlpec_PKV) <> "" Then PKV = Cells(i, stlpec_PKV).Text
    If Cells(i, stlpec_PKV) = "neknih." Then PKV = "0"
    If Cells(i, stlpec_LV) <> "" Then clv = Cells(i, stlpec_LV).Text
    If clv = "" Then clv = "0"
      
    If Cells(i, stlpec_PK) <> "" Then
     cpa = Cells(i, stlpec_PK).Value
     DRN = "5"
    End If
      
    If stlpec_KN_E > 0 Then
     If Cells(i, stlpec_KN_E) <> "" Then
      If Cells(i, Stlpec_PKU).Value <> 0 Then cpa = Cells(i, Stlpec_PKU).Value & "-" & Cells(i, stlpec_KN_E).Value Else _
      cpa = Cells(i, stlpec_KN_E).Value
      DRN = "2"
     End If
    End If
    
    If Cells(i, stlpec_KN_C) <> "" Then
     cpa = Cells(i, stlpec_KN_C).Text
     DRN = "1"
    End If
      
    If stlpec_PKV = stlpec_LV Then
     If Cells(i, stlpec_PK) <> "" Then
      PKV = Cells(i, stlpec_PKV).Text
      clv = "0"
     Else:
      PKV = ""
      clv = Cells(i, stlpec_PKV).Text
     End If
    End If

    If PKV = "neknih." Then PKV = "0"                                                       ''SKONTROLOVAT
    If clv = "" Then clv = "0"

    If Cells(i, stlpec_D_ha) <> "" And Cells(i, stlpec_D_m2) <> "" Then
     Cells(i, stlpec_D_m2).NumberFormat = "0000"
     Cells(i, stlpec_D_m2) = Cells(i, stlpec_D_m2).Text
    Else: Cells(i, stlpec_D_m2).NumberFormat = "General"
    End If
      
    If Cells(i, stlpec_D_m2) = 0 And Cells(i, stlpec_D_m2) <> "" Then
     Cells(i, stlpec_D_m2).NumberFormat = "@"
     Cells(i, stlpec_D_m2) = "0000"
    End If
    
    vym = Cells(i, stlpec_D_ha).Text + Cells(i, stlpec_D_m2).Text
    If Cells(i, stlpec_D_m2) = "" Then vym = 0
    
    If pozicia_spolu_C = 0 Then
     If i < pozicia_spolu_E Then Suma_DS_ha = Suma_DS_ha + vym
    Else
     If i < pozicia_spolu_E Then
      Suma_DS_ha = Suma_DS_ha + vym
     End If
     If i > pozicia_spolu_E And i < pozicia_spolu_C Then
      Suma_DS_CKN_ha = Suma_DS_CKN_ha + vym
     End If
    End If
      
    For jj = 61 To 200
     Sheets("exp_imp").Cells(jj, 2) = ""
     Sheets("exp_imp").Cells(jj, 3) = ""
    Next jj
    
    j = 12
    jj = 61
    Do
     j = j + 1
     If Sheets("nastavenia").Cells(j, 33) = "" Then
      Exit Do
     Else
      Sheets("exp_imp").Cells(jj, 2) = Sheets("nastavenia").Cells(j, 33)
      Sheets("exp_imp").Cells(jj, 3) = Sheets("nastavenia").Cells(j, 34)
      jj = jj + 1
     End If
    Loop
    
    j = 12
    Do
     j = j + 1
     If Sheets("nastavenia").Cells(j, 36) = "" Then
      Exit Do
     Else
      Sheets("exp_imp").Cells(jj, 2) = Sheets("nastavenia").Cells(j, 36)
      Sheets("exp_imp").Cells(jj, 3) = Sheets("nastavenia").Cells(j, 37)
      jj = jj + 1
     End If
    Loop

    j = 60
    Do
     j = j + 1
     If Sheets("exp_imp").Cells(j, 2) = "" Then
      Exit Do
     Else
      If Cells(i, stlpec_D_DP).Text = Sheets("exp_imp").Cells(j, 2).Text Then drp = Sheets("exp_imp").Cells(j, 3).Text
     End If
    Loop

    If drp = "" Then
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, -1).Value = "DP"
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Nespr|fffd|vny druh pozemku p.|fffd|. " + cpa + " - Doteraj|fffd||fffd| stav"
     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_D_DP
     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
    End If
      
    '**************************************************************************************Druh pozemku koniec
    Na_LV = 0
      
    With Sheets("xml")
     For j = 2 To .Cells(1, 1) + 1
      If .Cells(j, 3) = cpa Then
       If .Cells(j, 4) = clv Then Na_LV = 1
      End If
     Next j
     Sheets("XML").Visible = xlSheetVeryHidden
     Sheets("poznamky_XML").Visible = xlSheetVeryHidden

''     On Error GoTo Chyba_PS
     If (DRN <> 1) Or (pozicia_spolu_E < i) Or (pozicia_spolu_C = 0) Then
      .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) = "PARCELA_DS"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 1).NumberFormat = "@"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 1) = DRN
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 2).NumberFormat = "@"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 2) = cpa
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 3).NumberFormat = "@"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 3) = clv
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 4).NumberFormat = "@"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 4) = PKV
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5).NumberFormat = "@"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5) = vym
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 6).NumberFormat = "@"
      .Cells(Rows.Count, 1).End(xlUp).Offset(0, 6) = drp
      .Cells(1, 1) = .Cells(1, 1) + 1
     End If
    End With
    
   End If
   End If
   If Sheets("vstup").chbSumyVv.Value = True Then
    If pozicia_spolu_C = 0 Then
     If i = pozicia_Spolu - 1 Then
      Sheets("exp_imp").Cells(57, 4) = Suma_DS_ha
      Cells(pozicia_Spolu, stlpec_D_ha) = Sheets("exp_imp").Cells(57, 5)
      Cells(pozicia_Spolu, stlpec_D_m2) = Sheets("exp_imp").Cells(57, 6)
     End If
    Else
     If i = pozicia_spolu_E Then
      Sheets("exp_imp").Cells(57, 4) = Suma_DS_ha
      Cells(pozicia_spolu_E, stlpec_D_ha) = Sheets("exp_imp").Cells(57, 5)
      Cells(pozicia_spolu_E, stlpec_D_m2) = Sheets("exp_imp").Cells(57, 6)
     End If
     If i = pozicia_Spolu - 1 Then
      Sheets("exp_imp").Cells(57, 4) = Suma_DS_CKN_ha
      Cells(pozicia_Spolu, stlpec_D_ha) = Sheets("exp_imp").Cells(57, 5)
      Cells(pozicia_Spolu, stlpec_D_m2) = Sheets("exp_imp").Cells(57, 6)
     End If
    End If
   End If
  '************************************************************************************************koniec vyhodnotenia DS
                                                            '***********************************************************Doterajsi stav - koniec
                                                            
                                                            
                                                            '*****************************************************************************Diely
   If Sheets("vstup").chbVB.Value = False Then
   If Cells(i, stlpec_diel) <> "" Then
     
    If Cells(i, stlpec_PK).Text <> "" Then
     ds_cpa = Cells(i, stlpec_PK).Text
     ds_drn = "5"
    End If
    If stlpec_KN_E > 0 Then
     If Cells(i, stlpec_KN_E).Text <> "" Then
      If Cells(i, Stlpec_PKU).Value <> 0 Then ds_cpa = Cells(i, Stlpec_PKU).Text & "-" & Cells(i, stlpec_KN_E).Text Else _
      ds_cpa = Cells(i, stlpec_KN_E).Text
      ds_cpa_Pre_Diel = Cells(i, stlpec_KN_E).Text
      ds_drn = "2"
     End If
    End If
    If Cells(i, stlpec_KN_C).Text <> "" Then
     ds_cpa = Cells(i, stlpec_KN_C).Text
     ds_drn = "1"
    End If
     
    cdi = Cells(i, stlpec_diel).Text
    diel_exist = 0

    For j = i + 1 To pozicia_Spolu
     If Cells(j, stlpec_diel).Text = cdi Then

      diel_exist = diel_exist + 1 ''Skontrolova|fffd|, ci existuje diel s takym cislom
      
      ns_cpa = ""
      For k = j To pozicia_Spolu
       If Cells(k, stlpec_N_cp).Text <> "" Then
        If ns_cpa = "" Then ns_cpa = Cells(k, stlpec_N_cp).Text
       End If
      Next k
    
      If ns_cpa <> Cells(i, stlpec_K).Text Then ''And diel_exist = 1 And Cells(j, stlpec_K).Text <> "" Then
       Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|." + cdi + "  - nesedia parc.|fffd|. Nov|fffd|ho stavu"
       Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
       Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_K
       Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
      End If
     End If
    Next j
     
    If diel_exist = 0 And Cells(i, stlpec_K) <> "" Then
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|. " + cdi + " sa nenach|fffd|dza pri skladan|fffd| parciel z dielov (v |fffd|asti od parcely)"
     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_diel
     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
    End If
    
    If diel_exist > 1 And Cells(i, stlpec_K) <> "" Then
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|. " + cdi + " sa nach|fffd|dza pri skladan|fffd| parciel z dielov " & diel_exist & "x"
     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_diel
     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
    End If
      
    For j = i + 1 To pozicia_Spolu
     If Cells(j, stlpec_diel).Text = cdi Then
      If DRN = 2 Then
       If Cells(j, stlpec_OD).Text <> ds_cpa_Pre_Diel Then
        Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|. " + cdi + " nesedia parc.|fffd|. Doteraj|fffd|ieho stavu"
        Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = j
        Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_OD
        Sheets("XML").Cells(Rows.Count, 103).End(xlUp).Offset(1, 0).Value = cdi
        Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
       End If
      Else
       If Cells(j, stlpec_OD).Text <> ds_cpa Then
        Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|. " + cdi + " nesedia parc.|fffd|. Doteraj|fffd|ieho stavu"
        Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = j
        Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_OD
        Sheets("XML").Cells(Rows.Count, 103).End(xlUp).Offset(1, 0).Value = cdi
        Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
       End If
      End If
      If Cells(j, stlpec_OD_m2).Text <> Cells(i, stlpec_K_m2).Text Then ''And diel_exist = 1 And Cells(j, stlpec_K).Text <> "" Then
       Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|. " + cdi + " nesedia v|fffd|mery"
       Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
       Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_K_m2
       Sheets("XML").Cells(Rows.Count, 103).End(xlUp).Offset(1, 0).Value = Cells(j, stlpec_OD_m2).Text
       Sheets("XML").Cells(Rows.Count, 104).End(xlUp).Offset(1, 0).Value = Cells(i, stlpec_K_m2).Text
       Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
      End If
      With Sheets("xml")
       .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) = "DIEL"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5) = Cells(i, stlpec_K_m2).Text
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 7).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 7) = cdi
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 8).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 8) = ds_cpa
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 9).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 9) = ds_drn
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 10).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 10) = ns_cpa
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 11).Value = "1"
      End With
     End If
    Next j
     
    diel_exist = 0
    
    If Cells(i, stlpec_K).Text = "" And Cells(i, stlpec_OD).Text <> "" And cdi <> "" Then
     For j = 6 To i - 1
      If Cells(j, stlpec_diel).Text = cdi Then
       diel_exist = diel_exist + 1 ''Skontrolova|fffd|, ci existuje diel s takym cislom
      End If
     Next j
     If diel_exist = 0 Then
      Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Diel |fffd|. " + cdi + " sa nenach|fffd|dza pri skladan|fffd| parciel z dielov (v |fffd|asti k parcele)"
      Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
      Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_diel
      Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
     End If
    End If
   
   End If
   End If
                                                            '********************************************************************Diely - koniec
                                                            '*****************************************************************************Diely VB
   If Sheets("vstup").chbVB.Value = True Then
   If Cells(i, stlpec_diel) <> "" Then
     
    If Cells(i, stlpec_PK).Text <> "" Then
     ds_cpa = Cells(i, stlpec_PK).Text
     ds_drn = "5"
    End If
    If stlpec_KN_E > 0 Then
     If Cells(i, stlpec_KN_E).Text <> "" Then
      If Cells(i, Stlpec_PKU).Value <> 0 Then ds_cpa = Cells(i, Stlpec_PKU).Text & "-" & Cells(i, stlpec_KN_E).Text Else _
      ds_cpa = Cells(i, stlpec_KN_E).Text
      ds_cpa_Pre_Diel = Cells(i, stlpec_KN_E).Text
      ds_drn = "2"
     End If
    End If
    If Cells(i, stlpec_KN_C).Text <> "" Then
     ds_cpa = Cells(i, stlpec_KN_C).Text
     ds_drn = "1"
    End If
    cdi = Cells(i, stlpec_diel).Text
    ns_cpa = ds_cpa
      
    For j = i To pozicia_spolu_E
     If Cells(j, stlpec_diel).Text = cdi And DRN <> "" Then
      With Sheets("xml")
       .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) = "DIEL"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5) = Cells(i, stlpec_OD_m2).Text
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 7).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 7) = cdi
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 8).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 8) = ds_cpa
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 9).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 9) = ds_drn
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 10).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 10) = ds_cpa
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 11) = ds_drn
       If Cells(j, 1) = "Spolu:" Then DRN = ""
      End With
     End If
    Next j
   
   End If
   End If
                                                            '********************************************************************Diely VB - koniec
                                                            
                                                            '**************************************************************************Novy stav
   If Cells(i, stlpec_N_cp).Text <> "" Then
    DRN = ""
    drsR = ""
    pecR = ""
    ds_cpaR = ""
       
    If Cells(i, stlpec_PK).Text <> "" Then
     DRN = "5"
        If "(" & Cells(i, stlpec_PK).Text <> Cells(i, stlpec_N_cp).Text Then
          Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, -1).Value = "Nespr|fffd|vne p.|fffd|."
          Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Nes|fffd|hlas parceln|fffd|ho |fffd||fffd|sla doteraj|fffd|ieho a nov|fffd|ho stavu v riadku " & i & "  (m|fffd||fffd|e ch|fffd|ba|fffd| za|fffd|iatok z|fffd|tvorky)."
         Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
         Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_N_cp
         Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
        End If
     cpa = Cells(i, stlpec_PK).Text
    End If
    
    If stlpec_KN_E <> 0 Then
     If Cells(i, stlpec_KN_E).Text <> "" Then
      If Cells(i, Stlpec_PKU).Value <> 0 Then cpa = Cells(i, Stlpec_PKU).Text & "-" & Cells(i, stlpec_KN_E).Text Else _
      cpa = Cells(i, stlpec_KN_E).Text
      DRN = "2"
      If "(" & Cells(i, stlpec_KN_E).Text <> Cells(i, stlpec_N_cp).Text Then
       Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, -1).Value = "Nespr|fffd|vne p.|fffd|."
       Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Nes|fffd|hlas parceln|fffd|ho |fffd||fffd|sla doteraj|fffd|ieho a nov|fffd|ho stavu v riadku " & i & "  (m|fffd||fffd|e ch|fffd|ba|fffd| za|fffd|iatok z|fffd|tvorky)."
       Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
       Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_N_cp
       Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
      End If
     End If
    End If

    If DRN = "" Then
     DRN = "1"
     cpa = Cells(i, stlpec_N_cp).Text
    End If
    
    If Cells(i, stlpec_N_ha) <> "" And Cells(i, stlpec_N_m2) <> "" Then
     Cells(i, stlpec_N_m2).NumberFormat = "0000"
     Cells(i, stlpec_N_m2) = Cells(i, stlpec_N_m2).Text
    Else: Cells(i, stlpec_N_m2).NumberFormat = "General"
    End If
       
    If Cells(i, stlpec_N_m2) = 0 And Cells(i, stlpec_N_m2) <> "" Then
     Cells(i, stlpec_N_m2).NumberFormat = "@"
     Cells(i, stlpec_N_m2) = "0000"
    End If
    
    If Cells(i, stlpec_N_ha) = "" And Cells(i, stlpec_N_m2) = "0000" Then
     Cells(i, stlpec_N_m2) = ""
    End If

    vym = Cells(i, stlpec_N_ha).Text + Cells(i, stlpec_N_m2).Text
    If vym = "" Then vym = 0
        
    If pozicia_spolu_C = 0 Then
     If i < pozicia_Spolu Then
      Suma_NS_ha = Suma_NS_ha + vym
     End If
    Else
     If i < pozicia_spolu_E Then
      Suma_NS_ha = Suma_NS_ha + vym
     End If
     If i > pozicia_spolu_E And i < pozicia_spolu_C Then
      Suma_NS_CKN_ha = Suma_NS_CKN_ha + vym
     End If
    End If
    
    If Cells(i, stlpec_N_ha) = "" And Cells(i, stlpec_N_m2) = "" And DRN <> 1 Then
     If Cells(i, stlpec_N_dp) <> Sheets("exp_imp").Cells(15, 1).Text + ")" Then vym = "0" Else vym = ""
    End If

    If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(15, 1).Text + ")" Or Cells(i, stlpec_N_dp) = Sheets("exp_imp").Cells(15, 1).Text Then
     If vym <> "" And vym <> "0" Then
      Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Nov|fffd| stav - pri p.|fffd|. " + cpa + " je v|fffd|mera aj ""zanik|fffd|"""
      Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
      Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_N_dp
      Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
     End If
    End If
    
    If Cells(i, stlpec_N_dp) = Sheets("exp_imp").Cells(15, 1).Text Then vym = "0"
    If Cells(i, stlpec_N_dp) = Sheets("exp_imp").Cells(15, 1).Text + ")" Then vym = ""
    
    drp = ""
    
''povodne
''    j = 12
''    Do
''     j = j + 1
''     If Sheets("nastavenia").Cells(j, 33) = "" Then
''      Exit Do
''     Else
     
''      If Cells(i, stlpec_N_dp).Text = Sheets("nastavenia").Cells(j, 33).Text Then drp = Sheets("nastavenia").Cells(j, 34).Text
''      If Cells(i, stlpec_N_dp).Text = Sheets("nastavenia").Cells(j, 33).Text + ")" Then drp = Sheets("nastavenia").Cells(j, 34).Text
''      If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(15, 1).Text Then
''       If Cells(i, stlpec_D_DP).Text = Sheets("nastavenia").Cells(j, 33).Text Then drp = Sheets("nastavenia").Cells(j, 34).Text
''      End If
''      If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(15, 1).Text + ")" Then
''       If Cells(i, stlpec_D_DP).Text = Sheets("nastavenia").Cells(j, 33).Text Then drp = Sheets("nastavenia").Cells(j, 34).Text
''      End If
         
''     End If
''    Loop
    
''    If drp = "" Then
''     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, -1).Value = "DP"
''     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Nespr|fffd|vny druh pozemku p.|fffd|. " + cpa + " - Nov|fffd| stav"
''     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
''     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_N_dp
''     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
''    End If
    
    j = 60
    Do
     j = j + 1
     If Sheets("exp_imp").Cells(j, 2) = "" Then
      Exit Do
     Else
      If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(j, 2).Text Then drp = Sheets("exp_imp").Cells(j, 3).Text
      If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(j, 2).Text + ")" Then drp = Sheets("exp_imp").Cells(j, 3).Text
      If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(15, 1).Text Then
       If Cells(i, stlpec_D_DP).Text = Sheets("exp_imp").Cells(j, 2).Text Then drp = Sheets("exp_imp").Cells(j, 3).Text
      End If
      If Cells(i, stlpec_N_dp).Text = Sheets("exp_imp").Cells(15, 1).Text + ")" Then
       If Cells(i, stlpec_D_DP).Text = Sheets("exp_imp").Cells(j, 2).Text Then drp = Sheets("exp_imp").Cells(j, 3).Text
      End If
     End If
    Loop
    
    If drp = "" Then
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, -1).Value = "DP"
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Nespr|fffd|vny druh pozemku p.|fffd|. " + cpa + " - Nov|fffd| stav"
     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_N_dp
     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
    End If
    
      
    drs = ""
    pec = ""
    pkk = ""
    ds_cpa_NS = ""
      
    If Cells(i + 1, stlpec_N_cp).Text = "" Then
     If Cells(i + 1, stlpec_N_dp).Text <> "" Then pkk = Cells(i + 1, stlpec_N_dp).Text
    End If
    
    'If drp <> "" Then                                                                                                              NEDAM??
    '    pkk_E = 0
    'End If
    
    If Cells(i, stlpec_N_dp).Text <> "zanik|fffd|" Then
     If drp <> "" And pkk = "" And DRN = 1 Then
      Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Zadaj sp|fffd|sob vyu|fffd||fffd|vania p.|fffd|. " + cpa
      Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i + 1
      Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_N_dp
      Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
     End If
    End If
      
      ''tu sa ma vlozit podmienka, aby nedavalo 2x NS parcely
      
    If pozicia_spolu_E = pozicia_Spolu Or i > pozicia_spolu_E Then              ''Aby davalo/porovnavalo stavby len v stave podla CKN
     ''RUSENIE STAVBY
     drsR = Cells(i, stlpec_rusenieSV).Text
     pecR = Cells(i, stlpec_rusenieSC).Text
    
     If pecR = "" And drsR <> "" Then
      Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Zadaj s|fffd|pisn|fffd| |fffd||fffd|slo stavby p.|fffd|. " + cpa + " v Stave pod|fffd|a registra C KN (pre ru|fffd|en|fffd| stavbu)"
      Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
      Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_rusenieSC
      Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
     End If
      
     If pecR <> "" And drsR = "" Then
      Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Zadaj sp|fffd|sob vyu|fffd||fffd|vania stavby p.|fffd|. " + cpa + " v Stave pod|fffd|a registra C KN (pre ru|fffd|en|fffd| stavbu)"
      Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
      Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_rusenieSV
      Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
     End If
    
     If Cells(i, stlpec_N_cp).Text <> "" Then ds_cpaR = Cells(i, stlpec_N_cp).Text

     If Cells(i, stlpec_N_cp).Text = "" And ds_cpaR <> "" Then
      Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "p|fffd|vodn|fffd| sp|fffd|sob vyu|fffd||fffd|vania je zap|fffd|san|fffd| v zlom riadku (ru|fffd|en|fffd| stavba)"
      Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
      Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_rusenieSV
      Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
     End If
     ''RUSENIE STAVBY KONIEC
    
    
    
     If Cells(i + 2, stlpec_N_cp).Text = "" Then
      If Cells(i + 2, stlpec_N_dp).Text <> "" Then

       ''STAVBA
       drs = Cells(i + 2, stlpec_N_dp).Text
       If Cells(i, stlpec_Supisne_Cislo).Text <> "" Then pec = Cells(i, stlpec_Supisne_Cislo).Text
       If Cells(i, stlpec_Supisne_Cislo) = "0" Then pec = 0
       If pec = "" Then
        Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Zadaj s|fffd|pisn|fffd| |fffd||fffd|slo stavby p.|fffd|. " + cpa + " v Stave pod|fffd|a registra C KN"
        Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
        Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_Supisne_Cislo
        Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
       End If
       If Cells(i, stlpec_Stavba_Od).Text <> "" Then ds_cpa_NS = Cells(i, stlpec_Stavba_Od).Text
       If Cells(i, stlpec_Stavba_Od) = "0" Then ds_cpa_NS = 0
       If ds_cpa_NS = "" Then
         Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "Zadaj p.|fffd|., od ktorej parcely |fffd|lo s|fffd|pisn|fffd| |fffd||fffd|slo, pr|fffd|padne nulu, ak je to nov|fffd| s|fffd|pisn|fffd| |fffd|islo (p.|fffd|. " + cpa + ")" + " v Stave pod|fffd|a registra C KN"
         Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
         Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_Stavba_Od
         Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
       End If
       ''STAVBA KONIEC
      End If
     End If
    End If
      
      ''If pkk = "" Then pkk = pkk_E                                                ''*******************************************NEDAVAM
    If DRN <> "1" Then pkk = 0
    
    Davat = "Ano"
    If DRN = "1" And vym = "0" Then Davat = "Nie"
    If DRN = "1" And vym <> "0" Then Davat = "Ano"
    
    If (DRN <> 1) Or (pozicia_spolu_E < i) Or (pozicia_spolu_C = 0) Then
     If Davat = "Ano" Or DRN <> 1 Then
      With Sheets("xml")
       .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) = "PARCELA_NS"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 1).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 1) = DRN
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 2).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 2) = cpa
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 4).NumberFormat = "@"              ''Doplneny sposob vyuzivania
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 4) = pkk                            ''Doplneny sposob vyuzivania
       '' pridanie povolenych kodov pre dany sposob vyuzivania
       For k = 3 To 41
        If pkk = Sheets("Vyuz_poz").Cells(k, 1) Then
         .Cells(Rows.Count, 1).End(xlUp).Offset(0, 15).NumberFormat = "@"
         .Cells(Rows.Count, 1).End(xlUp).Offset(0, 15) = Sheets("Vyuz_poz").Cells(k, 3)
        End If
       Next k
       '' pridanie povolenych kodov pre dany sposob vyuzivania - koniec
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 5) = vym
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 6).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 6) = drp
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 8).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 8) = ds_cpa_NS
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 12).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 12) = pkk
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 13).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 13) = pec
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 14).NumberFormat = "@"
       .Cells(Rows.Count, 1).End(xlUp).Offset(0, 14).Value = drs
       .Cells(1, 2).Value = ActiveSheet.Name
       If Cells(i, stlpec_rusenieSV + 2).Text = "x" Or Cells(i, stlpec_rusenieSV + 2).Text = "X" Then _
                    .Cells(Rows.Count, 1).End(xlUp).Offset(0, 7) = "odpocet"
      End With
     End If
    End If
      
    ''RUSENA STAVBA V ZLOM RIADKU
    If Cells(i, stlpec_N_cp).Text = "" And Cells(i, stlpec_rusenieSV).Text <> "" Then
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "p|fffd|vodn|fffd| sp|fffd|sob vyu|fffd||fffd|vania je zap|fffd|san|fffd| v zlom riadku (ru|fffd|en|fffd| stavba)"
     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_rusenieSV
     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
    End If
    If Cells(i, stlpec_N_cp).Text = "" And Cells(i, stlpec_rusenieSC).Text <> "" Then
     Sheets("XML").Cells(Rows.Count, 100).End(xlUp).Offset(1, 0).Value = "S|fffd|pisn|fffd| |fffd||fffd|slo stavby je v zap|fffd|san|fffd| v zlom riadku"
     Sheets("XML").Cells(Rows.Count, 101).End(xlUp).Offset(1, 0).Value = i
     Sheets("XML").Cells(Rows.Count, 102).End(xlUp).Offset(1, 0).Value = stlpec_rusenieSC
     Sheets("XML").Cells(1, 100) = Sheets("XML").Cells(1, 100) + 1
    End If
           
    If ds_cpaR <> "" And pecR <> "" And drsR <> "" Then
     With Sheets("exp_imp")
      .Cells(.Cells(1, 13), 15).NumberFormat = "@"
      .Cells(.Cells(1, 13), 15).Value = ds_cpaR
      .Cells(.Cells(1, 13), 16).NumberFormat = "@"
      .Cells(.Cells(1, 13), 16).Value = pecR
      .Cells(.Cells(1, 13), 17).NumberFormat = "@"
      .Cells(.Cells(1, 13), 17).Value = drsR
      .Cells(.Cells(1, 13), 14) = "RUSENIE_STAVBY"
     End With
    End If
      
    ds_cpaR = ""
    pecR = ""
    drsR = ""
   
   End If
   
   If Sheets("vstup").chbSumyVv.Value = True Then
    If pozicia_spolu_C = 0 Then
     If i = pozicia_Spolu - 1 Then
      Sheets("exp_imp").Cells(57, 4) = Suma_NS_ha
      Cells(pozicia_Spolu, stlpec_N_ha) = Sheets("exp_imp").Cells(57, 5)
      Cells(pozicia_Spolu, stlpec_N_m2) = Sheets("exp_imp").Cells(57, 6)
     End If
    Else
     If i = pozicia_spolu_E Then
      Sheets("exp_imp").Cells(57, 4) = Suma_NS_ha
      Cells(pozicia_spolu_E, stlpec_N_ha) = Sheets("exp_imp").Cells(57, 5)
      Cells(pozicia_spolu_E, stlpec_N_m2) = Sheets("exp_imp").Cells(57, 6)
     End If
     If i = pozicia_spolu_C - 1 Then
      Sheets("exp_imp").Cells(57, 4) = Suma_NS_CKN_ha
      Cells(pozicia_Spolu, stlpec_N_ha) = Sheets("exp_imp").Cells(57, 5)
      Cells(pozicia_Spolu, stlpec_N_m2) = Sheets("exp_imp").Cells(57, 6)
     End If
    End If
   End If
   

                                                            '*****************************************************************Novy stav - koniec
  End If
 Loop

 With Sheets("xml")          ''doplnenie poctu riadkov v XML liste
    i = 0
    Do
        i = i + 1
        If .Cells(i, 1) = "" Then
            Exit Do
        Else
            .Cells(1, 1) = i
        End If
    Loop
 End With
        
        
 'Pridat poznamky
 For i = 2 To Sheets("xml").Cells(1, 1)
  For j = 3 To Sheets("poznamky_xml").Cells(1, 1)
  
   If Sheets("xml").Cells(i, 1).Text = Sheets("poznamky_xml").Cells(j, 1).Text Then
     If Sheets("xml").Cells(i, 2).Text = Sheets("poznamky_xml").Cells(j, 2).Text Then
       If Sheets("xml").Cells(i, 3).Text = Sheets("poznamky_xml").Cells(j, 3).Text Then
        Sheets("xml").Cells(i, 20) = Sheets("poznamky_xml").Cells(j, 4)
       End If
     End If
   End If
  
  If Sheets("xml").Cells(i, 1) = "DIEL" Then
    If Sheets("xml").Cells(i, 8) = Sheets("poznamky_xml").Cells(j, 3) Then Sheets("xml").Cells(i, 20) = Sheets("poznamky_xml").Cells(j, 4)
  End If
  Next j
 Next i
'Pridat poznamky koniec


''Pridat RUSENIE STAVBY
 For i = 1 To Sheets("exp_imp").Cells(1, 13)
  Sheets("XML").Cells(Sheets("XML").Cells(1, 1) + i, 1).Value = Sheets("exp_imp").Cells(i, 14).Value
  Sheets("XML").Cells(Sheets("XML").Cells(1, 1) + i, 2).Value = Sheets("exp_imp").Cells(i, 15).Value
  Sheets("XML").Cells(Sheets("XML").Cells(1, 1) + i, 3).Value = Sheets("exp_imp").Cells(i, 16).Value
  Sheets("XML").Cells(Sheets("XML").Cells(1, 1) + i, 4).Value = Sheets("exp_imp").Cells(i, 17).Value
 Next i
  Sheets("XML").Cells(1, 1) = Sheets("XML").Cells(1, 1) + Sheets("exp_imp").Cells(1, 13) - 1
    
''Pridat RUSENIE STAVBY koniec



 If Sheets("XML").Cells(Rows.Count, 100).End(xlUp) = "" Then
  Dim pocet As Integer
  pocet = 0
  
  With Sheets("XML")
   For i = 2 To .Cells(1, 1) + 1
    If .Cells(i, 1) = "RUSENIE_STAVBY" Then pocet = pocet + 1
   Next i
    frm_XML.cmbRuseneStavby.Caption = "ru|fffd|en|fffd| stavby [ " & pocet & " ]"
  End With

  Sheets("XML").Visible = xlSheetVeryHidden
  If ZobrazitOkno = True Then frm_XML.Show
  If ZobrazitOkno = False Then
   If Sheets("exp_imp").Cells(12, 2) <> "Poznamky" Then frmVGI.Show
  End If
'' End If
 Else:
  frmChyby.Show
 End If
                                                            
Exit Sub
Chyba_Spolu: MsgBox "Ch|fffd|ba ""Spolu:"". Ak ho nechce|fffd| ma|fffd| vo V|fffd|kaze v|fffd|mer, tak ho vyma|fffd| a|fffd| po vytvoren|fffd| XML, alebo daj font pisma biely."
''Chyba_PS: MsgBox "Ch|fffd|ba parceln|fffd| |fffd||fffd|slo (v riadku " & i & ")", vbOKOnly, "Tabulky_GP"
NefungujeLTrim:
If Sheets("Vstup").chbPrazdne.Value = True Then MsgBox "Funkcia na odstr|fffd|nenie pr|fffd|zdnych medzier nefunguje v tejto verzii excelu", vbOKOnly, "Tabulky_GP"
End Sub




Attribute VB_Name = "mdl_kopia_harku"
'Sub kopia_harku()
'Sub kopia_harku_viac()


Sub kopia_harku()
Dim nazov_listu As String
Dim Nuly As Boolean
Dim mriezka As Boolean
Dim s_LeftHeader As String
Dim pomSuma As String

If Sheets("Vstup").chbSumyVv.Value = True Then
 pomSuma = "Ano"
 Sheets("Vstup").chbSumyVv.Value = False
Else
 pomSuma = "Nie"
End If

nazov_listu = ActiveSheet.Name
If ActiveWindow.DisplayZeros = True Then Nuly = True Else Nuly = False
If ActiveWindow.DisplayGridlines = True Then mriezka = True Else mriezka = False
s_LeftHeader = Sheets(nazov_listu).PageSetup.LeftHeader
    
Sheets.Add
ActiveSheet.Name = nazov_listu + "_novySJ"
Sheets(nazov_listu).Select
Cells.Select
Selection.Copy
Cells(1, 1).Select
Sheets(nazov_listu + "_novySJ").Select
ActiveSheet.Paste
    
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
With Selection.Validation
 .Delete
 .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator:=xlBetween
 .IgnoreBlank = True
 .InCellDropdown = True
 .ShowInput = True
 .ShowError = True
End With
   
Sheets(nazov_listu + "_novySJ").Cells(1, 1).Select
If Nuly = False Then ActiveWindow.DisplayZeros = False Else ActiveWindow.DisplayZeros = True
If mriezka = False Then ActiveWindow.DisplayGridlines = False Else ActiveWindow.DisplayGridlines = True

Dim i As Integer

For i = 1 To 30
 If Cells(1, i) = Sheets("VvA").Cells(1, 17) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvA").Cells(1, 18) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvA").Cells(1, 19) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvA").Cells(1, 20) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvC").Cells(1, 23) Then Columns(i).Delete
Next i

'TLAC
With Sheets(nazov_listu + "_novySJ").PageSetup
 .PrintTitleRows = Sheets(nazov_listu).PageSetup.PrintTitleRows
 .PrintTitleColumns = Sheets(nazov_listu).PageSetup.PrintTitleColumns
End With
    
ActiveSheet.PageSetup.PrintArea = Sheets(nazov_listu).PageSetup.PrintArea
With ActiveSheet.PageSetup
 .LeftHeader = Sheets(nazov_listu).PageSetup.LeftHeader
 .CenterHeader = Sheets(nazov_listu).PageSetup.CenterHeader
 .RightHeader = Sheets(nazov_listu).PageSetup.RightHeader
 .LeftFooter = Sheets(nazov_listu).PageSetup.LeftFooter
 .CenterFooter = Sheets(nazov_listu).PageSetup.CenterFooter
 .RightFooter = Sheets(nazov_listu).PageSetup.RightFooter
 .LeftMargin = Sheets(nazov_listu).PageSetup.LeftMargin
 .RightMargin = Sheets(nazov_listu).PageSetup.RightMargin
 .TopMargin = Sheets(nazov_listu).PageSetup.TopMargin
 .BottomMargin = Sheets(nazov_listu).PageSetup.BottomMargin
 .HeaderMargin = Sheets(nazov_listu).PageSetup.HeaderMargin
 .FooterMargin = Sheets(nazov_listu).PageSetup.FooterMargin
 .PrintHeadings = Sheets(nazov_listu).PageSetup.PrintHeadings
 .PrintGridlines = Sheets(nazov_listu).PageSetup.PrintGridlines
 .PrintComments = Sheets(nazov_listu).PageSetup.PrintComments
'        .PrintQuality = Sheets(nazov_listu).PageSetup.PrintQuality
 .CenterHorizontally = Sheets(nazov_listu).PageSetup.CenterHorizontally
 .CenterVertically = Sheets(nazov_listu).PageSetup.CenterVertically
 .Orientation = Sheets(nazov_listu).PageSetup.Orientation
 .Draft = Sheets(nazov_listu).PageSetup.Draft
 On Error Resume Next
 .PaperSize = Sheets(nazov_listu).PageSetup.PaperSize
 On Error GoTo 0
 .FirstPageNumber = Sheets(nazov_listu).PageSetup.FirstPageNumber
 .Order = Sheets(nazov_listu).PageSetup.Order
 .BlackAndWhite = Sheets(nazov_listu).PageSetup.BlackAndWhite
 .Zoom = Sheets(nazov_listu).PageSetup.Zoom
 .PrintErrors = Sheets(nazov_listu).PageSetup.PrintErrors
 
 If pomSuma = "Ano" Then Sheets("Vstup").chbSumyVv.Value = True
End With
'TLAC KONIEC

Sheets(nazov_listu + "_novySJ").Move
Sheets(nazov_listu + "_novySJ").Name = nazov_listu


End Sub

Sub kopia_harku_viac(cislo_harku As Integer, nazov_listu As String)
Dim Nuly As Boolean
Dim mriezka As Boolean
Dim s_LeftHeader As String
    
If ActiveWindow.DisplayZeros = True Then Nuly = True Else Nuly = False
If ActiveWindow.DisplayGridlines = True Then mriezka = True Else mriezka = False
s_LeftHeader = Sheets(nazov_listu).PageSetup.LeftHeader
    
Sheets.Add
ActiveSheet.Name = nazov_listu + "_novySJ" + cislo_harku
Sheets(nazov_listu).Select
Cells.Select
Selection.Copy
Cells(1, 1).Select
Sheets(nazov_listu + "_novySJ" + cislo_harku).Select
ActiveSheet.Paste
    
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
With Selection.Validation
 .Delete
 .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator:=xlBetween
 .IgnoreBlank = True
 .InCellDropdown = True
 .ShowInput = True
 .ShowError = True
End With
   
Sheets(nazov_listu + "_novySJ" + cislo_harku).Cells(1, 1).Select
If Nuly = False Then ActiveWindow.DisplayZeros = False Else ActiveWindow.DisplayZeros = True
If mriezka = False Then ActiveWindow.DisplayGridlines = False Else ActiveWindow.DisplayGridlines = True

Dim i As Integer

For i = 1 To 30
 If Cells(1, i) = Sheets("VvA").Cells(1, 17) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvA").Cells(1, 18) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvA").Cells(1, 19) Then Columns(i).Delete
 If Cells(1, i) = Sheets("VvA").Cells(1, 20) Then Columns(i).Delete
Next i

'TLAC
With Sheets(nazov_listu + "_novySJ" + cislo_harku).PageSetup
 .PrintTitleRows = Sheets(nazov_listu).PageSetup.PrintTitleRows
 .PrintTitleColumns = Sheets(nazov_listu).PageSetup.PrintTitleColumns
End With
    
ActiveSheet.PageSetup.PrintArea = Sheets(nazov_listu).PageSetup.PrintArea
With ActiveSheet.PageSetup
 .LeftHeader = Sheets(nazov_listu).PageSetup.LeftHeader
 .CenterHeader = Sheets(nazov_listu).PageSetup.CenterHeader
 .RightHeader = Sheets(nazov_listu).PageSetup.RightHeader
 .LeftFooter = Sheets(nazov_listu).PageSetup.LeftFooter
 .CenterFooter = Sheets(nazov_listu).PageSetup.CenterFooter
 .RightFooter = Sheets(nazov_listu).PageSetup.RightFooter
 .LeftMargin = Sheets(nazov_listu).PageSetup.LeftMargin
 .RightMargin = Sheets(nazov_listu).PageSetup.RightMargin
 .TopMargin = Sheets(nazov_listu).PageSetup.TopMargin
 .BottomMargin = Sheets(nazov_listu).PageSetup.BottomMargin
 .HeaderMargin = Sheets(nazov_listu).PageSetup.HeaderMargin
 .FooterMargin = Sheets(nazov_listu).PageSetup.FooterMargin
 .PrintHeadings = Sheets(nazov_listu).PageSetup.PrintHeadings
 .PrintGridlines = Sheets(nazov_listu).PageSetup.PrintGridlines
 .PrintComments = Sheets(nazov_listu).PageSetup.PrintComments
 .CenterHorizontally = Sheets(nazov_listu).PageSetup.CenterHorizontally
 .CenterVertically = Sheets(nazov_listu).PageSetup.CenterVertically
 .Orientation = Sheets(nazov_listu).PageSetup.Orientation
 .Draft = Sheets(nazov_listu).PageSetup.Draft
 On Error Resume Next
 .PaperSize = Sheets(nazov_listu).PageSetup.PaperSize
 On Error GoTo 0
 .FirstPageNumber = Sheets(nazov_listu).PageSetup.FirstPageNumber
 .Order = Sheets(nazov_listu).PageSetup.Order
 .BlackAndWhite = Sheets(nazov_listu).PageSetup.BlackAndWhite
 .Zoom = Sheets(nazov_listu).PageSetup.Zoom
 .PrintErrors = Sheets(nazov_listu).PageSetup.PrintErrors
End With
'TLAC KONIEC

Sheets(nazov_listu + "_novySJ" + cislo_harku).Move
Sheets(nazov_listu + "_novySJ" + cislo_harku).Name = nazov_listu

End Sub

Attribute VB_Name = "mdl_nacitanie_ComboBoxov"
'Sub NACITANIE_CMB()
    'Sub FIRMY_nacitanie()
    'Sub OVEROVATELIA_nacitanie()
    'Sub PRISTROJE_nacitanie()
    'Sub Uradne_nacitanie()
    'Sub MERAL_nacitanie()
    'Sub VYHOTOVIL_nacitanie()


Dim i As Integer
Dim j As Integer

Sub NACITANIE_CMB()
    FIRMY_nacitanie
    PRISTROJE_nacitanie
    PrihlasovacieMeno_nacitanie
    HRANICE_nacitanie
    MERAL_nacitanie
    VYHOTOVIL_nacitanie
    OVEROVATELIA_nacitanie
End Sub

Sub FIRMY_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbFirmy.Clear
  
  i = 12
  j = 1         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbFirmy.AddItem .Cells(i, j)
    End If
  Loop

  If Sheets("exp_imp").Cells(2, 4) = "" Then Sheets("Vstup").cmbFirmy.Text = .Cells(13, j) Else _
  Sheets("Vstup").cmbFirmy.Text = Sheets("exp_imp").Cells(2, 4)
End With

End Sub


Sub PRISTROJE_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbPristroje.Clear
  
  i = 12
  j = 25         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbPristroje.AddItem .Cells(i, j)
    End If
  Loop

  If Sheets("exp_imp").Cells(1, 6) = "" Then Sheets("Vstup").cmbPristroje.Text = .Cells(13, j) Else _
  Sheets("Vstup").cmbPristroje.Text = Sheets("exp_imp").Cells(1, 6)

End With

End Sub

Sub PrihlasovacieMeno_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbGPSmeno.Clear
  
  i = 17         'Zaciatocny riadok -1
  j = 29         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbGPSmeno.AddItem .Cells(i, j)
    End If
  Loop
  
  If Sheets("exp_imp").Cells(2, 6) = "" Then Sheets("Vstup").cmbGPSmeno.Text = .Cells(18, j) Else _
  Sheets("Vstup").cmbGPSmeno.Text = Sheets("exp_imp").Cells(2, 6)
  
End With

End Sub


Sub HRANICE_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbHranice.Clear
  
  i = 12
  j = 27         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbHranice.AddItem .Cells(i, j)
    End If
  Loop

  If Sheets("exp_imp").Cells(3, 6) = "" Then Sheets("Vstup").cmbHranice.Text = .Cells(13, j) Else _
  Sheets("Vstup").cmbHranice.Text = Sheets("exp_imp").Cells(3, 6)

End With
End Sub


Sub MERAL_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbMeral.Clear
  
  i = 12
  j = 20         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbMeral.AddItem .Cells(i, j)
    End If
  Loop

  If Sheets("exp_imp").Cells(4, 6) = "" Then Sheets("Vstup").cmbMeral.Text = .Cells(13, j) Else _
  Sheets("Vstup").cmbMeral.Text = Sheets("exp_imp").Cells(4, 6)

End With

End Sub


Sub VYHOTOVIL_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbVyhotovil.Clear
  
  i = 12
  j = 22         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbVyhotovil.AddItem .Cells(i, j)
    End If
  Loop

  If Sheets("exp_imp").Cells(5, 6) = "" Then Sheets("Vstup").cmbVyhotovil.Text = .Cells(13, j) Else _
  Sheets("Vstup").cmbVyhotovil.Text = Sheets("exp_imp").Cells(5, 6)

End With

End Sub


Sub OVEROVATELIA_nacitanie()

With Sheets("Nastavenia")
  Sheets("Vstup").cmbOverovatel.Clear
  
  i = 12
  j = 18         'porovnavany stlpec
  Do
    i = i + 1
    If .Cells(i, j) = "" Then
        Exit Do
    Else
        Sheets("Vstup").cmbOverovatel.AddItem .Cells(i, j)
    End If
  Loop

  If Sheets("exp_imp").Cells(8, 8) = "" Then Sheets("Vstup").cmbOverovatel.Text = .Cells(13, j) Else _
  Sheets("Vstup").cmbOverovatel.Text = Sheets("exp_imp").Cells(8, 8)

End With

End Sub


Attribute VB_Name = "mdl_overenieIB"
Sub OverenieIB()
Dim pocet_riadkov As Integer
Dim aktivny_list As String

Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim a As Integer
Dim B As Integer


Dim Y03 As Double
Dim X03 As Double
Dim Y As Double
Dim X As Double
Dim d03 As Double
Dim d As Double
Dim pocet_d As Integer
Dim porovnavana_podmienka As Integer


pocet_riadkov = pocet_riadkov_List(ActiveSheet.Name)
aktivny_list = ActiveSheet.Name
porovnavana_podmienka = Cells(1, 7)
With Sheets("XML")
 .Visible = True
 .Select
 .UsedRange.Delete
 .Visible = False
 
 Sheets(aktivny_list).Select
    
 .Cells(1, 1) = 2
  
    Range("J4:W4").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
'    Selection.Interior.Pattern = xlNone
    Selection.Interior.ColorIndex = 15
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeTop).Weight = xlMedium
        

    Cells(4, 1).Select
    Cells(1, 22) = 0
  
 For i = 4 To pocet_riadkov
    If Cells(i, 1) = "x" Or Cells(i, 1) = "X" Then
      .Cells(.Cells(1, 1), 1).NumberFormat = Cells(i, 2).NumberFormat
      .Cells(.Cells(1, 1), 1) = Cells(i, 2)
      .Cells(.Cells(1, 1), 2).NumberFormat = Cells(i, 3).NumberFormat
      .Cells(.Cells(1, 1), 2) = Cells(i, 3)
      .Cells(.Cells(1, 1), 3).NumberFormat = Cells(i, 4).NumberFormat
      .Cells(.Cells(1, 1), 3) = Cells(i, 4)
      .Cells(.Cells(1, 1), 4).NumberFormat = Cells(i, 5).NumberFormat
      .Cells(.Cells(1, 1), 4) = Cells(i, 5)
      .Cells(.Cells(1, 1), 5).NumberFormat = Cells(i, 6).NumberFormat
      .Cells(.Cells(1, 1), 5) = Cells(i, 6)
      .Cells(.Cells(1, 1), 6).NumberFormat = Cells(i, 7).NumberFormat
      .Cells(.Cells(1, 1), 6) = Cells(i, 7)
      .Cells(.Cells(1, 1), 7) = i
      .Cells(1, 1) = .Cells(1, 1) + 1
      
    End If
      Cells(i, 7) = ""
    
 Next i
 
''vypocet dlzok
pocet_d = 4     'aby zacalo od stvrteho riadku davat
For i = 2 To .Cells(1, 1) - 2
  For j = i + 1 To .Cells(1, 1) - 1
     
    Cells(pocet_d, 10).NumberFormat = "@"
    Cells(pocet_d, 10) = .Cells(i, 1) & " - " & .Cells(j, 1)
    Cells(1, 22) = Cells(1, 22) + 1
    
    Y03_1 = .Cells(i, 2)
    X03_1 = .Cells(i, 3)
    Y_1 = .Cells(i, 4)
    X_1 = .Cells(i, 5)
    
    Y03_2 = .Cells(j, 2)
    X03_2 = .Cells(j, 3)
    Y_2 = .Cells(j, 4)
    X_2 = .Cells(j, 5)
    
    On Error GoTo Zle_desatinne_miesto
    d03 = (Y03_2 - Y03_1) * (Y03_2 - Y03_1) + (X03_2 - X03_1) * (X03_2 - X03_1)
    Sheets("exp_imp").Cells(5, 11) = d03
    d03 = Sheets("exp_imp").Cells(5, 10)
    Cells(pocet_d, 11).NumberFormat = "0.00"
    Cells(pocet_d, 11) = d03
    
    d = (Y_2 - Y_1) * (Y_2 - Y_1) + (X_2 - X_1) * (X_2 - X_1)
    Sheets("exp_imp").Cells(5, 11) = d
    d = Sheets("exp_imp").Cells(5, 10)
    Cells(pocet_d, 12).NumberFormat = "0.00"
    Cells(pocet_d, 12) = d
    
    Cells(pocet_d, 13).NumberFormat = "0.00"
    Cells(pocet_d, 13) = Abs(d - d03)
       
''vypocet dovolenych odchylok

'1
    Cells(pocet_d, 14).NumberFormat = "0.00"
    Cells(pocet_d, 14) = 0.14
          If Cells(pocet_d, 13) <= Cells(pocet_d, 14) Then _
                    Cells(pocet_d, 14).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 14).Interior.ColorIndex = 3
     If porovnavana_podmienka = 1 And Cells(pocet_d, 13) > Cells(pocet_d, 14) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'1 koniec
  
'2
    Cells(pocet_d, 15).NumberFormat = "0.00"
    Cells(pocet_d, 15) = 0.42 * ((d + 12) / (d + 20))
          If Cells(pocet_d, 13) <= Cells(pocet_d, 15) Then _
                    Cells(pocet_d, 15).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 15).Interior.ColorIndex = 3
     If porovnavana_podmienka = 2 And Cells(pocet_d, 13) > Cells(pocet_d, 15) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'2 koniec

'3
    Cells(pocet_d, 16).NumberFormat = "0.00"
    Cells(pocet_d, 16) = 0.78 * ((d + 12) / (d + 20))
          If Cells(pocet_d, 13) <= Cells(pocet_d, 16) Then _
                    Cells(pocet_d, 16).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 16).Interior.ColorIndex = 3
     If porovnavana_podmienka = 3 And Cells(pocet_d, 13) > Cells(pocet_d, 16) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'3 koniec
  
'4
    Cells(pocet_d, 17).NumberFormat = "0.00"
    Cells(pocet_d, 17) = 0.5 * ((d + 12) / (d + 20))
          If Cells(pocet_d, 13) <= Cells(pocet_d, 17) Then _
                    Cells(pocet_d, 17).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 17).Interior.ColorIndex = 3
     If porovnavana_podmienka = 4 And Cells(pocet_d, 13) > Cells(pocet_d, 17) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'4 koniec

'5
    Cells(pocet_d, 18).NumberFormat = "0.00"
    Cells(pocet_d, 18) = 0.55 * ((d + 12) / (d + 20))
          If Cells(pocet_d, 13) <= Cells(pocet_d, 18) Then _
                    Cells(pocet_d, 18).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 18).Interior.ColorIndex = 3
     If porovnavana_podmienka = 5 And Cells(pocet_d, 13) > Cells(pocet_d, 18) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'5 koniec

'6
    Cells(pocet_d, 19).NumberFormat = "0.00"
    Cells(pocet_d, 19) = 0.67 * ((d + 12) / (d + 20))
          If Cells(pocet_d, 13) <= Cells(pocet_d, 19) Then _
                    Cells(pocet_d, 19).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 19).Interior.ColorIndex = 3
     If porovnavana_podmienka = 6 And Cells(pocet_d, 13) > Cells(pocet_d, 19) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'6 koniec

'7
    Cells(pocet_d, 20).NumberFormat = "0.00"
    If Cells(pocet_d, 13) <= 50 Then Cells(pocet_d, 20) = 0.58 Else Cells(pocet_d, 20) = 0.68
    
          If Cells(pocet_d, 13) <= Cells(pocet_d, 20) Then _
                    Cells(pocet_d, 20).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 20).Interior.ColorIndex = 3
     If porovnavana_podmienka = 7 And Cells(pocet_d, 13) > Cells(pocet_d, 20) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'7 koniec

'8
    Cells(pocet_d, 21).NumberFormat = "0.00"
    If Cells(pocet_d, 13) <= 50 Then Cells(pocet_d, 21) = 0.67 Else Cells(pocet_d, 21) = 0.77
    
          If Cells(pocet_d, 13) <= Cells(pocet_d, 21) Then _
                    Cells(pocet_d, 21).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 21).Interior.ColorIndex = 3
     If porovnavana_podmienka = 8 And Cells(pocet_d, 13) > Cells(pocet_d, 21) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'8 koniec

'9
    Cells(pocet_d, 22).NumberFormat = "0.00"
    If Cells(pocet_d, 13) <= 50 Then Cells(pocet_d, 22) = 1.16 Else Cells(pocet_d, 22) = 1.26
    
          If Cells(pocet_d, 13) <= Cells(pocet_d, 22) Then _
                    Cells(pocet_d, 22).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 22).Interior.ColorIndex = 3
     If porovnavana_podmienka = 9 And Cells(pocet_d, 13) > Cells(pocet_d, 22) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'9 koniec

'10
    Cells(pocet_d, 23).NumberFormat = "0.00"
    If Cells(pocet_d, 13) <= 50 Then Cells(pocet_d, 23) = 1.26 Else Cells(pocet_d, 23) = 1.47
    
          If Cells(pocet_d, 13) <= Cells(pocet_d, 23) Then _
                    Cells(pocet_d, 23).Interior.ColorIndex = 6 Else _
                    Cells(pocet_d, 23).Interior.ColorIndex = 3
     If porovnavana_podmienka = 10 And Cells(pocet_d, 13) > Cells(pocet_d, 23) Then
        Cells(.Cells(i, 7), 7) = Cells(.Cells(i, 7), 7) + 1
        Cells(.Cells(j, 7), 7) = Cells(.Cells(j, 7), 7) + 1
     End If
'10 koniec


  
    pocet_d = pocet_d + 1
  Next j
Next i

End With

''ORAMOVANIE
    Range("J4:W4").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeTop).Weight = xlMedium
    Selection.Borders(xlEdgeLeft).LineStyle = xlContinuous
    Selection.Borders(xlEdgeLeft).Weight = xlMedium
    Selection.Borders(xlEdgeRight).LineStyle = xlContinuous
    Selection.Borders(xlEdgeRight).Weight = xlMedium
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).Weight = xlMedium
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).Weight = xlThin
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).Weight = xlThin
    

    Cells(4, 1).Select
''ORAMOVANIE koniec

Sheets(aktivny_list).Select

Exit Sub
Sheets(aktivny_list).Select

Zle_desatinne_miesto: MsgBox "Pou|fffd|it|fffd| zl|fffd| oddelova|fffd| desatinn|fffd|ch miest asi - m|fffd| by|fffd| |fffd|iarka"

End Sub

Attribute VB_Name = "mdl_pocet_riadkov_List"
'mdl_pocet_riadkov_List
'Function pocet_riadkov_List(nazov_listu As String) As Integer

Function pocet_riadkov_List(nazov_listu As String) As Integer
Dim pom_visible As String
On Error GoTo 1
With Sheets(nazov_listu)
    If .Visible = False Then pom_visible = "false" Else pom_visible = "true"
    If pom_visible = "false" Then .Visible = True
    .Select
    .UsedRange.Select
    pocet_riadkov_List = Selection.Rows.Count
    .Cells(1, 1).Select
    If pom_visible = "false" Then .Visible = False
End With

Exit Function
1: MsgBox "List " & nazov_listu & " neexistuje. Je potrebne mat takyto list v zosite"

End Function

Attribute VB_Name = "mdl_vlozit_riadok"
'Sub vlozit_riadok()
Sub Vlozit_riadok()
Dim i As Integer

If Cells(3, 8) = "Druh pozemku" And ActiveSheet.Name <> "VvC" Then

    Rows(ActiveCell.Row).Select
    Selection.Insert Shift:=xlDown
    i = ActiveCell.Row
    Range(Cells(i, 3), Cells(i, 4)).Select
    Selection.Merge
      Range(Cells(i, 6), Cells(i, 7)).Select
      Selection.Merge
    Range(Cells(i, 8), Cells(i, 10)).Select
    Selection.Merge
      Range(Cells(i, 11), Cells(i, 12)).Select
      Selection.Merge
    Range(Cells(i, 14), Cells(i, 15)).Select
    Selection.Merge
      Range(Cells(i, 16), Cells(i, 18)).Select
      Selection.Merge
    Range(Cells(i, 19), Cells(i, 21)).Select
    Selection.Merge
      Range(Cells(i, 22), Cells(i, 23)).Select
      Selection.Merge
    Range(Cells(i, 25), Cells(i, 26)).Select
    Selection.Merge
      Range(Cells(i, 27), Cells(i, 28)).Select
      Selection.Merge
    Cells(i, 1).Select
Else
    Rows(ActiveCell.Row).Select
    Selection.Insert Shift:=xlDown
    ActiveCell.Select
End If

End Sub


Attribute VB_Name = "mdl_vyber_prvku"
Function vyber_prvku(riadok As String, index_prvku As Integer, oddelovac As String) As String    'index_prvku = -1 - posledny prvok
Dim riadokN As String
Dim i As Integer
Dim pocet As Integer

riadokN = ""
pocet = 0
For i = 1 To Len(riadok)
 If Mid(riadok, i, 1) <> oddelovac Then riadokN = riadokN + Mid(riadok, i, 1)
 If Mid(riadok, i, 1) = oddelovac Then
  If (Len(riadokN) = 0) Or (Mid(riadok, i + 1, 1) = oddelovac) Or (Mid(riadok, i + 1, 1) = "") Then riadokN = riadokN Else riadokN = riadokN + Mid(riadok, i, 1)
 End If
Next i

riadok = riadokN
riadokN = ""

For i = 1 To Len(riadok) + 1
 If Mid(riadok, i, 1) <> oddelovac Then riadokN = riadokN + Mid(riadok, i, 1)
 If (Mid(riadok, i, 1) = oddelovac) Or (Mid(riadok, i, 1) = "") Then
  pocet = pocet + 1
  If index_prvku = pocet Then
   vyber_prvku = riadokN
  Else
   riadokN = ""
  End If
 End If
Next i
    
If index_prvku = -1 Then
 riadokN = ""
 index_prvku = pocet
 pocet = 0
    
 For i = 1 To Len(riadok) + 1
  If Mid(riadok, i, 1) <> oddelovac Then riadokN = riadokN + Mid(riadok, i, 1)
  If (Mid(riadok, i, 1) = oddelovac) Or (Mid(riadok, i, 1) = "") Then
   pocet = pocet + 1
   If index_prvku = pocet Then
    vyber_prvku = riadokN
   Else
    riadokN = ""
   End If
  End If
 Next i
     
End If
End Function


Attribute VB_Name = "mdl_zmena_formatu"
Sub Zmena_formatu1()
 Zmena_formatu 1
End Sub

Sub Zmena_formatu2()
 Zmena_formatu 2
End Sub

Sub Zmena_formatu3()
 Zmena_formatu 3
End Sub

Sub Zmena_formatu4()
 Zmena_formatu 4
End Sub

Sub Zmena_formatu5()
 Zmena_formatu 5
End Sub

Sub Zmena_formatu(pozadovany_format As Integer)
Dim TextStr As String
'   1 - vseobecne _
    2 - 4 miesta _
    3 - text _
    4 - cislo 0 des.miest _
    5 - datum
    
With ActiveCell
 TextStr = .Text
 If pozadovany_format = 1 Then .NumberFormat = "General"
 If pozadovany_format = 2 Then .NumberFormat = "0000"
 If pozadovany_format = 3 Then .NumberFormat = "@"
 If pozadovany_format = 4 Then .NumberFormat = "0"
 If pozadovany_format = 5 Then .Value = Upravit_Datum(TextStr)
 
 .Formula = .FormulaR1C1
 .Select
End With

End Sub


Function Upravit_Datum(VstupnyDatum As String) As String
Dim i As Integer
Dim bodkaDen As Integer
Dim bodkaMesiac As Integer
Dim den As String
Dim mesiac As String
Dim rok As String

den = ""
mesiac = ""
rok = ""

For i = 1 To Len(VstupnyDatum)
 If Mid(VstupnyDatum, i, 1) = "." Then
  If bodkaDen = 0 Then bodkaDen = i Else bodkaMesiac = i
 End If
Next i

den = ""
For i = 1 To bodkaDen - 1
 den = den & Mid(VstupnyDatum, i, 1)
Next i

mesiac = ""
For i = bodkaDen + 1 To bodkaMesiac - 1
 mesiac = mesiac & Mid(VstupnyDatum, i, 1)
Next i

rok = ""
For i = bodkaMesiac + 1 To Len(VstupnyDatum)
 rok = rok & Mid(VstupnyDatum, i, 1)
Next i

If Len(den) = 1 Then den = "0" & den
If Len(mesiac) = 1 Then mesiac = "0" & mesiac

Upravit_Datum = den & "." & mesiac & "." & rok
End Function






INQUEST-PP=macro
