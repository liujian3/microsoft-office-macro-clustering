Attribute VB_Name = "Frm01"
Attribute VB_Base = "0{F21A536D-8BC0-419F-8F32-720FDC81CAB5}{6EDF08E2-F102-4307-8FC2-EB7C5E28D44B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Attribute VB_Name = "Frm_Data"
Attribute VB_Base = "0{B767763F-059F-423F-9BA0-B39E5982A4D3}{9F52B26E-4F31-4131-B3A8-B17990540817}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Count_Data As Integer

'|fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub Com_NG_Click()
    Arr_CSV_Flg = False
    Unload Frm_Data
End Sub

'|fffd||752||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub Com_OK_Click()
    Dim i As Integer
    Dim j As Integer
    Dim Str_Day As String

    'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||14c82||fffd||fffd||fffd|
    If Count_Data = 0 Then
        Exit Sub
    End If

    '|fffd|z|fffd||50502||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y
    ReDim Arr_CSV(Count_Data - 1)
    ReDim Day_Num(Count_Data - 1)
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|i|fffd|[
    j = 0
    For i = 0 To List_Data.ListCount - 1
        If List_Data.Selected(i) = True Then
            Arr_CSV(j).F_Path = FolderPath & "\" & List_Data.List(i)
            Str_Day = Left(List_Data.List(i), Len_NM_YYYYMMDD)
            Str_Day = Mid(Str_Day, 1, 4) & "/" & Mid(Str_Day, 5, 2) & "/" & Mid(Str_Day, 7, 2)
            Arr_CSV(j).F_Day = CDate(Str_Day)
            Arr_CSV(j).Flg = False
            j = j + 1
        End If
    Next
    Arr_CSV_Flg = True
    Unload Frm_Data
End Sub

'******************************************************************************
' |fffd|@|fffd|\       : |fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd|I|fffd||fffd||fffd||fffd||fffd||251|I|fffd||10502||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : |fffd||64fe||fffd||fffd||fffd||fffd|l|fffd||12d02||fffd||fffd||103|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6c2||24c|x|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|A
'            : |fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2019/1/21   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Private Sub List_Data_Change()
    Count_Data = 0
    Dim i As Integer
    '|fffd|I|fffd||10503|J|fffd|E|fffd||fffd||fffd|g
    For i = 0 To Frm_Data.List_Data.ListCount - 1
        If Frm_Data.List_Data.Selected(i) Then
            Count_Data = Count_Data + 1
        End If
    Next
    '|fffd||fffd||fffd||fffd||12d02||fffd||fffd||102||fffd||fffd||fffd||fffd||a347|
    If Count_Data > Max_CSVFile_Count Then
        MsgBox "|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||12d02||fffd||fffd||702||fffd||fffd||fffd|"
        List_Data.Selected(List_Data.ListIndex) = False
    End If

End Sub

'******************************************************************************
' |fffd|@|fffd|\       : |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2019/1/21   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Private Sub UserForm_Initialize()
    Dim Str_File As String
    Dim Count As Integer

    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    List_Data.Clear
    Str_File = Dir(FolderPath & "\" & "*.csv")
    Count = 0
    Do While Str_File <> ""
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||243|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c9||fffd|
        Frm_Data.List_Data.AddItem Str_File
        Count = Count + 1
        Str_File = Dir()
    Loop
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Com_Exit, 5, 0, MSForms, CommandButton"
Attribute VB_Control = "Com_SaveSheets, 4, 1, MSForms, CommandButton"
Attribute VB_Control = "Com_SetData, 3, 2, MSForms, CommandButton"
Option Explicit
'******************************************************************************
' |fffd|@|fffd|\       : |fffd|I|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/5   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Private Sub Com_Exit_Click()
    If 6 <> MsgBox("|fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & "|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion) Then
        Exit Sub
    End If
    ThisWorkbook.Saved = True
    '|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
    Application.Quit
    '|fffd|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd|
    ThisWorkbook.Close
End Sub


'******************************************************************************
' |fffd|@|fffd|\       : |fffd|V|fffd|[|fffd|g|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/10  |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Private Sub Com_SaveSheets_Click()
    Call Output_Sheet(Sh_Main)
End Sub


'******************************************************************************
' |fffd|@|fffd|\       : |fffd|f|fffd|[|fffd|^|fffd||1cd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/5   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Private Sub Com_SetData_Click()
    '|fffd||fffd||28d|X|fffd|V|fffd||fffd||fffd|~|fffd||7c2||fffd|
    Application.ScreenUpdating = False
    '|fffd|f|fffd|[|fffd|^|fffd||1cd||fffd||fffd||74f||fffd||fffd||fffd||fffd|J|fffd|n
    Call Main
    '|fffd||fffd||28d|X|fffd|V|fffd||fffd||fffd||10a|J|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
'******************************************************************************
' |fffd|@|fffd|\       : |fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/5   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Private Sub Workbook_Open()
    Set Sh_Main = ThisWorkbook.Worksheets(ShN_main)

    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
    Sh_Main.Protect userinterfaceonly:=True

    '|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
    Call Sheet_Clear
End Sub
Attribute VB_Name = "|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd||fffd|E|fffd||8414||fffd||a5d7|"
Option Explicit
'--------------------|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||8414|--------------------'
''|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|p|fffd|X
'Public Const Path_ZIP As String = "\temporarily\ZIP"    'tmp|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||243||fffd||fffd|l|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|p|fffd|X
'Public Const Path_CSV As String = "\temporarily\CSV"    'zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||13002||fffd||fffd||fffd|p|fffd|X
'Public Const Path_UnZip As String = "\tool\UnZip.bat"   'zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||13002||fffd||fffd||fffd|bat|fffd|t|fffd|@|fffd|C|fffd||fffd|

Public Const Max_CSVFile_Count As Integer = 7       '|fffd|I|fffd||fffd||fffd||94|\|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f||fffd||fffd|

'|fffd|V|fffd|[|fffd|g|fffd||fffd|
Public Const ShN_main As String = "|fffd||fffd||fffd|C|fffd||fffd|"

'|fffd|Z|fffd||fffd||fffd||752||fffd||fffd||fffd|
Public Const CY_Time_Whet As Integer = 3            'Y|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd|
Public Const CX_Time_Whet As Integer = 6            'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd|
Public Const CY_Start As Integer = 5                'Y|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|o|fffd||fffd|
Public Const CX_Start As Integer = 2                'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|o|fffd||fffd|
Public Const CX_StrDay As Integer = 2               'X|fffd||fffd||fffd|W_|fffd||fffd||fffd|t
Public Const CX_StrTime As Integer = 3              'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd|
Public Const CX_NM_DENKI As Integer = 4             'X|fffd||fffd||fffd|W_|fffd|d|fffd|C|fffd||fffd|
Public Const CX_NM_SENRO As Integer = 5             'X|fffd||fffd||fffd|W_|fffd||fffd||fffd|H|fffd|@|fffd||d5bc|
Public Const CX_KIKI As Integer = 6                 'X|fffd||fffd||fffd|W_|fffd|@|fffd||d5bc||fffd||fffd|
Public Const CX_DOUSA As Integer = 7                'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Const CX_KUBUN As Integer = 8                'X|fffd||fffd||fffd|W_|fffd|\|fffd||fffd||fffd||656a|

'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||24a||582||fffd||fffd||fffd||752||fffd|
Public Const Len_NM_YYYYMMDD As Integer = 8         'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||302||24b|L|fffd||682||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||303|T|fffd|C|fffd|Y
Public Const Get_Data_Count As Integer = 9          'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|v|fffd|f|fffd||310||fffd|
'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||752||fffd||fffd||fffd|(|fffd||64fe||fffd||38f||6c2||303|Z|fffd||fffd||fffd||fffd||fffd|W)|fffd||fffd||fffd||fffd|"-1"|fffd||fffd||fffd||fffd||fffd|l
Public Const CX_CSV_datetime As Integer = 0         'X|fffd||fffd||fffd|W_|fffd||fffd||fffd|t
Public Const CX_CSV_dt As Integer = 2               'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd|
Public Const CX_CSV_ms As Integer = 3               'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd|(|fffd|~|fffd||fffd||fffd|b)
Public Const CX_CSV_nm_ss As Integer = 4            'X|fffd||fffd||fffd|W_|fffd|d|fffd|C|fffd||fffd|
Public Const CX_CSV_nm_lnkk As Integer = 6          'X|fffd||fffd||fffd|W_|fffd||fffd||fffd|H|fffd|@|fffd||d5bc|
Public Const CX_CSV_nm_kk As Integer = 9            'X|fffd||fffd||fffd|W_|fffd|@|fffd||d5bc||fffd||fffd|
Public Const CX_CSV_nm_dir As Integer = 11          'X|fffd||fffd||fffd|W_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Const CX_CSV_ct As Integer = 63              'X|fffd||fffd||fffd|W_|fffd|\|fffd||fffd||fffd||656a|_1
Public Const CX_CSV_tp_msg As Integer = 64          'X|fffd||fffd||fffd|W_|fffd|\|fffd||fffd||fffd||656a|_2


'--------------------|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd|--------------------'
Public Sh_Main As Worksheet         '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|_|fffd||fffd||fffd|C|fffd||fffd||fffd|V|fffd|[|fffd|g
Public StartDay As Date             '|fffd||fffd||fffd||fffd|_|fffd|J|fffd|n|fffd||fffd|
Public EndDay As Date               '|fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd||fffd||fffd|

Public FolderPath As String         '|fffd|Q|fffd||182||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|p|fffd|X

Public Arr_CSV_Flg As Boolean       'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14ed2|f
Public Day_Num() As Integer         'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||313||fffd||fffd|t|fffd||fffd||fffd|||fffd|C|fffd||fffd||fffd|^|fffd||fffd||fffd|i|fffd|[
Public Arr_CSV() As Arr             'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
Public Type Arr
    F_Path As String        '|fffd||64fe||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd||fffd||fffd|p|fffd|X
    F_Day As Date           '|fffd|i|fffd|[|fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||313||fffd||fffd|t
    F_Data() As String      '|fffd|i|fffd|[|fffd||fffd||fffd||fffd|f|fffd|[|fffd|^
    Flg As Boolean          '|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||93c7||fffd||502||fffd||fffd|i|fffd|[
End Type
Attribute VB_Name = "|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|"
Option Explicit
'******************************************************************************
' |fffd|@|fffd|\       : |fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||3cd|X
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd||14f|I|fffd|s
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : |fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||251||382||fffd||fffd||103|t|fffd|H|fffd||fffd||fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Sub ChgFontColor(ByVal CY_End As Long)
    Dim i As Long
    i = 0
    Do While i <= CY_End
        Select Case Sh_Main.Cells(CY_Start + i, CX_KUBUN).Value
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                '|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||fffd||502||242||fffd||fffd||fffd|
                Sh_Main.Cells(CY_Start + i, CX_KUBUN).Font.ColorIndex = 3
        End Select
    i = i + 1
    Loop
End Sub

'******************************************************************************
' |fffd|@|fffd|\       : |fffd|V|fffd|[|fffd|g|fffd||6d1||fffd||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd||38f||6c3|V|fffd|[|fffd|g
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/10  |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Sub Output_Sheet(ByRef ShOBJ As Worksheet)
    Dim MyPath As String            '|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|p|fffd|X
    Dim strBook As String           '|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|p|fffd|X|fffd||183|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||302||fffd||fffd|i|fffd|[
    Dim SaveBookName As String      '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||302||fffd||fffd|i|fffd|[
    Dim SaveBook As Workbook        '|fffd||6d1||fffd||fffd||fffd||303|u|fffd|b|fffd|N
    Dim SaveSheet As Worksheet      '|fffd||6d1||fffd||fffd||fffd||303|V|fffd|[|fffd|g
    Dim BookModule As VBComponent   '|fffd||d3dc||fffd||fffd||fffd||fffd|VB|fffd|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g
    Dim DelCode As CodeModule       '|fffd||d3dc||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||38f||fffd|
    Dim DelOBJ As Shape             '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||d3dc||fffd|p

    '|fffd||fffd||28d|X|fffd|V|fffd|I|fffd|t
    Application.ScreenUpdating = False
    If ShOBJ.Cells(CY_Start, CX_Start) = "" Then
        MsgBox "|fffd|f|fffd|[|fffd|^|fffd||1cd||fffd||fffd||74c||fffd||255||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Exit Sub
    End If
    MyPath = ThisWorkbook.Path & "\"
    '|fffd||6d1||fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    SaveBookName = Format(Now, "YYYYMMDDHHMM") & "SV|fffd||fffd||3c3||fffd||fffd|O"
    strBook = Application.GetSaveAsFilename(MyPath & SaveBookName, "EXCEL|fffd|u|fffd|b|fffd|N(*.xlsx),*.xlsx", 1, "|fffd|V|fffd|[|fffd|g|fffd||315||6d1||fffd|")
    If strBook = "False" Then
        Exit Sub
    End If

    ShOBJ.Copy
    Set SaveBook = ActiveWorkbook
    Set SaveSheet = SaveBook.Worksheets(1)

    '|fffd|V|fffd|[|fffd|g|fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd|S|fffd||d3dc|
    For Each DelOBJ In SaveSheet.Shapes
        DelOBJ.Delete
    Next

    '|fffd|V|fffd|[|fffd|g|fffd||303|}|fffd|N|fffd||fffd||fffd||d3dc|
    For Each BookModule In SaveBook.VBProject.VBComponents
        Set DelCode = BookModule.CodeModule
        DelCode.DeleteLines 1, DelCode.CountOfLines
    Next

    SaveSheet.Name = SaveBookName
    '|fffd|x|fffd||fffd||fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    Application.DisplayAlerts = False
    SaveBook.SaveAs Filename:=strBook
    SaveBook.Saved = True
    SaveBook.Close
    '|fffd|x|fffd||fffd||fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
    Application.DisplayAlerts = True
    '|fffd||fffd||28d|X|fffd|V|fffd|I|fffd||fffd|
    Application.ScreenUpdating = True
    Set SaveBook = Nothing
    Set SaveSheet = Nothing
    MsgBox "|fffd|V|fffd|[|fffd|g|fffd||6d1||fffd||fffd||fffd||fffd||fffd|"
End Sub
Attribute VB_Name = "|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|"
Option Explicit
'******************************************************************************
' |fffd|@|fffd|\       : |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|H
' |fffd||502||fffd|l     : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd|o|fffd||357|p|fffd|z|fffd||fffd|,CSV|fffd|f|fffd|[|fffd|^
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : CSV|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|o|fffd||357|p|fffd|z|fffd||fffd||24a|i|fffd|[|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd|l       : |fffd|e|fffd||fffd||fffd|[|fffd||fffd|(|fffd|@|fffd|\)|fffd||fffd||fffd||255||48f|W|fffd||fffd||fffd||fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function MakeData(ByRef ArrData() As String, ByRef ArrCSV() As Arr) As Boolean
    Dim i As Long
    Dim j As Long
    Dim s As Long
    Dim Sum_Y As Long
    Dim str As String       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||24a|i|fffd|[
    Dim str2 As String      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||24a|i|fffd|[
    Dim Str_Num As Integer  '|fffd||38f||6d5||fffd||fffd||fffd||fffd||30d||fffd||fffd|W|fffd||fffd||fffd||a39e||fffd|I|fffd||24a|i|fffd|[

    On Error GoTo MyError

    Sum_Y = 0
    s = 0

    '|fffd|s|fffd||fffd||fffd||fffd||3ca||fffd||fffd||fffd||fffd||fffd|
    For i = 0 To UBound(ArrCSV)
        'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||14f|I|fffd|A|fffd|h|fffd||fffd||fffd|X|fffd||312|l|fffd||34e|g|fffd|p|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|
        Sum_Y = Sum_Y + UBound(ArrCSV(i).F_Data, 2) - 1
    Next
    '|fffd|V|fffd|[|fffd|g|fffd||30d||14f|I|fffd|s|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||14c82||fffd||fffd||fffd|
    If Rows.Count < Sum_Y + CY_Start Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||50ab||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & "|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||70b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
    End If
    ReDim ArrData(Sum_Y, UBound(ArrCSV(0).F_Data, 1))

    For i = 0 To UBound(ArrCSV)
        j = 0
        Do While j < UBound(ArrCSV(Day_Num(i)).F_Data, 2) - 1
            '|fffd||fffd||fffd|t
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_datetime), j + 1)
            Str_Num = InStrRev(str, " ")
            str = Replace(Left(str, Str_Num - 1), "-", "/")
            ArrData(s, CX_StrDay - CX_Start) = str
            If StartDay > CDate(str) Then
                StartDay = CDate(str)
            End If
            If EndDay < CDate(str) Then
                EndDay = CDate(str)
            End If

            '|fffd||fffd||fffd||fffd|
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_dt), j + 1)
            str2 = "00" & ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_ms), j + 1)
            Str_Num = InStrRev(str, " ")
            ArrData(s, CX_StrTime - CX_Start) = Mid(str, Str_Num + 1) & "." & Right(str2, 2)

            '|fffd|d|fffd|C|fffd||fffd|
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_nm_ss), j + 1)
            ArrData(s, CX_NM_DENKI - CX_Start) = str

            '|fffd||fffd||fffd|H|fffd|@|fffd||d5bc|
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_nm_lnkk), j + 1)
            ArrData(s, CX_NM_SENRO - CX_Start) = str

            '|fffd|@|fffd||d5bc||fffd||fffd|
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_nm_kk), j + 1)
            ArrData(s, CX_KIKI - CX_Start) = str

            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_nm_dir), j + 1)
            ArrData(s, CX_DOUSA - CX_Start) = str

            '|fffd|\|fffd||fffd||fffd||656a|
            str = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_ct), j + 1)
            str2 = ArrCSV(Day_Num(i)).F_Data(SearchPoint(ArrCSV(Day_Num(i)).F_Data, 1, CX_CSV_tp_msg), j + 1)
            ArrData(s, CX_KUBUN - CX_Start) = SelectKUBUN(CInt(str), CInt(str2))
            j = j + 1
            s = s + 1
        Loop
    Next

    MakeData = True
    Exit Function
MyError:
    MakeData = False
End Function

'******************************************************************************
' |fffd|@|fffd|\       : |fffd|i|fffd|[|fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     : |fffd|i|fffd|[|fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|l
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd||38f||6d4|z|fffd||fffd|,|fffd||38f||6ce||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||30f||a347||fffd||fffd||fffd|l|fffd||fffd|),|fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|f|fffd||fffd||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : CSV|fffd|i|fffd|[|fffd|z|fffd||fffd||fffd||fffd|A|fffd|v|fffd|f|fffd||fffd||fffd||1c2||303|A|fffd|h|fffd||fffd||fffd|X|fffd|l|fffd||24a|i|fffd|[|fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||14ed2|f|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function SearchPoint(ByRef Arr() As String, ByVal Adj As Integer, ByVal Target As Integer) As Integer
    Dim i As Integer
    Dim Num As Integer
    For i = 0 To UBound(Arr, Adj)
        If Arr(i, 0) = Target Then
            Num = i
            Exit For
        End If
    Next
    SearchPoint = Num
End Function

'******************************************************************************
' |fffd|@|fffd|\       : |fffd|\|fffd||fffd||fffd||656a|
' |fffd||502||fffd|l     : |fffd|\|fffd||fffd||fffd||fffd||fffd|e
' |fffd||fffd||fffd||fffd||fffd||fffd|     : CT,TP_MSG
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : CSV|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||656a||fffd||fffd||fffd||7c2||fffd|
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function SelectKUBUN(ByVal CT As Integer, ByVal TP_MSG As Integer) As String
    Dim str As String
    str = ""
    Select Case CT
        Case 1
            If TP_MSG = 1 Then
                str = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            ElseIf TP_MSG = 2 Then
                str = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            End If
        Case 2
            If TP_MSG = 1 Then
                str = "|fffd||fffd||fffd||30f||fffd||fffd|"
            ElseIf TP_MSG = 2 Then
                str = "|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            End If
        Case 4
            If TP_MSG = 16 Then
                str = "FCB|fffd|x|fffd|~"
            ElseIf TP_MSG = 32 Then
                str = "SV|3fd||fffd|(|fffd||95||fffd|)"
            ElseIf TP_MSG = 64 Then
                str = "SV|3fd||fffd|(|fffd||a287|)"
            ElseIf TP_MSG = 128 Then
                str = "|fffd||fffd||fffd||fffd||fffd||752||fffd|(|fffd||95||fffd|)"
            ElseIf TP_MSG = 256 Then
                str = "|fffd||fffd||fffd||fffd||fffd||752||fffd|(|fffd||a287|)"
            End If
    End Select
    SelectKUBUN = str
End Function


'******************************************************************************
' |fffd|@|fffd|\       : |fffd||fffd||fffd|t|fffd|\|fffd|[|fffd|g
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd||38f||6cd|\|fffd||fffd||fffd||314|z|fffd||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : |fffd|\|fffd||fffd||fffd||314|z|fffd||fffd||302||1c2||303|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd|o|fffd||357|p|fffd|z|fffd||fffd||24a|i|fffd|[|fffd||fffd||fffd||90a9||fffd||fffd||fffd|w|fffd||80b7||fffd||fffd|
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2019/1/21   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Sub Sort_Arr(ByRef Arr_CSV() As Arr)
    Dim Min_Date As Date
    Dim Num As Integer
    Dim i As Integer
    Dim j As Integer

    For i = 0 To UBound(Arr_CSV)
        Min_Date = "9999/12/31"
        For j = 0 To UBound(Arr_CSV)
            If Arr_CSV(j).F_Day < Min_Date And Arr_CSV(j).Flg = False Then
                Min_Date = Arr_CSV(j).F_Day
                Num = j
            End If
        Next
        Day_Num(i) = Num
        Arr_CSV(Num).Flg = True
    Next
End Sub

Attribute VB_Name = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|"
Option Explicit
Private ColCount As Integer    'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|J|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|

'******************************************************************************
' |fffd|@|fffd|\       : |fffd||64fe||fffd||38f||6c2||fffd||fffd|w|fffd||fffd|
' |fffd||502||fffd|l     : |fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/5   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function Select_File() As String
    Dim F_nm As String
    
    ChDrive "C"
    ChDir "C:\"
    F_nm = Application.GetOpenFilename("|fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd|,*.*")
'    F_nm = Application.GetOpenFilename("CSV|fffd|t|fffd|@|fffd|C|fffd||fffd|,*.csv,ZIP|fffd|t|fffd|@|fffd|C|fffd||fffd|,*.zip")
'    F_nm = Application.GetOpenFilename("TMP|fffd|t|fffd|@|fffd|C|fffd||fffd|,*.tmp")
    If F_nm <> "False" Then
        Select_File = F_nm
    Else
        F_nm = ""
    End If
End Function


'******************************************************************************
' |fffd|@|fffd|\       : |fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2019/1/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function Delete_Folder() As Boolean
    Dim Del_Path As String
    Dim Del_Folder As Object
    On Error GoTo MyError
    'ZIP|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||d3dc|
    Del_Path = ThisWorkbook.Path & Path_ZIP & "\*.zip"
    If Dir(Del_Path) <> "" Then
        Kill Del_Path
    End If
    'CSV|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||d3dc|
    Del_Path = ThisWorkbook.Path & Path_CSV & "\*"
    If Dir(Del_Path, vbDirectory) <> "" Then
        Set Del_Folder = CreateObject("Scripting.FileSystemObject")
        Del_Folder.deletefolder Del_Path
        Set Del_Folder = Nothing
    End If
    
    Delete_Folder = True
    Exit Function
MyError:
    Delete_Folder = False
End Function


'******************************************************************************
' |fffd|@|fffd|\       : |fffd||64fe||fffd||38f||6c2||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|A|fffd||13002||fffd||fffd||fffd|
' |fffd||502||fffd|l     : |fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X(|fffd||1300c||fffd|)
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X(|fffd||13011|O)
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2019/1/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function UnZip_File(ByVal FPath As String) As String
    Dim F_Len As Integer    '|fffd|p|fffd|X|fffd||315||fffd||fffd||fffd||fffd||fffd|
    Dim F_ReNM As String    '|fffd||fffd||fffd|l|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|
    Dim F_ZIP_NM As String  'ZIP|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim F_CSV As String     'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||350||fffd|
    Dim ShellObj As Object  'bat|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|s|fffd|p|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Dim Close_Str As String '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|p|fffd|X
    Dim Close_Obj As Object '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|I|fffd||fffd||fffd|p|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Dim F_Obj As Object     '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|I|fffd||fffd||fffd|p|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g

    On Error GoTo MyError
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd|g|fffd||fffd||fffd|q|fffd||fffd||fffd||fffd|)|fffd||302||74e||64fe|
    F_Len = InStrRev(FPath, "\")
    F_ReNM = Mid(FPath, F_Len + 1)
    '|fffd|g|fffd||fffd||fffd|q".tmp"|fffd||fffd||fffd||202||fffd|
    F_Len = InStrRev(F_ReNM, ".zip")
    F_ReNM = Left(F_ReNM, F_Len - 1)
    '|fffd|o|fffd||350||fffd|p|fffd|X|fffd||fffd||fffd|w|fffd||fffd|
    F_ZIP_NM = ThisWorkbook.Path & Path_ZIP & "\" & F_ReNM & ".zip"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[
    FileCopy FPath, F_ZIP_NM

    'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|w|fffd||fffd|
    F_CSV = ThisWorkbook.Path & Path_CSV

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||13002||fffd||fffd||fffd|
    Set ShellObj = CreateObject("WScript.Shell")
    '|fffd||fffd||fffd|s|fffd||38f||fffd|bat|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|1(|fffd||13011||38f||fffd|),|fffd||fffd||fffd||fffd|2(|fffd||13010||fffd|t|fffd|H|fffd||fffd||fffd|_), |fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd|\|fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h
    ShellObj.Run ThisWorkbook.Path & Path_UnZip & " " & F_ZIP_NM & " " & F_CSV, 0, True

    '|fffd|J|fffd||fffd||fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||82||fffd||fffd||fffd|
    Set Close_Obj = CreateObject("Shell.Application")
    '|fffd||38f||6c2||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe|
    Close_Str = F_CSV & "\" & F_ReNM
    Close_Str = Replace(Close_Str, "\", "/")
    For Each F_Obj In Close_Obj.Windows
        If InStr(F_Obj.locationURL, Close_Str) > 0 Then
            '|fffd||38f||6c3|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||30f||a347||fffd|A
            F_Obj.Quit
            Exit For
        End If
    Next

    UnZip_File = F_CSV & "\" & F_ReNM & "\" & F_ReNM & ".csv"
    Set ShellObj = Nothing
    Exit Function
MyError:
    Set ShellObj = Nothing
    UnZip_File = ""
End Function


'******************************************************************************
' |fffd|@|fffd|\       : CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
' |fffd||502||fffd|l     : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X,|fffd|i|fffd|[|fffd||fffd|z|fffd||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Function GetFileData(ByVal FPath As String, ByRef Arr() As String) As Boolean
    Dim File_No As Integer
    Dim i As Long
    Dim j As Long
    Dim str As String
    Dim arr1() As String    '|fffd||fffd||fffd|s|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||243|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    Dim arr2() As String    '|fffd||fffd||602||8576||fffd||fffd||fffd||fffd||fffd||243|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|(",")

    On Error GoTo MyError
    j = 0
    File_No = FreeFile()                            '|fffd|t|fffd||fffd||fffd|[|fffd|t|fffd|@|fffd|C|fffd||fffd|No|fffd||fffd||fffd||64fe|
    Open FPath For Input Access Read As #File_No    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74e||fffd||fffd||fffd|p|fffd||14a|J|fffd||fffd|
    Do Until EOF(File_No)                           'CSV|fffd||30d||14c||fffd||702||143||fffd||fffd|[|fffd|v
        Line Input #File_No, str                    '1|fffd|s|fffd||1cd||fffd||fffd||fffd|
        arr1 = Split(str, vbLf)                     '|fffd||fffd||fffd|s|fffd|R|fffd|[|fffd|h|fffd||243|f|fffd|[|fffd|^|fffd||fffd||fffd|i|fffd|[
        For i = 0 To UBound(arr1)                   '|fffd||14f|I|fffd|s|fffd||341|u|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|v|fffd||fffd||fffd|L|fffd||682||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7ce||64fe||fffd||fffd||fffd||202||fffd|
            arr2 = Split(arr1(i), ",")              '|fffd||fffd||602||8576||fffd||fffd||fffd||fffd||fffd||243|f|fffd|[|fffd|^|fffd||fffd||fffd|i|fffd|[
            Call SetArrData(Arr, arr2, j)
            j = j + 1
        Next
    Loop
    Close #File_No                          '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    GetFileData = True
    Exit Function
MyError:
    GetFileData = False
End Function


'******************************************************************************
' |fffd|@|fffd|\       : |fffd|f|fffd|[|fffd|^|fffd|d|fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     : |fffd|i|fffd|[|fffd||fffd|,CSV|fffd|f|fffd|[|fffd|^,|fffd|z|fffd||fffd||303|A|fffd|h|fffd||fffd||fffd|X|fffd|l
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   : CSV|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|","|fffd||fffd||fffd||255||fffd||fffd||fffd||fffd||10a|i|fffd|[|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd|l       : |fffd|e|fffd||fffd||fffd|[|fffd||fffd|(|fffd|@|fffd|\)|fffd||fffd||fffd||255||48f|W|fffd||fffd||fffd||fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/8   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Sub SetArrData(ByRef Arr() As String, ByRef Data() As String, ByVal j As Long)
    Dim n As Integer
    If j = 0 Then
        '|fffd||fffd||fffd||4f217||fffd|
        ReDim Preserve Arr(Get_Data_Count - 1, j)
        Arr(0, j) = CX_CSV_datetime
        Arr(1, j) = CX_CSV_dt
        Arr(2, j) = CX_CSV_ms
        Arr(3, j) = CX_CSV_nm_ss
        Arr(4, j) = CX_CSV_nm_lnkk
        Arr(5, j) = CX_CSV_nm_kk
        Arr(6, j) = CX_CSV_nm_dir
        Arr(7, j) = CX_CSV_ct
        Arr(8, j) = CX_CSV_tp_msg
        ColCount = UBound(Data)     'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|J|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    Else
        '|fffd||64fe||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^(1|fffd|s)|fffd||317|v|fffd|f|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
        If ColCount = UBound(Data) Then
            ReDim Preserve Arr(Get_Data_Count - 1, j)
            For n = 0 To Get_Data_Count - 1
                Arr(n, j) = Data(Arr(n, 0))
            Next
        End If
    End If
End Sub











Attribute VB_Name = "|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|"
Option Explicit
'******************************************************************************
' |fffd|@|fffd|\       : |fffd||fffd||fffd|[|fffd||c42c||fffd||fffd||fffd|C|fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/5   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Sub Main()
    Dim ArrData() As String     '|fffd|o|fffd||357|p|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
    Dim i As Integer            '|fffd||fffd||fffd|[|fffd|v|fffd||3d0||fffd|

    '|fffd||fffd||fffd||502||30f||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|b|fffd|g
    StartDay = "9999/12/31"
    EndDay = "1001/01/01"


    '|fffd||64fe||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|w|fffd||fffd|
    With Application.FileDialog(msoFileDialogFolderPicker)
        .InitialFileName = ThisWorkbook.Path & "\"
        If .Show = True Then
            FolderPath = .SelectedItems(1)
        Else
            Exit Sub
        End If
    End With
    Frm_Data.Show

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||14c82||fffd||fffd||fffd|
    If Arr_CSV_Flg = False Then
        Exit Sub
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
    Frm01.Show vbModeless

    '|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
    Call Sheet_Clear

    For i = 0 To UBound(Arr_CSV)
        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
        If GetFileData(Arr_CSV(i).F_Path, Arr_CSV(i).F_Data) = False Then
            MsgBox "CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd|"
            Exit Sub
        End If
    Next

    '|fffd||fffd||fffd|t|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||243|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
    Call Sort_Arr(Arr_CSV)

    '|fffd|o|fffd||357|p|fffd||314|z|fffd||fffd||24a|i|fffd|[|fffd||fffd||fffd||fffd|
    If MakeData(ArrData, Arr_CSV) = False Then
        MsgBox "|fffd|f|fffd|[|fffd|^|fffd||310||fffd||fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd|"
        Exit Sub
    End If

    '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||24f|o|fffd||fffd|
    Sh_Main.Range(Sh_Main.Cells(CY_Start, CX_Start), _
                  Sh_Main.Cells(CY_Start + UBound(ArrData, 1), CX_Start + UBound(ArrData, 2)) _
                 ) = ArrData

    '|fffd||fffd||fffd||502||fffd||fffd|Z|fffd|b|fffd|g
    Sh_Main.Cells(CY_Time_Whet, CX_Time_Whet).Value = Format(StartDay, "YYYY/MM/DD") & " |fffd|` " & Format(EndDay, "YYYY/MM/DD")

    '|fffd||fffd||fffd||fffd||fffd||303|R|fffd|s|fffd|[
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(CY_Start, CX_KUBUN)).Copy
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), _
                  Cells(CY_Start + UBound(ArrData, 1) - 1, CX_KUBUN) _
                  ).PasteSpecial xlFormats
    Application.CutCopyMode = False
    Sh_Main.Cells(1, 1).Select

    '|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||3cd|X
    Call ChgFontColor(UBound(ArrData, 1))

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    Unload Frm01
End Sub


'******************************************************************************
' |fffd|@|fffd|\       : |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||502||fffd|l     :
' |fffd||fffd||fffd||fffd||fffd||fffd|     :
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd|   :
' |fffd||fffd||fffd|l       :
' |fffd||c42c||fffd||fffd||fffd|@   : 2018/12/5   |fffd||c42c||fffd||fffd|:|fffd||fffd|J
' |fffd|C|fffd||fffd||fffd||fffd||fffd|@   :             |fffd|C|fffd||fffd||fffd||fffd|:                |fffd||3cd|X|fffd||fffd||fffd|R:
'******************************************************************************
Sub Sheet_Clear()
Set Sh_Main = ThisWorkbook.Worksheets(ShN_main)
    Dim str As String
    '|fffd||fffd||fffd||502||30f||fffd||fffd||fffd||fffd||fffd|
    Sh_Main.Range(Cells(CY_Time_Whet, CX_Time_Whet), Cells(CY_Time_Whet, CX_Time_Whet + 1)).ClearContents
    '|fffd|f|fffd|[|fffd|^|fffd||30d||d3dc|
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(Rows.Count, CX_KUBUN)).Clear
    '|fffd|o|fffd||350||fffd|Z|fffd||fffd||fffd||303|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||782||fffd||fffd|l|fffd|r|fffd|S|fffd|V|fffd|b|fffd|N|fffd||255||3cd|X
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(CY_Start, CX_KUBUN)).Font.Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
    '|fffd|r|fffd||fffd||fffd||30d||c42c|
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(CY_Start, CX_KUBUN)).Borders.LineStyle = xlContinuous
    '|fffd||fffd||fffd|t|fffd||303|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||fffd|w|fffd||fffd|(YYYY/MM/DD)
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(CY_Start, CX_StrDay)).NumberFormatLocal = "yyyy/mm/dd"
    '|fffd||fffd||fffd|t|fffd||12189||fffd||fffd||fffd||fffd||fffd|
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(CY_Start, CX_StrDay)).HorizontalAlignment = xlCenter
    '|fffd||fffd||fffd||fffd||fffd|`|fffd|\|fffd||fffd||fffd||656a||fffd||303|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||fffd|w|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|)
    Sh_Main.Range(Cells(CY_Start, CX_StrTime), Cells(CY_Start, CX_KUBUN)).NumberFormatLocal = "@"
    '|fffd||fffd||fffd||fffd||fffd|`|fffd|\|fffd||fffd||fffd||656a||fffd||12189||fffd||fffd||fffd||fffd||fffd|
    Sh_Main.Range(Cells(CY_Start, CX_StrTime), Cells(CY_Start, CX_KUBUN)).HorizontalAlignment = xlCenter
    '|fffd||fffd||fffd||fffd||fffd|`|fffd|\|fffd||fffd||fffd||656a||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|k|fffd||fffd||fffd||fffd||fffd||111|S|fffd||302||fffd|\|fffd||fffd|
    Sh_Main.Range(Cells(CY_Start, CX_StrTime), Cells(CY_Start, CX_KUBUN)).ShrinkToFit = True
    '|fffd||fffd||fffd|t|fffd|`|fffd||fffd||fffd||fffd||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X(|fffd|O|fffd||fffd||fffd|[)
    Sh_Main.Range(Cells(CY_Start, CX_StrDay), Cells(CY_Start, CX_StrTime)).Interior.Color = RGB(192, 192, 192)
    '|fffd|d|fffd|C|fffd||fffd||fffd|`|fffd|\|fffd||fffd||fffd||656a||fffd||314|w|fffd|i|fffd|F|fffd||fffd||3cd|X(|fffd||fffd||fffd|F)
    Sh_Main.Range(Cells(CY_Start, CX_NM_DENKI), Cells(CY_Start, CX_KUBUN)).Interior.Color = RGB(255, 255, 0)
End Sub



INQUEST-PP=macro
